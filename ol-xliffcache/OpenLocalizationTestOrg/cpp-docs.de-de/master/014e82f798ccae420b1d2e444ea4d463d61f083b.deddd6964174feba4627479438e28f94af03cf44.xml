{"nodes":[{"pos":[12,43],"content":"Error Trapping | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Error Trapping | Microsoft Docs","pos":[0,31]}]},{"content":"Error Trapping","pos":[617,631]},{"content":"In databinding, error trapping comes from two sources: error events or error objects.","pos":[632,717]},{"pos":[775,806],"content":"Error Trapping via Error Events"},{"content":"Both the ADO data control and the RDO RemoteData control data controls have error events.","pos":[810,899]},{"content":"Typically, you set an error event handler.","pos":[900,942]},{"content":"The event handlers have the following signature.","pos":[943,991]},{"content":"Usually the Description field is populated, but the ErrorNumber and Scode fields are only populated in the event of COM errors.","pos":[1347,1474]},{"content":"A standard event handler is to display the Description field in a message box.","pos":[1475,1553]},{"content":"For example:","pos":[1554,1566]},{"content":"However, because the ADO data control and RDO RemoteData control are already set up to trap error events, no coding is necessary.","pos":[1754,1883]},{"pos":[1942,1978],"content":"Error Trapping Through Error Objects"},{"content":"Both ADO and RDO have error objects.","pos":[1982,2018]},{"content":"When generating <bpt id=\"p1\">[</bpt>wrapper classes<ept id=\"p1\">](../../data/ado-rdo/wrapper-classes.md)</ept>, the RDO RemoteData control generates wrappers for error objects, but the ADO data control does not.","pos":[2019,2192],"source":" When generating [wrapper classes](../../data/ado-rdo/wrapper-classes.md), the RDO RemoteData control generates wrappers for error objects, but the ADO data control does not."},{"content":"The ADO data control automatically displays ADO error messages.","pos":[2199,2262]},{"content":"See Also","pos":[2271,2279]},{"content":"Databinding with ActiveX Controls in Visual C++","pos":[2284,2331]}],"content":"---\ntitle: \"Error Trapping | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ActiveX controls [C++], error trapping\"\n  - \"error trapping [C++]\"\nms.assetid: c509b089-a542-44be-8f22-dc5832967a48\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Error Trapping\nIn databinding, error trapping comes from two sources: error events or error objects.  \n  \n##  <a name=\"vcreferrortrappingviaerrorevents\"></a> Error Trapping via Error Events  \n Both the ADO data control and the RDO RemoteData control data controls have error events. Typically, you set an error event handler. The event handlers have the following signature.  \n  \n```  \nvoid CMyDlg::OnErrorAdodc1(long ErrorNumber,  \n                           BSTR* FAR Description,  \n                           long Scode,  \n                           LPCTSTR Source,  \n                           LPCTSTR HelpFile,  \n                           long HelpContext,  \n                           BOOL FAR* fCancelDisplay)  \n```  \n  \n Usually the Description field is populated, but the ErrorNumber and Scode fields are only populated in the event of COM errors. A standard event handler is to display the Description field in a message box. For example:  \n  \n```  \n{  \n   USES_CONVERSION;     \n// note: have to include the ATL file ATLConv.h to use the ATL conversion macros  \n   ::AfxMessageBox(OLE2T(*Description), MB_OK);  \n}  \n```  \n  \n However, because the ADO data control and RDO RemoteData control are already set up to trap error events, no coding is necessary.  \n  \n##  <a name=\"vcreferrortrappingviaerrorobjects\"></a> Error Trapping Through Error Objects  \n Both ADO and RDO have error objects. When generating [wrapper classes](../../data/ado-rdo/wrapper-classes.md), the RDO RemoteData control generates wrappers for error objects, but the ADO data control does not.  \n  \n The ADO data control automatically displays ADO error messages.  \n  \n## See Also  \n [Databinding with ActiveX Controls in Visual C++](../../data/ado-rdo/databinding-with-activex-controls-in-visual-cpp.md)"}