{"nodes":[{"pos":[12,52],"content":"Using Dynamic Accessors | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using Dynamic Accessors | Microsoft Docs","pos":[0,40]}]},{"content":"Using Dynamic Accessors","pos":[610,633]},{"content":"Dynamic accessors allow you to access a data source when you have no knowledge of the database schema (underlying structure).","pos":[634,759]},{"content":"The OLE DB Templates library provides several classes to help you do this.","pos":[760,834]},{"pos":[841,1048],"content":"The <bpt id=\"p1\">[</bpt>DynamicConsumer<ept id=\"p1\">](http://msdn.microsoft.com/en-us/2ccc4c61-6749-4e83-aa81-00f8009c0dc3)</ept> sample shows how to use the dynamic accessor classes to obtain column information and dynamically create accessors.","source":"The [DynamicConsumer](http://msdn.microsoft.com/en-us/2ccc4c61-6749-4e83-aa81-00f8009c0dc3) sample shows how to use the dynamic accessor classes to obtain column information and dynamically create accessors."},{"content":"Using CDynamicAccessor","pos":[1057,1079]},{"content":"<bpt id=\"p1\">[</bpt>CDynamicAccessor<ept id=\"p1\">](../../data/oledb/cdynamicaccessor-class.md)</ept> allows you to access a data source when you have no knowledge of the database schema (the database's underlying structure).","pos":[1083,1269],"source":"[CDynamicAccessor](../../data/oledb/cdynamicaccessor-class.md) allows you to access a data source when you have no knowledge of the database schema (the database's underlying structure)."},{"content":"methods obtain column information such as column names, count, and data type.","pos":[1289,1366]},{"content":"You use this column information to create an accessor dynamically at run time.","pos":[1367,1445]},{"content":"The column information is stored in a buffer that is created and managed by this class.","pos":[1446,1533]},{"content":"Obtain data from the buffer using the <bpt id=\"p1\">[</bpt>GetValue<ept id=\"p1\">](../../data/oledb/cdynamicaccessor-getvalue.md)</ept> method.","pos":[1534,1637],"source":" Obtain data from the buffer using the [GetValue](../../data/oledb/cdynamicaccessor-getvalue.md) method."},{"content":"Example","pos":[1646,1653]},{"content":"Code","pos":[1663,1667]},{"content":"Using CDynamicStringAccessor","pos":[3562,3590]},{"content":"<bpt id=\"p1\">[</bpt>CDynamicStringAccessor<ept id=\"p1\">](../../data/oledb/cdynamicstringaccessor-class.md)</ept> works like <bpt id=\"p2\">[</bpt>CDynamicAccessor<ept id=\"p2\">](../../data/oledb/cdynamicaccessor-class.md)</ept>, except in one important way.","pos":[3594,3772],"source":"[CDynamicStringAccessor](../../data/oledb/cdynamicstringaccessor-class.md) works like [CDynamicAccessor](../../data/oledb/cdynamicaccessor-class.md), except in one important way."},{"content":"While <ph id=\"ph1\">`CDynamicAccessor`</ph> requests data in the native format reported by the provider, <ph id=\"ph2\">`CDynamicStringAccessor`</ph> requests that the provider fetch all data accessed from the data store as string data.","pos":[3773,3970],"source":" While `CDynamicAccessor` requests data in the native format reported by the provider, `CDynamicStringAccessor` requests that the provider fetch all data accessed from the data store as string data."},{"content":"This is especially useful for simple tasks that do not require calculation of values in the data store, such as displaying or printing the data store's contents.","pos":[3971,4132]},{"content":"Use <ph id=\"ph1\">`CDynamicStringAccessor`</ph> methods to obtain column information.","pos":[4139,4205],"source":"Use `CDynamicStringAccessor` methods to obtain column information."},{"content":"You use this column information to create an accessor dynamically at run time.","pos":[4206,4284]},{"content":"The column information is stored in a buffer created and managed by this class.","pos":[4285,4364]},{"content":"Obtain data from the buffer using <bpt id=\"p1\">[</bpt>CDynamicStringAccessor::GetString<ept id=\"p1\">](../../data/oledb/cdynamicstringaccessor-getstring.md)</ept> or store it to the buffer using <bpt id=\"p2\">[</bpt>CDynamicStringAccessor::SetString<ept id=\"p2\">](../../data/oledb/cdynamicstringaccessor-setstring.md)</ept>.","pos":[4365,4611],"source":" Obtain data from the buffer using [CDynamicStringAccessor::GetString](../../data/oledb/cdynamicstringaccessor-getstring.md) or store it to the buffer using [CDynamicStringAccessor::SetString](../../data/oledb/cdynamicstringaccessor-setstring.md)."},{"content":"Example","pos":[4620,4627]},{"content":"Code","pos":[4637,4641]},{"content":"Using CDynamicParameterAccessor","pos":[6004,6035]},{"content":"<bpt id=\"p1\">[</bpt>CDynamicParameterAccessor<ept id=\"p1\">](../../data/oledb/cdynamicparameteraccessor-class.md)</ept> is similar to <bpt id=\"p2\">[</bpt>CDynamicAccessor<ept id=\"p2\">](../../data/oledb/cdynamicaccessor-class.md)</ept>, except that <ph id=\"ph1\">`CDynamicParameterAccessor`</ph> obtains parameter information to be set by calling the <bpt id=\"p3\">[</bpt>ICommandWithParameters<ept id=\"p3\">](https://msdn.microsoft.com/en-us/library/ms712937.aspx)</ept> interface.","pos":[6039,6384],"source":"[CDynamicParameterAccessor](../../data/oledb/cdynamicparameteraccessor-class.md) is similar to [CDynamicAccessor](../../data/oledb/cdynamicaccessor-class.md), except that `CDynamicParameterAccessor` obtains parameter information to be set by calling the [ICommandWithParameters](https://msdn.microsoft.com/en-us/library/ms712937.aspx) interface."},{"content":"The provider must support <ph id=\"ph1\">`ICommandWithParameters`</ph> for the consumer to use this class.","pos":[6385,6471],"source":" The provider must support `ICommandWithParameters` for the consumer to use this class."},{"content":"The parameter information is stored in a buffer created and managed by this class.","pos":[6478,6560]},{"content":"Obtain parameter data from the buffer by using <bpt id=\"p1\">[</bpt>CDynamicParameterAccessor::GetParam<ept id=\"p1\">](../../data/oledb/cdynamicparameteraccessor-getparam.md)</ept> and <bpt id=\"p2\">[</bpt>CDynamicParameterAccessor::GetParamType<ept id=\"p2\">](../../data/oledb/cdynamicparameteraccessor-getparamtype.md)</ept>.","pos":[6561,6808],"source":" Obtain parameter data from the buffer by using [CDynamicParameterAccessor::GetParam](../../data/oledb/cdynamicparameteraccessor-getparam.md) and [CDynamicParameterAccessor::GetParamType](../../data/oledb/cdynamicparameteraccessor-getparamtype.md)."},{"content":"For an example demonstrating how to use this class to execute a SQL Server stored procedure and get the output parameter values, see Knowledge Base article Q058860, \"HOWTO: Execute Stored Procedure using CDynamicParameterAccessor.\"","pos":[6815,7046]},{"content":"Knowledge Base articles are available in the MSDN Library Visual Studio documentation or at <bpt id=\"p1\">[</bpt>http://support.microsoft.com<ept id=\"p1\">](http://support.microsoft.com/)</ept>.","pos":[7047,7201],"source":" Knowledge Base articles are available in the MSDN Library Visual Studio documentation or at [http://support.microsoft.com](http://support.microsoft.com/)."},{"content":"See Also","pos":[7210,7218]},{"content":"Using Accessors","pos":[7223,7238]},{"content":"CDynamicAccessor Class","pos":[7282,7304]},{"content":"CDynamicStringAccessor Class","pos":[7355,7383]},{"content":"CDynamicParameterAccessor Class","pos":[7440,7471]},{"content":"DynamicConsumer Sample","pos":[7531,7553]}],"content":"---\ntitle: \"Using Dynamic Accessors | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"accessors [C++], dynamic\"\n  - \"dynamic accessors\"\nms.assetid: e5d5bfa6-2b1d-49d0-8ced-914666422431\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Using Dynamic Accessors\nDynamic accessors allow you to access a data source when you have no knowledge of the database schema (underlying structure). The OLE DB Templates library provides several classes to help you do this.  \n  \n The [DynamicConsumer](http://msdn.microsoft.com/en-us/2ccc4c61-6749-4e83-aa81-00f8009c0dc3) sample shows how to use the dynamic accessor classes to obtain column information and dynamically create accessors.  \n  \n## Using CDynamicAccessor  \n [CDynamicAccessor](../../data/oledb/cdynamicaccessor-class.md) allows you to access a data source when you have no knowledge of the database schema (the database's underlying structure). `CDynamicAccessor` methods obtain column information such as column names, count, and data type. You use this column information to create an accessor dynamically at run time. The column information is stored in a buffer that is created and managed by this class. Obtain data from the buffer using the [GetValue](../../data/oledb/cdynamicaccessor-getvalue.md) method.  \n  \n## Example  \n  \n### Code  \n  \n```  \n// Using_Dynamic_Accessors.cpp  \n// compile with: /c /EHsc  \n#include <stdio.h>  \n#include <objbase.h>  \n#include <atldbcli.h>  \n  \nint main( int argc, char* argv[] )  \n{  \n    HRESULT hr = CoInitialize( NULL );  \n  \n    CDataSource ds;  \n    CSession ss;  \n  \n    CTable<CDynamicAccessor> rs;  \n  \n    // The following is an example initialization string:  \n    hr = ds.OpenFromInitializationString(L\"Provider=SQLOLEDB.1;\"  \n      L\"Integrated Security=SSPI;Persist Security Info=False;\"  \n      L\"Initial Catalog=Loginname;Data Source=your_data_source;\"  \n      L\"Use Procedure for Prepare=1;Auto Translate=True;\"  \n      L\"Packet Size=4096;Workstation ID=LOGINNAME01;\"  \n      L\"Use Encryption for Data=False;\"  \n      L\"Tag with column collation when possible=False\");  \n  \n    hr = ss.Open( ds );  \n    hr = rs.Open( ss, \"Shippers\" );  \n  \n    hr = rs.MoveFirst( );  \n    while( SUCCEEDED( hr ) && hr != DB_S_ENDOFROWSET )  \n    {  \n        for( size_t i = 1; i <= rs.GetColumnCount( ); i++ )  \n        {  \n            DBTYPE type;  \n            rs.GetColumnType( i, &type );  \n            printf_s( \"Column %d [%S] is of type %d\\n\",  \n                      i, rs.GetColumnName( i ), type );   \n  \n            switch( type )  \n            {  \n                case DBTYPE_WSTR:  \n                    printf_s( \"value is %S\\n\",  \n                              (WCHAR*)rs.GetValue( i ) );  \n                break;  \n                case DBTYPE_STR:  \n                    printf_s( \"value is %s\\n\",  \n                              (CHAR*)rs.GetValue( i ) );  \n                default:  \n                    printf_s( \"value is %d\\n\",  \n                              *(long*)rs.GetValue( i ) );  \n            }  \n        }  \n        hr = rs.MoveNext( );  \n    }  \n  \n    rs.Close();     \n    ss.Close();  \n    ds.Close();  \n    CoUninitialize();  \n  \n    return 0;  \n}  \n```  \n  \n## Using CDynamicStringAccessor  \n [CDynamicStringAccessor](../../data/oledb/cdynamicstringaccessor-class.md) works like [CDynamicAccessor](../../data/oledb/cdynamicaccessor-class.md), except in one important way. While `CDynamicAccessor` requests data in the native format reported by the provider, `CDynamicStringAccessor` requests that the provider fetch all data accessed from the data store as string data. This is especially useful for simple tasks that do not require calculation of values in the data store, such as displaying or printing the data store's contents.  \n  \n Use `CDynamicStringAccessor` methods to obtain column information. You use this column information to create an accessor dynamically at run time. The column information is stored in a buffer created and managed by this class. Obtain data from the buffer using [CDynamicStringAccessor::GetString](../../data/oledb/cdynamicstringaccessor-getstring.md) or store it to the buffer using [CDynamicStringAccessor::SetString](../../data/oledb/cdynamicstringaccessor-setstring.md).  \n  \n## Example  \n  \n### Code  \n  \n```  \n// Using_Dynamic_Accessors_b.cpp  \n// compile with: /c /EHsc  \n#include <stdio.h>  \n#include <objbase.h>  \n#include <atldbcli.h>  \n  \nint main( int argc, char* argv[] )  \n{  \n    HRESULT hr = CoInitialize( NULL );  \n    if (hr != S_OK)  \n    {  \n        exit (-1);  \n    }  \n  \n    CDataSource ds;  \n    CSession ss;  \n  \n    CTable<CDynamicStringAccessor> rs;  \n  \n    // The following is an example initialization string:  \n    hr = ds.OpenFromInitializationString(L\"Provider=SQLOLEDB.1;\"  \n      L\"Integrated Security=SSPI;Persist Security Info=False;\"  \n      L\"Initial Catalog=Loginname;Data Source=your_data_source;\"  \n      L\"Use Procedure for Prepare=1;Auto Translate=True;\"  \n      L\"Packet Size=4096;Workstation ID=LOGINNAME01;\"  \n      L\"Use Encryption for Data=False;\"  \n      L\"Tag with column collation when possible=False\");  \n  \n    hr = ss.Open( ds );  \n    hr = rs.Open( ss, \"Shippers\" );  \n  \n    hr = rs.MoveFirst( );  \n    while( SUCCEEDED( hr ) && hr != DB_S_ENDOFROWSET )  \n    {  \n        for( size_t i = 1; i <= rs.GetColumnCount( ); i++ )  \n        {  \n            printf_s( \"column %d value is %s\\n\",   \n                      i, rs.GetString( i ) );  \n        }  \n        hr = rs.MoveNext( );  \n    }  \n  \n    rs.Close();     \n    ss.Close();  \n    ds.Close();  \n    CoUninitialize();  \n  \n   return 0;  \n  \n}  \n```  \n  \n## Using CDynamicParameterAccessor  \n [CDynamicParameterAccessor](../../data/oledb/cdynamicparameteraccessor-class.md) is similar to [CDynamicAccessor](../../data/oledb/cdynamicaccessor-class.md), except that `CDynamicParameterAccessor` obtains parameter information to be set by calling the [ICommandWithParameters](https://msdn.microsoft.com/en-us/library/ms712937.aspx) interface. The provider must support `ICommandWithParameters` for the consumer to use this class.  \n  \n The parameter information is stored in a buffer created and managed by this class. Obtain parameter data from the buffer by using [CDynamicParameterAccessor::GetParam](../../data/oledb/cdynamicparameteraccessor-getparam.md) and [CDynamicParameterAccessor::GetParamType](../../data/oledb/cdynamicparameteraccessor-getparamtype.md).  \n  \n For an example demonstrating how to use this class to execute a SQL Server stored procedure and get the output parameter values, see Knowledge Base article Q058860, \"HOWTO: Execute Stored Procedure using CDynamicParameterAccessor.\" Knowledge Base articles are available in the MSDN Library Visual Studio documentation or at [http://support.microsoft.com](http://support.microsoft.com/).  \n  \n## See Also  \n [Using Accessors](../../data/oledb/using-accessors.md)   \n [CDynamicAccessor Class](../../data/oledb/cdynamicaccessor-class.md)   \n [CDynamicStringAccessor Class](../../data/oledb/cdynamicstringaccessor-class.md)   \n [CDynamicParameterAccessor Class](../../data/oledb/cdynamicparameteraccessor-class.md)   \n [DynamicConsumer Sample](http://msdn.microsoft.com/en-us/2ccc4c61-6749-4e83-aa81-00f8009c0dc3)"}