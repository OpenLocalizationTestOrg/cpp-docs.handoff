{"nodes":[{"pos":[12,47],"content":"CDaoDatabase Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDaoDatabase Class | Microsoft Docs","pos":[0,35]}]},{"content":"CDaoDatabase Class","pos":[776,794]},{"content":"Represents a connection to a database through which you can operate on the data.","pos":[795,875]},{"content":"Syntax","pos":[884,890]},{"content":"Members","pos":[952,959]},{"content":"Public Constructors","pos":[969,988]},{"content":"Name","pos":[995,999]},{"content":"Description","pos":[1000,1011]},{"content":"CDaoDatabase::CDaoDatabase","pos":[1050,1076]},{"content":"Constructs a <ph id=\"ph1\">`CDaoDatabase`</ph> object.","pos":[1107,1142],"source":"Constructs a `CDaoDatabase` object."},{"content":"Call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> to connect the object to a database.","pos":[1143,1193],"source":" Call **Open** to connect the object to a database."},{"content":"Public Methods","pos":[1204,1218]},{"content":"Name","pos":[1225,1229]},{"content":"Description","pos":[1230,1241]},{"content":"CDaoDatabase::CanTransact","pos":[1280,1305]},{"content":"Returns nonzero if the database supports transactions.","pos":[1335,1389]},{"content":"CDaoDatabase::CanUpdate","pos":[1395,1418]},{"pos":[1446,1520],"content":"Returns nonzero if the <ph id=\"ph1\">`CDaoDatabase`</ph> object is updatable (not read-only).","source":"Returns nonzero if the `CDaoDatabase` object is updatable (not read-only)."},{"content":"CDaoDatabase::Close","pos":[1526,1545]},{"content":"Closes the database connection.","pos":[1569,1600]},{"content":"CDaoDatabase::Create","pos":[1606,1626]},{"pos":[1651,1736],"content":"Creates the underlying DAO database object and initializes the <ph id=\"ph1\">`CDaoDatabase`</ph> object.","source":"Creates the underlying DAO database object and initializes the `CDaoDatabase` object."},{"content":"CDaoDatabase::CreateRelation","pos":[1742,1770]},{"content":"Defines a new relation among the tables in the database.","pos":[1803,1859]},{"content":"CDaoDatabase::DeleteQueryDef","pos":[1865,1893]},{"content":"Deletes a querydef object saved in the database's QueryDefs collection.","pos":[1926,1997]},{"content":"CDaoDatabase::DeleteRelation","pos":[2003,2031]},{"content":"Deletes an existing relation between tables in the database.","pos":[2064,2124]},{"content":"CDaoDatabase::DeleteTableDef","pos":[2130,2158]},{"content":"Deletes the definition of a table in the database.","pos":[2191,2241]},{"content":"This deletes the actual table and all of its data.","pos":[2242,2292]},{"content":"CDaoDatabase::Execute","pos":[2298,2319]},{"content":"Executes an action query.","pos":[2345,2370]},{"content":"Calling <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> for a query that returns results throws an exception.","pos":[2371,2444],"source":" Calling **Execute** for a query that returns results throws an exception."},{"content":"CDaoDatabase::GetConnect","pos":[2450,2474]},{"content":"Returns the connection string used to connect the <ph id=\"ph1\">`CDaoDatabase`</ph> object to a database.","pos":[2503,2589],"source":"Returns the connection string used to connect the `CDaoDatabase` object to a database."},{"content":"Used for ODBC.","pos":[2590,2604]},{"content":"CDaoDatabase::GetName","pos":[2610,2631]},{"content":"Returns the name of the database currently in use.","pos":[2657,2707]},{"content":"CDaoDatabase::GetQueryDefCount","pos":[2713,2743]},{"content":"Returns the number of queries defined for the database.","pos":[2778,2833]},{"content":"CDaoDatabase::GetQueryDefInfo","pos":[2839,2868]},{"content":"Returns information about a specified query defined in the database.","pos":[2902,2970]},{"content":"CDaoDatabase::GetQueryTimeout","pos":[2976,3005]},{"content":"Returns the number of seconds after which database query operations will time out.","pos":[3039,3121]},{"content":"Affects all subsequent open, add new, update, and edit operations and other operations on ODBC data sources (only) such as <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> calls.","pos":[3122,3263],"source":" Affects all subsequent open, add new, update, and edit operations and other operations on ODBC data sources (only) such as **Execute** calls."},{"content":"CDaoDatabase::GetRecordsAffected","pos":[3269,3301]},{"pos":[3338,3448],"content":"Returns the number of records affected by the last update, edit, or add operation or by a call to <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept>.","source":"Returns the number of records affected by the last update, edit, or add operation or by a call to **Execute**."},{"content":"CDaoDatabase::GetRelationCount","pos":[3454,3484]},{"content":"Returns the number of relations defined between tables in the database.","pos":[3519,3590]},{"content":"CDaoDatabase::GetRelationInfo","pos":[3596,3625]},{"content":"Returns information about a specified relation defined between tables in the database.","pos":[3659,3745]},{"content":"CDaoDatabase::GetTableDefCount","pos":[3751,3781]},{"content":"Returns the number of tables defined in the database.","pos":[3816,3869]},{"content":"CDaoDatabase::GetTableDefInfo","pos":[3875,3904]},{"content":"Returns information about a specified table in the database.","pos":[3938,3998]},{"content":"CDaoDatabase::GetVersion","pos":[4004,4028]},{"content":"Returns the version of the database engine associated with the database.","pos":[4057,4129]},{"content":"CDaoDatabase::IsOpen","pos":[4135,4155]},{"pos":[4180,4262],"content":"Returns nonzero if the <ph id=\"ph1\">`CDaoDatabase`</ph> object is currently connected to a database.","source":"Returns nonzero if the `CDaoDatabase` object is currently connected to a database."},{"content":"CDaoDatabase::Open","pos":[4268,4286]},{"content":"Establishes a connection to a database.","pos":[4309,4348]},{"content":"CDaoDatabase::SetQueryTimeout","pos":[4354,4383]},{"content":"Sets the number of seconds after which database query operations (on ODBC data sources only) will time out.","pos":[4417,4524]},{"content":"Affects all subsequent open, add new, update, and delete operations.","pos":[4525,4593]},{"content":"Public Data Members","pos":[4604,4623]},{"content":"Name","pos":[4630,4634]},{"content":"Description","pos":[4635,4646]},{"content":"CDaoDatabase::m_pDAODatabase","pos":[4685,4713]},{"content":"A pointer to the underlying DAO database object.","pos":[4746,4794]},{"content":"CDaoDatabase::m_pWorkspace","pos":[4800,4826]},{"pos":[4857,5002],"content":"A pointer to the <bpt id=\"p1\">[</bpt>CDaoWorkspace<ept id=\"p1\">](../../mfc/reference/cdaoworkspace-class.md)</ept> object that contains the database and defines its transaction space.","source":"A pointer to the [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) object that contains the database and defines its transaction space."},{"content":"Remarks","pos":[5012,5019]},{"content":"For information about the database formats supported, see the <bpt id=\"p1\">[</bpt>GetName<ept id=\"p1\">](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__getname)</ept> member function.","pos":[5023,5178],"source":"For information about the database formats supported, see the [GetName](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__getname) member function."},{"content":"You can have one or more <ph id=\"ph1\">`CDaoDatabase`</ph> objects active at a time in a given \"workspace,\" represented by a <bpt id=\"p1\">[</bpt>CDaoWorkspace<ept id=\"p1\">](../../mfc/reference/cdaoworkspace-class.md)</ept> object.","pos":[5179,5352],"source":" You can have one or more `CDaoDatabase` objects active at a time in a given \"workspace,\" represented by a [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) object."},{"content":"The workspace maintains a collection of open database objects, called the Databases collection.","pos":[5353,5448]},{"pos":[5456,6328],"content":"[!NOTE]\n The MFC DAO database classes are distinct from the MFC database classes based on ODBC. All DAO database class names have the \"CDao\" prefix. Class `CDaoDatabase` supplies an interface similar to that of the ODBC class [CDatabase](../../mfc/reference/cdatabase-class.md). The main difference is that `CDatabase` accesses the DBMS through Open Database Connectivity (ODBC) and an ODBC driver for that DBMS. `CDaoDatabase` accesses data through a Data Access Object (DAO) based on the Microsoft Jet database engine. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC; the DAO-based classes can access data, including through ODBC drivers, via their own database engine. The DAO-based classes also support Data Definition Language (DDL) operations, such as adding tables via the classes, without having to call DAO directly.","leadings":["","> "],"nodes":[{"content":" The MFC DAO database classes are distinct from the MFC database classes based on ODBC. All DAO database class names have the \"CDao\" prefix. Class `CDaoDatabase` supplies an interface similar to that of the ODBC class [CDatabase](../../mfc/reference/cdatabase-class.md). The main difference is that `CDatabase` accesses the DBMS through Open Database Connectivity (ODBC) and an ODBC driver for that DBMS. `CDaoDatabase` accesses data through a Data Access Object (DAO) based on the Microsoft Jet database engine. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC; the DAO-based classes can access data, including through ODBC drivers, via their own database engine. The DAO-based classes also support Data Definition Language (DDL) operations, such as adding tables via the classes, without having to call DAO directly.","pos":[8,870],"nodes":[{"content":"The MFC DAO database classes are distinct from the MFC database classes based on ODBC.","pos":[1,87]},{"content":"All DAO database class names have the \"CDao\" prefix.","pos":[88,140]},{"content":"Class <ph id=\"ph1\">`CDaoDatabase`</ph> supplies an interface similar to that of the ODBC class <bpt id=\"p1\">[</bpt>CDatabase<ept id=\"p1\">](../../mfc/reference/cdatabase-class.md)</ept>.","pos":[141,270],"source":" Class `CDaoDatabase` supplies an interface similar to that of the ODBC class [CDatabase](../../mfc/reference/cdatabase-class.md)."},{"content":"The main difference is that <ph id=\"ph1\">`CDatabase`</ph> accesses the DBMS through Open Database Connectivity (ODBC) and an ODBC driver for that DBMS.","pos":[271,404],"source":" The main difference is that `CDatabase` accesses the DBMS through Open Database Connectivity (ODBC) and an ODBC driver for that DBMS."},{"content":"accesses data through a Data Access Object (DAO) based on the Microsoft Jet database engine.","pos":[420,512]},{"content":"In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC; the DAO-based classes can access data, including through ODBC drivers, via their own database engine.","pos":[513,708]},{"content":"The DAO-based classes also support Data Definition Language (DDL) operations, such as adding tables via the classes, without having to call DAO directly.","pos":[709,862]}]}]},{"content":"Usage","pos":[6337,6342]},{"content":"You can create database objects implicitly, when you create recordset objects.","pos":[6346,6424]},{"content":"But you can also create database objects explicitly.","pos":[6425,6477]},{"content":"To use an existing database explicitly with <ph id=\"ph1\">`CDaoDatabase`</ph>, do either of the following:","pos":[6478,6565],"source":" To use an existing database explicitly with `CDaoDatabase`, do either of the following:"},{"pos":[6575,6706],"content":"Construct a <ph id=\"ph1\">`CDaoDatabase`</ph> object, passing a pointer to an open <bpt id=\"p1\">[</bpt>CDaoWorkspace<ept id=\"p1\">](../../mfc/reference/cdaoworkspace-class.md)</ept> object.","source":"Construct a `CDaoDatabase` object, passing a pointer to an open [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) object."},{"pos":[6716,6829],"content":"Or construct a <ph id=\"ph1\">`CDaoDatabase`</ph> object without specifying the workspace (MFC creates a temporary workspace object).","source":"Or construct a `CDaoDatabase` object without specifying the workspace (MFC creates a temporary workspace object)."},{"content":"To create a new Microsoft Jet (.MDB) database, construct a <ph id=\"ph1\">`CDaoDatabase`</ph> object and call its <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaodatabase__create)</ept> member function.","pos":[6836,6978],"source":"To create a new Microsoft Jet (.MDB) database, construct a `CDaoDatabase` object and call its [Create](#cdaodatabase__create) member function."},{"content":"Do <bpt id=\"p1\">*</bpt>not<ept id=\"p1\">*</ept> call <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> after <bpt id=\"p3\">**</bpt>Create<ept id=\"p3\">**</ept>.","pos":[6979,7019],"source":" Do *not* call **Open** after **Create**."},{"pos":[7026,7147],"content":"To open an existing database, construct a <ph id=\"ph1\">`CDaoDatabase`</ph> object and call its <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaodatabase__open)</ept> member function.","source":"To open an existing database, construct a `CDaoDatabase` object and call its [Open](#cdaodatabase__open) member function."},{"content":"Any of these techniques appends the DAO database object to the workspace's Databases collection and opens a connection to the data.","pos":[7154,7285]},{"content":"When you then construct <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept>, <bpt id=\"p2\">[</bpt>CDaoTableDef<ept id=\"p2\">](../../mfc/reference/cdaotabledef-class.md)</ept>, or <bpt id=\"p3\">[</bpt>CDaoQueryDef<ept id=\"p3\">](../../mfc/reference/cdaoquerydef-class.md)</ept> objects for operating on the connected database, pass the constructors for these objects a pointer to your <ph id=\"ph1\">`CDaoDatabase`</ph> object.","pos":[7286,7620],"source":" When you then construct [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md), [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md), or [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md) objects for operating on the connected database, pass the constructors for these objects a pointer to your `CDaoDatabase` object."},{"content":"When you finish using the connection, call the <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](#cdaodatabase__close)</ept> member function and destroy the <ph id=\"ph1\">`CDaoDatabase`</ph> object.","pos":[7621,7752],"source":" When you finish using the connection, call the [Close](#cdaodatabase__close) member function and destroy the `CDaoDatabase` object."},{"content":"<bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> closes any recordsets you have not closed previously.","pos":[7753,7816],"source":"**Close** closes any recordsets you have not closed previously."},{"content":"Transactions","pos":[7825,7837]},{"pos":[7841,8213],"content":"Database transaction processing is supplied at the workspace level — see the <bpt id=\"p1\">[</bpt>BeginTrans<ept id=\"p1\">](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__begintrans)</ept>, <bpt id=\"p2\">[</bpt>CommitTrans<ept id=\"p2\">](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__committrans)</ept>, and <bpt id=\"p3\">[</bpt>Rollback<ept id=\"p3\">](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__rollback)</ept> member functions of class <ph id=\"ph1\">`CDaoWorkspace`</ph>.","source":"Database transaction processing is supplied at the workspace level — see the [BeginTrans](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__begintrans), [CommitTrans](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__committrans), and [Rollback](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__rollback) member functions of class `CDaoWorkspace`."},{"content":"ODBC Connections","pos":[8222,8238]},{"content":"The recommended way to work with ODBC data sources is to attach external tables to a Microsoft Jet (.MDB) database.","pos":[8242,8357]},{"content":"Collections","pos":[8366,8377]},{"content":"Each database maintains its own collections of tabledef, querydef, recordset, and relation objects.","pos":[8381,8480]},{"content":"Class <ph id=\"ph1\">`CDaoDatabase`</ph> supplies member functions for manipulating these objects.","pos":[8481,8559],"source":" Class `CDaoDatabase` supplies member functions for manipulating these objects."},{"pos":[8567,8737],"content":"[!NOTE]\n The objects are stored in DAO, not in the MFC database object. MFC supplies classes for tabledef, querydef, and recordset objects but not for relation objects.","leadings":["","> "],"nodes":[{"content":" The objects are stored in DAO, not in the MFC database object. MFC supplies classes for tabledef, querydef, and recordset objects but not for relation objects.","pos":[8,168],"nodes":[{"content":"The objects are stored in DAO, not in the MFC database object.","pos":[1,63]},{"content":"MFC supplies classes for tabledef, querydef, and recordset objects but not for relation objects.","pos":[64,160]}]}]},{"content":"Inheritance Hierarchy","pos":[8746,8767]},{"content":"CObject","pos":[8772,8779]},{"content":"Requirements","pos":[8848,8860]},{"pos":[8864,8884],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdao.h","source":"**Header:** afxdao.h"},{"pos":[8936,8961],"content":"CDaoDatabase::CanTransact"},{"content":"Call this member function to determine whether the database allows transactions.","pos":[8965,9045]},{"content":"Return Value","pos":[9090,9102]},{"content":"Nonzero if the database supports transactions; otherwise 0.","pos":[9106,9165]},{"content":"Remarks","pos":[9175,9182]},{"content":"Transactions are managed in the database's workspace.","pos":[9186,9239]},{"pos":[9289,9312],"content":"CDaoDatabase::CanUpdate"},{"pos":[9316,9404],"content":"Call this member function to determine whether the <ph id=\"ph1\">`CDaoDatabase`</ph> object allows updates.","source":"Call this member function to determine whether the `CDaoDatabase` object allows updates."},{"content":"Return Value","pos":[9447,9459]},{"content":"Nonzero if the <ph id=\"ph1\">`CDaoDatabase`</ph> object allows updates; otherwise 0, indicating either that you passed <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> in <ph id=\"ph2\">`bReadOnly`</ph> when you opened the <ph id=\"ph3\">`CDaoDatabase`</ph> object or that the database itself is read-only.","pos":[9463,9670],"source":"Nonzero if the `CDaoDatabase` object allows updates; otherwise 0, indicating either that you passed **TRUE** in `bReadOnly` when you opened the `CDaoDatabase` object or that the database itself is read-only."},{"content":"See the <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaodatabase__open)</ept> member function.","pos":[9671,9723],"source":" See the [Open](#cdaodatabase__open) member function."},{"content":"Remarks","pos":[9733,9740]},{"content":"For information about database updatability, see the topic \"Updatable Property\" in DAO Help.","pos":[9744,9836]},{"pos":[9889,9915],"content":"CDaoDatabase::CDaoDatabase"},{"pos":[9919,9954],"content":"Constructs a <ph id=\"ph1\">`CDaoDatabase`</ph> object.","source":"Constructs a `CDaoDatabase` object."},{"content":"Parameters","pos":[10027,10037]},{"content":"pWorkspace","pos":[10042,10052]},{"content":"A pointer to the <ph id=\"ph1\">`CDaoWorkspace`</ph> object that will contain the new database object.","pos":[10057,10139],"source":" A pointer to the `CDaoWorkspace` object that will contain the new database object."},{"content":"If you accept the default value of <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the constructor creates a temporary <ph id=\"ph1\">`CDaoWorkspace`</ph> object that uses the default DAO workspace.","pos":[10140,10280],"source":" If you accept the default value of **NULL**, the constructor creates a temporary `CDaoWorkspace` object that uses the default DAO workspace."},{"content":"You can get a pointer to the workspace object via the <bpt id=\"p1\">[</bpt>m_pWorkspace<ept id=\"p1\">](#cdaodatabase__m_pworkspace)</ept> data member.","pos":[10281,10391],"source":" You can get a pointer to the workspace object via the [m_pWorkspace](#cdaodatabase__m_pworkspace) data member."},{"content":"Remarks","pos":[10401,10408]},{"content":"After constructing the object, if you are creating a new Microsoft Jet (.MDB) database, call the object's <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaodatabase__create)</ept> member function.","pos":[10412,10566],"source":"After constructing the object, if you are creating a new Microsoft Jet (.MDB) database, call the object's [Create](#cdaodatabase__create) member function."},{"content":"If you are, instead, opening an existing database, call the object's <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaodatabase__open)</ept> member function.","pos":[10567,10680],"source":" If you are, instead, opening an existing database, call the object's [Open](#cdaodatabase__open) member function."},{"pos":[10687,10829],"content":"When you finish with the object, you should call its <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](#cdaodatabase__close)</ept> member function and then destroy the <ph id=\"ph1\">`CDaoDatabase`</ph> object.","source":"When you finish with the object, you should call its [Close](#cdaodatabase__close) member function and then destroy the `CDaoDatabase` object."},{"pos":[10836,10923],"content":"You might find it convenient to embed the <ph id=\"ph1\">`CDaoDatabase`</ph> object in your document class.","source":"You might find it convenient to embed the `CDaoDatabase` object in your document class."},{"pos":[10931,11205],"content":"[!NOTE]\n A `CDaoDatabase` object is also created implicitly if you open a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object without passing a pointer to an existing `CDaoDatabase` object. This database object is closed when you close the recordset object.","leadings":["","> "],"nodes":[{"content":" A `CDaoDatabase` object is also created implicitly if you open a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object without passing a pointer to an existing `CDaoDatabase` object. This database object is closed when you close the recordset object.","pos":[8,272],"nodes":[{"content":"A <ph id=\"ph1\">`CDaoDatabase`</ph> object is also created implicitly if you open a <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept> object without passing a pointer to an existing <ph id=\"ph2\">`CDaoDatabase`</ph> object.","pos":[1,196],"source":" A `CDaoDatabase` object is also created implicitly if you open a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object without passing a pointer to an existing `CDaoDatabase` object."},{"content":"This database object is closed when you close the recordset object.","pos":[197,264]}]}]},{"pos":[11251,11270],"content":"CDaoDatabase::Close"},{"content":"Call this member function to disconnect from a database and close any open recordsets, tabledefs, and querydefs associated with the database.","pos":[11274,11415]},{"content":"Remarks","pos":[11462,11469]},{"content":"It is good practice to close these objects yourself before you call this member function.","pos":[11473,11562]},{"content":"Closing a <ph id=\"ph1\">`CDaoDatabase`</ph> object removes it from the Databases collection in the associated <bpt id=\"p1\">[</bpt>workspace<ept id=\"p1\">](../../mfc/reference/cdaoworkspace-class.md)</ept>.","pos":[11563,11710],"source":" Closing a `CDaoDatabase` object removes it from the Databases collection in the associated [workspace](../../mfc/reference/cdaoworkspace-class.md)."},{"content":"Because <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> does not destroy the <ph id=\"ph1\">`CDaoDatabase`</ph> object, you can reuse the object by opening the same database or a different database.","pos":[11711,11851],"source":" Because **Close** does not destroy the `CDaoDatabase` object, you can reuse the object by opening the same database or a different database."},{"pos":[11859,12372],"content":"[!CAUTION]\n Call the [Update](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__update) member function (if there are pending edits) and the **Close** member function on all open recordset objects before you close a database. If you exit a function that declares [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) or `CDaoDatabase` objects on the stack, the database is closed, any unsaved changes are lost, all pending transactions are rolled back, and any pending edits to your data are lost.","leadings":["","> "],"nodes":[{"content":" Call the [Update](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__update) member function (if there are pending edits) and the **Close** member function on all open recordset objects before you close a database. If you exit a function that declares [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) or `CDaoDatabase` objects on the stack, the database is closed, any unsaved changes are lost, all pending transactions are rolled back, and any pending edits to your data are lost.","pos":[11,511],"nodes":[{"content":"Call the <bpt id=\"p1\">[</bpt>Update<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__update)</ept> member function (if there are pending edits) and the <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept> member function on all open recordset objects before you close a database.","pos":[1,222],"source":" Call the [Update](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__update) member function (if there are pending edits) and the **Close** member function on all open recordset objects before you close a database."},{"content":"If you exit a function that declares <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept> or <ph id=\"ph1\">`CDaoDatabase`</ph> objects on the stack, the database is closed, any unsaved changes are lost, all pending transactions are rolled back, and any pending edits to your data are lost.","pos":[223,500],"source":" If you exit a function that declares [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) or `CDaoDatabase` objects on the stack, the database is closed, any unsaved changes are lost, all pending transactions are rolled back, and any pending edits to your data are lost."}]}]},{"pos":[12380,13010],"content":"[!CAUTION]\n If you try to close a database object while any recordset objects are open, or if you try to close a workspace object while any database objects belonging to that specific workspace are open, those recordset objects will be closed and any pending updates or edits will be rolled back. If you try to close a workspace object while any database objects belonging to it are open, the operation closes all database objects belonging to that specific workspace object, which may result in unclosed recordset objects being closed. If you do not close your database object, MFC reports an assertion failure in debug builds.","leadings":["","> "],"nodes":[{"content":" If you try to close a database object while any recordset objects are open, or if you try to close a workspace object while any database objects belonging to that specific workspace are open, those recordset objects will be closed and any pending updates or edits will be rolled back. If you try to close a workspace object while any database objects belonging to it are open, the operation closes all database objects belonging to that specific workspace object, which may result in unclosed recordset objects being closed. If you do not close your database object, MFC reports an assertion failure in debug builds.","pos":[11,628],"nodes":[{"content":"If you try to close a database object while any recordset objects are open, or if you try to close a workspace object while any database objects belonging to that specific workspace are open, those recordset objects will be closed and any pending updates or edits will be rolled back.","pos":[1,285]},{"content":"If you try to close a workspace object while any database objects belonging to it are open, the operation closes all database objects belonging to that specific workspace object, which may result in unclosed recordset objects being closed.","pos":[286,525]},{"content":"If you do not close your database object, MFC reports an assertion failure in debug builds.","pos":[526,617]}]}]},{"content":"If the database object is defined outside the scope of a function, and you exit the function without closing it, the database object will remain open until explicitly closed or the module in which it is defined is out of scope.","pos":[13017,13244]},{"pos":[13291,13311],"content":"CDaoDatabase::Create"},{"pos":[13315,13432],"content":"To create a new Microsoft Jet (.MDB) database, call this member function after you construct a <ph id=\"ph1\">`CDaoDatabase`</ph> object.","source":"To create a new Microsoft Jet (.MDB) database, call this member function after you construct a `CDaoDatabase` object."},{"content":"Parameters","pos":[13568,13578]},{"content":"A string expression that is the name of the database file that you are creating.","pos":[13596,13676]},{"content":"It can be the full path and filename, such as \"C:<ph id=\"ph1\">\\\\</ph>\\MYDB.MDB\".","pos":[13677,13739],"source":" It can be the full path and filename, such as \"C:\\\\\\MYDB.MDB\"."},{"content":"You must supply a name.","pos":[13740,13763]},{"content":"If you do not supply a filename extension, .MDB is appended.","pos":[13764,13824]},{"content":"If your network supports the uniform naming convention (UNC), you can also specify a network path, such as \"<ph id=\"ph1\">\\\\\\\\\\\\</ph>\\MYSERVER<ph id=\"ph2\">\\\\</ph>\\MYSHARE<ph id=\"ph3\">\\\\</ph>\\MYDIR<ph id=\"ph4\">\\\\</ph>\\MYDB\".","pos":[13825,13975],"source":" If your network supports the uniform naming convention (UNC), you can also specify a network path, such as \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB\"."},{"content":"Only Microsoft Jet (.MDB) database files can be created using this member function.","pos":[13976,14059]},{"content":"(Double backslashes are required in string literals because \"<ph id=\"ph1\">\\\\</ph>\" is the C++ escape character.)","pos":[14060,14154],"source":" (Double backslashes are required in string literals because \"\\\\\" is the C++ escape character.)"},{"content":"A string expression used to specify collating order for creating the database.","pos":[14177,14255]},{"content":"The default value is <bpt id=\"p1\">**</bpt>dbLangGeneral<ept id=\"p1\">**</ept>.","pos":[14256,14295],"source":" The default value is **dbLangGeneral**."},{"content":"Possible values are:","pos":[14296,14316]},{"pos":[14324,14406],"content":"<bpt id=\"p1\">**</bpt>dbLangGeneral<ept id=\"p1\">**</ept> English, German, French, Portuguese, Italian, and Modern Spanish","source":"**dbLangGeneral** English, German, French, Portuguese, Italian, and Modern Spanish"},{"pos":[14414,14437],"content":"<bpt id=\"p1\">**</bpt>dbLangArabic<ept id=\"p1\">**</ept> Arabic","source":"**dbLangArabic** Arabic"},{"pos":[14445,14471],"content":"<bpt id=\"p1\">**</bpt>dbLangCyrillic<ept id=\"p1\">**</ept> Russian","source":"**dbLangCyrillic** Russian"},{"pos":[14479,14500],"content":"<bpt id=\"p1\">**</bpt>dbLangCzech<ept id=\"p1\">**</ept> Czech","source":"**dbLangCzech** Czech"},{"pos":[14508,14529],"content":"<bpt id=\"p1\">**</bpt>dbLangDutch<ept id=\"p1\">**</ept> Dutch","source":"**dbLangDutch** Dutch"},{"pos":[14537,14558],"content":"<bpt id=\"p1\">**</bpt>dbLangGreek<ept id=\"p1\">**</ept> Greek","source":"**dbLangGreek** Greek"},{"pos":[14566,14589],"content":"<bpt id=\"p1\">**</bpt>dbLangHebrew<ept id=\"p1\">**</ept> Hebrew","source":"**dbLangHebrew** Hebrew"},{"pos":[14597,14626],"content":"<bpt id=\"p1\">**</bpt>dbLangHungarian<ept id=\"p1\">**</ept> Hungarian","source":"**dbLangHungarian** Hungarian"},{"pos":[14634,14663],"content":"<bpt id=\"p1\">**</bpt>dbLangIcelandic<ept id=\"p1\">**</ept> Icelandic","source":"**dbLangIcelandic** Icelandic"},{"pos":[14671,14753],"content":"<bpt id=\"p1\">**</bpt>dbLangNordic<ept id=\"p1\">**</ept> Nordic languages (Microsoft Jet database engine version 1.0 only)","source":"**dbLangNordic** Nordic languages (Microsoft Jet database engine version 1.0 only)"},{"pos":[14761,14799],"content":"<bpt id=\"p1\">**</bpt>dbLangNorwdan<ept id=\"p1\">**</ept> Norwegian and Danish","source":"**dbLangNorwdan** Norwegian and Danish"},{"pos":[14807,14830],"content":"<bpt id=\"p1\">**</bpt>dbLangPolish<ept id=\"p1\">**</ept> Polish","source":"**dbLangPolish** Polish"},{"pos":[14838,14875],"content":"<bpt id=\"p1\">**</bpt>dbLangSpanish<ept id=\"p1\">**</ept> Traditional Spanish","source":"**dbLangSpanish** Traditional Spanish"},{"pos":[14883,14920],"content":"<bpt id=\"p1\">**</bpt>dbLangSwedfin<ept id=\"p1\">**</ept> Swedish and Finnish","source":"**dbLangSwedfin** Swedish and Finnish"},{"pos":[14928,14953],"content":"<bpt id=\"p1\">**</bpt>dbLangTurkish<ept id=\"p1\">**</ept> Turkish","source":"**dbLangTurkish** Turkish"},{"pos":[14960,15042],"content":"`dwOptions`  \nAn integer that indicates one or more options. Possible values are:","leadings":[""," "],"nodes":[{"content":"An integer that indicates one or more options. Possible values are:","pos":[14,81],"nodes":[{"content":"An integer that indicates one or more options.","pos":[0,46]},{"content":"Possible values are:","pos":[47,67]}]}]},{"pos":[15050,15093],"content":"<bpt id=\"p1\">**</bpt>dbEncrypt<ept id=\"p1\">**</ept> Create an encrypted database.","source":"**dbEncrypt** Create an encrypted database."},{"pos":[15101,15175],"content":"<bpt id=\"p1\">**</bpt>dbVersion10<ept id=\"p1\">**</ept> Create a database with Microsoft Jet database version 1.0.","source":"**dbVersion10** Create a database with Microsoft Jet database version 1.0."},{"pos":[15183,15257],"content":"<bpt id=\"p1\">**</bpt>dbVersion11<ept id=\"p1\">**</ept> Create a database with Microsoft Jet database version 1.1.","source":"**dbVersion11** Create a database with Microsoft Jet database version 1.1."},{"pos":[15265,15339],"content":"<bpt id=\"p1\">**</bpt>dbVersion20<ept id=\"p1\">**</ept> Create a database with Microsoft Jet database version 2.0.","source":"**dbVersion20** Create a database with Microsoft Jet database version 2.0."},{"pos":[15347,15421],"content":"<bpt id=\"p1\">**</bpt>dbVersion30<ept id=\"p1\">**</ept> Create a database with Microsoft Jet database version 3.0.","source":"**dbVersion30** Create a database with Microsoft Jet database version 3.0."},{"content":"If you omit the encryption constant, an unencrypted database is created.","pos":[15428,15500]},{"content":"You can specify only one version constant.","pos":[15501,15543]},{"content":"If you omit a version constant, a database that uses the Microsoft Jet database version 3.0 is created.","pos":[15544,15647]},{"pos":[15655,15831],"content":"[!CAUTION]\n If a database is not encrypted, it is possible, even if you implement user/password security, to directly read the binary disk file that constitutes the database.","leadings":["","> "],"nodes":[{"content":"If a database is not encrypted, it is possible, even if you implement user/password security, to directly read the binary disk file that constitutes the database.","pos":[12,174]}]},{"content":"Remarks","pos":[15841,15848]},{"content":"<bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> creates the database file and the underlying DAO database object and initializes the C++ object.","pos":[15852,15959],"source":"**Create** creates the database file and the underlying DAO database object and initializes the C++ object."},{"content":"The object is appended to the associated workspace's Databases collection.","pos":[15960,16034]},{"content":"The database object is in an open state; do not call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> after <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept>.","pos":[16035,16114],"source":" The database object is in an open state; do not call **Open** after **Create**."},{"pos":[16122,16253],"content":"[!NOTE]\n With **Create**, you can create only Microsoft Jet (.MDB) databases. You cannot create ISAM databases or ODBC databases.","leadings":["","> "],"nodes":[{"content":" With **Create**, you can create only Microsoft Jet (.MDB) databases. You cannot create ISAM databases or ODBC databases.","pos":[8,129],"nodes":[{"content":"With <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>, you can create only Microsoft Jet (.MDB) databases.","pos":[1,69],"source":" With **Create**, you can create only Microsoft Jet (.MDB) databases."},{"content":"You cannot create ISAM databases or ODBC databases.","pos":[70,121]}]}]},{"pos":[16308,16336],"content":"CDaoDatabase::CreateRelation"},{"content":"Call this member function to establish a relation between one or more fields in a primary table in the database and one or more fields in a foreign table (another table in the database).","pos":[16340,16526]},{"content":"Parameters","pos":[16789,16799]},{"content":"The unique name of the relation object.","pos":[16817,16856]},{"content":"The name must start with a letter and can contain a maximum of 40 characters.","pos":[16857,16934]},{"content":"It can include numbers and underscore characters but cannot include punctuation or spaces.","pos":[16935,17025]},{"content":"The name of the primary table in the relation.","pos":[17047,17093]},{"content":"If the table does not exist, MFC throws an exception of type <bpt id=\"p1\">[</bpt>CDaoException<ept id=\"p1\">](../../mfc/reference/cdaoexception-class.md)</ept>.","pos":[17094,17215],"source":" If the table does not exist, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md)."},{"content":"The name of the foreign table in the relation.","pos":[17244,17290]},{"content":"If the table does not exist, MFC throws an exception of type <ph id=\"ph1\">`CDaoException`</ph>.","pos":[17291,17368],"source":" If the table does not exist, MFC throws an exception of type `CDaoException`."},{"content":"A long value that contains information about the relationship type.","pos":[17392,17459]},{"content":"You can use this value to enforce referential integrity, among other things.","pos":[17460,17536]},{"content":"You can use the bitwise-OR operator ( <bpt id=\"p1\">**</bpt>&amp;#124;<ept id=\"p1\">**</ept>) to combine any of the following values (as long as the combination makes sense):","pos":[17537,17667],"source":" You can use the bitwise-OR operator ( **&#124;**) to combine any of the following values (as long as the combination makes sense):"},{"pos":[17675,17723],"content":"<bpt id=\"p1\">**</bpt>dbRelationUnique<ept id=\"p1\">**</ept> Relationship is one-to-one.","source":"**dbRelationUnique** Relationship is one-to-one."},{"pos":[17731,17813],"content":"<bpt id=\"p1\">**</bpt>dbRelationDontEnforce<ept id=\"p1\">**</ept> Relationship is not enforced (no referential integrity).","source":"**dbRelationDontEnforce** Relationship is not enforced (no referential integrity)."},{"pos":[17821,17928],"content":"<bpt id=\"p1\">**</bpt>dbRelationInherited<ept id=\"p1\">**</ept> Relationship exists in a noncurrent database that contains the two attached tables.","source":"**dbRelationInherited** Relationship exists in a noncurrent database that contains the two attached tables."},{"pos":[17936,18021],"content":"<bpt id=\"p1\">**</bpt>dbRelationUpdateCascade<ept id=\"p1\">**</ept> Updates will cascade (for more on cascades, see Remarks).","source":"**dbRelationUpdateCascade** Updates will cascade (for more on cascades, see Remarks)."},{"pos":[18029,18080],"content":"<bpt id=\"p1\">**</bpt>dbRelationDeleteCascade<ept id=\"p1\">**</ept> Deletions will cascade.","source":"**dbRelationDeleteCascade** Deletions will cascade."},{"pos":[18087,18215],"content":"*lpszField*  \nA pointer to a null-terminated string containing the name of a field in the primary table (named by `lpszTable`).","leadings":[""," "],"nodes":[{"content":"lpszField","pos":[1,10]},{"content":"A pointer to a null-terminated string containing the name of a field in the primary table (named by <ph id=\"ph1\">`lpszTable`</ph>).","pos":[14,127],"source":"A pointer to a null-terminated string containing the name of a field in the primary table (named by `lpszTable`)."}]},{"pos":[18222,18364],"content":"*lpszForeignField*  \nA pointer to a null-terminated string containing the name of a field in the foreign table (named by `lpszForeignTable`).","leadings":[""," "],"nodes":[{"content":"lpszForeignField","pos":[1,17]},{"content":"A pointer to a null-terminated string containing the name of a field in the foreign table (named by <ph id=\"ph1\">`lpszForeignTable`</ph>).","pos":[21,141],"source":"A pointer to a null-terminated string containing the name of a field in the foreign table (named by `lpszForeignTable`)."}]},{"pos":[18371,18542],"content":"*relinfo*  \nA reference to a [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) object that contains information about the relation you want to create.","leadings":[""," "],"nodes":[{"content":"relinfo","pos":[1,8]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoRelationInfo<ept id=\"p1\">](../../mfc/reference/cdaorelationinfo-structure.md)</ept> object that contains information about the relation you want to create.","pos":[12,170],"source":"A reference to a [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) object that contains information about the relation you want to create."}]},{"content":"Remarks","pos":[18552,18559]},{"content":"The relationship cannot involve a query or an attached table from an external database.","pos":[18563,18650]},{"content":"Use the first version of the function when the relation involves one field in each of the two tables.","pos":[18657,18758]},{"content":"Use the second version when the relation involves multiple fields.","pos":[18759,18825]},{"content":"The maximum number of fields in a relation is 14.","pos":[18826,18875]},{"content":"This action creates an underlying DAO relation object, but this is an MFC implementation detail since MFC's encapsulation of relation objects is contained within class <ph id=\"ph1\">`CDaoDatabase`</ph>.","pos":[18882,19065],"source":"This action creates an underlying DAO relation object, but this is an MFC implementation detail since MFC's encapsulation of relation objects is contained within class `CDaoDatabase`."},{"content":"MFC does not supply a class for relations.","pos":[19066,19108]},{"content":"If you set the relation object's attributes to activate cascade operations, the database engine automatically updates or deletes records in one or more other tables when changes are made to related primary key tables.","pos":[19115,19332]},{"content":"For example, suppose you establish a cascade delete relationship between a Customers table and an Orders table.","pos":[19339,19450]},{"content":"When you delete records from the Customers table, records in the Orders table related to that customer are also deleted.","pos":[19451,19571]},{"content":"In addition, if you establish cascade delete relationships between the Orders table and other tables, records from those tables are automatically deleted when you delete records from the Customers table.","pos":[19572,19775]},{"content":"For related information, see the topic \"CreateRelation Method\" in DAO Help.","pos":[19782,19857]},{"pos":[19912,19940],"content":"CDaoDatabase::DeleteQueryDef"},{"pos":[19944,20073],"content":"Call this member function to delete the specified querydef — saved query — from the <ph id=\"ph1\">`CDaoDatabase`</ph> object's QueryDefs collection.","source":"Call this member function to delete the specified querydef — saved query — from the `CDaoDatabase` object's QueryDefs collection."},{"content":"Parameters","pos":[20137,20147]},{"content":"The name of the saved query to delete.","pos":[20165,20203]},{"content":"Remarks","pos":[20213,20220]},{"content":"Afterwards, that query is no longer defined in the database.","pos":[20224,20284]},{"content":"For information about creating querydef objects, see class <bpt id=\"p1\">[</bpt>CDaoQueryDef<ept id=\"p1\">](../../mfc/reference/cdaoquerydef-class.md)</ept>.","pos":[20291,20408],"source":"For information about creating querydef objects, see class [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)."},{"content":"A querydef object becomes associated with a particular <ph id=\"ph1\">`CDaoDatabase`</ph> object when you construct the <ph id=\"ph2\">`CDaoQueryDef`</ph> object, passing it a pointer to the database object.","pos":[20409,20576],"source":" A querydef object becomes associated with a particular `CDaoDatabase` object when you construct the `CDaoQueryDef` object, passing it a pointer to the database object."},{"pos":[20631,20659],"content":"CDaoDatabase::DeleteRelation"},{"content":"Call this member function to delete an existing relation from the database object's Relations collection.","pos":[20663,20768]},{"content":"Parameters","pos":[20832,20842]},{"content":"The name of the relation to delete.","pos":[20860,20895]},{"content":"Remarks","pos":[20905,20912]},{"content":"Afterwards, the relation no longer exists.","pos":[20916,20958]},{"content":"For related information, see the topic \"Delete Method\" in DAO Help.","pos":[20965,21032]},{"pos":[21087,21115],"content":"CDaoDatabase::DeleteTableDef"},{"pos":[21119,21249],"content":"Call this member function to delete the specified table and all of its data from the <ph id=\"ph1\">`CDaoDatabase`</ph> object's TableDefs collection.","source":"Call this member function to delete the specified table and all of its data from the `CDaoDatabase` object's TableDefs collection."},{"content":"Parameters","pos":[21313,21323]},{"content":"The name of the tabledef to delete.","pos":[21341,21376]},{"content":"Remarks","pos":[21386,21393]},{"content":"Afterwards, that table is no longer defined in the database.","pos":[21397,21457]},{"pos":[21465,21520],"content":"[!NOTE]\n Be very careful not to delete system tables.","leadings":["","> "],"nodes":[{"content":"Be very careful not to delete system tables.","pos":[9,53]}]},{"content":"For information about creating tabledef objects, see class <bpt id=\"p1\">[</bpt>CDaoTableDef<ept id=\"p1\">](../../mfc/reference/cdaotabledef-class.md)</ept>.","pos":[21527,21644],"source":"For information about creating tabledef objects, see class [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)."},{"content":"A tabledef object becomes associated with a particular <ph id=\"ph1\">`CDaoDatabase`</ph> object when you construct the <ph id=\"ph2\">`CDaoTableDef`</ph> object, passing it a pointer to the database object.","pos":[21645,21812],"source":" A tabledef object becomes associated with a particular `CDaoDatabase` object when you construct the `CDaoTableDef` object, passing it a pointer to the database object."},{"content":"For related information, see the topic \"Delete Method\" in DAO Help.","pos":[21819,21886]},{"pos":[21934,21955],"content":"CDaoDatabase::Execute"},{"content":"Call this member function to run an action query or execute a SQL statement on the database.","pos":[21959,22051]},{"content":"Parameters","pos":[22148,22158]},{"content":"Pointer to a null-terminated string containing a valid SQL command to execute.","pos":[22175,22253]},{"content":"An integer that specifies options relating to the integrity of the query.","pos":[22274,22347]},{"content":"You can use the bitwise-OR operator ( <bpt id=\"p1\">**</bpt>&amp;#124;<ept id=\"p1\">**</ept>) to combine any of the following constants (provided the combination makes sense — for example, you would not combine <bpt id=\"p2\">**</bpt>dbInconsistent<ept id=\"p2\">**</ept> with <bpt id=\"p3\">**</bpt>dbConsistent<ept id=\"p3\">**</ept>):","pos":[22348,22557],"source":" You can use the bitwise-OR operator ( **&#124;**) to combine any of the following constants (provided the combination makes sense — for example, you would not combine **dbInconsistent** with **dbConsistent**):"},{"pos":[22565,22618],"content":"<bpt id=\"p1\">**</bpt>dbDenyWrite<ept id=\"p1\">**</ept> Deny write permission to other users.","source":"**dbDenyWrite** Deny write permission to other users."},{"pos":[22626,22676],"content":"<bpt id=\"p1\">**</bpt>dbInconsistent<ept id=\"p1\">**</ept> (Default) Inconsistent updates.","source":"**dbInconsistent** (Default) Inconsistent updates."},{"pos":[22684,22720],"content":"<bpt id=\"p1\">**</bpt>dbConsistent<ept id=\"p1\">**</ept> Consistent updates.","source":"**dbConsistent** Consistent updates."},{"content":"<bpt id=\"p1\">**</bpt>dbSQLPassThrough<ept id=\"p1\">**</ept> SQL pass-through.","pos":[22728,22766],"source":"**dbSQLPassThrough** SQL pass-through."},{"content":"Causes the SQL statement to be passed to an ODBC data source for processing.","pos":[22767,22843]},{"pos":[22851,22906],"content":"<bpt id=\"p1\">**</bpt>dbFailOnError<ept id=\"p1\">**</ept> Roll back updates if an error occurs.","source":"**dbFailOnError** Roll back updates if an error occurs."},{"pos":[22914,23006],"content":"<bpt id=\"p1\">**</bpt>dbSeeChanges<ept id=\"p1\">**</ept> Generate a run-time error if another user is changing data you are editing.","source":"**dbSeeChanges** Generate a run-time error if another user is changing data you are editing."},{"pos":[23014,23222],"content":"[!NOTE]\n If both **dbInconsistent** and **dbConsistent** are included or if neither is included, the result is the default. For an explanation of these constants, see the topic \"Execute Method\" in DAO Help.","leadings":["","> "],"nodes":[{"content":" If both **dbInconsistent** and **dbConsistent** are included or if neither is included, the result is the default. For an explanation of these constants, see the topic \"Execute Method\" in DAO Help.","pos":[8,206],"nodes":[{"content":"If both <bpt id=\"p1\">**</bpt>dbInconsistent<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>dbConsistent<ept id=\"p2\">**</ept> are included or if neither is included, the result is the default.","pos":[1,115],"source":" If both **dbInconsistent** and **dbConsistent** are included or if neither is included, the result is the default."},{"content":"For an explanation of these constants, see the topic \"Execute Method\" in DAO Help.","pos":[116,198]}]}]},{"content":"Remarks","pos":[23232,23239]},{"content":"<bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> works only for action queries or SQL pass-through queries that do not return results.","pos":[23243,23340],"source":"**Execute** works only for action queries or SQL pass-through queries that do not return results."},{"content":"It does not work for select queries, which return records.","pos":[23341,23399]},{"content":"For a definition and information about action queries, see the topics \"Action Query\" and \"Execute Method\" in DAO Help.","pos":[23406,23524]},{"pos":[23532,24153],"content":"[!TIP]\n Given a syntactically correct SQL statement and proper permissions, the **Execute** member function will not fail even if not a single row can be modified or deleted. Therefore, always use the **dbFailOnError** option when using the **Execute** member function to run an update or delete query. This option causes MFC to throw an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md) and rolls back all successful changes if any of the records affected are locked and cannot be updated or deleted. Note that you can always call `GetRecordsAffected` to see how many records were affected.","leadings":["","> "],"nodes":[{"content":" Given a syntactically correct SQL statement and proper permissions, the **Execute** member function will not fail even if not a single row can be modified or deleted. Therefore, always use the **dbFailOnError** option when using the **Execute** member function to run an update or delete query. This option causes MFC to throw an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md) and rolls back all successful changes if any of the records affected are locked and cannot be updated or deleted. Note that you can always call `GetRecordsAffected` to see how many records were affected.","pos":[7,619],"nodes":[{"content":"Given a syntactically correct SQL statement and proper permissions, the <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> member function will not fail even if not a single row can be modified or deleted.","pos":[1,167],"source":" Given a syntactically correct SQL statement and proper permissions, the **Execute** member function will not fail even if not a single row can be modified or deleted."},{"content":"Therefore, always use the <bpt id=\"p1\">**</bpt>dbFailOnError<ept id=\"p1\">**</ept> option when using the <bpt id=\"p2\">**</bpt>Execute<ept id=\"p2\">**</ept> member function to run an update or delete query.","pos":[168,295],"source":" Therefore, always use the **dbFailOnError** option when using the **Execute** member function to run an update or delete query."},{"content":"This option causes MFC to throw an exception of type <bpt id=\"p1\">[</bpt>CDaoException<ept id=\"p1\">](../../mfc/reference/cdaoexception-class.md)</ept> and rolls back all successful changes if any of the records affected are locked and cannot be updated or deleted.","pos":[296,522],"source":" This option causes MFC to throw an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md) and rolls back all successful changes if any of the records affected are locked and cannot be updated or deleted."},{"content":"Note that you can always call <ph id=\"ph1\">`GetRecordsAffected`</ph> to see how many records were affected.","pos":[523,612],"source":" Note that you can always call `GetRecordsAffected` to see how many records were affected."}]}]},{"content":"Call the <bpt id=\"p1\">[</bpt>GetRecordsAffected<ept id=\"p1\">](#cdaodatabase__getrecordsaffected)</ept> member function of the database object to determine the number of records affected by the most recent <bpt id=\"p2\">**</bpt>Execute<ept id=\"p2\">**</ept> call.","pos":[24160,24344],"source":"Call the [GetRecordsAffected](#cdaodatabase__getrecordsaffected) member function of the database object to determine the number of records affected by the most recent **Execute** call."},{"content":"For example, <ph id=\"ph1\">`GetRecordsAffected`</ph> returns information about the number of records deleted, updated, or inserted when executing an action query.","pos":[24345,24488],"source":" For example, `GetRecordsAffected` returns information about the number of records deleted, updated, or inserted when executing an action query."},{"content":"The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.","pos":[24489,24597]},{"content":"<bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> does not return a recordset.","pos":[24604,24644],"source":"**Execute** does not return a recordset."},{"content":"Using <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> on a query that selects records causes MFC to throw an exception of type <ph id=\"ph1\">`CDaoException`</ph>.","pos":[24645,24752],"source":" Using **Execute** on a query that selects records causes MFC to throw an exception of type `CDaoException`."},{"content":"(There is no <ph id=\"ph1\">`ExecuteSQL`</ph> member function analogous to <ph id=\"ph2\">`CDatabase::ExecuteSQL`</ph>.)","pos":[24753,24833],"source":" (There is no `ExecuteSQL` member function analogous to `CDatabase::ExecuteSQL`.)"},{"pos":[24884,24908],"content":"CDaoDatabase::GetConnect"},{"pos":[24912,25042],"content":"Call this member function to retrieve the connection string used to connect the <ph id=\"ph1\">`CDaoDatabase`</ph> object to an ODBC or ISAM database.","source":"Call this member function to retrieve the connection string used to connect the `CDaoDatabase` object to an ODBC or ISAM database."},{"content":"Return Value","pos":[25089,25101]},{"content":"The connection string if <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaodatabase__open)</ept> has been called successfully on an ODBC data source; otherwise, an empty string.","pos":[25105,25238],"source":"The connection string if [Open](#cdaodatabase__open) has been called successfully on an ODBC data source; otherwise, an empty string."},{"content":"For a Microsoft Jet (.MDB) database, the string is always empty unless you set it for use with the <bpt id=\"p1\">**</bpt>dbSQLPassThrough<ept id=\"p1\">**</ept> option used with the <bpt id=\"p2\">[</bpt>Execute<ept id=\"p2\">](#cdaodatabase__execute)</ept> member function or used in opening a recordset.","pos":[25239,25461],"source":" For a Microsoft Jet (.MDB) database, the string is always empty unless you set it for use with the **dbSQLPassThrough** option used with the [Execute](#cdaodatabase__execute) member function or used in opening a recordset."},{"content":"Remarks","pos":[25471,25478]},{"content":"The string provides information about the source of an open database or a database used in a pass-through query.","pos":[25482,25594]},{"content":"The connection string is composed of a database type specifier and zero or more parameters separated by semicolons.","pos":[25595,25710]},{"pos":[25718,25848],"content":"[!NOTE]\n Using the MFC DAO classes to connect to a data source via ODBC is less efficient than connecting via an attached table.","leadings":["","> "],"nodes":[{"content":"Using the MFC DAO classes to connect to a data source via ODBC is less efficient than connecting via an attached table.","pos":[9,128]}]},{"pos":[25856,26183],"content":"[!NOTE]\n The connection string is used to pass additional information to ODBC and certain ISAM drivers as needed. It is not used for .MDB databases. For Microsoft Jet database base tables, the connection string is an empty string (\"\") except when you use it for a SQL pass-through query as described under Return Value above.","leadings":["","> "],"nodes":[{"content":" The connection string is used to pass additional information to ODBC and certain ISAM drivers as needed. It is not used for .MDB databases. For Microsoft Jet database base tables, the connection string is an empty string (\"\") except when you use it for a SQL pass-through query as described under Return Value above.","pos":[8,325],"nodes":[{"content":"The connection string is used to pass additional information to ODBC and certain ISAM drivers as needed.","pos":[1,105]},{"content":"It is not used for .MDB databases.","pos":[106,140]},{"content":"For Microsoft Jet database base tables, the connection string is an empty string (\"\") except when you use it for a SQL pass-through query as described under Return Value above.","pos":[141,317]}]}]},{"content":"See the <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaodatabase__open)</ept> member function for a description of how the connection string is created.","pos":[26190,26300],"source":"See the [Open](#cdaodatabase__open) member function for a description of how the connection string is created."},{"content":"Once the connection string has been set in the <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> call, you can later use it to check the setting to determine the type, path, user ID, Password, or ODBC data source of the database.","pos":[26301,26489],"source":" Once the connection string has been set in the **Open** call, you can later use it to check the setting to determine the type, path, user ID, Password, or ODBC data source of the database."},{"pos":[26537,26558],"content":"CDaoDatabase::GetName"},{"content":"Call this member function to retrieve the name of the currently open database, which is the name of an existing database file or the name of a registered ODBC data source.","pos":[26562,26733]},{"content":"Return Value","pos":[26777,26789]},{"pos":[26793,26932],"content":"The full path and file name of the database if successful; otherwise, an empty <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept>.","source":"The full path and file name of the database if successful; otherwise, an empty [CString](../../atl-mfc-shared/reference/cstringt-class.md)."},{"content":"Remarks","pos":[26942,26949]},{"content":"If your network supports the uniform naming convention (UNC), you can also specify a network path—for example, \"<ph id=\"ph1\">\\\\\\\\\\\\</ph>\\MYSERVER<ph id=\"ph2\">\\\\</ph>\\MYSHARE<ph id=\"ph3\">\\\\</ph>\\MYDIR<ph id=\"ph4\">\\\\</ph>\\MYDB.MDB\".","pos":[26953,27111],"source":"If your network supports the uniform naming convention (UNC), you can also specify a network path—for example, \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB.MDB\"."},{"content":"(Double backslashes are required in string literals because \"<ph id=\"ph1\">\\\\</ph>\" is the C++ escape character.)","pos":[27112,27206],"source":" (Double backslashes are required in string literals because \"\\\\\" is the C++ escape character.)"},{"content":"You might, for example, want to display this name in a heading.","pos":[27213,27276]},{"content":"If an error occurs while the name is being retrieved, MFC throws an exception of type <bpt id=\"p1\">[</bpt>CDaoException<ept id=\"p1\">](../../mfc/reference/cdaoexception-class.md)</ept>.","pos":[27277,27423],"source":" If an error occurs while the name is being retrieved, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md)."},{"pos":[27431,27649],"content":"[!NOTE]\n For better performance when external databases are being accessed, we recommend that you attach external database tables to a Microsoft Jet database (.MDB) rather than connecting directly to the data source.","leadings":["","> "],"nodes":[{"content":"For better performance when external databases are being accessed, we recommend that you attach external database tables to a Microsoft Jet database (.MDB) rather than connecting directly to the data source.","pos":[9,216]}]},{"content":"The database type is indicated by the file or directory that the path points to, as follows:","pos":[27656,27748]},{"content":"Pathname points to..","pos":[27755,27775]},{"content":"Database type","pos":[27776,27789]},{"content":".MDB file","pos":[27845,27854]},{"content":"Microsoft Jet database (Microsoft Access)","pos":[27855,27896]},{"content":"Directory that contains .DBF file(s)","pos":[27901,27937]},{"content":"dBASE database","pos":[27938,27952]},{"content":"Directory that contains .XLS file","pos":[27957,27990]},{"content":"Microsoft Excel database","pos":[27991,28015]},{"content":"Directory that contains .PDX file(s)","pos":[28020,28056]},{"content":"Paradox database","pos":[28057,28073]},{"content":"Directory that contains appropriately formatted text database files","pos":[28078,28145]},{"content":"Text format database","pos":[28146,28166]},{"content":"For ODBC databases such as SQL Server and Oracle, the database's connection string identifies a data source name (DSN) that's registered by ODBC.","pos":[28174,28319]},{"pos":[28376,28406],"content":"CDaoDatabase::GetQueryDefCount"},{"content":"Call this member function to retrieve the number of queries defined in the database's QueryDefs collection.","pos":[28410,28517]},{"content":"Return Value","pos":[28568,28580]},{"content":"The number of queries defined in the database.","pos":[28584,28630]},{"content":"Remarks","pos":[28640,28647]},{"content":"is useful if you need to loop through all querydefs in the QueryDefs collection.","pos":[28670,28750]},{"content":"To obtain information about a given query in the collection, see <bpt id=\"p1\">[</bpt>GetQueryDefInfo<ept id=\"p1\">](#cdaodatabase__getquerydefinfo)</ept>.","pos":[28751,28866],"source":" To obtain information about a given query in the collection, see [GetQueryDefInfo](#cdaodatabase__getquerydefinfo)."},{"pos":[28922,28951],"content":"CDaoDatabase::GetQueryDefInfo"},{"content":"Call this member function to obtain various kinds of information about a query defined in the database.","pos":[28955,29058]},{"content":"Parameters","pos":[29346,29356]},{"content":"The index of the predefined query in the database's QueryDefs collection, for lookup by index.","pos":[29372,29466]},{"content":"querydefinfo","pos":[29474,29486]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoQueryDefInfo<ept id=\"p1\">](../../mfc/reference/cdaoquerydefinfo-structure.md)</ept> object that returns the information requested.","pos":[29491,29624],"source":" A reference to a [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) object that returns the information requested."},{"content":"Options that specify which information about the recordset to retrieve.","pos":[29650,29721]},{"content":"The available options are listed here along with what they cause the function to return about the recordset:","pos":[29722,29830]},{"pos":[29861,29881],"content":"(Default) Name, Type"},{"pos":[29914,30001],"content":"Primary information plus: Date Created, Date of Last Update, Returns Records, Updatable"},{"pos":[30028,30093],"content":"Primary and secondary information plus: SQL, Connect, ODBCTimeout"},{"pos":[30100,30198],"content":"`lpszName`  \nA string containing the name of a query defined in the database, for lookup by name.","leadings":[""," "],"nodes":[{"content":"A string containing the name of a query defined in the database, for lookup by name.","pos":[13,97]}]},{"content":"Remarks","pos":[30208,30215]},{"content":"Two versions of the function are supplied so you can select a query either by index in the database's QueryDefs collection or by the name of the query.","pos":[30219,30370]},{"content":"For a description of the information returned in <bpt id=\"p1\">*</bpt>querydefinfo<ept id=\"p1\">*</ept>, see the <bpt id=\"p2\">[</bpt>CDaoQueryDefInfo<ept id=\"p2\">](../../mfc/reference/cdaoquerydefinfo-structure.md)</ept> structure.","pos":[30377,30530],"source":"For a description of the information returned in *querydefinfo*, see the [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) structure."},{"content":"This structure has members that correspond to the items of information listed above in the description of <ph id=\"ph1\">`dwInfoOptions`</ph>.","pos":[30531,30653],"source":" This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`."},{"content":"If you request one level of information, you get any prior levels of information as well.","pos":[30654,30743]},{"pos":[30799,30828],"content":"CDaoDatabase::GetQueryTimeout"},{"content":"Call this member function to retrieve the current number of seconds to allow before subsequent operations on the connected database are timed out.","pos":[30832,30978]},{"content":"Return Value","pos":[31028,31040]},{"content":"A short integer containing the timeout value in seconds.","pos":[31044,31100]},{"content":"Remarks","pos":[31110,31117]},{"content":"An operation might time out due to network access problems, excessive query processing time, and so on.","pos":[31121,31224]},{"content":"While the setting is in effect, it affects all open, add new, update, and delete operations on any recordsets associated with this <ph id=\"ph1\">`CDaoDatabase`</ph> object.","pos":[31225,31378],"source":" While the setting is in effect, it affects all open, add new, update, and delete operations on any recordsets associated with this `CDaoDatabase` object."},{"content":"You can change the current timeout setting by calling <bpt id=\"p1\">[</bpt>SetQueryTimeout<ept id=\"p1\">](#cdaodatabase__setquerytimeout)</ept>.","pos":[31379,31483],"source":" You can change the current timeout setting by calling [SetQueryTimeout](#cdaodatabase__setquerytimeout)."},{"content":"Changing the query timeout value for a recordset after opening does not change the value for the recordset.","pos":[31484,31591]},{"content":"For example, subsequent <bpt id=\"p1\">[</bpt>Move<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__move)</ept> operations do not use the new value.","pos":[31592,31723],"source":" For example, subsequent [Move](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__move) operations do not use the new value."},{"content":"The default value is initially set when the database engine is initialized.","pos":[31724,31799]},{"content":"The default value for query timeouts is taken from the Windows registry.","pos":[31806,31878]},{"content":"If there is no registry setting, the default is 60 seconds.","pos":[31879,31938]},{"content":"Not all databases support the ability to set a query timeout value.","pos":[31939,32006]},{"content":"If you set a query timeout value of 0, no timeout occurs; and communication with the database may stop responding.","pos":[32007,32121]},{"content":"This behavior may be useful during development.","pos":[32122,32169]},{"content":"If the call fails, MFC throws an exception of type <bpt id=\"p1\">[</bpt>CDaoException<ept id=\"p1\">](../../mfc/reference/cdaoexception-class.md)</ept>.","pos":[32170,32281],"source":" If the call fails, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md)."},{"content":"For related information, see the topic \"QueryTimeout Property\" in DAO Help.","pos":[32288,32363]},{"pos":[32422,32454],"content":"CDaoDatabase::GetRecordsAffected"},{"pos":[32458,32609],"content":"Call this member function to determine the number of records affected by the most recent call of the <bpt id=\"p1\">[</bpt>Execute<ept id=\"p1\">](#cdaodatabase__execute)</ept> member function.","source":"Call this member function to determine the number of records affected by the most recent call of the [Execute](#cdaodatabase__execute) member function."},{"content":"Return Value","pos":[32661,32673]},{"content":"A long integer containing the number of records affected.","pos":[32677,32734]},{"content":"Remarks","pos":[32744,32751]},{"content":"The value returned includes the number of records deleted, updated, or inserted by an action query run with <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept>.","pos":[32755,32875],"source":"The value returned includes the number of records deleted, updated, or inserted by an action query run with **Execute**."},{"content":"The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.","pos":[32876,32984]},{"content":"For related information, see the topic \"RecordsAffected Property\" in DAO Help.","pos":[32991,33069]},{"pos":[33126,33156],"content":"CDaoDatabase::GetRelationCount"},{"content":"Call this member function to obtain the number of relations defined between tables in the database.","pos":[33160,33259]},{"content":"Return Value","pos":[33310,33322]},{"content":"The number of relations defined between tables in the database.","pos":[33326,33389]},{"content":"Remarks","pos":[33399,33406]},{"content":"<bpt id=\"p1\">**</bpt>GetRelationCount<ept id=\"p1\">**</ept> is useful if you need to loop through all defined relations in the database's Relations collection.","pos":[33410,33530],"source":"**GetRelationCount** is useful if you need to loop through all defined relations in the database's Relations collection."},{"content":"To obtain information about a given relation in the collection, see <bpt id=\"p1\">[</bpt>GetRelationInfo<ept id=\"p1\">](#cdaodatabase__getrelationinfo)</ept>.","pos":[33531,33649],"source":" To obtain information about a given relation in the collection, see [GetRelationInfo](#cdaodatabase__getrelationinfo)."},{"content":"To illustrate the concept of a relation, consider a Suppliers table and a Products table, which might have a one-to-many relationship.","pos":[33656,33790]},{"content":"In this relationship, one supplier can supply more than one product.","pos":[33791,33859]},{"content":"Other relations are one-to-one and many-to-many.","pos":[33860,33908]},{"pos":[33964,33993],"content":"CDaoDatabase::GetRelationInfo"},{"content":"Call this member function to obtain information about a specified relation in the database's Relations collection.","pos":[33997,34111]},{"content":"Parameters","pos":[34389,34399]},{"content":"The index of the relation object in the database's Relations collection, for lookup by index.","pos":[34415,34508]},{"content":"relinfo","pos":[34516,34523]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoRelationInfo<ept id=\"p1\">](../../mfc/reference/cdaorelationinfo-structure.md)</ept> object that returns the information requested.","pos":[34528,34661],"source":" A reference to a [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) object that returns the information requested."},{"content":"Options that specify which information about the relation to retrieve.","pos":[34687,34757]},{"content":"The available options are listed here along with what they cause the function to return about the relation:","pos":[34758,34865]},{"pos":[34896,34932],"content":"(Default) Name, Table, Foreign Table"},{"pos":[34965,34994],"content":"Attributes, Field Information"},{"pos":[35001,35185],"content":"The Field Information is a <bpt id=\"p1\">[</bpt>CDaoRelationFieldInfo<ept id=\"p1\">](../../mfc/reference/cdaorelationfieldinfo-structure.md)</ept> object containing the fields from the primary table involved in the relation.","source":"The Field Information is a [CDaoRelationFieldInfo](../../mfc/reference/cdaorelationfieldinfo-structure.md) object containing the fields from the primary table involved in the relation."},{"pos":[35192,35278],"content":"`lpszName`  \nA string containing the name of the relation object, for lookup by name.","leadings":[""," "],"nodes":[{"content":"A string containing the name of the relation object, for lookup by name.","pos":[13,85]}]},{"content":"Remarks","pos":[35288,35295]},{"content":"Two versions of this function provide access either by index or by name.","pos":[35299,35371]},{"content":"For a description of the information returned in <bpt id=\"p1\">*</bpt>relinfo<ept id=\"p1\">*</ept>, see the <bpt id=\"p2\">[</bpt>CDaoRelationInfo<ept id=\"p2\">](../../mfc/reference/cdaorelationinfo-structure.md)</ept> structure.","pos":[35372,35520],"source":" For a description of the information returned in *relinfo*, see the [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) structure."},{"content":"This structure has members that correspond to the items of information listed above in the description of <ph id=\"ph1\">`dwInfoOptions`</ph>.","pos":[35521,35643],"source":" This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`."},{"content":"If you request information at one level, you also get information at any prior levels as well.","pos":[35644,35738]},{"pos":[35746,36489],"content":"[!NOTE]\n If you set the relation object's attributes to activate cascade operations ( **dbRelationUpdateCascades** or **dbRelationDeleteCascades**), the Microsoft Jet database engine automatically updates or deletes records in one or more other tables when changes are made to related primary key tables. For example, suppose you establish a cascade delete relationship between a Customers table and an Orders table. When you delete records from the Customers table, records in the Orders table related to that customer are also deleted. In addition, if you establish cascade delete relationships between the Orders table and other tables, records from those tables are automatically deleted when you delete records from the Customers table.","leadings":["","> "],"nodes":[{"content":" If you set the relation object's attributes to activate cascade operations ( **dbRelationUpdateCascades** or **dbRelationDeleteCascades**), the Microsoft Jet database engine automatically updates or deletes records in one or more other tables when changes are made to related primary key tables. For example, suppose you establish a cascade delete relationship between a Customers table and an Orders table. When you delete records from the Customers table, records in the Orders table related to that customer are also deleted. In addition, if you establish cascade delete relationships between the Orders table and other tables, records from those tables are automatically deleted when you delete records from the Customers table.","pos":[8,741],"nodes":[{"content":"If you set the relation object's attributes to activate cascade operations ( <bpt id=\"p1\">**</bpt>dbRelationUpdateCascades<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>dbRelationDeleteCascades<ept id=\"p2\">**</ept>), the Microsoft Jet database engine automatically updates or deletes records in one or more other tables when changes are made to related primary key tables.","pos":[1,296],"source":" If you set the relation object's attributes to activate cascade operations ( **dbRelationUpdateCascades** or **dbRelationDeleteCascades**), the Microsoft Jet database engine automatically updates or deletes records in one or more other tables when changes are made to related primary key tables."},{"content":"For example, suppose you establish a cascade delete relationship between a Customers table and an Orders table.","pos":[297,408]},{"content":"When you delete records from the Customers table, records in the Orders table related to that customer are also deleted.","pos":[409,529]},{"content":"In addition, if you establish cascade delete relationships between the Orders table and other tables, records from those tables are automatically deleted when you delete records from the Customers table.","pos":[530,733]}]}]},{"pos":[36546,36576],"content":"CDaoDatabase::GetTableDefCount"},{"content":"Call this member function to retrieve the number of tables defined in the database.","pos":[36580,36663]},{"content":"Return Value","pos":[36714,36726]},{"content":"The number of tabledefs defined in the database.","pos":[36730,36778]},{"content":"Remarks","pos":[36788,36795]},{"content":"is useful if you need to loop through all tabledefs in the database's TableDefs collection.","pos":[36818,36909]},{"content":"To obtain information about a given table in the collection, see <bpt id=\"p1\">[</bpt>GetTableDefInfo<ept id=\"p1\">](#cdaodatabase__gettabledefinfo)</ept>.","pos":[36910,37025],"source":" To obtain information about a given table in the collection, see [GetTableDefInfo](#cdaodatabase__gettabledefinfo)."},{"pos":[37081,37110],"content":"CDaoDatabase::GetTableDefInfo"},{"content":"Call this member function to obtain various kinds of information about a table defined in the database.","pos":[37114,37217]},{"content":"Parameters","pos":[37505,37515]},{"content":"The index of the tabledef object in the database's TableDefs collection, for lookup by index.","pos":[37531,37624]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoTableDefInfo<ept id=\"p1\">](../../mfc/reference/cdaotabledefinfo-structure.md)</ept> object that returns the information requested.","pos":[37649,37782],"source":" A reference to a [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) object that returns the information requested."},{"content":"Options that specify which information about the table to retrieve.","pos":[37808,37875]},{"content":"The available options are listed here along with what they cause the function to return about the relation:","pos":[37876,37983]},{"pos":[38014,38051],"content":"(Default) Name, Updatable, Attributes"},{"pos":[38084,38169],"content":"Primary information plus: Date Created, Date Last Updated, Source Table Name, Connect"},{"pos":[38196,38282],"content":"Primary and secondary information plus: Validation Rule, Validation Text, Record Count"},{"pos":[38289,38355],"content":"`lpszName`  \nThe name of the tabledef object, for lookup by name.","leadings":[""," "],"nodes":[{"content":"The name of the tabledef object, for lookup by name.","pos":[13,65]}]},{"content":"Remarks","pos":[38365,38372]},{"content":"Two versions of the function are supplied so you can select a table either by index in the database's TableDefs collection or by the name of the table.","pos":[38376,38527]},{"content":"For a description of the information returned in <ph id=\"ph1\">`tabledefinfo`</ph>, see the <bpt id=\"p1\">[</bpt>CDaoTableDefInfo<ept id=\"p1\">](../../mfc/reference/cdaotabledefinfo-structure.md)</ept> structure.","pos":[38534,38687],"source":"For a description of the information returned in `tabledefinfo`, see the [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) structure."},{"content":"This structure has members that correspond to the items of information listed above in the description of <ph id=\"ph1\">`dwInfoOptions`</ph>.","pos":[38688,38810],"source":" This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`."},{"content":"If you request information at one level, you get information for any prior levels as well.","pos":[38811,38901]},{"pos":[38909,39102],"content":"[!NOTE]\n The `AFX_DAO_ALL_INFO` option provides information that can be slow to obtain. In this case, counting the records in the table could be very time consuming if there are many records.","leadings":["","> "],"nodes":[{"content":" The `AFX_DAO_ALL_INFO` option provides information that can be slow to obtain. In this case, counting the records in the table could be very time consuming if there are many records.","pos":[8,191],"nodes":[{"content":"The <ph id=\"ph1\">`AFX_DAO_ALL_INFO`</ph> option provides information that can be slow to obtain.","pos":[1,79],"source":" The `AFX_DAO_ALL_INFO` option provides information that can be slow to obtain."},{"content":"In this case, counting the records in the table could be very time consuming if there are many records.","pos":[80,183]}]}]},{"pos":[39153,39177],"content":"CDaoDatabase::GetVersion"},{"content":"Call this member function to determine the version of the Microsoft Jet database file.","pos":[39181,39267]},{"content":"Return Value","pos":[39314,39326]},{"pos":[39330,39467],"content":"A <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> that indicates the version of the database file associated with the object.","source":"A [CString](../../atl-mfc-shared/reference/cstringt-class.md) that indicates the version of the database file associated with the object."},{"content":"Remarks","pos":[39477,39484]},{"content":"The value returned represents the version number in the form \"major.minor\"; for example, \"3.0\".","pos":[39488,39583]},{"content":"The product version number (for example, 3.0) consists of the version number (3), a period, and the release number (0).","pos":[39584,39703]},{"content":"The versions to date are 1.0, 1.1, 2.0, and 3.0.","pos":[39704,39752]},{"content":"For related information, see the topic \"Version Property\" in DAO Help.","pos":[39759,39829]},{"pos":[39876,39896],"content":"CDaoDatabase::IsOpen"},{"pos":[39900,40005],"content":"Call this member function to determine whether the <ph id=\"ph1\">`CDaoDatabase`</ph> object is currently open on a database.","source":"Call this member function to determine whether the `CDaoDatabase` object is currently open on a database."},{"content":"Return Value","pos":[40054,40066]},{"pos":[40070,40138],"content":"Nonzero if the <ph id=\"ph1\">`CDaoDatabase`</ph> object is currently open; otherwise 0.","source":"Nonzero if the `CDaoDatabase` object is currently open; otherwise 0."},{"content":"Remarks","pos":[40148,40155]},{"pos":[40210,40238],"content":"CDaoDatabase::m_pDAODatabase"},{"pos":[40242,40347],"content":"Contains a pointer to the OLE interface for the DAO database object underlying the <ph id=\"ph1\">`CDaoDatabase`</ph> object.","source":"Contains a pointer to the OLE interface for the DAO database object underlying the `CDaoDatabase` object."},{"content":"Remarks","pos":[40357,40364]},{"content":"Use this pointer if you need to access the DAO interface directly.","pos":[40368,40434]},{"pos":[40441,40578],"content":"For information about calling DAO directly, see <bpt id=\"p1\">[</bpt>Technical Note 54<ept id=\"p1\">](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)</ept>.","source":"For information about calling DAO directly, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)."},{"pos":[40631,40657],"content":"CDaoDatabase::m_pWorkspace"},{"pos":[40661,40788],"content":"Contains a pointer to the <bpt id=\"p1\">[</bpt>CDaoWorkspace<ept id=\"p1\">](../../mfc/reference/cdaoworkspace-class.md)</ept> object that contains the database object.","source":"Contains a pointer to the [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) object that contains the database object."},{"content":"Remarks","pos":[40798,40805]},{"content":"Use this pointer if you need to access the workspace directly — for example, to obtain pointers to other database objects in the workspace's Databases collection.","pos":[40809,40971]},{"pos":[41016,41034],"content":"CDaoDatabase::Open"},{"pos":[41038,41166],"content":"You must call this member function to initialize a newly constructed <ph id=\"ph1\">`CDaoDatabase`</ph> object that represents an existing database.","source":"You must call this member function to initialize a newly constructed `CDaoDatabase` object that represents an existing database."},{"content":"Parameters","pos":[41332,41342]},{"content":"A string expression that is the name of an existing Microsoft Jet (.MDB) database file.","pos":[41360,41447]},{"content":"If the filename has an extension, it is required.","pos":[41448,41497]},{"content":"If your network supports the uniform naming convention (UNC), you can also specify a network path, such as \"<ph id=\"ph1\">\\\\\\\\\\\\</ph>\\MYSERVER<ph id=\"ph2\">\\\\</ph>\\MYSHARE<ph id=\"ph3\">\\\\</ph>\\MYDIR<ph id=\"ph4\">\\\\</ph>\\MYDB.MDB\".","pos":[41498,41652],"source":" If your network supports the uniform naming convention (UNC), you can also specify a network path, such as \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB.MDB\"."},{"content":"(Double backslashes are required in string literals because \"<ph id=\"ph1\">\\\\</ph>\" is the C++ escape character.)","pos":[41653,41747],"source":" (Double backslashes are required in string literals because \"\\\\\" is the C++ escape character.)"},{"content":"Some considerations apply when using <ph id=\"ph1\">`lpszName`</ph>.","pos":[41754,41802],"source":"Some considerations apply when using `lpszName`."},{"content":"If it:","pos":[41803,41809]},{"content":"Refers to a database that is already open for exclusive access by another user, MFC throws an exception of type <bpt id=\"p1\">[</bpt>CDaoException<ept id=\"p1\">](../../mfc/reference/cdaoexception-class.md)</ept>.","pos":[41819,41991],"source":"Refers to a database that is already open for exclusive access by another user, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md)."},{"content":"Trap that exception to let your user know that the database is unavailable.","pos":[41992,42067]},{"content":"Is an empty string (\"\") and <bpt id=\"p1\">*</bpt>lpszConnect<ept id=\"p1\">*</ept> is \"ODBC;\", a dialog box listing all registered ODBC data source names is displayed so the user can select a database.","pos":[42077,42237],"source":"Is an empty string (\"\") and *lpszConnect* is \"ODBC;\", a dialog box listing all registered ODBC data source names is displayed so the user can select a database."},{"content":"You should avoid direct connections to ODBC data sources; use an attached table instead.","pos":[42238,42326]},{"pos":[42336,42465],"content":"Otherwise does not refer to an existing database or valid ODBC data source name, MFC throws an exception of type <ph id=\"ph1\">`CDaoException`</ph>.","source":"Otherwise does not refer to an existing database or valid ODBC data source name, MFC throws an exception of type `CDaoException`."},{"pos":[42473,42624],"content":"[!NOTE]\n For details about DAO error codes, see the DAOERR.H file. For related information, see the topic \"Trappable Data Access Errors\" in DAO Help.","leadings":["","> "],"nodes":[{"content":" For details about DAO error codes, see the DAOERR.H file. For related information, see the topic \"Trappable Data Access Errors\" in DAO Help.","pos":[8,149],"nodes":[{"content":"For details about DAO error codes, see the DAOERR.H file.","pos":[1,58]},{"content":"For related information, see the topic \"Trappable Data Access Errors\" in DAO Help.","pos":[59,141]}]}]},{"content":"A Boolean value that is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if the database is to be opened for exclusive (nonshared) access and <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> if the database is to be opened for shared access.","pos":[42647,42809],"source":" A Boolean value that is **TRUE** if the database is to be opened for exclusive (nonshared) access and **FALSE** if the database is to be opened for shared access."},{"content":"If you omit this argument, the database is opened for shared access.","pos":[42810,42878]},{"content":"A Boolean value that is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if the database is to be opened for read-only access and <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> if the database is to be opened for read/write access.","pos":[42900,43054],"source":" A Boolean value that is **TRUE** if the database is to be opened for read-only access and **FALSE** if the database is to be opened for read/write access."},{"content":"If you omit this argument, the database is opened for read/write access.","pos":[43055,43127]},{"content":"All dependent recordsets inherit this attribute.","pos":[43128,43176]},{"content":"A string expression used for opening the database.","pos":[43200,43250]},{"content":"This string constitutes the ODBC connect arguments.","pos":[43251,43302]},{"content":"You must supply the exclusive and read-only arguments to supply a source string.","pos":[43303,43383]},{"content":"If the database is a Microsoft Jet database (.MDB), this string is empty (\"\").","pos":[43384,43462]},{"content":"The syntax for the default value — <bpt id=\"p1\">**</bpt>_T<ept id=\"p1\">**</ept>(\"\") — provides portability for Unicode as well as ANSI builds of your application.","pos":[43463,43587],"source":" The syntax for the default value — **_T**(\"\") — provides portability for Unicode as well as ANSI builds of your application."},{"content":"Remarks","pos":[43597,43604]},{"content":"<bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> associates the database with the underlying DAO object.","pos":[43608,43672],"source":"**Open** associates the database with the underlying DAO object."},{"content":"You cannot use the database object to construct recordset, tabledef, or querydef objects until it is initialized.","pos":[43673,43786]},{"content":"<bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> appends the database object to the associated workspace's Databases collection.","pos":[43787,43875],"source":"**Open** appends the database object to the associated workspace's Databases collection."},{"content":"Use the parameters as follows:","pos":[43882,43912]},{"pos":[43922,44174],"content":"If you are opening a Microsoft Jet (.MDB) database, use the <ph id=\"ph1\">`lpszName`</ph> parameter and pass an empty string for the <ph id=\"ph2\">`lpszConnect`</ph> parameter or pass a password string of the form \";PWD=password\" if the database is password-protected (.MDB databases only).","source":"If you are opening a Microsoft Jet (.MDB) database, use the `lpszName` parameter and pass an empty string for the `lpszConnect` parameter or pass a password string of the form \";PWD=password\" if the database is password-protected (.MDB databases only)."},{"pos":[44184,44311],"content":"If you are opening an ODBC data source, pass a valid ODBC connection string in <ph id=\"ph1\">`lpszConnect`</ph> and an empty string in <ph id=\"ph2\">`lpszName`</ph>.","source":"If you are opening an ODBC data source, pass a valid ODBC connection string in `lpszConnect` and an empty string in `lpszName`."},{"content":"For related information, see the topic \"OpenDatabase Method\" in DAO Help.","pos":[44318,44391]},{"pos":[44399,44668],"content":"[!NOTE]\n For better performance when accessing external databases, including ISAM databases and ODBC data sources, it is recommended that you attach external database tables to a Microsoft Jet engine database (.MDB) rather than connecting directly to the data source.","leadings":["","> "],"nodes":[{"content":"For better performance when accessing external databases, including ISAM databases and ODBC data sources, it is recommended that you attach external database tables to a Microsoft Jet engine database (.MDB) rather than connecting directly to the data source.","pos":[9,267]}]},{"content":"It is possible for a connection attempt to time out if, for example, the DBMS host is unavailable.","pos":[44675,44773]},{"content":"If the connection attempt fails, <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> throws an exception of type <bpt id=\"p2\">[</bpt>CDaoException<ept id=\"p2\">](../../mfc/reference/cdaoexception-class.md)</ept>.","pos":[44774,44904],"source":" If the connection attempt fails, **Open** throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md)."},{"content":"The remaining remarks apply only to ODBC databases:","pos":[44911,44962]},{"content":"If the database is an ODBC database and the parameters in your <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> call do not contain enough information to make the connection, the ODBC driver opens a dialog box to obtain the necessary information from the user.","pos":[44969,45189],"source":"If the database is an ODBC database and the parameters in your **Open** call do not contain enough information to make the connection, the ODBC driver opens a dialog box to obtain the necessary information from the user."},{"content":"When you call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>, your connection string, <ph id=\"ph1\">`lpszConnect`</ph>, is stored privately and is available by calling the <bpt id=\"p2\">[</bpt>GetConnect<ept id=\"p2\">](#cdaodatabase__getconnect)</ept> member function.","pos":[45190,45361],"source":" When you call **Open**, your connection string, `lpszConnect`, is stored privately and is available by calling the [GetConnect](#cdaodatabase__getconnect) member function."},{"content":"If you wish, you can open your own dialog box before you call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> to get information from the user, such as a password, then add that information to the connection string you pass to <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","pos":[45368,45565],"source":"If you wish, you can open your own dialog box before you call **Open** to get information from the user, such as a password, then add that information to the connection string you pass to **Open**."},{"content":"Or you might want to save the connection string you pass (perhaps in the Windows registry) so you can reuse it the next time your application calls <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> on a <ph id=\"ph1\">`CDaoDatabase`</ph> object.","pos":[45566,45750],"source":" Or you might want to save the connection string you pass (perhaps in the Windows registry) so you can reuse it the next time your application calls **Open** on a `CDaoDatabase` object."},{"pos":[45757,45933],"content":"You can also use the connection string for multiple levels of login authorization (each for a different <ph id=\"ph1\">`CDaoDatabase`</ph> object) or to convey other database-specific information.","source":"You can also use the connection string for multiple levels of login authorization (each for a different `CDaoDatabase` object) or to convey other database-specific information."},{"pos":[45989,46018],"content":"CDaoDatabase::SetQueryTimeout"},{"content":"Call this member function to override the default number of seconds to allow before subsequent operations on the connected database time out.","pos":[46022,46163]},{"content":"Parameters","pos":[46226,46236]},{"content":"The number of seconds to allow before a query attempt times out.","pos":[46254,46318]},{"content":"Remarks","pos":[46328,46335]},{"content":"An operation might time out because of network access problems, excessive query processing time, and so on.","pos":[46339,46446]},{"content":"Call <ph id=\"ph1\">`SetQueryTimeout`</ph> before opening your recordset or before calling the recordset's <bpt id=\"p1\">[</bpt>AddNew<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__addnew)</ept>, <bpt id=\"p2\">[</bpt>Update<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__update)</ept>, or <bpt id=\"p3\">[</bpt>Delete<ept id=\"p3\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__delete)</ept> member functions if you want to change the query timeout value.","pos":[46447,46827],"source":" Call `SetQueryTimeout` before opening your recordset or before calling the recordset's [AddNew](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__addnew), [Update](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__update), or [Delete](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__delete) member functions if you want to change the query timeout value."},{"content":"The setting affects all subsequent <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__open)</ept>, <ph id=\"ph1\">`AddNew`</ph>, <bpt id=\"p2\">**</bpt>Update<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Delete<ept id=\"p3\">**</ept> calls to any recordsets associated with this <ph id=\"ph2\">`CDaoDatabase`</ph> object.","pos":[46828,47039],"source":" The setting affects all subsequent [Open](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__open), `AddNew`, **Update**, and **Delete** calls to any recordsets associated with this `CDaoDatabase` object."},{"content":"Changing the query timeout value for a recordset after opening does not change the value for the recordset.","pos":[47040,47147]},{"content":"For example, subsequent <bpt id=\"p1\">[</bpt>Move<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__move)</ept> operations do not use the new value.","pos":[47148,47279],"source":" For example, subsequent [Move](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__move) operations do not use the new value."},{"content":"The default value for query timeouts is 60 seconds.","pos":[47286,47337]},{"content":"Not all databases support the ability to set a query timeout value.","pos":[47338,47405]},{"content":"If you set a query timeout value of 0, no timeout occurs; the communication with the database may stop responding.","pos":[47406,47520]},{"content":"This behavior may be useful during development.","pos":[47521,47568]},{"content":"For related information, see the topic \"QueryTimeout Property\" in DAO Help.","pos":[47575,47650]},{"content":"See Also","pos":[47659,47667]},{"content":"CObject Class","pos":[47672,47685]},{"content":"Hierarchy Chart","pos":[47730,47745]},{"content":"CDaoWorkspace Class","pos":[47782,47801]},{"content":"CDaoRecordset Class","pos":[47852,47871]},{"content":"CDaoTableDef Class","pos":[47922,47940]},{"content":"CDaoQueryDef Class","pos":[47990,48008]},{"content":"CDatabase Class","pos":[48058,48073]},{"content":"CDaoException Class","pos":[48120,48139]}],"content":"---\ntitle: \"CDaoDatabase Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDaoDatabase\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"database classes [C++], DAO\"\n  - \"CDaoDatabase class, vs. CDatabase class\"\n  - \"CDaoDatabase class, and workspace\"\n  - \"CDaoDatabase class\"\n  - \"CDatabase class, vs. CDaoDatabase class\"\nms.assetid: 8ff5b342-964d-449d-bef1-d0ff56aadf6d\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDaoDatabase Class\nRepresents a connection to a database through which you can operate on the data.  \n  \n## Syntax  \n  \n```  \nclass CDaoDatabase : public CObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoDatabase::CDaoDatabase](#cdaodatabase__cdaodatabase)|Constructs a `CDaoDatabase` object. Call **Open** to connect the object to a database.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoDatabase::CanTransact](#cdaodatabase__cantransact)|Returns nonzero if the database supports transactions.|  \n|[CDaoDatabase::CanUpdate](#cdaodatabase__canupdate)|Returns nonzero if the `CDaoDatabase` object is updatable (not read-only).|  \n|[CDaoDatabase::Close](#cdaodatabase__close)|Closes the database connection.|  \n|[CDaoDatabase::Create](#cdaodatabase__create)|Creates the underlying DAO database object and initializes the `CDaoDatabase` object.|  \n|[CDaoDatabase::CreateRelation](#cdaodatabase__createrelation)|Defines a new relation among the tables in the database.|  \n|[CDaoDatabase::DeleteQueryDef](#cdaodatabase__deletequerydef)|Deletes a querydef object saved in the database's QueryDefs collection.|  \n|[CDaoDatabase::DeleteRelation](#cdaodatabase__deleterelation)|Deletes an existing relation between tables in the database.|  \n|[CDaoDatabase::DeleteTableDef](#cdaodatabase__deletetabledef)|Deletes the definition of a table in the database. This deletes the actual table and all of its data.|  \n|[CDaoDatabase::Execute](#cdaodatabase__execute)|Executes an action query. Calling **Execute** for a query that returns results throws an exception.|  \n|[CDaoDatabase::GetConnect](#cdaodatabase__getconnect)|Returns the connection string used to connect the `CDaoDatabase` object to a database. Used for ODBC.|  \n|[CDaoDatabase::GetName](#cdaodatabase__getname)|Returns the name of the database currently in use.|  \n|[CDaoDatabase::GetQueryDefCount](#cdaodatabase__getquerydefcount)|Returns the number of queries defined for the database.|  \n|[CDaoDatabase::GetQueryDefInfo](#cdaodatabase__getquerydefinfo)|Returns information about a specified query defined in the database.|  \n|[CDaoDatabase::GetQueryTimeout](#cdaodatabase__getquerytimeout)|Returns the number of seconds after which database query operations will time out. Affects all subsequent open, add new, update, and edit operations and other operations on ODBC data sources (only) such as **Execute** calls.|  \n|[CDaoDatabase::GetRecordsAffected](#cdaodatabase__getrecordsaffected)|Returns the number of records affected by the last update, edit, or add operation or by a call to **Execute**.|  \n|[CDaoDatabase::GetRelationCount](#cdaodatabase__getrelationcount)|Returns the number of relations defined between tables in the database.|  \n|[CDaoDatabase::GetRelationInfo](#cdaodatabase__getrelationinfo)|Returns information about a specified relation defined between tables in the database.|  \n|[CDaoDatabase::GetTableDefCount](#cdaodatabase__gettabledefcount)|Returns the number of tables defined in the database.|  \n|[CDaoDatabase::GetTableDefInfo](#cdaodatabase__gettabledefinfo)|Returns information about a specified table in the database.|  \n|[CDaoDatabase::GetVersion](#cdaodatabase__getversion)|Returns the version of the database engine associated with the database.|  \n|[CDaoDatabase::IsOpen](#cdaodatabase__isopen)|Returns nonzero if the `CDaoDatabase` object is currently connected to a database.|  \n|[CDaoDatabase::Open](#cdaodatabase__open)|Establishes a connection to a database.|  \n|[CDaoDatabase::SetQueryTimeout](#cdaodatabase__setquerytimeout)|Sets the number of seconds after which database query operations (on ODBC data sources only) will time out. Affects all subsequent open, add new, update, and delete operations.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoDatabase::m_pDAODatabase](#cdaodatabase__m_pdaodatabase)|A pointer to the underlying DAO database object.|  \n|[CDaoDatabase::m_pWorkspace](#cdaodatabase__m_pworkspace)|A pointer to the [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) object that contains the database and defines its transaction space.|  \n  \n## Remarks  \n For information about the database formats supported, see the [GetName](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__getname) member function. You can have one or more `CDaoDatabase` objects active at a time in a given \"workspace,\" represented by a [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) object. The workspace maintains a collection of open database objects, called the Databases collection.  \n  \n> [!NOTE]\n>  The MFC DAO database classes are distinct from the MFC database classes based on ODBC. All DAO database class names have the \"CDao\" prefix. Class `CDaoDatabase` supplies an interface similar to that of the ODBC class [CDatabase](../../mfc/reference/cdatabase-class.md). The main difference is that `CDatabase` accesses the DBMS through Open Database Connectivity (ODBC) and an ODBC driver for that DBMS. `CDaoDatabase` accesses data through a Data Access Object (DAO) based on the Microsoft Jet database engine. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC; the DAO-based classes can access data, including through ODBC drivers, via their own database engine. The DAO-based classes also support Data Definition Language (DDL) operations, such as adding tables via the classes, without having to call DAO directly.  \n  \n## Usage  \n You can create database objects implicitly, when you create recordset objects. But you can also create database objects explicitly. To use an existing database explicitly with `CDaoDatabase`, do either of the following:  \n  \n-   Construct a `CDaoDatabase` object, passing a pointer to an open [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) object.  \n  \n-   Or construct a `CDaoDatabase` object without specifying the workspace (MFC creates a temporary workspace object).  \n  \n To create a new Microsoft Jet (.MDB) database, construct a `CDaoDatabase` object and call its [Create](#cdaodatabase__create) member function. Do *not* call **Open** after **Create**.  \n  \n To open an existing database, construct a `CDaoDatabase` object and call its [Open](#cdaodatabase__open) member function.  \n  \n Any of these techniques appends the DAO database object to the workspace's Databases collection and opens a connection to the data. When you then construct [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md), [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md), or [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md) objects for operating on the connected database, pass the constructors for these objects a pointer to your `CDaoDatabase` object. When you finish using the connection, call the [Close](#cdaodatabase__close) member function and destroy the `CDaoDatabase` object. **Close** closes any recordsets you have not closed previously.  \n  \n## Transactions  \n Database transaction processing is supplied at the workspace level — see the [BeginTrans](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__begintrans), [CommitTrans](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__committrans), and [Rollback](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__rollback) member functions of class `CDaoWorkspace`.  \n  \n## ODBC Connections  \n The recommended way to work with ODBC data sources is to attach external tables to a Microsoft Jet (.MDB) database.  \n  \n## Collections  \n Each database maintains its own collections of tabledef, querydef, recordset, and relation objects. Class `CDaoDatabase` supplies member functions for manipulating these objects.  \n  \n> [!NOTE]\n>  The objects are stored in DAO, not in the MFC database object. MFC supplies classes for tabledef, querydef, and recordset objects but not for relation objects.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n `CDaoDatabase`  \n  \n## Requirements  \n **Header:** afxdao.h  \n  \n##  <a name=\"cdaodatabase__cantransact\"></a>  CDaoDatabase::CanTransact  \n Call this member function to determine whether the database allows transactions.  \n  \n```  \nBOOL CanTransact();\n```  \n  \n### Return Value  \n Nonzero if the database supports transactions; otherwise 0.  \n  \n### Remarks  \n Transactions are managed in the database's workspace.  \n  \n##  <a name=\"cdaodatabase__canupdate\"></a>  CDaoDatabase::CanUpdate  \n Call this member function to determine whether the `CDaoDatabase` object allows updates.  \n  \n```  \nBOOL CanUpdate();\n```  \n  \n### Return Value  \n Nonzero if the `CDaoDatabase` object allows updates; otherwise 0, indicating either that you passed **TRUE** in `bReadOnly` when you opened the `CDaoDatabase` object or that the database itself is read-only. See the [Open](#cdaodatabase__open) member function.  \n  \n### Remarks  \n For information about database updatability, see the topic \"Updatable Property\" in DAO Help.  \n  \n##  <a name=\"cdaodatabase__cdaodatabase\"></a>  CDaoDatabase::CDaoDatabase  \n Constructs a `CDaoDatabase` object.  \n  \n```  \nCDaoDatabase(CDaoWorkspace* pWorkspace = NULL);\n```  \n  \n### Parameters  \n *pWorkspace*  \n A pointer to the `CDaoWorkspace` object that will contain the new database object. If you accept the default value of **NULL**, the constructor creates a temporary `CDaoWorkspace` object that uses the default DAO workspace. You can get a pointer to the workspace object via the [m_pWorkspace](#cdaodatabase__m_pworkspace) data member.  \n  \n### Remarks  \n After constructing the object, if you are creating a new Microsoft Jet (.MDB) database, call the object's [Create](#cdaodatabase__create) member function. If you are, instead, opening an existing database, call the object's [Open](#cdaodatabase__open) member function.  \n  \n When you finish with the object, you should call its [Close](#cdaodatabase__close) member function and then destroy the `CDaoDatabase` object.  \n  \n You might find it convenient to embed the `CDaoDatabase` object in your document class.  \n  \n> [!NOTE]\n>  A `CDaoDatabase` object is also created implicitly if you open a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object without passing a pointer to an existing `CDaoDatabase` object. This database object is closed when you close the recordset object.  \n  \n##  <a name=\"cdaodatabase__close\"></a>  CDaoDatabase::Close  \n Call this member function to disconnect from a database and close any open recordsets, tabledefs, and querydefs associated with the database.  \n  \n```  \nvirtual void Close();\n```  \n  \n### Remarks  \n It is good practice to close these objects yourself before you call this member function. Closing a `CDaoDatabase` object removes it from the Databases collection in the associated [workspace](../../mfc/reference/cdaoworkspace-class.md). Because **Close** does not destroy the `CDaoDatabase` object, you can reuse the object by opening the same database or a different database.  \n  \n> [!CAUTION]\n>  Call the [Update](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__update) member function (if there are pending edits) and the **Close** member function on all open recordset objects before you close a database. If you exit a function that declares [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) or `CDaoDatabase` objects on the stack, the database is closed, any unsaved changes are lost, all pending transactions are rolled back, and any pending edits to your data are lost.  \n  \n> [!CAUTION]\n>  If you try to close a database object while any recordset objects are open, or if you try to close a workspace object while any database objects belonging to that specific workspace are open, those recordset objects will be closed and any pending updates or edits will be rolled back. If you try to close a workspace object while any database objects belonging to it are open, the operation closes all database objects belonging to that specific workspace object, which may result in unclosed recordset objects being closed. If you do not close your database object, MFC reports an assertion failure in debug builds.  \n  \n If the database object is defined outside the scope of a function, and you exit the function without closing it, the database object will remain open until explicitly closed or the module in which it is defined is out of scope.  \n  \n##  <a name=\"cdaodatabase__create\"></a>  CDaoDatabase::Create  \n To create a new Microsoft Jet (.MDB) database, call this member function after you construct a `CDaoDatabase` object.  \n  \n```  \nvirtual void Create(\n    LPCTSTR lpszName,  \n    LPCTSTR lpszLocale = dbLangGeneral,  \n    int dwOptions = 0);\n```  \n  \n### Parameters  \n `lpszName`  \n A string expression that is the name of the database file that you are creating. It can be the full path and filename, such as \"C:\\\\\\MYDB.MDB\". You must supply a name. If you do not supply a filename extension, .MDB is appended. If your network supports the uniform naming convention (UNC), you can also specify a network path, such as \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB\". Only Microsoft Jet (.MDB) database files can be created using this member function. (Double backslashes are required in string literals because \"\\\\\" is the C++ escape character.)  \n  \n `lpszLocale`  \n A string expression used to specify collating order for creating the database. The default value is **dbLangGeneral**. Possible values are:  \n  \n- **dbLangGeneral** English, German, French, Portuguese, Italian, and Modern Spanish  \n  \n- **dbLangArabic** Arabic  \n  \n- **dbLangCyrillic** Russian  \n  \n- **dbLangCzech** Czech  \n  \n- **dbLangDutch** Dutch  \n  \n- **dbLangGreek** Greek  \n  \n- **dbLangHebrew** Hebrew  \n  \n- **dbLangHungarian** Hungarian  \n  \n- **dbLangIcelandic** Icelandic  \n  \n- **dbLangNordic** Nordic languages (Microsoft Jet database engine version 1.0 only)  \n  \n- **dbLangNorwdan** Norwegian and Danish  \n  \n- **dbLangPolish** Polish  \n  \n- **dbLangSpanish** Traditional Spanish  \n  \n- **dbLangSwedfin** Swedish and Finnish  \n  \n- **dbLangTurkish** Turkish  \n  \n `dwOptions`  \n An integer that indicates one or more options. Possible values are:  \n  \n- **dbEncrypt** Create an encrypted database.  \n  \n- **dbVersion10** Create a database with Microsoft Jet database version 1.0.  \n  \n- **dbVersion11** Create a database with Microsoft Jet database version 1.1.  \n  \n- **dbVersion20** Create a database with Microsoft Jet database version 2.0.  \n  \n- **dbVersion30** Create a database with Microsoft Jet database version 3.0.  \n  \n If you omit the encryption constant, an unencrypted database is created. You can specify only one version constant. If you omit a version constant, a database that uses the Microsoft Jet database version 3.0 is created.  \n  \n> [!CAUTION]\n>  If a database is not encrypted, it is possible, even if you implement user/password security, to directly read the binary disk file that constitutes the database.  \n  \n### Remarks  \n **Create** creates the database file and the underlying DAO database object and initializes the C++ object. The object is appended to the associated workspace's Databases collection. The database object is in an open state; do not call **Open** after **Create**.  \n  \n> [!NOTE]\n>  With **Create**, you can create only Microsoft Jet (.MDB) databases. You cannot create ISAM databases or ODBC databases.  \n  \n##  <a name=\"cdaodatabase__createrelation\"></a>  CDaoDatabase::CreateRelation  \n Call this member function to establish a relation between one or more fields in a primary table in the database and one or more fields in a foreign table (another table in the database).  \n  \n```  \nvoid CreateRelation(\n    LPCTSTR lpszName,  \n    LPCTSTR lpszTable,  \n    LPCTSTR lpszForeignTable,  \n    long lAttributes,  \n    LPCTSTR lpszField,  \n    LPCTSTR lpszForeignField);\n\n \nvoid CreateRelation(\n    CDaoRelationInfo& relinfo);\n```  \n  \n### Parameters  \n `lpszName`  \n The unique name of the relation object. The name must start with a letter and can contain a maximum of 40 characters. It can include numbers and underscore characters but cannot include punctuation or spaces.  \n  \n `lpszTable`  \n The name of the primary table in the relation. If the table does not exist, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md).  \n  \n `lpszForeignTable`  \n The name of the foreign table in the relation. If the table does not exist, MFC throws an exception of type `CDaoException`.  \n  \n `lAttributes`  \n A long value that contains information about the relationship type. You can use this value to enforce referential integrity, among other things. You can use the bitwise-OR operator ( **&#124;**) to combine any of the following values (as long as the combination makes sense):  \n  \n- **dbRelationUnique** Relationship is one-to-one.  \n  \n- **dbRelationDontEnforce** Relationship is not enforced (no referential integrity).  \n  \n- **dbRelationInherited** Relationship exists in a noncurrent database that contains the two attached tables.  \n  \n- **dbRelationUpdateCascade** Updates will cascade (for more on cascades, see Remarks).  \n  \n- **dbRelationDeleteCascade** Deletions will cascade.  \n  \n *lpszField*  \n A pointer to a null-terminated string containing the name of a field in the primary table (named by `lpszTable`).  \n  \n *lpszForeignField*  \n A pointer to a null-terminated string containing the name of a field in the foreign table (named by `lpszForeignTable`).  \n  \n *relinfo*  \n A reference to a [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) object that contains information about the relation you want to create.  \n  \n### Remarks  \n The relationship cannot involve a query or an attached table from an external database.  \n  \n Use the first version of the function when the relation involves one field in each of the two tables. Use the second version when the relation involves multiple fields. The maximum number of fields in a relation is 14.  \n  \n This action creates an underlying DAO relation object, but this is an MFC implementation detail since MFC's encapsulation of relation objects is contained within class `CDaoDatabase`. MFC does not supply a class for relations.  \n  \n If you set the relation object's attributes to activate cascade operations, the database engine automatically updates or deletes records in one or more other tables when changes are made to related primary key tables.  \n  \n For example, suppose you establish a cascade delete relationship between a Customers table and an Orders table. When you delete records from the Customers table, records in the Orders table related to that customer are also deleted. In addition, if you establish cascade delete relationships between the Orders table and other tables, records from those tables are automatically deleted when you delete records from the Customers table.  \n  \n For related information, see the topic \"CreateRelation Method\" in DAO Help.  \n  \n##  <a name=\"cdaodatabase__deletequerydef\"></a>  CDaoDatabase::DeleteQueryDef  \n Call this member function to delete the specified querydef — saved query — from the `CDaoDatabase` object's QueryDefs collection.  \n  \n```  \nvoid DeleteQueryDef(LPCTSTR lpszName);\n```  \n  \n### Parameters  \n `lpszName`  \n The name of the saved query to delete.  \n  \n### Remarks  \n Afterwards, that query is no longer defined in the database.  \n  \n For information about creating querydef objects, see class [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md). A querydef object becomes associated with a particular `CDaoDatabase` object when you construct the `CDaoQueryDef` object, passing it a pointer to the database object.  \n  \n##  <a name=\"cdaodatabase__deleterelation\"></a>  CDaoDatabase::DeleteRelation  \n Call this member function to delete an existing relation from the database object's Relations collection.  \n  \n```  \nvoid DeleteRelation(LPCTSTR lpszName);\n```  \n  \n### Parameters  \n `lpszName`  \n The name of the relation to delete.  \n  \n### Remarks  \n Afterwards, the relation no longer exists.  \n  \n For related information, see the topic \"Delete Method\" in DAO Help.  \n  \n##  <a name=\"cdaodatabase__deletetabledef\"></a>  CDaoDatabase::DeleteTableDef  \n Call this member function to delete the specified table and all of its data from the `CDaoDatabase` object's TableDefs collection.  \n  \n```  \nvoid DeleteTableDef(LPCTSTR lpszName);\n```  \n  \n### Parameters  \n `lpszName`  \n The name of the tabledef to delete.  \n  \n### Remarks  \n Afterwards, that table is no longer defined in the database.  \n  \n> [!NOTE]\n>  Be very careful not to delete system tables.  \n  \n For information about creating tabledef objects, see class [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md). A tabledef object becomes associated with a particular `CDaoDatabase` object when you construct the `CDaoTableDef` object, passing it a pointer to the database object.  \n  \n For related information, see the topic \"Delete Method\" in DAO Help.  \n  \n##  <a name=\"cdaodatabase__execute\"></a>  CDaoDatabase::Execute  \n Call this member function to run an action query or execute a SQL statement on the database.  \n  \n```  \nvoid Execute(\n    LPCTSTR lpszSQL,  \n    int nOptions = dbFailOnError);\n```  \n  \n### Parameters  \n `lpszSQL`  \n Pointer to a null-terminated string containing a valid SQL command to execute.  \n  \n `nOptions`  \n An integer that specifies options relating to the integrity of the query. You can use the bitwise-OR operator ( **&#124;**) to combine any of the following constants (provided the combination makes sense — for example, you would not combine **dbInconsistent** with **dbConsistent**):  \n  \n- **dbDenyWrite** Deny write permission to other users.  \n  \n- **dbInconsistent** (Default) Inconsistent updates.  \n  \n- **dbConsistent** Consistent updates.  \n  \n- **dbSQLPassThrough** SQL pass-through. Causes the SQL statement to be passed to an ODBC data source for processing.  \n  \n- **dbFailOnError** Roll back updates if an error occurs.  \n  \n- **dbSeeChanges** Generate a run-time error if another user is changing data you are editing.  \n  \n> [!NOTE]\n>  If both **dbInconsistent** and **dbConsistent** are included or if neither is included, the result is the default. For an explanation of these constants, see the topic \"Execute Method\" in DAO Help.  \n  \n### Remarks  \n **Execute** works only for action queries or SQL pass-through queries that do not return results. It does not work for select queries, which return records.  \n  \n For a definition and information about action queries, see the topics \"Action Query\" and \"Execute Method\" in DAO Help.  \n  \n> [!TIP]\n>  Given a syntactically correct SQL statement and proper permissions, the **Execute** member function will not fail even if not a single row can be modified or deleted. Therefore, always use the **dbFailOnError** option when using the **Execute** member function to run an update or delete query. This option causes MFC to throw an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md) and rolls back all successful changes if any of the records affected are locked and cannot be updated or deleted. Note that you can always call `GetRecordsAffected` to see how many records were affected.  \n  \n Call the [GetRecordsAffected](#cdaodatabase__getrecordsaffected) member function of the database object to determine the number of records affected by the most recent **Execute** call. For example, `GetRecordsAffected` returns information about the number of records deleted, updated, or inserted when executing an action query. The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.  \n  \n **Execute** does not return a recordset. Using **Execute** on a query that selects records causes MFC to throw an exception of type `CDaoException`. (There is no `ExecuteSQL` member function analogous to `CDatabase::ExecuteSQL`.)  \n  \n##  <a name=\"cdaodatabase__getconnect\"></a>  CDaoDatabase::GetConnect  \n Call this member function to retrieve the connection string used to connect the `CDaoDatabase` object to an ODBC or ISAM database.  \n  \n```  \nCString GetConnect();\n```  \n  \n### Return Value  \n The connection string if [Open](#cdaodatabase__open) has been called successfully on an ODBC data source; otherwise, an empty string. For a Microsoft Jet (.MDB) database, the string is always empty unless you set it for use with the **dbSQLPassThrough** option used with the [Execute](#cdaodatabase__execute) member function or used in opening a recordset.  \n  \n### Remarks  \n The string provides information about the source of an open database or a database used in a pass-through query. The connection string is composed of a database type specifier and zero or more parameters separated by semicolons.  \n  \n> [!NOTE]\n>  Using the MFC DAO classes to connect to a data source via ODBC is less efficient than connecting via an attached table.  \n  \n> [!NOTE]\n>  The connection string is used to pass additional information to ODBC and certain ISAM drivers as needed. It is not used for .MDB databases. For Microsoft Jet database base tables, the connection string is an empty string (\"\") except when you use it for a SQL pass-through query as described under Return Value above.  \n  \n See the [Open](#cdaodatabase__open) member function for a description of how the connection string is created. Once the connection string has been set in the **Open** call, you can later use it to check the setting to determine the type, path, user ID, Password, or ODBC data source of the database.  \n  \n##  <a name=\"cdaodatabase__getname\"></a>  CDaoDatabase::GetName  \n Call this member function to retrieve the name of the currently open database, which is the name of an existing database file or the name of a registered ODBC data source.  \n  \n```  \nCString GetName();\n```  \n  \n### Return Value  \n The full path and file name of the database if successful; otherwise, an empty [CString](../../atl-mfc-shared/reference/cstringt-class.md).  \n  \n### Remarks  \n If your network supports the uniform naming convention (UNC), you can also specify a network path—for example, \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB.MDB\". (Double backslashes are required in string literals because \"\\\\\" is the C++ escape character.)  \n  \n You might, for example, want to display this name in a heading. If an error occurs while the name is being retrieved, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md).  \n  \n> [!NOTE]\n>  For better performance when external databases are being accessed, we recommend that you attach external database tables to a Microsoft Jet database (.MDB) rather than connecting directly to the data source.  \n  \n The database type is indicated by the file or directory that the path points to, as follows:  \n  \n|Pathname points to..|Database type|  \n|--------------------------|-------------------|  \n|.MDB file|Microsoft Jet database (Microsoft Access)|  \n|Directory that contains .DBF file(s)|dBASE database|  \n|Directory that contains .XLS file|Microsoft Excel database|  \n|Directory that contains .PDX file(s)|Paradox database|  \n|Directory that contains appropriately formatted text database files|Text format database|  \n  \n For ODBC databases such as SQL Server and Oracle, the database's connection string identifies a data source name (DSN) that's registered by ODBC.  \n  \n##  <a name=\"cdaodatabase__getquerydefcount\"></a>  CDaoDatabase::GetQueryDefCount  \n Call this member function to retrieve the number of queries defined in the database's QueryDefs collection.  \n  \n```  \nshort GetQueryDefCount();\n```  \n  \n### Return Value  \n The number of queries defined in the database.  \n  \n### Remarks  \n `GetQueryDefCount` is useful if you need to loop through all querydefs in the QueryDefs collection. To obtain information about a given query in the collection, see [GetQueryDefInfo](#cdaodatabase__getquerydefinfo).  \n  \n##  <a name=\"cdaodatabase__getquerydefinfo\"></a>  CDaoDatabase::GetQueryDefInfo  \n Call this member function to obtain various kinds of information about a query defined in the database.  \n  \n```  \nvoid GetQueryDefInfo(\n    int nIndex,  \n    CDaoQueryDefInfo& querydefinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n\n \nvoid GetQueryDefInfo(\n    LPCTSTR lpszName,  \n    CDaoQueryDefInfo& querydefinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n```  \n  \n### Parameters  \n `nIndex`  \n The index of the predefined query in the database's QueryDefs collection, for lookup by index.  \n  \n *querydefinfo*  \n A reference to a [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) object that returns the information requested.  \n  \n `dwInfoOptions`  \n Options that specify which information about the recordset to retrieve. The available options are listed here along with what they cause the function to return about the recordset:  \n  \n- `AFX_DAO_PRIMARY_INFO` (Default) Name, Type  \n  \n- `AFX_DAO_SECONDARY_INFO` Primary information plus: Date Created, Date of Last Update, Returns Records, Updatable  \n  \n- `AFX_DAO_ALL_INFO` Primary and secondary information plus: SQL, Connect, ODBCTimeout  \n  \n `lpszName`  \n A string containing the name of a query defined in the database, for lookup by name.  \n  \n### Remarks  \n Two versions of the function are supplied so you can select a query either by index in the database's QueryDefs collection or by the name of the query.  \n  \n For a description of the information returned in *querydefinfo*, see the [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) structure. This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`. If you request one level of information, you get any prior levels of information as well.  \n  \n##  <a name=\"cdaodatabase__getquerytimeout\"></a>  CDaoDatabase::GetQueryTimeout  \n Call this member function to retrieve the current number of seconds to allow before subsequent operations on the connected database are timed out.  \n  \n```  \nshort GetQueryTimeout();\n```  \n  \n### Return Value  \n A short integer containing the timeout value in seconds.  \n  \n### Remarks  \n An operation might time out due to network access problems, excessive query processing time, and so on. While the setting is in effect, it affects all open, add new, update, and delete operations on any recordsets associated with this `CDaoDatabase` object. You can change the current timeout setting by calling [SetQueryTimeout](#cdaodatabase__setquerytimeout). Changing the query timeout value for a recordset after opening does not change the value for the recordset. For example, subsequent [Move](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__move) operations do not use the new value. The default value is initially set when the database engine is initialized.  \n  \n The default value for query timeouts is taken from the Windows registry. If there is no registry setting, the default is 60 seconds. Not all databases support the ability to set a query timeout value. If you set a query timeout value of 0, no timeout occurs; and communication with the database may stop responding. This behavior may be useful during development. If the call fails, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md).  \n  \n For related information, see the topic \"QueryTimeout Property\" in DAO Help.  \n  \n##  <a name=\"cdaodatabase__getrecordsaffected\"></a>  CDaoDatabase::GetRecordsAffected  \n Call this member function to determine the number of records affected by the most recent call of the [Execute](#cdaodatabase__execute) member function.  \n  \n```  \nlong GetRecordsAffected();\n```  \n  \n### Return Value  \n A long integer containing the number of records affected.  \n  \n### Remarks  \n The value returned includes the number of records deleted, updated, or inserted by an action query run with **Execute**. The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.  \n  \n For related information, see the topic \"RecordsAffected Property\" in DAO Help.  \n  \n##  <a name=\"cdaodatabase__getrelationcount\"></a>  CDaoDatabase::GetRelationCount  \n Call this member function to obtain the number of relations defined between tables in the database.  \n  \n```  \nshort GetRelationCount();\n```  \n  \n### Return Value  \n The number of relations defined between tables in the database.  \n  \n### Remarks  \n **GetRelationCount** is useful if you need to loop through all defined relations in the database's Relations collection. To obtain information about a given relation in the collection, see [GetRelationInfo](#cdaodatabase__getrelationinfo).  \n  \n To illustrate the concept of a relation, consider a Suppliers table and a Products table, which might have a one-to-many relationship. In this relationship, one supplier can supply more than one product. Other relations are one-to-one and many-to-many.  \n  \n##  <a name=\"cdaodatabase__getrelationinfo\"></a>  CDaoDatabase::GetRelationInfo  \n Call this member function to obtain information about a specified relation in the database's Relations collection.  \n  \n```  \nvoid GetRelationInfo(\n    int nIndex,  \n    CDaoRelationInfo& relinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n\n \nvoid GetRelationInfo(\n    LPCTSTR lpszName,  \n    CDaoRelationInfo& relinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n```  \n  \n### Parameters  \n `nIndex`  \n The index of the relation object in the database's Relations collection, for lookup by index.  \n  \n *relinfo*  \n A reference to a [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) object that returns the information requested.  \n  \n `dwInfoOptions`  \n Options that specify which information about the relation to retrieve. The available options are listed here along with what they cause the function to return about the relation:  \n  \n- `AFX_DAO_PRIMARY_INFO` (Default) Name, Table, Foreign Table  \n  \n- `AFX_DAO_SECONDARY_INFO` Attributes, Field Information  \n  \n The Field Information is a [CDaoRelationFieldInfo](../../mfc/reference/cdaorelationfieldinfo-structure.md) object containing the fields from the primary table involved in the relation.  \n  \n `lpszName`  \n A string containing the name of the relation object, for lookup by name.  \n  \n### Remarks  \n Two versions of this function provide access either by index or by name. For a description of the information returned in *relinfo*, see the [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) structure. This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`. If you request information at one level, you also get information at any prior levels as well.  \n  \n> [!NOTE]\n>  If you set the relation object's attributes to activate cascade operations ( **dbRelationUpdateCascades** or **dbRelationDeleteCascades**), the Microsoft Jet database engine automatically updates or deletes records in one or more other tables when changes are made to related primary key tables. For example, suppose you establish a cascade delete relationship between a Customers table and an Orders table. When you delete records from the Customers table, records in the Orders table related to that customer are also deleted. In addition, if you establish cascade delete relationships between the Orders table and other tables, records from those tables are automatically deleted when you delete records from the Customers table.  \n  \n##  <a name=\"cdaodatabase__gettabledefcount\"></a>  CDaoDatabase::GetTableDefCount  \n Call this member function to retrieve the number of tables defined in the database.  \n  \n```  \nshort GetTableDefCount();\n```  \n  \n### Return Value  \n The number of tabledefs defined in the database.  \n  \n### Remarks  \n `GetTableDefCount` is useful if you need to loop through all tabledefs in the database's TableDefs collection. To obtain information about a given table in the collection, see [GetTableDefInfo](#cdaodatabase__gettabledefinfo).  \n  \n##  <a name=\"cdaodatabase__gettabledefinfo\"></a>  CDaoDatabase::GetTableDefInfo  \n Call this member function to obtain various kinds of information about a table defined in the database.  \n  \n```  \nvoid GetTableDefInfo(\n    int nIndex,  \n    CDaoTableDefInfo& tabledefinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n\n \nvoid GetTableDefInfo(\n    LPCTSTR lpszName,  \n    CDaoTableDefInfo& tabledefinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n```  \n  \n### Parameters  \n `nIndex`  \n The index of the tabledef object in the database's TableDefs collection, for lookup by index.  \n  \n `tabledefinfo`  \n A reference to a [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) object that returns the information requested.  \n  \n `dwInfoOptions`  \n Options that specify which information about the table to retrieve. The available options are listed here along with what they cause the function to return about the relation:  \n  \n- `AFX_DAO_PRIMARY_INFO` (Default) Name, Updatable, Attributes  \n  \n- `AFX_DAO_SECONDARY_INFO` Primary information plus: Date Created, Date Last Updated, Source Table Name, Connect  \n  \n- `AFX_DAO_ALL_INFO` Primary and secondary information plus: Validation Rule, Validation Text, Record Count  \n  \n `lpszName`  \n The name of the tabledef object, for lookup by name.  \n  \n### Remarks  \n Two versions of the function are supplied so you can select a table either by index in the database's TableDefs collection or by the name of the table.  \n  \n For a description of the information returned in `tabledefinfo`, see the [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) structure. This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`. If you request information at one level, you get information for any prior levels as well.  \n  \n> [!NOTE]\n>  The `AFX_DAO_ALL_INFO` option provides information that can be slow to obtain. In this case, counting the records in the table could be very time consuming if there are many records.  \n  \n##  <a name=\"cdaodatabase__getversion\"></a>  CDaoDatabase::GetVersion  \n Call this member function to determine the version of the Microsoft Jet database file.  \n  \n```  \nCString GetVersion();\n```  \n  \n### Return Value  \n A [CString](../../atl-mfc-shared/reference/cstringt-class.md) that indicates the version of the database file associated with the object.  \n  \n### Remarks  \n The value returned represents the version number in the form \"major.minor\"; for example, \"3.0\". The product version number (for example, 3.0) consists of the version number (3), a period, and the release number (0). The versions to date are 1.0, 1.1, 2.0, and 3.0.  \n  \n For related information, see the topic \"Version Property\" in DAO Help.  \n  \n##  <a name=\"cdaodatabase__isopen\"></a>  CDaoDatabase::IsOpen  \n Call this member function to determine whether the `CDaoDatabase` object is currently open on a database.  \n  \n```  \nBOOL IsOpen() const;\n\n \n```  \n  \n### Return Value  \n Nonzero if the `CDaoDatabase` object is currently open; otherwise 0.  \n  \n### Remarks  \n  \n##  <a name=\"cdaodatabase__m_pdaodatabase\"></a>  CDaoDatabase::m_pDAODatabase  \n Contains a pointer to the OLE interface for the DAO database object underlying the `CDaoDatabase` object.  \n  \n### Remarks  \n Use this pointer if you need to access the DAO interface directly.  \n  \n For information about calling DAO directly, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  \n  \n##  <a name=\"cdaodatabase__m_pworkspace\"></a>  CDaoDatabase::m_pWorkspace  \n Contains a pointer to the [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) object that contains the database object.  \n  \n### Remarks  \n Use this pointer if you need to access the workspace directly — for example, to obtain pointers to other database objects in the workspace's Databases collection.  \n  \n##  <a name=\"cdaodatabase__open\"></a>  CDaoDatabase::Open  \n You must call this member function to initialize a newly constructed `CDaoDatabase` object that represents an existing database.  \n  \n```  \nvirtual void Open(\n    LPCTSTR lpszName,  \n    BOOL bExclusive = FALSE,  \n    BOOL bReadOnly = FALSE,  \n    LPCTSTR lpszConnect = _T(\n \"\"));\n```  \n  \n### Parameters  \n `lpszName`  \n A string expression that is the name of an existing Microsoft Jet (.MDB) database file. If the filename has an extension, it is required. If your network supports the uniform naming convention (UNC), you can also specify a network path, such as \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB.MDB\". (Double backslashes are required in string literals because \"\\\\\" is the C++ escape character.)  \n  \n Some considerations apply when using `lpszName`. If it:  \n  \n-   Refers to a database that is already open for exclusive access by another user, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md). Trap that exception to let your user know that the database is unavailable.  \n  \n-   Is an empty string (\"\") and *lpszConnect* is \"ODBC;\", a dialog box listing all registered ODBC data source names is displayed so the user can select a database. You should avoid direct connections to ODBC data sources; use an attached table instead.  \n  \n-   Otherwise does not refer to an existing database or valid ODBC data source name, MFC throws an exception of type `CDaoException`.  \n  \n> [!NOTE]\n>  For details about DAO error codes, see the DAOERR.H file. For related information, see the topic \"Trappable Data Access Errors\" in DAO Help.  \n  \n `bExclusive`  \n A Boolean value that is **TRUE** if the database is to be opened for exclusive (nonshared) access and **FALSE** if the database is to be opened for shared access. If you omit this argument, the database is opened for shared access.  \n  \n `bReadOnly`  \n A Boolean value that is **TRUE** if the database is to be opened for read-only access and **FALSE** if the database is to be opened for read/write access. If you omit this argument, the database is opened for read/write access. All dependent recordsets inherit this attribute.  \n  \n `lpszConnect`  \n A string expression used for opening the database. This string constitutes the ODBC connect arguments. You must supply the exclusive and read-only arguments to supply a source string. If the database is a Microsoft Jet database (.MDB), this string is empty (\"\"). The syntax for the default value — **_T**(\"\") — provides portability for Unicode as well as ANSI builds of your application.  \n  \n### Remarks  \n **Open** associates the database with the underlying DAO object. You cannot use the database object to construct recordset, tabledef, or querydef objects until it is initialized. **Open** appends the database object to the associated workspace's Databases collection.  \n  \n Use the parameters as follows:  \n  \n-   If you are opening a Microsoft Jet (.MDB) database, use the `lpszName` parameter and pass an empty string for the `lpszConnect` parameter or pass a password string of the form \";PWD=password\" if the database is password-protected (.MDB databases only).  \n  \n-   If you are opening an ODBC data source, pass a valid ODBC connection string in `lpszConnect` and an empty string in `lpszName`.  \n  \n For related information, see the topic \"OpenDatabase Method\" in DAO Help.  \n  \n> [!NOTE]\n>  For better performance when accessing external databases, including ISAM databases and ODBC data sources, it is recommended that you attach external database tables to a Microsoft Jet engine database (.MDB) rather than connecting directly to the data source.  \n  \n It is possible for a connection attempt to time out if, for example, the DBMS host is unavailable. If the connection attempt fails, **Open** throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md).  \n  \n The remaining remarks apply only to ODBC databases:  \n  \n If the database is an ODBC database and the parameters in your **Open** call do not contain enough information to make the connection, the ODBC driver opens a dialog box to obtain the necessary information from the user. When you call **Open**, your connection string, `lpszConnect`, is stored privately and is available by calling the [GetConnect](#cdaodatabase__getconnect) member function.  \n  \n If you wish, you can open your own dialog box before you call **Open** to get information from the user, such as a password, then add that information to the connection string you pass to **Open**. Or you might want to save the connection string you pass (perhaps in the Windows registry) so you can reuse it the next time your application calls **Open** on a `CDaoDatabase` object.  \n  \n You can also use the connection string for multiple levels of login authorization (each for a different `CDaoDatabase` object) or to convey other database-specific information.  \n  \n##  <a name=\"cdaodatabase__setquerytimeout\"></a>  CDaoDatabase::SetQueryTimeout  \n Call this member function to override the default number of seconds to allow before subsequent operations on the connected database time out.  \n  \n```  \nvoid SetQueryTimeout(short nSeconds);\n```  \n  \n### Parameters  \n `nSeconds`  \n The number of seconds to allow before a query attempt times out.  \n  \n### Remarks  \n An operation might time out because of network access problems, excessive query processing time, and so on. Call `SetQueryTimeout` before opening your recordset or before calling the recordset's [AddNew](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__addnew), [Update](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__update), or [Delete](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__delete) member functions if you want to change the query timeout value. The setting affects all subsequent [Open](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__open), `AddNew`, **Update**, and **Delete** calls to any recordsets associated with this `CDaoDatabase` object. Changing the query timeout value for a recordset after opening does not change the value for the recordset. For example, subsequent [Move](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__move) operations do not use the new value.  \n  \n The default value for query timeouts is 60 seconds. Not all databases support the ability to set a query timeout value. If you set a query timeout value of 0, no timeout occurs; the communication with the database may stop responding. This behavior may be useful during development.  \n  \n For related information, see the topic \"QueryTimeout Property\" in DAO Help.  \n  \n## See Also  \n [CObject Class](../../mfc/reference/cobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CDaoWorkspace Class](../../mfc/reference/cdaoworkspace-class.md)   \n [CDaoRecordset Class](../../mfc/reference/cdaorecordset-class.md)   \n [CDaoTableDef Class](../../mfc/reference/cdaotabledef-class.md)   \n [CDaoQueryDef Class](../../mfc/reference/cdaoquerydef-class.md)   \n [CDatabase Class](../../mfc/reference/cdatabase-class.md)   \n [CDaoException Class](../../mfc/reference/cdaoexception-class.md)\n"}