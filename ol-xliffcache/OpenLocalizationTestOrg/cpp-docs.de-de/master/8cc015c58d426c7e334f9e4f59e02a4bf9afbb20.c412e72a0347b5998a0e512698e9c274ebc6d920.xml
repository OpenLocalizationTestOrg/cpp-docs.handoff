{"nodes":[{"pos":[12,80],"content":"Record Field Exchange: Working with the Wizard Code | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Record Field Exchange: Working with the Wizard Code | Microsoft Docs","pos":[0,68]}]},{"content":"Record Field Exchange: Working with the Wizard Code","pos":[998,1049]},{"pos":[1050,1292],"content":"This topic explains the code that the MFC Application Wizard and <bpt id=\"p1\">**</bpt>Add Class<ept id=\"p1\">**</ept> (as described in <bpt id=\"p2\">[</bpt>Adding an MFC ODBC Consumer<ept id=\"p2\">](../../mfc/reference/adding-an-mfc-odbc-consumer.md)</ept>) write to support RFX and how you might want to alter that code.","source":"This topic explains the code that the MFC Application Wizard and **Add Class** (as described in [Adding an MFC ODBC Consumer](../../mfc/reference/adding-an-mfc-odbc-consumer.md)) write to support RFX and how you might want to alter that code."},{"pos":[1300,1678],"content":"[!NOTE]\n This topic applies to classes derived from `CRecordset` in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","leadings":["","> "],"nodes":[{"content":" This topic applies to classes derived from `CRecordset` in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","pos":[8,376],"nodes":[{"content":"This topic applies to classes derived from <ph id=\"ph1\">`CRecordset`</ph> in which bulk row fetching has not been implemented.","pos":[1,109],"source":" This topic applies to classes derived from `CRecordset` in which bulk row fetching has not been implemented."},{"content":"If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented.","pos":[110,199]},{"content":"Bulk RFX is similar to RFX.","pos":[200,227]},{"content":"To understand the differences, see <bpt id=\"p1\">[</bpt>Recordset: Fetching Records in Bulk (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)</ept>.","pos":[228,368],"source":" To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)."}]}]},{"pos":[1685,1906],"content":"When you create a recordset class with the MFC Application Wizard or <bpt id=\"p1\">**</bpt>Add Class<ept id=\"p1\">**</ept>, the wizard writes the following RFX-related elements for you, based on the data source, table, and column choices you make in the wizard:","source":"When you create a recordset class with the MFC Application Wizard or **Add Class**, the wizard writes the following RFX-related elements for you, based on the data source, table, and column choices you make in the wizard:"},{"content":"Declarations of the recordset field data members in the recordset class","pos":[1916,1987]},{"pos":[1997,2011],"content":"An override of"},{"content":"Initialization of recordset field data members in the recordset class constructor","pos":[2051,2132]},{"pos":[2198,2228],"content":"Field Data Member Declarations"},{"pos":[2232,2345],"content":"The wizards write a recordset class declaration in an .h file that resembles the following for class <ph id=\"ph1\">`CSections`</ph>:","source":"The wizards write a recordset class declaration in an .h file that resembles the following for class `CSections`:"},{"content":"If you add parameter data members or new field data members that you bind yourself, add them after the wizard-generated ones.","pos":[3119,3244]},{"pos":[3251,3350],"content":"Also, notice that the wizard overrides the <ph id=\"ph1\">`DoFieldExchange`</ph> member function of class <ph id=\"ph2\">`CRecordset`</ph>.","source":"Also, notice that the wizard overrides the `DoFieldExchange` member function of class `CRecordset`."},{"pos":[3410,3434],"content":"DoFieldExchange Override"},{"content":"<bpt id=\"p1\">[</bpt>DoFieldExchange<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange)</ept> is the heart of RFX.","pos":[3439,3546],"source":"[DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) is the heart of RFX."},{"content":"The framework calls <ph id=\"ph1\">`DoFieldExchange`</ph> any time it needs to move data either from data source to recordset or from recordset to data source.","pos":[3547,3686],"source":" The framework calls `DoFieldExchange` any time it needs to move data either from data source to recordset or from recordset to data source."},{"content":"also supports obtaining information about field data members through the <bpt id=\"p1\">[</bpt>IsFieldDirty<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__isfielddirty)</ept> and <bpt id=\"p2\">[</bpt>IsFieldNull<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__isfieldnull)</ept> member functions.","pos":[3705,3959],"source":" also supports obtaining information about field data members through the [IsFieldDirty](../../mfc/reference/crecordset-class.md#crecordset__isfielddirty) and [IsFieldNull](../../mfc/reference/crecordset-class.md#crecordset__isfieldnull) member functions."},{"content":"The following <ph id=\"ph1\">`DoFieldExchange`</ph> override is for the <ph id=\"ph2\">`CSections`</ph> class.","pos":[3966,4036],"source":"The following `DoFieldExchange` override is for the `CSections` class."},{"content":"The wizard writes the function in the .cpp file for your recordset class.","pos":[4037,4110]},{"content":"Notice the following key features of the function:","pos":[4490,4540]},{"content":"This section of the function is called the field map.","pos":[4550,4603]},{"content":"A call to <ph id=\"ph1\">`CFieldExchange::SetFieldType`</ph>, through the <ph id=\"ph2\">`pFX`</ph> pointer.","pos":[4613,4681],"source":"A call to `CFieldExchange::SetFieldType`, through the `pFX` pointer."},{"content":"This call specifies that all RFX function calls up to the end of <ph id=\"ph1\">`DoFieldExchange`</ph> or the next call to <ph id=\"ph2\">`SetFieldType`</ph> are output columns.","pos":[4682,4819],"source":" This call specifies that all RFX function calls up to the end of `DoFieldExchange` or the next call to `SetFieldType` are output columns."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>CFieldExchange::SetFieldType<ept id=\"p1\">](../../mfc/reference/cfieldexchange-class.md#cfieldexchange__setfieldtype)</ept>.","pos":[4820,4951],"source":" For more information, see [CFieldExchange::SetFieldType](../../mfc/reference/cfieldexchange-class.md#cfieldexchange__setfieldtype)."},{"content":"Several calls to the <ph id=\"ph1\">`RFX_Text`</ph> global function — one per field data member (all of which are <ph id=\"ph2\">`CString`</ph> variables in the example).","pos":[4961,5091],"source":"Several calls to the `RFX_Text` global function — one per field data member (all of which are `CString` variables in the example)."},{"content":"These calls specify the relationship between a column name on the data source and a field data member.","pos":[5092,5194]},{"content":"The RFX functions do the actual data transfer.","pos":[5195,5241]},{"content":"The class library supplies RFX functions for all the common data types.","pos":[5242,5313]},{"content":"For more information about RFX functions, see <bpt id=\"p1\">[</bpt>Record Field Exchange: Using the RFX Functions<ept id=\"p1\">](../../data/odbc/record-field-exchange-using-the-rfx-functions.md)</ept>.","pos":[5314,5475],"source":" For more information about RFX functions, see [Record Field Exchange: Using the RFX Functions](../../data/odbc/record-field-exchange-using-the-rfx-functions.md)."},{"pos":[5487,5614],"content":"[!NOTE]\n The order of the columns in your result set must match the order of the RFX function calls in `DoFieldExchange`.","leadings":["","    > "],"nodes":[{"content":"The order of the columns in your result set must match the order of the RFX function calls in <ph id=\"ph1\">`DoFieldExchange`</ph>.","pos":[9,121],"source":" The order of the columns in your result set must match the order of the RFX function calls in `DoFieldExchange`."}]},{"content":"The <ph id=\"ph1\">`pFX`</ph> pointer to a <bpt id=\"p1\">[</bpt>CFieldExchange<ept id=\"p1\">](../../mfc/reference/cfieldexchange-class.md)</ept> object that the framework passes when it calls <ph id=\"ph2\">`DoFieldExchange`</ph>.","pos":[5624,5774],"source":"The `pFX` pointer to a [CFieldExchange](../../mfc/reference/cfieldexchange-class.md) object that the framework passes when it calls `DoFieldExchange`."},{"content":"The <ph id=\"ph1\">`CFieldExchange`</ph> object specifies the operation that <ph id=\"ph2\">`DoFieldExchange`</ph> is to perform, the direction of transfer, and other context information.","pos":[5775,5922],"source":" The `CFieldExchange` object specifies the operation that `DoFieldExchange` is to perform, the direction of transfer, and other context information."},{"pos":[5979,6000],"content":"Recordset Constructor"},{"content":"The recordset constructor that the wizards write contains two things related to RFX:","pos":[6004,6088]},{"content":"An initialization for each field data member","pos":[6098,6142]},{"pos":[6152,6313],"content":"An initialization for the <bpt id=\"p1\">[</bpt>m_nFields<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__m_nfields)</ept> data member, which contains the number of field data members","source":"An initialization for the [m_nFields](../../mfc/reference/crecordset-class.md#crecordset__m_nfields) data member, which contains the number of field data members"},{"pos":[6320,6390],"content":"The constructor for the <ph id=\"ph1\">`CSections`</ph> recordset example looks like this:","source":"The constructor for the `CSections` recordset example looks like this:"},{"pos":[6631,6817],"content":"[!NOTE]\n If you add any field data members manually, as you might if you bind new columns dynamically, you must increment `m_nFields`. Do so by appending another line of code, such as:","leadings":["","> "],"nodes":[{"content":" If you add any field data members manually, as you might if you bind new columns dynamically, you must increment `m_nFields`. Do so by appending another line of code, such as:","pos":[8,184],"nodes":[{"content":"If you add any field data members manually, as you might if you bind new columns dynamically, you must increment <ph id=\"ph1\">`m_nFields`</ph>.","pos":[1,126],"source":" If you add any field data members manually, as you might if you bind new columns dynamically, you must increment `m_nFields`."},{"content":"Do so by appending another line of code, such as:","pos":[127,176]}]}]},{"content":"This is the code for adding three new fields.","pos":[6855,6900]},{"content":"If you add any parameter data members, you must initialize the <bpt id=\"p1\">[</bpt>m_nParams<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__m_nparams)</ept> data member, which contains the number of parameter data members.","pos":[6901,7104],"source":" If you add any parameter data members, you must initialize the [m_nParams](../../mfc/reference/crecordset-class.md#crecordset__m_nparams) data member, which contains the number of parameter data members."},{"content":"Put the <ph id=\"ph1\">`m_nParams`</ph> initialization outside the brackets.","pos":[7105,7161],"source":" Put the `m_nParams` initialization outside the brackets."},{"content":"See Also","pos":[7171,7179]},{"content":"Record Field Exchange (RFX)","pos":[7184,7211]}],"content":"---\ntitle: \"Record Field Exchange: Working with the Wizard Code | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DoFieldExchange method, overriding\"\n  - \"Unicode, with database classes\"\n  - \"field data members, declaring\"\n  - \"RFX (ODBC), wizard code\"\n  - \"RFX (ODBC), implementing\"\n  - \"field data members\"\n  - \"ODBC, RFX\"\n  - \"m_nParams data member, initializing\"\n  - \"m_nFields data member\"\n  - \"m_nParams data member\"\n  - \"overriding, DoFieldExchange\"\n  - \"m_nFields data member, initializing\"\nms.assetid: f00d882a-ff1b-4a75-9717-98d8762bb237\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Record Field Exchange: Working with the Wizard Code\nThis topic explains the code that the MFC Application Wizard and **Add Class** (as described in [Adding an MFC ODBC Consumer](../../mfc/reference/adding-an-mfc-odbc-consumer.md)) write to support RFX and how you might want to alter that code.  \n  \n> [!NOTE]\n>  This topic applies to classes derived from `CRecordset` in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).  \n  \n When you create a recordset class with the MFC Application Wizard or **Add Class**, the wizard writes the following RFX-related elements for you, based on the data source, table, and column choices you make in the wizard:  \n  \n-   Declarations of the recordset field data members in the recordset class  \n  \n-   An override of `CRecordset::DoFieldExchange`  \n  \n-   Initialization of recordset field data members in the recordset class constructor  \n  \n##  <a name=\"_core_the_field_data_member_declarations\"></a> Field Data Member Declarations  \n The wizards write a recordset class declaration in an .h file that resembles the following for class `CSections`:  \n  \n```  \nclass CSections : public CRecordset  \n{  \npublic:  \n   CSections(CDatabase* pDatabase = NULL);  \n   DECLARE_DYNAMIC(CSections)  \n  \n// Field/Param Data  \n   CString   m_strCourseID;  \n   CString   m_strInstructorID;  \n   CString   m_strRoomNo;  \n   CString   m_strSchedule;  \n   CString   m_strSectionNo;  \n  \n// Overrides  \n   // Wizard generated virtual function overrides  \n   protected:  \n   virtual CString GetDefaultConnect();  // Default connection string  \n   virtual CString GetDefaultSQL();      // Default SQL for Recordset  \n   virtual void DoFieldExchange(CFieldExchange* pFX);  // RFX support  \n  \n// Implementation  \n#ifdef _DEBUG  \n   virtual void AssertValid() const;  \n   virtual void Dump(CDumpContext& dc) const;  \n#endif  \n  \n};  \n```  \n  \n If you add parameter data members or new field data members that you bind yourself, add them after the wizard-generated ones.  \n  \n Also, notice that the wizard overrides the `DoFieldExchange` member function of class `CRecordset`.  \n  \n##  <a name=\"_core_the_dofieldexchange_override\"></a> DoFieldExchange Override  \n\n [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) is the heart of RFX. The framework calls `DoFieldExchange` any time it needs to move data either from data source to recordset or from recordset to data source. `DoFieldExchange` also supports obtaining information about field data members through the [IsFieldDirty](../../mfc/reference/crecordset-class.md#crecordset__isfielddirty) and [IsFieldNull](../../mfc/reference/crecordset-class.md#crecordset__isfieldnull) member functions.  \n  \n The following `DoFieldExchange` override is for the `CSections` class. The wizard writes the function in the .cpp file for your recordset class.  \n  \n```  \nvoid CSections::DoFieldExchange(CFieldExchange* pFX)  \n{  \n   pFX->SetFieldType(CFieldExchange::outputColumn);  \n   RFX_Text(pFX, \"CourseID\", m_strCourseID);  \n   RFX_Text(pFX, \"InstructorID\", m_strInstructorID);  \n   RFX_Text(pFX, \"RoomNo\", m_strRoomNo);  \n   RFX_Text(pFX, \"Schedule\", m_strSchedule);  \n   RFX_Text(pFX, \"SectionNo\", m_strSectionNo);  \n}  \n```  \n  \n Notice the following key features of the function:  \n  \n-   This section of the function is called the field map.  \n  \n-   A call to `CFieldExchange::SetFieldType`, through the `pFX` pointer. This call specifies that all RFX function calls up to the end of `DoFieldExchange` or the next call to `SetFieldType` are output columns. For more information, see [CFieldExchange::SetFieldType](../../mfc/reference/cfieldexchange-class.md#cfieldexchange__setfieldtype).  \n  \n-   Several calls to the `RFX_Text` global function — one per field data member (all of which are `CString` variables in the example). These calls specify the relationship between a column name on the data source and a field data member. The RFX functions do the actual data transfer. The class library supplies RFX functions for all the common data types. For more information about RFX functions, see [Record Field Exchange: Using the RFX Functions](../../data/odbc/record-field-exchange-using-the-rfx-functions.md).  \n  \n    > [!NOTE]\n    >  The order of the columns in your result set must match the order of the RFX function calls in `DoFieldExchange`.  \n  \n-   The `pFX` pointer to a [CFieldExchange](../../mfc/reference/cfieldexchange-class.md) object that the framework passes when it calls `DoFieldExchange`. The `CFieldExchange` object specifies the operation that `DoFieldExchange` is to perform, the direction of transfer, and other context information.  \n  \n##  <a name=\"_core_the_recordset_constructor\"></a> Recordset Constructor  \n The recordset constructor that the wizards write contains two things related to RFX:  \n  \n-   An initialization for each field data member  \n  \n-   An initialization for the [m_nFields](../../mfc/reference/crecordset-class.md#crecordset__m_nfields) data member, which contains the number of field data members  \n  \n The constructor for the `CSections` recordset example looks like this:  \n  \n```  \nCSections::CSections(CDatabase* pdb)  \n   : CRecordset(pdb)  \n{  \n   m_strCourseID = \"\";  \n   m_strInstructorID = \"\";  \n   m_strRoomNo = \"\";  \n   m_strSchedule = \"\";  \n   m_strSectionNo = \"\";  \n   m_nFields = 5;  \n}  \n```  \n  \n> [!NOTE]\n>  If you add any field data members manually, as you might if you bind new columns dynamically, you must increment `m_nFields`. Do so by appending another line of code, such as:  \n  \n```  \nm_nFields += 3;  \n```  \n\n This is the code for adding three new fields. If you add any parameter data members, you must initialize the [m_nParams](../../mfc/reference/crecordset-class.md#crecordset__m_nparams) data member, which contains the number of parameter data members. Put the `m_nParams` initialization outside the brackets.  \n\n  \n## See Also  \n [Record Field Exchange (RFX)](../../data/odbc/record-field-exchange-rfx.md)"}