{"nodes":[{"pos":[12,69],"content":"File Menu in an MFC Database Application | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"File Menu in an MFC Database Application | Microsoft Docs","pos":[0,57]}]},{"content":"File Menu in an MFC Database Application","pos":[641,681]},{"content":"If you create an MFC database application and don't use serialization, how should you interpret the Open, Close, Save, and Save As commands on the File menu While there are no style guidelines for this question, here are a few suggestions:","pos":[682,921]},{"content":"Eliminate the File menu's Open command entirely.","pos":[931,979]},{"content":"Interpret the Open command as \"open database\" and show the user a list of data sources your application recognizes.","pos":[989,1104]},{"content":"Interpret the Open command as, perhaps, \"open profile.\"","pos":[1114,1169]},{"content":"Retain Open for opening a serialized file, but use the file to store a serialized document containing \"user profile\" information, such as the user's preferences, including his or her login ID (optionally excluding the password) and the data source he or she most recently worked with.","pos":[1170,1454]},{"content":"The MFC Application Wizard supports creating an application with no document-related File menu commands.","pos":[1461,1565]},{"content":"Select the <bpt id=\"p1\">**</bpt>Database view without file support<ept id=\"p1\">**</ept> option on the <bpt id=\"p2\">**</bpt>Database Support<ept id=\"p2\">**</ept> page.","pos":[1566,1656],"source":" Select the **Database view without file support** option on the **Database Support** page."},{"content":"To interpret a File menu command in a special way, you must override one or more command handlers, mostly in your <ph id=\"ph1\">`CWinApp`</ph>-derived class.","pos":[1663,1801],"source":"To interpret a File menu command in a special way, you must override one or more command handlers, mostly in your `CWinApp`-derived class."},{"content":"For example, if you completely override <ph id=\"ph1\">`OnFileOpen`</ph> (which implements the <ph id=\"ph2\">`ID_FILE_OPEN`</ph> command) to mean \"open database:\"","pos":[1802,1925],"source":" For example, if you completely override `OnFileOpen` (which implements the `ID_FILE_OPEN` command) to mean \"open database:\""},{"pos":[1935,2074],"content":"Don't call the base class version of <ph id=\"ph1\">`OnFileOpen`</ph>, since you're completely replacing the framework's default implementation of the command.","source":"Don't call the base class version of `OnFileOpen`, since you're completely replacing the framework's default implementation of the command."},{"content":"Use the handler instead to display a dialog box listing data sources.","pos":[2084,2153]},{"content":"You can display such a dialog by calling <ph id=\"ph1\">`CDatabase::OpenEx`</ph> or <ph id=\"ph2\">`CDatabase::Open`</ph> with the parameter <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[2154,2264],"source":" You can display such a dialog by calling `CDatabase::OpenEx` or `CDatabase::Open` with the parameter **NULL**."},{"content":"This opens an ODBC dialog box that displays all available data sources on the user's machine.","pos":[2265,2358]},{"content":"Because database applications typically don't save a whole document, you'll probably want to remove the Save and Save As implementations unless you use a serialized document to store profile information.","pos":[2368,2571]},{"content":"Otherwise, you might implement the Save command as, for example, \"commit transaction.\"","pos":[2572,2658]},{"content":"See <bpt id=\"p1\">[</bpt>Technical Note 22<ept id=\"p1\">](../mfc/tn022-standard-commands-implementation.md)</ept> for more information about overriding these commands.","pos":[2659,2786],"source":" See [Technical Note 22](../mfc/tn022-standard-commands-implementation.md) for more information about overriding these commands."},{"content":"See Also","pos":[2795,2803]},{"content":"Serialization: Serialization vs. Database Input/Output","pos":[2808,2862]}],"content":"---\ntitle: \"File Menu in an MFC Database Application | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"File menu\"\n  - \"database applications [C++], File menu commands\"\nms.assetid: 92dafb75-c1b3-4860-80a0-87a83bfc36f2\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# File Menu in an MFC Database Application\nIf you create an MFC database application and don't use serialization, how should you interpret the Open, Close, Save, and Save As commands on the File menu While there are no style guidelines for this question, here are a few suggestions:  \n  \n-   Eliminate the File menu's Open command entirely.  \n  \n-   Interpret the Open command as \"open database\" and show the user a list of data sources your application recognizes.  \n  \n-   Interpret the Open command as, perhaps, \"open profile.\" Retain Open for opening a serialized file, but use the file to store a serialized document containing \"user profile\" information, such as the user's preferences, including his or her login ID (optionally excluding the password) and the data source he or she most recently worked with.  \n  \n The MFC Application Wizard supports creating an application with no document-related File menu commands. Select the **Database view without file support** option on the **Database Support** page.  \n  \n To interpret a File menu command in a special way, you must override one or more command handlers, mostly in your `CWinApp`-derived class. For example, if you completely override `OnFileOpen` (which implements the `ID_FILE_OPEN` command) to mean \"open database:\"  \n  \n-   Don't call the base class version of `OnFileOpen`, since you're completely replacing the framework's default implementation of the command.  \n  \n-   Use the handler instead to display a dialog box listing data sources. You can display such a dialog by calling `CDatabase::OpenEx` or `CDatabase::Open` with the parameter **NULL**. This opens an ODBC dialog box that displays all available data sources on the user's machine.  \n  \n-   Because database applications typically don't save a whole document, you'll probably want to remove the Save and Save As implementations unless you use a serialized document to store profile information. Otherwise, you might implement the Save command as, for example, \"commit transaction.\" See [Technical Note 22](../mfc/tn022-standard-commands-implementation.md) for more information about overriding these commands.  \n  \n## See Also  \n [Serialization: Serialization vs. Database Input/Output](../mfc/serialization-serialization-vs-database-input-output.md)\n\n"}