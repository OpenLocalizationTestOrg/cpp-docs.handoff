{"nodes":[{"pos":[12,46],"content":"CScrollView Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CScrollView Class | Microsoft Docs","pos":[0,34]}]},{"content":"CScrollView Class","pos":[652,669]},{"pos":[670,744],"content":"A <bpt id=\"p1\">[</bpt>CView<ept id=\"p1\">](../../mfc/reference/cview-class.md)</ept> with scrolling capabilities.","source":"A [CView](../../mfc/reference/cview-class.md) with scrolling capabilities."},{"content":"Syntax","pos":[753,759]},{"content":"Members","pos":[818,825]},{"content":"Protected Constructors","pos":[835,857]},{"content":"Name","pos":[864,868]},{"content":"Description","pos":[869,880]},{"content":"CScrollView::CScrollView","pos":[919,943]},{"pos":[972,1006],"content":"Constructs a <ph id=\"ph1\">`CScrollView`</ph> object.","source":"Constructs a `CScrollView` object."},{"content":"Public Methods","pos":[1017,1031]},{"content":"Name","pos":[1038,1042]},{"content":"Description","pos":[1043,1054]},{"content":"CScrollView::CheckScrollBars","pos":[1093,1121]},{"content":"Indicates whether the scroll view has horizontal and vertical scroll bars.","pos":[1154,1228]},{"content":"CScrollView::FillOutsideRect","pos":[1234,1262]},{"content":"Fills the area of a view outside the scrolling area.","pos":[1295,1347]},{"content":"CScrollView::GetDeviceScrollPosition","pos":[1353,1389]},{"content":"Gets the current scroll position in device units.","pos":[1430,1479]},{"content":"CScrollView::GetDeviceScrollSizes","pos":[1485,1518]},{"content":"Gets the current mapping mode, the total size, and the line and page sizes of the scrollable view.","pos":[1556,1654]},{"content":"Sizes are in device units.","pos":[1655,1681]},{"content":"CScrollView::GetScrollPosition","pos":[1687,1717]},{"content":"Gets the current scroll position in logical units.","pos":[1752,1802]},{"content":"CScrollView::GetTotalSize","pos":[1808,1833]},{"content":"Gets the total size of the scroll view in logical units.","pos":[1863,1919]},{"content":"CScrollView::ResizeParentToFit","pos":[1925,1955]},{"content":"Causes the size of the view to dictate the size of its frame.","pos":[1990,2051]},{"content":"CScrollView::ScrollToPosition","pos":[2057,2086]},{"content":"Scrolls the view to a given point, specified in logical units.","pos":[2120,2182]},{"content":"CScrollView::SetScaleToFitSize","pos":[2188,2218]},{"content":"Puts the scroll view into scale-to-fit mode.","pos":[2253,2297]},{"content":"CScrollView::SetScrollSizes","pos":[2303,2330]},{"content":"Sets the scroll view's mapping mode, total size, and horizontal and vertical scroll amounts.","pos":[2362,2454]},{"content":"Remarks","pos":[2464,2471]},{"content":"You can handle standard scrolling yourself in any class derived from <ph id=\"ph1\">`CView`</ph> by overriding the message-mapped <bpt id=\"p1\">[</bpt>OnHScroll<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__onhscroll)</ept> and <bpt id=\"p2\">[</bpt>OnVScroll<ept id=\"p2\">](../../mfc/reference/cwnd-class.md#cwnd__onvscroll)</ept> member functions.","pos":[2475,2732],"source":"You can handle standard scrolling yourself in any class derived from `CView` by overriding the message-mapped [OnHScroll](../../mfc/reference/cwnd-class.md#cwnd__onhscroll) and [OnVScroll](../../mfc/reference/cwnd-class.md#cwnd__onvscroll) member functions."},{"content":"But <ph id=\"ph1\">`CScrollView`</ph> adds the following features to its <ph id=\"ph2\">`CView`</ph> capabilities:","pos":[2733,2807],"source":" But `CScrollView` adds the following features to its `CView` capabilities:"},{"content":"It manages window and viewport sizes and mapping modes.","pos":[2817,2872]},{"content":"It scrolls automatically in response to scroll-bar messages.","pos":[2882,2942]},{"content":"It scrolls automatically in response to messages from the keyboard, a non-scrolling mouse, or the IntelliMouse wheel.","pos":[2952,3069]},{"pos":[3076,3283],"content":"To scroll automatically in response to messages from the keyboard, add a WM_KEYDOWN message, and test for VK_DOWN, VK_PREV and call <bpt id=\"p1\">[</bpt>SetScrollPos<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb787597)</ept>.","source":"To scroll automatically in response to messages from the keyboard, add a WM_KEYDOWN message, and test for VK_DOWN, VK_PREV and call [SetScrollPos](http://msdn.microsoft.com/library/windows/desktop/bb787597)."},{"content":"You can handle mouse wheel scrolling yourself by overriding the message-mapped <bpt id=\"p1\">[</bpt>OnMouseWheel<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__onmousewheel)</ept> and <bpt id=\"p2\">[</bpt>OnRegisteredMouseWheel<ept id=\"p2\">](../../mfc/reference/cwnd-class.md#cwnd__onregisteredmousewheel)</ept> member functions.","pos":[3290,3548],"source":"You can handle mouse wheel scrolling yourself by overriding the message-mapped [OnMouseWheel](../../mfc/reference/cwnd-class.md#cwnd__onmousewheel) and [OnRegisteredMouseWheel](../../mfc/reference/cwnd-class.md#cwnd__onregisteredmousewheel) member functions."},{"content":"As they are for <ph id=\"ph1\">`CScrollView`</ph>, these member functions support the recommended behaviour for <bpt id=\"p1\">[</bpt>WM_MOUSEWHEEL<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms645617)</ept>, the wheel rotation message.","pos":[3549,3745],"source":" As they are for `CScrollView`, these member functions support the recommended behaviour for [WM_MOUSEWHEEL](http://msdn.microsoft.com/library/windows/desktop/ms645617), the wheel rotation message."},{"content":"To take advantage of automatic scrolling, derive your view class from <ph id=\"ph1\">`CScrollView`</ph> instead of from <ph id=\"ph2\">`CView`</ph>.","pos":[3752,3860],"source":"To take advantage of automatic scrolling, derive your view class from `CScrollView` instead of from `CView`."},{"content":"When the view is first created, if you want to calculate the size of the scrollable view based on the size of the document, call the <ph id=\"ph1\">`SetScrollSizes`</ph> member function from your override of either <bpt id=\"p1\">[</bpt>CView::OnInitialUpdate<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__oninitialupdate)</ept> or <bpt id=\"p2\">[</bpt>CView::OnUpdate<ept id=\"p2\">](../../mfc/reference/cview-class.md#cview__onupdate)</ept>.","pos":[3861,4213],"source":" When the view is first created, if you want to calculate the size of the scrollable view based on the size of the document, call the `SetScrollSizes` member function from your override of either [CView::OnInitialUpdate](../../mfc/reference/cview-class.md#cview__oninitialupdate) or [CView::OnUpdate](../../mfc/reference/cview-class.md#cview__onupdate)."},{"content":"(You must write your own code to query the size of the document.","pos":[4214,4278]},{"content":"For an example, see the <bpt id=\"p1\">[</bpt>Scribble sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.)","pos":[4279,4351],"source":" For an example, see the [Scribble sample](../../visual-cpp-samples.md).)"},{"content":"The call to the <ph id=\"ph1\">`SetScrollSizes`</ph> member function sets the view's mapping mode, the total dimensions of the scroll view, and the amounts to scroll horizontally and vertically.","pos":[4358,4532],"source":"The call to the `SetScrollSizes` member function sets the view's mapping mode, the total dimensions of the scroll view, and the amounts to scroll horizontally and vertically."},{"content":"All sizes are in logical units.","pos":[4533,4564]},{"content":"The logical size of the view is usually calculated from data stored in the document, but in some cases you may want to specify a fixed size.","pos":[4565,4705]},{"content":"For examples of both approaches, see <bpt id=\"p1\">[</bpt>CScrollView::SetScrollSizes<ept id=\"p1\">](#cscrollview__setscrollsizes)</ept>.","pos":[4706,4803],"source":" For examples of both approaches, see [CScrollView::SetScrollSizes](#cscrollview__setscrollsizes)."},{"content":"You specify the amounts to scroll horizontally and vertically in logical units.","pos":[4810,4889]},{"content":"By default, if the user clicks a scroll bar shaft outside of the scroll box, <ph id=\"ph1\">`CScrollView`</ph> scrolls a \"page.\"","pos":[4890,4998],"source":" By default, if the user clicks a scroll bar shaft outside of the scroll box, `CScrollView` scrolls a \"page.\""},{"content":"If the user clicks a scroll arrow at either end of a scroll bar, <ph id=\"ph1\">`CScrollView`</ph> scrolls a \"line.\"","pos":[4999,5095],"source":" If the user clicks a scroll arrow at either end of a scroll bar, `CScrollView` scrolls a \"line.\""},{"content":"By default, a page is 1/10 of the total size of the view; a line is 1/10 of the page size.","pos":[5096,5186]},{"content":"Override these default values by passing custom sizes in the <ph id=\"ph1\">`SetScrollSizes`</ph> member function.","pos":[5187,5281],"source":" Override these default values by passing custom sizes in the `SetScrollSizes` member function."},{"content":"For example, you might set the horizontal size to some fraction of the width of the total size and the vertical size to the height of a line in the current font.","pos":[5282,5443]},{"content":"Instead of scrolling, <ph id=\"ph1\">`CScrollView`</ph> can automatically scale the view to the current window size.","pos":[5450,5546],"source":"Instead of scrolling, `CScrollView` can automatically scale the view to the current window size."},{"content":"In this mode, the view has no scroll bars and the logical view is stretched or shrunk to exactly fit the window's client area.","pos":[5547,5673]},{"content":"To use this scale-to-fit capability, call <bpt id=\"p1\">[</bpt>CScrollView::SetScaleToFitSize<ept id=\"p1\">](#cscrollview__setscaletofitsize)</ept>.","pos":[5674,5782],"source":" To use this scale-to-fit capability, call [CScrollView::SetScaleToFitSize](#cscrollview__setscaletofitsize)."},{"content":"(Call either <ph id=\"ph1\">`SetScaleToFitSize`</ph> or <ph id=\"ph2\">`SetScrollSizes`</ph>, but not both.)","pos":[5783,5851],"source":" (Call either `SetScaleToFitSize` or `SetScrollSizes`, but not both.)"},{"pos":[5858,6056],"content":"Before the <ph id=\"ph1\">`OnDraw`</ph> member function of your derived view class is called, <ph id=\"ph2\">`CScrollView`</ph> automatically adjusts the viewport origin for the <ph id=\"ph3\">`CPaintDC`</ph> device-context object that it passes to <ph id=\"ph4\">`OnDraw`</ph>.","source":"Before the `OnDraw` member function of your derived view class is called, `CScrollView` automatically adjusts the viewport origin for the `CPaintDC` device-context object that it passes to `OnDraw`."},{"content":"To adjust the viewport origin for the scrolling window, <ph id=\"ph1\">`CScrollView`</ph> overrides <bpt id=\"p1\">[</bpt>CView::OnPrepareDC<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__onpreparedc)</ept>.","pos":[6063,6219],"source":"To adjust the viewport origin for the scrolling window, `CScrollView` overrides [CView::OnPrepareDC](../../mfc/reference/cview-class.md#cview__onpreparedc)."},{"content":"This adjustment is automatic for the <ph id=\"ph1\">`CPaintDC`</ph> device context that <ph id=\"ph2\">`CScrollView`</ph> passes to <ph id=\"ph3\">`OnDraw`</ph>, but you must call <bpt id=\"p1\">**</bpt>CScrollView::OnPrepareDC<ept id=\"p1\">**</ept> yourself for any other device contexts you use, such as a <ph id=\"ph4\">`CClientDC`</ph>.","pos":[6220,6439],"source":" This adjustment is automatic for the `CPaintDC` device context that `CScrollView` passes to `OnDraw`, but you must call **CScrollView::OnPrepareDC** yourself for any other device contexts you use, such as a `CClientDC`."},{"content":"You can override <bpt id=\"p1\">**</bpt>CScrollView::OnPrepareDC<ept id=\"p1\">**</ept> to set the pen, background color, and other drawing attributes, but call the base class to do scaling.","pos":[6440,6588],"source":" You can override **CScrollView::OnPrepareDC** to set the pen, background color, and other drawing attributes, but call the base class to do scaling."},{"content":"Scroll bars can appear in three places relative to a view, as shown in the following cases:","pos":[6595,6686]},{"pos":[6696,6852],"content":"Standard window-style scroll bars can be set for the view using the <bpt id=\"p1\">**</bpt>WS_HSCROLL<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>WS_VSCROLL<ept id=\"p2\">**</ept><bpt id=\"p3\">[</bpt>Windows Styles<ept id=\"p3\">](../../mfc/reference/window-styles.md)</ept>.","source":"Standard window-style scroll bars can be set for the view using the **WS_HSCROLL** and **WS_VSCROLL**[Windows Styles](../../mfc/reference/window-styles.md)."},{"pos":[6862,7061],"content":"Scroll-bar controls can also be added to the frame containing the view, in which case the framework forwards <ph id=\"ph1\">`WM_HSCROLL`</ph> and <ph id=\"ph2\">`WM_VSCROLL`</ph> messages from the frame window to the currently active view.","source":"Scroll-bar controls can also be added to the frame containing the view, in which case the framework forwards `WM_HSCROLL` and `WM_VSCROLL` messages from the frame window to the currently active view."},{"content":"The framework also forwards scroll messages from a <ph id=\"ph1\">`CSplitterWnd`</ph> splitter control to the currently active splitter pane (a view).","pos":[7071,7201],"source":"The framework also forwards scroll messages from a `CSplitterWnd` splitter control to the currently active splitter pane (a view)."},{"content":"When placed in a <bpt id=\"p1\">[</bpt>CSplitterWnd<ept id=\"p1\">](../../mfc/reference/csplitterwnd-class.md)</ept> with shared scroll bars, a <ph id=\"ph1\">`CScrollView`</ph> object will use the shared ones rather than creating its own.","pos":[7202,7379],"source":" When placed in a [CSplitterWnd](../../mfc/reference/csplitterwnd-class.md) with shared scroll bars, a `CScrollView` object will use the shared ones rather than creating its own."},{"pos":[7386,7601],"content":"For more information on using <ph id=\"ph1\">`CScrollView`</ph>, see <bpt id=\"p1\">[</bpt>Document/View Architecture<ept id=\"p1\">](../../mfc/document-view-architecture.md)</ept> and <bpt id=\"p2\">[</bpt>Derived View Classes Available in MFC<ept id=\"p2\">](../../mfc/derived-view-classes-available-in-mfc.md)</ept>.","source":"For more information on using `CScrollView`, see [Document/View Architecture](../../mfc/document-view-architecture.md) and [Derived View Classes Available in MFC](../../mfc/derived-view-classes-available-in-mfc.md)."},{"content":"Inheritance Hierarchy","pos":[7610,7631]},{"content":"CObject","pos":[7636,7643]},{"content":"CCmdTarget","pos":[7690,7700]},{"content":"CWnd","pos":[7750,7754]},{"content":"CView","pos":[7798,7803]},{"content":"Requirements","pos":[7869,7881]},{"pos":[7885,7905],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxwin.h","source":"**Header:** afxwin.h"},{"pos":[7960,7988],"content":"CScrollView::CheckScrollBars"},{"content":"Call this member function to determine if the scroll view has horizontal and vertical bars.","pos":[7992,8083]},{"content":"Parameters","pos":[8188,8198]},{"content":"bHasHorzBar","pos":[8203,8214]},{"content":"Indicates the application has a horizontal scroll bar.","pos":[8219,8273]},{"content":"bHasVertBar","pos":[8281,8292]},{"content":"Indicates the application has a vertical scroll bar.","pos":[8297,8349]},{"pos":[8400,8424],"content":"CScrollView::CScrollView"},{"pos":[8428,8462],"content":"Constructs a <ph id=\"ph1\">`CScrollView`</ph> object.","source":"Constructs a `CScrollView` object."},{"content":"Remarks","pos":[8502,8509]},{"pos":[8513,8607],"content":"You must call either <ph id=\"ph1\">`SetScrollSizes`</ph> or <ph id=\"ph2\">`SetScaleToFitSize`</ph> before the scroll view is usable.","source":"You must call either `SetScrollSizes` or `SetScaleToFitSize` before the scroll view is usable."},{"pos":[8662,8690],"content":"CScrollView::FillOutsideRect"},{"pos":[8694,8789],"content":"Call <ph id=\"ph1\">`FillOutsideRect`</ph> to fill the area of the view that appears outside of the scrolling area.","source":"Call `FillOutsideRect` to fill the area of the view that appears outside of the scrolling area."},{"content":"Parameters","pos":[8873,8883]},{"content":"Device context in which the filling is to be done.","pos":[8896,8946]},{"content":"Brush with which the area is to be filled.","pos":[8965,9007]},{"content":"Remarks","pos":[9017,9024]},{"pos":[9028,9147],"content":"Use <ph id=\"ph1\">`FillOutsideRect`</ph> in your scroll view's <ph id=\"ph2\">`OnEraseBkgnd`</ph> handler function to prevent excessive background repainting.","source":"Use `FillOutsideRect` in your scroll view's `OnEraseBkgnd` handler function to prevent excessive background repainting."},{"content":"Example","pos":[9157,9164]},{"pos":[9179,9197],"content":"NVC_MFCDocView#164"},{"pos":[9313,9349],"content":"CScrollView::GetDeviceScrollPosition"},{"pos":[9353,9483],"content":"Call <ph id=\"ph1\">`GetDeviceScrollPosition`</ph> when you need the current horizontal and vertical positions of the scroll boxes in the scroll bars.","source":"Call `GetDeviceScrollPosition` when you need the current horizontal and vertical positions of the scroll boxes in the scroll bars."},{"content":"Return Value","pos":[9551,9563]},{"pos":[9567,9664],"content":"The horizontal and vertical positions (in device units) of the scroll boxes as a <ph id=\"ph1\">`CPoint`</ph> object.","source":"The horizontal and vertical positions (in device units) of the scroll boxes as a `CPoint` object."},{"content":"Remarks","pos":[9674,9681]},{"content":"This coordinate pair corresponds to the location in the document to which the upper-left corner of the view has been scrolled.","pos":[9685,9811]},{"content":"This is useful for offsetting mouse-device positions to scroll-view device positions.","pos":[9812,9897]},{"content":"returns values in device units.","pos":[9930,9961]},{"content":"If you want logical units, use <ph id=\"ph1\">`GetScrollPosition`</ph> instead.","pos":[9962,10021],"source":" If you want logical units, use `GetScrollPosition` instead."},{"pos":[10081,10114],"content":"CScrollView::GetDeviceScrollSizes"},{"pos":[10141,10239],"content":"gets the current mapping mode, the total size, and the line and page sizes of the scrollable view."},{"content":"Parameters","pos":[10387,10397]},{"content":"Returns the current mapping mode for this view.","pos":[10415,10462]},{"content":"For a list of possible values, see <ph id=\"ph1\">`SetScrollSizes`</ph>.","pos":[10463,10515],"source":" For a list of possible values, see `SetScrollSizes`."},{"content":"Returns the current total size of the scroll view in device units.","pos":[10537,10603]},{"content":"Returns the current horizontal and vertical amounts to scroll in each direction in response to a mouse click in a scroll-bar shaft.","pos":[10624,10755]},{"content":"The <bpt id=\"p1\">**</bpt>cx<ept id=\"p1\">**</ept> member contains the horizontal amount.","pos":[10756,10805],"source":" The **cx** member contains the horizontal amount."},{"content":"The <bpt id=\"p1\">**</bpt>cy<ept id=\"p1\">**</ept> member contains the vertical amount.","pos":[10806,10853],"source":" The **cy** member contains the vertical amount."},{"content":"Returns the current horizontal and vertical amounts to scroll in each direction in response to a mouse click in a scroll arrow.","pos":[10874,11001]},{"content":"The <bpt id=\"p1\">**</bpt>cx<ept id=\"p1\">**</ept> member contains the horizontal amount.","pos":[11002,11051],"source":" The **cx** member contains the horizontal amount."},{"content":"The <bpt id=\"p1\">**</bpt>cy<ept id=\"p1\">**</ept> member contains the vertical amount.","pos":[11052,11099],"source":" The **cy** member contains the vertical amount."},{"content":"Remarks","pos":[11109,11116]},{"content":"Sizes are in device units.","pos":[11120,11146]},{"content":"This member function is rarely called.","pos":[11147,11185]},{"pos":[11242,11272],"content":"CScrollView::GetScrollPosition"},{"pos":[11276,11400],"content":"Call <ph id=\"ph1\">`GetScrollPosition`</ph> when you need the current horizontal and vertical positions of the scroll boxes in the scroll bars.","source":"Call `GetScrollPosition` when you need the current horizontal and vertical positions of the scroll boxes in the scroll bars."},{"content":"Return Value","pos":[11462,11474]},{"pos":[11478,11576],"content":"The horizontal and vertical positions (in logical units) of the scroll boxes as a <ph id=\"ph1\">`CPoint`</ph> object.","source":"The horizontal and vertical positions (in logical units) of the scroll boxes as a `CPoint` object."},{"content":"Remarks","pos":[11586,11593]},{"content":"This coordinate pair corresponds to the location in the document to which the upper-left corner of the view has been scrolled.","pos":[11597,11723]},{"content":"returns values in logical units.","pos":[11750,11782]},{"content":"If you want device units, use <ph id=\"ph1\">`GetDeviceScrollPosition`</ph> instead.","pos":[11783,11847],"source":" If you want device units, use `GetDeviceScrollPosition` instead."},{"pos":[11899,11924],"content":"CScrollView::GetTotalSize"},{"pos":[11928,12021],"content":"Call <ph id=\"ph1\">`GetTotalSize`</ph> to retrieve the current horizontal and vertical sizes of the scroll view.","source":"Call `GetTotalSize` to retrieve the current horizontal and vertical sizes of the scroll view."},{"content":"Return Value","pos":[12077,12089]},{"content":"The total size of the scroll view in logical units.","pos":[12093,12144]},{"content":"The horizontal size is in the <bpt id=\"p1\">**</bpt>cx<ept id=\"p1\">**</ept> member of the <ph id=\"ph1\">`CSize`</ph> return value.","pos":[12145,12217],"source":" The horizontal size is in the **cx** member of the `CSize` return value."},{"content":"The vertical size is in the <bpt id=\"p1\">**</bpt>cy<ept id=\"p1\">**</ept> member.","pos":[12218,12260],"source":" The vertical size is in the **cy** member."},{"pos":[12317,12347],"content":"CScrollView::ResizeParentToFit"},{"pos":[12351,12442],"content":"Call <ph id=\"ph1\">`ResizeParentToFit`</ph> to let the size of your view dictate the size of its frame window.","source":"Call `ResizeParentToFit` to let the size of your view dictate the size of its frame window."},{"content":"Parameters","pos":[12516,12526]},{"content":"bShrinkOnly","pos":[12531,12542]},{"content":"The kind of resizing to perform.","pos":[12547,12579]},{"content":"The default value, <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, shrinks the frame window if appropriate.","pos":[12580,12649],"source":" The default value, **TRUE**, shrinks the frame window if appropriate."},{"content":"Scroll bars will still appear for large views or small frame windows.","pos":[12650,12719]},{"content":"A value of <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> causes the view always to resize the frame window exactly.","pos":[12720,12799],"source":" A value of **FALSE** causes the view always to resize the frame window exactly."},{"content":"This can be somewhat dangerous since the frame window could get too big to fit inside the multiple document interface (MDI) frame window or the screen.","pos":[12800,12951]},{"content":"Remarks","pos":[12961,12968]},{"content":"This is recommended only for views in MDI child frame windows.","pos":[12972,13034]},{"content":"Use <ph id=\"ph1\">`ResizeParentToFit`</ph> in the <ph id=\"ph2\">`OnInitialUpdate`</ph> handler function of your derived <ph id=\"ph3\">`CScrollView`</ph> class.","pos":[13035,13137],"source":" Use `ResizeParentToFit` in the `OnInitialUpdate` handler function of your derived `CScrollView` class."},{"content":"For an example of this member function, see <bpt id=\"p1\">[</bpt>CScrollView::SetScrollSizes<ept id=\"p1\">](#cscrollview__setscrollsizes)</ept>.","pos":[13138,13242],"source":" For an example of this member function, see [CScrollView::SetScrollSizes](#cscrollview__setscrollsizes)."},{"content":"assumes that the size of the view window has been set.","pos":[13269,13323]},{"content":"If the view window size has not been set when <ph id=\"ph1\">`ResizeParentToFit`</ph> is called, you will get an assertion.","pos":[13324,13427],"source":" If the view window size has not been set when `ResizeParentToFit` is called, you will get an assertion."},{"content":"To ensure that this does not happen, make the following call before calling <ph id=\"ph1\">`ResizeParentToFit`</ph>:","pos":[13428,13524],"source":" To ensure that this does not happen, make the following call before calling `ResizeParentToFit`:"},{"pos":[13542,13560],"content":"NVC_MFCDocView#165"},{"pos":[13669,13698],"content":"CScrollView::ScrollToPosition"},{"pos":[13702,13765],"content":"Call <ph id=\"ph1\">`ScrollToPosition`</ph> to scroll to a given point in the view.","source":"Call `ScrollToPosition` to scroll to a given point in the view."},{"content":"Parameters","pos":[13823,13833]},{"content":"The point to scroll to, in logical units.","pos":[13845,13886]},{"content":"The <bpt id=\"p1\">**</bpt>x<ept id=\"p1\">**</ept> member must be a positive value (greater than or equal to 0, up to the total size of the view).","pos":[13887,13992],"source":" The **x** member must be a positive value (greater than or equal to 0, up to the total size of the view)."},{"content":"The same is true for the <bpt id=\"p1\">**</bpt>y<ept id=\"p1\">**</ept> member when the mapping mode is <ph id=\"ph1\">`MM_TEXT`</ph>.","pos":[13993,14066],"source":" The same is true for the **y** member when the mapping mode is `MM_TEXT`."},{"content":"The <bpt id=\"p1\">**</bpt>y<ept id=\"p1\">**</ept> member is negative in mapping modes other than <ph id=\"ph1\">`MM_TEXT`</ph>.","pos":[14067,14134],"source":" The **y** member is negative in mapping modes other than `MM_TEXT`."},{"content":"Remarks","pos":[14144,14151]},{"content":"The view will be scrolled so that this point is at the upper-left corner of the window.","pos":[14155,14242]},{"content":"This member function must not be called if the view is scaled to fit.","pos":[14243,14312]},{"pos":[14369,14399],"content":"CScrollView::SetScaleToFitSize"},{"pos":[14403,14510],"content":"Call <ph id=\"ph1\">`SetScaleToFitSize`</ph> when you want to scale the viewport size to the current window size automatically.","source":"Call `SetScaleToFitSize` when you want to scale the viewport size to the current window size automatically."},{"content":"Parameters","pos":[14575,14585]},{"content":"The horizontal and vertical sizes to which the view is to be scaled.","pos":[14604,14672]},{"content":"The scroll view's size is measured in logical units.","pos":[14673,14725]},{"content":"The horizontal size is contained in the <bpt id=\"p1\">**</bpt>cx<ept id=\"p1\">**</ept> member.","pos":[14726,14780],"source":" The horizontal size is contained in the **cx** member."},{"content":"The vertical size is contained in the <bpt id=\"p1\">**</bpt>cy<ept id=\"p1\">**</ept> member.","pos":[14781,14833],"source":" The vertical size is contained in the **cy** member."},{"content":"Both <bpt id=\"p1\">**</bpt>cx<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>cy<ept id=\"p2\">**</ept> must be greater than or equal to 0.","pos":[14834,14892],"source":" Both **cx** and **cy** must be greater than or equal to 0."},{"content":"Remarks","pos":[14902,14909]},{"content":"With scroll bars, only a portion of the logical view may be visible at any time.","pos":[14913,14993]},{"content":"But with the scale-to-fit capability, the view has no scroll bars and the logical view is stretched or shrunk to exactly fit the window's client area.","pos":[14994,15144]},{"content":"When the window is resized, the view draws its data at a new scale based on the size of the window.","pos":[15145,15244]},{"content":"You'll typically place the call to <ph id=\"ph1\">`SetScaleToFitSize`</ph> in your override of the view's <ph id=\"ph2\">`OnInitialUpdate`</ph> member function.","pos":[15251,15371],"source":"You'll typically place the call to `SetScaleToFitSize` in your override of the view's `OnInitialUpdate` member function."},{"content":"If you do not want automatic scaling, call the <ph id=\"ph1\">`SetScrollSizes`</ph> member function instead.","pos":[15372,15460],"source":" If you do not want automatic scaling, call the `SetScrollSizes` member function instead."},{"content":"can be used to implement a \"Zoom to Fit\" operation.","pos":[15487,15538]},{"content":"Use <ph id=\"ph1\">`SetScrollSizes`</ph> to reinitialize scrolling.","pos":[15539,15586],"source":" Use `SetScrollSizes` to reinitialize scrolling."},{"content":"assumes that the size of the view window has been set.","pos":[15613,15667]},{"content":"If the view window size has not been set when <ph id=\"ph1\">`SetScaleToFitSize`</ph> is called, you will get an assertion.","pos":[15668,15771],"source":" If the view window size has not been set when `SetScaleToFitSize` is called, you will get an assertion."},{"content":"To ensure that this does not happen, make the following call before calling <ph id=\"ph1\">`SetScaleToFitSize`</ph>:","pos":[15772,15868],"source":" To ensure that this does not happen, make the following call before calling `SetScaleToFitSize`:"},{"pos":[15886,15904],"content":"NVC_MFCDocView#165"},{"pos":[16011,16038],"content":"CScrollView::SetScrollSizes"},{"pos":[16042,16101],"content":"Call <ph id=\"ph1\">`SetScrollSizes`</ph> when the view is about to be updated.","source":"Call `SetScrollSizes` when the view is about to be updated."},{"content":"Parameters","pos":[16272,16282]},{"content":"The mapping mode to set for this view.","pos":[16300,16338]},{"content":"Possible values include:","pos":[16339,16363]},{"content":"Mapping Mode","pos":[16370,16382]},{"content":"Logical Unit","pos":[16383,16395]},{"content":"Positive y-axis Extends...","pos":[16396,16422]},{"content":"1 pixel","pos":[16513,16520]},{"content":"Downward","pos":[16521,16529]},{"content":"0.01 mm","pos":[16548,16555]},{"content":"Upward","pos":[16556,16562]},{"content":"1/1440 in","pos":[16578,16587]},{"content":"Upward","pos":[16588,16594]},{"content":"0.001 in","pos":[16614,16622]},{"content":"Upward","pos":[16623,16629]},{"content":"0.1 mm","pos":[16648,16654]},{"content":"Upward","pos":[16655,16661]},{"content":"0.01 in","pos":[16681,16688]},{"content":"Upward","pos":[16689,16695]},{"content":"All of these modes are defined by Windows.","pos":[16703,16745]},{"content":"Two standard mapping modes, <ph id=\"ph1\">`MM_ISOTROPIC`</ph> and <ph id=\"ph2\">`MM_ANISOTROPIC`</ph>, are not used for <ph id=\"ph3\">`CScrollView`</ph>.","pos":[16746,16842],"source":" Two standard mapping modes, `MM_ISOTROPIC` and `MM_ANISOTROPIC`, are not used for `CScrollView`."},{"content":"The class library provides the <ph id=\"ph1\">`SetScaleToFitSize`</ph> member function for scaling the view to window size.","pos":[16843,16946],"source":" The class library provides the `SetScaleToFitSize` member function for scaling the view to window size."},{"content":"Column three in the table above describes the coordinate orientation.","pos":[16947,17016]},{"content":"The total size of the scroll view.","pos":[17038,17072]},{"content":"The <bpt id=\"p1\">**</bpt>cx<ept id=\"p1\">**</ept> member contains the horizontal extent.","pos":[17073,17122],"source":" The **cx** member contains the horizontal extent."},{"content":"The <bpt id=\"p1\">**</bpt>cy<ept id=\"p1\">**</ept> member contains the vertical extent.","pos":[17123,17170],"source":" The **cy** member contains the vertical extent."},{"content":"Sizes are in logical units.","pos":[17171,17198]},{"content":"Both <bpt id=\"p1\">**</bpt>cx<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>cy<ept id=\"p2\">**</ept> must be greater than or equal to 0.","pos":[17199,17257],"source":" Both **cx** and **cy** must be greater than or equal to 0."},{"content":"The horizontal and vertical amounts to scroll in each direction in response to a mouse click in a scroll-bar shaft.","pos":[17278,17393]},{"content":"The <bpt id=\"p1\">**</bpt>cx<ept id=\"p1\">**</ept> member contains the horizontal amount.","pos":[17394,17443],"source":" The **cx** member contains the horizontal amount."},{"content":"The <bpt id=\"p1\">**</bpt>cy<ept id=\"p1\">**</ept> member contains the vertical amount.","pos":[17444,17491],"source":" The **cy** member contains the vertical amount."},{"content":"The horizontal and vertical amounts to scroll in each direction in response to a mouse click in a scroll arrow.","pos":[17512,17623]},{"content":"The <bpt id=\"p1\">**</bpt>cx<ept id=\"p1\">**</ept> member contains the horizontal amount.","pos":[17624,17673],"source":" The **cx** member contains the horizontal amount."},{"content":"The <bpt id=\"p1\">**</bpt>cy<ept id=\"p1\">**</ept> member contains the vertical amount.","pos":[17674,17721],"source":" The **cy** member contains the vertical amount."},{"content":"Remarks","pos":[17731,17738]},{"pos":[17742,17916],"content":"Call it in your override of the <ph id=\"ph1\">`OnUpdate`</ph> member function to adjust scrolling characteristics when, for example, the document is initially displayed or when it changes size.","source":"Call it in your override of the `OnUpdate` member function to adjust scrolling characteristics when, for example, the document is initially displayed or when it changes size."},{"content":"You will typically obtain size information from the view's associated document by calling a document member function, perhaps called <ph id=\"ph1\">`GetMyDocSize`</ph>, that you supply with your derived document class.","pos":[17923,18121],"source":"You will typically obtain size information from the view's associated document by calling a document member function, perhaps called `GetMyDocSize`, that you supply with your derived document class."},{"content":"The following code shows this approach:","pos":[18122,18161]},{"pos":[18179,18197],"content":"NVC_MFCDocView#166"},{"content":"Alternatively, you might sometimes need to set a fixed size, as in the following code:","pos":[18257,18343]},{"pos":[18361,18379],"content":"NVC_MFCDocView#167"},{"content":"You must set the mapping mode to any of the Windows mapping modes except <ph id=\"ph1\">`MM_ISOTROPIC`</ph> or <ph id=\"ph2\">`MM_ANISOTROPIC`</ph>.","pos":[18439,18547],"source":"You must set the mapping mode to any of the Windows mapping modes except `MM_ISOTROPIC` or `MM_ANISOTROPIC`."},{"content":"If you want to use an unconstrained mapping mode, call the <ph id=\"ph1\">`SetScaleToFitSize`</ph> member function instead of <ph id=\"ph2\">`SetScrollSizes`</ph>.","pos":[18548,18671],"source":" If you want to use an unconstrained mapping mode, call the `SetScaleToFitSize` member function instead of `SetScrollSizes`."},{"content":"Example","pos":[18681,18688]},{"pos":[18703,18721],"content":"NVC_MFCDocView#168"},{"pos":[18792,18810],"content":"NVC_MFCDocView#169"},{"content":"See Also","pos":[18872,18880]},{"content":"MFC Sample DIBLOOK","pos":[18885,18903]},{"content":"CView Class","pos":[18939,18950]},{"content":"Hierarchy Chart","pos":[18993,19008]},{"content":"CView Class","pos":[19045,19056]},{"content":"CSplitterWnd Class","pos":[19099,19117]}],"content":"---\ntitle: \"CScrollView Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CScrollView\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CScrollView class\"\n  - \"views, scrolling\"\n  - \"scrolling views\"\nms.assetid: 4ba16dac-1acb-4be0-bb55-5fb695b6948d\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CScrollView Class\nA [CView](../../mfc/reference/cview-class.md) with scrolling capabilities.  \n  \n## Syntax  \n  \n```  \nclass CScrollView : public CView  \n```  \n  \n## Members  \n  \n### Protected Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CScrollView::CScrollView](#cscrollview__cscrollview)|Constructs a `CScrollView` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CScrollView::CheckScrollBars](#cscrollview__checkscrollbars)|Indicates whether the scroll view has horizontal and vertical scroll bars.|  \n|[CScrollView::FillOutsideRect](#cscrollview__filloutsiderect)|Fills the area of a view outside the scrolling area.|  \n|[CScrollView::GetDeviceScrollPosition](#cscrollview__getdevicescrollposition)|Gets the current scroll position in device units.|  \n|[CScrollView::GetDeviceScrollSizes](#cscrollview__getdevicescrollsizes)|Gets the current mapping mode, the total size, and the line and page sizes of the scrollable view. Sizes are in device units.|  \n|[CScrollView::GetScrollPosition](#cscrollview__getscrollposition)|Gets the current scroll position in logical units.|  \n|[CScrollView::GetTotalSize](#cscrollview__gettotalsize)|Gets the total size of the scroll view in logical units.|  \n|[CScrollView::ResizeParentToFit](#cscrollview__resizeparenttofit)|Causes the size of the view to dictate the size of its frame.|  \n|[CScrollView::ScrollToPosition](#cscrollview__scrolltoposition)|Scrolls the view to a given point, specified in logical units.|  \n|[CScrollView::SetScaleToFitSize](#cscrollview__setscaletofitsize)|Puts the scroll view into scale-to-fit mode.|  \n|[CScrollView::SetScrollSizes](#cscrollview__setscrollsizes)|Sets the scroll view's mapping mode, total size, and horizontal and vertical scroll amounts.|  \n  \n## Remarks  \n You can handle standard scrolling yourself in any class derived from `CView` by overriding the message-mapped [OnHScroll](../../mfc/reference/cwnd-class.md#cwnd__onhscroll) and [OnVScroll](../../mfc/reference/cwnd-class.md#cwnd__onvscroll) member functions. But `CScrollView` adds the following features to its `CView` capabilities:  \n  \n-   It manages window and viewport sizes and mapping modes.  \n  \n-   It scrolls automatically in response to scroll-bar messages.  \n  \n-   It scrolls automatically in response to messages from the keyboard, a non-scrolling mouse, or the IntelliMouse wheel.  \n  \n To scroll automatically in response to messages from the keyboard, add a WM_KEYDOWN message, and test for VK_DOWN, VK_PREV and call [SetScrollPos](http://msdn.microsoft.com/library/windows/desktop/bb787597).  \n  \n You can handle mouse wheel scrolling yourself by overriding the message-mapped [OnMouseWheel](../../mfc/reference/cwnd-class.md#cwnd__onmousewheel) and [OnRegisteredMouseWheel](../../mfc/reference/cwnd-class.md#cwnd__onregisteredmousewheel) member functions. As they are for `CScrollView`, these member functions support the recommended behaviour for [WM_MOUSEWHEEL](http://msdn.microsoft.com/library/windows/desktop/ms645617), the wheel rotation message.  \n  \n To take advantage of automatic scrolling, derive your view class from `CScrollView` instead of from `CView`. When the view is first created, if you want to calculate the size of the scrollable view based on the size of the document, call the `SetScrollSizes` member function from your override of either [CView::OnInitialUpdate](../../mfc/reference/cview-class.md#cview__oninitialupdate) or [CView::OnUpdate](../../mfc/reference/cview-class.md#cview__onupdate). (You must write your own code to query the size of the document. For an example, see the [Scribble sample](../../visual-cpp-samples.md).)  \n  \n The call to the `SetScrollSizes` member function sets the view's mapping mode, the total dimensions of the scroll view, and the amounts to scroll horizontally and vertically. All sizes are in logical units. The logical size of the view is usually calculated from data stored in the document, but in some cases you may want to specify a fixed size. For examples of both approaches, see [CScrollView::SetScrollSizes](#cscrollview__setscrollsizes).  \n  \n You specify the amounts to scroll horizontally and vertically in logical units. By default, if the user clicks a scroll bar shaft outside of the scroll box, `CScrollView` scrolls a \"page.\" If the user clicks a scroll arrow at either end of a scroll bar, `CScrollView` scrolls a \"line.\" By default, a page is 1/10 of the total size of the view; a line is 1/10 of the page size. Override these default values by passing custom sizes in the `SetScrollSizes` member function. For example, you might set the horizontal size to some fraction of the width of the total size and the vertical size to the height of a line in the current font.  \n  \n Instead of scrolling, `CScrollView` can automatically scale the view to the current window size. In this mode, the view has no scroll bars and the logical view is stretched or shrunk to exactly fit the window's client area. To use this scale-to-fit capability, call [CScrollView::SetScaleToFitSize](#cscrollview__setscaletofitsize). (Call either `SetScaleToFitSize` or `SetScrollSizes`, but not both.)  \n  \n Before the `OnDraw` member function of your derived view class is called, `CScrollView` automatically adjusts the viewport origin for the `CPaintDC` device-context object that it passes to `OnDraw`.  \n  \n To adjust the viewport origin for the scrolling window, `CScrollView` overrides [CView::OnPrepareDC](../../mfc/reference/cview-class.md#cview__onpreparedc). This adjustment is automatic for the `CPaintDC` device context that `CScrollView` passes to `OnDraw`, but you must call **CScrollView::OnPrepareDC** yourself for any other device contexts you use, such as a `CClientDC`. You can override **CScrollView::OnPrepareDC** to set the pen, background color, and other drawing attributes, but call the base class to do scaling.  \n  \n Scroll bars can appear in three places relative to a view, as shown in the following cases:  \n  \n-   Standard window-style scroll bars can be set for the view using the **WS_HSCROLL** and **WS_VSCROLL**[Windows Styles](../../mfc/reference/window-styles.md).  \n  \n-   Scroll-bar controls can also be added to the frame containing the view, in which case the framework forwards `WM_HSCROLL` and `WM_VSCROLL` messages from the frame window to the currently active view.  \n  \n-   The framework also forwards scroll messages from a `CSplitterWnd` splitter control to the currently active splitter pane (a view). When placed in a [CSplitterWnd](../../mfc/reference/csplitterwnd-class.md) with shared scroll bars, a `CScrollView` object will use the shared ones rather than creating its own.  \n  \n For more information on using `CScrollView`, see [Document/View Architecture](../../mfc/document-view-architecture.md) and [Derived View Classes Available in MFC](../../mfc/derived-view-classes-available-in-mfc.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CView](../../mfc/reference/cview-class.md)  \n  \n `CScrollView`  \n  \n## Requirements  \n **Header:** afxwin.h  \n  \n##  <a name=\"cscrollview__checkscrollbars\"></a>  CScrollView::CheckScrollBars  \n Call this member function to determine if the scroll view has horizontal and vertical bars.  \n  \n```  \nvoid CheckScrollBars(\n    BOOL& bHasHorzBar,  \n    BOOL& bHasVertBar) const;\n\n \n```  \n  \n### Parameters  \n *bHasHorzBar*  \n Indicates the application has a horizontal scroll bar.  \n  \n *bHasVertBar*  \n Indicates the application has a vertical scroll bar.  \n  \n##  <a name=\"cscrollview__cscrollview\"></a>  CScrollView::CScrollView  \n Constructs a `CScrollView` object.  \n  \n```  \nCScrollView();\n```  \n  \n### Remarks  \n You must call either `SetScrollSizes` or `SetScaleToFitSize` before the scroll view is usable.  \n  \n##  <a name=\"cscrollview__filloutsiderect\"></a>  CScrollView::FillOutsideRect  \n Call `FillOutsideRect` to fill the area of the view that appears outside of the scrolling area.  \n  \n```  \nvoid FillOutsideRect(\n    CDC* pDC,  \n    CBrush* pBrush);\n```  \n  \n### Parameters  \n `pDC`  \n Device context in which the filling is to be done.  \n  \n `pBrush`  \n Brush with which the area is to be filled.  \n  \n### Remarks  \n Use `FillOutsideRect` in your scroll view's `OnEraseBkgnd` handler function to prevent excessive background repainting.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#164](../../mfc/codesnippet/cpp/cscrollview-class_1.cpp)]  \n  \n##  <a name=\"cscrollview__getdevicescrollposition\"></a>  CScrollView::GetDeviceScrollPosition  \n Call `GetDeviceScrollPosition` when you need the current horizontal and vertical positions of the scroll boxes in the scroll bars.  \n  \n```  \nCPoint GetDeviceScrollPosition() const;\n\n \n```  \n  \n### Return Value  \n The horizontal and vertical positions (in device units) of the scroll boxes as a `CPoint` object.  \n  \n### Remarks  \n This coordinate pair corresponds to the location in the document to which the upper-left corner of the view has been scrolled. This is useful for offsetting mouse-device positions to scroll-view device positions.  \n  \n `GetDeviceScrollPosition` returns values in device units. If you want logical units, use `GetScrollPosition` instead.  \n  \n##  <a name=\"cscrollview__getdevicescrollsizes\"></a>  CScrollView::GetDeviceScrollSizes  \n `GetDeviceScrollSizes` gets the current mapping mode, the total size, and the line and page sizes of the scrollable view.  \n  \n```  \nvoid GetDeviceScrollSizes(\n    int& nMapMode,  \n    SIZE& sizeTotal,  \n    SIZE& sizePage,  \n    SIZE& sizeLine) const;\n\n \n```  \n  \n### Parameters  \n `nMapMode`  \n Returns the current mapping mode for this view. For a list of possible values, see `SetScrollSizes`.  \n  \n `sizeTotal`  \n Returns the current total size of the scroll view in device units.  \n  \n `sizePage`  \n Returns the current horizontal and vertical amounts to scroll in each direction in response to a mouse click in a scroll-bar shaft. The **cx** member contains the horizontal amount. The **cy** member contains the vertical amount.  \n  \n `sizeLine`  \n Returns the current horizontal and vertical amounts to scroll in each direction in response to a mouse click in a scroll arrow. The **cx** member contains the horizontal amount. The **cy** member contains the vertical amount.  \n  \n### Remarks  \n Sizes are in device units. This member function is rarely called.  \n  \n##  <a name=\"cscrollview__getscrollposition\"></a>  CScrollView::GetScrollPosition  \n Call `GetScrollPosition` when you need the current horizontal and vertical positions of the scroll boxes in the scroll bars.  \n  \n```  \nCPoint GetScrollPosition() const;\n\n \n```  \n  \n### Return Value  \n The horizontal and vertical positions (in logical units) of the scroll boxes as a `CPoint` object.  \n  \n### Remarks  \n This coordinate pair corresponds to the location in the document to which the upper-left corner of the view has been scrolled.  \n  \n `GetScrollPosition` returns values in logical units. If you want device units, use `GetDeviceScrollPosition` instead.  \n  \n##  <a name=\"cscrollview__gettotalsize\"></a>  CScrollView::GetTotalSize  \n Call `GetTotalSize` to retrieve the current horizontal and vertical sizes of the scroll view.  \n  \n```  \nCSize GetTotalSize() const;\n\n \n```  \n  \n### Return Value  \n The total size of the scroll view in logical units. The horizontal size is in the **cx** member of the `CSize` return value. The vertical size is in the **cy** member.  \n  \n##  <a name=\"cscrollview__resizeparenttofit\"></a>  CScrollView::ResizeParentToFit  \n Call `ResizeParentToFit` to let the size of your view dictate the size of its frame window.  \n  \n```  \nvoid ResizeParentToFit(BOOL bShrinkOnly = TRUE);\n```  \n  \n### Parameters  \n *bShrinkOnly*  \n The kind of resizing to perform. The default value, **TRUE**, shrinks the frame window if appropriate. Scroll bars will still appear for large views or small frame windows. A value of **FALSE** causes the view always to resize the frame window exactly. This can be somewhat dangerous since the frame window could get too big to fit inside the multiple document interface (MDI) frame window or the screen.  \n  \n### Remarks  \n This is recommended only for views in MDI child frame windows. Use `ResizeParentToFit` in the `OnInitialUpdate` handler function of your derived `CScrollView` class. For an example of this member function, see [CScrollView::SetScrollSizes](#cscrollview__setscrollsizes).  \n  \n `ResizeParentToFit` assumes that the size of the view window has been set. If the view window size has not been set when `ResizeParentToFit` is called, you will get an assertion. To ensure that this does not happen, make the following call before calling `ResizeParentToFit`:  \n  \n [!code-cpp[NVC_MFCDocView#165](../../mfc/codesnippet/cpp/cscrollview-class_2.cpp)]  \n  \n##  <a name=\"cscrollview__scrolltoposition\"></a>  CScrollView::ScrollToPosition  \n Call `ScrollToPosition` to scroll to a given point in the view.  \n  \n```  \nvoid ScrollToPosition(POINT pt);\n```  \n  \n### Parameters  \n `pt`  \n The point to scroll to, in logical units. The **x** member must be a positive value (greater than or equal to 0, up to the total size of the view). The same is true for the **y** member when the mapping mode is `MM_TEXT`. The **y** member is negative in mapping modes other than `MM_TEXT`.  \n  \n### Remarks  \n The view will be scrolled so that this point is at the upper-left corner of the window. This member function must not be called if the view is scaled to fit.  \n  \n##  <a name=\"cscrollview__setscaletofitsize\"></a>  CScrollView::SetScaleToFitSize  \n Call `SetScaleToFitSize` when you want to scale the viewport size to the current window size automatically.  \n  \n```  \nvoid SetScaleToFitSize(SIZE sizeTotal);\n```  \n  \n### Parameters  \n `sizeTotal`  \n The horizontal and vertical sizes to which the view is to be scaled. The scroll view's size is measured in logical units. The horizontal size is contained in the **cx** member. The vertical size is contained in the **cy** member. Both **cx** and **cy** must be greater than or equal to 0.  \n  \n### Remarks  \n With scroll bars, only a portion of the logical view may be visible at any time. But with the scale-to-fit capability, the view has no scroll bars and the logical view is stretched or shrunk to exactly fit the window's client area. When the window is resized, the view draws its data at a new scale based on the size of the window.  \n  \n You'll typically place the call to `SetScaleToFitSize` in your override of the view's `OnInitialUpdate` member function. If you do not want automatic scaling, call the `SetScrollSizes` member function instead.  \n  \n `SetScaleToFitSize` can be used to implement a \"Zoom to Fit\" operation. Use `SetScrollSizes` to reinitialize scrolling.  \n  \n `SetScaleToFitSize` assumes that the size of the view window has been set. If the view window size has not been set when `SetScaleToFitSize` is called, you will get an assertion. To ensure that this does not happen, make the following call before calling `SetScaleToFitSize`:  \n  \n [!code-cpp[NVC_MFCDocView#165](../../mfc/codesnippet/cpp/cscrollview-class_2.cpp)]  \n  \n##  <a name=\"cscrollview__setscrollsizes\"></a>  CScrollView::SetScrollSizes  \n Call `SetScrollSizes` when the view is about to be updated.  \n  \n```  \nvoid SetScrollSizes(\n    int nMapMode,  \n    SIZE sizeTotal,  \n    const SIZE& sizePage = sizeDefault,  \n    const SIZE& sizeLine = sizeDefault);\n```  \n  \n### Parameters  \n `nMapMode`  \n The mapping mode to set for this view. Possible values include:  \n  \n|Mapping Mode|Logical Unit|Positive y-axis Extends...|  \n|------------------|------------------|---------------------------------|  \n|`MM_TEXT`|1 pixel|Downward|  \n|`MM_HIMETRIC`|0.01 mm|Upward|  \n|`MM_TWIPS`|1/1440 in|Upward|  \n|`MM_HIENGLISH`|0.001 in|Upward|  \n|`MM_LOMETRIC`|0.1 mm|Upward|  \n|`MM_LOENGLISH`|0.01 in|Upward|  \n  \n All of these modes are defined by Windows. Two standard mapping modes, `MM_ISOTROPIC` and `MM_ANISOTROPIC`, are not used for `CScrollView`. The class library provides the `SetScaleToFitSize` member function for scaling the view to window size. Column three in the table above describes the coordinate orientation.  \n  \n `sizeTotal`  \n The total size of the scroll view. The **cx** member contains the horizontal extent. The **cy** member contains the vertical extent. Sizes are in logical units. Both **cx** and **cy** must be greater than or equal to 0.  \n  \n `sizePage`  \n The horizontal and vertical amounts to scroll in each direction in response to a mouse click in a scroll-bar shaft. The **cx** member contains the horizontal amount. The **cy** member contains the vertical amount.  \n  \n `sizeLine`  \n The horizontal and vertical amounts to scroll in each direction in response to a mouse click in a scroll arrow. The **cx** member contains the horizontal amount. The **cy** member contains the vertical amount.  \n  \n### Remarks  \n Call it in your override of the `OnUpdate` member function to adjust scrolling characteristics when, for example, the document is initially displayed or when it changes size.  \n  \n You will typically obtain size information from the view's associated document by calling a document member function, perhaps called `GetMyDocSize`, that you supply with your derived document class. The following code shows this approach:  \n  \n [!code-cpp[NVC_MFCDocView#166](../../mfc/codesnippet/cpp/cscrollview-class_3.cpp)]  \n  \n Alternatively, you might sometimes need to set a fixed size, as in the following code:  \n  \n [!code-cpp[NVC_MFCDocView#167](../../mfc/codesnippet/cpp/cscrollview-class_4.cpp)]  \n  \n You must set the mapping mode to any of the Windows mapping modes except `MM_ISOTROPIC` or `MM_ANISOTROPIC`. If you want to use an unconstrained mapping mode, call the `SetScaleToFitSize` member function instead of `SetScrollSizes`.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#168](../../mfc/codesnippet/cpp/cscrollview-class_5.cpp)]  \n  \n [!code-cpp[NVC_MFCDocView#169](../../mfc/codesnippet/cpp/cscrollview-class_6.cpp)]  \n  \n## See Also  \n [MFC Sample DIBLOOK](../../visual-cpp-samples.md)   \n [CView Class](../../mfc/reference/cview-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CView Class](../../mfc/reference/cview-class.md)   \n [CSplitterWnd Class](../../mfc/reference/csplitterwnd-class.md)\n"}