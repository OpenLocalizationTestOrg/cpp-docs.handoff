{"nodes":[{"pos":[12,55],"content":"CAtlAutoThreadModule Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CAtlAutoThreadModule Class | Microsoft Docs","pos":[0,43]}]},{"content":"CAtlAutoThreadModule Class","pos":[697,723]},{"content":"This class implements a thread-pooled, apartment-model COM server.","pos":[724,790]},{"pos":[798,908],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"content":"Syntax","pos":[917,923]},{"content":"Remarks","pos":[1026,1033]},{"content":"derives from <bpt id=\"p1\">[</bpt>CAtlAutoThreadModuleT<ept id=\"p1\">](../../atl/reference/catlautothreadmodulet-class.md)</ept> and implements a thread-pooled, apartment-model COM server.","pos":[1060,1208],"source":" derives from [CAtlAutoThreadModuleT](../../atl/reference/catlautothreadmodulet-class.md) and implements a thread-pooled, apartment-model COM server."},{"content":"uses <bpt id=\"p1\">[</bpt>CComApartment<ept id=\"p1\">](../../atl/reference/ccomapartment-class.md)</ept> to manage an apartment for each thread in the module.","pos":[1232,1350],"source":" uses [CComApartment](../../atl/reference/ccomapartment-class.md) to manage an apartment for each thread in the module."},{"content":"You must use the <bpt id=\"p1\">[</bpt>DECLARE_CLASSFACTORY_AUTO_THREAD<ept id=\"p1\">](http://msdn.microsoft.com/library/19d7105e-03e8-4412-9f5e-5384c8a5e18f)</ept> macro in your object's class definition to specify <bpt id=\"p2\">[</bpt>CComClassFactoryAutoThread<ept id=\"p2\">](../../atl/reference/ccomclassfactoryautothread-class.md)</ept> as the class factory.","pos":[1357,1639],"source":"You must use the [DECLARE_CLASSFACTORY_AUTO_THREAD](http://msdn.microsoft.com/library/19d7105e-03e8-4412-9f5e-5384c8a5e18f) macro in your object's class definition to specify [CComClassFactoryAutoThread](../../atl/reference/ccomclassfactoryautothread-class.md) as the class factory."},{"content":"You should then add a single instance of a class derived from <ph id=\"ph1\">`CAtlAutoThreadModuleT`</ph> such as <ph id=\"ph2\">`CAtlAutoThreadModule`</ph>.","pos":[1640,1757],"source":" You should then add a single instance of a class derived from `CAtlAutoThreadModuleT` such as `CAtlAutoThreadModule`."},{"content":"For example:","pos":[1758,1770]},{"pos":[1846,1970],"content":"[!NOTE]\n This class replaces the obsolete [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) class.","leadings":["","> "],"nodes":[{"content":"This class replaces the obsolete <bpt id=\"p1\">[</bpt>CComAutoThreadModule<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md)</ept> class.","pos":[9,122],"source":" This class replaces the obsolete [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) class."}]},{"content":"Inheritance Hierarchy","pos":[1979,2000]},{"content":"CAtlAutoThreadModuleT","pos":[2034,2055]},{"content":"Requirements","pos":[2146,2158]},{"pos":[2162,2183],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlbase.h","source":"**Header:** atlbase.h"},{"content":"See Also","pos":[2192,2200]},{"content":"CAtlAutoThreadModuleT Class","pos":[2205,2232]},{"content":"IAtlAutoThreadModule Class","pos":[2291,2317]},{"content":"Class Overview","pos":[2375,2389]},{"content":"Module Classes","pos":[2429,2443]}],"content":"---\ntitle: \"CAtlAutoThreadModule Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL.CAtlAutoThreadModule\"\n  - \"CAtlAutoThreadModule\"\n  - \"ATL::CAtlAutoThreadModule\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CAtlAutoThreadModule class\"\nms.assetid: 3be834aa-55ef-403e-94ae-41979691b15f\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CAtlAutoThreadModule Class\nThis class implements a thread-pooled, apartment-model COM server.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\nclass CAtlAutoThreadModule :  public CAtlAutoThreadModuleT<CAtlAutoThreadModule>\n```  \n  \n## Remarks  \n `CAtlAutoThreadModule` derives from [CAtlAutoThreadModuleT](../../atl/reference/catlautothreadmodulet-class.md) and implements a thread-pooled, apartment-model COM server. `CAtlAutoThreadModule` uses [CComApartment](../../atl/reference/ccomapartment-class.md) to manage an apartment for each thread in the module.  \n  \n You must use the [DECLARE_CLASSFACTORY_AUTO_THREAD](http://msdn.microsoft.com/library/19d7105e-03e8-4412-9f5e-5384c8a5e18f) macro in your object's class definition to specify [CComClassFactoryAutoThread](../../atl/reference/ccomclassfactoryautothread-class.md) as the class factory. You should then add a single instance of a class derived from `CAtlAutoThreadModuleT` such as `CAtlAutoThreadModule`. For example:  \n  \n `CAtlAutoThreadModule _AtlAutoModule; // name is immaterial.`  \n  \n> [!NOTE]\n>  This class replaces the obsolete [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) class.  \n  \n## Inheritance Hierarchy  \n `IAtlAutoThreadModule`  \n  \n [CAtlAutoThreadModuleT](../../atl/reference/catlautothreadmodulet-class.md)  \n  \n `CAtlAutoThreadModule`  \n  \n## Requirements  \n **Header:** atlbase.h  \n  \n## See Also  \n [CAtlAutoThreadModuleT Class](../../atl/reference/catlautothreadmodulet-class.md)   \n [IAtlAutoThreadModule Class](../../atl/reference/iatlautothreadmodule-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)   \n [Module Classes](../../atl/atl-module-classes.md)"}