{"nodes":[{"pos":[12,78],"content":"Creating an Active Document Container Application | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Creating an Active Document Container Application | Microsoft Docs","pos":[0,66]}]},{"content":"Creating an Active Document Container Application","pos":[812,861]},{"content":"The simplest and most recommended way to create an active document container application is to create an MFC EXE container application using the MFC Application Wizard, then modify the application to support active document containment.","pos":[862,1098]},{"content":"To create an active document container application","pos":[1109,1159]},{"pos":[1169,1235],"content":"From the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Project<ept id=\"p2\">**</ept>from the <bpt id=\"p3\">**</bpt>New<ept id=\"p3\">**</ept> submenu.","source":"From the **File** menu, click **Project**from the **New** submenu."},{"pos":[1245,1299],"content":"From the left pane, click <bpt id=\"p1\">**</bpt>Visual C++<ept id=\"p1\">**</ept> project type.","source":"From the left pane, click **Visual C++** project type."},{"pos":[1309,1356],"content":"Select <bpt id=\"p1\">**</bpt>MFC Application<ept id=\"p1\">**</ept> from the right pane.","source":"Select **MFC Application** from the right pane."},{"pos":[1366,1406],"content":"Name the project <ph id=\"ph1\">`MyProj`</ph>, click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Name the project `MyProj`, click **OK**."},{"pos":[1416,1462],"content":"Select the <bpt id=\"p1\">**</bpt>Compound Document Support<ept id=\"p1\">**</ept> page.","source":"Select the **Compound Document Support** page."},{"pos":[1472,1533],"content":"Select the <bpt id=\"p1\">**</bpt>Container<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Container/Full-server<ept id=\"p2\">**</ept> option.","source":"Select the **Container** or **Container/Full-server** option."},{"pos":[1543,1594],"content":"Select the <bpt id=\"p1\">**</bpt>Active document container<ept id=\"p1\">**</ept> check box.","source":"Select the **Active document container** check box."},{"pos":[1604,1621],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Click **Finish**."},{"content":"When the MFC Application Wizard finishes generating the application, open the following files using Solution Explorer:","pos":[1630,1748]},{"content":"MyProjview.cpp","pos":[1762,1776]},{"content":"In MyProjview.cpp, make the following changes:","pos":[1786,1832]},{"pos":[1846,1937],"content":"In <ph id=\"ph1\">`CMyProjView::OnPreparePrinting`</ph>, replace the function contents with the following code:","source":"In `CMyProjView::OnPreparePrinting`, replace the function contents with the following code:"},{"pos":[1963,1980],"content":"NVC_MFCDocView#56"},{"content":"provides printing support.","pos":[2093,2119]},{"content":"This code replaces <ph id=\"ph1\">`DoPreparePrinting`</ph>, which is the default print preparation.","pos":[2120,2199],"source":" This code replaces `DoPreparePrinting`, which is the default print preparation."},{"content":"Active document containment provides an improved printing scheme:","pos":[2210,2275]},{"content":"You can first call the active document through its <ph id=\"ph1\">`IPrint`</ph>interface and tell it to print itself.","pos":[2289,2386],"source":"You can first call the active document through its `IPrint`interface and tell it to print itself."},{"content":"This is different from previous OLE containment, in which the container had to render an image of the contained item onto the printer <ph id=\"ph1\">`CDC`</ph>object.","pos":[2387,2533],"source":" This is different from previous OLE containment, in which the container had to render an image of the contained item onto the printer `CDC`object."},{"pos":[2547,2642],"content":"If that fails, tell the contained item to print itself through its <ph id=\"ph1\">`IOleCommandTarget`</ph>interface","source":"If that fails, tell the contained item to print itself through its `IOleCommandTarget`interface"},{"content":"If that fails, make your own rendering of the item.","pos":[2656,2707]},{"pos":[2718,2893],"content":"The static member functions <ph id=\"ph1\">`COleDocObjectItem::OnPrint`</ph> and <ph id=\"ph2\">`COleDocObjectItem::OnPreparePrinting`</ph>, as implemented in the previous code, handle this improved printing scheme.","source":"The static member functions `COleDocObjectItem::OnPrint` and `COleDocObjectItem::OnPreparePrinting`, as implemented in the previous code, handle this improved printing scheme."},{"content":"Add any implementation of your own and build the application.","pos":[2903,2964]},{"content":"See Also","pos":[2973,2981]},{"content":"Active Document Containment","pos":[2986,3013]}],"content":"---\ntitle: \"Creating an Active Document Container Application | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"active documents [C++], containers\"\n  - \"containers [C++], active document\"\n  - \"active document containers [C++], creating\"\n  - \"MFC COM [C++], active document containment\"\n  - \"applications [MFC], active document container\"\nms.assetid: 14e2d022-a6c5-4249-8712-706b0f4433f7\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Creating an Active Document Container Application\nThe simplest and most recommended way to create an active document container application is to create an MFC EXE container application using the MFC Application Wizard, then modify the application to support active document containment.  \n  \n#### To create an active document container application  \n  \n1.  From the **File** menu, click **Project**from the **New** submenu.  \n  \n2.  From the left pane, click **Visual C++** project type.  \n  \n3.  Select **MFC Application** from the right pane.  \n  \n4.  Name the project `MyProj`, click **OK**.  \n  \n5.  Select the **Compound Document Support** page.  \n  \n6.  Select the **Container** or **Container/Full-server** option.  \n  \n7.  Select the **Active document container** check box.  \n  \n8.  Click **Finish**.  \n  \n9. When the MFC Application Wizard finishes generating the application, open the following files using Solution Explorer:  \n  \n    -   MyProjview.cpp  \n  \n10. In MyProjview.cpp, make the following changes:  \n  \n    -   In `CMyProjView::OnPreparePrinting`, replace the function contents with the following code:  \n  \n         [!code-cpp[NVC_MFCDocView#56](../mfc/codesnippet/cpp/creating-an-active-document-container-application_1.cpp)]  \n  \n     `OnPreparePrinting` provides printing support. This code replaces `DoPreparePrinting`, which is the default print preparation.  \n  \n     Active document containment provides an improved printing scheme:  \n  \n    -   You can first call the active document through its `IPrint`interface and tell it to print itself. This is different from previous OLE containment, in which the container had to render an image of the contained item onto the printer `CDC`object.  \n  \n    -   If that fails, tell the contained item to print itself through its `IOleCommandTarget`interface  \n  \n    -   If that fails, make your own rendering of the item.  \n  \n     The static member functions `COleDocObjectItem::OnPrint` and `COleDocObjectItem::OnPreparePrinting`, as implemented in the previous code, handle this improved printing scheme.  \n  \n11. Add any implementation of your own and build the application.  \n  \n## See Also  \n [Active Document Containment](../mfc/active-document-containment.md)\n\n"}