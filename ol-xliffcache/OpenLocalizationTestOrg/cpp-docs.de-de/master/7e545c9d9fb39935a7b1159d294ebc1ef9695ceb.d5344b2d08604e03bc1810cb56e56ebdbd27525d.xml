{"nodes":[{"pos":[12,67],"content":"Servers: Implementing Server Documents | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Servers: Implementing Server Documents | Microsoft Docs","pos":[0,55]}]},{"content":"Servers: Implementing Server Documents","pos":[752,790]},{"content":"This article explains the steps you must take to successfully implement a server document if you did not specify the OLE Server option in the application wizard.","pos":[791,952]},{"content":"To define a server document class","pos":[963,996]},{"pos":[1006,1079],"content":"Derive your document class from <ph id=\"ph1\">`COleServerDoc`</ph> instead of <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept>.","source":"Derive your document class from `COleServerDoc` instead of **CDocument**."},{"pos":[1089,1146],"content":"Create a server item class derived from <ph id=\"ph1\">`COleServerItem`</ph>.","source":"Create a server item class derived from `COleServerItem`."},{"pos":[1156,1236],"content":"Implement the <ph id=\"ph1\">`OnGetEmbeddedItem`</ph> member function of your server document class.","source":"Implement the `OnGetEmbeddedItem` member function of your server document class."},{"content":"is called when the user of a container application creates or edits an embedded item.","pos":[1267,1352]},{"content":"It should return an item representing the entire document.","pos":[1353,1411]},{"content":"This should be an object of your <ph id=\"ph1\">`COleServerItem`</ph>-derived class.","pos":[1412,1476],"source":" This should be an object of your `COleServerItem`-derived class."},{"content":"Override the <ph id=\"ph1\">`Serialize`</ph> member function to serialize the contents of the document.","pos":[1486,1569],"source":"Override the `Serialize` member function to serialize the contents of the document."},{"content":"You do not need to serialize the list of server items unless you are using them to represent the native data in your document.","pos":[1570,1696]},{"content":"For more information, see <bpt id=\"p1\">*</bpt>Implementing Server Items<ept id=\"p1\">*</ept> in the article <bpt id=\"p2\">[</bpt>Servers: Server Items<ept id=\"p2\">](../mfc/servers-server-items.md)</ept>.","pos":[1697,1822],"source":" For more information, see *Implementing Server Items* in the article [Servers: Server Items](../mfc/servers-server-items.md)."},{"content":"When a server document is created, the framework automatically registers the document with the OLE system DLLs.","pos":[1829,1940]},{"content":"This allows the DLLs to identify the server documents.","pos":[1941,1995]},{"pos":[2002,2181],"content":"For more information, see <bpt id=\"p1\">[</bpt>COleServerItem<ept id=\"p1\">](../mfc/reference/coleserveritem-class.md)</ept> and <bpt id=\"p2\">[</bpt>COleServerDoc<ept id=\"p2\">](../mfc/reference/coleserverdoc-class.md)</ept> in the <bpt id=\"p3\">*</bpt>Class Library Reference<ept id=\"p3\">*</ept>.","source":"For more information, see [COleServerItem](../mfc/reference/coleserveritem-class.md) and [COleServerDoc](../mfc/reference/coleserverdoc-class.md) in the *Class Library Reference*."},{"content":"See Also","pos":[2190,2198]},{"content":"Servers","pos":[2203,2210]},{"content":"Servers: Server Items","pos":[2236,2257]},{"content":"Servers: Implementing a Server","pos":[2296,2326]},{"content":"Servers: Implementing In-Place Frame Windows","pos":[2374,2418]}],"content":"---\ntitle: \"Servers: Implementing Server Documents | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE server applications, managing server documents\"\n  - \"OLE server applications, implementing OLE servers\"\n  - \"servers, server documents\"\n  - \"server documents, implementing\"\nms.assetid: cca1451a-ad09-47ed-b56e-bccd78fc86d1\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Servers: Implementing Server Documents\nThis article explains the steps you must take to successfully implement a server document if you did not specify the OLE Server option in the application wizard.  \n  \n#### To define a server document class  \n  \n1.  Derive your document class from `COleServerDoc` instead of **CDocument**.  \n  \n2.  Create a server item class derived from `COleServerItem`.  \n  \n3.  Implement the `OnGetEmbeddedItem` member function of your server document class.  \n  \n     `OnGetEmbeddedItem` is called when the user of a container application creates or edits an embedded item. It should return an item representing the entire document. This should be an object of your `COleServerItem`-derived class.  \n  \n4.  Override the `Serialize` member function to serialize the contents of the document. You do not need to serialize the list of server items unless you are using them to represent the native data in your document. For more information, see *Implementing Server Items* in the article [Servers: Server Items](../mfc/servers-server-items.md).  \n  \n When a server document is created, the framework automatically registers the document with the OLE system DLLs. This allows the DLLs to identify the server documents.  \n  \n For more information, see [COleServerItem](../mfc/reference/coleserveritem-class.md) and [COleServerDoc](../mfc/reference/coleserverdoc-class.md) in the *Class Library Reference*.  \n  \n## See Also  \n [Servers](../mfc/servers.md)   \n [Servers: Server Items](../mfc/servers-server-items.md)   \n [Servers: Implementing a Server](../mfc/servers-implementing-a-server.md)   \n [Servers: Implementing In-Place Frame Windows](../mfc/servers-implementing-in-place-frame-windows.md)\n\n"}