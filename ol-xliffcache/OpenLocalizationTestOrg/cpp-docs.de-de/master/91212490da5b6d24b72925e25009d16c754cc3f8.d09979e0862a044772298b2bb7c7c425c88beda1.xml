{"nodes":[{"pos":[12,46],"content":"Object Map Macros | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Object Map Macros | Microsoft Docs","pos":[0,34]}]},{"content":"Object Map Macros","pos":[529,546]},{"content":"These macros define object maps and entries.","pos":[547,591]},{"content":"DECLARE_OBJECT_DESCRIPTION","pos":[613,639]},{"content":"Allows you to specify a class object's text description, which will be entered into the object map.","pos":[670,769]},{"content":"OBJECT_ENTRY_AUTO","pos":[775,792]},{"content":"Enters an ATL object into the object map, updates the registry, and creates an instance of the object.","pos":[814,916]},{"content":"OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO","pos":[922,957]},{"pos":[997,1138],"content":"Allows you to specify that the object should be registered and initialized, but it should not be externally creatable via <ph id=\"ph1\">`CoCreateInstance`</ph>.","source":"Allows you to specify that the object should be registered and initialized, but it should not be externally creatable via `CoCreateInstance`."},{"pos":[1192,1218],"content":"DECLARE_OBJECT_DESCRIPTION"},{"content":"Allows you to specify a text description for your class object.","pos":[1222,1285]},{"content":"Parameters","pos":[1340,1350]},{"content":"x","pos":[1355,1356]},{"content":"[in] The class object's description.","pos":[1361,1397]},{"content":"Remarks","pos":[1407,1414]},{"pos":[1418,1569],"content":"ATL enters this description into the object map through the <bpt id=\"p1\">[</bpt>OBJECT_ENTRY<ept id=\"p1\">](http://msdn.microsoft.com/en-us/abd10ee2-54f0-4f94-9ec2-ddf8f4c8c8cd)</ept> macro.","source":"ATL enters this description into the object map through the [OBJECT_ENTRY](http://msdn.microsoft.com/en-us/abd10ee2-54f0-4f94-9ec2-ddf8f4c8c8cd) macro."},{"pos":[1605,1784],"content":"implements a <ph id=\"ph1\">`GetObjectDescription`</ph> function, which you can use to override the <bpt id=\"p1\">[</bpt>CComCoClass::GetObjectDescription<ept id=\"p1\">](ccomcoclass-class.md#ccomcoclass__getobjectdescription)</ept> method.","source":" implements a `GetObjectDescription` function, which you can use to override the [CComCoClass::GetObjectDescription](ccomcoclass-class.md#ccomcoclass__getobjectdescription) method."},{"content":"The <ph id=\"ph1\">`GetObjectDescription`</ph> function is called by <bpt id=\"p1\">**</bpt>IComponentRegistrar::GetComponents<ept id=\"p1\">**</ept>.","pos":[1792,1880],"source":"The `GetObjectDescription` function is called by **IComponentRegistrar::GetComponents**."},{"content":"<bpt id=\"p1\">**</bpt>IComponentRegistrar<ept id=\"p1\">**</ept> is an Automation interface that allows you to register and unregister individual components in a DLL.","pos":[1881,2006],"source":"**IComponentRegistrar** is an Automation interface that allows you to register and unregister individual components in a DLL."},{"content":"When you create a Component Registrar object with the ATL Project Wizard, the wizard will automatically implement the <bpt id=\"p1\">**</bpt>IComponentRegistrar<ept id=\"p1\">**</ept> interface.","pos":[2007,2159],"source":" When you create a Component Registrar object with the ATL Project Wizard, the wizard will automatically implement the **IComponentRegistrar** interface."},{"content":"<bpt id=\"p1\">**</bpt>IComponentRegistrar<ept id=\"p1\">**</ept> is typically used by Microsoft Transaction Server.","pos":[2160,2234],"source":"**IComponentRegistrar** is typically used by Microsoft Transaction Server."},{"pos":[2241,2382],"content":"For more information about the ATL Project Wizard, see the article <bpt id=\"p1\">[</bpt>Creating an ATL Project<ept id=\"p1\">](../../atl/reference/creating-an-atl-project.md)</ept>.","source":"For more information about the ATL Project Wizard, see the article [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)."},{"content":"Example","pos":[2392,2399]},{"pos":[2414,2435],"content":"NVC_ATL_Windowing#123"},{"pos":[2530,2547],"content":"OBJECT_ENTRY_AUTO"},{"content":"Enters an ATL object into the object map, updates the registry, and creates an instance of the object.","pos":[2551,2653]},{"content":"Parameters","pos":[2710,2720]},{"content":"[in] The CLSID of a COM class implemented by the C++ class named <ph id=\"ph1\">`class`</ph>.","pos":[2735,2808],"source":" [in] The CLSID of a COM class implemented by the C++ class named `class`."},{"content":"[in] The name of the C++ class implementing the COM class represented by <ph id=\"ph1\">`clsid`</ph>.","pos":[2826,2907],"source":" [in] The name of the C++ class implementing the COM class represented by `clsid`."},{"content":"Remarks","pos":[2917,2924]},{"content":"Object entry macros are placed at global scope in the project to provide support for the registration, initialization, and creation of a class.","pos":[2928,3071]},{"content":"enters the function pointers of the creator class and class-factory creator class <ph id=\"ph1\">`CreateInstance`</ph> functions for this object into the auto-generated ATL object map.","pos":[3098,3262],"source":" enters the function pointers of the creator class and class-factory creator class `CreateInstance` functions for this object into the auto-generated ATL object map."},{"content":"When <bpt id=\"p1\">[</bpt>CAtlComModule::RegisterServer<ept id=\"p1\">](catlcommodule-class.md#catlcommodule__registerserver)</ept> is called, it updates the system registry for each object in the object map.","pos":[3263,3430],"source":" When [CAtlComModule::RegisterServer](catlcommodule-class.md#catlcommodule__registerserver) is called, it updates the system registry for each object in the object map."},{"content":"The table below describes how the information added to the object map is obtained from the class given as the second parameter to this macro.","pos":[3438,3579]},{"content":"Information for","pos":[3586,3601]},{"content":"Obtained from","pos":[3602,3615]},{"content":"COM registration","pos":[3666,3682]},{"content":"Registry Macros","pos":[3684,3699]},{"content":"Class factory creation","pos":[3745,3767]},{"content":"Class Factory Macros","pos":[3769,3789]},{"content":"Instance creation","pos":[3856,3873]},{"content":"Aggregation Macros","pos":[3875,3893]},{"content":"Component category registration","pos":[3960,3991]},{"content":"Category Macros","pos":[3993,4008]},{"content":"Class-level initialization and cleanup","pos":[4054,4092]},{"content":"ObjectMain","pos":[4094,4104]},{"pos":[4225,4260],"content":"OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO"},{"pos":[4264,4405],"content":"Allows you to specify that the object should be registered and initialized, but it should not be externally creatable via <ph id=\"ph1\">`CoCreateInstance`</ph>.","source":"Allows you to specify that the object should be registered and initialized, but it should not be externally creatable via `CoCreateInstance`."},{"content":"Parameters","pos":[4480,4490]},{"content":"[in] The CLSID of a COM class implemented by the C++ class named <ph id=\"ph1\">`class`</ph>.","pos":[4505,4578],"source":" [in] The CLSID of a COM class implemented by the C++ class named `class`."},{"content":"[in] The name of the C++ class implementing the COM class represented by <ph id=\"ph1\">`clsid`</ph>.","pos":[4596,4677],"source":" [in] The name of the C++ class implementing the COM class represented by `clsid`."},{"content":"Remarks","pos":[4687,4694]},{"content":"Object entry macros are placed at global scope in the project to provide support for the registration, initialization, and creation of a class.","pos":[4698,4841]},{"pos":[4886,5082],"content":"allows you to specify that an object should be registered and initialized (see <bpt id=\"p1\">[</bpt>OBJECT_ENTRY_AUTO<ept id=\"p1\">](#object_entry_auto)</ept> for more information), but it should not be creatable via <ph id=\"ph1\">`CoCreateInstance`</ph>.","source":" allows you to specify that an object should be registered and initialized (see [OBJECT_ENTRY_AUTO](#object_entry_auto) for more information), but it should not be creatable via `CoCreateInstance`."},{"content":"See Also","pos":[5091,5099]},{"content":"Macros","pos":[5104,5110]}],"content":"---\ntitle: \"Object Map Macros | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nms.assetid: 680087f4-9894-41dd-a79c-6f337e1f13c1\ncaps.latest.revision: 16\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Object Map Macros\nThese macros define object maps and entries.  \n  \n|||  \n|-|-|  \n|[DECLARE_OBJECT_DESCRIPTION](#declare_object_description)|Allows you to specify a class object's text description, which will be entered into the object map.|  \n|[OBJECT_ENTRY_AUTO](#object_entry_auto)|Enters an ATL object into the object map, updates the registry, and creates an instance of the object.|  \n|[OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO](#object_entry_non_createable_ex_auto)|Allows you to specify that the object should be registered and initialized, but it should not be externally creatable via `CoCreateInstance`.|  \n  \n##  <a name=\"declare_object_description\"></a>  DECLARE_OBJECT_DESCRIPTION  \n Allows you to specify a text description for your class object.  \n  \n```\nDECLARE_OBJECT_DESCRIPTION( x )\n```  \n  \n### Parameters  \n *x*  \n [in] The class object's description.  \n  \n### Remarks  \n ATL enters this description into the object map through the [OBJECT_ENTRY](http://msdn.microsoft.com/en-us/abd10ee2-54f0-4f94-9ec2-ddf8f4c8c8cd) macro.  \n  \n `DECLARE_OBJECT_DESCRIPTION` implements a `GetObjectDescription` function, which you can use to override the [CComCoClass::GetObjectDescription](ccomcoclass-class.md#ccomcoclass__getobjectdescription) method.  \n\n  \n The `GetObjectDescription` function is called by **IComponentRegistrar::GetComponents**. **IComponentRegistrar** is an Automation interface that allows you to register and unregister individual components in a DLL. When you create a Component Registrar object with the ATL Project Wizard, the wizard will automatically implement the **IComponentRegistrar** interface. **IComponentRegistrar** is typically used by Microsoft Transaction Server.  \n  \n For more information about the ATL Project Wizard, see the article [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md).  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#123](../../atl/codesnippet/cpp/object-map-macros_1.h)]  \n  \n##  <a name=\"object_entry_auto\"></a>  OBJECT_ENTRY_AUTO  \n Enters an ATL object into the object map, updates the registry, and creates an instance of the object.  \n  \n```\nOBJECT_ENTRY_AUTO( clsid, class )\n```  \n  \n### Parameters  \n `clsid`  \n [in] The CLSID of a COM class implemented by the C++ class named `class`.  \n  \n `class`  \n [in] The name of the C++ class implementing the COM class represented by `clsid`.  \n  \n### Remarks  \n Object entry macros are placed at global scope in the project to provide support for the registration, initialization, and creation of a class.  \n  \n `OBJECT_ENTRY_AUTO` enters the function pointers of the creator class and class-factory creator class `CreateInstance` functions for this object into the auto-generated ATL object map. When [CAtlComModule::RegisterServer](catlcommodule-class.md#catlcommodule__registerserver) is called, it updates the system registry for each object in the object map.  \n\n  \n The table below describes how the information added to the object map is obtained from the class given as the second parameter to this macro.  \n  \n|Information for|Obtained from|  \n|---------------------|-------------------|  \n|COM registration|[Registry Macros](../../atl/reference/registry-macros.md)|  \n|Class factory creation|[Class Factory Macros](../../atl/reference/aggregation-and-class-factory-macros.md)|  \n|Instance creation|[Aggregation Macros](../../atl/reference/aggregation-and-class-factory-macros.md)|  \n|Component category registration|[Category Macros](../../atl/reference/category-macros.md)|  \n|Class-level initialization and cleanup|[ObjectMain](ccomobjectrootex-class.md#ccomobjectrootex__objectmain)|  \n\n  \n##  <a name=\"object_entry_non_createable_ex_auto\"></a>  OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO  \n Allows you to specify that the object should be registered and initialized, but it should not be externally creatable via `CoCreateInstance`.  \n  \n```\nOBJECT_ENTRY_NON_CREATEABLE_EX_AUTO( clsid, class )\n```  \n  \n### Parameters  \n `clsid`  \n [in] The CLSID of a COM class implemented by the C++ class named `class`.  \n  \n `class`  \n [in] The name of the C++ class implementing the COM class represented by `clsid`.  \n  \n### Remarks  \n Object entry macros are placed at global scope in the project to provide support for the registration, initialization, and creation of a class.  \n  \n `OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO` allows you to specify that an object should be registered and initialized (see [OBJECT_ENTRY_AUTO](#object_entry_auto) for more information), but it should not be creatable via `CoCreateInstance`.  \n  \n## See Also  \n [Macros](../../atl/reference/atl-macros.md)\n"}