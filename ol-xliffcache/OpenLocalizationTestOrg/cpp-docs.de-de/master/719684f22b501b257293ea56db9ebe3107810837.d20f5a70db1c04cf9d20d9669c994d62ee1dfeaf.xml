{"nodes":[{"pos":[12,49],"content":"COleLinkingDoc Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleLinkingDoc Class | Microsoft Docs","pos":[0,37]}]},{"content":"COleLinkingDoc Class","pos":[651,671]},{"content":"The base class for OLE container documents that support linking to the embedded items they contain.","pos":[672,771]},{"content":"Syntax","pos":[780,786]},{"content":"Members","pos":[855,862]},{"content":"Public Constructors","pos":[872,891]},{"content":"Name","pos":[898,902]},{"content":"Description","pos":[903,914]},{"content":"COleLinkingDoc::COleLinkingDoc","pos":[953,983]},{"pos":[1018,1055],"content":"Constructs a <ph id=\"ph1\">`COleLinkingDoc`</ph> object.","source":"Constructs a `COleLinkingDoc` object."},{"content":"Public Methods","pos":[1066,1080]},{"content":"Name","pos":[1087,1091]},{"content":"Description","pos":[1092,1103]},{"content":"COleLinkingDoc::Register","pos":[1142,1166]},{"content":"Registers the document with the OLE system DLLs.","pos":[1195,1243]},{"content":"COleLinkingDoc::Revoke","pos":[1249,1271]},{"content":"Revokes the document's registration.","pos":[1298,1334]},{"content":"Protected Methods","pos":[1345,1362]},{"content":"Name","pos":[1369,1373]},{"content":"Description","pos":[1374,1385]},{"content":"COleLinkingDoc::OnFindEmbeddedItem","pos":[1424,1458]},{"content":"Finds the specified embedded item.","pos":[1497,1531]},{"content":"COleLinkingDoc::OnGetLinkedItem","pos":[1537,1568]},{"content":"Finds the specified linked item.","pos":[1604,1636]},{"content":"Remarks","pos":[1646,1653]},{"content":"A container application that supports linking to embedded items is called a \"link container.\"","pos":[1657,1750]},{"content":"The <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../../visual-cpp-samples.md)</ept> sample application is an example of a link container.","pos":[1751,1847],"source":" The [OCLIENT](../../visual-cpp-samples.md) sample application is an example of a link container."},{"content":"When a linked item's source is an embedded item in another document, that containing document must be loaded in order for the embedded item to be edited.","pos":[1854,2007]},{"content":"For this reason, a link container must be able to be launched by another container application when the user wants to edit the source of a linked item.","pos":[2008,2159]},{"content":"Your application must also use the <bpt id=\"p1\">[</bpt>COleTemplateServer<ept id=\"p1\">](../../mfc/reference/coletemplateserver-class.md)</ept> class so that it can create documents when launched programmatically.","pos":[2160,2334],"source":" Your application must also use the [COleTemplateServer](../../mfc/reference/coletemplateserver-class.md) class so that it can create documents when launched programmatically."},{"content":"To make your container a link container, derive your document class from <ph id=\"ph1\">`COleLinkingDoc`</ph> instead of <bpt id=\"p1\">[</bpt>COleDocument<ept id=\"p1\">](../../mfc/reference/coledocument-class.md)</ept>.","pos":[2341,2500],"source":"To make your container a link container, derive your document class from `COleLinkingDoc` instead of [COleDocument](../../mfc/reference/coledocument-class.md)."},{"content":"As with any other OLE container, you must design your class for storing the application's native data as well as embedded or linked items.","pos":[2501,2639]},{"content":"Also, you must design data structures for storing your native data.","pos":[2640,2707]},{"content":"If you define a <ph id=\"ph1\">`CDocItem`</ph>-derived class for your application's native data, you can use the interface defined by <ph id=\"ph2\">`COleDocument`</ph> to store your native data as well as your OLE data.","pos":[2708,2888],"source":" If you define a `CDocItem`-derived class for your application's native data, you can use the interface defined by `COleDocument` to store your native data as well as your OLE data."},{"pos":[2895,3071],"content":"To allow your application to be launched programmatically by another container, declare a <ph id=\"ph1\">`COleTemplateServer`</ph> object as a member of your application's <ph id=\"ph2\">`CWinApp`</ph>-derived class:","source":"To allow your application to be launched programmatically by another container, declare a `COleTemplateServer` object as a member of your application's `CWinApp`-derived class:"},{"pos":[3089,3111],"content":"NVC_MFCOleContainer#23"},{"pos":[3172,3340],"content":"In the <ph id=\"ph1\">`InitInstance`</ph> member function of your <ph id=\"ph2\">`CWinApp`</ph>-derived class, create a document template and specify your <ph id=\"ph3\">`COleLinkingDoc`</ph>-derived class as the document class:","source":"In the `InitInstance` member function of your `CWinApp`-derived class, create a document template and specify your `COleLinkingDoc`-derived class as the document class:"},{"pos":[3358,3380],"content":"NVC_MFCOleContainer#24"},{"pos":[3443,3668],"content":"Connect your <ph id=\"ph1\">`COleTemplateServer`</ph> object to your document templates by calling the object's <ph id=\"ph2\">`ConnectTemplate`</ph> member function, and register all class objects with the OLE system by calling <bpt id=\"p1\">**</bpt>COleTemplateServer::RegisterAll<ept id=\"p1\">**</ept>:","source":"Connect your `COleTemplateServer` object to your document templates by calling the object's `ConnectTemplate` member function, and register all class objects with the OLE system by calling **COleTemplateServer::RegisterAll**:"},{"pos":[3686,3708],"content":"NVC_MFCOleContainer#25"},{"pos":[3771,3935],"content":"For a sample <ph id=\"ph1\">`CWinApp`</ph>-derived class definition and <ph id=\"ph2\">`InitInstance`</ph> function, see OCLIENT.H and OCLIENT.CPP in the MFC sample <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","source":"For a sample `CWinApp`-derived class definition and `InitInstance` function, see OCLIENT.H and OCLIENT.CPP in the MFC sample [OCLIENT](../../visual-cpp-samples.md)."},{"pos":[3942,4175],"content":"For more information on using <ph id=\"ph1\">`COleLinkingDoc`</ph>, see the articles <bpt id=\"p1\">[</bpt>Containers: Implementing a Container<ept id=\"p1\">](../../mfc/containers-implementing-a-container.md)</ept> and <bpt id=\"p2\">[</bpt>Containers: Advanced Features<ept id=\"p2\">](../../mfc/containers-advanced-features.md)</ept>.","source":"For more information on using `COleLinkingDoc`, see the articles [Containers: Implementing a Container](../../mfc/containers-implementing-a-container.md) and [Containers: Advanced Features](../../mfc/containers-advanced-features.md)."},{"content":"Inheritance Hierarchy","pos":[4184,4205]},{"content":"CObject","pos":[4210,4217]},{"content":"CCmdTarget","pos":[4264,4274]},{"content":"CDocument","pos":[4324,4333]},{"content":"COleDocument","pos":[4382,4394]},{"content":"Requirements","pos":[4470,4482]},{"pos":[4486,4506],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxole.h","source":"**Header:** afxole.h"},{"pos":[4563,4593],"content":"COleLinkingDoc::COleLinkingDoc"},{"pos":[4597,4692],"content":"Constructs a <ph id=\"ph1\">`COleLinkingDoc`</ph> object without beginning communications with the OLE system DLLs.","source":"Constructs a `COleLinkingDoc` object without beginning communications with the OLE system DLLs."},{"content":"Remarks","pos":[4735,4742]},{"pos":[4746,4831],"content":"You must call the <ph id=\"ph1\">`Register`</ph> member function to inform OLE that the document is open.","source":"You must call the `Register` member function to inform OLE that the document is open."},{"pos":[4892,4926],"content":"COleLinkingDoc::OnFindEmbeddedItem"},{"content":"Called by the framework to determine whether the document contains an embedded OLE item with the specified name.","pos":[4930,5042]},{"content":"Parameters","pos":[5133,5143]},{"content":"Pointer to the name of the embedded OLE item requested.","pos":[5165,5220]},{"content":"Return Value","pos":[5230,5242]},{"pos":[5246,5313],"content":"A pointer to the specified item; <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the item is not found.","source":"A pointer to the specified item; **NULL** if the item is not found."},{"content":"Remarks","pos":[5323,5330]},{"content":"The default implementation searches the list of embedded items for an item with the specified name (the name comparison is case sensitive).","pos":[5334,5473]},{"content":"Override this function if you have your own method of storing or naming embedded OLE items.","pos":[5474,5565]},{"pos":[5623,5654],"content":"COleLinkingDoc::OnGetLinkedItem"},{"content":"Called by the framework to check whether the document contains a linked server item with the specified name.","pos":[5658,5766]},{"content":"Parameters","pos":[5854,5864]},{"content":"Pointer to the name of the linked OLE item requested.","pos":[5886,5939]},{"content":"Return Value","pos":[5949,5961]},{"pos":[5965,6032],"content":"A pointer to the specified item; <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the item is not found.","source":"A pointer to the specified item; **NULL** if the item is not found."},{"content":"Remarks","pos":[6042,6049]},{"content":"The default <ph id=\"ph1\">`COleLinkingDoc`</ph> implementation always returns <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[6053,6121],"source":"The default `COleLinkingDoc` implementation always returns **NULL**."},{"content":"This function is overriden in the derived class <ph id=\"ph1\">`COleServerDoc`</ph> to search the list of OLE server items for a linked item with the specified name (the name comparison is case sensitive).","pos":[6122,6307],"source":" This function is overriden in the derived class `COleServerDoc` to search the list of OLE server items for a linked item with the specified name (the name comparison is case sensitive)."},{"content":"Override this function if you have implemented your own method of storing or retrieving linked server items.","pos":[6308,6416]},{"pos":[6467,6491],"content":"COleLinkingDoc::Register"},{"content":"Informs the OLE system DLLs that the document is open.","pos":[6495,6549]},{"content":"Parameters","pos":[6651,6661]},{"content":"pFactory","pos":[6666,6674]},{"content":"Pointer to an OLE factory object (can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>).","pos":[6679,6730],"source":" Pointer to an OLE factory object (can be **NULL**)."},{"content":"Pointer to the fully qualified path of the container document.","pos":[6755,6817]},{"content":"Return Value","pos":[6827,6839]},{"content":"Nonzero if the document is successfully registered; otherwise 0.","pos":[6843,6907]},{"content":"Remarks","pos":[6917,6924]},{"content":"Call this function when creating or opening a named file to register the document with the OLE system DLLs.","pos":[6928,7035]},{"content":"There is no need to call this function if the document represents an embedded item.","pos":[7036,7119]},{"pos":[7126,7310],"content":"If you are using <ph id=\"ph1\">`COleTemplateServer`</ph> in your application, <ph id=\"ph2\">`Register`</ph> is called for you by <ph id=\"ph3\">`COleLinkingDoc`</ph>'s implementation of <ph id=\"ph4\">`OnNewDocument`</ph>, <ph id=\"ph5\">`OnOpenDocument`</ph>, and <ph id=\"ph6\">`OnSaveDocument`</ph>.","source":"If you are using `COleTemplateServer` in your application, `Register` is called for you by `COleLinkingDoc`'s implementation of `OnNewDocument`, `OnOpenDocument`, and `OnSaveDocument`."},{"pos":[7359,7381],"content":"COleLinkingDoc::Revoke"},{"content":"Informs the OLE system DLLs that the document is no longer open.","pos":[7385,7449]},{"content":"Remarks","pos":[7489,7496]},{"content":"Call this function to revoke the document's registration with the OLE system DLLs.","pos":[7500,7582]},{"content":"You should call this function when closing a named file, but you usually do not need to call it directly.","pos":[7589,7694]},{"content":"is called for you by <ph id=\"ph1\">`COleLinkingDoc`</ph>'s implementation of <ph id=\"ph2\">`OnCloseDocument`</ph>, <ph id=\"ph3\">`OnNewDocument`</ph>, <ph id=\"ph4\">`OnOpenDocument`</ph>, and <ph id=\"ph5\">`OnSaveDocument`</ph>.","pos":[7704,7837],"source":" is called for you by `COleLinkingDoc`'s implementation of `OnCloseDocument`, `OnNewDocument`, `OnOpenDocument`, and `OnSaveDocument`."},{"content":"See Also","pos":[7846,7854]},{"content":"MFC Sample OCLIENT","pos":[7859,7877]},{"content":"COleDocument Class","pos":[7913,7931]},{"content":"Hierarchy Chart","pos":[7981,7996]},{"content":"CDocTemplate Class","pos":[8033,8051]}],"content":"---\ntitle: \"COleLinkingDoc Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleLinkingDoc\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE containers, client items\"\n  - \"COleLinkingDoc class\"\nms.assetid: 9f547f35-2f95-427f-b9c0-85c31940198b\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleLinkingDoc Class\nThe base class for OLE container documents that support linking to the embedded items they contain.  \n  \n## Syntax  \n  \n```  \nclass COleLinkingDoc : public COleDocument  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleLinkingDoc::COleLinkingDoc](#colelinkingdoc__colelinkingdoc)|Constructs a `COleLinkingDoc` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleLinkingDoc::Register](#colelinkingdoc__register)|Registers the document with the OLE system DLLs.|  \n|[COleLinkingDoc::Revoke](#colelinkingdoc__revoke)|Revokes the document's registration.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleLinkingDoc::OnFindEmbeddedItem](#colelinkingdoc__onfindembeddeditem)|Finds the specified embedded item.|  \n|[COleLinkingDoc::OnGetLinkedItem](#colelinkingdoc__ongetlinkeditem)|Finds the specified linked item.|  \n  \n## Remarks  \n A container application that supports linking to embedded items is called a \"link container.\" The [OCLIENT](../../visual-cpp-samples.md) sample application is an example of a link container.  \n  \n When a linked item's source is an embedded item in another document, that containing document must be loaded in order for the embedded item to be edited. For this reason, a link container must be able to be launched by another container application when the user wants to edit the source of a linked item. Your application must also use the [COleTemplateServer](../../mfc/reference/coletemplateserver-class.md) class so that it can create documents when launched programmatically.  \n  \n To make your container a link container, derive your document class from `COleLinkingDoc` instead of [COleDocument](../../mfc/reference/coledocument-class.md). As with any other OLE container, you must design your class for storing the application's native data as well as embedded or linked items. Also, you must design data structures for storing your native data. If you define a `CDocItem`-derived class for your application's native data, you can use the interface defined by `COleDocument` to store your native data as well as your OLE data.  \n  \n To allow your application to be launched programmatically by another container, declare a `COleTemplateServer` object as a member of your application's `CWinApp`-derived class:  \n  \n [!code-cpp[NVC_MFCOleContainer#23](../../mfc/codesnippet/cpp/colelinkingdoc-class_1.h)]  \n  \n In the `InitInstance` member function of your `CWinApp`-derived class, create a document template and specify your `COleLinkingDoc`-derived class as the document class:  \n  \n [!code-cpp[NVC_MFCOleContainer#24](../../mfc/codesnippet/cpp/colelinkingdoc-class_2.cpp)]  \n  \n Connect your `COleTemplateServer` object to your document templates by calling the object's `ConnectTemplate` member function, and register all class objects with the OLE system by calling **COleTemplateServer::RegisterAll**:  \n  \n [!code-cpp[NVC_MFCOleContainer#25](../../mfc/codesnippet/cpp/colelinkingdoc-class_3.cpp)]  \n  \n For a sample `CWinApp`-derived class definition and `InitInstance` function, see OCLIENT.H and OCLIENT.CPP in the MFC sample [OCLIENT](../../visual-cpp-samples.md).  \n  \n For more information on using `COleLinkingDoc`, see the articles [Containers: Implementing a Container](../../mfc/containers-implementing-a-container.md) and [Containers: Advanced Features](../../mfc/containers-advanced-features.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CDocument](../../mfc/reference/cdocument-class.md)  \n  \n [COleDocument](../../mfc/reference/coledocument-class.md)  \n  \n `COleLinkingDoc`  \n  \n## Requirements  \n **Header:** afxole.h  \n  \n##  <a name=\"colelinkingdoc__colelinkingdoc\"></a>  COleLinkingDoc::COleLinkingDoc  \n Constructs a `COleLinkingDoc` object without beginning communications with the OLE system DLLs.  \n  \n```  \nCOleLinkingDoc();\n```  \n  \n### Remarks  \n You must call the `Register` member function to inform OLE that the document is open.  \n  \n##  <a name=\"colelinkingdoc__onfindembeddeditem\"></a>  COleLinkingDoc::OnFindEmbeddedItem  \n Called by the framework to determine whether the document contains an embedded OLE item with the specified name.  \n  \n```  \nvirtual COleClientItem* OnFindEmbeddedItem(LPCTSTR lpszItemName);\n```  \n  \n### Parameters  \n `lpszItemName`  \n Pointer to the name of the embedded OLE item requested.  \n  \n### Return Value  \n A pointer to the specified item; **NULL** if the item is not found.  \n  \n### Remarks  \n The default implementation searches the list of embedded items for an item with the specified name (the name comparison is case sensitive). Override this function if you have your own method of storing or naming embedded OLE items.  \n  \n##  <a name=\"colelinkingdoc__ongetlinkeditem\"></a>  COleLinkingDoc::OnGetLinkedItem  \n Called by the framework to check whether the document contains a linked server item with the specified name.  \n  \n```  \nvirtual COleServerItem* OnGetLinkedItem(LPCTSTR lpszItemName);\n```  \n  \n### Parameters  \n `lpszItemName`  \n Pointer to the name of the linked OLE item requested.  \n  \n### Return Value  \n A pointer to the specified item; **NULL** if the item is not found.  \n  \n### Remarks  \n The default `COleLinkingDoc` implementation always returns **NULL**. This function is overriden in the derived class `COleServerDoc` to search the list of OLE server items for a linked item with the specified name (the name comparison is case sensitive). Override this function if you have implemented your own method of storing or retrieving linked server items.  \n  \n##  <a name=\"colelinkingdoc__register\"></a>  COleLinkingDoc::Register  \n Informs the OLE system DLLs that the document is open.  \n  \n```  \nBOOL Register(\n    COleObjectFactory* pFactory,  \n    LPCTSTR lpszPathName);\n```  \n  \n### Parameters  \n *pFactory*  \n Pointer to an OLE factory object (can be **NULL**).  \n  \n `lpszPathName`  \n Pointer to the fully qualified path of the container document.  \n  \n### Return Value  \n Nonzero if the document is successfully registered; otherwise 0.  \n  \n### Remarks  \n Call this function when creating or opening a named file to register the document with the OLE system DLLs. There is no need to call this function if the document represents an embedded item.  \n  \n If you are using `COleTemplateServer` in your application, `Register` is called for you by `COleLinkingDoc`'s implementation of `OnNewDocument`, `OnOpenDocument`, and `OnSaveDocument`.  \n  \n##  <a name=\"colelinkingdoc__revoke\"></a>  COleLinkingDoc::Revoke  \n Informs the OLE system DLLs that the document is no longer open.  \n  \n```  \nvoid Revoke();\n```  \n  \n### Remarks  \n Call this function to revoke the document's registration with the OLE system DLLs.  \n  \n You should call this function when closing a named file, but you usually do not need to call it directly. `Revoke` is called for you by `COleLinkingDoc`'s implementation of `OnCloseDocument`, `OnNewDocument`, `OnOpenDocument`, and `OnSaveDocument`.  \n  \n## See Also  \n [MFC Sample OCLIENT](../../visual-cpp-samples.md)   \n [COleDocument Class](../../mfc/reference/coledocument-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CDocTemplate Class](../../mfc/reference/cdoctemplate-class.md)\n"}