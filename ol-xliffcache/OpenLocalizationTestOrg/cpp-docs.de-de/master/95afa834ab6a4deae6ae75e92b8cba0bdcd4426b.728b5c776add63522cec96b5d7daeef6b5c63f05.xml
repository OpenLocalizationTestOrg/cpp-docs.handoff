{"nodes":[{"pos":[12,48],"content":"CComApartment Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComApartment Class | Microsoft Docs","pos":[0,36]}]},{"content":"CComApartment Class","pos":[698,717]},{"content":"This class provides support for managing an appartment in a thread-pooled EXE module.","pos":[718,803]},{"pos":[811,921],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"content":"Syntax","pos":[930,936]},{"content":"Members","pos":[978,985]},{"content":"Public Constructors","pos":[995,1014]},{"content":"Name","pos":[1021,1025]},{"content":"Description","pos":[1026,1037]},{"content":"CComApartment::CComApartment","pos":[1076,1104]},{"content":"The constructor.","pos":[1137,1153]},{"content":"Public Methods","pos":[1164,1178]},{"content":"Name","pos":[1185,1189]},{"content":"Description","pos":[1190,1201]},{"content":"CComApartment::Apartment","pos":[1240,1264]},{"content":"Marks the thread's starting address.","pos":[1293,1329]},{"content":"CComApartment::GetLockCount","pos":[1335,1362]},{"content":"Returns the thread's current lock count.","pos":[1394,1434]},{"content":"CComApartment::Lock","pos":[1440,1459]},{"content":"Increments the thread's lock count.","pos":[1483,1518]},{"content":"CComApartment::Unlock","pos":[1524,1545]},{"content":"Decrements the thread's lock count.","pos":[1571,1606]},{"content":"Public Data Members","pos":[1617,1636]},{"content":"Name","pos":[1643,1647]},{"content":"Description","pos":[1648,1659]},{"content":"CComApartment::m_dwThreadID","pos":[1698,1725]},{"content":"Contains the thread's identifier.","pos":[1757,1790]},{"content":"CComApartment::m_hThread","pos":[1796,1820]},{"content":"Contains the thread's handle.","pos":[1849,1878]},{"content":"CComApartment::m_nLockCnt","pos":[1884,1909]},{"content":"Contains the thread's current lock count.","pos":[1939,1980]},{"content":"Remarks","pos":[1990,1997]},{"content":"is used by <bpt id=\"p1\">[</bpt>CComAutoThreadModule<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md)</ept> to manage an apartment in a thread-pooled EXE module.","pos":[2017,2155],"source":" is used by [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) to manage an apartment in a thread-pooled EXE module."},{"content":"provides methods for incrementing and decrementing the lock count on a thread.","pos":[2172,2250]},{"content":"Requirements","pos":[2259,2271]},{"pos":[2275,2296],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlbase.h","source":"**Header:** atlbase.h"},{"pos":[2347,2371],"content":"CComApartment::Apartment"},{"content":"Marks the thread's starting address.","pos":[2375,2411]},{"content":"Return Value","pos":[2453,2465]},{"content":"Always 0.","pos":[2469,2478]},{"content":"Remarks","pos":[2488,2495]},{"pos":[2499,2631],"content":"Automatically set during <bpt id=\"p1\">[</bpt>CComAutoThreadModule::Init<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__init)</ept>.","source":"Automatically set during [CComAutoThreadModule::Init](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__init)."},{"pos":[2686,2714],"content":"CComApartment::CComApartment"},{"content":"The constructor.","pos":[2718,2734]},{"content":"Remarks","pos":[2774,2781]},{"pos":[2785,2914],"content":"Initializes the <ph id=\"ph1\">`CComApartment`</ph> data members <bpt id=\"p1\">[</bpt>m_nLockCnt<ept id=\"p1\">](#ccomapartment__m_nlockcnt)</ept> and <bpt id=\"p2\">[</bpt>m_hThread<ept id=\"p2\">](#ccomapartment__m_hthread)</ept>.","source":"Initializes the `CComApartment` data members [m_nLockCnt](#ccomapartment__m_nlockcnt) and [m_hThread](#ccomapartment__m_hthread)."},{"pos":[2968,2995],"content":"CComApartment::GetLockCount"},{"content":"Returns the thread's current lock count.","pos":[2999,3039]},{"content":"Return Value","pos":[3083,3095]},{"content":"The lock count on the thread.","pos":[3099,3128]},{"pos":[3174,3193],"content":"CComApartment::Lock"},{"content":"Increments the thread's lock count.","pos":[3197,3232]},{"content":"Return Value","pos":[3268,3280]},{"content":"A value that may be useful for diagnostics or testing.","pos":[3284,3338]},{"content":"Remarks","pos":[3348,3355]},{"pos":[3359,3476],"content":"Called by <bpt id=\"p1\">[</bpt>CComAutoThreadModule::Lock<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)</ept>.","source":"Called by [CComAutoThreadModule::Lock](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)."},{"content":"The lock count on the thread is used for statistical purposes.","pos":[3483,3545]},{"pos":[3599,3626],"content":"CComApartment::m_dwThreadID"},{"content":"Contains the thread's identifier.","pos":[3630,3663]},{"pos":[3747,3771],"content":"CComApartment::m_hThread"},{"content":"Contains the thread's handle.","pos":[3775,3804]},{"pos":[3887,3912],"content":"CComApartment::m_nLockCnt"},{"content":"Contains the thread's current lock count.","pos":[3916,3957]},{"pos":[4035,4056],"content":"CComApartment::Unlock"},{"content":"Decrements the thread's lock count.","pos":[4060,4095]},{"content":"Return Value","pos":[4133,4145]},{"content":"A value that may be useful for diagnostics or testing.","pos":[4149,4203]},{"content":"Remarks","pos":[4213,4220]},{"pos":[4224,4343],"content":"Called by <bpt id=\"p1\">[</bpt>CComAutoThreadModule::Unlock<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)</ept>.","source":"Called by [CComAutoThreadModule::Unlock](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)."},{"content":"The lock count on the thread is used for statistical purposes.","pos":[4350,4412]},{"content":"See Also","pos":[4421,4429]},{"content":"Class Overview","pos":[4434,4448]}],"content":"---\ntitle: \"CComApartment Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::CComApartment\"\n  - \"CComApartment\"\n  - \"ATL.CComApartment\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"apartments in ATL EXE modules\"\n  - \"CComApartment class\"\nms.assetid: dbc177d7-7ee4-45f2-b563-d578a467ca93\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComApartment Class\nThis class provides support for managing an appartment in a thread-pooled EXE module.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\nclass CComApartment\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComApartment::CComApartment](#ccomapartment__ccomapartment)|The constructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComApartment::Apartment](#ccomapartment__apartment)|Marks the thread's starting address.|  \n|[CComApartment::GetLockCount](#ccomapartment__getlockcount)|Returns the thread's current lock count.|  \n|[CComApartment::Lock](#ccomapartment__lock)|Increments the thread's lock count.|  \n|[CComApartment::Unlock](#ccomapartment__unlock)|Decrements the thread's lock count.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComApartment::m_dwThreadID](#ccomapartment__m_dwthreadid)|Contains the thread's identifier.|  \n|[CComApartment::m_hThread](#ccomapartment__m_hthread)|Contains the thread's handle.|  \n|[CComApartment::m_nLockCnt](#ccomapartment__m_nlockcnt)|Contains the thread's current lock count.|  \n  \n## Remarks  \n `CComApartment` is used by [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) to manage an apartment in a thread-pooled EXE module. `CComApartment` provides methods for incrementing and decrementing the lock count on a thread.  \n  \n## Requirements  \n **Header:** atlbase.h  \n  \n##  <a name=\"ccomapartment__apartment\"></a>  CComApartment::Apartment  \n Marks the thread's starting address.  \n  \n```\nDWORD Apartment();\n```  \n  \n### Return Value  \n Always 0.  \n  \n### Remarks  \n Automatically set during [CComAutoThreadModule::Init](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__init).  \n  \n##  <a name=\"ccomapartment__ccomapartment\"></a>  CComApartment::CComApartment  \n The constructor.  \n  \n```\nCComApartment();\n```  \n  \n### Remarks  \n Initializes the `CComApartment` data members [m_nLockCnt](#ccomapartment__m_nlockcnt) and [m_hThread](#ccomapartment__m_hthread).  \n  \n##  <a name=\"ccomapartment__getlockcount\"></a>  CComApartment::GetLockCount  \n Returns the thread's current lock count.  \n  \n```\nLONG GetLockCount();\n```  \n  \n### Return Value  \n The lock count on the thread.  \n  \n##  <a name=\"ccomapartment__lock\"></a>  CComApartment::Lock  \n Increments the thread's lock count.  \n  \n```\nLONG Lock();\n```  \n  \n### Return Value  \n A value that may be useful for diagnostics or testing.  \n  \n### Remarks  \n Called by [CComAutoThreadModule::Lock](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock).  \n  \n The lock count on the thread is used for statistical purposes.  \n  \n##  <a name=\"ccomapartment__m_dwthreadid\"></a>  CComApartment::m_dwThreadID  \n Contains the thread's identifier.  \n  \n```\nDWORD m_dwThreadID;\n```  \n  \n##  <a name=\"ccomapartment__m_hthread\"></a>  CComApartment::m_hThread  \n Contains the thread's handle.  \n  \n```\nHANDLE m_hThread;\n```  \n  \n##  <a name=\"ccomapartment__m_nlockcnt\"></a>  CComApartment::m_nLockCnt  \n Contains the thread's current lock count.  \n  \n```\nLONG m_nLockCnt;\n```  \n  \n##  <a name=\"ccomapartment__unlock\"></a>  CComApartment::Unlock  \n Decrements the thread's lock count.  \n  \n```\nLONG Unlock();\n```  \n  \n### Return Value  \n A value that may be useful for diagnostics or testing.  \n  \n### Remarks  \n Called by [CComAutoThreadModule::Unlock](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock).  \n  \n The lock count on the thread is used for statistical purposes.  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}