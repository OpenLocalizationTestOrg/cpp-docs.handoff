{"nodes":[{"pos":[12,59],"content":"LoadLibrary and AfxLoadLibrary | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"LoadLibrary and AfxLoadLibrary | Microsoft Docs","pos":[0,47]}]},{"content":"LoadLibrary and AfxLoadLibrary","pos":[739,769]},{"content":"Processes call <bpt id=\"p1\">[</bpt>LoadLibrary<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=259187)</ept> (or <bpt id=\"p2\">[</bpt>AfxLoadLibrary<ept id=\"p2\">](http://msdn.microsoft.com/Library/1339678b-c843-4474-b9c9-8f3bd9905e2e)</ept>) to explicitly link to a DLL.","pos":[770,970],"source":"Processes call [LoadLibrary](http://go.microsoft.com/fwlink/p/?LinkID=259187) (or [AfxLoadLibrary](http://msdn.microsoft.com/Library/1339678b-c843-4474-b9c9-8f3bd9905e2e)) to explicitly link to a DLL."},{"content":"If the function succeeds, it maps the specified DLL into the address space of the calling process and returns a handle to the DLL that can be used with other functions in explicit linking—for example, <ph id=\"ph1\">`GetProcAddress`</ph> and <ph id=\"ph2\">`FreeLibrary`</ph>.","pos":[971,1207],"source":" If the function succeeds, it maps the specified DLL into the address space of the calling process and returns a handle to the DLL that can be used with other functions in explicit linking—for example, `GetProcAddress` and `FreeLibrary`."},{"content":"attempts to locate the DLL by using the same search sequence that is used for implicit linking.","pos":[1228,1323]},{"content":"If the system cannot find the DLL or if the entry-point function returns FALSE, <ph id=\"ph1\">`LoadLibrary`</ph> returns NULL.","pos":[1324,1431],"source":" If the system cannot find the DLL or if the entry-point function returns FALSE, `LoadLibrary` returns NULL."},{"content":"If the call to <ph id=\"ph1\">`LoadLibrary`</ph> specifies a DLL module that is already mapped into the address space of the calling process, the function returns a handle of the DLL and increments the reference count of the module.","pos":[1432,1644],"source":" If the call to `LoadLibrary` specifies a DLL module that is already mapped into the address space of the calling process, the function returns a handle of the DLL and increments the reference count of the module."},{"content":"If the DLL has an entry-point function, the operating system calls the function in the context of the thread that called <ph id=\"ph1\">`LoadLibrary`</ph>.","pos":[1651,1786],"source":"If the DLL has an entry-point function, the operating system calls the function in the context of the thread that called `LoadLibrary`."},{"content":"The entry-point function is not called if the DLL is already attached to the process because of a previous call to <ph id=\"ph1\">`LoadLibrary`</ph> that has no corresponding call to the <ph id=\"ph2\">`FreeLibrary`</ph> function.","pos":[1787,1977],"source":" The entry-point function is not called if the DLL is already attached to the process because of a previous call to `LoadLibrary` that has no corresponding call to the `FreeLibrary` function."},{"content":"For MFC applications that load extension DLLs, we recommend that you use <ph id=\"ph1\">`AfxLoadLibrary`</ph> instead of <ph id=\"ph2\">`LoadLibrary`</ph>.","pos":[1984,2099],"source":"For MFC applications that load extension DLLs, we recommend that you use `AfxLoadLibrary` instead of `LoadLibrary`."},{"content":"handles thread synchronization before you call <ph id=\"ph1\">`LoadLibrary`</ph>.","pos":[2117,2178],"source":" handles thread synchronization before you call `LoadLibrary`."},{"content":"The interface (function prototype) to <ph id=\"ph1\">`AfxLoadLibrary`</ph> is the same as <ph id=\"ph2\">`LoadLibrary`</ph>.","pos":[2179,2263],"source":" The interface (function prototype) to `AfxLoadLibrary` is the same as `LoadLibrary`."},{"content":"If Windows cannot load the DLL, the process can attempt to recover from the error.","pos":[2270,2352]},{"content":"For example, the process could notify the user of the error and ask the user to specify another path to the DLL.","pos":[2353,2465]},{"pos":[2473,2810],"content":"[!IMPORTANT]\n If the code is to run under Windows NT 4, Windows 2000, or Windows XP (prior to SP1), make sure to specify the full path of any DLLs. On these operating systems, the current directory is searched first when files are loaded. If you do not qualify the path of the file, a file that is not the intended one might be loaded.","leadings":["","> "],"nodes":[{"content":" If the code is to run under Windows NT 4, Windows 2000, or Windows XP (prior to SP1), make sure to specify the full path of any DLLs. On these operating systems, the current directory is searched first when files are loaded. If you do not qualify the path of the file, a file that is not the intended one might be loaded.","pos":[13,335],"nodes":[{"content":"If the code is to run under Windows NT 4, Windows 2000, or Windows XP (prior to SP1), make sure to specify the full path of any DLLs.","pos":[1,134]},{"content":"On these operating systems, the current directory is searched first when files are loaded.","pos":[135,225]},{"content":"If you do not qualify the path of the file, a file that is not the intended one might be loaded.","pos":[226,322]}]}]},{"content":"What do you want to do?","pos":[2819,2842]},{"content":"Link implicitly","pos":[2853,2868]},{"content":"Determine which linking method to use","pos":[2912,2949]},{"content":"What do you want to know more about?","pos":[3012,3048]},{"content":"The search path that is used by Windows to locate a DLL","pos":[3059,3114]},{"content":"FreeLibrary and AfxFreeLibrary","pos":[3183,3213]},{"content":"GetProcAddress","pos":[3269,3283]},{"content":"See Also","pos":[3321,3329]},{"content":"DLLs in Visual C++","pos":[3334,3352]},{"content":"LoadLibrary","pos":[3391,3402]},{"content":"AfxLoadLibrary","pos":[3458,3472]}],"content":"---\ntitle: \"LoadLibrary and AfxLoadLibrary | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"LoadLibrary\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DLLs [C++], AfxLoadLibrary\"\n  - \"DLLs [C++], LoadLibrary\"\n  - \"AfxLoadLibrary method\"\n  - \"LoadLibrary method\"\n  - \"explicit linking [C++]\"\nms.assetid: b4535d19-6243-4146-a31a-a5cca4c7c9e3\ncaps.latest.revision: 16\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# LoadLibrary and AfxLoadLibrary\nProcesses call [LoadLibrary](http://go.microsoft.com/fwlink/p/?LinkID=259187) (or [AfxLoadLibrary](http://msdn.microsoft.com/Library/1339678b-c843-4474-b9c9-8f3bd9905e2e)) to explicitly link to a DLL. If the function succeeds, it maps the specified DLL into the address space of the calling process and returns a handle to the DLL that can be used with other functions in explicit linking—for example, `GetProcAddress` and `FreeLibrary`.  \n  \n `LoadLibrary` attempts to locate the DLL by using the same search sequence that is used for implicit linking. If the system cannot find the DLL or if the entry-point function returns FALSE, `LoadLibrary` returns NULL. If the call to `LoadLibrary` specifies a DLL module that is already mapped into the address space of the calling process, the function returns a handle of the DLL and increments the reference count of the module.  \n  \n If the DLL has an entry-point function, the operating system calls the function in the context of the thread that called `LoadLibrary`. The entry-point function is not called if the DLL is already attached to the process because of a previous call to `LoadLibrary` that has no corresponding call to the `FreeLibrary` function.  \n  \n For MFC applications that load extension DLLs, we recommend that you use `AfxLoadLibrary` instead of `LoadLibrary`. `AfxLoadLibrary` handles thread synchronization before you call `LoadLibrary`. The interface (function prototype) to `AfxLoadLibrary` is the same as `LoadLibrary`.  \n  \n If Windows cannot load the DLL, the process can attempt to recover from the error. For example, the process could notify the user of the error and ask the user to specify another path to the DLL.  \n  \n> [!IMPORTANT]\n>  If the code is to run under Windows NT 4, Windows 2000, or Windows XP (prior to SP1), make sure to specify the full path of any DLLs. On these operating systems, the current directory is searched first when files are loaded. If you do not qualify the path of the file, a file that is not the intended one might be loaded.  \n  \n## What do you want to do?  \n  \n-   [Link implicitly](../build/linking-implicitly.md)  \n  \n-   [Determine which linking method to use](../build/determining-which-linking-method-to-use.md)  \n  \n## What do you want to know more about?  \n  \n-   [The search path that is used by Windows to locate a DLL](../build/search-path-used-by-windows-to-locate-a-dll.md)  \n  \n-   [FreeLibrary and AfxFreeLibrary](../build/freelibrary-and-afxfreelibrary.md)  \n  \n-   [GetProcAddress](../build/getprocaddress.md)  \n  \n## See Also  \n [DLLs in Visual C++](../build/dlls-in-visual-cpp.md)   \n [LoadLibrary](http://go.microsoft.com/fwlink/p/?LinkID=259187)   \n [AfxLoadLibrary](http://msdn.microsoft.com/Library/1339678b-c843-4474-b9c9-8f3bd9905e2e)"}