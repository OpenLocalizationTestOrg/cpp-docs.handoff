{"nodes":[{"pos":[12,52],"content":"IRowsetLocateImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IRowsetLocateImpl Class | Microsoft Docs","pos":[0,40]}]},{"content":"IRowsetLocateImpl Class","pos":[674,697]},{"pos":[698,846],"content":"Implements the OLE DB <bpt id=\"p1\">[</bpt>IRowsetLocate<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms721190.aspx)</ept> interface, which fetches arbitrary rows from a rowset.","source":"Implements the OLE DB [IRowsetLocate](https://msdn.microsoft.com/en-us/library/ms721190.aspx) interface, which fetches arbitrary rows from a rowset."},{"content":"Syntax","pos":[855,861]},{"content":"Parameters","pos":[1316,1326]},{"content":"A class derived from <ph id=\"ph1\">`IRowsetLocateImpl`</ph>.","pos":[1337,1378],"source":" A class derived from `IRowsetLocateImpl`."},{"content":"A class derived from <ph id=\"ph1\">`IRowsetImpl`</ph>.","pos":[1406,1441],"source":" A class derived from `IRowsetImpl`."},{"content":"The storage unit for the <bpt id=\"p1\">**</bpt>HROW<ept id=\"p1\">**</ept>.","pos":[1462,1496],"source":" The storage unit for the **HROW**."},{"content":"The storage unit for all row handles held by the provider.","pos":[1517,1575]},{"content":"The type of the bookmark, such as a LONG or a string.","pos":[1603,1656]},{"content":"Ordinary bookmarks must have a length of at least two bytes.","pos":[1657,1717]},{"content":"(Single-byte length is reserved for the OLE DB <bpt id=\"p1\">[</bpt>standard bookmarks<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms712954.aspx)</ept><bpt id=\"p2\">**</bpt>DBBMK_FIRST<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>DBBMK_LAST<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>DBBMK_INVALID<ept id=\"p4\">**</ept>.)","pos":[1718,1897],"source":" (Single-byte length is reserved for the OLE DB [standard bookmarks](https://msdn.microsoft.com/en-us/library/ms712954.aspx)**DBBMK_FIRST**, **DBBMK_LAST**, and **DBBMK_INVALID**.)"},{"content":"The mapping mechanism for maintaining bookmark-to-data relationships.","pos":[1922,1991]},{"content":"The storage unit for all row handles held by the bookmark.","pos":[2020,2078]},{"content":"Members","pos":[2087,2094]},{"content":"Interface Methods","pos":[2104,2121]},{"content":"Compare","pos":[2143,2150]},{"content":"Compares two bookmarks.","pos":[2199,2222]},{"content":"GetRowsAt","pos":[2228,2237]},{"content":"Fetches rows starting with the row specified by an offset from a bookmark.","pos":[2288,2362]},{"content":"GetRowsByBookmark","pos":[2368,2385]},{"content":"Fetches the rows that match the specified bookmarks.","pos":[2444,2496]},{"content":"Hash","pos":[2502,2506]},{"content":"Returns hash values for the specified bookmarks.","pos":[2552,2600]},{"content":"Data Members","pos":[2611,2623]},{"content":"m_rgBookmarks","pos":[2645,2658]},{"content":"An array of bookmarks.","pos":[2713,2735]},{"content":"Remarks","pos":[2745,2752]},{"content":"is the OLE DB Templates implementation of the <bpt id=\"p1\">[</bpt>IRowsetLocate<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms721190.aspx)</ept> interface.","pos":[2776,2904],"source":" is the OLE DB Templates implementation of the [IRowsetLocate](https://msdn.microsoft.com/en-us/library/ms721190.aspx) interface."},{"content":"is used to fetch arbitrary rows from a rowset.","pos":[2921,2967]},{"content":"A rowset that does not implement this interface is a <ph id=\"ph1\">`sequential`</ph> rowset.","pos":[2968,3041],"source":" A rowset that does not implement this interface is a `sequential` rowset."},{"content":"When <ph id=\"ph1\">`IRowsetLocate`</ph> is present on a rowset, column 0 is the bookmark for the rows; reading this column will obtain a bookmark value that can be used to reposition to the same row.","pos":[3042,3222],"source":" When `IRowsetLocate` is present on a rowset, column 0 is the bookmark for the rows; reading this column will obtain a bookmark value that can be used to reposition to the same row."},{"content":"is used to implement bookmark support in providers.","pos":[3249,3300]},{"content":"Bookmarks are placeholders (indices on a rowset) that enable the consumer to return quickly to a row, allowing high-speed access to data.","pos":[3301,3438]},{"content":"The provider determines what bookmarks can uniquely identify a row.","pos":[3439,3506]},{"content":"Using <ph id=\"ph1\">`IRowsetLocateImpl`</ph> methods, you can compare bookmarks, fetch rows by offset, fetch rows by bookmark, and return hash values for bookmarks.","pos":[3507,3652],"source":" Using `IRowsetLocateImpl` methods, you can compare bookmarks, fetch rows by offset, fetch rows by bookmark, and return hash values for bookmarks."},{"content":"To support OLE DB bookmarks in a rowset, make the rowset inherit from this class.","pos":[3659,3740]},{"pos":[3747,4059],"content":"For information on implementing bookmark support, see <bpt id=\"p1\">[</bpt>Provider Support for Bookmarks<ept id=\"p1\">](../../data/oledb/provider-support-for-bookmarks.md)</ept> in the <bpt id=\"p2\">*</bpt>Visual C++ Programmer's Guide<ept id=\"p2\">*</ept> and <bpt id=\"p3\">[</bpt>Bookmarks<ept id=\"p3\">](https://msdn.microsoft.com/en-us/library/ms709728.aspx)</ept> in the <bpt id=\"p4\">*</bpt>OLE DB Programmer's Reference<ept id=\"p4\">*</ept> in the <ph id=\"ph1\">`Platform``SDK`</ph>.","source":"For information on implementing bookmark support, see [Provider Support for Bookmarks](../../data/oledb/provider-support-for-bookmarks.md) in the *Visual C++ Programmer's Guide* and [Bookmarks](https://msdn.microsoft.com/en-us/library/ms709728.aspx) in the *OLE DB Programmer's Reference* in the `Platform``SDK`."},{"content":"Requirements","pos":[4068,4080]},{"pos":[4084,4103],"content":"<bpt id=\"p1\">**</bpt>Header<ept id=\"p1\">**</ept>: atldb.h","source":"**Header**: atldb.h"},{"content":"See Also","pos":[4112,4120]},{"content":"OLE DB Provider Templates","pos":[4125,4150]},{"content":"OLE DB Provider Template Architecture","pos":[4208,4245]},{"content":"IRowsetLocate:IRowset","pos":[4311,4332]},{"content":"Provider Support for Bookmarks","pos":[4395,4425]},{"content":"Bookmarks","pos":[4484,4493]}],"content":"---\ntitle: \"IRowsetLocateImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"IRowsetLocateImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"providers, bookmarks\"\n  - \"IRowsetLocateImpl class\"\n  - \"bookmarks, OLE DB\"\nms.assetid: a8aa3149-7ce8-4976-a680-2da193fd3234\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IRowsetLocateImpl Class\nImplements the OLE DB [IRowsetLocate](https://msdn.microsoft.com/en-us/library/ms721190.aspx) interface, which fetches arbitrary rows from a rowset.  \n  \n## Syntax  \n  \n```  \ntemplate <  \n   class T,   \n   class RowsetInterface,   \n   class RowClass = CSimpleRow,   \n   class MapClass = CAtlMap < RowClass::KeyType, RowClass* >,   \n   class BookmarkKeyType = LONG,   \n   class BookmarkType = LONG,   \n   class BookmarkMapClass = CAtlMap < RowClass::KeyType, RowClass* >  \n>  \nclass ATL_NO_VTABLE IRowsetLocateImpl : public IRowsetImpl<  \n   T,   \n   RowsetInterface,   \n   RowClass,   \n   MapClass  \n>  \n```  \n  \n#### Parameters  \n `T`  \n A class derived from `IRowsetLocateImpl`.  \n  \n `RowsetInterface`  \n A class derived from `IRowsetImpl`.  \n  \n `RowClass`  \n The storage unit for the **HROW**.  \n  \n `MapClass`  \n The storage unit for all row handles held by the provider.  \n  \n `BookmarkKeyType`  \n The type of the bookmark, such as a LONG or a string. Ordinary bookmarks must have a length of at least two bytes. (Single-byte length is reserved for the OLE DB [standard bookmarks](https://msdn.microsoft.com/en-us/library/ms712954.aspx)**DBBMK_FIRST**, **DBBMK_LAST**, and **DBBMK_INVALID**.)  \n  \n `BookmarkType`  \n The mapping mechanism for maintaining bookmark-to-data relationships.  \n  \n `BookmarkMapClass`  \n The storage unit for all row handles held by the bookmark.  \n  \n## Members  \n  \n### Interface Methods  \n  \n|||  \n|-|-|  \n|[Compare](../../data/oledb/irowsetlocateimpl-compare.md)|Compares two bookmarks.|  \n|[GetRowsAt](../../data/oledb/irowsetlocateimpl-getrowsat.md)|Fetches rows starting with the row specified by an offset from a bookmark.|  \n|[GetRowsByBookmark](../../data/oledb/irowsetlocateimpl-getrowsbybookmark.md)|Fetches the rows that match the specified bookmarks.|  \n|[Hash](../../data/oledb/irowsetlocateimpl-hash.md)|Returns hash values for the specified bookmarks.|  \n  \n### Data Members  \n  \n|||  \n|-|-|  \n|[m_rgBookmarks](../../data/oledb/irowsetlocateimpl-m-rgbookmarks.md)|An array of bookmarks.|  \n  \n## Remarks  \n `IRowsetLocateImpl` is the OLE DB Templates implementation of the [IRowsetLocate](https://msdn.microsoft.com/en-us/library/ms721190.aspx) interface. `IRowsetLocate` is used to fetch arbitrary rows from a rowset. A rowset that does not implement this interface is a `sequential` rowset. When `IRowsetLocate` is present on a rowset, column 0 is the bookmark for the rows; reading this column will obtain a bookmark value that can be used to reposition to the same row.  \n  \n `IRowsetLocateImpl` is used to implement bookmark support in providers. Bookmarks are placeholders (indices on a rowset) that enable the consumer to return quickly to a row, allowing high-speed access to data. The provider determines what bookmarks can uniquely identify a row. Using `IRowsetLocateImpl` methods, you can compare bookmarks, fetch rows by offset, fetch rows by bookmark, and return hash values for bookmarks.  \n  \n To support OLE DB bookmarks in a rowset, make the rowset inherit from this class.  \n  \n For information on implementing bookmark support, see [Provider Support for Bookmarks](../../data/oledb/provider-support-for-bookmarks.md) in the *Visual C++ Programmer's Guide* and [Bookmarks](https://msdn.microsoft.com/en-us/library/ms709728.aspx) in the *OLE DB Programmer's Reference* in the `Platform``SDK`.  \n  \n## Requirements  \n **Header**: atldb.h  \n  \n## See Also  \n [OLE DB Provider Templates](../../data/oledb/ole-db-provider-templates-cpp.md)   \n [OLE DB Provider Template Architecture](../../data/oledb/ole-db-provider-template-architecture.md)   \n [IRowsetLocate:IRowset](https://msdn.microsoft.com/en-us/library/ms721190.aspx)   \n [Provider Support for Bookmarks](../../data/oledb/provider-support-for-bookmarks.md)   \n [Bookmarks](https://msdn.microsoft.com/en-us/library/ms709728.aspx)"}