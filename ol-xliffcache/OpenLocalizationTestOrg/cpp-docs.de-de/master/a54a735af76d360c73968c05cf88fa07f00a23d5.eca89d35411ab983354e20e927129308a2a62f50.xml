{"nodes":[{"pos":[12,64],"content":"Recordset: Filtering Records (ODBC) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Recordset: Filtering Records (ODBC) | Microsoft Docs","pos":[0,52]}]},{"content":"Recordset: Filtering Records (ODBC)","pos":[740,775]},{"content":"This topic applies to the MFC ODBC classes.","pos":[776,819]},{"content":"This topic explains how to filter a recordset so that it selects only a particular subset of the available records.","pos":[826,941]},{"content":"For example, you might want to select only the class sections for a particular course, such as MATH101.","pos":[942,1045]},{"content":"A filter is a search condition defined by the contents of a SQL <bpt id=\"p1\">**</bpt>WHERE<ept id=\"p1\">**</ept> clause.","pos":[1046,1127],"source":" A filter is a search condition defined by the contents of a SQL **WHERE** clause."},{"content":"When the framework appends it to the recordset's SQL statement, the <bpt id=\"p1\">**</bpt>WHERE<ept id=\"p1\">**</ept> clause constrains the selection.","pos":[1128,1238],"source":" When the framework appends it to the recordset's SQL statement, the **WHERE** clause constrains the selection."},{"pos":[1245,1516],"content":"You must establish a recordset object's filter after you construct the object but before you call its <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> member function (or before you call the <bpt id=\"p2\">**</bpt>Requery<ept id=\"p2\">**</ept> member function for an existing recordset object whose <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept> member function has been called previously).","source":"You must establish a recordset object's filter after you construct the object but before you call its **Open** member function (or before you call the **Requery** member function for an existing recordset object whose **Open** member function has been called previously)."},{"content":"To specify a filter for a recordset object","pos":[1527,1569]},{"pos":[1579,1668],"content":"Construct a new recordset object (or prepare to call <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> for an existing object).","source":"Construct a new recordset object (or prepare to call **Requery** for an existing object)."},{"pos":[1678,1799],"content":"Set the value of the object's <bpt id=\"p1\">[</bpt>m_strFilter<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__m_strfilter)</ept> data member.","source":"Set the value of the object's [m_strFilter](../../mfc/reference/crecordset-class.md#crecordset__m_strfilter) data member."},{"content":"The filter is a null-terminated string that contains the contents of the SQL <bpt id=\"p1\">**</bpt>WHERE<ept id=\"p1\">**</ept> clause but not the keyword <bpt id=\"p2\">**</bpt>WHERE<ept id=\"p2\">**</ept>.","pos":[1810,1934],"source":"The filter is a null-terminated string that contains the contents of the SQL **WHERE** clause but not the keyword **WHERE**."},{"content":"For example, use:","pos":[1935,1952]},{"content":"not","pos":[2038,2041]},{"pos":[2134,2477],"content":"[!NOTE]\n The literal string \"MATH101\" is shown with single quotation marks above. In the ODBC SQL specification, single quotes are used to denote a character string literal. Check your ODBC driver documentation for the quoting requirements of your DBMS in this situation. This syntax is also discussed further near the end of this topic.","leadings":["","    > "],"nodes":[{"content":" The literal string \"MATH101\" is shown with single quotation marks above. In the ODBC SQL specification, single quotes are used to denote a character string literal. Check your ODBC driver documentation for the quoting requirements of your DBMS in this situation. This syntax is also discussed further near the end of this topic.","pos":[8,337],"nodes":[{"content":"The literal string \"MATH101\" is shown with single quotation marks above.","pos":[1,73]},{"content":"In the ODBC SQL specification, single quotes are used to denote a character string literal.","pos":[74,165]},{"content":"Check your ODBC driver documentation for the quoting requirements of your DBMS in this situation.","pos":[166,263]},{"content":"This syntax is also discussed further near the end of this topic.","pos":[264,329]}]}]},{"content":"Set any other options you need, such as sort order, locking mode, or parameters.","pos":[2487,2567]},{"content":"Specifying a parameter is especially useful.","pos":[2568,2612]},{"content":"For information about parameterizing your filter, see <bpt id=\"p1\">[</bpt>Recordset: Parameterizing a Recordset (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)</ept>.","pos":[2613,2776],"source":" For information about parameterizing your filter, see [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)."},{"pos":[2786,2867],"content":"Call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> for the new object (or <bpt id=\"p2\">**</bpt>Requery<ept id=\"p2\">**</ept> for a previously opened object).","source":"Call **Open** for the new object (or **Requery** for a previously opened object)."},{"pos":[2875,2981],"content":"[!TIP]\n Using parameters in your filter is potentially the most efficient method for retrieving records.","leadings":["","> "],"nodes":[{"content":"Using parameters in your filter is potentially the most efficient method for retrieving records.","pos":[8,104]}]},{"pos":[2989,3247],"content":"[!TIP]\n Recordset filters are useful for [joining](../../data/odbc/recordset-performing-a-join-odbc.md) tables and for using [parameters](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) based on information obtained or calculated at run time.","leadings":["","> "],"nodes":[{"content":"Recordset filters are useful for <bpt id=\"p1\">[</bpt>joining<ept id=\"p1\">](../../data/odbc/recordset-performing-a-join-odbc.md)</ept> tables and for using <bpt id=\"p2\">[</bpt>parameters<ept id=\"p2\">](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)</ept> based on information obtained or calculated at run time.","pos":[8,256],"source":" Recordset filters are useful for [joining](../../data/odbc/recordset-performing-a-join-odbc.md) tables and for using [parameters](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) based on information obtained or calculated at run time."}]},{"content":"The recordset selects only those records that meet the search condition you specified.","pos":[3254,3340]},{"content":"For example, to specify the course filter described above (assuming a variable <ph id=\"ph1\">`strCourseID`</ph> currently set, for instance, to \"MATH101\"), do the following:","pos":[3341,3495],"source":" For example, to specify the course filter described above (assuming a variable `strCourseID` currently set, for instance, to \"MATH101\"), do the following:"},{"content":"The recordset contains records for all class sections for MATH101.","pos":[3787,3853]},{"content":"Notice how the filter string was set in the example above, using a string variable.","pos":[3860,3943]},{"content":"This is the typical usage.","pos":[3944,3970]},{"content":"But suppose you wanted to specify the literal value 100 for the course ID.","pos":[3971,4045]},{"content":"The following code shows how to set the filter string correctly with a literal value:","pos":[4046,4131]},{"pos":[4203,4312],"content":"Note the use of single quote characters; if you set the filter string directly, the filter string is <bpt id=\"p1\">**</bpt>not<ept id=\"p1\">**</ept>:","source":"Note the use of single quote characters; if you set the filter string directly, the filter string is **not**:"},{"content":"The quoting shown above conforms to the ODBC specification, but some DBMSs might require other quote characters.","pos":[4401,4513]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>SQL: Customizing Your Recordset's SQL Statement (ODBC)<ept id=\"p1\">](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)</ept>.","pos":[4514,4668],"source":" For more information, see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)."},{"pos":[4676,5053],"content":"[!NOTE]\n If you choose to override the recordset's default SQL string by passing your own SQL string to **Open**, you should not set a filter if your custom string has a **WHERE** clause. For more information about overriding the default SQL, see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).","leadings":["","> "],"nodes":[{"content":" If you choose to override the recordset's default SQL string by passing your own SQL string to **Open**, you should not set a filter if your custom string has a **WHERE** clause. For more information about overriding the default SQL, see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).","pos":[8,375],"nodes":[{"content":"If you choose to override the recordset's default SQL string by passing your own SQL string to <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>, you should not set a filter if your custom string has a <bpt id=\"p2\">**</bpt>WHERE<ept id=\"p2\">**</ept> clause.","pos":[1,179],"source":" If you choose to override the recordset's default SQL string by passing your own SQL string to **Open**, you should not set a filter if your custom string has a **WHERE** clause."},{"content":"For more information about overriding the default SQL, see <bpt id=\"p1\">[</bpt>SQL: Customizing Your Recordset's SQL Statement (ODBC)<ept id=\"p1\">](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)</ept>.","pos":[180,367],"source":" For more information about overriding the default SQL, see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)."}]}]},{"content":"See Also","pos":[5062,5070]},{"content":"Recordset (ODBC)","pos":[5075,5091]},{"content":"Recordset: Sorting Records (ODBC)","pos":[5133,5166]},{"content":"Recordset: How Recordsets Select Records (ODBC)","pos":[5224,5271]},{"content":"Recordset: How Recordsets Update Records (ODBC)","pos":[5343,5390]},{"content":"Recordset: Locking Records (ODBC)","pos":[5462,5495]}],"content":"---\ntitle: \"Recordset: Filtering Records (ODBC) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"data [MFC], filtering\"\n  - \"recordsets [C++], filtering\"\n  - \"filtering recordsets\"\n  - \"ODBC recordsets [C++], filtering records\"\n  - \"filters [C++], recordset object\"\nms.assetid: 5c075f37-c837-464d-90c1-d028a9d1c175\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Recordset: Filtering Records (ODBC)\nThis topic applies to the MFC ODBC classes.  \n  \n This topic explains how to filter a recordset so that it selects only a particular subset of the available records. For example, you might want to select only the class sections for a particular course, such as MATH101. A filter is a search condition defined by the contents of a SQL **WHERE** clause. When the framework appends it to the recordset's SQL statement, the **WHERE** clause constrains the selection.  \n  \n You must establish a recordset object's filter after you construct the object but before you call its **Open** member function (or before you call the **Requery** member function for an existing recordset object whose **Open** member function has been called previously).  \n  \n#### To specify a filter for a recordset object  \n  \n1.  Construct a new recordset object (or prepare to call **Requery** for an existing object).  \n  \n2.  Set the value of the object's [m_strFilter](../../mfc/reference/crecordset-class.md#crecordset__m_strfilter) data member.  \n  \n     The filter is a null-terminated string that contains the contents of the SQL **WHERE** clause but not the keyword **WHERE**. For example, use:  \n  \n    ```  \n    m_pSet->m_strFilter = \"CourseID = 'MATH101'\";  \n    ```  \n  \n     not  \n  \n    ```  \n    m_pSet->m_strFilter = \"WHERE CourseID = 'MATH101'\";  \n    ```  \n  \n    > [!NOTE]\n    >  The literal string \"MATH101\" is shown with single quotation marks above. In the ODBC SQL specification, single quotes are used to denote a character string literal. Check your ODBC driver documentation for the quoting requirements of your DBMS in this situation. This syntax is also discussed further near the end of this topic.  \n  \n3.  Set any other options you need, such as sort order, locking mode, or parameters. Specifying a parameter is especially useful. For information about parameterizing your filter, see [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).  \n  \n4.  Call **Open** for the new object (or **Requery** for a previously opened object).  \n  \n> [!TIP]\n>  Using parameters in your filter is potentially the most efficient method for retrieving records.  \n  \n> [!TIP]\n>  Recordset filters are useful for [joining](../../data/odbc/recordset-performing-a-join-odbc.md) tables and for using [parameters](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) based on information obtained or calculated at run time.  \n  \n The recordset selects only those records that meet the search condition you specified. For example, to specify the course filter described above (assuming a variable `strCourseID` currently set, for instance, to \"MATH101\"), do the following:  \n  \n```  \n// Using the recordset pointed to by m_pSet  \n  \n// Set the filter  \nm_pSet->m_strFilter = \"CourseID = \" + strCourseID;   \n  \n// Run the query with the filter in place  \nif ( m_pSet->Open( CRecordset::snapshot, NULL, CRecordset::readOnly ) )  \n  \n// Use the recordset  \n```  \n  \n The recordset contains records for all class sections for MATH101.  \n  \n Notice how the filter string was set in the example above, using a string variable. This is the typical usage. But suppose you wanted to specify the literal value 100 for the course ID. The following code shows how to set the filter string correctly with a literal value:  \n  \n```  \nm_strFilter = \"StudentID = '100'\";   // correct  \n```  \n  \n Note the use of single quote characters; if you set the filter string directly, the filter string is **not**:  \n  \n```  \nm_strFilter = \"StudentID = 100\";   // incorrect for some drivers  \n```  \n  \n The quoting shown above conforms to the ODBC specification, but some DBMSs might require other quote characters. For more information, see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).  \n  \n> [!NOTE]\n>  If you choose to override the recordset's default SQL string by passing your own SQL string to **Open**, you should not set a filter if your custom string has a **WHERE** clause. For more information about overriding the default SQL, see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).  \n  \n## See Also  \n [Recordset (ODBC)](../../data/odbc/recordset-odbc.md)   \n [Recordset: Sorting Records (ODBC)](../../data/odbc/recordset-sorting-records-odbc.md)   \n [Recordset: How Recordsets Select Records (ODBC)](../../data/odbc/recordset-how-recordsets-select-records-odbc.md)   \n [Recordset: How Recordsets Update Records (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)   \n [Recordset: Locking Records (ODBC)](../../data/odbc/recordset-locking-records-odbc.md)"}