{"nodes":[{"pos":[12,47],"content":"CDBException Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDBException Class | Microsoft Docs","pos":[0,35]}]},{"pos":[741,759],"content":"CDBException Class","linkify":"CDBException Class","nodes":[{"content":"CDBException Class","pos":[0,18]}]},{"content":"Represents an exception condition arising from the database classes.","pos":[760,828]},{"pos":[837,843],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[908,915],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[925,944],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[951,955]},{"content":"Description","pos":[956,967]},{"pos":[1005,1058],"content":"<bpt id=\"p1\">[</bpt>CDBException::m_nRetCode<ept id=\"p1\">](#cdbexception__m_nretcode)</ept>","source":"[CDBException::m_nRetCode](#cdbexception__m_nretcode)"},{"pos":[1059,1138],"content":"Contains an Open Database Connectivity (ODBC) return code, of type <bpt id=\"p1\">**</bpt>RETCODE<ept id=\"p1\">**</ept>.","source":"Contains an Open Database Connectivity (ODBC) return code, of type **RETCODE**."},{"pos":[1143,1196],"content":"<bpt id=\"p1\">[</bpt>CDBException::m_strError<ept id=\"p1\">](#cdbexception__m_strerror)</ept>","source":"[CDBException::m_strError](#cdbexception__m_strerror)"},{"content":"Contains a string that describes the error in alphanumeric terms.","pos":[1197,1262]},{"pos":[1267,1344],"content":"<bpt id=\"p1\">[</bpt>CDBException::m_strStateNativeOrigin<ept id=\"p1\">](#cdbexception__m_strstatenativeorigin)</ept>","source":"[CDBException::m_strStateNativeOrigin](#cdbexception__m_strstatenativeorigin)"},{"content":"Contains a string describing the error in terms of the error codes returned by ODBC.","pos":[1345,1429]},{"pos":[1439,1446],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The class includes two public data members you can use to determine the cause of the exception or to display a text message describing the exception.","pos":[1450,1599]},{"content":"<ph id=\"ph1\">`CDBException`</ph> objects are constructed and thrown by member functions of the database classes.","pos":[1600,1694],"source":"`CDBException` objects are constructed and thrown by member functions of the database classes."},{"pos":[1702,2089],"content":"[!NOTE]\n This class is one of MFC's Open Database Connectivity (ODBC) classes. If you are instead using the newer Data Access Objects (DAO) classes, use [CDaoException](../../mfc/reference/cdaoexception-class.md) instead. All DAO class names have \"CDao\" as a prefix. For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md).","leadings":["","> "],"nodes":[{"content":" This class is one of MFC's Open Database Connectivity (ODBC) classes. If you are instead using the newer Data Access Objects (DAO) classes, use [CDaoException](../../mfc/reference/cdaoexception-class.md) instead. All DAO class names have \"CDao\" as a prefix. For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md).","pos":[8,385],"nodes":[{"content":"This class is one of MFC's Open Database Connectivity (ODBC) classes.","pos":[1,70]},{"content":"If you are instead using the newer Data Access Objects (DAO) classes, use <bpt id=\"p1\">[</bpt>CDaoException<ept id=\"p1\">](../../mfc/reference/cdaoexception-class.md)</ept> instead.","pos":[71,213],"source":" If you are instead using the newer Data Access Objects (DAO) classes, use [CDaoException](../../mfc/reference/cdaoexception-class.md) instead."},{"content":"All DAO class names have \"CDao\" as a prefix.","pos":[214,258]},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Overview: Database Programming<ept id=\"p1\">](../../data/data-access-programming-mfc-atl.md)</ept>.","pos":[259,377],"source":" For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md)."}]}]},{"content":"Exceptions are cases of abnormal execution involving conditions outside the program's control, such as data source or network I/O errors.","pos":[2096,2233]},{"content":"Errors that you might expect to see in the normal course of executing your program are usually not considered exceptions.","pos":[2234,2355]},{"content":"You can access these objects within the scope of a <bpt id=\"p1\">**</bpt>CATCH<ept id=\"p1\">**</ept> expression.","pos":[2362,2434],"source":"You can access these objects within the scope of a **CATCH** expression."},{"content":"You can also throw <ph id=\"ph1\">`CDBException`</ph> objects from your own code with the <ph id=\"ph2\">`AfxThrowDBException`</ph> global function.","pos":[2435,2543],"source":" You can also throw `CDBException` objects from your own code with the `AfxThrowDBException` global function."},{"pos":[2550,2808],"content":"For more information about exception handling in general, or about <ph id=\"ph1\">`CDBException`</ph> objects, see the articles <bpt id=\"p1\">[</bpt>Exception Handling (MFC)<ept id=\"p1\">](../../mfc/exception-handling-in-mfc.md)</ept> and <bpt id=\"p2\">[</bpt>Exceptions: Database Exceptions<ept id=\"p2\">](../../mfc/exceptions-database-exceptions.md)</ept>.","source":"For more information about exception handling in general, or about `CDBException` objects, see the articles [Exception Handling (MFC)](../../mfc/exception-handling-in-mfc.md) and [Exceptions: Database Exceptions](../../mfc/exceptions-database-exceptions.md)."},{"pos":[2817,2838],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2842,2889],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[2896,2949],"content":"<bpt id=\"p1\">[</bpt>CException<ept id=\"p1\">](../../mfc/reference/cexception-class.md)</ept>","source":"[CException](../../mfc/reference/cexception-class.md)"},{"pos":[2979,2991],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2995,3014],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdb.h","source":"**Header:** afxdb.h"},{"pos":[3024,3089],"content":"<bpt id=\"p1\">&lt;a name=\"cdbexception__m_nretcode\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDBException::m_nRetCode","linkify":"<a name=\"cdbexception__m_nretcode\"></a>  CDBException::m_nRetCode","source":"<a name=\"cdbexception__m_nretcode\"></a>  CDBException::m_nRetCode"},{"pos":[3093,3210],"content":"Contains an ODBC error code of type <bpt id=\"p1\">**</bpt>RETCODE<ept id=\"p1\">**</ept> returned by an ODBC application programming interface (API) function.","source":"Contains an ODBC error code of type **RETCODE** returned by an ODBC application programming interface (API) function."},{"pos":[3220,3227],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This type includes SQL-prefixed codes defined by ODBC and AFX_SQL-prefixed codes defined by the database classes.","pos":[3231,3344]},{"content":"For a <ph id=\"ph1\">`CDBException`</ph>, this member will contain one of the following values:","pos":[3345,3420],"source":" For a `CDBException`, this member will contain one of the following values:"},{"pos":[3428,3605],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_API_CONFORMANCE<ept id=\"p1\">**</ept> The driver for a <ph id=\"ph1\">`CDatabase::OpenEx`</ph> or <ph id=\"ph2\">`CDatabase::Open`</ph> call does not conform to required ODBC API Conformance level 1 ( <bpt id=\"p2\">**</bpt>SQL_OAC_LEVEL1<ept id=\"p2\">**</ept>).","source":"**AFX_SQL_ERROR_API_CONFORMANCE** The driver for a `CDatabase::OpenEx` or `CDatabase::Open` call does not conform to required ODBC API Conformance level 1 ( **SQL_OAC_LEVEL1**)."},{"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_CONNECT_FAIL<ept id=\"p1\">**</ept> Connection to the data source failed.","pos":[3613,3681],"source":"**AFX_SQL_ERROR_CONNECT_FAIL** Connection to the data source failed."},{"content":"You passed a <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept><ph id=\"ph1\">`CDatabase`</ph> pointer to your recordset constructor and the subsequent attempt to create a connection based on <ph id=\"ph2\">`GetDefaultConnect`</ph> failed.","pos":[3682,3839],"source":" You passed a **NULL**`CDatabase` pointer to your recordset constructor and the subsequent attempt to create a connection based on `GetDefaultConnect` failed."},{"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_DATA_TRUNCATED<ept id=\"p1\">**</ept> You requested more data than you have provided storage for.","pos":[3847,3939],"source":"**AFX_SQL_ERROR_DATA_TRUNCATED** You requested more data than you have provided storage for."},{"content":"For information on increasing the provided data storage for <ph id=\"ph1\">`CString`</ph> or <ph id=\"ph2\">`CByteArray`</ph> data types, see the <ph id=\"ph3\">`nMaxLength`</ph> argument for <bpt id=\"p1\">[</bpt>RFX_Text<ept id=\"p1\">](http://msdn.microsoft.com/library/de3c7581-d26c-40cb-81f3-c492ef4809f6)</ept> and <bpt id=\"p2\">[</bpt>RFX_Binary<ept id=\"p2\">](http://msdn.microsoft.com/library/908ff945-3ad0-43a1-9932-cdcdc8b14915)</ept> under \"Macros and Globals.\"","pos":[3940,4271],"source":" For information on increasing the provided data storage for `CString` or `CByteArray` data types, see the `nMaxLength` argument for [RFX_Text](http://msdn.microsoft.com/library/de3c7581-d26c-40cb-81f3-c492ef4809f6) and [RFX_Binary](http://msdn.microsoft.com/library/908ff945-3ad0-43a1-9932-cdcdc8b14915) under \"Macros and Globals.\""},{"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_DYNASET_NOT_SUPPORTED<ept id=\"p1\">**</ept> A call to <ph id=\"ph1\">`CRecordset::Open`</ph> requesting a dynaset failed.","pos":[4279,4376],"source":"**AFX_SQL_ERROR_DYNASET_NOT_SUPPORTED** A call to `CRecordset::Open` requesting a dynaset failed."},{"content":"Dynasets are not supported by the driver.","pos":[4377,4418]},{"pos":[4426,4696],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_EMPTY_COLUMN_LIST<ept id=\"p1\">**</ept> You attempted to open a table (or what you gave could not be identified as a procedure call or <bpt id=\"p2\">**</bpt>SELECT<ept id=\"p2\">**</ept> statement) but there are no columns identified in record field exchange (RFX) function calls in your <ph id=\"ph1\">`DoFieldExchange`</ph> override.","source":"**AFX_SQL_ERROR_EMPTY_COLUMN_LIST** You attempted to open a table (or what you gave could not be identified as a procedure call or **SELECT** statement) but there are no columns identified in record field exchange (RFX) function calls in your `DoFieldExchange` override."},{"pos":[4704,4868],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_FIELD_SCHEMA_MISMATCH<ept id=\"p1\">**</ept> The type of an RFX function in your <ph id=\"ph1\">`DoFieldExchange`</ph> override is not compatible with the column data type in the recordset.","source":"**AFX_SQL_ERROR_FIELD_SCHEMA_MISMATCH** The type of an RFX function in your `DoFieldExchange` override is not compatible with the column data type in the recordset."},{"pos":[4876,5009],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_ILLEGAL_MODE<ept id=\"p1\">**</ept> You called <ph id=\"ph1\">`CRecordset::Update`</ph> without previously calling <ph id=\"ph2\">`CRecordset::AddNew`</ph> or <ph id=\"ph3\">`CRecordset::Edit`</ph>.","source":"**AFX_SQL_ERROR_ILLEGAL_MODE** You called `CRecordset::Update` without previously calling `CRecordset::AddNew` or `CRecordset::Edit`."},{"pos":[5017,5172],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_LOCK_MODE_NOT_SUPPORTED<ept id=\"p1\">**</ept> Your request to lock records for update could not be fulfilled because your ODBC driver does not support locking.","source":"**AFX_SQL_ERROR_LOCK_MODE_NOT_SUPPORTED** Your request to lock records for update could not be fulfilled because your ODBC driver does not support locking."},{"pos":[5180,5327],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_MULTIPLE_ROWS_AFFECTED<ept id=\"p1\">**</ept> You called <ph id=\"ph1\">`CRecordset::Update`</ph> or <bpt id=\"p2\">**</bpt>Delete<ept id=\"p2\">**</ept> for a table with no unique key and changed multiple records.","source":"**AFX_SQL_ERROR_MULTIPLE_ROWS_AFFECTED** You called `CRecordset::Update` or **Delete** for a table with no unique key and changed multiple records."},{"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_NO_CURRENT_RECORD<ept id=\"p1\">**</ept> You attempted to edit or delete a previously deleted record.","pos":[5335,5431],"source":"**AFX_SQL_ERROR_NO_CURRENT_RECORD** You attempted to edit or delete a previously deleted record."},{"content":"You must scroll to a new current record after a deletion.","pos":[5432,5489]},{"pos":[5497,5648],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_NO_POSITIONED_UPDATES<ept id=\"p1\">**</ept> Your request for a dynaset could not be fulfilled because your ODBC driver does not support positioned updates.","source":"**AFX_SQL_ERROR_NO_POSITIONED_UPDATES** Your request for a dynaset could not be fulfilled because your ODBC driver does not support positioned updates."},{"pos":[5656,5803],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_NO_ROWS_AFFECTED<ept id=\"p1\">**</ept> You called <ph id=\"ph1\">`CRecordset::Update`</ph> or <bpt id=\"p2\">**</bpt>Delete<ept id=\"p2\">**</ept>, but when the operation began the record could no longer be found.","source":"**AFX_SQL_ERROR_NO_ROWS_AFFECTED** You called `CRecordset::Update` or **Delete**, but when the operation began the record could no longer be found."},{"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_ODBC_LOAD_FAILED<ept id=\"p1\">**</ept> An attempt to load the ODBC.DLL failed; Windows could not find or could not load this DLL.","pos":[5811,5936],"source":"**AFX_SQL_ERROR_ODBC_LOAD_FAILED** An attempt to load the ODBC.DLL failed; Windows could not find or could not load this DLL."},{"content":"This error is fatal.","pos":[5937,5957]},{"pos":[5965,6102],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_ODBC_V2_REQUIRED<ept id=\"p1\">**</ept> Your request for a dynaset could not be fulfilled because a Level 2-compliant ODBC driver is required.","source":"**AFX_SQL_ERROR_ODBC_V2_REQUIRED** Your request for a dynaset could not be fulfilled because a Level 2-compliant ODBC driver is required."},{"pos":[6110,6248],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_RECORDSET_FORWARD_ONLY<ept id=\"p1\">**</ept> An attempt to scroll did not succeed because the data source does not support backward scrolling.","source":"**AFX_SQL_ERROR_RECORDSET_FORWARD_ONLY** An attempt to scroll did not succeed because the data source does not support backward scrolling."},{"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_SNAPSHOT_NOT_SUPPORTED<ept id=\"p1\">**</ept> A call to <ph id=\"ph1\">`CRecordset::Open`</ph> requesting a snapshot failed.","pos":[6256,6355],"source":"**AFX_SQL_ERROR_SNAPSHOT_NOT_SUPPORTED** A call to `CRecordset::Open` requesting a snapshot failed."},{"content":"Snapshots are not supported by the driver.","pos":[6356,6398]},{"content":"(This should only occur when the ODBC cursor library â€” ODBCCURS.DLL â€” is not present.)","pos":[6399,6489]},{"pos":[6497,6690],"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_SQL_CONFORMANCE<ept id=\"p1\">**</ept> The driver for a <ph id=\"ph1\">`CDatabase::OpenEx`</ph> or <ph id=\"ph2\">`CDatabase::Open`</ph> call does not conform to the required ODBC SQL Conformance level of \"Minimum\" ( <bpt id=\"p2\">**</bpt>SQL_OSC_MINIMUM<ept id=\"p2\">**</ept>).","source":"**AFX_SQL_ERROR_SQL_CONFORMANCE** The driver for a `CDatabase::OpenEx` or `CDatabase::Open` call does not conform to the required ODBC SQL Conformance level of \"Minimum\" ( **SQL_OSC_MINIMUM**)."},{"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_SQL_NO_TOTAL<ept id=\"p1\">**</ept> The ODBC driver was unable to specify the total size of a <ph id=\"ph1\">`CLongBinary`</ph> data value.","pos":[6698,6812],"source":"**AFX_SQL_ERROR_SQL_NO_TOTAL** The ODBC driver was unable to specify the total size of a `CLongBinary` data value."},{"content":"The operation probably failed because a global memory block could not be preallocated.","pos":[6813,6899]},{"content":"<bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_RECORDSET_READONLY<ept id=\"p1\">**</ept> You attempted to update a read-only recordset, or the data source is read-only.","pos":[6907,7023],"source":"**AFX_SQL_ERROR_RECORDSET_READONLY** You attempted to update a read-only recordset, or the data source is read-only."},{"content":"No update operations can be performed with the recordset or the <ph id=\"ph1\">`CDatabase`</ph> object it is associated with.","pos":[7024,7129],"source":" No update operations can be performed with the recordset or the `CDatabase` object it is associated with."},{"content":"<bpt id=\"p1\">**</bpt>SQL_ERROR<ept id=\"p1\">**</ept> Function failed.","pos":[7137,7167],"source":"**SQL_ERROR** Function failed."},{"content":"The error message returned by the ODBC function <bpt id=\"p1\">**</bpt>SQLError<ept id=\"p1\">**</ept> is stored in the <bpt id=\"p2\">**</bpt>m_strError<ept id=\"p2\">**</ept> data member.","pos":[7168,7273],"source":" The error message returned by the ODBC function **SQLError** is stored in the **m_strError** data member."},{"content":"<bpt id=\"p1\">**</bpt>SQL_INVALID_HANDLE<ept id=\"p1\">**</ept> Function failed due to an invalid environment handle, connection handle, or statement handle.","pos":[7281,7397],"source":"**SQL_INVALID_HANDLE** Function failed due to an invalid environment handle, connection handle, or statement handle."},{"content":"This indicates a programming error.","pos":[7398,7433]},{"content":"No additional information is available from the ODBC function <bpt id=\"p1\">**</bpt>SQLError<ept id=\"p1\">**</ept>.","pos":[7434,7509],"source":" No additional information is available from the ODBC function **SQLError**."},{"content":"The SQL-prefixed codes are defined by ODBC.","pos":[7516,7559]},{"content":"The AFX-prefixed codes are defined in AFXDB.H, found in MFC\\INCLUDE.","pos":[7560,7628]},{"pos":[7638,7703],"content":"<bpt id=\"p1\">&lt;a name=\"cdbexception__m_strerror\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDBException::m_strError","linkify":"<a name=\"cdbexception__m_strerror\"></a>  CDBException::m_strError","source":"<a name=\"cdbexception__m_strerror\"></a>  CDBException::m_strError"},{"content":"Contains a string describing the error that caused the exception.","pos":[7707,7772]},{"pos":[7782,7789],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The string describes the error in alphanumeric terms.","pos":[7793,7846]},{"content":"For more detailed information and an example, see <bpt id=\"p1\">**</bpt>m_strStateNativeOrigin<ept id=\"p1\">**</ept>.","pos":[7847,7924],"source":" For more detailed information and an example, see **m_strStateNativeOrigin**."},{"pos":[7934,8023],"content":"<bpt id=\"p1\">&lt;a name=\"cdbexception__m_strstatenativeorigin\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDBException::m_strStateNativeOrigin","linkify":"<a name=\"cdbexception__m_strstatenativeorigin\"></a>  CDBException::m_strStateNativeOrigin","source":"<a name=\"cdbexception__m_strstatenativeorigin\"></a>  CDBException::m_strStateNativeOrigin"},{"content":"Contains a string describing the error that caused the exception.","pos":[8027,8092]},{"pos":[8102,8109],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The string is of the form \"State:%s,Native:%ld,Origin:%s\", where the format codes, in order, are replaced by values that describe:","pos":[8113,8243]},{"content":"The <bpt id=\"p1\">**</bpt>SQLSTATE<ept id=\"p1\">**</ept>, a null-terminated string containing a five-character error code returned in the <bpt id=\"p2\">*</bpt>szSqlState<ept id=\"p2\">*</ept> parameter of the ODBC function <bpt id=\"p3\">**</bpt>SQLError<ept id=\"p3\">**</ept>.","pos":[8253,8408],"source":"The **SQLSTATE**, a null-terminated string containing a five-character error code returned in the *szSqlState* parameter of the ODBC function **SQLError**."},{"content":"<bpt id=\"p1\">**</bpt>SQLSTATE<ept id=\"p1\">**</ept> values are listed in Appendix A, <bpt id=\"p2\">[</bpt>ODBC Error Codes<ept id=\"p2\">](https://msdn.microsoft.com/library/ms714687.aspx)</ept>, in the <bpt id=\"p3\">*</bpt>ODBC Programmer's Reference<ept id=\"p3\">*</ept>.","pos":[8409,8562],"source":"**SQLSTATE** values are listed in Appendix A, [ODBC Error Codes](https://msdn.microsoft.com/library/ms714687.aspx), in the *ODBC Programmer's Reference*."},{"content":"Example: \"S0022\".","pos":[8563,8580]},{"content":"The native error code, specific to the data source, returned in the <bpt id=\"p1\">*</bpt>pfNativeError<ept id=\"p1\">*</ept> parameter of the <bpt id=\"p2\">**</bpt>SQLError<ept id=\"p2\">**</ept> function.","pos":[8590,8713],"source":"The native error code, specific to the data source, returned in the *pfNativeError* parameter of the **SQLError** function."},{"content":"Example: 207.","pos":[8714,8727]},{"content":"The error message text returned in the <bpt id=\"p1\">*</bpt>szErrorMsg<ept id=\"p1\">*</ept> parameter of the <bpt id=\"p2\">**</bpt>SQLError<ept id=\"p2\">**</ept> function.","pos":[8737,8828],"source":"The error message text returned in the *szErrorMsg* parameter of the **SQLError** function."},{"content":"This message consists of several bracketed names.","pos":[8829,8878]},{"content":"As an error is passed from its source to the user, each ODBC component (data source, driver, Driver Manager) appends its own name.","pos":[8879,9009]},{"content":"This information helps to pinpoint the origin of the error.","pos":[9010,9069]},{"content":"Example: [Microsoft][ODBC SQL Server Driver][SQL Server]","pos":[9070,9126]},{"content":"The framework interprets the error string and puts its components into <bpt id=\"p1\">**</bpt>m_strStateNativeOrigin<ept id=\"p1\">**</ept>; if <bpt id=\"p2\">**</bpt>m_strStateNativeOrigin<ept id=\"p2\">**</ept> contains information for more than one error, the errors are separated by newlines.","pos":[9133,9345],"source":"The framework interprets the error string and puts its components into **m_strStateNativeOrigin**; if **m_strStateNativeOrigin** contains information for more than one error, the errors are separated by newlines."},{"content":"The framework puts the alphanumeric error text into <bpt id=\"p1\">**</bpt>m_strError<ept id=\"p1\">**</ept>.","pos":[9346,9413],"source":" The framework puts the alphanumeric error text into **m_strError**."},{"pos":[9420,9607],"content":"For additional information about the codes used to make up this string, see the <bpt id=\"p1\">[</bpt>SQLError<ept id=\"p1\">](https://msdn.microsoft.com/library/ms716312.aspx)</ept> function in the <bpt id=\"p2\">*</bpt>ODBC Programmer's Reference<ept id=\"p2\">*</ept>.","source":"For additional information about the codes used to make up this string, see the [SQLError](https://msdn.microsoft.com/library/ms716312.aspx) function in the *ODBC Programmer's Reference*."},{"pos":[9617,9624],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"From ODBC: \"State:S0022,Native:207,Origin:[Microsoft][ODBC SQL Server Driver][SQL Server] Invalid column name 'ColName'\"","pos":[9629,9749]},{"pos":[9756,9866],"content":"In <bpt id=\"p1\">**</bpt>m_strStateNativeOrigin<ept id=\"p1\">**</ept>: \"State:S0022,Native:207,Origin:[Microsoft][ODBC SQL Server Driver][SQL Server]\"","source":"In **m_strStateNativeOrigin**: \"State:S0022,Native:207,Origin:[Microsoft][ODBC SQL Server Driver][SQL Server]\""},{"pos":[9873,9923],"content":"In <bpt id=\"p1\">**</bpt>m_strError<ept id=\"p1\">**</ept>: \"Invalid column name 'ColName'\"","source":"In **m_strError**: \"Invalid column name 'ColName'\""},{"pos":[9932,9940],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CException Class<ept id=\"p1\">](../../mfc/reference/cexception-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[9944,10004],"source":"[CException Class](../../mfc/reference/cexception-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[10007,10056],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDatabase Class<ept id=\"p1\">](../../mfc/reference/cdatabase-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[10059,10118],"source":" [CDatabase Class](../../mfc/reference/cdatabase-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CRecordset Class<ept id=\"p1\">](../../mfc/reference/crecordset-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[10121,10182],"source":" [CRecordset Class](../../mfc/reference/crecordset-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CFieldExchange Class<ept id=\"p1\">](../../mfc/reference/cfieldexchange-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[10185,10254],"source":" [CFieldExchange Class](../../mfc/reference/cfieldexchange-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CRecordset::Update<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__update)</ept><ph id=\"ph1\"> </ph>","pos":[10257,10339],"source":" [CRecordset::Update](../../mfc/reference/crecordset-class.md#crecordset__update) "},{"content":"<bpt id=\"p1\"> [</bpt>CRecordset::Delete<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__delete)</ept><ph id=\"ph1\"> </ph>","pos":[10342,10424],"source":" [CRecordset::Delete](../../mfc/reference/crecordset-class.md#crecordset__delete) "},{"content":"<bpt id=\"p1\"> [</bpt>CException Class<ept id=\"p1\">](../../mfc/reference/cexception-class.md)</ept>","pos":[10427,10487],"source":" [CException Class](../../mfc/reference/cexception-class.md)"}],"content":"---\ntitle: \"CDBException Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDBException\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CDBException class\"\n  - \"exceptions [C++], database\"\n  - \"database exceptions [C++]\"\n  - \"ODBC classes [C++], exceptions\"\n  - \"errors [C++], database\"\nms.assetid: eb9e1119-89f5-49a7-b9d4-b91cee1ccc82\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDBException Class\nRepresents an exception condition arising from the database classes.  \n  \n## Syntax  \n  \n```  \nclass CDBException : public CException  \n```  \n  \n## Members  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDBException::m_nRetCode](#cdbexception__m_nretcode)|Contains an Open Database Connectivity (ODBC) return code, of type **RETCODE**.|  \n|[CDBException::m_strError](#cdbexception__m_strerror)|Contains a string that describes the error in alphanumeric terms.|  \n|[CDBException::m_strStateNativeOrigin](#cdbexception__m_strstatenativeorigin)|Contains a string describing the error in terms of the error codes returned by ODBC.|  \n  \n## Remarks  \n The class includes two public data members you can use to determine the cause of the exception or to display a text message describing the exception. `CDBException` objects are constructed and thrown by member functions of the database classes.  \n  \n> [!NOTE]\n>  This class is one of MFC's Open Database Connectivity (ODBC) classes. If you are instead using the newer Data Access Objects (DAO) classes, use [CDaoException](../../mfc/reference/cdaoexception-class.md) instead. All DAO class names have \"CDao\" as a prefix. For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md).  \n  \n Exceptions are cases of abnormal execution involving conditions outside the program's control, such as data source or network I/O errors. Errors that you might expect to see in the normal course of executing your program are usually not considered exceptions.  \n  \n You can access these objects within the scope of a **CATCH** expression. You can also throw `CDBException` objects from your own code with the `AfxThrowDBException` global function.  \n  \n For more information about exception handling in general, or about `CDBException` objects, see the articles [Exception Handling (MFC)](../../mfc/exception-handling-in-mfc.md) and [Exceptions: Database Exceptions](../../mfc/exceptions-database-exceptions.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CException](../../mfc/reference/cexception-class.md)  \n  \n `CDBException`  \n  \n## Requirements  \n **Header:** afxdb.h  \n  \n##  <a name=\"cdbexception__m_nretcode\"></a>  CDBException::m_nRetCode  \n Contains an ODBC error code of type **RETCODE** returned by an ODBC application programming interface (API) function.  \n  \n### Remarks  \n This type includes SQL-prefixed codes defined by ODBC and AFX_SQL-prefixed codes defined by the database classes. For a `CDBException`, this member will contain one of the following values:  \n  \n- **AFX_SQL_ERROR_API_CONFORMANCE** The driver for a `CDatabase::OpenEx` or `CDatabase::Open` call does not conform to required ODBC API Conformance level 1 ( **SQL_OAC_LEVEL1**).  \n  \n- **AFX_SQL_ERROR_CONNECT_FAIL** Connection to the data source failed. You passed a **NULL**`CDatabase` pointer to your recordset constructor and the subsequent attempt to create a connection based on `GetDefaultConnect` failed.  \n  \n- **AFX_SQL_ERROR_DATA_TRUNCATED** You requested more data than you have provided storage for. For information on increasing the provided data storage for `CString` or `CByteArray` data types, see the `nMaxLength` argument for [RFX_Text](http://msdn.microsoft.com/library/de3c7581-d26c-40cb-81f3-c492ef4809f6) and [RFX_Binary](http://msdn.microsoft.com/library/908ff945-3ad0-43a1-9932-cdcdc8b14915) under \"Macros and Globals.\"  \n  \n- **AFX_SQL_ERROR_DYNASET_NOT_SUPPORTED** A call to `CRecordset::Open` requesting a dynaset failed. Dynasets are not supported by the driver.  \n  \n- **AFX_SQL_ERROR_EMPTY_COLUMN_LIST** You attempted to open a table (or what you gave could not be identified as a procedure call or **SELECT** statement) but there are no columns identified in record field exchange (RFX) function calls in your `DoFieldExchange` override.  \n  \n- **AFX_SQL_ERROR_FIELD_SCHEMA_MISMATCH** The type of an RFX function in your `DoFieldExchange` override is not compatible with the column data type in the recordset.  \n  \n- **AFX_SQL_ERROR_ILLEGAL_MODE** You called `CRecordset::Update` without previously calling `CRecordset::AddNew` or `CRecordset::Edit`.  \n  \n- **AFX_SQL_ERROR_LOCK_MODE_NOT_SUPPORTED** Your request to lock records for update could not be fulfilled because your ODBC driver does not support locking.  \n  \n- **AFX_SQL_ERROR_MULTIPLE_ROWS_AFFECTED** You called `CRecordset::Update` or **Delete** for a table with no unique key and changed multiple records.  \n  \n- **AFX_SQL_ERROR_NO_CURRENT_RECORD** You attempted to edit or delete a previously deleted record. You must scroll to a new current record after a deletion.  \n  \n- **AFX_SQL_ERROR_NO_POSITIONED_UPDATES** Your request for a dynaset could not be fulfilled because your ODBC driver does not support positioned updates.  \n  \n- **AFX_SQL_ERROR_NO_ROWS_AFFECTED** You called `CRecordset::Update` or **Delete**, but when the operation began the record could no longer be found.  \n  \n- **AFX_SQL_ERROR_ODBC_LOAD_FAILED** An attempt to load the ODBC.DLL failed; Windows could not find or could not load this DLL. This error is fatal.  \n  \n- **AFX_SQL_ERROR_ODBC_V2_REQUIRED** Your request for a dynaset could not be fulfilled because a Level 2-compliant ODBC driver is required.  \n  \n- **AFX_SQL_ERROR_RECORDSET_FORWARD_ONLY** An attempt to scroll did not succeed because the data source does not support backward scrolling.  \n  \n- **AFX_SQL_ERROR_SNAPSHOT_NOT_SUPPORTED** A call to `CRecordset::Open` requesting a snapshot failed. Snapshots are not supported by the driver. (This should only occur when the ODBC cursor library â€” ODBCCURS.DLL â€” is not present.)  \n  \n- **AFX_SQL_ERROR_SQL_CONFORMANCE** The driver for a `CDatabase::OpenEx` or `CDatabase::Open` call does not conform to the required ODBC SQL Conformance level of \"Minimum\" ( **SQL_OSC_MINIMUM**).  \n  \n- **AFX_SQL_ERROR_SQL_NO_TOTAL** The ODBC driver was unable to specify the total size of a `CLongBinary` data value. The operation probably failed because a global memory block could not be preallocated.  \n  \n- **AFX_SQL_ERROR_RECORDSET_READONLY** You attempted to update a read-only recordset, or the data source is read-only. No update operations can be performed with the recordset or the `CDatabase` object it is associated with.  \n  \n- **SQL_ERROR** Function failed. The error message returned by the ODBC function **SQLError** is stored in the **m_strError** data member.  \n  \n- **SQL_INVALID_HANDLE** Function failed due to an invalid environment handle, connection handle, or statement handle. This indicates a programming error. No additional information is available from the ODBC function **SQLError**.  \n  \n The SQL-prefixed codes are defined by ODBC. The AFX-prefixed codes are defined in AFXDB.H, found in MFC\\INCLUDE.  \n  \n##  <a name=\"cdbexception__m_strerror\"></a>  CDBException::m_strError  \n Contains a string describing the error that caused the exception.  \n  \n### Remarks  \n The string describes the error in alphanumeric terms. For more detailed information and an example, see **m_strStateNativeOrigin**.  \n  \n##  <a name=\"cdbexception__m_strstatenativeorigin\"></a>  CDBException::m_strStateNativeOrigin  \n Contains a string describing the error that caused the exception.  \n  \n### Remarks  \n The string is of the form \"State:%s,Native:%ld,Origin:%s\", where the format codes, in order, are replaced by values that describe:  \n  \n-   The **SQLSTATE**, a null-terminated string containing a five-character error code returned in the *szSqlState* parameter of the ODBC function **SQLError**. **SQLSTATE** values are listed in Appendix A, [ODBC Error Codes](https://msdn.microsoft.com/library/ms714687.aspx), in the *ODBC Programmer's Reference*. Example: \"S0022\".  \n  \n-   The native error code, specific to the data source, returned in the *pfNativeError* parameter of the **SQLError** function. Example: 207.  \n  \n-   The error message text returned in the *szErrorMsg* parameter of the **SQLError** function. This message consists of several bracketed names. As an error is passed from its source to the user, each ODBC component (data source, driver, Driver Manager) appends its own name. This information helps to pinpoint the origin of the error. Example: [Microsoft][ODBC SQL Server Driver][SQL Server]  \n  \n The framework interprets the error string and puts its components into **m_strStateNativeOrigin**; if **m_strStateNativeOrigin** contains information for more than one error, the errors are separated by newlines. The framework puts the alphanumeric error text into **m_strError**.  \n  \n For additional information about the codes used to make up this string, see the [SQLError](https://msdn.microsoft.com/library/ms716312.aspx) function in the *ODBC Programmer's Reference*.  \n  \n### Example  \n  From ODBC: \"State:S0022,Native:207,Origin:[Microsoft][ODBC SQL Server Driver][SQL Server] Invalid column name 'ColName'\"  \n  \n In **m_strStateNativeOrigin**: \"State:S0022,Native:207,Origin:[Microsoft][ODBC SQL Server Driver][SQL Server]\"  \n  \n In **m_strError**: \"Invalid column name 'ColName'\"  \n  \n## See Also  \n [CException Class](../../mfc/reference/cexception-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CDatabase Class](../../mfc/reference/cdatabase-class.md)   \n [CRecordset Class](../../mfc/reference/crecordset-class.md)   \n [CFieldExchange Class](../../mfc/reference/cfieldexchange-class.md)   \n [CRecordset::Update](../../mfc/reference/crecordset-class.md#crecordset__update)   \n [CRecordset::Delete](../../mfc/reference/crecordset-class.md#crecordset__delete)   \n [CException Class](../../mfc/reference/cexception-class.md)\n"}