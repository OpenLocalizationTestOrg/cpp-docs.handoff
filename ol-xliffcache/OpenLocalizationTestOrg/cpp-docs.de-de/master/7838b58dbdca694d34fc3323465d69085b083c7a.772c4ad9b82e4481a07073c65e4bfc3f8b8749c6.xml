{"nodes":[{"pos":[12,70],"content":"Drag and Drop: Implementing a Drop Target | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Drag and Drop: Implementing a Drop Target | Microsoft Docs","pos":[0,58]}]},{"content":"Drag and Drop: Implementing a Drop Target","pos":[694,735]},{"content":"This article outlines how to make your application a drop target.","pos":[736,801]},{"content":"Implementing a drop target takes slightly more work than implementing a drop source, but it is still relatively simple.","pos":[802,921]},{"content":"These techniques also apply to non-OLE applications.","pos":[922,974]},{"content":"To implement a drop target","pos":[985,1011]},{"content":"Add a member variable to each view in the application that you want to be a drop target.","pos":[1021,1109]},{"content":"This member variable must be of type <ph id=\"ph1\">`COleDropTarget`</ph> or a class derived from it.","pos":[1110,1191],"source":" This member variable must be of type `COleDropTarget` or a class derived from it."},{"content":"From your view class's function that handles the <ph id=\"ph1\">`WM_CREATE`</ph> message (typically <ph id=\"ph2\">`OnCreate`</ph>), call the new member variable's <ph id=\"ph3\">`Register`</ph> member function.","pos":[1201,1352],"source":"From your view class's function that handles the `WM_CREATE` message (typically `OnCreate`), call the new member variable's `Register` member function."},{"content":"will be called automatically for you when your view is destroyed.","pos":[1362,1427]},{"content":"Override the following functions.","pos":[1437,1470]},{"content":"If you want the same behavior throughout your application, override these functions in your view class.","pos":[1471,1574]},{"content":"If you want to modify behavior in isolated cases or want to enable dropping on non-<ph id=\"ph1\">`CView`</ph> windows, override these functions in your <ph id=\"ph2\">`COleDropTarget`</ph>-derived class.","pos":[1575,1739],"source":" If you want to modify behavior in isolated cases or want to enable dropping on non-`CView` windows, override these functions in your `COleDropTarget`-derived class."},{"content":"Override","pos":[1750,1758]},{"content":"To allow","pos":[1759,1767]},{"content":"Drop operations to occur in the window.","pos":[1828,1867]},{"content":"Called when the cursor first enters the window.","pos":[1868,1915]},{"content":"Special behavior when the drag operation leaves the specified window.","pos":[1938,2007]},{"content":"Drop operations to occur in the window.","pos":[2029,2068]},{"content":"Called when the cursor is being dragged across the window.","pos":[2069,2127]},{"content":"Handling of data being dropped into the specified window.","pos":[2145,2202]},{"content":"Special behavior for when scrolling is necessary in the target window.","pos":[2224,2294]},{"pos":[2302,2451],"content":"See the MAINVIEW.CPP file that is part of the MFC OLE sample <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../visual-cpp-samples.md)</ept> for an example of how these functions work together.","source":"See the MAINVIEW.CPP file that is part of the MFC OLE sample [OCLIENT](../visual-cpp-samples.md) for an example of how these functions work together."},{"content":"For more information, see:","pos":[2458,2484]},{"content":"Implementing a Drop Source","pos":[2495,2521]},{"content":"Creating and Destroying OLE Data Objects and Data Sources","pos":[2585,2642]},{"content":"Manipulating OLE Data Objects and Data Sources","pos":[2720,2766]},{"content":"See Also","pos":[2830,2838]},{"content":"Drag and Drop (OLE)","pos":[2843,2862]},{"content":"COleDropTarget Class","pos":[2898,2918]}],"content":"---\ntitle: \"Drag and Drop: Implementing a Drop Target | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE drag and drop, implementing drop targets\"\n  - \"OLE drag and drop, drop target\"\n  - \"drag and drop, drop target\"\nms.assetid: 0689f1ec-5326-4008-b226-4b373c881358\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Drag and Drop: Implementing a Drop Target\nThis article outlines how to make your application a drop target. Implementing a drop target takes slightly more work than implementing a drop source, but it is still relatively simple. These techniques also apply to non-OLE applications.  \n  \n#### To implement a drop target  \n  \n1.  Add a member variable to each view in the application that you want to be a drop target. This member variable must be of type `COleDropTarget` or a class derived from it.  \n  \n2.  From your view class's function that handles the `WM_CREATE` message (typically `OnCreate`), call the new member variable's `Register` member function. `Revoke` will be called automatically for you when your view is destroyed.  \n  \n3.  Override the following functions. If you want the same behavior throughout your application, override these functions in your view class. If you want to modify behavior in isolated cases or want to enable dropping on non-`CView` windows, override these functions in your `COleDropTarget`-derived class.  \n  \n    |Override|To allow|  \n    |--------------|--------------|  \n    |`OnDragEnter`|Drop operations to occur in the window. Called when the cursor first enters the window.|  \n    |`OnDragLeave`|Special behavior when the drag operation leaves the specified window.|  \n    |`OnDragOver`|Drop operations to occur in the window. Called when the cursor is being dragged across the window.|  \n    |`OnDrop`|Handling of data being dropped into the specified window.|  \n    |`OnScrollBy`|Special behavior for when scrolling is necessary in the target window.|  \n  \n See the MAINVIEW.CPP file that is part of the MFC OLE sample [OCLIENT](../visual-cpp-samples.md) for an example of how these functions work together.  \n  \n For more information, see:  \n  \n-   [Implementing a Drop Source](../mfc/drag-and-drop-implementing-a-drop-source.md)  \n  \n-   [Creating and Destroying OLE Data Objects and Data Sources](../mfc/data-objects-and-data-sources-creation-and-destruction.md)  \n  \n-   [Manipulating OLE Data Objects and Data Sources](../mfc/data-objects-and-data-sources-manipulation.md)  \n  \n## See Also  \n [Drag and Drop (OLE)](../mfc/drag-and-drop-ole.md)   \n [COleDropTarget Class](../mfc/reference/coledroptarget-class.md)\n"}