{"nodes":[{"pos":[12,57],"content":"Linker Tools Warning LNK4049 | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Linker Tools Warning LNK4049 | Microsoft Docs","pos":[0,45]}]},{"content":"Linker Tools Warning LNK4049","pos":[610,638]},{"content":"locally defined symbol 'symbol' imported","pos":[639,679]},{"content":"The symbol was both exported from and imported to the program.","pos":[686,748]},{"pos":[755,976],"content":"This warning is generated by the linker when you declare a symbol by using the <ph id=\"ph1\">`__declspec(dllexport)`</ph> storage-class attribute in one object file and reference it by using the <ph id=\"ph2\">`__declspec(dllimport)`</ph> attribute in another.","source":"This warning is generated by the linker when you declare a symbol by using the `__declspec(dllexport)` storage-class attribute in one object file and reference it by using the `__declspec(dllimport)` attribute in another."},{"content":"Warning LNK4049 is a more general version of <bpt id=\"p1\">[</bpt>Linker Tools Warning LNK4217<ept id=\"p1\">](../../error-messages/tool-errors/linker-tools-warning-lnk4217.md)</ept>.","pos":[983,1125],"source":"Warning LNK4049 is a more general version of [Linker Tools Warning LNK4217](../../error-messages/tool-errors/linker-tools-warning-lnk4217.md)."},{"content":"The linker generates Warning LNK4049 when it cannot determine from which function the imported symbol was referenced.","pos":[1126,1243]},{"content":"The common cases where LNK4049 is generated instead of LNK4217 are:","pos":[1250,1317]},{"pos":[1327,1450],"content":"Performing incremental linking by using the <bpt id=\"p1\">[</bpt>/INCREMENTAL<ept id=\"p1\">](../../build/reference/incremental-link-incrementally.md)</ept> option.","source":"Performing incremental linking by using the [/INCREMENTAL](../../build/reference/incremental-link-incrementally.md) option."},{"pos":[1460,1583],"content":"Performing whole-program optimization by using the <bpt id=\"p1\">[</bpt>/LTCG<ept id=\"p1\">](../../build/reference/ltcg-link-time-code-generation.md)</ept> option.","source":"Performing whole-program optimization by using the [/LTCG](../../build/reference/ltcg-link-time-code-generation.md) option."},{"content":"To resolve LNK4049, try one of the following:","pos":[1590,1635]},{"content":"Remove the <ph id=\"ph1\">`__declspec(dllimport)`</ph> name declaration from the forward declaration of the symbol which triggered LNK4049.","pos":[1645,1764],"source":"Remove the `__declspec(dllimport)` name declaration from the forward declaration of the symbol which triggered LNK4049."},{"content":"You can search for symbols within a binary image by using the <bpt id=\"p1\">**</bpt>DUMPBIN<ept id=\"p1\">**</ept> utility.","pos":[1765,1847],"source":" You can search for symbols within a binary image by using the **DUMPBIN** utility."},{"content":"The <bpt id=\"p1\">**</bpt>DUMPBIN/SYMBOLS<ept id=\"p1\">**</ept> switch displays the COFF symbol table of the image.","pos":[1848,1923],"source":" The **DUMPBIN/SYMBOLS** switch displays the COFF symbol table of the image."},{"content":"For more information on the <bpt id=\"p1\">**</bpt>DUMPBIN<ept id=\"p1\">**</ept> utility, see <bpt id=\"p2\">[</bpt>DUMPBIN Reference<ept id=\"p2\">](../../build/reference/dumpbin-reference.md)</ept>.","pos":[1924,2041],"source":" For more information on the **DUMPBIN** utility, see [DUMPBIN Reference](../../build/reference/dumpbin-reference.md)."},{"content":"Temporarily disable incremental linking and whole-program optimization.","pos":[2051,2122]},{"content":"Recompiling the application will generate Warning LNK4217, which will include the name of the function from which the imported symbol was referenced.","pos":[2123,2272]},{"content":"Remove the <ph id=\"ph1\">`__declspec(dllimport)`</ph> declaration from the imported symbol and enable incremental linking or whole-program optimization as required.","pos":[2273,2418],"source":" Remove the `__declspec(dllimport)` declaration from the imported symbol and enable incremental linking or whole-program optimization as required."},{"content":"Although the final generated code will behave correctly, the code generated to call the imported function is less efficient than calling the function directly.","pos":[2425,2584]},{"content":"This warning will not appear when you compile by using the option <bpt id=\"p1\">[</bpt>/clr<ept id=\"p1\">](../../build/reference/clr-common-language-runtime-compilation.md)</ept>.","pos":[2585,2724],"source":" This warning will not appear when you compile by using the option [/clr](../../build/reference/clr-common-language-runtime-compilation.md)."},{"pos":[2731,2853],"content":"For more information on import and export data declarations, see <bpt id=\"p1\">[</bpt>dllexport, dllimport<ept id=\"p1\">](../../cpp/dllexport-dllimport.md)</ept>.","source":"For more information on import and export data declarations, see [dllexport, dllimport](../../cpp/dllexport-dllimport.md)."},{"content":"Example","pos":[2862,2869]},{"content":"Linking the following two modules will generate LNK4049.","pos":[2873,2929]},{"content":"The first module generates an object file containing a single exported function.","pos":[2930,3010]},{"content":"Example","pos":[3136,3143]},{"content":"The second module generates an object file containing a forward declaration to the function exported in the first module, along with a call to this function inside the <ph id=\"ph1\">`main`</ph> function.","pos":[3147,3331],"source":"The second module generates an object file containing a forward declaration to the function exported in the first module, along with a call to this function inside the `main` function."},{"content":"Linking this module with the first module will generate LNK4049.","pos":[3332,3396]},{"content":"Removing the <ph id=\"ph1\">`__declspec(dllimport)`</ph> declaration will resolve the warning.","pos":[3397,3471],"source":" Removing the `__declspec(dllimport)` declaration will resolve the warning."},{"content":"See Also","pos":[3719,3727]},{"content":"Linker Tools Warning LNK4217","pos":[3732,3760]},{"content":"dllexport, dllimport","pos":[3833,3853]}],"content":"---\ntitle: \"Linker Tools Warning LNK4049 | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"error-reference\"\nf1_keywords: \n  - \"LNK4049\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"LNK4049\"\nms.assetid: 5fd5fb24-c860-4149-a557-0ac26a65d97c\ncaps.latest.revision: 19\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Linker Tools Warning LNK4049\nlocally defined symbol 'symbol' imported  \n  \n The symbol was both exported from and imported to the program.  \n  \n This warning is generated by the linker when you declare a symbol by using the `__declspec(dllexport)` storage-class attribute in one object file and reference it by using the `__declspec(dllimport)` attribute in another.  \n  \n Warning LNK4049 is a more general version of [Linker Tools Warning LNK4217](../../error-messages/tool-errors/linker-tools-warning-lnk4217.md). The linker generates Warning LNK4049 when it cannot determine from which function the imported symbol was referenced.  \n  \n The common cases where LNK4049 is generated instead of LNK4217 are:  \n  \n-   Performing incremental linking by using the [/INCREMENTAL](../../build/reference/incremental-link-incrementally.md) option.  \n  \n-   Performing whole-program optimization by using the [/LTCG](../../build/reference/ltcg-link-time-code-generation.md) option.  \n  \n To resolve LNK4049, try one of the following:  \n  \n-   Remove the `__declspec(dllimport)` name declaration from the forward declaration of the symbol which triggered LNK4049. You can search for symbols within a binary image by using the **DUMPBIN** utility. The **DUMPBIN/SYMBOLS** switch displays the COFF symbol table of the image. For more information on the **DUMPBIN** utility, see [DUMPBIN Reference](../../build/reference/dumpbin-reference.md).  \n  \n-   Temporarily disable incremental linking and whole-program optimization. Recompiling the application will generate Warning LNK4217, which will include the name of the function from which the imported symbol was referenced. Remove the `__declspec(dllimport)` declaration from the imported symbol and enable incremental linking or whole-program optimization as required.  \n  \n Although the final generated code will behave correctly, the code generated to call the imported function is less efficient than calling the function directly. This warning will not appear when you compile by using the option [/clr](../../build/reference/clr-common-language-runtime-compilation.md).  \n  \n For more information on import and export data declarations, see [dllexport, dllimport](../../cpp/dllexport-dllimport.md).  \n  \n## Example  \n Linking the following two modules will generate LNK4049. The first module generates an object file containing a single exported function.  \n  \n```  \n// LNK4049a.cpp  \n// compile with: /c  \n  \n__declspec(dllexport) int func()   \n{  \n   return 3;  \n}  \n```  \n  \n## Example  \n The second module generates an object file containing a forward declaration to the function exported in the first module, along with a call to this function inside the `main` function. Linking this module with the first module will generate LNK4049. Removing the `__declspec(dllimport)` declaration will resolve the warning.  \n  \n```  \n// LNK4049b.cpp  \n// compile with: /link /WX /LTCG LNK4049a.obj  \n// LNK4049 expected  \n  \n__declspec(dllimport) int func();  \n// try the following line instead  \n// int func();  \n  \nint main()  \n{  \n   return func();  \n}  \n```  \n  \n## See Also  \n [Linker Tools Warning LNK4217](../../error-messages/tool-errors/linker-tools-warning-lnk4217.md)   \n [dllexport, dllimport](../../cpp/dllexport-dllimport.md)"}