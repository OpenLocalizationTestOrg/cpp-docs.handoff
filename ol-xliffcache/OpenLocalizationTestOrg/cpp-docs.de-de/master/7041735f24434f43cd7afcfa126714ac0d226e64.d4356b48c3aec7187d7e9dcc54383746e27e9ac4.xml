{"nodes":[{"pos":[12,66],"content":"CAnimationVariableChangeHandler Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CAnimationVariableChangeHandler Class | Microsoft Docs","pos":[0,54]}]},{"pos":[728,765],"content":"CAnimationVariableChangeHandler Class","linkify":"CAnimationVariableChangeHandler Class","nodes":[{"content":"CAnimationVariableChangeHandler Class","pos":[0,37]}]},{"content":"Implements a callback, which is called by the Animation API when the value of an animation variable changes.","pos":[766,874]},{"pos":[883,889],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1034,1041],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1051,1070],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1077,1081]},{"content":"Description","pos":[1082,1093]},{"pos":[1198,1252],"content":"Constructs a <ph id=\"ph1\">`CAnimationVariableChangeHandler`</ph> object.","source":"Constructs a `CAnimationVariableChangeHandler` object."},{"pos":[1263,1277],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1284,1288]},{"content":"Description","pos":[1289,1300]},{"pos":[1388,1452],"content":"Creates an instance of <ph id=\"ph1\">`CAnimationVariableChangeHandler`</ph> object.","source":"Creates an instance of `CAnimationVariableChangeHandler` object."},{"pos":[1457,1556],"content":"<bpt id=\"p1\">[</bpt>CAnimationVariableChangeHandler::OnValueChanged<ept id=\"p1\">](#canimationvariablechangehandler__onvaluechanged)</ept>","source":"[CAnimationVariableChangeHandler::OnValueChanged](#canimationvariablechangehandler__onvaluechanged)"},{"content":"Called when a value of an animation variable has changed.","pos":[1557,1614]},{"content":"(Overrides <ph id=\"ph1\">`CUIAnimationVariableChangeHandlerBase::OnValueChanged`</ph>.)","pos":[1615,1683],"source":" (Overrides `CUIAnimationVariableChangeHandlerBase::OnValueChanged`.)"},{"pos":[1688,1803],"content":"<bpt id=\"p1\">[</bpt>CAnimationVariableChangeHandler::SetAnimationController<ept id=\"p1\">](#canimationvariablechangehandler__setanimationcontroller)</ept>","source":"[CAnimationVariableChangeHandler::SetAnimationController](#canimationvariablechangehandler__setanimationcontroller)"},{"content":"Stores a pointer to animation controller to route events.","pos":[1804,1861]},{"pos":[1871,1878],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1882,2185],"content":"This event handler is created and passed to <ph id=\"ph1\">`IUIAnimationVariable::SetVariableChangeHandler`</ph> method, when you call <ph id=\"ph2\">`CAnimationVariable::EnableValueChangedEvent`</ph> or <ph id=\"ph3\">`CAnimationBaseObject::EnableValueChangedEvent`</ph> (which enables this event for all animation variables encapsulated in an animation object).","source":"This event handler is created and passed to `IUIAnimationVariable::SetVariableChangeHandler` method, when you call `CAnimationVariable::EnableValueChangedEvent` or `CAnimationBaseObject::EnableValueChangedEvent` (which enables this event for all animation variables encapsulated in an animation object)."},{"pos":[2194,2215],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2340,2352],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2356,2392],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxanimationcontroller.h","source":"**Header:** afxanimationcontroller.h"},{"pos":[2402,2513],"content":"<bpt id=\"p1\">&lt;a name=\"canimationvariablechangehandler__onvaluechanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAnimationVariableChangeHandler::OnValueChanged","linkify":"<a name=\"canimationvariablechangehandler__onvaluechanged\"></a>  CAnimationVariableChangeHandler::OnValueChanged","source":"<a name=\"canimationvariablechangehandler__onvaluechanged\"></a>  CAnimationVariableChangeHandler::OnValueChanged"},{"content":"Called when a value of an animation variable has changed.","pos":[2517,2574]},{"pos":[2773,2783],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The storyboard that is animating the variable.","pos":[2803,2849]},{"content":"The animation variable that was updated.","pos":[2870,2910]},{"content":"The new value.","pos":[2931,2945]},{"content":"The previous value.","pos":[2971,2990]},{"pos":[3000,3012],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"If the method succeeds, it returns S_OK.","pos":[3016,3056]},{"content":"Otherwise, it returns an HRESULT error code.","pos":[3057,3101]},{"pos":[3111,3238],"content":"<bpt id=\"p1\">&lt;a name=\"canimationvariablechangehandler__setanimationcontroller\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAnimationVariableChangeHandler::SetAnimationController","linkify":"<a name=\"canimationvariablechangehandler__setanimationcontroller\"></a>  CAnimationVariableChangeHandler::SetAnimationController","source":"<a name=\"canimationvariablechangehandler__setanimationcontroller\"></a>  CAnimationVariableChangeHandler::SetAnimationController"},{"content":"Stores a pointer to animation controller to route events.","pos":[3242,3299]},{"pos":[3397,3407],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to animation controller, which will receive events.","pos":[3437,3498]},{"pos":[3507,3515],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[3519,3564],"content":"<bpt id=\"p1\">[</bpt>Classes<ept id=\"p1\">](../../mfc/reference/mfc-classes.md)</ept>","source":"[Classes](../../mfc/reference/mfc-classes.md)"}],"content":"---\ntitle: \"CAnimationVariableChangeHandler Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"afxanimationcontroller/CAnimationVariableChangeHandler\"\n  - \"CAnimationVariableChangeHandler\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CAnimationVariableChangeHandler class\"\nms.assetid: 2ea4996d-5c04-4dfc-be79-d42d55050795\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CAnimationVariableChangeHandler Class\nImplements a callback, which is called by the Animation API when the value of an animation variable changes.  \n  \n## Syntax  \n  \n```  \nclass CAnimationVariableChangeHandler : public CUIAnimationVariableChangeHandlerBase<CAnimationVariableChangeHandler>;  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|`CAnimationVariableChangeHandler::CAnimationVariableChangeHandler`|Constructs a `CAnimationVariableChangeHandler` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|`CAnimationVariableChangeHandler::CreateInstance`|Creates an instance of `CAnimationVariableChangeHandler` object.|  \n|[CAnimationVariableChangeHandler::OnValueChanged](#canimationvariablechangehandler__onvaluechanged)|Called when a value of an animation variable has changed. (Overrides `CUIAnimationVariableChangeHandlerBase::OnValueChanged`.)|  \n|[CAnimationVariableChangeHandler::SetAnimationController](#canimationvariablechangehandler__setanimationcontroller)|Stores a pointer to animation controller to route events.|  \n  \n## Remarks  \n This event handler is created and passed to `IUIAnimationVariable::SetVariableChangeHandler` method, when you call `CAnimationVariable::EnableValueChangedEvent` or `CAnimationBaseObject::EnableValueChangedEvent` (which enables this event for all animation variables encapsulated in an animation object).  \n  \n## Inheritance Hierarchy  \n `CUIAnimationCallbackBase`  \n  \n `CUIAnimationVariableChangeHandlerBase`  \n  \n `CAnimationVariableChangeHandler`  \n  \n## Requirements  \n **Header:** afxanimationcontroller.h  \n  \n##  <a name=\"canimationvariablechangehandler__onvaluechanged\"></a>  CAnimationVariableChangeHandler::OnValueChanged  \n Called when a value of an animation variable has changed.  \n  \n```  \nIFACEMETHOD(\n    OnValueChanged) (__in IUIAnimationStoryboard* storyboard,\n    __in IUIAnimationVariable* variable,\n    __in DOUBLE newValue,\n    __in DOUBLE previousValue);\n```  \n  \n### Parameters  \n `storyboard`  \n The storyboard that is animating the variable.  \n  \n `variable`  \n The animation variable that was updated.  \n  \n `newValue`  \n The new value.  \n  \n `previousValue`  \n The previous value.  \n  \n### Return Value  \n If the method succeeds, it returns S_OK. Otherwise, it returns an HRESULT error code.  \n  \n##  <a name=\"canimationvariablechangehandler__setanimationcontroller\"></a>  CAnimationVariableChangeHandler::SetAnimationController  \n Stores a pointer to animation controller to route events.  \n  \n```  \nvoid SetAnimationController(CAnimationController* pAnimationController);\n```  \n  \n### Parameters  \n `pAnimationController`  \n A pointer to animation controller, which will receive events.  \n  \n## See Also  \n [Classes](../../mfc/reference/mfc-classes.md)\n"}