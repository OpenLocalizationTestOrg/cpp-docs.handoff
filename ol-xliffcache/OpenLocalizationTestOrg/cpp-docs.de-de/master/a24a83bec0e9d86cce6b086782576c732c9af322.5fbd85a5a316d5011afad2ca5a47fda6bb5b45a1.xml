{"nodes":[{"pos":[12,36],"content":"Dynaset | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Dynaset | Microsoft Docs","pos":[0,24]}]},{"content":"Dynaset","pos":[808,815]},{"pos":[816,914],"content":"This topic describes dynasets and discusses their <bpt id=\"p1\">[</bpt>availability<ept id=\"p1\">](#_core_availability_of_dynasets)</ept>.","source":"This topic describes dynasets and discusses their [availability](#_core_availability_of_dynasets)."},{"pos":[922,1205],"content":"[!NOTE]\n This topic applies to the MFC ODBC classes, including [CRecordset](../../mfc/reference/crecordset-class.md). For information about dynasets in the DAO classes, see [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md). With DAO, you can open dynaset-type recordsets.","leadings":["","> "],"nodes":[{"content":" This topic applies to the MFC ODBC classes, including [CRecordset](../../mfc/reference/crecordset-class.md). For information about dynasets in the DAO classes, see [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md). With DAO, you can open dynaset-type recordsets.","pos":[8,281],"nodes":[{"content":"This topic applies to the MFC ODBC classes, including <bpt id=\"p1\">[</bpt>CRecordset<ept id=\"p1\">](../../mfc/reference/crecordset-class.md)</ept>.","pos":[1,109],"source":" This topic applies to the MFC ODBC classes, including [CRecordset](../../mfc/reference/crecordset-class.md)."},{"content":"For information about dynasets in the DAO classes, see <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept>.","pos":[110,225],"source":" For information about dynasets in the DAO classes, see [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)."},{"content":"With DAO, you can open dynaset-type recordsets.","pos":[226,273]}]}]},{"content":"A dynaset is a recordset with dynamic properties.","pos":[1212,1261]},{"content":"During its lifetime, a recordset object in dynaset mode (usually called a dynaset) stays synchronized with the data source in the following way.","pos":[1262,1406]},{"content":"In a multiuser environment, other users might edit or delete records that are in your dynaset or add records to the table your dynaset represents.","pos":[1407,1553]},{"content":"Records your application adds to or deletes from the recordset are reflected in your dynaset.","pos":[1554,1647]},{"content":"Records that other users add to the table will not be reflected in your dynaset until you rebuild the dynaset by calling its <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> member function.","pos":[1648,1801],"source":" Records that other users add to the table will not be reflected in your dynaset until you rebuild the dynaset by calling its **Requery** member function."},{"content":"When other users delete records, MFC code skips over the deletions in your recordset.","pos":[1802,1887]},{"content":"Other users' editing changes to existing records are reflected in your dynaset as soon as you scroll to the affected record.","pos":[1888,2012]},{"content":"Similarly, edits you make to records in a dynaset are reflected in dynasets in use by other users.","pos":[2019,2117]},{"content":"Records you add are not reflected in other users' dynasets until they requery their dynasets.","pos":[2118,2211]},{"content":"Records you delete are marked as \"deleted\" in other users' recordsets.","pos":[2212,2282]},{"content":"If you have multiple connections to the same database (multiple <ph id=\"ph1\">`CDatabase`</ph> objects), recordsets associated with those connections have the same status as the recordsets of other users.","pos":[2283,2468],"source":" If you have multiple connections to the same database (multiple `CDatabase` objects), recordsets associated with those connections have the same status as the recordsets of other users."},{"content":"Dynasets are most valuable when data must be dynamic, as (for example) in an airline reservation system.","pos":[2475,2579]},{"pos":[2587,2822],"content":"[!NOTE]\n To use dynasets, you must have an ODBC driver for your data source that supports dynasets and the ODBC cursor library must not be loaded. For more information, see [Availability of Dynasets](#_core_availability_of_dynasets).","leadings":["","> "],"nodes":[{"content":" To use dynasets, you must have an ODBC driver for your data source that supports dynasets and the ODBC cursor library must not be loaded. For more information, see [Availability of Dynasets](#_core_availability_of_dynasets).","pos":[8,233],"nodes":[{"content":"To use dynasets, you must have an ODBC driver for your data source that supports dynasets and the ODBC cursor library must not be loaded.","pos":[1,138]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Availability of Dynasets<ept id=\"p1\">](#_core_availability_of_dynasets)</ept>.","pos":[139,225],"source":" For more information, see [Availability of Dynasets](#_core_availability_of_dynasets)."}]}]},{"pos":[2829,2980],"content":"To specify that a recordset is a dynaset, pass <bpt id=\"p1\">**</bpt>CRecordset::dynaset<ept id=\"p1\">**</ept> as the first parameter to the <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> member function of your recordset object.","source":"To specify that a recordset is a dynaset, pass **CRecordset::dynaset** as the first parameter to the **Open** member function of your recordset object."},{"pos":[2988,3194],"content":"[!NOTE]\n For updatable dynasets, your ODBC driver must support either positioned update statements or the **::SQLSetPos** ODBC API function. If both are supported, MFC uses **::SQLSetPos** for efficiency.","leadings":["","> "],"nodes":[{"content":" For updatable dynasets, your ODBC driver must support either positioned update statements or the **::SQLSetPos** ODBC API function. If both are supported, MFC uses **::SQLSetPos** for efficiency.","pos":[8,204],"nodes":[{"content":"For updatable dynasets, your ODBC driver must support either positioned update statements or the <bpt id=\"p1\">**</bpt>::SQLSetPos<ept id=\"p1\">**</ept> ODBC API function.","pos":[1,132],"source":" For updatable dynasets, your ODBC driver must support either positioned update statements or the **::SQLSetPos** ODBC API function."},{"content":"If both are supported, MFC uses <bpt id=\"p1\">**</bpt>::SQLSetPos<ept id=\"p1\">**</ept> for efficiency.","pos":[133,196],"source":" If both are supported, MFC uses **::SQLSetPos** for efficiency."}]}]},{"pos":[3250,3274],"content":"Availability of Dynasets"},{"content":"The MFC database classes support dynasets if the following requirements are met:","pos":[3278,3358]},{"content":"The ODBC cursor library DLL must not be in use for this data source.","pos":[3368,3436]},{"content":"If the cursor library is used, it masks some functionality of the underlying ODBC driver that is necessary for dynaset support.","pos":[3447,3574]},{"content":"If you want to use dynasets (and your ODBC driver has the functionality required for dynasets, as described in the rest of this section), you can cause MFC not to load the cursor library when you create a <ph id=\"ph1\">`CDatabase`</ph> object.","pos":[3575,3799],"source":" If you want to use dynasets (and your ODBC driver has the functionality required for dynasets, as described in the rest of this section), you can cause MFC not to load the cursor library when you create a `CDatabase` object."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ODBC<ept id=\"p1\">](../../data/odbc/odbc-basics.md)</ept> and the <bpt id=\"p2\">[</bpt>OpenEx<ept id=\"p2\">](../../mfc/reference/cdatabase-class.md#cdatabase__openex)</ept> or <bpt id=\"p3\">[</bpt>Open<ept id=\"p3\">](../../mfc/reference/cdatabase-class.md#cdatabase__open)</ept> member function of class <ph id=\"ph1\">`CDatabase`</ph>.","pos":[3800,4043],"source":" For more information, see [ODBC](../../data/odbc/odbc-basics.md) and the [OpenEx](../../mfc/reference/cdatabase-class.md#cdatabase__openex) or [Open](../../mfc/reference/cdatabase-class.md#cdatabase__open) member function of class `CDatabase`."},{"content":"In ODBC terminology, dynasets and snapshots are referred to as cursors.","pos":[4054,4125]},{"content":"A cursor is a mechanism used for keeping track of its position in a recordset.","pos":[4126,4204]},{"content":"The ODBC driver for your data source must support keyset-driven cursors.","pos":[4214,4286]},{"content":"Keyset-driven cursors manage data from a table by getting and storing a set of keys.","pos":[4297,4381]},{"content":"The keys are used to obtain current data from the table when the user scrolls onto a particular record.","pos":[4382,4485]},{"content":"To determine whether your driver provides this support, call the <bpt id=\"p1\">**</bpt>::SQLGetInfo<ept id=\"p1\">**</ept> ODBC API function with the <bpt id=\"p2\">**</bpt>SQL_SCROLL_OPTIONS<ept id=\"p2\">**</ept> parameter.","pos":[4486,4628],"source":" To determine whether your driver provides this support, call the **::SQLGetInfo** ODBC API function with the **SQL_SCROLL_OPTIONS** parameter."},{"pos":[4639,4784],"content":"If you try to open a dynaset without keyset support, you get a <ph id=\"ph1\">`CDBException`</ph> with the return code value <bpt id=\"p1\">**</bpt>AFX_SQL_ERROR_DYNASET_NOT_SUPPORTED<ept id=\"p1\">**</ept>.","source":"If you try to open a dynaset without keyset support, you get a `CDBException` with the return code value **AFX_SQL_ERROR_DYNASET_NOT_SUPPORTED**."},{"content":"The ODBC driver for your data source must support extended fetching.","pos":[4794,4862]},{"content":"Extended fetching is the ability to scroll backward as well as forward over the resulting records of your SQL query.","pos":[4873,4989]},{"content":"To determine whether your driver supports this ability, call the <bpt id=\"p1\">**</bpt>::SQLGetFunctions<ept id=\"p1\">**</ept> ODBC API function with the <bpt id=\"p2\">**</bpt>SQL_API_SQLEXTENDEDFETCH<ept id=\"p2\">**</ept> parameter.","pos":[4990,5143],"source":" To determine whether your driver supports this ability, call the **::SQLGetFunctions** ODBC API function with the **SQL_API_SQLEXTENDEDFETCH** parameter."},{"content":"If you want updateable dynasets (or snapshots, for that matter), your ODBC driver must also support either the <bpt id=\"p1\">**</bpt>::SQLSetPos<ept id=\"p1\">**</ept> ODBC API function or positioned updates.","pos":[5150,5317],"source":"If you want updateable dynasets (or snapshots, for that matter), your ODBC driver must also support either the **::SQLSetPos** ODBC API function or positioned updates."},{"content":"The <bpt id=\"p1\">**</bpt>::SQLSetPos<ept id=\"p1\">**</ept> function allows MFC to update the data source without sending SQL statements.","pos":[5318,5415],"source":" The **::SQLSetPos** function allows MFC to update the data source without sending SQL statements."},{"content":"If this support is available, MFC uses it in preference to making updates using SQL.","pos":[5416,5500]},{"content":"To determine whether your driver supports <bpt id=\"p1\">**</bpt>::SQLSetPos<ept id=\"p1\">**</ept>, call <bpt id=\"p2\">**</bpt>::SQLGetInfo<ept id=\"p2\">**</ept> with the <bpt id=\"p3\">**</bpt>SQL_POS_OPERATIONS<ept id=\"p3\">**</ept> parameter.","pos":[5501,5624],"source":" To determine whether your driver supports **::SQLSetPos**, call **::SQLGetInfo** with the **SQL_POS_OPERATIONS** parameter."},{"content":"Positioned updates use SQL syntax (of the form <bpt id=\"p1\">**</bpt>WHERE CURRENT OF<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\&lt;</ph>cursorname&gt;) to identify a particular row in the table on the data source.","pos":[5631,5775],"source":"Positioned updates use SQL syntax (of the form **WHERE CURRENT OF** \\<cursorname>) to identify a particular row in the table on the data source."},{"content":"To determine whether your driver supports positioned updates, call <bpt id=\"p1\">**</bpt>::SQLGetInfo<ept id=\"p1\">**</ept> with the <bpt id=\"p2\">**</bpt>SQL_POSITIONED_STATEMENTS<ept id=\"p2\">**</ept> parameter.","pos":[5776,5909],"source":" To determine whether your driver supports positioned updates, call **::SQLGetInfo** with the **SQL_POSITIONED_STATEMENTS** parameter."},{"content":"Generally, MFC dynasets (but not forward-only recordsets) require an ODBC driver with level 2 API conformance.","pos":[5916,6026]},{"content":"If the driver for your data source conforms to the level 1 API set, you can still use both updateable and read-only snapshots and forward-only recordsets, but not dynasets.","pos":[6027,6199]},{"content":"However, a level 1 driver can support dynasets if it supports extended fetching and keyset-driven cursors.","pos":[6200,6306]},{"content":"For more information about ODBC conformance levels, see <bpt id=\"p1\">[</bpt>ODBC<ept id=\"p1\">](../../data/odbc/odbc-basics.md)</ept>.","pos":[6307,6402],"source":" For more information about ODBC conformance levels, see [ODBC](../../data/odbc/odbc-basics.md)."},{"pos":[6410,6553],"content":"[!NOTE]\n If you want to use both snapshots and dynasets, you must base them on two different `CDatabase` objects (two different connections).","leadings":["","> "],"nodes":[{"content":"If you want to use both snapshots and dynasets, you must base them on two different <ph id=\"ph1\">`CDatabase`</ph> objects (two different connections).","pos":[9,141],"source":" If you want to use both snapshots and dynasets, you must base them on two different `CDatabase` objects (two different connections)."}]},{"content":"Unlike snapshots, which use intermediate storage maintained by the ODBC cursor library, dynasets fetch a record directly from the data source as soon as you scroll to it.","pos":[6560,6730]},{"content":"This keeps the records originally selected by the dynaset synchronized with the data source.","pos":[6731,6823]},{"pos":[6830,7012],"content":"For a list of ODBC drivers included in this version of Visual C++ and for information about obtaining additional drivers, see <bpt id=\"p1\">[</bpt>ODBC Driver List<ept id=\"p1\">](../../data/odbc/odbc-driver-list.md)</ept>.","source":"For a list of ODBC drivers included in this version of Visual C++ and for information about obtaining additional drivers, see [ODBC Driver List](../../data/odbc/odbc-driver-list.md)."},{"content":"See Also","pos":[7021,7029]},{"content":"Open Database Connectivity (ODBC)","pos":[7034,7067]}],"content":"---\ntitle: \"Dynaset | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ODBC recordsets, dynasets\"\n  - \"ODBC cursor library [ODBC], dynasets\"\n  - \"keyset-driven cursors in dynasets\"\n  - \"cursors [ODBC], keyset-driven cursors in dynasets\"\n  - \"cursor library [ODBC], dynaset availability\"\n  - \"recordsets [C++], dynasets\"\n  - \"dynasets\"\nms.assetid: 2867e6be-208e-4fe7-8bbe-b8697cb1045c\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Dynaset\nThis topic describes dynasets and discusses their [availability](#_core_availability_of_dynasets).  \n  \n> [!NOTE]\n>  This topic applies to the MFC ODBC classes, including [CRecordset](../../mfc/reference/crecordset-class.md). For information about dynasets in the DAO classes, see [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md). With DAO, you can open dynaset-type recordsets.  \n  \n A dynaset is a recordset with dynamic properties. During its lifetime, a recordset object in dynaset mode (usually called a dynaset) stays synchronized with the data source in the following way. In a multiuser environment, other users might edit or delete records that are in your dynaset or add records to the table your dynaset represents. Records your application adds to or deletes from the recordset are reflected in your dynaset. Records that other users add to the table will not be reflected in your dynaset until you rebuild the dynaset by calling its **Requery** member function. When other users delete records, MFC code skips over the deletions in your recordset. Other users' editing changes to existing records are reflected in your dynaset as soon as you scroll to the affected record.  \n  \n Similarly, edits you make to records in a dynaset are reflected in dynasets in use by other users. Records you add are not reflected in other users' dynasets until they requery their dynasets. Records you delete are marked as \"deleted\" in other users' recordsets. If you have multiple connections to the same database (multiple `CDatabase` objects), recordsets associated with those connections have the same status as the recordsets of other users.  \n  \n Dynasets are most valuable when data must be dynamic, as (for example) in an airline reservation system.  \n  \n> [!NOTE]\n>  To use dynasets, you must have an ODBC driver for your data source that supports dynasets and the ODBC cursor library must not be loaded. For more information, see [Availability of Dynasets](#_core_availability_of_dynasets).  \n  \n To specify that a recordset is a dynaset, pass **CRecordset::dynaset** as the first parameter to the **Open** member function of your recordset object.  \n  \n> [!NOTE]\n>  For updatable dynasets, your ODBC driver must support either positioned update statements or the **::SQLSetPos** ODBC API function. If both are supported, MFC uses **::SQLSetPos** for efficiency.  \n  \n##  <a name=\"_core_availability_of_dynasets\"></a> Availability of Dynasets  \n The MFC database classes support dynasets if the following requirements are met:  \n  \n-   The ODBC cursor library DLL must not be in use for this data source.  \n  \n     If the cursor library is used, it masks some functionality of the underlying ODBC driver that is necessary for dynaset support. If you want to use dynasets (and your ODBC driver has the functionality required for dynasets, as described in the rest of this section), you can cause MFC not to load the cursor library when you create a `CDatabase` object. For more information, see [ODBC](../../data/odbc/odbc-basics.md) and the [OpenEx](../../mfc/reference/cdatabase-class.md#cdatabase__openex) or [Open](../../mfc/reference/cdatabase-class.md#cdatabase__open) member function of class `CDatabase`.  \n  \n     In ODBC terminology, dynasets and snapshots are referred to as cursors. A cursor is a mechanism used for keeping track of its position in a recordset.  \n  \n-   The ODBC driver for your data source must support keyset-driven cursors.  \n  \n     Keyset-driven cursors manage data from a table by getting and storing a set of keys. The keys are used to obtain current data from the table when the user scrolls onto a particular record. To determine whether your driver provides this support, call the **::SQLGetInfo** ODBC API function with the **SQL_SCROLL_OPTIONS** parameter.  \n  \n     If you try to open a dynaset without keyset support, you get a `CDBException` with the return code value **AFX_SQL_ERROR_DYNASET_NOT_SUPPORTED**.  \n  \n-   The ODBC driver for your data source must support extended fetching.  \n  \n     Extended fetching is the ability to scroll backward as well as forward over the resulting records of your SQL query. To determine whether your driver supports this ability, call the **::SQLGetFunctions** ODBC API function with the **SQL_API_SQLEXTENDEDFETCH** parameter.  \n  \n If you want updateable dynasets (or snapshots, for that matter), your ODBC driver must also support either the **::SQLSetPos** ODBC API function or positioned updates. The **::SQLSetPos** function allows MFC to update the data source without sending SQL statements. If this support is available, MFC uses it in preference to making updates using SQL. To determine whether your driver supports **::SQLSetPos**, call **::SQLGetInfo** with the **SQL_POS_OPERATIONS** parameter.  \n  \n Positioned updates use SQL syntax (of the form **WHERE CURRENT OF** \\<cursorname>) to identify a particular row in the table on the data source. To determine whether your driver supports positioned updates, call **::SQLGetInfo** with the **SQL_POSITIONED_STATEMENTS** parameter.  \n  \n Generally, MFC dynasets (but not forward-only recordsets) require an ODBC driver with level 2 API conformance. If the driver for your data source conforms to the level 1 API set, you can still use both updateable and read-only snapshots and forward-only recordsets, but not dynasets. However, a level 1 driver can support dynasets if it supports extended fetching and keyset-driven cursors. For more information about ODBC conformance levels, see [ODBC](../../data/odbc/odbc-basics.md).  \n  \n> [!NOTE]\n>  If you want to use both snapshots and dynasets, you must base them on two different `CDatabase` objects (two different connections).  \n  \n Unlike snapshots, which use intermediate storage maintained by the ODBC cursor library, dynasets fetch a record directly from the data source as soon as you scroll to it. This keeps the records originally selected by the dynaset synchronized with the data source.  \n  \n For a list of ODBC drivers included in this version of Visual C++ and for information about obtaining additional drivers, see [ODBC Driver List](../../data/odbc/odbc-driver-list.md).  \n  \n## See Also  \n [Open Database Connectivity (ODBC)](../../data/odbc/open-database-connectivity-odbc.md)"}