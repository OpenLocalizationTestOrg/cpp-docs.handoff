{"nodes":[{"pos":[12,54],"content":"Supporting Schema Rowsets | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Supporting Schema Rowsets | Microsoft Docs","pos":[0,42]}]},{"content":"Supporting Schema Rowsets","pos":[694,719]},{"content":"Schema rowsets allow consumers to obtain information about a data store without knowing its underlying structure, or schema.","pos":[720,844]},{"content":"For example, a data store might have tables organized into a user-defined hierarchy, so there would be no way to ensure knowledge of the schema except by reading it.","pos":[845,1010]},{"content":"(As another example, note that the Visual C++ wizards use schema rowsets to generate accessors for the consumer.) To allow the consumer to do this, the provider's session object exposes methods on the <bpt id=\"p1\">[</bpt>IDBSchemaRowset<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms713686.aspx)</ept> interface.","pos":[1011,1296],"source":" (As another example, note that the Visual C++ wizards use schema rowsets to generate accessors for the consumer.) To allow the consumer to do this, the provider's session object exposes methods on the [IDBSchemaRowset](https://msdn.microsoft.com/en-us/library/ms713686.aspx) interface."},{"content":"In Visual C++ applications, you use the <bpt id=\"p1\">[</bpt>IDBSchemaRowsetImpl<ept id=\"p1\">](../../data/oledb/idbschemarowsetimpl-class.md)</ept> class to implement <bpt id=\"p2\">**</bpt>IDBSchemaRowset<ept id=\"p2\">**</ept>.","pos":[1297,1445],"source":" In Visual C++ applications, you use the [IDBSchemaRowsetImpl](../../data/oledb/idbschemarowsetimpl-class.md) class to implement **IDBSchemaRowset**."},{"pos":[1474,1505],"content":"supports the following methods:"},{"pos":[1515,1654],"content":"<bpt id=\"p1\">[</bpt>CheckRestrictions<ept id=\"p1\">](../../data/oledb/idbschemarowsetimpl-checkrestrictions.md)</ept> checks the validity of restrictions against a schema rowset.","source":"[CheckRestrictions](../../data/oledb/idbschemarowsetimpl-checkrestrictions.md) checks the validity of restrictions against a schema rowset."},{"pos":[1664,1837],"content":"<bpt id=\"p1\">[</bpt>CreateSchemaRowset<ept id=\"p1\">](../../data/oledb/idbschemarowsetimpl-createschemarowset.md)</ept> implements a COM object creator function for the object specified by the template parameter.","source":"[CreateSchemaRowset](../../data/oledb/idbschemarowsetimpl-createschemarowset.md) implements a COM object creator function for the object specified by the template parameter."},{"pos":[1847,1993],"content":"<bpt id=\"p1\">[</bpt>SetRestrictions<ept id=\"p1\">](../../data/oledb/idbschemarowsetimpl-setrestrictions.md)</ept> specifies which restrictions you support on a particular schema rowset.","source":"[SetRestrictions](../../data/oledb/idbschemarowsetimpl-setrestrictions.md) specifies which restrictions you support on a particular schema rowset."},{"pos":[2003,2134],"content":"<bpt id=\"p1\">[</bpt>IDBSchemaRowset::GetRowset<ept id=\"p1\">](../../data/oledb/idbschemarowsetimpl-getrowset.md)</ept> returns a schema rowset (inherited from interface).","source":"[IDBSchemaRowset::GetRowset](../../data/oledb/idbschemarowsetimpl-getrowset.md) returns a schema rowset (inherited from interface)."},{"pos":[2144,2316],"content":"<bpt id=\"p1\">[</bpt>GetSchemas<ept id=\"p1\">](../../data/oledb/idbschemarowsetimpl-getschemas.md)</ept> returns a list of schema rowsets accessible by <ph id=\"ph1\">`IDBSchemaRowsetImpl::GetRowset`</ph> (inherited from interface).","source":"[GetSchemas](../../data/oledb/idbschemarowsetimpl-getschemas.md) returns a list of schema rowsets accessible by `IDBSchemaRowsetImpl::GetRowset` (inherited from interface)."},{"content":"ATL OLE DB Provider Wizard Support","pos":[2325,2359]},{"content":"The ATL OLE DB Provider Wizard creates three schema classes in the session header file:","pos":[2363,2450]},{"pos":[2460,2503],"content":"<bpt id=\"p1\">**</bpt>C<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>ShortName<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt>SessionTRSchemaRowset<ept id=\"p3\">**</ept>","source":"**C** *ShortName* **SessionTRSchemaRowset**"},{"pos":[2513,2557],"content":"<bpt id=\"p1\">**</bpt>C<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>ShortName<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt>SessionColSchemaRowset<ept id=\"p3\">**</ept>","source":"**C** *ShortName* **SessionColSchemaRowset**"},{"pos":[2567,2610],"content":"<bpt id=\"p1\">**</bpt>C<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>ShortName<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt>SessionPTSchemaRowset<ept id=\"p3\">**</ept>","source":"**C** *ShortName* **SessionPTSchemaRowset**"},{"content":"These classes respond to consumer requests for schema information; note that the OLE DB specification requires that these three schema rowsets be supported:","pos":[2617,2773]},{"pos":[2783,2904],"content":"<bpt id=\"p1\">**</bpt>C<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>ShortName<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt>SessionTRSchemaRowset<ept id=\"p3\">**</ept> handles requests for table information (the <ph id=\"ph1\">`DBSCHEMA_TABLES`</ph> schema rowset).","source":"**C** *ShortName* **SessionTRSchemaRowset** handles requests for table information (the `DBSCHEMA_TABLES` schema rowset)."},{"content":"<bpt id=\"p1\">**</bpt>C<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>ShortName<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt>SessionColSchemaRowset<ept id=\"p3\">**</ept> handles requests for column information (the <bpt id=\"p4\">**</bpt>DBSCHEMA_COLUMNS<ept id=\"p4\">**</ept> schema rowset).","pos":[2914,3040],"source":"**C** *ShortName* **SessionColSchemaRowset** handles requests for column information (the **DBSCHEMA_COLUMNS** schema rowset)."},{"content":"The wizard supplies sample implementations for these classes, which return schema information for a DOS provider.","pos":[3041,3154]},{"content":"<bpt id=\"p1\">**</bpt>C<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>ShortName<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt>SessionPTSchemaRowset<ept id=\"p3\">**</ept> handles requests for schema information about the provider type (the <bpt id=\"p4\">**</bpt>DBSCHEMA_PROVIDER_TYPES<ept id=\"p4\">**</ept> schema rowset).","pos":[3164,3320],"source":"**C** *ShortName* **SessionPTSchemaRowset** handles requests for schema information about the provider type (the **DBSCHEMA_PROVIDER_TYPES** schema rowset)."},{"content":"The default implementation provided by the wizard returns <ph id=\"ph1\">`S_OK`</ph>.","pos":[3321,3386],"source":" The default implementation provided by the wizard returns `S_OK`."},{"content":"You can customize these classes to handle schema information appropriate to your provider:","pos":[3393,3483]},{"content":"In <bpt id=\"p1\">**</bpt>C<ept id=\"p1\">**</ept><bpt id=\"p2\">*</bpt>ShortName<ept id=\"p2\">*</ept><bpt id=\"p3\">**</bpt>SessionTRSchemaRowset<ept id=\"p3\">**</ept>, you must fill out the catalog, table, and description fields (<bpt id=\"p4\">**</bpt>trData.m_szType<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>trData.m_szTable<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>trData.m_szDesc<ept id=\"p6\">**</ept>).","pos":[3493,3669],"source":"In **C***ShortName***SessionTRSchemaRowset**, you must fill out the catalog, table, and description fields (**trData.m_szType**, **trData.m_szTable**, and **trData.m_szDesc**)."},{"content":"The wizard-generated example uses only one row (table).","pos":[3670,3725]},{"content":"Other providers might return more than one table.","pos":[3726,3775]},{"pos":[3785,3877],"content":"In <bpt id=\"p1\">**</bpt>C<ept id=\"p1\">**</ept><bpt id=\"p2\">*</bpt>ShortName<ept id=\"p2\">*</ept><bpt id=\"p3\">**</bpt>SessionColSchemaRowset<ept id=\"p3\">**</ept>, you pass the name of the table as a <bpt id=\"p4\">**</bpt>DBID<ept id=\"p4\">**</ept>.","source":"In **C***ShortName***SessionColSchemaRowset**, you pass the name of the table as a **DBID**."},{"content":"Setting Restrictions","pos":[3886,3906]},{"content":"An important concept in schema rowset support is setting restrictions, which you do using <ph id=\"ph1\">`SetRestrictions`</ph>.","pos":[3910,4018],"source":"An important concept in schema rowset support is setting restrictions, which you do using `SetRestrictions`."},{"content":"Restrictions allow consumers to fetch only matching rows (for example, find all the columns in the table \"MyTable\").","pos":[4019,4135]},{"content":"Restrictions are optional, and in the case in which none are supported (the default), all data is always returned.","pos":[4136,4250]},{"content":"For an example of a provider that does support restrictions, see the <bpt id=\"p1\">[</bpt>UpdatePV<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f)</ept> sample.","pos":[4251,4408],"source":" For an example of a provider that does support restrictions, see the [UpdatePV](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f) sample."},{"content":"Setting up the Schema Map","pos":[4417,4442]},{"content":"Set up a schema map such as this one in Session.h in UpdatePV:","pos":[4446,4508]},{"content":"To support <bpt id=\"p1\">**</bpt>IDBSchemaRowset<ept id=\"p1\">**</ept>, you must support <ph id=\"ph1\">`DBSCHEMA_TABLES`</ph>, <bpt id=\"p2\">**</bpt>DBSCHEMA_COLUMNS<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>DBSCHEMA_PROVIDER_TYPES<ept id=\"p3\">**</ept>.","pos":[4792,4914],"source":"To support **IDBSchemaRowset**, you must support `DBSCHEMA_TABLES`, **DBSCHEMA_COLUMNS**, and **DBSCHEMA_PROVIDER_TYPES**."},{"content":"You can add additional schema rowsets at your discretion.","pos":[4915,4972]},{"pos":[4979,5085],"content":"Declare a schema rowset class with an <ph id=\"ph1\">`Execute`</ph> method such as <ph id=\"ph2\">`CUpdateSessionTRSchemaRowset`</ph> in UpdatePV:","source":"Declare a schema rowset class with an `Execute` method such as `CUpdateSessionTRSchemaRowset` in UpdatePV:"},{"content":"Note that <ph id=\"ph1\">`CUpdateSession`</ph> inherits from <ph id=\"ph2\">`IDBSchemaRowsetImpl`</ph>, so it has all the restriction handling methods.","pos":[5470,5581],"source":"Note that `CUpdateSession` inherits from `IDBSchemaRowsetImpl`, so it has all the restriction handling methods."},{"content":"Using <ph id=\"ph1\">`CSchemaRowsetImpl`</ph>, declare three child classes (listed in the schema map above): <ph id=\"ph2\">`CUpdateSessionTRSchemaRowset`</ph>, <ph id=\"ph3\">`CUpdateSessionColSchemaRowset`</ph>, and <ph id=\"ph4\">`CUpdateSessionPTSchemaRowset`</ph>.","pos":[5582,5771],"source":" Using `CSchemaRowsetImpl`, declare three child classes (listed in the schema map above): `CUpdateSessionTRSchemaRowset`, `CUpdateSessionColSchemaRowset`, and `CUpdateSessionPTSchemaRowset`."},{"content":"Each of these child classes has an <ph id=\"ph1\">`Execute`</ph> method that handles its respective set of restrictions (search criteria).","pos":[5772,5890],"source":" Each of these child classes has an `Execute` method that handles its respective set of restrictions (search criteria)."},{"content":"Each <ph id=\"ph1\">`Execute`</ph> method compares the values of the <ph id=\"ph2\">`cRestrictions`</ph> and <ph id=\"ph3\">`rgRestrictions`</ph> parameters.","pos":[5891,5988],"source":" Each `Execute` method compares the values of the `cRestrictions` and `rgRestrictions` parameters."},{"content":"See the description of these parameters in <bpt id=\"p1\">[</bpt>SetRestrictions<ept id=\"p1\">](../../data/oledb/idbschemarowsetimpl-setrestrictions.md)</ept>.","pos":[5989,6107],"source":" See the description of these parameters in [SetRestrictions](../../data/oledb/idbschemarowsetimpl-setrestrictions.md)."},{"pos":[6114,6449],"content":"For more information about which restrictions correspond to a particular schema rowset, consult the table of schema rowset GUIDs in <bpt id=\"p1\">[</bpt>IDBSchemaRowset<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms713686.aspx)</ept> in the <bpt id=\"p2\">*</bpt>OLE DB Programmer's Reference<ept id=\"p2\">*</ept> in the <ph id=\"ph1\">[!INCLUDE[winsdkshort](../../atl-mfc-shared/reference/includes/winsdkshort_md.md)]</ph>.","source":"For more information about which restrictions correspond to a particular schema rowset, consult the table of schema rowset GUIDs in [IDBSchemaRowset](https://msdn.microsoft.com/en-us/library/ms713686.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winsdkshort](../../atl-mfc-shared/reference/includes/winsdkshort_md.md)]."},{"pos":[6456,6566],"content":"For example, if you supported the <bpt id=\"p1\">**</bpt>TABLE_NAME<ept id=\"p1\">**</ept> restriction on <ph id=\"ph1\">`DBSCHEMA_TABLES`</ph>, you would do the following:","source":"For example, if you supported the **TABLE_NAME** restriction on `DBSCHEMA_TABLES`, you would do the following:"},{"pos":[6573,6660],"content":"First, look up <ph id=\"ph1\">`DBSCHEMA_TABLES`</ph> and see that it supports four restrictions (in order).","source":"First, look up `DBSCHEMA_TABLES` and see that it supports four restrictions (in order)."},{"content":"Schema rowset restriction","pos":[6667,6692]},{"content":"Restriction value","pos":[6693,6710]},{"content":"TABLE_CATALOG","pos":[6777,6790]},{"content":"0x1 (binary 1)","pos":[6793,6807]},{"content":"TABLE_SCHEMA","pos":[6814,6826]},{"content":"0x2 (binary 10)","pos":[6829,6844]},{"content":"TABLE_NAME","pos":[6851,6861]},{"content":"0x4 (binary 100)","pos":[6864,6880]},{"content":"TABLE_TYPE","pos":[6887,6897]},{"content":"0x8 (binary 1000)","pos":[6900,6917]},{"content":"Next, note that there is one bit for each restriction.","pos":[6925,6979]},{"content":"Because you want to support <bpt id=\"p1\">**</bpt>TABLE_NAME<ept id=\"p1\">**</ept> only, you would return 0x4 in the <ph id=\"ph1\">`rgRestrictions`</ph> element.","pos":[6980,7082],"source":" Because you want to support **TABLE_NAME** only, you would return 0x4 in the `rgRestrictions` element."},{"content":"If you supported <bpt id=\"p1\">**</bpt>TABLE_CATALOG<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>TABLE_NAME<ept id=\"p2\">**</ept>, you would return 0x5 (binary 101).","pos":[7083,7172],"source":" If you supported **TABLE_CATALOG** and **TABLE_NAME**, you would return 0x5 (binary 101)."},{"content":"By default, the implementation returns 0 (does not support any restrictions) for any request.","pos":[7179,7272]},{"content":"UpdatePV is an example of a provider that does support restrictions.","pos":[7273,7341]},{"content":"Example","pos":[7351,7358]},{"content":"This code is taken from the <bpt id=\"p1\">[</bpt>UpdatePV<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f)</ept> sample.","pos":[7362,7478],"source":"This code is taken from the [UpdatePV](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f) sample."},{"content":"UpdatePv supports the three required schema rowsets: <ph id=\"ph1\">`DBSCHEMA_TABLES`</ph>, <bpt id=\"p1\">**</bpt>DBSCHEMA_COLUMNS<ept id=\"p1\">**</ept>, and <bpt id=\"p2\">**</bpt>DBSCHEMA_PROVIDER_TYPES<ept id=\"p2\">**</ept>.","pos":[7479,7605],"source":" UpdatePv supports the three required schema rowsets: `DBSCHEMA_TABLES`, **DBSCHEMA_COLUMNS**, and **DBSCHEMA_PROVIDER_TYPES**."},{"content":"As an example of how to implement schema support in your provider, this topic takes you through implementing the <bpt id=\"p1\">**</bpt>DBSCHEMA_TABLE<ept id=\"p1\">**</ept> rowset.","pos":[7606,7745],"source":" As an example of how to implement schema support in your provider, this topic takes you through implementing the **DBSCHEMA_TABLE** rowset."},{"pos":[7753,7884],"content":"[!NOTE]\n The sample code might differ from what is listed here; you should regard the sample code as the more up-to-date version.","leadings":["","> "],"nodes":[{"content":"The sample code might differ from what is listed here; you should regard the sample code as the more up-to-date version.","pos":[9,129]}]},{"content":"The first step in adding schema support is to determine which restrictions you are going to support.","pos":[7891,7991]},{"content":"To determine which restrictions are available for your schema rowset, look at the OLE DB specification for the definition of <bpt id=\"p1\">**</bpt>IDBSchemaRowset<ept id=\"p1\">**</ept>.","pos":[7992,8137],"source":" To determine which restrictions are available for your schema rowset, look at the OLE DB specification for the definition of **IDBSchemaRowset**."},{"content":"Following the main definition, you see a table containing the schema rowset name, the number of restrictions, and the restriction columns.","pos":[8138,8276]},{"content":"Select the schema rowset you want to support and make a note of the number of restrictions and restriction columns.","pos":[8277,8392]},{"content":"For example, <ph id=\"ph1\">`DBSCHEMA_TABLES`</ph> supports four restrictions (<bpt id=\"p1\">**</bpt>TABLE_CATALOG<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>TABLE_SCHEMA<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>TABLE_NAME<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>TABLE_TYPE<ept id=\"p4\">**</ept>):","pos":[8393,8525],"source":" For example, `DBSCHEMA_TABLES` supports four restrictions (**TABLE_CATALOG**, **TABLE_SCHEMA**, **TABLE_NAME**, and **TABLE_TYPE**):"},{"content":"A bit represents each restriction column.","pos":[9105,9146]},{"content":"If you want to support a restriction (that is, you can query by it), set that bit to a 1.","pos":[9147,9236]},{"content":"If you do not want to support a restriction, set that bit to zero.","pos":[9237,9303]},{"content":"From the line of code above, UpdatePV supports the <bpt id=\"p1\">**</bpt>TABLE_NAME<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>TABLE_TYPE<ept id=\"p2\">**</ept> restrictions on the <ph id=\"ph1\">`DBSCHEMA_TABLES`</ph> rowset.","pos":[9304,9434],"source":" From the line of code above, UpdatePV supports the **TABLE_NAME** and **TABLE_TYPE** restrictions on the `DBSCHEMA_TABLES` rowset."},{"content":"These are the third (bit mask 100) and fourth (bit mask 1000) restrictions.","pos":[9435,9510]},{"content":"Therefore, the bitmask for UpdatePv is 1100 (or 0x0C):","pos":[9511,9565]},{"content":"The following <ph id=\"ph1\">`Execute`</ph> function is similar to those in regular rowsets.","pos":[9677,9749],"source":"The following `Execute` function is similar to those in regular rowsets."},{"content":"You have three arguments: <ph id=\"ph1\">`pcRowsAffected`</ph>, <ph id=\"ph2\">`cRestrictions`</ph>, and <ph id=\"ph3\">`rgRestrictions`</ph>.","pos":[9750,9832],"source":" You have three arguments: `pcRowsAffected`, `cRestrictions`, and `rgRestrictions`."},{"content":"The <ph id=\"ph1\">`pcRowsAffected`</ph> variable is an output parameter that the provider can return the count of rows in the schema rowset.","pos":[9833,9954],"source":" The `pcRowsAffected` variable is an output parameter that the provider can return the count of rows in the schema rowset."},{"content":"The <ph id=\"ph1\">`cRestrictions`</ph> parameter is an input parameter containing the number of restrictions passed by the consumer to the provider.","pos":[9955,10084],"source":" The `cRestrictions` parameter is an input parameter containing the number of restrictions passed by the consumer to the provider."},{"content":"The <ph id=\"ph1\">`rgRestrictions`</ph> parameter is an array of <bpt id=\"p1\">**</bpt>VARIANT<ept id=\"p1\">**</ept> values that contain the restriction values.","pos":[10085,10186],"source":" The `rgRestrictions` parameter is an array of **VARIANT** values that contain the restriction values."},{"content":"The <ph id=\"ph1\">`cRestrictions`</ph> variable is based on the total number of restrictions for a schema rowset, regardless of whether the provider supports them.","pos":[10325,10469],"source":"The `cRestrictions` variable is based on the total number of restrictions for a schema rowset, regardless of whether the provider supports them."},{"content":"Because UpdatePv supports two restrictions (the third and fourth), this code only looks for a <ph id=\"ph1\">`cRestrictions`</ph> value greater than or equal to three.","pos":[10470,10617],"source":" Because UpdatePv supports two restrictions (the third and fourth), this code only looks for a `cRestrictions` value greater than or equal to three."},{"content":"The value for the <bpt id=\"p1\">**</bpt>TABLE_NAME<ept id=\"p1\">**</ept> restriction is stored in <ph id=\"ph1\">`rgRestrictions[2]`</ph> (again, the third restriction in a zero-based array is 2).","pos":[10624,10760],"source":"The value for the **TABLE_NAME** restriction is stored in `rgRestrictions[2]` (again, the third restriction in a zero-based array is 2)."},{"content":"You need to check that the restriction is not <ph id=\"ph1\">`VT_EMPTY`</ph> to actually support it.","pos":[10761,10841],"source":" You need to check that the restriction is not `VT_EMPTY` to actually support it."},{"content":"Note that <bpt id=\"p1\">**</bpt>VT_NULL<ept id=\"p1\">**</ept> is not equal to <ph id=\"ph1\">`VT_EMPTY`</ph>.","pos":[10842,10891],"source":" Note that **VT_NULL** is not equal to `VT_EMPTY`."},{"content":"<bpt id=\"p1\">**</bpt>VT_NULL<ept id=\"p1\">**</ept> specifies a valid restriction value.","pos":[10892,10940],"source":"**VT_NULL** specifies a valid restriction value."},{"content":"The UpdatePv definition of a table name is a fully qualified path name to a text file.","pos":[10947,11033]},{"content":"Extract the restriction value and then attempt to open the file to ensure that the file does actually exist.","pos":[11034,11142]},{"content":"If the file does not exist, return <ph id=\"ph1\">`S_OK`</ph>.","pos":[11143,11185],"source":" If the file does not exist, return `S_OK`."},{"content":"This might seem a bit backwards but what the code is really telling the consumer is that there were no supported tables by the name specified.","pos":[11186,11328]},{"content":"The <ph id=\"ph1\">`S_OK`</ph> return means that the code executed correctly.","pos":[11329,11386],"source":" The `S_OK` return means that the code executed correctly."},{"content":"Supporting the fourth restriction (<bpt id=\"p1\">**</bpt>TABLE_TYPE<ept id=\"p1\">**</ept>) is similar to the third restriction.","pos":[12467,12554],"source":"Supporting the fourth restriction (**TABLE_TYPE**) is similar to the third restriction."},{"content":"Check to see that the value is not <ph id=\"ph1\">`VT_EMPTY`</ph>.","pos":[12555,12601],"source":" Check to see that the value is not `VT_EMPTY`."},{"content":"This restriction only returns the table type, <bpt id=\"p1\">**</bpt>TABLE<ept id=\"p1\">**</ept>.","pos":[12602,12658],"source":" This restriction only returns the table type, **TABLE**."},{"content":"To determine the valid values for the <ph id=\"ph1\">`DBSCHEMA_TABLES`</ph>, look in Appendix B of the <bpt id=\"p1\">*</bpt>OLE DB Programmer's Reference<ept id=\"p1\">*</ept> in the <bpt id=\"p2\">**</bpt>TABLES<ept id=\"p2\">**</ept> rowset section.","pos":[12659,12807],"source":" To determine the valid values for the `DBSCHEMA_TABLES`, look in Appendix B of the *OLE DB Programmer's Reference* in the **TABLES** rowset section."},{"content":"This is where you actually create a row entry for the rowset.","pos":[13337,13398]},{"content":"The variable <ph id=\"ph1\">`trData`</ph> corresponds to <bpt id=\"p1\">**</bpt>CTABLESRow<ept id=\"p1\">**</ept>, a structure defined in the OLE DB provider templates.","pos":[13399,13505],"source":" The variable `trData` corresponds to **CTABLESRow**, a structure defined in the OLE DB provider templates."},{"content":"<bpt id=\"p1\">**</bpt>CTABLESRow<ept id=\"p1\">**</ept> corresponds to the <bpt id=\"p2\">**</bpt>TABLES<ept id=\"p2\">**</ept> rowset definition in Appendix B of the OLE DB specification.","pos":[13506,13611],"source":"**CTABLESRow** corresponds to the **TABLES** rowset definition in Appendix B of the OLE DB specification."},{"content":"You only have one row to add because you can only support one table at a time.","pos":[13612,13690]},{"content":"UpdatePV sets only three columns: <bpt id=\"p1\">**</bpt>TABLE_NAME<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>TABLE_TYPE<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>DESCRIPTION<ept id=\"p3\">**</ept>.","pos":[13908,13994],"source":"UpdatePV sets only three columns: **TABLE_NAME**, **TABLE_TYPE**, and **DESCRIPTION**."},{"content":"You should make a note of the columns for which you return information, because you need this information when you implement <ph id=\"ph1\">`GetDBStatus`</ph>:","pos":[13995,14134],"source":" You should make a note of the columns for which you return information, because you need this information when you implement `GetDBStatus`:"},{"content":"The <ph id=\"ph1\">`GetDBStatus`</ph> function is very important to the correct operation of the schema rowset.","pos":[14412,14503],"source":"The `GetDBStatus` function is very important to the correct operation of the schema rowset."},{"content":"Because you do not return data for every column in the <bpt id=\"p1\">**</bpt>TABLES<ept id=\"p1\">**</ept> rowset, you need to specify which columns you return data for and which you do not.","pos":[14504,14653],"source":" Because you do not return data for every column in the **TABLES** rowset, you need to specify which columns you return data for and which you do not."},{"content":"Because your <ph id=\"ph1\">`Execute`</ph> function returns data for the <bpt id=\"p1\">**</bpt>TABLE_NAME<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>TABLE_TYPE<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>DESCRIPTION<ept id=\"p3\">**</ept> fields from the <bpt id=\"p4\">**</bpt>TABLES<ept id=\"p4\">**</ept> rowset, you can look in Appendix B of the OLE DB specification and determine (by counting from the top down) that they are ordinals 3, 4, and 6.","pos":[15050,15326],"source":"Because your `Execute` function returns data for the **TABLE_NAME**, **TABLE_TYPE**, and **DESCRIPTION** fields from the **TABLES** rowset, you can look in Appendix B of the OLE DB specification and determine (by counting from the top down) that they are ordinals 3, 4, and 6."},{"content":"For each of those columns, return <bpt id=\"p1\">**</bpt>DBSTATUS_S_OK<ept id=\"p1\">**</ept>.","pos":[15327,15379],"source":" For each of those columns, return **DBSTATUS_S_OK**."},{"content":"For all the other columns, return <bpt id=\"p1\">**</bpt>DBSTATUS_S_ISNULL<ept id=\"p1\">**</ept>.","pos":[15380,15436],"source":" For all the other columns, return **DBSTATUS_S_ISNULL**."},{"content":"It is important to return this status, because a consumer might not understand that the value you return is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or something else.","pos":[15437,15572],"source":" It is important to return this status, because a consumer might not understand that the value you return is **NULL** or something else."},{"content":"Again, note that <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> is not equivalent to empty.","pos":[15573,15626],"source":" Again, note that **NULL** is not equivalent to empty."},{"pos":[15633,15816],"content":"For more information about the OLE DB schema rowset interface, see the <bpt id=\"p1\">[</bpt>IDBSchemaRowset<ept id=\"p1\">](../../data/oledb/idbschemarowsetimpl-class.md)</ept> interface in the OLE DB Programmer's Reference.","source":"For more information about the OLE DB schema rowset interface, see the [IDBSchemaRowset](../../data/oledb/idbschemarowsetimpl-class.md) interface in the OLE DB Programmer's Reference."},{"pos":[15823,16001],"content":"For information about how consumers can use <bpt id=\"p1\">**</bpt>IDBSchemaRowset<ept id=\"p1\">**</ept> methods, see <bpt id=\"p2\">[</bpt>Obtaining Metadata with Schema Rowsets<ept id=\"p2\">](../../data/oledb/obtaining-metadata-with-schema-rowsets.md)</ept>.","source":"For information about how consumers can use **IDBSchemaRowset** methods, see [Obtaining Metadata with Schema Rowsets](../../data/oledb/obtaining-metadata-with-schema-rowsets.md)."},{"pos":[16008,16164],"content":"For an example of an provider that supports schema rowsets, see the <bpt id=\"p1\">[</bpt>UpdatePV<ept id=\"p1\">](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f)</ept> sample.","source":"For an example of an provider that supports schema rowsets, see the [UpdatePV](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f) sample."},{"content":"See Also","pos":[16173,16181]},{"content":"Advanced Provider Techniques","pos":[16186,16214]}],"content":"---\ntitle: \"Supporting Schema Rowsets | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"schema rowsets\"\n  - \"OLE DB consumer templates, schema rowsets\"\n  - \"OLE DB providers, schema rowsets\"\n  - \"OLE DB, schema rowsets\"\nms.assetid: 71c5e14b-6e33-4502-a2d9-a1dc6d6e9ba0\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Supporting Schema Rowsets\nSchema rowsets allow consumers to obtain information about a data store without knowing its underlying structure, or schema. For example, a data store might have tables organized into a user-defined hierarchy, so there would be no way to ensure knowledge of the schema except by reading it. (As another example, note that the Visual C++ wizards use schema rowsets to generate accessors for the consumer.) To allow the consumer to do this, the provider's session object exposes methods on the [IDBSchemaRowset](https://msdn.microsoft.com/en-us/library/ms713686.aspx) interface. In Visual C++ applications, you use the [IDBSchemaRowsetImpl](../../data/oledb/idbschemarowsetimpl-class.md) class to implement **IDBSchemaRowset**.  \n  \n `IDBSchemaRowsetImpl` supports the following methods:  \n  \n-   [CheckRestrictions](../../data/oledb/idbschemarowsetimpl-checkrestrictions.md) checks the validity of restrictions against a schema rowset.  \n  \n-   [CreateSchemaRowset](../../data/oledb/idbschemarowsetimpl-createschemarowset.md) implements a COM object creator function for the object specified by the template parameter.  \n  \n-   [SetRestrictions](../../data/oledb/idbschemarowsetimpl-setrestrictions.md) specifies which restrictions you support on a particular schema rowset.  \n  \n-   [IDBSchemaRowset::GetRowset](../../data/oledb/idbschemarowsetimpl-getrowset.md) returns a schema rowset (inherited from interface).  \n  \n-   [GetSchemas](../../data/oledb/idbschemarowsetimpl-getschemas.md) returns a list of schema rowsets accessible by `IDBSchemaRowsetImpl::GetRowset` (inherited from interface).  \n  \n## ATL OLE DB Provider Wizard Support  \n The ATL OLE DB Provider Wizard creates three schema classes in the session header file:  \n  \n-   **C** *ShortName* **SessionTRSchemaRowset**  \n  \n-   **C** *ShortName* **SessionColSchemaRowset**  \n  \n-   **C** *ShortName* **SessionPTSchemaRowset**  \n  \n These classes respond to consumer requests for schema information; note that the OLE DB specification requires that these three schema rowsets be supported:  \n  \n-   **C** *ShortName* **SessionTRSchemaRowset** handles requests for table information (the `DBSCHEMA_TABLES` schema rowset).  \n  \n-   **C** *ShortName* **SessionColSchemaRowset** handles requests for column information (the **DBSCHEMA_COLUMNS** schema rowset). The wizard supplies sample implementations for these classes, which return schema information for a DOS provider.  \n  \n-   **C** *ShortName* **SessionPTSchemaRowset** handles requests for schema information about the provider type (the **DBSCHEMA_PROVIDER_TYPES** schema rowset). The default implementation provided by the wizard returns `S_OK`.  \n  \n You can customize these classes to handle schema information appropriate to your provider:  \n  \n-   In **C***ShortName***SessionTRSchemaRowset**, you must fill out the catalog, table, and description fields (**trData.m_szType**, **trData.m_szTable**, and **trData.m_szDesc**). The wizard-generated example uses only one row (table). Other providers might return more than one table.  \n  \n-   In **C***ShortName***SessionColSchemaRowset**, you pass the name of the table as a **DBID**.  \n  \n## Setting Restrictions  \n An important concept in schema rowset support is setting restrictions, which you do using `SetRestrictions`. Restrictions allow consumers to fetch only matching rows (for example, find all the columns in the table \"MyTable\"). Restrictions are optional, and in the case in which none are supported (the default), all data is always returned. For an example of a provider that does support restrictions, see the [UpdatePV](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f) sample.  \n  \n## Setting up the Schema Map  \n Set up a schema map such as this one in Session.h in UpdatePV:  \n  \n```  \nBEGIN_SCHEMA_MAP(CUpdateSession)  \n    SCHEMA_ENTRY(DBSCHEMA_TABLES, CUpdateSessionTRSchemaRowset)  \n    SCHEMA_ENTRY(DBSCHEMA_COLUMNS, CUpdateSessionColSchemaRowset)  \n    SCHEMA_ENTRY(DBSCHEMA_PROVIDER_TYPES, CUpdateSessionPTSchemaRowset)  \nEND_SCHEMA_MAP()  \n```  \n  \n To support **IDBSchemaRowset**, you must support `DBSCHEMA_TABLES`, **DBSCHEMA_COLUMNS**, and **DBSCHEMA_PROVIDER_TYPES**. You can add additional schema rowsets at your discretion.  \n  \n Declare a schema rowset class with an `Execute` method such as `CUpdateSessionTRSchemaRowset` in UpdatePV:  \n  \n```  \nclass CUpdateSessionTRSchemaRowset :   \n    public CSchemaRowsetImpl < CUpdateSessionTRSchemaRowset,   \n                              CTABLESRow, CUpdateSession >  \n...  \n// Execute looks like this; what pointers does the consumer use?  \n    HRESULT Execute(DBROWCOUNT* pcRowsAffected,   \n                    ULONG cRestrictions, const VARIANT* rgRestrictions)  \n```  \n  \n Note that `CUpdateSession` inherits from `IDBSchemaRowsetImpl`, so it has all the restriction handling methods. Using `CSchemaRowsetImpl`, declare three child classes (listed in the schema map above): `CUpdateSessionTRSchemaRowset`, `CUpdateSessionColSchemaRowset`, and `CUpdateSessionPTSchemaRowset`. Each of these child classes has an `Execute` method that handles its respective set of restrictions (search criteria). Each `Execute` method compares the values of the `cRestrictions` and `rgRestrictions` parameters. See the description of these parameters in [SetRestrictions](../../data/oledb/idbschemarowsetimpl-setrestrictions.md).  \n  \n For more information about which restrictions correspond to a particular schema rowset, consult the table of schema rowset GUIDs in [IDBSchemaRowset](https://msdn.microsoft.com/en-us/library/ms713686.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winsdkshort](../../atl-mfc-shared/reference/includes/winsdkshort_md.md)].  \n  \n For example, if you supported the **TABLE_NAME** restriction on `DBSCHEMA_TABLES`, you would do the following:  \n  \n First, look up `DBSCHEMA_TABLES` and see that it supports four restrictions (in order).  \n  \n|Schema rowset restriction|Restriction value|  \n|-------------------------------|-----------------------|  \n|**TABLE_CATALOG**|0x1 (binary 1)|  \n|**TABLE_SCHEMA**|0x2 (binary 10)|  \n|**TABLE_NAME**|0x4 (binary 100)|  \n|**TABLE_TYPE**|0x8 (binary 1000)|  \n  \n Next, note that there is one bit for each restriction. Because you want to support **TABLE_NAME** only, you would return 0x4 in the `rgRestrictions` element. If you supported **TABLE_CATALOG** and **TABLE_NAME**, you would return 0x5 (binary 101).  \n  \n By default, the implementation returns 0 (does not support any restrictions) for any request. UpdatePV is an example of a provider that does support restrictions.  \n  \n### Example  \n This code is taken from the [UpdatePV](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f) sample. UpdatePv supports the three required schema rowsets: `DBSCHEMA_TABLES`, **DBSCHEMA_COLUMNS**, and **DBSCHEMA_PROVIDER_TYPES**. As an example of how to implement schema support in your provider, this topic takes you through implementing the **DBSCHEMA_TABLE** rowset.  \n  \n> [!NOTE]\n>  The sample code might differ from what is listed here; you should regard the sample code as the more up-to-date version.  \n  \n The first step in adding schema support is to determine which restrictions you are going to support. To determine which restrictions are available for your schema rowset, look at the OLE DB specification for the definition of **IDBSchemaRowset**. Following the main definition, you see a table containing the schema rowset name, the number of restrictions, and the restriction columns. Select the schema rowset you want to support and make a note of the number of restrictions and restriction columns. For example, `DBSCHEMA_TABLES` supports four restrictions (**TABLE_CATALOG**, **TABLE_SCHEMA**, **TABLE_NAME**, and **TABLE_TYPE**):  \n  \n```  \nvoid SetRestrictions(ULONG cRestrictions, GUID* rguidSchema,   \n   ULONG* rgRestrictions)  \n{  \n    for (ULONG l=0; l<cRestrictions; l++)  \n    {  \n        if (InlineIsEqualGUID(rguidSchema[l], DBSCHEMA_TABLES))  \n            rgRestrictions[l] = 0x0C;  \n        else if (InlineIsEqualGUID(rguidSchema[l], DBSCHEMA_COLUMNS))  \n                 rgRestrictions[l] = 0x04;  \n             else if (InlineIsEqualGUID(rguidSchema[l],  \n                                        DBSCHEMA_PROVIDER_TYPES))  \n                      rgRestrictions[l] = 0x00;  \n   }  \n}  \n```  \n  \n A bit represents each restriction column. If you want to support a restriction (that is, you can query by it), set that bit to a 1. If you do not want to support a restriction, set that bit to zero. From the line of code above, UpdatePV supports the **TABLE_NAME** and **TABLE_TYPE** restrictions on the `DBSCHEMA_TABLES` rowset. These are the third (bit mask 100) and fourth (bit mask 1000) restrictions. Therefore, the bitmask for UpdatePv is 1100 (or 0x0C):  \n  \n```  \nif (InlineIsEqualGUID(rguidSchema[l], DBSCHEMA_TABLES))  \n    rgRestrictions[l] = 0x0C;  \n```  \n  \n The following `Execute` function is similar to those in regular rowsets. You have three arguments: `pcRowsAffected`, `cRestrictions`, and `rgRestrictions`. The `pcRowsAffected` variable is an output parameter that the provider can return the count of rows in the schema rowset. The `cRestrictions` parameter is an input parameter containing the number of restrictions passed by the consumer to the provider. The `rgRestrictions` parameter is an array of **VARIANT** values that contain the restriction values.  \n  \n```  \nHRESULT Execute(DBROWCOUNT* pcRowsAffected, ULONG cRestrictions,   \n                const VARIANT* rgRestrictions)  \n```  \n  \n The `cRestrictions` variable is based on the total number of restrictions for a schema rowset, regardless of whether the provider supports them. Because UpdatePv supports two restrictions (the third and fourth), this code only looks for a `cRestrictions` value greater than or equal to three.  \n  \n The value for the **TABLE_NAME** restriction is stored in `rgRestrictions[2]` (again, the third restriction in a zero-based array is 2). You need to check that the restriction is not `VT_EMPTY` to actually support it. Note that **VT_NULL** is not equal to `VT_EMPTY`. **VT_NULL** specifies a valid restriction value.  \n  \n The UpdatePv definition of a table name is a fully qualified path name to a text file. Extract the restriction value and then attempt to open the file to ensure that the file does actually exist. If the file does not exist, return `S_OK`. This might seem a bit backwards but what the code is really telling the consumer is that there were no supported tables by the name specified. The `S_OK` return means that the code executed correctly.  \n  \n```  \nUSES_CONVERSION;  \nenum {  \n            sizeOfszFile = 255  \n};  \nCTABLESRow  trData;  \nFILE        *pFile = NULL;  \nTCHAR       szFile[ sizeOfszFile ];  \nerrcode     err = 0;  \n  \n// Handle any restrictions sent to us. This only handles  \n// the TABLE_NAME & TABLE_TYPE restictions (the 3rd and 4th   \n// restrictions in DBSCHEMA_TABLES...look in IDBSchemaRowsets   \n// in part 2 of the prog. ref) so your restrictions are 0x08 & 0x04   \n// for a total of (0x0C)  \nif (cRestrictions >= 3 && rgRestrictions[2].vt != VT_EMPTY)  \n{  \n    CComBSTR bstrName = rgRestrictions[2].bstrVal;  \n    if ((rgRestrictions[2].vt == VT_BSTR) && (bstrName != (BSTR)NULL))  \n    {  \n        // Check to see if the file exists  \n        _tcscpy_s(&szFile[0], sizeOfszFile, OLE2T(bstrName));  \n        if (szFile[0] == _T('\\0') ||   \n           ((err = _tfopen(&pFile, &szFile[0], _T(\"r\"))) == 0))  \n        {  \n            return S_OK;// Their restriction was invalid return no data  \n        }  \n        else  \n        {  \n            fclose(pFile);  \n        }  \n    }  \n}  \n```  \n  \n Supporting the fourth restriction (**TABLE_TYPE**) is similar to the third restriction. Check to see that the value is not `VT_EMPTY`. This restriction only returns the table type, **TABLE**. To determine the valid values for the `DBSCHEMA_TABLES`, look in Appendix B of the *OLE DB Programmer's Reference* in the **TABLES** rowset section.  \n  \n```  \n// TABLE_TYPE restriction:  \nif (cRestrictions >=4 && rgRestrictions[3].vt != VT_EMPTY)  \n{  \n    CComBSTR bstrType = rgRestrictions[3].bstrVal;  \n    if ((rgRestrictions[3].vt == VT_BSTR) && (bstrType != (BSTR)NULL))  \n    {  \n        // This is kind of a blind restriction.  \n        // This only actually supports  \n        // TABLES so if you get anything else,   \n        // just return an empty rowset.  \n        if (_tcscmp(_T(\"TABLE\"), OLE2T(bstrType)) != 0)  \n            return S_OK;  \n    }  \n}  \n```  \n  \n This is where you actually create a row entry for the rowset. The variable `trData` corresponds to **CTABLESRow**, a structure defined in the OLE DB provider templates. **CTABLESRow** corresponds to the **TABLES** rowset definition in Appendix B of the OLE DB specification. You only have one row to add because you can only support one table at a time.  \n  \n```  \n// Bring over the data:  \nwcspy_s(trData.m_szType, OLESTR(\"TABLE\"), 5);  \nwcspy_s(trData.m_szDesc, OLESTR(\"The Directory Table\"), 19);  \nwcsncpy_s(trData.m_szTable, T2OLE(szFile), _TRUNCATE());  \n```  \n  \n UpdatePV sets only three columns: **TABLE_NAME**, **TABLE_TYPE**, and **DESCRIPTION**. You should make a note of the columns for which you return information, because you need this information when you implement `GetDBStatus`:  \n  \n```  \n    _ATLTRY  \n    {  \n        m_rgRowData.Add(trData);  \n    }  \n    _ATLCATCHALL()  \n    {  \n        return E_OUTOFMEMORY;  \n    }  \n    //if (!m_rgRowData.Add(trData))  \n    //    return E_OUTOFMEMORY;  \n    *pcRowsAffected = 1;  \n    return S_OK;  \n}  \n```  \n  \n The `GetDBStatus` function is very important to the correct operation of the schema rowset. Because you do not return data for every column in the **TABLES** rowset, you need to specify which columns you return data for and which you do not.  \n  \n```  \nvirtual DBSTATUS GetDBStatus(CSimpleRow* , ATLCOLUMNINFO* pColInfo)  \n{  \n    ATLASSERT(pColInfo != NULL);  \n  \n    switch(pColInfo->iOrdinal)  \n    {  \n    case 3:     // TABLE_NAME  \n    case 4:     // TABLE_TYPE  \n    case 6:     // DESCRIPTION  \n        return DBSTATUS_S_OK;  \n        break;  \n    default:  \n        return DBSTATUS_S_ISNULL;  \n    break;  \n    }  \n}  \n```  \n  \n Because your `Execute` function returns data for the **TABLE_NAME**, **TABLE_TYPE**, and **DESCRIPTION** fields from the **TABLES** rowset, you can look in Appendix B of the OLE DB specification and determine (by counting from the top down) that they are ordinals 3, 4, and 6. For each of those columns, return **DBSTATUS_S_OK**. For all the other columns, return **DBSTATUS_S_ISNULL**. It is important to return this status, because a consumer might not understand that the value you return is **NULL** or something else. Again, note that **NULL** is not equivalent to empty.  \n  \n For more information about the OLE DB schema rowset interface, see the [IDBSchemaRowset](../../data/oledb/idbschemarowsetimpl-class.md) interface in the OLE DB Programmer's Reference.  \n  \n For information about how consumers can use **IDBSchemaRowset** methods, see [Obtaining Metadata with Schema Rowsets](../../data/oledb/obtaining-metadata-with-schema-rowsets.md).  \n  \n For an example of an provider that supports schema rowsets, see the [UpdatePV](http://msdn.microsoft.com/en-us/c8bed873-223c-4a7d-af55-f90138c6f38f) sample.  \n  \n## See Also  \n [Advanced Provider Techniques](../../data/oledb/advanced-provider-techniques.md)"}