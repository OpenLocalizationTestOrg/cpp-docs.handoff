{"nodes":[{"pos":[12,74],"content":"Adding a Property Page (ATL Tutorial, Part 6) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Adding a Property Page (ATL Tutorial, Part 6) | Microsoft Docs","pos":[0,62]}]},{"content":"Adding a Property Page (ATL Tutorial, Part 6)","pos":[567,612]},{"content":"Property pages are implemented as separate COM objects, which allow them to be shared if required.","pos":[613,711]},{"content":"In this step, you will do the following tasks to add a property page to the control:","pos":[712,796]},{"content":"Creating the Property Page Resource","pos":[806,841]},{"content":"Adding Code to Create and Manage the Property Page","pos":[851,901]},{"content":"Adding the Property Page to the Control","pos":[911,950]},{"content":"Creating the Property Page Resource","pos":[959,994]},{"content":"To add a property page to your control, use the ATL Add Class Wizard.","pos":[998,1067]},{"content":"To add a Property Page","pos":[1078,1100]},{"content":"In Solution Explorer, right-click Polygon.","pos":[1110,1152]},{"pos":[1162,1228],"content":"On the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Add Class<ept id=\"p2\">**</ept>.","source":"On the shortcut menu, click **Add**, and then click **Add Class**."},{"pos":[1238,1313],"content":"From the list of templates, select <bpt id=\"p1\">**</bpt>ATL Property Page<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>.","source":"From the list of templates, select **ATL Property Page** and click **Add**."},{"pos":[1323,1405],"content":"When the ATL Property Page Wizard appears, enter <ph id=\"ph1\">`PolyProp`</ph> as the <bpt id=\"p1\">**</bpt>Short<ept id=\"p1\">**</ept> name.","source":"When the ATL Property Page Wizard appears, enter `PolyProp` as the **Short** name."},{"pos":[1415,1502],"content":"Click <bpt id=\"p1\">**</bpt>Strings<ept id=\"p1\">**</ept> to open the <bpt id=\"p2\">**</bpt>Strings<ept id=\"p2\">**</ept> page and enter <bpt id=\"p3\">**</bpt>&amp;Polygon<ept id=\"p3\">**</ept> as the <bpt id=\"p4\">**</bpt>Title<ept id=\"p4\">**</ept>.","source":"Click **Strings** to open the **Strings** page and enter **&Polygon** as the **Title**."},{"content":"The <bpt id=\"p1\">**</bpt>Title<ept id=\"p1\">**</ept> of the property page is the string that appears in the tab for that page.","pos":[1513,1600],"source":"The **Title** of the property page is the string that appears in the tab for that page."},{"content":"The <bpt id=\"p1\">**</bpt>Doc string<ept id=\"p1\">**</ept> is a description that a property frame uses to put in a status line or tool tip.","pos":[1601,1700],"source":" The **Doc string** is a description that a property frame uses to put in a status line or tool tip."},{"content":"Note that the standard property frame currently does not use this string, so you can leave it with the default contents.","pos":[1701,1821]},{"content":"You will not generate a <bpt id=\"p1\">**</bpt>Help file<ept id=\"p1\">**</ept> at the moment, so delete the entry in that text box.","pos":[1822,1912],"source":" You will not generate a **Help file** at the moment, so delete the entry in that text box."},{"pos":[1922,1985],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>, and the property page object will be created.","source":"Click **Finish**, and the property page object will be created."},{"content":"The following three files are created:","pos":[1992,2030]},{"content":"File","pos":[2037,2041]},{"content":"Description","pos":[2042,2053]},{"content":"PolyProp.h","pos":[2091,2101]},{"pos":[2102,2173],"content":"Contains the C++ class <ph id=\"ph1\">`CPolyProp`</ph>, which implements the property page.","source":"Contains the C++ class `CPolyProp`, which implements the property page."},{"content":"PolyProp.cpp","pos":[2178,2190]},{"content":"Includes the PolyProp.h file.","pos":[2191,2220]},{"content":"PolyProp.rgs","pos":[2225,2237]},{"content":"The registry script that registers the property page object.","pos":[2238,2298]},{"content":"The following code changes are also made:","pos":[2306,2347]},{"content":"The new property page is added to the object entry map in Polygon.cpp.","pos":[2357,2427]},{"pos":[2437,2491],"content":"The <ph id=\"ph1\">`PolyProp`</ph> class is added to the Polygon.idl file.","source":"The `PolyProp` class is added to the Polygon.idl file."},{"content":"The new registry script file PolyProp.rgs is added to the project resource.","pos":[2501,2576]},{"content":"A dialog box template is added to the project resource for the property page.","pos":[2586,2663]},{"content":"The property strings that you specified are added to the resource string table.","pos":[2673,2752]},{"content":"Now add the fields that you want to appear on the property page.","pos":[2759,2823]},{"content":"To add fields to the Property Page","pos":[2834,2868]},{"content":"In Solution Explorer, double-click the Polygon.rc resource file.","pos":[2878,2942]},{"content":"This will open Resource View.","pos":[2943,2972]},{"content":"In Resource View, expand the Dialog node and double-click IDD_POLYPROP.","pos":[2982,3053]},{"content":"Note that the dialog box that appears is empty except for a label that tells you to insert your controls here.","pos":[3054,3164]},{"pos":[3174,3285],"content":"Select that label and change it to read <ph id=\"ph1\">`Sides:`</ph> by altering the <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> text in the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> window.","source":"Select that label and change it to read `Sides:` by altering the **Caption** text in the **Properties** window."},{"content":"Resize the label box so that it fits the size of the text.","pos":[3295,3353]},{"content":"Drag an Edit control from the Toolbox to the right of the label.","pos":[3363,3427]},{"pos":[3437,3527],"content":"Finally, change the <bpt id=\"p1\">**</bpt>ID<ept id=\"p1\">**</ept> of the Edit control to <ph id=\"ph1\">`IDC_SIDES`</ph> using the Properties window.","source":"Finally, change the **ID** of the Edit control to `IDC_SIDES` using the Properties window."},{"content":"This completes the process of creating the property page resource.","pos":[3534,3600]},{"content":"Adding Code to Create and Manage the Property Page","pos":[3609,3659]},{"content":"Now that you have created the property page resource, you need to write the implementation code.","pos":[3663,3759]},{"pos":[3766,3881],"content":"First, enable the <ph id=\"ph1\">`CPolyProp`</ph> class to set the number of sides in your object when the <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept> button is pressed.","source":"First, enable the `CPolyProp` class to set the number of sides in your object when the **Apply** button is pressed."},{"content":"To modify the Apply function to set the number of sides","pos":[3892,3947]},{"pos":[3957,4024],"content":"Replace the <ph id=\"ph1\">`Apply`</ph> function in PolyProp.h with the following code:","source":"Replace the `Apply` function in PolyProp.h with the following code:"},{"pos":[4046,4066],"content":"NVC_ATL_Windowing#58"},{"content":"A property page can have more than one client attached to it at a time, so the <ph id=\"ph1\">`Apply`</ph> function loops around and calls <ph id=\"ph2\">`put_Sides`</ph> on each client with the value retrieved from the edit box.","pos":[4146,4335],"source":"A property page can have more than one client attached to it at a time, so the `Apply` function loops around and calls `put_Sides` on each client with the value retrieved from the edit box."},{"content":"You are using the <bpt id=\"p1\">[</bpt>CComQIPtr<ept id=\"p1\">](../atl/reference/ccomqiptr-class.md)</ept> class, which performs the <ph id=\"ph1\">`QueryInterface`</ph> on each object to obtain the <ph id=\"ph2\">`IPolyCtl`</ph> interface from the <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> interface (stored in the <ph id=\"ph3\">`m_ppUnk`</ph> array).","pos":[4336,4560],"source":" You are using the [CComQIPtr](../atl/reference/ccomqiptr-class.md) class, which performs the `QueryInterface` on each object to obtain the `IPolyCtl` interface from the **IUnknown** interface (stored in the `m_ppUnk` array)."},{"content":"The code now checks that setting the <ph id=\"ph1\">`Sides`</ph> property actually worked.","pos":[4567,4637],"source":"The code now checks that setting the `Sides` property actually worked."},{"content":"If it fails, the code displays a message box displaying error details from the <bpt id=\"p1\">**</bpt>IErrorInfo<ept id=\"p1\">**</ept> interface.","pos":[4638,4742],"source":" If it fails, the code displays a message box displaying error details from the **IErrorInfo** interface."},{"content":"Typically, a container asks an object for the <bpt id=\"p1\">**</bpt>ISupportErrorInfo<ept id=\"p1\">**</ept> interface and calls <ph id=\"ph1\">`InterfaceSupportsErrorInfo`</ph> first, to determine whether the object supports setting error information.","pos":[4743,4934],"source":" Typically, a container asks an object for the **ISupportErrorInfo** interface and calls `InterfaceSupportsErrorInfo` first, to determine whether the object supports setting error information."},{"content":"You can skip this task.","pos":[4935,4958]},{"content":"<bpt id=\"p1\">[</bpt>CComPtr<ept id=\"p1\">](../atl/reference/ccomptr-class.md)</ept> helps you by automatically handling the reference counting, so you do not need to call <ph id=\"ph1\">`Release`</ph> on the interface.","pos":[4965,5124],"source":"[CComPtr](../atl/reference/ccomptr-class.md) helps you by automatically handling the reference counting, so you do not need to call `Release` on the interface."},{"content":"helps you with <ph id=\"ph1\">`BSTR`</ph> processing, so you do not have to perform the final <ph id=\"ph2\">`SysFreeString`</ph> call.","pos":[5136,5231],"source":" helps you with `BSTR` processing, so you do not have to perform the final `SysFreeString` call."},{"content":"You also use one of the various string conversion classes, so you can convert the <ph id=\"ph1\">`BSTR`</ph> if necessary (this is why the <ph id=\"ph2\">`USES_CONVERSION`</ph> macro is at the start of the function).","pos":[5232,5408],"source":" You also use one of the various string conversion classes, so you can convert the `BSTR` if necessary (this is why the `USES_CONVERSION` macro is at the start of the function)."},{"content":"You also need to set the property page's dirty flag to indicate that the <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept> button should be enabled.","pos":[5415,5523],"source":"You also need to set the property page's dirty flag to indicate that the **Apply** button should be enabled."},{"content":"This occurs when the user changes the value in the <bpt id=\"p1\">**</bpt>Sides<ept id=\"p1\">**</ept> edit box.","pos":[5524,5594],"source":" This occurs when the user changes the value in the **Sides** edit box."},{"content":"To handle the Apply button","pos":[5605,5631]},{"pos":[5641,5724],"content":"In Class View, right-click CPolyProp and click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> on the shortcut menu.","source":"In Class View, right-click CPolyProp and click **Properties** on the shortcut menu."},{"pos":[5734,5786],"content":"In the Properties window, click the <bpt id=\"p1\">**</bpt>Events<ept id=\"p1\">**</ept> icon.","source":"In the Properties window, click the **Events** icon."},{"pos":[5796,5842],"content":"Expand the <ph id=\"ph1\">`IDC_SIDES`</ph> node in the event list.","source":"Expand the `IDC_SIDES` node in the event list."},{"content":"Select <ph id=\"ph1\">`EN_CHANGE`</ph>, and from the drop-down menu to the right, click <bpt id=\"p1\">**</bpt><ph id=\"ph2\">\\&lt;</ph>Add&gt; OnEnChangeSides<ept id=\"p1\">**</ept>.","pos":[5852,5947],"source":"Select `EN_CHANGE`, and from the drop-down menu to the right, click **\\<Add> OnEnChangeSides**."},{"content":"The <ph id=\"ph1\">`OnEnChangeSides`</ph> handler declaration will be added to Polyprop.h, and the handler implementation to Polyprop.cpp.","pos":[5948,6066],"source":" The `OnEnChangeSides` handler declaration will be added to Polyprop.h, and the handler implementation to Polyprop.cpp."},{"content":"Next, you will modify the handler.","pos":[6073,6107]},{"content":"To modify the OnEnChangeSides method","pos":[6118,6154]},{"pos":[6164,6281],"content":"Add the following code in Polyprop.cpp to the <ph id=\"ph1\">`OnEnChangeSides`</ph> method (deleting any code that the wizard put there):","source":"Add the following code in Polyprop.cpp to the `OnEnChangeSides` method (deleting any code that the wizard put there):"},{"pos":[6303,6323],"content":"NVC_ATL_Windowing#59"},{"content":"will be called when a <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> message is sent with the <bpt id=\"p2\">**</bpt>EN_CHANGE<ept id=\"p2\">**</ept> notification for the <ph id=\"ph1\">`IDC_SIDES`</ph> control.","pos":[6423,6540],"source":" will be called when a **WM_COMMAND** message is sent with the **EN_CHANGE** notification for the `IDC_SIDES` control."},{"content":"then calls <ph id=\"ph1\">`SetDirty`</ph> and passes <ph id=\"ph2\">`TRUE`</ph> to indicate the property page is now dirty and the <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept> button should be enabled.","pos":[6559,6685],"source":" then calls `SetDirty` and passes `TRUE` to indicate the property page is now dirty and the **Apply** button should be enabled."},{"content":"Adding the Property Page to the Control","pos":[6694,6733]},{"content":"The ATL Add Class Wizard and the ATL Property Page Wizard do not add the property page to your control for you automatically, because there could be multiple controls in your project.","pos":[6737,6920]},{"content":"You will need to add an entry to the control's property map.","pos":[6921,6981]},{"content":"To add the property page","pos":[6992,7016]},{"content":"Open PolyCtl.h and add this line to the property map:","pos":[7026,7079]},{"pos":[7101,7121],"content":"NVC_ATL_Windowing#60"},{"content":"The control's property map now looks like this:","pos":[7201,7248]},{"pos":[7266,7286],"content":"NVC_ATL_Windowing#61"},{"pos":[7366,7560],"content":"You could have added a <ph id=\"ph1\">`PROP_PAGE`</ph> macro with the CLSID of your property page, but if you use the <ph id=\"ph2\">`PROP_ENTRY`</ph> macro as shown, the <ph id=\"ph3\">`Sides`</ph> property value is also saved when the control is saved.","source":"You could have added a `PROP_PAGE` macro with the CLSID of your property page, but if you use the `PROP_ENTRY` macro as shown, the `Sides` property value is also saved when the control is saved."},{"content":"The three parameters to the macro are the property description, the DISPID of the property, and the CLSID of the property page that has the property on it.","pos":[7567,7722]},{"content":"This is useful if, for example, you load the control into Visual Basic and set the number of Sides at design time.","pos":[7723,7837]},{"content":"Because the number of Sides is saved, when you reload your Visual Basic project, the number of Sides will be restored.","pos":[7838,7956]},{"content":"Building and Testing the Control","pos":[7965,7997]},{"content":"Now build that control and insert it into ActiveX Control Test Container.","pos":[8001,8074]},{"content":"In Test Container, on the <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>PolyCtl Class Object<ept id=\"p2\">**</ept>.","pos":[8075,8147],"source":" In Test Container, on the **Edit** menu, click **PolyCtl Class Object**."},{"content":"The property page appears; click the <bpt id=\"p1\">**</bpt>Polygon<ept id=\"p1\">**</ept> tab.","pos":[8148,8201],"source":" The property page appears; click the **Polygon** tab."},{"content":"The <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept> button is initially disabled.","pos":[8208,8251],"source":"The **Apply** button is initially disabled."},{"content":"Start typing a value in the <bpt id=\"p1\">**</bpt>Sides<ept id=\"p1\">**</ept> box and the <bpt id=\"p2\">**</bpt>Apply<ept id=\"p2\">**</ept> button will become enabled.","pos":[8252,8339],"source":" Start typing a value in the **Sides** box and the **Apply** button will become enabled."},{"content":"After you have finished entering the value, click the <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept> button.","pos":[8340,8411],"source":" After you have finished entering the value, click the **Apply** button."},{"content":"The control display changes, and the <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept> button is again disabled.","pos":[8412,8484],"source":" The control display changes, and the **Apply** button is again disabled."},{"content":"Try entering an invalid value.","pos":[8485,8515]},{"content":"You will see a message box containing the error description that you set from the <ph id=\"ph1\">`put_Sides`</ph> function.","pos":[8516,8619],"source":" You will see a message box containing the error description that you set from the `put_Sides` function."},{"content":"Next, you will put your control on a Web page.","pos":[8626,8672]},{"pos":[8679,8829],"content":"<bpt id=\"p1\">[</bpt>Back to Step 5<ept id=\"p1\">](../atl/adding-an-event-atl-tutorial-part-5.md)</ept> &amp;#124; <bpt id=\"p2\">[</bpt>On to Step 7<ept id=\"p2\">](../atl/putting-the-control-on-a-web-page-atl-tutorial-part-7.md)</ept>","source":"[Back to Step 5](../atl/adding-an-event-atl-tutorial-part-5.md) &#124; [On to Step 7](../atl/putting-the-control-on-a-web-page-atl-tutorial-part-7.md)"},{"content":"See Also","pos":[8838,8846]},{"content":"Tutorial","pos":[8851,8859]}],"content":"---\ntitle: \"Adding a Property Page (ATL Tutorial, Part 6) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nms.assetid: df80d255-e7ea-49d9-b940-3f012e90cf9b\ncaps.latest.revision: 15\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Adding a Property Page (ATL Tutorial, Part 6)\nProperty pages are implemented as separate COM objects, which allow them to be shared if required. In this step, you will do the following tasks to add a property page to the control:  \n  \n-   Creating the Property Page Resource  \n  \n-   Adding Code to Create and Manage the Property Page  \n  \n-   Adding the Property Page to the Control  \n  \n## Creating the Property Page Resource  \n To add a property page to your control, use the ATL Add Class Wizard.  \n  \n#### To add a Property Page  \n  \n1.  In Solution Explorer, right-click Polygon.  \n  \n2.  On the shortcut menu, click **Add**, and then click **Add Class**.  \n  \n3.  From the list of templates, select **ATL Property Page** and click **Add**.  \n  \n4.  When the ATL Property Page Wizard appears, enter `PolyProp` as the **Short** name.  \n  \n5.  Click **Strings** to open the **Strings** page and enter **&Polygon** as the **Title**.  \n  \n     The **Title** of the property page is the string that appears in the tab for that page. The **Doc string** is a description that a property frame uses to put in a status line or tool tip. Note that the standard property frame currently does not use this string, so you can leave it with the default contents. You will not generate a **Help file** at the moment, so delete the entry in that text box.  \n  \n6.  Click **Finish**, and the property page object will be created.  \n  \n The following three files are created:  \n  \n|File|Description|  \n|----------|-----------------|  \n|PolyProp.h|Contains the C++ class `CPolyProp`, which implements the property page.|  \n|PolyProp.cpp|Includes the PolyProp.h file.|  \n|PolyProp.rgs|The registry script that registers the property page object.|  \n  \n The following code changes are also made:  \n  \n-   The new property page is added to the object entry map in Polygon.cpp.  \n  \n-   The `PolyProp` class is added to the Polygon.idl file.  \n  \n-   The new registry script file PolyProp.rgs is added to the project resource.  \n  \n-   A dialog box template is added to the project resource for the property page.  \n  \n-   The property strings that you specified are added to the resource string table.  \n  \n Now add the fields that you want to appear on the property page.  \n  \n#### To add fields to the Property Page  \n  \n1.  In Solution Explorer, double-click the Polygon.rc resource file. This will open Resource View.  \n  \n2.  In Resource View, expand the Dialog node and double-click IDD_POLYPROP. Note that the dialog box that appears is empty except for a label that tells you to insert your controls here.  \n  \n3.  Select that label and change it to read `Sides:` by altering the **Caption** text in the **Properties** window.  \n  \n4.  Resize the label box so that it fits the size of the text.  \n  \n5.  Drag an Edit control from the Toolbox to the right of the label.  \n  \n6.  Finally, change the **ID** of the Edit control to `IDC_SIDES` using the Properties window.  \n  \n This completes the process of creating the property page resource.  \n  \n## Adding Code to Create and Manage the Property Page  \n Now that you have created the property page resource, you need to write the implementation code.  \n  \n First, enable the `CPolyProp` class to set the number of sides in your object when the **Apply** button is pressed.  \n  \n#### To modify the Apply function to set the number of sides  \n  \n1.  Replace the `Apply` function in PolyProp.h with the following code:  \n  \n     [!code-cpp[NVC_ATL_Windowing#58](../atl/codesnippet/cpp/adding-a-property-page-atl-tutorial-part-6_1.h)]  \n  \n A property page can have more than one client attached to it at a time, so the `Apply` function loops around and calls `put_Sides` on each client with the value retrieved from the edit box. You are using the [CComQIPtr](../atl/reference/ccomqiptr-class.md) class, which performs the `QueryInterface` on each object to obtain the `IPolyCtl` interface from the **IUnknown** interface (stored in the `m_ppUnk` array).  \n  \n The code now checks that setting the `Sides` property actually worked. If it fails, the code displays a message box displaying error details from the **IErrorInfo** interface. Typically, a container asks an object for the **ISupportErrorInfo** interface and calls `InterfaceSupportsErrorInfo` first, to determine whether the object supports setting error information. You can skip this task.  \n  \n [CComPtr](../atl/reference/ccomptr-class.md) helps you by automatically handling the reference counting, so you do not need to call `Release` on the interface. `CComBSTR` helps you with `BSTR` processing, so you do not have to perform the final `SysFreeString` call. You also use one of the various string conversion classes, so you can convert the `BSTR` if necessary (this is why the `USES_CONVERSION` macro is at the start of the function).  \n  \n You also need to set the property page's dirty flag to indicate that the **Apply** button should be enabled. This occurs when the user changes the value in the **Sides** edit box.  \n  \n#### To handle the Apply button  \n  \n1.  In Class View, right-click CPolyProp and click **Properties** on the shortcut menu.  \n  \n2.  In the Properties window, click the **Events** icon.  \n  \n3.  Expand the `IDC_SIDES` node in the event list.  \n  \n4.  Select `EN_CHANGE`, and from the drop-down menu to the right, click **\\<Add> OnEnChangeSides**. The `OnEnChangeSides` handler declaration will be added to Polyprop.h, and the handler implementation to Polyprop.cpp.  \n  \n Next, you will modify the handler.  \n  \n#### To modify the OnEnChangeSides method  \n  \n1.  Add the following code in Polyprop.cpp to the `OnEnChangeSides` method (deleting any code that the wizard put there):  \n  \n     [!code-cpp[NVC_ATL_Windowing#59](../atl/codesnippet/cpp/adding-a-property-page-atl-tutorial-part-6_2.cpp)]  \n  \n `OnEnChangeSides` will be called when a **WM_COMMAND** message is sent with the **EN_CHANGE** notification for the `IDC_SIDES` control. `OnEnChangeSides` then calls `SetDirty` and passes `TRUE` to indicate the property page is now dirty and the **Apply** button should be enabled.  \n  \n## Adding the Property Page to the Control  \n The ATL Add Class Wizard and the ATL Property Page Wizard do not add the property page to your control for you automatically, because there could be multiple controls in your project. You will need to add an entry to the control's property map.  \n  \n#### To add the property page  \n  \n1.  Open PolyCtl.h and add this line to the property map:  \n  \n     [!code-cpp[NVC_ATL_Windowing#60](../atl/codesnippet/cpp/adding-a-property-page-atl-tutorial-part-6_3.h)]  \n  \n The control's property map now looks like this:  \n  \n [!code-cpp[NVC_ATL_Windowing#61](../atl/codesnippet/cpp/adding-a-property-page-atl-tutorial-part-6_4.h)]  \n  \n You could have added a `PROP_PAGE` macro with the CLSID of your property page, but if you use the `PROP_ENTRY` macro as shown, the `Sides` property value is also saved when the control is saved.  \n  \n The three parameters to the macro are the property description, the DISPID of the property, and the CLSID of the property page that has the property on it. This is useful if, for example, you load the control into Visual Basic and set the number of Sides at design time. Because the number of Sides is saved, when you reload your Visual Basic project, the number of Sides will be restored.  \n  \n## Building and Testing the Control  \n Now build that control and insert it into ActiveX Control Test Container. In Test Container, on the **Edit** menu, click **PolyCtl Class Object**. The property page appears; click the **Polygon** tab.  \n  \n The **Apply** button is initially disabled. Start typing a value in the **Sides** box and the **Apply** button will become enabled. After you have finished entering the value, click the **Apply** button. The control display changes, and the **Apply** button is again disabled. Try entering an invalid value. You will see a message box containing the error description that you set from the `put_Sides` function.  \n  \n Next, you will put your control on a Web page.  \n  \n [Back to Step 5](../atl/adding-an-event-atl-tutorial-part-5.md) &#124; [On to Step 7](../atl/putting-the-control-on-a-web-page-atl-tutorial-part-7.md)  \n  \n## See Also  \n [Tutorial](../atl/active-template-library-atl-tutorial.md)\n\n"}