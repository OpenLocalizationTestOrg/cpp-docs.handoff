{"nodes":[{"pos":[12,59],"content":"Redistributing the MFC Library | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Redistributing the MFC Library | Microsoft Docs","pos":[0,47]}]},{"content":"Redistributing the MFC Library","pos":[621,651]},{"content":"If you dynamically link your application to the MFC library, you must redistribute the matching MFC DLL.","pos":[652,756]},{"content":"For example, if your MFC app is built by using the version of MFC that ships with Visual Studio 2015, you must redistribute mfc140.dll or mfc140u.dll, depending on whether your app is compiled for narrow characters or Unicode support.","pos":[757,991]},{"pos":[999,1234],"content":"[!NOTE]\n The mfc140.dll files were omitted from the redistributable files directory in Visual Studio 2015 RTM. You can use the versions installed by Visual Studio 2015 in the Windows\\system32 and Windows\\syswow64 directories instead.","leadings":["","> "],"nodes":[{"content":" The mfc140.dll files were omitted from the redistributable files directory in Visual Studio 2015 RTM. You can use the versions installed by Visual Studio 2015 in the Windows\\system32 and Windows\\syswow64 directories instead.","pos":[8,233],"nodes":[{"content":"The mfc140.dll files were omitted from the redistributable files directory in Visual Studio 2015 RTM.","pos":[1,102]},{"content":"You can use the versions installed by Visual Studio 2015 in the Windows\\system32 and Windows\\syswow64 directories instead.","pos":[103,225]}]}]},{"content":"Because all MFC DLLs use the shared version of the C runtime library (CRT), You may also need to redistribute the CRT.","pos":[1241,1359]},{"content":"The version of MFC that ships with Visual Studio 2015 uses the universal CRT library, which is distributed as part of Windows 10.","pos":[1360,1489]},{"content":"To run an MFC application built by using Visual Studio 2015 on earlier versions of Windows, you must redistribute the Universal CRT.","pos":[1490,1622]},{"content":"For information on how to redistribute the universal CRT as an operating system component or by using local deployment, see <bpt id=\"p1\">[</bpt>Introducing the Universal CRT<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=617977)</ept>.","pos":[1623,1826],"source":" For information on how to redistribute the universal CRT as an operating system component or by using local deployment, see [Introducing the Universal CRT](http://go.microsoft.com/fwlink/?LinkId=617977)."},{"content":"To download the univeral CRT for central deployment on supported versions of Windows, see <bpt id=\"p1\">[</bpt>Windows 10 Universal C Runtime<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619489)</ept>.","pos":[1827,1999],"source":" To download the univeral CRT for central deployment on supported versions of Windows, see [Windows 10 Universal C Runtime](http://go.microsoft.com/fwlink/p/?LinkId=619489)."},{"content":"Redistributable architecture-specific versions of ucrtbase.dll for local deployment are found in the Windows SDK.","pos":[2000,2113]},{"content":"By default, Visual Studio installs these in C:\\Program Files (x86)\\Windows Kits\\10\\Redist\\ucrt\\DLLs\\ in an architecture-specific sub-directory.","pos":[2114,2257]},{"content":"If your app is built by using an earlier version of the MFC library, you must redistribute the matching CRT DLL from the redistributable files directory.","pos":[2264,2417]},{"content":"For example, if your MFC application is built by using the Visual Studio 2013 (vc120) toolset, you must redistribute the msvcr120.dll.","pos":[2418,2552]},{"content":"You also have to redistribute the matching mfc<ph id=\"ph1\">`&lt;version&gt;`</ph>u.dll or mfc<ph id=\"ph2\">`&lt;version&gt;`</ph>.dll.","pos":[2553,2638],"source":" You also have to redistribute the matching mfc`<version>`u.dll or mfc`<version>`.dll."},{"content":"If you statically link your application to MFC (that is, if you specify <bpt id=\"p1\">**</bpt>Use MFC in a Static Library<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>General<ept id=\"p2\">**</ept> tab in the <bpt id=\"p3\">**</bpt>Property Pages<ept id=\"p3\">**</ept> dialog box), you do not have to redistribute an MFC DLL.","pos":[2645,2854],"source":"If you statically link your application to MFC (that is, if you specify **Use MFC in a Static Library** on the **General** tab in the **Property Pages** dialog box), you do not have to redistribute an MFC DLL."},{"content":"However, although static linking may work for testing and internal deployment of applications, we recommend that you do not use it to redistribute MFC.","pos":[2855,3006]},{"content":"For more information about the recommended strategies for deploying Visual C++ libraries, see <bpt id=\"p1\">[</bpt>Choosing a Deployment Method<ept id=\"p1\">](../ide/choosing-a-deployment-method.md)</ept>.","pos":[3007,3172],"source":" For more information about the recommended strategies for deploying Visual C++ libraries, see [Choosing a Deployment Method](../ide/choosing-a-deployment-method.md)."},{"content":"If your application uses the MFC classes that implement the WebBrowser control (for example, <bpt id=\"p1\">[</bpt>CHtmlView Class<ept id=\"p1\">](../mfc/reference/chtmlview-class.md)</ept> or <bpt id=\"p2\">[</bpt>CHtmlEditView Class<ept id=\"p2\">](../mfc/reference/chtmleditview-class.md)</ept>), we recommend that you also install the most current version of Microsoft Internet Explorer so that the target computer will have the most current common control files.","pos":[3179,3562],"source":"If your application uses the MFC classes that implement the WebBrowser control (for example, [CHtmlView Class](../mfc/reference/chtmlview-class.md) or [CHtmlEditView Class](../mfc/reference/chtmleditview-class.md)), we recommend that you also install the most current version of Microsoft Internet Explorer so that the target computer will have the most current common control files."},{"content":"(At a minimum, Internet Explorer 4.0 is required.) Information about how to install Internet Explorer components is available in \"Article 185375: How To Create a Single EXE Install of Internet Explorer\" on the Microsoft Support website.","pos":[3563,3799]},{"content":"If your application uses the MFC database classes (for example, <bpt id=\"p1\">[</bpt>CRecordset Class<ept id=\"p1\">](../mfc/reference/crecordset-class.md)</ept> and <bpt id=\"p2\">[</bpt>CRecordView Class<ept id=\"p2\">](../mfc/reference/crecordview-class.md)</ept>), you must redistribute ODBC and any ODBC drivers that your application uses.","pos":[3806,4067],"source":"If your application uses the MFC database classes (for example, [CRecordset Class](../mfc/reference/crecordset-class.md) and [CRecordView Class](../mfc/reference/crecordview-class.md)), you must redistribute ODBC and any ODBC drivers that your application uses."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Redistributing Database Support Files<ept id=\"p1\">](../ide/redistributing-database-support-files.md)</ept>.","pos":[4068,4183],"source":" For more information, see [Redistributing Database Support Files](../ide/redistributing-database-support-files.md)."},{"content":"If your MFC application uses Windows Forms controls, you must redistribute mfcmifc80.dll with your application.","pos":[4190,4301]},{"content":"This DLL is a strong-name-signed .NET assembly that can be redistributed with an application in its application local folder or by deploying it to the Global Assembly Cache (GAC) by using the <bpt id=\"p1\">[</bpt>Gacutil.exe (Global Assembly Cache Tool)<ept id=\"p1\">](http://msdn.microsoft.com/Library/4c7be9c8-72ae-481f-a01c-1a4716806e99)</ept>.","pos":[4302,4609],"source":" This DLL is a strong-name-signed .NET assembly that can be redistributed with an application in its application local folder or by deploying it to the Global Assembly Cache (GAC) by using the [Gacutil.exe (Global Assembly Cache Tool)](http://msdn.microsoft.com/Library/4c7be9c8-72ae-481f-a01c-1a4716806e99)."},{"content":"If you redistribute an MFC DLL, make sure to redistribute the retail version and not the debug version.","pos":[4616,4719]},{"content":"Debug versions of the DLLs are not redistributable.","pos":[4720,4771]},{"content":"The names of debug versions of the MFC DLLs end with a \"d\", for example, Mfc140d.dll.","pos":[4772,4857]},{"content":"You can redistribute MFC by using either VCRedist_<bpt id=\"p1\">*</bpt>architecture<ept id=\"p1\">*</ept>.exe, merge modules that are installed with Visual Studio, or by deploying the MFC DLL to the same folder as your application.","pos":[4864,5054],"source":"You can redistribute MFC by using either VCRedist_*architecture*.exe, merge modules that are installed with Visual Studio, or by deploying the MFC DLL to the same folder as your application."},{"content":"For more information about how to redistribute MFC, see <bpt id=\"p1\">[</bpt>Redistributing Visual C++ Files<ept id=\"p1\">](../ide/redistributing-visual-cpp-files.md)</ept>.","pos":[5055,5188],"source":" For more information about how to redistribute MFC, see [Redistributing Visual C++ Files](../ide/redistributing-visual-cpp-files.md)."},{"content":"Installation of Localized MFC Components","pos":[5197,5237]},{"content":"If you decide to localize your application by installing an MFC localization DLL, you must use the redistributable merge files (.msm).","pos":[5241,5375]},{"content":"For example, if you want to localize your application on an x86 computer, you must merge Microsoft_VC<ph id=\"ph1\">`&lt;version&gt;`</ph>_MFCLOC_x86.msm into the installation package for an x86 computer.","pos":[5376,5554],"source":" For example, if you want to localize your application on an x86 computer, you must merge Microsoft_VC`<version>`_MFCLOC_x86.msm into the installation package for an x86 computer."},{"content":"The redistributable .msm files contain the DLLs that are used for localization.","pos":[5561,5640]},{"content":"There is one DLL for each supported language.","pos":[5641,5686]},{"content":"The installation process installs these DLLs in the %windir%\\system32\\ folder on the target computer.","pos":[5687,5788]},{"pos":[5795,6082],"content":"For more information about how to localize MFC applications, see <bpt id=\"p1\">[</bpt>TN057: Localization of MFC Components<ept id=\"p1\">](../mfc/tn057-localization-of-mfc-components.md)</ept>, and also <bpt id=\"p2\">[</bpt>Article 208983: How to Using MFC LOC DLLs<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkId=198025)</ept> on the Microsoft Support website.","source":"For more information about how to localize MFC applications, see [TN057: Localization of MFC Components](../mfc/tn057-localization-of-mfc-components.md), and also [Article 208983: How to Using MFC LOC DLLs](http://go.microsoft.com/fwlink/?LinkId=198025) on the Microsoft Support website."},{"content":"You can redistribute MFC localization DLLs by deploying the MFC DLL in your application local folder.","pos":[6089,6190]},{"content":"For more information about how to redistribute Visual C++ libraries, see <bpt id=\"p1\">[</bpt>Redistributing Visual C++ Files<ept id=\"p1\">](../ide/redistributing-visual-cpp-files.md)</ept>.","pos":[6191,6341],"source":" For more information about how to redistribute Visual C++ libraries, see [Redistributing Visual C++ Files](../ide/redistributing-visual-cpp-files.md)."},{"content":"See Also","pos":[6350,6358]},{"content":"Redistributing Visual C++ Files","pos":[6363,6394]}],"content":"---\ntitle: \"Redistributing the MFC Library | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC, redistributing\"\n  - \"redistributing MFC library\"\nms.assetid: 72714ce1-385e-4c1c-afa5-96b03e873866\ncaps.latest.revision: 32\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Redistributing the MFC Library\nIf you dynamically link your application to the MFC library, you must redistribute the matching MFC DLL. For example, if your MFC app is built by using the version of MFC that ships with Visual Studio 2015, you must redistribute mfc140.dll or mfc140u.dll, depending on whether your app is compiled for narrow characters or Unicode support.  \n  \n> [!NOTE]\n>  The mfc140.dll files were omitted from the redistributable files directory in Visual Studio 2015 RTM. You can use the versions installed by Visual Studio 2015 in the Windows\\system32 and Windows\\syswow64 directories instead.  \n  \n Because all MFC DLLs use the shared version of the C runtime library (CRT), You may also need to redistribute the CRT. The version of MFC that ships with Visual Studio 2015 uses the universal CRT library, which is distributed as part of Windows 10. To run an MFC application built by using Visual Studio 2015 on earlier versions of Windows, you must redistribute the Universal CRT. For information on how to redistribute the universal CRT as an operating system component or by using local deployment, see [Introducing the Universal CRT](http://go.microsoft.com/fwlink/?LinkId=617977). To download the univeral CRT for central deployment on supported versions of Windows, see [Windows 10 Universal C Runtime](http://go.microsoft.com/fwlink/p/?LinkId=619489). Redistributable architecture-specific versions of ucrtbase.dll for local deployment are found in the Windows SDK. By default, Visual Studio installs these in C:\\Program Files (x86)\\Windows Kits\\10\\Redist\\ucrt\\DLLs\\ in an architecture-specific sub-directory.  \n  \n If your app is built by using an earlier version of the MFC library, you must redistribute the matching CRT DLL from the redistributable files directory. For example, if your MFC application is built by using the Visual Studio 2013 (vc120) toolset, you must redistribute the msvcr120.dll. You also have to redistribute the matching mfc`<version>`u.dll or mfc`<version>`.dll.  \n  \n If you statically link your application to MFC (that is, if you specify **Use MFC in a Static Library** on the **General** tab in the **Property Pages** dialog box), you do not have to redistribute an MFC DLL. However, although static linking may work for testing and internal deployment of applications, we recommend that you do not use it to redistribute MFC. For more information about the recommended strategies for deploying Visual C++ libraries, see [Choosing a Deployment Method](../ide/choosing-a-deployment-method.md).  \n  \n If your application uses the MFC classes that implement the WebBrowser control (for example, [CHtmlView Class](../mfc/reference/chtmlview-class.md) or [CHtmlEditView Class](../mfc/reference/chtmleditview-class.md)), we recommend that you also install the most current version of Microsoft Internet Explorer so that the target computer will have the most current common control files. (At a minimum, Internet Explorer 4.0 is required.) Information about how to install Internet Explorer components is available in \"Article 185375: How To Create a Single EXE Install of Internet Explorer\" on the Microsoft Support website.  \n  \n If your application uses the MFC database classes (for example, [CRecordset Class](../mfc/reference/crecordset-class.md) and [CRecordView Class](../mfc/reference/crecordview-class.md)), you must redistribute ODBC and any ODBC drivers that your application uses. For more information, see [Redistributing Database Support Files](../ide/redistributing-database-support-files.md).  \n  \n If your MFC application uses Windows Forms controls, you must redistribute mfcmifc80.dll with your application. This DLL is a strong-name-signed .NET assembly that can be redistributed with an application in its application local folder or by deploying it to the Global Assembly Cache (GAC) by using the [Gacutil.exe (Global Assembly Cache Tool)](http://msdn.microsoft.com/Library/4c7be9c8-72ae-481f-a01c-1a4716806e99).  \n  \n If you redistribute an MFC DLL, make sure to redistribute the retail version and not the debug version. Debug versions of the DLLs are not redistributable. The names of debug versions of the MFC DLLs end with a \"d\", for example, Mfc140d.dll.  \n  \n You can redistribute MFC by using either VCRedist_*architecture*.exe, merge modules that are installed with Visual Studio, or by deploying the MFC DLL to the same folder as your application. For more information about how to redistribute MFC, see [Redistributing Visual C++ Files](../ide/redistributing-visual-cpp-files.md).  \n  \n## Installation of Localized MFC Components  \n If you decide to localize your application by installing an MFC localization DLL, you must use the redistributable merge files (.msm). For example, if you want to localize your application on an x86 computer, you must merge Microsoft_VC`<version>`_MFCLOC_x86.msm into the installation package for an x86 computer.  \n  \n The redistributable .msm files contain the DLLs that are used for localization. There is one DLL for each supported language. The installation process installs these DLLs in the %windir%\\system32\\ folder on the target computer.  \n  \n For more information about how to localize MFC applications, see [TN057: Localization of MFC Components](../mfc/tn057-localization-of-mfc-components.md), and also [Article 208983: How to Using MFC LOC DLLs](http://go.microsoft.com/fwlink/?LinkId=198025) on the Microsoft Support website.  \n  \n You can redistribute MFC localization DLLs by deploying the MFC DLL in your application local folder. For more information about how to redistribute Visual C++ libraries, see [Redistributing Visual C++ Files](../ide/redistributing-visual-cpp-files.md).  \n  \n## See Also  \n [Redistributing Visual C++ Files](../ide/redistributing-visual-cpp-files.md)"}