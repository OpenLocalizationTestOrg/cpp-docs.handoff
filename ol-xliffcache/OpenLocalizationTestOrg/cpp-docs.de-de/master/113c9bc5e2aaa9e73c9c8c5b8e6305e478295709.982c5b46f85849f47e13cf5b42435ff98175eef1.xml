{"nodes":[{"pos":[12,50],"content":"Virtual List Controls | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Virtual List Controls | Microsoft Docs","pos":[0,38]}]},{"content":"Virtual List Controls","pos":[685,706]},{"content":"A virtual list control is a list view control that has the <bpt id=\"p1\">**</bpt>LVS_OWNERDATA<ept id=\"p1\">**</ept> style.","pos":[707,790],"source":"A virtual list control is a list view control that has the **LVS_OWNERDATA** style."},{"content":"This style enables the control to support an item count up to a <ph id=\"ph1\">`DWORD`</ph> (the default item count only extends to an <ph id=\"ph2\">`int`</ph>).","pos":[791,913],"source":" This style enables the control to support an item count up to a `DWORD` (the default item count only extends to an `int`)."},{"content":"However, the biggest advantage provided by this style is the ability to only have a subset of data items in memory at any one time.","pos":[914,1045]},{"content":"This allows the virtual list view control to lend itself for use with large databases of information, where specific methods of accessing data are already in place.","pos":[1046,1210]},{"pos":[1218,1400],"content":"[!NOTE]\n In addition to providing virtual list functionality in `CListCtrl`, MFC also provides the same functionality in the [CListView](../mfc/reference/clistview-class.md) class.","leadings":["","> "],"nodes":[{"content":"In addition to providing virtual list functionality in <ph id=\"ph1\">`CListCtrl`</ph>, MFC also provides the same functionality in the <bpt id=\"p1\">[</bpt>CListView<ept id=\"p1\">](../mfc/reference/clistview-class.md)</ept> class.","pos":[9,180],"source":" In addition to providing virtual list functionality in `CListCtrl`, MFC also provides the same functionality in the [CListView](../mfc/reference/clistview-class.md) class."}]},{"content":"There are some compatibility issues you should be aware of when developing virtual list controls.","pos":[1407,1504]},{"content":"For more information, see the Compatibility Issues section of the List-View Controls topic in the <ph id=\"ph1\">[!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]</ph>.","pos":[1505,1652],"source":" For more information, see the Compatibility Issues section of the List-View Controls topic in the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]."},{"content":"Handling the LVN_GETDISPINFO Notification","pos":[1661,1702]},{"content":"Virtual list controls maintain very little item information.","pos":[1706,1766]},{"content":"Except for the item selection and focus information, all item information is managed by the owner of the control.","pos":[1767,1880]},{"content":"Information is requested by the framework via a <bpt id=\"p1\">**</bpt>LVN_GETDISPINFO<ept id=\"p1\">**</ept> notification message.","pos":[1881,1970],"source":" Information is requested by the framework via a **LVN_GETDISPINFO** notification message."},{"content":"To provide the requested information, the owner of the virtual list control (or the control itself) must handle this notification.","pos":[1971,2101]},{"content":"This can easily be done using the Properties window (see <bpt id=\"p1\">[</bpt>Mapping Messages to Functions<ept id=\"p1\">](../mfc/reference/mapping-messages-to-functions.md)</ept>).","pos":[2102,2243],"source":" This can easily be done using the Properties window (see [Mapping Messages to Functions](../mfc/reference/mapping-messages-to-functions.md))."},{"content":"The resultant code should look something like the following example (where <ph id=\"ph1\">`CMyDialog`</ph> owns the virtual list control object and the dialog is handling the notification):","pos":[2244,2413],"source":" The resultant code should look something like the following example (where `CMyDialog` owns the virtual list control object and the dialog is handling the notification):"},{"pos":[2431,2459],"content":"NVC_MFCControlLadenDialog#23"},{"content":"In the handler for the <bpt id=\"p1\">**</bpt>LVN_GETDISPINFO<ept id=\"p1\">**</ept> notification message, you must check to see what type of information is being requested.","pos":[2520,2651],"source":"In the handler for the **LVN_GETDISPINFO** notification message, you must check to see what type of information is being requested."},{"content":"The possible values are:","pos":[2652,2676]},{"pos":[2698,2737],"content":"The <ph id=\"ph1\">`pszText`</ph> member must be filled in.","source":" The `pszText` member must be filled in."},{"pos":[2760,2798],"content":"The <ph id=\"ph1\">`iImage`</ph> member must be filled in.","source":" The `iImage` member must be filled in."},{"pos":[2808,2863],"content":"<bpt id=\"p1\">**</bpt>LVIF_INDENT<ept id=\"p1\">**</ept> The <bpt id=\"p2\">*</bpt>iIndent<ept id=\"p2\">*</ept> member must be filled in.","source":"**LVIF_INDENT** The *iIndent* member must be filled in."},{"content":"The <bpt id=\"p1\">*</bpt>lParam<ept id=\"p1\">*</ept> member must be filled in.","pos":[2886,2924],"source":" The *lParam* member must be filled in."},{"content":"(Not present for sub-items.)","pos":[2925,2953]},{"pos":[2976,3013],"content":"The <bpt id=\"p1\">*</bpt>state<ept id=\"p1\">*</ept> member must be filled in.","source":" The *state* member must be filled in."},{"content":"You should then supply whatever information is requested back to the framework.","pos":[3020,3099]},{"content":"The following example (taken from the body of the notification handler for the list control object) demonstrates one possible method by supplying information for the text buffers and image of an item:","pos":[3106,3306]},{"pos":[3324,3352],"content":"NVC_MFCControlLadenDialog#24"},{"content":"Caching and Virtual List Controls","pos":[3415,3448]},{"content":"Because this type of list control is intended for large data sets, it is recommended that you cache requested item data to improve retrieval performance.","pos":[3452,3605]},{"content":"The framework provides a cache-hinting mechanism to assist in optimizing the cache by sending an <bpt id=\"p1\">**</bpt>LVN_ODCACHEHINT<ept id=\"p1\">**</ept> notification message.","pos":[3606,3744],"source":" The framework provides a cache-hinting mechanism to assist in optimizing the cache by sending an **LVN_ODCACHEHINT** notification message."},{"content":"The following example updates the cache with the range passed to the handler function.","pos":[3751,3837]},{"pos":[3855,3883],"content":"NVC_MFCControlLadenDialog#25"},{"pos":[3944,4124],"content":"For more information on preparing and maintaining a cache, see the Cache Management section of the List-View Controls topic in the <ph id=\"ph1\">[!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on preparing and maintaining a cache, see the Cache Management section of the List-View Controls topic in the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]."},{"content":"Finding Specific Items","pos":[4133,4155]},{"content":"The <bpt id=\"p1\">**</bpt>LVN_ODFINDITEM<ept id=\"p1\">**</ept> notification message is sent by the virtual list control when a particular list control item needs to be found.","pos":[4159,4293],"source":"The **LVN_ODFINDITEM** notification message is sent by the virtual list control when a particular list control item needs to be found."},{"content":"The notification message is sent when the list view control receives quick key access or when it receives an <bpt id=\"p1\">**</bpt>LVM_FINDITEM<ept id=\"p1\">**</ept> message.","pos":[4294,4428],"source":" The notification message is sent when the list view control receives quick key access or when it receives an **LVM_FINDITEM** message."},{"content":"Search information is sent in the form of an <bpt id=\"p1\">**</bpt>LVFINDINFO<ept id=\"p1\">**</ept> structure, which is a member of the <bpt id=\"p2\">**</bpt>NMLVFINDITEM<ept id=\"p2\">**</ept> structure.","pos":[4429,4552],"source":" Search information is sent in the form of an **LVFINDINFO** structure, which is a member of the **NMLVFINDITEM** structure."},{"content":"Handle this message by overriding the <ph id=\"ph1\">`OnChildNotify`</ph> function of your list control object and inside the body of the handler, check for the <bpt id=\"p1\">**</bpt>LVN_ODFINDITEM<ept id=\"p1\">**</ept> message.","pos":[4553,4721],"source":" Handle this message by overriding the `OnChildNotify` function of your list control object and inside the body of the handler, check for the **LVN_ODFINDITEM** message."},{"content":"If found, perform the appropriate action.","pos":[4722,4763]},{"content":"You should be prepared to search for an item that matches the information given by the list view control.","pos":[4770,4875]},{"content":"You should return the index of the item if successful, or -1 if no matching item is found.","pos":[4876,4966]},{"content":"See Also","pos":[4975,4983]},{"content":"Using CListCtrl","pos":[4988,5003]},{"content":"Controls","pos":[5037,5045]}],"content":"---\ntitle: \"Virtual List Controls | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"cache, virtual list control item data\"\n  - \"list controls, virtual\"\n  - \"list controls, List view\"\n  - \"virtual list controls\"\nms.assetid: 319f841f-e426-423a-8276-d93f965b0b45\ncaps.latest.revision: 13\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Virtual List Controls\nA virtual list control is a list view control that has the **LVS_OWNERDATA** style. This style enables the control to support an item count up to a `DWORD` (the default item count only extends to an `int`). However, the biggest advantage provided by this style is the ability to only have a subset of data items in memory at any one time. This allows the virtual list view control to lend itself for use with large databases of information, where specific methods of accessing data are already in place.  \n  \n> [!NOTE]\n>  In addition to providing virtual list functionality in `CListCtrl`, MFC also provides the same functionality in the [CListView](../mfc/reference/clistview-class.md) class.  \n  \n There are some compatibility issues you should be aware of when developing virtual list controls. For more information, see the Compatibility Issues section of the List-View Controls topic in the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)].  \n  \n## Handling the LVN_GETDISPINFO Notification  \n Virtual list controls maintain very little item information. Except for the item selection and focus information, all item information is managed by the owner of the control. Information is requested by the framework via a **LVN_GETDISPINFO** notification message. To provide the requested information, the owner of the virtual list control (or the control itself) must handle this notification. This can easily be done using the Properties window (see [Mapping Messages to Functions](../mfc/reference/mapping-messages-to-functions.md)). The resultant code should look something like the following example (where `CMyDialog` owns the virtual list control object and the dialog is handling the notification):  \n  \n [!code-cpp[NVC_MFCControlLadenDialog#23](../mfc/codesnippet/cpp/virtual-list-controls_1.cpp)]  \n  \n In the handler for the **LVN_GETDISPINFO** notification message, you must check to see what type of information is being requested. The possible values are:  \n  \n-   `LVIF_TEXT` The `pszText` member must be filled in.  \n  \n-   `LVIF_IMAGE` The `iImage` member must be filled in.  \n  \n-   **LVIF_INDENT** The *iIndent* member must be filled in.  \n  \n-   `LVIF_PARAM` The *lParam* member must be filled in. (Not present for sub-items.)  \n  \n-   `LVIF_STATE` The *state* member must be filled in.  \n  \n You should then supply whatever information is requested back to the framework.  \n  \n The following example (taken from the body of the notification handler for the list control object) demonstrates one possible method by supplying information for the text buffers and image of an item:  \n  \n [!code-cpp[NVC_MFCControlLadenDialog#24](../mfc/codesnippet/cpp/virtual-list-controls_2.cpp)]  \n  \n## Caching and Virtual List Controls  \n Because this type of list control is intended for large data sets, it is recommended that you cache requested item data to improve retrieval performance. The framework provides a cache-hinting mechanism to assist in optimizing the cache by sending an **LVN_ODCACHEHINT** notification message.  \n  \n The following example updates the cache with the range passed to the handler function.  \n  \n [!code-cpp[NVC_MFCControlLadenDialog#25](../mfc/codesnippet/cpp/virtual-list-controls_3.cpp)]  \n  \n For more information on preparing and maintaining a cache, see the Cache Management section of the List-View Controls topic in the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)].  \n  \n## Finding Specific Items  \n The **LVN_ODFINDITEM** notification message is sent by the virtual list control when a particular list control item needs to be found. The notification message is sent when the list view control receives quick key access or when it receives an **LVM_FINDITEM** message. Search information is sent in the form of an **LVFINDINFO** structure, which is a member of the **NMLVFINDITEM** structure. Handle this message by overriding the `OnChildNotify` function of your list control object and inside the body of the handler, check for the **LVN_ODFINDITEM** message. If found, perform the appropriate action.  \n  \n You should be prepared to search for an item that matches the information given by the list view control. You should return the index of the item if successful, or -1 if no matching item is found.  \n  \n## See Also  \n [Using CListCtrl](../mfc/using-clistctrl.md)   \n [Controls](../mfc/controls-mfc.md)\n\n"}