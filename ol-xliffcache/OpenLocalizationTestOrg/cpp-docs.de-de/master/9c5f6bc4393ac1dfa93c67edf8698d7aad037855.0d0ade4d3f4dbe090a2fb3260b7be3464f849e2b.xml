{"nodes":[{"pos":[12,44],"content":"CDocument Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDocument Class | Microsoft Docs","pos":[0,32]}]},{"content":"CDocument Class","pos":[928,943]},{"content":"Provides the basic functionality for user-defined document classes.","pos":[944,1011]},{"content":"Syntax","pos":[1020,1026]},{"content":"Members","pos":[1088,1095]},{"content":"Public Constructors","pos":[1105,1124]},{"content":"Name","pos":[1131,1135]},{"content":"Description","pos":[1136,1147]},{"content":"CDocument::CDocument","pos":[1186,1206]},{"pos":[1231,1263],"content":"Constructs a <ph id=\"ph1\">`CDocument`</ph> object.","source":"Constructs a `CDocument` object."},{"content":"Public Methods","pos":[1274,1288]},{"content":"Name","pos":[1295,1299]},{"content":"Description","pos":[1300,1311]},{"content":"CDocument::AddView","pos":[1350,1368]},{"content":"Attaches a view to the document.","pos":[1391,1423]},{"content":"CDocument::BeginReadChunks","pos":[1429,1455]},{"content":"Initializes chunk reading.","pos":[1486,1512]},{"content":"CDocument::CanCloseFrame","pos":[1518,1542]},{"content":"Advanced overridable; called before closing a frame window viewing this document.","pos":[1571,1652]},{"content":"CDocument::ClearChunkList","pos":[1658,1683]},{"content":"Clears the chunk list.","pos":[1713,1735]},{"content":"CDocument::ClearPathName","pos":[1741,1765]},{"content":"Clears the path of the document object.","pos":[1794,1833]},{"content":"CDocument::DeleteContents","pos":[1839,1864]},{"content":"Called to perform cleanup of the document.","pos":[1894,1936]},{"content":"CDocument::FindChunk","pos":[1942,1962]},{"content":"Looks for a chunk with specified GUID.","pos":[1987,2025]},{"content":"CDocument::GetAdapter","pos":[2031,2052]},{"pos":[2078,2141],"content":"Returns a pointer to object implementing <ph id=\"ph1\">`IDocument`</ph> interface.","source":"Returns a pointer to object implementing `IDocument` interface."},{"content":"CDocument::GetDocTemplate","pos":[2147,2172]},{"content":"Returns a pointer to the document template that describes the type of the document.","pos":[2202,2285]},{"content":"CDocument::GetFile","pos":[2291,2309]},{"pos":[2332,2380],"content":"Returns a pointer to the desired <ph id=\"ph1\">`CFile`</ph> object.","source":"Returns a pointer to the desired `CFile` object."},{"content":"CDocument::GetFirstViewPosition","pos":[2386,2417]},{"content":"Returns the position of the first in the list of views; used to begin iteration.","pos":[2453,2533]},{"content":"CDocument::GetNextView","pos":[2539,2561]},{"content":"Iterates through the list of views associated with the document.","pos":[2588,2652]},{"content":"CDocument::GetPathName","pos":[2658,2680]},{"content":"Returns the path of the document's data file.","pos":[2707,2752]},{"content":"CDocument::GetThumbnail","pos":[2758,2781]},{"content":"Called to create a bitmap to be used by thumbnail provider to display thumbnail.","pos":[2809,2889]},{"content":"CDocument::GetTitle","pos":[2895,2914]},{"content":"Returns the document's title.","pos":[2938,2967]},{"content":"CDocument::InitializeSearchContent","pos":[2973,3007]},{"content":"Called to initialize search content for Search Handler.","pos":[3046,3101]},{"content":"CDocument::IsModified","pos":[3107,3128]},{"content":"Indicates whether the document has been modified since it was last saved.","pos":[3154,3227]},{"content":"CDocument::IsSearchAndOrganizeHandler","pos":[3233,3270]},{"pos":[3312,3404],"content":"Tells whether this instance of <ph id=\"ph1\">`CDocument`</ph> object was created for Search &amp; Organize handler.","source":"Tells whether this instance of `CDocument` object was created for Search & Organize handler."},{"content":"CDocument::LoadDocumentFromStream","pos":[3410,3443]},{"content":"Called to load document data from stream.","pos":[3481,3522]},{"content":"CDocument::OnBeforeRichPreviewFontChanged","pos":[3528,3569]},{"content":"Called before Rich Preview font is changed.","pos":[3615,3658]},{"content":"CDocument::OnChangedViewList","pos":[3664,3692]},{"content":"Called after a view is added to or removed from the document.","pos":[3725,3786]},{"content":"CDocument::OnCloseDocument","pos":[3792,3818]},{"content":"Called to close the document.","pos":[3849,3878]},{"content":"CDocument::OnCreatePreviewFrame","pos":[3884,3915]},{"content":"Called by the framework when it needs to create a preview frame for Rich Preview.","pos":[3951,4032]},{"content":"CDocument::OnDocumentEvent","pos":[4038,4064]},{"content":"Called by the framework in response to a document event.","pos":[4095,4151]},{"content":"CDocument::OnDrawThumbnail","pos":[4157,4183]},{"content":"Override this method in a derived class to draw content of thumbnail.","pos":[4214,4283]},{"content":"CDocument::OnLoadDocumentFromStream","pos":[4289,4324]},{"content":"Called by the framework when it needs to load the document data from stream.","pos":[4364,4440]},{"content":"CDocument::OnNewDocument","pos":[4446,4470]},{"content":"Called to create a new document.","pos":[4499,4531]},{"content":"CDocument::OnOpenDocument","pos":[4537,4562]},{"content":"Called to open an existing document.","pos":[4592,4628]},{"content":"CDocument::OnPreviewHandlerQueryFocus","pos":[4634,4671]},{"content":"Directs the preview handler to return the HWND from calling the GetFocus Function.","pos":[4713,4795]},{"content":"CDocument::OnPreviewHandlerTranslateAccelerator","pos":[4801,4848]},{"content":"Directs the preview handler to handle a keystroke passed up from the message pump of the process in which the preview handler is running.","pos":[4900,5037]},{"content":"CDocument::OnRichPreviewBackColorChanged","pos":[5043,5083]},{"content":"Called when Rich Preview background color has changed.","pos":[5128,5182]},{"content":"CDocument::OnRichPreviewFontChanged","pos":[5188,5223]},{"content":"Called when Rich Preview font has changed.","pos":[5263,5305]},{"content":"CDocument::OnRichPreviewSiteChanged","pos":[5311,5346]},{"content":"Called when Rich Preview site has changed.","pos":[5386,5428]},{"content":"CDocument::OnRichPreviewTextColorChanged","pos":[5434,5474]},{"content":"Called when Rich Preview text color has changed.","pos":[5519,5567]},{"content":"CDocument::OnSaveDocument","pos":[5573,5598]},{"content":"Called to save the document to disk.","pos":[5628,5664]},{"content":"CDocument::OnUnloadHandler","pos":[5670,5696]},{"content":"Called by the framework when the preview handler is being unloaded.","pos":[5727,5794]},{"content":"CDocument::PreCloseFrame","pos":[5800,5824]},{"content":"Called before the frame window is closed.","pos":[5853,5894]},{"content":"CDocument::ReadNextChunkValue","pos":[5900,5929]},{"content":"Reads next chunk value.","pos":[5963,5986]},{"content":"CDocument::ReleaseFile","pos":[5992,6014]},{"content":"Releases a file to make it available for use by other applications.","pos":[6041,6108]},{"content":"CDocument::RemoveChunk","pos":[6114,6136]},{"content":"Removes a chunk with specified GUID.","pos":[6163,6199]},{"content":"CDocument::RemoveView","pos":[6205,6226]},{"content":"Detaches a view from the document.","pos":[6252,6286]},{"content":"CDocument::ReportSaveLoadException","pos":[6292,6326]},{"content":"Advanced overridable; called when an open or save operation cannot be completed because of an exception.","pos":[6365,6469]},{"content":"CDocument::SaveModified","pos":[6475,6498]},{"content":"Advanced overridable; called to ask the user whether the document should be saved.","pos":[6526,6608]},{"content":"CDocument::SetChunkValue","pos":[6614,6638]},{"content":"Sets a chunk value.","pos":[6667,6686]},{"content":"CDocument::SetModifiedFlag","pos":[6692,6718]},{"content":"Sets a flag indicating that you have modified the document since it was last saved.","pos":[6749,6832]},{"content":"CDocument::SetPathName","pos":[6838,6860]},{"content":"Sets the path of the data file used by the document.","pos":[6887,6939]},{"content":"CDocument::SetTitle","pos":[6945,6964]},{"content":"Sets the document's title.","pos":[6988,7014]},{"content":"CDocument::UpdateAllViews","pos":[7020,7045]},{"content":"Notifies all views that document has been modified.","pos":[7075,7126]},{"content":"Protected Methods","pos":[7137,7154]},{"content":"Name","pos":[7161,7165]},{"content":"Description","pos":[7166,7177]},{"content":"CDocument::OnFileSendMail","pos":[7216,7241]},{"content":"Sends a mail message with the document attached.","pos":[7271,7319]},{"content":"CDocument::OnUpdateFileSendMail","pos":[7325,7356]},{"content":"Enables the Send Mail command if mail support is present.","pos":[7392,7449]},{"content":"Public Data Members","pos":[7460,7479]},{"content":"Name","pos":[7486,7490]},{"content":"Description","pos":[7491,7502]},{"content":"CDocument::m_bGetThumbnailMode","pos":[7541,7571]},{"content":"Specifies that <ph id=\"ph1\">`CDocument`</ph> object was created by dllhost for thumbnails.","pos":[7606,7678],"source":"Specifies that `CDocument` object was created by dllhost for thumbnails."},{"content":"Should be checked in <ph id=\"ph1\">`CView::OnDraw`</ph>.","pos":[7679,7716],"source":" Should be checked in `CView::OnDraw`."},{"content":"CDocument::m_bPreviewHandlerMode","pos":[7722,7754]},{"content":"Specifies that <ph id=\"ph1\">`CDocument`</ph> object was created by prevhost for <ph id=\"ph2\">`Rich Preview`</ph>.","pos":[7791,7868],"source":"Specifies that `CDocument` object was created by prevhost for `Rich Preview`."},{"content":"Should be checked in <ph id=\"ph1\">`CView::OnDraw`</ph>.","pos":[7869,7906],"source":" Should be checked in `CView::OnDraw`."},{"content":"CDocument::m_bSearchMode","pos":[7912,7936]},{"pos":[7965,8050],"content":"Specifies that <ph id=\"ph1\">`CDocument`</ph> object was created by indexer or other search application.","source":"Specifies that `CDocument` object was created by indexer or other search application."},{"content":"CDocument::m_clrRichPreviewBackColor","pos":[8056,8092]},{"content":"Specifies background color of Rich Preview window.","pos":[8133,8183]},{"content":"This color is set by host.","pos":[8184,8210]},{"content":"CDocument::m_clrRichPreviewTextColor","pos":[8216,8252]},{"content":"Specifies foreground color of Rich Preview window.","pos":[8293,8343]},{"content":"This color is set by host.","pos":[8344,8370]},{"content":"CDocument::m_lfRichPreviewFont","pos":[8376,8406]},{"content":"Specifies text font for Rich Preview window.","pos":[8441,8485]},{"content":"This font information is set by host.","pos":[8486,8523]},{"content":"Remarks","pos":[8533,8540]},{"content":"A document represents the unit of data that the user typically opens with the File Open command and saves with the File Save command.","pos":[8544,8677]},{"content":"<bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> supports standard operations such as creating a document, loading it, and saving it.","pos":[8684,8782],"source":"**CDocument** supports standard operations such as creating a document, loading it, and saving it."},{"content":"The framework manipulates documents using the interface defined by <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept>.","pos":[8783,8864],"source":" The framework manipulates documents using the interface defined by **CDocument**."},{"content":"An application can support more than one type of document; for example, an application might support both spreadsheets and text documents.","pos":[8871,9009]},{"content":"Each type of document has an associated document template; the document template specifies what resources (for example, menu, icon, or accelerator table) are used for that type of document.","pos":[9010,9199]},{"content":"Each document contains a pointer to its associated <ph id=\"ph1\">`CDocTemplate`</ph> object.","pos":[9200,9273],"source":" Each document contains a pointer to its associated `CDocTemplate` object."},{"content":"Users interact with a document through the <bpt id=\"p1\">[</bpt>CView<ept id=\"p1\">](../../mfc/reference/cview-class.md)</ept> object(s) associated with it.","pos":[9280,9396],"source":"Users interact with a document through the [CView](../../mfc/reference/cview-class.md) object(s) associated with it."},{"content":"A view renders an image of the document in a frame window and interprets user input as operations on the document.","pos":[9397,9511]},{"content":"A document can have multiple views associated with it.","pos":[9512,9566]},{"content":"When the user opens a window on a document, the framework creates a view and attaches it to the document.","pos":[9567,9672]},{"content":"The document template specifies what type of view and frame window are used to display each type of document.","pos":[9673,9782]},{"content":"Documents are part of the framework's standard command routing and consequently receive commands from standard user-interface components (such as the File Save menu item).","pos":[9789,9960]},{"content":"A document receives commands forwarded by the active view.","pos":[9961,10019]},{"content":"If the document doesn't handle a given command, it forwards the command to the document template that manages it.","pos":[10020,10133]},{"content":"When a document's data is modified, each of its views must reflect those modifications.","pos":[10140,10227]},{"content":"<bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> provides the <bpt id=\"p2\">[</bpt>UpdateAllViews<ept id=\"p2\">](#cdocument__updateallviews)</ept> member function for you to notify the views of such changes, so the views can repaint themselves as necessary.","pos":[10228,10410],"source":"**CDocument** provides the [UpdateAllViews](#cdocument__updateallviews) member function for you to notify the views of such changes, so the views can repaint themselves as necessary."},{"content":"The framework also prompts the user to save a modified file before closing it.","pos":[10411,10489]},{"content":"To implement documents in a typical application, you must do the following:","pos":[10496,10571]},{"pos":[10581,10641],"content":"Derive a class from <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> for each type of document.","source":"Derive a class from **CDocument** for each type of document."},{"content":"Add member variables to store each document's data.","pos":[10651,10702]},{"content":"Implement member functions for reading and modifying the document's data.","pos":[10712,10785]},{"content":"The document's views are the most important users of these member functions.","pos":[10786,10862]},{"pos":[10872,11057],"content":"Override the <bpt id=\"p1\">[</bpt>CObject::Serialize<ept id=\"p1\">](../../mfc/reference/cobject-class.md#cobject__serialize)</ept> member function in your document class to write and read the document's data to and from disk.","source":"Override the [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize) member function in your document class to write and read the document's data to and from disk."},{"content":"<bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> supports sending your document via mail if mail support (MAPI) is present.","pos":[11064,11152],"source":"**CDocument** supports sending your document via mail if mail support (MAPI) is present."},{"content":"See the articles <bpt id=\"p1\">[</bpt>MAPI<ept id=\"p1\">](../../mfc/mapi.md)</ept> and <bpt id=\"p2\">[</bpt>MAPI Support in MFC<ept id=\"p2\">](../../mfc/mapi-support-in-mfc.md)</ept>.","pos":[11153,11256],"source":" See the articles [MAPI](../../mfc/mapi.md) and [MAPI Support in MFC](../../mfc/mapi-support-in-mfc.md)."},{"pos":[11263,11502],"content":"For more information on <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept>, see <bpt id=\"p2\">[</bpt>Serialization<ept id=\"p2\">](../../mfc/serialization-in-mfc.md)</ept>, <bpt id=\"p3\">[</bpt>Document/View Architecture Topics<ept id=\"p3\">](../../mfc/document-view-architecture.md)</ept>, and <bpt id=\"p4\">[</bpt>Document/View Creation<ept id=\"p4\">](../../mfc/document-view-creation.md)</ept>.","source":"For more information on **CDocument**, see [Serialization](../../mfc/serialization-in-mfc.md), [Document/View Architecture Topics](../../mfc/document-view-architecture.md), and [Document/View Creation](../../mfc/document-view-creation.md)."},{"content":"Inheritance Hierarchy","pos":[11511,11532]},{"content":"CObject","pos":[11537,11544]},{"content":"CCmdTarget","pos":[11591,11601]},{"content":"Requirements","pos":[11670,11682]},{"pos":[11686,11706],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxwin.h","source":"**Header:** afxwin.h"},{"pos":[11751,11769],"content":"CDocument::AddView"},{"content":"Call this function to attach a view to the document.","pos":[11773,11825]},{"content":"Parameters","pos":[11878,11888]},{"content":"Points to the view being added.","pos":[11903,11934]},{"content":"Remarks","pos":[11944,11951]},{"content":"This function adds the specified view to the list of views associated with the document; the function also sets the view's document pointer to this document.","pos":[11955,12112]},{"content":"The framework calls this function when attaching a newly created view object to a document; this occurs in response to a File New, File Open, or New Window command or when a splitter window is split.","pos":[12113,12312]},{"content":"Call this function only if you are manually creating and attaching a view.","pos":[12319,12393]},{"content":"Typically you will let the framework connect documents and views by defining a <bpt id=\"p1\">[</bpt>CDocTemplate<ept id=\"p1\">](../../mfc/reference/cdoctemplate-class.md)</ept> object to associate a document class, view class, and frame window class.","pos":[12394,12604],"source":" Typically you will let the framework connect documents and views by defining a [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) object to associate a document class, view class, and frame window class."},{"content":"Example","pos":[12614,12621]},{"pos":[12636,12656],"content":"NVC_MFCDocViewSDI#12"},{"pos":[12760,12786],"content":"CDocument::BeginReadChunks"},{"content":"Initializes chunk reading.","pos":[12790,12816]},{"content":"Remarks","pos":[12874,12881]},{"pos":[12932,12956],"content":"CDocument::CanCloseFrame"},{"content":"Called by the framework before a frame window displaying the document is closed.","pos":[12960,13040]},{"content":"Parameters","pos":[13112,13122]},{"content":"Points to the frame window of a view attached to the document.","pos":[13138,13200]},{"content":"Return Value","pos":[13210,13222]},{"content":"Nonzero if it is safe to close the frame window; otherwise 0.","pos":[13226,13287]},{"content":"Remarks","pos":[13297,13304]},{"content":"The default implementation checks if there are other frame windows displaying the document.","pos":[13308,13399]},{"content":"If the specified frame window is the last one that displays the document, the function prompts the user to save the document if it has been modified.","pos":[13400,13549]},{"content":"Override this function if you want to perform special processing when a frame window is closed.","pos":[13550,13645]},{"content":"This is an advanced overridable.","pos":[13646,13678]},{"pos":[13725,13745],"content":"CDocument::CDocument"},{"pos":[13749,13783],"content":"Constructs a <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> object.","source":"Constructs a **CDocument** object."},{"content":"Remarks","pos":[13821,13828]},{"content":"The framework handles document creation for you.","pos":[13832,13880]},{"content":"Override the <bpt id=\"p1\">[</bpt>OnNewDocument<ept id=\"p1\">](#cdocument__onnewdocument)</ept> member function to perform initialization on a per-document basis; this is particularly important in single document interface (SDI) applications.","pos":[13881,14083],"source":" Override the [OnNewDocument](#cdocument__onnewdocument) member function to perform initialization on a per-document basis; this is particularly important in single document interface (SDI) applications."},{"pos":[14135,14160],"content":"CDocument::ClearChunkList"},{"content":"Clears the chunk list.","pos":[14164,14186]},{"content":"Remarks","pos":[14243,14250]},{"pos":[14301,14325],"content":"CDocument::ClearPathName"},{"content":"Clears the path of the document object.","pos":[14329,14368]},{"content":"Remarks","pos":[14423,14430]},{"content":"Clearing the path from a <ph id=\"ph1\">`CDocument`</ph> object causes the application to prompt the user when the document is next saved.","pos":[14434,14552],"source":"Clearing the path from a `CDocument` object causes the application to prompt the user when the document is next saved."},{"content":"This makes a <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> command behave like a <bpt id=\"p2\">**</bpt>Save As<ept id=\"p2\">**</ept> command.","pos":[14553,14617],"source":" This makes a **Save** command behave like a **Save As** command."},{"pos":[14669,14694],"content":"CDocument::DeleteContents"},{"pos":[14698,14803],"content":"Called by the framework to delete the document's data without destroying the <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> object itself.","source":"Called by the framework to delete the document's data without destroying the **CDocument** object itself."},{"content":"Remarks","pos":[14859,14866]},{"content":"It is called just before the document is to be destroyed.","pos":[14870,14927]},{"content":"It is also called to ensure that a document is empty before it is reused.","pos":[14928,15001]},{"content":"This is particularly important for an SDI application, which uses only one document; the document is reused whenever the user creates or opens another document.","pos":[15002,15162]},{"content":"Call this function to implement an \"Edit Clear All\" or similar command that deletes all of the document's data.","pos":[15163,15274]},{"content":"The default implementation of this function does nothing.","pos":[15275,15332]},{"content":"Override this function to delete the data in your document.","pos":[15333,15392]},{"content":"Example","pos":[15402,15409]},{"pos":[15424,15441],"content":"NVC_MFCDocView#57"},{"pos":[15539,15559],"content":"CDocument::FindChunk"},{"content":"Looks for a chunk with a specified GUID.","pos":[15563,15603]},{"content":"Parameters","pos":[15693,15703]},{"content":"Specifies the GUID of a chunk to find.","pos":[15717,15755]},{"content":"Specifies a PID of a chunk to find.","pos":[15771,15806]},{"content":"Return Value","pos":[15816,15828]},{"content":"Position in the internal chunk list if successful.","pos":[15832,15882]},{"content":"Otherwise <ph id=\"ph1\">`NULL`</ph>.","pos":[15883,15900],"source":" Otherwise `NULL`."},{"content":"Remarks","pos":[15910,15917]},{"pos":[15965,15986],"content":"CDocument::GetAdapter"},{"pos":[15990,16060],"content":"Returns a pointer to an object implementing the <ph id=\"ph1\">`IDocument`</ph> interface.","source":"Returns a pointer to an object implementing the `IDocument` interface."},{"content":"Return Value","pos":[16123,16135]},{"pos":[16139,16201],"content":"A pointer to an object implementing the <ph id=\"ph1\">`IDocument`</ph> interface.","source":"A pointer to an object implementing the `IDocument` interface."},{"content":"Remarks","pos":[16211,16218]},{"pos":[16270,16295],"content":"CDocument::GetDocTemplate"},{"content":"Call this function to get a pointer to the document template for this document type.","pos":[16299,16383]},{"content":"Return Value","pos":[16449,16461]},{"pos":[16465,16590],"content":"A pointer to the document template for this document type, or <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the document is not managed by a document template.","source":"A pointer to the document template for this document type, or **NULL** if the document is not managed by a document template."},{"content":"Example","pos":[16600,16607]},{"pos":[16622,16639],"content":"NVC_MFCDocView#58"},{"pos":[16735,16753],"content":"CDocument::GetFile"},{"pos":[16757,16820],"content":"Call this member function to get a pointer to a <ph id=\"ph1\">`CFile`</ph> object.","source":"Call this member function to get a pointer to a `CFile` object."},{"content":"Parameters","pos":[16949,16959]},{"content":"A string that is the path to the desired file.","pos":[16981,17027]},{"content":"The path may be relative or absolute.","pos":[17028,17065]},{"content":"A pointer to an existing file-exception object that indicates the completion status of the operation.","pos":[17084,17185]},{"content":"Sharing and access mode.","pos":[17208,17232]},{"content":"Specifies the action to take when opening the file.","pos":[17233,17284]},{"content":"You can combine options listed in the CFile constructor <bpt id=\"p1\">[</bpt>CFile::CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md#cfile__cfile)</ept> by using the bitwise OR (&amp;#124;) operator.","pos":[17285,17447],"source":" You can combine options listed in the CFile constructor [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile) by using the bitwise OR (&#124;) operator."},{"content":"One access permission and one share option are required; the <bpt id=\"p1\">**</bpt>modeCreate<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>modeNoInherit<ept id=\"p2\">**</ept> modes are optional.","pos":[17448,17565],"source":" One access permission and one share option are required; the **modeCreate** and **modeNoInherit** modes are optional."},{"content":"Return Value","pos":[17575,17587]},{"pos":[17591,17621],"content":"A pointer to a <ph id=\"ph1\">`CFile`</ph> object.","source":"A pointer to a `CFile` object."},{"pos":[17679,17710],"content":"CDocument::GetFirstViewPosition"},{"content":"Call this function to get the position of the first view in the list of views associated with the document.","pos":[17714,17821]},{"content":"Return Value","pos":[17896,17908]},{"pos":[17912,18028],"content":"A <bpt id=\"p1\">**</bpt>POSITION<ept id=\"p1\">**</ept> value that can be used for iteration with the <bpt id=\"p2\">[</bpt>GetNextView<ept id=\"p2\">](#cdocument__getnextview)</ept> member function.","source":"A **POSITION** value that can be used for iteration with the [GetNextView](#cdocument__getnextview) member function."},{"content":"Example","pos":[18038,18045]},{"pos":[18060,18077],"content":"NVC_MFCDocView#59"},{"pos":[18177,18199],"content":"CDocument::GetNextView"},{"content":"Call this function to iterate through all of the document's views.","pos":[18203,18269]},{"content":"Parameters","pos":[18352,18362]},{"content":"A reference to a <bpt id=\"p1\">**</bpt>POSITION<ept id=\"p1\">**</ept> value returned by a previous call to the <ph id=\"ph1\">`GetNextView`</ph> or <bpt id=\"p2\">[</bpt>GetFirstViewPosition<ept id=\"p2\">](#cdocument__getfirstviewposition)</ept> member functions.","pos":[18381,18543],"source":" A reference to a **POSITION** value returned by a previous call to the `GetNextView` or [GetFirstViewPosition](#cdocument__getfirstviewposition) member functions."},{"content":"This value must not be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[18544,18576],"source":" This value must not be **NULL**."},{"content":"Return Value","pos":[18586,18598]},{"pos":[18602,18650],"content":"A pointer to the view identified by <ph id=\"ph1\">`rPosition`</ph>.","source":"A pointer to the view identified by `rPosition`."},{"content":"Remarks","pos":[18660,18667]},{"content":"The function returns the view identified by <ph id=\"ph1\">`rPosition`</ph> and then sets <ph id=\"ph2\">`rPosition`</ph> to the <bpt id=\"p1\">**</bpt>POSITION<ept id=\"p1\">**</ept> value of the next view in the list.","pos":[18671,18808],"source":"The function returns the view identified by `rPosition` and then sets `rPosition` to the **POSITION** value of the next view in the list."},{"content":"If the retrieved view is the last in the list, then <ph id=\"ph1\">`rPosition`</ph> is set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[18809,18892],"source":" If the retrieved view is the last in the list, then `rPosition` is set to **NULL**."},{"content":"Example","pos":[18902,18909]},{"pos":[18924,18941],"content":"NVC_MFCDocView#59"},{"pos":[19041,19063],"content":"CDocument::GetPathName"},{"content":"Call this function to get the fully qualified path of the document's disk file.","pos":[19067,19146]},{"content":"Return Value","pos":[19210,19222]},{"content":"The document's fully qualified path.","pos":[19226,19262]},{"content":"This string is empty if the document has not been saved or does not have a disk file associated with it.","pos":[19263,19367]},{"pos":[19417,19440],"content":"CDocument::GetThumbnail"},{"content":"Creates a bitmap to be used by the thumbnail provider to display the thumbnail.","pos":[19444,19523]},{"content":"Parameters","pos":[19634,19644]},{"content":"Specifies the width and height of the bitmap.","pos":[19656,19701]},{"content":"Contains a handle to a bitmap, when the function returns successfully.","pos":[19719,19789]},{"content":"Contains a DWORD specifying the alpha channel value, when the function returns successfully.","pos":[19810,19902]},{"content":"Return Value","pos":[19912,19924]},{"pos":[19928,20017],"content":"Returns <ph id=\"ph1\">`TRUE`</ph> if a bitmap for the thumbnail was created successfully; otherwise <ph id=\"ph2\">`FALSE`</ph>.","source":"Returns `TRUE` if a bitmap for the thumbnail was created successfully; otherwise `FALSE`."},{"content":"Remarks","pos":[20027,20034]},{"pos":[20080,20099],"content":"CDocument::GetTitle"},{"content":"Call this function to get the document's title, which is usually derived from the document's filename.","pos":[20103,20205]},{"content":"Return Value","pos":[20266,20278]},{"content":"The document's title.","pos":[20282,20303]},{"pos":[20364,20398],"content":"CDocument::InitializeSearchContent"},{"content":"Called to initialize search content for the Search Handler.","pos":[20402,20461]},{"content":"Remarks","pos":[20527,20534]},{"content":"Override this method in a derived class to initialize search content.","pos":[20538,20607]},{"content":"The content should be a string with parts delimited by \";\".","pos":[20608,20667]},{"content":"For example, \"point; rectangle; ole item\".","pos":[20668,20710]},{"pos":[20758,20779],"content":"CDocument::IsModified"},{"content":"Call this function to determine whether the document has been modified since it was last saved.","pos":[20783,20878]},{"content":"Return Value","pos":[20930,20942]},{"content":"Nonzero if the document has been modified since it was last saved; otherwise 0.","pos":[20946,21025]},{"pos":[21089,21126],"content":"CDocument::IsSearchAndOrganizeHandler"},{"pos":[21130,21219],"content":"Tells whether this instance of <ph id=\"ph1\">`CDocument`</ph> was created for the Search &amp; Organize handler.","source":"Tells whether this instance of `CDocument` was created for the Search & Organize handler."},{"content":"Return Value","pos":[21288,21300]},{"pos":[21304,21397],"content":"Returns <ph id=\"ph1\">`TRUE`</ph> if this instance of <ph id=\"ph2\">`CDocument`</ph> was created for the Search &amp; Organize handler.","source":"Returns `TRUE` if this instance of `CDocument` was created for the Search & Organize handler."},{"content":"Remarks","pos":[21407,21414]},{"content":"Currently this function returns <ph id=\"ph1\">`TRUE`</ph> only for Rich Preview handlers implemented in an out of process server.","pos":[21418,21528],"source":"Currently this function returns `TRUE` only for Rich Preview handlers implemented in an out of process server."},{"content":"You can set the appropriate flags (m_bPreviewHandlerMode, m_bSearchMode, m_bGetThumbnailMode) at your application level to make this function return <ph id=\"ph1\">`TRUE`</ph>.","pos":[21529,21685],"source":" You can set the appropriate flags (m_bPreviewHandlerMode, m_bSearchMode, m_bGetThumbnailMode) at your application level to make this function return `TRUE`."},{"pos":[21745,21778],"content":"CDocument::LoadDocumentFromStream"},{"content":"Called to load document data from a stream.","pos":[21782,21825]},{"content":"Parameters","pos":[21936,21946]},{"content":"A pointer to a stream.","pos":[21963,21985]},{"content":"This stream is supplied by the Shell.","pos":[21986,22023]},{"content":"Access mode to the stream.","pos":[22045,22071]},{"content":"Return Value","pos":[22081,22093]},{"content":"S_OK if the load operation succeeds, otherwise HRESULT with an error code.","pos":[22097,22171]},{"content":"Remarks","pos":[22181,22188]},{"content":"You can override this method in a derived class to customize how to load data from the stream.","pos":[22192,22286]},{"pos":[22343,22373],"content":"CDocument::m_bGetThumbnailMode"},{"content":"Specifies that the <ph id=\"ph1\">`CDocument`</ph> object was created by dllhost for thumbnails.","pos":[22377,22453],"source":"Specifies that the `CDocument` object was created by dllhost for thumbnails."},{"content":"Should be checked in <ph id=\"ph1\">`CView::OnDraw`</ph>.","pos":[22454,22491],"source":" Should be checked in `CView::OnDraw`."},{"content":"Remarks","pos":[22544,22551]},{"pos":[22562,22628],"content":"indicates that the document was created by dllhost for thumbnails."},{"pos":[22687,22719],"content":"CDocument::m_bPreviewHandlerMode"},{"content":"Specifies that the <ph id=\"ph1\">`CDocument`</ph> object was created by prevhost for Rich Preview.","pos":[22723,22802],"source":"Specifies that the `CDocument` object was created by prevhost for Rich Preview."},{"content":"Should be checked in <ph id=\"ph1\">`CView::OnDraw`</ph>.","pos":[22803,22840],"source":" Should be checked in `CView::OnDraw`."},{"content":"Remarks","pos":[22895,22902]},{"pos":[22913,22982],"content":"indicates that the document was created by prevhost for Rich Preview."},{"pos":[23033,23057],"content":"CDocument::m_bSearchMode"},{"pos":[23061,23155],"content":"Specifies that the <ph id=\"ph1\">`CDocument`</ph> object was created by indexer or by another search application.","source":"Specifies that the `CDocument` object was created by indexer or by another search application."},{"content":"Remarks","pos":[23202,23209]},{"pos":[23220,23304],"content":"indicates that the document was created by indexer or by another search application."},{"pos":[23367,23403],"content":"CDocument::m_clrRichPreviewBackColor"},{"content":"Specifies the background color of the Rich Preview window.","pos":[23407,23465]},{"content":"This color is set by host.","pos":[23466,23492]},{"content":"Remarks","pos":[23555,23562]},{"pos":[23625,23661],"content":"CDocument::m_clrRichPreviewTextColor"},{"content":"Specifies the foreground color of the Rich Preview window.","pos":[23665,23723]},{"content":"This color is set by host.","pos":[23724,23750]},{"content":"Remarks","pos":[23813,23820]},{"pos":[23877,23907],"content":"CDocument::m_lfRichPreviewFont"},{"content":"Specifies the text font for the Rich Preview window.","pos":[23911,23963]},{"content":"This font information is set by host.","pos":[23964,24001]},{"content":"Remarks","pos":[24055,24062]},{"pos":[24130,24171],"content":"CDocument::OnBeforeRichPreviewFontChanged"},{"content":"Called before the Rich Preview font is changed.","pos":[24175,24222]},{"content":"Remarks","pos":[24294,24301]},{"pos":[24356,24384],"content":"CDocument::OnChangedViewList"},{"content":"Called by the framework after a view is added to or removed from the document.","pos":[24388,24466]},{"content":"Remarks","pos":[24525,24532]},{"content":"The default implementation of this function checks whether the last view is being removed and, if so, deletes the document.","pos":[24536,24659]},{"content":"Override this function if you want to perform special processing when the framework adds or removes a view.","pos":[24660,24767]},{"content":"For example, if you want a document to remain open even when there are no views attached to it, override this function.","pos":[24768,24887]},{"pos":[24940,24966],"content":"CDocument::OnCloseDocument"},{"content":"Called by the framework when the document is closed, typically as part of the File Close command.","pos":[24970,25067]},{"content":"Remarks","pos":[25124,25131]},{"pos":[25135,25399],"content":"The default implementation of this function destroys all of the frames used for viewing the document, closes the view, cleans up the document's contents, and then calls the <bpt id=\"p1\">[</bpt>DeleteContents<ept id=\"p1\">](#cdocument__deletecontents)</ept> member function to delete the document's data.","source":"The default implementation of this function destroys all of the frames used for viewing the document, closes the view, cleans up the document's contents, and then calls the [DeleteContents](#cdocument__deletecontents) member function to delete the document's data."},{"content":"Override this function if you want to perform special cleanup processing when the framework closes a document.","pos":[25406,25516]},{"content":"For example, if the document represents a record in a database, you may want to override this function to close the database.","pos":[25517,25642]},{"content":"You should call the base class version of this function from your override.","pos":[25643,25718]},{"pos":[25776,25807],"content":"CDocument::OnCreatePreviewFrame"},{"content":"Called by the framework when it needs to create a preview frame for Rich Preview.","pos":[25811,25892]},{"content":"Return Value","pos":[25954,25966]},{"pos":[25970,26041],"content":"Returns <ph id=\"ph1\">`TRUE`</ph> if the frame is created successfully; otherwise <ph id=\"ph2\">`FALSE`</ph>.","source":"Returns `TRUE` if the frame is created successfully; otherwise `FALSE`."},{"content":"Remarks","pos":[26051,26058]},{"pos":[26111,26137],"content":"CDocument::OnDocumentEvent"},{"content":"Called by the framework in response to a document event.","pos":[26141,26197]},{"content":"Parameters","pos":[26275,26285]},{"content":"[in]","pos":[26289,26293]},{"content":"An enumerated data type that describes the type of event.","pos":[26307,26364]},{"content":"Remarks","pos":[26374,26381]},{"content":"Document events may affect multiple classes.","pos":[26385,26429]},{"content":"This method is responsible for handling document events that affect classes other than the <bpt id=\"p1\">[</bpt>CDocument Class<ept id=\"p1\">](../../mfc/reference/cdocument-class.md)</ept>.","pos":[26430,26579],"source":" This method is responsible for handling document events that affect classes other than the [CDocument Class](../../mfc/reference/cdocument-class.md)."},{"content":"Currently, the only class that must respond to document events is the <bpt id=\"p1\">[</bpt>CDataRecoveryHandler Class<ept id=\"p1\">](../../mfc/reference/cdatarecoveryhandler-class.md)</ept>.","pos":[26580,26730],"source":" Currently, the only class that must respond to document events is the [CDataRecoveryHandler Class](../../mfc/reference/cdatarecoveryhandler-class.md)."},{"content":"The <ph id=\"ph1\">`CDocument`</ph> class has other overrideable methods responsible for handling the effect on the <ph id=\"ph2\">`CDocument`</ph>.","pos":[26731,26839],"source":" The `CDocument` class has other overrideable methods responsible for handling the effect on the `CDocument`."},{"pos":[26846,26945],"content":"The following table lists the possible values for <ph id=\"ph1\">`deEvent`</ph> and the events that they correspond to.","source":"The following table lists the possible values for `deEvent` and the events that they correspond to."},{"content":"Value","pos":[26952,26957]},{"content":"Corresponding Event","pos":[26958,26977]},{"content":"A new document was created.","pos":[27045,27072]},{"content":"A new document was opened.","pos":[27099,27125]},{"content":"The document was saved.","pos":[27152,27175]},{"content":"The document was closed.","pos":[27203,27227]},{"pos":[27281,27307],"content":"CDocument::OnDrawThumbnail"},{"content":"Override this method in a derived class to draw the thumbnail.","pos":[27311,27373]},{"content":"Parameters","pos":[27467,27477]},{"content":"A reference to a device context.","pos":[27489,27521]},{"content":"Specifies a bounding rectangle of the area where the thumbnail should be drawn.","pos":[27544,27623]},{"content":"Remarks","pos":[27633,27640]},{"pos":[27692,27717],"content":"CDocument::OnFileSendMail"},{"content":"Sends a message via the resident mail host (if any) with the document as an attachment.","pos":[27721,27808]},{"content":"Remarks","pos":[27856,27863]},{"content":"calls <bpt id=\"p1\">[</bpt>OnSaveDocument<ept id=\"p1\">](#cdocument__onsavedocument)</ept> to serialize (save) untitled and modified documents to a temporary file, which is then sent via electronic mail.","pos":[27884,28047],"source":" calls [OnSaveDocument](#cdocument__onsavedocument) to serialize (save) untitled and modified documents to a temporary file, which is then sent via electronic mail."},{"content":"If the document has not been modified, a temporary file is not needed; the original is sent.","pos":[28048,28140]},{"content":"loads MAPI32.DLL if it has not already been loaded.","pos":[28158,28209]},{"pos":[28216,28356],"content":"A special implementation of <ph id=\"ph1\">`OnFileSendMail`</ph> for <bpt id=\"p1\">[</bpt>COleDocument<ept id=\"p1\">](../../mfc/reference/coledocument-class.md)</ept> handles compound files correctly.","source":"A special implementation of `OnFileSendMail` for [COleDocument](../../mfc/reference/coledocument-class.md) handles compound files correctly."},{"content":"<bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> supports sending your document via mail if mail support (MAPI) is present.","pos":[28363,28451],"source":"**CDocument** supports sending your document via mail if mail support (MAPI) is present."},{"content":"See the articles <bpt id=\"p1\">[</bpt>MAPI Topics<ept id=\"p1\">](../../mfc/mapi.md)</ept> and <bpt id=\"p2\">[</bpt>MAPI Support in MFC<ept id=\"p2\">](../../mfc/mapi-support-in-mfc.md)</ept>.","pos":[28452,28562],"source":" See the articles [MAPI Topics](../../mfc/mapi.md) and [MAPI Support in MFC](../../mfc/mapi-support-in-mfc.md)."},{"pos":[28624,28659],"content":"CDocument::OnLoadDocumentFromStream"},{"content":"Called by the framework when it needs to load the document data from a stream.","pos":[28663,28741]},{"content":"Parameters","pos":[28852,28862]},{"content":"A pointer to an incoming stream.","pos":[28879,28911]},{"content":"Access mode to the stream.","pos":[28931,28957]},{"content":"Return Value","pos":[28967,28979]},{"content":"S_OK if the load is successful; otherwise an error code.","pos":[28983,29039]},{"content":"Remarks","pos":[29049,29056]},{"pos":[29107,29131],"content":"CDocument::OnNewDocument"},{"content":"Called by the framework as part of the File New command.","pos":[29135,29191]},{"content":"Return Value","pos":[29246,29258]},{"content":"Nonzero if the document was successfully initialized; otherwise 0.","pos":[29262,29328]},{"content":"Remarks","pos":[29338,29345]},{"content":"The default implementation of this function calls the <bpt id=\"p1\">[</bpt>DeleteContents<ept id=\"p1\">](#cdocument__deletecontents)</ept> member function to ensure that the document is empty and then marks the new document as clean.","pos":[29349,29542],"source":"The default implementation of this function calls the [DeleteContents](#cdocument__deletecontents) member function to ensure that the document is empty and then marks the new document as clean."},{"content":"Override this function to initialize the data structure for a new document.","pos":[29543,29618]},{"content":"You should call the base class version of this function from your override.","pos":[29619,29694]},{"content":"If the user chooses the File New command in an SDI application, the framework uses this function to reinitialize the existing document, rather than creating a new one.","pos":[29701,29868]},{"content":"If the user chooses File New in a multiple document interface (MDI) application, the framework creates a new document each time and then calls this function to initialize it.","pos":[29869,30043]},{"content":"You must place your initialization code in this function instead of in the constructor for the File New command to be effective in SDI applications.","pos":[30044,30192]},{"content":"Note that there are cases where <ph id=\"ph1\">`OnNewDocument`</ph> is called twice.","pos":[30199,30263],"source":"Note that there are cases where `OnNewDocument` is called twice."},{"content":"This occurs when the document is embedded as an ActiveX Document Server.","pos":[30264,30336]},{"content":"The function is first called by the <ph id=\"ph1\">`CreateInstance`</ph> method (exposed by the <ph id=\"ph2\">`COleObjectFactory`</ph>-derived class) and a second time by the <ph id=\"ph3\">`InitNew`</ph> method (exposed by the <ph id=\"ph4\">`COleServerDoc`</ph>-derived class).","pos":[30337,30537],"source":" The function is first called by the `CreateInstance` method (exposed by the `COleObjectFactory`-derived class) and a second time by the `InitNew` method (exposed by the `COleServerDoc`-derived class)."},{"content":"Example","pos":[30547,30554]},{"content":"The following examples illustrate alternative methods of initializing a document object.","pos":[30558,30646]},{"pos":[30664,30681],"content":"NVC_MFCDocView#60"},{"pos":[30750,30767],"content":"NVC_MFCDocView#61"},{"pos":[30836,30853],"content":"NVC_MFCDocView#62"},{"pos":[30956,30981],"content":"CDocument::OnOpenDocument"},{"content":"Called by the framework as part of the File Open command.","pos":[30985,31042]},{"content":"Parameters","pos":[31118,31128]},{"content":"Points to the path of the document to be opened.","pos":[31150,31198]},{"content":"Return Value","pos":[31208,31220]},{"content":"Nonzero if the document was successfully loaded; otherwise 0.","pos":[31224,31285]},{"content":"Remarks","pos":[31295,31302]},{"content":"The default implementation of this function opens the specified file, calls the <bpt id=\"p1\">[</bpt>DeleteContents<ept id=\"p1\">](#cdocument__deletecontents)</ept> member function to ensure that the document is empty, calls <bpt id=\"p2\">[</bpt>CObject::Serialize<ept id=\"p2\">](../../mfc/reference/cobject-class.md#cobject__serialize)</ept> to read the file's contents, and then marks the document as clean.","pos":[31306,31635],"source":"The default implementation of this function opens the specified file, calls the [DeleteContents](#cdocument__deletecontents) member function to ensure that the document is empty, calls [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize) to read the file's contents, and then marks the document as clean."},{"content":"Override this function if you want to use something other than the archive mechanism or the file mechanism.","pos":[31636,31743]},{"content":"For example, you might write an application where documents represent records in a database rather than separate files.","pos":[31744,31863]},{"content":"If the user chooses the File Open command in an SDI application, the framework uses this function to reinitialize the existing <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> object, rather than creating a new one.","pos":[31870,32050],"source":"If the user chooses the File Open command in an SDI application, the framework uses this function to reinitialize the existing **CDocument** object, rather than creating a new one."},{"content":"If the user chooses File Open in an MDI application, the framework constructs a new <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> object each time and then calls this function to initialize it.","pos":[32051,32212],"source":" If the user chooses File Open in an MDI application, the framework constructs a new **CDocument** object each time and then calls this function to initialize it."},{"content":"You must place your initialization code in this function instead of in the constructor for the File Open command to be effective in SDI applications.","pos":[32213,32362]},{"content":"Example","pos":[32372,32379]},{"content":"The following examples illustrate alternative methods of initializing a document object.","pos":[32383,32471]},{"pos":[32489,32506],"content":"NVC_MFCDocView#60"},{"pos":[32575,32592],"content":"NVC_MFCDocView#61"},{"pos":[32661,32678],"content":"NVC_MFCDocView#62"},{"pos":[32747,32764],"content":"NVC_MFCDocView#63"},{"pos":[32879,32916],"content":"CDocument::OnPreviewHandlerQueryFocus"},{"pos":[32920,33014],"content":"Directs the preview handler to return the HWND retrieved from calling the <ph id=\"ph1\">`GetFocus`</ph> function.","source":"Directs the preview handler to return the HWND retrieved from calling the `GetFocus` function."},{"content":"Parameters","pos":[33096,33106]},{"content":"[out] When this method returns, contains a pointer to the HWND returned from calling the <ph id=\"ph1\">`GetFocus`</ph> function from the preview handler's foreground thread.","pos":[33121,33275],"source":" [out] When this method returns, contains a pointer to the HWND returned from calling the `GetFocus` function from the preview handler's foreground thread."},{"content":"Return Value","pos":[33285,33297]},{"content":"Returns S_OK if successful; or an error value otherwise.","pos":[33301,33357]},{"content":"Remarks","pos":[33367,33374]},{"pos":[33448,33495],"content":"CDocument::OnPreviewHandlerTranslateAccelerator"},{"content":"Directs the preview handler to handle a keystroke passed up from the message pump of the process in which the preview handler is running.","pos":[33499,33636]},{"content":"Parameters","pos":[33726,33736]},{"content":"[in] A pointer to a window message.","pos":[33750,33785]},{"content":"Return Value","pos":[33795,33807]},{"content":"If the keystroke message can be processed by the preview handler, the handler processes it and returns S_OK.","pos":[33811,33919]},{"content":"If the preview handler cannot process the keystroke message, it offers it to the host via <ph id=\"ph1\">`IPreviewHandlerFrame::TranslateAccelerator`</ph>.","pos":[33920,34055],"source":" If the preview handler cannot process the keystroke message, it offers it to the host via `IPreviewHandlerFrame::TranslateAccelerator`."},{"content":"If the host processes the message, this method returns S_OK.","pos":[34056,34116]},{"content":"If the host does not process the message, this method returns S_FALSE.","pos":[34117,34187]},{"content":"Remarks","pos":[34197,34204]},{"pos":[34271,34311],"content":"CDocument::OnRichPreviewBackColorChanged"},{"content":"Called when the Rich Preview background color has changed.","pos":[34315,34373]},{"content":"Remarks","pos":[34444,34451]},{"pos":[34513,34548],"content":"CDocument::OnRichPreviewFontChanged"},{"content":"Called when the Rich Preview font has changed.","pos":[34552,34598]},{"content":"Remarks","pos":[34664,34671]},{"pos":[34733,34768],"content":"CDocument::OnRichPreviewSiteChanged"},{"content":"Called when the Rich Preview site has changed.","pos":[34772,34818]},{"content":"Remarks","pos":[34884,34891]},{"pos":[34958,34998],"content":"CDocument::OnRichPreviewTextColorChanged"},{"content":"Called when the Rich Preview text color has changed.","pos":[35002,35054]},{"content":"Remarks","pos":[35125,35132]},{"pos":[35184,35209],"content":"CDocument::OnSaveDocument"},{"content":"Called by the framework as part of the File Save or File Save As command.","pos":[35213,35286]},{"content":"Parameters","pos":[35362,35372]},{"content":"Points to the fully qualified path to which the file should be saved.","pos":[35394,35463]},{"content":"Return Value","pos":[35473,35485]},{"content":"Nonzero if the document was successfully saved; otherwise 0.","pos":[35489,35549]},{"content":"Remarks","pos":[35559,35566]},{"content":"The default implementation of this function opens the specified file, calls <bpt id=\"p1\">[</bpt>CObject::Serialize<ept id=\"p1\">](../../mfc/reference/cobject-class.md#cobject__serialize)</ept> to write the document's data to the file, and then marks the document as clean.","pos":[35570,35803],"source":"The default implementation of this function opens the specified file, calls [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize) to write the document's data to the file, and then marks the document as clean."},{"content":"Override this function if you want to perform special processing when the framework saves a document.","pos":[35804,35905]},{"content":"For example, you might write an application where documents represent records in a database rather than separate files.","pos":[35906,36025]},{"pos":[36078,36104],"content":"CDocument::OnUnloadHandler"},{"content":"Called by the framework when the preview handler is unloaded.","pos":[36108,36169]},{"content":"Remarks","pos":[36226,36233]},{"pos":[36291,36322],"content":"CDocument::OnUpdateFileSendMail"},{"pos":[36326,36402],"content":"Enables the <bpt id=\"p1\">**</bpt>ID_FILE_SEND_MAIL<ept id=\"p1\">**</ept> command if mail support (MAPI) is present.","source":"Enables the **ID_FILE_SEND_MAIL** command if mail support (MAPI) is present."},{"content":"Parameters","pos":[36470,36480]},{"content":"A pointer to the <bpt id=\"p1\">[</bpt>CCmdUI<ept id=\"p1\">](../../mfc/reference/ccmdui-class.md)</ept> object associated with the <bpt id=\"p2\">**</bpt>ID_FILE_SEND_MAIL<ept id=\"p2\">**</ept> command.","pos":[36496,36616],"source":" A pointer to the [CCmdUI](../../mfc/reference/ccmdui-class.md) object associated with the **ID_FILE_SEND_MAIL** command."},{"content":"Remarks","pos":[36626,36633]},{"content":"Otherwise the function removes the <bpt id=\"p1\">**</bpt>ID_FILE_SEND_MAIL<ept id=\"p1\">**</ept> command from the menu, including separators above or below the menu item as appropriate.","pos":[36637,36782],"source":"Otherwise the function removes the **ID_FILE_SEND_MAIL** command from the menu, including separators above or below the menu item as appropriate."},{"content":"MAPI is enabled if MAPI32.DLL is present in the path and, in the [Mail] section of the WIN.INI file, MAPI=1.","pos":[36783,36891]},{"content":"Most applications put this command on the File menu.","pos":[36892,36944]},{"content":"<bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> supports sending your document via mail if mail support (MAPI) is present.","pos":[36951,37039],"source":"**CDocument** supports sending your document via mail if mail support (MAPI) is present."},{"content":"See the articles <bpt id=\"p1\">[</bpt>MAPI Topics<ept id=\"p1\">](../../mfc/mapi.md)</ept> and <bpt id=\"p2\">[</bpt>MAPI Support in MFC<ept id=\"p2\">](../../mfc/mapi-support-in-mfc.md)</ept>.","pos":[37040,37150],"source":" See the articles [MAPI Topics](../../mfc/mapi.md) and [MAPI Support in MFC](../../mfc/mapi-support-in-mfc.md)."},{"pos":[37201,37225],"content":"CDocument::PreCloseFrame"},{"content":"This member function is called by the framework before the frame window is destroyed.","pos":[37229,37314]},{"content":"Parameters","pos":[37386,37396]},{"content":"Pointer to the <bpt id=\"p1\">[</bpt>CFrameWnd<ept id=\"p1\">](../../mfc/reference/cframewnd-class.md)</ept> that holds the associated <bpt id=\"p2\">**</bpt>CDocument<ept id=\"p2\">**</ept> object.","pos":[37412,37526],"source":" Pointer to the [CFrameWnd](../../mfc/reference/cframewnd-class.md) that holds the associated **CDocument** object."},{"content":"Remarks","pos":[37536,37543]},{"content":"It can be overridden to provide custom cleanup, but be sure to call the base class as well.","pos":[37547,37638]},{"content":"The default of <ph id=\"ph1\">`PreCloseFrame`</ph> does nothing in <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept>.","pos":[37645,37706],"source":"The default of `PreCloseFrame` does nothing in **CDocument**."},{"content":"The <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept>-derived classes <bpt id=\"p2\">[</bpt>COleDocument<ept id=\"p2\">](../../mfc/reference/coledocument-class.md)</ept> and <bpt id=\"p3\">[</bpt>CRichEditDoc<ept id=\"p3\">](../../mfc/reference/cricheditdoc-class.md)</ept> use this member function.","pos":[37707,37886],"source":" The **CDocument**-derived classes [COleDocument](../../mfc/reference/coledocument-class.md) and [CRichEditDoc](../../mfc/reference/cricheditdoc-class.md) use this member function."},{"pos":[37942,37971],"content":"CDocument::ReadNextChunkValue"},{"content":"Reads the next chunk value.","pos":[37975,38002]},{"content":"Parameters","pos":[38089,38099]},{"content":"[out] When the function returns, <ph id=\"ph1\">`ppValue`</ph> contains the value that was read.","pos":[38116,38192],"source":" [out] When the function returns, `ppValue` contains the value that was read."},{"content":"Return Value","pos":[38202,38214]},{"content":"Nonzero if successful; otherwise 0.","pos":[38218,38253]},{"content":"Remarks","pos":[38263,38270]},{"pos":[38319,38341],"content":"CDocument::ReleaseFile"},{"content":"This member function is called by the framework to release a file, making it available for use by other applications.","pos":[38345,38462]},{"content":"Parameters","pos":[38551,38561]},{"content":"A pointer to the CFile object to be released.","pos":[38576,38621]},{"content":"Specifies whether the file is to be released by using either <ph id=\"ph1\">`CFile::Close`</ph> or <ph id=\"ph2\">`CFile::Abort`</ph>.","pos":[38640,38734],"source":" Specifies whether the file is to be released by using either `CFile::Close` or `CFile::Abort`."},{"content":"<bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> if the file is to be released using <bpt id=\"p2\">[</bpt>CFile::Close<ept id=\"p2\">](../../mfc/reference/cfile-class.md#cfile__close)</ept>; <bpt id=\"p3\">**</bpt>TRUE<ept id=\"p3\">**</ept> if the file is to be released using <bpt id=\"p4\">[</bpt>CFile::Abort<ept id=\"p4\">](../../mfc/reference/cfile-class.md#cfile__abort)</ept>.","pos":[38735,38955],"source":"**FALSE** if the file is to be released using [CFile::Close](../../mfc/reference/cfile-class.md#cfile__close); **TRUE** if the file is to be released using [CFile::Abort](../../mfc/reference/cfile-class.md#cfile__abort)."},{"content":"Remarks","pos":[38965,38972]},{"content":"If <ph id=\"ph1\">`bAbort`</ph> is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, <ph id=\"ph2\">`ReleaseFile`</ph> calls <ph id=\"ph3\">`CFile::Abort`</ph>, and the file is released.","pos":[38976,39062],"source":"If `bAbort` is **TRUE**, `ReleaseFile` calls `CFile::Abort`, and the file is released."},{"content":"will not throw an exception.","pos":[39078,39106]},{"pos":[39113,39199],"content":"If <ph id=\"ph1\">`bAbort`</ph> is <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, <ph id=\"ph2\">`ReleaseFile`</ph> calls <ph id=\"ph3\">`CFile::Close`</ph> and the file is released.","source":"If `bAbort` is **FALSE**, `ReleaseFile` calls `CFile::Close` and the file is released."},{"content":"Override this member function to require an action by the user before the file is released.","pos":[39206,39297]},{"pos":[39346,39368],"content":"CDocument::RemoveChunk"},{"content":"Removes a chunk with the specified GUID.","pos":[39372,39412]},{"content":"Parameters","pos":[39500,39510]},{"content":"Specifies the GUID of a chunk to be removed.","pos":[39524,39568]},{"content":"Specifies the PID of a chunk to be removed.","pos":[39584,39627]},{"content":"Remarks","pos":[39637,39644]},{"pos":[39692,39713],"content":"CDocument::RemoveView"},{"content":"Call this function to detach a view from a document.","pos":[39717,39769]},{"content":"Parameters","pos":[39825,39835]},{"content":"Points to the view being removed.","pos":[39850,39883]},{"content":"Remarks","pos":[39893,39900]},{"content":"This function removes the specified view from the list of views associated with the document; it also sets the view's document pointer to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[39904,40051],"source":"This function removes the specified view from the list of views associated with the document; it also sets the view's document pointer to **NULL**."},{"content":"This function is called by the framework when a frame window is closed or a pane of a splitter window is closed.","pos":[40052,40164]},{"content":"Call this function only if you are manually detaching a view.","pos":[40171,40232]},{"content":"Typically you will let the framework detach documents and views by defining a <bpt id=\"p1\">[</bpt>CDocTemplate<ept id=\"p1\">](../../mfc/reference/cdoctemplate-class.md)</ept> object to associate a document class, view class, and frame window class.","pos":[40233,40442],"source":" Typically you will let the framework detach documents and views by defining a [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) object to associate a document class, view class, and frame window class."},{"pos":[40449,40527],"content":"See the example at <bpt id=\"p1\">[</bpt>AddView<ept id=\"p1\">](#cdocument__addview)</ept> for a sample implementation.","source":"See the example at [AddView](#cdocument__addview) for a sample implementation."},{"pos":[40588,40622],"content":"CDocument::ReportSaveLoadException"},{"pos":[40626,40843],"content":"Called if an exception is thrown (typically a <bpt id=\"p1\">[</bpt>CFileException<ept id=\"p1\">](../../mfc/reference/cfileexception-class.md)</ept> or <bpt id=\"p2\">[</bpt>CArchiveException<ept id=\"p2\">](../../mfc/reference/carchiveexception-class.md)</ept>) while saving or loading the document.","source":"Called if an exception is thrown (typically a [CFileException](../../mfc/reference/cfileexception-class.md) or [CArchiveException](../../mfc/reference/carchiveexception-class.md)) while saving or loading the document."},{"content":"Parameters","pos":[40998,41008]},{"content":"Points to name of document that was being saved or loaded.","pos":[41030,41088]},{"content":"e","pos":[41096,41097]},{"content":"Points to the exception that was thrown.","pos":[41102,41142]},{"content":"May be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[41143,41159],"source":" May be **NULL**."},{"content":"bSaving","pos":[41167,41174]},{"content":"Flag indicating what operation was in progress; nonzero if the document was being saved, 0 if the document was being loaded.","pos":[41179,41303]},{"content":"Identifier of the error message to be displayed if the function does not specify a more specific one.","pos":[41327,41428]},{"content":"Remarks","pos":[41438,41445]},{"content":"The default implementation examines the exception object and looks for an error message that specifically describes the cause.","pos":[41449,41575]},{"content":"If a specific message is not found or if <bpt id=\"p1\">*</bpt>e<ept id=\"p1\">*</ept> is <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>, the general message specified by the <ph id=\"ph1\">`nIDPDefault`</ph> parameter is used.","pos":[41576,41703],"source":" If a specific message is not found or if *e* is **NULL**, the general message specified by the `nIDPDefault` parameter is used."},{"content":"The function then displays a message box containing the error message.","pos":[41704,41774]},{"content":"Override this function if you want to provide additional, customized failure messages.","pos":[41775,41861]},{"content":"This is an advanced overridable.","pos":[41862,41894]},{"pos":[41944,41967],"content":"CDocument::SaveModified"},{"content":"Called by the framework before a modified document is to be closed.","pos":[41971,42038]},{"content":"Return Value","pos":[42092,42104]},{"content":"Nonzero if it is safe to continue and close the document; 0 if the document should not be closed.","pos":[42108,42205]},{"content":"Remarks","pos":[42215,42222]},{"content":"The default implementation of this function displays a message box asking the user whether to save the changes to the document, if any have been made.","pos":[42226,42376]},{"content":"Override this function if your program requires a different prompting procedure.","pos":[42377,42457]},{"content":"This is an advanced overridable.","pos":[42458,42490]},{"pos":[42541,42565],"content":"CDocument::SetChunkValue"},{"content":"Sets a chunk value.","pos":[42569,42588]},{"content":"Parameters","pos":[42669,42679]},{"content":"Specifies a chunk value to set.","pos":[42695,42726]},{"content":"Return Value","pos":[42736,42748]},{"content":"Nonzero if successful; otherwise 0.","pos":[42752,42787]},{"content":"Remarks","pos":[42797,42804]},{"pos":[42857,42883],"content":"CDocument::SetModifiedFlag"},{"content":"Call this function after you have made any modifications to the document.","pos":[42887,42960]},{"content":"Parameters","pos":[43038,43048]},{"content":"Flag indicating whether the document has been modified.","pos":[43067,43122]},{"content":"Remarks","pos":[43132,43139]},{"content":"By calling this function consistently, you ensure that the framework prompts the user to save changes before closing a document.","pos":[43143,43271]},{"content":"Typically you should use the default value of <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> for the <ph id=\"ph1\">`bModified`</ph> parameter.","pos":[43272,43357],"source":" Typically you should use the default value of **TRUE** for the `bModified` parameter."},{"content":"To mark a document as clean (unmodified), call this function with a value of <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[43358,43445],"source":" To mark a document as clean (unmodified), call this function with a value of **FALSE**."},{"pos":[43494,43516],"content":"CDocument::SetPathName"},{"content":"Call this function to specify the fully qualified path of the document's disk file.","pos":[43520,43603]},{"content":"Parameters","pos":[43710,43720]},{"content":"Points to the string to be used as the path for the document.","pos":[43742,43803]},{"content":"Determines whether the filename is added to the most recently used (MRU) file list.","pos":[43825,43908]},{"content":"If <bpt id=\"p1\">**</bpt>TRUE,<ept id=\"p1\">**</ept> the filename is added; if <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>, it is not added.","pos":[43909,43975],"source":" If **TRUE,** the filename is added; if **FALSE**, it is not added."},{"content":"Remarks","pos":[43985,43992]},{"content":"Depending on the value of <ph id=\"ph1\">`bAddToMRU`</ph> the path is added, or not added, to the MRU list maintained by the application.","pos":[43996,44113],"source":"Depending on the value of `bAddToMRU` the path is added, or not added, to the MRU list maintained by the application."},{"content":"Note that some documents are not associated with a disk file.","pos":[44114,44175]},{"content":"Call this function only if you are overriding the default implementation for opening and saving files used by the framework.","pos":[44176,44300]},{"pos":[44346,44365],"content":"CDocument::SetTitle"},{"content":"Call this function to specify the document's title (the string displayed in the title bar of a frame window).","pos":[44369,44478]},{"content":"Parameters","pos":[44545,44555]},{"content":"Points to the string to be used as the document's title.","pos":[44574,44630]},{"content":"Remarks","pos":[44640,44647]},{"content":"Calling this function updates the titles of all frame windows that display the document.","pos":[44651,44739]},{"pos":[44791,44816],"content":"CDocument::UpdateAllViews"},{"content":"Call this function after the document has been modified.","pos":[44820,44876]},{"content":"Parameters","pos":[44997,45007]},{"content":"Points to the view that modified the document, or <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if all views are to be updated.","pos":[45024,45114],"source":" Points to the view that modified the document, or **NULL** if all views are to be updated."},{"content":"Contains information about the modification.","pos":[45132,45176]},{"content":"Points to an object storing information about the modification.","pos":[45194,45257]},{"content":"Remarks","pos":[45267,45274]},{"content":"You should call this function after you call the <bpt id=\"p1\">[</bpt>SetModifiedFlag<ept id=\"p1\">](#cdocument__setmodifiedflag)</ept> member function.","pos":[45278,45390],"source":"You should call this function after you call the [SetModifiedFlag](#cdocument__setmodifiedflag) member function."},{"content":"This function informs each view attached to the document, except for the view specified by <ph id=\"ph1\">`pSender`</ph>, that the document has been modified.","pos":[45391,45529],"source":" This function informs each view attached to the document, except for the view specified by `pSender`, that the document has been modified."},{"content":"You typically call this function from your view class after the user has changed the document through a view.","pos":[45530,45639]},{"content":"This function calls the <bpt id=\"p1\">[</bpt>CView::OnUpdate<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__onupdate)</ept> member function for each of the document's views except the sending view, passing <ph id=\"ph1\">`pHint`</ph> and <ph id=\"ph2\">`lHint`</ph>.","pos":[45646,45842],"source":"This function calls the [CView::OnUpdate](../../mfc/reference/cview-class.md#cview__onupdate) member function for each of the document's views except the sending view, passing `pHint` and `lHint`."},{"content":"Use these parameters to pass information to the views about the modifications made to the document.","pos":[45843,45942]},{"content":"You can encode information using <ph id=\"ph1\">`lHint`</ph> and/or you can define a <bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>-derived class to store information about the modifications and pass an object of that class using <ph id=\"ph2\">`pHint`</ph>.","pos":[45943,46162],"source":" You can encode information using `lHint` and/or you can define a [CObject](../../mfc/reference/cobject-class.md)-derived class to store information about the modifications and pass an object of that class using `pHint`."},{"content":"Override the <ph id=\"ph1\">`CView::OnUpdate`</ph> member function in your <bpt id=\"p1\">[</bpt>CView<ept id=\"p1\">](../../mfc/reference/cview-class.md)</ept>-derived class to optimize the updating of the view's display based on the information passed.","pos":[46163,46355],"source":" Override the `CView::OnUpdate` member function in your [CView](../../mfc/reference/cview-class.md)-derived class to optimize the updating of the view's display based on the information passed."},{"content":"Example","pos":[46365,46372]},{"pos":[46387,46404],"content":"NVC_MFCDocView#64"},{"content":"See Also","pos":[46464,46472]},{"content":"MFC Sample MDIDOCVW","pos":[46477,46496]},{"content":"MFC Sample SNAPVW","pos":[46532,46549]},{"content":"MFC Sample NPP","pos":[46585,46599]},{"content":"CCmdTarget Class","pos":[46635,46651]},{"content":"Hierarchy Chart","pos":[46699,46714]},{"content":"CCmdTarget Class","pos":[46751,46767]},{"content":"CView Class","pos":[46815,46826]},{"content":"CDocTemplate Class","pos":[46869,46887]}],"content":"---\ntitle: \"CDocument Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDocument\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"documents [C++], serialization\"\n  - \"files [C++], documents\"\n  - \"command handling, documents and\"\n  - \"documents [C++], document classes\"\n  - \"documents [C++], multiple views\"\n  - \"serialization [C++], documents and\"\n  - \"CDocument class\"\n  - \"command routing, documents and\"\n  - \"views [C++], document\"\n  - \"documents [C++], command routing\"\nms.assetid: e5a2891d-e1e1-4599-8c7e-afa9b4945446\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDocument Class\nProvides the basic functionality for user-defined document classes.  \n  \n## Syntax  \n  \n```  \nclass CDocument : public CCmdTarget  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDocument::CDocument](#cdocument__cdocument)|Constructs a `CDocument` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDocument::AddView](#cdocument__addview)|Attaches a view to the document.|  \n|[CDocument::BeginReadChunks](#cdocument__beginreadchunks)|Initializes chunk reading.|  \n|[CDocument::CanCloseFrame](#cdocument__cancloseframe)|Advanced overridable; called before closing a frame window viewing this document.|  \n|[CDocument::ClearChunkList](#cdocument__clearchunklist)|Clears the chunk list.|  \n|[CDocument::ClearPathName](#cdocument__clearpathname)|Clears the path of the document object.|  \n|[CDocument::DeleteContents](#cdocument__deletecontents)|Called to perform cleanup of the document.|  \n|[CDocument::FindChunk](#cdocument__findchunk)|Looks for a chunk with specified GUID.|  \n|[CDocument::GetAdapter](#cdocument__getadapter)|Returns a pointer to object implementing `IDocument` interface.|  \n|[CDocument::GetDocTemplate](#cdocument__getdoctemplate)|Returns a pointer to the document template that describes the type of the document.|  \n|[CDocument::GetFile](#cdocument__getfile)|Returns a pointer to the desired `CFile` object.|  \n|[CDocument::GetFirstViewPosition](#cdocument__getfirstviewposition)|Returns the position of the first in the list of views; used to begin iteration.|  \n|[CDocument::GetNextView](#cdocument__getnextview)|Iterates through the list of views associated with the document.|  \n|[CDocument::GetPathName](#cdocument__getpathname)|Returns the path of the document's data file.|  \n|[CDocument::GetThumbnail](#cdocument__getthumbnail)|Called to create a bitmap to be used by thumbnail provider to display thumbnail.|  \n|[CDocument::GetTitle](#cdocument__gettitle)|Returns the document's title.|  \n|[CDocument::InitializeSearchContent](#cdocument__initializesearchcontent)|Called to initialize search content for Search Handler.|  \n|[CDocument::IsModified](#cdocument__ismodified)|Indicates whether the document has been modified since it was last saved.|  \n|[CDocument::IsSearchAndOrganizeHandler](#cdocument__issearchandorganizehandler)|Tells whether this instance of `CDocument` object was created for Search & Organize handler.|  \n|[CDocument::LoadDocumentFromStream](#cdocument__loaddocumentfromstream)|Called to load document data from stream.|  \n|[CDocument::OnBeforeRichPreviewFontChanged](#cdocument__onbeforerichpreviewfontchanged)|Called before Rich Preview font is changed.|  \n|[CDocument::OnChangedViewList](#cdocument__onchangedviewlist)|Called after a view is added to or removed from the document.|  \n|[CDocument::OnCloseDocument](#cdocument__onclosedocument)|Called to close the document.|  \n|[CDocument::OnCreatePreviewFrame](#cdocument__oncreatepreviewframe)|Called by the framework when it needs to create a preview frame for Rich Preview.|  \n|[CDocument::OnDocumentEvent](#cdocument__ondocumentevent)|Called by the framework in response to a document event.|  \n|[CDocument::OnDrawThumbnail](#cdocument__ondrawthumbnail)|Override this method in a derived class to draw content of thumbnail.|  \n|[CDocument::OnLoadDocumentFromStream](#cdocument__onloaddocumentfromstream)|Called by the framework when it needs to load the document data from stream.|  \n|[CDocument::OnNewDocument](#cdocument__onnewdocument)|Called to create a new document.|  \n|[CDocument::OnOpenDocument](#cdocument__onopendocument)|Called to open an existing document.|  \n|[CDocument::OnPreviewHandlerQueryFocus](#cdocument__onpreviewhandlerqueryfocus)|Directs the preview handler to return the HWND from calling the GetFocus Function.|  \n|[CDocument::OnPreviewHandlerTranslateAccelerator](#cdocument__onpreviewhandlertranslateaccelerator)|Directs the preview handler to handle a keystroke passed up from the message pump of the process in which the preview handler is running.|  \n|[CDocument::OnRichPreviewBackColorChanged](#cdocument__onrichpreviewbackcolorchanged)|Called when Rich Preview background color has changed.|  \n|[CDocument::OnRichPreviewFontChanged](#cdocument__onrichpreviewfontchanged)|Called when Rich Preview font has changed.|  \n|[CDocument::OnRichPreviewSiteChanged](#cdocument__onrichpreviewsitechanged)|Called when Rich Preview site has changed.|  \n|[CDocument::OnRichPreviewTextColorChanged](#cdocument__onrichpreviewtextcolorchanged)|Called when Rich Preview text color has changed.|  \n|[CDocument::OnSaveDocument](#cdocument__onsavedocument)|Called to save the document to disk.|  \n|[CDocument::OnUnloadHandler](#cdocument__onunloadhandler)|Called by the framework when the preview handler is being unloaded.|  \n|[CDocument::PreCloseFrame](#cdocument__precloseframe)|Called before the frame window is closed.|  \n|[CDocument::ReadNextChunkValue](#cdocument__readnextchunkvalue)|Reads next chunk value.|  \n|[CDocument::ReleaseFile](#cdocument__releasefile)|Releases a file to make it available for use by other applications.|  \n|[CDocument::RemoveChunk](#cdocument__removechunk)|Removes a chunk with specified GUID.|  \n|[CDocument::RemoveView](#cdocument__removeview)|Detaches a view from the document.|  \n|[CDocument::ReportSaveLoadException](#cdocument__reportsaveloadexception)|Advanced overridable; called when an open or save operation cannot be completed because of an exception.|  \n|[CDocument::SaveModified](#cdocument__savemodified)|Advanced overridable; called to ask the user whether the document should be saved.|  \n|[CDocument::SetChunkValue](#cdocument__setchunkvalue)|Sets a chunk value.|  \n|[CDocument::SetModifiedFlag](#cdocument__setmodifiedflag)|Sets a flag indicating that you have modified the document since it was last saved.|  \n|[CDocument::SetPathName](#cdocument__setpathname)|Sets the path of the data file used by the document.|  \n|[CDocument::SetTitle](#cdocument__settitle)|Sets the document's title.|  \n|[CDocument::UpdateAllViews](#cdocument__updateallviews)|Notifies all views that document has been modified.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDocument::OnFileSendMail](#cdocument__onfilesendmail)|Sends a mail message with the document attached.|  \n|[CDocument::OnUpdateFileSendMail](#cdocument__onupdatefilesendmail)|Enables the Send Mail command if mail support is present.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDocument::m_bGetThumbnailMode](#cdocument__m_bgetthumbnailmode)|Specifies that `CDocument` object was created by dllhost for thumbnails. Should be checked in `CView::OnDraw`.|  \n|[CDocument::m_bPreviewHandlerMode](#cdocument__m_bpreviewhandlermode)|Specifies that `CDocument` object was created by prevhost for `Rich Preview`. Should be checked in `CView::OnDraw`.|  \n|[CDocument::m_bSearchMode](#cdocument__m_bsearchmode)|Specifies that `CDocument` object was created by indexer or other search application.|  \n|[CDocument::m_clrRichPreviewBackColor](#cdocument__m_clrrichpreviewbackcolor)|Specifies background color of Rich Preview window. This color is set by host.|  \n|[CDocument::m_clrRichPreviewTextColor](#cdocument__m_clrrichpreviewtextcolor)|Specifies foreground color of Rich Preview window. This color is set by host.|  \n|[CDocument::m_lfRichPreviewFont](#cdocument__m_lfrichpreviewfont)|Specifies text font for Rich Preview window. This font information is set by host.|  \n  \n## Remarks  \n A document represents the unit of data that the user typically opens with the File Open command and saves with the File Save command.  \n  \n **CDocument** supports standard operations such as creating a document, loading it, and saving it. The framework manipulates documents using the interface defined by **CDocument**.  \n  \n An application can support more than one type of document; for example, an application might support both spreadsheets and text documents. Each type of document has an associated document template; the document template specifies what resources (for example, menu, icon, or accelerator table) are used for that type of document. Each document contains a pointer to its associated `CDocTemplate` object.  \n  \n Users interact with a document through the [CView](../../mfc/reference/cview-class.md) object(s) associated with it. A view renders an image of the document in a frame window and interprets user input as operations on the document. A document can have multiple views associated with it. When the user opens a window on a document, the framework creates a view and attaches it to the document. The document template specifies what type of view and frame window are used to display each type of document.  \n  \n Documents are part of the framework's standard command routing and consequently receive commands from standard user-interface components (such as the File Save menu item). A document receives commands forwarded by the active view. If the document doesn't handle a given command, it forwards the command to the document template that manages it.  \n  \n When a document's data is modified, each of its views must reflect those modifications. **CDocument** provides the [UpdateAllViews](#cdocument__updateallviews) member function for you to notify the views of such changes, so the views can repaint themselves as necessary. The framework also prompts the user to save a modified file before closing it.  \n  \n To implement documents in a typical application, you must do the following:  \n  \n-   Derive a class from **CDocument** for each type of document.  \n  \n-   Add member variables to store each document's data.  \n  \n-   Implement member functions for reading and modifying the document's data. The document's views are the most important users of these member functions.  \n  \n-   Override the [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize) member function in your document class to write and read the document's data to and from disk.  \n  \n **CDocument** supports sending your document via mail if mail support (MAPI) is present. See the articles [MAPI](../../mfc/mapi.md) and [MAPI Support in MFC](../../mfc/mapi-support-in-mfc.md).  \n  \n For more information on **CDocument**, see [Serialization](../../mfc/serialization-in-mfc.md), [Document/View Architecture Topics](../../mfc/document-view-architecture.md), and [Document/View Creation](../../mfc/document-view-creation.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n `CDocument`  \n  \n## Requirements  \n **Header:** afxwin.h  \n  \n##  <a name=\"cdocument__addview\"></a>  CDocument::AddView  \n Call this function to attach a view to the document.  \n  \n```  \nvoid AddView(CView* pView);\n```  \n  \n### Parameters  \n `pView`  \n Points to the view being added.  \n  \n### Remarks  \n This function adds the specified view to the list of views associated with the document; the function also sets the view's document pointer to this document. The framework calls this function when attaching a newly created view object to a document; this occurs in response to a File New, File Open, or New Window command or when a splitter window is split.  \n  \n Call this function only if you are manually creating and attaching a view. Typically you will let the framework connect documents and views by defining a [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) object to associate a document class, view class, and frame window class.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocViewSDI#12](../../mfc/codesnippet/cpp/cdocument-class_1.cpp)]  \n  \n##  <a name=\"cdocument__beginreadchunks\"></a>  CDocument::BeginReadChunks  \n Initializes chunk reading.  \n  \n```  \nvirtual void BeginReadChunks ();\n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__cancloseframe\"></a>  CDocument::CanCloseFrame  \n Called by the framework before a frame window displaying the document is closed.  \n  \n```  \nvirtual BOOL CanCloseFrame(CFrameWnd* pFrame);\n```  \n  \n### Parameters  \n `pFrame`  \n Points to the frame window of a view attached to the document.  \n  \n### Return Value  \n Nonzero if it is safe to close the frame window; otherwise 0.  \n  \n### Remarks  \n The default implementation checks if there are other frame windows displaying the document. If the specified frame window is the last one that displays the document, the function prompts the user to save the document if it has been modified. Override this function if you want to perform special processing when a frame window is closed. This is an advanced overridable.  \n  \n##  <a name=\"cdocument__cdocument\"></a>  CDocument::CDocument  \n Constructs a **CDocument** object.  \n  \n```  \nCDocument();\n```  \n  \n### Remarks  \n The framework handles document creation for you. Override the [OnNewDocument](#cdocument__onnewdocument) member function to perform initialization on a per-document basis; this is particularly important in single document interface (SDI) applications.  \n  \n##  <a name=\"cdocument__clearchunklist\"></a>  CDocument::ClearChunkList  \n Clears the chunk list.  \n  \n```  \nvirtual void ClearChunkList ();\n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__clearpathname\"></a>  CDocument::ClearPathName  \n Clears the path of the document object.  \n  \n```  \nvirtual void ClearPathName();\n```  \n  \n### Remarks  \n Clearing the path from a `CDocument` object causes the application to prompt the user when the document is next saved. This makes a **Save** command behave like a **Save As** command.  \n  \n##  <a name=\"cdocument__deletecontents\"></a>  CDocument::DeleteContents  \n Called by the framework to delete the document's data without destroying the **CDocument** object itself.  \n  \n```  \nvirtual void DeleteContents();\n```  \n  \n### Remarks  \n It is called just before the document is to be destroyed. It is also called to ensure that a document is empty before it is reused. This is particularly important for an SDI application, which uses only one document; the document is reused whenever the user creates or opens another document. Call this function to implement an \"Edit Clear All\" or similar command that deletes all of the document's data. The default implementation of this function does nothing. Override this function to delete the data in your document.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#57](../../mfc/codesnippet/cpp/cdocument-class_2.cpp)]  \n  \n##  <a name=\"cdocument__findchunk\"></a>  CDocument::FindChunk  \n Looks for a chunk with a specified GUID.  \n  \n```  \nvirtual POSITION FindChunk(\n    REFCLSID guid,  \n    DWORD pid);\n```  \n  \n### Parameters  \n `guid`  \n Specifies the GUID of a chunk to find.  \n  \n `pid`  \n Specifies a PID of a chunk to find.  \n  \n### Return Value  \n Position in the internal chunk list if successful. Otherwise `NULL`.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__getadapter\"></a>  CDocument::GetAdapter  \n Returns a pointer to an object implementing the `IDocument` interface.  \n  \n```  \nvirtual ATL::IDocument* GetAdapter();\n```  \n  \n### Return Value  \n A pointer to an object implementing the `IDocument` interface.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__getdoctemplate\"></a>  CDocument::GetDocTemplate  \n Call this function to get a pointer to the document template for this document type.  \n  \n```  \nCDocTemplate* GetDocTemplate() const;\n\n \n```  \n  \n### Return Value  \n A pointer to the document template for this document type, or **NULL** if the document is not managed by a document template.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#58](../../mfc/codesnippet/cpp/cdocument-class_3.cpp)]  \n  \n##  <a name=\"cdocument__getfile\"></a>  CDocument::GetFile  \n Call this member function to get a pointer to a `CFile` object.  \n  \n```  \nvirtual CFile* GetFile(\n    LPCTSTR lpszFileName,  \n    UINT nOpenFlags,  \n    CFileException* pError);\n```  \n  \n### Parameters  \n `lpszFileName`  \n A string that is the path to the desired file. The path may be relative or absolute.  \n  \n `pError`  \n A pointer to an existing file-exception object that indicates the completion status of the operation.  \n  \n `nOpenFlags`  \n Sharing and access mode. Specifies the action to take when opening the file. You can combine options listed in the CFile constructor [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile) by using the bitwise OR (&#124;) operator. One access permission and one share option are required; the **modeCreate** and **modeNoInherit** modes are optional.  \n  \n### Return Value  \n A pointer to a `CFile` object.  \n  \n##  <a name=\"cdocument__getfirstviewposition\"></a>  CDocument::GetFirstViewPosition  \n Call this function to get the position of the first view in the list of views associated with the document.  \n  \n```  \nvirtual POSITION GetFirstViewPosition() const;\n\n \n```  \n  \n### Return Value  \n A **POSITION** value that can be used for iteration with the [GetNextView](#cdocument__getnextview) member function.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#59](../../mfc/codesnippet/cpp/cdocument-class_4.cpp)]  \n  \n##  <a name=\"cdocument__getnextview\"></a>  CDocument::GetNextView  \n Call this function to iterate through all of the document's views.  \n  \n```  \nvirtual CView* GetNextView(POSITION& rPosition) const;\n\n \n```  \n  \n### Parameters  \n `rPosition`  \n A reference to a **POSITION** value returned by a previous call to the `GetNextView` or [GetFirstViewPosition](#cdocument__getfirstviewposition) member functions. This value must not be **NULL**.  \n  \n### Return Value  \n A pointer to the view identified by `rPosition`.  \n  \n### Remarks  \n The function returns the view identified by `rPosition` and then sets `rPosition` to the **POSITION** value of the next view in the list. If the retrieved view is the last in the list, then `rPosition` is set to **NULL**.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#59](../../mfc/codesnippet/cpp/cdocument-class_4.cpp)]  \n  \n##  <a name=\"cdocument__getpathname\"></a>  CDocument::GetPathName  \n Call this function to get the fully qualified path of the document's disk file.  \n  \n```  \nconst CString& GetPathName() const;\n\n \n```  \n  \n### Return Value  \n The document's fully qualified path. This string is empty if the document has not been saved or does not have a disk file associated with it.  \n  \n##  <a name=\"cdocument__getthumbnail\"></a>  CDocument::GetThumbnail  \n Creates a bitmap to be used by the thumbnail provider to display the thumbnail.  \n  \n```  \nvirtual BOOL GetThumbnail(\n    UINT cx,  \n    HBITMAP* phbmp,  \n    DWORD* pdwAlpha);\n```  \n  \n### Parameters  \n `cx`  \n Specifies the width and height of the bitmap.  \n  \n `phbmp`  \n Contains a handle to a bitmap, when the function returns successfully.  \n  \n `pdwAlpha`  \n Contains a DWORD specifying the alpha channel value, when the function returns successfully.  \n  \n### Return Value  \n Returns `TRUE` if a bitmap for the thumbnail was created successfully; otherwise `FALSE`.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__gettitle\"></a>  CDocument::GetTitle  \n Call this function to get the document's title, which is usually derived from the document's filename.  \n  \n```  \nconst CString& GetTitle() const;\n\n \n```  \n  \n### Return Value  \n The document's title.  \n  \n##  <a name=\"cdocument__initializesearchcontent\"></a>  CDocument::InitializeSearchContent  \n Called to initialize search content for the Search Handler.  \n  \n```  \nvirtual void InitializeSearchContent ();\n```  \n  \n### Remarks  \n Override this method in a derived class to initialize search content. The content should be a string with parts delimited by \";\". For example, \"point; rectangle; ole item\".  \n  \n##  <a name=\"cdocument__ismodified\"></a>  CDocument::IsModified  \n Call this function to determine whether the document has been modified since it was last saved.  \n  \n```  \nvirtual BOOL IsModified();\n```  \n  \n### Return Value  \n Nonzero if the document has been modified since it was last saved; otherwise 0.  \n  \n##  <a name=\"cdocument__issearchandorganizehandler\"></a>  CDocument::IsSearchAndOrganizeHandler  \n Tells whether this instance of `CDocument` was created for the Search & Organize handler.  \n  \n```  \nBOOL IsSearchAndOrganizeHandler() const;\n\n \n```  \n  \n### Return Value  \n Returns `TRUE` if this instance of `CDocument` was created for the Search & Organize handler.  \n  \n### Remarks  \n Currently this function returns `TRUE` only for Rich Preview handlers implemented in an out of process server. You can set the appropriate flags (m_bPreviewHandlerMode, m_bSearchMode, m_bGetThumbnailMode) at your application level to make this function return `TRUE`.  \n  \n##  <a name=\"cdocument__loaddocumentfromstream\"></a>  CDocument::LoadDocumentFromStream  \n Called to load document data from a stream.  \n  \n```  \nvirtual HRESULT LoadDocumentFromStream(\n    IStream* pStream,  \n    DWORD dwGrfMode);\n```  \n  \n### Parameters  \n `pStream`  \n A pointer to a stream. This stream is supplied by the Shell.  \n  \n `dwGrfMode`  \n Access mode to the stream.  \n  \n### Return Value  \n S_OK if the load operation succeeds, otherwise HRESULT with an error code.  \n  \n### Remarks  \n You can override this method in a derived class to customize how to load data from the stream.  \n  \n##  <a name=\"cdocument__m_bgetthumbnailmode\"></a>  CDocument::m_bGetThumbnailMode  \n Specifies that the `CDocument` object was created by dllhost for thumbnails. Should be checked in `CView::OnDraw`.  \n  \n```  \nBOOL m_bGetThumbnailMode;  \n```  \n  \n### Remarks  \n `TRUE` indicates that the document was created by dllhost for thumbnails.  \n  \n##  <a name=\"cdocument__m_bpreviewhandlermode\"></a>  CDocument::m_bPreviewHandlerMode  \n Specifies that the `CDocument` object was created by prevhost for Rich Preview. Should be checked in `CView::OnDraw`.  \n  \n```  \nBOOL m_bPreviewHandlerMode;  \n```  \n  \n### Remarks  \n `TRUE` indicates that the document was created by prevhost for Rich Preview.  \n  \n##  <a name=\"cdocument__m_bsearchmode\"></a>  CDocument::m_bSearchMode  \n Specifies that the `CDocument` object was created by indexer or by another search application.  \n  \n```  \nBOOL m_bSearchMode;  \n```  \n  \n### Remarks  \n `TRUE` indicates that the document was created by indexer or by another search application.  \n  \n##  <a name=\"cdocument__m_clrrichpreviewbackcolor\"></a>  CDocument::m_clrRichPreviewBackColor  \n Specifies the background color of the Rich Preview window. This color is set by host.  \n  \n```  \nCOLORREF m_clrRichPreviewBackColor;  \n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__m_clrrichpreviewtextcolor\"></a>  CDocument::m_clrRichPreviewTextColor  \n Specifies the foreground color of the Rich Preview window. This color is set by host.  \n  \n```  \nCOLORREF m_clrRichPreviewTextColor;  \n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__m_lfrichpreviewfont\"></a>  CDocument::m_lfRichPreviewFont  \n Specifies the text font for the Rich Preview window. This font information is set by host.  \n  \n```  \nCFont m_lfRichPreviewFont;  \n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onbeforerichpreviewfontchanged\"></a>  CDocument::OnBeforeRichPreviewFontChanged  \n Called before the Rich Preview font is changed.  \n  \n```  \nvirtual void OnBeforeRichPreviewFontChanged();\n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onchangedviewlist\"></a>  CDocument::OnChangedViewList  \n Called by the framework after a view is added to or removed from the document.  \n  \n```  \nvirtual void OnChangedViewList();\n```  \n  \n### Remarks  \n The default implementation of this function checks whether the last view is being removed and, if so, deletes the document. Override this function if you want to perform special processing when the framework adds or removes a view. For example, if you want a document to remain open even when there are no views attached to it, override this function.  \n  \n##  <a name=\"cdocument__onclosedocument\"></a>  CDocument::OnCloseDocument  \n Called by the framework when the document is closed, typically as part of the File Close command.  \n  \n```  \nvirtual void OnCloseDocument();\n```  \n  \n### Remarks  \n The default implementation of this function destroys all of the frames used for viewing the document, closes the view, cleans up the document's contents, and then calls the [DeleteContents](#cdocument__deletecontents) member function to delete the document's data.  \n  \n Override this function if you want to perform special cleanup processing when the framework closes a document. For example, if the document represents a record in a database, you may want to override this function to close the database. You should call the base class version of this function from your override.  \n  \n##  <a name=\"cdocument__oncreatepreviewframe\"></a>  CDocument::OnCreatePreviewFrame  \n Called by the framework when it needs to create a preview frame for Rich Preview.  \n  \n```  \nvirtual BOOL OnCreatePreviewFrame();\n```  \n  \n### Return Value  \n Returns `TRUE` if the frame is created successfully; otherwise `FALSE`.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__ondocumentevent\"></a>  CDocument::OnDocumentEvent  \n Called by the framework in response to a document event.  \n  \n```  \nvirtual void OnDocumentEvent(DocumentEvent deEvent);\n```  \n  \n### Parameters  \n [in] `deEvent`  \n An enumerated data type that describes the type of event.  \n  \n### Remarks  \n Document events may affect multiple classes. This method is responsible for handling document events that affect classes other than the [CDocument Class](../../mfc/reference/cdocument-class.md). Currently, the only class that must respond to document events is the [CDataRecoveryHandler Class](../../mfc/reference/cdatarecoveryhandler-class.md). The `CDocument` class has other overrideable methods responsible for handling the effect on the `CDocument`.  \n  \n The following table lists the possible values for `deEvent` and the events that they correspond to.  \n  \n|Value|Corresponding Event|  \n|-----------|-------------------------|  \n|`onAfterNewDocument`|A new document was created.|  \n|`onAfterOpenDocument`|A new document was opened.|  \n|`onAfterSaveDocument`|The document was saved.|  \n|`onAfterCloseDocument`|The document was closed.|  \n  \n##  <a name=\"cdocument__ondrawthumbnail\"></a>  CDocument::OnDrawThumbnail  \n Override this method in a derived class to draw the thumbnail.  \n  \n```  \nvirtual void OnDrawThumbnail(\n    CDC& dc,  \n    LPRECT lprcBounds);\n```  \n  \n### Parameters  \n `dc`  \n A reference to a device context.  \n  \n `lprcBounds`  \n Specifies a bounding rectangle of the area where the thumbnail should be drawn.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onfilesendmail\"></a>  CDocument::OnFileSendMail  \n Sends a message via the resident mail host (if any) with the document as an attachment.  \n  \n```  \nvoid OnFileSendMail();\n```  \n  \n### Remarks  \n `OnFileSendMail` calls [OnSaveDocument](#cdocument__onsavedocument) to serialize (save) untitled and modified documents to a temporary file, which is then sent via electronic mail. If the document has not been modified, a temporary file is not needed; the original is sent. `OnFileSendMail` loads MAPI32.DLL if it has not already been loaded.  \n  \n A special implementation of `OnFileSendMail` for [COleDocument](../../mfc/reference/coledocument-class.md) handles compound files correctly.  \n  \n **CDocument** supports sending your document via mail if mail support (MAPI) is present. See the articles [MAPI Topics](../../mfc/mapi.md) and [MAPI Support in MFC](../../mfc/mapi-support-in-mfc.md).  \n  \n##  <a name=\"cdocument__onloaddocumentfromstream\"></a>  CDocument::OnLoadDocumentFromStream  \n Called by the framework when it needs to load the document data from a stream.  \n  \n```  \nvirtual HRESULT OnLoadDocumentFromStream(\n    IStream* pStream,  \n    DWORD grfMode);\n```  \n  \n### Parameters  \n `pStream`  \n A pointer to an incoming stream.  \n  \n `grfMode`  \n Access mode to the stream.  \n  \n### Return Value  \n S_OK if the load is successful; otherwise an error code.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onnewdocument\"></a>  CDocument::OnNewDocument  \n Called by the framework as part of the File New command.  \n  \n```  \nvirtual BOOL OnNewDocument();\n```  \n  \n### Return Value  \n Nonzero if the document was successfully initialized; otherwise 0.  \n  \n### Remarks  \n The default implementation of this function calls the [DeleteContents](#cdocument__deletecontents) member function to ensure that the document is empty and then marks the new document as clean. Override this function to initialize the data structure for a new document. You should call the base class version of this function from your override.  \n  \n If the user chooses the File New command in an SDI application, the framework uses this function to reinitialize the existing document, rather than creating a new one. If the user chooses File New in a multiple document interface (MDI) application, the framework creates a new document each time and then calls this function to initialize it. You must place your initialization code in this function instead of in the constructor for the File New command to be effective in SDI applications.  \n  \n Note that there are cases where `OnNewDocument` is called twice. This occurs when the document is embedded as an ActiveX Document Server. The function is first called by the `CreateInstance` method (exposed by the `COleObjectFactory`-derived class) and a second time by the `InitNew` method (exposed by the `COleServerDoc`-derived class).  \n  \n### Example  \n The following examples illustrate alternative methods of initializing a document object.  \n  \n [!code-cpp[NVC_MFCDocView#60](../../mfc/codesnippet/cpp/cdocument-class_5.cpp)]  \n  \n [!code-cpp[NVC_MFCDocView#61](../../mfc/codesnippet/cpp/cdocument-class_6.cpp)]  \n  \n [!code-cpp[NVC_MFCDocView#62](../../mfc/codesnippet/cpp/cdocument-class_7.cpp)]  \n  \n##  <a name=\"cdocument__onopendocument\"></a>  CDocument::OnOpenDocument  \n Called by the framework as part of the File Open command.  \n  \n```  \nvirtual BOOL OnOpenDocument(LPCTSTR lpszPathName);\n```  \n  \n### Parameters  \n `lpszPathName`  \n Points to the path of the document to be opened.  \n  \n### Return Value  \n Nonzero if the document was successfully loaded; otherwise 0.  \n  \n### Remarks  \n The default implementation of this function opens the specified file, calls the [DeleteContents](#cdocument__deletecontents) member function to ensure that the document is empty, calls [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize) to read the file's contents, and then marks the document as clean. Override this function if you want to use something other than the archive mechanism or the file mechanism. For example, you might write an application where documents represent records in a database rather than separate files.  \n  \n If the user chooses the File Open command in an SDI application, the framework uses this function to reinitialize the existing **CDocument** object, rather than creating a new one. If the user chooses File Open in an MDI application, the framework constructs a new **CDocument** object each time and then calls this function to initialize it. You must place your initialization code in this function instead of in the constructor for the File Open command to be effective in SDI applications.  \n  \n### Example  \n The following examples illustrate alternative methods of initializing a document object.  \n  \n [!code-cpp[NVC_MFCDocView#60](../../mfc/codesnippet/cpp/cdocument-class_5.cpp)]  \n  \n [!code-cpp[NVC_MFCDocView#61](../../mfc/codesnippet/cpp/cdocument-class_6.cpp)]  \n  \n [!code-cpp[NVC_MFCDocView#62](../../mfc/codesnippet/cpp/cdocument-class_7.cpp)]  \n  \n [!code-cpp[NVC_MFCDocView#63](../../mfc/codesnippet/cpp/cdocument-class_8.cpp)]  \n  \n##  <a name=\"cdocument__onpreviewhandlerqueryfocus\"></a>  CDocument::OnPreviewHandlerQueryFocus  \n Directs the preview handler to return the HWND retrieved from calling the `GetFocus` function.  \n  \n```  \nvirtual HRESULT OnPreviewHandlerQueryFocus(HWND* phwnd);\n```  \n  \n### Parameters  \n `phwnd`  \n [out] When this method returns, contains a pointer to the HWND returned from calling the `GetFocus` function from the preview handler's foreground thread.  \n  \n### Return Value  \n Returns S_OK if successful; or an error value otherwise.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onpreviewhandlertranslateaccelerator\"></a>  CDocument::OnPreviewHandlerTranslateAccelerator  \n Directs the preview handler to handle a keystroke passed up from the message pump of the process in which the preview handler is running.  \n  \n```  \nvirtual HRESULT OnPreviewHandlerTranslateAccelerator(MSG* pmsg);\n```  \n  \n### Parameters  \n `pmsg`  \n [in] A pointer to a window message.  \n  \n### Return Value  \n If the keystroke message can be processed by the preview handler, the handler processes it and returns S_OK. If the preview handler cannot process the keystroke message, it offers it to the host via `IPreviewHandlerFrame::TranslateAccelerator`. If the host processes the message, this method returns S_OK. If the host does not process the message, this method returns S_FALSE.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onrichpreviewbackcolorchanged\"></a>  CDocument::OnRichPreviewBackColorChanged  \n Called when the Rich Preview background color has changed.  \n  \n```  \nvirtual void OnRichPreviewBackColorChanged();\n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onrichpreviewfontchanged\"></a>  CDocument::OnRichPreviewFontChanged  \n Called when the Rich Preview font has changed.  \n  \n```  \nvirtual void OnRichPreviewFontChanged();\n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onrichpreviewsitechanged\"></a>  CDocument::OnRichPreviewSiteChanged  \n Called when the Rich Preview site has changed.  \n  \n```  \nvirtual void OnRichPreviewSiteChanged();\n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onrichpreviewtextcolorchanged\"></a>  CDocument::OnRichPreviewTextColorChanged  \n Called when the Rich Preview text color has changed.  \n  \n```  \nvirtual void OnRichPreviewTextColorChanged();\n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onsavedocument\"></a>  CDocument::OnSaveDocument  \n Called by the framework as part of the File Save or File Save As command.  \n  \n```  \nvirtual BOOL OnSaveDocument(LPCTSTR lpszPathName);\n```  \n  \n### Parameters  \n `lpszPathName`  \n Points to the fully qualified path to which the file should be saved.  \n  \n### Return Value  \n Nonzero if the document was successfully saved; otherwise 0.  \n  \n### Remarks  \n The default implementation of this function opens the specified file, calls [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize) to write the document's data to the file, and then marks the document as clean. Override this function if you want to perform special processing when the framework saves a document. For example, you might write an application where documents represent records in a database rather than separate files.  \n  \n##  <a name=\"cdocument__onunloadhandler\"></a>  CDocument::OnUnloadHandler  \n Called by the framework when the preview handler is unloaded.  \n  \n```  \nvirtual void OnUnloadHandler();\n```  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__onupdatefilesendmail\"></a>  CDocument::OnUpdateFileSendMail  \n Enables the **ID_FILE_SEND_MAIL** command if mail support (MAPI) is present.  \n  \n```  \nvoid OnUpdateFileSendMail(CCmdUI* pCmdUI);\n```  \n  \n### Parameters  \n `pCmdUI`  \n A pointer to the [CCmdUI](../../mfc/reference/ccmdui-class.md) object associated with the **ID_FILE_SEND_MAIL** command.  \n  \n### Remarks  \n Otherwise the function removes the **ID_FILE_SEND_MAIL** command from the menu, including separators above or below the menu item as appropriate. MAPI is enabled if MAPI32.DLL is present in the path and, in the [Mail] section of the WIN.INI file, MAPI=1. Most applications put this command on the File menu.  \n  \n **CDocument** supports sending your document via mail if mail support (MAPI) is present. See the articles [MAPI Topics](../../mfc/mapi.md) and [MAPI Support in MFC](../../mfc/mapi-support-in-mfc.md).  \n  \n##  <a name=\"cdocument__precloseframe\"></a>  CDocument::PreCloseFrame  \n This member function is called by the framework before the frame window is destroyed.  \n  \n```  \nvirtual void PreCloseFrame(CFrameWnd* pFrame);\n```  \n  \n### Parameters  \n `pFrame`  \n Pointer to the [CFrameWnd](../../mfc/reference/cframewnd-class.md) that holds the associated **CDocument** object.  \n  \n### Remarks  \n It can be overridden to provide custom cleanup, but be sure to call the base class as well.  \n  \n The default of `PreCloseFrame` does nothing in **CDocument**. The **CDocument**-derived classes [COleDocument](../../mfc/reference/coledocument-class.md) and [CRichEditDoc](../../mfc/reference/cricheditdoc-class.md) use this member function.  \n  \n##  <a name=\"cdocument__readnextchunkvalue\"></a>  CDocument::ReadNextChunkValue  \n Reads the next chunk value.  \n  \n```  \nvirtual BOOL ReadNextChunkValue(IFilterChunkValue** ppValue);\n```  \n  \n### Parameters  \n `ppValue`  \n [out] When the function returns, `ppValue` contains the value that was read.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__releasefile\"></a>  CDocument::ReleaseFile  \n This member function is called by the framework to release a file, making it available for use by other applications.  \n  \n```  \nvirtual void ReleaseFile(\n    CFile* pFile,  \n    BOOL bAbort);\n```  \n  \n### Parameters  \n `pFile`  \n A pointer to the CFile object to be released.  \n  \n `bAbort`  \n Specifies whether the file is to be released by using either `CFile::Close` or `CFile::Abort`. **FALSE** if the file is to be released using [CFile::Close](../../mfc/reference/cfile-class.md#cfile__close); **TRUE** if the file is to be released using [CFile::Abort](../../mfc/reference/cfile-class.md#cfile__abort).  \n  \n### Remarks  \n If `bAbort` is **TRUE**, `ReleaseFile` calls `CFile::Abort`, and the file is released. `CFile::Abort` will not throw an exception.  \n  \n If `bAbort` is **FALSE**, `ReleaseFile` calls `CFile::Close` and the file is released.  \n  \n Override this member function to require an action by the user before the file is released.  \n  \n##  <a name=\"cdocument__removechunk\"></a>  CDocument::RemoveChunk  \n Removes a chunk with the specified GUID.  \n  \n```  \nvirtual void RemoveChunk(\n    REFCLSID guid,  \n    DWORD pid);\n```  \n  \n### Parameters  \n `Guid`  \n Specifies the GUID of a chunk to be removed.  \n  \n `Pid`  \n Specifies the PID of a chunk to be removed.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__removeview\"></a>  CDocument::RemoveView  \n Call this function to detach a view from a document.  \n  \n```  \nvoid RemoveView(CView* pView);\n```  \n  \n### Parameters  \n `pView`  \n Points to the view being removed.  \n  \n### Remarks  \n This function removes the specified view from the list of views associated with the document; it also sets the view's document pointer to **NULL**. This function is called by the framework when a frame window is closed or a pane of a splitter window is closed.  \n  \n Call this function only if you are manually detaching a view. Typically you will let the framework detach documents and views by defining a [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) object to associate a document class, view class, and frame window class.  \n  \n See the example at [AddView](#cdocument__addview) for a sample implementation.  \n  \n##  <a name=\"cdocument__reportsaveloadexception\"></a>  CDocument::ReportSaveLoadException  \n Called if an exception is thrown (typically a [CFileException](../../mfc/reference/cfileexception-class.md) or [CArchiveException](../../mfc/reference/carchiveexception-class.md)) while saving or loading the document.  \n  \n```  \nvirtual void ReportSaveLoadException(\n    LPCTSTR lpszPathName,  \n    CException* e,  \n    BOOL bSaving,  \n    UINT nIDPDefault);\n```  \n  \n### Parameters  \n `lpszPathName`  \n Points to name of document that was being saved or loaded.  \n  \n *e*  \n Points to the exception that was thrown. May be **NULL**.  \n  \n *bSaving*  \n Flag indicating what operation was in progress; nonzero if the document was being saved, 0 if the document was being loaded.  \n  \n `nIDPDefault`  \n Identifier of the error message to be displayed if the function does not specify a more specific one.  \n  \n### Remarks  \n The default implementation examines the exception object and looks for an error message that specifically describes the cause. If a specific message is not found or if *e* is **NULL**, the general message specified by the `nIDPDefault` parameter is used. The function then displays a message box containing the error message. Override this function if you want to provide additional, customized failure messages. This is an advanced overridable.  \n  \n##  <a name=\"cdocument__savemodified\"></a>  CDocument::SaveModified  \n Called by the framework before a modified document is to be closed.  \n  \n```  \nvirtual BOOL SaveModified();\n```  \n  \n### Return Value  \n Nonzero if it is safe to continue and close the document; 0 if the document should not be closed.  \n  \n### Remarks  \n The default implementation of this function displays a message box asking the user whether to save the changes to the document, if any have been made. Override this function if your program requires a different prompting procedure. This is an advanced overridable.  \n  \n##  <a name=\"cdocument__setchunkvalue\"></a>  CDocument::SetChunkValue  \n Sets a chunk value.  \n  \n```  \nvirtual BOOL SetChunkValue (IFilterChunkValue* pValue);\n```  \n  \n### Parameters  \n `pValue`  \n Specifies a chunk value to set.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n  \n##  <a name=\"cdocument__setmodifiedflag\"></a>  CDocument::SetModifiedFlag  \n Call this function after you have made any modifications to the document.  \n  \n```  \nvirtual void SetModifiedFlag(BOOL bModified = TRUE);\n```  \n  \n### Parameters  \n `bModified`  \n Flag indicating whether the document has been modified.  \n  \n### Remarks  \n By calling this function consistently, you ensure that the framework prompts the user to save changes before closing a document. Typically you should use the default value of **TRUE** for the `bModified` parameter. To mark a document as clean (unmodified), call this function with a value of **FALSE**.  \n  \n##  <a name=\"cdocument__setpathname\"></a>  CDocument::SetPathName  \n Call this function to specify the fully qualified path of the document's disk file.  \n  \n```  \nvirtual void SetPathName(\n    LPCTSTR lpszPathName,  \n    BOOL bAddToMRU = TRUE);\n```  \n  \n### Parameters  \n `lpszPathName`  \n Points to the string to be used as the path for the document.  \n  \n `bAddToMRU`  \n Determines whether the filename is added to the most recently used (MRU) file list. If **TRUE,** the filename is added; if **FALSE**, it is not added.  \n  \n### Remarks  \n Depending on the value of `bAddToMRU` the path is added, or not added, to the MRU list maintained by the application. Note that some documents are not associated with a disk file. Call this function only if you are overriding the default implementation for opening and saving files used by the framework.  \n  \n##  <a name=\"cdocument__settitle\"></a>  CDocument::SetTitle  \n Call this function to specify the document's title (the string displayed in the title bar of a frame window).  \n  \n```  \nvirtual void SetTitle(LPCTSTR lpszTitle);\n```  \n  \n### Parameters  \n `lpszTitle`  \n Points to the string to be used as the document's title.  \n  \n### Remarks  \n Calling this function updates the titles of all frame windows that display the document.  \n  \n##  <a name=\"cdocument__updateallviews\"></a>  CDocument::UpdateAllViews  \n Call this function after the document has been modified.  \n  \n```  \nvoid UpdateAllViews(\n    CView* pSender,  \n    LPARAM lHint = 0L,  \n    CObject* pHint = NULL);\n```  \n  \n### Parameters  \n `pSender`  \n Points to the view that modified the document, or **NULL** if all views are to be updated.  \n  \n `lHint`  \n Contains information about the modification.  \n  \n `pHint`  \n Points to an object storing information about the modification.  \n  \n### Remarks  \n You should call this function after you call the [SetModifiedFlag](#cdocument__setmodifiedflag) member function. This function informs each view attached to the document, except for the view specified by `pSender`, that the document has been modified. You typically call this function from your view class after the user has changed the document through a view.  \n  \n This function calls the [CView::OnUpdate](../../mfc/reference/cview-class.md#cview__onupdate) member function for each of the document's views except the sending view, passing `pHint` and `lHint`. Use these parameters to pass information to the views about the modifications made to the document. You can encode information using `lHint` and/or you can define a [CObject](../../mfc/reference/cobject-class.md)-derived class to store information about the modifications and pass an object of that class using `pHint`. Override the `CView::OnUpdate` member function in your [CView](../../mfc/reference/cview-class.md)-derived class to optimize the updating of the view's display based on the information passed.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#64](../../mfc/codesnippet/cpp/cdocument-class_9.cpp)]  \n  \n## See Also  \n [MFC Sample MDIDOCVW](../../visual-cpp-samples.md)   \n [MFC Sample SNAPVW](../../visual-cpp-samples.md)   \n [MFC Sample NPP](../../visual-cpp-samples.md)   \n [CCmdTarget Class](../../mfc/reference/ccmdtarget-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CCmdTarget Class](../../mfc/reference/ccmdtarget-class.md)   \n [CView Class](../../mfc/reference/cview-class.md)   \n [CDocTemplate Class](../../mfc/reference/cdoctemplate-class.md)\n"}