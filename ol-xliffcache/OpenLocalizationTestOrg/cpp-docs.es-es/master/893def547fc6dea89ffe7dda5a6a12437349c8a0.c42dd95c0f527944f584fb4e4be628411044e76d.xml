{"nodes":[{"pos":[12,55],"content":"IServiceProviderImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IServiceProviderImpl Class | Microsoft Docs","pos":[0,43]}]},{"pos":[819,845],"content":"IServiceProviderImpl Class","linkify":"IServiceProviderImpl Class","nodes":[{"content":"IServiceProviderImpl Class","pos":[0,26]}]},{"pos":[846,927],"content":"This class provides a default implementation of the <ph id=\"ph1\">`IServiceProvider`</ph> interface.","source":"This class provides a default implementation of the `IServiceProvider` interface."},{"pos":[936,942],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1055,1065],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Your class, derived from <ph id=\"ph1\">`IServiceProviderImpl`</ph>.","pos":[1076,1124],"source":" Your class, derived from `IServiceProviderImpl`."},{"pos":[1133,1140],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1150,1164],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1171,1175]},{"content":"Description","pos":[1176,1187]},{"pos":[1225,1298],"content":"<bpt id=\"p1\">[</bpt>IServiceProviderImpl::QueryService<ept id=\"p1\">](#iserviceproviderimpl__queryservice)</ept>","source":"[IServiceProviderImpl::QueryService](#iserviceproviderimpl__queryservice)"},{"content":"Creates or accesses the specified service and returns an interface pointer to the specified interface for the service.","pos":[1299,1417]},{"pos":[1427,1434],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`IServiceProvider`</ph> interface locates a service specified by its GUID and returns the interface pointer for the requested interface on the service.","pos":[1438,1588],"source":"The `IServiceProvider` interface locates a service specified by its GUID and returns the interface pointer for the requested interface on the service."},{"content":"Class <ph id=\"ph1\">`IServiceProviderImpl`</ph> provides a default implementation of this interface.","pos":[1589,1670],"source":" Class `IServiceProviderImpl` provides a default implementation of this interface."},{"pos":[1677,1901],"content":"<bpt id=\"p1\">**</bpt>IServiceProviderImpl<ept id=\"p1\">**</ept> specifies one method: <bpt id=\"p2\">[</bpt>QueryService<ept id=\"p2\">](#iserviceproviderimpl__queryservice)</ept>, which creates or accesses the specified service and returns an interface pointer to the specified interface for the service.","source":"**IServiceProviderImpl** specifies one method: [QueryService](#iserviceproviderimpl__queryservice), which creates or accesses the specified service and returns an interface pointer to the specified interface for the service."},{"pos":[1908,2163],"content":"<ph id=\"ph1\">`IServiceProviderImpl`</ph> uses a service map, starting with <bpt id=\"p1\">[</bpt>BEGIN_SERVICE_MAP<ept id=\"p1\">](http://msdn.microsoft.com/library/3c6ae156-8776-4588-8227-2d234daec236)</ept> and ending with <bpt id=\"p2\">[</bpt>END_SERVICE_MAP<ept id=\"p2\">](http://msdn.microsoft.com/library/9a35d02a-014c-413a-bb0b-bcca11ab45a6)</ept>.","source":"`IServiceProviderImpl` uses a service map, starting with [BEGIN_SERVICE_MAP](http://msdn.microsoft.com/library/3c6ae156-8776-4588-8227-2d234daec236) and ending with [END_SERVICE_MAP](http://msdn.microsoft.com/library/9a35d02a-014c-413a-bb0b-bcca11ab45a6)."},{"pos":[2170,2520],"content":"The service map contains two entries: <bpt id=\"p1\">[</bpt>SERVICE_ENTRY<ept id=\"p1\">](http://msdn.microsoft.com/library/e65ff9cc-15e8-41cf-b686-f99eb6686ca9)</ept>, which indicates a specified service id (SID) supported by the object, and <bpt id=\"p2\">[</bpt>SERVICE_ENTRY_CHAIN<ept id=\"p2\">](http://msdn.microsoft.com/library/09be4ce4-3ccd-4ff2-a95e-a9d5275354c1)</ept>, which calls <ph id=\"ph1\">`QueryService`</ph> to chain to another object.","source":"The service map contains two entries: [SERVICE_ENTRY](http://msdn.microsoft.com/library/e65ff9cc-15e8-41cf-b686-f99eb6686ca9), which indicates a specified service id (SID) supported by the object, and [SERVICE_ENTRY_CHAIN](http://msdn.microsoft.com/library/09be4ce4-3ccd-4ff2-a95e-a9d5275354c1), which calls `QueryService` to chain to another object."},{"pos":[2529,2550],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2610,2622],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2626,2646],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[2656,2741],"content":"<bpt id=\"p1\">&lt;a name=\"iserviceproviderimpl__queryservice\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IServiceProviderImpl::QueryService","linkify":"<a name=\"iserviceproviderimpl__queryservice\"></a>  IServiceProviderImpl::QueryService","source":"<a name=\"iserviceproviderimpl__queryservice\"></a>  IServiceProviderImpl::QueryService"},{"content":"Creates or accesses the specified service and returns an interface pointer to the specified interface for the service.","pos":[2745,2863]},{"pos":[2971,2981],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[IN] <ph id=\"ph1\">`guidService`</ph>","pos":[2985,3003],"source":"[IN] `guidService`"},{"content":"Pointer to a service identifier (SID).","pos":[3007,3045]},{"content":"[IN] <ph id=\"ph1\">`riid`</ph>","pos":[3052,3063],"source":"[IN] `riid`"},{"content":"Identifier of the interface to which the caller is to gain access.","pos":[3067,3133]},{"content":"[OUT] <ph id=\"ph1\">`ppvObj`</ph>","pos":[3140,3154],"source":"[OUT] `ppvObj`"},{"content":"Indirect pointer to the requested interface.","pos":[3158,3202]},{"pos":[3212,3224],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[3228,3281],"content":"The returned <ph id=\"ph1\">`HRESULT`</ph> value is one of the following:","source":"The returned `HRESULT` value is one of the following:"},{"content":"Return value","pos":[3288,3300]},{"content":"Meaning","pos":[3301,3308]},{"content":"S_OK","pos":[3350,3354]},{"content":"The service was successfully created or retrieved.","pos":[3355,3405]},{"content":"E_INVALIDARG","pos":[3410,3422]},{"content":"One or more of the arguments is invalid.","pos":[3423,3463]},{"content":"E_OUTOFMEMORY","pos":[3468,3481]},{"content":"Memory is insufficient to create the service.","pos":[3482,3527]},{"content":"E_UNEXPECTED","pos":[3532,3544]},{"content":"An unknown error occurred.","pos":[3545,3571]},{"content":"E_NOINTERFACE","pos":[3576,3589]},{"content":"The requested interface is not part of this service, or the service is unknown.","pos":[3590,3669]},{"pos":[3680,3687],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`QueryService`</ph> returns an indirect pointer to the requested interface in the specified service.","pos":[3691,3786],"source":"`QueryService` returns an indirect pointer to the requested interface in the specified service."},{"content":"The caller is responsible for releasing this pointer when it is no longer required.","pos":[3787,3870]},{"content":"When you call <ph id=\"ph1\">`QueryService`</ph>, you pass both a service identifier ( <ph id=\"ph2\">`guidService`</ph>) and an interface identifier ( <ph id=\"ph3\">`riid`</ph>).","pos":[3877,3997],"source":"When you call `QueryService`, you pass both a service identifier ( `guidService`) and an interface identifier ( `riid`)."},{"content":"The <ph id=\"ph1\">`guidService`</ph> specifies the service to which you want access, and the <ph id=\"ph2\">`riid`</ph> identifies an interface that is part of the service.","pos":[3998,4131],"source":" The `guidService` specifies the service to which you want access, and the `riid` identifies an interface that is part of the service."},{"content":"In return, you receive an indirect pointer to the interface.","pos":[4132,4192]},{"content":"The object that implements the interface might also implement interfaces that are part of other services.","pos":[4199,4304]},{"content":"Consider the following:","pos":[4305,4328]},{"content":"Some of these interfaces might be optional.","pos":[4338,4381]},{"content":"Not all interfaces defined in the service description are necessarily present on every implementation of the service or on every returned object.","pos":[4382,4527]},{"pos":[4537,4701],"content":"Unlike calls to <ph id=\"ph1\">`QueryInterface`</ph>, passing a different service identifier does not necessarily mean that a different Component Object Model (COM) object is returned.","source":"Unlike calls to `QueryInterface`, passing a different service identifier does not necessarily mean that a different Component Object Model (COM) object is returned."},{"content":"The returned object might have additional interfaces that are not part of the definition of the service.","pos":[4711,4815]},{"content":"Two different services, such as SID_SMyService and SID_SYourService, can both specify the use of the same interface, even though the implementation of the interface might have nothing in common between the two services.","pos":[4822,5041]},{"content":"This works, because a call to <ph id=\"ph1\">`QueryService`</ph> (SID_SMyService, IID_IDispatch) can return a different object than <ph id=\"ph2\">`QueryService`</ph> (SID_SYourService, IID_IDispatch).","pos":[5042,5203],"source":" This works, because a call to `QueryService` (SID_SMyService, IID_IDispatch) can return a different object than `QueryService` (SID_SYourService, IID_IDispatch)."},{"content":"Object identity is not assumed when you specify a different service identifier.","pos":[5204,5283]},{"pos":[5292,5300],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[5304,5353],"content":"<bpt id=\"p1\">[</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","source":"[Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"IServiceProviderImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::IServiceProviderImpl<T>\"\n  - \"ATL.IServiceProviderImpl<T>\"\n  - \"ATL.IServiceProviderImpl\"\n  - \"ATL::IServiceProviderImpl\"\n  - \"IServiceProviderImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IServiceProviderImpl class\"\n  - \"IServiceProvider interface, ATL implementation\"\nms.assetid: 251254d3-c4ce-40d7-aee0-3d676d1d72f2\ncaps.latest.revision: 22\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IServiceProviderImpl Class\nThis class provides a default implementation of the `IServiceProvider` interface.  \n  \n## Syntax  \n  \n```\ntemplate <class T>   class ATL_NO_VTABLE IServiceProviderImpl :  public IServiceProvider\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `IServiceProviderImpl`.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IServiceProviderImpl::QueryService](#iserviceproviderimpl__queryservice)|Creates or accesses the specified service and returns an interface pointer to the specified interface for the service.|  \n  \n## Remarks  \n The `IServiceProvider` interface locates a service specified by its GUID and returns the interface pointer for the requested interface on the service. Class `IServiceProviderImpl` provides a default implementation of this interface.  \n  \n **IServiceProviderImpl** specifies one method: [QueryService](#iserviceproviderimpl__queryservice), which creates or accesses the specified service and returns an interface pointer to the specified interface for the service.  \n  \n `IServiceProviderImpl` uses a service map, starting with [BEGIN_SERVICE_MAP](http://msdn.microsoft.com/library/3c6ae156-8776-4588-8227-2d234daec236) and ending with [END_SERVICE_MAP](http://msdn.microsoft.com/library/9a35d02a-014c-413a-bb0b-bcca11ab45a6).  \n  \n The service map contains two entries: [SERVICE_ENTRY](http://msdn.microsoft.com/library/e65ff9cc-15e8-41cf-b686-f99eb6686ca9), which indicates a specified service id (SID) supported by the object, and [SERVICE_ENTRY_CHAIN](http://msdn.microsoft.com/library/09be4ce4-3ccd-4ff2-a95e-a9d5275354c1), which calls `QueryService` to chain to another object.  \n  \n## Inheritance Hierarchy  \n `IServiceProvider`  \n  \n `IServiceProviderImpl`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"iserviceproviderimpl__queryservice\"></a>  IServiceProviderImpl::QueryService  \n Creates or accesses the specified service and returns an interface pointer to the specified interface for the service.  \n  \n```\nSTDMETHOD(QueryService)(REFGUID guidService,\n    REFIID riid,\n    void** ppvObject);\n```  \n  \n### Parameters  \n [IN] `guidService`  \n Pointer to a service identifier (SID).  \n  \n [IN] `riid`  \n Identifier of the interface to which the caller is to gain access.  \n  \n [OUT] `ppvObj`  \n Indirect pointer to the requested interface.  \n  \n### Return Value  \n The returned `HRESULT` value is one of the following:  \n  \n|Return value|Meaning|  \n|------------------|-------------|  \n|S_OK|The service was successfully created or retrieved.|  \n|E_INVALIDARG|One or more of the arguments is invalid.|  \n|E_OUTOFMEMORY|Memory is insufficient to create the service.|  \n|E_UNEXPECTED|An unknown error occurred.|  \n|E_NOINTERFACE|The requested interface is not part of this service, or the service is unknown.|  \n  \n### Remarks  \n `QueryService` returns an indirect pointer to the requested interface in the specified service. The caller is responsible for releasing this pointer when it is no longer required.  \n  \n When you call `QueryService`, you pass both a service identifier ( `guidService`) and an interface identifier ( `riid`). The `guidService` specifies the service to which you want access, and the `riid` identifies an interface that is part of the service. In return, you receive an indirect pointer to the interface.  \n  \n The object that implements the interface might also implement interfaces that are part of other services. Consider the following:  \n  \n-   Some of these interfaces might be optional. Not all interfaces defined in the service description are necessarily present on every implementation of the service or on every returned object.  \n  \n-   Unlike calls to `QueryInterface`, passing a different service identifier does not necessarily mean that a different Component Object Model (COM) object is returned.  \n  \n-   The returned object might have additional interfaces that are not part of the definition of the service.  \n  \n Two different services, such as SID_SMyService and SID_SYourService, can both specify the use of the same interface, even though the implementation of the interface might have nothing in common between the two services. This works, because a call to `QueryService` (SID_SMyService, IID_IDispatch) can return a different object than `QueryService` (SID_SYourService, IID_IDispatch). Object identity is not assumed when you specify a different service identifier.  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}