{"nodes":[{"pos":[12,74],"content":"MFC ActiveX Controls: Adding Stock Properties | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Adding Stock Properties | Microsoft Docs","pos":[0,62]}]},{"content":"MFC ActiveX Controls: Adding Stock Properties","pos":[769,814]},{"content":"Stock properties differ from custom properties in that they are already implemented by the class <ph id=\"ph1\">`COleControl`</ph>.","pos":[815,926],"source":"Stock properties differ from custom properties in that they are already implemented by the class `COleControl`."},{"content":"contains predefined member functions that support common properties for the control.","pos":[941,1025]},{"content":"Some common properties include the control's caption and the foreground and background colors.","pos":[1026,1120]},{"content":"For information on other stock properties, see <bpt id=\"p1\">[</bpt>Stock Properties Supported by the Add Property Wizard<ept id=\"p1\">](#_core_stock_properties_supported_by_classwizard)</ept> later in this article.","pos":[1121,1296],"source":" For information on other stock properties, see [Stock Properties Supported by the Add Property Wizard](#_core_stock_properties_supported_by_classwizard) later in this article."},{"content":"The dispatch map entries for stock properties are always prefixed by <bpt id=\"p1\">**</bpt>DISP_STOCKPROP<ept id=\"p1\">**</ept>.","pos":[1297,1385],"source":" The dispatch map entries for stock properties are always prefixed by **DISP_STOCKPROP**."},{"content":"This article describes how to add a stock property (in this case, Caption) to an ActiveX control using the Add Property Wizard and explains the resulting code modifications.","pos":[1392,1565]},{"content":"Topics include:","pos":[1566,1581]},{"content":"Using the Add Property Wizard to add a stock property","pos":[1592,1645]},{"content":"Add Property Wizard changes for stock properties","pos":[1707,1755]},{"content":"Stock properties supported by the Add Property Wizard","pos":[1816,1869]},{"content":"Stock properties and notification","pos":[1931,1964]},{"content":"Color properties","pos":[2018,2034]},{"pos":[2072,2387],"content":"[!NOTE]\n Visual Basic custom controls typically have properties such as Top, Left, Width, Height, Align, Tag, Name, TabIndex, TabStop, and Parent. ActiveX control containers, however, are responsible for implementing these control properties and therefore ActiveX controls should not support these properties.","leadings":["","    > "],"nodes":[{"content":" Visual Basic custom controls typically have properties such as Top, Left, Width, Height, Align, Tag, Name, TabIndex, TabStop, and Parent. ActiveX control containers, however, are responsible for implementing these control properties and therefore ActiveX controls should not support these properties.","pos":[8,309],"nodes":[{"content":"Visual Basic custom controls typically have properties such as Top, Left, Width, Height, Align, Tag, Name, TabIndex, TabStop, and Parent.","pos":[1,138]},{"content":"ActiveX control containers, however, are responsible for implementing these control properties and therefore ActiveX controls should not support these properties.","pos":[139,301]}]}]},{"pos":[2460,2513],"content":"Using the Add Property Wizard to Add a Stock Property"},{"content":"Adding stock properties requires less code than adding custom properties because support for the property is handled automatically by <ph id=\"ph1\">`COleControl`</ph>.","pos":[2517,2665],"source":"Adding stock properties requires less code than adding custom properties because support for the property is handled automatically by `COleControl`."},{"content":"The following procedure demonstrates adding the stock Caption property to an ActiveX control framework and can also be used to add other stock properties.","pos":[2666,2820]},{"content":"Substitute the selected stock property name for Caption.","pos":[2821,2877]},{"content":"To add the stock Caption property using the Add Property Wizard","pos":[2888,2951]},{"content":"Load your control's project.","pos":[2961,2989]},{"content":"In Class View, expand the library node of your control.","pos":[2999,3054]},{"content":"Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.","pos":[3064,3176]},{"pos":[3186,3256],"content":"From the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Property<ept id=\"p2\">**</ept>.","source":"From the shortcut menu, click **Add** and then click **Add Property**."},{"pos":[3267,3341],"content":"This opens the <bpt id=\"p1\">[</bpt>Add Property Wizard<ept id=\"p1\">](../ide/names-add-property-wizard.md)</ept>.","source":"This opens the [Add Property Wizard](../ide/names-add-property-wizard.md)."},{"pos":[3351,3399],"content":"In the <bpt id=\"p1\">**</bpt>Property Name<ept id=\"p1\">**</ept> box, click <bpt id=\"p2\">**</bpt>Caption<ept id=\"p2\">**</ept>.","source":"In the **Property Name** box, click **Caption**."},{"pos":[3409,3426],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Click **Finish**."},{"pos":[3498,3546],"content":"Add Property Wizard Changes for Stock Properties"},{"content":"Because <ph id=\"ph1\">`COleControl`</ph> supports stock properties, the Add Property Wizard does not change the class declaration in any way; it adds the property to the dispatch map.","pos":[3550,3714],"source":"Because `COleControl` supports stock properties, the Add Property Wizard does not change the class declaration in any way; it adds the property to the dispatch map."},{"content":"The Add Property Wizard adds the following line to the dispatch map of the control, which is located in the implementation (.CPP) file:","pos":[3715,3850]},{"pos":[3868,3883],"content":"NVC_MFC_AxUI#22"},{"content":"The following line is added to your control's interface description (.IDL) file:","pos":[3967,4047]},{"pos":[4065,4080],"content":"NVC_MFC_AxUI#23"},{"content":"This line assigns the Caption property a specific ID.","pos":[4164,4217]},{"content":"Notice that the property is bindable and will request permission from the database before modifying the value.","pos":[4218,4328]},{"content":"This makes the Caption property available to users of your control.","pos":[4335,4402]},{"content":"To use the value of a stock property, access a member variable or member function of the <ph id=\"ph1\">`COleControl`</ph> base class.","pos":[4403,4517],"source":" To use the value of a stock property, access a member variable or member function of the `COleControl` base class."},{"content":"For more information on these member variables and member functions, see the next section, Stock Properties Supported by the Add Property Wizard.","pos":[4518,4663]},{"pos":[4736,4789],"content":"Stock Properties Supported by the Add Property Wizard"},{"content":"The <ph id=\"ph1\">`COleControl`</ph> class provides nine stock properties.","pos":[4793,4848],"source":"The `COleControl` class provides nine stock properties."},{"content":"You can add the properties you want by using the Add Property Wizard.","pos":[4849,4918]},{"content":"Property","pos":[4925,4933]},{"content":"Dispatch map entry","pos":[4934,4952]},{"content":"How to access value","pos":[4953,4972]},{"content":"Appearance","pos":[5049,5059]},{"content":"DISP_STOCKPROP_APPEARANCE( )","pos":[5064,5092]},{"pos":[5095,5133],"content":"Value accessible as <bpt id=\"p1\">**</bpt>m_sAppearance<ept id=\"p1\">**</ept>.","source":"Value accessible as **m_sAppearance**."},{"content":"DISP_STOCKPROP_BACKCOLOR( )","pos":[5152,5179]},{"pos":[5182,5225],"content":"Value accessible by calling <ph id=\"ph1\">`GetBackColor`</ph>.","source":"Value accessible by calling `GetBackColor`."},{"content":"DISP_STOCKPROP_BORDERSTYLE( )","pos":[5246,5275]},{"pos":[5278,5317],"content":"Value accessible as <bpt id=\"p1\">**</bpt>m_sBorderStyle<ept id=\"p1\">**</ept>.","source":"Value accessible as **m_sBorderStyle**."},{"content":"Caption","pos":[5324,5331]},{"content":"DISP_STOCKPROP_CAPTION( )","pos":[5336,5361]},{"pos":[5364,5410],"content":"Value accessible by calling <ph id=\"ph1\">`InternalGetText`</ph>.","source":"Value accessible by calling `InternalGetText`."},{"content":"Enabled","pos":[5417,5424]},{"content":"DISP_STOCKPROP_ENABLED( )","pos":[5429,5454]},{"pos":[5457,5492],"content":"Value accessible as <bpt id=\"p1\">**</bpt>m_bEnabled<ept id=\"p1\">**</ept>.","source":"Value accessible as **m_bEnabled**."},{"content":"Font","pos":[5499,5503]},{"content":"DISP_STOCKPROP_FONT( )","pos":[5508,5530]},{"pos":[5533,5639],"content":"See the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Using Fonts<ept id=\"p1\">](../mfc/mfc-activex-controls-using-fonts.md)</ept> for usage.","source":"See the article [MFC ActiveX Controls: Using Fonts](../mfc/mfc-activex-controls-using-fonts.md) for usage."},{"content":"DISP_STOCKPROP_FORECOLOR( )","pos":[5658,5685]},{"pos":[5688,5731],"content":"Value accessible by calling <ph id=\"ph1\">`GetForeColor`</ph>.","source":"Value accessible by calling `GetForeColor`."},{"content":"hWnd","pos":[5738,5742]},{"content":"DISP_STOCKPROP_HWND( )","pos":[5747,5769]},{"pos":[5772,5801],"content":"Value accessible as <ph id=\"ph1\">`m_hWnd`</ph>.","source":"Value accessible as `m_hWnd`."},{"content":"Text","pos":[5808,5812]},{"content":"DISP_STOCKPROP_TEXT( )","pos":[5817,5839]},{"content":"Value accessible by calling <ph id=\"ph1\">`InternalGetText`</ph>.","pos":[5842,5888],"source":"Value accessible by calling `InternalGetText`."},{"content":"This property is the same as <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept>, except for the property name.","pos":[5889,5960],"source":" This property is the same as **Caption**, except for the property name."},{"content":"ReadyState","pos":[5967,5977]},{"content":"DISP_STOCKPROP_READYSTATE()","pos":[5982,6009]},{"pos":[6012,6048],"content":"Value accessible as m_lReadyState or"},{"pos":[6130,6163],"content":"Stock Properties and Notification"},{"content":"Most stock properties have notification functions that can be overridden.","pos":[6167,6240]},{"content":"For example, whenever the <ph id=\"ph1\">`BackColor`</ph> property is changed, the <ph id=\"ph2\">`OnBackColorChanged`</ph> function (a member function of the control class) is called.","pos":[6241,6385],"source":" For example, whenever the `BackColor` property is changed, the `OnBackColorChanged` function (a member function of the control class) is called."},{"content":"The default implementation (in <ph id=\"ph1\">`COleControl`</ph>) calls <ph id=\"ph2\">`InvalidateControl`</ph>.","pos":[6386,6458],"source":" The default implementation (in `COleControl`) calls `InvalidateControl`."},{"content":"Override this function if you want to take additional actions in response to this situation.","pos":[6459,6551]},{"pos":[6599,6615],"content":"Color Properties"},{"content":"You can use the stock <ph id=\"ph1\">`ForeColor`</ph> and <ph id=\"ph2\">`BackColor`</ph> properties, or your own custom color properties, when painting the control.","pos":[6619,6744],"source":"You can use the stock `ForeColor` and `BackColor` properties, or your own custom color properties, when painting the control."},{"content":"To use a color property, call the <bpt id=\"p1\">[</bpt>COleControl::TranslateColor<ept id=\"p1\">](../mfc/reference/colecontrol-class.md#colecontrol__translatecolor)</ept> member function.","pos":[6745,6892],"source":" To use a color property, call the [COleControl::TranslateColor](../mfc/reference/colecontrol-class.md#colecontrol__translatecolor) member function."},{"content":"The parameters of this function are the value of the color property and an optional palette handle.","pos":[6893,6992]},{"content":"The return value is a <bpt id=\"p1\">**</bpt>COLORREF<ept id=\"p1\">**</ept> value that can be passed to GDI functions, such as <ph id=\"ph1\">`SetTextColor`</ph> and <ph id=\"ph2\">`CreateSolidBrush`</ph>.","pos":[6993,7117],"source":" The return value is a **COLORREF** value that can be passed to GDI functions, such as `SetTextColor` and `CreateSolidBrush`."},{"pos":[7124,7289],"content":"The color values for the stock <ph id=\"ph1\">`ForeColor`</ph> and <ph id=\"ph2\">`BackColor`</ph> properties are accessed by calling either the <ph id=\"ph3\">`GetForeColor`</ph> or the <ph id=\"ph4\">`GetBackColor`</ph> function, respectively.","source":"The color values for the stock `ForeColor` and `BackColor` properties are accessed by calling either the `GetForeColor` or the `GetBackColor` function, respectively."},{"content":"The following example demonstrates using these two color properties when painting a control.","pos":[7296,7388]},{"content":"It initializes a temporary <bpt id=\"p1\">**</bpt>COLORREF<ept id=\"p1\">**</ept> variable and a <ph id=\"ph1\">`CBrush`</ph> object with calls to <ph id=\"ph2\">`TranslateColor`</ph>: one using the <ph id=\"ph3\">`ForeColor`</ph> property and the other using the <ph id=\"ph4\">`BackColor`</ph> property.","pos":[7389,7572],"source":" It initializes a temporary **COLORREF** variable and a `CBrush` object with calls to `TranslateColor`: one using the `ForeColor` property and the other using the `BackColor` property."},{"content":"A temporary <ph id=\"ph1\">`CBrush`</ph> object is then used to paint the control's rectangle, and the text color is set using the <ph id=\"ph2\">`ForeColor`</ph> property.","pos":[7573,7705],"source":" A temporary `CBrush` object is then used to paint the control's rectangle, and the text color is set using the `ForeColor` property."},{"pos":[7723,7738],"content":"NVC_MFC_AxUI#24"},{"content":"See Also","pos":[7824,7832]},{"content":"MFC ActiveX Controls","pos":[7837,7857]},{"content":"MFC ActiveX Controls: Properties","pos":[7896,7928]},{"content":"MFC ActiveX Controls: Methods","pos":[7978,8007]},{"content":"COleControl Class","pos":[8054,8071]}],"content":"---\ntitle: \"MFC ActiveX Controls: Adding Stock Properties | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"BackColor property\"\n  - \"properties [MFC], adding stock\"\n  - \"ForeColor property\"\n  - \"MFC ActiveX controls, properties\"\n  - \"foreground colors, ActiveX controls\"\n  - \"foreground colors\"\nms.assetid: 8b98c8c5-5b69-4366-87bf-0e61e6668ecb\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Adding Stock Properties\nStock properties differ from custom properties in that they are already implemented by the class `COleControl`. `COleControl` contains predefined member functions that support common properties for the control. Some common properties include the control's caption and the foreground and background colors. For information on other stock properties, see [Stock Properties Supported by the Add Property Wizard](#_core_stock_properties_supported_by_classwizard) later in this article. The dispatch map entries for stock properties are always prefixed by **DISP_STOCKPROP**.  \n  \n This article describes how to add a stock property (in this case, Caption) to an ActiveX control using the Add Property Wizard and explains the resulting code modifications. Topics include:  \n  \n-   [Using the Add Property Wizard to add a stock property](#_core_using_classwizard_to_add_a_stock_property)  \n  \n-   [Add Property Wizard changes for stock properties](#_core_classwizard_changes_for_stock_properties)  \n  \n-   [Stock properties supported by the Add Property Wizard](#_core_stock_properties_supported_by_classwizard)  \n  \n-   [Stock properties and notification](#_core_stock_properties_and_notification)  \n  \n-   [Color properties](#_core_color_properties)  \n  \n    > [!NOTE]\n    >  Visual Basic custom controls typically have properties such as Top, Left, Width, Height, Align, Tag, Name, TabIndex, TabStop, and Parent. ActiveX control containers, however, are responsible for implementing these control properties and therefore ActiveX controls should not support these properties.  \n  \n##  <a name=\"_core_using_classwizard_to_add_a_stock_property\"></a> Using the Add Property Wizard to Add a Stock Property  \n Adding stock properties requires less code than adding custom properties because support for the property is handled automatically by `COleControl`. The following procedure demonstrates adding the stock Caption property to an ActiveX control framework and can also be used to add other stock properties. Substitute the selected stock property name for Caption.  \n  \n#### To add the stock Caption property using the Add Property Wizard  \n  \n1.  Load your control's project.  \n  \n2.  In Class View, expand the library node of your control.  \n  \n3.  Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.  \n  \n4.  From the shortcut menu, click **Add** and then click **Add Property**.  \n  \n     This opens the [Add Property Wizard](../ide/names-add-property-wizard.md).  \n  \n5.  In the **Property Name** box, click **Caption**.  \n  \n6.  Click **Finish**.  \n  \n##  <a name=\"_core_classwizard_changes_for_stock_properties\"></a> Add Property Wizard Changes for Stock Properties  \n Because `COleControl` supports stock properties, the Add Property Wizard does not change the class declaration in any way; it adds the property to the dispatch map. The Add Property Wizard adds the following line to the dispatch map of the control, which is located in the implementation (.CPP) file:  \n  \n [!code-cpp[NVC_MFC_AxUI#22](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-properties_1.cpp)]  \n  \n The following line is added to your control's interface description (.IDL) file:  \n  \n [!code-cpp[NVC_MFC_AxUI#23](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-properties_2.idl)]  \n  \n This line assigns the Caption property a specific ID. Notice that the property is bindable and will request permission from the database before modifying the value.  \n  \n This makes the Caption property available to users of your control. To use the value of a stock property, access a member variable or member function of the `COleControl` base class. For more information on these member variables and member functions, see the next section, Stock Properties Supported by the Add Property Wizard.  \n  \n##  <a name=\"_core_stock_properties_supported_by_classwizard\"></a> Stock Properties Supported by the Add Property Wizard  \n The `COleControl` class provides nine stock properties. You can add the properties you want by using the Add Property Wizard.  \n  \n|Property|Dispatch map entry|How to access value|  \n|--------------|------------------------|-------------------------|  \n|**Appearance**|**DISP_STOCKPROP_APPEARANCE( )**|Value accessible as **m_sAppearance**.|  \n|`BackColor`|**DISP_STOCKPROP_BACKCOLOR( )**|Value accessible by calling `GetBackColor`.|  \n|`BorderStyle`|**DISP_STOCKPROP_BORDERSTYLE( )**|Value accessible as **m_sBorderStyle**.|  \n|**Caption**|**DISP_STOCKPROP_CAPTION( )**|Value accessible by calling `InternalGetText`.|  \n|**Enabled**|**DISP_STOCKPROP_ENABLED( )**|Value accessible as **m_bEnabled**.|  \n|**Font**|**DISP_STOCKPROP_FONT( )**|See the article [MFC ActiveX Controls: Using Fonts](../mfc/mfc-activex-controls-using-fonts.md) for usage.|  \n|`ForeColor`|**DISP_STOCKPROP_FORECOLOR( )**|Value accessible by calling `GetForeColor`.|  \n|**hWnd**|**DISP_STOCKPROP_HWND( )**|Value accessible as `m_hWnd`.|  \n|**Text**|**DISP_STOCKPROP_TEXT( )**|Value accessible by calling `InternalGetText`. This property is the same as **Caption**, except for the property name.|  \n|**ReadyState**|**DISP_STOCKPROP_READYSTATE()**|Value accessible as m_lReadyState or `GetReadyState`|  \n  \n##  <a name=\"_core_stock_properties_and_notification\"></a> Stock Properties and Notification  \n Most stock properties have notification functions that can be overridden. For example, whenever the `BackColor` property is changed, the `OnBackColorChanged` function (a member function of the control class) is called. The default implementation (in `COleControl`) calls `InvalidateControl`. Override this function if you want to take additional actions in response to this situation.  \n  \n##  <a name=\"_core_color_properties\"></a> Color Properties  \n You can use the stock `ForeColor` and `BackColor` properties, or your own custom color properties, when painting the control. To use a color property, call the [COleControl::TranslateColor](../mfc/reference/colecontrol-class.md#colecontrol__translatecolor) member function. The parameters of this function are the value of the color property and an optional palette handle. The return value is a **COLORREF** value that can be passed to GDI functions, such as `SetTextColor` and `CreateSolidBrush`.  \n  \n The color values for the stock `ForeColor` and `BackColor` properties are accessed by calling either the `GetForeColor` or the `GetBackColor` function, respectively.  \n  \n The following example demonstrates using these two color properties when painting a control. It initializes a temporary **COLORREF** variable and a `CBrush` object with calls to `TranslateColor`: one using the `ForeColor` property and the other using the `BackColor` property. A temporary `CBrush` object is then used to paint the control's rectangle, and the text color is set using the `ForeColor` property.  \n  \n [!code-cpp[NVC_MFC_AxUI#24](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-properties_3.cpp)]  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)   \n [MFC ActiveX Controls: Properties](../mfc/mfc-activex-controls-properties.md)   \n [MFC ActiveX Controls: Methods](../mfc/mfc-activex-controls-methods.md)   \n [COleControl Class](../mfc/reference/colecontrol-class.md)\n"}