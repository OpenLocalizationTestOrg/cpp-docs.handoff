{"nodes":[{"pos":[12,59],"content":"Recordset: Architecture (ODBC) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Recordset: Architecture (ODBC) | Microsoft Docs","pos":[0,47]}]},{"content":"Recordset: Architecture (ODBC)","pos":[912,942]},{"content":"This topic applies to the MFC ODBC classes.","pos":[943,986]},{"content":"This topic describes the data members that comprise the architecture of a recordset object:","pos":[993,1084]},{"content":"Field data members","pos":[1095,1113]},{"content":"Parameter data members","pos":[1152,1174]},{"content":"Using m_nFields and m_nParams data members","pos":[1217,1259]},{"pos":[1306,1632],"content":"[!NOTE]\n This topic applies to objects derived from `CRecordset` in which bulk row fetching has not been implemented. If bulk row fetching is implemented, the architecture is similar. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","leadings":["","> "],"nodes":[{"content":" This topic applies to objects derived from `CRecordset` in which bulk row fetching has not been implemented. If bulk row fetching is implemented, the architecture is similar. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","pos":[8,324],"nodes":[{"content":"This topic applies to objects derived from <ph id=\"ph1\">`CRecordset`</ph> in which bulk row fetching has not been implemented.","pos":[1,109],"source":" This topic applies to objects derived from `CRecordset` in which bulk row fetching has not been implemented."},{"content":"If bulk row fetching is implemented, the architecture is similar.","pos":[110,175]},{"content":"To understand the differences, see <bpt id=\"p1\">[</bpt>Recordset: Fetching Records in Bulk (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)</ept>.","pos":[176,316],"source":" To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)."}]}]},{"pos":[1678,1690],"content":"Sample Class"},{"pos":[1694,1954],"content":"When you use the <bpt id=\"p1\">[</bpt>MFC ODBC Consumer Wizard<ept id=\"p1\">](../../mfc/reference/adding-an-mfc-odbc-consumer.md)</ept> from <bpt id=\"p2\">**</bpt>Add Class<ept id=\"p2\">**</ept> wizard to declare a recordset class derived from <ph id=\"ph1\">`CRecordset`</ph>, the resulting class has the general structure shown in the following simple class:","source":"When you use the [MFC ODBC Consumer Wizard](../../mfc/reference/adding-an-mfc-odbc-consumer.md) from **Add Class** wizard to declare a recordset class derived from `CRecordset`, the resulting class has the general structure shown in the following simple class:"},{"content":"At the beginning of the class, the wizard writes a set of <bpt id=\"p1\">[</bpt>field data members<ept id=\"p1\">](#_core_field_data_members)</ept>.","pos":[2169,2275],"source":"At the beginning of the class, the wizard writes a set of [field data members](#_core_field_data_members)."},{"content":"When you create the class, you must specify one or more field data members.","pos":[2276,2351]},{"content":"If the class is parameterized, as the sample class is (with the data member <ph id=\"ph1\">`m_strIDParam`</ph>), you must manually add <bpt id=\"p1\">[</bpt>parameter data members<ept id=\"p1\">](#_core_parameter_data_members)</ept>.","pos":[2352,2523],"source":" If the class is parameterized, as the sample class is (with the data member `m_strIDParam`), you must manually add [parameter data members](#_core_parameter_data_members)."},{"content":"The wizard does not support adding parameters to a class.","pos":[2524,2581]},{"pos":[2631,2649],"content":"Field Data Members"},{"content":"The most important members of your recordset class are the field data members.","pos":[2653,2731]},{"content":"For each column you select from the data source, the class contains a data member of the appropriate data type for that column.","pos":[2732,2859]},{"content":"For example, the <bpt id=\"p1\">[</bpt>sample class<ept id=\"p1\">](#_core_a_sample_class)</ept> shown at the beginning of this topic has two field data members, both of type <ph id=\"ph1\">`CString`</ph>, called <ph id=\"ph2\">`m_strCourseID`</ph> and <ph id=\"ph3\">`m_strCourseTitle`</ph>.","pos":[2860,3050],"source":" For example, the [sample class](#_core_a_sample_class) shown at the beginning of this topic has two field data members, both of type `CString`, called `m_strCourseID` and `m_strCourseTitle`."},{"content":"When the recordset selects a set of records, the framework automatically binds the columns of the current record (after the <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> call, the first record is current) to the field data members of the object.","pos":[3057,3265],"source":"When the recordset selects a set of records, the framework automatically binds the columns of the current record (after the **Open** call, the first record is current) to the field data members of the object."},{"content":"That is, the framework uses the appropriate field data member as a buffer in which to store the contents of a record column.","pos":[3266,3390]},{"content":"As the user scrolls to a new record, the framework uses the field data members to represent the current record.","pos":[3397,3508]},{"content":"The framework refreshes the field data members, replacing the previous record's values.","pos":[3509,3596]},{"content":"The field data members are also used for updating the current record and for adding new records.","pos":[3597,3693]},{"content":"As part of the process of updating a record, you specify the update values by assigning values directly to the appropriate field data member or members.","pos":[3694,3846]},{"pos":[3900,3922],"content":"Parameter Data Members"},{"content":"If the class is parameterized, it has one or more parameter data members.","pos":[3926,3999]},{"content":"A parameterized class lets you base a recordset query on information obtained or calculated at run time.","pos":[4000,4104]},{"content":"Typically, the parameter helps narrow the selection, as in the following example.","pos":[4111,4192]},{"content":"Based on the <bpt id=\"p1\">[</bpt>sample class<ept id=\"p1\">](#_core_a_sample_class)</ept> at the beginning of this topic, the recordset object might execute the following SQL statement:","pos":[4193,4339],"source":" Based on the [sample class](#_core_a_sample_class) at the beginning of this topic, the recordset object might execute the following SQL statement:"},{"content":"The \"?\" is a placeholder for a parameter value that you supply at run time.","pos":[4423,4498]},{"content":"When you construct the recordset and set its <ph id=\"ph1\">`m_strIDParam`</ph> data member to MATH101, the effective SQL statement for the recordset becomes:","pos":[4499,4637],"source":" When you construct the recordset and set its `m_strIDParam` data member to MATH101, the effective SQL statement for the recordset becomes:"},{"content":"By defining parameter data members, you tell the framework about parameters in the SQL string.","pos":[4727,4821]},{"content":"The framework binds the parameter, which lets ODBC know where to get values to substitute for the placeholder.","pos":[4822,4932]},{"content":"In the example, the resulting recordset contains only the record from the Course table with a CourseID column whose value is MATH101.","pos":[4933,5066]},{"content":"All specified columns of this record are selected.","pos":[5067,5117]},{"content":"You can specify as many parameters (and placeholders) as you need.","pos":[5118,5184]},{"pos":[5192,5425],"content":"[!NOTE]\n MFC does nothing itself with the parameters — in particular, it does not perform a text substitution. Instead, MFC tells ODBC where to get the parameter; ODBC retrieves the data and performs the necessary parameterization.","leadings":["","> "],"nodes":[{"content":" MFC does nothing itself with the parameters — in particular, it does not perform a text substitution. Instead, MFC tells ODBC where to get the parameter; ODBC retrieves the data and performs the necessary parameterization.","pos":[8,231],"nodes":[{"content":"MFC does nothing itself with the parameters — in particular, it does not perform a text substitution.","pos":[1,102]},{"content":"Instead, MFC tells ODBC where to get the parameter; ODBC retrieves the data and performs the necessary parameterization.","pos":[103,223]}]}]},{"pos":[5433,5661],"content":"[!NOTE]\n The order of parameters is important. For information about this and more information about parameters, see [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).","leadings":["","> "],"nodes":[{"content":" The order of parameters is important. For information about this and more information about parameters, see [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).","pos":[8,226],"nodes":[{"content":"The order of parameters is important.","pos":[1,38]},{"content":"For information about this and more information about parameters, see <bpt id=\"p1\">[</bpt>Recordset: Parameterizing a Recordset (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)</ept>.","pos":[39,218],"source":" For information about this and more information about parameters, see [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)."}]}]},{"pos":[5722,5751],"content":"Using m_nFields and m_nParams"},{"content":"When a wizard writes a constructor for your class, it also initializes the <bpt id=\"p1\">[</bpt>m_nFields<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__m_nfields)</ept> data member, which specifies the number of <bpt id=\"p2\">[</bpt>field data members<ept id=\"p2\">](#_core_field_data_members)</ept> in the class.","pos":[5756,6010],"source":"When a wizard writes a constructor for your class, it also initializes the [m_nFields](../../mfc/reference/crecordset-class.md#crecordset__m_nfields) data member, which specifies the number of [field data members](#_core_field_data_members) in the class."},{"content":"If you add any <bpt id=\"p1\">[</bpt>parameters<ept id=\"p1\">](#_core_parameter_data_members)</ept> to your class, you must also add an initialization for the <bpt id=\"p2\">[</bpt>m_nParams<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__m_nparams)</ept> data member, which specifies the number of parameter data members.","pos":[6011,6270],"source":" If you add any [parameters](#_core_parameter_data_members) to your class, you must also add an initialization for the [m_nParams](../../mfc/reference/crecordset-class.md#crecordset__m_nparams) data member, which specifies the number of parameter data members."},{"content":"The framework uses these values to work with the data members.","pos":[6271,6333]},{"pos":[6340,6466],"content":"For more information and examples, see <bpt id=\"p1\">[</bpt>Record Field Exchange: Using RFX<ept id=\"p1\">](../../data/odbc/record-field-exchange-using-rfx.md)</ept>.","source":"For more information and examples, see [Record Field Exchange: Using RFX](../../data/odbc/record-field-exchange-using-rfx.md)."},{"content":"See Also","pos":[6475,6483]},{"content":"Recordset (ODBC)","pos":[6488,6504]},{"content":"Recordset: Declaring a Class for a Table (ODBC)","pos":[6546,6593]},{"content":"Record Field Exchange (RFX)","pos":[6665,6692]}],"content":"---\ntitle: \"Recordset: Architecture (ODBC) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"recordsets, data members\"\n  - \"field data members, recordset architecture\"\n  - \"field data members\"\n  - \"m_nParams data member, recordsets\"\n  - \"recordsets, architecture\"\n  - \"parameter data members in recordsets\"\n  - \"m_nFields data member\"\n  - \"ODBC recordsets, architecture\"\n  - \"m_nParams data member\"\n  - \"m_nFields data member, recordsets\"\nms.assetid: 47555ddb-11be-4b9e-9b9a-f2931764d298\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Recordset: Architecture (ODBC)\nThis topic applies to the MFC ODBC classes.  \n  \n This topic describes the data members that comprise the architecture of a recordset object:  \n  \n-   [Field data members](#_core_field_data_members)  \n  \n-   [Parameter data members](#_core_parameter_data_members)  \n  \n-   [Using m_nFields and m_nParams data members](#_core_using_m_nfields_and_m_nparams)  \n  \n> [!NOTE]\n>  This topic applies to objects derived from `CRecordset` in which bulk row fetching has not been implemented. If bulk row fetching is implemented, the architecture is similar. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).  \n  \n##  <a name=\"_core_a_sample_class\"></a> Sample Class  \n When you use the [MFC ODBC Consumer Wizard](../../mfc/reference/adding-an-mfc-odbc-consumer.md) from **Add Class** wizard to declare a recordset class derived from `CRecordset`, the resulting class has the general structure shown in the following simple class:  \n  \n```  \nclass CCourse : public CRecordset  \n{  \npublic:  \n   CCourse(CDatabase* pDatabase = NULL);  \n   ...  \n   CString m_strCourseID;  \n   CString m_strCourseTitle;  \n   CString m_strIDParam;  \n};  \n```  \n  \n At the beginning of the class, the wizard writes a set of [field data members](#_core_field_data_members). When you create the class, you must specify one or more field data members. If the class is parameterized, as the sample class is (with the data member `m_strIDParam`), you must manually add [parameter data members](#_core_parameter_data_members). The wizard does not support adding parameters to a class.  \n  \n##  <a name=\"_core_field_data_members\"></a> Field Data Members  \n The most important members of your recordset class are the field data members. For each column you select from the data source, the class contains a data member of the appropriate data type for that column. For example, the [sample class](#_core_a_sample_class) shown at the beginning of this topic has two field data members, both of type `CString`, called `m_strCourseID` and `m_strCourseTitle`.  \n  \n When the recordset selects a set of records, the framework automatically binds the columns of the current record (after the **Open** call, the first record is current) to the field data members of the object. That is, the framework uses the appropriate field data member as a buffer in which to store the contents of a record column.  \n  \n As the user scrolls to a new record, the framework uses the field data members to represent the current record. The framework refreshes the field data members, replacing the previous record's values. The field data members are also used for updating the current record and for adding new records. As part of the process of updating a record, you specify the update values by assigning values directly to the appropriate field data member or members.  \n  \n##  <a name=\"_core_parameter_data_members\"></a> Parameter Data Members  \n If the class is parameterized, it has one or more parameter data members. A parameterized class lets you base a recordset query on information obtained or calculated at run time.  \n  \n Typically, the parameter helps narrow the selection, as in the following example. Based on the [sample class](#_core_a_sample_class) at the beginning of this topic, the recordset object might execute the following SQL statement:  \n  \n```  \nSELECT CourseID, CourseTitle FROM Course WHERE CourseID = ?  \n```  \n  \n The \"?\" is a placeholder for a parameter value that you supply at run time. When you construct the recordset and set its `m_strIDParam` data member to MATH101, the effective SQL statement for the recordset becomes:  \n  \n```  \nSELECT CourseID, CourseTitle FROM Course WHERE CourseID = MATH101  \n```  \n  \n By defining parameter data members, you tell the framework about parameters in the SQL string. The framework binds the parameter, which lets ODBC know where to get values to substitute for the placeholder. In the example, the resulting recordset contains only the record from the Course table with a CourseID column whose value is MATH101. All specified columns of this record are selected. You can specify as many parameters (and placeholders) as you need.  \n  \n> [!NOTE]\n>  MFC does nothing itself with the parameters — in particular, it does not perform a text substitution. Instead, MFC tells ODBC where to get the parameter; ODBC retrieves the data and performs the necessary parameterization.  \n  \n> [!NOTE]\n>  The order of parameters is important. For information about this and more information about parameters, see [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).  \n  \n##  <a name=\"_core_using_m_nfields_and_m_nparams\"></a> Using m_nFields and m_nParams  \n\n When a wizard writes a constructor for your class, it also initializes the [m_nFields](../../mfc/reference/crecordset-class.md#crecordset__m_nfields) data member, which specifies the number of [field data members](#_core_field_data_members) in the class. If you add any [parameters](#_core_parameter_data_members) to your class, you must also add an initialization for the [m_nParams](../../mfc/reference/crecordset-class.md#crecordset__m_nparams) data member, which specifies the number of parameter data members. The framework uses these values to work with the data members.  \n  \n For more information and examples, see [Record Field Exchange: Using RFX](../../data/odbc/record-field-exchange-using-rfx.md).  \n  \n## See Also  \n [Recordset (ODBC)](../../data/odbc/recordset-odbc.md)   \n [Recordset: Declaring a Class for a Table (ODBC)](../../data/odbc/recordset-declaring-a-class-for-a-table-odbc.md)   \n [Record Field Exchange (RFX)](../../data/odbc/record-field-exchange-rfx.md)"}