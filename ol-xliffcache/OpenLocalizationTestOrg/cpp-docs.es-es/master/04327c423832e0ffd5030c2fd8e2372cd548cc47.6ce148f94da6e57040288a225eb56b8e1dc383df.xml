{"nodes":[{"pos":[12,75],"content":"CString Operations Relating to C-Style Strings | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CString Operations Relating to C-Style Strings | Microsoft Docs","pos":[0,63]}]},{"content":"CString Operations Relating to C-Style Strings","pos":[1006,1052]},{"content":"A <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../atl-mfc-shared/using-cstring.md)</ept> object contains character string data.","pos":[1053,1139],"source":"A [CString](../atl-mfc-shared/using-cstring.md) object contains character string data."},{"content":"inherits the set of the <bpt id=\"p1\">[</bpt>methods and operators<ept id=\"p1\">](../atl-mfc-shared/reference/cstringt-class.md)</ept> that are defined in the class template <bpt id=\"p2\">[</bpt>CStringT<ept id=\"p2\">](../atl-mfc-shared/reference/cstringt-class.md)</ept> to work with string data.","pos":[1150,1367],"source":" inherits the set of the [methods and operators](../atl-mfc-shared/reference/cstringt-class.md) that are defined in the class template [CStringT](../atl-mfc-shared/reference/cstringt-class.md) to work with string data."},{"content":"(<ph id=\"ph1\">`CString`</ph> is a <ph id=\"ph2\">`typedef`</ph> that specializes <ph id=\"ph3\">`CStringT`</ph> to work with the kind of character data that <ph id=\"ph4\">`CString`</ph> supports.)","pos":[1368,1487],"source":" (`CString` is a `typedef` that specializes `CStringT` to work with the kind of character data that `CString` supports.)"},{"content":"does not store character data internally as a C-style null-terminated string.","pos":[1504,1581]},{"content":"Instead, <ph id=\"ph1\">`CString`</ph> tracks the length of character data so that it can more securely watch the data and the space it requires.","pos":[1582,1707],"source":" Instead, `CString` tracks the length of character data so that it can more securely watch the data and the space it requires."},{"content":"does accept C-style strings, and provides ways to access character data as a C-style string.","pos":[1724,1816]},{"content":"This topic contains the following sections that explain how to use a <ph id=\"ph1\">`CString`</ph> object as if it were a C-style null-terminated string.","pos":[1817,1950],"source":" This topic contains the following sections that explain how to use a `CString` object as if it were a C-style null-terminated string."},{"content":"Converting to C-style null-terminated strings","pos":[1959,2004]},{"content":"Working with standard run-time library string functions","pos":[2078,2133]},{"content":"Modifying CString contents directly","pos":[2210,2245]},{"content":"Using CString objects with variable argument functions","pos":[2299,2353]},{"content":"Specifying CString formal parameters","pos":[2426,2462]},{"pos":[2595,2644],"content":"Using CString as a C-Style Null-Terminated String"},{"content":"To use a <ph id=\"ph1\">`CString`</ph> object as a C-style string, cast the object to <ph id=\"ph2\">`LPCTSTR`</ph>.","pos":[2648,2724],"source":"To use a `CString` object as a C-style string, cast the object to `LPCTSTR`."},{"content":"In the following example, the <ph id=\"ph1\">`CString`</ph> returns a pointer to a read-only C-style null-terminated string.","pos":[2725,2829],"source":" In the following example, the `CString` returns a pointer to a read-only C-style null-terminated string."},{"content":"The <ph id=\"ph1\">`strcpy`</ph> function puts a copy of the C-style string in the variable <ph id=\"ph2\">`myString`</ph>.","pos":[2830,2913],"source":" The `strcpy` function puts a copy of the C-style string in the variable `myString`."},{"content":"You can use <ph id=\"ph1\">`CString`</ph> methods, for example, <ph id=\"ph2\">`SetAt`</ph>, to modify individual characters in the string object.","pos":[3027,3133],"source":"You can use `CString` methods, for example, `SetAt`, to modify individual characters in the string object."},{"content":"However, the <ph id=\"ph1\">`LPCTSTR`</ph> pointer is temporary and becomes invalid when any change is made to <ph id=\"ph2\">`CString`</ph>.","pos":[3134,3235],"source":" However, the `LPCTSTR` pointer is temporary and becomes invalid when any change is made to `CString`."},{"content":"The <ph id=\"ph1\">`CString`</ph> can also go out of scope and be automatically deleted.","pos":[3236,3304],"source":" The `CString` can also go out of scope and be automatically deleted."},{"content":"We recommend that you get a fresh <ph id=\"ph1\">`LPCTSTR`</ph> pointer of a <ph id=\"ph2\">`CString`</ph> object every time that you use one.","pos":[3305,3407],"source":" We recommend that you get a fresh `LPCTSTR` pointer of a `CString` object every time that you use one."},{"content":"Sometimes you may require a copy of <ph id=\"ph1\">`CString`</ph> data to modify directly.","pos":[3414,3484],"source":"Sometimes you may require a copy of `CString` data to modify directly."},{"content":"Use the more secured function <ph id=\"ph1\">`strcpy_s`</ph> (or the Unicode/MBCS-portable <ph id=\"ph2\">`_tcscpy_s`</ph>) to copy the <ph id=\"ph3\">`CString`</ph> object into a separate buffer.","pos":[3485,3621],"source":" Use the more secured function `strcpy_s` (or the Unicode/MBCS-portable `_tcscpy_s`) to copy the `CString` object into a separate buffer."},{"content":"This is where characters can be safely modified, as shown by the following example.","pos":[3622,3705]},{"pos":[3723,3747],"content":"NVC_ATLMFC_Utilities#189"},{"pos":[3845,4302],"content":"[!NOTE]\n The third argument to `strcpy_s` (or the Unicode/MBCS-portable `_tcscpy_s`) is either a `const``wchar_t*` (Unicode) or a `const``char*` (ANSI). The example above passes a `CString` for this argument. The C++ compiler automatically applies the conversion function defined for the `CString` class that converts a `CString` to an `LPCTSTR`. The ability to define casting operations from one type to another is one of the most useful features of C++.","leadings":["","> "],"nodes":[{"content":" The third argument to `strcpy_s` (or the Unicode/MBCS-portable `_tcscpy_s`) is either a `const``wchar_t*` (Unicode) or a `const``char*` (ANSI). The example above passes a `CString` for this argument. The C++ compiler automatically applies the conversion function defined for the `CString` class that converts a `CString` to an `LPCTSTR`. The ability to define casting operations from one type to another is one of the most useful features of C++.","pos":[8,455],"nodes":[{"content":"The third argument to <ph id=\"ph1\">`strcpy_s`</ph> (or the Unicode/MBCS-portable <ph id=\"ph2\">`_tcscpy_s`</ph>) is either a <ph id=\"ph3\">`const``wchar_t*`</ph> (Unicode) or a <ph id=\"ph4\">`const``char*`</ph> (ANSI).","pos":[1,144],"source":" The third argument to `strcpy_s` (or the Unicode/MBCS-portable `_tcscpy_s`) is either a `const``wchar_t*` (Unicode) or a `const``char*` (ANSI)."},{"content":"The example above passes a <ph id=\"ph1\">`CString`</ph> for this argument.","pos":[145,200],"source":" The example above passes a `CString` for this argument."},{"content":"The C++ compiler automatically applies the conversion function defined for the <ph id=\"ph1\">`CString`</ph> class that converts a <ph id=\"ph2\">`CString`</ph> to an <ph id=\"ph3\">`LPCTSTR`</ph>.","pos":[201,338],"source":" The C++ compiler automatically applies the conversion function defined for the `CString` class that converts a `CString` to an `LPCTSTR`."},{"content":"The ability to define casting operations from one type to another is one of the most useful features of C++.","pos":[339,447]}]}]},{"pos":[4392,4447],"content":"Working with Standard Run-Time Library String Functions"},{"pos":[4451,4671],"content":"You should be able to find a <ph id=\"ph1\">`CString`</ph> method to perform any string operation for which you might consider using the standard C run-time library string functions such as <ph id=\"ph2\">`strcmp`</ph> (or the Unicode/MBCS-portable <ph id=\"ph3\">`_tcscmp`</ph>).","source":"You should be able to find a `CString` method to perform any string operation for which you might consider using the standard C run-time library string functions such as `strcmp` (or the Unicode/MBCS-portable `_tcscmp`)."},{"content":"If you must use the C run-time string functions, you can use the techniques described in _core_using_cstring_as_a_c.2d.style_null.2d.terminated_string.","pos":[4678,4829]},{"content":"You can copy the <ph id=\"ph1\">`CString`</ph> object to an equivalent C-style string buffer, perform your operations on the buffer, and then assign the resulting C-style string back to a <ph id=\"ph2\">`CString`</ph> object.","pos":[4830,5015],"source":" You can copy the `CString` object to an equivalent C-style string buffer, perform your operations on the buffer, and then assign the resulting C-style string back to a `CString` object."},{"pos":[5082,5117],"content":"Modifying CString Contents Directly"},{"pos":[5121,5286],"content":"In most situations, you should use <ph id=\"ph1\">`CString`</ph> member functions to modify the contents of a <ph id=\"ph2\">`CString`</ph> object or to convert the <ph id=\"ph3\">`CString`</ph> to a C-style character string.","source":"In most situations, you should use `CString` member functions to modify the contents of a `CString` object or to convert the `CString` to a C-style character string."},{"pos":[5293,5474],"content":"There are some situations where it makes sense to directly modify the <ph id=\"ph1\">`CString`</ph> contents, for example, when you work with operating-system functions that require a character buffer.","source":"There are some situations where it makes sense to directly modify the `CString` contents, for example, when you work with operating-system functions that require a character buffer."},{"content":"The <ph id=\"ph1\">`GetBuffer`</ph> and <ph id=\"ph2\">`ReleaseBuffer`</ph> methods offer access to the internal character buffer of a <ph id=\"ph3\">`CString`</ph> object and let you modify it directly.","pos":[5481,5624],"source":"The `GetBuffer` and `ReleaseBuffer` methods offer access to the internal character buffer of a `CString` object and let you modify it directly."},{"content":"The following steps show how to use these functions for this purpose.","pos":[5625,5694]},{"content":"To use GetBuffer and ReleaseBuffer to access the internal character buffer of a CString object","pos":[5705,5799]},{"pos":[5809,5898],"content":"Call <ph id=\"ph1\">`GetBuffer`</ph> for a <ph id=\"ph2\">`CString`</ph> object and specify the length of the buffer you require.","source":"Call `GetBuffer` for a `CString` object and specify the length of the buffer you require."},{"pos":[5908,6003],"content":"Use the pointer returned by <ph id=\"ph1\">`GetBuffer`</ph> to write characters directly into the <ph id=\"ph2\">`CString`</ph> object.","source":"Use the pointer returned by `GetBuffer` to write characters directly into the `CString` object."},{"content":"Call <ph id=\"ph1\">`ReleaseBuffer`</ph> for the <ph id=\"ph2\">`CString`</ph> object to update all the internal <ph id=\"ph3\">`CString`</ph> state information, for example, the length of the string.","pos":[6013,6153],"source":"Call `ReleaseBuffer` for the `CString` object to update all the internal `CString` state information, for example, the length of the string."},{"content":"After you modify the contents of a <ph id=\"ph1\">`CString`</ph> object directly, you must call <ph id=\"ph2\">`ReleaseBuffer`</ph> before you call any other <ph id=\"ph3\">`CString`</ph> member functions.","pos":[6154,6299],"source":" After you modify the contents of a `CString` object directly, you must call `ReleaseBuffer` before you call any other `CString` member functions."},{"pos":[6385,6439],"content":"Using CString Objects with Variable Argument Functions"},{"content":"Some C functions take a variable number of arguments.","pos":[6443,6496]},{"content":"A notable example is <ph id=\"ph1\">`printf_s`</ph>.","pos":[6497,6529],"source":" A notable example is `printf_s`."},{"content":"Because of the way this kind of function is declared, the compiler cannot be sure of the type of the arguments and cannot determine which conversion operation to perform on each argument.","pos":[6530,6717]},{"content":"Therefore, it is essential that you use an explicit type cast when passing a <ph id=\"ph1\">`CString`</ph> object to a function that takes a variable number of arguments.","pos":[6718,6868],"source":" Therefore, it is essential that you use an explicit type cast when passing a `CString` object to a function that takes a variable number of arguments."},{"pos":[6875,7022],"content":"To use a <ph id=\"ph1\">`CString`</ph> object in a variable argument function, explicitly cast the <ph id=\"ph2\">`CString`</ph> to an <ph id=\"ph3\">`LPCTSTR`</ph> string, as shown in the following example.","source":"To use a `CString` object in a variable argument function, explicitly cast the `CString` to an `LPCTSTR` string, as shown in the following example."},{"pos":[7040,7064],"content":"NVC_ATLMFC_Utilities#190"},{"pos":[7222,7258],"content":"Specifying CString Formal Parameters"},{"content":"For most functions that need a string argument, it is best to specify the formal parameter in the function prototype as a <ph id=\"ph1\">`const`</ph> pointer to a character (<ph id=\"ph2\">`LPCTSTR`</ph>) instead of a <ph id=\"ph3\">`CString`</ph>.","pos":[7262,7450],"source":"For most functions that need a string argument, it is best to specify the formal parameter in the function prototype as a `const` pointer to a character (`LPCTSTR`) instead of a `CString`."},{"content":"When a formal parameter is specified as a <ph id=\"ph1\">`const`</ph> pointer to a character, you can pass either a pointer to a <ph id=\"ph2\">`TCHAR`</ph> array, a literal string [<ph id=\"ph3\">`\"hi there\"`</ph>], or a <ph id=\"ph4\">`CString`</ph> object.","pos":[7451,7630],"source":" When a formal parameter is specified as a `const` pointer to a character, you can pass either a pointer to a `TCHAR` array, a literal string [`\"hi there\"`], or a `CString` object."},{"content":"The <ph id=\"ph1\">`CString`</ph> object will be automatically converted to an <ph id=\"ph2\">`LPCTSTR`</ph>.","pos":[7631,7700],"source":" The `CString` object will be automatically converted to an `LPCTSTR`."},{"content":"Any place you can use an <ph id=\"ph1\">`LPCTSTR`</ph>, you can also use a <ph id=\"ph2\">`CString`</ph> object.","pos":[7701,7773],"source":" Any place you can use an `LPCTSTR`, you can also use a `CString` object."},{"content":"You can also specify a formal parameter as a constant string reference (that is, <ph id=\"ph1\">`const``CString&amp;`</ph>) if the argument will not be modified.","pos":[7780,7917],"source":"You can also specify a formal parameter as a constant string reference (that is, `const``CString&`) if the argument will not be modified."},{"content":"Drop the <ph id=\"ph1\">`const`</ph> modifier if the string will be modified by the function.","pos":[7918,7991],"source":" Drop the `const` modifier if the string will be modified by the function."},{"content":"If a default null value is desired, initialize it to the null string [<ph id=\"ph1\">`\"\"`</ph>], as shown below:","pos":[7992,8084],"source":" If a default null value is desired, initialize it to the null string [`\"\"`], as shown below:"},{"pos":[8102,8126],"content":"NVC_ATLMFC_Utilities#191"},{"pos":[8223,8300],"content":"For most function results, you can simply return a <ph id=\"ph1\">`CString`</ph> object by value.","source":"For most function results, you can simply return a `CString` object by value."},{"content":"See Also","pos":[8309,8317]},{"content":"Strings (ATL/MFC)","pos":[8322,8339]},{"content":"CString Argument Passing","pos":[8384,8408]}],"content":"---\ntitle: \"CString Operations Relating to C-Style Strings | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CString objects, basic operations\"\n  - \"MFC [C++], string handling class\"\n  - \"string conversion [C++], C-style strings\"\n  - \"strings [C++], string operations\"\n  - \"standard run-time library string functions\"\n  - \"null values, Null-terminated string conversion\"\n  - \"string functions\"\n  - \"strings [C++], in C\"\n  - \"string arguments\"\n  - \"C-style strings\"\n  - \"strings [C++], class CString\"\n  - \"casting CString objects\"\nms.assetid: 5048de8a-5298-4891-b8a0-c554b5a3ac1b\ncaps.latest.revision: 17\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CString Operations Relating to C-Style Strings\nA [CString](../atl-mfc-shared/using-cstring.md) object contains character string data. `CString` inherits the set of the [methods and operators](../atl-mfc-shared/reference/cstringt-class.md) that are defined in the class template [CStringT](../atl-mfc-shared/reference/cstringt-class.md) to work with string data. (`CString` is a `typedef` that specializes `CStringT` to work with the kind of character data that `CString` supports.)  \n  \n `CString` does not store character data internally as a C-style null-terminated string. Instead, `CString` tracks the length of character data so that it can more securely watch the data and the space it requires.  \n  \n `CString` does accept C-style strings, and provides ways to access character data as a C-style string. This topic contains the following sections that explain how to use a `CString` object as if it were a C-style null-terminated string.  \n  \n- [Converting to C-style null-terminated strings](#_core_using_cstring_as_a_c.2d.style_null.2d.terminated_string)  \n  \n- [Working with standard run-time library string functions](#_core_working_with_standard_run.2d.time_library_string_functions)  \n  \n- [Modifying CString contents directly](#_core_modifying_cstring_contents_directly)  \n  \n- [Using CString objects with variable argument functions](#_core_using_cstring_objects_with_variable_argument_functions)  \n  \n- [Specifying CString formal parameters](#_core_specifying_cstring_formal_parameters)  \n  \n##  <a name=\"_core_using_cstring_as_a_c.2d.style_null.2d.terminated_string\"></a> Using CString as a C-Style Null-Terminated String  \n To use a `CString` object as a C-style string, cast the object to `LPCTSTR`. In the following example, the `CString` returns a pointer to a read-only C-style null-terminated string. The `strcpy` function puts a copy of the C-style string in the variable `myString`.  \n  \n```  \nCString aCString = \"A string\";  \nchar myString[256];  \nstrcpy(myString, (LPCTSTR)aCString);\n```  \n  \n You can use `CString` methods, for example, `SetAt`, to modify individual characters in the string object. However, the `LPCTSTR` pointer is temporary and becomes invalid when any change is made to `CString`. The `CString` can also go out of scope and be automatically deleted. We recommend that you get a fresh `LPCTSTR` pointer of a `CString` object every time that you use one.  \n  \n Sometimes you may require a copy of `CString` data to modify directly. Use the more secured function `strcpy_s` (or the Unicode/MBCS-portable `_tcscpy_s`) to copy the `CString` object into a separate buffer. This is where characters can be safely modified, as shown by the following example.  \n  \n [!code-cpp[NVC_ATLMFC_Utilities#189](../atl-mfc-shared/codesnippet/cpp/cstring-operations-relating-to-c-style-strings_1.cpp)]  \n  \n> [!NOTE]\n>  The third argument to `strcpy_s` (or the Unicode/MBCS-portable `_tcscpy_s`) is either a `const``wchar_t*` (Unicode) or a `const``char*` (ANSI). The example above passes a `CString` for this argument. The C++ compiler automatically applies the conversion function defined for the `CString` class that converts a `CString` to an `LPCTSTR`. The ability to define casting operations from one type to another is one of the most useful features of C++.  \n  \n##  <a name=\"_core_working_with_standard_run.2d.time_library_string_functions\"></a> Working with Standard Run-Time Library String Functions  \n You should be able to find a `CString` method to perform any string operation for which you might consider using the standard C run-time library string functions such as `strcmp` (or the Unicode/MBCS-portable `_tcscmp`).  \n  \n If you must use the C run-time string functions, you can use the techniques described in _core_using_cstring_as_a_c.2d.style_null.2d.terminated_string. You can copy the `CString` object to an equivalent C-style string buffer, perform your operations on the buffer, and then assign the resulting C-style string back to a `CString` object.  \n  \n##  <a name=\"_core_modifying_cstring_contents_directly\"></a> Modifying CString Contents Directly  \n In most situations, you should use `CString` member functions to modify the contents of a `CString` object or to convert the `CString` to a C-style character string.  \n  \n There are some situations where it makes sense to directly modify the `CString` contents, for example, when you work with operating-system functions that require a character buffer.  \n  \n The `GetBuffer` and `ReleaseBuffer` methods offer access to the internal character buffer of a `CString` object and let you modify it directly. The following steps show how to use these functions for this purpose.  \n  \n#### To use GetBuffer and ReleaseBuffer to access the internal character buffer of a CString object  \n  \n1.  Call `GetBuffer` for a `CString` object and specify the length of the buffer you require.  \n  \n2.  Use the pointer returned by `GetBuffer` to write characters directly into the `CString` object.  \n  \n3.  Call `ReleaseBuffer` for the `CString` object to update all the internal `CString` state information, for example, the length of the string. After you modify the contents of a `CString` object directly, you must call `ReleaseBuffer` before you call any other `CString` member functions.  \n  \n##  <a name=\"_core_using_cstring_objects_with_variable_argument_functions\"></a> Using CString Objects with Variable Argument Functions  \n Some C functions take a variable number of arguments. A notable example is `printf_s`. Because of the way this kind of function is declared, the compiler cannot be sure of the type of the arguments and cannot determine which conversion operation to perform on each argument. Therefore, it is essential that you use an explicit type cast when passing a `CString` object to a function that takes a variable number of arguments.  \n  \n To use a `CString` object in a variable argument function, explicitly cast the `CString` to an `LPCTSTR` string, as shown in the following example.  \n  \n [!code-cpp[NVC_ATLMFC_Utilities#190](../atl-mfc-shared/codesnippet/cpp/cstring-operations-relating-to-c-style-strings_2.cpp)]  \n  \n##  <a name=\"_core_specifying_cstring_formal_parameters\"></a> Specifying CString Formal Parameters  \n For most functions that need a string argument, it is best to specify the formal parameter in the function prototype as a `const` pointer to a character (`LPCTSTR`) instead of a `CString`. When a formal parameter is specified as a `const` pointer to a character, you can pass either a pointer to a `TCHAR` array, a literal string [`\"hi there\"`], or a `CString` object. The `CString` object will be automatically converted to an `LPCTSTR`. Any place you can use an `LPCTSTR`, you can also use a `CString` object.  \n  \n You can also specify a formal parameter as a constant string reference (that is, `const``CString&`) if the argument will not be modified. Drop the `const` modifier if the string will be modified by the function. If a default null value is desired, initialize it to the null string [`\"\"`], as shown below:  \n  \n [!code-cpp[NVC_ATLMFC_Utilities#191](../atl-mfc-shared/codesnippet/cpp/cstring-operations-relating-to-c-style-strings_3.cpp)]  \n  \n For most function results, you can simply return a `CString` object by value.  \n  \n## See Also  \n [Strings (ATL/MFC)](../atl-mfc-shared/strings-atl-mfc.md)   \n [CString Argument Passing](../atl-mfc-shared/cstring-argument-passing.md)\n\n"}