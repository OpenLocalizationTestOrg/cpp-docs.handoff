{"nodes":[{"pos":[12,47],"content":"User-defined Tools | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"User-defined Tools | Microsoft Docs","pos":[0,35]}]},{"content":"User-defined Tools","pos":[592,610]},{"content":"MFC supports user-defined tools.","pos":[611,643]},{"content":"A user-defined tool is a special command that executes an external, user-specified program.","pos":[644,735]},{"content":"You can use the customization process to manage user-defined tools.","pos":[736,803]},{"content":"However, you cannot use this process if your application object is not derived from <bpt id=\"p1\">[</bpt>CWinAppEx Class<ept id=\"p1\">](../mfc/reference/cwinappex-class.md)</ept>.","pos":[804,943],"source":" However, you cannot use this process if your application object is not derived from [CWinAppEx Class](../mfc/reference/cwinappex-class.md)."},{"content":"For more information about customization, see <bpt id=\"p1\">[</bpt>Customization for MFC<ept id=\"p1\">](../mfc/customization-for-mfc.md)</ept>.","pos":[944,1047],"source":" For more information about customization, see [Customization for MFC](../mfc/customization-for-mfc.md)."},{"content":"If you enabled user-defined tools support, the customization dialog box automatically includes the <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> tab.","pos":[1054,1167],"source":"If you enabled user-defined tools support, the customization dialog box automatically includes the **Tools** tab."},{"content":"The following illustration shows the <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> page.","pos":[1168,1220],"source":" The following illustration shows the **Tools** page."},{"content":"Tools tab in the Customize dialog box","pos":[1229,1266]},{"content":"Customization dialog box Tools tab","pos":[1334,1368]},{"content":"Enabling user-defined tools support","pos":[1377,1412]},{"content":"To enable user-defined tools in an application, call <bpt id=\"p1\">[</bpt>CWinAppEx::EnableUserTools<ept id=\"p1\">](../mfc/reference/cwinappex-class.md#cwinappex__enableusertools)</ept>.","pos":[1416,1562],"source":"To enable user-defined tools in an application, call [CWinAppEx::EnableUserTools](../mfc/reference/cwinappex-class.md#cwinappex__enableusertools)."},{"content":"However, you must first define several constants in the resource files of your application to use as parameters for this call.","pos":[1563,1689]},{"content":"In the resource editor create a dummy command that uses an appropriate command ID.","pos":[1696,1778]},{"content":"In the following example, we use <bpt id=\"p1\">**</bpt>ID_TOOLS_ENTRY<ept id=\"p1\">**</ept> as the command ID.","pos":[1779,1849],"source":" In the following example, we use **ID_TOOLS_ENTRY** as the command ID."},{"content":"This command ID marks a location in one or more menus where the framework will insert the user-defined tools.","pos":[1850,1959]},{"content":"You must set aside some consecutive IDs in the string table to represent the user-defined tools.","pos":[1966,2062]},{"content":"The number of strings that you set aside is equal to the maximum number of user tools that the users can define.","pos":[2063,2175]},{"content":"In the following example, these are named <bpt id=\"p1\">**</bpt>ID_USER_TOOL1<ept id=\"p1\">**</ept> through <bpt id=\"p2\">**</bpt>ID_USER_TOOL10<ept id=\"p2\">**</ept>.","pos":[2176,2263],"source":" In the following example, these are named **ID_USER_TOOL1** through **ID_USER_TOOL10**."},{"content":"You can offer suggestions to the users to help them select directories and arguments for the external programs that will be called as tools.","pos":[2270,2410]},{"content":"To do this, create two popup menus in the resource editor.","pos":[2411,2469]},{"content":"In the following example these are named <bpt id=\"p1\">**</bpt>IDR_MENU_ARGS<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>IDR_MENU_DIRS<ept id=\"p2\">**</ept>.","pos":[2470,2551],"source":" In the following example these are named **IDR_MENU_ARGS** and **IDR_MENU_DIRS**."},{"content":"For each command in these menus, define a string in your application string table.","pos":[2552,2634]},{"content":"The resource ID of the string must be equal to the command ID.","pos":[2635,2697]},{"content":"You can also create a derived class from <bpt id=\"p1\">[</bpt>CUserTool Class<ept id=\"p1\">](../mfc/reference/cusertool-class.md)</ept> to replace the default implementation.","pos":[2704,2838],"source":"You can also create a derived class from [CUserTool Class](../mfc/reference/cusertool-class.md) to replace the default implementation."},{"content":"To do this, pass the runtime information for your derived class as the fourth parameter in CWinAppEx::EnableUserTools, instead of RUNTIME_CLASS(<bpt id=\"p1\">[</bpt>CUserTool Class<ept id=\"p1\">](../mfc/reference/cusertool-class.md)</ept>).","pos":[2839,3039],"source":" To do this, pass the runtime information for your derived class as the fourth parameter in CWinAppEx::EnableUserTools, instead of RUNTIME_CLASS([CUserTool Class](../mfc/reference/cusertool-class.md))."},{"pos":[3046,3217],"content":"After you define the appropriate constants, call <bpt id=\"p1\">[</bpt>CWinAppEx::EnableUserTools<ept id=\"p1\">](../mfc/reference/cwinappex-class.md#cwinappex__enableusertools)</ept> to enable user-defined tools.","source":"After you define the appropriate constants, call [CWinAppEx::EnableUserTools](../mfc/reference/cwinappex-class.md#cwinappex__enableusertools) to enable user-defined tools."},{"content":"The following method call shows how to use these constants:","pos":[3224,3283]},{"pos":[3301,3327],"content":"NVC_MFC_VisualStudioDemo#1"},{"content":"In this example, the tools tab will be included on the <bpt id=\"p1\">**</bpt>Customization<ept id=\"p1\">**</ept> dialog box.","pos":[3385,3469],"source":"In this example, the tools tab will be included on the **Customization** dialog box."},{"content":"The framework will replace any command that matches the command ID <bpt id=\"p1\">**</bpt>ID_TOOLS_ENTRY<ept id=\"p1\">**</ept> in any menu with the set of currently defined user tools whenever a user opens that menu.","pos":[3470,3645],"source":" The framework will replace any command that matches the command ID **ID_TOOLS_ENTRY** in any menu with the set of currently defined user tools whenever a user opens that menu."},{"content":"The command IDs <bpt id=\"p1\">**</bpt>ID_USER_TOOL1<ept id=\"p1\">**</ept> through <bpt id=\"p2\">**</bpt>ID_USER_TOOL10<ept id=\"p2\">**</ept> are reserved for use for user-defined tools.","pos":[3646,3751],"source":" The command IDs **ID_USER_TOOL1** through **ID_USER_TOOL10** are reserved for use for user-defined tools."},{"content":"The class <bpt id=\"p1\">[</bpt>CUserTool Class<ept id=\"p1\">](../mfc/reference/cusertool-class.md)</ept> handles calls to the user tools.","pos":[3752,3849],"source":" The class [CUserTool Class](../mfc/reference/cusertool-class.md) handles calls to the user tools."},{"content":"The tool tab of the <bpt id=\"p1\">**</bpt>Customization<ept id=\"p1\">**</ept> dialog box provides buttons to the right of the argument and directory entry fields to access the menus <bpt id=\"p2\">**</bpt>IDR_MENU_ARGS<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>IDR_MENU_DIRS<ept id=\"p3\">**</ept>.When a user selects a command from one of these menus, the framework appends to the appropriate text box the string that has the resource ID equal to the command ID.","pos":[3850,4197],"source":" The tool tab of the **Customization** dialog box provides buttons to the right of the argument and directory entry fields to access the menus **IDR_MENU_ARGS** and **IDR_MENU_DIRS**.When a user selects a command from one of these menus, the framework appends to the appropriate text box the string that has the resource ID equal to the command ID."},{"content":"Including predefined tools","pos":[4207,4233]},{"content":"If you want to predefine some tools on the application startup, you must override the <bpt id=\"p1\">[</bpt>CFrameWnd::LoadFrame<ept id=\"p1\">](../mfc/reference/cframewnd-class.md#cframewnd__loadframe)</ept> method of the main window of your application.","pos":[4237,4450],"source":"If you want to predefine some tools on the application startup, you must override the [CFrameWnd::LoadFrame](../mfc/reference/cframewnd-class.md#cframewnd__loadframe) method of the main window of your application."},{"content":"In that method, you must perform the following steps.","pos":[4451,4504]},{"content":"To add new tools in LoadFrame","pos":[4516,4545]},{"pos":[4555,4769],"content":"Obtain a pointer to the <bpt id=\"p1\">[</bpt>CUserToolsManager Class<ept id=\"p1\">](../mfc/reference/cusertoolsmanager-class.md)</ept> object by calling <bpt id=\"p2\">[</bpt>CWinAppEx::GetUserToolsManager<ept id=\"p2\">](../mfc/reference/cwinappex-class.md#cwinappex__getusertoolsmanager)</ept>.","source":"Obtain a pointer to the [CUserToolsManager Class](../mfc/reference/cusertoolsmanager-class.md) object by calling [CWinAppEx::GetUserToolsManager](../mfc/reference/cwinappex-class.md#cwinappex__getusertoolsmanager)."},{"content":"For every tool that you want to create, call <bpt id=\"p1\">[</bpt>CUserToolsManager::CreateNewTool<ept id=\"p1\">](../mfc/reference/cusertoolsmanager-class.md#cusertoolsmanager__createnewtool)</ept>.","pos":[4779,4937],"source":"For every tool that you want to create, call [CUserToolsManager::CreateNewTool](../mfc/reference/cusertoolsmanager-class.md#cusertoolsmanager__createnewtool)."},{"content":"This method returns a pointer to a <bpt id=\"p1\">[</bpt>CUserTool Class<ept id=\"p1\">](../mfc/reference/cusertool-class.md)</ept> object and adds the newly created user tool to the internal collection of tools.","pos":[4938,5108],"source":" This method returns a pointer to a [CUserTool Class](../mfc/reference/cusertool-class.md) object and adds the newly created user tool to the internal collection of tools."},{"content":"If you provided the runtime information for a derived class of <bpt id=\"p1\">[</bpt>CUserTool Class<ept id=\"p1\">](../mfc/reference/cusertool-class.md)</ept> as the fourth parameter of <bpt id=\"p2\">[</bpt>CWinAppEx::EnableUserTools<ept id=\"p2\">](../mfc/reference/cwinappex-class.md#cwinappex__enableusertools)</ept>, <bpt id=\"p3\">[</bpt>CUserToolsManager::CreateNewTool<ept id=\"p3\">](../mfc/reference/cusertoolsmanager-class.md#cusertoolsmanager__createnewtool)</ept> will instantiate and return an instance of that class instead.","pos":[5109,5523],"source":" If you provided the runtime information for a derived class of [CUserTool Class](../mfc/reference/cusertool-class.md) as the fourth parameter of [CWinAppEx::EnableUserTools](../mfc/reference/cwinappex-class.md#cwinappex__enableusertools), [CUserToolsManager::CreateNewTool](../mfc/reference/cusertoolsmanager-class.md#cusertoolsmanager__createnewtool) will instantiate and return an instance of that class instead."},{"content":"For each tool, set its text label by setting <ph id=\"ph1\">`CUserTool::m_strLabel`</ph> and set its command by calling <ph id=\"ph2\">`CUserTool::SetCommand`</ph>.","pos":[5533,5657],"source":"For each tool, set its text label by setting `CUserTool::m_strLabel` and set its command by calling `CUserTool::SetCommand`."},{"content":"The default implementation of <bpt id=\"p1\">[</bpt>CUserTool Class<ept id=\"p1\">](../mfc/reference/cusertool-class.md)</ept> automatically retrieves available icons from the program that is specified in the call to <ph id=\"ph1\">`SetCommand`</ph>.","pos":[5658,5846],"source":" The default implementation of [CUserTool Class](../mfc/reference/cusertool-class.md) automatically retrieves available icons from the program that is specified in the call to `SetCommand`."},{"content":"See Also","pos":[5855,5863]},{"content":"Customization for MFC","pos":[5868,5889]},{"content":"CUserTool Class","pos":[5929,5944]},{"content":"CUserToolsManager Class","pos":[5988,6011]},{"content":"CWinAppEx Class","pos":[6063,6078]}],"content":"---\ntitle: \"User-defined Tools | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"user-defined tools (MFC Extensions)\"\nms.assetid: cb887421-78ce-4652-bc67-96a53984ccaa\ncaps.latest.revision: 18\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# User-defined Tools\nMFC supports user-defined tools. A user-defined tool is a special command that executes an external, user-specified program. You can use the customization process to manage user-defined tools. However, you cannot use this process if your application object is not derived from [CWinAppEx Class](../mfc/reference/cwinappex-class.md). For more information about customization, see [Customization for MFC](../mfc/customization-for-mfc.md).  \n  \n If you enabled user-defined tools support, the customization dialog box automatically includes the **Tools** tab. The following illustration shows the **Tools** page.  \n  \n ![Tools tab in the Customize dialog box](../mfc/media/custdialogboxtoolstab.png \"custdialogboxtoolstab\")  \nCustomization dialog box Tools tab  \n  \n## Enabling user-defined tools support  \n To enable user-defined tools in an application, call [CWinAppEx::EnableUserTools](../mfc/reference/cwinappex-class.md#cwinappex__enableusertools). However, you must first define several constants in the resource files of your application to use as parameters for this call.  \n  \n In the resource editor create a dummy command that uses an appropriate command ID. In the following example, we use **ID_TOOLS_ENTRY** as the command ID. This command ID marks a location in one or more menus where the framework will insert the user-defined tools.  \n  \n You must set aside some consecutive IDs in the string table to represent the user-defined tools. The number of strings that you set aside is equal to the maximum number of user tools that the users can define. In the following example, these are named **ID_USER_TOOL1** through **ID_USER_TOOL10**.  \n  \n You can offer suggestions to the users to help them select directories and arguments for the external programs that will be called as tools. To do this, create two popup menus in the resource editor. In the following example these are named **IDR_MENU_ARGS** and **IDR_MENU_DIRS**. For each command in these menus, define a string in your application string table. The resource ID of the string must be equal to the command ID.  \n  \n You can also create a derived class from [CUserTool Class](../mfc/reference/cusertool-class.md) to replace the default implementation. To do this, pass the runtime information for your derived class as the fourth parameter in CWinAppEx::EnableUserTools, instead of RUNTIME_CLASS([CUserTool Class](../mfc/reference/cusertool-class.md)).  \n  \n After you define the appropriate constants, call [CWinAppEx::EnableUserTools](../mfc/reference/cwinappex-class.md#cwinappex__enableusertools) to enable user-defined tools.  \n  \n The following method call shows how to use these constants:  \n  \n [!code-cpp[NVC_MFC_VisualStudioDemo#1](../mfc/codesnippet/cpp/user-defined-tools_1.cpp)]  \n  \n In this example, the tools tab will be included on the **Customization** dialog box. The framework will replace any command that matches the command ID **ID_TOOLS_ENTRY** in any menu with the set of currently defined user tools whenever a user opens that menu. The command IDs **ID_USER_TOOL1** through **ID_USER_TOOL10** are reserved for use for user-defined tools. The class [CUserTool Class](../mfc/reference/cusertool-class.md) handles calls to the user tools. The tool tab of the **Customization** dialog box provides buttons to the right of the argument and directory entry fields to access the menus **IDR_MENU_ARGS** and **IDR_MENU_DIRS**.When a user selects a command from one of these menus, the framework appends to the appropriate text box the string that has the resource ID equal to the command ID.  \n  \n### Including predefined tools  \n If you want to predefine some tools on the application startup, you must override the [CFrameWnd::LoadFrame](../mfc/reference/cframewnd-class.md#cframewnd__loadframe) method of the main window of your application. In that method, you must perform the following steps.  \n  \n##### To add new tools in LoadFrame  \n  \n1.  Obtain a pointer to the [CUserToolsManager Class](../mfc/reference/cusertoolsmanager-class.md) object by calling [CWinAppEx::GetUserToolsManager](../mfc/reference/cwinappex-class.md#cwinappex__getusertoolsmanager).  \n  \n2.  For every tool that you want to create, call [CUserToolsManager::CreateNewTool](../mfc/reference/cusertoolsmanager-class.md#cusertoolsmanager__createnewtool). This method returns a pointer to a [CUserTool Class](../mfc/reference/cusertool-class.md) object and adds the newly created user tool to the internal collection of tools. If you provided the runtime information for a derived class of [CUserTool Class](../mfc/reference/cusertool-class.md) as the fourth parameter of [CWinAppEx::EnableUserTools](../mfc/reference/cwinappex-class.md#cwinappex__enableusertools), [CUserToolsManager::CreateNewTool](../mfc/reference/cusertoolsmanager-class.md#cusertoolsmanager__createnewtool) will instantiate and return an instance of that class instead.  \n  \n3.  For each tool, set its text label by setting `CUserTool::m_strLabel` and set its command by calling `CUserTool::SetCommand`. The default implementation of [CUserTool Class](../mfc/reference/cusertool-class.md) automatically retrieves available icons from the program that is specified in the call to `SetCommand`.  \n  \n## See Also  \n [Customization for MFC](../mfc/customization-for-mfc.md)   \n [CUserTool Class](../mfc/reference/cusertool-class.md)   \n [CUserToolsManager Class](../mfc/reference/cusertoolsmanager-class.md)   \n [CWinAppEx Class](../mfc/reference/cwinappex-class.md)\n\n\n\n\n"}