{"nodes":[{"pos":[12,93],"content":"How to: Call Properties and Methods of the Windows Forms Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Call Properties and Methods of the Windows Forms Control | Microsoft Docs","pos":[0,81]}]},{"content":"How to: Call Properties and Methods of the Windows Forms Control","pos":[850,914]},{"content":"Because <bpt id=\"p1\">[</bpt>CWinFormsView::GetControl<ept id=\"p1\">](../mfc/reference/cwinformsview-class.md#cwinformsview__getcontrol)</ept> returns a pointer to &lt;xref:System.Windows.Forms.Control?displayProperty=fullName&gt;, and not a pointer to <ph id=\"ph1\">`WindowsControlLibrary1::UserControl1`</ph>, it is advisable to add a member of the user control type and initialize it in <bpt id=\"p2\">[</bpt>IView::OnInitialUpdate<ept id=\"p2\">](.../mfc/reference/iview-interface.md#iview__oninitialupdate)</ept>.","pos":[915,1326],"source":"Because [CWinFormsView::GetControl](../mfc/reference/cwinformsview-class.md#cwinformsview__getcontrol) returns a pointer to <xref:System.Windows.Forms.Control?displayProperty=fullName>, and not a pointer to `WindowsControlLibrary1::UserControl1`, it is advisable to add a member of the user control type and initialize it in [IView::OnInitialUpdate](.../mfc/reference/iview-interface.md#iview__oninitialupdate)."},{"content":"Now you can call methods and properties using <ph id=\"ph1\">`m_ViewControl`</ph>.","pos":[1327,1389],"source":" Now you can call methods and properties using `m_ViewControl`."},{"pos":[1396,1693],"content":"This topic assumes you have previously completed <bpt id=\"p1\">[</bpt>How to: Create the User Control and Host in a Dialog Box<ept id=\"p1\">](../dotnet/how-to-create-the-user-control-and-host-in-a-dialog-box.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Create the User Control and Host MDI View<ept id=\"p2\">](../dotnet/how-to-create-the-user-control-and-host-mdi-view.md)</ept>.","source":"This topic assumes you have previously completed [How to: Create the User Control and Host in a Dialog Box](../dotnet/how-to-create-the-user-control-and-host-in-a-dialog-box.md) and [How to: Create the User Control and Host MDI View](../dotnet/how-to-create-the-user-control-and-host-mdi-view.md)."},{"content":"To create the MFC host application","pos":[1703,1737]},{"pos":[1747,1902],"content":"Open the MFC application you created in <bpt id=\"p1\">[</bpt>How to: Create the User Control and Host MDI View<ept id=\"p1\">](../dotnet/how-to-create-the-user-control-and-host-mdi-view.md)</ept>.","source":"Open the MFC application you created in [How to: Create the User Control and Host MDI View](../dotnet/how-to-create-the-user-control-and-host-mdi-view.md)."},{"pos":[1912,2020],"content":"Add the following line to the public overrides section of the <ph id=\"ph1\">`CMFC02View`</ph> class declaration in MFC02View.h.","source":"Add the following line to the public overrides section of the `CMFC02View` class declaration in MFC02View.h."},{"content":"Add an override for OnInitialupdate.","pos":[2109,2145]},{"content":"Display the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window (F4).","pos":[2156,2195],"source":"Display the **Properties** window (F4)."},{"content":"In <bpt id=\"p1\">**</bpt>Class View<ept id=\"p1\">**</ept> (CTRL+SHIFT+C), select CMFC02View class.","pos":[2196,2254],"source":" In **Class View** (CTRL+SHIFT+C), select CMFC02View class."},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, select the icon for Overrides.","pos":[2255,2315],"source":" In the **Properties** window, select the icon for Overrides."},{"content":"Scoll down the list to OnInitialUpdate.","pos":[2316,2355]},{"content":"Click on the drop down list and select <ph id=\"ph1\">\\&lt;</ph>Add&gt;.","pos":[2356,2402],"source":" Click on the drop down list and select \\<Add>."},{"content":"In MFC02View.cpp.","pos":[2403,2420]},{"content":"make sure the body of the OnInitialUpdate function is as follows:","pos":[2421,2486]},{"content":"Build and run the project.","pos":[2723,2749]},{"pos":[2760,2808],"content":"On the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept>.","source":"On the **Build** menu, click **Build Solution**."},{"pos":[2819,2876],"content":"On the <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Start without debugging<ept id=\"p2\">**</ept>.","source":"On the **Debug** menu, click **Start without debugging**."},{"content":"Notice that the text box is now initialized.","pos":[2887,2931]},{"content":"See Also","pos":[2940,2948]},{"content":"Hosting a Windows Forms User Control as an MFC View","pos":[2953,3004]}],"content":"---\ntitle: \"How to: Call Properties and Methods of the Windows Forms Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"method calls, Windows Forms\"\n  - \"calling methods, Windows Forms control\"\n  - \"calling properties, Windows Forms control\"\n  - \"Windows Forms controls [C++], methods\"\n  - \"calling properties\"\n  - \"Windows Forms controls [C++], properties\"\nms.assetid: 6e647d8a-fdaa-4aa1-b3fe-04f15cff8eb3\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Call Properties and Methods of the Windows Forms Control\nBecause [CWinFormsView::GetControl](../mfc/reference/cwinformsview-class.md#cwinformsview__getcontrol) returns a pointer to <xref:System.Windows.Forms.Control?displayProperty=fullName>, and not a pointer to `WindowsControlLibrary1::UserControl1`, it is advisable to add a member of the user control type and initialize it in [IView::OnInitialUpdate](.../mfc/reference/iview-interface.md#iview__oninitialupdate). Now you can call methods and properties using `m_ViewControl`.  \n  \n This topic assumes you have previously completed [How to: Create the User Control and Host in a Dialog Box](../dotnet/how-to-create-the-user-control-and-host-in-a-dialog-box.md) and [How to: Create the User Control and Host MDI View](../dotnet/how-to-create-the-user-control-and-host-mdi-view.md).  \n  \n### To create the MFC host application  \n  \n1.  Open the MFC application you created in [How to: Create the User Control and Host MDI View](../dotnet/how-to-create-the-user-control-and-host-mdi-view.md).  \n  \n2.  Add the following line to the public overrides section of the `CMFC02View` class declaration in MFC02View.h.  \n  \n     `gcroot<WindowsFormsControlLibrary1::UserControl1 ^> m_ViewControl;`  \n  \n3.  Add an override for OnInitialupdate.  \n  \n     Display the **Properties** window (F4). In **Class View** (CTRL+SHIFT+C), select CMFC02View class. In the **Properties** window, select the icon for Overrides. Scoll down the list to OnInitialUpdate. Click on the drop down list and select \\<Add>. In MFC02View.cpp. make sure the body of the OnInitialUpdate function is as follows:  \n  \n    ```  \n    CWinFormsView::OnInitialUpdate();  \n    m_ViewControl = safe_cast<WindowsFormsControlLibrary1::UserControl1 ^>(this->GetControl());  \n    m_ViewControl->textBox1->Text = gcnew System::String(\"hi\");  \n    ```  \n  \n4.  Build and run the project.  \n  \n     On the **Build** menu, click **Build Solution**.  \n  \n     On the **Debug** menu, click **Start without debugging**.  \n  \n     Notice that the text box is now initialized.  \n  \n## See Also  \n [Hosting a Windows Forms User Control as an MFC View](../dotnet/hosting-a-windows-forms-user-control-as-an-mfc-view.md)"}