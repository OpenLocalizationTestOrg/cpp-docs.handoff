{"nodes":[{"pos":[12,62],"content":"Connection Point Global Functions | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Connection Point Global Functions | Microsoft Docs","pos":[0,50]}]},{"content":"Connection Point Global Functions","pos":[615,648]},{"content":"These functions provide support for connection points and sink maps.","pos":[649,717]},{"pos":[725,892],"content":"[!IMPORTANT]\n The functions listed in the following table cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"The functions listed in the following table cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,165],"source":" The functions listed in the following table cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"content":"AtlAdvise","pos":[914,923]},{"content":"Creates a connection between an object's connection point and a client's sink.","pos":[937,1015]},{"content":"AtlUnadvise","pos":[1021,1032]},{"pos":[1048,1106],"content":"Terminates the connection established through <ph id=\"ph1\">`AtlAdvise`</ph>.","source":"Terminates the connection established through `AtlAdvise`."},{"content":"AtlAdviseSinkMap","pos":[1112,1128]},{"content":"Advises or unadvises entries in an event sink map.","pos":[1149,1199]},{"pos":[1236,1245],"content":"AtlAdvise"},{"content":"Creates a connection between an object's connection point and a client's sink.","pos":[1249,1327]},{"pos":[1335,1472],"content":"[!IMPORTANT]\n This function cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This function cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,135],"source":" This function cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"content":"Parameters","pos":[1598,1608]},{"content":"[in] A pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> of the object the client wants to connect with.","pos":[1624,1706],"source":" [in] A pointer to the **IUnknown** of the object the client wants to connect with."},{"content":"pUnk","pos":[1714,1718]},{"content":"[in] A pointer to the client's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>.","pos":[1723,1767],"source":" [in] A pointer to the client's **IUnknown**."},{"content":"[in] The GUID of the connection point.","pos":[1783,1821]},{"content":"Typically, this is the same as the outgoing interface managed by the connection point.","pos":[1822,1908]},{"content":"[out] A pointer to the cookie that uniquely identifies the connection.","pos":[1924,1994]},{"content":"Return Value","pos":[2004,2016]},{"content":"A standard HRESULT value.","pos":[2020,2045]},{"content":"Remarks","pos":[2055,2062]},{"content":"The sink implements the outgoing interface supported by the connection point.","pos":[2066,2143]},{"content":"The client uses the <ph id=\"ph1\">`pdw`</ph> cookie to remove the connection by passing it to <bpt id=\"p1\">[</bpt>AtlUnadvise<ept id=\"p1\">](#atlunadvise)</ept>.","pos":[2144,2247],"source":" The client uses the `pdw` cookie to remove the connection by passing it to [AtlUnadvise](#atlunadvise)."},{"content":"Example","pos":[2257,2264]},{"pos":[2279,2299],"content":"NVC_ATL_Windowing#91"},{"pos":[2406,2417],"content":"AtlUnadvise"},{"pos":[2421,2491],"content":"Terminates the connection established through <bpt id=\"p1\">[</bpt>AtlAdvise<ept id=\"p1\">](#atladvise)</ept>.","source":"Terminates the connection established through [AtlAdvise](#atladvise)."},{"pos":[2499,2636],"content":"[!IMPORTANT]\n This function cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This function cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,135],"source":" This function cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"content":"Parameters","pos":[2741,2751]},{"content":"[in] A pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> of the object that the client is connected with.","pos":[2767,2850],"source":" [in] A pointer to the **IUnknown** of the object that the client is connected with."},{"content":"[in] The GUID of the connection point.","pos":[2866,2904]},{"content":"Typically, this is the same as the outgoing interface managed by the connection point.","pos":[2905,2991]},{"content":"[in] The cookie that uniquely identifies the connection.","pos":[3006,3062]},{"content":"Return Value","pos":[3072,3084]},{"content":"A standard HRESULT value.","pos":[3088,3113]},{"content":"Example","pos":[3123,3130]},{"pos":[3145,3165],"content":"NVC_ATL_Windowing#96"},{"pos":[3277,3293],"content":"AtlAdviseSinkMap"},{"content":"Call this function to advise or unadvise all entries in the object's sink event map.","pos":[3297,3381]},{"pos":[3389,3526],"content":"[!IMPORTANT]\n This function cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This function cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,135],"source":" This function cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"content":"Parameters","pos":[3602,3612]},{"content":"pT","pos":[3617,3619]},{"content":"[in] A pointer to the object containing the sink map.","pos":[3624,3677]},{"content":"[in] <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> if all sink entries are to be advised; <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept> if all sink entries are to be unadvised.","pos":[3697,3800],"source":" [in] **true** if all sink entries are to be advised; **false** if all sink entries are to be unadvised."},{"content":"Return Value","pos":[3810,3822]},{"content":"A standard HRESULT value.","pos":[3826,3851]},{"content":"Example","pos":[3861,3868]},{"pos":[3883,3903],"content":"NVC_ATL_Windowing#92"},{"content":"See Also","pos":[3979,3987]},{"content":"Functions","pos":[3992,4001]},{"content":"Connection Point Macros","pos":[4046,4069]}],"content":"---\ntitle: \"Connection Point Global Functions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"connection points [C++], global functions\"\nms.assetid: bcb4bf50-2155-4e20-b8bb-f2908b03a6e7\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Connection Point Global Functions\nThese functions provide support for connection points and sink maps.  \n  \n> [!IMPORTANT]\n>  The functions listed in the following table cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n|||  \n|-|-|  \n|[AtlAdvise](#atladvise)|Creates a connection between an object's connection point and a client's sink.|  \n|[AtlUnadvise](#atlunadvise)|Terminates the connection established through `AtlAdvise`.|  \n|[AtlAdviseSinkMap](#atladvisesinkmap)|Advises or unadvises entries in an event sink map.|  \n  \n##  <a name=\"atladvise\"></a>  AtlAdvise  \n Creates a connection between an object's connection point and a client's sink.  \n  \n> [!IMPORTANT]\n>  This function cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n```\nHRESULT     AtlAdvise(\n    IUnknown* pUnkCP,\n    IUnknown* pUnk,\n    const IID& iid,\n    LPDWORD pdw);\n```  \n  \n### Parameters  \n `pUnkCP`  \n [in] A pointer to the **IUnknown** of the object the client wants to connect with.  \n  \n *pUnk*  \n [in] A pointer to the client's **IUnknown**.  \n  \n `iid`  \n [in] The GUID of the connection point. Typically, this is the same as the outgoing interface managed by the connection point.  \n  \n `pdw`  \n [out] A pointer to the cookie that uniquely identifies the connection.  \n  \n### Return Value  \n A standard HRESULT value.  \n  \n### Remarks  \n The sink implements the outgoing interface supported by the connection point. The client uses the `pdw` cookie to remove the connection by passing it to [AtlUnadvise](#atlunadvise).  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#91](../../atl/codesnippet/cpp/connection-point-global-functions_1.cpp)]  \n  \n##  <a name=\"atlunadvise\"></a>  AtlUnadvise  \n Terminates the connection established through [AtlAdvise](#atladvise).  \n  \n> [!IMPORTANT]\n>  This function cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n```\nHRESULT     AtlUnadvise(\n    IUnknown* pUnkCP,\n    const IID& iid,\n    DWORD dw);\n```  \n  \n### Parameters  \n `pUnkCP`  \n [in] A pointer to the **IUnknown** of the object that the client is connected with.  \n  \n `iid`  \n [in] The GUID of the connection point. Typically, this is the same as the outgoing interface managed by the connection point.  \n  \n `dw`  \n [in] The cookie that uniquely identifies the connection.  \n  \n### Return Value  \n A standard HRESULT value.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#96](../../atl/codesnippet/cpp/connection-point-global-functions_2.cpp)]  \n  \n##  <a name=\"atladvisesinkmap\"></a>  AtlAdviseSinkMap  \n Call this function to advise or unadvise all entries in the object's sink event map.  \n  \n> [!IMPORTANT]\n>  This function cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n```\nHRESULT AtlAdviseSinkMap(\n    T* pT,  bool bAdvise);\n```  \n  \n### Parameters  \n *pT*  \n [in] A pointer to the object containing the sink map.  \n  \n `bAdvise`  \n [in] **true** if all sink entries are to be advised; **false** if all sink entries are to be unadvised.  \n  \n### Return Value  \n A standard HRESULT value.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#92](../../atl/codesnippet/cpp/connection-point-global-functions_3.h)]  \n  \n## See Also  \n [Functions](../../atl/reference/atl-functions.md)   \n [Connection Point Macros](../../atl/reference/connection-point-macros.md)\n"}