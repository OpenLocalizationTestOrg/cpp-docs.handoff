{"nodes":[{"pos":[12,121],"content":"How to: Create a Partially Trusted Application by Removing Dependency on the CRT Library DLL | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Create a Partially Trusted Application by Removing Dependency on the CRT Library DLL | Microsoft Docs","pos":[0,109]}]},{"content":"How to: Create a Partially Trusted Application by Removing Dependency on the CRT Library DLL","pos":[938,1030]},{"pos":[1031,1217],"content":"This topic discusses how to create a partially trusted Common Language Runtime application using <ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph> by removing dependency on msvcm90.dll.","source":"This topic discusses how to create a partially trusted Common Language Runtime application using [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] by removing dependency on msvcm90.dll."},{"content":"A Visual C++ application built with <bpt id=\"p1\">**</bpt>/clr<ept id=\"p1\">**</ept> will have a dependency on msvcm90.dll, which is part of the C-Runtime Library.","pos":[1224,1347],"source":"A Visual C++ application built with **/clr** will have a dependency on msvcm90.dll, which is part of the C-Runtime Library."},{"content":"When you want your application to be used in a partial trust environment, the CLR will enforce certain code access security rules on your DLL.","pos":[1348,1490]},{"content":"Therefore, it will be necessary to remove this dependency because msvcm90.dll contains native code and code access security policy cannot be enforced on it.","pos":[1491,1647]},{"content":"If your application does not use any functionality of the C-Runtime Library and you would like to remove the dependency on this library from your code, you will have to use the <bpt id=\"p1\">**</bpt>/NODEFAULTLIB:msvcmrt.lib<ept id=\"p1\">**</ept> linker option and link with either ptrustm.lib or ptrustmd.lib.","pos":[1654,1924],"source":"If your application does not use any functionality of the C-Runtime Library and you would like to remove the dependency on this library from your code, you will have to use the **/NODEFAULTLIB:msvcmrt.lib** linker option and link with either ptrustm.lib or ptrustmd.lib."},{"content":"These libraries contain object files for initialization and uninitialization of an application, exception classes used by the initialization code, and managed exception handling code.","pos":[1925,2108]},{"content":"Linking in one of these libraries will remove any dependency on msvcm90.dll.","pos":[2109,2185]},{"pos":[2193,2566],"content":"[!NOTE]\n The order of assembly uninitialization might differ for applications that use the ptrust libraries. For normal applications, assemblies are usually unloaded in the reverse order that they are loaded, but this is not guaranteed. For partial trust applications, assemblies are usually unloaded in the same order that they are loaded. This, also, is not guaranteed.","leadings":["","> "],"nodes":[{"content":" The order of assembly uninitialization might differ for applications that use the ptrust libraries. For normal applications, assemblies are usually unloaded in the reverse order that they are loaded, but this is not guaranteed. For partial trust applications, assemblies are usually unloaded in the same order that they are loaded. This, also, is not guaranteed.","pos":[8,371],"nodes":[{"content":"The order of assembly uninitialization might differ for applications that use the ptrust libraries.","pos":[1,100]},{"content":"For normal applications, assemblies are usually unloaded in the reverse order that they are loaded, but this is not guaranteed.","pos":[101,228]},{"content":"For partial trust applications, assemblies are usually unloaded in the same order that they are loaded.","pos":[229,332]},{"content":"This, also, is not guaranteed.","pos":[333,363]}]}]},{"content":"To create a partially trusted mixed (/clr) application","pos":[2576,2630]},{"content":"To remove the dependency on msvcm90.dll, you must specify to the linker not to include this library by using the <bpt id=\"p1\">**</bpt>/NODEFAULTLIB:msvcmrt.lib<ept id=\"p1\">**</ept> linker option.","pos":[2640,2797],"source":"To remove the dependency on msvcm90.dll, you must specify to the linker not to include this library by using the **/NODEFAULTLIB:msvcmrt.lib** linker option."},{"content":"For information on how to do this using the Visual Studio development environment or programmatically, see <bpt id=\"p1\">[</bpt>/NODEFAULTLIB (Ignore Libraries)<ept id=\"p1\">](../build/reference/nodefaultlib-ignore-libraries.md)</ept>.","pos":[2798,2993],"source":" For information on how to do this using the Visual Studio development environment or programmatically, see [/NODEFAULTLIB (Ignore Libraries)](../build/reference/nodefaultlib-ignore-libraries.md)."},{"content":"Add one of the ptrustm libraries to the linker input dependencies.","pos":[3003,3069]},{"content":"Use ptrustm.lib if you are building your application in release mode.","pos":[3070,3139]},{"content":"For debug mode, use ptrustmd.lib.","pos":[3140,3173]},{"content":"For information on how to do this using the Visual Studio development environment or programmatically, see <bpt id=\"p1\">[</bpt>.Lib Files as Linker Input<ept id=\"p1\">](../build/reference/dot-lib-files-as-linker-input.md)</ept>.","pos":[3174,3363],"source":" For information on how to do this using the Visual Studio development environment or programmatically, see [.Lib Files as Linker Input](../build/reference/dot-lib-files-as-linker-input.md)."},{"content":"See Also","pos":[3372,3380]},{"content":"Mixed (Native and Managed) Assemblies","pos":[3385,3422]},{"content":"Initialization of Mixed Assemblies","pos":[3479,3513]},{"content":"Library Support for Mixed Assemblies","pos":[3569,3605]},{"content":"/link (Pass Options to Linker)","pos":[3663,3693]},{"content":"PAVE Security in Native and .NET Framework Code","pos":[3751,3798]}],"content":"---\ntitle: \"How to: Create a Partially Trusted Application by Removing Dependency on the CRT Library DLL | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"partially trusted applications [C++]\"\n  - \"mixed assemblies [C++], partially trusted applications\"\n  - \"msvcm90[d].dll\"\n  - \"interoperability [C++], partially trusted applications\"\n  - \"interop [C++], partially trusted applications\"\n  - \"/clr compiler option [C++], partially trusted applications\"\nms.assetid: 4760cd0c-4227-4f23-a7fb-d25b51bf246e\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Create a Partially Trusted Application by Removing Dependency on the CRT Library DLL\nThis topic discusses how to create a partially trusted Common Language Runtime application using [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] by removing dependency on msvcm90.dll.  \n  \n A Visual C++ application built with **/clr** will have a dependency on msvcm90.dll, which is part of the C-Runtime Library. When you want your application to be used in a partial trust environment, the CLR will enforce certain code access security rules on your DLL. Therefore, it will be necessary to remove this dependency because msvcm90.dll contains native code and code access security policy cannot be enforced on it.  \n  \n If your application does not use any functionality of the C-Runtime Library and you would like to remove the dependency on this library from your code, you will have to use the **/NODEFAULTLIB:msvcmrt.lib** linker option and link with either ptrustm.lib or ptrustmd.lib. These libraries contain object files for initialization and uninitialization of an application, exception classes used by the initialization code, and managed exception handling code. Linking in one of these libraries will remove any dependency on msvcm90.dll.  \n  \n> [!NOTE]\n>  The order of assembly uninitialization might differ for applications that use the ptrust libraries. For normal applications, assemblies are usually unloaded in the reverse order that they are loaded, but this is not guaranteed. For partial trust applications, assemblies are usually unloaded in the same order that they are loaded. This, also, is not guaranteed.  \n  \n### To create a partially trusted mixed (/clr) application  \n  \n1.  To remove the dependency on msvcm90.dll, you must specify to the linker not to include this library by using the **/NODEFAULTLIB:msvcmrt.lib** linker option. For information on how to do this using the Visual Studio development environment or programmatically, see [/NODEFAULTLIB (Ignore Libraries)](../build/reference/nodefaultlib-ignore-libraries.md).  \n  \n2.  Add one of the ptrustm libraries to the linker input dependencies. Use ptrustm.lib if you are building your application in release mode. For debug mode, use ptrustmd.lib. For information on how to do this using the Visual Studio development environment or programmatically, see [.Lib Files as Linker Input](../build/reference/dot-lib-files-as-linker-input.md).  \n  \n## See Also  \n [Mixed (Native and Managed) Assemblies](../dotnet/mixed-native-and-managed-assemblies.md)   \n [Initialization of Mixed Assemblies](../dotnet/initialization-of-mixed-assemblies.md)   \n [Library Support for Mixed Assemblies](../dotnet/library-support-for-mixed-assemblies.md)   \n [/link (Pass Options to Linker)](../build/reference/link-pass-options-to-linker.md)   \n [PAVE Security in Native and .NET Framework Code](http://msdn.microsoft.com/en-us/bd61be84-c143-409a-a75a-44253724f784)"}