{"nodes":[{"pos":[12,50],"content":"2.6.5 flush Directive | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"2.6.5 flush Directive | Microsoft Docs","pos":[0,38]}]},{"content":"2.6.5 flush Directive","pos":[530,551]},{"content":"The <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> directive, whether explicit or implied, specifies a \"cross-thread\" sequence point at which the implementation is required to ensure that all threads in a team have a consistent view of certain objects (specified below) in memory.","pos":[552,795],"source":"The **flush** directive, whether explicit or implied, specifies a \"cross-thread\" sequence point at which the implementation is required to ensure that all threads in a team have a consistent view of certain objects (specified below) in memory."},{"content":"This means that previous evaluations of expressions that reference those objects are complete and subsequent evaluations have not yet begun.","pos":[796,936]},{"content":"For example, compilers must restore the values of the objects from registers to memory, and hardware may need to flush write buffers to memory and reload the values of the objects from memory.","pos":[937,1129]},{"pos":[1136,1188],"content":"The syntax of the <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> directive is as follows:","source":"The syntax of the **flush** directive is as follows:"},{"content":"If the objects that require synchronization can all be designated by variables, then those variables can be specified in the optional <bpt id=\"p1\">*</bpt>variable-list<ept id=\"p1\">*</ept>.","pos":[1258,1408],"source":"If the objects that require synchronization can all be designated by variables, then those variables can be specified in the optional *variable-list*."},{"content":"If a pointer is present in the <bpt id=\"p1\">*</bpt>variable-list<ept id=\"p1\">*</ept>, the pointer itself is flushed, not the object the pointer refers to.","pos":[1409,1525],"source":" If a pointer is present in the *variable-list*, the pointer itself is flushed, not the object the pointer refers to."},{"content":"A <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> directive without a <bpt id=\"p2\">*</bpt>variable-list<ept id=\"p2\">*</ept> synchronizes all shared objects except inaccessible objects with automatic storage duration.","pos":[1532,1672],"source":"A **flush** directive without a *variable-list* synchronizes all shared objects except inaccessible objects with automatic storage duration."},{"content":"(This is likely to have more overhead than a <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> with a <bpt id=\"p2\">*</bpt>variable-list<ept id=\"p2\">*</ept>.) A <bpt id=\"p3\">**</bpt>flush<ept id=\"p3\">**</ept> directive without a <bpt id=\"p4\">*</bpt>variable-list<ept id=\"p4\">*</ept> is implied for the following directives:","pos":[1673,1841],"source":" (This is likely to have more overhead than a **flush** with a *variable-list*.) A **flush** directive without a *variable-list* is implied for the following directives:"},{"pos":[1870,1908],"content":"At entry to and exit from <bpt id=\"p1\">**</bpt>critical<ept id=\"p1\">**</ept>","source":"At entry to and exit from **critical**"},{"pos":[1918,1943],"content":"At entry to and exit from"},{"pos":[1963,2001],"content":"At entry to and exit from <bpt id=\"p1\">**</bpt>parallel<ept id=\"p1\">**</ept>","source":"At entry to and exit from **parallel**"},{"pos":[2011,2031],"content":"At exit from <bpt id=\"p1\">**</bpt>for<ept id=\"p1\">**</ept>","source":"At exit from **for**"},{"pos":[2041,2066],"content":"At exit from <bpt id=\"p1\">**</bpt>sections<ept id=\"p1\">**</ept>","source":"At exit from **sections**"},{"pos":[2076,2099],"content":"At exit from <bpt id=\"p1\">**</bpt>single<ept id=\"p1\">**</ept>","source":"At exit from **single**"},{"pos":[2109,2151],"content":"At entry to and exit from <bpt id=\"p1\">**</bpt>parallel for<ept id=\"p1\">**</ept>","source":"At entry to and exit from **parallel for**"},{"pos":[2161,2208],"content":"At entry to and exit from <bpt id=\"p1\">**</bpt>parallel sections<ept id=\"p1\">**</ept>","source":"At entry to and exit from **parallel sections**"},{"content":"The directive is not implied if a <ph id=\"ph1\">`nowait`</ph> clause is present.","pos":[2215,2276],"source":"The directive is not implied if a `nowait` clause is present."},{"content":"It should be noted that the <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> directive is not implied for any of the following:","pos":[2277,2365],"source":" It should be noted that the **flush** directive is not implied for any of the following:"},{"pos":[2375,2394],"content":"At entry to <bpt id=\"p1\">**</bpt>for<ept id=\"p1\">**</ept>","source":"At entry to **for**"},{"pos":[2404,2439],"content":"At entry to or exit from <bpt id=\"p1\">**</bpt>master<ept id=\"p1\">**</ept>","source":"At entry to or exit from **master**"},{"pos":[2449,2473],"content":"At entry to <bpt id=\"p1\">**</bpt>sections<ept id=\"p1\">**</ept>","source":"At entry to **sections**"},{"pos":[2483,2505],"content":"At entry to <bpt id=\"p1\">**</bpt>single<ept id=\"p1\">**</ept>","source":"At entry to **single**"},{"content":"A reference that accesses the value of an object with a volatile-qualified type behaves as if there were a <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> directive specifying that object at the previous sequence point.","pos":[2512,2693],"source":"A reference that accesses the value of an object with a volatile-qualified type behaves as if there were a **flush** directive specifying that object at the previous sequence point."},{"content":"A reference that modifies the value of an object with a volatile-qualified type behaves as if there were a <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> directive specifying that object at the subsequent sequence point.","pos":[2694,2877],"source":" A reference that modifies the value of an object with a volatile-qualified type behaves as if there were a **flush** directive specifying that object at the subsequent sequence point."},{"content":"Note that because the <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> directive does not have a C language statement as part of its syntax, there are some restrictions on its placement within a program.","pos":[2884,3048],"source":"Note that because the **flush** directive does not have a C language statement as part of its syntax, there are some restrictions on its placement within a program."},{"content":"See <bpt id=\"p1\">[</bpt>Appendix C<ept id=\"p1\">](../../parallel/openmp/c-openmp-c-and-cpp-grammar.md)</ept> for the formal grammar.","pos":[3049,3142],"source":" See [Appendix C](../../parallel/openmp/c-openmp-c-and-cpp-grammar.md) for the formal grammar."},{"content":"The example below illustrates these restrictions.","pos":[3143,3192]},{"pos":[3495,3550],"content":"Restrictions to the <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> directive are as follows:","source":"Restrictions to the **flush** directive are as follows:"},{"pos":[3560,3637],"content":"A variable specified in a <bpt id=\"p1\">**</bpt>flush<ept id=\"p1\">**</ept> directive must not have a reference type.","source":"A variable specified in a **flush** directive must not have a reference type."}],"content":"---\ntitle: \"2.6.5 flush Directive | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nms.assetid: a2ec5f74-9c37-424a-8376-47ab4a5829a2\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# 2.6.5 flush Directive\nThe **flush** directive, whether explicit or implied, specifies a \"cross-thread\" sequence point at which the implementation is required to ensure that all threads in a team have a consistent view of certain objects (specified below) in memory. This means that previous evaluations of expressions that reference those objects are complete and subsequent evaluations have not yet begun. For example, compilers must restore the values of the objects from registers to memory, and hardware may need to flush write buffers to memory and reload the values of the objects from memory.  \n  \n The syntax of the **flush** directive is as follows:  \n  \n```  \n#pragma omp flush [(variable-list)]  new-line  \n```  \n  \n If the objects that require synchronization can all be designated by variables, then those variables can be specified in the optional *variable-list*. If a pointer is present in the *variable-list*, the pointer itself is flushed, not the object the pointer refers to.  \n  \n A **flush** directive without a *variable-list* synchronizes all shared objects except inaccessible objects with automatic storage duration. (This is likely to have more overhead than a **flush** with a *variable-list*.) A **flush** directive without a *variable-list* is implied for the following directives:  \n  \n-   `barrier`  \n  \n-   At entry to and exit from **critical**  \n  \n-   At entry to and exit from `ordered`  \n  \n-   At entry to and exit from **parallel**  \n  \n-   At exit from **for**  \n  \n-   At exit from **sections**  \n  \n-   At exit from **single**  \n  \n-   At entry to and exit from **parallel for**  \n  \n-   At entry to and exit from **parallel sections**  \n  \n The directive is not implied if a `nowait` clause is present. It should be noted that the **flush** directive is not implied for any of the following:  \n  \n-   At entry to **for**  \n  \n-   At entry to or exit from **master**  \n  \n-   At entry to **sections**  \n  \n-   At entry to **single**  \n  \n A reference that accesses the value of an object with a volatile-qualified type behaves as if there were a **flush** directive specifying that object at the previous sequence point. A reference that modifies the value of an object with a volatile-qualified type behaves as if there were a **flush** directive specifying that object at the subsequent sequence point.  \n  \n Note that because the **flush** directive does not have a C language statement as part of its syntax, there are some restrictions on its placement within a program. See [Appendix C](../../parallel/openmp/c-openmp-c-and-cpp-grammar.md) for the formal grammar. The example below illustrates these restrictions.  \n  \n```  \n/* ERROR - The flush directive cannot be the immediate  \n*          substatement of an if statement.  \n*/  \nif (x!=0)  \n   #pragma omp flush (x)  \n...  \n  \n/* OK - The flush directive is enclosed in a  \n*      compound statement  \n*/  \nif (x!=0) {  \n   #pragma omp flush (x)  \n}  \n```  \n  \n Restrictions to the **flush** directive are as follows:  \n  \n-   A variable specified in a **flush** directive must not have a reference type."}