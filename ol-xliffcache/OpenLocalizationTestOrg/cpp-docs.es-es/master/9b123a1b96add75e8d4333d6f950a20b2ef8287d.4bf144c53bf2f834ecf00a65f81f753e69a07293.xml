{"nodes":[{"pos":[12,64],"content":"CMyProviderCommand (MyProviderRS.H) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMyProviderCommand (MyProviderRS.H) | Microsoft Docs","pos":[0,52]}]},{"content":"CMyProviderCommand (MyProviderRS.H)","pos":[722,757]},{"content":"The <ph id=\"ph1\">`CMyProviderCommand`</ph> class is the implementation for the provider command object.","pos":[758,843],"source":"The `CMyProviderCommand` class is the implementation for the provider command object."},{"content":"It provides the implementation for the <ph id=\"ph1\">`IAccessor`</ph>, <ph id=\"ph2\">`ICommandText`</ph>, and <bpt id=\"p1\">**</bpt>ICommandProperties<ept id=\"p1\">**</ept> interfaces.","pos":[844,950],"source":" It provides the implementation for the `IAccessor`, `ICommandText`, and **ICommandProperties** interfaces."},{"content":"The <ph id=\"ph1\">`IAccessor`</ph> interface is the same as the one in the rowset.","pos":[951,1014],"source":" The `IAccessor` interface is the same as the one in the rowset."},{"content":"The command object uses the accessor to specify bindings for parameters.","pos":[1015,1087]},{"content":"The rowset object uses them to specify bindings for output columns.","pos":[1088,1155]},{"content":"The <ph id=\"ph1\">`ICommandText`</ph> interface is a useful way to specify a command textually.","pos":[1156,1232],"source":" The `ICommandText` interface is a useful way to specify a command textually."},{"content":"This example uses the <ph id=\"ph1\">`ICommandText`</ph> interface later when it adds custom code; it also overrides the <ph id=\"ph2\">`ICommand::Execute`</ph> method.","pos":[1233,1361],"source":" This example uses the `ICommandText` interface later when it adds custom code; it also overrides the `ICommand::Execute` method."},{"content":"The <bpt id=\"p1\">**</bpt>ICommandProperties<ept id=\"p1\">**</ept> interface handles all of the properties for the command and rowset objects.","pos":[1362,1464],"source":" The **ICommandProperties** interface handles all of the properties for the command and rowset objects."},{"content":"The <ph id=\"ph1\">`IAccessor`</ph> interface manages all the bindings used in commands and rowsets.","pos":[1956,2036],"source":"The `IAccessor` interface manages all the bindings used in commands and rowsets."},{"content":"The consumer calls <bpt id=\"p1\">**</bpt>IAccessor::CreateAccessor<ept id=\"p1\">**</ept> with an array of <bpt id=\"p2\">**</bpt>DBBINDING<ept id=\"p2\">**</ept> structures.","pos":[2037,2128],"source":" The consumer calls **IAccessor::CreateAccessor** with an array of **DBBINDING** structures."},{"content":"Each <bpt id=\"p1\">**</bpt>DBBINDING<ept id=\"p1\">**</ept> structure contains the information about how the column bindings should be handled (such as type and length).","pos":[2129,2257],"source":" Each **DBBINDING** structure contains the information about how the column bindings should be handled (such as type and length)."},{"content":"The provider receives the structures and then determines how the data should be transferred and whether any conversions are necessary.","pos":[2258,2392]},{"content":"The <ph id=\"ph1\">`IAccessor`</ph> interface is used in the command object to handle any parameters in the command.","pos":[2393,2489],"source":" The `IAccessor` interface is used in the command object to handle any parameters in the command."},{"content":"The command object also provides an implementation of <ph id=\"ph1\">`IColumnsInfo`</ph>.","pos":[2496,2565],"source":"The command object also provides an implementation of `IColumnsInfo`."},{"content":"OLE DB requires the <ph id=\"ph1\">`IColumnsInfo`</ph> interface.","pos":[2566,2611],"source":" OLE DB requires the `IColumnsInfo` interface."},{"content":"The interface allows the consumer to retrieve information about parameters from the command.","pos":[2612,2704]},{"content":"The rowset object uses the <ph id=\"ph1\">`IColumnsInfo`</ph> interface to return information about the output columns to the provider.","pos":[2705,2820],"source":" The rowset object uses the `IColumnsInfo` interface to return information about the output columns to the provider."},{"content":"The provider also contains an interface called <ph id=\"ph1\">`IObjectWithSite`</ph>.","pos":[2827,2892],"source":"The provider also contains an interface called `IObjectWithSite`."},{"content":"The <ph id=\"ph1\">`IObjectWithSite`</ph> interface was implemented in ATL 2.0 and allows the implementer to pass information about itself to its child.","pos":[2893,3025],"source":" The `IObjectWithSite` interface was implemented in ATL 2.0 and allows the implementer to pass information about itself to its child."},{"content":"The command object uses the <ph id=\"ph1\">`IObjectWithSite`</ph> information to tell any generated rowset objects about who created them.","pos":[3026,3144],"source":" The command object uses the `IObjectWithSite` information to tell any generated rowset objects about who created them."},{"content":"See Also","pos":[3153,3161]},{"content":"Provider Wizard-Generated Files","pos":[3166,3197]}],"content":"---\ntitle: \"CMyProviderCommand (MyProviderRS.H) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"cmyprovidercommand\"\n  - \"myproviderrs.h\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE DB providers, wizard-generated files\"\n  - \"CMyProviderCommand class in MyProviderRS.H\"\nms.assetid: b30b956e-cc91-4cf5-9fe6-f8b1ce9cc2a5\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMyProviderCommand (MyProviderRS.H)\nThe `CMyProviderCommand` class is the implementation for the provider command object. It provides the implementation for the `IAccessor`, `ICommandText`, and **ICommandProperties** interfaces. The `IAccessor` interface is the same as the one in the rowset. The command object uses the accessor to specify bindings for parameters. The rowset object uses them to specify bindings for output columns. The `ICommandText` interface is a useful way to specify a command textually. This example uses the `ICommandText` interface later when it adds custom code; it also overrides the `ICommand::Execute` method. The **ICommandProperties** interface handles all of the properties for the command and rowset objects.  \n  \n```  \n// CMyProviderCommand  \nclass ATL_NO_VTABLE CMyProviderCommand :   \nclass ATL_NO_VTABLE CMyProviderCommand :   \n   public CComObjectRootEx<CComSingleThreadModel>,  \n   public IAccessorImpl<CMyProviderCommand>,  \n   public ICommandTextImpl<CMyProviderCommand>,  \n   public ICommandPropertiesImpl<CMyProviderCommand>,  \n   public IObjectWithSiteImpl<CMyProviderCommand>,  \n   public IConvertTypeImpl<CMyProviderCommand>,  \n   public IColumnsInfoImpl<CMyProviderCommand>  \n```  \n  \n The `IAccessor` interface manages all the bindings used in commands and rowsets. The consumer calls **IAccessor::CreateAccessor** with an array of **DBBINDING** structures. Each **DBBINDING** structure contains the information about how the column bindings should be handled (such as type and length). The provider receives the structures and then determines how the data should be transferred and whether any conversions are necessary. The `IAccessor` interface is used in the command object to handle any parameters in the command.  \n  \n The command object also provides an implementation of `IColumnsInfo`. OLE DB requires the `IColumnsInfo` interface. The interface allows the consumer to retrieve information about parameters from the command. The rowset object uses the `IColumnsInfo` interface to return information about the output columns to the provider.  \n  \n The provider also contains an interface called `IObjectWithSite`. The `IObjectWithSite` interface was implemented in ATL 2.0 and allows the implementer to pass information about itself to its child. The command object uses the `IObjectWithSite` information to tell any generated rowset objects about who created them.  \n  \n## See Also  \n [Provider Wizard-Generated Files](../../data/oledb/provider-wizard-generated-files.md)"}