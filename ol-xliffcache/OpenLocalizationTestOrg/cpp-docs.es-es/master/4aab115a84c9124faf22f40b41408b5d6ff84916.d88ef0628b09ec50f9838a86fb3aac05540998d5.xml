{"nodes":[{"pos":[12,73],"content":"Servers: Implementing In-Place Frame Windows | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Servers: Implementing In-Place Frame Windows | Microsoft Docs","pos":[0,61]}]},{"content":"Servers: Implementing In-Place Frame Windows","pos":[752,796]},{"content":"This article explains what you must do to implement in-place frame windows in your visual editing server application if you do not use the application wizard to create your server application.","pos":[797,989]},{"content":"In place of following the procedure outlined in this article, you could use an existing in-place frame-window class from either an application wizard–generated application or a sample provided with Visual C++.","pos":[990,1199]},{"content":"To declare an in-place frame-window class","pos":[1210,1251]},{"pos":[1261,1321],"content":"Derive an in-place frame-window class from <ph id=\"ph1\">`COleIPFrameWnd`</ph>.","source":"Derive an in-place frame-window class from `COleIPFrameWnd`."},{"pos":[1335,1395],"content":"Use the <ph id=\"ph1\">`DECLARE_DYNCREATE`</ph> macro in your class header file.","source":"Use the `DECLARE_DYNCREATE` macro in your class header file."},{"content":"Use the <ph id=\"ph1\">`IMPLEMENT_DYNCREATE`</ph> macro in your class implementation (.cpp) file.","pos":[1409,1486],"source":"Use the `IMPLEMENT_DYNCREATE` macro in your class implementation (.cpp) file."},{"content":"This allows objects of this class to be created by the framework.","pos":[1487,1552]},{"content":"Declare a <ph id=\"ph1\">`COleResizeBar`</ph> member in the frame-window class.","pos":[1562,1621],"source":"Declare a `COleResizeBar` member in the frame-window class."},{"content":"This is needed if you want to support in-place resizing in server applications.","pos":[1622,1701]},{"pos":[1712,1859],"content":"Declare an <ph id=\"ph1\">`OnCreate`</ph> message handler (using the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window), and call <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept> for your <ph id=\"ph2\">`COleResizeBar`</ph> member, if you've defined it.","source":"Declare an `OnCreate` message handler (using the **Properties** window), and call **Create** for your `COleResizeBar` member, if you've defined it."},{"pos":[1869,1946],"content":"If you have a toolbar, declare a <ph id=\"ph1\">`CToolBar`</ph> member in the frame-window class.","source":"If you have a toolbar, declare a `CToolBar` member in the frame-window class."},{"content":"Override the <ph id=\"ph1\">`OnCreateControlBars`</ph> member function to create a toolbar when the server is active in place.","pos":[1957,2063],"source":"Override the `OnCreateControlBars` member function to create a toolbar when the server is active in place."},{"content":"For example:","pos":[2064,2076]},{"pos":[2098,2116],"content":"NVC_MFCOleServer#1"},{"content":"See the discussion of this code following step 5.","pos":[2203,2252]},{"content":"Include the header file for this in-place frame-window class in your main .cpp file.","pos":[2262,2346]},{"pos":[2356,2559],"content":"In <ph id=\"ph1\">`InitInstance`</ph> for your application class, call the <ph id=\"ph2\">`SetServerInfo`</ph> function of the document template object to specify the resources and in-place frame window to be used in open and in-place editing.","source":"In `InitInstance` for your application class, call the `SetServerInfo` function of the document template object to specify the resources and in-place frame window to be used in open and in-place editing."},{"content":"The series of function calls in the <bpt id=\"p1\">**</bpt>if<ept id=\"p1\">**</ept> statement creates the toolbar from the resources the server provided.","pos":[2566,2678],"source":"The series of function calls in the **if** statement creates the toolbar from the resources the server provided."},{"content":"At this point, the toolbar is part of the container's window hierarchy.","pos":[2679,2750]},{"content":"Because this toolbar is derived from <ph id=\"ph1\">`CToolBar`</ph>, it will pass its messages to its owner, the container application's frame window, unless you change the owner.","pos":[2751,2910],"source":" Because this toolbar is derived from `CToolBar`, it will pass its messages to its owner, the container application's frame window, unless you change the owner."},{"content":"That is why the call to <ph id=\"ph1\">`SetOwner`</ph> is necessary.","pos":[2911,2959],"source":" That is why the call to `SetOwner` is necessary."},{"content":"This call changes the window where commands are sent to be the server's in-place frame window, causing the messages to be passed to the server.","pos":[2960,3103]},{"content":"This allows the server to react to operations on the toolbar that it provides.","pos":[3104,3182]},{"content":"The ID for the toolbar bitmap should be the same as the other in-place resources defined in your server application.","pos":[3189,3305]},{"content":"See <bpt id=\"p1\">[</bpt>Menus and Resources: Server Additions<ept id=\"p1\">](../mfc/menus-and-resources-server-additions.md)</ept> for details.","pos":[3306,3410],"source":" See [Menus and Resources: Server Additions](../mfc/menus-and-resources-server-additions.md) for details."},{"pos":[3417,3696],"content":"For more information, see <bpt id=\"p1\">[</bpt>COleIPFrameWnd<ept id=\"p1\">](../mfc/reference/coleipframewnd-class.md)</ept>, <bpt id=\"p2\">[</bpt>COleResizeBar<ept id=\"p2\">](../mfc/reference/coleresizebar-class.md)</ept>, and <bpt id=\"p3\">[</bpt>CDocTemplate::SetServerInfo<ept id=\"p3\">](../mfc/reference/cdoctemplate-class.md#cdoctemplate__setserverinfo)</ept> in the <bpt id=\"p4\">*</bpt>Class Library Reference<ept id=\"p4\">*</ept>.","source":"For more information, see [COleIPFrameWnd](../mfc/reference/coleipframewnd-class.md), [COleResizeBar](../mfc/reference/coleresizebar-class.md), and [CDocTemplate::SetServerInfo](../mfc/reference/cdoctemplate-class.md#cdoctemplate__setserverinfo) in the *Class Library Reference*."},{"content":"See Also","pos":[3705,3713]},{"content":"Servers","pos":[3718,3725]},{"content":"Servers: Implementing a Server","pos":[3751,3781]},{"content":"Servers: Implementing Server Documents","pos":[3829,3867]},{"content":"Servers: Server Items","pos":[3923,3944]}],"content":"---\ntitle: \"Servers: Implementing In-Place Frame Windows | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"frame windows, implementing\"\n  - \"OLE server applications, frame windows\"\n  - \"servers, in-place frame windows\"\n  - \"frame windows, in-place\"\n  - \"in-place frame windows\"\nms.assetid: 09bde4d8-15e2-4fba-8d14-9b954d926b92\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Servers: Implementing In-Place Frame Windows\nThis article explains what you must do to implement in-place frame windows in your visual editing server application if you do not use the application wizard to create your server application. In place of following the procedure outlined in this article, you could use an existing in-place frame-window class from either an application wizard–generated application or a sample provided with Visual C++.  \n  \n#### To declare an in-place frame-window class  \n  \n1.  Derive an in-place frame-window class from `COleIPFrameWnd`.  \n  \n    -   Use the `DECLARE_DYNCREATE` macro in your class header file.  \n  \n    -   Use the `IMPLEMENT_DYNCREATE` macro in your class implementation (.cpp) file. This allows objects of this class to be created by the framework.  \n  \n2.  Declare a `COleResizeBar` member in the frame-window class. This is needed if you want to support in-place resizing in server applications.  \n  \n     Declare an `OnCreate` message handler (using the **Properties** window), and call **Create** for your `COleResizeBar` member, if you've defined it.  \n  \n3.  If you have a toolbar, declare a `CToolBar` member in the frame-window class.  \n  \n     Override the `OnCreateControlBars` member function to create a toolbar when the server is active in place. For example:  \n  \n     [!code-cpp[NVC_MFCOleServer#1](../mfc/codesnippet/cpp/servers-implementing-in-place-frame-windows_1.cpp)]  \n  \n     See the discussion of this code following step 5.  \n  \n4.  Include the header file for this in-place frame-window class in your main .cpp file.  \n  \n5.  In `InitInstance` for your application class, call the `SetServerInfo` function of the document template object to specify the resources and in-place frame window to be used in open and in-place editing.  \n  \n The series of function calls in the **if** statement creates the toolbar from the resources the server provided. At this point, the toolbar is part of the container's window hierarchy. Because this toolbar is derived from `CToolBar`, it will pass its messages to its owner, the container application's frame window, unless you change the owner. That is why the call to `SetOwner` is necessary. This call changes the window where commands are sent to be the server's in-place frame window, causing the messages to be passed to the server. This allows the server to react to operations on the toolbar that it provides.  \n  \n The ID for the toolbar bitmap should be the same as the other in-place resources defined in your server application. See [Menus and Resources: Server Additions](../mfc/menus-and-resources-server-additions.md) for details.  \n  \n For more information, see [COleIPFrameWnd](../mfc/reference/coleipframewnd-class.md), [COleResizeBar](../mfc/reference/coleresizebar-class.md), and [CDocTemplate::SetServerInfo](../mfc/reference/cdoctemplate-class.md#cdoctemplate__setserverinfo) in the *Class Library Reference*.  \n  \n## See Also  \n [Servers](../mfc/servers.md)   \n [Servers: Implementing a Server](../mfc/servers-implementing-a-server.md)   \n [Servers: Implementing Server Documents](../mfc/servers-implementing-server-documents.md)   \n [Servers: Server Items](../mfc/servers-server-items.md)\n\n"}