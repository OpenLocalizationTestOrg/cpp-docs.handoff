{"nodes":[{"pos":[12,79],"content":"Specifying the Threading Model for a Project (ATL) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Specifying the Threading Model for a Project (ATL) | Microsoft Docs","pos":[0,67]}]},{"content":"Specifying the Threading Model for a Project (ATL)","pos":[738,788]},{"content":"The following macros are available to specify the threading model of an ATL project:","pos":[789,873]},{"content":"Macro","pos":[880,885]},{"content":"Guidelines for using","pos":[886,906]},{"content":"_ATL_SINGLE_THREADED","pos":[954,974]},{"content":"Define if all of your objects use the single threading model.","pos":[975,1036]},{"content":"_ATL_APARTMENT_THREADED","pos":[1041,1064]},{"content":"Define if one or more of your objects use apartment threading.","pos":[1065,1127]},{"content":"_ATL_FREE_THREADED","pos":[1132,1150]},{"content":"Define if one or more of your objects use free or neutral threading.","pos":[1151,1219]},{"content":"Existing code may contain references to the equivalent macro <bpt id=\"p1\">[</bpt>_ATL_MULTI_THREADED<ept id=\"p1\">](http://msdn.microsoft.com/library/23fb6460-e651-46e6-b207-8559ccf49608)</ept>.","pos":[1220,1375],"source":" Existing code may contain references to the equivalent macro [_ATL_MULTI_THREADED](http://msdn.microsoft.com/library/23fb6460-e651-46e6-b207-8559ccf49608)."},{"content":"If you do not define any of these macros for your project, _ATL_FREE_THREADED will be in effect.","pos":[1383,1479]},{"content":"The macros affect run-time performance as follows:","pos":[1486,1536]},{"content":"Specifying the macro that corresponds to the objects in your project can improve run-time performance.","pos":[1546,1648]},{"content":"Specifying a higher level of macro, for example if you specify _ATL_APARTMENT_THREADED when all of your objects are single threaded, will slightly degrade run-time performance.","pos":[1658,1834]},{"content":"Specifying a lower level of macro, for example, if you specify _ATL_SINGLE_THREADED when one or more of your objects use apartment threading or free threading, can cause your application to fail at run time.","pos":[1844,2051]},{"pos":[2058,2222],"content":"See <bpt id=\"p1\">[</bpt>Options, ATL Simple Object Wizard<ept id=\"p1\">](../atl/reference/options-atl-simple-object-wizard.md)</ept> for a description of the threading models available for an ATL object.","source":"See [Options, ATL Simple Object Wizard](../atl/reference/options-atl-simple-object-wizard.md) for a description of the threading models available for an ATL object."},{"content":"See Also","pos":[2231,2239]},{"content":"Concepts","pos":[2244,2252]}],"content":"---\ntitle: \"Specifying the Threading Model for a Project (ATL) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"_ATL_FREE_THREADED macro\"\n  - \"_ATL_APARTMENT_THREADED macro\"\n  - \"ATL, multithreading\"\n  - \"threading [ATL], models\"\n  - \"_ATL_SINGLE_THREADED macro\"\nms.assetid: 6b571078-521c-4f3e-9f08-482aa235a822\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Specifying the Threading Model for a Project (ATL)\nThe following macros are available to specify the threading model of an ATL project:  \n  \n|Macro|Guidelines for using|  \n|-----------|--------------------------|  \n|_ATL_SINGLE_THREADED|Define if all of your objects use the single threading model.|  \n|_ATL_APARTMENT_THREADED|Define if one or more of your objects use apartment threading.|  \n|_ATL_FREE_THREADED|Define if one or more of your objects use free or neutral threading. Existing code may contain references to the equivalent macro [_ATL_MULTI_THREADED](http://msdn.microsoft.com/library/23fb6460-e651-46e6-b207-8559ccf49608).|  \n  \n If you do not define any of these macros for your project, _ATL_FREE_THREADED will be in effect.  \n  \n The macros affect run-time performance as follows:  \n  \n-   Specifying the macro that corresponds to the objects in your project can improve run-time performance.  \n  \n-   Specifying a higher level of macro, for example if you specify _ATL_APARTMENT_THREADED when all of your objects are single threaded, will slightly degrade run-time performance.  \n  \n-   Specifying a lower level of macro, for example, if you specify _ATL_SINGLE_THREADED when one or more of your objects use apartment threading or free threading, can cause your application to fail at run time.  \n  \n See [Options, ATL Simple Object Wizard](../atl/reference/options-atl-simple-object-wizard.md) for a description of the threading models available for an ATL object.  \n  \n## See Also  \n [Concepts](../atl/active-template-library-atl-concepts.md)\n\n"}