{"nodes":[{"pos":[12,78],"content":"How to: Create the User Control and Host MDI View | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Create the User Control and Host MDI View | Microsoft Docs","pos":[0,66]}]},{"content":"How to: Create the User Control and Host MDI View","pos":[672,721]},{"content":"The following steps show how to create a .NET Framework user control, author the user control in a control class library (specifically, a Windows Control Library project), and then compile the project into an assembly.","pos":[722,940]},{"content":"The control can then be consumed from an MFC application that uses classes derived from <bpt id=\"p1\">[</bpt>CView Class<ept id=\"p1\">](../mfc/reference/cview-class.md)</ept> and <bpt id=\"p2\">[</bpt>CWinFormsView Class<ept id=\"p2\">](../mfc/reference/cwinformsview-class.md)</ept>.","pos":[941,1143],"source":" The control can then be consumed from an MFC application that uses classes derived from [CView Class](../mfc/reference/cview-class.md) and [CWinFormsView Class](../mfc/reference/cwinformsview-class.md)."},{"pos":[1150,1358],"content":"For information about how to create a Windows Forms user control and author a control class library, see <bpt id=\"p1\">[</bpt>How to: Author User Controls<ept id=\"p1\">](http://msdn.microsoft.com/Library/79c9cf05-5ab6-4a18-886d-88a64748b098)</ept>.","source":"For information about how to create a Windows Forms user control and author a control class library, see [How to: Author User Controls](http://msdn.microsoft.com/Library/79c9cf05-5ab6-4a18-886d-88a64748b098)."},{"pos":[1366,1665],"content":"[!NOTE]\n In some cases, Windows Forms controls, such as a third-party Grid control, might not behave reliably when hosted in an MFC application. A recommended workaround is to place a Windows Forms User Control in the MFC application and place the third-party Grid control inside the User control.","leadings":["","> "],"nodes":[{"content":" In some cases, Windows Forms controls, such as a third-party Grid control, might not behave reliably when hosted in an MFC application. A recommended workaround is to place a Windows Forms User Control in the MFC application and place the third-party Grid control inside the User control.","pos":[8,297],"nodes":[{"content":"In some cases, Windows Forms controls, such as a third-party Grid control, might not behave reliably when hosted in an MFC application.","pos":[1,136]},{"content":"A recommended workaround is to place a Windows Forms User Control in the MFC application and place the third-party Grid control inside the User control.","pos":[137,289]}]}]},{"pos":[1672,1941],"content":"This procedure assumes that you created a Windows Forms Controls Library project named WindowsFormsControlLibrary1, as per the procedure in <bpt id=\"p1\">[</bpt>How to: Create the User Control and Host in a Dialog Box<ept id=\"p1\">](../dotnet/how-to-create-the-user-control-and-host-in-a-dialog-box.md)</ept>.","source":"This procedure assumes that you created a Windows Forms Controls Library project named WindowsFormsControlLibrary1, as per the procedure in [How to: Create the User Control and Host in a Dialog Box](../dotnet/how-to-create-the-user-control-and-host-in-a-dialog-box.md)."},{"content":"To create the MFC host application","pos":[1951,1985]},{"content":"Create an MFC Application project.","pos":[1995,2029]},{"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, select <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","pos":[2040,2105],"source":"On the **File** menu, select **New**, and then click **Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>Visual C++<ept id=\"p1\">**</ept> folder, select <bpt id=\"p2\">**</bpt>MFC Application<ept id=\"p2\">**</ept>.","pos":[2106,2163],"source":" In the **Visual C++** folder, select **MFC Application**."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, enter <ph id=\"ph1\">`MFC02`</ph> and change the <bpt id=\"p2\">**</bpt>Solution<ept id=\"p2\">**</ept> setting to <bpt id=\"p3\">**</bpt>Add to Solution<ept id=\"p3\">**</ept>.","pos":[2174,2268],"source":"In the **Name** box, enter `MFC02` and change the **Solution** setting to **Add to Solution**."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[2269,2282],"source":" Click **OK**."},{"content":"In the <bpt id=\"p1\">**</bpt>MFC Application Wizard<ept id=\"p1\">**</ept>, accept all the defaults, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>.","pos":[2293,2379],"source":"In the **MFC Application Wizard**, accept all the defaults, and then click **Finish**."},{"content":"This creates an MFC application with a Multiple Document Interface.","pos":[2380,2447]},{"content":"Configure the project for Common Language Runtime (CLR) support.","pos":[2457,2521]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <ph id=\"ph1\">`MFC01`</ph> project node, and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> from the context menu.","pos":[2532,2644],"source":"In **Solution Explorer**, right-click the `MFC01` project node, and select **Properties** from the context menu."},{"content":"The <bpt id=\"p1\">**</bpt>Property Pages<ept id=\"p1\">**</ept> dialog box appears.","pos":[2645,2687],"source":" The **Property Pages** dialog box appears."},{"content":"Under <bpt id=\"p1\">**</bpt>Configuration Properties<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>General<ept id=\"p2\">**</ept>.","pos":[2698,2753],"source":"Under **Configuration Properties**, select **General**."},{"content":"Under the <bpt id=\"p1\">**</bpt>Project Defaults<ept id=\"p1\">**</ept> section, set <bpt id=\"p2\">**</bpt>Common Language Runtime support<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>Common Language Runtime Support (/clr)<ept id=\"p3\">**</ept>.","pos":[2754,2880],"source":" Under the **Project Defaults** section, set **Common Language Runtime support** to **Common Language Runtime Support (/clr)**."},{"content":"Under <bpt id=\"p1\">**</bpt>Configuration Properties<ept id=\"p1\">**</ept>, expand <bpt id=\"p2\">**</bpt>C/C++<ept id=\"p2\">**</ept> and click the <bpt id=\"p3\">**</bpt>General<ept id=\"p3\">**</ept> node.","pos":[2891,2975],"source":"Under **Configuration Properties**, expand **C/C++** and click the **General** node."},{"content":"Set <bpt id=\"p1\">**</bpt>Debug Information Format<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Program Database (/Zi)<ept id=\"p2\">**</ept>.","pos":[2976,3039],"source":" Set **Debug Information Format** to **Program Database (/Zi)**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Code Generation<ept id=\"p1\">**</ept> node.","pos":[3050,3085],"source":"Click the **Code Generation** node."},{"content":"Set <bpt id=\"p1\">**</bpt>Enable Minimal Rebuild<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>No (/Gm-)<ept id=\"p2\">**</ept>.","pos":[3086,3134],"source":" Set **Enable Minimal Rebuild** to **No (/Gm-)**."},{"content":"Also set <bpt id=\"p1\">**</bpt>Basic Runtime Checks<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Default<ept id=\"p2\">**</ept>.","pos":[3135,3184],"source":" Also set **Basic Runtime Checks** to **Default**."},{"pos":[3195,3230],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to apply your changes.","source":"Click **OK** to apply your changes."},{"content":"In stdafx.h, add the following line:","pos":[3240,3276]},{"content":"Add a reference to the .NET control.","pos":[3349,3385]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the <ph id=\"ph1\">`MFC02`</ph> project node and select <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>References<ept id=\"p3\">**</ept>.","pos":[3396,3494],"source":"In **Solution Explorer**, right-click the `MFC02` project node and select **Add**, **References**."},{"content":"In the <bpt id=\"p1\">**</bpt>Property Page<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Add New Reference<ept id=\"p2\">**</ept>, select WindowsFormsControlLibrary1 (under the <bpt id=\"p3\">**</bpt>Projects<ept id=\"p3\">**</ept> tab), and click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","pos":[3495,3632],"source":" In the **Property Page**, click **Add New Reference**, select WindowsFormsControlLibrary1 (under the **Projects** tab), and click **OK**."},{"content":"This adds a reference in the form of a <bpt id=\"p1\">[</bpt>/FU<ept id=\"p1\">](../build/reference/fu-name-forced-hash-using-file.md)</ept> compiler option so that the program will compile; it also copies WindowsFormsControlLibrary1.dll into the <ph id=\"ph1\">`MFC02`</ph> project directory so that the program will run.","pos":[3633,3893],"source":" This adds a reference in the form of a [/FU](../build/reference/fu-name-forced-hash-using-file.md) compiler option so that the program will compile; it also copies WindowsFormsControlLibrary1.dll into the `MFC02` project directory so that the program will run."},{"content":"In stdafx.h, find this line:","pos":[3903,3931]},{"content":"Add these lines above it:","pos":[4005,4030]},{"pos":[4125,4229],"content":"Modify the view class so that it inherits from <bpt id=\"p1\">[</bpt>CWinFormsView<ept id=\"p1\">](../mfc/reference/cwinformsview-class.md)</ept>.","source":"Modify the view class so that it inherits from [CWinFormsView](../mfc/reference/cwinformsview-class.md)."},{"pos":[4240,4403],"content":"In MFC02View.h, replace <bpt id=\"p1\">[</bpt>CView<ept id=\"p1\">](../mfc/reference/cview-class.md)</ept> with <bpt id=\"p2\">[</bpt>CWinFormsView<ept id=\"p2\">](../mfc/reference/cwinformsview-class.md)</ept> so that the code appears as follows:","source":"In MFC02View.h, replace [CView](../mfc/reference/cview-class.md) with [CWinFormsView](../mfc/reference/cwinformsview-class.md) so that the code appears as follows:"},{"pos":[4500,4690],"content":"If you want add additional views to your MDI application, you will need to call <bpt id=\"p1\">[</bpt>CWinApp::AddDocTemplate<ept id=\"p1\">](../mfc/reference/cwinapp-class.md#cwinapp__adddoctemplate)</ept> for each view you create.","source":"If you want add additional views to your MDI application, you will need to call [CWinApp::AddDocTemplate](../mfc/reference/cwinapp-class.md#cwinapp__adddoctemplate) for each view you create."},{"content":"Modify the MFC02View.cpp file to change CView to CWinFormsView in the IMPLEMENT_DYNCREATE macro and message map and replace the existing empty constructor with the constructor shown below:","pos":[4700,4888]},{"content":"Build and run the project.","pos":[5200,5226]},{"pos":[5237,5319],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click MFC02 and select <bpt id=\"p2\">**</bpt>Set as StartUp Project<ept id=\"p2\">**</ept>.","source":"In **Solution Explorer**, right-click MFC02 and select **Set as StartUp Project**."},{"pos":[5330,5378],"content":"On the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept>.","source":"On the **Build** menu, click **Build Solution**."},{"pos":[5389,5446],"content":"On the <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Start without debugging<ept id=\"p2\">**</ept>.","source":"On the **Debug** menu, click **Start without debugging**."},{"content":"See Also","pos":[5455,5463]},{"content":"Hosting a Windows Forms User Control as an MFC View","pos":[5468,5519]}],"content":"---\ntitle: \"How to: Create the User Control and Host MDI View | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC [C++], Windows Forms Controls\"\n  - \"Windows Forms [C++], MFC support\"\nms.assetid: 625b5821-f923-4701-aca0-c1a4ceca4f63\ncaps.latest.revision: 25\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Create the User Control and Host MDI View\nThe following steps show how to create a .NET Framework user control, author the user control in a control class library (specifically, a Windows Control Library project), and then compile the project into an assembly. The control can then be consumed from an MFC application that uses classes derived from [CView Class](../mfc/reference/cview-class.md) and [CWinFormsView Class](../mfc/reference/cwinformsview-class.md).  \n  \n For information about how to create a Windows Forms user control and author a control class library, see [How to: Author User Controls](http://msdn.microsoft.com/Library/79c9cf05-5ab6-4a18-886d-88a64748b098).  \n  \n> [!NOTE]\n>  In some cases, Windows Forms controls, such as a third-party Grid control, might not behave reliably when hosted in an MFC application. A recommended workaround is to place a Windows Forms User Control in the MFC application and place the third-party Grid control inside the User control.  \n  \n This procedure assumes that you created a Windows Forms Controls Library project named WindowsFormsControlLibrary1, as per the procedure in [How to: Create the User Control and Host in a Dialog Box](../dotnet/how-to-create-the-user-control-and-host-in-a-dialog-box.md).  \n  \n### To create the MFC host application  \n  \n1.  Create an MFC Application project.  \n  \n     On the **File** menu, select **New**, and then click **Project**. In the **Visual C++** folder, select **MFC Application**.  \n  \n     In the **Name** box, enter `MFC02` and change the **Solution** setting to **Add to Solution**. Click **OK**.  \n  \n     In the **MFC Application Wizard**, accept all the defaults, and then click **Finish**. This creates an MFC application with a Multiple Document Interface.  \n  \n2.  Configure the project for Common Language Runtime (CLR) support.  \n  \n     In **Solution Explorer**, right-click the `MFC01` project node, and select **Properties** from the context menu. The **Property Pages** dialog box appears.  \n  \n     Under **Configuration Properties**, select **General**. Under the **Project Defaults** section, set **Common Language Runtime support** to **Common Language Runtime Support (/clr)**.  \n  \n     Under **Configuration Properties**, expand **C/C++** and click the **General** node. Set **Debug Information Format** to **Program Database (/Zi)**.  \n  \n     Click the **Code Generation** node. Set **Enable Minimal Rebuild** to **No (/Gm-)**. Also set **Basic Runtime Checks** to **Default**.  \n  \n     Click **OK** to apply your changes.  \n  \n3.  In stdafx.h, add the following line:  \n  \n    ```  \n    #using <System.Windows.Forms.dll>  \n    ```  \n  \n4.  Add a reference to the .NET control.  \n  \n     In **Solution Explorer**, right-click the `MFC02` project node and select **Add**, **References**. In the **Property Page**, click **Add New Reference**, select WindowsFormsControlLibrary1 (under the **Projects** tab), and click **OK**. This adds a reference in the form of a [/FU](../build/reference/fu-name-forced-hash-using-file.md) compiler option so that the program will compile; it also copies WindowsFormsControlLibrary1.dll into the `MFC02` project directory so that the program will run.  \n  \n5.  In stdafx.h, find this line:  \n  \n    ```  \n    #endif // _AFX_NO_AFXCMN_SUPPORT   \n    ```  \n  \n     Add these lines above it:  \n  \n    ```  \n    #include <afxwinforms.h>   // MFC Windows Forms support  \n    ```  \n  \n6.  Modify the view class so that it inherits from [CWinFormsView](../mfc/reference/cwinformsview-class.md).  \n  \n     In MFC02View.h, replace [CView](../mfc/reference/cview-class.md) with [CWinFormsView](../mfc/reference/cwinformsview-class.md) so that the code appears as follows:  \n  \n    ```  \n    class CMFC02View : public CWinFormsView  \n    {  \n    };  \n    ```  \n  \n     If you want add additional views to your MDI application, you will need to call [CWinApp::AddDocTemplate](../mfc/reference/cwinapp-class.md#cwinapp__adddoctemplate) for each view you create.  \n  \n7.  Modify the MFC02View.cpp file to change CView to CWinFormsView in the IMPLEMENT_DYNCREATE macro and message map and replace the existing empty constructor with the constructor shown below:  \n  \n    ```  \n    IMPLEMENT_DYNCREATE(CMFC02View, CWinFormsView)  \n  \n    CMFC02View::CMFC02View(): CWinFormsView(WindowsFormsControlLibrary1::UserControl1::typeid)   \n    {  \n    }  \n    BEGIN_MESSAGE_MAP(CMFC02View, CWinFormsView)  \n    //leave existing body as is  \n    END_MESSAGE_MAP()  \n    ```  \n  \n8.  Build and run the project.  \n  \n     In **Solution Explorer**, right-click MFC02 and select **Set as StartUp Project**.  \n  \n     On the **Build** menu, click **Build Solution**.  \n  \n     On the **Debug** menu, click **Start without debugging**.  \n  \n## See Also  \n [Hosting a Windows Forms User Control as an MFC View](../dotnet/hosting-a-windows-forms-user-control-as-an-mfc-view.md)"}