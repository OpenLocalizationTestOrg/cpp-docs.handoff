{"nodes":[{"pos":[12,42],"content":"_bstr_t Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"_bstr_t Class | Microsoft Docs","pos":[0,30]}]},{"content":"_bstr_t Class","pos":[658,671]},{"content":"Microsoft Specific","pos":[674,692]},{"content":"A <ph id=\"ph1\">`_bstr_t`</ph> object encapsulates the <bpt id=\"p1\">[</bpt>BSTR data type<ept id=\"p1\">](http://msdn.microsoft.com/en-us/1b2d7d2c-47af-4389-a6b6-b01b7e915228)</ept>.","pos":[701,824],"source":"A `_bstr_t` object encapsulates the [BSTR data type](http://msdn.microsoft.com/en-us/1b2d7d2c-47af-4389-a6b6-b01b7e915228)."},{"content":"The class manages resource allocation and deallocation through function calls to <bpt id=\"p1\">**</bpt>SysAllocString<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>SysFreeString<ept id=\"p2\">**</ept> and other <ph id=\"ph1\">`BSTR`</ph> APIs when appropriate.","pos":[825,986],"source":" The class manages resource allocation and deallocation through function calls to **SysAllocString** and **SysFreeString** and other `BSTR` APIs when appropriate."},{"content":"The <ph id=\"ph1\">`_bstr_t`</ph> class uses reference counting to avoid excessive overhead.","pos":[987,1059],"source":" The `_bstr_t` class uses reference counting to avoid excessive overhead."},{"content":"Construction","pos":[1069,1081]},{"content":"_bstr_t","pos":[1103,1110]},{"pos":[1137,1167],"content":"Constructs a <ph id=\"ph1\">`_bstr_t`</ph> object.","source":"Constructs a `_bstr_t` object."},{"content":"Operations","pos":[1178,1188]},{"content":"Assign","pos":[1210,1216]},{"pos":[1243,1298],"content":"Copies a <ph id=\"ph1\">`BSTR`</ph> into the <ph id=\"ph2\">`BSTR`</ph> wrapped by a <ph id=\"ph3\">`_bstr_t`</ph>.","source":"Copies a `BSTR` into the `BSTR` wrapped by a `_bstr_t`."},{"content":"Attach","pos":[1304,1310]},{"pos":[1337,1375],"content":"Links a <ph id=\"ph1\">`_bstr_t`</ph> wrapper to a <ph id=\"ph2\">`BSTR`</ph>.","source":"Links a `_bstr_t` wrapper to a `BSTR`."},{"content":"copy","pos":[1381,1385]},{"pos":[1410,1455],"content":"Constructs a copy of the encapsulated <ph id=\"ph1\">`BSTR`</ph>.","source":"Constructs a copy of the encapsulated `BSTR`."},{"content":"Detach","pos":[1461,1467]},{"pos":[1494,1579],"content":"Returns the <ph id=\"ph1\">`BSTR`</ph> wrapped by a <ph id=\"ph2\">`_bstr_t`</ph> and detaches the <ph id=\"ph3\">`BSTR`</ph> from the <ph id=\"ph4\">`_bstr_t`</ph>.","source":"Returns the `BSTR` wrapped by a `_bstr_t` and detaches the `BSTR` from the `_bstr_t`."},{"content":"GetAddress","pos":[1585,1595]},{"pos":[1626,1670],"content":"Points to the <ph id=\"ph1\">`BSTR`</ph> wrapped by a <ph id=\"ph2\">`_bstr_t`</ph>.","source":"Points to the `BSTR` wrapped by a `_bstr_t`."},{"content":"GetBSTR","pos":[1676,1683]},{"pos":[1711,1774],"content":"Points to the beginning of the <ph id=\"ph1\">`BSTR`</ph> wrapped by the <ph id=\"ph2\">`_bstr_t`</ph>.","source":"Points to the beginning of the `BSTR` wrapped by the `_bstr_t`."},{"content":"length","pos":[1780,1786]},{"pos":[1813,1863],"content":"Returns the number of characters in the <ph id=\"ph1\">`_bstr_t`</ph>.","source":"Returns the number of characters in the `_bstr_t`."},{"content":"Operators","pos":[1874,1883]},{"content":"operator =","pos":[1905,1915]},{"pos":[1950,2002],"content":"Assigns a new value to an existing <ph id=\"ph1\">`_bstr_t`</ph> object.","source":"Assigns a new value to an existing `_bstr_t` object."},{"content":"operator +=","pos":[2008,2019]},{"pos":[2063,2117],"content":"Appends characters to the end of the <ph id=\"ph1\">`_bstr_t`</ph> object.","source":"Appends characters to the end of the `_bstr_t` object."},{"content":"operator +","pos":[2123,2133]},{"content":"Concatenates two strings.","pos":[2177,2202]},{"content":"operator !","pos":[2208,2218]},{"pos":[2259,2314],"content":"Checks if the encapsulated <ph id=\"ph1\">`BSTR`</ph> is a <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> string.","source":"Checks if the encapsulated `BSTR` is a **NULL** string."},{"content":"operator ==, !=, <ph id=\"ph1\">\\&lt;</ph>, &gt;, <ph id=\"ph2\">\\&lt;</ph>=, &gt;=","pos":[2320,2351],"source":"operator ==, !=, \\<, >, \\<=, >="},{"pos":[2392,2423],"content":"Compares two <ph id=\"ph1\">`_bstr_t`</ph> objects.","source":"Compares two `_bstr_t` objects."},{"content":"operator wchar_t* &amp;#124; char","pos":[2429,2458],"source":"operator wchar_t* &#124; char"},{"pos":[2510,2586],"content":"Extract the pointers to the encapsulated Unicode or multibyte <ph id=\"ph1\">`BSTR`</ph> object.","source":"Extract the pointers to the encapsulated Unicode or multibyte `BSTR` object."},{"content":"END Microsoft Specific","pos":[2596,2618]},{"content":"Requirements","pos":[2627,2639]},{"pos":[2643,2664],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> comutil.h","source":"**Header:** comutil.h"},{"pos":[2671,2832],"content":"<bpt id=\"p1\">**</bpt>Lib:<ept id=\"p1\">**</ept> comsuppw.lib or comsuppwd.lib (see <bpt id=\"p2\">[</bpt>/Zc:wchar_t (wchar_t Is Native Type)<ept id=\"p2\">](../build/reference/zc-wchar-t-wchar-t-is-native-type.md)</ept> for more information)","source":"**Lib:** comsuppw.lib or comsuppwd.lib (see [/Zc:wchar_t (wchar_t Is Native Type)](../build/reference/zc-wchar-t-wchar-t-is-native-type.md) for more information)"},{"content":"See Also","pos":[2841,2849]},{"content":"Compiler COM Support Classes","pos":[2854,2882]}],"content":"---\ntitle: \"_bstr_t Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\nf1_keywords: \n  - \"_bstr_t\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"BSTR object\"\n  - \"_bstr_t class\"\n  - \"BSTR object, COM encapsulation\"\nms.assetid: 58841fef-fe21-4a84-aab9-780262b5201f\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# _bstr_t Class\n**Microsoft Specific**  \n  \n A `_bstr_t` object encapsulates the [BSTR data type](http://msdn.microsoft.com/en-us/1b2d7d2c-47af-4389-a6b6-b01b7e915228). The class manages resource allocation and deallocation through function calls to **SysAllocString** and **SysFreeString** and other `BSTR` APIs when appropriate. The `_bstr_t` class uses reference counting to avoid excessive overhead.  \n  \n### Construction  \n  \n|||  \n|-|-|  \n|[_bstr_t](../cpp/bstr-t-bstr-t.md)|Constructs a `_bstr_t` object.|  \n  \n### Operations  \n  \n|||  \n|-|-|  \n|[Assign](../cpp/bstr-t-assign.md)|Copies a `BSTR` into the `BSTR` wrapped by a `_bstr_t`.|  \n|[Attach](../cpp/bstr-t-attach.md)|Links a `_bstr_t` wrapper to a `BSTR`.|  \n|[copy](../cpp/bstr-t-copy.md)|Constructs a copy of the encapsulated `BSTR`.|  \n|[Detach](../cpp/bstr-t-detach.md)|Returns the `BSTR` wrapped by a `_bstr_t` and detaches the `BSTR` from the `_bstr_t`.|  \n|[GetAddress](../cpp/bstr-t-getaddress.md)|Points to the `BSTR` wrapped by a `_bstr_t`.|  \n|[GetBSTR](../cpp/bstr-t-getbstr.md)|Points to the beginning of the `BSTR` wrapped by the `_bstr_t`.|  \n|[length](../cpp/bstr-t-length.md)|Returns the number of characters in the `_bstr_t`.|  \n  \n### Operators  \n  \n|||  \n|-|-|  \n|[operator =](../cpp/bstr-t-operator-equal.md)|Assigns a new value to an existing `_bstr_t` object.|  \n|[operator +=](../cpp/bstr-t-operator-add-equal-plus.md)|Appends characters to the end of the `_bstr_t` object.|  \n|[operator +](../cpp/bstr-t-operator-add-equal-plus.md)|Concatenates two strings.|  \n|[operator !](../cpp/bstr-t-operator-logical-not.md)|Checks if the encapsulated `BSTR` is a **NULL** string.|  \n|[operator ==, !=, \\<, >, \\<=, >=](../cpp/bstr-t-relational-operators.md)|Compares two `_bstr_t` objects.|  \n|[operator wchar_t* &#124; char\\*](../cpp/bstr-t-wchar-t-star-bstr-t-char-star.md)|Extract the pointers to the encapsulated Unicode or multibyte `BSTR` object.|  \n  \n## END Microsoft Specific  \n  \n## Requirements  \n **Header:** comutil.h  \n  \n **Lib:** comsuppw.lib or comsuppwd.lib (see [/Zc:wchar_t (wchar_t Is Native Type)](../build/reference/zc-wchar-t-wchar-t-is-native-type.md) for more information)  \n  \n## See Also  \n [Compiler COM Support Classes](../cpp/compiler-com-support-classes.md)"}