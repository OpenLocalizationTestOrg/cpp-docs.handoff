{"nodes":[{"pos":[12,48],"content":"CComApartment Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComApartment Class | Microsoft Docs","pos":[0,36]}]},{"pos":[698,717],"content":"CComApartment Class","linkify":"CComApartment Class","nodes":[{"content":"CComApartment Class","pos":[0,19]}]},{"content":"This class provides support for managing an appartment in a thread-pooled EXE module.","pos":[718,803]},{"pos":[811,921],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"pos":[930,936],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[978,985],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[995,1014],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1021,1025]},{"content":"Description","pos":[1026,1037]},{"pos":[1075,1136],"content":"<bpt id=\"p1\">[</bpt>CComApartment::CComApartment<ept id=\"p1\">](#ccomapartment__ccomapartment)</ept>","source":"[CComApartment::CComApartment](#ccomapartment__ccomapartment)"},{"content":"The constructor.","pos":[1137,1153]},{"pos":[1164,1178],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1185,1189]},{"content":"Description","pos":[1190,1201]},{"pos":[1239,1292],"content":"<bpt id=\"p1\">[</bpt>CComApartment::Apartment<ept id=\"p1\">](#ccomapartment__apartment)</ept>","source":"[CComApartment::Apartment](#ccomapartment__apartment)"},{"content":"Marks the thread's starting address.","pos":[1293,1329]},{"pos":[1334,1393],"content":"<bpt id=\"p1\">[</bpt>CComApartment::GetLockCount<ept id=\"p1\">](#ccomapartment__getlockcount)</ept>","source":"[CComApartment::GetLockCount](#ccomapartment__getlockcount)"},{"content":"Returns the thread's current lock count.","pos":[1394,1434]},{"pos":[1439,1482],"content":"<bpt id=\"p1\">[</bpt>CComApartment::Lock<ept id=\"p1\">](#ccomapartment__lock)</ept>","source":"[CComApartment::Lock](#ccomapartment__lock)"},{"content":"Increments the thread's lock count.","pos":[1483,1518]},{"pos":[1523,1570],"content":"<bpt id=\"p1\">[</bpt>CComApartment::Unlock<ept id=\"p1\">](#ccomapartment__unlock)</ept>","source":"[CComApartment::Unlock](#ccomapartment__unlock)"},{"content":"Decrements the thread's lock count.","pos":[1571,1606]},{"pos":[1617,1636],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[1643,1647]},{"content":"Description","pos":[1648,1659]},{"pos":[1697,1756],"content":"<bpt id=\"p1\">[</bpt>CComApartment::m_dwThreadID<ept id=\"p1\">](#ccomapartment__m_dwthreadid)</ept>","source":"[CComApartment::m_dwThreadID](#ccomapartment__m_dwthreadid)"},{"content":"Contains the thread's identifier.","pos":[1757,1790]},{"pos":[1795,1848],"content":"<bpt id=\"p1\">[</bpt>CComApartment::m_hThread<ept id=\"p1\">](#ccomapartment__m_hthread)</ept>","source":"[CComApartment::m_hThread](#ccomapartment__m_hthread)"},{"content":"Contains the thread's handle.","pos":[1849,1878]},{"pos":[1883,1938],"content":"<bpt id=\"p1\">[</bpt>CComApartment::m_nLockCnt<ept id=\"p1\">](#ccomapartment__m_nlockcnt)</ept>","source":"[CComApartment::m_nLockCnt](#ccomapartment__m_nlockcnt)"},{"content":"Contains the thread's current lock count.","pos":[1939,1980]},{"pos":[1990,1997],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`CComApartment`</ph> is used by <bpt id=\"p1\">[</bpt>CComAutoThreadModule<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md)</ept> to manage an apartment in a thread-pooled EXE module.","pos":[2001,2155],"source":"`CComApartment` is used by [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) to manage an apartment in a thread-pooled EXE module."},{"content":"<ph id=\"ph1\">`CComApartment`</ph> provides methods for incrementing and decrementing the lock count on a thread.","pos":[2156,2250],"source":"`CComApartment` provides methods for incrementing and decrementing the lock count on a thread."},{"pos":[2259,2271],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2275,2296],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlbase.h","source":"**Header:** atlbase.h"},{"pos":[2306,2371],"content":"<bpt id=\"p1\">&lt;a name=\"ccomapartment__apartment\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComApartment::Apartment","linkify":"<a name=\"ccomapartment__apartment\"></a>  CComApartment::Apartment","source":"<a name=\"ccomapartment__apartment\"></a>  CComApartment::Apartment"},{"content":"Marks the thread's starting address.","pos":[2375,2411]},{"pos":[2453,2465],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Always 0.","pos":[2469,2478]},{"pos":[2488,2495],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2499,2631],"content":"Automatically set during <bpt id=\"p1\">[</bpt>CComAutoThreadModule::Init<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__init)</ept>.","source":"Automatically set during [CComAutoThreadModule::Init](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__init)."},{"pos":[2641,2714],"content":"<bpt id=\"p1\">&lt;a name=\"ccomapartment__ccomapartment\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComApartment::CComApartment","linkify":"<a name=\"ccomapartment__ccomapartment\"></a>  CComApartment::CComApartment","source":"<a name=\"ccomapartment__ccomapartment\"></a>  CComApartment::CComApartment"},{"content":"The constructor.","pos":[2718,2734]},{"pos":[2774,2781],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2785,2914],"content":"Initializes the <ph id=\"ph1\">`CComApartment`</ph> data members <bpt id=\"p1\">[</bpt>m_nLockCnt<ept id=\"p1\">](#ccomapartment__m_nlockcnt)</ept> and <bpt id=\"p2\">[</bpt>m_hThread<ept id=\"p2\">](#ccomapartment__m_hthread)</ept>.","source":"Initializes the `CComApartment` data members [m_nLockCnt](#ccomapartment__m_nlockcnt) and [m_hThread](#ccomapartment__m_hthread)."},{"pos":[2924,2995],"content":"<bpt id=\"p1\">&lt;a name=\"ccomapartment__getlockcount\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComApartment::GetLockCount","linkify":"<a name=\"ccomapartment__getlockcount\"></a>  CComApartment::GetLockCount","source":"<a name=\"ccomapartment__getlockcount\"></a>  CComApartment::GetLockCount"},{"content":"Returns the thread's current lock count.","pos":[2999,3039]},{"pos":[3083,3095],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The lock count on the thread.","pos":[3099,3128]},{"pos":[3138,3193],"content":"<bpt id=\"p1\">&lt;a name=\"ccomapartment__lock\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComApartment::Lock","linkify":"<a name=\"ccomapartment__lock\"></a>  CComApartment::Lock","source":"<a name=\"ccomapartment__lock\"></a>  CComApartment::Lock"},{"content":"Increments the thread's lock count.","pos":[3197,3232]},{"pos":[3268,3280],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A value that may be useful for diagnostics or testing.","pos":[3284,3338]},{"pos":[3348,3355],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3359,3476],"content":"Called by <bpt id=\"p1\">[</bpt>CComAutoThreadModule::Lock<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)</ept>.","source":"Called by [CComAutoThreadModule::Lock](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)."},{"content":"The lock count on the thread is used for statistical purposes.","pos":[3483,3545]},{"pos":[3555,3626],"content":"<bpt id=\"p1\">&lt;a name=\"ccomapartment__m_dwthreadid\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComApartment::m_dwThreadID","linkify":"<a name=\"ccomapartment__m_dwthreadid\"></a>  CComApartment::m_dwThreadID","source":"<a name=\"ccomapartment__m_dwthreadid\"></a>  CComApartment::m_dwThreadID"},{"content":"Contains the thread's identifier.","pos":[3630,3663]},{"pos":[3706,3771],"content":"<bpt id=\"p1\">&lt;a name=\"ccomapartment__m_hthread\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComApartment::m_hThread","linkify":"<a name=\"ccomapartment__m_hthread\"></a>  CComApartment::m_hThread","source":"<a name=\"ccomapartment__m_hthread\"></a>  CComApartment::m_hThread"},{"content":"Contains the thread's handle.","pos":[3775,3804]},{"pos":[3845,3912],"content":"<bpt id=\"p1\">&lt;a name=\"ccomapartment__m_nlockcnt\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComApartment::m_nLockCnt","linkify":"<a name=\"ccomapartment__m_nlockcnt\"></a>  CComApartment::m_nLockCnt","source":"<a name=\"ccomapartment__m_nlockcnt\"></a>  CComApartment::m_nLockCnt"},{"content":"Contains the thread's current lock count.","pos":[3916,3957]},{"pos":[3997,4056],"content":"<bpt id=\"p1\">&lt;a name=\"ccomapartment__unlock\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComApartment::Unlock","linkify":"<a name=\"ccomapartment__unlock\"></a>  CComApartment::Unlock","source":"<a name=\"ccomapartment__unlock\"></a>  CComApartment::Unlock"},{"content":"Decrements the thread's lock count.","pos":[4060,4095]},{"pos":[4133,4145],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A value that may be useful for diagnostics or testing.","pos":[4149,4203]},{"pos":[4213,4220],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4224,4343],"content":"Called by <bpt id=\"p1\">[</bpt>CComAutoThreadModule::Unlock<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)</ept>.","source":"Called by [CComAutoThreadModule::Unlock](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)."},{"content":"The lock count on the thread is used for statistical purposes.","pos":[4350,4412]},{"pos":[4421,4429],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[4433,4482],"content":"<bpt id=\"p1\">[</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","source":"[Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"CComApartment Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::CComApartment\"\n  - \"CComApartment\"\n  - \"ATL.CComApartment\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"apartments in ATL EXE modules\"\n  - \"CComApartment class\"\nms.assetid: dbc177d7-7ee4-45f2-b563-d578a467ca93\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComApartment Class\nThis class provides support for managing an appartment in a thread-pooled EXE module.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\nclass CComApartment\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComApartment::CComApartment](#ccomapartment__ccomapartment)|The constructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComApartment::Apartment](#ccomapartment__apartment)|Marks the thread's starting address.|  \n|[CComApartment::GetLockCount](#ccomapartment__getlockcount)|Returns the thread's current lock count.|  \n|[CComApartment::Lock](#ccomapartment__lock)|Increments the thread's lock count.|  \n|[CComApartment::Unlock](#ccomapartment__unlock)|Decrements the thread's lock count.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComApartment::m_dwThreadID](#ccomapartment__m_dwthreadid)|Contains the thread's identifier.|  \n|[CComApartment::m_hThread](#ccomapartment__m_hthread)|Contains the thread's handle.|  \n|[CComApartment::m_nLockCnt](#ccomapartment__m_nlockcnt)|Contains the thread's current lock count.|  \n  \n## Remarks  \n `CComApartment` is used by [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) to manage an apartment in a thread-pooled EXE module. `CComApartment` provides methods for incrementing and decrementing the lock count on a thread.  \n  \n## Requirements  \n **Header:** atlbase.h  \n  \n##  <a name=\"ccomapartment__apartment\"></a>  CComApartment::Apartment  \n Marks the thread's starting address.  \n  \n```\nDWORD Apartment();\n```  \n  \n### Return Value  \n Always 0.  \n  \n### Remarks  \n Automatically set during [CComAutoThreadModule::Init](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__init).  \n  \n##  <a name=\"ccomapartment__ccomapartment\"></a>  CComApartment::CComApartment  \n The constructor.  \n  \n```\nCComApartment();\n```  \n  \n### Remarks  \n Initializes the `CComApartment` data members [m_nLockCnt](#ccomapartment__m_nlockcnt) and [m_hThread](#ccomapartment__m_hthread).  \n  \n##  <a name=\"ccomapartment__getlockcount\"></a>  CComApartment::GetLockCount  \n Returns the thread's current lock count.  \n  \n```\nLONG GetLockCount();\n```  \n  \n### Return Value  \n The lock count on the thread.  \n  \n##  <a name=\"ccomapartment__lock\"></a>  CComApartment::Lock  \n Increments the thread's lock count.  \n  \n```\nLONG Lock();\n```  \n  \n### Return Value  \n A value that may be useful for diagnostics or testing.  \n  \n### Remarks  \n Called by [CComAutoThreadModule::Lock](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock).  \n  \n The lock count on the thread is used for statistical purposes.  \n  \n##  <a name=\"ccomapartment__m_dwthreadid\"></a>  CComApartment::m_dwThreadID  \n Contains the thread's identifier.  \n  \n```\nDWORD m_dwThreadID;\n```  \n  \n##  <a name=\"ccomapartment__m_hthread\"></a>  CComApartment::m_hThread  \n Contains the thread's handle.  \n  \n```\nHANDLE m_hThread;\n```  \n  \n##  <a name=\"ccomapartment__m_nlockcnt\"></a>  CComApartment::m_nLockCnt  \n Contains the thread's current lock count.  \n  \n```\nLONG m_nLockCnt;\n```  \n  \n##  <a name=\"ccomapartment__unlock\"></a>  CComApartment::Unlock  \n Decrements the thread's lock count.  \n  \n```\nLONG Unlock();\n```  \n  \n### Return Value  \n A value that may be useful for diagnostics or testing.  \n  \n### Remarks  \n Called by [CComAutoThreadModule::Unlock](../../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock).  \n  \n The lock count on the thread is used for statistical purposes.  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}