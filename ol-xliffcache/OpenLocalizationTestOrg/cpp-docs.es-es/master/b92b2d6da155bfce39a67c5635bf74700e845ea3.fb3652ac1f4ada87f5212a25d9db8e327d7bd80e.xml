{"nodes":[{"pos":[12,52],"content":"IObjectSafetyImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IObjectSafetyImpl Class | Microsoft Docs","pos":[0,40]}]},{"pos":[747,770],"content":"IObjectSafetyImpl Class","linkify":"IObjectSafetyImpl Class","nodes":[{"content":"IObjectSafetyImpl Class","pos":[0,23]}]},{"pos":[771,913],"content":"This class provides a default implementation of the <ph id=\"ph1\">`IObjectSafety`</ph> interface to allow a client to retrieve and set an object's safety levels.","source":"This class provides a default implementation of the `IObjectSafety` interface to allow a client to retrieve and set an object's safety levels."},{"pos":[921,1071],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,148],"source":" This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"pos":[1080,1086],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1178,1188],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Your class, derived from <ph id=\"ph1\">`IObjectSafetyImpl`</ph>.","pos":[1199,1244],"source":" Your class, derived from `IObjectSafetyImpl`."},{"content":"<bpt id=\"p1\">*</bpt>dwSupportedSafety<ept id=\"p1\">*</ept>","pos":[1251,1270],"source":"*dwSupportedSafety*"},{"content":"Specifies the supported safety options for the control.","pos":[1274,1329]},{"content":"Can be one of the following values:","pos":[1330,1365]},{"pos":[1373,1570],"content":"<bpt id=\"p1\">**</bpt>INTERFACESAFE_FOR_UNTRUSTED_CALLER<ept id=\"p1\">**</ept> The interface identified by the <bpt id=\"p2\">[</bpt>SetInterfaceSafetyOptions<ept id=\"p2\">](#iobjectsafetyimpl__setinterfacesafetyoptions)</ept> parameter <ph id=\"ph1\">`riid`</ph> should be made safe for scripting.","source":"**INTERFACESAFE_FOR_UNTRUSTED_CALLER** The interface identified by the [SetInterfaceSafetyOptions](#iobjectsafetyimpl__setinterfacesafetyoptions) parameter `riid` should be made safe for scripting."},{"pos":[1578,1753],"content":"<bpt id=\"p1\">**</bpt>INTERFACESAFE_FOR_UNTRUSTED_DATA<ept id=\"p1\">**</ept> The interface identified by the <ph id=\"ph1\">`SetInterfaceSafetyOptions`</ph> parameter <ph id=\"ph2\">`riid`</ph> should be made safe for untrusted data during initialization.","source":"**INTERFACESAFE_FOR_UNTRUSTED_DATA** The interface identified by the `SetInterfaceSafetyOptions` parameter `riid` should be made safe for untrusted data during initialization."},{"pos":[1762,1769],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1779,1793],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1800,1804]},{"content":"Description","pos":[1805,1816]},{"pos":[1854,1947],"content":"<bpt id=\"p1\">[</bpt>IObjectSafetyImpl::GetInterfaceSafetyOptions<ept id=\"p1\">](#iobjectsafetyimpl__getinterfacesafetyoptions)</ept>","source":"[IObjectSafetyImpl::GetInterfaceSafetyOptions](#iobjectsafetyimpl__getinterfacesafetyoptions)"},{"content":"Retrieves the safety options supported by the object, as well as the safety options currently set for the object.","pos":[1948,2061]},{"pos":[2066,2159],"content":"<bpt id=\"p1\">[</bpt>IObjectSafetyImpl::SetInterfaceSafetyOptions<ept id=\"p1\">](#iobjectsafetyimpl__setinterfacesafetyoptions)</ept>","source":"[IObjectSafetyImpl::SetInterfaceSafetyOptions](#iobjectsafetyimpl__setinterfacesafetyoptions)"},{"content":"Makes the object safe for initialization or scripting.","pos":[2160,2214]},{"pos":[2225,2244],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[2251,2255]},{"content":"Description","pos":[2256,2267]},{"pos":[2305,2382],"content":"<bpt id=\"p1\">[</bpt>IObjectSafetyImpl::m_dwCurrentSafety<ept id=\"p1\">](#iobjectsafetyimpl__m_dwcurrentsafety)</ept>","source":"[IObjectSafetyImpl::m_dwCurrentSafety](#iobjectsafetyimpl__m_dwcurrentsafety)"},{"content":"Stores the object's current safety level.","pos":[2383,2424]},{"pos":[2434,2441],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Class <ph id=\"ph1\">`IObjectSafetyImpl`</ph> provides a default implementation of <ph id=\"ph2\">`IObjectSafety`</ph>.","pos":[2445,2524],"source":"Class `IObjectSafetyImpl` provides a default implementation of `IObjectSafety`."},{"content":"The <ph id=\"ph1\">`IObjectSafety`</ph> interface allows a client to retrieve and set an object's safety levels.","pos":[2525,2617],"source":" The `IObjectSafety` interface allows a client to retrieve and set an object's safety levels."},{"content":"For example, a web browser can call <bpt id=\"p1\">**</bpt>IObjectSafety::SetInterfaceSafetyOptions<ept id=\"p1\">**</ept> to make a control safe for initialization or safe for scripting.","pos":[2618,2763],"source":" For example, a web browser can call **IObjectSafety::SetInterfaceSafetyOptions** to make a control safe for initialization or safe for scripting."},{"pos":[2770,3049],"content":"Note that using the <bpt id=\"p1\">[</bpt>IMPLEMENTED_CATEGORY<ept id=\"p1\">](http://msdn.microsoft.com/library/d898ef34-5684-4709-beb9-7114ddd96674)</ept> macro with the <bpt id=\"p2\">**</bpt>CATID_SafeForScripting<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>CATID_SafeForInitializing<ept id=\"p3\">**</ept> component categories provides an alternative way of specifying that a component is safe.","source":"Note that using the [IMPLEMENTED_CATEGORY](http://msdn.microsoft.com/library/d898ef34-5684-4709-beb9-7114ddd96674) macro with the **CATID_SafeForScripting** and **CATID_SafeForInitializing** component categories provides an alternative way of specifying that a component is safe."},{"pos":[3056,3217],"content":"<bpt id=\"p1\">**</bpt>Related Articles<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>ATL Tutorial<ept id=\"p2\">](../../atl/active-template-library-atl-tutorial.md)</ept>, <bpt id=\"p3\">[</bpt>Creating an ATL Project<ept id=\"p3\">](../../atl/reference/creating-an-atl-project.md)</ept>","source":"**Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)"},{"pos":[3226,3247],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3301,3313],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3317,3337],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlctl.h","source":"**Header:** atlctl.h"},{"pos":[3347,3452],"content":"<bpt id=\"p1\">&lt;a name=\"iobjectsafetyimpl__getinterfacesafetyoptions\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IObjectSafetyImpl::GetInterfaceSafetyOptions","linkify":"<a name=\"iobjectsafetyimpl__getinterfacesafetyoptions\"></a>  IObjectSafetyImpl::GetInterfaceSafetyOptions","source":"<a name=\"iobjectsafetyimpl__getinterfacesafetyoptions\"></a>  IObjectSafetyImpl::GetInterfaceSafetyOptions"},{"content":"Retrieves the safety options supported by the object, as well as the safety options currently set for the object.","pos":[3456,3569]},{"pos":[3702,3709],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3713,3854],"content":"The implementation returns the appropriate values for any interface supported by the object's implementation of <bpt id=\"p1\">**</bpt>IUnknown::QueryInterface<ept id=\"p1\">**</ept>.","source":"The implementation returns the appropriate values for any interface supported by the object's implementation of **IUnknown::QueryInterface**."},{"pos":[3862,4143],"content":"[!IMPORTANT]\n Any object that supports `IObjectSafety` is responsible for its own security, and that of any object it delegates. The programmer must take into account issues arising from running code in the user's context, cross-site scripting and perform suitable zone checking.","leadings":["","> "],"nodes":[{"content":" Any object that supports `IObjectSafety` is responsible for its own security, and that of any object it delegates. The programmer must take into account issues arising from running code in the user's context, cross-site scripting and perform suitable zone checking.","pos":[13,279],"nodes":[{"content":"Any object that supports <ph id=\"ph1\">`IObjectSafety`</ph> is responsible for its own security, and that of any object it delegates.","pos":[1,115],"source":" Any object that supports `IObjectSafety` is responsible for its own security, and that of any object it delegates."},{"content":"The programmer must take into account issues arising from running code in the user's context, cross-site scripting and perform suitable zone checking.","pos":[116,266]}]}]},{"pos":[4150,4306],"content":"See <bpt id=\"p1\">[</bpt>IObjectSafety::GetInterfaceSafetyOptions<ept id=\"p1\">](https://msdn.microsoft.com/library/aa768223.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IObjectSafety::GetInterfaceSafetyOptions](https://msdn.microsoft.com/library/aa768223.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4316,4405],"content":"<bpt id=\"p1\">&lt;a name=\"iobjectsafetyimpl__m_dwcurrentsafety\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IObjectSafetyImpl::m_dwCurrentSafety","linkify":"<a name=\"iobjectsafetyimpl__m_dwcurrentsafety\"></a>  IObjectSafetyImpl::m_dwCurrentSafety","source":"<a name=\"iobjectsafetyimpl__m_dwcurrentsafety\"></a>  IObjectSafetyImpl::m_dwCurrentSafety"},{"content":"Stores the object's current safety level.","pos":[4409,4450]},{"pos":[4498,4603],"content":"<bpt id=\"p1\">&lt;a name=\"iobjectsafetyimpl__setinterfacesafetyoptions\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IObjectSafetyImpl::SetInterfaceSafetyOptions","linkify":"<a name=\"iobjectsafetyimpl__setinterfacesafetyoptions\"></a>  IObjectSafetyImpl::SetInterfaceSafetyOptions","source":"<a name=\"iobjectsafetyimpl__setinterfacesafetyoptions\"></a>  IObjectSafetyImpl::SetInterfaceSafetyOptions"},{"pos":[4607,4767],"content":"Makes the object safe for initialization or scripting by setting the <bpt id=\"p1\">[</bpt>m_dwCurrentSafety<ept id=\"p1\">](#iobjectsafetyimpl__m_dwcurrentsafety)</ept> member to the appropriate value.","source":"Makes the object safe for initialization or scripting by setting the [m_dwCurrentSafety](#iobjectsafetyimpl__m_dwcurrentsafety) member to the appropriate value."},{"pos":[4894,4901],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4905,5045],"content":"The implementation returns <bpt id=\"p1\">**</bpt>E_NOINTERFACE<ept id=\"p1\">**</ept> for any interface not supported by the object's implementation of <bpt id=\"p2\">**</bpt>IUnknown::QueryInterface<ept id=\"p2\">**</ept>.","source":"The implementation returns **E_NOINTERFACE** for any interface not supported by the object's implementation of **IUnknown::QueryInterface**."},{"pos":[5053,5334],"content":"[!IMPORTANT]\n Any object that supports `IObjectSafety` is responsible for its own security, and that of any object it delegates. The programmer must take into account issues arising from running code in the user's context, cross-site scripting and perform suitable zone checking.","leadings":["","> "],"nodes":[{"content":" Any object that supports `IObjectSafety` is responsible for its own security, and that of any object it delegates. The programmer must take into account issues arising from running code in the user's context, cross-site scripting and perform suitable zone checking.","pos":[13,279],"nodes":[{"content":"Any object that supports <ph id=\"ph1\">`IObjectSafety`</ph> is responsible for its own security, and that of any object it delegates.","pos":[1,115],"source":" Any object that supports `IObjectSafety` is responsible for its own security, and that of any object it delegates."},{"content":"The programmer must take into account issues arising from running code in the user's context, cross-site scripting and perform suitable zone checking.","pos":[116,266]}]}]},{"pos":[5341,5497],"content":"See <bpt id=\"p1\">[</bpt>IObjectSafety::SetInterfaceSafetyOptions<ept id=\"p1\">](https://msdn.microsoft.com/library/aa768225.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IObjectSafety::SetInterfaceSafetyOptions](https://msdn.microsoft.com/library/aa768225.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[5506,5514],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>IObjectSafety Interface<ept id=\"p1\">](https://msdn.microsoft.com/library/aa768224.aspx)</ept><ph id=\"ph1\"> </ph>","pos":[5518,5594],"source":"[IObjectSafety Interface](https://msdn.microsoft.com/library/aa768224.aspx) "},{"content":"<bpt id=\"p1\"> [</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","pos":[5597,5647],"source":" [Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"IObjectSafetyImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"IObjectSafetyImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"controls [ATL], safe\"\n  - \"safe for scripting and initialization (controls)\"\n  - \"IObjectSafety, ATL implementation\"\n  - \"IObjectSafetyImpl class\"\nms.assetid: 64e32082-d910-4a8a-a5bf-ebed9145359d\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IObjectSafetyImpl Class\nThis class provides a default implementation of the `IObjectSafety` interface to allow a client to retrieve and set an object's safety levels.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n## Syntax  \n  \n```\ntemplate <class T,DWORD dwSupportedSafety>  class IObjectSafetyImpl\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `IObjectSafetyImpl`.  \n  \n *dwSupportedSafety*  \n Specifies the supported safety options for the control. Can be one of the following values:  \n  \n- **INTERFACESAFE_FOR_UNTRUSTED_CALLER** The interface identified by the [SetInterfaceSafetyOptions](#iobjectsafetyimpl__setinterfacesafetyoptions) parameter `riid` should be made safe for scripting.  \n  \n- **INTERFACESAFE_FOR_UNTRUSTED_DATA** The interface identified by the `SetInterfaceSafetyOptions` parameter `riid` should be made safe for untrusted data during initialization.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IObjectSafetyImpl::GetInterfaceSafetyOptions](#iobjectsafetyimpl__getinterfacesafetyoptions)|Retrieves the safety options supported by the object, as well as the safety options currently set for the object.|  \n|[IObjectSafetyImpl::SetInterfaceSafetyOptions](#iobjectsafetyimpl__setinterfacesafetyoptions)|Makes the object safe for initialization or scripting.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IObjectSafetyImpl::m_dwCurrentSafety](#iobjectsafetyimpl__m_dwcurrentsafety)|Stores the object's current safety level.|  \n  \n## Remarks  \n Class `IObjectSafetyImpl` provides a default implementation of `IObjectSafety`. The `IObjectSafety` interface allows a client to retrieve and set an object's safety levels. For example, a web browser can call **IObjectSafety::SetInterfaceSafetyOptions** to make a control safe for initialization or safe for scripting.  \n  \n Note that using the [IMPLEMENTED_CATEGORY](http://msdn.microsoft.com/library/d898ef34-5684-4709-beb9-7114ddd96674) macro with the **CATID_SafeForScripting** and **CATID_SafeForInitializing** component categories provides an alternative way of specifying that a component is safe.  \n  \n **Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)  \n  \n## Inheritance Hierarchy  \n `IObjectSafety`  \n  \n `IObjectSafetyImpl`  \n  \n## Requirements  \n **Header:** atlctl.h  \n  \n##  <a name=\"iobjectsafetyimpl__getinterfacesafetyoptions\"></a>  IObjectSafetyImpl::GetInterfaceSafetyOptions  \n Retrieves the safety options supported by the object, as well as the safety options currently set for the object.  \n  \n```\nHRESULT GetInterfaceSafetyOptions(REFIID riid,\n    DWORD* pdwSupportedOptions,\n    DWORD* pdwEnabledOptions);\n```  \n  \n### Remarks  \n The implementation returns the appropriate values for any interface supported by the object's implementation of **IUnknown::QueryInterface**.  \n  \n> [!IMPORTANT]\n>  Any object that supports `IObjectSafety` is responsible for its own security, and that of any object it delegates. The programmer must take into account issues arising from running code in the user's context, cross-site scripting and perform suitable zone checking.  \n  \n See [IObjectSafety::GetInterfaceSafetyOptions](https://msdn.microsoft.com/library/aa768223.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"iobjectsafetyimpl__m_dwcurrentsafety\"></a>  IObjectSafetyImpl::m_dwCurrentSafety  \n Stores the object's current safety level.  \n  \n```\nDWORD m_dwCurrentSafety;\n```  \n  \n##  <a name=\"iobjectsafetyimpl__setinterfacesafetyoptions\"></a>  IObjectSafetyImpl::SetInterfaceSafetyOptions  \n Makes the object safe for initialization or scripting by setting the [m_dwCurrentSafety](#iobjectsafetyimpl__m_dwcurrentsafety) member to the appropriate value.  \n  \n```\nHRESULT SetInterfaceSafetyOptions(REFIID riid,\n    DWORD dwOptionsSetMask,\n    DWORD dwEnabledOptions);\n```  \n  \n### Remarks  \n The implementation returns **E_NOINTERFACE** for any interface not supported by the object's implementation of **IUnknown::QueryInterface**.  \n  \n> [!IMPORTANT]\n>  Any object that supports `IObjectSafety` is responsible for its own security, and that of any object it delegates. The programmer must take into account issues arising from running code in the user's context, cross-site scripting and perform suitable zone checking.  \n  \n See [IObjectSafety::SetInterfaceSafetyOptions](https://msdn.microsoft.com/library/aa768225.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [IObjectSafety Interface](https://msdn.microsoft.com/library/aa768224.aspx)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}