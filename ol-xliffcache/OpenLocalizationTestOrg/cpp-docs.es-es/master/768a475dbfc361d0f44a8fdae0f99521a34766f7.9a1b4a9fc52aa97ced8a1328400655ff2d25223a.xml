{"nodes":[{"pos":[12,57],"content":"Calculating Necessary Values | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Calculating Necessary Values | Microsoft Docs","pos":[0,45]}]},{"content":"Calculating Necessary Values","pos":[612,640]},{"content":"Two critical pieces of information need to be calculated by the delay helper routine.","pos":[641,726]},{"content":"To that end, there are two inline functions in delayhlp.cpp for calculating this information.","pos":[727,820]},{"content":"The first calculates the index of the current import into the three different tables (import address table (IAT), bound import address table (BIAT), and unbound import address table (UIAT)).","pos":[830,1020]},{"content":"The second counts the number of imports in a valid IAT.","pos":[1030,1085]},{"content":"See Also","pos":[1742,1750]},{"content":"Understanding the Helper Function","pos":[1755,1788]}],"content":"---\ntitle: \"Calculating Necessary Values | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"helper functions, calculating necessary values\"\nms.assetid: 4f037d0f-881a-4a48-a9d2-9f8872dfccb7\ncaps.latest.revision: 7\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Calculating Necessary Values\nTwo critical pieces of information need to be calculated by the delay helper routine. To that end, there are two inline functions in delayhlp.cpp for calculating this information.  \n  \n-   The first calculates the index of the current import into the three different tables (import address table (IAT), bound import address table (BIAT), and unbound import address table (UIAT)).  \n  \n-   The second counts the number of imports in a valid IAT.  \n  \n```  \n// utility function for calculating the index of the current import  \n// for all the tables (INT, BIAT, UIAT, and IAT).  \n__inline unsigned  \nIndexFromPImgThunkData(PCImgThunkData pitdCur, PCImgThunkData pitdBase) {  \n    return pitdCur - pitdBase;  \n    }  \n  \n// utility function for calculating the count of imports given the base  \n// of the IAT. NB: this only works on a valid IAT!  \n__inline unsigned  \nCountOfImports(PCImgThunkData pitdBase) {  \n    unsigned        cRet = 0;  \n    PCImgThunkData  pitd = pitdBase;  \n    while (pitd->u1.Function) {  \n        pitd++;  \n        cRet++;  \n        }  \n    return cRet;  \n    }  \n```  \n  \n## See Also  \n [Understanding the Helper Function](http://msdn.microsoft.com/en-us/6279c12c-d908-4967-b0b3-cabfc3e91d3d)"}