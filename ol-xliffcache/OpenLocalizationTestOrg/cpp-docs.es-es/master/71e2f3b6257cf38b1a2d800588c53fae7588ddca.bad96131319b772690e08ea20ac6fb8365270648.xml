{"nodes":[{"pos":[12,67],"content":"Linking to the CRT in Your ATL Project | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Linking to the CRT in Your ATL Project | Microsoft Docs","pos":[0,55]}]},{"content":"Linking to the CRT in Your ATL Project","pos":[815,853]},{"content":"The <bpt id=\"p1\">[</bpt>C Run-Time Libraries<ept id=\"p1\">](../c-runtime-library/crt-library-features.md)</ept> (CRT) provide many useful functions that can make programming much easier during ATL development.","pos":[854,1024],"source":"The [C Run-Time Libraries](../c-runtime-library/crt-library-features.md) (CRT) provide many useful functions that can make programming much easier during ATL development."},{"content":"All ATL projects link to the CRT library.","pos":[1025,1066]},{"content":"You can see the advantages and disadvantages of linking method in <bpt id=\"p1\">[</bpt>Benefits and Tradeoffs of the Method Used to Link to the CRT<ept id=\"p1\">](../atl/benefits-and-tradeoffs-of-the-method-used-to-link-to-the-crt.md)</ept>.","pos":[1067,1268],"source":" You can see the advantages and disadvantages of linking method in [Benefits and Tradeoffs of the Method Used to Link to the CRT](../atl/benefits-and-tradeoffs-of-the-method-used-to-link-to-the-crt.md)."},{"content":"Effects of Linking to the CRT on Your Program Image","pos":[1277,1328]},{"content":"If you statically link to the CRT, code from the CRT is placed in your executable image and you do not need to have the CRT DLL present on a system to run your image.","pos":[1332,1498]},{"content":"If you dynamically link to the CRT, references to the code in the CRT DLL are placed in your image, but not the code itself.","pos":[1499,1623]},{"content":"In order for your image to run on a given system, the CRT DLL must be present on that system.","pos":[1624,1717]},{"content":"Even when you dynamically link to the CRT, you may find that some code can be statically linked (for example, <bpt id=\"p1\">**</bpt>DllMainCRTStartup<ept id=\"p1\">**</ept>).","pos":[1718,1851],"source":" Even when you dynamically link to the CRT, you may find that some code can be statically linked (for example, **DllMainCRTStartup**)."},{"content":"When you link your image, you either explicitly or implicitly specify an entry point that the operating system will call into after loading the image.","pos":[1858,2008]},{"content":"For a DLL, the default entry point is <bpt id=\"p1\">**</bpt>DllMainCRTStartup<ept id=\"p1\">**</ept>.","pos":[2009,2069],"source":" For a DLL, the default entry point is **DllMainCRTStartup**."},{"content":"For an EXE, it is <bpt id=\"p1\">**</bpt>WinMainCRTStartup<ept id=\"p1\">**</ept>.","pos":[2070,2110],"source":" For an EXE, it is **WinMainCRTStartup**."},{"content":"You can override the default with the /ENTRY linker option.","pos":[2111,2170]},{"content":"The CRT provides an implementation for <bpt id=\"p1\">**</bpt>DllMainCRTStartup<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>WinMainCRTStartup<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>wWinMainCRTStartup<ept id=\"p3\">**</ept> (the Unicode entry point for an EXE).","pos":[2171,2320],"source":" The CRT provides an implementation for **DllMainCRTStartup**, **WinMainCRTStartup**, and **wWinMainCRTStartup** (the Unicode entry point for an EXE)."},{"content":"These CRT-provided entry points call constructors on global objects and initialize other data structures that are used by some CRT functions.","pos":[2321,2462]},{"content":"This startup code adds about 25K to your image if it is linked statically.","pos":[2463,2537]},{"content":"If it is linked dynamically, most of the code is in the DLL, so your image size stays small.","pos":[2538,2630]},{"pos":[2637,2758],"content":"For more information, see the linker topic <bpt id=\"p1\">[</bpt>/ENTRY (Entry-Point Symbol)<ept id=\"p1\">](../build/reference/entry-entry-point-symbol.md)</ept>.","source":"For more information, see the linker topic [/ENTRY (Entry-Point Symbol)](../build/reference/entry-entry-point-symbol.md)."},{"content":"Optimization Options","pos":[2767,2787]},{"content":"Using the linker option /OPT:NOWIN98 can further reduce a default ATL control by 10K, at the expense of increased loading time on Windows 98 systems.","pos":[2791,2940]},{"content":"For more information on linking options, see <bpt id=\"p1\">[</bpt>/OPT (Optimizations)<ept id=\"p1\">](../build/reference/opt-optimizations.md)</ept>.","pos":[2941,3050],"source":" For more information on linking options, see [/OPT (Optimizations)](../build/reference/opt-optimizations.md)."},{"content":"See Also","pos":[3059,3067]},{"content":"Programming with ATL and C Run-Time Code","pos":[3072,3112]},{"content":"Run-Time Library Behavior","pos":[3171,3196]}],"content":"---\ntitle: \"Linking to the CRT in Your ATL Project | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"DllMainCRTStartup\"\n  - \"wWinMainCRTStartup\"\n  - \"WinMainCRTStartup\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CRT, linking with ATL\"\n  - \"WinMainCRTStartup method\"\n  - \"DllMainCRTStartup method\"\n  - \"wWinMainCRTStartup method\"\n  - \"ATL, C Run-Time library (CRT)\"\nms.assetid: 650957ae-362c-4ecf-8b03-5d49138e8b5b\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Linking to the CRT in Your ATL Project\nThe [C Run-Time Libraries](../c-runtime-library/crt-library-features.md) (CRT) provide many useful functions that can make programming much easier during ATL development. All ATL projects link to the CRT library. You can see the advantages and disadvantages of linking method in [Benefits and Tradeoffs of the Method Used to Link to the CRT](../atl/benefits-and-tradeoffs-of-the-method-used-to-link-to-the-crt.md).  \n  \n## Effects of Linking to the CRT on Your Program Image  \n If you statically link to the CRT, code from the CRT is placed in your executable image and you do not need to have the CRT DLL present on a system to run your image. If you dynamically link to the CRT, references to the code in the CRT DLL are placed in your image, but not the code itself. In order for your image to run on a given system, the CRT DLL must be present on that system. Even when you dynamically link to the CRT, you may find that some code can be statically linked (for example, **DllMainCRTStartup**).  \n  \n When you link your image, you either explicitly or implicitly specify an entry point that the operating system will call into after loading the image. For a DLL, the default entry point is **DllMainCRTStartup**. For an EXE, it is **WinMainCRTStartup**. You can override the default with the /ENTRY linker option. The CRT provides an implementation for **DllMainCRTStartup**, **WinMainCRTStartup**, and **wWinMainCRTStartup** (the Unicode entry point for an EXE). These CRT-provided entry points call constructors on global objects and initialize other data structures that are used by some CRT functions. This startup code adds about 25K to your image if it is linked statically. If it is linked dynamically, most of the code is in the DLL, so your image size stays small.  \n  \n For more information, see the linker topic [/ENTRY (Entry-Point Symbol)](../build/reference/entry-entry-point-symbol.md).  \n  \n## Optimization Options  \n Using the linker option /OPT:NOWIN98 can further reduce a default ATL control by 10K, at the expense of increased loading time on Windows 98 systems. For more information on linking options, see [/OPT (Optimizations)](../build/reference/opt-optimizations.md).  \n  \n## See Also  \n [Programming with ATL and C Run-Time Code](../atl/programming-with-atl-and-c-run-time-code.md)   \n [Run-Time Library Behavior](../build/run-time-library-behavior.md)\n\n"}