{"nodes":[{"pos":[12,52],"content":"CMFCDropDownFrame Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCDropDownFrame Class | Microsoft Docs","pos":[0,40]}]},{"content":"CMFCDropDownFrame Class","pos":[625,648]},{"content":"Provides drop-down frame window functionality to drop-down toolbars and drop-down toolbar buttons.","pos":[649,747]},{"content":"Syntax","pos":[756,762]},{"content":"Members","pos":[835,842]},{"content":"Public Constructors","pos":[852,871]},{"content":"Name","pos":[892,896]},{"content":"Description","pos":[897,908]},{"content":"Default constructor.","pos":[952,972]},{"content":"Destructor.","pos":[1017,1028]},{"content":"Public Methods","pos":[1039,1053]},{"content":"Name","pos":[1074,1078]},{"content":"Description","pos":[1079,1090]},{"content":"CMFCDropDownFrame::Create","pos":[1096,1121]},{"pos":[1151,1188],"content":"Creates a <ph id=\"ph1\">`CMFCDropDownFrame`</ph> object.","source":"Creates a `CMFCDropDownFrame` object."},{"content":"Used by the framework to create a dynamic instance of this class type.","pos":[1227,1297]},{"content":"CMFCDropDownFrame::GetParentMenuBar","pos":[1303,1338]},{"content":"Retrieves the parent menu bar of the drop-down frame.","pos":[1378,1431]},{"content":"CMFCDropDownFrame::GetParentPopupMenu","pos":[1437,1474]},{"content":"Retrieves the parent pop-up menu of the drop-down frame.","pos":[1516,1572]},{"pos":[1611,1771],"content":"Used by the framework to obtain a pointer to the <bpt id=\"p1\">[</bpt>CRuntimeClass<ept id=\"p1\">](../../mfc/reference/cruntimeclass-structure.md)</ept> object that is associated with this class type.","source":"Used by the framework to obtain a pointer to the [CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md) object that is associated with this class type."},{"content":"CMFCDropDownFrame::RecalcLayout","pos":[1777,1808]},{"content":"Repositions the drop-down frame.","pos":[1844,1876]},{"content":"CMFCDropDownFrame::SetAutoDestroy","pos":[1882,1915]},{"content":"Sets whether the child drop-down toolbar window is destroyed automatically.","pos":[1953,2028]},{"content":"Remarks","pos":[2039,2046]},{"content":"This class is not intended to be used directly from your code.","pos":[2050,2112]},{"content":"The framework uses this class to provide frame behavior to the <ph id=\"ph1\">`CMFCDropDownToolbar`</ph> and <ph id=\"ph2\">`CMFCDropDownToolbarButton`</ph> classes.","pos":[2119,2244],"source":"The framework uses this class to provide frame behavior to the `CMFCDropDownToolbar` and `CMFCDropDownToolbarButton` classes."},{"content":"For more information about these classes, see <bpt id=\"p1\">[</bpt>CMFCDropDownToolBar Class<ept id=\"p1\">](../../mfc/reference/cmfcdropdowntoolbar-class.md)</ept> and <bpt id=\"p2\">[</bpt>CMFCDropDownToolbarButton Class<ept id=\"p2\">](../../mfc/reference/cmfcdropdowntoolbarbutton-class.md)</ept>.","pos":[2245,2463],"source":" For more information about these classes, see [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md) and [CMFCDropDownToolbarButton Class](../../mfc/reference/cmfcdropdowntoolbarbutton-class.md)."},{"content":"Example","pos":[2472,2479]},{"pos":[2483,2682],"content":"The following example demonstrates how to retrieve a pointer to a <ph id=\"ph1\">`CMFCDropDownFrame`</ph> object from a <ph id=\"ph2\">`CFrameWnd`</ph> class, and how to set the child drop-down toolbar window to be destroyed automatically.","source":"The following example demonstrates how to retrieve a pointer to a `CMFCDropDownFrame` object from a `CFrameWnd` class, and how to set the child drop-down toolbar window to be destroyed automatically."},{"pos":[2700,2720],"content":"NVC_MFC_RibbonApp#36"},{"content":"Inheritance Hierarchy","pos":[2798,2819]},{"content":"CObject","pos":[2824,2831]},{"content":"CCmdTarget","pos":[2878,2888]},{"content":"CWnd","pos":[2938,2942]},{"content":"CFrameWnd","pos":[2986,2995]},{"content":"CMiniFrameWnd","pos":[3044,3057]},{"content":"CMFCDropDownFrame","pos":[3110,3127]},{"content":"Requirements","pos":[3185,3197]},{"pos":[3201,3233],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdropdowntoolbar.h","source":"**Header:** afxdropdowntoolbar.h"},{"pos":[3285,3310],"content":"CMFCDropDownFrame::Create"},{"pos":[3314,3351],"content":"Creates a <ph id=\"ph1\">`CMFCDropDownFrame`</ph> object.","source":"Creates a `CMFCDropDownFrame` object."},{"content":"Parameters","pos":[3492,3502]},{"content":"Parameter","pos":[3523,3532]},{"content":"Description","pos":[3533,3544]},{"pos":[3549,3553],"content":"[in]"},{"content":"The parent window of the drop-down frame.","pos":[3567,3608]},{"pos":[3613,3617],"content":"[in]"},{"content":"The horizontal screen coordinate for the location of the down-down frame.","pos":[3622,3695]},{"pos":[3700,3704],"content":"[in]"},{"content":"The vertical screen coordinate for the location of the down-down frame.","pos":[3709,3780]},{"pos":[3785,3789],"content":"[in]"},{"content":"The toolbar that has the drop-down buttons that this method uses to populate the new drop-down frame object.","pos":[3810,3918]},{"content":"Return Value","pos":[3929,3941]},{"pos":[3952,4019],"content":"if the drop-down frame was successfully created; otherwise <ph id=\"ph1\">`FALSE`</ph>.","source":" if the drop-down frame was successfully created; otherwise `FALSE`."},{"content":"Remarks","pos":[4029,4036]},{"content":"This method calls the base <bpt id=\"p1\">[</bpt>CMiniFrameWnd::CreateEx<ept id=\"p1\">](../../mfc/reference/cminiframewnd-class.md#cminiframewnd__createex)</ept> method to create the drop-down frame window with the <ph id=\"ph1\">`WS_POPUP`</ph> style.","pos":[4040,4231],"source":"This method calls the base [CMiniFrameWnd::CreateEx](../../mfc/reference/cminiframewnd-class.md#cminiframewnd__createex) method to create the drop-down frame window with the `WS_POPUP` style."},{"content":"The drop-down frame window appears at the specified screen coordinates.","pos":[4232,4303]},{"content":"This method fails if the <bpt id=\"p1\">[</bpt>CMiniFrameWnd::CreateEx<ept id=\"p1\">](../../mfc/reference/cminiframewnd-class.md#cminiframewnd__createex)</ept> method returns <ph id=\"ph1\">`FALSE`</ph>.","pos":[4304,4446],"source":" This method fails if the [CMiniFrameWnd::CreateEx](../../mfc/reference/cminiframewnd-class.md#cminiframewnd__createex) method returns `FALSE`."},{"content":"The <ph id=\"ph1\">`CMFCDropDownFrame`</ph> class creates a copy of the provided <ph id=\"ph2\">`CMFCDropDownToolBar`</ph> parameter.","pos":[4453,4546],"source":"The `CMFCDropDownFrame` class creates a copy of the provided `CMFCDropDownToolBar` parameter."},{"content":"This method copies the button images and button states from the <ph id=\"ph1\">`pWndOriginToolbar`</ph> parameter to the <ph id=\"ph2\">`m_pWndOriginToolbar`</ph> data member.","pos":[4547,4682],"source":" This method copies the button images and button states from the `pWndOriginToolbar` parameter to the `m_pWndOriginToolbar` data member."},{"pos":[4744,4779],"content":"CMFCDropDownFrame::GetParentMenuBar"},{"content":"Retrieves the parent menu bar of the drop-down frame.","pos":[4783,4836]},{"content":"Return Value","pos":[4903,4915]},{"pos":[4919,5013],"content":"A pointer to the parent menu bar of the drop-down frame, or <ph id=\"ph1\">`NULL`</ph> if the frame has no parent.","source":"A pointer to the parent menu bar of the drop-down frame, or `NULL` if the frame has no parent."},{"content":"Remarks","pos":[5023,5030]},{"content":"This method retrieves the parent menu bar from the parent button.","pos":[5034,5099]},{"content":"This method returns <ph id=\"ph1\">`NULL`</ph> if the drop-down frame has no parent button or the parent button has no parent menu bar.","pos":[5100,5215],"source":" This method returns `NULL` if the drop-down frame has no parent button or the parent button has no parent menu bar."},{"pos":[5279,5316],"content":"CMFCDropDownFrame::GetParentPopupMenu"},{"content":"Retrieves the parent pop-up menu of the drop-down frame.","pos":[5320,5376]},{"content":"Return Value","pos":[5451,5463]},{"pos":[5467,5567],"content":"A pointer to the parent drop-down menu of the drop-down frame, or <ph id=\"ph1\">`NULL`</ph> if the frame has no parent.","source":"A pointer to the parent drop-down menu of the drop-down frame, or `NULL` if the frame has no parent."},{"content":"Remarks","pos":[5577,5584]},{"content":"This method retrieves the parent menu from the parent button.","pos":[5588,5649]},{"content":"This method returns <ph id=\"ph1\">`NULL`</ph> if the drop-down frame has no parent button or the parent button has no parent menu.","pos":[5650,5761],"source":" This method returns `NULL` if the drop-down frame has no parent button or the parent button has no parent menu."},{"pos":[5819,5850],"content":"CMFCDropDownFrame::RecalcLayout"},{"content":"Repositions the drop-down frame.","pos":[5854,5886]},{"content":"Parameters","pos":[5959,5969]},{"content":"Parameter","pos":[5990,5999]},{"content":"Description","pos":[6000,6011]},{"pos":[6016,6020],"content":"[in]"},{"content":"Unused.","pos":[6031,6038]},{"content":"Remarks","pos":[6049,6056]},{"content":"The framework calls this method when the drop-down frame is created or the parent window is resized.","pos":[6060,6160]},{"content":"This method calculates the position and size of the drop-down frame by using the position and size of the parent window.","pos":[6161,6281]},{"pos":[6341,6374],"content":"CMFCDropDownFrame::SetAutoDestroy"},{"content":"Sets whether the child drop-down toolbar window is destroyed automatically.","pos":[6378,6453]},{"content":"Parameters","pos":[6525,6535]},{"content":"[in]","pos":[6539,6543]},{"content":"to automatically destroy the associated drop-down toolbar window; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","pos":[6569,6654],"source":" to automatically destroy the associated drop-down toolbar window; otherwise, `FALSE`."},{"content":"Remarks","pos":[6664,6671]},{"content":"If <ph id=\"ph1\">`bAutoDestroy`</ph> is <ph id=\"ph2\">`TRUE`</ph>, then the <ph id=\"ph3\">`CMFCDropDownFrame`</ph> destructor destroys the associated drop-down toolbar window.","pos":[6675,6793],"source":"If `bAutoDestroy` is `TRUE`, then the `CMFCDropDownFrame` destructor destroys the associated drop-down toolbar window."},{"content":"The default value is <ph id=\"ph1\">`TRUE`</ph>.","pos":[6794,6822],"source":" The default value is `TRUE`."},{"content":"See Also","pos":[6831,6839]},{"content":"Hierarchy Chart","pos":[6844,6859]},{"content":"Classes","pos":[6896,6903]},{"content":"CMFCDropDownToolBar Class","pos":[6946,6971]},{"content":"CMFCDropDownToolbarButton Class","pos":[7028,7059]}],"content":"---\ntitle: \"CMFCDropDownFrame Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCDropDownFrame\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCDropDownFrame class\"\nms.assetid: 09ff81a9-de00-43ec-9df9-b626f7728c4b\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCDropDownFrame Class\nProvides drop-down frame window functionality to drop-down toolbars and drop-down toolbar buttons.  \n  \n## Syntax  \n  \n```  \nclass CMFCDropDownFrame : public CMiniFrameWnd  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|||  \n|-|-|  \n|Name|Description|  \n|`CMFCDropDownFrame::CMFCDropDownFrame`|Default constructor.|  \n|`CMFCDropDownFrame::~CMFCDropDownFrame`|Destructor.|  \n  \n### Public Methods  \n  \n|||  \n|-|-|  \n|Name|Description|  \n|[CMFCDropDownFrame::Create](#cmfcdropdownframe__create)|Creates a `CMFCDropDownFrame` object.|  \n|`CMFCDropDownFrame::CreateObject`|Used by the framework to create a dynamic instance of this class type.|  \n|[CMFCDropDownFrame::GetParentMenuBar](#cmfcdropdownframe__getparentmenubar)|Retrieves the parent menu bar of the drop-down frame.|  \n|[CMFCDropDownFrame::GetParentPopupMenu](#cmfcdropdownframe__getparentpopupmenu)|Retrieves the parent pop-up menu of the drop-down frame.|  \n|`CMFCDropDownFrame::GetThisClass`|Used by the framework to obtain a pointer to the [CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md) object that is associated with this class type.|  \n|[CMFCDropDownFrame::RecalcLayout](#cmfcdropdownframe__recalclayout)|Repositions the drop-down frame.|  \n|[CMFCDropDownFrame::SetAutoDestroy](#cmfcdropdownframe__setautodestroy)|Sets whether the child drop-down toolbar window is destroyed automatically.|  \n  \n### Remarks  \n This class is not intended to be used directly from your code.  \n  \n The framework uses this class to provide frame behavior to the `CMFCDropDownToolbar` and `CMFCDropDownToolbarButton` classes. For more information about these classes, see [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md) and [CMFCDropDownToolbarButton Class](../../mfc/reference/cmfcdropdowntoolbarbutton-class.md).  \n  \n## Example  \n The following example demonstrates how to retrieve a pointer to a `CMFCDropDownFrame` object from a `CFrameWnd` class, and how to set the child drop-down toolbar window to be destroyed automatically.  \n  \n [!code-cpp[NVC_MFC_RibbonApp#36](../../mfc/reference/codesnippet/cpp/cmfcdropdownframe-class_1.cpp)]  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CFrameWnd](../../mfc/reference/cframewnd-class.md)  \n  \n [CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)  \n  \n [CMFCDropDownFrame](../../mfc/reference/cmfcdropdownframe-class.md)  \n  \n## Requirements  \n **Header:** afxdropdowntoolbar.h  \n  \n##  <a name=\"cmfcdropdownframe__create\"></a>  CMFCDropDownFrame::Create  \n Creates a `CMFCDropDownFrame` object.  \n  \n```  \nvirtual BOOL Create(\n    CWnd* pWndParent,  \n    int x,  \n    int y,  \n    CMFCDropDownToolBar* pWndOriginToolbar);\n```  \n  \n### Parameters  \n  \n|||  \n|-|-|  \n|Parameter|Description|  \n|[in] `pWndParent`|The parent window of the drop-down frame.|  \n|[in] `x`|The horizontal screen coordinate for the location of the down-down frame.|  \n|[in] `y`|The vertical screen coordinate for the location of the down-down frame.|  \n|[in] `pWndOriginToolbar`|The toolbar that has the drop-down buttons that this method uses to populate the new drop-down frame object.|  \n  \n### Return Value  \n `TRUE` if the drop-down frame was successfully created; otherwise `FALSE`.  \n  \n### Remarks  \n This method calls the base [CMiniFrameWnd::CreateEx](../../mfc/reference/cminiframewnd-class.md#cminiframewnd__createex) method to create the drop-down frame window with the `WS_POPUP` style. The drop-down frame window appears at the specified screen coordinates. This method fails if the [CMiniFrameWnd::CreateEx](../../mfc/reference/cminiframewnd-class.md#cminiframewnd__createex) method returns `FALSE`.  \n  \n The `CMFCDropDownFrame` class creates a copy of the provided `CMFCDropDownToolBar` parameter. This method copies the button images and button states from the `pWndOriginToolbar` parameter to the `m_pWndOriginToolbar` data member.  \n  \n##  <a name=\"cmfcdropdownframe__getparentmenubar\"></a>  CMFCDropDownFrame::GetParentMenuBar  \n Retrieves the parent menu bar of the drop-down frame.  \n  \n```  \nCMFCMenuBar* GetParentMenuBar() const;\n\n \n```  \n  \n### Return Value  \n A pointer to the parent menu bar of the drop-down frame, or `NULL` if the frame has no parent.  \n  \n### Remarks  \n This method retrieves the parent menu bar from the parent button. This method returns `NULL` if the drop-down frame has no parent button or the parent button has no parent menu bar.  \n  \n##  <a name=\"cmfcdropdownframe__getparentpopupmenu\"></a>  CMFCDropDownFrame::GetParentPopupMenu  \n Retrieves the parent pop-up menu of the drop-down frame.  \n  \n```  \nCMFCDropDownFrame* GetParentPopupMenu() const;\n\n \n```  \n  \n### Return Value  \n A pointer to the parent drop-down menu of the drop-down frame, or `NULL` if the frame has no parent.  \n  \n### Remarks  \n This method retrieves the parent menu from the parent button. This method returns `NULL` if the drop-down frame has no parent button or the parent button has no parent menu.  \n  \n##  <a name=\"cmfcdropdownframe__recalclayout\"></a>  CMFCDropDownFrame::RecalcLayout  \n Repositions the drop-down frame.  \n  \n```  \nvirtual void RecalcLayout(BOOL bNotify = TRUE);\n```  \n  \n### Parameters  \n  \n|||  \n|-|-|  \n|Parameter|Description|  \n|[in] `bNotify`|Unused.|  \n  \n### Remarks  \n The framework calls this method when the drop-down frame is created or the parent window is resized. This method calculates the position and size of the drop-down frame by using the position and size of the parent window.  \n  \n##  <a name=\"cmfcdropdownframe__setautodestroy\"></a>  CMFCDropDownFrame::SetAutoDestroy  \n Sets whether the child drop-down toolbar window is destroyed automatically.  \n  \n```  \nvoid SetAutoDestroy(BOOL bAutoDestroy = TRUE);\n```  \n  \n### Parameters  \n [in] `bAutoDestroy`  \n `TRUE` to automatically destroy the associated drop-down toolbar window; otherwise, `FALSE`.  \n  \n### Remarks  \n If `bAutoDestroy` is `TRUE`, then the `CMFCDropDownFrame` destructor destroys the associated drop-down toolbar window. The default value is `TRUE`.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md)   \n [CMFCDropDownToolbarButton Class](../../mfc/reference/cmfcdropdowntoolbarbutton-class.md)\n"}