{"nodes":[{"pos":[12,71],"content":"MFC ActiveX Controls: Adding Stock Methods | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Adding Stock Methods | Microsoft Docs","pos":[0,59]}]},{"content":"MFC ActiveX Controls: Adding Stock Methods","pos":[673,715]},{"content":"A stock method differs from a custom method in that it is already implemented by class <bpt id=\"p1\">[</bpt>COleControl<ept id=\"p1\">](../mfc/reference/colecontrol-class.md)</ept>.","pos":[716,856],"source":"A stock method differs from a custom method in that it is already implemented by class [COleControl](../mfc/reference/colecontrol-class.md)."},{"content":"For example, <ph id=\"ph1\">`COleControl`</ph> contains a predefined member function that supports the Refresh method for your control.","pos":[857,972],"source":" For example, `COleControl` contains a predefined member function that supports the Refresh method for your control."},{"content":"The dispatch map entry for this stock method is <bpt id=\"p1\">**</bpt>DISP_STOCKFUNC_REFRESH<ept id=\"p1\">**</ept>.","pos":[973,1048],"source":" The dispatch map entry for this stock method is **DISP_STOCKFUNC_REFRESH**."},{"content":"supports two stock methods: DoClick and Refresh.","pos":[1069,1117]},{"content":"Refresh is invoked by the control's user to immediately update the control's appearance; DoClick is invoked to fire the control's Click event.","pos":[1118,1260]},{"content":"Method","pos":[1267,1273]},{"content":"Dispatch map entry","pos":[1274,1292]},{"content":"Comment","pos":[1293,1300]},{"content":"DISP_STOCKPROP_DOCLICK( )","pos":[1373,1398]},{"content":"Fires a Click event.","pos":[1401,1421]},{"content":"Refresh","pos":[1428,1435]},{"content":"DISP_STOCKPROP_REFRESH( )","pos":[1440,1465]},{"content":"Immediately updates the control's appearance.","pos":[1468,1513]},{"pos":[1585,1634],"content":"Adding a Stock Method Using the Add Method Wizard"},{"content":"Adding a stock method is simple using the <bpt id=\"p1\">[</bpt>Add Method Wizard<ept id=\"p1\">](../ide/add-method-wizard.md)</ept>.","pos":[1638,1729],"source":"Adding a stock method is simple using the [Add Method Wizard](../ide/add-method-wizard.md)."},{"content":"The following procedure demonstrates adding the Refresh method to a control created using the MFC ActiveX Control Wizard.","pos":[1730,1851]},{"content":"To add the stock Refresh method using the Add Method Wizard","pos":[1862,1921]},{"content":"Load your control's project.","pos":[1931,1959]},{"content":"In Class View, expand the library node of your control.","pos":[1969,2024]},{"content":"Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.","pos":[2034,2146]},{"pos":[2156,2224],"content":"From the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Method<ept id=\"p2\">**</ept>.","source":"From the shortcut menu, click **Add** and then click **Add Method**."},{"content":"This opens the Add Method Wizard.","pos":[2235,2268]},{"pos":[2278,2324],"content":"In the <bpt id=\"p1\">**</bpt>Method Name<ept id=\"p1\">**</ept> box, click <bpt id=\"p2\">**</bpt>Refresh<ept id=\"p2\">**</ept>.","source":"In the **Method Name** box, click **Refresh**."},{"pos":[2334,2351],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Click **Finish**."},{"pos":[2420,2463],"content":"Add Method Wizard Changes for Stock Methods"},{"content":"Because the stock Refresh method is supported by the control's base class, the <bpt id=\"p1\">**</bpt>Add Method Wizard<ept id=\"p1\">**</ept> does not change the control's class declaration in any way.","pos":[2467,2627],"source":"Because the stock Refresh method is supported by the control's base class, the **Add Method Wizard** does not change the control's class declaration in any way."},{"content":"It adds an entry for the method to the control's dispatch map and to its .IDL file.","pos":[2628,2711]},{"content":"The following line is added to the control's dispatch map, located in its implementation (.CPP) file:","pos":[2712,2813]},{"pos":[2831,2846],"content":"NVC_MFC_AxUI#16"},{"content":"This makes the Refresh method available to the control's users.","pos":[2927,2990]},{"content":"The following line is added to the control's .IDL file:","pos":[2997,3052]},{"pos":[3070,3085],"content":"NVC_MFC_AxUI#17"},{"content":"This line assigns the Refresh method a specific ID number.","pos":[3166,3224]},{"content":"See Also","pos":[3233,3241]},{"content":"MFC ActiveX Controls","pos":[3246,3266]}],"content":"---\ntitle: \"MFC ActiveX Controls: Adding Stock Methods | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, stock methods\"\n  - \"MFC ActiveX controls, methods\"\n  - \"DoClick method\"\nms.assetid: bc4fad78-cabd-4cc0-a798-464b1a682f0b\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Adding Stock Methods\nA stock method differs from a custom method in that it is already implemented by class [COleControl](../mfc/reference/colecontrol-class.md). For example, `COleControl` contains a predefined member function that supports the Refresh method for your control. The dispatch map entry for this stock method is **DISP_STOCKFUNC_REFRESH**.  \n  \n `COleControl` supports two stock methods: DoClick and Refresh. Refresh is invoked by the control's user to immediately update the control's appearance; DoClick is invoked to fire the control's Click event.  \n  \n|Method|Dispatch map entry|Comment|  \n|------------|------------------------|-------------|  \n|`DoClick`|**DISP_STOCKPROP_DOCLICK( )**|Fires a Click event.|  \n|**Refresh**|**DISP_STOCKPROP_REFRESH( )**|Immediately updates the control's appearance.|  \n  \n##  <a name=\"_core_adding_a_stock_method_using_classwizard\"></a> Adding a Stock Method Using the Add Method Wizard  \n Adding a stock method is simple using the [Add Method Wizard](../ide/add-method-wizard.md). The following procedure demonstrates adding the Refresh method to a control created using the MFC ActiveX Control Wizard.  \n  \n#### To add the stock Refresh method using the Add Method Wizard  \n  \n1.  Load your control's project.  \n  \n2.  In Class View, expand the library node of your control.  \n  \n3.  Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.  \n  \n4.  From the shortcut menu, click **Add** and then click **Add Method**.  \n  \n     This opens the Add Method Wizard.  \n  \n5.  In the **Method Name** box, click **Refresh**.  \n  \n6.  Click **Finish**.  \n  \n##  <a name=\"_core_classwizard_changes_for_stock_methods\"></a> Add Method Wizard Changes for Stock Methods  \n Because the stock Refresh method is supported by the control's base class, the **Add Method Wizard** does not change the control's class declaration in any way. It adds an entry for the method to the control's dispatch map and to its .IDL file. The following line is added to the control's dispatch map, located in its implementation (.CPP) file:  \n  \n [!code-cpp[NVC_MFC_AxUI#16](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-methods_1.cpp)]  \n  \n This makes the Refresh method available to the control's users.  \n  \n The following line is added to the control's .IDL file:  \n  \n [!code-cpp[NVC_MFC_AxUI#17](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-methods_2.idl)]  \n  \n This line assigns the Refresh method a specific ID number.  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)\n\n"}