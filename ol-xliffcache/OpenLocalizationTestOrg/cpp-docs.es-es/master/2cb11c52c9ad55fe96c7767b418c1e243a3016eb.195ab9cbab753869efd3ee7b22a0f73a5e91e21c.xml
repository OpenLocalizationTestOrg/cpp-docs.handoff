{"nodes":[{"pos":[12,43],"content":"event_receiver | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"event_receiver | Microsoft Docs","pos":[0,31]}]},{"content":"event_receiver","pos":[828,842]},{"content":"Creates an event receiver (sink).","pos":[843,876]},{"content":"Syntax","pos":[885,891]},{"content":"Parameters","pos":[996,1006]},{"content":"An enumeration of one of the following values:","pos":[1020,1066]},{"pos":[1085,1139],"content":"for unmanaged C/C++ code (default for native classes)."},{"content":"for COM code.","pos":[1155,1168]},{"content":"This value requires that you include the following header files:","pos":[1169,1233]},{"pos":[1346,1453],"content":"**layout_dependent**  \nSpecify *layout_dependent* only if `type`=**com**. *layout_dependent* is a Boolean:","leadings":[""," "],"nodes":[{"content":"layout_dependent","pos":[2,18]},{"content":"Specify *layout_dependent* only if `type`=**com**. *layout_dependent* is a Boolean:","pos":[23,106],"nodes":[{"content":"Specify <bpt id=\"p1\">*</bpt>layout_dependent<ept id=\"p1\">*</ept> only if <ph id=\"ph1\">`type`=</ph><bpt id=\"p2\">**</bpt>com<ept id=\"p2\">**</ept>.","pos":[0,50],"source":"Specify *layout_dependent* only if `type`=**com**."},{"content":"<bpt id=\"p1\">*</bpt>layout_dependent<ept id=\"p1\">*</ept> is a Boolean:","pos":[51,83],"source":"*layout_dependent* is a Boolean:"}]}]},{"content":"<bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> means that the signature of the delegates in the event receiver must exactly match those to which they are hooked in the event source.","pos":[1463,1606],"source":"**true** means that the signature of the delegates in the event receiver must exactly match those to which they are hooked in the event source."},{"content":"The event receiver handler names must match the names specified in the relevant event source interface.","pos":[1607,1710]},{"content":"You must use <bpt id=\"p1\">**</bpt>coclass<ept id=\"p1\">**</ept> when <bpt id=\"p2\">*</bpt>layout_dependent<ept id=\"p2\">*</ept> is <bpt id=\"p3\">**</bpt>true<ept id=\"p3\">**</ept>.","pos":[1711,1772],"source":" You must use **coclass** when *layout_dependent* is **true**."},{"content":"It is slightly more efficient to specify <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept>.","pos":[1773,1823],"source":" It is slightly more efficient to specify **true**."},{"pos":[1833,2070],"content":"<bpt id=\"p1\">**</bpt>false<ept id=\"p1\">**</ept> (default) means that the calling convention and storage class (virtual, static, and others) do not have to match the event method and the handlers; nor do the handler names need to match the event source interface method names.","source":"**false** (default) means that the calling convention and storage class (virtual, static, and others) do not have to match the event method and the handlers; nor do the handler names need to match the event source interface method names."},{"content":"Remarks","pos":[2079,2086]},{"pos":[2090,2256],"content":"The <bpt id=\"p1\">**</bpt>event_receiver<ept id=\"p1\">**</ept> C++ attribute specifies that the class or structure to which it is applied will be an event receiver, using the Visual C++ unified event model.","source":"The **event_receiver** C++ attribute specifies that the class or structure to which it is applied will be an event receiver, using the Visual C++ unified event model."},{"content":"<bpt id=\"p1\">**</bpt>event_receiver<ept id=\"p1\">**</ept> is used with the <bpt id=\"p2\">[</bpt>event_source<ept id=\"p2\">](../windows/event-source.md)</ept> attribute and the <bpt id=\"p3\">[</bpt>__hook<ept id=\"p3\">](../cpp/hook.md)</ept> and <bpt id=\"p4\">[</bpt>__unhook<ept id=\"p4\">](../cpp/unhook.md)</ept> keywords.","pos":[2263,2427],"source":"**event_receiver** is used with the [event_source](../windows/event-source.md) attribute and the [__hook](../cpp/hook.md) and [__unhook](../cpp/unhook.md) keywords."},{"content":"Use <bpt id=\"p1\">**</bpt>event_source<ept id=\"p1\">**</ept> to create event sources.","pos":[2428,2473],"source":" Use **event_source** to create event sources."},{"content":"Use <ph id=\"ph1\">`__hook`</ph> within an event receiver's methods to associate (\"hook\") event receiver methods to the events of an event source.","pos":[2474,2600],"source":" Use `__hook` within an event receiver's methods to associate (\"hook\") event receiver methods to the events of an event source."},{"content":"Use <ph id=\"ph1\">`__unhook`</ph> to dissociate them.","pos":[2601,2635],"source":" Use `__unhook` to dissociate them."},{"content":"<bpt id=\"p1\">*</bpt>layout_dependent<ept id=\"p1\">*</ept> is only specified for COM event receivers (<ph id=\"ph1\">`type`=</ph><bpt id=\"p2\">**</bpt>com<ept id=\"p2\">**</ept>).","pos":[2642,2720],"source":"*layout_dependent* is only specified for COM event receivers (`type`=**com**)."},{"content":"The default for <bpt id=\"p1\">*</bpt>layout_dependent<ept id=\"p1\">*</ept> is <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept>.","pos":[2721,2769],"source":" The default for *layout_dependent* is **false**."},{"pos":[2777,2838],"content":"[!NOTE]\n A templated class or struct cannot contain events.","leadings":["","> "],"nodes":[{"content":"A templated class or struct cannot contain events.","pos":[9,59]}]},{"content":"Requirements","pos":[2847,2859]},{"content":"Attribute Context","pos":[2869,2886]},{"content":"Applies to","pos":[2909,2919]},{"pos":[2922,2932],"content":"<bpt id=\"p1\">**</bpt>class<ept id=\"p1\">**</ept>,","source":"**class**, "},{"content":"Repeatable","pos":[2948,2958]},{"content":"No","pos":[2961,2963]},{"content":"Required attributes","pos":[2970,2989]},{"pos":[2992,3036],"content":"<bpt id=\"p1\">**</bpt>coclass<ept id=\"p1\">**</ept> when <bpt id=\"p2\">*</bpt>layout_dependent<ept id=\"p2\">*</ept><ph id=\"ph1\">=</ph><bpt id=\"p3\">**</bpt>true<ept id=\"p3\">**</ept>","source":"**coclass** when *layout_dependent*=**true**"},{"content":"Invalid attributes","pos":[3043,3061]},{"content":"None","pos":[3064,3068]},{"pos":[3076,3157],"content":"For more information, see <bpt id=\"p1\">[</bpt>Attribute Contexts<ept id=\"p1\">](../windows/attribute-contexts.md)</ept>.","source":"For more information, see [Attribute Contexts](../windows/attribute-contexts.md)."},{"content":"See Also","pos":[3166,3174]},{"content":"Compiler Attributes","pos":[3179,3198]},{"content":"event_source","pos":[3240,3252]},{"content":"__event","pos":[3287,3294]},{"content":"__hook","pos":[3318,3324]},{"content":"__unhook","pos":[3347,3355]},{"content":"Class Attributes","pos":[3380,3396]},{"content":"Attributes Samples","pos":[3435,3453]}],"content":"---\ntitle: \"event_receiver | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\nf1_keywords: \n  - \"vc-attr.event_receiver\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"event_receiver attribute\"\n  - \"event receivers\"\n  - \"events [C++], event receivers (sinks)\"\n  - \"event handling [C++], attributes\"\n  - \"event handling [C++], creating receiver\"\n  - \"event sinks, creating\"\n  - \"event sinks\"\nms.assetid: bf8fe770-3ea2-4128-b46b-166222ee4097\ncaps.latest.revision: 13\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# event_receiver\nCreates an event receiver (sink).  \n  \n## Syntax  \n  \n```  \n  \n      [ event_receiver(  \n   type   \n   [, layout_dependent=false]   \n) ]  \n```  \n  \n#### Parameters  \n `type`  \n An enumeration of one of the following values:  \n  \n-   `native` for unmanaged C/C++ code (default for native classes).  \n  \n-   `com` for COM code. This value requires that you include the following header files:  \n  \n    ```  \n    #define _ATL_ATTRIBUTES  \n    #include <atlbase.h>  \n    #include <atlcom.h>  \n    ```  \n  \n **layout_dependent**  \n Specify *layout_dependent* only if `type`=**com**. *layout_dependent* is a Boolean:  \n  \n-   **true** means that the signature of the delegates in the event receiver must exactly match those to which they are hooked in the event source. The event receiver handler names must match the names specified in the relevant event source interface. You must use **coclass** when *layout_dependent* is **true**. It is slightly more efficient to specify **true**.  \n  \n-   **false** (default) means that the calling convention and storage class (virtual, static, and others) do not have to match the event method and the handlers; nor do the handler names need to match the event source interface method names.  \n  \n## Remarks  \n The **event_receiver** C++ attribute specifies that the class or structure to which it is applied will be an event receiver, using the Visual C++ unified event model.  \n  \n **event_receiver** is used with the [event_source](../windows/event-source.md) attribute and the [__hook](../cpp/hook.md) and [__unhook](../cpp/unhook.md) keywords. Use **event_source** to create event sources. Use `__hook` within an event receiver's methods to associate (\"hook\") event receiver methods to the events of an event source. Use `__unhook` to dissociate them.  \n  \n *layout_dependent* is only specified for COM event receivers (`type`=**com**). The default for *layout_dependent* is **false**.  \n  \n> [!NOTE]\n>  A templated class or struct cannot contain events.  \n  \n## Requirements  \n  \n### Attribute Context  \n  \n|||  \n|-|-|  \n|**Applies to**|**class**, `struct`|  \n|**Repeatable**|No|  \n|**Required attributes**|**coclass** when *layout_dependent*=**true**|  \n|**Invalid attributes**|None|  \n  \n For more information, see [Attribute Contexts](../windows/attribute-contexts.md).  \n  \n## See Also  \n [Compiler Attributes](../windows/compiler-attributes.md)   \n [event_source](../windows/event-source.md)   \n [__event](../cpp/event.md)   \n [__hook](../cpp/hook.md)   \n [__unhook](../cpp/unhook.md)   \n [Class Attributes](../windows/class-attributes.md)   \n [Attributes Samples](http://msdn.microsoft.com/en-us/558ebdb2-082f-44dc-b442-d8d33bf7bdb8)"}