{"nodes":[{"pos":[12,54],"content":"CBindStatusCallback Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CBindStatusCallback Class | Microsoft Docs","pos":[0,42]}]},{"content":"CBindStatusCallback Class","pos":[736,761]},{"pos":[762,820],"content":"This class implements the <ph id=\"ph1\">`IBindStatusCallback`</ph> interface.","source":"This class implements the `IBindStatusCallback` interface."},{"pos":[828,938],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"content":"Syntax","pos":[947,953]},{"content":"Parameters","pos":[1249,1259]},{"content":"Your class containing the function that will be called as the data is received.","pos":[1270,1349]},{"content":"nBindFlags","pos":[1357,1367]},{"content":"Specifies the bind flags that are returned by <bpt id=\"p1\">[</bpt>GetBindInfo<ept id=\"p1\">](#cbindstatuscallback__getbindinfo)</ept>.","pos":[1372,1467],"source":" Specifies the bind flags that are returned by [GetBindInfo](#cbindstatuscallback__getbindinfo)."},{"content":"The default implementation sets the binding to be asynchronous, retrieves the newest version of the data/object, and does not store retrieved data in the disk cache.","pos":[1468,1633]},{"content":"Members","pos":[1642,1649]},{"content":"Public Constructors","pos":[1659,1678]},{"content":"Name","pos":[1685,1689]},{"content":"Description","pos":[1690,1701]},{"content":"CBindStatusCallback::CBindStatusCallback","pos":[1740,1780]},{"content":"The constructor.","pos":[1825,1841]},{"content":"CBindStatusCallback::~CBindStatusCallback","pos":[1847,1888]},{"content":"The destructor.","pos":[1938,1953]},{"content":"Public Methods","pos":[1964,1978]},{"content":"Name","pos":[1985,1989]},{"content":"Description","pos":[1990,2001]},{"content":"CBindStatusCallback::Download","pos":[2040,2069]},{"pos":[2103,2222],"content":"Static method that starts the download process, creates a <ph id=\"ph1\">`CBindStatusCallback`</ph> object, and calls <ph id=\"ph2\">`StartAsyncDownload`</ph>.","source":"Static method that starts the download process, creates a `CBindStatusCallback` object, and calls `StartAsyncDownload`."},{"content":"CBindStatusCallback::GetBindInfo","pos":[2228,2260]},{"content":"Called by the asynchronous moniker to request information on the type of bind to be created.","pos":[2297,2389]},{"content":"CBindStatusCallback::GetPriority","pos":[2395,2427]},{"content":"Called by the asynchronous moniker to get the priority of the bind operation.","pos":[2464,2541]},{"content":"The ATL implementation returns <ph id=\"ph1\">`E_NOTIMPL`</ph>.","pos":[2542,2585],"source":" The ATL implementation returns `E_NOTIMPL`."},{"content":"CBindStatusCallback::OnDataAvailable","pos":[2591,2627]},{"content":"Called to provide data to your application as it becomes available.","pos":[2668,2735]},{"content":"Reads the data, then calls the function passed to it to use the data.","pos":[2736,2805]},{"content":"CBindStatusCallback::OnLowResource","pos":[2811,2845]},{"content":"Called when resources are low.","pos":[2884,2914]},{"content":"The ATL implementation returns <ph id=\"ph1\">`S_OK`</ph>.","pos":[2915,2953],"source":" The ATL implementation returns `S_OK`."},{"content":"CBindStatusCallback::OnObjectAvailable","pos":[2959,2997]},{"content":"Called by the asynchronous moniker to pass an object interface pointer to your application.","pos":[3040,3131]},{"content":"The ATL implementation returns <ph id=\"ph1\">`S_OK`</ph>.","pos":[3132,3170],"source":" The ATL implementation returns `S_OK`."},{"content":"CBindStatusCallback::OnProgress","pos":[3176,3207]},{"content":"Called to indicate the progress of a data downloading process.","pos":[3243,3305]},{"content":"The ATL implementation returns <ph id=\"ph1\">`S_OK`</ph>.","pos":[3306,3344],"source":" The ATL implementation returns `S_OK`."},{"content":"CBindStatusCallback::OnStartBinding","pos":[3350,3385]},{"content":"Called when binding is started.","pos":[3425,3456]},{"content":"CBindStatusCallback::OnStopBinding","pos":[3462,3496]},{"content":"Called when the asynchronous data transfer is stopped.","pos":[3535,3589]},{"content":"CBindStatusCallback::StartAsyncDownload","pos":[3595,3634]},{"pos":[3678,3837],"content":"Initializes the bytes available and bytes read to zero, creates a push-type stream object from a URL, and calls <ph id=\"ph1\">`OnDataAvailable`</ph> every time data is available.","source":"Initializes the bytes available and bytes read to zero, creates a push-type stream object from a URL, and calls `OnDataAvailable` every time data is available."},{"content":"Public Data Members","pos":[3848,3867]},{"content":"Name","pos":[3874,3878]},{"content":"Description","pos":[3879,3890]},{"content":"CBindStatusCallback::m_dwAvailableToRead","pos":[3929,3969]},{"content":"Number of bytes available to read.","pos":[4014,4048]},{"content":"CBindStatusCallback::m_dwTotalRead","pos":[4054,4088]},{"content":"Total number of bytes read.","pos":[4127,4154]},{"content":"CBindStatusCallback::m_pFunc","pos":[4160,4188]},{"content":"Pointer to the function called when data is available.","pos":[4221,4275]},{"content":"CBindStatusCallback::m_pT","pos":[4281,4306]},{"content":"Pointer to the object requesting the asynchronous data transfer.","pos":[4336,4400]},{"content":"CBindStatusCallback::m_spBindCtx","pos":[4406,4438]},{"pos":[4475,4602],"content":"Pointer to the <bpt id=\"p1\">[</bpt>IBindCtx<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms693755)</ept> interface for the current bind operation.","source":"Pointer to the [IBindCtx](http://msdn.microsoft.com/library/windows/desktop/ms693755) interface for the current bind operation."},{"content":"CBindStatusCallback::m_spBinding","pos":[4608,4640]},{"pos":[4677,4744],"content":"Pointer to the <ph id=\"ph1\">`IBinding`</ph> interface for the current bind operation.","source":"Pointer to the `IBinding` interface for the current bind operation."},{"content":"CBindStatusCallback::m_spMoniker","pos":[4750,4782]},{"pos":[4819,4934],"content":"Pointer to the <bpt id=\"p1\">[</bpt>IMoniker<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679705)</ept> interface for the URL to use.","source":"Pointer to the [IMoniker](http://msdn.microsoft.com/library/windows/desktop/ms679705) interface for the URL to use."},{"content":"CBindStatusCallback::m_spStream","pos":[4940,4971]},{"pos":[5007,5124],"content":"Pointer to the <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> interface for the data transfer.","source":"Pointer to the [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) interface for the data transfer."},{"content":"Remarks","pos":[5134,5141]},{"content":"The <ph id=\"ph1\">`CBindStatusCallback`</ph> class implements the <ph id=\"ph2\">`IBindStatusCallback`</ph> interface.","pos":[5145,5224],"source":"The `CBindStatusCallback` class implements the `IBindStatusCallback` interface."},{"content":"must be implemented by your application so it can receive notifications from an asynchronous data transfer.","pos":[5247,5354]},{"content":"The asynchronous moniker provided by the system uses <ph id=\"ph1\">`IBindStatusCallback`</ph> methods to send and receive information about the asynchronous data transfer to and from your object.","pos":[5355,5531],"source":" The asynchronous moniker provided by the system uses `IBindStatusCallback` methods to send and receive information about the asynchronous data transfer to and from your object."},{"content":"Typically, the <ph id=\"ph1\">`CBindStatusCallback`</ph> object is associated with a specific bind operation.","pos":[5538,5627],"source":"Typically, the `CBindStatusCallback` object is associated with a specific bind operation."},{"content":"For example, in the <bpt id=\"p1\">[</bpt>ASYNC<ept id=\"p1\">](../../visual-cpp-samples.md)</ept> sample, when you set the URL property, it creates a <ph id=\"ph1\">`CBindStatusCallback`</ph> object in the call to <ph id=\"ph2\">`Download`</ph>:","pos":[5628,5792],"source":" For example, in the [ASYNC](../../visual-cpp-samples.md) sample, when you set the URL property, it creates a `CBindStatusCallback` object in the call to `Download`:"},{"pos":[5810,5830],"content":"NVC_ATL_Windowing#86"},{"content":"The asynchronous moniker uses the callback function <ph id=\"ph1\">`OnData`</ph> to call your application when it has data.","pos":[5896,5999],"source":"The asynchronous moniker uses the callback function `OnData` to call your application when it has data."},{"content":"The asynchronous moniker is provided by the system.","pos":[6000,6051]},{"content":"Inheritance Hierarchy","pos":[6060,6081]},{"content":"CComObjectRootEx","pos":[6141,6157]},{"content":"Requirements","pos":[6242,6254]},{"pos":[6258,6278],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlctl.h","source":"**Header:** atlctl.h"},{"pos":[6345,6385],"content":"CBindStatusCallback::CBindStatusCallback"},{"content":"The constructor.","pos":[6389,6405]},{"content":"Remarks","pos":[6451,6458]},{"content":"Creates an object to receive notifications concerning the asynchronous data transfer.","pos":[6462,6547]},{"content":"Typically, one object is created for each bind operation.","pos":[6548,6605]},{"pos":[6612,6737],"content":"The constructor also initializes <bpt id=\"p1\">[</bpt>m_pT<ept id=\"p1\">](#cbindstatuscallback__m_pt)</ept> and <bpt id=\"p2\">[</bpt>m_pFunc<ept id=\"p2\">](#cbindstatuscallback__m_pfunc)</ept> to <bpt id=\"p3\">**</bpt>NULL<ept id=\"p3\">**</ept>.","source":"The constructor also initializes [m_pT](#cbindstatuscallback__m_pt) and [m_pFunc](#cbindstatuscallback__m_pfunc) to **NULL**."},{"pos":[6809,6850],"content":"CBindStatusCallback::~CBindStatusCallback"},{"content":"The destructor.","pos":[6854,6869]},{"content":"Remarks","pos":[6916,6923]},{"content":"Frees all allocated resources.","pos":[6927,6957]},{"pos":[7013,7042],"content":"CBindStatusCallback::Download"},{"pos":[7046,7180],"content":"Creates a <ph id=\"ph1\">`CBindStatusCallback`</ph> object and calls <ph id=\"ph2\">`StartAsyncDownload`</ph> to start downloading data asynchronously from the specified URL.","source":"Creates a `CBindStatusCallback` object and calls `StartAsyncDownload` to start downloading data asynchronously from the specified URL."},{"content":"Parameters","pos":[7347,7357]},{"content":"pT","pos":[7362,7364]},{"content":"[in] A pointer to the object requesting the asynchronous data transfer.","pos":[7369,7440]},{"content":"The <ph id=\"ph1\">`CBindStatusCallback`</ph> object is templatized on this object's class.","pos":[7441,7512],"source":" The `CBindStatusCallback` object is templatized on this object's class."},{"content":"pFunc","pos":[7520,7525]},{"content":"[in] A pointer to the function that receives the data that is read.","pos":[7530,7597]},{"content":"The function is a member of your object's class of type <ph id=\"ph1\">`T`</ph>.","pos":[7598,7658],"source":" The function is a member of your object's class of type `T`."},{"content":"See <bpt id=\"p1\">[</bpt>StartAsyncDownload<ept id=\"p1\">](#cbindstatuscallback__startasyncdownload)</ept> for syntax and an example.","pos":[7659,7752],"source":" See [StartAsyncDownload](#cbindstatuscallback__startasyncdownload) for syntax and an example."},{"content":"[in] The URL to obtain data from.","pos":[7772,7805]},{"content":"Can be any valid URL or file name.","pos":[7806,7840]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[7841,7860],"source":" Cannot be **NULL**."},{"content":"For example:","pos":[7861,7873]},{"content":"[in] The <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> of the container.","pos":[7955,7994],"source":" [in] The **IUnknown** of the container."},{"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> by default.","pos":[7995,8015],"source":"**NULL** by default."},{"content":"[in] A flag indicating whether the URL is relative or absolute.","pos":[8037,8100]},{"content":"<bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> by default, meaning the URL is absolute.","pos":[8101,8151],"source":"**FALSE** by default, meaning the URL is absolute."},{"content":"Return Value","pos":[8161,8173]},{"pos":[8177,8214],"content":"One of the standard <ph id=\"ph1\">`HRESULT`</ph> values.","source":"One of the standard `HRESULT` values."},{"content":"Remarks","pos":[8224,8231]},{"content":"Every time data is available it is sent to the object through <ph id=\"ph1\">`OnDataAvailable`</ph>.","pos":[8235,8315],"source":"Every time data is available it is sent to the object through `OnDataAvailable`."},{"content":"reads the data and calls the function pointed to by <bpt id=\"p1\">*</bpt>pFunc<ept id=\"p1\">*</ept> (for example, to store the data or print it to the screen).","pos":[8334,8453],"source":" reads the data and calls the function pointed to by *pFunc* (for example, to store the data or print it to the screen)."},{"pos":[8512,8544],"content":"CBindStatusCallback::GetBindInfo"},{"content":"Called to tell the moniker how to bind.","pos":[8548,8587]},{"content":"Parameters","pos":[8681,8691]},{"content":"pgrfBSCF","pos":[8696,8704]},{"content":"[out] A pointer to <bpt id=\"p1\">**</bpt>BINDF<ept id=\"p1\">**</ept> enumeration values indicating how the bind operation should occur.","pos":[8709,8804],"source":" [out] A pointer to **BINDF** enumeration values indicating how the bind operation should occur."},{"content":"By default, set with the following enumeration values:","pos":[8805,8859]},{"pos":[8866,8911],"content":"<bpt id=\"p1\">**</bpt>BINDF_ASYNCHRONOUS<ept id=\"p1\">**</ept> Asynchronous download.","source":"**BINDF_ASYNCHRONOUS** Asynchronous download."},{"pos":[8918,9057],"content":"<bpt id=\"p1\">**</bpt>BINDF_ASYNCSTORAGE<ept id=\"p1\">**</ept> <ph id=\"ph1\">`OnDataAvailable`</ph> returns <bpt id=\"p2\">**</bpt>E_PENDING<ept id=\"p2\">**</ept> when data is not yet available rather than blocking until data is available.","source":"**BINDF_ASYNCSTORAGE** `OnDataAvailable` returns **E_PENDING** when data is not yet available rather than blocking until data is available."},{"pos":[9064,9157],"content":"<bpt id=\"p1\">**</bpt>BINDF_GETNEWESTVERSION<ept id=\"p1\">**</ept> The bind operation should retrieve the newest version of the data.","source":"**BINDF_GETNEWESTVERSION** The bind operation should retrieve the newest version of the data."},{"pos":[9164,9256],"content":"<bpt id=\"p1\">**</bpt>BINDF_NOWRITECACHE<ept id=\"p1\">**</ept> The bind operation should not store retrieved data in the disk cache.","source":"**BINDF_NOWRITECACHE** The bind operation should not store retrieved data in the disk cache."},{"content":"pbindinfo","pos":[9264,9273]},{"content":"[in, out] A pointer to the <bpt id=\"p1\">**</bpt>BINDINFO<ept id=\"p1\">**</ept> structure giving more information about how the object wants binding to occur.","pos":[9278,9396],"source":" [in, out] A pointer to the **BINDINFO** structure giving more information about how the object wants binding to occur."},{"content":"Return Value","pos":[9406,9418]},{"pos":[9422,9459],"content":"One of the standard <ph id=\"ph1\">`HRESULT`</ph> values.","source":"One of the standard `HRESULT` values."},{"content":"Remarks","pos":[9469,9476]},{"content":"The default implementation sets the binding to be asynchronous and to use the data-push model.","pos":[9480,9574]},{"content":"In the data-push model, the moniker drives the asynchronous bind operation and continuously notifies the client whenever new data is available.","pos":[9575,9718]},{"pos":[9777,9809],"content":"CBindStatusCallback::GetPriority"},{"content":"Called by the asynchronous moniker to get the priority of the bind operation.","pos":[9813,9890]},{"content":"Parameters","pos":[9955,9965]},{"content":"pnPriority","pos":[9970,9980]},{"content":"[out] Address of the <bpt id=\"p1\">**</bpt>LONG<ept id=\"p1\">**</ept> variable that, on success, receives the priority.","pos":[9985,10064],"source":" [out] Address of the **LONG** variable that, on success, receives the priority."},{"content":"Return Value","pos":[10074,10086]},{"pos":[10090,10112],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[10179,10219],"content":"CBindStatusCallback::m_dwAvailableToRead"},{"content":"Can be used to store the number of bytes available to be read.","pos":[10223,10285]},{"content":"Remarks","pos":[10335,10342]},{"pos":[10346,10390],"content":"Initialized to zero in <ph id=\"ph1\">`StartAsyncDownload`</ph>.","source":"Initialized to zero in `StartAsyncDownload`."},{"pos":[10451,10485],"content":"CBindStatusCallback::m_dwTotalRead"},{"content":"The cumulative total of bytes read in the asynchronous data transfer.","pos":[10489,10558]},{"content":"Remarks","pos":[10602,10609]},{"content":"Incremented every time <ph id=\"ph1\">`OnDataAvailable`</ph> is called by the number of bytes actually read.","pos":[10613,10701],"source":"Incremented every time `OnDataAvailable` is called by the number of bytes actually read."},{"content":"Initialized to zero in <ph id=\"ph1\">`StartAsyncDownload`</ph>.","pos":[10702,10746],"source":" Initialized to zero in `StartAsyncDownload`."},{"pos":[10801,10829],"content":"CBindStatusCallback::m_pFunc"},{"pos":[10833,10994],"content":"The function pointed to by <ph id=\"ph1\">`m_pFunc`</ph> is called by <ph id=\"ph2\">`OnDataAvailable`</ph> after it reads the available data (for example, to store the data or print it to the screen).","source":"The function pointed to by `m_pFunc` is called by `OnDataAvailable` after it reads the available data (for example, to store the data or print it to the screen)."},{"content":"Remarks","pos":[11045,11052]},{"pos":[11056,11157],"content":"The function pointed to by <ph id=\"ph1\">`m_pFunc`</ph> is a member of your object's class and has the following syntax:","source":"The function pointed to by `m_pFunc` is a member of your object's class and has the following syntax:"},{"pos":[11329,11354],"content":"CBindStatusCallback::m_pT"},{"content":"A pointer to the object requesting the asynchronous data transfer.","pos":[11358,11424]},{"content":"Remarks","pos":[11456,11463]},{"pos":[11467,11538],"content":"The <ph id=\"ph1\">`CBindStatusCallback`</ph> object is templatized on this object's class.","source":"The `CBindStatusCallback` object is templatized on this object's class."},{"pos":[11597,11629],"content":"CBindStatusCallback::m_spBindCtx"},{"pos":[11633,11852],"content":"A pointer to an <bpt id=\"p1\">[</bpt>IBindCtx<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms693755)</ept> interface that provides access to the bind context (an object that stores information about a particular moniker binding operation).","source":"A pointer to an [IBindCtx](http://msdn.microsoft.com/library/windows/desktop/ms693755) interface that provides access to the bind context (an object that stores information about a particular moniker binding operation)."},{"content":"Remarks","pos":[11906,11913]},{"pos":[11917,11953],"content":"Initialized in <ph id=\"ph1\">`StartAsyncDownload`</ph>.","source":"Initialized in `StartAsyncDownload`."},{"pos":[12012,12044],"content":"CBindStatusCallback::m_spBinding"},{"pos":[12048,12116],"content":"A pointer to the <ph id=\"ph1\">`IBinding`</ph> interface of the current bind operation.","source":"A pointer to the `IBinding` interface of the current bind operation."},{"content":"Remarks","pos":[12170,12177]},{"pos":[12181,12245],"content":"Initialized in <ph id=\"ph1\">`OnStartBinding`</ph> and released in <ph id=\"ph2\">`OnStopBinding`</ph>.","source":"Initialized in `OnStartBinding` and released in `OnStopBinding`."},{"pos":[12304,12336],"content":"CBindStatusCallback::m_spMoniker"},{"pos":[12340,12457],"content":"A pointer to the <bpt id=\"p1\">[</bpt>IMoniker<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679705)</ept> interface for the URL to use.","source":"A pointer to the [IMoniker](http://msdn.microsoft.com/library/windows/desktop/ms679705) interface for the URL to use."},{"content":"Remarks","pos":[12511,12518]},{"pos":[12522,12558],"content":"Initialized in <ph id=\"ph1\">`StartAsyncDownload`</ph>.","source":"Initialized in `StartAsyncDownload`."},{"pos":[12616,12647],"content":"CBindStatusCallback::m_spStream"},{"pos":[12651,12778],"content":"A pointer to the <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> interface of the current bind operation.","source":"A pointer to the [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) interface of the current bind operation."},{"content":"Remarks","pos":[12830,12837]},{"pos":[12841,13033],"content":"Initialized in <ph id=\"ph1\">`OnDataAvailable`</ph> from the <bpt id=\"p1\">**</bpt>STGMEDIUM<ept id=\"p1\">**</ept> structure when the <bpt id=\"p2\">**</bpt>BCSF<ept id=\"p2\">**</ept> flag is <bpt id=\"p3\">**</bpt>BCSF_FIRSTDATANOTIFICATION<ept id=\"p3\">**</ept> and released when the <bpt id=\"p4\">**</bpt>BCSF<ept id=\"p4\">**</ept> flag is <bpt id=\"p5\">**</bpt>BCSF_LASTDATANOTIFICATION<ept id=\"p5\">**</ept>.","source":"Initialized in `OnDataAvailable` from the **STGMEDIUM** structure when the **BCSF** flag is **BCSF_FIRSTDATANOTIFICATION** and released when the **BCSF** flag is **BCSF_LASTDATANOTIFICATION**."},{"pos":[13096,13132],"content":"CBindStatusCallback::OnDataAvailable"},{"pos":[13136,13255],"content":"The system-supplied asynchronous moniker calls <ph id=\"ph1\">`OnDataAvailable`</ph> to provide data to the object as it becomes available.","source":"The system-supplied asynchronous moniker calls `OnDataAvailable` to provide data to the object as it becomes available."},{"content":"Parameters","pos":[13396,13406]},{"content":"grfBSCF","pos":[13411,13418]},{"content":"[in] A <bpt id=\"p1\">**</bpt>BSCF<ept id=\"p1\">**</ept> enumeration value.","pos":[13423,13457],"source":" [in] A **BSCF** enumeration value."},{"content":"One or more of the following: <bpt id=\"p1\">**</bpt>BSCF_FIRSTDATANOTIFICATION<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>BSCF_INTERMEDIARYDATANOTIFICATION<ept id=\"p2\">**</ept>, or <bpt id=\"p3\">**</bpt>BSCF_LASTDATANOTIFICATION<ept id=\"p3\">**</ept>.","pos":[13458,13592],"source":" One or more of the following: **BSCF_FIRSTDATANOTIFICATION**, **BSCF_INTERMEDIARYDATANOTIFICATION**, or **BSCF_LASTDATANOTIFICATION**."},{"content":"[in] The cumulative amount (in bytes) of data available since the beginning of the binding.","pos":[13611,13702]},{"content":"Can be zero, indicating that the amount of data is not relevant or that no specific amount became available.","pos":[13703,13811]},{"content":"pformatetc","pos":[13819,13829]},{"content":"[in] Pointer to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682242)</ept> structure that contains the format of the available data.","pos":[13834,13983],"source":" [in] Pointer to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682242) structure that contains the format of the available data."},{"content":"If there is no format, can be <bpt id=\"p1\">**</bpt>CF_NULL<ept id=\"p1\">**</ept>.","pos":[13984,14026],"source":" If there is no format, can be **CF_NULL**."},{"content":"pstgmed","pos":[14034,14041]},{"content":"[in] Pointer to the <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms695269)</ept> structure that holds the actual data now available.","pos":[14046,14189],"source":" [in] Pointer to the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms695269) structure that holds the actual data now available."},{"content":"Return Value","pos":[14199,14211]},{"pos":[14215,14252],"content":"One of the standard <ph id=\"ph1\">`HRESULT`</ph> values.","source":"One of the standard `HRESULT` values."},{"content":"Remarks","pos":[14262,14269]},{"content":"reads the data, then calls a method of your object's class (for example, to store the data or print it to the screen).","pos":[14291,14409]},{"content":"See <bpt id=\"p1\">[</bpt>CBindStatusCallback::StartAsyncDownload<ept id=\"p1\">](#cbindstatuscallback__startasyncdownload)</ept> for details.","pos":[14410,14510],"source":" See [CBindStatusCallback::StartAsyncDownload](#cbindstatuscallback__startasyncdownload) for details."},{"pos":[14571,14605],"content":"CBindStatusCallback::OnLowResource"},{"content":"Called when resources are low.","pos":[14609,14639]},{"content":"Parameters","pos":[14712,14722]},{"content":"Reserved.","pos":[14742,14751]},{"content":"Return Value","pos":[14761,14773]},{"pos":[14777,14792],"content":"Returns <ph id=\"ph1\">`S_OK`</ph>.","source":"Returns `S_OK`."},{"pos":[14857,14895],"content":"CBindStatusCallback::OnObjectAvailable"},{"content":"Called by the asynchronous moniker to pass an object interface pointer to your application.","pos":[14899,14990]},{"content":"Parameters","pos":[15087,15097]},{"content":"Interface identifier of the requested interface.","pos":[15111,15159]},{"content":"Unused.","pos":[15160,15167]},{"content":"Address of the IUnknown interface.","pos":[15184,15218]},{"content":"Unused.","pos":[15219,15226]},{"content":"Return Value","pos":[15236,15248]},{"pos":[15252,15267],"content":"Returns <ph id=\"ph1\">`S_OK`</ph>.","source":"Returns `S_OK`."},{"pos":[15325,15356],"content":"CBindStatusCallback::OnProgress"},{"content":"Called to indicate the progress of a data downloading process.","pos":[15360,15422]},{"content":"Parameters","pos":[15588,15598]},{"content":"Unsigned long integer.","pos":[15618,15640]},{"content":"Unused.","pos":[15641,15648]},{"content":"Unsigned long integer Unused.","pos":[15674,15703]},{"content":"Unsigned long integer.","pos":[15728,15750]},{"content":"Unused.","pos":[15751,15758]},{"content":"Address of a string value.","pos":[15783,15809]},{"content":"Unused.","pos":[15810,15817]},{"content":"Return Value","pos":[15827,15839]},{"pos":[15843,15858],"content":"Returns <ph id=\"ph1\">`S_OK`</ph>.","source":"Returns `S_OK`."},{"pos":[15920,15955],"content":"CBindStatusCallback::OnStartBinding"},{"pos":[15959,16069],"content":"Sets the data member <bpt id=\"p1\">[</bpt>m_spBinding<ept id=\"p1\">](#cbindstatuscallback__m_spbinding)</ept> to the <ph id=\"ph1\">`IBinding`</ph> pointer in <ph id=\"ph2\">`pBinding`</ph>.","source":"Sets the data member [m_spBinding](#cbindstatuscallback__m_spbinding) to the `IBinding` pointer in `pBinding`."},{"content":"Parameters","pos":[16167,16177]},{"content":"Reserved for future use.","pos":[16197,16221]},{"content":"[in] Address of the IBinding interface of the current bind operation.","pos":[16242,16311]},{"content":"This cannot be NULL.","pos":[16312,16332]},{"content":"The client should call AddRef on this pointer to keep a reference to the binding object.","pos":[16333,16421]},{"pos":[16482,16516],"content":"CBindStatusCallback::OnStopBinding"},{"pos":[16520,16620],"content":"Releases the <ph id=\"ph1\">`IBinding`</ph> pointer in the data member <bpt id=\"p1\">[</bpt>m_spBinding<ept id=\"p1\">](#cbindstatuscallback__m_spbinding)</ept>.","source":"Releases the `IBinding` pointer in the data member [m_spBinding](#cbindstatuscallback__m_spbinding)."},{"content":"Parameters","pos":[16710,16720]},{"content":"Status code returned from the bind operation.","pos":[16737,16782]},{"content":"szStatusText","pos":[16789,16801]},{"content":"Address of a string value Unused.","pos":[16805,16838]},{"content":"Remarks","pos":[16848,16855]},{"content":"Called by the system-supplied asynchronous moniker to indicate the end of the bind operation.","pos":[16859,16952]},{"pos":[17018,17057],"content":"CBindStatusCallback::StartAsyncDownload"},{"content":"Starts downloading data asynchronously from the specified URL.","pos":[17061,17123]},{"content":"Parameters","pos":[17293,17303]},{"content":"pT","pos":[17308,17310]},{"content":"[in] A pointer to the object requesting the asynchronous data transfer.","pos":[17315,17386]},{"content":"The <ph id=\"ph1\">`CBindStatusCallback`</ph> object is templatized on this object's class.","pos":[17387,17458],"source":" The `CBindStatusCallback` object is templatized on this object's class."},{"content":"pFunc","pos":[17466,17471]},{"content":"[in] A pointer to the function that receives the data being read.","pos":[17476,17541]},{"content":"The function is a member of your object's class of type <ph id=\"ph1\">`T`</ph>.","pos":[17542,17602],"source":" The function is a member of your object's class of type `T`."},{"content":"See <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> for syntax and an example.","pos":[17603,17645],"source":" See **Remarks** for syntax and an example."},{"content":"[in] The URL to obtain data from.","pos":[17665,17698]},{"content":"Can be any valid URL or file name.","pos":[17699,17733]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[17734,17753],"source":" Cannot be **NULL**."},{"content":"For example:","pos":[17754,17766]},{"content":"[in] The <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> of the container.","pos":[17848,17887],"source":" [in] The **IUnknown** of the container."},{"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> by default.","pos":[17888,17908],"source":"**NULL** by default."},{"content":"[in] A flag indicating whether the URL is relative or absolute.","pos":[17930,17993]},{"content":"<bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> by default, meaning the URL is absolute.","pos":[17994,18044],"source":"**FALSE** by default, meaning the URL is absolute."},{"content":"Return Value","pos":[18054,18066]},{"pos":[18070,18107],"content":"One of the standard <ph id=\"ph1\">`HRESULT`</ph> values.","source":"One of the standard `HRESULT` values."},{"content":"Remarks","pos":[18117,18124]},{"content":"Every time data is available it is sent to the object through <ph id=\"ph1\">`OnDataAvailable`</ph>.","pos":[18128,18208],"source":"Every time data is available it is sent to the object through `OnDataAvailable`."},{"content":"reads the data and calls the function pointed to by <bpt id=\"p1\">*</bpt>pFunc<ept id=\"p1\">*</ept> (for example, to store the data or print it to the screen).","pos":[18227,18346],"source":" reads the data and calls the function pointed to by *pFunc* (for example, to store the data or print it to the screen)."},{"pos":[18353,18452],"content":"The function pointed to by <bpt id=\"p1\">*</bpt>pFunc<ept id=\"p1\">*</ept> is a member of your object's class and has the following syntax:","source":"The function pointed to by *pFunc* is a member of your object's class and has the following syntax:"},{"pos":[18591,18741],"content":"In the following example (taken from the <bpt id=\"p1\">[</bpt>ASYNC<ept id=\"p1\">](../../visual-cpp-samples.md)</ept> sample), the function <ph id=\"ph1\">`OnData`</ph> writes the received data into a text box.","source":"In the following example (taken from the [ASYNC](../../visual-cpp-samples.md) sample), the function `OnData` writes the received data into a text box."},{"content":"Example","pos":[18751,18758]},{"pos":[18773,18793],"content":"NVC_ATL_Windowing#87"},{"content":"See Also","pos":[18861,18869]},{"content":"Class Overview","pos":[18874,18888]}],"content":"---\ntitle: \"CBindStatusCallback Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CBindStatusCallback\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"asynchronous data transfer [C++]\"\n  - \"data transfer [C++]\"\n  - \"data transfer [C++], asynchronous\"\n  - \"CBindStatusCallback class\"\nms.assetid: 0f5da276-6031-4418-b2a9-a4750ef29e77\ncaps.latest.revision: 22\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CBindStatusCallback Class\nThis class implements the `IBindStatusCallback` interface.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\ntemplate <class T,\n    int nBindFlags = BINDF_ASYNCHRONOUS |   BINDF_ASYNCSTORAGE | BINDF_GETNEWESTVERSION | BINDF_NOWRITECACHE>  class ATL_NO_VTABLE CBindStatusCallback : public CComObjectRootEx\n <T ::_ThreadModel::ThreadModelNoCS>,\n    public IBindStatusCallbackImpl<T>\n```  \n  \n#### Parameters  \n `T`  \n Your class containing the function that will be called as the data is received.  \n  \n *nBindFlags*  \n Specifies the bind flags that are returned by [GetBindInfo](#cbindstatuscallback__getbindinfo). The default implementation sets the binding to be asynchronous, retrieves the newest version of the data/object, and does not store retrieved data in the disk cache.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CBindStatusCallback::CBindStatusCallback](#cbindstatuscallback__cbindstatuscallback)|The constructor.|  \n|[CBindStatusCallback::~CBindStatusCallback](#cbindstatuscallback___dtorcbindstatuscallback)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CBindStatusCallback::Download](#cbindstatuscallback__download)|Static method that starts the download process, creates a `CBindStatusCallback` object, and calls `StartAsyncDownload`.|  \n|[CBindStatusCallback::GetBindInfo](#cbindstatuscallback__getbindinfo)|Called by the asynchronous moniker to request information on the type of bind to be created.|  \n|[CBindStatusCallback::GetPriority](#cbindstatuscallback__getpriority)|Called by the asynchronous moniker to get the priority of the bind operation. The ATL implementation returns `E_NOTIMPL`.|  \n|[CBindStatusCallback::OnDataAvailable](#cbindstatuscallback__ondataavailable)|Called to provide data to your application as it becomes available. Reads the data, then calls the function passed to it to use the data.|  \n|[CBindStatusCallback::OnLowResource](#cbindstatuscallback__onlowresource)|Called when resources are low. The ATL implementation returns `S_OK`.|  \n|[CBindStatusCallback::OnObjectAvailable](#cbindstatuscallback__onobjectavailable)|Called by the asynchronous moniker to pass an object interface pointer to your application. The ATL implementation returns `S_OK`.|  \n|[CBindStatusCallback::OnProgress](#cbindstatuscallback__onprogress)|Called to indicate the progress of a data downloading process. The ATL implementation returns `S_OK`.|  \n|[CBindStatusCallback::OnStartBinding](#cbindstatuscallback__onstartbinding)|Called when binding is started.|  \n|[CBindStatusCallback::OnStopBinding](#cbindstatuscallback__onstopbinding)|Called when the asynchronous data transfer is stopped.|  \n|[CBindStatusCallback::StartAsyncDownload](#cbindstatuscallback__startasyncdownload)|Initializes the bytes available and bytes read to zero, creates a push-type stream object from a URL, and calls `OnDataAvailable` every time data is available.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CBindStatusCallback::m_dwAvailableToRead](#cbindstatuscallback__m_dwavailabletoread)|Number of bytes available to read.|  \n|[CBindStatusCallback::m_dwTotalRead](#cbindstatuscallback__m_dwtotalread)|Total number of bytes read.|  \n|[CBindStatusCallback::m_pFunc](#cbindstatuscallback__m_pfunc)|Pointer to the function called when data is available.|  \n|[CBindStatusCallback::m_pT](#cbindstatuscallback__m_pt)|Pointer to the object requesting the asynchronous data transfer.|  \n|[CBindStatusCallback::m_spBindCtx](#cbindstatuscallback__m_spbindctx)|Pointer to the [IBindCtx](http://msdn.microsoft.com/library/windows/desktop/ms693755) interface for the current bind operation.|  \n|[CBindStatusCallback::m_spBinding](#cbindstatuscallback__m_spbinding)|Pointer to the `IBinding` interface for the current bind operation.|  \n|[CBindStatusCallback::m_spMoniker](#cbindstatuscallback__m_spmoniker)|Pointer to the [IMoniker](http://msdn.microsoft.com/library/windows/desktop/ms679705) interface for the URL to use.|  \n|[CBindStatusCallback::m_spStream](#cbindstatuscallback__m_spstream)|Pointer to the [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) interface for the data transfer.|  \n  \n## Remarks  \n The `CBindStatusCallback` class implements the `IBindStatusCallback` interface. `IBindStatusCallback` must be implemented by your application so it can receive notifications from an asynchronous data transfer. The asynchronous moniker provided by the system uses `IBindStatusCallback` methods to send and receive information about the asynchronous data transfer to and from your object.  \n  \n Typically, the `CBindStatusCallback` object is associated with a specific bind operation. For example, in the [ASYNC](../../visual-cpp-samples.md) sample, when you set the URL property, it creates a `CBindStatusCallback` object in the call to `Download`:  \n  \n [!code-cpp[NVC_ATL_Windowing#86](../../atl/codesnippet/cpp/cbindstatuscallback-class_1.h)]  \n  \n The asynchronous moniker uses the callback function `OnData` to call your application when it has data. The asynchronous moniker is provided by the system.  \n  \n## Inheritance Hierarchy  \n `CComObjectRootBase`  \n  \n `IBindStatusCallback`  \n  \n [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md)  \n  \n `CBindStatusCallback`  \n  \n## Requirements  \n **Header:** atlctl.h  \n  \n##  <a name=\"cbindstatuscallback__cbindstatuscallback\"></a>  CBindStatusCallback::CBindStatusCallback  \n The constructor.  \n  \n```\nCBindStatusCallback();\n```  \n  \n### Remarks  \n Creates an object to receive notifications concerning the asynchronous data transfer. Typically, one object is created for each bind operation.  \n  \n The constructor also initializes [m_pT](#cbindstatuscallback__m_pt) and [m_pFunc](#cbindstatuscallback__m_pfunc) to **NULL**.  \n  \n##  <a name=\"cbindstatuscallback___dtorcbindstatuscallback\"></a>  CBindStatusCallback::~CBindStatusCallback  \n The destructor.  \n  \n```\n~CBindStatusCallback();\n```  \n  \n### Remarks  \n Frees all allocated resources.  \n  \n##  <a name=\"cbindstatuscallback__download\"></a>  CBindStatusCallback::Download  \n Creates a `CBindStatusCallback` object and calls `StartAsyncDownload` to start downloading data asynchronously from the specified URL.  \n  \n```\nstatic HRESULT Download(T* pT,\n    ATL_PDATAAVAILABLE pFunc,\n    BSTR bstrURL,\n    IUnknown* pUnkContainer = NULL,\n    BOOL bRelative = FALSE);\n```  \n  \n### Parameters  \n *pT*  \n [in] A pointer to the object requesting the asynchronous data transfer. The `CBindStatusCallback` object is templatized on this object's class.  \n  \n *pFunc*  \n [in] A pointer to the function that receives the data that is read. The function is a member of your object's class of type `T`. See [StartAsyncDownload](#cbindstatuscallback__startasyncdownload) for syntax and an example.  \n  \n `bstrURL`  \n [in] The URL to obtain data from. Can be any valid URL or file name. Cannot be **NULL**. For example:  \n  \n `CComBSTR mybstr =_T(\"http://somesite/data.htm\")`  \n  \n `pUnkContainer`  \n [in] The **IUnknown** of the container. **NULL** by default.  \n  \n `bRelative`  \n [in] A flag indicating whether the URL is relative or absolute. **FALSE** by default, meaning the URL is absolute.  \n  \n### Return Value  \n One of the standard `HRESULT` values.  \n  \n### Remarks  \n Every time data is available it is sent to the object through `OnDataAvailable`. `OnDataAvailable` reads the data and calls the function pointed to by *pFunc* (for example, to store the data or print it to the screen).  \n  \n##  <a name=\"cbindstatuscallback__getbindinfo\"></a>  CBindStatusCallback::GetBindInfo  \n Called to tell the moniker how to bind.  \n  \n```\nSTDMETHOD(GetBindInfo)(\n    DWORD* pgrfBSCF,\n    BINDINFO* pbindinfo);\n```  \n  \n### Parameters  \n *pgrfBSCF*  \n [out] A pointer to **BINDF** enumeration values indicating how the bind operation should occur. By default, set with the following enumeration values:  \n  \n **BINDF_ASYNCHRONOUS** Asynchronous download.  \n  \n **BINDF_ASYNCSTORAGE** `OnDataAvailable` returns **E_PENDING** when data is not yet available rather than blocking until data is available.  \n  \n **BINDF_GETNEWESTVERSION** The bind operation should retrieve the newest version of the data.  \n  \n **BINDF_NOWRITECACHE** The bind operation should not store retrieved data in the disk cache.  \n  \n *pbindinfo*  \n [in, out] A pointer to the **BINDINFO** structure giving more information about how the object wants binding to occur.  \n  \n### Return Value  \n One of the standard `HRESULT` values.  \n  \n### Remarks  \n The default implementation sets the binding to be asynchronous and to use the data-push model. In the data-push model, the moniker drives the asynchronous bind operation and continuously notifies the client whenever new data is available.  \n  \n##  <a name=\"cbindstatuscallback__getpriority\"></a>  CBindStatusCallback::GetPriority  \n Called by the asynchronous moniker to get the priority of the bind operation.  \n  \n```\nSTDMETHOD(GetPriority)(LONG* pnPriority);\n```  \n  \n### Parameters  \n *pnPriority*  \n [out] Address of the **LONG** variable that, on success, receives the priority.  \n  \n### Return Value  \n Returns **E_NOTIMPL**.  \n  \n##  <a name=\"cbindstatuscallback__m_dwavailabletoread\"></a>  CBindStatusCallback::m_dwAvailableToRead  \n Can be used to store the number of bytes available to be read.  \n  \n```\nDWORD m_dwAvailableToRead;\n```  \n  \n### Remarks  \n Initialized to zero in `StartAsyncDownload`.  \n  \n##  <a name=\"cbindstatuscallback__m_dwtotalread\"></a>  CBindStatusCallback::m_dwTotalRead  \n The cumulative total of bytes read in the asynchronous data transfer.  \n  \n```\nDWORD m_dwTotalRead;\n```  \n  \n### Remarks  \n Incremented every time `OnDataAvailable` is called by the number of bytes actually read. Initialized to zero in `StartAsyncDownload`.  \n  \n##  <a name=\"cbindstatuscallback__m_pfunc\"></a>  CBindStatusCallback::m_pFunc  \n The function pointed to by `m_pFunc` is called by `OnDataAvailable` after it reads the available data (for example, to store the data or print it to the screen).  \n  \n```\nATL_PDATAAVAILABLE m_pFunc;\n```  \n  \n### Remarks  \n The function pointed to by `m_pFunc` is a member of your object's class and has the following syntax:  \n  \n `void Function_Name(`  \n  \n `CBindStatusCallback<T>* pbsc,`  \n  \n `BYTE* pBytes,`  \n  \n `DWORD dwSize`  \n  \n `);`  \n  \n##  <a name=\"cbindstatuscallback__m_pt\"></a>  CBindStatusCallback::m_pT  \n A pointer to the object requesting the asynchronous data transfer.  \n  \n```\nT* m_pT;\n```  \n  \n### Remarks  \n The `CBindStatusCallback` object is templatized on this object's class.  \n  \n##  <a name=\"cbindstatuscallback__m_spbindctx\"></a>  CBindStatusCallback::m_spBindCtx  \n A pointer to an [IBindCtx](http://msdn.microsoft.com/library/windows/desktop/ms693755) interface that provides access to the bind context (an object that stores information about a particular moniker binding operation).  \n  \n```\nCComPtr<IBindCtx> m_spBindCtx;\n```  \n  \n### Remarks  \n Initialized in `StartAsyncDownload`.  \n  \n##  <a name=\"cbindstatuscallback__m_spbinding\"></a>  CBindStatusCallback::m_spBinding  \n A pointer to the `IBinding` interface of the current bind operation.  \n  \n```\nCComPtr<IBinding> m_spBinding;\n```  \n  \n### Remarks  \n Initialized in `OnStartBinding` and released in `OnStopBinding`.  \n  \n##  <a name=\"cbindstatuscallback__m_spmoniker\"></a>  CBindStatusCallback::m_spMoniker  \n A pointer to the [IMoniker](http://msdn.microsoft.com/library/windows/desktop/ms679705) interface for the URL to use.  \n  \n```\nCComPtr<IMoniker> m_spMoniker;\n```  \n  \n### Remarks  \n Initialized in `StartAsyncDownload`.  \n  \n##  <a name=\"cbindstatuscallback__m_spstream\"></a>  CBindStatusCallback::m_spStream  \n A pointer to the [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) interface of the current bind operation.  \n  \n```\nCComPtr<IStream> m_spStream;\n```  \n  \n### Remarks  \n Initialized in `OnDataAvailable` from the **STGMEDIUM** structure when the **BCSF** flag is **BCSF_FIRSTDATANOTIFICATION** and released when the **BCSF** flag is **BCSF_LASTDATANOTIFICATION**.  \n  \n##  <a name=\"cbindstatuscallback__ondataavailable\"></a>  CBindStatusCallback::OnDataAvailable  \n The system-supplied asynchronous moniker calls `OnDataAvailable` to provide data to the object as it becomes available.  \n  \n```\nSTDMETHOD(OnDataAvailable)(DWORD grfBSCF,\n    DWORD dwSize,\n    FORMATETC* /* pformatetc */,\n    STGMEDIUM* pstgmed);\n```  \n  \n### Parameters  \n *grfBSCF*  \n [in] A **BSCF** enumeration value. One or more of the following: **BSCF_FIRSTDATANOTIFICATION**, **BSCF_INTERMEDIARYDATANOTIFICATION**, or **BSCF_LASTDATANOTIFICATION**.  \n  \n `dwSize`  \n [in] The cumulative amount (in bytes) of data available since the beginning of the binding. Can be zero, indicating that the amount of data is not relevant or that no specific amount became available.  \n  \n *pformatetc*  \n [in] Pointer to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682242) structure that contains the format of the available data. If there is no format, can be **CF_NULL**.  \n  \n *pstgmed*  \n [in] Pointer to the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms695269) structure that holds the actual data now available.  \n  \n### Return Value  \n One of the standard `HRESULT` values.  \n  \n### Remarks  \n `OnDataAvailable` reads the data, then calls a method of your object's class (for example, to store the data or print it to the screen). See [CBindStatusCallback::StartAsyncDownload](#cbindstatuscallback__startasyncdownload) for details.  \n  \n##  <a name=\"cbindstatuscallback__onlowresource\"></a>  CBindStatusCallback::OnLowResource  \n Called when resources are low.  \n  \n```\nSTDMETHOD(OnLowResource)(DWORD /* dwReserved */);\n```  \n  \n### Parameters  \n `dwReserved`  \n Reserved.  \n  \n### Return Value  \n Returns `S_OK`.  \n  \n##  <a name=\"cbindstatuscallback__onobjectavailable\"></a>  CBindStatusCallback::OnObjectAvailable  \n Called by the asynchronous moniker to pass an object interface pointer to your application.  \n  \n```\nSTDMETHOD(OnObjectAvailable)(REFID /* riid */,\n    IUnknown* /* punk */);\n```  \n  \n### Parameters  \n `riid`  \n Interface identifier of the requested interface. Unused.  \n  \n `punk`  \n Address of the IUnknown interface. Unused.  \n  \n### Return Value  \n Returns `S_OK`.  \n  \n##  <a name=\"cbindstatuscallback__onprogress\"></a>  CBindStatusCallback::OnProgress  \n Called to indicate the progress of a data downloading process.  \n  \n```\nSTDMETHOD(OnProgress)(ULONG /* ulProgress */,\n    ULONG /* ulProgressMax */,\n    ULONG /* ulStatusCode */,\n    LPCWSTRONG /* szStatusText */);\n```  \n  \n### Parameters  \n `ulProgress`  \n Unsigned long integer. Unused.  \n  \n `ulProgressMax`  \n Unsigned long integer Unused.  \n  \n `ulStatusCode`  \n Unsigned long integer. Unused.  \n  \n `szStatusText`  \n Address of a string value. Unused.  \n  \n### Return Value  \n Returns `S_OK`.  \n  \n##  <a name=\"cbindstatuscallback__onstartbinding\"></a>  CBindStatusCallback::OnStartBinding  \n Sets the data member [m_spBinding](#cbindstatuscallback__m_spbinding) to the `IBinding` pointer in `pBinding`.  \n  \n```\nSTDMETHOD(OnStartBinding)(DWORD /* dwReserved */,\n    IBinding* pBinding);\n```  \n  \n### Parameters  \n `dwReserved`  \n Reserved for future use.  \n  \n `pBinding`  \n [in] Address of the IBinding interface of the current bind operation. This cannot be NULL. The client should call AddRef on this pointer to keep a reference to the binding object.  \n  \n##  <a name=\"cbindstatuscallback__onstopbinding\"></a>  CBindStatusCallback::OnStopBinding  \n Releases the `IBinding` pointer in the data member [m_spBinding](#cbindstatuscallback__m_spbinding).  \n  \n```\nSTDMETHOD(OnStopBinding)(HRESULT hresult,  LPCWSTR /* szError */);\n```  \n  \n### Parameters  \n `hresult`  \n Status code returned from the bind operation.  \n  \n szStatusText  \n Address of a string value Unused.  \n  \n### Remarks  \n Called by the system-supplied asynchronous moniker to indicate the end of the bind operation.  \n  \n##  <a name=\"cbindstatuscallback__startasyncdownload\"></a>  CBindStatusCallback::StartAsyncDownload  \n Starts downloading data asynchronously from the specified URL.  \n  \n```\nHRESULT StartAsyncDownload(T* pT,\n    ATL_PDATAAVAILABLE pFunc,\n    BSTR bstrURL,\n    IUnknown* pUnkContainer = NULL,\n    BOOL bRelative = FALSE);\n```  \n  \n### Parameters  \n *pT*  \n [in] A pointer to the object requesting the asynchronous data transfer. The `CBindStatusCallback` object is templatized on this object's class.  \n  \n *pFunc*  \n [in] A pointer to the function that receives the data being read. The function is a member of your object's class of type `T`. See **Remarks** for syntax and an example.  \n  \n `bstrURL`  \n [in] The URL to obtain data from. Can be any valid URL or file name. Cannot be **NULL**. For example:  \n  \n `CComBSTR mybstr =_T(\"http://somesite/data.htm\")`  \n  \n `pUnkContainer`  \n [in] The **IUnknown** of the container. **NULL** by default.  \n  \n `bRelative`  \n [in] A flag indicating whether the URL is relative or absolute. **FALSE** by default, meaning the URL is absolute.  \n  \n### Return Value  \n One of the standard `HRESULT` values.  \n  \n### Remarks  \n Every time data is available it is sent to the object through `OnDataAvailable`. `OnDataAvailable` reads the data and calls the function pointed to by *pFunc* (for example, to store the data or print it to the screen).  \n  \n The function pointed to by *pFunc* is a member of your object's class and has the following syntax:  \n  \n `void Function_Name(`  \n  \n `CBindStatusCallback<T>*` `pbsc` `,`  \n  \n `BYTE*` `pBytes` `,`  \n  \n `DWORD` `dwSize`  \n  \n `);`  \n  \n In the following example (taken from the [ASYNC](../../visual-cpp-samples.md) sample), the function `OnData` writes the received data into a text box.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#87](../../atl/codesnippet/cpp/cbindstatuscallback-class_2.h)]  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}