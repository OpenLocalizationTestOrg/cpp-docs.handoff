{"nodes":[{"pos":[12,49],"content":"CMFCMenuButton Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCMenuButton Class | Microsoft Docs","pos":[0,37]}]},{"content":"CMFCMenuButton Class","pos":[642,662]},{"content":"A button that displays a pop-up menu and reports on the user's menu selections.","pos":[663,742]},{"content":"Syntax","pos":[751,757]},{"content":"Members","pos":[824,831]},{"content":"Public Constructors","pos":[841,860]},{"content":"Name","pos":[867,871]},{"content":"Description","pos":[872,883]},{"content":"CMFCMenuButton::CMFCMenuButton","pos":[922,952]},{"pos":[987,1024],"content":"Constructs a <ph id=\"ph1\">`CMFCMenuButton`</ph> object.","source":"Constructs a `CMFCMenuButton` object."},{"content":"Public Methods","pos":[1035,1049]},{"content":"Name","pos":[1056,1060]},{"content":"Description","pos":[1061,1072]},{"content":"CMFCMenuButton::PreTranslateMessage","pos":[1111,1146]},{"content":"Called by the framework to translate window messages before they are dispatched.","pos":[1186,1266]},{"content":"(Overrides <ph id=\"ph1\">`CMFCButton::PreTranslateMessage`</ph>.)","pos":[1267,1313],"source":" (Overrides `CMFCButton::PreTranslateMessage`.)"},{"content":"CMFCMenuButton::SizeToContent","pos":[1319,1348]},{"content":"Changes the size of the button according to its text and image size.","pos":[1382,1450]},{"content":"Data Members","pos":[1461,1473]},{"content":"Name","pos":[1480,1484]},{"content":"Description","pos":[1485,1496]},{"content":"CMFCMenuButton::m_bOSMenu","pos":[1535,1560]},{"pos":[1590,1784],"content":"Specifies whether to display the default system pop-up menu or to use <bpt id=\"p1\">[</bpt>CContextMenuManager::TrackPopupMenu<ept id=\"p1\">](../../mfc/reference/ccontextmenumanager-class.md#ccontextmenumanager__trackpopupmenu)</ept>.","source":"Specifies whether to display the default system pop-up menu or to use [CContextMenuManager::TrackPopupMenu](../../mfc/reference/ccontextmenumanager-class.md#ccontextmenumanager__trackpopupmenu)."},{"content":"CMFCMenuButton::m_bRightArrow","pos":[1790,1819]},{"content":"Specifies whether the pop-up menu will appear underneath or to the right of the button.","pos":[1853,1940]},{"content":"CMFCMenuButton::m_bStayPressed","pos":[1946,1976]},{"content":"Specifies whether the menu button changes its state after the user releases the button.","pos":[2011,2098]},{"content":"CMFCMenuButton::m_hMenu","pos":[2104,2127]},{"content":"A handle to the attached Windows menu.","pos":[2155,2193]},{"content":"CMFCMenuButton::m_nMenuResult","pos":[2199,2228]},{"content":"An identifier that indicates which item the user selected from the pop-up menu.","pos":[2262,2341]},{"content":"Remarks","pos":[2351,2358]},{"content":"The <ph id=\"ph1\">`CMFCMenuButton`</ph> class is derived from the <bpt id=\"p1\">[</bpt>CMFCButton Class<ept id=\"p1\">](../../mfc/reference/cmfcbutton-class.md)</ept> which is, in turn, derived from the <bpt id=\"p2\">[</bpt>CButton Class<ept id=\"p2\">](../../mfc/reference/cbutton-class.md)</ept>.","pos":[2362,2559],"source":"The `CMFCMenuButton` class is derived from the [CMFCButton Class](../../mfc/reference/cmfcbutton-class.md) which is, in turn, derived from the [CButton Class](../../mfc/reference/cbutton-class.md)."},{"content":"Therefore, you can use <ph id=\"ph1\">`CMFCMenuButton`</ph> in your code the same way you would use <ph id=\"ph2\">`CButton`</ph>.","pos":[2560,2650],"source":" Therefore, you can use `CMFCMenuButton` in your code the same way you would use `CButton`."},{"content":"When you create a <ph id=\"ph1\">`CMFCMenuButton`</ph>, you must pass in a handle to the associated pop-up menu.","pos":[2657,2749],"source":"When you create a `CMFCMenuButton`, you must pass in a handle to the associated pop-up menu."},{"content":"Next, call the function <ph id=\"ph1\">`CMFCMenuButton::SizeToContent`</ph>.","pos":[2750,2806],"source":" Next, call the function `CMFCMenuButton::SizeToContent`."},{"content":"checks that the button size is sufficient to include an arrow that points to the location where the pop-up window will appear - namely, underneath or to the right of the button.","pos":[2839,3016]},{"content":"Example","pos":[3025,3032]},{"content":"The following example demonstrates how to set the handle of the menu attached to the button, resize the button according to its text and image size, and set the pop-up menu that is displayed by the framework.","pos":[3036,3244]},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>New Controls sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[3245,3329],"source":" This code snippet is part of the [New Controls sample](../../visual-cpp-samples.md)."},{"content":"NVC_MFC_NewControls#38","pos":[3347,3369]},{"content":"NVC_MFC_NewControls#39","pos":[3447,3469]},{"content":"Inheritance Hierarchy","pos":[3544,3565]},{"content":"CObject","pos":[3570,3577]},{"content":"CCmdTarget","pos":[3624,3634]},{"content":"CWnd","pos":[3684,3688]},{"content":"CButton","pos":[3732,3739]},{"content":"CMFCButton","pos":[3786,3796]},{"content":"CMFCMenuButton","pos":[3846,3860]},{"content":"Requirements","pos":[3915,3927]},{"pos":[3931,3958],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxmenubutton.h","source":"**Header:** afxmenubutton.h"},{"pos":[4015,4045],"content":"CMFCMenuButton::CMFCMenuButton"},{"pos":[4049,4135],"content":"Constructs a new <bpt id=\"p1\">[</bpt>CMFCMenuButton<ept id=\"p1\">](../../mfc/reference/cmfcmenubutton-class.md)</ept> object.","source":"Constructs a new [CMFCMenuButton](../../mfc/reference/cmfcmenubutton-class.md) object."},{"pos":[4220,4245],"content":"CMFCMenuButton::m_bOSMenu"},{"content":"A Boolean member variable that indicates which pop-up menu the framework displays.","pos":[4249,4331]},{"content":"Remarks","pos":[4374,4381]},{"content":"If <ph id=\"ph1\">`m_bOSMenu`</ph> is <ph id=\"ph2\">`TRUE`</ph>, the framework calls the inherited <ph id=\"ph3\">`TrackPopupMenu`</ph> method for this object.","pos":[4385,4485],"source":"If `m_bOSMenu` is `TRUE`, the framework calls the inherited `TrackPopupMenu` method for this object."},{"content":"Otherwise, the framework calls <bpt id=\"p1\">[</bpt>CContextMenuManager::TrackPopupMenu<ept id=\"p1\">](../../mfc/reference/ccontextmenumanager-class.md#ccontextmenumanager__trackpopupmenu)</ept>.","pos":[4486,4641],"source":" Otherwise, the framework calls [CContextMenuManager::TrackPopupMenu](../../mfc/reference/ccontextmenumanager-class.md#ccontextmenumanager__trackpopupmenu)."},{"pos":[4697,4726],"content":"CMFCMenuButton::m_bRightArrow"},{"content":"A Boolean member variable that indicates the location of the pop-up menu.","pos":[4730,4803]},{"content":"Remarks","pos":[4850,4857]},{"content":"When the user presses the menu button, the application shows a pop-up menu.","pos":[4861,4936]},{"content":"The framework will display the pop-up menu either under the button or to the right of the button.","pos":[4937,5034]},{"content":"The button also has a small arrow that indicates where the pop-up menu will appear.","pos":[5035,5118]},{"content":"If <ph id=\"ph1\">`m_bRightArrow`</ph> is <ph id=\"ph2\">`TRUE`</ph>, the framework displays the pop-up menu to the right of the button.","pos":[5119,5215],"source":" If `m_bRightArrow` is `TRUE`, the framework displays the pop-up menu to the right of the button."},{"content":"Otherwise, it displays the pop-up menu under the button.","pos":[5216,5272]},{"pos":[5329,5359],"content":"CMFCMenuButton::m_bStayPressed"},{"content":"A Boolean member variable that indicates whether the menu button appears pressed while the user makes a selection from the pop-up menu.","pos":[5363,5498]},{"content":"Remarks","pos":[5546,5553]},{"content":"If the <ph id=\"ph1\">`m_bStayPressed`</ph> member is <ph id=\"ph2\">`FALSE`</ph>, the menu button does not become pressed when the uses clicks the button.","pos":[5557,5672],"source":"If the `m_bStayPressed` member is `FALSE`, the menu button does not become pressed when the uses clicks the button."},{"content":"In this case, the framework displays only the pop-up menu.","pos":[5673,5731]},{"content":"If the <ph id=\"ph1\">`m_bStayPressed`</ph> member is <ph id=\"ph2\">`TRUE`</ph>, the menu button becomes pressed when the user clicks the button.","pos":[5738,5844],"source":"If the `m_bStayPressed` member is `TRUE`, the menu button becomes pressed when the user clicks the button."},{"content":"It stays pressed until after the user closes the pop-up menu, either by making a selection or canceling.","pos":[5845,5949]},{"pos":[5999,6022],"content":"CMFCMenuButton::m_hMenu"},{"content":"The handle to the attached menu.","pos":[6026,6058]},{"content":"Remarks","pos":[6100,6107]},{"content":"The framework displays the menu indicated by this member variable when the user clicks the menu button.","pos":[6111,6214]},{"pos":[6270,6299],"content":"CMFCMenuButton::m_nMenuResult"},{"content":"An integer that indicates which item the user selects from the pop-up menu.","pos":[6303,6378]},{"content":"Remarks","pos":[6424,6431]},{"content":"The value of this member variable is zero if the user cancels the menu without making a selection or if an error occurs.","pos":[6435,6555]},{"pos":[6617,6652],"content":"CMFCMenuButton::PreTranslateMessage"},{"content":"Called by the framework to translate window messages before they are dispatched.","pos":[6656,6736]},{"content":"Parameters","pos":[6806,6816]},{"content":"[in]","pos":[6820,6824]},{"content":"Points to a <bpt id=\"p1\">[</bpt>MSG<ept id=\"p1\">](../../mfc/reference/msg-structure1.md)</ept> structure that contains the message to process.","pos":[6835,6939],"source":" Points to a [MSG](../../mfc/reference/msg-structure1.md) structure that contains the message to process."},{"content":"Return Value","pos":[6949,6961]},{"content":"Nonzero if the message was translated and should not be dispatched; 0 if the message was not translated and should be dispatched.","pos":[6965,7094]},{"content":"Remarks","pos":[7104,7111]},{"pos":[7167,7196],"content":"CMFCMenuButton::SizeToContent"},{"content":"Changes the size of the button according to its text size and image size.","pos":[7200,7273]},{"content":"Parameters","pos":[7351,7361]},{"content":"[in]","pos":[7365,7369]},{"content":"A Boolean parameter that indicates whether this method resizes the button .","pos":[7385,7460]},{"content":"Return Value","pos":[7470,7482]},{"pos":[7486,7593],"content":"A <bpt id=\"p1\">[</bpt>CSize<ept id=\"p1\">](../../atl-mfc-shared/reference/csize-class.md)</ept> object that specifies the new size for the button.","source":"A [CSize](../../atl-mfc-shared/reference/csize-class.md) object that specifies the new size for the button."},{"content":"Remarks","pos":[7603,7610]},{"pos":[7614,7730],"content":"If you call this function and <ph id=\"ph1\">`bCalcOnly`</ph> is <ph id=\"ph2\">`TRUE`</ph>, <ph id=\"ph3\">`SizeToContent`</ph> will calculate only the new size of the button.","source":"If you call this function and `bCalcOnly` is `TRUE`, `SizeToContent` will calculate only the new size of the button."},{"content":"The new size of the button is calculated to fit the button text, image, and arrow.","pos":[7737,7819]},{"content":"The framework also adds in predefined margins of 10 pixels for the horizontal edge and 5 pixels for the vertical edge.","pos":[7820,7938]},{"content":"See Also","pos":[7947,7955]},{"content":"Hierarchy Chart","pos":[7960,7975]},{"content":"Classes","pos":[8012,8019]},{"content":"CMFCButton Class","pos":[8062,8078]}],"content":"---\ntitle: \"CMFCMenuButton Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCMenuButton\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCMenuButton class\"\nms.assetid: 53d3d459-1e5a-47c5-8b7f-2e61f6af5187\ncaps.latest.revision: 32\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# CMFCMenuButton Class\nA button that displays a pop-up menu and reports on the user's menu selections.  \n  \n## Syntax  \n  \n```  \nclass CMFCMenuButton : public CMFCButton  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCMenuButton::CMFCMenuButton](#cmfcmenubutton__cmfcmenubutton)|Constructs a `CMFCMenuButton` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCMenuButton::PreTranslateMessage](#cmfcmenubutton__pretranslatemessage)|Called by the framework to translate window messages before they are dispatched. (Overrides `CMFCButton::PreTranslateMessage`.)|  \n|[CMFCMenuButton::SizeToContent](#cmfcmenubutton__sizetocontent)|Changes the size of the button according to its text and image size.|  \n  \n### Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCMenuButton::m_bOSMenu](#cmfcmenubutton__m_bosmenu)|Specifies whether to display the default system pop-up menu or to use [CContextMenuManager::TrackPopupMenu](../../mfc/reference/ccontextmenumanager-class.md#ccontextmenumanager__trackpopupmenu).|  \n|[CMFCMenuButton::m_bRightArrow](#cmfcmenubutton__m_brightarrow)|Specifies whether the pop-up menu will appear underneath or to the right of the button.|  \n|[CMFCMenuButton::m_bStayPressed](#cmfcmenubutton__m_bstaypressed)|Specifies whether the menu button changes its state after the user releases the button.|  \n|[CMFCMenuButton::m_hMenu](#cmfcmenubutton__m_hmenu)|A handle to the attached Windows menu.|  \n|[CMFCMenuButton::m_nMenuResult](#cmfcmenubutton__m_nmenuresult)|An identifier that indicates which item the user selected from the pop-up menu.|  \n  \n## Remarks  \n The `CMFCMenuButton` class is derived from the [CMFCButton Class](../../mfc/reference/cmfcbutton-class.md) which is, in turn, derived from the [CButton Class](../../mfc/reference/cbutton-class.md). Therefore, you can use `CMFCMenuButton` in your code the same way you would use `CButton`.  \n  \n When you create a `CMFCMenuButton`, you must pass in a handle to the associated pop-up menu. Next, call the function `CMFCMenuButton::SizeToContent`. `CMFCMenuButton::SizeToContent` checks that the button size is sufficient to include an arrow that points to the location where the pop-up window will appear - namely, underneath or to the right of the button.  \n  \n## Example  \n The following example demonstrates how to set the handle of the menu attached to the button, resize the button according to its text and image size, and set the pop-up menu that is displayed by the framework. This code snippet is part of the [New Controls sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_NewControls#38](../../mfc/reference/codesnippet/cpp/cmfcmenubutton-class_1.h)]  \n[!code-cpp[NVC_MFC_NewControls#39](../../mfc/reference/codesnippet/cpp/cmfcmenubutton-class_2.cpp)]  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CButton](../../mfc/reference/cbutton-class.md)  \n  \n [CMFCButton](../../mfc/reference/cmfcbutton-class.md)  \n  \n [CMFCMenuButton](../../mfc/reference/cmfcmenubutton-class.md)  \n  \n## Requirements  \n **Header:** afxmenubutton.h  \n  \n##  <a name=\"cmfcmenubutton__cmfcmenubutton\"></a>  CMFCMenuButton::CMFCMenuButton  \n Constructs a new [CMFCMenuButton](../../mfc/reference/cmfcmenubutton-class.md) object.  \n  \n```  \nCMFCMenuButton();\n```  \n  \n##  <a name=\"cmfcmenubutton__m_bosmenu\"></a>  CMFCMenuButton::m_bOSMenu  \n A Boolean member variable that indicates which pop-up menu the framework displays.  \n  \n```  \nBOOL m_bOSMenu;  \n```  \n  \n### Remarks  \n If `m_bOSMenu` is `TRUE`, the framework calls the inherited `TrackPopupMenu` method for this object. Otherwise, the framework calls [CContextMenuManager::TrackPopupMenu](../../mfc/reference/ccontextmenumanager-class.md#ccontextmenumanager__trackpopupmenu).  \n  \n##  <a name=\"cmfcmenubutton__m_brightarrow\"></a>  CMFCMenuButton::m_bRightArrow  \n A Boolean member variable that indicates the location of the pop-up menu.  \n  \n```  \nBOOL m_bRightArrow;  \n```  \n  \n### Remarks  \n When the user presses the menu button, the application shows a pop-up menu. The framework will display the pop-up menu either under the button or to the right of the button. The button also has a small arrow that indicates where the pop-up menu will appear. If `m_bRightArrow` is `TRUE`, the framework displays the pop-up menu to the right of the button. Otherwise, it displays the pop-up menu under the button.  \n  \n##  <a name=\"cmfcmenubutton__m_bstaypressed\"></a>  CMFCMenuButton::m_bStayPressed  \n A Boolean member variable that indicates whether the menu button appears pressed while the user makes a selection from the pop-up menu.  \n  \n```  \nBOOL m_bStayPressed;  \n```  \n  \n### Remarks  \n If the `m_bStayPressed` member is `FALSE`, the menu button does not become pressed when the uses clicks the button. In this case, the framework displays only the pop-up menu.  \n  \n If the `m_bStayPressed` member is `TRUE`, the menu button becomes pressed when the user clicks the button. It stays pressed until after the user closes the pop-up menu, either by making a selection or canceling.  \n  \n##  <a name=\"cmfcmenubutton__m_hmenu\"></a>  CMFCMenuButton::m_hMenu  \n The handle to the attached menu.  \n  \n```  \nHMENU m_hMenu;  \n```  \n  \n### Remarks  \n The framework displays the menu indicated by this member variable when the user clicks the menu button.  \n  \n##  <a name=\"cmfcmenubutton__m_nmenuresult\"></a>  CMFCMenuButton::m_nMenuResult  \n An integer that indicates which item the user selects from the pop-up menu.  \n  \n```  \nint m_nMenuResult;  \n```  \n  \n### Remarks  \n The value of this member variable is zero if the user cancels the menu without making a selection or if an error occurs.  \n  \n##  <a name=\"cmfcmenubutton__pretranslatemessage\"></a>  CMFCMenuButton::PreTranslateMessage  \n Called by the framework to translate window messages before they are dispatched.  \n  \n```  \nvirtual BOOL PreTranslateMessage(MSG* pMsg);\n```  \n  \n### Parameters  \n [in] `pMsg`  \n Points to a [MSG](../../mfc/reference/msg-structure1.md) structure that contains the message to process.  \n  \n### Return Value  \n Nonzero if the message was translated and should not be dispatched; 0 if the message was not translated and should be dispatched.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcmenubutton__sizetocontent\"></a>  CMFCMenuButton::SizeToContent  \n Changes the size of the button according to its text size and image size.  \n  \n```  \nvirtual CSize SizeToContent(BOOL bCalcOnly = FALSE);\n```  \n  \n### Parameters  \n [in] `bCalcOnly`  \n A Boolean parameter that indicates whether this method resizes the button .  \n  \n### Return Value  \n A [CSize](../../atl-mfc-shared/reference/csize-class.md) object that specifies the new size for the button.  \n  \n### Remarks  \n If you call this function and `bCalcOnly` is `TRUE`, `SizeToContent` will calculate only the new size of the button.  \n  \n The new size of the button is calculated to fit the button text, image, and arrow. The framework also adds in predefined margins of 10 pixels for the horizontal edge and 5 pixels for the vertical edge.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CMFCButton Class](../../mfc/reference/cmfcbutton-class.md)\n"}