{"nodes":[{"pos":[12,54],"content":"CAtlPreviewCtrlImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CAtlPreviewCtrlImpl Class | Microsoft Docs","pos":[0,42]}]},{"pos":[681,706],"content":"CAtlPreviewCtrlImpl Class","linkify":"CAtlPreviewCtrlImpl Class","nodes":[{"content":"CAtlPreviewCtrlImpl Class","pos":[0,25]}]},{"content":"This class is an ATL implementation of a window that is placed on a host window provided by the Shell  for Rich Preview.","pos":[707,827]},{"pos":[835,945],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"pos":[954,960],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1072,1079],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1089,1108],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1115,1119]},{"content":"Description","pos":[1120,1131]},{"pos":[1169,1260],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl<ept id=\"p1\">](#catlpreviewctrlimpl___dtorcatlpreviewctrlimpl)</ept>","source":"[CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl](#catlpreviewctrlimpl___dtorcatlpreviewctrlimpl)"},{"content":"Destructs a preview control object.","pos":[1261,1296]},{"pos":[1301,1386],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl<ept id=\"p1\">](#catlpreviewctrlimpl__catlpreviewctrlimpl)</ept>","source":"[CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl](#catlpreviewctrlimpl__catlpreviewctrlimpl)"},{"content":"Constructs a preview control object.","pos":[1387,1423]},{"pos":[1434,1448],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1455,1459]},{"content":"Description","pos":[1460,1471]},{"pos":[1509,1568],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::Create<ept id=\"p1\">](#catlpreviewctrlimpl__create)</ept>","source":"[CAtlPreviewCtrlImpl::Create](#catlpreviewctrlimpl__create)"},{"content":"Called by a Rich Preview handler to create the Windows window.","pos":[1569,1631]},{"pos":[1636,1697],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::Destroy<ept id=\"p1\">](#catlpreviewctrlimpl__destroy)</ept>","source":"[CAtlPreviewCtrlImpl::Destroy](#catlpreviewctrlimpl__destroy)"},{"content":"Called by a Rich Preview handler when it needs to destroy this control.","pos":[1698,1769]},{"pos":[1774,1831],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::Focus<ept id=\"p1\">](#catlpreviewctrlimpl__focus)</ept>","source":"[CAtlPreviewCtrlImpl::Focus](#catlpreviewctrlimpl__focus)"},{"content":"Sets input focus to this control.","pos":[1832,1865]},{"pos":[1870,1931],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::OnPaint<ept id=\"p1\">](#catlpreviewctrlimpl__onpaint)</ept>","source":"[CAtlPreviewCtrlImpl::OnPaint](#catlpreviewctrlimpl__onpaint)"},{"content":"Handles the WM_PAINT message.","pos":[1932,1961]},{"pos":[1966,2025],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::Redraw<ept id=\"p1\">](#catlpreviewctrlimpl__redraw)</ept>","source":"[CAtlPreviewCtrlImpl::Redraw](#catlpreviewctrlimpl__redraw)"},{"content":"Tells this control to redraw.","pos":[2026,2055]},{"pos":[2060,2121],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::SetHost<ept id=\"p1\">](#catlpreviewctrlimpl__sethost)</ept>","source":"[CAtlPreviewCtrlImpl::SetHost](#catlpreviewctrlimpl__sethost)"},{"content":"Sets a new parent for this control.","pos":[2122,2157]},{"pos":[2162,2243],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::SetPreviewVisuals<ept id=\"p1\">](#catlpreviewctrlimpl__setpreviewvisuals)</ept>","source":"[CAtlPreviewCtrlImpl::SetPreviewVisuals](#catlpreviewctrlimpl__setpreviewvisuals)"},{"content":"Called by a Rich Preview handler when it needs to set visuals of rich preview content.","pos":[2244,2330]},{"pos":[2335,2396],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::SetRect<ept id=\"p1\">](#catlpreviewctrlimpl__setrect)</ept>","source":"[CAtlPreviewCtrlImpl::SetRect](#catlpreviewctrlimpl__setrect)"},{"content":"Sets a new bounding rectangle for this control.","pos":[2397,2444]},{"pos":[2455,2472],"content":"Protected Methods","linkify":"Protected Methods","nodes":[{"content":"Protected Methods","pos":[0,17]}]},{"content":"Name","pos":[2479,2483]},{"content":"Description","pos":[2484,2495]},{"pos":[2533,2594],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::DoPaint<ept id=\"p1\">](#catlpreviewctrlimpl__dopaint)</ept>","source":"[CAtlPreviewCtrlImpl::DoPaint](#catlpreviewctrlimpl__dopaint)"},{"content":"Called by the framework to render the preview.","pos":[2595,2641]},{"pos":[2652,2671],"content":"Protected Constants","linkify":"Protected Constants","nodes":[{"content":"Protected Constants","pos":[0,19]}]},{"content":"Name","pos":[2678,2682]},{"content":"Description","pos":[2683,2694]},{"pos":[2732,2789],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::m_plf<ept id=\"p1\">](#catlpreviewctrlimpl__m_plf)</ept>","source":"[CAtlPreviewCtrlImpl::m_plf](#catlpreviewctrlimpl__m_plf)"},{"content":"Font used to display text in the preview window.","pos":[2790,2838]},{"pos":[2849,2871],"content":"Protected Data Members","linkify":"Protected Data Members","nodes":[{"content":"Protected Data Members","pos":[0,22]}]},{"content":"Name","pos":[2878,2882]},{"content":"Description","pos":[2883,2894]},{"pos":[2932,2997],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::m_clrBack<ept id=\"p1\">](#catlpreviewctrlimpl__m_clrback)</ept>","source":"[CAtlPreviewCtrlImpl::m_clrBack](#catlpreviewctrlimpl__m_clrback)"},{"content":"Background color of the preview window.","pos":[2998,3037]},{"pos":[3042,3107],"content":"<bpt id=\"p1\">[</bpt>CAtlPreviewCtrlImpl::m_clrText<ept id=\"p1\">](#catlpreviewctrlimpl__m_clrtext)</ept>","source":"[CAtlPreviewCtrlImpl::m_clrText](#catlpreviewctrlimpl__m_clrtext)"},{"content":"Text color of preview window.","pos":[3108,3137]},{"pos":[3148,3155],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3164,3185],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3312,3394],"content":"<bpt id=\"p1\">[</bpt>ATL::CWindowImpl<ph id=\"ph1\">\\&lt;</ph>CAtlPreviewCtrlImpl&gt;<ept id=\"p1\">](../../atl/reference/cwindowimpl-class.md)</ept>","source":"[ATL::CWindowImpl\\<CAtlPreviewCtrlImpl>](../../atl/reference/cwindowimpl-class.md)"},{"pos":[3457,3469],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3473,3505],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlpreviewctrlimpl.h","source":"**Header:** atlpreviewctrlimpl.h"},{"pos":[3515,3612],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__catlpreviewctrlimpl\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl","linkify":"<a name=\"catlpreviewctrlimpl__catlpreviewctrlimpl\"></a>  CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl","source":"<a name=\"catlpreviewctrlimpl__catlpreviewctrlimpl\"></a>  CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl"},{"content":"Constructs a preview control object.","pos":[3616,3652]},{"pos":[3771,3778],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3788,3891],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl___dtorcatlpreviewctrlimpl\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl","linkify":"<a name=\"catlpreviewctrlimpl___dtorcatlpreviewctrlimpl\"></a>  CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl","source":"<a name=\"catlpreviewctrlimpl___dtorcatlpreviewctrlimpl\"></a>  CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl"},{"content":"Destructs a preview control object.","pos":[3895,3930]},{"pos":[3989,3996],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4006,4077],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__create\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::Create","linkify":"<a name=\"catlpreviewctrlimpl__create\"></a>  CAtlPreviewCtrlImpl::Create","source":"<a name=\"catlpreviewctrlimpl__create\"></a>  CAtlPreviewCtrlImpl::Create"},{"content":"Called by a Rich Preview handler to create the Windows window.","pos":[4081,4143]},{"pos":[4222,4232],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A handle to the host window supplied by the Shell for Rich Preview.","pos":[4252,4319]},{"content":"Specifies the initial size and position of the window.","pos":[4335,4389]},{"pos":[4399,4411],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[4415,4455],"content":"<ph id=\"ph1\">`TRUE`</ph> if successful; otherwise <ph id=\"ph2\">`FALSE`</ph>.","source":"`TRUE` if successful; otherwise `FALSE`."},{"pos":[4465,4472],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4482,4555],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__destroy\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::Destroy","linkify":"<a name=\"catlpreviewctrlimpl__destroy\"></a>  CAtlPreviewCtrlImpl::Destroy","source":"<a name=\"catlpreviewctrlimpl__destroy\"></a>  CAtlPreviewCtrlImpl::Destroy"},{"content":"Called by a Rich Preview handler when it needs to destroy this control.","pos":[4559,4630]},{"pos":[4677,4684],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4694,4767],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__dopaint\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::DoPaint","linkify":"<a name=\"catlpreviewctrlimpl__dopaint\"></a>  CAtlPreviewCtrlImpl::DoPaint","source":"<a name=\"catlpreviewctrlimpl__dopaint\"></a>  CAtlPreviewCtrlImpl::DoPaint"},{"content":"Called by the framework to render the preview.","pos":[4771,4817]},{"pos":[4871,4881],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A handle to a device context for painting.","pos":[4894,4936]},{"pos":[4946,4953],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4963,5032],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__focus\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::Focus","linkify":"<a name=\"catlpreviewctrlimpl__focus\"></a>  CAtlPreviewCtrlImpl::Focus","source":"<a name=\"catlpreviewctrlimpl__focus\"></a>  CAtlPreviewCtrlImpl::Focus"},{"content":"Sets input focus to this control.","pos":[5036,5069]},{"pos":[5114,5121],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5131,5208],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__m_clrback\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::m_clrBack","linkify":"<a name=\"catlpreviewctrlimpl__m_clrback\"></a>  CAtlPreviewCtrlImpl::m_clrBack","source":"<a name=\"catlpreviewctrlimpl__m_clrback\"></a>  CAtlPreviewCtrlImpl::m_clrBack"},{"content":"Background color of the preview window.","pos":[5212,5251]},{"pos":[5294,5301],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5311,5388],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__m_clrtext\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::m_clrText","linkify":"<a name=\"catlpreviewctrlimpl__m_clrtext\"></a>  CAtlPreviewCtrlImpl::m_clrText","source":"<a name=\"catlpreviewctrlimpl__m_clrtext\"></a>  CAtlPreviewCtrlImpl::m_clrText"},{"content":"Text color of the preview window.","pos":[5392,5425]},{"pos":[5468,5475],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5485,5554],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__m_plf\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::m_plf","linkify":"<a name=\"catlpreviewctrlimpl__m_plf\"></a>  CAtlPreviewCtrlImpl::m_plf","source":"<a name=\"catlpreviewctrlimpl__m_plf\"></a>  CAtlPreviewCtrlImpl::m_plf"},{"content":"Font used to display text in the preview window.","pos":[5558,5606]},{"pos":[5652,5659],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5669,5742],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__onpaint\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::OnPaint","linkify":"<a name=\"catlpreviewctrlimpl__onpaint\"></a>  CAtlPreviewCtrlImpl::OnPaint","source":"<a name=\"catlpreviewctrlimpl__onpaint\"></a>  CAtlPreviewCtrlImpl::OnPaint"},{"content":"Handles the WM_PAINT message.","pos":[5746,5775]},{"pos":[5884,5894],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Set to WM_PAINT.","pos":[5908,5924]},{"content":"This parameter is not used.","pos":[5943,5970]},{"content":"This parameter is not used.","pos":[5989,6016]},{"content":"When this function returns, it contains <ph id=\"ph1\">`TRUE`</ph>.","pos":[6037,6084],"source":" When this function returns, it contains `TRUE`."},{"pos":[6094,6106],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Always returns 0.","pos":[6110,6127]},{"pos":[6137,6144],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6154,6225],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__redraw\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::Redraw","linkify":"<a name=\"catlpreviewctrlimpl__redraw\"></a>  CAtlPreviewCtrlImpl::Redraw","source":"<a name=\"catlpreviewctrlimpl__redraw\"></a>  CAtlPreviewCtrlImpl::Redraw"},{"content":"Tells this control to redraw.","pos":[6229,6258]},{"pos":[6304,6311],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6321,6394],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__sethost\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::SetHost","linkify":"<a name=\"catlpreviewctrlimpl__sethost\"></a>  CAtlPreviewCtrlImpl::SetHost","source":"<a name=\"catlpreviewctrlimpl__sethost\"></a>  CAtlPreviewCtrlImpl::SetHost"},{"content":"Sets a new parent for this control.","pos":[6398,6433]},{"pos":[6495,6505],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A handle to the new parent window.","pos":[6525,6559]},{"pos":[6569,6576],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6586,6679],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__setpreviewvisuals\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::SetPreviewVisuals","linkify":"<a name=\"catlpreviewctrlimpl__setpreviewvisuals\"></a>  CAtlPreviewCtrlImpl::SetPreviewVisuals","source":"<a name=\"catlpreviewctrlimpl__setpreviewvisuals\"></a>  CAtlPreviewCtrlImpl::SetPreviewVisuals"},{"content":"Called by a Rich Preview handler when it needs to set visuals of rich preview content.","pos":[6683,6769]},{"pos":[6889,6899],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Background color of the preview window.","pos":[6916,6955]},{"content":"Text color of the preview window.","pos":[6975,7008]},{"content":"Font used to display text in the preview window.","pos":[7024,7072]},{"pos":[7082,7089],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7099,7172],"content":"<bpt id=\"p1\">&lt;a name=\"catlpreviewctrlimpl__setrect\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CAtlPreviewCtrlImpl::SetRect","linkify":"<a name=\"catlpreviewctrlimpl__setrect\"></a>  CAtlPreviewCtrlImpl::SetRect","source":"<a name=\"catlpreviewctrlimpl__setrect\"></a>  CAtlPreviewCtrlImpl::SetRect"},{"content":"Sets a new bounding rectangle for this control.","pos":[7176,7223]},{"pos":[7300,7310],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies the new size and position of the preview control.","pos":[7323,7382]},{"content":"Specifies whether the control should be redrawn.","pos":[7402,7450]},{"pos":[7460,7467],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7476,7484],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[7488,7557],"content":"<bpt id=\"p1\">[</bpt>ATL COM Desktop Components<ept id=\"p1\">](../../atl/atl-com-desktop-components.md)</ept>","source":"[ATL COM Desktop Components](../../atl/atl-com-desktop-components.md)"}],"content":"---\ntitle: \"CAtlPreviewCtrlImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"atlpreviewctrlimpl/ATL::CAtlPreviewCtrlImpl\"\n  - \"CAtlPreviewCtrlImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CAtlPreviewCtrlImpl class\"\nms.assetid: 39b3299e-07e4-4abc-9b6e-b54bfa3b0802\ncaps.latest.revision: 26\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CAtlPreviewCtrlImpl Class\nThis class is an ATL implementation of a window that is placed on a host window provided by the Shell  for Rich Preview.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\nclass CAtlPreviewCtrlImpl : public CWindowImpl<CAtlPreviewCtrlImpl>, public IPreviewCtrl;\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl](#catlpreviewctrlimpl___dtorcatlpreviewctrlimpl)|Destructs a preview control object.|  \n|[CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl](#catlpreviewctrlimpl__catlpreviewctrlimpl)|Constructs a preview control object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::Create](#catlpreviewctrlimpl__create)|Called by a Rich Preview handler to create the Windows window.|  \n|[CAtlPreviewCtrlImpl::Destroy](#catlpreviewctrlimpl__destroy)|Called by a Rich Preview handler when it needs to destroy this control.|  \n|[CAtlPreviewCtrlImpl::Focus](#catlpreviewctrlimpl__focus)|Sets input focus to this control.|  \n|[CAtlPreviewCtrlImpl::OnPaint](#catlpreviewctrlimpl__onpaint)|Handles the WM_PAINT message.|  \n|[CAtlPreviewCtrlImpl::Redraw](#catlpreviewctrlimpl__redraw)|Tells this control to redraw.|  \n|[CAtlPreviewCtrlImpl::SetHost](#catlpreviewctrlimpl__sethost)|Sets a new parent for this control.|  \n|[CAtlPreviewCtrlImpl::SetPreviewVisuals](#catlpreviewctrlimpl__setpreviewvisuals)|Called by a Rich Preview handler when it needs to set visuals of rich preview content.|  \n|[CAtlPreviewCtrlImpl::SetRect](#catlpreviewctrlimpl__setrect)|Sets a new bounding rectangle for this control.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::DoPaint](#catlpreviewctrlimpl__dopaint)|Called by the framework to render the preview.|  \n  \n### Protected Constants  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::m_plf](#catlpreviewctrlimpl__m_plf)|Font used to display text in the preview window.|  \n  \n### Protected Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::m_clrBack](#catlpreviewctrlimpl__m_clrback)|Background color of the preview window.|  \n|[CAtlPreviewCtrlImpl::m_clrText](#catlpreviewctrlimpl__m_clrtext)|Text color of preview window.|  \n\n  \n## Remarks  \n  \n## Inheritance Hierarchy  \n `TBase`  \n  \n `ATL::CMessageMap`  \n  \n `ATL::CWindowImplRoot<TBase>`  \n  \n `ATL::CWindowImplBaseT<TBase,TWinTraits>`  \n  \n [ATL::CWindowImpl\\<CAtlPreviewCtrlImpl>](../../atl/reference/cwindowimpl-class.md)  \n  \n `IPreviewCtrl`  \n  \n `ATL::CAtlPreviewCtrlImpl`  \n  \n## Requirements  \n **Header:** atlpreviewctrlimpl.h  \n  \n##  <a name=\"catlpreviewctrlimpl__catlpreviewctrlimpl\"></a>  CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl  \n Constructs a preview control object.  \n  \n```\nCAtlPreviewCtrlImpl(void) : m_clrText(0),\n    m_clrBack(RGB(255,\n 255,\n    255)),\n m_plf(NULL);\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl___dtorcatlpreviewctrlimpl\"></a>  CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl  \n Destructs a preview control object.  \n  \n```\nvirtual ~CAtlPreviewCtrlImpl(void);\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__create\"></a>  CAtlPreviewCtrlImpl::Create  \n Called by a Rich Preview handler to create the Windows window.  \n  \n```\nvirtual BOOL Create(HWND hWndParent,  const RECT* prc);\n```  \n  \n### Parameters  \n `hWndParent`  \n A handle to the host window supplied by the Shell for Rich Preview.  \n  \n `prc`  \n Specifies the initial size and position of the window.  \n  \n### Return Value  \n `TRUE` if successful; otherwise `FALSE`.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__destroy\"></a>  CAtlPreviewCtrlImpl::Destroy  \n Called by a Rich Preview handler when it needs to destroy this control.  \n  \n```\nvirtual void Destroy();\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__dopaint\"></a>  CAtlPreviewCtrlImpl::DoPaint  \n Called by the framework to render the preview.  \n  \n```\nvirtual void DoPaint(HDC hdc);\n```  \n  \n### Parameters  \n `hdc`  \n A handle to a device context for painting.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__focus\"></a>  CAtlPreviewCtrlImpl::Focus  \n Sets input focus to this control.  \n  \n```\nvirtual void Focus();\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__m_clrback\"></a>  CAtlPreviewCtrlImpl::m_clrBack  \n Background color of the preview window.  \n  \n```\nCOLORREF m_clrBack;\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__m_clrtext\"></a>  CAtlPreviewCtrlImpl::m_clrText  \n Text color of the preview window.  \n  \n```\nCOLORREF m_clrText;\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__m_plf\"></a>  CAtlPreviewCtrlImpl::m_plf  \n Font used to display text in the preview window.  \n  \n```\nconst LOGFONTW* m_plf;\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__onpaint\"></a>  CAtlPreviewCtrlImpl::OnPaint  \n Handles the WM_PAINT message.  \n  \n```\nLRESULT OnPaint(UINT nMsg,\n    WPARAM wParam,\n    LPARAM lParam,\n    BOOL& bHandled);\n```  \n  \n### Parameters  \n `nMsg`  \n Set to WM_PAINT.  \n  \n `wParam`  \n This parameter is not used.  \n  \n `lParam`  \n This parameter is not used.  \n  \n `bHandled`  \n When this function returns, it contains `TRUE`.  \n  \n### Return Value  \n Always returns 0.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__redraw\"></a>  CAtlPreviewCtrlImpl::Redraw  \n Tells this control to redraw.  \n  \n```\nvirtual void Redraw();\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__sethost\"></a>  CAtlPreviewCtrlImpl::SetHost  \n Sets a new parent for this control.  \n  \n```\nvirtual void SetHost(HWND hWndParent);\n```  \n  \n### Parameters  \n `hWndParent`  \n A handle to the new parent window.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__setpreviewvisuals\"></a>  CAtlPreviewCtrlImpl::SetPreviewVisuals  \n Called by a Rich Preview handler when it needs to set visuals of rich preview content.  \n  \n```\nvirtual void SetPreviewVisuals(COLORREF clrBack,\n    COLORREF clrText,\n    const LOGFONTW* plf);\n```  \n  \n### Parameters  \n `clrBack`  \n Background color of the preview window.  \n  \n `clrText`  \n Text color of the preview window.  \n  \n `plf`  \n Font used to display text in the preview window.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__setrect\"></a>  CAtlPreviewCtrlImpl::SetRect  \n Sets a new bounding rectangle for this control.  \n  \n```\nvirtual void SetRect(const RECT* prc,  BOOL bRedraw);\n```  \n  \n### Parameters  \n `prc`  \n Specifies the new size and position of the preview control.  \n  \n `bRedraw`  \n Specifies whether the control should be redrawn.  \n  \n### Remarks  \n  \n## See Also  \n [ATL COM Desktop Components](../../atl/atl-com-desktop-components.md)\n\n\n\n\n\n\n\n\n\n"}