{"nodes":[{"pos":[12,61],"content":"Keyboard and Mouse Customization | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Keyboard and Mouse Customization | Microsoft Docs","pos":[0,49]}]},{"content":"Keyboard and Mouse Customization","pos":[705,737]},{"content":"MFC allows the user of your application to customize how it handles keyboard and mouse input.","pos":[738,831]},{"content":"The user can customize keyboard input by assigning keyboard shortcuts to commands.","pos":[832,914]},{"content":"The user can also customize the mouse input by selecting the command that should be executed when the user double-clicks inside specific windows of the application.","pos":[915,1079]},{"content":"This topic explains how to customize the input for your application.","pos":[1080,1148]},{"content":"In the <bpt id=\"p1\">**</bpt>Customization<ept id=\"p1\">**</ept> dialog box, the user can change the custom controls for the mouse and the keyboard.","pos":[1155,1263],"source":"In the **Customization** dialog box, the user can change the custom controls for the mouse and the keyboard."},{"content":"To display this dialog box, the user points to <bpt id=\"p1\">**</bpt>Customize<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>View<ept id=\"p2\">**</ept> menu and then clicks <bpt id=\"p3\">**</bpt>Toolbars and Docking<ept id=\"p3\">**</ept>.","pos":[1264,1387],"source":" To display this dialog box, the user points to **Customize** on the **View** menu and then clicks **Toolbars and Docking**."},{"content":"In the dialog box, the user clicks either the <bpt id=\"p1\">**</bpt>Keyboard<ept id=\"p1\">**</ept> tab or the <bpt id=\"p2\">**</bpt>Mouse<ept id=\"p2\">**</ept> tab.","pos":[1388,1472],"source":" In the dialog box, the user clicks either the **Keyboard** tab or the **Mouse** tab."},{"content":"Keyboard Customization","pos":[1481,1503]},{"pos":[1507,1597],"content":"The following illustration shows the <bpt id=\"p1\">**</bpt>Keyboard<ept id=\"p1\">**</ept> tab of the <bpt id=\"p2\">**</bpt>Customization<ept id=\"p2\">**</ept> dialog box.","source":"The following illustration shows the **Keyboard** tab of the **Customization** dialog box."},{"content":"Keyboard tab in the Customize dialog box","pos":[1606,1646]},{"content":"Keyboard Customization Tab","pos":[1708,1734]},{"content":"The user interacts with the keyboard tab to assign one or more keyboard shortcuts to a command.","pos":[1741,1836]},{"content":"The available commands are listed on the left side of the tab.","pos":[1837,1899]},{"content":"The user can select any available command from the menu.","pos":[1900,1956]},{"content":"Only menu commands can be associated with a keyboard shortcut.","pos":[1957,2019]},{"content":"After the user enters a new shortcut, the <bpt id=\"p1\">**</bpt>Assign<ept id=\"p1\">**</ept> button becomes enabled.","pos":[2020,2096],"source":" After the user enters a new shortcut, the **Assign** button becomes enabled."},{"content":"When the user clicks this button, the application associates the selected command with that shortcut.","pos":[2097,2198]},{"content":"All of the currently assigned keyboard shortcuts are listed in the list box in the right column.","pos":[2205,2301]},{"content":"The user can also select individual shortcuts and remove them, or reset all the mappings for the application.","pos":[2302,2411]},{"content":"If you want to support this customization in your application, you must create a <bpt id=\"p1\">[</bpt>CKeyboardManager<ept id=\"p1\">](../mfc/reference/ckeyboardmanager-class.md)</ept> object.","pos":[2418,2569],"source":"If you want to support this customization in your application, you must create a [CKeyboardManager](../mfc/reference/ckeyboardmanager-class.md) object."},{"content":"To create a <ph id=\"ph1\">`CKeyboardManager`</ph> object, call the function <bpt id=\"p1\">[</bpt>CWinAppEx::InitKeyboardManager<ept id=\"p1\">](../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager)</ept>.","pos":[2570,2728],"source":" To create a `CKeyboardManager` object, call the function [CWinAppEx::InitKeyboardManager](../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager)."},{"content":"This method creates and initializes a keyboard manager.","pos":[2729,2784]},{"content":"If you create a keyboard manager manually, you still must call <ph id=\"ph1\">`CWinAppEx::InitKeyboardManager`</ph> to initialize it.","pos":[2785,2898],"source":" If you create a keyboard manager manually, you still must call `CWinAppEx::InitKeyboardManager` to initialize it."},{"content":"If you use the Wizard to create your application, the Wizard will initialize the keyboard manager.","pos":[2905,3003]},{"content":"After your application initializes the keyboard manager, the framework adds a <bpt id=\"p1\">**</bpt>Keyboard<ept id=\"p1\">**</ept> tab to the <bpt id=\"p2\">**</bpt>Customization<ept id=\"p2\">**</ept> dialog box.","pos":[3004,3135],"source":" After your application initializes the keyboard manager, the framework adds a **Keyboard** tab to the **Customization** dialog box."},{"content":"Mouse Customization","pos":[3144,3163]},{"pos":[3167,3254],"content":"The following illustration shows the <bpt id=\"p1\">**</bpt>Mouse<ept id=\"p1\">**</ept> tab of the <bpt id=\"p2\">**</bpt>Customization<ept id=\"p2\">**</ept> dialog box.","source":"The following illustration shows the **Mouse** tab of the **Customization** dialog box."},{"content":"Mouse tab in the Customize dialog box","pos":[3263,3300]},{"content":"Mouse Customization Tab","pos":[3356,3379]},{"content":"The user interacts with this tab to assign a menu command to the mouse double-click action.","pos":[3386,3477]},{"content":"The user selects a view from the left side of the window and then uses the controls on the right side to associate a command with the double-click action.","pos":[3478,3632]},{"content":"After the user clicks <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept>, the application executes the associated command whenever the user double-clicks anywhere in the view.","pos":[3633,3767],"source":" After the user clicks **Close**, the application executes the associated command whenever the user double-clicks anywhere in the view."},{"content":"By default, mouse customization is not enabled when you create an application by using the Wizard.","pos":[3774,3872]},{"content":"To enable mouse customization","pos":[3883,3912]},{"pos":[3922,4105],"content":"Initialize a <bpt id=\"p1\">[</bpt>CMouseManager<ept id=\"p1\">](../mfc/reference/cmousemanager-class.md)</ept> object by calling <bpt id=\"p2\">[</bpt>CWinAppEx::InitMouseManager<ept id=\"p2\">](../mfc/reference/cwinappex-class.md#cwinappex__initmousemanager)</ept>.","source":"Initialize a [CMouseManager](../mfc/reference/cmousemanager-class.md) object by calling [CWinAppEx::InitMouseManager](../mfc/reference/cwinappex-class.md#cwinappex__initmousemanager)."},{"pos":[4115,4255],"content":"Obtain a pointer to the mouse manager by using <bpt id=\"p1\">[</bpt>CWinAppEx::GetMouseManager<ept id=\"p1\">](../mfc/reference/cwinappex-class.md#cwinappex__getmousemanager)</ept>.","source":"Obtain a pointer to the mouse manager by using [CWinAppEx::GetMouseManager](../mfc/reference/cwinappex-class.md#cwinappex__getmousemanager)."},{"content":"Add views to the mouse manager by using the <bpt id=\"p1\">[</bpt>CMouseManager::AddView<ept id=\"p1\">](../mfc/reference/cmousemanager-class.md#cmousemanager__addview)</ept> method.","pos":[4265,4405],"source":"Add views to the mouse manager by using the [CMouseManager::AddView](../mfc/reference/cmousemanager-class.md#cmousemanager__addview) method."},{"content":"Do this for every view you want to add to the mouse manager.","pos":[4406,4466]},{"content":"After your application initializes the mouse manager, the framework adds the <bpt id=\"p1\">**</bpt>Mouse<ept id=\"p1\">**</ept> tab to the <bpt id=\"p2\">**</bpt>Customize<ept id=\"p2\">**</ept> dialog box.","pos":[4473,4596],"source":"After your application initializes the mouse manager, the framework adds the **Mouse** tab to the **Customize** dialog box."},{"content":"If you do not add any views, accessing the tab will cause an unhandled exception.","pos":[4597,4678]},{"content":"After you have created a list of views, the <bpt id=\"p1\">**</bpt>Mouse<ept id=\"p1\">**</ept> tab is available to the user.","pos":[4679,4762],"source":" After you have created a list of views, the **Mouse** tab is available to the user."},{"content":"When you add a new view to the mouse manager, you give it a unique ID.","pos":[4769,4839]},{"content":"If you want to support mouse customization for a window, you must process the <ph id=\"ph1\">`WM_LBUTTONDBLCLICK`</ph> message and call the <bpt id=\"p1\">[</bpt>CWinAppEx::OnViewDoubleClick<ept id=\"p1\">](../mfc/reference/cwinappex-class.md#cwinappex__onviewdoubleclick)</ept> function.","pos":[4840,5066],"source":" If you want to support mouse customization for a window, you must process the `WM_LBUTTONDBLCLICK` message and call the [CWinAppEx::OnViewDoubleClick](../mfc/reference/cwinappex-class.md#cwinappex__onviewdoubleclick) function."},{"content":"When you call this function, one of the parameters is the ID for that window.","pos":[5067,5144]},{"content":"It is the responsibility of the programmer to keep track of the ID numbers and the objects associated with them.","pos":[5145,5257]},{"content":"Security Concerns","pos":[5266,5283]},{"content":"As described in <bpt id=\"p1\">[</bpt>User-defined Tools<ept id=\"p1\">](../mfc/user-defined-tools.md)</ept>, the user can associate a user-defined tool ID with the double-click event.","pos":[5287,5429],"source":"As described in [User-defined Tools](../mfc/user-defined-tools.md), the user can associate a user-defined tool ID with the double-click event."},{"content":"When the user double-clicks a view, the application looks for a user tool that matches the associated ID.","pos":[5430,5535]},{"content":"If the application finds a matching tool, it executes the tool.","pos":[5536,5599]},{"content":"If the application cannot find a matching tool, it sends a WM_COMMAND message with the ID to the view that was double-clicked.","pos":[5600,5726]},{"content":"The customized settings are stored in the registry.","pos":[5733,5784]},{"content":"By editing the registry, an attacker can replace a valid user tool ID with an arbitrary command.","pos":[5785,5881]},{"content":"When the user double-clicks a view, the view processes the command that the attacker planted.","pos":[5882,5975]},{"content":"This could cause unexpected and potentially dangerous behavior.","pos":[5976,6039]},{"content":"In addition, this kind of attack can bypass user interface safeguards.","pos":[6046,6116]},{"content":"For example, suppose an application has printing disabled.","pos":[6117,6175]},{"content":"That is, in its user interface, the <bpt id=\"p1\">**</bpt>Print<ept id=\"p1\">**</ept> menu and button are unavailable.","pos":[6176,6254],"source":" That is, in its user interface, the **Print** menu and button are unavailable."},{"content":"Normally this prevents the application from printing.","pos":[6255,6308]},{"content":"But if an attacker edited the registry, a user could now could send the print command directly by double-clicking the view, bypassing the user interface elements that are unavailable.","pos":[6309,6492]},{"content":"To guard against this kind of attack, add code to your application command handler to verify that a command is valid before it is executed.","pos":[6499,6638]},{"content":"Do not depend on the user interface to prevent a command from being sent to the application.","pos":[6639,6731]},{"content":"See Also","pos":[6740,6748]},{"content":"Customization for MFC","pos":[6753,6774]},{"content":"CKeyboardManager Class","pos":[6814,6836]},{"content":"CMouseManager Class","pos":[6887,6906]},{"content":"Security Implications of Customization","pos":[6954,6992]}],"content":"---\ntitle: \"Keyboard and Mouse Customization | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"customizations, keyboard and mouse (MFC Extensions)\"\n  - \"keyboard and mouse customizations (MFC Extensions)\"\nms.assetid: 1f789f1b-5f2e-4b11-b974-e3e2a2e49d82\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Keyboard and Mouse Customization\nMFC allows the user of your application to customize how it handles keyboard and mouse input. The user can customize keyboard input by assigning keyboard shortcuts to commands. The user can also customize the mouse input by selecting the command that should be executed when the user double-clicks inside specific windows of the application. This topic explains how to customize the input for your application.  \n  \n In the **Customization** dialog box, the user can change the custom controls for the mouse and the keyboard. To display this dialog box, the user points to **Customize** on the **View** menu and then clicks **Toolbars and Docking**. In the dialog box, the user clicks either the **Keyboard** tab or the **Mouse** tab.  \n  \n## Keyboard Customization  \n The following illustration shows the **Keyboard** tab of the **Customization** dialog box.  \n  \n ![Keyboard tab in the Customize dialog box](../mfc/media/mfcnextkeyboardtab.png \"mfcnextkeyboardtab\")  \nKeyboard Customization Tab  \n  \n The user interacts with the keyboard tab to assign one or more keyboard shortcuts to a command. The available commands are listed on the left side of the tab. The user can select any available command from the menu. Only menu commands can be associated with a keyboard shortcut. After the user enters a new shortcut, the **Assign** button becomes enabled. When the user clicks this button, the application associates the selected command with that shortcut.  \n  \n All of the currently assigned keyboard shortcuts are listed in the list box in the right column. The user can also select individual shortcuts and remove them, or reset all the mappings for the application.  \n  \n If you want to support this customization in your application, you must create a [CKeyboardManager](../mfc/reference/ckeyboardmanager-class.md) object. To create a `CKeyboardManager` object, call the function [CWinAppEx::InitKeyboardManager](../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager). This method creates and initializes a keyboard manager. If you create a keyboard manager manually, you still must call `CWinAppEx::InitKeyboardManager` to initialize it.  \n  \n If you use the Wizard to create your application, the Wizard will initialize the keyboard manager. After your application initializes the keyboard manager, the framework adds a **Keyboard** tab to the **Customization** dialog box.  \n  \n## Mouse Customization  \n The following illustration shows the **Mouse** tab of the **Customization** dialog box.  \n  \n ![Mouse tab in the Customize dialog box](../mfc/media/mfcnextmousetab.png \"mfcnextmousetab\")  \nMouse Customization Tab  \n  \n The user interacts with this tab to assign a menu command to the mouse double-click action. The user selects a view from the left side of the window and then uses the controls on the right side to associate a command with the double-click action. After the user clicks **Close**, the application executes the associated command whenever the user double-clicks anywhere in the view.  \n  \n By default, mouse customization is not enabled when you create an application by using the Wizard.  \n  \n#### To enable mouse customization  \n  \n1.  Initialize a [CMouseManager](../mfc/reference/cmousemanager-class.md) object by calling [CWinAppEx::InitMouseManager](../mfc/reference/cwinappex-class.md#cwinappex__initmousemanager).  \n  \n2.  Obtain a pointer to the mouse manager by using [CWinAppEx::GetMouseManager](../mfc/reference/cwinappex-class.md#cwinappex__getmousemanager).  \n  \n3.  Add views to the mouse manager by using the [CMouseManager::AddView](../mfc/reference/cmousemanager-class.md#cmousemanager__addview) method. Do this for every view you want to add to the mouse manager.  \n  \n After your application initializes the mouse manager, the framework adds the **Mouse** tab to the **Customize** dialog box. If you do not add any views, accessing the tab will cause an unhandled exception. After you have created a list of views, the **Mouse** tab is available to the user.  \n  \n When you add a new view to the mouse manager, you give it a unique ID. If you want to support mouse customization for a window, you must process the `WM_LBUTTONDBLCLICK` message and call the [CWinAppEx::OnViewDoubleClick](../mfc/reference/cwinappex-class.md#cwinappex__onviewdoubleclick) function. When you call this function, one of the parameters is the ID for that window. It is the responsibility of the programmer to keep track of the ID numbers and the objects associated with them.  \n  \n## Security Concerns  \n As described in [User-defined Tools](../mfc/user-defined-tools.md), the user can associate a user-defined tool ID with the double-click event. When the user double-clicks a view, the application looks for a user tool that matches the associated ID. If the application finds a matching tool, it executes the tool. If the application cannot find a matching tool, it sends a WM_COMMAND message with the ID to the view that was double-clicked.  \n  \n The customized settings are stored in the registry. By editing the registry, an attacker can replace a valid user tool ID with an arbitrary command. When the user double-clicks a view, the view processes the command that the attacker planted. This could cause unexpected and potentially dangerous behavior.  \n  \n In addition, this kind of attack can bypass user interface safeguards. For example, suppose an application has printing disabled. That is, in its user interface, the **Print** menu and button are unavailable. Normally this prevents the application from printing. But if an attacker edited the registry, a user could now could send the print command directly by double-clicking the view, bypassing the user interface elements that are unavailable.  \n  \n To guard against this kind of attack, add code to your application command handler to verify that a command is valid before it is executed. Do not depend on the user interface to prevent a command from being sent to the application.  \n  \n## See Also  \n [Customization for MFC](../mfc/customization-for-mfc.md)   \n [CKeyboardManager Class](../mfc/reference/ckeyboardmanager-class.md)   \n [CMouseManager Class](../mfc/reference/cmousemanager-class.md)   \n [Security Implications of Customization](../mfc/security-implications-of-customization.md)\n\n"}