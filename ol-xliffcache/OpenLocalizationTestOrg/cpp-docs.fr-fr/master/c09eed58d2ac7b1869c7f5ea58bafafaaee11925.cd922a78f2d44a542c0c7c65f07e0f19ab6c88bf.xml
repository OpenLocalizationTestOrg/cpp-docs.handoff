{"nodes":[{"pos":[12,76],"content":"Porting to the Universal Windows Platform (C++) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Porting to the Universal Windows Platform (C++) | Microsoft Docs","pos":[0,64]}]},{"content":"Porting to the Universal Windows Platform (C++)","pos":[583,630]},{"content":"In this topic, you can find information on how to port existing C++ code to the Windows 10 app platform, the Universal Windows Platform.","pos":[631,767]},{"content":"What is meant by the term <bpt id=\"p1\">*</bpt>universal<ept id=\"p1\">*</ept> is that your code can run on any of the devices that run Windows 10, including desktop, phone, tablets, and future devices that run Windows 10.","pos":[768,949],"source":" What is meant by the term *universal* is that your code can run on any of the devices that run Windows 10, including desktop, phone, tablets, and future devices that run Windows 10."},{"content":"With Windows 8.1, you created an app that targeted both Windows 8.1 and Windows Phone 8.1 by using a special project system feature called a shared project.","pos":[950,1106]},{"content":"Universal Windows Apps do not use this mechanism, but instead you use a single project and a single XAML that works well on any device that runs Windows 10.","pos":[1107,1263]},{"content":"You can use dynamic layout features in XAML to allow the app's UI to adapt to different display sizes.","pos":[1264,1366]},{"content":"The Windows Dev Center documentation contains a guide for porting Windows 8.1 apps to the Universal Windows Platform.","pos":[1373,1490]},{"content":"See <bpt id=\"p1\">[</bpt>Move from Windows Runtime 8 to UWP<ept id=\"p1\">](https://msdn.microsoft.com/windows/uwp/porting/w8x-to-uwp-root)</ept>.","pos":[1491,1596],"source":" See [Move from Windows Runtime 8 to UWP](https://msdn.microsoft.com/windows/uwp/porting/w8x-to-uwp-root)."},{"content":"Although the guide focused mostly on C# code, most of the guidance is applicable to C++.","pos":[1597,1685]},{"content":"The following procedures contain more detailed information.","pos":[1686,1745]},{"content":"This topic contains the following procedures for porting code to the UWP.","pos":[1752,1825]},{"content":"Porting a Windows 8.1 Store App to the UWP","pos":[1836,1878]},{"content":"Porting a Windows 8.1 Runtime Component to the UWP","pos":[1906,1956]},{"content":"If you have a classic desktop Win32 DLL and you want to call it from a UWP application, you can do that as well.","pos":[1981,2093]},{"content":"Using such procedures, you can create a UWP user interface layer for an existing classic Windows desktop C++ application, or your cross-platform standard C++ code.","pos":[2094,2257]},{"content":"See <bpt id=\"p1\">[</bpt>How to: Use Existing C++ Code in a Universal Windows Platform App<ept id=\"p1\">](../porting/how-to-use-existing-cpp-code-in-a-universal-windows-platform-app.md)</ept>.","pos":[2258,2410],"source":" See [How to: Use Existing C++ Code in a Universal Windows Platform App](../porting/how-to-use-existing-cpp-code-in-a-universal-windows-platform-app.md)."},{"pos":[2449,2491],"content":"Porting a Windows 8.1 Store App to the UWP"},{"content":"If you have a Windows 8.1 Store App, you can use this procedure to get it working on the UWP and any device that runs Windows 10.","pos":[2495,2624]},{"content":"It's a good idea to first build the project with <ph id=\"ph1\">[!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)]</ph> as a Windows 8.1 project, to first eliminate any issues that arise from changes in the compiler and libraries.","pos":[2626,2838],"source":"  It's a good idea to first build the project with [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)] as a Windows 8.1 project, to first eliminate any issues that arise from changes in the compiler and libraries."},{"content":"Once you've done that, there are two ways to convert this to a Windows 10 UWP project.","pos":[2839,2925]},{"content":"The easiest way (as explained in the following procedure) is to create a Universal Windows project, and copy your existing code into it.","pos":[2926,3062]},{"content":"If you were using a Universal project for Windows 8.1 desktop and Windows 8.1 Phone, your project will start with two different layouts in XAML but end with a single dynamic layout that adjusts to the display size.","pos":[3063,3277]},{"content":"To port a Windows 8.1 Store App to the UWP","pos":[3288,3330]},{"pos":[3340,3520],"content":"If you have not already done so, open your Windows 8.1 App project in <ph id=\"ph1\">[!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)]</ph>, and follow the instructions to upgrade the project file.","source":"If you have not already done so, open your Windows 8.1 App project in [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)], and follow the instructions to upgrade the project file."},{"content":"You need to have installed the Windows 8.1 Tools in Visual Studio setup.","pos":[3531,3603]},{"content":"If you don't have those tools installed, start Visual Studio setup from the Programs and Features window, choose <ph id=\"ph1\">[!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)]</ph>, and in the setup window, choose <bpt id=\"p1\">**</bpt>Modify<ept id=\"p1\">**</ept>.","pos":[3604,3814],"source":" If you don't have those tools installed, start Visual Studio setup from the Programs and Features window, choose [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)], and in the setup window, choose **Modify**."},{"content":"Locate Windows 8.1 Tools, make sure it is selected, and choose OK.","pos":[3815,3881]},{"pos":[3891,4058],"content":"Open the Project Properties window, and under C++, General, set the Platform Toolset to v140, the build tools for <ph id=\"ph1\">[!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)]</ph>.","source":"Open the Project Properties window, and under C++, General, set the Platform Toolset to v140, the build tools for [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)]."},{"content":"Build the project as a Windows 8.1 project, and address any build errors.","pos":[4068,4141]},{"content":"Any errors at this stage are probably due to breaking changes in the build tools and libraries.","pos":[4142,4237]},{"content":"See <bpt id=\"p1\">[</bpt>Visual C++ change history 2003 - 2015<ept id=\"p1\">](../porting/visual-cpp-change-history-2003-2015.md)</ept> for a detailed explanation of the changes that might affect your code.","pos":[4238,4403],"source":" See [Visual C++ change history 2003 - 2015](../porting/visual-cpp-change-history-2003-2015.md) for a detailed explanation of the changes that might affect your code."},{"content":"Once your project builds cleanly, you are ready to port to Universal Windows (Windows 10).","pos":[4414,4504]},{"content":"Create a new Universal Windows App project using the Blank template.","pos":[4514,4582]},{"content":"You might want to give it the same name as your existing project, although to do that the projects must be in different directories.","pos":[4583,4715]},{"content":"Close the solution, and then using Windows Explorer or the command line, copy the code files (with extensions .cpp, .h, and .xaml) from your Windows 8.1 project into the same folder as the project file (.vcxproj) for the project you created in step 1.","pos":[4725,4976]},{"content":"Do not copy the Package.appxmanifest file, and if you have separate code for Windows 8.1 desktop and phone, choose one of them to port first (you'll have to do some work later to adapt to the other).","pos":[4977,5176]},{"content":"Be sure to copy and subfolders and their contents.","pos":[5177,5227]},{"content":"If prompted, choose to replace any files with duplicate names.","pos":[5228,5290]},{"content":"Reopen the solution, and choose <bpt id=\"p1\">**</bpt>Add, Existing Item<ept id=\"p1\">**</ept> from the shortcut menu for the project node.","pos":[5300,5399],"source":"Reopen the solution, and choose **Add, Existing Item** from the shortcut menu for the project node."},{"content":"Select all the files you copied, except any that are already part of the project.","pos":[5400,5481]},{"content":"Check any subfolders and make sure to add the files in them as well.","pos":[5492,5560]},{"content":"If you are not using the same project name as your old project, open the Package.appxmanifest file and update the Entry Point to reflect the namespace name for the App class.","pos":[5570,5744]},{"content":"The <bpt id=\"p1\">**</bpt>Entry Point<ept id=\"p1\">**</ept> field in the Package.appxmanifest file contains a scoped name for the App class, which includes the namespace that contains the App class.","pos":[5755,5913],"source":"The **Entry Point** field in the Package.appxmanifest file contains a scoped name for the App class, which includes the namespace that contains the App class."},{"content":"When you create a Universal Windows project, the namespace is set to the name of the project.","pos":[5914,6007]},{"content":"If this is different from what's in the files you copied in from your old project, you must update one or the other to make them match.","pos":[6008,6143]},{"content":"Build the project, and address any build errors due to breaking changes between the different versions of the Windows SDK.","pos":[6153,6275]},{"content":"Run the project on the Local Desktop.","pos":[6284,6321]},{"content":"Verify that there are no deployment errors, and that the layout of the app looks reasonable and that it functions correctly on the desktop.","pos":[6322,6461]},{"content":"If you had separate code files and .xaml for another device, such as Windows Phone 8.1, examine this code and identify where it differs from the standard device.","pos":[6471,6632]},{"content":"If the difference is only in the layout, you might be able to use a Visual State Manager in the xaml to customize the display depending on the size of the screen.","pos":[6633,6795]},{"content":"For other differences, you can use conditions sections in your code using the following #if statements.","pos":[6796,6899]},{"content":"These statements respectively apply to Windows Store apps, Windows Phone Store apps, both, or neither (classic Win32 desktop only).","pos":[7170,7301]},{"content":"These macros are only available in Windows SDK 8.1 and later, so if your code needs to compile with earlier versions of the Windows SDK or for other platforms besides Windows, then you should also consider the case that none of them are defined.","pos":[7302,7547]},{"content":"Run and debug the app on an emulator or physical device, for each type of device that your app supports.","pos":[7557,7661]},{"content":"To run an emulator, you need to run Visual Studio on a physical computer, not a virtual machine.","pos":[7662,7758]},{"pos":[7798,7848],"content":"Porting a Windows 8.1 Runtime Component to the UWP"},{"content":"If you have a DLL or a Windows Runtime Component that already works with Windows 8.1 Store apps, you can use this procedure to get the component or DLL working with the UWP and Windows 10.","pos":[7852,8040]},{"content":"The basic procedure is to create a new project and copy your code into it.","pos":[8041,8115]},{"content":"To port a Windows 8.1 Runtime Component to the UWP","pos":[8126,8176]},{"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog in <ph id=\"ph1\">[!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)]</ph>, locate the <bpt id=\"p2\">**</bpt>Windows Universal<ept id=\"p2\">**</ept> node.","pos":[8186,8311],"source":"In the **New Project** dialog in [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)], locate the **Windows Universal** node."},{"content":"If you don't see this node, install the <bpt id=\"p1\">[</bpt>Tools for Windows 10<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=617903)</ept> first.","pos":[8312,8430],"source":" If you don't see this node, install the [Tools for Windows 10](http://go.microsoft.com/fwlink/p/?LinkID=617903) first."},{"content":"Choose the <bpt id=\"p1\">**</bpt>Windows Runtime Component<ept id=\"p1\">**</ept> template, give a name for your component, and choose the <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept> button.","pos":[8431,8543],"source":" Choose the **Windows Runtime Component** template, give a name for your component, and choose the **OK** button."},{"content":"The component name will be used as the namespace name, so you might want to use the same name as your old projects' namespace.","pos":[8544,8670]},{"content":"This requires that you create the project in a different folder from the old one.","pos":[8671,8752]},{"content":"If you choose a different name, you can update the namespace name in the generated code files.","pos":[8753,8847]},{"content":"Close the project.","pos":[8857,8875]},{"content":"Copy all the code files (.cpp, .h, .xaml, etc.) from your Windows 8.1 component into your newly created project.","pos":[8885,8997]},{"content":"Do not copy the Package.appxmanifest file.","pos":[8998,9040]},{"content":"Build, and resolve any errors due to breaking changes between different versions of the Windows SDK.","pos":[9050,9150]},{"content":"Troubleshooting","pos":[9159,9174]},{"content":"You might encounter various errors during the process of porting code to the Universal Windows Platform.","pos":[9178,9282]},{"content":"Here are some of the possible problems you might encounter.","pos":[9283,9342]},{"content":"Project Configuration Issues","pos":[9351,9379]},{"content":"You might receive the error:","pos":[9388,9416]},{"content":"If this happens, the project is not building as a Windows Universal project.","pos":[9585,9661]},{"content":"Check the project file and make sure it has the correct XML elements that identify a project as a Windows Universal Project.","pos":[9662,9786]},{"content":"The following elements should be present (the version number of the target platform might be different):","pos":[9787,9891]},{"content":"If you created a new Universal Windows Platform project using Visual Studio, you should not see this error.","pos":[10241,10348]},{"content":"See Also","pos":[10357,10365]},{"content":"Visual C++ Porting Guide","pos":[10370,10394]},{"content":"Develop apps for the Universal Windows Platform (UWP)","pos":[10462,10515]}],"content":"---\ntitle: \"Porting to the Universal Windows Platform (C++) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nms.assetid: f662d2e4-8940-418d-8109-cb76cb8f8569\ncaps.latest.revision: 14\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Porting to the Universal Windows Platform (C++)\nIn this topic, you can find information on how to port existing C++ code to the Windows 10 app platform, the Universal Windows Platform. What is meant by the term *universal* is that your code can run on any of the devices that run Windows 10, including desktop, phone, tablets, and future devices that run Windows 10. With Windows 8.1, you created an app that targeted both Windows 8.1 and Windows Phone 8.1 by using a special project system feature called a shared project. Universal Windows Apps do not use this mechanism, but instead you use a single project and a single XAML that works well on any device that runs Windows 10. You can use dynamic layout features in XAML to allow the app's UI to adapt to different display sizes.  \n  \n The Windows Dev Center documentation contains a guide for porting Windows 8.1 apps to the Universal Windows Platform. See [Move from Windows Runtime 8 to UWP](https://msdn.microsoft.com/windows/uwp/porting/w8x-to-uwp-root). Although the guide focused mostly on C# code, most of the guidance is applicable to C++. The following procedures contain more detailed information.  \n  \n This topic contains the following procedures for porting code to the UWP.  \n  \n1.  [Porting a Windows 8.1 Store App to the UWP](#BK_81StoreApp)  \n  \n2.  [Porting a Windows 8.1 Runtime Component to the UWP](#BK_81Component)  \n  \n If you have a classic desktop Win32 DLL and you want to call it from a UWP application, you can do that as well. Using such procedures, you can create a UWP user interface layer for an existing classic Windows desktop C++ application, or your cross-platform standard C++ code. See [How to: Use Existing C++ Code in a Universal Windows Platform App](../porting/how-to-use-existing-cpp-code-in-a-universal-windows-platform-app.md).  \n  \n##  <a name=\"BK_81StoreApp\"></a> Porting a Windows 8.1 Store App to the UWP  \n If you have a Windows 8.1 Store App, you can use this procedure to get it working on the UWP and any device that runs Windows 10.  It's a good idea to first build the project with [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)] as a Windows 8.1 project, to first eliminate any issues that arise from changes in the compiler and libraries. Once you've done that, there are two ways to convert this to a Windows 10 UWP project. The easiest way (as explained in the following procedure) is to create a Universal Windows project, and copy your existing code into it. If you were using a Universal project for Windows 8.1 desktop and Windows 8.1 Phone, your project will start with two different layouts in XAML but end with a single dynamic layout that adjusts to the display size.  \n  \n#### To port a Windows 8.1 Store App to the UWP  \n  \n1.  If you have not already done so, open your Windows 8.1 App project in [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)], and follow the instructions to upgrade the project file.  \n  \n     You need to have installed the Windows 8.1 Tools in Visual Studio setup. If you don't have those tools installed, start Visual Studio setup from the Programs and Features window, choose [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)], and in the setup window, choose **Modify**. Locate Windows 8.1 Tools, make sure it is selected, and choose OK.  \n  \n2.  Open the Project Properties window, and under C++, General, set the Platform Toolset to v140, the build tools for [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)].  \n  \n3.  Build the project as a Windows 8.1 project, and address any build errors. Any errors at this stage are probably due to breaking changes in the build tools and libraries. See [Visual C++ change history 2003 - 2015](../porting/visual-cpp-change-history-2003-2015.md) for a detailed explanation of the changes that might affect your code.  \n  \n     Once your project builds cleanly, you are ready to port to Universal Windows (Windows 10).  \n  \n4.  Create a new Universal Windows App project using the Blank template. You might want to give it the same name as your existing project, although to do that the projects must be in different directories.  \n  \n5.  Close the solution, and then using Windows Explorer or the command line, copy the code files (with extensions .cpp, .h, and .xaml) from your Windows 8.1 project into the same folder as the project file (.vcxproj) for the project you created in step 1. Do not copy the Package.appxmanifest file, and if you have separate code for Windows 8.1 desktop and phone, choose one of them to port first (you'll have to do some work later to adapt to the other). Be sure to copy and subfolders and their contents. If prompted, choose to replace any files with duplicate names.  \n  \n6.  Reopen the solution, and choose **Add, Existing Item** from the shortcut menu for the project node. Select all the files you copied, except any that are already part of the project.  \n  \n     Check any subfolders and make sure to add the files in them as well.  \n  \n7.  If you are not using the same project name as your old project, open the Package.appxmanifest file and update the Entry Point to reflect the namespace name for the App class.  \n  \n     The **Entry Point** field in the Package.appxmanifest file contains a scoped name for the App class, which includes the namespace that contains the App class. When you create a Universal Windows project, the namespace is set to the name of the project. If this is different from what's in the files you copied in from your old project, you must update one or the other to make them match.  \n  \n8.  Build the project, and address any build errors due to breaking changes between the different versions of the Windows SDK.  \n  \n9. Run the project on the Local Desktop. Verify that there are no deployment errors, and that the layout of the app looks reasonable and that it functions correctly on the desktop.  \n  \n10. If you had separate code files and .xaml for another device, such as Windows Phone 8.1, examine this code and identify where it differs from the standard device. If the difference is only in the layout, you might be able to use a Visual State Manager in the xaml to customize the display depending on the size of the screen. For other differences, you can use conditions sections in your code using the following #if statements.  \n  \n    ```  \n    #if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_PC_APP)  \n    #if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_PHONE_APP)  \n    #if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_APP)  \n    #if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP)  \n    ```  \n  \n     These statements respectively apply to Windows Store apps, Windows Phone Store apps, both, or neither (classic Win32 desktop only). These macros are only available in Windows SDK 8.1 and later, so if your code needs to compile with earlier versions of the Windows SDK or for other platforms besides Windows, then you should also consider the case that none of them are defined.  \n  \n11. Run and debug the app on an emulator or physical device, for each type of device that your app supports. To run an emulator, you need to run Visual Studio on a physical computer, not a virtual machine.  \n  \n##  <a name=\"BK_81Component\"></a> Porting a Windows 8.1 Runtime Component to the UWP  \n If you have a DLL or a Windows Runtime Component that already works with Windows 8.1 Store apps, you can use this procedure to get the component or DLL working with the UWP and Windows 10. The basic procedure is to create a new project and copy your code into it.  \n  \n#### To port a Windows 8.1 Runtime Component to the UWP  \n  \n1.  In the **New Project** dialog in [!INCLUDE[vs_dev14](../ide/includes/vs_dev14_md.md)], locate the **Windows Universal** node. If you don't see this node, install the [Tools for Windows 10](http://go.microsoft.com/fwlink/p/?LinkID=617903) first. Choose the **Windows Runtime Component** template, give a name for your component, and choose the **OK** button. The component name will be used as the namespace name, so you might want to use the same name as your old projects' namespace. This requires that you create the project in a different folder from the old one. If you choose a different name, you can update the namespace name in the generated code files.  \n  \n2.  Close the project.  \n  \n3.  Copy all the code files (.cpp, .h, .xaml, etc.) from your Windows 8.1 component into your newly created project. Do not copy the Package.appxmanifest file.  \n  \n4.  Build, and resolve any errors due to breaking changes between different versions of the Windows SDK.  \n  \n## Troubleshooting  \n You might encounter various errors during the process of porting code to the Universal Windows Platform. Here are some of the possible problems you might encounter.  \n  \n **Project Configuration Issues**  \n  \n You might receive the error:  \n  \n```Output  \ncould not find assembly 'platform.winmd': please specify the assembly search path using /AI or by setting the LIBPATH environment variable  \n```  \n  \n If this happens, the project is not building as a Windows Universal project. Check the project file and make sure it has the correct XML elements that identify a project as a Windows Universal Project. The following elements should be present (the version number of the target platform might be different):  \n  \n```xml  \n<AppContainerApplication>true</AppContainerApplication>  \n<ApplicationType>Windows Store</ApplicationType>  \n<WindowsTargetPlatformVersion>10.0.10156.0</WindowsTargetPlatformVersion>  \n<WindowsTargetPlatformMinVersion>10.0.10156.0</WindowsTargetPlatformMinVersion>  \n<ApplicationTypeRevision>10.0</ApplicationTypeRevision>  \n```  \n  \n If you created a new Universal Windows Platform project using Visual Studio, you should not see this error.  \n  \n## See Also  \n [Visual C++ Porting Guide](../porting/porting-to-the-universal-windows-platform-cpp.md)   \n [Develop apps for the Universal Windows Platform (UWP)](/visualstudio/cross-platform/develop-apps-for-the-universal-windows-platform-uwp)"}