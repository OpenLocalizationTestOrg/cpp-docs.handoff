{"nodes":[{"pos":[12,47],"content":"CRichEditDoc Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CRichEditDoc Class | Microsoft Docs","pos":[0,35]}]},{"content":"CRichEditDoc Class","pos":[762,780]},{"pos":[781,1026],"content":"With <bpt id=\"p1\">[</bpt>CRichEditView<ept id=\"p1\">](../../mfc/reference/cricheditview-class.md)</ept> and <bpt id=\"p2\">[</bpt>CRichEditCntrItem<ept id=\"p2\">](../../mfc/reference/cricheditcntritem-class.md)</ept>, provides the functionality of the rich edit control within the context of MFC's document view architecture.","source":"With [CRichEditView](../../mfc/reference/cricheditview-class.md) and [CRichEditCntrItem](../../mfc/reference/cricheditcntritem-class.md), provides the functionality of the rich edit control within the context of MFC's document view architecture."},{"content":"Syntax","pos":[1035,1041]},{"content":"Members","pos":[1109,1116]},{"content":"Public Methods","pos":[1126,1140]},{"content":"Name","pos":[1147,1151]},{"content":"Description","pos":[1152,1163]},{"content":"CRichEditDoc::CreateClientItem","pos":[1202,1232]},{"content":"Called to perform cleanup of the document.","pos":[1267,1309]},{"content":"CRichEditDoc::GetStreamFormat","pos":[1315,1344]},{"content":"Indicates whether stream input and output should include formatting information.","pos":[1378,1458]},{"content":"CRichEditDoc::GetView","pos":[1464,1485]},{"pos":[1511,1604],"content":"Retrieves the asssociated <bpt id=\"p1\">[</bpt>CRichEditView<ept id=\"p1\">](../../mfc/reference/cricheditview-class.md)</ept> object.","source":"Retrieves the asssociated [CRichEditView](../../mfc/reference/cricheditview-class.md) object."},{"content":"Public Data Members","pos":[1615,1634]},{"content":"Name","pos":[1641,1645]},{"content":"Description","pos":[1646,1657]},{"content":"CRichEditDoc::m_bRTF","pos":[1696,1716]},{"content":"Indicates whether stream I/O should include formatting.","pos":[1741,1796]},{"content":"Remarks","pos":[1806,1813]},{"content":"A \"rich edit control\" is a window in which the user can enter and edit text.","pos":[1817,1893]},{"content":"The text can be assigned character and paragraph formatting, and can include embedded OLE objects.","pos":[1894,1992]},{"content":"Rich edit controls provide a programming interface for formatting text.","pos":[1993,2064]},{"content":"However, an application must implement any user interface components necessary to make formatting operations available to the user.","pos":[2065,2196]},{"content":"maintains the text and formatting characteristic of text.","pos":[2219,2276]},{"content":"maintains the list of client items which are in the view.","pos":[2292,2349]},{"content":"provides container-side access to the OLE client items.","pos":[2370,2425]},{"pos":[2432,2657],"content":"This Windows Common control (and therefore the <bpt id=\"p1\">[</bpt>CRichEditCtrl<ept id=\"p1\">](../../mfc/reference/cricheditctrl-class.md)</ept> and related classes) is available only to programs running under Windows 95/98 and Windows NT versions 3.51 and later.","source":"This Windows Common control (and therefore the [CRichEditCtrl](../../mfc/reference/cricheditctrl-class.md) and related classes) is available only to programs running under Windows 95/98 and Windows NT versions 3.51 and later."},{"pos":[2664,2798],"content":"For an example of using a rich edit document in an MFC application, see the <bpt id=\"p1\">[</bpt>WORDPAD<ept id=\"p1\">](../../visual-cpp-samples.md)</ept> sample application.","source":"For an example of using a rich edit document in an MFC application, see the [WORDPAD](../../visual-cpp-samples.md) sample application."},{"content":"Inheritance Hierarchy","pos":[2807,2828]},{"content":"CObject","pos":[2833,2840]},{"content":"CCmdTarget","pos":[2887,2897]},{"content":"CDocument","pos":[2947,2956]},{"content":"COleDocument","pos":[3005,3017]},{"content":"COleLinkingDoc","pos":[3069,3083]},{"content":"COleServerDoc","pos":[3137,3150]},{"content":"Requirements","pos":[3225,3237]},{"pos":[3241,3262],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxrich.h","source":"**Header:** afxrich.h"},{"pos":[3319,3349],"content":"CRichEditDoc::CreateClientItem"},{"pos":[3353,3439],"content":"Call this function to create a <ph id=\"ph1\">`CRichEditCntrItem`</ph> object and add it to this document.","source":"Call this function to create a `CRichEditCntrItem` object and add it to this document."},{"content":"Parameters","pos":[3544,3554]},{"content":"preo","pos":[3559,3563]},{"content":"Pointer to an <bpt id=\"p1\">[</bpt>REOBJECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb787946)</ept> structure which describes an OLE item.","pos":[3568,3691],"source":" Pointer to an [REOBJECT](http://msdn.microsoft.com/library/windows/desktop/bb787946) structure which describes an OLE item."},{"content":"The new <ph id=\"ph1\">`CRichEditCntrItem`</ph> object is constructed around this OLE item.","pos":[3692,3763],"source":" The new `CRichEditCntrItem` object is constructed around this OLE item."},{"content":"If <bpt id=\"p1\">*</bpt>preo<ept id=\"p1\">*</ept> is <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>, the new client item is empty.","pos":[3764,3816],"source":" If *preo* is **NULL**, the new client item is empty."},{"content":"Return Value","pos":[3826,3838]},{"pos":[3842,3972],"content":"Pointer to a new <bpt id=\"p1\">[</bpt>CRichEditCntrItem<ept id=\"p1\">](../../mfc/reference/cricheditcntritem-class.md)</ept> object which has been added to this document.","source":"Pointer to a new [CRichEditCntrItem](../../mfc/reference/cricheditcntritem-class.md) object which has been added to this document."},{"content":"Remarks","pos":[3982,3989]},{"content":"This function does not perform any OLE initialization.","pos":[3993,4047]},{"pos":[4054,4224],"content":"For more information, see the <bpt id=\"p1\">[</bpt>REOBJECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb787946)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [REOBJECT](http://msdn.microsoft.com/library/windows/desktop/bb787946) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4280,4309],"content":"CRichEditDoc::GetStreamFormat"},{"content":"Call this function to determine the text format for streaming the contents of the rich edit.","pos":[4313,4405]},{"content":"Return Value","pos":[4462,4474]},{"content":"One of the following flags:","pos":[4478,4505]},{"pos":[4523,4601],"content":"Indicates that the rich edit control does not maintain formatting information."},{"pos":[4618,4692],"content":"Indicates that the rich edit control does maintain formatting information."},{"content":"Remarks","pos":[4702,4709]},{"content":"The return value is based on the <bpt id=\"p1\">[</bpt>m_bRTF<ept id=\"p1\">](#cricheditdoc__m_brtf)</ept> data member.","pos":[4713,4790],"source":"The return value is based on the [m_bRTF](#cricheditdoc__m_brtf) data member."},{"content":"This function returns <ph id=\"ph1\">`SF_RTF`</ph> if <ph id=\"ph2\">`m_bRTF`</ph> is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>; otherwise, <ph id=\"ph3\">`SF_TEXT`</ph>.","pos":[4791,4868],"source":" This function returns `SF_RTF` if `m_bRTF` is **TRUE**; otherwise, `SF_TEXT`."},{"pos":[4916,4937],"content":"CRichEditDoc::GetView"},{"pos":[4941,5084],"content":"Call this function to access the <bpt id=\"p1\">[</bpt>CRichEditView<ept id=\"p1\">](../../mfc/reference/cricheditview-class.md)</ept> object associated with this <ph id=\"ph1\">`CRichEditDoc`</ph> object.","source":"Call this function to access the [CRichEditView](../../mfc/reference/cricheditview-class.md) object associated with this `CRichEditDoc` object."},{"content":"Return Value","pos":[5152,5164]},{"pos":[5168,5235],"content":"Pointer to the <ph id=\"ph1\">`CRichEditView`</ph> object associated with the document.","source":"Pointer to the `CRichEditView` object associated with the document."},{"content":"Remarks","pos":[5245,5252]},{"content":"The text and formatting information are contained within the <ph id=\"ph1\">`CRichEditView`</ph> object.","pos":[5256,5340],"source":"The text and formatting information are contained within the `CRichEditView` object."},{"content":"The <ph id=\"ph1\">`CRichEditDoc`</ph> object maintains the OLE items for serialization.","pos":[5341,5409],"source":" The `CRichEditDoc` object maintains the OLE items for serialization."},{"content":"There should be only one <ph id=\"ph1\">`CRichEditView`</ph> for each <ph id=\"ph2\">`CRichEditDoc`</ph>.","pos":[5410,5475],"source":" There should be only one `CRichEditView` for each `CRichEditDoc`."},{"pos":[5522,5542],"content":"CRichEditDoc::m_bRTF"},{"pos":[5546,5834],"content":"When <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, indicates that <bpt id=\"p2\">[</bpt>CRichEditCtrl::StreamIn<ept id=\"p2\">](../../mfc/reference/cricheditctrl-class.md#cricheditctrl__streamin)</ept> and <bpt id=\"p3\">[</bpt>CRichEditCtrl::StreamOut<ept id=\"p3\">](../../mfc/reference/cricheditctrl-class.md#cricheditctrl__streamout)</ept> should store paragraph and character-formatting characteristics.","source":"When **TRUE**, indicates that [CRichEditCtrl::StreamIn](../../mfc/reference/cricheditctrl-class.md#cricheditctrl__streamin) and [CRichEditCtrl::StreamOut](../../mfc/reference/cricheditctrl-class.md#cricheditctrl__streamout) should store paragraph and character-formatting characteristics."},{"content":"See Also","pos":[5873,5881]},{"content":"MFC Sample WORDPAD","pos":[5886,5904]},{"content":"COleServerDoc Class","pos":[5940,5959]},{"content":"Hierarchy Chart","pos":[6010,6025]},{"content":"CRichEditView Class","pos":[6062,6081]},{"content":"CRichEditCntrItem Class","pos":[6132,6155]},{"content":"COleDocument Class","pos":[6210,6228]},{"content":"CRichEditCtrl Class","pos":[6278,6297]}],"content":"---\ntitle: \"CRichEditDoc Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CRichEditDoc\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"document/view architecture, rich edit controls\"\n  - \"OLE containers, rich edit\"\n  - \"documents, rich edit\"\n  - \"rich edit controls, OLE container\"\n  - \"CRichEditDoc class\"\nms.assetid: c936ec18-d516-49d4-b7fb-c9aa0229eddc\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CRichEditDoc Class\nWith [CRichEditView](../../mfc/reference/cricheditview-class.md) and [CRichEditCntrItem](../../mfc/reference/cricheditcntritem-class.md), provides the functionality of the rich edit control within the context of MFC's document view architecture.  \n  \n## Syntax  \n  \n```  \nclass CRichEditDoc : public COleServerDoc  \n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRichEditDoc::CreateClientItem](#cricheditdoc__createclientitem)|Called to perform cleanup of the document.|  \n|[CRichEditDoc::GetStreamFormat](#cricheditdoc__getstreamformat)|Indicates whether stream input and output should include formatting information.|  \n|[CRichEditDoc::GetView](#cricheditdoc__getview)|Retrieves the asssociated [CRichEditView](../../mfc/reference/cricheditview-class.md) object.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRichEditDoc::m_bRTF](#cricheditdoc__m_brtf)|Indicates whether stream I/O should include formatting.|  \n  \n## Remarks  \n A \"rich edit control\" is a window in which the user can enter and edit text. The text can be assigned character and paragraph formatting, and can include embedded OLE objects. Rich edit controls provide a programming interface for formatting text. However, an application must implement any user interface components necessary to make formatting operations available to the user.  \n  \n `CRichEditView` maintains the text and formatting characteristic of text. `CRichEditDoc` maintains the list of client items which are in the view. `CRichEditCntrItem` provides container-side access to the OLE client items.  \n  \n This Windows Common control (and therefore the [CRichEditCtrl](../../mfc/reference/cricheditctrl-class.md) and related classes) is available only to programs running under Windows 95/98 and Windows NT versions 3.51 and later.  \n  \n For an example of using a rich edit document in an MFC application, see the [WORDPAD](../../visual-cpp-samples.md) sample application.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CDocument](../../mfc/reference/cdocument-class.md)  \n  \n [COleDocument](../../mfc/reference/coledocument-class.md)  \n  \n [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)  \n  \n [COleServerDoc](../../mfc/reference/coleserverdoc-class.md)  \n  \n `CRichEditDoc`  \n  \n## Requirements  \n **Header:** afxrich.h  \n  \n##  <a name=\"cricheditdoc__createclientitem\"></a>  CRichEditDoc::CreateClientItem  \n Call this function to create a `CRichEditCntrItem` object and add it to this document.  \n  \n```  \nvirtual CRichEditCntrItem* CreateClientItem(REOBJECT* preo = NULL) const = 0;  \n```  \n  \n### Parameters  \n *preo*  \n Pointer to an [REOBJECT](http://msdn.microsoft.com/library/windows/desktop/bb787946) structure which describes an OLE item. The new `CRichEditCntrItem` object is constructed around this OLE item. If *preo* is **NULL**, the new client item is empty.  \n  \n### Return Value  \n Pointer to a new [CRichEditCntrItem](../../mfc/reference/cricheditcntritem-class.md) object which has been added to this document.  \n  \n### Remarks  \n This function does not perform any OLE initialization.  \n  \n For more information, see the [REOBJECT](http://msdn.microsoft.com/library/windows/desktop/bb787946) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"cricheditdoc__getstreamformat\"></a>  CRichEditDoc::GetStreamFormat  \n Call this function to determine the text format for streaming the contents of the rich edit.  \n  \n```  \nint GetStreamFormat() const;\n\n \n```  \n  \n### Return Value  \n One of the following flags:  \n  \n- `SF_TEXT` Indicates that the rich edit control does not maintain formatting information.  \n  \n- `SF_RTF` Indicates that the rich edit control does maintain formatting information.  \n  \n### Remarks  \n The return value is based on the [m_bRTF](#cricheditdoc__m_brtf) data member. This function returns `SF_RTF` if `m_bRTF` is **TRUE**; otherwise, `SF_TEXT`.  \n  \n##  <a name=\"cricheditdoc__getview\"></a>  CRichEditDoc::GetView  \n Call this function to access the [CRichEditView](../../mfc/reference/cricheditview-class.md) object associated with this `CRichEditDoc` object.  \n  \n```  \nvirtual CRichEditView* GetView() const;\n\n \n```  \n  \n### Return Value  \n Pointer to the `CRichEditView` object associated with the document.  \n  \n### Remarks  \n The text and formatting information are contained within the `CRichEditView` object. The `CRichEditDoc` object maintains the OLE items for serialization. There should be only one `CRichEditView` for each `CRichEditDoc`.  \n  \n##  <a name=\"cricheditdoc__m_brtf\"></a>  CRichEditDoc::m_bRTF  \n When **TRUE**, indicates that [CRichEditCtrl::StreamIn](../../mfc/reference/cricheditctrl-class.md#cricheditctrl__streamin) and [CRichEditCtrl::StreamOut](../../mfc/reference/cricheditctrl-class.md#cricheditctrl__streamout) should store paragraph and character-formatting characteristics.  \n  \n```  \nBOOL m_bRTF;  \n```  \n  \n## See Also  \n [MFC Sample WORDPAD](../../visual-cpp-samples.md)   \n [COleServerDoc Class](../../mfc/reference/coleserverdoc-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CRichEditView Class](../../mfc/reference/cricheditview-class.md)   \n [CRichEditCntrItem Class](../../mfc/reference/cricheditcntritem-class.md)   \n [COleDocument Class](../../mfc/reference/coledocument-class.md)   \n [CRichEditCtrl Class](../../mfc/reference/cricheditctrl-class.md)\n"}