{"nodes":[{"pos":[12,47],"content":"OLE Initialization | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"OLE Initialization | Microsoft Docs","pos":[0,35]}]},{"pos":[613,631],"content":"OLE Initialization","linkify":"OLE Initialization","nodes":[{"content":"OLE Initialization","pos":[0,18]}]},{"content":"Before an application can use OLE system services, it must initialize the OLE system DLLs and verify that the DLLs are the correct version.","pos":[632,771]},{"content":"The <bpt id=\"p1\">**</bpt>AfxOleInit<ept id=\"p1\">**</ept> function initializes the OLE system DLLs.","pos":[772,832],"source":" The **AfxOleInit** function initializes the OLE system DLLs."},{"pos":[842,860],"content":"OLE Initialization","linkify":"OLE Initialization","nodes":[{"content":"OLE Initialization","pos":[0,18]}]},{"pos":[881,906],"content":"<bpt id=\"p1\">[</bpt>AfxOleInit<ept id=\"p1\">](#afxoleinit)</ept>","source":"[AfxOleInit](#afxoleinit)"},{"content":"Initializes the OLE libraries.","pos":[907,937]},{"pos":[948,985],"content":"<bpt id=\"p1\">&lt;a name=\"afxoleinit\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AfxOleInit","linkify":"<a name=\"afxoleinit\"></a>  AfxOleInit","source":"<a name=\"afxoleinit\"></a>  AfxOleInit"},{"content":"Initializes OLE support for the application.","pos":[989,1033]},{"pos":[1084,1096],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; 0 if initialization fails, possibly because incorrect versions of the OLE system DLLs are installed.","pos":[1100,1223]},{"pos":[1233,1240],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to initialize the OLE support for an MFC application.","pos":[1244,1316]},{"content":"When this function is called, the following actions occur:","pos":[1317,1375]},{"content":"Initializes the COM library on the current apartment of the calling application.","pos":[1385,1465]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>OleInitialize<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690134)</ept>.","pos":[1466,1568],"source":" For more information, see [OleInitialize](http://msdn.microsoft.com/library/windows/desktop/ms690134)."},{"content":"Creates a message filter object, implementing the <bpt id=\"p1\">[</bpt>IMessageFilter<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms693740)</ept> interface.","pos":[1578,1715],"source":"Creates a message filter object, implementing the [IMessageFilter](http://msdn.microsoft.com/library/windows/desktop/ms693740) interface."},{"content":"This message filter can be accessed with a call to <bpt id=\"p1\">[</bpt>AfxOleGetMessageFilter<ept id=\"p1\">](http://msdn.microsoft.com/library/36cca011-4775-4086-b471-5557a87b266c)</ept>.","pos":[1716,1864],"source":" This message filter can be accessed with a call to [AfxOleGetMessageFilter](http://msdn.microsoft.com/library/36cca011-4775-4086-b471-5557a87b266c)."},{"pos":[1872,2099],"content":"[!NOTE]\n If **AfxOleInit** is called from an MFC DLL, the call will fail. The failure occurs because the function assumes that, if it is called from a DLL, the OLE system was previously initialized by the calling application.","leadings":["","> "],"nodes":[{"content":" If **AfxOleInit** is called from an MFC DLL, the call will fail. The failure occurs because the function assumes that, if it is called from a DLL, the OLE system was previously initialized by the calling application.","pos":[8,225],"nodes":[{"content":"If <bpt id=\"p1\">**</bpt>AfxOleInit<ept id=\"p1\">**</ept> is called from an MFC DLL, the call will fail.","pos":[1,65],"source":" If **AfxOleInit** is called from an MFC DLL, the call will fail."},{"content":"The failure occurs because the function assumes that, if it is called from a DLL, the OLE system was previously initialized by the calling application.","pos":[66,217]}]}]},{"pos":[2107,2654],"content":"[!NOTE]\n MFC applications must be initialized as single threaded apartment (STA). If you call [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) in your `InitInstance` override, specify `COINIT_APARTMENTTHREADED` (rather than `COINIT_MULTITHREADED`). For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at [http://support.microsoft.com/default.aspxscid=kb;en-us;828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643).","leadings":["","> "],"nodes":[{"content":" MFC applications must be initialized as single threaded apartment (STA). If you call [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) in your `InitInstance` override, specify `COINIT_APARTMENTTHREADED` (rather than `COINIT_MULTITHREADED`). For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at [http://support.microsoft.com/default.aspxscid=kb;en-us;828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643).","pos":[8,545],"nodes":[{"content":"MFC applications must be initialized as single threaded apartment (STA).","pos":[1,73]},{"content":"If you call <bpt id=\"p1\">[</bpt>CoInitializeEx<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms695279)</ept> in your <ph id=\"ph1\">`InitInstance`</ph> override, specify <ph id=\"ph2\">`COINIT_APARTMENTTHREADED`</ph> (rather than <ph id=\"ph3\">`COINIT_MULTITHREADED`</ph>).","pos":[74,268],"source":" If you call [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) in your `InitInstance` override, specify `COINIT_APARTMENTTHREADED` (rather than `COINIT_MULTITHREADED`)."},{"content":"For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at <bpt id=\"p1\">[</bpt>http://support.microsoft.com/default.aspxscid=kb;en-us;828643<ept id=\"p1\">](http://support.microsoft.com/default.aspxscid=kb;en-us;828643)</ept>.","pos":[269,537],"source":" For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at [http://support.microsoft.com/default.aspxscid=kb;en-us;828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643)."}]}]},{"pos":[2663,2671],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2675,2742],"content":"<bpt id=\"p1\">[</bpt>Macros and Globals<ept id=\"p1\">](../../mfc/reference/mfc-macros-and-globals.md)</ept>","source":"[Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)"}],"content":"---\ntitle: \"OLE Initialization | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.mfc.macros.ole\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE initialization\"\nms.assetid: aa8a54a7-24c3-4344-b2c6-dbcf6084fa31\ncaps.latest.revision: 13\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# OLE Initialization\nBefore an application can use OLE system services, it must initialize the OLE system DLLs and verify that the DLLs are the correct version. The **AfxOleInit** function initializes the OLE system DLLs.  \n  \n### OLE Initialization  \n  \n|||  \n|-|-|  \n|[AfxOleInit](#afxoleinit)|Initializes the OLE libraries.|  \n  \n##  <a name=\"afxoleinit\"></a>  AfxOleInit  \n Initializes OLE support for the application.  \n  \n``` \nBOOL AFXAPI AfxOleInit(); \n```  \n  \n### Return Value  \n Nonzero if successful; 0 if initialization fails, possibly because incorrect versions of the OLE system DLLs are installed.  \n  \n### Remarks  \n Call this function to initialize the OLE support for an MFC application. When this function is called, the following actions occur:  \n  \n-   Initializes the COM library on the current apartment of the calling application. For more information, see [OleInitialize](http://msdn.microsoft.com/library/windows/desktop/ms690134).  \n  \n-   Creates a message filter object, implementing the [IMessageFilter](http://msdn.microsoft.com/library/windows/desktop/ms693740) interface. This message filter can be accessed with a call to [AfxOleGetMessageFilter](http://msdn.microsoft.com/library/36cca011-4775-4086-b471-5557a87b266c).  \n  \n> [!NOTE]\n>  If **AfxOleInit** is called from an MFC DLL, the call will fail. The failure occurs because the function assumes that, if it is called from a DLL, the OLE system was previously initialized by the calling application.  \n  \n> [!NOTE]\n>  MFC applications must be initialized as single threaded apartment (STA). If you call [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) in your `InitInstance` override, specify `COINIT_APARTMENTTHREADED` (rather than `COINIT_MULTITHREADED`). For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at [http://support.microsoft.com/default.aspxscid=kb;en-us;828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643).  \n  \n## See Also  \n [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)\n"}