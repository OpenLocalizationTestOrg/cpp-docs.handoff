{"nodes":[{"pos":[12,41],"content":"CMutex Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMutex Class | Microsoft Docs","pos":[0,29]}]},{"pos":[697,709],"content":"CMutex Class","linkify":"CMutex Class","nodes":[{"content":"CMutex Class","pos":[0,12]}]},{"content":"Represents a \"mutex\" — a synchronization object that allows one thread mutually exclusive access to a resource.","pos":[710,821]},{"pos":[830,836],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[896,903],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[913,932],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[939,943]},{"content":"Description","pos":[944,955]},{"pos":[993,1026],"content":"<bpt id=\"p1\">[</bpt>CMutex::CMutex<ept id=\"p1\">](#cmutex__cmutex)</ept>","source":"[CMutex::CMutex](#cmutex__cmutex)"},{"pos":[1027,1056],"content":"Constructs a <ph id=\"ph1\">`CMutex`</ph> object.","source":"Constructs a `CMutex` object."},{"pos":[1066,1073],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Mutexes are useful when only one thread at a time can be allowed to modify data or some other controlled resource.","pos":[1077,1191]},{"content":"For example, adding nodes to a linked list is a process that should only be allowed by one thread at a time.","pos":[1192,1300]},{"content":"By using a <ph id=\"ph1\">`CMutex`</ph> object to control the linked list, only one thread at a time can gain access to the list.","pos":[1301,1410],"source":" By using a `CMutex` object to control the linked list, only one thread at a time can gain access to the list."},{"content":"To use a <ph id=\"ph1\">`CMutex`</ph> object, construct the <ph id=\"ph2\">`CMutex`</ph> object when it is needed.","pos":[1417,1491],"source":"To use a `CMutex` object, construct the `CMutex` object when it is needed."},{"content":"Specify the name of the mutex you wish to wait on, and that your application should initially own it.","pos":[1492,1593]},{"content":"You can then access the mutex when the constructor returns.","pos":[1594,1653]},{"content":"Call <bpt id=\"p1\">[</bpt>CSyncObject::Unlock<ept id=\"p1\">](../../mfc/reference/csyncobject-class.md#csyncobject__unlock)</ept> when you are done accessing the controlled resource.","pos":[1654,1795],"source":" Call [CSyncObject::Unlock](../../mfc/reference/csyncobject-class.md#csyncobject__unlock) when you are done accessing the controlled resource."},{"content":"An alternative method for using <ph id=\"ph1\">`CMutex`</ph> objects is to add a variable of type <ph id=\"ph2\">`CMutex`</ph> as a data member to the class you wish to control.","pos":[1802,1939],"source":"An alternative method for using `CMutex` objects is to add a variable of type `CMutex` as a data member to the class you wish to control."},{"content":"During construction of the controlled object, call the constructor of the <ph id=\"ph1\">`CMutex`</ph> data member specifying if the mutex is initially owned, the name of the mutex (if it will be used across process boundaries), and desired security attributes.","pos":[1940,2181],"source":" During construction of the controlled object, call the constructor of the `CMutex` data member specifying if the mutex is initially owned, the name of the mutex (if it will be used across process boundaries), and desired security attributes."},{"content":"To access resources controlled by <ph id=\"ph1\">`CMutex`</ph> objects in this manner, first create a variable of either type <bpt id=\"p1\">[</bpt>CSingleLock<ept id=\"p1\">](../../mfc/reference/csinglelock-class.md)</ept> or type <bpt id=\"p2\">[</bpt>CMultiLock<ept id=\"p2\">](../../mfc/reference/cmultilock-class.md)</ept> in your resource's access member function.","pos":[2188,2454],"source":"To access resources controlled by `CMutex` objects in this manner, first create a variable of either type [CSingleLock](../../mfc/reference/csinglelock-class.md) or type [CMultiLock](../../mfc/reference/cmultilock-class.md) in your resource's access member function."},{"content":"Then call the lock object's <ph id=\"ph1\">`Lock`</ph> member function (for example, <bpt id=\"p1\">[</bpt>CSingleLock::Lock<ept id=\"p1\">](../../mfc/reference/csinglelock-class.md#csinglelock__lock)</ept>).","pos":[2455,2601],"source":" Then call the lock object's `Lock` member function (for example, [CSingleLock::Lock](../../mfc/reference/csinglelock-class.md#csinglelock__lock))."},{"content":"At this point, your thread will either gain access to the resource, wait for the resource to be released and gain access, or wait for the resource to be released and time out, failing to gain access to the resource.","pos":[2602,2817]},{"content":"In any case, your resource has been accessed in a thread-safe manner.","pos":[2818,2887]},{"content":"To release the resource, use the lock object's <ph id=\"ph1\">`Unlock`</ph> member function (for example, <bpt id=\"p1\">[</bpt>CSingleLock::Unlock<ept id=\"p1\">](../../mfc/reference/csinglelock-class.md#csinglelock__unlock)</ept>), or allow the lock object to fall out of scope.","pos":[2888,3106],"source":" To release the resource, use the lock object's `Unlock` member function (for example, [CSingleLock::Unlock](../../mfc/reference/csinglelock-class.md#csinglelock__unlock)), or allow the lock object to fall out of scope."},{"pos":[3113,3307],"content":"For more information on using <ph id=\"ph1\">`CMutex`</ph> objects, see the article <bpt id=\"p1\">[</bpt>Multithreading: How to Use the Synchronization Classes<ept id=\"p1\">](../../parallel/multithreading-how-to-use-the-synchronization-classes.md)</ept>.","source":"For more information on using `CMutex` objects, see the article [Multithreading: How to Use the Synchronization Classes](../../parallel/multithreading-how-to-use-the-synchronization-classes.md)."},{"pos":[3316,3337],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3341,3388],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[3395,3450],"content":"<bpt id=\"p1\">[</bpt>CSyncObject<ept id=\"p1\">](../../mfc/reference/csyncobject-class.md)</ept>","source":"[CSyncObject](../../mfc/reference/csyncobject-class.md)"},{"pos":[3474,3486],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3490,3509],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxmt.h","source":"**Header:** afxmt.h"},{"pos":[3519,3564],"content":"<bpt id=\"p1\">&lt;a name=\"cmutex__cmutex\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMutex::CMutex","linkify":"<a name=\"cmutex__cmutex\"></a>  CMutex::CMutex","source":"<a name=\"cmutex__cmutex\"></a>  CMutex::CMutex"},{"pos":[3568,3614],"content":"Constructs a named or unnamed <ph id=\"ph1\">`CMutex`</ph> object.","source":"Constructs a named or unnamed `CMutex` object."},{"pos":[3761,3771],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies if the thread creating the <ph id=\"ph1\">`CMutex`</ph> object initially has access to the resource controlled by the mutex.","pos":[3794,3908],"source":" Specifies if the thread creating the `CMutex` object initially has access to the resource controlled by the mutex."},{"content":"Name of the <ph id=\"ph1\">`CMutex`</ph> object.","pos":[3929,3957],"source":" Name of the `CMutex` object."},{"content":"If another mutex with the same name exists, <ph id=\"ph1\">`lpszName`</ph> must be supplied if the object will be used across process boundaries.","pos":[3958,4083],"source":" If another mutex with the same name exists, `lpszName` must be supplied if the object will be used across process boundaries."},{"content":"If <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the mutex will be unnamed.","pos":[4084,4123],"source":" If **NULL**, the mutex will be unnamed."},{"content":"If the name matches an existing mutex, the constructor builds a new <ph id=\"ph1\">`CMutex`</ph> object which references the mutex of that name.","pos":[4124,4248],"source":" If the name matches an existing mutex, the constructor builds a new `CMutex` object which references the mutex of that name."},{"content":"If the name matches an existing synchronization object that is not a mutex, the construction will fail.","pos":[4249,4352]},{"content":"Security attributes for the mutex object.","pos":[4378,4419]},{"content":"For a full description of this structure, see <bpt id=\"p1\">[</bpt>SECURITY_ATTRIBUTES<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa379560)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[4420,4607],"source":" For a full description of this structure, see [SECURITY_ATTRIBUTES](http://msdn.microsoft.com/library/windows/desktop/aa379560) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4617,4624],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"To access or release a <ph id=\"ph1\">`CMutex`</ph> object, create a <bpt id=\"p1\">[</bpt>CMultiLock<ept id=\"p1\">](../../mfc/reference/cmultilock-class.md)</ept> or <bpt id=\"p2\">[</bpt>CSingleLock<ept id=\"p2\">](../../mfc/reference/csinglelock-class.md)</ept> object and call its <bpt id=\"p3\">[</bpt>Lock<ept id=\"p3\">](../../mfc/reference/csinglelock-class.md#csinglelock__lock)</ept> and <bpt id=\"p4\">[</bpt>Unlock<ept id=\"p4\">](../../mfc/reference/csinglelock-class.md#csinglelock__unlock)</ept> member functions.","pos":[4628,4969],"source":"To access or release a `CMutex` object, create a [CMultiLock](../../mfc/reference/cmultilock-class.md) or [CSingleLock](../../mfc/reference/csinglelock-class.md) object and call its [Lock](../../mfc/reference/csinglelock-class.md#csinglelock__lock) and [Unlock](../../mfc/reference/csinglelock-class.md#csinglelock__unlock) member functions."},{"content":"If the <ph id=\"ph1\">`CMutex`</ph> object is being used stand-alone, call its <ph id=\"ph2\">`Unlock`</ph> member function to release it.","pos":[4970,5068],"source":" If the `CMutex` object is being used stand-alone, call its `Unlock` member function to release it."},{"pos":[5076,5532],"content":"[!IMPORTANT]\n After creating the `CMutex` object, use [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) to ensure that the mutex did not already exist. If the mutex did exist unexpectedly, it may indicate a rogue process is squatting and may be intending to use the mutex maliciously. In this case, the recommended security-conscious procedure is to close the handle and continue as if there was a failure in creating the object.","leadings":["","> "],"nodes":[{"content":" After creating the `CMutex` object, use [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) to ensure that the mutex did not already exist. If the mutex did exist unexpectedly, it may indicate a rogue process is squatting and may be intending to use the mutex maliciously. In this case, the recommended security-conscious procedure is to close the handle and continue as if there was a failure in creating the object.","pos":[13,454],"nodes":[{"content":"After creating the <ph id=\"ph1\">`CMutex`</ph> object, use <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> to ensure that the mutex did not already exist.","pos":[1,163],"source":" After creating the `CMutex` object, use [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) to ensure that the mutex did not already exist."},{"content":"If the mutex did exist unexpectedly, it may indicate a rogue process is squatting and may be intending to use the mutex maliciously.","pos":[164,296]},{"content":"In this case, the recommended security-conscious procedure is to close the handle and continue as if there was a failure in creating the object.","pos":[297,441]}]}]},{"pos":[5541,5549],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CSyncObject Class<ept id=\"p1\">](../../mfc/reference/csyncobject-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[5553,5615],"source":"[CSyncObject Class](../../mfc/reference/csyncobject-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept>","pos":[5618,5666],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md)"}],"content":"---\ntitle: \"CMutex Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"Mutex\"\n  - \"CMutex\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMutex class\"\n  - \"synchronization classes, CMutex class\"\n  - \"synchronization objects, mutex\"\n  - \"mutex\"\nms.assetid: 6330c050-4f01-4195-a099-2029b92f8cf1\ncaps.latest.revision: 22\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMutex Class\nRepresents a \"mutex\" — a synchronization object that allows one thread mutually exclusive access to a resource.  \n  \n## Syntax  \n  \n```  \nclass CMutex : public CSyncObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMutex::CMutex](#cmutex__cmutex)|Constructs a `CMutex` object.|  \n  \n## Remarks  \n Mutexes are useful when only one thread at a time can be allowed to modify data or some other controlled resource. For example, adding nodes to a linked list is a process that should only be allowed by one thread at a time. By using a `CMutex` object to control the linked list, only one thread at a time can gain access to the list.  \n  \n To use a `CMutex` object, construct the `CMutex` object when it is needed. Specify the name of the mutex you wish to wait on, and that your application should initially own it. You can then access the mutex when the constructor returns. Call [CSyncObject::Unlock](../../mfc/reference/csyncobject-class.md#csyncobject__unlock) when you are done accessing the controlled resource.  \n  \n An alternative method for using `CMutex` objects is to add a variable of type `CMutex` as a data member to the class you wish to control. During construction of the controlled object, call the constructor of the `CMutex` data member specifying if the mutex is initially owned, the name of the mutex (if it will be used across process boundaries), and desired security attributes.  \n  \n To access resources controlled by `CMutex` objects in this manner, first create a variable of either type [CSingleLock](../../mfc/reference/csinglelock-class.md) or type [CMultiLock](../../mfc/reference/cmultilock-class.md) in your resource's access member function. Then call the lock object's `Lock` member function (for example, [CSingleLock::Lock](../../mfc/reference/csinglelock-class.md#csinglelock__lock)). At this point, your thread will either gain access to the resource, wait for the resource to be released and gain access, or wait for the resource to be released and time out, failing to gain access to the resource. In any case, your resource has been accessed in a thread-safe manner. To release the resource, use the lock object's `Unlock` member function (for example, [CSingleLock::Unlock](../../mfc/reference/csinglelock-class.md#csinglelock__unlock)), or allow the lock object to fall out of scope.  \n  \n For more information on using `CMutex` objects, see the article [Multithreading: How to Use the Synchronization Classes](../../parallel/multithreading-how-to-use-the-synchronization-classes.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CSyncObject](../../mfc/reference/csyncobject-class.md)  \n  \n `CMutex`  \n  \n## Requirements  \n **Header:** afxmt.h  \n  \n##  <a name=\"cmutex__cmutex\"></a>  CMutex::CMutex  \n Constructs a named or unnamed `CMutex` object.  \n  \n```  \nCMutex(\n    BOOL bInitiallyOwn = FALSE,  \n    LPCTSTR lpszName = NULL,  \n    LPSECURITY_ATTRIBUTES lpsaAttribute = NULL);\n```  \n  \n### Parameters  \n `bInitiallyOwn`  \n Specifies if the thread creating the `CMutex` object initially has access to the resource controlled by the mutex.  \n  \n `lpszName`  \n Name of the `CMutex` object. If another mutex with the same name exists, `lpszName` must be supplied if the object will be used across process boundaries. If **NULL**, the mutex will be unnamed. If the name matches an existing mutex, the constructor builds a new `CMutex` object which references the mutex of that name. If the name matches an existing synchronization object that is not a mutex, the construction will fail.  \n  \n `lpsaAttribute`  \n Security attributes for the mutex object. For a full description of this structure, see [SECURITY_ATTRIBUTES](http://msdn.microsoft.com/library/windows/desktop/aa379560) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Remarks  \n To access or release a `CMutex` object, create a [CMultiLock](../../mfc/reference/cmultilock-class.md) or [CSingleLock](../../mfc/reference/csinglelock-class.md) object and call its [Lock](../../mfc/reference/csinglelock-class.md#csinglelock__lock) and [Unlock](../../mfc/reference/csinglelock-class.md#csinglelock__unlock) member functions. If the `CMutex` object is being used stand-alone, call its `Unlock` member function to release it.  \n  \n> [!IMPORTANT]\n>  After creating the `CMutex` object, use [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) to ensure that the mutex did not already exist. If the mutex did exist unexpectedly, it may indicate a rogue process is squatting and may be intending to use the mutex maliciously. In this case, the recommended security-conscious procedure is to close the handle and continue as if there was a failure in creating the object.  \n  \n## See Also  \n [CSyncObject Class](../../mfc/reference/csyncobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n\n\n"}