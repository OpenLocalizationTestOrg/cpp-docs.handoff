{"nodes":[{"pos":[12,65],"content":"Accessing Run-Time Class Information | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Accessing Run-Time Class Information | Microsoft Docs","pos":[0,53]}]},{"content":"Accessing Run-Time Class Information","pos":[1023,1059]},{"content":"This article explains how to access information about the class of an object at run time.","pos":[1060,1149]},{"pos":[1157,1298],"content":"[!NOTE]\n MFC does not use the [Run-Time Type Information](../cpp/run-time-type-information.md) (RTTI) support introduced in Visual C++ 4.0.","leadings":["","> "],"nodes":[{"content":"MFC does not use the <bpt id=\"p1\">[</bpt>Run-Time Type Information<ept id=\"p1\">](../cpp/run-time-type-information.md)</ept> (RTTI) support introduced in Visual C++ 4.0.","pos":[9,139],"source":" MFC does not use the [Run-Time Type Information](../cpp/run-time-type-information.md) (RTTI) support introduced in Visual C++ 4.0."}]},{"pos":[1305,1742],"content":"If you have derived your class from <bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../mfc/reference/cobject-class.md)</ept> and used the <bpt id=\"p2\">**</bpt>DECLARE<ept id=\"p2\">**</ept>_<bpt id=\"p3\">**</bpt>DYNAMIC<ept id=\"p3\">**</ept> and <ph id=\"ph1\">`IMPLEMENT_DYNAMIC`</ph>, the <ph id=\"ph2\">`DECLARE_DYNCREATE`</ph> and <ph id=\"ph3\">`IMPLEMENT_DYNCREATE`</ph>, or the <ph id=\"ph4\">`DECLARE_SERIAL`</ph> and <ph id=\"ph5\">`IMPLEMENT_SERIAL`</ph> macros explained in the article <bpt id=\"p4\">[</bpt>Deriving a Class from CObject<ept id=\"p4\">](../mfc/deriving-a-class-from-cobject.md)</ept>, the <ph id=\"ph6\">`CObject`</ph> class has the ability to determine the exact class of an object at run time.","source":"If you have derived your class from [CObject](../mfc/reference/cobject-class.md) and used the **DECLARE**_**DYNAMIC** and `IMPLEMENT_DYNAMIC`, the `DECLARE_DYNCREATE` and `IMPLEMENT_DYNCREATE`, or the `DECLARE_SERIAL` and `IMPLEMENT_SERIAL` macros explained in the article [Deriving a Class from CObject](../mfc/deriving-a-class-from-cobject.md), the `CObject` class has the ability to determine the exact class of an object at run time."},{"content":"This ability is most useful when extra type checking of function arguments is needed and when you must write special-purpose code based on the class of an object.","pos":[1749,1911]},{"content":"However, this practice is not usually recommended because it duplicates the functionality of virtual functions.","pos":[1912,2023]},{"content":"The <ph id=\"ph1\">`CObject`</ph> member function <ph id=\"ph2\">`IsKindOf`</ph> can be used to determine if a particular object belongs to a specified class or if it is derived from a specific class.","pos":[2030,2190],"source":"The `CObject` member function `IsKindOf` can be used to determine if a particular object belongs to a specified class or if it is derived from a specific class."},{"content":"The argument to <ph id=\"ph1\">`IsKindOf`</ph> is a <ph id=\"ph2\">`CRuntimeClass`</ph> object, which you can get using the <ph id=\"ph3\">`RUNTIME_CLASS`</ph> macro with the name of the class.","pos":[2191,2324],"source":" The argument to `IsKindOf` is a `CRuntimeClass` object, which you can get using the `RUNTIME_CLASS` macro with the name of the class."},{"content":"To use the RUNTIME_CLASS macro","pos":[2334,2364]},{"pos":[2374,2460],"content":"Use <ph id=\"ph1\">`RUNTIME_CLASS`</ph> with the name of the class, as shown here for the class <ph id=\"ph2\">`CObject`</ph>:","source":"Use `RUNTIME_CLASS` with the name of the class, as shown here for the class `CObject`:"},{"pos":[2482,2504],"content":"NVC_MFCCObjectSample#4"},{"content":"You will rarely need to access the run-time class object directly.","pos":[2580,2646]},{"content":"A more common use is to pass the run-time class object to the <ph id=\"ph1\">`IsKindOf`</ph> function, as shown in the next procedure.","pos":[2647,2761],"source":" A more common use is to pass the run-time class object to the `IsKindOf` function, as shown in the next procedure."},{"content":"The <ph id=\"ph1\">`IsKindOf`</ph> function tests an object to see if it belongs to a particular class.","pos":[2762,2845],"source":" The `IsKindOf` function tests an object to see if it belongs to a particular class."},{"content":"To use the IsKindOf function","pos":[2856,2884]},{"content":"Make sure the class has run-time class support.","pos":[2894,2941]},{"content":"That is, the class must have been derived directly or indirectly from <ph id=\"ph1\">`CObject`</ph> and used the <bpt id=\"p1\">**</bpt>DECLARE<ept id=\"p1\">**</ept>_<bpt id=\"p2\">**</bpt>DYNAMIC<ept id=\"p2\">**</ept> and <ph id=\"ph2\">`IMPLEMENT_DYNAMIC`</ph>, the <ph id=\"ph3\">`DECLARE_DYNCREATE`</ph> and <ph id=\"ph4\">`IMPLEMENT_DYNCREATE`</ph>, or the <ph id=\"ph5\">`DECLARE_SERIAL`</ph> and <ph id=\"ph6\">`IMPLEMENT_SERIAL`</ph> macros explained in the article <bpt id=\"p3\">[</bpt>Deriving a Class from CObject<ept id=\"p3\">](../mfc/deriving-a-class-from-cobject.md)</ept>.","pos":[2942,3287],"source":" That is, the class must have been derived directly or indirectly from `CObject` and used the **DECLARE**_**DYNAMIC** and `IMPLEMENT_DYNAMIC`, the `DECLARE_DYNCREATE` and `IMPLEMENT_DYNCREATE`, or the `DECLARE_SERIAL` and `IMPLEMENT_SERIAL` macros explained in the article [Deriving a Class from CObject](../mfc/deriving-a-class-from-cobject.md)."},{"pos":[3297,3448],"content":"Call the <ph id=\"ph1\">`IsKindOf`</ph> member function for objects of that class, using the <ph id=\"ph2\">`RUNTIME_CLASS`</ph> macro to generate the <ph id=\"ph3\">`CRuntimeClass`</ph> argument, as shown here:","source":"Call the `IsKindOf` member function for objects of that class, using the `RUNTIME_CLASS` macro to generate the `CRuntimeClass` argument, as shown here:"},{"pos":[3470,3492],"content":"NVC_MFCCObjectSample#2"},{"pos":[3581,3603],"content":"NVC_MFCCObjectSample#5"},{"pos":[3684,3997],"content":"[!NOTE]\n IsKindOf returns **TRUE** if the object is a member of the specified class or of a class derived from the specified class. `IsKindOf` does not support multiple inheritance or virtual base classes, although you can use multiple inheritance for your derived Microsoft Foundation classes if necessary.","leadings":["","    > "],"nodes":[{"content":" IsKindOf returns **TRUE** if the object is a member of the specified class or of a class derived from the specified class. `IsKindOf` does not support multiple inheritance or virtual base classes, although you can use multiple inheritance for your derived Microsoft Foundation classes if necessary.","pos":[8,307],"nodes":[{"content":"IsKindOf returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if the object is a member of the specified class or of a class derived from the specified class.","pos":[1,123],"source":" IsKindOf returns **TRUE** if the object is a member of the specified class or of a class derived from the specified class."},{"content":"does not support multiple inheritance or virtual base classes, although you can use multiple inheritance for your derived Microsoft Foundation classes if necessary.","pos":[135,299]}]}]},{"content":"One use of run-time class information is in the dynamic creation of objects.","pos":[4004,4080]},{"content":"This process is discussed in the article <bpt id=\"p1\">[</bpt>Dynamic Object Creation<ept id=\"p1\">](../mfc/dynamic-object-creation.md)</ept>.","pos":[4081,4183],"source":" This process is discussed in the article [Dynamic Object Creation](../mfc/dynamic-object-creation.md)."},{"pos":[4190,4377],"content":"For more detailed information on serialization and run-time class information, see the articles <bpt id=\"p1\">[</bpt>Files in MFC<ept id=\"p1\">](../mfc/files-in-mfc.md)</ept> and <bpt id=\"p2\">[</bpt>Serialization<ept id=\"p2\">](../mfc/serialization-in-mfc.md)</ept>.","source":"For more detailed information on serialization and run-time class information, see the articles [Files in MFC](../mfc/files-in-mfc.md) and [Serialization](../mfc/serialization-in-mfc.md)."},{"content":"See Also","pos":[4386,4394]},{"content":"Using CObject","pos":[4399,4412]}],"content":"---\ntitle: \"Accessing Run-Time Class Information | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CObject class, and RTTI\"\n  - \"CObject class, using IsKindOf method\"\n  - \"run time, class information\"\n  - \"RUNTIME_CLASS macro\"\n  - \"CObject class, using RUNTIME_CLASS macro\"\n  - \"RTTI compiler option\"\n  - \"CObject class, accessing run-time class information\"\n  - \"run time\"\n  - \"IsKindOf method method\"\n  - \"run-time class, accessing information\"\n  - \"classes [C++], run-time class information\"\n  - \"run-time class\"\n  - \"RUNTIME_CLASS macro, using\"\nms.assetid: 3445a9af-0bd6-4496-95c3-aa59b964570b\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Accessing Run-Time Class Information\nThis article explains how to access information about the class of an object at run time.  \n  \n> [!NOTE]\n>  MFC does not use the [Run-Time Type Information](../cpp/run-time-type-information.md) (RTTI) support introduced in Visual C++ 4.0.  \n  \n If you have derived your class from [CObject](../mfc/reference/cobject-class.md) and used the **DECLARE**_**DYNAMIC** and `IMPLEMENT_DYNAMIC`, the `DECLARE_DYNCREATE` and `IMPLEMENT_DYNCREATE`, or the `DECLARE_SERIAL` and `IMPLEMENT_SERIAL` macros explained in the article [Deriving a Class from CObject](../mfc/deriving-a-class-from-cobject.md), the `CObject` class has the ability to determine the exact class of an object at run time.  \n  \n This ability is most useful when extra type checking of function arguments is needed and when you must write special-purpose code based on the class of an object. However, this practice is not usually recommended because it duplicates the functionality of virtual functions.  \n  \n The `CObject` member function `IsKindOf` can be used to determine if a particular object belongs to a specified class or if it is derived from a specific class. The argument to `IsKindOf` is a `CRuntimeClass` object, which you can get using the `RUNTIME_CLASS` macro with the name of the class.  \n  \n### To use the RUNTIME_CLASS macro  \n  \n1.  Use `RUNTIME_CLASS` with the name of the class, as shown here for the class `CObject`:  \n  \n     [!code-cpp[NVC_MFCCObjectSample#4](../mfc/codesnippet/cpp/accessing-run-time-class-information_1.cpp)]  \n  \n You will rarely need to access the run-time class object directly. A more common use is to pass the run-time class object to the `IsKindOf` function, as shown in the next procedure. The `IsKindOf` function tests an object to see if it belongs to a particular class.  \n  \n#### To use the IsKindOf function  \n  \n1.  Make sure the class has run-time class support. That is, the class must have been derived directly or indirectly from `CObject` and used the **DECLARE**_**DYNAMIC** and `IMPLEMENT_DYNAMIC`, the `DECLARE_DYNCREATE` and `IMPLEMENT_DYNCREATE`, or the `DECLARE_SERIAL` and `IMPLEMENT_SERIAL` macros explained in the article [Deriving a Class from CObject](../mfc/deriving-a-class-from-cobject.md).  \n  \n2.  Call the `IsKindOf` member function for objects of that class, using the `RUNTIME_CLASS` macro to generate the `CRuntimeClass` argument, as shown here:  \n  \n     [!code-cpp[NVC_MFCCObjectSample#2](../mfc/codesnippet/cpp/accessing-run-time-class-information_2.h)]  \n  \n     [!code-cpp[NVC_MFCCObjectSample#5](../mfc/codesnippet/cpp/accessing-run-time-class-information_3.cpp)]  \n  \n    > [!NOTE]\n    >  IsKindOf returns **TRUE** if the object is a member of the specified class or of a class derived from the specified class. `IsKindOf` does not support multiple inheritance or virtual base classes, although you can use multiple inheritance for your derived Microsoft Foundation classes if necessary.  \n  \n One use of run-time class information is in the dynamic creation of objects. This process is discussed in the article [Dynamic Object Creation](../mfc/dynamic-object-creation.md).  \n  \n For more detailed information on serialization and run-time class information, see the articles [Files in MFC](../mfc/files-in-mfc.md) and [Serialization](../mfc/serialization-in-mfc.md).  \n  \n## See Also  \n [Using CObject](../mfc/using-cobject.md)\n\n"}