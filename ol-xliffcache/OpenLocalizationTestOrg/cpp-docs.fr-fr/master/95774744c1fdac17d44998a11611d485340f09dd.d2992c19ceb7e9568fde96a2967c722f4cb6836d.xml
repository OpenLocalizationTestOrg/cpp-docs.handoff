{"nodes":[{"pos":[12,50],"content":"marshal_context Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"marshal_context Class | Microsoft Docs","pos":[0,38]}]},{"content":"marshal_context Class","pos":[625,646]},{"content":"This class converts data between native and managed environments.","pos":[647,712]},{"content":"Syntax","pos":[721,727]},{"content":"Remarks","pos":[775,782]},{"content":"Use the <ph id=\"ph1\">`marshal_context`</ph> class for data conversions that require a context.","pos":[786,862],"source":"Use the `marshal_context` class for data conversions that require a context."},{"content":"See <bpt id=\"p1\">[</bpt>Overview of Marshaling in C++<ept id=\"p1\">](../dotnet/overview-of-marshaling-in-cpp.md)</ept> for more information about which conversions require a context and which marshaling file has to be included.","pos":[863,1051],"source":" See [Overview of Marshaling in C++](../dotnet/overview-of-marshaling-in-cpp.md) for more information about which conversions require a context and which marshaling file has to be included."},{"content":"The result of marshaling when you use a context is valid only until the <ph id=\"ph1\">`marshal_context`</ph> object is destroyed.","pos":[1052,1162],"source":" The result of marshaling when you use a context is valid only until the `marshal_context` object is destroyed."},{"content":"To preserve your result, you must copy the data.","pos":[1163,1211]},{"content":"The same <ph id=\"ph1\">`marshal_context`</ph> can be used for multiple data conversions.","pos":[1218,1287],"source":"The same `marshal_context` can be used for multiple data conversions."},{"content":"Reusing the context in this manner will not affect the results from previous marshaling calls.","pos":[1288,1382]},{"content":"Requirements","pos":[1391,1403]},{"pos":[1407,1524],"content":"<bpt id=\"p1\">**</bpt>Header file:<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\&lt;</ph>msclr\\marshal.h&gt;, <ph id=\"ph2\">\\&lt;</ph>msclr\\marshal_windows.h&gt;, <ph id=\"ph3\">\\&lt;</ph>msclr\\marshal_cppstd.h&gt;, or <ph id=\"ph4\">\\&lt;</ph>msclr\\marshal_atl.h&gt;","source":"**Header file:** \\<msclr\\marshal.h>, \\<msclr\\marshal_windows.h>, \\<msclr\\marshal_cppstd.h>, or \\<msclr\\marshal_atl.h>"},{"pos":[1531,1560],"content":"<bpt id=\"p1\">**</bpt>Namespace:<ept id=\"p1\">**</ept> msclr::interop","source":"**Namespace:** msclr::interop"},{"content":"See Also","pos":[1569,1577]},{"content":"Overview of Marshaling in C++","pos":[1582,1611]},{"content":"marshal_as","pos":[1662,1672]}],"content":"---\ntitle: \"marshal_context Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"marshal_context\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"marshal_context class [C++]\"\nms.assetid: 241b0cf6-4ca4-4812-aaee-d671c11dc034\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# marshal_context Class\nThis class converts data between native and managed environments.  \n  \n## Syntax  \n  \n```  \nclass marshal_context  \n```  \n  \n## Remarks  \n Use the `marshal_context` class for data conversions that require a context. See [Overview of Marshaling in C++](../dotnet/overview-of-marshaling-in-cpp.md) for more information about which conversions require a context and which marshaling file has to be included. The result of marshaling when you use a context is valid only until the `marshal_context` object is destroyed. To preserve your result, you must copy the data.  \n  \n The same `marshal_context` can be used for multiple data conversions. Reusing the context in this manner will not affect the results from previous marshaling calls.  \n  \n## Requirements  \n **Header file:** \\<msclr\\marshal.h>, \\<msclr\\marshal_windows.h>, \\<msclr\\marshal_cppstd.h>, or \\<msclr\\marshal_atl.h>  \n  \n **Namespace:** msclr::interop  \n  \n## See Also  \n [Overview of Marshaling in C++](../dotnet/overview-of-marshaling-in-cpp.md)   \n [marshal_as](../dotnet/marshal-as.md)"}