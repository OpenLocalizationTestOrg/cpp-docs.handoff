{"nodes":[{"pos":[12,51],"content":"COleInsertDialog Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleInsertDialog Class | Microsoft Docs","pos":[0,39]}]},{"pos":[712,734],"content":"COleInsertDialog Class","linkify":"COleInsertDialog Class","nodes":[{"content":"COleInsertDialog Class","pos":[0,22]}]},{"content":"Used for the OLE Insert Object dialog box.","pos":[735,777]},{"pos":[786,792],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[861,868],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[878,897],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[904,908]},{"content":"Description","pos":[909,920]},{"pos":[958,1031],"content":"<bpt id=\"p1\">[</bpt>COleInsertDialog::COleInsertDialog<ept id=\"p1\">](#coleinsertdialog__coleinsertdialog)</ept>","source":"[COleInsertDialog::COleInsertDialog](#coleinsertdialog__coleinsertdialog)"},{"pos":[1032,1071],"content":"Constructs a <ph id=\"ph1\">`COleInsertDialog`</ph> object.","source":"Constructs a `COleInsertDialog` object."},{"pos":[1082,1096],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1103,1107]},{"content":"Description","pos":[1108,1119]},{"pos":[1157,1218],"content":"<bpt id=\"p1\">[</bpt>COleInsertDialog::CreateItem<ept id=\"p1\">](#coleinsertdialog__createitem)</ept>","source":"[COleInsertDialog::CreateItem](#coleinsertdialog__createitem)"},{"content":"Creates the item selected in the dialog box.","pos":[1219,1263]},{"pos":[1268,1323],"content":"<bpt id=\"p1\">[</bpt>COleInsertDialog::DoModal<ept id=\"p1\">](#coleinsertdialog__domodal)</ept>","source":"[COleInsertDialog::DoModal](#coleinsertdialog__domodal)"},{"content":"Displays the OLE Insert Object dialog box.","pos":[1324,1366]},{"pos":[1371,1432],"content":"<bpt id=\"p1\">[</bpt>COleInsertDialog::GetClassID<ept id=\"p1\">](#coleinsertdialog__getclassid)</ept>","source":"[COleInsertDialog::GetClassID](#coleinsertdialog__getclassid)"},{"pos":[1433,1484],"content":"Gets the <bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept> associated with the chosen item.","source":"Gets the **CLSID** associated with the chosen item."},{"pos":[1489,1556],"content":"<bpt id=\"p1\">[</bpt>COleInsertDialog::GetDrawAspect<ept id=\"p1\">](#coleinsertdialog__getdrawaspect)</ept>","source":"[COleInsertDialog::GetDrawAspect](#coleinsertdialog__getdrawaspect)"},{"content":"Tells whether to draw the item as an icon.","pos":[1557,1599]},{"pos":[1604,1679],"content":"<bpt id=\"p1\">[</bpt>COleInsertDialog::GetIconicMetafile<ept id=\"p1\">](#coleinsertdialog__geticonicmetafile)</ept>","source":"[COleInsertDialog::GetIconicMetafile](#coleinsertdialog__geticonicmetafile)"},{"content":"Gets a handle to the metafile associated with the iconic form of this item.","pos":[1680,1755]},{"pos":[1760,1823],"content":"<bpt id=\"p1\">[</bpt>COleInsertDialog::GetPathName<ept id=\"p1\">](#coleinsertdialog__getpathname)</ept>","source":"[COleInsertDialog::GetPathName](#coleinsertdialog__getpathname)"},{"content":"Gets the full path to the file chosen in the dialog box.","pos":[1824,1880]},{"pos":[1885,1958],"content":"<bpt id=\"p1\">[</bpt>COleInsertDialog::GetSelectionType<ept id=\"p1\">](#coleinsertdialog__getselectiontype)</ept>","source":"[COleInsertDialog::GetSelectionType](#coleinsertdialog__getselectiontype)"},{"content":"Gets the type of object selected.","pos":[1959,1992]},{"pos":[2003,2022],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[2029,2033]},{"content":"Description","pos":[2034,2045]},{"pos":[2083,2132],"content":"<bpt id=\"p1\">[</bpt>COleInsertDialog::m_io<ept id=\"p1\">](#coleinsertdialog__m_io)</ept>","source":"[COleInsertDialog::m_io](#coleinsertdialog__m_io)"},{"pos":[2133,2220],"content":"A structure of type <bpt id=\"p1\">**</bpt>OLEUIINSERTOBJECT<ept id=\"p1\">**</ept> that controls the behavior of the dialog box.","source":"A structure of type **OLEUIINSERTOBJECT** that controls the behavior of the dialog box."},{"pos":[2230,2237],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Create an object of class <ph id=\"ph1\">`COleInsertDialog`</ph> when you want to call this dialog box.","pos":[2241,2324],"source":"Create an object of class `COleInsertDialog` when you want to call this dialog box."},{"content":"After a <ph id=\"ph1\">`COleInsertDialog`</ph> object has been constructed, you can use the <bpt id=\"p1\">[</bpt>m_io<ept id=\"p1\">](#coleinsertdialog__m_io)</ept> structure to initialize the values or states of controls in the dialog box.","pos":[2325,2504],"source":" After a `COleInsertDialog` object has been constructed, you can use the [m_io](#coleinsertdialog__m_io) structure to initialize the values or states of controls in the dialog box."},{"content":"The <ph id=\"ph1\">`m_io`</ph> structure is of type <bpt id=\"p1\">**</bpt>OLEUIINSERTOBJECT<ept id=\"p1\">**</ept>.","pos":[2505,2559],"source":" The `m_io` structure is of type **OLEUIINSERTOBJECT**."},{"content":"For more information about using this dialog class, see the <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#coleinsertdialog__domodal)</ept> member function.","pos":[2560,2674],"source":" For more information about using this dialog class, see the [DoModal](#coleinsertdialog__domodal) member function."},{"pos":[2682,2753],"content":"[!NOTE]\n Application Wizard-generated container code uses this class.","leadings":["","> "],"nodes":[{"content":"Application Wizard-generated container code uses this class.","pos":[9,69]}]},{"pos":[2760,2939],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUIINSERTOBJECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms691316)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUIINSERTOBJECT](http://msdn.microsoft.com/library/windows/desktop/ms691316) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[2946,3076],"content":"For more information regarding OLE-specific dialog boxes, see the article <bpt id=\"p1\">[</bpt>Dialog Boxes in OLE<ept id=\"p1\">](../../mfc/dialog-boxes-in-ole.md)</ept>.","source":"For more information regarding OLE-specific dialog boxes, see the article [Dialog Boxes in OLE](../../mfc/dialog-boxes-in-ole.md)."},{"pos":[3085,3106],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3110,3157],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[3164,3217],"content":"<bpt id=\"p1\">[</bpt>CCmdTarget<ept id=\"p1\">](../../mfc/reference/ccmdtarget-class.md)</ept>","source":"[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)"},{"pos":[3224,3265],"content":"<bpt id=\"p1\">[</bpt>CWnd<ept id=\"p1\">](../../mfc/reference/cwnd-class.md)</ept>","source":"[CWnd](../../mfc/reference/cwnd-class.md)"},{"pos":[3272,3319],"content":"<bpt id=\"p1\">[</bpt>CDialog<ept id=\"p1\">](../../mfc/reference/cdialog-class.md)</ept>","source":"[CDialog](../../mfc/reference/cdialog-class.md)"},{"pos":[3326,3385],"content":"<bpt id=\"p1\">[</bpt>CCommonDialog<ept id=\"p1\">](../../mfc/reference/ccommondialog-class.md)</ept>","source":"[CCommonDialog](../../mfc/reference/ccommondialog-class.md)"},{"pos":[3392,3445],"content":"<bpt id=\"p1\">[</bpt>COleDialog<ept id=\"p1\">](../../mfc/reference/coledialog-class.md)</ept>","source":"[COleDialog](../../mfc/reference/coledialog-class.md)"},{"pos":[3479,3491],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3495,3517],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxodlgs.h","source":"**Header:** afxodlgs.h"},{"pos":[3527,3612],"content":"<bpt id=\"p1\">&lt;a name=\"coleinsertdialog__coleinsertdialog\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleInsertDialog::COleInsertDialog","linkify":"<a name=\"coleinsertdialog__coleinsertdialog\"></a>  COleInsertDialog::COleInsertDialog","source":"<a name=\"coleinsertdialog__coleinsertdialog\"></a>  COleInsertDialog::COleInsertDialog"},{"pos":[3616,3674],"content":"This function constructs only a <ph id=\"ph1\">`COleInsertDialog`</ph> object.","source":"This function constructs only a `COleInsertDialog` object."},{"pos":[3791,3801],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Creation flag that contains any number of the following values to be combined using the bitwise-OR operator:","pos":[3818,3926]},{"pos":[3934,4030],"content":"<bpt id=\"p1\">**</bpt>IOF_SHOWHELP<ept id=\"p1\">**</ept> Specifies that the Help button will be displayed when the dialog box is called.","source":"**IOF_SHOWHELP** Specifies that the Help button will be displayed when the dialog box is called."},{"content":"<bpt id=\"p1\">**</bpt>IOF_SELECTCREATENEW<ept id=\"p1\">**</ept> Specifies that the Create New radio button will be selected initially when the dialog box is called.","pos":[4038,4162],"source":"**IOF_SELECTCREATENEW** Specifies that the Create New radio button will be selected initially when the dialog box is called."},{"content":"This is the default and cannot be used with <bpt id=\"p1\">**</bpt>IOF_SELECTCREATEFROMFILE<ept id=\"p1\">**</ept>.","pos":[4163,4236],"source":" This is the default and cannot be used with **IOF_SELECTCREATEFROMFILE**."},{"content":"<bpt id=\"p1\">**</bpt>IOF_SELECTCREATEFROMFILE<ept id=\"p1\">**</ept> Specifies that the Create From File radio button will be selected initially when the dialog box is called.","pos":[4244,4379],"source":"**IOF_SELECTCREATEFROMFILE** Specifies that the Create From File radio button will be selected initially when the dialog box is called."},{"content":"Cannot be used with <bpt id=\"p1\">**</bpt>IOF_SELECTCREATENEW<ept id=\"p1\">**</ept>.","pos":[4380,4424],"source":" Cannot be used with **IOF_SELECTCREATENEW**."},{"pos":[4432,4540],"content":"<bpt id=\"p1\">**</bpt>IOF_CHECKLINK<ept id=\"p1\">**</ept> Specifies that the Link check box will be checked initially when the dialog box is called.","source":"**IOF_CHECKLINK** Specifies that the Link check box will be checked initially when the dialog box is called."},{"pos":[4548,4649],"content":"<bpt id=\"p1\">**</bpt>IOF_DISABLELINK<ept id=\"p1\">**</ept> Specifies that the Link check box will be disabled when the dialog box is called.","source":"**IOF_DISABLELINK** Specifies that the Link check box will be disabled when the dialog box is called."},{"pos":[4657,4865],"content":"<bpt id=\"p1\">**</bpt>IOF_CHECKDISPLAYASICON<ept id=\"p1\">**</ept> Specifies that the Display As Icon check box will be checked initially, the current icon will be displayed, and the Change Icon button will be enabled when the dialog box is called.","source":"**IOF_CHECKDISPLAYASICON** Specifies that the Display As Icon check box will be checked initially, the current icon will be displayed, and the Change Icon button will be enabled when the dialog box is called."},{"content":"<bpt id=\"p1\">**</bpt>IOF_VERIFYSERVERSEXIST<ept id=\"p1\">**</ept> Specifies that the dialog box should validate the classes it adds to the list box by ensuring that the servers specified in the registration database exist before the dialog box is displayed.","pos":[4873,5091],"source":"**IOF_VERIFYSERVERSEXIST** Specifies that the dialog box should validate the classes it adds to the list box by ensuring that the servers specified in the registration database exist before the dialog box is displayed."},{"content":"Setting this flag can significantly impair performance.","pos":[5092,5147]},{"pos":[5154,5363],"content":"`pParentWnd`  \nPoints to the parent or owner window object (of type `CWnd`) to which the dialog object belongs. If it is **NULL**, the parent window of the dialog object is set to the main application window.","leadings":[""," "],"nodes":[{"content":"Points to the parent or owner window object (of type `CWnd`) to which the dialog object belongs. If it is **NULL**, the parent window of the dialog object is set to the main application window.","pos":[15,208],"nodes":[{"content":"Points to the parent or owner window object (of type <ph id=\"ph1\">`CWnd`</ph>) to which the dialog object belongs.","pos":[0,96],"source":"Points to the parent or owner window object (of type `CWnd`) to which the dialog object belongs."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the parent window of the dialog object is set to the main application window.","pos":[97,193],"source":" If it is **NULL**, the parent window of the dialog object is set to the main application window."}]}]},{"pos":[5373,5380],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5384,5467],"content":"To display the dialog box, call the <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#coleinsertdialog__domodal)</ept> function.","source":"To display the dialog box, call the [DoModal](#coleinsertdialog__domodal) function."},{"pos":[5477,5550],"content":"<bpt id=\"p1\">&lt;a name=\"coleinsertdialog__createitem\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleInsertDialog::CreateItem","linkify":"<a name=\"coleinsertdialog__createitem\"></a>  COleInsertDialog::CreateItem","source":"<a name=\"coleinsertdialog__createitem\"></a>  COleInsertDialog::CreateItem"},{"pos":[5554,5726],"content":"Call this function to create an object of type <bpt id=\"p1\">[</bpt>COleClientItem<ept id=\"p1\">](../../mfc/reference/coleclientitem-class.md)</ept> only if <bpt id=\"p2\">[</bpt>DoModal<ept id=\"p2\">](#coleinsertdialog__domodal)</ept> returns <bpt id=\"p3\">**</bpt>IDOK<ept id=\"p3\">**</ept>.","source":"Call this function to create an object of type [COleClientItem](../../mfc/reference/coleclientitem-class.md) only if [DoModal](#coleinsertdialog__domodal) returns **IDOK**."},{"pos":[5791,5801],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to the item to be created.","pos":[5816,5849]},{"pos":[5859,5871],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if item was created; otherwise 0.","pos":[5875,5916]},{"pos":[5926,5933],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5937,6017],"content":"You must allocate the <ph id=\"ph1\">`COleClientItem`</ph> object before you can call this function.","source":"You must allocate the `COleClientItem` object before you can call this function."},{"pos":[6027,6094],"content":"<bpt id=\"p1\">&lt;a name=\"coleinsertdialog__domodal\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleInsertDialog::DoModal","linkify":"<a name=\"coleinsertdialog__domodal\"></a>  COleInsertDialog::DoModal","source":"<a name=\"coleinsertdialog__domodal\"></a>  COleInsertDialog::DoModal"},{"content":"Call this function to display the OLE Insert Object dialog box.","pos":[6098,6161]},{"pos":[6263,6273],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"One of the following values:","pos":[6290,6318]},{"pos":[6325,6384],"content":"<ph id=\"ph1\">`COleInsertDialog::DocObjectsOnly`</ph> inserts only DocObjects.","source":"`COleInsertDialog::DocObjectsOnly` inserts only DocObjects."},{"pos":[6391,6454],"content":"<ph id=\"ph1\">`COleInsertDialog::ControlsOnly`</ph> inserts only ActiveX controls.","source":"`COleInsertDialog::ControlsOnly` inserts only ActiveX controls."},{"content":"Zero inserts neither a DocObject nor an ActiveX control.","pos":[6461,6517]},{"content":"This value results in the same implementation as the first prototype listed above.","pos":[6518,6600]},{"pos":[6610,6622],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Completion status for the dialog box.","pos":[6626,6663]},{"content":"One of the following values:","pos":[6664,6692]},{"content":"IDOK if the dialog box was successfully displayed.","pos":[6702,6752]},{"content":"IDCANCEL if the user canceled the dialog box.","pos":[6762,6807]},{"content":"IDABORT if an error occurred.","pos":[6817,6846]},{"content":"If IDABORT is returned, call the <bpt id=\"p1\">[</bpt>COleDialog::GetLastError<ept id=\"p1\">](../../mfc/reference/coledialog-class.md#coledialog__getlasterror)</ept> member function to get more information about the type of error that occurred.","pos":[6847,7051],"source":" If IDABORT is returned, call the [COleDialog::GetLastError](../../mfc/reference/coledialog-class.md#coledialog__getlasterror) member function to get more information about the type of error that occurred."},{"content":"For a listing of possible errors, see the <bpt id=\"p1\">[</bpt>OleUIInsertObject<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694325)</ept> function in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[7052,7242],"source":" For a listing of possible errors, see the [OleUIInsertObject](http://msdn.microsoft.com/library/windows/desktop/ms694325) function in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[7252,7259],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7263,7478],"content":"If you want to initialize the various dialog box controls by setting members of the <bpt id=\"p1\">[</bpt>m_io<ept id=\"p1\">](#coleinsertdialog__m_io)</ept> structure, you should do this before calling <ph id=\"ph1\">`DoModal`</ph>, but after the dialog object is constructed.","source":"If you want to initialize the various dialog box controls by setting members of the [m_io](#coleinsertdialog__m_io) structure, you should do this before calling `DoModal`, but after the dialog object is constructed."},{"pos":[7485,7626],"content":"If <ph id=\"ph1\">`DoModal`</ph> returns IDOK, you can call other member functions to retrieve the settings or information input into the dialog box by the user.","source":"If `DoModal` returns IDOK, you can call other member functions to retrieve the settings or information input into the dialog box by the user."},{"pos":[7636,7709],"content":"<bpt id=\"p1\">&lt;a name=\"coleinsertdialog__getclassid\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleInsertDialog::GetClassID","linkify":"<a name=\"coleinsertdialog__getclassid\"></a>  COleInsertDialog::GetClassID","source":"<a name=\"coleinsertdialog__getclassid\"></a>  COleInsertDialog::GetClassID"},{"pos":[7713,7912],"content":"Call this function to get the <bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept> associated with the selected item only if <bpt id=\"p2\">[</bpt>DoModal<ept id=\"p2\">](#coleinsertdialog__domodal)</ept> returns <bpt id=\"p3\">**</bpt>IDOK<ept id=\"p3\">**</ept> and the selection type is <bpt id=\"p4\">**</bpt>COleInsertDialog::createNewItem<ept id=\"p4\">**</ept>.","source":"Call this function to get the **CLSID** associated with the selected item only if [DoModal](#coleinsertdialog__domodal) returns **IDOK** and the selection type is **COleInsertDialog::createNewItem**."},{"pos":[7969,7981],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[7985,8041],"content":"Returns the <bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept> associated with the selected item.","source":"Returns the **CLSID** associated with the selected item."},{"pos":[8051,8058],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[8062,8219],"content":"For more information, see <bpt id=\"p1\">[</bpt>CLSID Key<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms691424)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [CLSID Key](http://msdn.microsoft.com/library/windows/desktop/ms691424) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8229,8308],"content":"<bpt id=\"p1\">&lt;a name=\"coleinsertdialog__getdrawaspect\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleInsertDialog::GetDrawAspect","linkify":"<a name=\"coleinsertdialog__getdrawaspect\"></a>  COleInsertDialog::GetDrawAspect","source":"<a name=\"coleinsertdialog__getdrawaspect\"></a>  COleInsertDialog::GetDrawAspect"},{"content":"Call this function to determine if the user chose to display the selected item as an icon.","pos":[8312,8402]},{"pos":[8462,8474],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The method needed to render the object.","pos":[8478,8517]},{"pos":[8525,8602],"content":"<ph id=\"ph1\">`DVASPECT_CONTENT`</ph> Returned if the Display As Icon check box was not checked.","source":"`DVASPECT_CONTENT` Returned if the Display As Icon check box was not checked."},{"pos":[8610,8680],"content":"<ph id=\"ph1\">`DVASPECT_ICON`</ph> Returned if the Display As Icon check box was checked.","source":"`DVASPECT_ICON` Returned if the Display As Icon check box was checked."},{"pos":[8690,8697],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[8701,8783],"content":"Call this function only if <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#coleinsertdialog__domodal)</ept> returns <bpt id=\"p2\">**</bpt>IDOK<ept id=\"p2\">**</ept>.","source":"Call this function only if [DoModal](#coleinsertdialog__domodal) returns **IDOK**."},{"pos":[8790,8980],"content":"For more information on drawing aspect, see <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> data structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on drawing aspect, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) data structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8990,9077],"content":"<bpt id=\"p1\">&lt;a name=\"coleinsertdialog__geticonicmetafile\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleInsertDialog::GetIconicMetafile","linkify":"<a name=\"coleinsertdialog__geticonicmetafile\"></a>  COleInsertDialog::GetIconicMetafile","source":"<a name=\"coleinsertdialog__geticonicmetafile\"></a>  COleInsertDialog::GetIconicMetafile"},{"content":"Call this function to get a handle to the metafile that contains the iconic aspect of the selected item.","pos":[9081,9185]},{"pos":[9248,9260],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[9264,9456],"content":"The handle to the metafile containing the iconic aspect of the selected item, if the Display As Icon check box was checked when the dialog was dismissed by choosing <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>; otherwise <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","source":"The handle to the metafile containing the iconic aspect of the selected item, if the Display As Icon check box was checked when the dialog was dismissed by choosing **OK**; otherwise **NULL**."},{"pos":[9466,9541],"content":"<bpt id=\"p1\">&lt;a name=\"coleinsertdialog__getpathname\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleInsertDialog::GetPathName","linkify":"<a name=\"coleinsertdialog__getpathname\"></a>  COleInsertDialog::GetPathName","source":"<a name=\"coleinsertdialog__getpathname\"></a>  COleInsertDialog::GetPathName"},{"pos":[9545,9735],"content":"Call this function to get the full path of the selected file only if <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#coleinsertdialog__domodal)</ept> returns <bpt id=\"p2\">**</bpt>IDOK<ept id=\"p2\">**</ept> and the selection type is not <bpt id=\"p3\">**</bpt>COleInsertDialog::createNewItem<ept id=\"p3\">**</ept>.","source":"Call this function to get the full path of the selected file only if [DoModal](#coleinsertdialog__domodal) returns **IDOK** and the selection type is not **COleInsertDialog::createNewItem**."},{"pos":[9792,9804],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The full path to the file selected in the dialog box.","pos":[9808,9861]},{"content":"If the selection type is <ph id=\"ph1\">`createNewItem`</ph>, this function returns a meaningless <ph id=\"ph2\">`CString`</ph> in release mode or causes an assertion in debug mode.","pos":[9862,10003],"source":" If the selection type is `createNewItem`, this function returns a meaningless `CString` in release mode or causes an assertion in debug mode."},{"pos":[10013,10098],"content":"<bpt id=\"p1\">&lt;a name=\"coleinsertdialog__getselectiontype\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleInsertDialog::GetSelectionType","linkify":"<a name=\"coleinsertdialog__getselectiontype\"></a>  COleInsertDialog::GetSelectionType","source":"<a name=\"coleinsertdialog__getselectiontype\"></a>  COleInsertDialog::GetSelectionType"},{"pos":[10102,10221],"content":"Call this function to get the selection type chosen when the Insert Object dialog box was dismissed by choosing <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Call this function to get the selection type chosen when the Insert Object dialog box was dismissed by choosing **OK**."},{"pos":[10280,10292],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Type of selection made.","pos":[10296,10319]},{"pos":[10329,10336],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[10340,10456],"content":"The return type values are specified by the <bpt id=\"p1\">**</bpt>Selection<ept id=\"p1\">**</ept> enumeration type declared in the <ph id=\"ph1\">`COleInsertDialog`</ph> class.","source":"The return type values are specified by the **Selection** enumeration type declared in the `COleInsertDialog` class."},{"content":"Brief descriptions of these values follow:","pos":[10573,10615]},{"pos":[10623,10700],"content":"<bpt id=\"p1\">**</bpt>COleInsertDialog::createNewItem<ept id=\"p1\">**</ept> The Create New radio button was selected.","source":"**COleInsertDialog::createNewItem** The Create New radio button was selected."},{"pos":[10708,10831],"content":"<bpt id=\"p1\">**</bpt>COleInsertDialog::insertFromFile<ept id=\"p1\">**</ept> The Create From File radio button was selected and the Link check box was not checked.","source":"**COleInsertDialog::insertFromFile** The Create From File radio button was selected and the Link check box was not checked."},{"pos":[10839,10954],"content":"<bpt id=\"p1\">**</bpt>COleInsertDialog::linkToFile<ept id=\"p1\">**</ept> The Create From File radio button was selected and the Link check box was checked.","source":"**COleInsertDialog::linkToFile** The Create From File radio button was selected and the Link check box was checked."},{"pos":[10964,11025],"content":"<bpt id=\"p1\">&lt;a name=\"coleinsertdialog__m_io\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleInsertDialog::m_io","linkify":"<a name=\"coleinsertdialog__m_io\"></a>  COleInsertDialog::m_io","source":"<a name=\"coleinsertdialog__m_io\"></a>  COleInsertDialog::m_io"},{"pos":[11029,11130],"content":"Structure of type <bpt id=\"p1\">**</bpt>OLEUIINSERTOBJECT<ept id=\"p1\">**</ept> used to control the behavior of the Insert Object dialog box.","source":"Structure of type **OLEUIINSERTOBJECT** used to control the behavior of the Insert Object dialog box."},{"pos":[11181,11188],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Members of this structure can be modified either directly or through member functions.","pos":[11192,11278]},{"pos":[11285,11464],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUIINSERTOBJECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms691316)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUIINSERTOBJECT](http://msdn.microsoft.com/library/windows/desktop/ms691316) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[11473,11481],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>MFC Sample OCLIENT<ept id=\"p1\">](../../visual-cpp-samples.md)</ept><ph id=\"ph1\"> </ph>","pos":[11485,11535],"source":"[MFC Sample OCLIENT](../../visual-cpp-samples.md) "},{"content":"<bpt id=\"p1\"> [</bpt>COleDialog Class<ept id=\"p1\">](../../mfc/reference/coledialog-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[11538,11599],"source":" [COleDialog Class](../../mfc/reference/coledialog-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[11602,11651],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>COleDialog Class<ept id=\"p1\">](../../mfc/reference/coledialog-class.md)</ept>","pos":[11654,11714],"source":" [COleDialog Class](../../mfc/reference/coledialog-class.md)"}],"content":"---\ntitle: \"COleInsertDialog Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleInsertDialog\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE Insert Object dialog box\"\n  - \"dialog boxes, OLE\"\n  - \"COleInsertDialog class\"\n  - \"Insert Object dialog box\"\nms.assetid: a9ec610b-abde-431e-bd01-c40159a66dbb\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleInsertDialog Class\nUsed for the OLE Insert Object dialog box.  \n  \n## Syntax  \n  \n```  \nclass COleInsertDialog : public COleDialog  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleInsertDialog::COleInsertDialog](#coleinsertdialog__coleinsertdialog)|Constructs a `COleInsertDialog` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleInsertDialog::CreateItem](#coleinsertdialog__createitem)|Creates the item selected in the dialog box.|  \n|[COleInsertDialog::DoModal](#coleinsertdialog__domodal)|Displays the OLE Insert Object dialog box.|  \n|[COleInsertDialog::GetClassID](#coleinsertdialog__getclassid)|Gets the **CLSID** associated with the chosen item.|  \n|[COleInsertDialog::GetDrawAspect](#coleinsertdialog__getdrawaspect)|Tells whether to draw the item as an icon.|  \n|[COleInsertDialog::GetIconicMetafile](#coleinsertdialog__geticonicmetafile)|Gets a handle to the metafile associated with the iconic form of this item.|  \n|[COleInsertDialog::GetPathName](#coleinsertdialog__getpathname)|Gets the full path to the file chosen in the dialog box.|  \n|[COleInsertDialog::GetSelectionType](#coleinsertdialog__getselectiontype)|Gets the type of object selected.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleInsertDialog::m_io](#coleinsertdialog__m_io)|A structure of type **OLEUIINSERTOBJECT** that controls the behavior of the dialog box.|  \n  \n## Remarks  \n Create an object of class `COleInsertDialog` when you want to call this dialog box. After a `COleInsertDialog` object has been constructed, you can use the [m_io](#coleinsertdialog__m_io) structure to initialize the values or states of controls in the dialog box. The `m_io` structure is of type **OLEUIINSERTOBJECT**. For more information about using this dialog class, see the [DoModal](#coleinsertdialog__domodal) member function.  \n  \n> [!NOTE]\n>  Application Wizard-generated container code uses this class.  \n  \n For more information, see the [OLEUIINSERTOBJECT](http://msdn.microsoft.com/library/windows/desktop/ms691316) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information regarding OLE-specific dialog boxes, see the article [Dialog Boxes in OLE](../../mfc/dialog-boxes-in-ole.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CDialog](../../mfc/reference/cdialog-class.md)  \n  \n [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  \n  \n [COleDialog](../../mfc/reference/coledialog-class.md)  \n  \n `COleInsertDialog`  \n  \n## Requirements  \n **Header:** afxodlgs.h  \n  \n##  <a name=\"coleinsertdialog__coleinsertdialog\"></a>  COleInsertDialog::COleInsertDialog  \n This function constructs only a `COleInsertDialog` object.  \n  \n```  \nCOleInsertDialog (\n    DWORD dwFlags = IOF_SELECTCREATENEW,  \n    CWnd* pParentWnd = NULL);\n```  \n  \n### Parameters  \n `dwFlags`  \n Creation flag that contains any number of the following values to be combined using the bitwise-OR operator:  \n  \n- **IOF_SHOWHELP** Specifies that the Help button will be displayed when the dialog box is called.  \n  \n- **IOF_SELECTCREATENEW** Specifies that the Create New radio button will be selected initially when the dialog box is called. This is the default and cannot be used with **IOF_SELECTCREATEFROMFILE**.  \n  \n- **IOF_SELECTCREATEFROMFILE** Specifies that the Create From File radio button will be selected initially when the dialog box is called. Cannot be used with **IOF_SELECTCREATENEW**.  \n  \n- **IOF_CHECKLINK** Specifies that the Link check box will be checked initially when the dialog box is called.  \n  \n- **IOF_DISABLELINK** Specifies that the Link check box will be disabled when the dialog box is called.  \n  \n- **IOF_CHECKDISPLAYASICON** Specifies that the Display As Icon check box will be checked initially, the current icon will be displayed, and the Change Icon button will be enabled when the dialog box is called.  \n  \n- **IOF_VERIFYSERVERSEXIST** Specifies that the dialog box should validate the classes it adds to the list box by ensuring that the servers specified in the registration database exist before the dialog box is displayed. Setting this flag can significantly impair performance.  \n  \n `pParentWnd`  \n Points to the parent or owner window object (of type `CWnd`) to which the dialog object belongs. If it is **NULL**, the parent window of the dialog object is set to the main application window.  \n  \n### Remarks  \n To display the dialog box, call the [DoModal](#coleinsertdialog__domodal) function.  \n  \n##  <a name=\"coleinsertdialog__createitem\"></a>  COleInsertDialog::CreateItem  \n Call this function to create an object of type [COleClientItem](../../mfc/reference/coleclientitem-class.md) only if [DoModal](#coleinsertdialog__domodal) returns **IDOK**.  \n  \n```  \nBOOL CreateItem(COleClientItem* pItem);\n```  \n  \n### Parameters  \n `pItem`  \n Points to the item to be created.  \n  \n### Return Value  \n Nonzero if item was created; otherwise 0.  \n  \n### Remarks  \n You must allocate the `COleClientItem` object before you can call this function.  \n  \n##  <a name=\"coleinsertdialog__domodal\"></a>  COleInsertDialog::DoModal  \n Call this function to display the OLE Insert Object dialog box.  \n  \n```  \nvirtual INT_PTR   \n    DoModal();\n\n \nINT_PTR   \n    DoModal(DWORD  dwFlags);\n```  \n  \n### Parameters  \n `dwFlags`  \n One of the following values:  \n  \n `COleInsertDialog::DocObjectsOnly` inserts only DocObjects.  \n  \n `COleInsertDialog::ControlsOnly` inserts only ActiveX controls.  \n  \n Zero inserts neither a DocObject nor an ActiveX control. This value results in the same implementation as the first prototype listed above.  \n  \n### Return Value  \n Completion status for the dialog box. One of the following values:  \n  \n-   IDOK if the dialog box was successfully displayed.  \n  \n-   IDCANCEL if the user canceled the dialog box.  \n  \n-   IDABORT if an error occurred. If IDABORT is returned, call the [COleDialog::GetLastError](../../mfc/reference/coledialog-class.md#coledialog__getlasterror) member function to get more information about the type of error that occurred. For a listing of possible errors, see the [OleUIInsertObject](http://msdn.microsoft.com/library/windows/desktop/ms694325) function in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Remarks  \n If you want to initialize the various dialog box controls by setting members of the [m_io](#coleinsertdialog__m_io) structure, you should do this before calling `DoModal`, but after the dialog object is constructed.  \n  \n If `DoModal` returns IDOK, you can call other member functions to retrieve the settings or information input into the dialog box by the user.  \n  \n##  <a name=\"coleinsertdialog__getclassid\"></a>  COleInsertDialog::GetClassID  \n Call this function to get the **CLSID** associated with the selected item only if [DoModal](#coleinsertdialog__domodal) returns **IDOK** and the selection type is **COleInsertDialog::createNewItem**.  \n  \n```  \nREFCLSID GetClassID() const;\n\n \n```  \n  \n### Return Value  \n Returns the **CLSID** associated with the selected item.  \n  \n### Remarks  \n For more information, see [CLSID Key](http://msdn.microsoft.com/library/windows/desktop/ms691424) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coleinsertdialog__getdrawaspect\"></a>  COleInsertDialog::GetDrawAspect  \n Call this function to determine if the user chose to display the selected item as an icon.  \n  \n```  \nDVASPECT GetDrawAspect() const;\n\n \n```  \n  \n### Return Value  \n The method needed to render the object.  \n  \n- `DVASPECT_CONTENT` Returned if the Display As Icon check box was not checked.  \n  \n- `DVASPECT_ICON` Returned if the Display As Icon check box was checked.  \n  \n### Remarks  \n Call this function only if [DoModal](#coleinsertdialog__domodal) returns **IDOK**.  \n  \n For more information on drawing aspect, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) data structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coleinsertdialog__geticonicmetafile\"></a>  COleInsertDialog::GetIconicMetafile  \n Call this function to get a handle to the metafile that contains the iconic aspect of the selected item.  \n  \n```  \nHGLOBAL GetIconicMetafile() const;\n\n \n```  \n  \n### Return Value  \n The handle to the metafile containing the iconic aspect of the selected item, if the Display As Icon check box was checked when the dialog was dismissed by choosing **OK**; otherwise **NULL**.  \n  \n##  <a name=\"coleinsertdialog__getpathname\"></a>  COleInsertDialog::GetPathName  \n Call this function to get the full path of the selected file only if [DoModal](#coleinsertdialog__domodal) returns **IDOK** and the selection type is not **COleInsertDialog::createNewItem**.  \n  \n```  \nCString GetPathName() const;\n\n \n```  \n  \n### Return Value  \n The full path to the file selected in the dialog box. If the selection type is `createNewItem`, this function returns a meaningless `CString` in release mode or causes an assertion in debug mode.  \n  \n##  <a name=\"coleinsertdialog__getselectiontype\"></a>  COleInsertDialog::GetSelectionType  \n Call this function to get the selection type chosen when the Insert Object dialog box was dismissed by choosing **OK**.  \n  \n```  \nUINT GetSelectionType() const;\n\n \n```  \n  \n### Return Value  \n Type of selection made.  \n  \n### Remarks  \n The return type values are specified by the **Selection** enumeration type declared in the `COleInsertDialog` class.  \n  \n `enum Selection`  \n  \n `{`  \n  \n `createNewItem,`  \n  \n `insertFromFile,`  \n  \n `linkToFile`  \n  \n `};`  \n  \n Brief descriptions of these values follow:  \n  \n- **COleInsertDialog::createNewItem** The Create New radio button was selected.  \n  \n- **COleInsertDialog::insertFromFile** The Create From File radio button was selected and the Link check box was not checked.  \n  \n- **COleInsertDialog::linkToFile** The Create From File radio button was selected and the Link check box was checked.  \n  \n##  <a name=\"coleinsertdialog__m_io\"></a>  COleInsertDialog::m_io  \n Structure of type **OLEUIINSERTOBJECT** used to control the behavior of the Insert Object dialog box.  \n  \n```  \nOLEUIINSERTOBJECT m_io;  \n```  \n  \n### Remarks  \n Members of this structure can be modified either directly or through member functions.  \n  \n For more information, see the [OLEUIINSERTOBJECT](http://msdn.microsoft.com/library/windows/desktop/ms691316) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [MFC Sample OCLIENT](../../visual-cpp-samples.md)   \n [COleDialog Class](../../mfc/reference/coledialog-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [COleDialog Class](../../mfc/reference/coledialog-class.md)\n"}