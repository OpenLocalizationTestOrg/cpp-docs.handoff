{"nodes":[{"pos":[12,44],"content":"CCommand::Close | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CCommand::Close | Microsoft Docs","pos":[0,32]}]},{"content":"CCommand::Close","pos":[623,638]},{"content":"Releases the accessor rowset associated with the command.","pos":[639,696]},{"content":"Syntax","pos":[705,711]},{"content":"Remarks","pos":[752,759]},{"content":"A command uses a rowset, result set accessor, and (optionally) a parameter accessor (unlike tables, which do not support parameters and do not need a parameter accessor).","pos":[763,933]},{"pos":[940,1081],"content":"When you execute a command, you should call both <ph id=\"ph1\">`Close`</ph> and <bpt id=\"p1\">[</bpt>ReleaseCommand<ept id=\"p1\">](../../data/oledb/ccommand-releasecommand.md)</ept> after the command.","source":"When you execute a command, you should call both `Close` and [ReleaseCommand](../../data/oledb/ccommand-releasecommand.md) after the command."},{"content":"When you want to execute the same command repeatedly, you should release each result set accessor by calling <ph id=\"ph1\">`Close`</ph> before calling <ph id=\"ph2\">`Execute`</ph>.","pos":[1088,1230],"source":"When you want to execute the same command repeatedly, you should release each result set accessor by calling `Close` before calling `Execute`."},{"content":"At the end of the series, you should release the parameter accessor by calling <ph id=\"ph1\">`ReleaseCommand`</ph>.","pos":[1231,1327],"source":" At the end of the series, you should release the parameter accessor by calling `ReleaseCommand`."},{"content":"Another common scenario is calling a stored procedure that has output parameters.","pos":[1328,1409]},{"content":"On many providers (such as the OLE DB provider for SQL Server) the output parameter values will not be accessible until you close the result set accessor.","pos":[1410,1564]},{"content":"Call <ph id=\"ph1\">`Close`</ph> to close the returned rowset and result set accessor, but not the parameter accessor, thus allowing you to retrieve the output parameter values.","pos":[1565,1722],"source":" Call `Close` to close the returned rowset and result set accessor, but not the parameter accessor, thus allowing you to retrieve the output parameter values."},{"content":"Example","pos":[1731,1738]},{"pos":[1742,1861],"content":"The following example shows how you can call <ph id=\"ph1\">`Close`</ph> and <ph id=\"ph2\">`ReleaseCommand`</ph> when you execute the same command repeatedly.","source":"The following example shows how you can call `Close` and `ReleaseCommand` when you execute the same command repeatedly."},{"pos":[1879,1899],"content":"NVC_OLEDB_Consumer#2"},{"content":"Requirements","pos":[1965,1977]},{"pos":[1981,2003],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldbcli.h","source":"**Header:** atldbcli.h"},{"content":"See Also","pos":[2012,2020]},{"content":"CCommand Class","pos":[2025,2039]},{"content":"CCommand::ReleaseCommand","pos":[2082,2106]}],"content":"---\ntitle: \"CCommand::Close | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"CCommand.Close\"\n  - \"CCommand::Close\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Close method\"\nms.assetid: 4da9c02c-7082-4e47-a0fa-78b546f0f7d2\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CCommand::Close\nReleases the accessor rowset associated with the command.  \n  \n## Syntax  \n  \n```  \nvoid Close( );  \n```  \n  \n## Remarks  \n A command uses a rowset, result set accessor, and (optionally) a parameter accessor (unlike tables, which do not support parameters and do not need a parameter accessor).  \n  \n When you execute a command, you should call both `Close` and [ReleaseCommand](../../data/oledb/ccommand-releasecommand.md) after the command.  \n  \n When you want to execute the same command repeatedly, you should release each result set accessor by calling `Close` before calling `Execute`. At the end of the series, you should release the parameter accessor by calling `ReleaseCommand`. Another common scenario is calling a stored procedure that has output parameters. On many providers (such as the OLE DB provider for SQL Server) the output parameter values will not be accessible until you close the result set accessor. Call `Close` to close the returned rowset and result set accessor, but not the parameter accessor, thus allowing you to retrieve the output parameter values.  \n  \n## Example  \n The following example shows how you can call `Close` and `ReleaseCommand` when you execute the same command repeatedly.  \n  \n [!code-cpp[NVC_OLEDB_Consumer#2](../../data/oledb/codesnippet/cpp/ccommand-close_1.cpp)]  \n  \n## Requirements  \n **Header:** atldbcli.h  \n  \n## See Also  \n [CCommand Class](../../data/oledb/ccommand-class.md)   \n [CCommand::ReleaseCommand](../../data/oledb/ccommand-releasecommand.md)"}