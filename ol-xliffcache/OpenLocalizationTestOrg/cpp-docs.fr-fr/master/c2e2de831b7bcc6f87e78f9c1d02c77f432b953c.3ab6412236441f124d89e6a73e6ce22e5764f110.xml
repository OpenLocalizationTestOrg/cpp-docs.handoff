{"nodes":[{"pos":[12,60],"content":"Handlers for Message-Map Ranges | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Handlers for Message-Map Ranges | Microsoft Docs","pos":[0,48]}]},{"content":"Handlers for Message-Map Ranges","pos":[1201,1232]},{"content":"This article explains how to map a range of messages to a single message handler function (instead of mapping one message to only one function).","pos":[1233,1377]},{"content":"There are times when you need to process more than one message or control notification in exactly the same way.","pos":[1384,1495]},{"content":"At such times, you might wish to map all of the messages to a single handler function.","pos":[1496,1582]},{"content":"Message-map ranges allow you to do this for a contiguous range of messages:","pos":[1583,1658]},{"content":"You can map ranges of command IDs to:","pos":[1668,1705]},{"content":"A command handler function.","pos":[1719,1746]},{"content":"A command update handler function.","pos":[1760,1794]},{"content":"You can map control-notification messages for a range of control IDs to a message handler function.","pos":[1804,1903]},{"content":"Topics covered in this article include:","pos":[1910,1949]},{"content":"Writing the message-map entry","pos":[1960,1989]},{"content":"Declaring the handler function","pos":[2042,2072]},{"content":"Example for a range of command IDs","pos":[2123,2157]},{"content":"Example for a range of control IDs","pos":[2212,2246]},{"pos":[2354,2383],"content":"Writing the Message-Map Entry"},{"content":"In the .CPP file, add your message-map entry, as shown in the following example:","pos":[2387,2467]},{"pos":[2485,2509],"content":"NVC_MFCMessageHandling#6"},{"content":"The message-map entry consists of the following items:","pos":[2580,2634]},{"content":"The message-map range macro:","pos":[2644,2672]},{"content":"ON_COMMAND_RANGE","pos":[2687,2703]},{"content":"ON_UPDATE_COMMAND_UI_RANGE","pos":[2791,2817]},{"content":"ON_CONTROL_RANGE","pos":[2905,2921]},{"content":"Parameters to the macro:","pos":[3004,3028]},{"content":"The first two macros take three parameters:","pos":[3039,3082]},{"content":"The command ID that starts the range","pos":[3096,3132]},{"content":"The command ID that ends the range","pos":[3146,3180]},{"content":"The name of the message handler function","pos":[3194,3234]},{"content":"The range of command IDs must be contiguous.","pos":[3245,3289]},{"pos":[3300,3428],"content":"The third macro, <ph id=\"ph1\">`ON_CONTROL_RANGE`</ph>, takes an additional first parameter: a control-notification message, such as <bpt id=\"p1\">**</bpt>EN_CHANGE<ept id=\"p1\">**</ept>.","source":"The third macro, `ON_CONTROL_RANGE`, takes an additional first parameter: a control-notification message, such as **EN_CHANGE**."},{"pos":[3490,3520],"content":"Declaring the Handler Function"},{"content":"Add your handler function declaration in the .H file.","pos":[3524,3577]},{"content":"The following code shows how this might look, as shown below:","pos":[3578,3639]},{"pos":[3657,3681],"content":"NVC_MFCMessageHandling#7"},{"content":"Handler functions for single commands normally take no parameters.","pos":[3750,3816]},{"content":"With the exception of update handler functions, handler functions for message-map ranges require an extra parameter, <ph id=\"ph1\">`nID`</ph>, of type <bpt id=\"p1\">**</bpt>UINT<ept id=\"p1\">**</ept>.","pos":[3817,3958],"source":" With the exception of update handler functions, handler functions for message-map ranges require an extra parameter, `nID`, of type **UINT**."},{"content":"This parameter is the first parameter.","pos":[3959,3997]},{"content":"The extra parameter accommodates the extra command ID needed to specify which command the user actually chose.","pos":[3998,4108]},{"pos":[4115,4281],"content":"For more information about parameter requirements for updating handler functions, see <bpt id=\"p1\">[</bpt>Example for a Range of Command IDs<ept id=\"p1\">](#_core_example_for_a_range_of_command_ids)</ept>.","source":"For more information about parameter requirements for updating handler functions, see [Example for a Range of Command IDs](#_core_example_for_a_range_of_command_ids)."},{"pos":[4347,4381],"content":"Example for a Range of Command IDs"},{"content":"When might you use ranges One example is in handling commands like the Zoom command in the MFC sample <bpt id=\"p1\">[</bpt>HIERSVR<ept id=\"p1\">](../visual-cpp-samples.md)</ept>.","pos":[4385,4523],"source":"When might you use ranges One example is in handling commands like the Zoom command in the MFC sample [HIERSVR](../visual-cpp-samples.md)."},{"content":"This command zooms the view, scaling it between 25% and 300% of its normal size.","pos":[4524,4604]},{"content":"HIERSVR's view class uses a range to handle the Zoom commands with a message-map entry resembling this:","pos":[4605,4708]},{"pos":[4726,4750],"content":"NVC_MFCMessageHandling#8"},{"content":"When you write the message-map entry, you specify:","pos":[4821,4871]},{"content":"Two command IDs, beginning and ending a contiguous range.","pos":[4881,4938]},{"pos":[4949,5002],"content":"Here they are <ph id=\"ph1\">`ID_VIEW_ZOOM25`</ph> and <ph id=\"ph2\">`ID_VIEW_ZOOM300`</ph>.","source":"Here they are `ID_VIEW_ZOOM25` and `ID_VIEW_ZOOM300`."},{"content":"The name of the handler function for the commands.","pos":[5012,5062]},{"pos":[5073,5092],"content":"Here it's <ph id=\"ph1\">`OnZoom`</ph>.","source":"Here it's `OnZoom`."},{"content":"The function declaration would resemble this:","pos":[5099,5144]},{"pos":[5162,5186],"content":"NVC_MFCMessageHandling#9"},{"content":"The case of update handler functions is similar, and likely to be more widely useful.","pos":[5255,5340]},{"content":"It's quite common to write <ph id=\"ph1\">`ON_UPDATE_COMMAND_UI`</ph> handlers for a number of commands and find yourself writing, or copying, the same code over and over.","pos":[5341,5492],"source":" It's quite common to write `ON_UPDATE_COMMAND_UI` handlers for a number of commands and find yourself writing, or copying, the same code over and over."},{"content":"The solution is to map a range of command IDs to one update handler function using the <ph id=\"ph1\">`ON_UPDATE_COMMAND_UI_RANGE`</ph> macro.","pos":[5493,5615],"source":" The solution is to map a range of command IDs to one update handler function using the `ON_UPDATE_COMMAND_UI_RANGE` macro."},{"content":"The command IDs must form a contiguous range.","pos":[5616,5661]},{"content":"For an example, see the <bpt id=\"p1\">**</bpt>OnUpdateZoom<ept id=\"p1\">**</ept> handler and its <ph id=\"ph1\">`ON_UPDATE_COMMAND_UI_RANGE`</ph> message-map entry in the HIERSVR sample's view class.","pos":[5662,5801],"source":" For an example, see the **OnUpdateZoom** handler and its `ON_UPDATE_COMMAND_UI_RANGE` message-map entry in the HIERSVR sample's view class."},{"content":"Update handler functions for single commands normally take a single parameter, <ph id=\"ph1\">`pCmdUI`</ph>, of type <bpt id=\"p1\">**</bpt>CCmdUI<ph id=\"ph2\">\\*</ph><ept id=\"p1\">**</ept>.","pos":[5808,5918],"source":"Update handler functions for single commands normally take a single parameter, `pCmdUI`, of type **CCmdUI\\***."},{"content":"Unlike handler functions, update handler functions for message-map ranges do not require an extra parameter, <ph id=\"ph1\">`nID`</ph>, of type <bpt id=\"p1\">**</bpt>UINT<ept id=\"p1\">**</ept>.","pos":[5919,6052],"source":" Unlike handler functions, update handler functions for message-map ranges do not require an extra parameter, `nID`, of type **UINT**."},{"content":"The command ID, which is needed to specify which command the user actually chose, is found in the <ph id=\"ph1\">`CCmdUI`</ph> object.","pos":[6053,6167],"source":" The command ID, which is needed to specify which command the user actually chose, is found in the `CCmdUI` object."},{"pos":[6233,6267],"content":"Example for a Range of Control IDs"},{"content":"Another interesting case is mapping control-notification messages for a range of control IDs to a single handler.","pos":[6271,6384]},{"content":"Suppose the user can click any of 10 buttons.","pos":[6385,6430]},{"content":"To map all 10 buttons to one handler, your message-map entry would look like this:","pos":[6431,6513]},{"pos":[6531,6556],"content":"NVC_MFCMessageHandling#10"},{"pos":[6627,6704],"content":"When you write the <ph id=\"ph1\">`ON_CONTROL_RANGE`</ph> macro in your message map, you specify:","source":"When you write the `ON_CONTROL_RANGE` macro in your message map, you specify:"},{"content":"A particular control-notification message.","pos":[6714,6756]},{"pos":[6767,6792],"content":"Here it's <bpt id=\"p1\">**</bpt>BN_CLICKED<ept id=\"p1\">**</ept>.","source":"Here it's **BN_CLICKED**."},{"content":"The control ID values associated with the contiguous range of controls.","pos":[6802,6873]},{"pos":[6884,6932],"content":"Here these are <ph id=\"ph1\">`IDC_BUTTON1`</ph> and <ph id=\"ph2\">`IDC_BUTTON10`</ph>.","source":"Here these are `IDC_BUTTON1` and `IDC_BUTTON10`."},{"content":"The name of the message handler function.","pos":[6942,6983]},{"pos":[6994,7022],"content":"Here it's <ph id=\"ph1\">`OnButtonClicked`</ph>.","source":"Here it's `OnButtonClicked`."},{"pos":[7029,7130],"content":"When you write the handler function, specify the extra <bpt id=\"p1\">**</bpt>UINT<ept id=\"p1\">**</ept> parameter, as shown in the following:","source":"When you write the handler function, specify the extra **UINT** parameter, as shown in the following:"},{"pos":[7148,7173],"content":"NVC_MFCMessageHandling#11"},{"content":"The <ph id=\"ph1\">`OnButtonClicked`</ph> handler for a single <bpt id=\"p1\">**</bpt>BN_CLICKED<ept id=\"p1\">**</ept> message takes no parameters.","pos":[7244,7330],"source":"The `OnButtonClicked` handler for a single **BN_CLICKED** message takes no parameters."},{"content":"The same handler for a range of buttons takes one <bpt id=\"p1\">**</bpt>UINT<ept id=\"p1\">**</ept>.","pos":[7331,7390],"source":" The same handler for a range of buttons takes one **UINT**."},{"content":"The extra parameter allows for identifying the particular control responsible for generating the <bpt id=\"p1\">**</bpt>BN_CLICKED<ept id=\"p1\">**</ept> message.","pos":[7391,7511],"source":" The extra parameter allows for identifying the particular control responsible for generating the **BN_CLICKED** message."},{"content":"The code shown in the example is typical: converting the value passed to an <ph id=\"ph1\">`int`</ph> within the message range and asserting that this is the case.","pos":[7518,7661],"source":"The code shown in the example is typical: converting the value passed to an `int` within the message range and asserting that this is the case."},{"content":"Then you might take some different action depending on which button was clicked.","pos":[7662,7742]},{"content":"See Also","pos":[7751,7759]},{"content":"Declaring Message Handler Functions","pos":[7764,7799]}],"content":"---\ntitle: \"Handlers for Message-Map Ranges | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"message handlers\"\n  - \"handlers, message-map ranges\"\n  - \"message maps, message handler functions\"\n  - \"message maps, ranges\"\n  - \"control-notification messages\"\n  - \"command IDs, message mapping\"\n  - \"message-map ranges\"\n  - \"handlers\"\n  - \"message handling, message handler functions\"\n  - \"mappings, message ranges\"\n  - \"command handling, command update handlers\"\n  - \"controls [MFC], notifications\"\n  - \"handler functions, message-map ranges\"\n  - \"handler functions\"\n  - \"command update handlers\"\n  - \"command routing, command update handlers\"\n  - \"message ranges\"\n  - \"handler functions, declaring\"\n  - \"message ranges, mapping\"\nms.assetid: a271478b-5e1c-46f5-9f29-e5be44b27d08\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Handlers for Message-Map Ranges\nThis article explains how to map a range of messages to a single message handler function (instead of mapping one message to only one function).  \n  \n There are times when you need to process more than one message or control notification in exactly the same way. At such times, you might wish to map all of the messages to a single handler function. Message-map ranges allow you to do this for a contiguous range of messages:  \n  \n-   You can map ranges of command IDs to:  \n  \n    -   A command handler function.  \n  \n    -   A command update handler function.  \n  \n-   You can map control-notification messages for a range of control IDs to a message handler function.  \n  \n Topics covered in this article include:  \n  \n-   [Writing the message-map entry](#_core_writing_the_message.2d.map_entry)  \n  \n-   [Declaring the handler function](#_core_declaring_the_handler_function)  \n  \n-   [Example for a range of command IDs](#_core_example_for_a_range_of_command_ids)  \n  \n-   [Example for a range of control IDs](#_core_example_for_a_range_of_control_ids)  \n  \n##  <a name=\"_core_writing_the_message.2d.map_entry\"></a> Writing the Message-Map Entry  \n In the .CPP file, add your message-map entry, as shown in the following example:  \n  \n [!code-cpp[NVC_MFCMessageHandling#6](../mfc/codesnippet/cpp/handlers-for-message-map-ranges_1.cpp)]  \n  \n The message-map entry consists of the following items:  \n  \n-   The message-map range macro:  \n  \n    -   [ON_COMMAND_RANGE](http://msdn.microsoft.com/library/c52719fc-dd6e-48c9-af79-383f48d608e0)  \n  \n    -   [ON_UPDATE_COMMAND_UI_RANGE](http://msdn.microsoft.com/library/b7105bf1-44ad-4b00-b947-31478f964729)  \n  \n    -   [ON_CONTROL_RANGE](http://msdn.microsoft.com/library/46f0e1bb-569b-4b8b-9b80-89701d1cd7fd)  \n  \n-   Parameters to the macro:  \n  \n     The first two macros take three parameters:  \n  \n    -   The command ID that starts the range  \n  \n    -   The command ID that ends the range  \n  \n    -   The name of the message handler function  \n  \n     The range of command IDs must be contiguous.  \n  \n     The third macro, `ON_CONTROL_RANGE`, takes an additional first parameter: a control-notification message, such as **EN_CHANGE**.  \n  \n##  <a name=\"_core_declaring_the_handler_function\"></a> Declaring the Handler Function  \n Add your handler function declaration in the .H file. The following code shows how this might look, as shown below:  \n  \n [!code-cpp[NVC_MFCMessageHandling#7](../mfc/codesnippet/cpp/handlers-for-message-map-ranges_2.h)]  \n  \n Handler functions for single commands normally take no parameters. With the exception of update handler functions, handler functions for message-map ranges require an extra parameter, `nID`, of type **UINT**. This parameter is the first parameter. The extra parameter accommodates the extra command ID needed to specify which command the user actually chose.  \n  \n For more information about parameter requirements for updating handler functions, see [Example for a Range of Command IDs](#_core_example_for_a_range_of_command_ids).  \n  \n##  <a name=\"_core_example_for_a_range_of_command_ids\"></a> Example for a Range of Command IDs  \n When might you use ranges One example is in handling commands like the Zoom command in the MFC sample [HIERSVR](../visual-cpp-samples.md). This command zooms the view, scaling it between 25% and 300% of its normal size. HIERSVR's view class uses a range to handle the Zoom commands with a message-map entry resembling this:  \n  \n [!code-cpp[NVC_MFCMessageHandling#8](../mfc/codesnippet/cpp/handlers-for-message-map-ranges_3.cpp)]  \n  \n When you write the message-map entry, you specify:  \n  \n-   Two command IDs, beginning and ending a contiguous range.  \n  \n     Here they are `ID_VIEW_ZOOM25` and `ID_VIEW_ZOOM300`.  \n  \n-   The name of the handler function for the commands.  \n  \n     Here it's `OnZoom`.  \n  \n The function declaration would resemble this:  \n  \n [!code-cpp[NVC_MFCMessageHandling#9](../mfc/codesnippet/cpp/handlers-for-message-map-ranges_4.h)]  \n  \n The case of update handler functions is similar, and likely to be more widely useful. It's quite common to write `ON_UPDATE_COMMAND_UI` handlers for a number of commands and find yourself writing, or copying, the same code over and over. The solution is to map a range of command IDs to one update handler function using the `ON_UPDATE_COMMAND_UI_RANGE` macro. The command IDs must form a contiguous range. For an example, see the **OnUpdateZoom** handler and its `ON_UPDATE_COMMAND_UI_RANGE` message-map entry in the HIERSVR sample's view class.  \n  \n Update handler functions for single commands normally take a single parameter, `pCmdUI`, of type **CCmdUI\\***. Unlike handler functions, update handler functions for message-map ranges do not require an extra parameter, `nID`, of type **UINT**. The command ID, which is needed to specify which command the user actually chose, is found in the `CCmdUI` object.  \n  \n##  <a name=\"_core_example_for_a_range_of_control_ids\"></a> Example for a Range of Control IDs  \n Another interesting case is mapping control-notification messages for a range of control IDs to a single handler. Suppose the user can click any of 10 buttons. To map all 10 buttons to one handler, your message-map entry would look like this:  \n  \n [!code-cpp[NVC_MFCMessageHandling#10](../mfc/codesnippet/cpp/handlers-for-message-map-ranges_5.cpp)]  \n  \n When you write the `ON_CONTROL_RANGE` macro in your message map, you specify:  \n  \n-   A particular control-notification message.  \n  \n     Here it's **BN_CLICKED**.  \n  \n-   The control ID values associated with the contiguous range of controls.  \n  \n     Here these are `IDC_BUTTON1` and `IDC_BUTTON10`.  \n  \n-   The name of the message handler function.  \n  \n     Here it's `OnButtonClicked`.  \n  \n When you write the handler function, specify the extra **UINT** parameter, as shown in the following:  \n  \n [!code-cpp[NVC_MFCMessageHandling#11](../mfc/codesnippet/cpp/handlers-for-message-map-ranges_6.cpp)]  \n  \n The `OnButtonClicked` handler for a single **BN_CLICKED** message takes no parameters. The same handler for a range of buttons takes one **UINT**. The extra parameter allows for identifying the particular control responsible for generating the **BN_CLICKED** message.  \n  \n The code shown in the example is typical: converting the value passed to an `int` within the message range and asserting that this is the case. Then you might take some different action depending on which button was clicked.  \n  \n## See Also  \n [Declaring Message Handler Functions](../mfc/declaring-message-handler-functions.md)\n"}