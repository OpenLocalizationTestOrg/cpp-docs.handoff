{"nodes":[{"pos":[12,49],"content":"COleDataObject Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleDataObject Class | Microsoft Docs","pos":[0,37]}]},{"content":"COleDataObject Class","pos":[1012,1032]},{"content":"Used in data transfers for retrieving data in various formats from the Clipboard, through drag and drop, or from an embedded OLE item.","pos":[1033,1167]},{"content":"Syntax","pos":[1176,1182]},{"content":"Members","pos":[1229,1236]},{"content":"Public Constructors","pos":[1246,1265]},{"content":"Name","pos":[1272,1276]},{"content":"Description","pos":[1277,1288]},{"content":"COleDataObject::COleDataObject","pos":[1327,1357]},{"pos":[1392,1429],"content":"Constructs a <ph id=\"ph1\">`COleDataObject`</ph> object.","source":"Constructs a `COleDataObject` object."},{"content":"Public Methods","pos":[1440,1454]},{"content":"Name","pos":[1461,1465]},{"content":"Description","pos":[1466,1477]},{"content":"COleDataObject::Attach","pos":[1516,1538]},{"pos":[1565,1628],"content":"Attaches the specified OLE data object to the <ph id=\"ph1\">`COleDataObject`</ph>.","source":"Attaches the specified OLE data object to the `COleDataObject`."},{"content":"COleDataObject::AttachClipboard","pos":[1634,1665]},{"content":"Attaches the data object that is on the Clipboard.","pos":[1701,1751]},{"content":"COleDataObject::BeginEnumFormats","pos":[1757,1789]},{"pos":[1826,1884],"content":"Prepares for one or more subsequent <ph id=\"ph1\">`GetNextFormat`</ph> calls.","source":"Prepares for one or more subsequent `GetNextFormat` calls."},{"content":"COleDataObject::Detach","pos":[1890,1912]},{"pos":[1939,1984],"content":"Detaches the associated <ph id=\"ph1\">`IDataObject`</ph> object.","source":"Detaches the associated `IDataObject` object."},{"content":"COleDataObject::GetData","pos":[1990,2013]},{"content":"Copies data from the attached OLE data object in a specified format.","pos":[2041,2109]},{"content":"COleDataObject::GetFileData","pos":[2115,2142]},{"pos":[2174,2267],"content":"Copies data from the attached OLE data object into a <ph id=\"ph1\">`CFile`</ph> pointer in the specified format.","source":"Copies data from the attached OLE data object into a `CFile` pointer in the specified format."},{"content":"COleDataObject::GetGlobalData","pos":[2273,2302]},{"pos":[2336,2424],"content":"Copies data from the attached OLE data object into an <ph id=\"ph1\">`HGLOBAL`</ph> in the specified format.","source":"Copies data from the attached OLE data object into an `HGLOBAL` in the specified format."},{"content":"COleDataObject::GetNextFormat","pos":[2430,2459]},{"content":"Returns the next data format available.","pos":[2493,2532]},{"content":"COleDataObject::IsDataAvailable","pos":[2538,2569]},{"content":"Checks whether data is available in a specified format.","pos":[2605,2660]},{"content":"COleDataObject::Release","pos":[2666,2689]},{"pos":[2717,2775],"content":"Detaches and releases the associated <ph id=\"ph1\">`IDataObject`</ph> object.","source":"Detaches and releases the associated `IDataObject` object."},{"content":"Remarks","pos":[2785,2792]},{"pos":[2813,2840],"content":"does not have a base class."},{"content":"These kinds of data transfers include a source and a destination.","pos":[2847,2912]},{"content":"The data source is implemented as an object of the <bpt id=\"p1\">[</bpt>COleDataSource<ept id=\"p1\">](../../mfc/reference/coledatasource-class.md)</ept> class.","pos":[2913,3032],"source":" The data source is implemented as an object of the [COleDataSource](../../mfc/reference/coledatasource-class.md) class."},{"content":"Whenever a destination application has data dropped in it or is asked to perform a paste operation from the Clipboard, an object of the <ph id=\"ph1\">`COleDataObject`</ph> class must be created.","pos":[3033,3208],"source":" Whenever a destination application has data dropped in it or is asked to perform a paste operation from the Clipboard, an object of the `COleDataObject` class must be created."},{"content":"This class enables you to determine whether the data exists in a specified format.","pos":[3215,3297]},{"content":"You can also enumerate the available data formats or check whether a given format is available and then retrieve the data in the preferred format.","pos":[3298,3444]},{"content":"Object retrieval can be accomplished in several different ways, including the use of a <bpt id=\"p1\">[</bpt>CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md)</ept>, an <ph id=\"ph1\">`HGLOBAL`</ph>, or an <bpt id=\"p2\">**</bpt>STGMEDIUM<ept id=\"p2\">**</ept> structure.","pos":[3445,3621],"source":" Object retrieval can be accomplished in several different ways, including the use of a [CFile](../../mfc/reference/cfile-class.md), an `HGLOBAL`, or an **STGMEDIUM** structure."},{"pos":[3628,3799],"content":"For more information, see the <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3806,3975],"content":"For more information about using data objects in your application, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources (OLE)<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-ole.md)</ept>.","source":"For more information about using data objects in your application, see the article [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md)."},{"content":"Inheritance Hierarchy","pos":[3984,4005]},{"content":"Requirements","pos":[4034,4046]},{"pos":[4050,4070],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxole.h","source":"**Header:** afxole.h"},{"pos":[4119,4141],"content":"COleDataObject::Attach"},{"pos":[4145,4229],"content":"Call this function to associate the <ph id=\"ph1\">`COleDataObject`</ph> object with an OLE data object.","source":"Call this function to associate the `COleDataObject` object with an OLE data object."},{"content":"Parameters","pos":[4331,4341]},{"content":"lpDataObject","pos":[4346,4358]},{"content":"Points to an OLE data object.","pos":[4363,4392]},{"content":"<bpt id=\"p1\"> **</bpt>TRUE<ept id=\"p1\">**</ept> if the OLE data object should be released when the <ph id=\"ph1\">`COleDataObject`</ph> object is destroyed; otherwise <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","pos":[4416,4535],"source":" **TRUE** if the OLE data object should be released when the `COleDataObject` object is destroyed; otherwise **FALSE**."},{"content":"Remarks","pos":[4545,4552]},{"pos":[4556,4715],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDataObject<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms688421)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4773,4804],"content":"COleDataObject::AttachClipboard"},{"pos":[4808,4919],"content":"Call this function to attach the data object that is currently on the Clipboard to the <ph id=\"ph1\">`COleDataObject`</ph> object.","source":"Call this function to attach the data object that is currently on the Clipboard to the `COleDataObject` object."},{"content":"Return Value","pos":[4968,4980]},{"content":"Nonzero if successful; otherwise 0.","pos":[4984,5019]},{"content":"Remarks","pos":[5029,5036]},{"pos":[5044,5413],"content":"[!NOTE]\n Calling this function locks the Clipboard until this data object is released. The data object is released in the destructor for the `COleDataObject`. For more information, see [OpenClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649048) and [CloseClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649035) in the Win32 documention.","leadings":["","> "],"nodes":[{"content":" Calling this function locks the Clipboard until this data object is released. The data object is released in the destructor for the `COleDataObject`. For more information, see [OpenClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649048) and [CloseClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649035) in the Win32 documention.","pos":[8,367],"nodes":[{"content":"Calling this function locks the Clipboard until this data object is released.","pos":[1,78]},{"content":"The data object is released in the destructor for the <ph id=\"ph1\">`COleDataObject`</ph>.","pos":[79,150],"source":" The data object is released in the destructor for the `COleDataObject`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>OpenClipboard<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649048)</ept> and <bpt id=\"p2\">[</bpt>CloseClipboard<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms649035)</ept> in the Win32 documention.","pos":[151,359],"source":" For more information, see [OpenClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649048) and [CloseClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649035) in the Win32 documention."}]}]},{"pos":[5472,5504],"content":"COleDataObject::BeginEnumFormats"},{"pos":[5508,5630],"content":"Call this function to prepare for subsequent calls to <ph id=\"ph1\">`GetNextFormat`</ph> for retrieving a list of data formats from the item.","source":"Call this function to prepare for subsequent calls to `GetNextFormat` for retrieving a list of data formats from the item."},{"content":"Remarks","pos":[5680,5687]},{"content":"After a call to <ph id=\"ph1\">`BeginEnumFormats`</ph>, the position of the first format supported by this data object is stored.","pos":[5691,5800],"source":"After a call to `BeginEnumFormats`, the position of the first format supported by this data object is stored."},{"content":"Successive calls to <ph id=\"ph1\">`GetNextFormat`</ph> will enumerate the list of available formats in the data object.","pos":[5801,5901],"source":" Successive calls to `GetNextFormat` will enumerate the list of available formats in the data object."},{"pos":[5908,6036],"content":"To check on the availability of data in a given format, use <bpt id=\"p1\">[</bpt>COleDataObject::IsDataAvailable<ept id=\"p1\">](#coledataobject__isdataavailable)</ept>.","source":"To check on the availability of data in a given format, use [COleDataObject::IsDataAvailable](#coledataobject__isdataavailable)."},{"pos":[6043,6217],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDataObject::EnumFormatEtc<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683979)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDataObject::EnumFormatEtc](http://msdn.microsoft.com/library/windows/desktop/ms683979) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6274,6304],"content":"COleDataObject::COleDataObject"},{"pos":[6308,6345],"content":"Constructs a <ph id=\"ph1\">`COleDataObject`</ph> object.","source":"Constructs a `COleDataObject` object."},{"content":"Remarks","pos":[6388,6395]},{"pos":[6399,6591],"content":"A call to <bpt id=\"p1\">[</bpt>COleDataObject::Attach<ept id=\"p1\">](#coledataobject__attach)</ept> or <bpt id=\"p2\">[</bpt>COleDataObject::AttachClipboard<ept id=\"p2\">](#coledataobject__attachclipboard)</ept> must be made before calling other <ph id=\"ph1\">`COleDataObject`</ph> functions.","source":"A call to [COleDataObject::Attach](#coledataobject__attach) or [COleDataObject::AttachClipboard](#coledataobject__attachclipboard) must be made before calling other `COleDataObject` functions."},{"pos":[6599,6771],"content":"[!NOTE]\n Since one of the parameters to the drag-and-drop handlers is a pointer to a `COleDataObject`, there is no need to call this constructor to support drag and drop.","leadings":["","> "],"nodes":[{"content":"Since one of the parameters to the drag-and-drop handlers is a pointer to a <ph id=\"ph1\">`COleDataObject`</ph>, there is no need to call this constructor to support drag and drop.","pos":[9,170],"source":" Since one of the parameters to the drag-and-drop handlers is a pointer to a `COleDataObject`, there is no need to call this constructor to support drag and drop."}]},{"pos":[6820,6842],"content":"COleDataObject::Detach"},{"pos":[6846,6973],"content":"Call this function to detach the <ph id=\"ph1\">`COleDataObject`</ph> object from its associated OLE data object without releasing the data object.","source":"Call this function to detach the `COleDataObject` object from its associated OLE data object without releasing the data object."},{"content":"Return Value","pos":[7021,7033]},{"content":"A pointer to the OLE data object that was detached.","pos":[7037,7088]},{"content":"Remarks","pos":[7098,7105]},{"pos":[7155,7178],"content":"COleDataObject::GetData"},{"content":"Call this function to retrieve data from the item in the specified format.","pos":[7182,7256]},{"content":"Parameters","pos":[7390,7400]},{"content":"The format in which data is to be returned.","pos":[7418,7461]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[7462,7663],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure that will receive data.","pos":[7687,7804],"source":" Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure that will receive data."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which data is to be returned.","pos":[7828,7976],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[7977,8117],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[8118,8217],"source":" If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure."},{"content":"Return Value","pos":[8227,8239]},{"content":"Nonzero if successful; otherwise 0.","pos":[8243,8278]},{"content":"Remarks","pos":[8288,8295]},{"pos":[8299,8617],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDataObject::GetData<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms678431)</ept>, <bpt id=\"p2\">[</bpt>STGMEDIUM<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept>, and <bpt id=\"p3\">[</bpt>FORMATETC<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431), [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812), and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8624,8795],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8849,8876],"content":"COleDataObject::GetFileData"},{"pos":[8880,9013],"content":"Call this function to create a <ph id=\"ph1\">`CFile`</ph> or <ph id=\"ph2\">`CFile`</ph>-derived object and to retrieve data in the specified format into a <ph id=\"ph3\">`CFile`</ph> pointer.","source":"Call this function to create a `CFile` or `CFile`-derived object and to retrieve data in the specified format into a `CFile` pointer."},{"content":"Parameters","pos":[9122,9132]},{"content":"The format in which data is to be returned.","pos":[9150,9193]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[9194,9395],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which data is to be returned.","pos":[9419,9567],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[9568,9708],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[9709,9808],"source":" If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure."},{"content":"Return Value","pos":[9818,9830]},{"pos":[9834,9941],"content":"Pointer to the new <ph id=\"ph1\">`CFile`</ph> or <ph id=\"ph2\">`CFile`</ph>-derived object containing the data if successful; otherwise <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"Pointer to the new `CFile` or `CFile`-derived object containing the data if successful; otherwise **NULL**."},{"content":"Remarks","pos":[9951,9958]},{"pos":[9962,10107],"content":"Depending on the medium the data is stored in, the actual type pointed to by the return value may be <ph id=\"ph1\">`CFile`</ph>, <ph id=\"ph2\">`CSharedFile`</ph>, or <ph id=\"ph3\">`COleStreamFile`</ph>.","source":"Depending on the medium the data is stored in, the actual type pointed to by the return value may be `CFile`, `CSharedFile`, or `COleStreamFile`."},{"pos":[10115,10313],"content":"[!NOTE]\n The `CFile` object accessed by the return value of this function is owned by the caller. It is the responsibility of the caller to **delete** the `CFile` object, thereby closing the file.","leadings":["","> "],"nodes":[{"content":" The `CFile` object accessed by the return value of this function is owned by the caller. It is the responsibility of the caller to **delete** the `CFile` object, thereby closing the file.","pos":[8,196],"nodes":[{"content":"The <ph id=\"ph1\">`CFile`</ph> object accessed by the return value of this function is owned by the caller.","pos":[1,89],"source":" The `CFile` object accessed by the return value of this function is owned by the caller."},{"content":"It is the responsibility of the caller to <bpt id=\"p1\">**</bpt>delete<ept id=\"p1\">**</ept> the <ph id=\"ph1\">`CFile`</ph> object, thereby closing the file.","pos":[90,188],"source":" It is the responsibility of the caller to **delete** the `CFile` object, thereby closing the file."}]}]},{"pos":[10320,10477],"content":"For more information, see <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[10484,10655],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[10711,10740],"content":"COleDataObject::GetGlobalData"},{"pos":[10744,10860],"content":"Call this function to allocate a global memory block and to retrieve data in the specified format into an <ph id=\"ph1\">`HGLOBAL`</ph>.","source":"Call this function to allocate a global memory block and to retrieve data in the specified format into an `HGLOBAL`."},{"content":"Parameters","pos":[10972,10982]},{"content":"The format in which data is to be returned.","pos":[11000,11043]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[11044,11245],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which data is to be returned.","pos":[11269,11417],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[11418,11558],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[11559,11658],"source":" If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure."},{"content":"Return Value","pos":[11668,11680]},{"pos":[11684,11776],"content":"The handle of the global memory block containing the data if successful; otherwise <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"The handle of the global memory block containing the data if successful; otherwise **NULL**."},{"content":"Remarks","pos":[11786,11793]},{"pos":[11797,11954],"content":"For more information, see <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[11961,12132],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[12188,12217],"content":"COleDataObject::GetNextFormat"},{"content":"Call this function repeatedly to obtain all the formats available for retrieving data from the item.","pos":[12221,12321]},{"content":"Parameters","pos":[12391,12401]},{"content":"Points to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure that receives the format information when the function call returns.","pos":[12422,12586],"source":" Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure that receives the format information when the function call returns."},{"content":"Return Value","pos":[12596,12608]},{"content":"Nonzero if another format is available; otherwise 0.","pos":[12612,12664]},{"content":"Remarks","pos":[12674,12681]},{"content":"After a call to <bpt id=\"p1\">[</bpt>COleDataObject::BeginEnumFormats<ept id=\"p1\">](#coledataobject__beginenumformats)</ept>, the position of the first format supported by this data object is stored.","pos":[12685,12845],"source":"After a call to [COleDataObject::BeginEnumFormats](#coledataobject__beginenumformats), the position of the first format supported by this data object is stored."},{"content":"Successive calls to <ph id=\"ph1\">`GetNextFormat`</ph> will enumerate the list of available formats in the data object.","pos":[12846,12946],"source":" Successive calls to `GetNextFormat` will enumerate the list of available formats in the data object."},{"content":"Use these functions to list the available formats.","pos":[12947,12997]},{"pos":[13004,13126],"content":"To check for the availability of a given format, call <bpt id=\"p1\">[</bpt>COleDataObject::IsDataAvailable<ept id=\"p1\">](#coledataobject__isdataavailable)</ept>.","source":"To check for the availability of a given format, call [COleDataObject::IsDataAvailable](#coledataobject__isdataavailable)."},{"pos":[13133,13286],"content":"For more information, see <bpt id=\"p1\">[</bpt>IEnumXXXX::Next<ept id=\"p1\">](https://msdn.microsoft.com/library/ms695273.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IEnumXXXX::Next](https://msdn.microsoft.com/library/ms695273.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[13344,13375],"content":"COleDataObject::IsDataAvailable"},{"content":"Call this function to determine if a particular format is available for retrieving data from the OLE item.","pos":[13379,13485]},{"content":"Parameters","pos":[13596,13606]},{"content":"The Clipboard data format to be used in the structure pointed to by <ph id=\"ph1\">`lpFormatEtc`</ph>.","pos":[13624,13706],"source":" The Clipboard data format to be used in the structure pointed to by `lpFormatEtc`."},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[13707,13908],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format desired.","pos":[13932,14056],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format desired."},{"content":"Provide a value for this parameter only if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[14057,14202],"source":" Provide a value for this parameter only if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[14203,14302],"source":" If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure."},{"content":"Return Value","pos":[14312,14324]},{"content":"Nonzero if data is available in the specified format; otherwise 0.","pos":[14328,14394]},{"content":"Remarks","pos":[14404,14411]},{"pos":[14415,14499],"content":"This function is useful before calling <ph id=\"ph1\">`GetData`</ph>, <ph id=\"ph2\">`GetFileData`</ph>, or <ph id=\"ph3\">`GetGlobalData`</ph>.","source":"This function is useful before calling `GetData`, `GetFileData`, or `GetGlobalData`."},{"pos":[14506,14755],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDataObject::QueryGetData<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680637)</ept> and <bpt id=\"p2\">[</bpt>FORMATETC<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDataObject::QueryGetData](http://msdn.microsoft.com/library/windows/desktop/ms680637) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[14762,14933],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[14943,14950]},{"pos":[14955,15083],"content":"See the example for <bpt id=\"p1\">[</bpt>CRichEditView::QueryAcceptData<ept id=\"p1\">](../../mfc/reference/cricheditview-class.md#cricheditview__queryacceptdata)</ept>.","source":"See the example for [CRichEditView::QueryAcceptData](../../mfc/reference/cricheditview-class.md#cricheditview__queryacceptdata)."},{"pos":[15133,15156],"content":"COleDataObject::Release"},{"pos":[15160,15352],"content":"Call this function to release ownership of the <bpt id=\"p1\">[</bpt>IDataObject<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms688421)</ept> object that was previously associated with the <ph id=\"ph1\">`COleDataObject`</ph> object.","source":"Call this function to release ownership of the [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) object that was previously associated with the `COleDataObject` object."},{"content":"Remarks","pos":[15393,15400]},{"content":"The <ph id=\"ph1\">`IDataObject`</ph> was associated with the <ph id=\"ph2\">`COleDataObject`</ph> by calling <bpt id=\"p1\">**</bpt>Attach<ept id=\"p1\">**</ept> or <ph id=\"ph3\">`AttachClipboard`</ph> explicitly or by the framework.","pos":[15404,15537],"source":"The `IDataObject` was associated with the `COleDataObject` by calling **Attach** or `AttachClipboard` explicitly or by the framework."},{"content":"If the <ph id=\"ph1\">`bAutoRelease`</ph> parameter of <bpt id=\"p1\">**</bpt>Attach<ept id=\"p1\">**</ept> is <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>, the <ph id=\"ph2\">`IDataObject`</ph> object will not be released.","pos":[15538,15644],"source":" If the `bAutoRelease` parameter of **Attach** is **FALSE**, the `IDataObject` object will not be released."},{"content":"In this case, the caller is responsible for releasing the <ph id=\"ph1\">`IDataObject`</ph> by calling <bpt id=\"p1\">[</bpt>IUnknown::Release<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682317)</ept>.","pos":[15645,15808],"source":" In this case, the caller is responsible for releasing the `IDataObject` by calling [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317)."},{"content":"See Also","pos":[15817,15825]},{"content":"MFC Sample HIERSVR","pos":[15830,15848]},{"content":"MFC Sample OCLIENT","pos":[15884,15902]},{"content":"Hierarchy Chart","pos":[15938,15953]},{"content":"COleDataSource Class","pos":[15990,16010]},{"content":"COleClientItem Class","pos":[16062,16082]},{"content":"COleServerItem Class","pos":[16134,16154]}],"content":"---\ntitle: \"COleDataObject Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"IDataObject\"\n  - \"COleDataObject\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"drag and drop [C++], MFC support\"\n  - \"Clipboard [C++], OLE support\"\n  - \"uniform data transfer\"\n  - \"OLE [C++], uniform data transfer\"\n  - \"Clipboard [C++], MFC support\"\n  - \"OLE Clipboard [C++], support\"\n  - \"IDataObject interface, MFC encapsulation\"\n  - \"data transfer [C++]\"\n  - \"data transfer [C++], OLE\"\n  - \"OLE data transfer [C++]\"\n  - \"COleDataObject class\"\n  - \"uniform data transfer, OLE\"\nms.assetid: d1cc84be-2e1c-4bb3-a8a0-565eb08aaa34\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleDataObject Class\nUsed in data transfers for retrieving data in various formats from the Clipboard, through drag and drop, or from an embedded OLE item.  \n  \n## Syntax  \n  \n```  \nclass COleDataObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDataObject::COleDataObject](#coledataobject__coledataobject)|Constructs a `COleDataObject` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDataObject::Attach](#coledataobject__attach)|Attaches the specified OLE data object to the `COleDataObject`.|  \n|[COleDataObject::AttachClipboard](#coledataobject__attachclipboard)|Attaches the data object that is on the Clipboard.|  \n|[COleDataObject::BeginEnumFormats](#coledataobject__beginenumformats)|Prepares for one or more subsequent `GetNextFormat` calls.|  \n|[COleDataObject::Detach](#coledataobject__detach)|Detaches the associated `IDataObject` object.|  \n|[COleDataObject::GetData](#coledataobject__getdata)|Copies data from the attached OLE data object in a specified format.|  \n|[COleDataObject::GetFileData](#coledataobject__getfiledata)|Copies data from the attached OLE data object into a `CFile` pointer in the specified format.|  \n|[COleDataObject::GetGlobalData](#coledataobject__getglobaldata)|Copies data from the attached OLE data object into an `HGLOBAL` in the specified format.|  \n|[COleDataObject::GetNextFormat](#coledataobject__getnextformat)|Returns the next data format available.|  \n|[COleDataObject::IsDataAvailable](#coledataobject__isdataavailable)|Checks whether data is available in a specified format.|  \n|[COleDataObject::Release](#coledataobject__release)|Detaches and releases the associated `IDataObject` object.|  \n  \n## Remarks  \n `COleDataObject` does not have a base class.  \n  \n These kinds of data transfers include a source and a destination. The data source is implemented as an object of the [COleDataSource](../../mfc/reference/coledatasource-class.md) class. Whenever a destination application has data dropped in it or is asked to perform a paste operation from the Clipboard, an object of the `COleDataObject` class must be created.  \n  \n This class enables you to determine whether the data exists in a specified format. You can also enumerate the available data formats or check whether a given format is available and then retrieve the data in the preferred format. Object retrieval can be accomplished in several different ways, including the use of a [CFile](../../mfc/reference/cfile-class.md), an `HGLOBAL`, or an **STGMEDIUM** structure.  \n  \n For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information about using data objects in your application, see the article [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md).  \n  \n## Inheritance Hierarchy  \n `COleDataObject`  \n  \n## Requirements  \n **Header:** afxole.h  \n  \n##  <a name=\"coledataobject__attach\"></a>  COleDataObject::Attach  \n Call this function to associate the `COleDataObject` object with an OLE data object.  \n  \n```  \nvoid Attach(\n    LPDATAOBJECT lpDataObject,  \n    BOOL bAutoRelease = TRUE);\n```  \n  \n### Parameters  \n *lpDataObject*  \n Points to an OLE data object.  \n  \n `bAutoRelease`  \n **TRUE** if the OLE data object should be released when the `COleDataObject` object is destroyed; otherwise **FALSE**.  \n  \n### Remarks  \n For more information, see [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__attachclipboard\"></a>  COleDataObject::AttachClipboard  \n Call this function to attach the data object that is currently on the Clipboard to the `COleDataObject` object.  \n  \n```  \nBOOL AttachClipboard();\n```  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n  \n> [!NOTE]\n>  Calling this function locks the Clipboard until this data object is released. The data object is released in the destructor for the `COleDataObject`. For more information, see [OpenClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649048) and [CloseClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649035) in the Win32 documention.  \n  \n##  <a name=\"coledataobject__beginenumformats\"></a>  COleDataObject::BeginEnumFormats  \n Call this function to prepare for subsequent calls to `GetNextFormat` for retrieving a list of data formats from the item.  \n  \n```  \nvoid BeginEnumFormats();\n```  \n  \n### Remarks  \n After a call to `BeginEnumFormats`, the position of the first format supported by this data object is stored. Successive calls to `GetNextFormat` will enumerate the list of available formats in the data object.  \n  \n To check on the availability of data in a given format, use [COleDataObject::IsDataAvailable](#coledataobject__isdataavailable).  \n  \n For more information, see [IDataObject::EnumFormatEtc](http://msdn.microsoft.com/library/windows/desktop/ms683979) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__coledataobject\"></a>  COleDataObject::COleDataObject  \n Constructs a `COleDataObject` object.  \n  \n```  \nCOleDataObject();\n```  \n  \n### Remarks  \n A call to [COleDataObject::Attach](#coledataobject__attach) or [COleDataObject::AttachClipboard](#coledataobject__attachclipboard) must be made before calling other `COleDataObject` functions.  \n  \n> [!NOTE]\n>  Since one of the parameters to the drag-and-drop handlers is a pointer to a `COleDataObject`, there is no need to call this constructor to support drag and drop.  \n  \n##  <a name=\"coledataobject__detach\"></a>  COleDataObject::Detach  \n Call this function to detach the `COleDataObject` object from its associated OLE data object without releasing the data object.  \n  \n```  \nLPDATAOBJECT Detach();\n```  \n  \n### Return Value  \n A pointer to the OLE data object that was detached.  \n  \n### Remarks  \n  \n##  <a name=\"coledataobject__getdata\"></a>  COleDataObject::GetData  \n Call this function to retrieve data from the item in the specified format.  \n  \n```  \nBOOL GetData(\n    CLIPFORMAT cfFormat,  \n    LPSTGMEDIUM lpStgMedium,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The format in which data is to be returned. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpStgMedium`  \n Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure that will receive data.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n For more information, see [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431), [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812), and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__getfiledata\"></a>  COleDataObject::GetFileData  \n Call this function to create a `CFile` or `CFile`-derived object and to retrieve data in the specified format into a `CFile` pointer.  \n  \n```  \nCFile* GetFileData(\n    CLIPFORMAT cfFormat,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The format in which data is to be returned. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Return Value  \n Pointer to the new `CFile` or `CFile`-derived object containing the data if successful; otherwise **NULL**.  \n  \n### Remarks  \n Depending on the medium the data is stored in, the actual type pointed to by the return value may be `CFile`, `CSharedFile`, or `COleStreamFile`.  \n  \n> [!NOTE]\n>  The `CFile` object accessed by the return value of this function is owned by the caller. It is the responsibility of the caller to **delete** the `CFile` object, thereby closing the file.  \n  \n For more information, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__getglobaldata\"></a>  COleDataObject::GetGlobalData  \n Call this function to allocate a global memory block and to retrieve data in the specified format into an `HGLOBAL`.  \n  \n```  \nHGLOBAL GetGlobalData(\n    CLIPFORMAT cfFormat,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The format in which data is to be returned. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Return Value  \n The handle of the global memory block containing the data if successful; otherwise **NULL**.  \n  \n### Remarks  \n For more information, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__getnextformat\"></a>  COleDataObject::GetNextFormat  \n Call this function repeatedly to obtain all the formats available for retrieving data from the item.  \n  \n```  \nBOOL GetNextFormat(LPFORMATETC lpFormatEtc);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure that receives the format information when the function call returns.  \n  \n### Return Value  \n Nonzero if another format is available; otherwise 0.  \n  \n### Remarks  \n After a call to [COleDataObject::BeginEnumFormats](#coledataobject__beginenumformats), the position of the first format supported by this data object is stored. Successive calls to `GetNextFormat` will enumerate the list of available formats in the data object. Use these functions to list the available formats.  \n  \n To check for the availability of a given format, call [COleDataObject::IsDataAvailable](#coledataobject__isdataavailable).  \n  \n For more information, see [IEnumXXXX::Next](https://msdn.microsoft.com/library/ms695273.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__isdataavailable\"></a>  COleDataObject::IsDataAvailable  \n Call this function to determine if a particular format is available for retrieving data from the OLE item.  \n  \n```  \nBOOL IsDataAvailable(\n    CLIPFORMAT cfFormat,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The Clipboard data format to be used in the structure pointed to by `lpFormatEtc`. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format desired. Provide a value for this parameter only if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Return Value  \n Nonzero if data is available in the specified format; otherwise 0.  \n  \n### Remarks  \n This function is useful before calling `GetData`, `GetFileData`, or `GetGlobalData`.  \n  \n For more information, see [IDataObject::QueryGetData](http://msdn.microsoft.com/library/windows/desktop/ms680637) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n  See the example for [CRichEditView::QueryAcceptData](../../mfc/reference/cricheditview-class.md#cricheditview__queryacceptdata).  \n  \n##  <a name=\"coledataobject__release\"></a>  COleDataObject::Release  \n Call this function to release ownership of the [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) object that was previously associated with the `COleDataObject` object.  \n  \n```  \nvoid Release();\n```  \n  \n### Remarks  \n The `IDataObject` was associated with the `COleDataObject` by calling **Attach** or `AttachClipboard` explicitly or by the framework. If the `bAutoRelease` parameter of **Attach** is **FALSE**, the `IDataObject` object will not be released. In this case, the caller is responsible for releasing the `IDataObject` by calling [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317).  \n  \n## See Also  \n [MFC Sample HIERSVR](../../visual-cpp-samples.md)   \n [MFC Sample OCLIENT](../../visual-cpp-samples.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [COleDataSource Class](../../mfc/reference/coledatasource-class.md)   \n [COleClientItem Class](../../mfc/reference/coleclientitem-class.md)   \n [COleServerItem Class](../../mfc/reference/coleserveritem-class.md)\n"}