{"nodes":[{"pos":[12,55],"content":"Active Document Containers | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Active Document Containers | Microsoft Docs","pos":[0,43]}]},{"content":"Active Document Containers","pos":[727,753]},{"content":"An active document container, such as Microsoft Office Binder or Internet Explorer, allows you to work with several documents of different application types within a single frame (instead of forcing you to create and use multiple application frames for each document type).","pos":[754,1027]},{"content":"MFC provides full support for active document containers in the <ph id=\"ph1\">`COleDocObjectItem`</ph> class.","pos":[1034,1124],"source":"MFC provides full support for active document containers in the `COleDocObjectItem` class."},{"content":"You can use the MFC Application Wizard to create an active document container by selecting the <bpt id=\"p1\">**</bpt>Active document container<ept id=\"p1\">**</ept> check box on the <bpt id=\"p2\">**</bpt>Compound Document Support<ept id=\"p2\">**</ept> page of the MFC Application Wizard.","pos":[1125,1332],"source":" You can use the MFC Application Wizard to create an active document container by selecting the **Active document container** check box on the **Compound Document Support** page of the MFC Application Wizard."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating an Active Document Container Application<ept id=\"p1\">](../mfc/creating-an-active-document-container-application.md)</ept>.","pos":[1333,1472],"source":" For more information, see [Creating an Active Document Container Application](../mfc/creating-an-active-document-container-application.md)."},{"content":"For more information about active document containers, see:","pos":[1479,1538]},{"content":"Container Requirements","pos":[1549,1571]},{"content":"Document Site Objects","pos":[1608,1629]},{"content":"View Site Objects","pos":[1665,1682]},{"content":"Frame Object","pos":[1714,1726]},{"content":"Help Menu Merging","pos":[1753,1770]},{"content":"Programmatic Printing","pos":[1811,1832]},{"content":"Command Targets","pos":[1877,1892]},{"pos":[1989,2011],"content":"Container Requirements"},{"content":"Active document support in an active document container implies more than just interface implementations: it also requires knowledge of using the interfaces of a contained object.","pos":[2015,2194]},{"content":"The same applies to active document extensions, where the container must also know how to use those extension interfaces on the active documents themselves.","pos":[2195,2351]},{"content":"An active document container that integrates active documents must:","pos":[2358,2425]},{"pos":[2435,2588],"content":"Be capable of handling object storage through the <bpt id=\"p1\">**</bpt>IPersistStorage<ept id=\"p1\">**</ept> interface, that is, it must provide an <ph id=\"ph1\">`IStorage`</ph> instance to each active document.","source":"Be capable of handling object storage through the **IPersistStorage** interface, that is, it must provide an `IStorage` instance to each active document."},{"pos":[2598,2768],"content":"Support the basic embedding features of OLE documents, necessitating \"site\" objects (one per document or embedding) that implement <bpt id=\"p1\">**</bpt>IOleClientSite<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>IAdviseSink<ept id=\"p2\">**</ept>.","source":"Support the basic embedding features of OLE documents, necessitating \"site\" objects (one per document or embedding) that implement **IOleClientSite** and **IAdviseSink**."},{"content":"Support in-place activation of embedded objects or active documents.","pos":[2778,2846]},{"content":"The container's site objects must implement <ph id=\"ph1\">`IOleInPlaceSite`</ph> and the container's frame object must provide <bpt id=\"p1\">**</bpt>IOleInPlaceFrame<ept id=\"p1\">**</ept>.","pos":[2847,2976],"source":" The container's site objects must implement `IOleInPlaceSite` and the container's frame object must provide **IOleInPlaceFrame**."},{"content":"Support the active documents' extensions by implementing <ph id=\"ph1\">`IOleDocumentSite`</ph> to provide the mechanism for the container to talk to the document.","pos":[2986,3129],"source":"Support the active documents' extensions by implementing `IOleDocumentSite` to provide the mechanism for the container to talk to the document."},{"content":"Optionally, the container can implement the active document interfaces <ph id=\"ph1\">`IOleCommandTarget`</ph> and <ph id=\"ph2\">`IContinueCallback`</ph> to pick up simple commands such as printing or saving.","pos":[3130,3299],"source":" Optionally, the container can implement the active document interfaces `IOleCommandTarget` and `IContinueCallback` to pick up simple commands such as printing or saving."},{"content":"The frame object, the view objects, and the container object can optionally implement <bpt id=\"p1\">**</bpt>IOleCommandTarget<ept id=\"p1\">**</ept> to support the dispatch of certain commands, as discussed in <bpt id=\"p2\">[</bpt>Command Targets<ept id=\"p2\">](../mfc/message-handling-and-command-targets.md)</ept>.","pos":[3306,3541],"source":"The frame object, the view objects, and the container object can optionally implement **IOleCommandTarget** to support the dispatch of certain commands, as discussed in [Command Targets](../mfc/message-handling-and-command-targets.md)."},{"content":"View and container objects can also optionally implement <ph id=\"ph1\">`IPrint`</ph> and <ph id=\"ph2\">`IContinueCallback`</ph>, to support programmatic printing, as discussed in <bpt id=\"p1\">[</bpt>Programmatic Printing<ept id=\"p1\">](../mfc/programmatic-printing.md)</ept>.","pos":[3542,3740],"source":" View and container objects can also optionally implement `IPrint` and `IContinueCallback`, to support programmatic printing, as discussed in [Programmatic Printing](../mfc/programmatic-printing.md)."},{"content":"The following figure shows the conceptual relationships between a container and its components (at left), and the active document and its views (at right).","pos":[3747,3902]},{"content":"The active document manages storage and data, and the view displays or optionally prints that data.","pos":[3903,4002]},{"content":"Interfaces in bold are those required for active document participation; those bold and italic are optional.","pos":[4003,4111]},{"content":"All other interfaces are required.","pos":[4112,4146]},{"content":"Active document container interfaces","pos":[4155,4191]},{"content":"A document that supports only a single view can implement both the view and document components (that is, their corresponding interfaces) on a single concrete class.","pos":[4235,4400]},{"content":"In addition, a container site that only supports one view at a time can combine the document site and the view site into a single concrete site class.","pos":[4401,4551]},{"content":"The container's frame object, however, must remain distinct, and the container's document component is merely included here to give a complete picture of the architecture; it is not affected by the active document containment architecture.","pos":[4552,4791]},{"pos":[4838,4859],"content":"Document Site Objects"},{"pos":[4863,5031],"content":"In the active document containment architecture, a document site is the same as a client site object in OLE Documents with the addition of the <ph id=\"ph1\">`IOleDocument`</ph> interface:","source":"In the active document containment architecture, a document site is the same as a client site object in OLE Documents with the addition of the `IOleDocument` interface:"},{"content":"The document site is conceptually the container for one or more \"view site\" objects.","pos":[5167,5251]},{"content":"Each view site object is associated with individual view objects of the document managed by the document site.","pos":[5252,5362]},{"content":"If the container only supports a single view per document site, then it can implement the document site and the view site with a single concrete class.","pos":[5363,5514]},{"pos":[5557,5574],"content":"View Site Objects"},{"content":"A container's view site object manages the display space for a particular view of a document.","pos":[5578,5671]},{"content":"In addition to supporting the standard <ph id=\"ph1\">`IOleInPlaceSite`</ph> interface, a view site also generally implements <ph id=\"ph2\">`IContinueCallback`</ph> for programmatic printing control.","pos":[5672,5832],"source":" In addition to supporting the standard `IOleInPlaceSite` interface, a view site also generally implements `IContinueCallback` for programmatic printing control."},{"content":"(Note that the view object never queries for <ph id=\"ph1\">`IContinueCallback`</ph> so it can actually be implemented on any object the container desires.)","pos":[5833,5969],"source":" (Note that the view object never queries for `IContinueCallback` so it can actually be implemented on any object the container desires.)"},{"content":"A container that supports multiple views must be able to create multiple view site objects within the document site.","pos":[5976,6092]},{"content":"This provides each view with separate activation and deactivation services as provided through <ph id=\"ph1\">`IOleInPlaceSite`</ph>.","pos":[6093,6206],"source":" This provides each view with separate activation and deactivation services as provided through `IOleInPlaceSite`."},{"pos":[6244,6256],"content":"Frame Object"},{"content":"The container's frame object is, for the most part, the same frame that is used for in-place activation in OLE Documents, that is, the one that handles menu and toolbar negotiation.","pos":[6260,6441]},{"content":"A view object has access to this frame object through <bpt id=\"p1\">**</bpt>IOleInPlaceSite::GetWindowContext<ept id=\"p1\">**</ept>, which also provides access to the container object representing the container document (which can handle pane-level toolbar negotiation and contained object enumeration).","pos":[6442,6705],"source":" A view object has access to this frame object through **IOleInPlaceSite::GetWindowContext**, which also provides access to the container object representing the container document (which can handle pane-level toolbar negotiation and contained object enumeration)."},{"content":"An active document container can augment the frame by adding <ph id=\"ph1\">`IOleCommandTarget`</ph>.","pos":[6712,6793],"source":"An active document container can augment the frame by adding `IOleCommandTarget`."},{"content":"This allows it to receive commands that originate in the active document's user interface in the same way that this interface can allow a container to send the same commands (such as <bpt id=\"p1\">**</bpt>File New<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Save As<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Print<ept id=\"p4\">**</ept>; <bpt id=\"p5\">**</bpt>Edit Copy<ept id=\"p5\">**</ept>, <bpt id=\"p6\">**</bpt>Paste<ept id=\"p6\">**</ept>, <bpt id=\"p7\">**</bpt>Undo<ept id=\"p7\">**</ept>, and others) to an active document.","pos":[6794,7095],"source":" This allows it to receive commands that originate in the active document's user interface in the same way that this interface can allow a container to send the same commands (such as **File New**, **Open**, **Save As**, **Print**; **Edit Copy**, **Paste**, **Undo**, and others) to an active document."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Command Targets<ept id=\"p1\">](../mfc/message-handling-and-command-targets.md)</ept>.","pos":[7096,7188],"source":" For more information, see [Command Targets](../mfc/message-handling-and-command-targets.md)."},{"content":"See Also","pos":[7197,7205]},{"content":"Active Document Containment","pos":[7210,7237]}],"content":"---\ntitle: \"Active Document Containers | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"active documents [C++], containers\"\n  - \"active document containers [C++]\"\n  - \"containers [C++], active document\"\n  - \"MFC COM [C++], active document containment\"\nms.assetid: ba20183a-8b4c-440f-9031-e5fcc41d391b\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Active Document Containers\nAn active document container, such as Microsoft Office Binder or Internet Explorer, allows you to work with several documents of different application types within a single frame (instead of forcing you to create and use multiple application frames for each document type).  \n  \n MFC provides full support for active document containers in the `COleDocObjectItem` class. You can use the MFC Application Wizard to create an active document container by selecting the **Active document container** check box on the **Compound Document Support** page of the MFC Application Wizard. For more information, see [Creating an Active Document Container Application](../mfc/creating-an-active-document-container-application.md).  \n  \n For more information about active document containers, see:  \n  \n-   [Container Requirements](#container_requirements)  \n  \n-   [Document Site Objects](#document_site_objects)  \n  \n-   [View Site Objects](#view_site_objects)  \n  \n-   [Frame Object](#frame_object)  \n  \n-   [Help Menu Merging](../mfc/help-menu-merging.md)  \n  \n-   [Programmatic Printing](../mfc/programmatic-printing.md)  \n  \n-   [Command Targets](../mfc/message-handling-and-command-targets.md)  \n  \n##  <a name=\"container_requirements\"></a> Container Requirements  \n Active document support in an active document container implies more than just interface implementations: it also requires knowledge of using the interfaces of a contained object. The same applies to active document extensions, where the container must also know how to use those extension interfaces on the active documents themselves.  \n  \n An active document container that integrates active documents must:  \n  \n-   Be capable of handling object storage through the **IPersistStorage** interface, that is, it must provide an `IStorage` instance to each active document.  \n  \n-   Support the basic embedding features of OLE documents, necessitating \"site\" objects (one per document or embedding) that implement **IOleClientSite** and **IAdviseSink**.  \n  \n-   Support in-place activation of embedded objects or active documents. The container's site objects must implement `IOleInPlaceSite` and the container's frame object must provide **IOleInPlaceFrame**.  \n  \n-   Support the active documents' extensions by implementing `IOleDocumentSite` to provide the mechanism for the container to talk to the document. Optionally, the container can implement the active document interfaces `IOleCommandTarget` and `IContinueCallback` to pick up simple commands such as printing or saving.  \n  \n The frame object, the view objects, and the container object can optionally implement **IOleCommandTarget** to support the dispatch of certain commands, as discussed in [Command Targets](../mfc/message-handling-and-command-targets.md). View and container objects can also optionally implement `IPrint` and `IContinueCallback`, to support programmatic printing, as discussed in [Programmatic Printing](../mfc/programmatic-printing.md).  \n  \n The following figure shows the conceptual relationships between a container and its components (at left), and the active document and its views (at right). The active document manages storage and data, and the view displays or optionally prints that data. Interfaces in bold are those required for active document participation; those bold and italic are optional. All other interfaces are required.  \n  \n ![Active document container interfaces](../mfc/media/vc37gj1.gif \"vc37gj1\")  \n  \n A document that supports only a single view can implement both the view and document components (that is, their corresponding interfaces) on a single concrete class. In addition, a container site that only supports one view at a time can combine the document site and the view site into a single concrete site class. The container's frame object, however, must remain distinct, and the container's document component is merely included here to give a complete picture of the architecture; it is not affected by the active document containment architecture.  \n  \n##  <a name=\"document_site_objects\"></a> Document Site Objects  \n In the active document containment architecture, a document site is the same as a client site object in OLE Documents with the addition of the `IOleDocument` interface:  \n  \n `interface IOleDocumentSite : IUnknown`  \n  \n `{`  \n  \n `HRESULT ActivateMe(IOleDocumentView *pViewToActivate);`  \n  \n `}`  \n  \n The document site is conceptually the container for one or more \"view site\" objects. Each view site object is associated with individual view objects of the document managed by the document site. If the container only supports a single view per document site, then it can implement the document site and the view site with a single concrete class.  \n  \n##  <a name=\"view_site_objects\"></a> View Site Objects  \n A container's view site object manages the display space for a particular view of a document. In addition to supporting the standard `IOleInPlaceSite` interface, a view site also generally implements `IContinueCallback` for programmatic printing control. (Note that the view object never queries for `IContinueCallback` so it can actually be implemented on any object the container desires.)  \n  \n A container that supports multiple views must be able to create multiple view site objects within the document site. This provides each view with separate activation and deactivation services as provided through `IOleInPlaceSite`.  \n  \n##  <a name=\"frame_object\"></a> Frame Object  \n The container's frame object is, for the most part, the same frame that is used for in-place activation in OLE Documents, that is, the one that handles menu and toolbar negotiation. A view object has access to this frame object through **IOleInPlaceSite::GetWindowContext**, which also provides access to the container object representing the container document (which can handle pane-level toolbar negotiation and contained object enumeration).  \n  \n An active document container can augment the frame by adding `IOleCommandTarget`. This allows it to receive commands that originate in the active document's user interface in the same way that this interface can allow a container to send the same commands (such as **File New**, **Open**, **Save As**, **Print**; **Edit Copy**, **Paste**, **Undo**, and others) to an active document. For more information, see [Command Targets](../mfc/message-handling-and-command-targets.md).  \n  \n## See Also  \n [Active Document Containment](../mfc/active-document-containment.md)\n\n"}