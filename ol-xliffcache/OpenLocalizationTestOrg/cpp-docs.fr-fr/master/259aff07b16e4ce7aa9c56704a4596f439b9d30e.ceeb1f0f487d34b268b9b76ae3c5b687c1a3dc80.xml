{"nodes":[{"pos":[12,65],"content":"Exporting from a DLL Using DEF Files | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Exporting from a DLL Using DEF Files | Microsoft Docs","pos":[0,53]}]},{"content":"Exporting from a DLL Using DEF Files","pos":[692,728]},{"content":"A module-definition (.def) file is a text file containing one or more module statements that describe various attributes of a DLL.","pos":[729,859]},{"content":"If you are not using the <bpt id=\"p1\">**</bpt>__declspec(dllexport)<ept id=\"p1\">**</ept> keyword to export the DLL's functions, the DLL requires a .def file.","pos":[860,979],"source":" If you are not using the **__declspec(dllexport)** keyword to export the DLL's functions, the DLL requires a .def file."},{"content":"A minimal .def file must contain the following module-definition statements:","pos":[986,1062]},{"content":"The first statement in the file must be the LIBRARY statement.","pos":[1072,1134]},{"content":"This statement identifies the .def file as belonging to a DLL.","pos":[1135,1197]},{"content":"The LIBRARY statement is followed by the name of the DLL.","pos":[1198,1255]},{"content":"The linker places this name in the DLL's import library.","pos":[1256,1312]},{"content":"The EXPORTS statement lists the names and, optionally, the ordinal values of the functions exported by the DLL.","pos":[1322,1433]},{"content":"You assign the function an ordinal value by following the function's name with an at sign (@) and a number.","pos":[1434,1541]},{"content":"When you specify ordinal values, they must be in the range 1 through N, where N is the number of functions exported by the DLL.","pos":[1542,1669]},{"content":"If you want to export functions by ordinal, see <bpt id=\"p1\">[</bpt>Exporting Functions from a DLL by Ordinal Rather Than by Name<ept id=\"p1\">](../build/exporting-functions-from-a-dll-by-ordinal-rather-than-by-name.md)</ept> as well as this topic.","pos":[1670,1879],"source":" If you want to export functions by ordinal, see [Exporting Functions from a DLL by Ordinal Rather Than by Name](../build/exporting-functions-from-a-dll-by-ordinal-rather-than-by-name.md) as well as this topic."},{"content":"For example, a DLL that contains the code to implement a binary search tree might look like the following:","pos":[1886,1992]},{"content":"If you use the <bpt id=\"p1\">[</bpt>MFC DLL Wizard<ept id=\"p1\">](../mfc/reference/mfc-dll-wizard.md)</ept> to create an MFC DLL, the wizard creates a skeleton .def file for you and automatically adds it to your project.","pos":[2107,2287],"source":"If you use the [MFC DLL Wizard](../mfc/reference/mfc-dll-wizard.md) to create an MFC DLL, the wizard creates a skeleton .def file for you and automatically adds it to your project."},{"content":"Add the names of the functions to be exported to this file.","pos":[2288,2347]},{"content":"For non-MFC DLLs, you must create the .def file yourself and add it to your project.","pos":[2348,2432]},{"content":"If you are exporting functions in a C++ file, you have to either place the decorated names in the .def file or define your exported functions with standard C linkage by using extern \"C\".","pos":[2439,2625]},{"content":"If you need to place the decorated names in the .def file, you can obtain them by using the <bpt id=\"p1\">[</bpt>DUMPBIN<ept id=\"p1\">](../build/reference/dumpbin-reference.md)</ept> tool or by using the linker <bpt id=\"p2\">[</bpt>/MAP<ept id=\"p2\">](../build/reference/map-generate-mapfile.md)</ept> option.","pos":[2626,2855],"source":" If you need to place the decorated names in the .def file, you can obtain them by using the [DUMPBIN](../build/reference/dumpbin-reference.md) tool or by using the linker [/MAP](../build/reference/map-generate-mapfile.md) option."},{"content":"Note that the decorated names produced by the compiler are compiler specific.","pos":[2856,2933]},{"content":"If you place the decorated names produced by the Visual C++ compiler into a .def file, applications that link to your DLL must also be built using the same version of Visual C++ so that the decorated names in the calling application match the exported names in the DLL's .def file.","pos":[2934,3215]},{"pos":[3222,3437],"content":"If you are building an <bpt id=\"p1\">[</bpt>extension DLL<ept id=\"p1\">](../build/extension-dlls-overview.md)</ept>, and exporting using a .def file, place the following code at the beginning and end of your header files that contain the exported classes:","source":"If you are building an [extension DLL](../build/extension-dlls-overview.md), and exporting using a .def file, place the following code at the beginning and end of your header files that contain the exported classes:"},{"content":"These lines ensure that MFC variables that are used internally or that are added to your classes are exported (or imported) from your extension DLL.","pos":[3578,3726]},{"content":"For example, when deriving a class using <ph id=\"ph1\">`DECLARE_DYNAMIC`</ph>, the macro expands to add a <ph id=\"ph2\">`CRuntimeClass`</ph> member variable to your class.","pos":[3727,3860],"source":" For example, when deriving a class using `DECLARE_DYNAMIC`, the macro expands to add a `CRuntimeClass` member variable to your class."},{"content":"Leaving out these four lines might cause your DLL to compile or link incorrectly or cause an error when the client application links to the DLL.","pos":[3861,4005]},{"content":"When building the DLL, the linker uses the .def file to create an export (.exp) file and an import library (.lib) file.","pos":[4012,4131]},{"content":"The linker then uses the export file to build the DLL file.","pos":[4132,4191]},{"content":"Executables that implicitly link to the DLL link to the import library when they are built.","pos":[4192,4283]},{"content":"Note that MFC itself uses .def files to export functions and classes from the MFCx0.dll.","pos":[4290,4378]},{"content":"What do you want to do?","pos":[4387,4410]},{"content":"Export from a DLL using __declspec(dllexport)","pos":[4421,4466]},{"content":"Export and import using AFX_EXT_CLASS","pos":[4537,4574]},{"content":"Export C++ functions for use in C-language executables","pos":[4643,4697]},{"content":"Export C functions for use in C or C++-language executables","pos":[4780,4839]},{"content":"Determine which exporting method to use","pos":[4927,4966]},{"content":"Import into an application using __declspec(dllimport)","pos":[5033,5087]},{"content":"Initialize a DLL","pos":[5167,5183]},{"content":"What do you want to know more about?","pos":[5225,5261]},{"content":".def files","pos":[5272,5282]},{"content":"Rules for module-definition statements","pos":[5349,5387]},{"content":"Decorated names","pos":[5461,5476]},{"content":"Importing and exporting inline functions","pos":[5527,5567]},{"content":"Mutual imports","pos":[5633,5647]},{"content":"See Also","pos":[5685,5693]},{"content":"Exporting from a DLL","pos":[5698,5718]}],"content":"---\ntitle: \"Exporting from a DLL Using DEF Files | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"def files [C++], exporting from DLLs\"\n  - \".def files [C++], exporting from DLLs\"\n  - \"exporting DLLs [C++], DEF files\"\nms.assetid: 9d31eda2-184e-47de-a2ee-a93ebd603f8e\ncaps.latest.revision: 7\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Exporting from a DLL Using DEF Files\nA module-definition (.def) file is a text file containing one or more module statements that describe various attributes of a DLL. If you are not using the **__declspec(dllexport)** keyword to export the DLL's functions, the DLL requires a .def file.  \n  \n A minimal .def file must contain the following module-definition statements:  \n  \n-   The first statement in the file must be the LIBRARY statement. This statement identifies the .def file as belonging to a DLL. The LIBRARY statement is followed by the name of the DLL. The linker places this name in the DLL's import library.  \n  \n-   The EXPORTS statement lists the names and, optionally, the ordinal values of the functions exported by the DLL. You assign the function an ordinal value by following the function's name with an at sign (@) and a number. When you specify ordinal values, they must be in the range 1 through N, where N is the number of functions exported by the DLL. If you want to export functions by ordinal, see [Exporting Functions from a DLL by Ordinal Rather Than by Name](../build/exporting-functions-from-a-dll-by-ordinal-rather-than-by-name.md) as well as this topic.  \n  \n For example, a DLL that contains the code to implement a binary search tree might look like the following:  \n  \n```  \nLIBRARY   BTREE  \nEXPORTS  \n   Insert   @1  \n   Delete   @2  \n   Member   @3  \n   Min   @4  \n```  \n  \n If you use the [MFC DLL Wizard](../mfc/reference/mfc-dll-wizard.md) to create an MFC DLL, the wizard creates a skeleton .def file for you and automatically adds it to your project. Add the names of the functions to be exported to this file. For non-MFC DLLs, you must create the .def file yourself and add it to your project.  \n  \n If you are exporting functions in a C++ file, you have to either place the decorated names in the .def file or define your exported functions with standard C linkage by using extern \"C\". If you need to place the decorated names in the .def file, you can obtain them by using the [DUMPBIN](../build/reference/dumpbin-reference.md) tool or by using the linker [/MAP](../build/reference/map-generate-mapfile.md) option. Note that the decorated names produced by the compiler are compiler specific. If you place the decorated names produced by the Visual C++ compiler into a .def file, applications that link to your DLL must also be built using the same version of Visual C++ so that the decorated names in the calling application match the exported names in the DLL's .def file.  \n  \n If you are building an [extension DLL](../build/extension-dlls-overview.md), and exporting using a .def file, place the following code at the beginning and end of your header files that contain the exported classes:  \n  \n```  \n#undef AFX_DATA  \n#define AFX_DATA AFX_EXT_DATA  \n// <body of your header file>  \n#undef AFX_DATA  \n#define AFX_DATA  \n```  \n  \n These lines ensure that MFC variables that are used internally or that are added to your classes are exported (or imported) from your extension DLL. For example, when deriving a class using `DECLARE_DYNAMIC`, the macro expands to add a `CRuntimeClass` member variable to your class. Leaving out these four lines might cause your DLL to compile or link incorrectly or cause an error when the client application links to the DLL.  \n  \n When building the DLL, the linker uses the .def file to create an export (.exp) file and an import library (.lib) file. The linker then uses the export file to build the DLL file. Executables that implicitly link to the DLL link to the import library when they are built.  \n  \n Note that MFC itself uses .def files to export functions and classes from the MFCx0.dll.  \n  \n## What do you want to do?  \n  \n-   [Export from a DLL using __declspec(dllexport)](../build/exporting-from-a-dll-using-declspec-dllexport.md)  \n  \n-   [Export and import using AFX_EXT_CLASS](../build/exporting-and-importing-using-afx-ext-class.md)  \n  \n-   [Export C++ functions for use in C-language executables](../build/exporting-cpp-functions-for-use-in-c-language-executables.md)  \n  \n-   [Export C functions for use in C or C++-language executables](../build/exporting-c-functions-for-use-in-c-or-cpp-language-executables.md)  \n  \n-   [Determine which exporting method to use](../build/determining-which-exporting-method-to-use.md)  \n  \n-   [Import into an application using __declspec(dllimport)](../build/importing-into-an-application-using-declspec-dllimport.md)  \n  \n-   [Initialize a DLL](../build/initializing-a-dll.md)  \n  \n## What do you want to know more about?  \n  \n-   [.def files](../build/reference/module-definition-dot-def-files.md)  \n  \n-   [Rules for module-definition statements](../build/reference/rules-for-module-definition-statements.md)  \n  \n-   [Decorated names](../build/reference/decorated-names.md)  \n  \n-   [Importing and exporting inline functions](../build/importing-and-exporting-inline-functions.md)  \n  \n-   [Mutual imports](../build/mutual-imports.md)  \n  \n## See Also  \n [Exporting from a DLL](../build/exporting-from-a-dll.md)"}