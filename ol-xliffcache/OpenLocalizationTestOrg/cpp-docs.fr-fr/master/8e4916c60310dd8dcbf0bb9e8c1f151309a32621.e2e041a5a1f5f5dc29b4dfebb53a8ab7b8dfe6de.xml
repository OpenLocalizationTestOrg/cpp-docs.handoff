{"nodes":[{"pos":[12,69],"content":"Adding a New Interface in an ATL Project | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Adding a New Interface in an ATL Project | Microsoft Docs","pos":[0,57]}]},{"pos":[766,806],"content":"Adding a New Interface in an ATL Project","linkify":"Adding a New Interface in an ATL Project","nodes":[{"content":"Adding a New Interface in an ATL Project","pos":[0,40]}]},{"content":"When you add an interface to your object or control, you create stubbed-out functions for each method in that interface.","pos":[807,927]},{"content":"In your object or control, you can add only interfaces currently found in an existing type library.","pos":[928,1027]},{"content":"Also, the class in which you add the interface must implement the <bpt id=\"p1\">[</bpt>BEGIN_COM_MAP<ept id=\"p1\">](http://msdn.microsoft.com/library/ead2a1e3-334d-44ad-bb1f-b94bb14c2333)</ept> macro or, if the project is attributed, it must have the <ph id=\"ph1\">`coclass`</ph> attribute.","pos":[1028,1259],"source":" Also, the class in which you add the interface must implement the [BEGIN_COM_MAP](http://msdn.microsoft.com/library/ead2a1e3-334d-44ad-bb1f-b94bb14c2333) macro or, if the project is attributed, it must have the `coclass` attribute."},{"content":"You can add a new interface to your control in one of two ways: manually or using code wizards in Class View.","pos":[1266,1375]},{"pos":[1385,1471],"content":"To use code wizards in Class View to add an interface to an existing object or control","linkify":"To use code wizards in Class View to add an interface to an existing object or control","nodes":[{"content":"To use code wizards in Class View to add an interface to an existing object or control","pos":[0,86]}]},{"content":"In <bpt id=\"p1\">[</bpt>Class View<ept id=\"p1\">](http://msdn.microsoft.com/en-us/8d7430a9-3e33-454c-a9e1-a85e3d2db925)</ept>, right-click the class name of a control.","pos":[1481,1608],"source":"In [Class View](http://msdn.microsoft.com/en-us/8d7430a9-3e33-454c-a9e1-a85e3d2db925), right-click the class name of a control."},{"content":"For example, a full control or composite control, or any other control class that implements a BEGIN_COM_MAP macro in its header file.","pos":[1609,1743]},{"pos":[1753,1829],"content":"On the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Implement Interface<ept id=\"p2\">**</ept>.","source":"On the shortcut menu, click **Add**, and then click **Implement Interface**."},{"content":"Select the interfaces to implement in the <bpt id=\"p1\">[</bpt>Implement Interface Wizard<ept id=\"p1\">](../../ide/implement-interface-wizard.md)</ept>.","pos":[1839,1951],"source":"Select the interfaces to implement in the [Implement Interface Wizard](../../ide/implement-interface-wizard.md)."},{"content":"If the interface does not exist in any available typelib, then you must add it manually to the .idl file.","pos":[1952,2057]},{"pos":[2067,2098],"content":"To add a new interface manually","linkify":"To add a new interface manually","nodes":[{"content":"To add a new interface manually","pos":[0,31]}]},{"content":"Add the definition of your new interface to the .idl file.","pos":[2108,2166]},{"content":"Derive your object or control from the interface.","pos":[2176,2225]},{"pos":[2235,2422],"content":"Create a new <bpt id=\"p1\">[</bpt>COM_INTERFACE_ENTRY<ept id=\"p1\">](http://msdn.microsoft.com/library/c5363b8b-a1a2-471e-ad3a-d472f6c356c5)</ept> for the interface or, if the project is attributed, add the <ph id=\"ph1\">`coclass`</ph> attribute.","source":"Create a new [COM_INTERFACE_ENTRY](http://msdn.microsoft.com/library/c5363b8b-a1a2-471e-ad3a-d472f6c356c5) for the interface or, if the project is attributed, add the `coclass` attribute."},{"content":"Implement methods on the interface.","pos":[2432,2467]},{"pos":[2476,2484],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ATL Project Wizard<ept id=\"p1\">](../../atl/reference/atl-project-wizard.md)</ept><ph id=\"ph1\"> </ph>","pos":[2488,2552],"source":"[ATL Project Wizard](../../atl/reference/atl-project-wizard.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Visual C++ Project Types<ept id=\"p1\">](../../ide/visual-cpp-project-types.md)</ept><ph id=\"ph1\"> </ph>","pos":[2555,2622],"source":" [Visual C++ Project Types](../../ide/visual-cpp-project-types.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Creating Desktop Projects By Using Application Wizards<ept id=\"p1\">](../../ide/creating-desktop-projects-by-using-application-wizards.md)</ept><ph id=\"ph1\"> </ph>","pos":[2625,2752],"source":" [Creating Desktop Projects By Using Application Wizards](../../ide/creating-desktop-projects-by-using-application-wizards.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Programming with ATL and C Run-Time Code<ept id=\"p1\">](../../atl/programming-with-atl-and-c-run-time-code.md)</ept><ph id=\"ph1\"> </ph>","pos":[2755,2854],"source":" [Programming with ATL and C Run-Time Code](../../atl/programming-with-atl-and-c-run-time-code.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Fundamentals of ATL COM Objects<ept id=\"p1\">](../../atl/fundamentals-of-atl-com-objects.md)</ept><ph id=\"ph1\"> </ph>","pos":[2857,2938],"source":" [Fundamentals of ATL COM Objects](../../atl/fundamentals-of-atl-com-objects.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Default ATL Project Configurations<ept id=\"p1\">](../../atl/reference/default-atl-project-configurations.md)</ept>","pos":[2941,3037],"source":" [Default ATL Project Configurations](../../atl/reference/default-atl-project-configurations.md)"}],"content":"---\ntitle: \"Adding a New Interface in an ATL Project | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"vc.appwiz.ATL.interface\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"interfaces, adding to ATL objects\"\n  - \"Implement Interface ATL wizard\"\n  - \"controls [ATL], interfaces\"\n  - \"ATL projects, adding interfaces\"\nms.assetid: 7d34b023-2c6b-4155-aca3-d47a40968063\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Adding a New Interface in an ATL Project\nWhen you add an interface to your object or control, you create stubbed-out functions for each method in that interface. In your object or control, you can add only interfaces currently found in an existing type library. Also, the class in which you add the interface must implement the [BEGIN_COM_MAP](http://msdn.microsoft.com/library/ead2a1e3-334d-44ad-bb1f-b94bb14c2333) macro or, if the project is attributed, it must have the `coclass` attribute.  \n  \n You can add a new interface to your control in one of two ways: manually or using code wizards in Class View.  \n  \n### To use code wizards in Class View to add an interface to an existing object or control  \n  \n1.  In [Class View](http://msdn.microsoft.com/en-us/8d7430a9-3e33-454c-a9e1-a85e3d2db925), right-click the class name of a control. For example, a full control or composite control, or any other control class that implements a BEGIN_COM_MAP macro in its header file.  \n  \n2.  On the shortcut menu, click **Add**, and then click **Implement Interface**.  \n  \n3.  Select the interfaces to implement in the [Implement Interface Wizard](../../ide/implement-interface-wizard.md). If the interface does not exist in any available typelib, then you must add it manually to the .idl file.  \n  \n### To add a new interface manually  \n  \n1.  Add the definition of your new interface to the .idl file.  \n  \n2.  Derive your object or control from the interface.  \n  \n3.  Create a new [COM_INTERFACE_ENTRY](http://msdn.microsoft.com/library/c5363b8b-a1a2-471e-ad3a-d472f6c356c5) for the interface or, if the project is attributed, add the `coclass` attribute.  \n  \n4.  Implement methods on the interface.  \n  \n## See Also  \n [ATL Project Wizard](../../atl/reference/atl-project-wizard.md)   \n [Visual C++ Project Types](../../ide/visual-cpp-project-types.md)   \n [Creating Desktop Projects By Using Application Wizards](../../ide/creating-desktop-projects-by-using-application-wizards.md)   \n [Programming with ATL and C Run-Time Code](../../atl/programming-with-atl-and-c-run-time-code.md)   \n [Fundamentals of ATL COM Objects](../../atl/fundamentals-of-atl-com-objects.md)   \n [Default ATL Project Configurations](../../atl/reference/default-atl-project-configurations.md)\n\n"}