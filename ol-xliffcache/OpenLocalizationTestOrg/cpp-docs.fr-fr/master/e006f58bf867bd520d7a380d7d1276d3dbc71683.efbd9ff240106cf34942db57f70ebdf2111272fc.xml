{"nodes":[{"pos":[12,55],"content":"COlePropertiesDialog Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COlePropertiesDialog Class | Microsoft Docs","pos":[0,43]}]},{"pos":[800,826],"content":"COlePropertiesDialog Class","linkify":"COlePropertiesDialog Class","nodes":[{"content":"COlePropertiesDialog Class","pos":[0,26]}]},{"content":"Encapsulates the Windows common OLE Object Properties dialog box.","pos":[827,892]},{"pos":[901,907],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[980,987],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[997,1016],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1023,1027]},{"content":"Description","pos":[1028,1039]},{"pos":[1077,1166],"content":"<bpt id=\"p1\">[</bpt>COlePropertiesDialog::COlePropertiesDialog<ept id=\"p1\">](#colepropertiesdialog__colepropertiesdialog)</ept>","source":"[COlePropertiesDialog::COlePropertiesDialog](#colepropertiesdialog__colepropertiesdialog)"},{"pos":[1167,1210],"content":"Constructs a <ph id=\"ph1\">`COlePropertiesDialog`</ph> object.","source":"Constructs a `COlePropertiesDialog` object."},{"pos":[1221,1235],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1242,1246]},{"content":"Description","pos":[1247,1258]},{"pos":[1296,1359],"content":"<bpt id=\"p1\">[</bpt>COlePropertiesDialog::DoModal<ept id=\"p1\">](#colepropertiesdialog__domodal)</ept>","source":"[COlePropertiesDialog::DoModal](#colepropertiesdialog__domodal)"},{"content":"Displays the dialog box and allows the user to make a selection.","pos":[1360,1424]},{"pos":[1429,1502],"content":"<bpt id=\"p1\">[</bpt>COlePropertiesDialog::OnApplyScale<ept id=\"p1\">](#colepropertiesdialog__onapplyscale)</ept>","source":"[COlePropertiesDialog::OnApplyScale](#colepropertiesdialog__onapplyscale)"},{"content":"Called by the framework when the scaling of the document item has changed.","pos":[1503,1577]},{"pos":[1588,1607],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[1614,1618]},{"content":"Description","pos":[1619,1630]},{"pos":[1668,1725],"content":"<bpt id=\"p1\">[</bpt>COlePropertiesDialog::m_gp<ept id=\"p1\">](#colepropertiesdialog__m_gp)</ept>","source":"[COlePropertiesDialog::m_gp](#colepropertiesdialog__m_gp)"},{"pos":[1726,1811],"content":"A structure used to initialize the \"General\" page of a <ph id=\"ph1\">`COlePropertiesDialog`</ph> object.","source":"A structure used to initialize the \"General\" page of a `COlePropertiesDialog` object."},{"pos":[1816,1873],"content":"<bpt id=\"p1\">[</bpt>COlePropertiesDialog::m_lp<ept id=\"p1\">](#colepropertiesdialog__m_lp)</ept>","source":"[COlePropertiesDialog::m_lp](#colepropertiesdialog__m_lp)"},{"pos":[1874,1956],"content":"A structure used to initialize the \"Link\" page of a <ph id=\"ph1\">`COlePropertiesDialog`</ph> object.","source":"A structure used to initialize the \"Link\" page of a `COlePropertiesDialog` object."},{"pos":[1961,2018],"content":"<bpt id=\"p1\">[</bpt>COlePropertiesDialog::m_op<ept id=\"p1\">](#colepropertiesdialog__m_op)</ept>","source":"[COlePropertiesDialog::m_op](#colepropertiesdialog__m_op)"},{"pos":[2019,2084],"content":"A structure used to initialize the <ph id=\"ph1\">`COlePropertiesDialog`</ph> object.","source":"A structure used to initialize the `COlePropertiesDialog` object."},{"pos":[2089,2148],"content":"<bpt id=\"p1\">[</bpt>COlePropertiesDialog::m_psh<ept id=\"p1\">](#colepropertiesdialog__m_psh)</ept>","source":"[COlePropertiesDialog::m_psh](#colepropertiesdialog__m_psh)"},{"content":"A structure used to add additional custom property pages.","pos":[2149,2206]},{"pos":[2211,2268],"content":"<bpt id=\"p1\">[</bpt>COlePropertiesDialog::m_vp<ept id=\"p1\">](#colepropertiesdialog__m_vp)</ept>","source":"[COlePropertiesDialog::m_vp](#colepropertiesdialog__m_vp)"},{"pos":[2269,2350],"content":"A structure used to customize the \"View\" page of a <ph id=\"ph1\">`COlePropertiesDialog`</ph> object.","source":"A structure used to customize the \"View\" page of a `COlePropertiesDialog` object."},{"pos":[2360,2367],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Common OLE Object Properties dialog boxes provide an easy way to display and modify the properties of an OLE document item in a manner consistent with Windows standards.","pos":[2371,2540]},{"content":"These properties include, among others, information on the file represented by the document item, options for displaying the icon and image scaling, and information on the item's link (if the item is linked).","pos":[2541,2749]},{"content":"To use a <ph id=\"ph1\">`COlePropertiesDialog`</ph> object, first create the object using the <ph id=\"ph2\">`COlePropertiesDialog`</ph> constructor.","pos":[2756,2865],"source":"To use a `COlePropertiesDialog` object, first create the object using the `COlePropertiesDialog` constructor."},{"content":"After the dialog box has been constructed, call the <ph id=\"ph1\">`DoModal`</ph> member function to display the dialog box and allow the user to modify any properties of the item.","pos":[2866,3026],"source":" After the dialog box has been constructed, call the `DoModal` member function to display the dialog box and allow the user to modify any properties of the item."},{"content":"<ph id=\"ph1\">`DoModal`</ph> returns whether the user selected the OK ( <bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept>) or the Cancel ( <bpt id=\"p2\">**</bpt>IDCANCEL<ept id=\"p2\">**</ept>) button.","pos":[3027,3127],"source":"`DoModal` returns whether the user selected the OK ( **IDOK**) or the Cancel ( **IDCANCEL**) button."},{"content":"In addition to the OK and Cancel buttons, there is an Apply button.","pos":[3128,3195]},{"content":"When the user selects Apply, any changes made to the properties of the document item are applied to the item and its image is automatically updated, but remains active.","pos":[3196,3364]},{"content":"The <bpt id=\"p1\">[</bpt>m_psh<ept id=\"p1\">](#colepropertiesdialog__m_psh)</ept> data member is a pointer to a <bpt id=\"p2\">**</bpt>PROPSHEETHEADER<ept id=\"p2\">**</ept> structure, and in most cases you will not need to access it explicitly.","pos":[3371,3534],"source":"The [m_psh](#colepropertiesdialog__m_psh) data member is a pointer to a **PROPSHEETHEADER** structure, and in most cases you will not need to access it explicitly."},{"content":"One exception is when you need additional property pages beyond the default General, View, and Link pages.","pos":[3535,3641]},{"content":"In this case, you can modify the <ph id=\"ph1\">`m_psh`</ph> data member to include your custom pages before calling the <ph id=\"ph2\">`DoModal`</ph> member function.","pos":[3642,3769],"source":" In this case, you can modify the `m_psh` data member to include your custom pages before calling the `DoModal` member function."},{"pos":[3776,3890],"content":"For more information on OLE dialog boxes, see the article <bpt id=\"p1\">[</bpt>Dialog Boxes in OLE<ept id=\"p1\">](../../mfc/dialog-boxes-in-ole.md)</ept>.","source":"For more information on OLE dialog boxes, see the article [Dialog Boxes in OLE](../../mfc/dialog-boxes-in-ole.md)."},{"pos":[3899,3920],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3924,3971],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[3978,4031],"content":"<bpt id=\"p1\">[</bpt>CCmdTarget<ept id=\"p1\">](../../mfc/reference/ccmdtarget-class.md)</ept>","source":"[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)"},{"pos":[4038,4079],"content":"<bpt id=\"p1\">[</bpt>CWnd<ept id=\"p1\">](../../mfc/reference/cwnd-class.md)</ept>","source":"[CWnd](../../mfc/reference/cwnd-class.md)"},{"pos":[4086,4133],"content":"<bpt id=\"p1\">[</bpt>CDialog<ept id=\"p1\">](../../mfc/reference/cdialog-class.md)</ept>","source":"[CDialog](../../mfc/reference/cdialog-class.md)"},{"pos":[4140,4199],"content":"<bpt id=\"p1\">[</bpt>CCommonDialog<ept id=\"p1\">](../../mfc/reference/ccommondialog-class.md)</ept>","source":"[CCommonDialog](../../mfc/reference/ccommondialog-class.md)"},{"pos":[4206,4259],"content":"<bpt id=\"p1\">[</bpt>COleDialog<ept id=\"p1\">](../../mfc/reference/coledialog-class.md)</ept>","source":"[COleDialog](../../mfc/reference/coledialog-class.md)"},{"pos":[4297,4309],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4313,4335],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxodlgs.h","source":"**Header:** afxodlgs.h"},{"pos":[4345,4446],"content":"<bpt id=\"p1\">&lt;a name=\"colepropertiesdialog__colepropertiesdialog\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COlePropertiesDialog::COlePropertiesDialog","linkify":"<a name=\"colepropertiesdialog__colepropertiesdialog\"></a>  COlePropertiesDialog::COlePropertiesDialog","source":"<a name=\"colepropertiesdialog__colepropertiesdialog\"></a>  COlePropertiesDialog::COlePropertiesDialog"},{"pos":[4450,4490],"content":"Creates a <ph id=\"ph1\">`COlePropertiesDialog`</ph> object.","source":"Creates a `COlePropertiesDialog` object."},{"pos":[4651,4661],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the document item whose properties are being accessed.","pos":[4676,4741]},{"content":"<bpt id=\"p1\">*</bpt>nScaleMin<ept id=\"p1\">*</ept>","pos":[4748,4759],"source":"*nScaleMin*"},{"content":"Minimum scaling percentage for the document item image.","pos":[4763,4818]},{"content":"<bpt id=\"p1\">*</bpt>nScaleMax<ept id=\"p1\">*</ept>","pos":[4825,4836],"source":"*nScaleMax*"},{"content":"Maximum scaling percentage for the document item image.","pos":[4840,4895]},{"content":"Pointer to the dialog box's parent or owner.","pos":[4918,4962]},{"pos":[4972,4979],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Derive your common OLE Object Properties dialog class from <ph id=\"ph1\">`COlePropertiesDialog`</ph> in order to implement scaling for your document items.","pos":[4983,5119],"source":"Derive your common OLE Object Properties dialog class from `COlePropertiesDialog` in order to implement scaling for your document items."},{"content":"Any dialog boxes implemented by an instance of this class will not support scaling of the document item.","pos":[5120,5224]},{"content":"By default, the common OLE Object Properties dialog box has three default pages:","pos":[5231,5311]},{"content":"General","pos":[5321,5328]},{"content":"This page contains system information for the file represented by the selected document item.","pos":[5339,5432]},{"content":"From this page, the user can convert the selected item to another type.","pos":[5433,5504]},{"content":"View","pos":[5514,5518]},{"content":"This page contains options for displaying the item, changing the icon, and changing the scaling of the image.","pos":[5529,5638]},{"content":"Link","pos":[5648,5652]},{"content":"This page contains options for changing the location of the linked item and updating the linked item.","pos":[5663,5764]},{"content":"From this page, the user can break the link of the selected item.","pos":[5765,5830]},{"content":"To add pages beyond those provided by default, modify the <bpt id=\"p1\">[</bpt>m_psh<ept id=\"p1\">](#colepropertiesdialog__m_psh)</ept> member variable before exiting the constructor of your <ph id=\"ph1\">`COlePropertiesDialog`</ph>-derived class.","pos":[5837,6025],"source":"To add pages beyond those provided by default, modify the [m_psh](#colepropertiesdialog__m_psh) member variable before exiting the constructor of your `COlePropertiesDialog`-derived class."},{"content":"This is an advanced implementation of the <ph id=\"ph1\">`COlePropertiesDialog`</ph> constructor.","pos":[6026,6103],"source":" This is an advanced implementation of the `COlePropertiesDialog` constructor."},{"pos":[6113,6188],"content":"<bpt id=\"p1\">&lt;a name=\"colepropertiesdialog__domodal\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COlePropertiesDialog::DoModal","linkify":"<a name=\"colepropertiesdialog__domodal\"></a>  COlePropertiesDialog::DoModal","source":"<a name=\"colepropertiesdialog__domodal\"></a>  COlePropertiesDialog::DoModal"},{"content":"Call this member function to display the Windows common OLE Object Properties dialog box and allow the user to view and/or change the various properties of the document item.","pos":[6192,6366]},{"pos":[6418,6430],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"<bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>IDCANCEL<ept id=\"p2\">**</ept> if successful; otherwise 0.","pos":[6434,6486],"source":"**IDOK** or **IDCANCEL** if successful; otherwise 0."},{"content":"<bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>IDCANCEL<ept id=\"p2\">**</ept> are constants that indicate whether the user selected the OK or Cancel button.","pos":[6487,6591],"source":"**IDOK** and **IDCANCEL** are constants that indicate whether the user selected the OK or Cancel button."},{"pos":[6598,6783],"content":"If <bpt id=\"p1\">**</bpt>IDCANCEL<ept id=\"p1\">**</ept> is returned, you can call the Windows <bpt id=\"p2\">[</bpt>CommDlgExtendedError<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms646916)</ept> function to determine whether an error occurred.","source":"If **IDCANCEL** is returned, you can call the Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) function to determine whether an error occurred."},{"pos":[6793,6862],"content":"<bpt id=\"p1\">&lt;a name=\"colepropertiesdialog__m_gp\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COlePropertiesDialog::m_gp","linkify":"<a name=\"colepropertiesdialog__m_gp\"></a>  COlePropertiesDialog::m_gp","source":"<a name=\"colepropertiesdialog__m_gp\"></a>  COlePropertiesDialog::m_gp"},{"pos":[6866,7040],"content":"A structure of type <bpt id=\"p1\">[</bpt>OLEUIGNRLPROPS<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms687297)</ept>, used to initialize the General page of the OLE Object Properties dialog box.","source":"A structure of type [OLEUIGNRLPROPS](http://msdn.microsoft.com/library/windows/desktop/ms687297), used to initialize the General page of the OLE Object Properties dialog box."},{"pos":[7088,7095],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This page shows the type and size of an embedding and allows the user access to the Convert dialog box.","pos":[7099,7202]},{"content":"This page also shows the link destination if the object is a link.","pos":[7203,7269]},{"pos":[7276,7394],"content":"For more information on the <bpt id=\"p1\">**</bpt>OLEUIGNRLPROPS<ept id=\"p1\">**</ept> structure, see the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on the **OLEUIGNRLPROPS** structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[7404,7473],"content":"<bpt id=\"p1\">&lt;a name=\"colepropertiesdialog__m_lp\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COlePropertiesDialog::m_lp","linkify":"<a name=\"colepropertiesdialog__m_lp\"></a>  COlePropertiesDialog::m_lp","source":"<a name=\"colepropertiesdialog__m_lp\"></a>  COlePropertiesDialog::m_lp"},{"pos":[7477,7648],"content":"A structure of type <bpt id=\"p1\">[</bpt>OLEUILINKPROPS<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680735)</ept>, used to initialize the Link page of the OLE Object Properties dialog box.","source":"A structure of type [OLEUILINKPROPS](http://msdn.microsoft.com/library/windows/desktop/ms680735), used to initialize the Link page of the OLE Object Properties dialog box."},{"pos":[7696,7703],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This page shows the location of the linked item and allows the user to update, or break, the link to the item.","pos":[7707,7817]},{"pos":[7824,7942],"content":"For more information on the <bpt id=\"p1\">**</bpt>OLEUILINKPROPS<ept id=\"p1\">**</ept> structure, see the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on the **OLEUILINKPROPS** structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[7952,8021],"content":"<bpt id=\"p1\">&lt;a name=\"colepropertiesdialog__m_op\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COlePropertiesDialog::m_op","linkify":"<a name=\"colepropertiesdialog__m_op\"></a>  COlePropertiesDialog::m_op","source":"<a name=\"colepropertiesdialog__m_op\"></a>  COlePropertiesDialog::m_op"},{"pos":[8025,8188],"content":"A structure of type <bpt id=\"p1\">[</bpt>OLEUIOBJECTPROPS<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms687199)</ept>, used to initialize the common OLE Object Properties dialog box.","source":"A structure of type [OLEUIOBJECTPROPS](http://msdn.microsoft.com/library/windows/desktop/ms687199), used to initialize the common OLE Object Properties dialog box."},{"pos":[8238,8245],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This structure contains members used to initialize the General, Link, and View pages.","pos":[8249,8334]},{"pos":[8341,8543],"content":"For more information, see the <bpt id=\"p1\">**</bpt>OLEUIOBJECTPROPS<ept id=\"p1\">**</ept> and <bpt id=\"p2\">[</bpt>OLEUILINKPROPS<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms680735)</ept> structures in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the **OLEUIOBJECTPROPS** and [OLEUILINKPROPS](http://msdn.microsoft.com/library/windows/desktop/ms680735) structures in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8553,8624],"content":"<bpt id=\"p1\">&lt;a name=\"colepropertiesdialog__m_psh\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COlePropertiesDialog::m_psh","linkify":"<a name=\"colepropertiesdialog__m_psh\"></a>  COlePropertiesDialog::m_psh","source":"<a name=\"colepropertiesdialog__m_psh\"></a>  COlePropertiesDialog::m_psh"},{"pos":[8628,8788],"content":"A structure of type <bpt id=\"p1\">[</bpt>PROPSHEETHEADER<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb774546)</ept>, whose members store the characteristics of the dialog object.","source":"A structure of type [PROPSHEETHEADER](http://msdn.microsoft.com/library/windows/desktop/bb774546), whose members store the characteristics of the dialog object."},{"pos":[8838,8845],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[8849,9007],"content":"After constructing a <ph id=\"ph1\">`COlePropertiesDialog`</ph> object, you can use <ph id=\"ph2\">`m_psh`</ph> to set various aspects of the dialog box before calling the <ph id=\"ph3\">`DoModal`</ph> member function.","source":"After constructing a `COlePropertiesDialog` object, you can use `m_psh` to set various aspects of the dialog box before calling the `DoModal` member function."},{"pos":[9014,9101],"content":"If you modify the <ph id=\"ph1\">`m_psh`</ph> data member directly, you will override any default behavior.","source":"If you modify the `m_psh` data member directly, you will override any default behavior."},{"pos":[9108,9227],"content":"For more information on the <bpt id=\"p1\">**</bpt>PROPSHEETHEADER<ept id=\"p1\">**</ept> structure, see the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on the **PROPSHEETHEADER** structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[9237,9306],"content":"<bpt id=\"p1\">&lt;a name=\"colepropertiesdialog__m_vp\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COlePropertiesDialog::m_vp","linkify":"<a name=\"colepropertiesdialog__m_vp\"></a>  COlePropertiesDialog::m_vp","source":"<a name=\"colepropertiesdialog__m_vp\"></a>  COlePropertiesDialog::m_vp"},{"pos":[9310,9481],"content":"A structure of type <bpt id=\"p1\">[</bpt>OLEUIVIEWPROPS<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms693751)</ept>, used to initialize the View page of the OLE Object Properties dialog box.","source":"A structure of type [OLEUIVIEWPROPS](http://msdn.microsoft.com/library/windows/desktop/ms693751), used to initialize the View page of the OLE Object Properties dialog box."},{"pos":[9529,9536],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This page allows the user to toggle between \"content\" and \"iconic\" views of the object, and change its scaling within the container.","pos":[9540,9672]},{"content":"It also allows the user access to the Change Icon dialog box when the object is being displayed as an icon.","pos":[9673,9780]},{"pos":[9787,9905],"content":"For more information on the <bpt id=\"p1\">**</bpt>OLEUIVIEWPROPS<ept id=\"p1\">**</ept> structure, see the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on the **OLEUIVIEWPROPS** structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[9915,10000],"content":"<bpt id=\"p1\">&lt;a name=\"colepropertiesdialog__onapplyscale\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COlePropertiesDialog::OnApplyScale","linkify":"<a name=\"colepropertiesdialog__onapplyscale\"></a>  COlePropertiesDialog::OnApplyScale","source":"<a name=\"colepropertiesdialog__onapplyscale\"></a>  COlePropertiesDialog::OnApplyScale"},{"content":"Called by the framework when the scaling value has changed and either OK or Apply was selected.","pos":[10004,10099]},{"pos":[10232,10242],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the document item whose properties are being accessed.","pos":[10257,10322]},{"content":"Numerical value of the dialog scale.","pos":[10348,10384]},{"content":"<bpt id=\"p1\">*</bpt>bRelativeToOrig<ept id=\"p1\">*</ept>","pos":[10391,10408],"source":"*bRelativeToOrig*"},{"content":"Indicates whether scaling applies to the original size of the document item.","pos":[10412,10488]},{"pos":[10498,10510],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if handled; otherwise 0.","pos":[10514,10546]},{"pos":[10556,10563],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The default implementation does nothing.","pos":[10567,10607]},{"content":"You must override this function to enable the scaling controls.","pos":[10608,10671]},{"pos":[10679,10916],"content":"[!NOTE]\n Before the common OLE Object Properties dialog box is displayed, the framework calls this function with a **NULL** for `pItem` and a – 1 for `nCurrentScale`. This is done to determine if the scaling controls should be enabled.","leadings":["","> "],"nodes":[{"content":" Before the common OLE Object Properties dialog box is displayed, the framework calls this function with a **NULL** for `pItem` and a – 1 for `nCurrentScale`. This is done to determine if the scaling controls should be enabled.","pos":[8,235],"nodes":[{"content":"Before the common OLE Object Properties dialog box is displayed, the framework calls this function with a <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> for <ph id=\"ph1\">`pItem`</ph> and a – 1 for <ph id=\"ph2\">`nCurrentScale`</ph>.","pos":[1,158],"source":" Before the common OLE Object Properties dialog box is displayed, the framework calls this function with a **NULL** for `pItem` and a – 1 for `nCurrentScale`."},{"content":"This is done to determine if the scaling controls should be enabled.","pos":[159,227]}]}]},{"pos":[10925,10933],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>MFC Sample CIRC<ept id=\"p1\">](../../visual-cpp-samples.md)</ept><ph id=\"ph1\"> </ph>","pos":[10937,10984],"source":"[MFC Sample CIRC](../../visual-cpp-samples.md) "},{"content":"<bpt id=\"p1\"> [</bpt>COleDialog Class<ept id=\"p1\">](../../mfc/reference/coledialog-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[10987,11048],"source":" [COleDialog Class](../../mfc/reference/coledialog-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[11051,11100],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>COleDialog Class<ept id=\"p1\">](../../mfc/reference/coledialog-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[11103,11164],"source":" [COleDialog Class](../../mfc/reference/coledialog-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CPropertyPage Class<ept id=\"p1\">](../../mfc/reference/cpropertypage-class.md)</ept>","pos":[11167,11233],"source":" [CPropertyPage Class](../../mfc/reference/cpropertypage-class.md)"}],"content":"---\ntitle: \"COlePropertiesDialog Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COlePropertiesDialog\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE Object Properties dialog box\"\n  - \"Object Properties dialog box\"\n  - \"dialog boxes, OLE\"\n  - \"OLE documents, modifying properties\"\n  - \"property pages, OLE\"\n  - \"COlePropertiesDialog class\"\nms.assetid: a54dbc89-1447-4329-bd01-00e98ec9e935\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COlePropertiesDialog Class\nEncapsulates the Windows common OLE Object Properties dialog box.  \n  \n## Syntax  \n  \n```  \nclass COlePropertiesDialog : public COleDialog  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COlePropertiesDialog::COlePropertiesDialog](#colepropertiesdialog__colepropertiesdialog)|Constructs a `COlePropertiesDialog` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COlePropertiesDialog::DoModal](#colepropertiesdialog__domodal)|Displays the dialog box and allows the user to make a selection.|  \n|[COlePropertiesDialog::OnApplyScale](#colepropertiesdialog__onapplyscale)|Called by the framework when the scaling of the document item has changed.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COlePropertiesDialog::m_gp](#colepropertiesdialog__m_gp)|A structure used to initialize the \"General\" page of a `COlePropertiesDialog` object.|  \n|[COlePropertiesDialog::m_lp](#colepropertiesdialog__m_lp)|A structure used to initialize the \"Link\" page of a `COlePropertiesDialog` object.|  \n|[COlePropertiesDialog::m_op](#colepropertiesdialog__m_op)|A structure used to initialize the `COlePropertiesDialog` object.|  \n|[COlePropertiesDialog::m_psh](#colepropertiesdialog__m_psh)|A structure used to add additional custom property pages.|  \n|[COlePropertiesDialog::m_vp](#colepropertiesdialog__m_vp)|A structure used to customize the \"View\" page of a `COlePropertiesDialog` object.|  \n  \n## Remarks  \n Common OLE Object Properties dialog boxes provide an easy way to display and modify the properties of an OLE document item in a manner consistent with Windows standards. These properties include, among others, information on the file represented by the document item, options for displaying the icon and image scaling, and information on the item's link (if the item is linked).  \n  \n To use a `COlePropertiesDialog` object, first create the object using the `COlePropertiesDialog` constructor. After the dialog box has been constructed, call the `DoModal` member function to display the dialog box and allow the user to modify any properties of the item. `DoModal` returns whether the user selected the OK ( **IDOK**) or the Cancel ( **IDCANCEL**) button. In addition to the OK and Cancel buttons, there is an Apply button. When the user selects Apply, any changes made to the properties of the document item are applied to the item and its image is automatically updated, but remains active.  \n  \n The [m_psh](#colepropertiesdialog__m_psh) data member is a pointer to a **PROPSHEETHEADER** structure, and in most cases you will not need to access it explicitly. One exception is when you need additional property pages beyond the default General, View, and Link pages. In this case, you can modify the `m_psh` data member to include your custom pages before calling the `DoModal` member function.  \n  \n For more information on OLE dialog boxes, see the article [Dialog Boxes in OLE](../../mfc/dialog-boxes-in-ole.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CDialog](../../mfc/reference/cdialog-class.md)  \n  \n [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  \n  \n [COleDialog](../../mfc/reference/coledialog-class.md)  \n  \n `COlePropertiesDialog`  \n  \n## Requirements  \n **Header:** afxodlgs.h  \n  \n##  <a name=\"colepropertiesdialog__colepropertiesdialog\"></a>  COlePropertiesDialog::COlePropertiesDialog  \n Creates a `COlePropertiesDialog` object.  \n  \n```  \nCOlePropertiesDialog(\n    COleClientItem* pItem,  \n    UINT nScaleMin = 10,  \n    UINT nScaleMax = 500,  \n    CWnd* pParentWnd = NULL);\n```  \n  \n### Parameters  \n `pItem`  \n Pointer to the document item whose properties are being accessed.  \n  \n *nScaleMin*  \n Minimum scaling percentage for the document item image.  \n  \n *nScaleMax*  \n Maximum scaling percentage for the document item image.  \n  \n `pParentWnd`  \n Pointer to the dialog box's parent or owner.  \n  \n### Remarks  \n Derive your common OLE Object Properties dialog class from `COlePropertiesDialog` in order to implement scaling for your document items. Any dialog boxes implemented by an instance of this class will not support scaling of the document item.  \n  \n By default, the common OLE Object Properties dialog box has three default pages:  \n  \n-   General  \n  \n     This page contains system information for the file represented by the selected document item. From this page, the user can convert the selected item to another type.  \n  \n-   View  \n  \n     This page contains options for displaying the item, changing the icon, and changing the scaling of the image.  \n  \n-   Link  \n  \n     This page contains options for changing the location of the linked item and updating the linked item. From this page, the user can break the link of the selected item.  \n  \n To add pages beyond those provided by default, modify the [m_psh](#colepropertiesdialog__m_psh) member variable before exiting the constructor of your `COlePropertiesDialog`-derived class. This is an advanced implementation of the `COlePropertiesDialog` constructor.  \n  \n##  <a name=\"colepropertiesdialog__domodal\"></a>  COlePropertiesDialog::DoModal  \n Call this member function to display the Windows common OLE Object Properties dialog box and allow the user to view and/or change the various properties of the document item.  \n  \n```  \nvirtual INT_PTR DoModal();\n```  \n  \n### Return Value  \n **IDOK** or **IDCANCEL** if successful; otherwise 0. **IDOK** and **IDCANCEL** are constants that indicate whether the user selected the OK or Cancel button.  \n  \n If **IDCANCEL** is returned, you can call the Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) function to determine whether an error occurred.  \n  \n##  <a name=\"colepropertiesdialog__m_gp\"></a>  COlePropertiesDialog::m_gp  \n A structure of type [OLEUIGNRLPROPS](http://msdn.microsoft.com/library/windows/desktop/ms687297), used to initialize the General page of the OLE Object Properties dialog box.  \n  \n```  \nOLEUIGNRLPROPS m_gp;  \n```  \n  \n### Remarks  \n This page shows the type and size of an embedding and allows the user access to the Convert dialog box. This page also shows the link destination if the object is a link.  \n  \n For more information on the **OLEUIGNRLPROPS** structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colepropertiesdialog__m_lp\"></a>  COlePropertiesDialog::m_lp  \n A structure of type [OLEUILINKPROPS](http://msdn.microsoft.com/library/windows/desktop/ms680735), used to initialize the Link page of the OLE Object Properties dialog box.  \n  \n```  \nOLEUILINKPROPS m_lp;  \n```  \n  \n### Remarks  \n This page shows the location of the linked item and allows the user to update, or break, the link to the item.  \n  \n For more information on the **OLEUILINKPROPS** structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colepropertiesdialog__m_op\"></a>  COlePropertiesDialog::m_op  \n A structure of type [OLEUIOBJECTPROPS](http://msdn.microsoft.com/library/windows/desktop/ms687199), used to initialize the common OLE Object Properties dialog box.  \n  \n```  \nOLEUIOBJECTPROPS m_op;  \n```  \n  \n### Remarks  \n This structure contains members used to initialize the General, Link, and View pages.  \n  \n For more information, see the **OLEUIOBJECTPROPS** and [OLEUILINKPROPS](http://msdn.microsoft.com/library/windows/desktop/ms680735) structures in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colepropertiesdialog__m_psh\"></a>  COlePropertiesDialog::m_psh  \n A structure of type [PROPSHEETHEADER](http://msdn.microsoft.com/library/windows/desktop/bb774546), whose members store the characteristics of the dialog object.  \n  \n```  \nPROPSHEETHEADER m_psh;  \n```  \n  \n### Remarks  \n After constructing a `COlePropertiesDialog` object, you can use `m_psh` to set various aspects of the dialog box before calling the `DoModal` member function.  \n  \n If you modify the `m_psh` data member directly, you will override any default behavior.  \n  \n For more information on the **PROPSHEETHEADER** structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colepropertiesdialog__m_vp\"></a>  COlePropertiesDialog::m_vp  \n A structure of type [OLEUIVIEWPROPS](http://msdn.microsoft.com/library/windows/desktop/ms693751), used to initialize the View page of the OLE Object Properties dialog box.  \n  \n```  \nOLEUIVIEWPROPS m_vp;  \n```  \n  \n### Remarks  \n This page allows the user to toggle between \"content\" and \"iconic\" views of the object, and change its scaling within the container. It also allows the user access to the Change Icon dialog box when the object is being displayed as an icon.  \n  \n For more information on the **OLEUIVIEWPROPS** structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colepropertiesdialog__onapplyscale\"></a>  COlePropertiesDialog::OnApplyScale  \n Called by the framework when the scaling value has changed and either OK or Apply was selected.  \n  \n```  \nvirtual BOOL OnApplyScale(\n    COleClientItem* pItem,  \n    int nCurrentScale,  \n    BOOL bRelativeToOrig);\n```  \n  \n### Parameters  \n `pItem`  \n Pointer to the document item whose properties are being accessed.  \n  \n `nCurrentScale`  \n Numerical value of the dialog scale.  \n  \n *bRelativeToOrig*  \n Indicates whether scaling applies to the original size of the document item.  \n  \n### Return Value  \n Nonzero if handled; otherwise 0.  \n  \n### Remarks  \n The default implementation does nothing. You must override this function to enable the scaling controls.  \n  \n> [!NOTE]\n>  Before the common OLE Object Properties dialog box is displayed, the framework calls this function with a **NULL** for `pItem` and a – 1 for `nCurrentScale`. This is done to determine if the scaling controls should be enabled.  \n  \n## See Also  \n [MFC Sample CIRC](../../visual-cpp-samples.md)   \n [COleDialog Class](../../mfc/reference/coledialog-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [COleDialog Class](../../mfc/reference/coledialog-class.md)   \n [CPropertyPage Class](../../mfc/reference/cpropertypage-class.md)\n"}