{"nodes":[{"pos":[12,50],"content":"_spawnvpe, _wspawnvpe | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"_spawnvpe, _wspawnvpe | Microsoft Docs","pos":[0,38]}]},{"content":"_spawnvpe, _wspawnvpe","pos":[1147,1168]},{"content":"Creates and executes a new process.","pos":[1169,1204]},{"pos":[1212,1432],"content":"[!IMPORTANT]\n This API cannot be used in applications that execute in the Windows Runtime. For more information, see [CRT functions not supported with /ZW](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx).","leadings":["","> "],"nodes":[{"content":" This API cannot be used in applications that execute in the Windows Runtime. For more information, see [CRT functions not supported with /ZW](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx).","pos":[13,218],"nodes":[{"content":"This API cannot be used in applications that execute in the Windows Runtime.","pos":[1,77]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>CRT functions not supported with /ZW<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx)</ept>.","pos":[78,205],"source":" For more information, see [CRT functions not supported with /ZW](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx)."}]}]},{"content":"Syntax","pos":[1441,1447]},{"content":"Parameters","pos":[1739,1749]},{"content":"Execution mode for calling process","pos":[1763,1797]},{"content":"Path of file to be executed","pos":[1817,1844]},{"content":"Array of pointers to arguments.","pos":[1861,1892]},{"content":"The argument <ph id=\"ph1\">`argv`</ph>[0] is usually a pointer to a path in real mode or to the program name in protected mode, and <ph id=\"ph2\">`argv`</ph>[1] through <ph id=\"ph3\">`argv`</ph>[<ph id=\"ph4\">`n`</ph>] are pointers to the character strings forming the new argument list.","pos":[1893,2104],"source":" The argument `argv`[0] is usually a pointer to a path in real mode or to the program name in protected mode, and `argv`[1] through `argv`[`n`] are pointers to the character strings forming the new argument list."},{"content":"The argument <ph id=\"ph1\">`argv`</ph>[<ph id=\"ph2\">`n`</ph> +1] must be a <ph id=\"ph3\">`NULL`</ph> pointer to mark the end of the argument list.","pos":[2105,2195],"source":" The argument `argv`[`n` +1] must be a `NULL` pointer to mark the end of the argument list."},{"content":"Array of pointers to environment settings","pos":[2212,2253]},{"content":"Return Value","pos":[2262,2274]},{"content":"The return value from a synchronous <ph id=\"ph1\">`_spawnvpe`</ph> or <ph id=\"ph2\">`_wspawnvpe`</ph> (<ph id=\"ph3\">`_P_WAIT`</ph> specified for <ph id=\"ph4\">`mode`</ph>) is the exit status of the new process.","pos":[2278,2413],"source":"The return value from a synchronous `_spawnvpe` or `_wspawnvpe` (`_P_WAIT` specified for `mode`) is the exit status of the new process."},{"content":"The return value from an asynchronous <ph id=\"ph1\">`_spawnvpe`</ph> or <ph id=\"ph2\">`_wspawnvpe`</ph> (<ph id=\"ph3\">`_P_NOWAIT`</ph> or <ph id=\"ph4\">`_P_NOWAITO`</ph> specified for <ph id=\"ph5\">`mode`</ph>) is the process handle.","pos":[2414,2553],"source":" The return value from an asynchronous `_spawnvpe` or `_wspawnvpe` (`_P_NOWAIT` or `_P_NOWAITO` specified for `mode`) is the process handle."},{"content":"The exit status is 0 if the process terminated normally.","pos":[2554,2610]},{"content":"You can set the exit status to a nonzero value if the spawned process specifically calls the <ph id=\"ph1\">`exit`</ph> routine with a nonzero argument.","pos":[2611,2743],"source":" You can set the exit status to a nonzero value if the spawned process specifically calls the `exit` routine with a nonzero argument."},{"content":"If the new process did not explicitly set a positive exit status, a positive exit status indicates an abnormal exit with an abort or an interrupt.","pos":[2744,2890]},{"content":"A return value of â€“1 indicates an error (the new process is not started).","pos":[2891,2964]},{"content":"In this case, <ph id=\"ph1\">`errno`</ph> is set to one of the following values:","pos":[2965,3025],"source":" In this case, `errno` is set to one of the following values:"},{"content":"Argument list exceeds 1024 bytes","pos":[3043,3075]},{"content":"argument is invalid","pos":[3101,3120]},{"content":"File or path is not found","pos":[3139,3164]},{"content":"Specified file is not executable or has invalid executable-file format","pos":[3184,3254]},{"content":"Not enough memory is available to execute new process","pos":[3273,3326]},{"pos":[3333,3508],"content":"See <bpt id=\"p1\">[</bpt>_doserrno, errno, _sys_errlist, and _sys_nerr<ept id=\"p1\">](../../c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr.md)</ept> for more information on these, and other, return codes.","source":"See [_doserrno, errno, _sys_errlist, and _sys_nerr](../../c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr.md) for more information on these, and other, return codes."},{"content":"Remarks","pos":[3517,3524]},{"content":"Each of these functions creates and executes a new process, passing an array of pointers to command-line arguments and an array of pointers to environment settings.","pos":[3528,3692]},{"content":"These functions use the <ph id=\"ph1\">`PATH`</ph> environment variable to find the file to execute.","pos":[3693,3773],"source":" These functions use the `PATH` environment variable to find the file to execute."},{"content":"These functions validate their parameters.","pos":[3780,3822]},{"content":"If either <ph id=\"ph1\">`cmdname`</ph> or <ph id=\"ph2\">`argv`</ph> is a null pointer, or if <ph id=\"ph3\">`argv`</ph> points to null pointer, or <ph id=\"ph4\">`argv[0]`</ph> is an empty string, the invalid parameter handler is invoked, as described in <bpt id=\"p1\">[</bpt>Parameter Validation<ept id=\"p1\">](../../c-runtime-library/parameter-validation.md)</ept> .","pos":[3823,4073],"source":" If either `cmdname` or `argv` is a null pointer, or if `argv` points to null pointer, or `argv[0]` is an empty string, the invalid parameter handler is invoked, as described in [Parameter Validation](../../c-runtime-library/parameter-validation.md) ."},{"content":"If execution is allowed to continue, these functions set <ph id=\"ph1\">`errno`</ph> to <ph id=\"ph2\">`EINVAL`</ph>, and return -1.","pos":[4074,4166],"source":" If execution is allowed to continue, these functions set `errno` to `EINVAL`, and return -1."},{"content":"No new process is spawned.","pos":[4167,4193]},{"content":"Requirements","pos":[4202,4214]},{"content":"Routine","pos":[4221,4228]},{"content":"Required header","pos":[4229,4244]},{"content":"stdio.h&gt; or <ph id=\"ph1\">\\&lt;</ph>process.h&gt;","pos":[4303,4327],"source":"stdio.h> or \\<process.h>"},{"content":"stdio.h&gt; or <ph id=\"ph1\">\\&lt;</ph>wchar.h&gt;","pos":[4347,4369],"source":"stdio.h> or \\<wchar.h>"},{"pos":[4377,4481],"content":"For additional compatibility information, see <bpt id=\"p1\">[</bpt>Compatibility<ept id=\"p1\">](../../c-runtime-library/compatibility.md)</ept>.","source":"For additional compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md)."},{"content":"Example","pos":[4490,4497]},{"pos":[4501,4599],"content":"See the example in <bpt id=\"p1\">[</bpt>_spawn, _wspawn Functions<ept id=\"p1\">](../../c-runtime-library/spawn-wspawn-functions.md)</ept>.","source":"See the example in [_spawn, _wspawn Functions](../../c-runtime-library/spawn-wspawn-functions.md)."},{"content":".NET Framework Equivalent","pos":[4608,4633]},{"content":"System::Diagnostics::Process Class","pos":[4644,4678]},{"content":"System::Diagnostics::ProcessStartInfo Class","pos":[4764,4807]},{"content":"See Also","pos":[4900,4908]},{"content":"abort","pos":[4913,4918]},{"content":"atexit","pos":[4969,4975]},{"content":"_exec, _wexec Functions","pos":[5027,5050]},{"content":"exit, _Exit, _exit","pos":[5106,5124]},{"content":"_flushall","pos":[5184,5193]},{"content":"_getmbcp","pos":[5247,5255]},{"content":"_onexit, _onexit_m","pos":[5308,5326]},{"content":"_setmbcp","pos":[5387,5395]},{"content":"system, _wsystem","pos":[5448,5464]}],"content":"---\ntitle: \"_spawnvpe, _wspawnvpe | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\napiname: \n  - \"_spawnvpe\"\n  - \"_wspawnvpe\"\napilocation: \n  - \"msvcrt.dll\"\n  - \"msvcr80.dll\"\n  - \"msvcr90.dll\"\n  - \"msvcr100.dll\"\n  - \"msvcr100_clr0400.dll\"\n  - \"msvcr110.dll\"\n  - \"msvcr110_clr0400.dll\"\n  - \"msvcr120.dll\"\n  - \"msvcr120_clr0400.dll\"\n  - \"ucrtbase.dll\"\n  - \"api-ms-win-crt-process-l1-1-0.dll\"\napitype: \"DLLExport\"\nf1_keywords: \n  - \"_spawnvpe\"\n  - \"wspawnvpe\"\n  - \"spawnvpe\"\n  - \"_wspawnvpe\"\ndev_langs: \n  - \"C++\"\n  - \"C\"\nhelpviewer_keywords: \n  - \"_wspawnvpe function\"\n  - \"processes, creating\"\n  - \"_spawnvpe function\"\n  - \"processes, executing new\"\n  - \"wspawnvpe function\"\n  - \"process creation\"\n  - \"spawnvpe function\"\nms.assetid: 3db6394e-a955-4837-97a1-fab1db1e6092\ncaps.latest.revision: 16\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# _spawnvpe, _wspawnvpe\nCreates and executes a new process.  \n  \n> [!IMPORTANT]\n>  This API cannot be used in applications that execute in the Windows Runtime. For more information, see [CRT functions not supported with /ZW](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx).  \n  \n## Syntax  \n  \n```  \nintptr_t _spawnvpe(  \n   int mode,  \n   const char *cmdname,  \n   const char *const *argv,  \n   const char *const *envp   \n);  \nintptr_t _wspawnvpe(  \n   int mode,  \n   const wchar_t *cmdname,  \n   const wchar_t *const *argv,  \n   const wchar_t *const *envp   \n);  \n```  \n  \n#### Parameters  \n `mode`  \n Execution mode for calling process  \n  \n `cmdname`  \n Path of file to be executed  \n  \n `argv`  \n Array of pointers to arguments. The argument `argv`[0] is usually a pointer to a path in real mode or to the program name in protected mode, and `argv`[1] through `argv`[`n`] are pointers to the character strings forming the new argument list. The argument `argv`[`n` +1] must be a `NULL` pointer to mark the end of the argument list.  \n  \n `envp`  \n Array of pointers to environment settings  \n  \n## Return Value  \n The return value from a synchronous `_spawnvpe` or `_wspawnvpe` (`_P_WAIT` specified for `mode`) is the exit status of the new process. The return value from an asynchronous `_spawnvpe` or `_wspawnvpe` (`_P_NOWAIT` or `_P_NOWAITO` specified for `mode`) is the process handle. The exit status is 0 if the process terminated normally. You can set the exit status to a nonzero value if the spawned process specifically calls the `exit` routine with a nonzero argument. If the new process did not explicitly set a positive exit status, a positive exit status indicates an abnormal exit with an abort or an interrupt. A return value of â€“1 indicates an error (the new process is not started). In this case, `errno` is set to one of the following values:  \n  \n `E2BIG`  \n Argument list exceeds 1024 bytes  \n  \n `EINVAL`  \n `mode` argument is invalid  \n  \n `ENOENT`  \n File or path is not found  \n  \n `ENOEXEC`  \n Specified file is not executable or has invalid executable-file format  \n  \n `ENOMEM`  \n Not enough memory is available to execute new process  \n  \n See [_doserrno, errno, _sys_errlist, and _sys_nerr](../../c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr.md) for more information on these, and other, return codes.  \n  \n## Remarks  \n Each of these functions creates and executes a new process, passing an array of pointers to command-line arguments and an array of pointers to environment settings. These functions use the `PATH` environment variable to find the file to execute.  \n  \n These functions validate their parameters. If either `cmdname` or `argv` is a null pointer, or if `argv` points to null pointer, or `argv[0]` is an empty string, the invalid parameter handler is invoked, as described in [Parameter Validation](../../c-runtime-library/parameter-validation.md) . If execution is allowed to continue, these functions set `errno` to `EINVAL`, and return -1. No new process is spawned.  \n  \n## Requirements  \n  \n|Routine|Required header|  \n|-------------|---------------------|  \n|`_spawnvpe`|\\<stdio.h> or \\<process.h>|  \n|`_wspawnvpe`|\\<stdio.h> or \\<wchar.h>|  \n  \n For additional compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md).  \n  \n## Example  \n See the example in [_spawn, _wspawn Functions](../../c-runtime-library/spawn-wspawn-functions.md).  \n  \n## .NET Framework Equivalent  \n  \n-   [System::Diagnostics::Process Class](https://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)  \n  \n-   [System::Diagnostics::ProcessStartInfo Class](https://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.aspx)  \n  \n## See Also  \n [abort](../../c-runtime-library/reference/abort.md)   \n [atexit](../../c-runtime-library/reference/atexit.md)   \n [_exec, _wexec Functions](../../c-runtime-library/exec-wexec-functions.md)   \n [exit, _Exit, _exit](../../c-runtime-library/reference/exit-exit-exit.md)   \n [_flushall](../../c-runtime-library/reference/flushall.md)   \n [_getmbcp](../../c-runtime-library/reference/getmbcp.md)   \n [_onexit, _onexit_m](../../c-runtime-library/reference/onexit-onexit-m.md)   \n [_setmbcp](../../c-runtime-library/reference/setmbcp.md)   \n [system, _wsystem](../../c-runtime-library/reference/system-wsystem.md)"}