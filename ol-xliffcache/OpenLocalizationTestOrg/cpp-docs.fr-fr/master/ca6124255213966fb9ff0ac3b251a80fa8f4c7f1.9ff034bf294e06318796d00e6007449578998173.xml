{"nodes":[{"pos":[12,52],"content":"CMFCShellListCtrl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCShellListCtrl Class | Microsoft Docs","pos":[0,40]}]},{"content":"CMFCShellListCtrl Class","pos":[625,648]},{"pos":[649,796],"content":"The <ph id=\"ph1\">`CMFCShellListCtrl`</ph> class provides Windows list control functionality and expands it by including the ability to display a list of shell items.","source":"The `CMFCShellListCtrl` class provides Windows list control functionality and expands it by including the ability to display a list of shell items."},{"content":"Syntax","pos":[805,811]},{"content":"Members","pos":[883,890]},{"content":"Public Methods","pos":[900,914]},{"content":"Name","pos":[921,925]},{"content":"Description","pos":[926,937]},{"content":"CMFCShellListCtrl::DisplayFolder","pos":[976,1008]},{"content":"Displays a list of items that are contained in a provided folder.","pos":[1045,1110]},{"content":"CMFCShellListCtrl::DisplayParentFolder","pos":[1116,1154]},{"content":"Displays a list of items that are contained in the folder that is the parent of the currently displayed folder.","pos":[1197,1308]},{"content":"CMFCShellListCtrl::EnableShellContextMenu","pos":[1314,1355]},{"content":"Enables or disables the shortcut menu.","pos":[1401,1439]},{"content":"CMFCShellListCtrl::GetCurrentFolder","pos":[1445,1480]},{"content":"Retrieves the path of the current folder.","pos":[1520,1561]},{"content":"CMFCShellListCtrl::GetCurrentFolderName","pos":[1567,1606]},{"content":"Retrieves the name of the current folder.","pos":[1650,1691]},{"content":"CMFCShellListCtrl::GetCurrentItemIdList","pos":[1697,1736]},{"content":"Returns the PIDL of the current list control item.","pos":[1780,1830]},{"content":"CMFCShellListCtrl::GetCurrentShellFolder","pos":[1836,1876]},{"content":"Returns a pointer to the current Shell folder.","pos":[1921,1967]},{"content":"CMFCShellListCtrl::GetItemPath","pos":[1973,2003]},{"content":"Returns the textual path of an item.","pos":[2038,2074]},{"content":"CMFCShellListCtrl::GetItemTypes","pos":[2080,2111]},{"content":"Returns Shell item types that are displayed by the list control.","pos":[2147,2211]},{"content":"CMFCShellListCtrl::IsDesktop","pos":[2217,2245]},{"content":"Checks if the currently selected folder is the desktop folder.","pos":[2278,2340]},{"content":"CMFCShellListCtrl::OnCompareItems","pos":[2346,2379]},{"content":"The framework calls this method when it compares two items.","pos":[2417,2476]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCListCtrl::OnCompareItems<ept id=\"p1\">](../../mfc/reference/cmfclistctrl-class.md#cmfclistctrl__oncompareitems)</ept>.)","pos":[2477,2592],"source":" (Overrides [CMFCListCtrl::OnCompareItems](../../mfc/reference/cmfclistctrl-class.md#cmfclistctrl__oncompareitems).)"},{"content":"CMFCShellListCtrl::OnFormatFileDate","pos":[2598,2633]},{"content":"Called when the framework retrieves the file date displayed by the list control.","pos":[2673,2753]},{"content":"CMFCShellListCtrl::OnFormatFileSize","pos":[2759,2794]},{"content":"Called when the framework converts the file size of a list control.","pos":[2834,2901]},{"content":"CMFCShellListCtrl::OnGetItemIcon","pos":[2907,2939]},{"content":"Called when the framework retrieves the icon of a list control item.","pos":[2976,3044]},{"content":"CMFCShellListCtrl::OnGetItemText","pos":[3050,3082]},{"content":"Called when the framework converts the text of a list control item.","pos":[3119,3186]},{"content":"CMFCShellListCtrl::OnSetColumns","pos":[3192,3223]},{"content":"Called by the framework when it sets the names of the columns.","pos":[3259,3321]},{"content":"CMFCShellListCtrl::Refresh","pos":[3327,3353]},{"content":"Refreshes and repaints the list control.","pos":[3384,3424]},{"content":"CMFCShellListCtrl::SetItemTypes","pos":[3430,3461]},{"content":"Sets the type of items displayed by the list control.","pos":[3497,3550]},{"content":"Remarks","pos":[3560,3567]},{"content":"The <ph id=\"ph1\">`CMFCShellListCtrl`</ph> class extends the functionality of the <bpt id=\"p1\">[</bpt>CMFCListCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfclistctrl-class.md)</ept> by enabling your program to list Windows shell items.","pos":[3571,3751],"source":"The `CMFCShellListCtrl` class extends the functionality of the [CMFCListCtrl Class](../../mfc/reference/cmfclistctrl-class.md) by enabling your program to list Windows shell items."},{"content":"The display format that is used is like that of a list view for an Explorer window.","pos":[3752,3835]},{"content":"A <bpt id=\"p1\">[</bpt>CMFCShellTreeCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelltreectrl-class.md)</ept> object can be associated with a <ph id=\"ph1\">`CMFCShellListCtrl`</ph> object to create a complete Explorer window.","pos":[3842,4008],"source":"A [CMFCShellTreeCtrl](../../mfc/reference/cmfcshelltreectrl-class.md) object can be associated with a `CMFCShellListCtrl` object to create a complete Explorer window."},{"content":"Then, selecting an item in the <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph> will cause the <ph id=\"ph2\">`CMFCShellListCtrl`</ph> object to list the contents of the selected item.","pos":[4009,4144],"source":" Then, selecting an item in the `CMFCShellTreeCtrl` will cause the `CMFCShellListCtrl` object to list the contents of the selected item."},{"content":"Example","pos":[4153,4160]},{"content":"The following example demonstrates how to create an object of the <ph id=\"ph1\">`CMFCShellListCtrl`</ph> class and how to display the parent folder of the currently displayed folder.","pos":[4164,4327],"source":"The following example demonstrates how to create an object of the `CMFCShellListCtrl` class and how to display the parent folder of the currently displayed folder."},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>Explorer sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[4328,4408],"source":" This code snippet is part of the [Explorer sample](../../visual-cpp-samples.md)."},{"content":"NVC_MFC_Explorer#1","pos":[4426,4444]},{"content":"NVC_MFC_Explorer#2","pos":[4525,4543]},{"content":"NVC_MFC_Explorer#3","pos":[4626,4644]},{"content":"Inheritance Hierarchy","pos":[4722,4743]},{"content":"CObject","pos":[4748,4755]},{"content":"CCmdTarget","pos":[4802,4812]},{"content":"CWnd","pos":[4862,4866]},{"content":"CListCtrl","pos":[4910,4919]},{"content":"CMFCListCtrl","pos":[4968,4980]},{"content":"CMFCShellListCtrl","pos":[5032,5049]},{"content":"Requirements","pos":[5107,5119]},{"pos":[5123,5153],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxshelllistCtrl.h","source":"**Header:** afxshelllistCtrl.h"},{"pos":[5212,5244],"content":"CMFCShellListCtrl::DisplayFolder"},{"content":"Displays a list of items that are contained in the provided folder.","pos":[5248,5315]},{"content":"Parameters","pos":[5453,5463]},{"content":"[in]","pos":[5467,5471]},{"content":"A string that contains the path of a folder.","pos":[5486,5530]},{"content":"[in]","pos":[5537,5541]},{"content":"A pointer to a <ph id=\"ph1\">`LPAFX_SHELLITEMINFO`</ph> structure that describes a folder to display.","pos":[5558,5640],"source":" A pointer to a `LPAFX_SHELLITEMINFO` structure that describes a folder to display."},{"content":"Return Value","pos":[5650,5662]},{"pos":[5673,5707],"content":"if successful; <ph id=\"ph1\">`E_FAIL`</ph> otherwise.","source":" if successful; `E_FAIL` otherwise."},{"pos":[5772,5810],"content":"CMFCShellListCtrl::DisplayParentFolder"},{"pos":[5814,5964],"content":"Updates the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object to display the parent folder of the currently displayed folder.","source":"Updates the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object to display the parent folder of the currently displayed folder."},{"content":"Return Value","pos":[6028,6040]},{"pos":[6051,6085],"content":"if successful; <ph id=\"ph1\">`E_FAIL`</ph> otherwise.","source":" if successful; `E_FAIL` otherwise."},{"pos":[6153,6194],"content":"CMFCShellListCtrl::EnableShellContextMenu"},{"content":"Enables the shortcut menu.","pos":[6198,6224]},{"content":"Parameters","pos":[6299,6309]},{"content":"[in]","pos":[6313,6317]},{"content":"A Boolean that specifies whether the framework enables the shortcut menu.","pos":[6331,6404]},{"pos":[6466,6501],"content":"CMFCShellListCtrl::GetCurrentFolder"},{"pos":[6505,6639],"content":"Retrieves the path of the currently selected folder in the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object.","source":"Retrieves the path of the currently selected folder in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object."},{"content":"Parameters","pos":[6714,6724]},{"content":"[out]","pos":[6728,6733]},{"content":"A reference to a string parameter where the method writes the path.","pos":[6747,6814]},{"content":"Return Value","pos":[6824,6836]},{"content":"Nonzero if successful; 0 otherwise.","pos":[6840,6875]},{"content":"Remarks","pos":[6885,6892]},{"pos":[6896,6972],"content":"This method fails if there is no folder selected in the <ph id=\"ph1\">`CMFCShellListCtrl`</ph>.","source":"This method fails if there is no folder selected in the `CMFCShellListCtrl`."},{"pos":[7038,7077],"content":"CMFCShellListCtrl::GetCurrentFolderName"},{"pos":[7081,7215],"content":"Retrieves the name of the currently selected folder in the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object.","source":"Retrieves the name of the currently selected folder in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object."},{"content":"Parameters","pos":[7294,7304]},{"content":"[out]","pos":[7308,7313]},{"content":"A reference to a string parameter where the method writes the name.","pos":[7327,7394]},{"content":"Return Value","pos":[7404,7416]},{"content":"Nonzero if successful; 0 otherwise.","pos":[7420,7455]},{"content":"Remarks","pos":[7465,7472]},{"pos":[7476,7552],"content":"This method fails if there is no folder selected in the <ph id=\"ph1\">`CMFCShellListCtrl`</ph>.","source":"This method fails if there is no folder selected in the `CMFCShellListCtrl`."},{"pos":[7618,7657],"content":"CMFCShellListCtrl::GetCurrentItemIdList"},{"content":"Returns the PIDL of the currently selected item.","pos":[7661,7709]},{"content":"Return Value","pos":[7780,7792]},{"content":"The PIDL of the current item.","pos":[7796,7825]},{"pos":[7892,7932],"content":"CMFCShellListCtrl::GetCurrentShellFolder"},{"pos":[7936,8064],"content":"Gets a pointer to the currently selected item in the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object.","source":"Gets a pointer to the currently selected item in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object."},{"content":"Return Value","pos":[8143,8155]},{"pos":[8159,8285],"content":"A pointer to the <bpt id=\"p1\">[</bpt>IShellFolder Interface<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb775075)</ept> for the selected object.","source":"A pointer to the [IShellFolder Interface](http://msdn.microsoft.com/library/windows/desktop/bb775075) for the selected object."},{"content":"Remarks","pos":[8295,8302]},{"pos":[8306,8368],"content":"This method returns <ph id=\"ph1\">`NULL`</ph> if no object is currently selected.","source":"This method returns `NULL` if no object is currently selected."},{"pos":[8425,8455],"content":"CMFCShellListCtrl::GetItemPath"},{"content":"Retrieves the path for an item.","pos":[8459,8490]},{"content":"Parameters","pos":[8582,8592]},{"content":"[out]","pos":[8596,8601]},{"content":"A reference to a string that receives the path.","pos":[8615,8662]},{"content":"[in]","pos":[8669,8673]},{"content":"The index of the list item.","pos":[8685,8712]},{"content":"Return Value","pos":[8722,8734]},{"pos":[8745,8778],"content":"if successful; <ph id=\"ph1\">`FALSE`</ph> otherwise.","source":" if successful; `FALSE` otherwise."},{"content":"Remarks","pos":[8788,8795]},{"pos":[8799,8959],"content":"The index supplied by <ph id=\"ph1\">`iItem`</ph> is based on the items currently displayed by the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object.","source":"The index supplied by `iItem` is based on the items currently displayed by the [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object."},{"pos":[9017,9048],"content":"CMFCShellListCtrl::GetItemTypes"},{"pos":[9052,9170],"content":"Returns the type of items displayed by the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object.","source":"Returns the type of items displayed by the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object."},{"content":"Return Value","pos":[9228,9240]},{"pos":[9244,9388],"content":"A <bpt id=\"p1\">[</bpt>SHCONTF<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb762539)</ept> value that contains the type of items listed in the <ph id=\"ph1\">`CMFCShellListCtrl`</ph>.","source":"A [SHCONTF](http://msdn.microsoft.com/library/windows/desktop/bb762539) value that contains the type of items listed in the `CMFCShellListCtrl`."},{"content":"Remarks","pos":[9398,9405]},{"pos":[9409,9540],"content":"To set the type of items listed in a <ph id=\"ph1\">`CMFCShellListCtrl`</ph>, call <bpt id=\"p1\">[</bpt>CMFCShellListCtrl::SetItemTypes<ept id=\"p1\">](#cmfcshelllistctrl__setitemtypes)</ept>.","source":"To set the type of items listed in a `CMFCShellListCtrl`, call [CMFCShellListCtrl::SetItemTypes](#cmfcshelllistctrl__setitemtypes)."},{"pos":[9595,9623],"content":"CMFCShellListCtrl::IsDesktop"},{"pos":[9627,9774],"content":"Determines if the folder that is displayed in the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object is the desktop folder.","source":"Determines if the folder that is displayed in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object is the desktop folder."},{"content":"Return Value","pos":[9826,9838]},{"pos":[9849,9914],"content":"if the displayed folder is the desktop folder; <ph id=\"ph1\">`FALSE`</ph> otherwise.","source":" if the displayed folder is the desktop folder; `FALSE` otherwise."},{"pos":[9974,10007],"content":"CMFCShellListCtrl::OnCompareItems"},{"content":"Parameters","pos":[10225,10235]},{"content":"[in]","pos":[10239,10243]},{"content":"[in]","pos":[10257,10261]},{"content":"[in]","pos":[10275,10279]},{"content":"Return Value","pos":[10299,10311]},{"content":"Remarks","pos":[10321,10328]},{"pos":[10390,10425],"content":"CMFCShellListCtrl::OnFormatFileDate"},{"content":"The framework calls this method when it must convert the date associated with an object into a string.","pos":[10429,10531]},{"content":"Parameters","pos":[10633,10643]},{"content":"[in]","pos":[10647,10651]},{"content":"The date associated with a file.","pos":[10664,10696]},{"content":"[out]","pos":[10703,10708]},{"content":"A string that contains the formatted file date.","pos":[10718,10765]},{"content":"Remarks","pos":[10775,10782]},{"content":"When a <bpt id=\"p1\">[</bpt>CMFCShellListCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object displays the date associated with a file, it must convert that date to a string format.","pos":[10786,10961],"source":"When a [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object displays the date associated with a file, it must convert that date to a string format."},{"content":"The <ph id=\"ph1\">`CMFCShellListCtrl`</ph> uses this method to make that conversion.","pos":[10962,11027],"source":" The `CMFCShellListCtrl` uses this method to make that conversion."},{"content":"By default, this method uses the current locale to format the date into a string.","pos":[11028,11109]},{"pos":[11171,11206],"content":"CMFCShellListCtrl::OnFormatFileSize"},{"content":"The framework calls this method when it converts the size of an object to a string.","pos":[11210,11293]},{"content":"Parameters","pos":[11390,11400]},{"content":"[in]","pos":[11404,11408]},{"content":"The size of the file that the framework will display.","pos":[11424,11477]},{"content":"[out]","pos":[11484,11489]},{"content":"A string that contains the formatted file size.","pos":[11499,11546]},{"content":"Remarks","pos":[11556,11563]},{"content":"When a <bpt id=\"p1\">[</bpt>CMFCShellListCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object needs to display the size of a file, it needs to convert the file size into a string format.","pos":[11567,11747],"source":"When a [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object needs to display the size of a file, it needs to convert the file size into a string format."},{"content":"The <ph id=\"ph1\">`CMFCShellListCtrl`</ph> uses this method to make that conversion.","pos":[11748,11813],"source":" The `CMFCShellListCtrl` uses this method to make that conversion."},{"content":"By default, this method converts the file size from bytes to kilobytes and then uses the current locale to format the size into string.","pos":[11814,11949]},{"pos":[12008,12040],"content":"CMFCShellListCtrl::OnGetItemIcon"},{"content":"The framework calls this method to retrieve the icon associated with a shell list item.","pos":[12044,12131]},{"content":"Parameters","pos":[12232,12242]},{"content":"[in]","pos":[12246,12250]},{"content":"The item index.","pos":[12262,12277]},{"content":"[in]","pos":[12284,12288]},{"content":"A <ph id=\"ph1\">`LPAFX_SHELLITEMINFO`</ph> parameter that describes the item.","pos":[12300,12358],"source":" A `LPAFX_SHELLITEMINFO` parameter that describes the item."},{"content":"Return Value","pos":[12368,12380]},{"content":"The index of the icon image if successful; -1 if the function fails.","pos":[12384,12452]},{"content":"Remarks","pos":[12462,12469]},{"content":"The icon image index is based on the system image list.","pos":[12473,12528]},{"content":"By default, this method relies on the <ph id=\"ph1\">`pItem`</ph> parameter.","pos":[12535,12591],"source":"By default, this method relies on the `pItem` parameter."},{"content":"The value of <ph id=\"ph1\">`iItem`</ph> is not used in the default implementation.","pos":[12592,12655],"source":" The value of `iItem` is not used in the default implementation."},{"content":"You can use <ph id=\"ph1\">`iItem`</ph> to implement custom behavior.","pos":[12656,12705],"source":" You can use `iItem` to implement custom behavior."},{"pos":[12764,12796],"content":"CMFCShellListCtrl::OnGetItemText"},{"content":"The framework calls this method when it must retrieve the text of a shell item.","pos":[12800,12879]},{"content":"Parameters","pos":[13003,13013]},{"content":"[in]","pos":[13017,13021]},{"content":"The item index.","pos":[13033,13048]},{"content":"[in]","pos":[13055,13059]},{"content":"The column of interest.","pos":[13073,13096]},{"content":"[in]","pos":[13103,13107]},{"content":"A <ph id=\"ph1\">`LPAFX_SHELLITEMINFO`</ph> parameter that describes the item.","pos":[13119,13177],"source":" A `LPAFX_SHELLITEMINFO` parameter that describes the item."},{"content":"Return Value","pos":[13187,13199]},{"pos":[13203,13263],"content":"A <ph id=\"ph1\">`CString`</ph> that contains the text associated with the item.","source":"A `CString` that contains the text associated with the item."},{"content":"Remarks","pos":[13273,13280]},{"content":"Each item in the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object may have text in one or more columns.","pos":[13284,13413],"source":"Each item in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object may have text in one or more columns."},{"content":"When the framework calls this method, it specifies the column that it is interested in.","pos":[13414,13501]},{"content":"If you call this function manually, you must also specify the column that you are interested in.","pos":[13502,13598]},{"content":"By default, this method relies on the <ph id=\"ph1\">`pItem`</ph> parameter to determine which item to process.","pos":[13605,13696],"source":"By default, this method relies on the `pItem` parameter to determine which item to process."},{"content":"The value of <ph id=\"ph1\">`iItem`</ph> is not used in the default implementation.","pos":[13697,13760],"source":" The value of `iItem` is not used in the default implementation."},{"pos":[13818,13849],"content":"CMFCShellListCtrl::OnSetColumns"},{"content":"The framework calls this method when it sets the names of the columns.","pos":[13853,13923]},{"content":"Remarks","pos":[13977,13984]},{"content":"By default, the framework creates four columns in a <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object.","pos":[13988,14115],"source":"By default, the framework creates four columns in a [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object."},{"content":"The names of these columns are <ph id=\"ph1\">`Name`</ph>, <ph id=\"ph2\">`Size`</ph>, <ph id=\"ph3\">`Type`</ph>, and <ph id=\"ph4\">`Modified`</ph>.","pos":[14116,14186],"source":" The names of these columns are `Name`, `Size`, `Type`, and `Modified`."},{"content":"You can override this method to customize the number of columns and their names.","pos":[14187,14267]},{"pos":[14320,14346],"content":"CMFCShellListCtrl::Refresh"},{"pos":[14350,14452],"content":"Refreshes and repaints the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object.","source":"Refreshes and repaints the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object."},{"content":"Return Value","pos":[14504,14516]},{"pos":[14527,14567],"content":"if successful; otherwise an error value."},{"content":"Remarks","pos":[14577,14584]},{"pos":[14588,14678],"content":"Call this method to refresh the list of items displayed by the <ph id=\"ph1\">`CMFCShellListCtrl`</ph> object.","source":"Call this method to refresh the list of items displayed by the `CMFCShellListCtrl` object."},{"pos":[14736,14767],"content":"CMFCShellListCtrl::SetItemTypes"},{"pos":[14771,14892],"content":"Sets the type of items that are listed in the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object.","source":"Sets the type of items that are listed in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object."},{"content":"Parameters","pos":[14952,14962]},{"content":"[in]","pos":[14966,14970]},{"content":"A list of item types that the <ph id=\"ph1\">`CMFCShellListCtrl`</ph> object supports.","pos":[14983,15049],"source":" A list of item types that the `CMFCShellListCtrl` object supports."},{"content":"Remarks","pos":[15059,15066]},{"pos":[15070,15195],"content":"For more information about the list of item types, see <bpt id=\"p1\">[</bpt>SHCONTF<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb762539)</ept>.","source":"For more information about the list of item types, see [SHCONTF](http://msdn.microsoft.com/library/windows/desktop/bb762539)."},{"content":"See Also","pos":[15204,15212]},{"content":"Hierarchy Chart","pos":[15217,15232]},{"content":"Classes","pos":[15269,15276]},{"content":"CMFCListCtrl Class","pos":[15319,15337]},{"content":"CMFCShellTreeCtrl Class","pos":[15387,15410]}],"content":"---\ntitle: \"CMFCShellListCtrl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCShellListCtrl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCShellListCtrl class\"\nms.assetid: ad472958-5586-4c50-aadf-1844c30bf6e7\ncaps.latest.revision: 30\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCShellListCtrl Class\nThe `CMFCShellListCtrl` class provides Windows list control functionality and expands it by including the ability to display a list of shell items.  \n  \n## Syntax  \n  \n```  \nclass CMFCShellListCtrl : public CMFCListCtrl  \n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCShellListCtrl::DisplayFolder](#cmfcshelllistctrl__displayfolder)|Displays a list of items that are contained in a provided folder.|  \n|[CMFCShellListCtrl::DisplayParentFolder](#cmfcshelllistctrl__displayparentfolder)|Displays a list of items that are contained in the folder that is the parent of the currently displayed folder.|  \n|[CMFCShellListCtrl::EnableShellContextMenu](#cmfcshelllistctrl__enableshellcontextmenu)|Enables or disables the shortcut menu.|  \n|[CMFCShellListCtrl::GetCurrentFolder](#cmfcshelllistctrl__getcurrentfolder)|Retrieves the path of the current folder.|  \n|[CMFCShellListCtrl::GetCurrentFolderName](#cmfcshelllistctrl__getcurrentfoldername)|Retrieves the name of the current folder.|  \n|[CMFCShellListCtrl::GetCurrentItemIdList](#cmfcshelllistctrl__getcurrentitemidlist)|Returns the PIDL of the current list control item.|  \n|[CMFCShellListCtrl::GetCurrentShellFolder](#cmfcshelllistctrl__getcurrentshellfolder)|Returns a pointer to the current Shell folder.|  \n|[CMFCShellListCtrl::GetItemPath](#cmfcshelllistctrl__getitempath)|Returns the textual path of an item.|  \n|[CMFCShellListCtrl::GetItemTypes](#cmfcshelllistctrl__getitemtypes)|Returns Shell item types that are displayed by the list control.|  \n|[CMFCShellListCtrl::IsDesktop](#cmfcshelllistctrl__isdesktop)|Checks if the currently selected folder is the desktop folder.|  \n|[CMFCShellListCtrl::OnCompareItems](#cmfcshelllistctrl__oncompareitems)|The framework calls this method when it compares two items. (Overrides [CMFCListCtrl::OnCompareItems](../../mfc/reference/cmfclistctrl-class.md#cmfclistctrl__oncompareitems).)|  \n|[CMFCShellListCtrl::OnFormatFileDate](#cmfcshelllistctrl__onformatfiledate)|Called when the framework retrieves the file date displayed by the list control.|  \n|[CMFCShellListCtrl::OnFormatFileSize](#cmfcshelllistctrl__onformatfilesize)|Called when the framework converts the file size of a list control.|  \n|[CMFCShellListCtrl::OnGetItemIcon](#cmfcshelllistctrl__ongetitemicon)|Called when the framework retrieves the icon of a list control item.|  \n|[CMFCShellListCtrl::OnGetItemText](#cmfcshelllistctrl__ongetitemtext)|Called when the framework converts the text of a list control item.|  \n|[CMFCShellListCtrl::OnSetColumns](#cmfcshelllistctrl__onsetcolumns)|Called by the framework when it sets the names of the columns.|  \n|[CMFCShellListCtrl::Refresh](#cmfcshelllistctrl__refresh)|Refreshes and repaints the list control.|  \n|[CMFCShellListCtrl::SetItemTypes](#cmfcshelllistctrl__setitemtypes)|Sets the type of items displayed by the list control.|  \n  \n## Remarks  \n The `CMFCShellListCtrl` class extends the functionality of the [CMFCListCtrl Class](../../mfc/reference/cmfclistctrl-class.md) by enabling your program to list Windows shell items. The display format that is used is like that of a list view for an Explorer window.  \n  \n A [CMFCShellTreeCtrl](../../mfc/reference/cmfcshelltreectrl-class.md) object can be associated with a `CMFCShellListCtrl` object to create a complete Explorer window. Then, selecting an item in the `CMFCShellTreeCtrl` will cause the `CMFCShellListCtrl` object to list the contents of the selected item.  \n  \n## Example  \n The following example demonstrates how to create an object of the `CMFCShellListCtrl` class and how to display the parent folder of the currently displayed folder. This code snippet is part of the [Explorer sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_Explorer#1](../../mfc/reference/codesnippet/cpp/cmfcshelllistctrl-class_1.h)]  \n[!code-cpp[NVC_MFC_Explorer#2](../../mfc/reference/codesnippet/cpp/cmfcshelllistctrl-class_2.cpp)]  \n[!code-cpp[NVC_MFC_Explorer#3](../../mfc/reference/codesnippet/cpp/cmfcshelllistctrl-class_3.cpp)]  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CListCtrl](../../mfc/reference/clistctrl-class.md)  \n  \n [CMFCListCtrl](../../mfc/reference/cmfclistctrl-class.md)  \n  \n [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md)  \n  \n## Requirements  \n **Header:** afxshelllistCtrl.h  \n  \n##  <a name=\"cmfcshelllistctrl__displayfolder\"></a>  CMFCShellListCtrl::DisplayFolder  \n Displays a list of items that are contained in the provided folder.  \n  \n```  \nvirtual HRESULT DisplayFolder(LPCTSTR lpszPath);\n\nvirtual HRESULT DisplayFolder(LPAFX_SHELLITEMINFO lpItemInfo);\n```  \n  \n### Parameters  \n [in] `lpszPath`  \n A string that contains the path of a folder.  \n  \n [in] `lpItemInfo`  \n A pointer to a `LPAFX_SHELLITEMINFO` structure that describes a folder to display.  \n  \n### Return Value  \n `S_OK` if successful; `E_FAIL` otherwise.  \n  \n##  <a name=\"cmfcshelllistctrl__displayparentfolder\"></a>  CMFCShellListCtrl::DisplayParentFolder  \n Updates the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object to display the parent folder of the currently displayed folder.  \n  \n```  \nvirtual HRESULT DisplayParentFolder();\n```  \n  \n### Return Value  \n `S_OK` if successful; `E_FAIL` otherwise.  \n  \n##  <a name=\"cmfcshelllistctrl__enableshellcontextmenu\"></a>  CMFCShellListCtrl::EnableShellContextMenu  \n Enables the shortcut menu.  \n  \n```  \nvoid EnableShellContextMenu(BOOL bEnable = TRUE);\n```  \n  \n### Parameters  \n [in] `bEnable`  \n A Boolean that specifies whether the framework enables the shortcut menu.  \n  \n##  <a name=\"cmfcshelllistctrl__getcurrentfolder\"></a>  CMFCShellListCtrl::GetCurrentFolder  \n Retrieves the path of the currently selected folder in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object.  \n  \n```  \nBOOL GetCurrentFolder(CString& strPath) const;\n\n \n```  \n  \n### Parameters  \n [out] `strPath`  \n A reference to a string parameter where the method writes the path.  \n  \n### Return Value  \n Nonzero if successful; 0 otherwise.  \n  \n### Remarks  \n This method fails if there is no folder selected in the `CMFCShellListCtrl`.  \n  \n##  <a name=\"cmfcshelllistctrl__getcurrentfoldername\"></a>  CMFCShellListCtrl::GetCurrentFolderName  \n Retrieves the name of the currently selected folder in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object.  \n  \n```  \nBOOL GetCurrentFolderName(CString& strName) const;\n\n \n```  \n  \n### Parameters  \n [out] `strName`  \n A reference to a string parameter where the method writes the name.  \n  \n### Return Value  \n Nonzero if successful; 0 otherwise.  \n  \n### Remarks  \n This method fails if there is no folder selected in the `CMFCShellListCtrl`.  \n  \n##  <a name=\"cmfcshelllistctrl__getcurrentitemidlist\"></a>  CMFCShellListCtrl::GetCurrentItemIdList  \n Returns the PIDL of the currently selected item.  \n  \n```  \nLPITEMIDLIST GetCurrentItemIdList() const;\n\n \n```  \n  \n### Return Value  \n The PIDL of the current item.  \n  \n##  <a name=\"cmfcshelllistctrl__getcurrentshellfolder\"></a>  CMFCShellListCtrl::GetCurrentShellFolder  \n Gets a pointer to the currently selected item in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object.  \n  \n```  \nconst IShellFolder* GetCurrentShellFolder() const;\n\n \n```  \n  \n### Return Value  \n A pointer to the [IShellFolder Interface](http://msdn.microsoft.com/library/windows/desktop/bb775075) for the selected object.  \n  \n### Remarks  \n This method returns `NULL` if no object is currently selected.  \n  \n##  <a name=\"cmfcshelllistctrl__getitempath\"></a>  CMFCShellListCtrl::GetItemPath  \n Retrieves the path for an item.  \n  \n```  \nBOOL GetItemPath(\n    CString& strPath,  \n    int iItem) const;\n\n \n```  \n  \n### Parameters  \n [out] `strPath`  \n A reference to a string that receives the path.  \n  \n [in] `iItem`  \n The index of the list item.  \n  \n### Return Value  \n `TRUE` if successful; `FALSE` otherwise.  \n  \n### Remarks  \n The index supplied by `iItem` is based on the items currently displayed by the [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object.  \n  \n##  <a name=\"cmfcshelllistctrl__getitemtypes\"></a>  CMFCShellListCtrl::GetItemTypes  \n Returns the type of items displayed by the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object.  \n  \n```  \nSHCONTF GetItemTypes() const;\n\n \n```  \n  \n### Return Value  \n A [SHCONTF](http://msdn.microsoft.com/library/windows/desktop/bb762539) value that contains the type of items listed in the `CMFCShellListCtrl`.  \n  \n### Remarks  \n To set the type of items listed in a `CMFCShellListCtrl`, call [CMFCShellListCtrl::SetItemTypes](#cmfcshelllistctrl__setitemtypes).  \n  \n##  <a name=\"cmfcshelllistctrl__isdesktop\"></a>  CMFCShellListCtrl::IsDesktop  \n Determines if the folder that is displayed in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object is the desktop folder.  \n  \n```  \nBOOL IsDesktop() const;\n\n \n```  \n  \n### Return Value  \n `TRUE` if the displayed folder is the desktop folder; `FALSE` otherwise.  \n  \n##  <a name=\"cmfcshelllistctrl__oncompareitems\"></a>  CMFCShellListCtrl::OnCompareItems  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual int OnCompareItems(\n    LPARAM lParam1,  \n    LPARAM lParam2,  \n    int iColumn);\n```  \n  \n### Parameters  \n [in] `lParam1`  \n [in] `lParam2`  \n [in] `iColumn`  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcshelllistctrl__onformatfiledate\"></a>  CMFCShellListCtrl::OnFormatFileDate  \n The framework calls this method when it must convert the date associated with an object into a string.  \n  \n```  \nvirtual void OnFormatFileDate(\n    const CTime& tmFile,  \n    CString& str);\n```  \n  \n### Parameters  \n [in] `tmFile`  \n The date associated with a file.  \n  \n [out] `str`  \n A string that contains the formatted file date.  \n  \n### Remarks  \n When a [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object displays the date associated with a file, it must convert that date to a string format. The `CMFCShellListCtrl` uses this method to make that conversion. By default, this method uses the current locale to format the date into a string.  \n  \n##  <a name=\"cmfcshelllistctrl__onformatfilesize\"></a>  CMFCShellListCtrl::OnFormatFileSize  \n The framework calls this method when it converts the size of an object to a string.  \n  \n```  \nvirtual void OnFormatFileSize(\n    long lFileSize,  \n    CString& str);\n```  \n  \n### Parameters  \n [in] `lFileSize`  \n The size of the file that the framework will display.  \n  \n [out] `str`  \n A string that contains the formatted file size.  \n  \n### Remarks  \n When a [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object needs to display the size of a file, it needs to convert the file size into a string format. The `CMFCShellListCtrl` uses this method to make that conversion. By default, this method converts the file size from bytes to kilobytes and then uses the current locale to format the size into string.  \n  \n##  <a name=\"cmfcshelllistctrl__ongetitemicon\"></a>  CMFCShellListCtrl::OnGetItemIcon  \n The framework calls this method to retrieve the icon associated with a shell list item.  \n  \n```  \nvirtual int OnGetItemIcon(\n    int iItem,  \n    LPAFX_SHELLITEMINFO pItem);\n```  \n  \n### Parameters  \n [in] `iItem`  \n The item index.  \n  \n [in] `pItem`  \n A `LPAFX_SHELLITEMINFO` parameter that describes the item.  \n  \n### Return Value  \n The index of the icon image if successful; -1 if the function fails.  \n  \n### Remarks  \n The icon image index is based on the system image list.  \n  \n By default, this method relies on the `pItem` parameter. The value of `iItem` is not used in the default implementation. You can use `iItem` to implement custom behavior.  \n  \n##  <a name=\"cmfcshelllistctrl__ongetitemtext\"></a>  CMFCShellListCtrl::OnGetItemText  \n The framework calls this method when it must retrieve the text of a shell item.  \n  \n```  \nvirtual CString OnGetItemText(\n    int iItem,  \n    int iColumn,  \n    LPAFX_SHELLITEMINFO pItem);\n```  \n  \n### Parameters  \n [in] `iItem`  \n The item index.  \n  \n [in] `iColumn`  \n The column of interest.  \n  \n [in] `pItem`  \n A `LPAFX_SHELLITEMINFO` parameter that describes the item.  \n  \n### Return Value  \n A `CString` that contains the text associated with the item.  \n  \n### Remarks  \n Each item in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object may have text in one or more columns. When the framework calls this method, it specifies the column that it is interested in. If you call this function manually, you must also specify the column that you are interested in.  \n  \n By default, this method relies on the `pItem` parameter to determine which item to process. The value of `iItem` is not used in the default implementation.  \n  \n##  <a name=\"cmfcshelllistctrl__onsetcolumns\"></a>  CMFCShellListCtrl::OnSetColumns  \n The framework calls this method when it sets the names of the columns.  \n  \n```  \nvirtual void OnSetColumns();\n```  \n  \n### Remarks  \n By default, the framework creates four columns in a [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object. The names of these columns are `Name`, `Size`, `Type`, and `Modified`. You can override this method to customize the number of columns and their names.  \n  \n##  <a name=\"cmfcshelllistctrl__refresh\"></a>  CMFCShellListCtrl::Refresh  \n Refreshes and repaints the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object.  \n  \n```  \nvirtual HRESULT Refresh();\n```  \n  \n### Return Value  \n `S_OK` if successful; otherwise an error value.  \n  \n### Remarks  \n Call this method to refresh the list of items displayed by the `CMFCShellListCtrl` object.  \n  \n##  <a name=\"cmfcshelllistctrl__setitemtypes\"></a>  CMFCShellListCtrl::SetItemTypes  \n Sets the type of items that are listed in the [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object.  \n  \n```  \nvoid SetItemTypes(SHCONTF nTypes);\n```  \n  \n### Parameters  \n [in] `nTypes`  \n A list of item types that the `CMFCShellListCtrl` object supports.  \n  \n### Remarks  \n For more information about the list of item types, see [SHCONTF](http://msdn.microsoft.com/library/windows/desktop/bb762539).  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CMFCListCtrl Class](../../mfc/reference/cmfclistctrl-class.md)   \n [CMFCShellTreeCtrl Class](../../mfc/reference/cmfcshelltreectrl-class.md)\n"}