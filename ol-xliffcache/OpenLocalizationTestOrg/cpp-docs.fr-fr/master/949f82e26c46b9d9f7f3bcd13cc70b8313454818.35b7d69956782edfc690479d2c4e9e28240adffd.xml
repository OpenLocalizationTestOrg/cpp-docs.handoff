{"nodes":[{"pos":[12,60],"content":"CMFCDropDownToolbarButton Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCDropDownToolbarButton Class | Microsoft Docs","pos":[0,48]}]},{"content":"CMFCDropDownToolbarButton Class","pos":[675,706]},{"content":"A type of toolbar button that behaves like a regular button when it is clicked.","pos":[707,786]},{"content":"However, it opens a drop-down toolbar ( <bpt id=\"p1\">[</bpt>CMFCDropDownToolBar Class<ept id=\"p1\">](../../mfc/reference/cmfcdropdowntoolbar-class.md)</ept> if the user presses and holds the toolbar button down.","pos":[787,959],"source":" However, it opens a drop-down toolbar ( [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md) if the user presses and holds the toolbar button down."},{"content":"Syntax","pos":[968,974]},{"content":"Members","pos":[1059,1066]},{"content":"Public Constructors","pos":[1076,1095]},{"content":"Name","pos":[1102,1106]},{"content":"Description","pos":[1107,1118]},{"content":"CMFCDropDownToolbarButton::CMFCDropDownToolbarButton","pos":[1157,1209]},{"pos":[1266,1314],"content":"Constructs a <ph id=\"ph1\">`CMFCDropDownToolbarButton`</ph> object.","source":"Constructs a `CMFCDropDownToolbarButton` object."},{"content":"Destructor.","pos":[1375,1386]},{"content":"Public Methods","pos":[1397,1411]},{"content":"Name","pos":[1418,1422]},{"content":"Description","pos":[1423,1434]},{"content":"CMFCDropDownToolbarButton::CopyFrom","pos":[1473,1508]},{"content":"Copies the properties of another toolbar button to the current button.","pos":[1548,1618]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::CopyFrom<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__copyfrom)</ept>.)","pos":[1619,1737],"source":" (Overrides [CMFCToolBarButton::CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__copyfrom).)"},{"content":"Used by the framework to create a dynamic instance of this class type.","pos":[1784,1854]},{"content":"CMFCDropDownToolbarButton::DropDownToolbar","pos":[1860,1902]},{"content":"Opens a drop-down toolbar.","pos":[1949,1975]},{"content":"CMFCDropDownToolbarButton::ExportToMenuButton","pos":[1981,2026]},{"content":"Copies text from the toolbar button to a menu.","pos":[2076,2122]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::ExportToMenuButton<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__exporttomenubutton)</ept>.)","pos":[2123,2261],"source":" (Overrides [CMFCToolBarButton::ExportToMenuButton](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__exporttomenubutton).)"},{"content":"CMFCDropDownToolbarButton::GetDropDownToolBar","pos":[2267,2312]},{"content":"Retrieves the drop-down toolbar that is associated with the button.","pos":[2362,2429]},{"pos":[2476,2636],"content":"Used by the framework to obtain a pointer to the <bpt id=\"p1\">[</bpt>CRuntimeClass<ept id=\"p1\">](../../mfc/reference/cruntimeclass-structure.md)</ept> object that is associated with this class type.","source":"Used by the framework to obtain a pointer to the [CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md) object that is associated with this class type."},{"content":"CMFCDropDownToolbarButton::IsDropDown","pos":[2642,2679]},{"content":"Determines whether the drop-down toolbar is currently open.","pos":[2721,2780]},{"content":"CMFCDropDownToolbarButton::IsExtraSize","pos":[2786,2824]},{"content":"Determines whether the button can be displayed with an extended border.","pos":[2867,2938]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::IsExtraSize<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__isextrasize)</ept>.)","pos":[2939,3063],"source":" (Overrides [CMFCToolBarButton::IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__isextrasize).)"},{"content":"CMFCDropDownToolbarButton::OnCalculateSize","pos":[3069,3111]},{"content":"Called by the framework to calculate the size of the button for the specified device context and docking state.","pos":[3158,3269]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnCalculateSize<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncalculatesize)</ept>.)","pos":[3270,3402],"source":" (Overrides [CMFCToolBarButton::OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncalculatesize).)"},{"content":"Called by the framework to handle the <bpt id=\"p1\">[</bpt>WM_CANCELMODE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms632615)</ept> message.","pos":[3449,3571],"source":"Called by the framework to handle the [WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615) message."},{"content":"(Overrides <ph id=\"ph1\">`CMCToolBarButton::OnCancelMode`</ph>.)","pos":[3572,3617],"source":" (Overrides `CMCToolBarButton::OnCancelMode`.)"},{"content":"CMFCDropDownToolbarButton::OnChangeParentWnd","pos":[3623,3667]},{"content":"Called by the framework when the button is inserted into a new toolbar.","pos":[3716,3787]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnChangeParentWnd<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onchangeparentwnd)</ept>.)","pos":[3788,3924],"source":" (Overrides [CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onchangeparentwnd).)"},{"content":"CMFCDropDownToolbarButton::OnClick","pos":[3930,3964]},{"content":"Called by the framework when the user clicks the mouse button.","pos":[4003,4065]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnClick<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclick)</ept>.)","pos":[4066,4182],"source":" (Overrides [CMFCToolBarButton::OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclick).)"},{"content":"CMFCDropDownToolbarButton::OnClickUp","pos":[4188,4224]},{"content":"Called by the framework when the user releases the mouse button.","pos":[4265,4329]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnClickUp<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclickup)</ept>.)","pos":[4330,4450],"source":" (Overrides [CMFCToolBarButton::OnClickUp](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclickup).)"},{"content":"CMFCDropDownToolbarButton::OnContextHelp","pos":[4456,4496]},{"content":"Called by the framework when the parent toolbar handles a <ph id=\"ph1\">`WM_HELPHITTEST`</ph> message.","pos":[4541,4624],"source":"Called by the framework when the parent toolbar handles a `WM_HELPHITTEST` message."},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnContextHelp<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncontexthelp)</ept>.)","pos":[4625,4753],"source":" (Overrides [CMFCToolBarButton::OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncontexthelp).)"},{"content":"CMFCDropDownToolbarButton::OnCustomizeMenu","pos":[4759,4801]},{"content":"Modifies the provided menu when the application displays a shortcut menu on the parent toolbar.","pos":[4848,4943]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnCustomizeMenu<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncustomizemenu)</ept>.)","pos":[4944,5076],"source":" (Overrides [CMFCToolBarButton::OnCustomizeMenu](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncustomizemenu).)"},{"content":"CMFCDropDownToolbarButton::OnDraw","pos":[5082,5115]},{"content":"Called by the framework to draw the button by using the specified styles and options.","pos":[5153,5238]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnDraw<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__ondraw)</ept>.)","pos":[5239,5353],"source":" (Overrides [CMFCToolBarButton::OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__ondraw).)"},{"content":"CMFCDropDownToolbarButton::OnDrawOnCustomizeList","pos":[5359,5407]},{"content":"Called by the framework to draw the button in the <bpt id=\"p1\">**</bpt>Commands<ept id=\"p1\">**</ept> pane of the <bpt id=\"p2\">**</bpt>Customize<ept id=\"p2\">**</ept> dialog box.","pos":[5460,5560],"source":"Called by the framework to draw the button in the **Commands** pane of the **Customize** dialog box."},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnDrawOnCustomizeList<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__ondrawoncustomizelist)</ept>.)","pos":[5561,5705],"source":" (Overrides [CMFCToolBarButton::OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__ondrawoncustomizelist).)"},{"content":"CMFCDropDownToolbarButton::Serialize","pos":[5711,5747]},{"content":"Reads this object from an archive or writes it to an archive.","pos":[5788,5849]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCToolBarButton::Serialize<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__serialize)</ept>.)","pos":[5850,5970],"source":" (Overrides [CMFCToolBarButton::Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__serialize).)"},{"content":"CMFCDropDownToolbarButton::SetDefaultCommand","pos":[5976,6020]},{"content":"Sets the default command that the framework uses when a user clicks the button.","pos":[6069,6148]},{"content":"Data Members","pos":[6159,6171]},{"content":"Name","pos":[6178,6182]},{"content":"Description","pos":[6183,6194]},{"content":"CMFCDropDownToolbarButton::m_uiShowBarDelay","pos":[6233,6276]},{"content":"Specifies the length of time that a user must hold the mouse button down before the drop-down toolbar appears.","pos":[6324,6434]},{"content":"Remarks","pos":[6444,6451]},{"content":"A <ph id=\"ph1\">`CMFCDropDownToolBarButton`</ph> differs from an ordinary button in that it has a small arrow in the lower-right corner of the button.","pos":[6455,6586],"source":"A `CMFCDropDownToolBarButton` differs from an ordinary button in that it has a small arrow in the lower-right corner of the button."},{"content":"After the user selects a button from the drop-down toolbar, the framework displays its icon on the top-level toolbar button (the button with the small arrow in the lower-right corner).","pos":[6587,6771]},{"pos":[6778,6920],"content":"For information about how to implement a drop-down toolbar, see <bpt id=\"p1\">[</bpt>CMFCDropDownToolBar Class<ept id=\"p1\">](../../mfc/reference/cmfcdropdowntoolbar-class.md)</ept>.","source":"For information about how to implement a drop-down toolbar, see [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md)."},{"pos":[6927,7126],"content":"The <ph id=\"ph1\">`CMFCDropDownToolBarButton`</ph> object can be exported to a <bpt id=\"p1\">[</bpt>CMFCToolBarMenuButton Class<ept id=\"p1\">](../../mfc/reference/cmfctoolbarmenubutton-class.md)</ept> object and displayed as a menu button with a pop-up menu.","source":"The `CMFCDropDownToolBarButton` object can be exported to a [CMFCToolBarMenuButton Class](../../mfc/reference/cmfctoolbarmenubutton-class.md) object and displayed as a menu button with a pop-up menu."},{"content":"Inheritance Hierarchy","pos":[7135,7156]},{"content":"CObject","pos":[7161,7168]},{"content":"CMFCToolBarButton","pos":[7215,7232]},{"content":"CMFCDropDownToolbarButton","pos":[7289,7314]},{"content":"Requirements","pos":[7380,7392]},{"pos":[7396,7428],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdropdowntoolbar.h","source":"**Header:** afxdropdowntoolbar.h"},{"pos":[7490,7525],"content":"CMFCDropDownToolbarButton::CopyFrom"},{"content":"Copies the properties of another toolbar button to the current button.","pos":[7529,7599]},{"content":"Parameters","pos":[7677,7687]},{"content":"[in]","pos":[7691,7695]},{"content":"A reference to the source button from which to copy.","pos":[7705,7757]},{"content":"Remarks","pos":[7767,7774]},{"content":"Call this method to copy another toolbar button to this toolbar button.","pos":[7778,7849]},{"content":"must be of type <ph id=\"ph1\">`CMFCDropDownToolbarButton`</ph>.","pos":[7856,7900],"source":" must be of type `CMFCDropDownToolbarButton`."},{"pos":[7979,8031],"content":"CMFCDropDownToolbarButton::CMFCDropDownToolbarButton"},{"pos":[8035,8083],"content":"Constructs a <ph id=\"ph1\">`CMFCDropDownToolbarButton`</ph> object.","source":"Constructs a `CMFCDropDownToolbarButton` object."},{"content":"Parameters","pos":[8227,8237]},{"content":"[in]","pos":[8241,8245]},{"content":"The default text of the button.","pos":[8260,8291]},{"content":"[in]","pos":[8298,8302]},{"content":"A pointer to the <ph id=\"ph1\">`CMFCDropDownToolBar`</ph> object that is displayed when the user presses the button.","pos":[8317,8414],"source":" A pointer to the `CMFCDropDownToolBar` object that is displayed when the user presses the button."},{"content":"Remarks","pos":[8424,8431]},{"pos":[8435,8565],"content":"The second overload of the constructor copies to the drop-down button the first button from the toolbar that <ph id=\"ph1\">`pToolBar`</ph> specifies.","source":"The second overload of the constructor copies to the drop-down button the first button from the toolbar that `pToolBar` specifies."},{"content":"Typically, a drop-down toolbar button uses the text from the most recently used button in the toolbar that <ph id=\"ph1\">`pToolBar`</ph> specifies.","pos":[8572,8700],"source":"Typically, a drop-down toolbar button uses the text from the most recently used button in the toolbar that `pToolBar` specifies."},{"content":"It uses the text specified by <ph id=\"ph1\">`lpszName`</ph> when the button is converted to a menu button or is displayed in the <bpt id=\"p1\">**</bpt>Commands<ept id=\"p1\">**</ept> tab of the <bpt id=\"p2\">**</bpt>Customize<ept id=\"p2\">**</ept> dialog box.","pos":[8701,8860],"source":" It uses the text specified by `lpszName` when the button is converted to a menu button or is displayed in the **Commands** tab of the **Customize** dialog box."},{"content":"For more information about the <bpt id=\"p1\">**</bpt>Customize<ept id=\"p1\">**</ept> dialog box, see <bpt id=\"p2\">[</bpt>CMFCToolBarsCustomizeDialog Class<ept id=\"p2\">](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)</ept>.","pos":[8861,9016],"source":" For more information about the **Customize** dialog box, see [CMFCToolBarsCustomizeDialog Class](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)."},{"content":"Example","pos":[9026,9033]},{"content":"The following example demonstrates how to construct an object of the <ph id=\"ph1\">`CMFCDropDownToolbarButton`</ph> class.","pos":[9037,9140],"source":"The following example demonstrates how to construct an object of the `CMFCDropDownToolbarButton` class."},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>Visual Studio Demo sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[9141,9231],"source":" This code snippet is part of the [Visual Studio Demo sample](../../visual-cpp-samples.md)."},{"pos":[9249,9276],"content":"NVC_MFC_VisualStudioDemo#31"},{"pos":[9412,9454],"content":"CMFCDropDownToolbarButton::DropDownToolbar"},{"content":"Opens a drop-down toolbar.","pos":[9458,9484]},{"content":"Parameters","pos":[9543,9553]},{"content":"[in]","pos":[9557,9561]},{"content":"The parent window of the drop-down frame, or <ph id=\"ph1\">`NULL`</ph> to use the parent window of the drop-down toolbar button.","pos":[9572,9681],"source":" The parent window of the drop-down frame, or `NULL` to use the parent window of the drop-down toolbar button."},{"content":"Return Value","pos":[9691,9703]},{"content":"Nonzero if the method is successful; otherwise 0.","pos":[9707,9756]},{"content":"Remarks","pos":[9766,9773]},{"pos":[9777,9966],"content":"The <bpt id=\"p1\">[</bpt>CMFCDropDownToolbarButton::OnClick<ept id=\"p1\">](#cmfcdropdowntoolbarbutton__onclick)</ept> method calls this method to open the drop-down toolbar when the user presses and holds the toolbar button down.","source":"The [CMFCDropDownToolbarButton::OnClick](#cmfcdropdowntoolbarbutton__onclick) method calls this method to open the drop-down toolbar when the user presses and holds the toolbar button down."},{"content":"This methods creates the drop-down toolbar by using the <bpt id=\"p1\">[</bpt>CMFCDropDownFrame::Create<ept id=\"p1\">](../../mfc/reference/cmfcdropdownframe-class.md#cmfcdropdownframe__create)</ept> method.","pos":[9973,10138],"source":"This methods creates the drop-down toolbar by using the [CMFCDropDownFrame::Create](../../mfc/reference/cmfcdropdownframe-class.md#cmfcdropdownframe__create) method."},{"content":"If the parent toolbar is docked vertically, this method positions the drop-down toolbar either to the left-hand or right-hand side of the parent toolbar, depending on the fit.","pos":[10139,10314]},{"content":"Otherwise, this method positions the drop-down toolbar underneath the parent toolbar.","pos":[10315,10400]},{"pos":[10407,10508],"content":"This method fails if <ph id=\"ph1\">`pWnd`</ph> is <ph id=\"ph2\">`NULL`</ph> and the drop-down toolbar button does not have a parent window.","source":"This method fails if `pWnd` is `NULL` and the drop-down toolbar button does not have a parent window."},{"pos":[10580,10625],"content":"CMFCDropDownToolbarButton::ExportToMenuButton"},{"content":"Copies text from the toolbar button to a menu.","pos":[10629,10675]},{"content":"Parameters","pos":[10777,10787]},{"content":"[in]","pos":[10791,10795]},{"content":"A reference to the target menu button.","pos":[10812,10850]},{"content":"Return Value","pos":[10860,10872]},{"content":"Nonzero if the method succeeds; otherwise 0.","pos":[10876,10920]},{"content":"Remarks","pos":[10930,10937]},{"content":"This method calls the base class implementation ( <bpt id=\"p1\">[</bpt>CMFCToolBarButton::ExportToMenuButton<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__exporttomenubutton)</ept>) and then appends to the target menu button a pop-up menu that contains each toolbar menu item in this button.","pos":[10941,11227],"source":"This method calls the base class implementation ( [CMFCToolBarButton::ExportToMenuButton](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__exporttomenubutton)) and then appends to the target menu button a pop-up menu that contains each toolbar menu item in this button."},{"content":"This method does not append sub-menus to the pop-up menu.","pos":[11228,11285]},{"pos":[11292,11406],"content":"This method fails if the parent toolbar, <ph id=\"ph1\">`m_pToolBar`</ph>, is <ph id=\"ph2\">`NULL`</ph> or the base class implementation returns <ph id=\"ph3\">`FALSE`</ph>.","source":"This method fails if the parent toolbar, `m_pToolBar`, is `NULL` or the base class implementation returns `FALSE`."},{"pos":[11478,11523],"content":"CMFCDropDownToolbarButton::GetDropDownToolBar"},{"content":"Retrieves the drop-down toolbar that is associated with the button.","pos":[11527,11594]},{"content":"Return Value","pos":[11663,11675]},{"content":"The drop-down toolbar that is associated with the button.","pos":[11679,11736]},{"content":"Remarks","pos":[11746,11753]},{"pos":[11757,11806],"content":"This method returns the <ph id=\"ph1\">`m_pToolBar`</ph> data member.","source":"This method returns the `m_pToolBar` data member."},{"pos":[11870,11907],"content":"CMFCDropDownToolbarButton::IsDropDown"},{"content":"Determines whether the drop-down toolbar is currently open.","pos":[11911,11970]},{"content":"Return Value","pos":[12023,12035]},{"content":"Nonzero if the drop-down toolbar is currently open; otherwise 0.","pos":[12039,12103]},{"content":"Remarks","pos":[12113,12120]},{"content":"The framework opens the drop-down toolbar by using the <bpt id=\"p1\">[</bpt>CMFCDropDownToolbarButton::DropDownToolbar<ept id=\"p1\">](#cmfcdropdowntoolbarbutton__dropdowntoolbar)</ept> method.","pos":[12124,12276],"source":"The framework opens the drop-down toolbar by using the [CMFCDropDownToolbarButton::DropDownToolbar](#cmfcdropdowntoolbarbutton__dropdowntoolbar) method."},{"content":"The framework closes the drop-down toolbar when the user presses the left-mouse button in the non-client area of the drop-down toolbar.","pos":[12277,12412]},{"pos":[12477,12515],"content":"CMFCDropDownToolbarButton::IsExtraSize"},{"content":"Determines whether the button can be displayed with an extended border.","pos":[12519,12590]},{"content":"Return Value","pos":[12652,12664]},{"content":"Nonzero if the toolbar button can be displayed with an extended border; otherwise 0.","pos":[12668,12752]},{"content":"Remarks","pos":[12762,12769]},{"pos":[12773,12934],"content":"For more information about extended borders, see <bpt id=\"p1\">[</bpt>CMFCToolBarButton::IsExtraSize<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__isextrasize)</ept>.","source":"For more information about extended borders, see [CMFCToolBarButton::IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__isextrasize)."},{"pos":[13004,13047],"content":"CMFCDropDownToolbarButton::m_uiShowBarDelay"},{"content":"Specifies the length of time that a user must hold the mouse button down before the drop-down toolbar appears.","pos":[13051,13161]},{"content":"Remarks","pos":[13218,13225]},{"content":"The delay time is measured in milliseconds.","pos":[13229,13272]},{"content":"The default value is 500.","pos":[13273,13298]},{"content":"You can set another delay by changing the value of this shared data member.","pos":[13299,13374]},{"pos":[13443,13485],"content":"CMFCDropDownToolbarButton::OnCalculateSize"},{"content":"Called by the framework to calculate the size of the button for the specified device context and docking state.","pos":[13489,13600]},{"content":"Parameters","pos":[13720,13730]},{"content":"[in]","pos":[13734,13738]},{"content":"The device context that displays the button.","pos":[13748,13792]},{"content":"[in]","pos":[13799,13803]},{"content":"The default size of the button.","pos":[13821,13852]},{"content":"[in]","pos":[13859,13863]},{"content":"The dock state of the parent toolbar.","pos":[13875,13912]},{"content":"This parameter is <ph id=\"ph1\">`TRUE`</ph> if the toolbar is docked horizontally or is floating, or <ph id=\"ph2\">`FALSE`</ph> if the toolbar is docked vertically.","pos":[13913,14039],"source":" This parameter is `TRUE` if the toolbar is docked horizontally or is floating, or `FALSE` if the toolbar is docked vertically."},{"content":"Return Value","pos":[14049,14061]},{"pos":[14065,14138],"content":"A <ph id=\"ph1\">`SIZE`</ph> structure that contains the dimensions of the button, in pixels.","source":"A `SIZE` structure that contains the dimensions of the button, in pixels."},{"content":"Remarks","pos":[14148,14155]},{"pos":[14159,14422],"content":"This method extends the base class implementation ( <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnCalculateSize<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncalculatesize)</ept>) by adding the width of the drop-down arrow to the horizontal dimension of the button size.","source":"This method extends the base class implementation ( [CMFCToolBarButton::OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncalculatesize)) by adding the width of the drop-down arrow to the horizontal dimension of the button size."},{"pos":[14493,14537],"content":"CMFCDropDownToolbarButton::OnChangeParentWnd"},{"content":"Called by the framework when the button is inserted into a new toolbar.","pos":[14541,14612]},{"content":"Parameters","pos":[14687,14697]},{"content":"[in]","pos":[14701,14705]},{"content":"The new parent window.","pos":[14722,14744]},{"content":"Remarks","pos":[14754,14761]},{"pos":[14765,15346],"content":"This method overrides the base class implementation ( <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnChangeParentWnd<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onchangeparentwnd)</ept>) by clearing the text label ( <bpt id=\"p2\">[</bpt>CMFCToolBarButton::m_strText<ept id=\"p2\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__m_strtext)</ept>) and setting the <bpt id=\"p3\">[</bpt>CMFCToolBarButton::m_bText<ept id=\"p3\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__m_btext)</ept> and <bpt id=\"p4\">[</bpt>CMFCToolBarButton::m_bUserButton<ept id=\"p4\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__m_buserbutton)</ept> data members to <ph id=\"ph1\">`FALSE`</ph>.","source":"This method overrides the base class implementation ( [CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onchangeparentwnd)) by clearing the text label ( [CMFCToolBarButton::m_strText](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__m_strtext)) and setting the [CMFCToolBarButton::m_bText](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__m_btext) and [CMFCToolBarButton::m_bUserButton](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__m_buserbutton) data members to `FALSE`."},{"pos":[15407,15441],"content":"CMFCDropDownToolbarButton::OnClick"},{"content":"Called by the framework when the user clicks the mouse button.","pos":[15445,15507]},{"content":"Parameters","pos":[15597,15607]},{"content":"[in]","pos":[15611,15615]},{"content":"The parent window of the toolbar button.","pos":[15626,15666]},{"content":"[in]","pos":[15673,15677]},{"content":"if the message should be handled with a delay.","pos":[15697,15743]},{"content":"Return Value","pos":[15753,15765]},{"content":"Nonzero if the button processes the click message; otherwise 0.","pos":[15769,15832]},{"content":"Remarks","pos":[15842,15849]},{"pos":[15853,16056],"content":"This method extends the base class implementation, <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnClick<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclick)</ept>, by updating the state of the drop-down toolbar.","source":"This method extends the base class implementation, [CMFCToolBarButton::OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclick), by updating the state of the drop-down toolbar."},{"content":"When a user clicks the toolbar button, this method creates a timer that waits the length of time specified by the <bpt id=\"p1\">[</bpt>CMFCDropDownToolbarButton::m_uiShowBarDelay<ept id=\"p1\">](#cmfcdropdowntoolbarbutton__m_uishowbardelay)</ept> data member and then opens the drop-down toolbar by using the <bpt id=\"p2\">[</bpt>CMFCDropDownToolbarButton::DropDownToolbar<ept id=\"p2\">](#cmfcdropdowntoolbarbutton__dropdowntoolbar)</ept> method.","pos":[16063,16428],"source":"When a user clicks the toolbar button, this method creates a timer that waits the length of time specified by the [CMFCDropDownToolbarButton::m_uiShowBarDelay](#cmfcdropdowntoolbarbutton__m_uishowbardelay) data member and then opens the drop-down toolbar by using the [CMFCDropDownToolbarButton::DropDownToolbar](#cmfcdropdowntoolbarbutton__dropdowntoolbar) method."},{"content":"This method closes the drop-down toolbar the second time the user clicks the toolbar button.","pos":[16429,16521]},{"pos":[16584,16620],"content":"CMFCDropDownToolbarButton::OnClickUp"},{"content":"Called by the framework when the user releases the mouse button.","pos":[16624,16688]},{"content":"Return Value","pos":[16739,16751]},{"content":"Nonzero if the button processes the click message; otherwise 0.","pos":[16755,16818]},{"content":"Remarks","pos":[16828,16835]},{"pos":[16839,17046],"content":"This method extends the base class implementation, <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnClickUp<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclickup)</ept>, by updating the state of the drop-down toolbar.","source":"This method extends the base class implementation, [CMFCToolBarButton::OnClickUp](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclickup), by updating the state of the drop-down toolbar."},{"content":"This method stops the drop-down toolbar timer if it is active.","pos":[17053,17115]},{"content":"It closes the drop-down toolbar if it is open.","pos":[17116,17162]},{"pos":[17169,17325],"content":"For more information about the drop-down toolbar and drop-down toolbar timer, see <bpt id=\"p1\">[</bpt>CMFCDropDownToolbarButton::OnClick<ept id=\"p1\">](#cmfcdropdowntoolbarbutton__onclick)</ept>.","source":"For more information about the drop-down toolbar and drop-down toolbar timer, see [CMFCDropDownToolbarButton::OnClick](#cmfcdropdowntoolbarbutton__onclick)."},{"pos":[17392,17432],"content":"CMFCDropDownToolbarButton::OnContextHelp"},{"pos":[17436,17519],"content":"Called by the framework when the parent toolbar handles a <ph id=\"ph1\">`WM_HELPHITTEST`</ph> message.","source":"Called by the framework when the parent toolbar handles a `WM_HELPHITTEST` message."},{"content":"Parameters","pos":[17584,17594]},{"content":"[in]","pos":[17598,17602]},{"content":"The parent window of the toolbar button.","pos":[17613,17653]},{"content":"Return Value","pos":[17663,17675]},{"content":"Nonzero if the button processes the help message; otherwise 0.","pos":[17679,17741]},{"content":"Remarks","pos":[17751,17758]},{"content":"This method extends the base class implementation ( <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnContextHelp<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncontexthelp)</ept>) by calling the <bpt id=\"p2\">[</bpt>CMFCDropDownToolbarButton::OnClick<ept id=\"p2\">](#cmfcdropdowntoolbarbutton__onclick)</ept> method with <ph id=\"ph1\">`bDelay`</ph> set to <ph id=\"ph2\">`FALSE`</ph>.","pos":[17762,18056],"source":"This method extends the base class implementation ( [CMFCToolBarButton::OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncontexthelp)) by calling the [CMFCDropDownToolbarButton::OnClick](#cmfcdropdowntoolbarbutton__onclick) method with `bDelay` set to `FALSE`."},{"content":"This method returns the value that is returned by <bpt id=\"p1\">[</bpt>CMFCDropDownToolbarButton::OnClick<ept id=\"p1\">](#cmfcdropdowntoolbarbutton__onclick)</ept>.","pos":[18057,18181],"source":" This method returns the value that is returned by [CMFCDropDownToolbarButton::OnClick](#cmfcdropdowntoolbarbutton__onclick)."},{"pos":[18188,18340],"content":"For more information about the <ph id=\"ph1\">`WM_HELPHITTEST message, see`</ph> <bpt id=\"p1\">[</bpt>TN028: Context-Sensitive Help Support<ept id=\"p1\">](../../mfc/tn028-context-sensitive-help-support.md)</ept>.","source":"For more information about the `WM_HELPHITTEST message, see` [TN028: Context-Sensitive Help Support](../../mfc/tn028-context-sensitive-help-support.md)."},{"pos":[18409,18451],"content":"CMFCDropDownToolbarButton::OnCustomizeMenu"},{"content":"Modifies the provided menu when the application displays a shortcut menu on the parent toolbar.","pos":[18455,18550]},{"content":"Parameters","pos":[18619,18629]},{"content":"[in]","pos":[18633,18637]},{"content":"The menu to customize.","pos":[18649,18671]},{"content":"Return Value","pos":[18681,18693]},{"pos":[18697,18724],"content":"This method returns <ph id=\"ph1\">`TRUE`</ph>.","source":"This method returns `TRUE`."},{"content":"Remarks","pos":[18734,18741]},{"pos":[18745,18956],"content":"This method extends the base class implementation ( <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnCustomizeMenu<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncustomizemenu)</ept>) by disabling the following menu items:","source":"This method extends the base class implementation ( [CMFCToolBarButton::OnCustomizeMenu](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncustomizemenu)) by disabling the following menu items:"},{"content":"Copy Button Image","pos":[18966,18983]},{"content":"Button Appearance","pos":[18995,19012]},{"content":"Image","pos":[19024,19029]},{"content":"Text","pos":[19041,19045]},{"content":"Image and Text","pos":[19057,19071]},{"content":"Override this method to modify the shortcut menu that the framework displays in customization mode.","pos":[19080,19179]},{"pos":[19239,19272],"content":"CMFCDropDownToolbarButton::OnDraw"},{"content":"Called by the framework to draw the button by using the specified styles and options.","pos":[19276,19361]},{"content":"Parameters","pos":[19643,19653]},{"content":"[in]","pos":[19657,19661]},{"content":"The device context that displays the button.","pos":[19671,19715]},{"content":"[in]","pos":[19722,19726]},{"content":"The bounding rectangle of the button.","pos":[19737,19774]},{"content":"[in]","pos":[19781,19785]},{"content":"The collection of toolbar images that is associated with the button.","pos":[19799,19867]},{"content":"[in]","pos":[19874,19878]},{"content":"The dock state of the parent toolbar.","pos":[19890,19927]},{"content":"This parameter is <ph id=\"ph1\">`TRUE`</ph> when the button is docked horizontally and <ph id=\"ph2\">`FALSE`</ph> when the button is docked vertically.","pos":[19928,20041],"source":" This parameter is `TRUE` when the button is docked horizontally and `FALSE` when the button is docked vertically."},{"content":"[in]","pos":[20048,20052]},{"content":"Specifies whether the toolbar is in customization mode.","pos":[20073,20128]},{"content":"This parameter is <ph id=\"ph1\">`TRUE`</ph> when the toolbar is in customization mode and <ph id=\"ph2\">`FALSE`</ph> when the toolbar is not in customization mode.","pos":[20129,20254],"source":" This parameter is `TRUE` when the toolbar is in customization mode and `FALSE` when the toolbar is not in customization mode."},{"content":"[in]","pos":[20261,20265]},{"content":"Specifies whether the button is highlighted.","pos":[20282,20326]},{"content":"This parameter is <ph id=\"ph1\">`TRUE`</ph> when the button is highlighted and <ph id=\"ph2\">`FALSE`</ph> when the button is not highlighted.","pos":[20327,20430],"source":" This parameter is `TRUE` when the button is highlighted and `FALSE` when the button is not highlighted."},{"content":"[in]","pos":[20437,20441]},{"content":"Specifies whether the button should display its border.","pos":[20459,20514]},{"content":"This parameter is <ph id=\"ph1\">`TRUE`</ph> when the button should display its border and <ph id=\"ph2\">`FALSE`</ph> when the button should not display its border.","pos":[20515,20640],"source":" This parameter is `TRUE` when the button should display its border and `FALSE` when the button should not display its border."},{"content":"[in]","pos":[20647,20651]},{"content":"Specifies whether to shade disabled buttons or use the disabled images collection.","pos":[20678,20760]},{"content":"This parameter is <ph id=\"ph1\">`TRUE`</ph> when disabled buttons should be shaded and <ph id=\"ph2\">`FALSE`</ph> when this method should use the disabled images collection.","pos":[20761,20896],"source":" This parameter is `TRUE` when disabled buttons should be shaded and `FALSE` when this method should use the disabled images collection."},{"content":"Remarks","pos":[20906,20913]},{"content":"Override this method to customize toolbar button drawing.","pos":[20917,20974]},{"pos":[21049,21097],"content":"CMFCDropDownToolbarButton::OnDrawOnCustomizeList"},{"pos":[21101,21201],"content":"Called by the framework to draw the button in the <bpt id=\"p1\">**</bpt>Commands<ept id=\"p1\">**</ept> pane of the <bpt id=\"p2\">**</bpt>Customize<ept id=\"p2\">**</ept> dialog box.","source":"Called by the framework to draw the button in the **Commands** pane of the **Customize** dialog box."},{"content":"Parameters","pos":[21323,21333]},{"content":"[in]","pos":[21337,21341]},{"content":"The device context that displays the button.","pos":[21351,21395]},{"content":"[in]","pos":[21402,21406]},{"content":"The bounding rectangle of the button.","pos":[21417,21454]},{"content":"[in]","pos":[21461,21465]},{"content":"Whether the button is selected.","pos":[21481,21512]},{"content":"If this parameter is <ph id=\"ph1\">`TRUE`</ph>, the button is selected.","pos":[21513,21565],"source":" If this parameter is `TRUE`, the button is selected."},{"content":"If this parameter is <ph id=\"ph1\">`FALSE`</ph>, the button is not selected.","pos":[21566,21623],"source":" If this parameter is `FALSE`, the button is not selected."},{"content":"Return Value","pos":[21633,21645]},{"content":"The width, in pixels, of the button on the specified device context.","pos":[21649,21717]},{"content":"Remarks","pos":[21727,21734]},{"pos":[21738,21885],"content":"This method is called by the customization dialog box ( <bpt id=\"p1\">**</bpt>Commands<ept id=\"p1\">**</ept> tab) when the button is required to display itself on the owner-draw list box.","source":"This method is called by the customization dialog box ( **Commands** tab) when the button is required to display itself on the owner-draw list box."},{"pos":[21892,22230],"content":"This method extends the base class implementation ( <bpt id=\"p1\">[</bpt>CMFCToolBarButton::OnDrawOnCustomizeList<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__ondrawoncustomizelist)</ept>) by changing the text label of the button to the name of the button (that is,to the value of the <ph id=\"ph1\">`lpszName`</ph> parameter that you passed to the constructor).","source":"This method extends the base class implementation ( [CMFCToolBarButton::OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__ondrawoncustomizelist)) by changing the text label of the button to the name of the button (that is,to the value of the `lpszName` parameter that you passed to the constructor)."},{"pos":[22293,22329],"content":"CMFCDropDownToolbarButton::Serialize"},{"content":"Reads this object from an archive or writes it to an archive.","pos":[22333,22394]},{"content":"Parameters","pos":[22457,22467]},{"content":"[in]","pos":[22471,22475]},{"content":"The <ph id=\"ph1\">`CArchive`</ph> object from which or to which to serialize.","pos":[22484,22542],"source":" The `CArchive` object from which or to which to serialize."},{"content":"Remarks","pos":[22552,22559]},{"content":"This method extends the base class implementation ( <bpt id=\"p1\">[</bpt>CMFCToolBarButton::Serialize<ept id=\"p1\">](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__serialize)</ept>) by serializing the resource ID of the parent toolbar.","pos":[22563,22777],"source":"This method extends the base class implementation ( [CMFCToolBarButton::Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__serialize)) by serializing the resource ID of the parent toolbar."},{"content":"When the archive is loading ( <bpt id=\"p1\">[</bpt>CArchive::IsLoading<ept id=\"p1\">](../../mfc/reference/carchive-class.md#carchive__isloading)</ept> returns a nonzero value), this method sets the <ph id=\"ph1\">`m_pToolBar`</ph> data member to the toolbar that contains the serialized resource ID.","pos":[22778,23017],"source":" When the archive is loading ( [CArchive::IsLoading](../../mfc/reference/carchive-class.md#carchive__isloading) returns a nonzero value), this method sets the `m_pToolBar` data member to the toolbar that contains the serialized resource ID."},{"pos":[23088,23132],"content":"CMFCDropDownToolbarButton::SetDefaultCommand"},{"content":"Sets the default command that the framework uses when a user clicks the button.","pos":[23136,23215]},{"content":"Parameters","pos":[23276,23286]},{"content":"[in]","pos":[23290,23294]},{"content":"The ID of the default command.","pos":[23306,23336]},{"content":"Remarks","pos":[23346,23353]},{"content":"Call this method to specify a default command that the framework executes when the user clicks the button.","pos":[23357,23463]},{"content":"An item with the command ID specified by <ph id=\"ph1\">`uiCmd`</ph> must be located in the parent drop-down toolbar.","pos":[23464,23561],"source":" An item with the command ID specified by `uiCmd` must be located in the parent drop-down toolbar."},{"content":"See Also","pos":[23570,23578]},{"content":"Hierarchy Chart","pos":[23583,23598]},{"content":"Classes","pos":[23635,23642]},{"content":"CMFCDropDownToolBar Class","pos":[23685,23710]},{"content":"CMFCToolBar Class","pos":[23767,23784]},{"content":"CMFCToolBarMenuButton Class","pos":[23833,23860]},{"content":"Walkthrough: Putting Controls On Toolbars","pos":[23919,23960]}],"content":"---\ntitle: \"CMFCDropDownToolbarButton Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCDropDownToolbarButton\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCDropDownToolbarButton class\"\n  - \"OnCancelMode method\"\nms.assetid: bc9d69e6-bd3e-4c15-9368-e80a504a0ba7\ncaps.latest.revision: 31\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCDropDownToolbarButton Class\nA type of toolbar button that behaves like a regular button when it is clicked. However, it opens a drop-down toolbar ( [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md) if the user presses and holds the toolbar button down.  \n  \n## Syntax  \n  \n```  \nclass CMFCDropDownToolbarButton : public CMFCToolBarButton  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCDropDownToolbarButton::CMFCDropDownToolbarButton](#cmfcdropdowntoolbarbutton__cmfcdropdowntoolbarbutton)|Constructs a `CMFCDropDownToolbarButton` object.|  \n|`CMFCDropDownToolbarButton::~CMFCDropDownToolbarButton`|Destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCDropDownToolbarButton::CopyFrom](#cmfcdropdowntoolbarbutton__copyfrom)|Copies the properties of another toolbar button to the current button. (Overrides [CMFCToolBarButton::CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__copyfrom).)|  \n|`CMFCDropDownToolbarButton::CreateObject`|Used by the framework to create a dynamic instance of this class type.|  \n|[CMFCDropDownToolbarButton::DropDownToolbar](#cmfcdropdowntoolbarbutton__dropdowntoolbar)|Opens a drop-down toolbar.|  \n|[CMFCDropDownToolbarButton::ExportToMenuButton](#cmfcdropdowntoolbarbutton__exporttomenubutton)|Copies text from the toolbar button to a menu. (Overrides [CMFCToolBarButton::ExportToMenuButton](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__exporttomenubutton).)|  \n|[CMFCDropDownToolbarButton::GetDropDownToolBar](#cmfcdropdowntoolbarbutton__getdropdowntoolbar)|Retrieves the drop-down toolbar that is associated with the button.|  \n|`CMFCDropDownToolbarButton::GetThisClass`|Used by the framework to obtain a pointer to the [CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md) object that is associated with this class type.|  \n|[CMFCDropDownToolbarButton::IsDropDown](#cmfcdropdowntoolbarbutton__isdropdown)|Determines whether the drop-down toolbar is currently open.|  \n|[CMFCDropDownToolbarButton::IsExtraSize](#cmfcdropdowntoolbarbutton__isextrasize)|Determines whether the button can be displayed with an extended border. (Overrides [CMFCToolBarButton::IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__isextrasize).)|  \n|[CMFCDropDownToolbarButton::OnCalculateSize](#cmfcdropdowntoolbarbutton__oncalculatesize)|Called by the framework to calculate the size of the button for the specified device context and docking state. (Overrides [CMFCToolBarButton::OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncalculatesize).)|  \n|`CMFCDropDownToolbarButton::OnCancelMode`|Called by the framework to handle the [WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615) message. (Overrides `CMCToolBarButton::OnCancelMode`.)|  \n|[CMFCDropDownToolbarButton::OnChangeParentWnd](#cmfcdropdowntoolbarbutton__onchangeparentwnd)|Called by the framework when the button is inserted into a new toolbar. (Overrides [CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onchangeparentwnd).)|  \n|[CMFCDropDownToolbarButton::OnClick](#cmfcdropdowntoolbarbutton__onclick)|Called by the framework when the user clicks the mouse button. (Overrides [CMFCToolBarButton::OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclick).)|  \n|[CMFCDropDownToolbarButton::OnClickUp](#cmfcdropdowntoolbarbutton__onclickup)|Called by the framework when the user releases the mouse button. (Overrides [CMFCToolBarButton::OnClickUp](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclickup).)|  \n|[CMFCDropDownToolbarButton::OnContextHelp](#cmfcdropdowntoolbarbutton__oncontexthelp)|Called by the framework when the parent toolbar handles a `WM_HELPHITTEST` message. (Overrides [CMFCToolBarButton::OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncontexthelp).)|  \n|[CMFCDropDownToolbarButton::OnCustomizeMenu](#cmfcdropdowntoolbarbutton__oncustomizemenu)|Modifies the provided menu when the application displays a shortcut menu on the parent toolbar. (Overrides [CMFCToolBarButton::OnCustomizeMenu](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncustomizemenu).)|  \n|[CMFCDropDownToolbarButton::OnDraw](#cmfcdropdowntoolbarbutton__ondraw)|Called by the framework to draw the button by using the specified styles and options. (Overrides [CMFCToolBarButton::OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__ondraw).)|  \n|[CMFCDropDownToolbarButton::OnDrawOnCustomizeList](#cmfcdropdowntoolbarbutton__ondrawoncustomizelist)|Called by the framework to draw the button in the **Commands** pane of the **Customize** dialog box. (Overrides [CMFCToolBarButton::OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__ondrawoncustomizelist).)|  \n|[CMFCDropDownToolbarButton::Serialize](#cmfcdropdowntoolbarbutton__serialize)|Reads this object from an archive or writes it to an archive. (Overrides [CMFCToolBarButton::Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__serialize).)|  \n|[CMFCDropDownToolbarButton::SetDefaultCommand](#cmfcdropdowntoolbarbutton__setdefaultcommand)|Sets the default command that the framework uses when a user clicks the button.|  \n  \n### Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCDropDownToolbarButton::m_uiShowBarDelay](#cmfcdropdowntoolbarbutton__m_uishowbardelay)|Specifies the length of time that a user must hold the mouse button down before the drop-down toolbar appears.|  \n  \n## Remarks  \n A `CMFCDropDownToolBarButton` differs from an ordinary button in that it has a small arrow in the lower-right corner of the button. After the user selects a button from the drop-down toolbar, the framework displays its icon on the top-level toolbar button (the button with the small arrow in the lower-right corner).  \n  \n For information about how to implement a drop-down toolbar, see [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md).  \n  \n The `CMFCDropDownToolBarButton` object can be exported to a [CMFCToolBarMenuButton Class](../../mfc/reference/cmfctoolbarmenubutton-class.md) object and displayed as a menu button with a pop-up menu.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)  \n  \n [CMFCDropDownToolbarButton](../../mfc/reference/cmfcdropdowntoolbarbutton-class.md)  \n  \n## Requirements  \n **Header:** afxdropdowntoolbar.h  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__copyfrom\"></a>  CMFCDropDownToolbarButton::CopyFrom  \n Copies the properties of another toolbar button to the current button.  \n  \n```  \nvirtual void CopyFrom(const CMFCToolBarButton& src);\n```  \n  \n### Parameters  \n [in] `src`  \n A reference to the source button from which to copy.  \n  \n### Remarks  \n Call this method to copy another toolbar button to this toolbar button. `src` must be of type `CMFCDropDownToolbarButton`.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__cmfcdropdowntoolbarbutton\"></a>  CMFCDropDownToolbarButton::CMFCDropDownToolbarButton  \n Constructs a `CMFCDropDownToolbarButton` object.  \n  \n```  \nCMFCDropDownToolbarButton();\n\n \nCMFCDropDownToolbarButton(\n    LPCTSTR lpszName,  \n    CMFCDropDownToolBar* pToolBar);\n```  \n  \n### Parameters  \n [in] `lpszName`  \n The default text of the button.  \n  \n [in] `pToolBar`  \n A pointer to the `CMFCDropDownToolBar` object that is displayed when the user presses the button.  \n  \n### Remarks  \n The second overload of the constructor copies to the drop-down button the first button from the toolbar that `pToolBar` specifies.  \n  \n Typically, a drop-down toolbar button uses the text from the most recently used button in the toolbar that `pToolBar` specifies. It uses the text specified by `lpszName` when the button is converted to a menu button or is displayed in the **Commands** tab of the **Customize** dialog box. For more information about the **Customize** dialog box, see [CMFCToolBarsCustomizeDialog Class](../../mfc/reference/cmfctoolbarscustomizedialog-class.md).  \n  \n### Example  \n The following example demonstrates how to construct an object of the `CMFCDropDownToolbarButton` class. This code snippet is part of the [Visual Studio Demo sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_VisualStudioDemo#31](../../mfc/codesnippet/cpp/cmfcdropdowntoolbarbutton-class_1.cpp)]  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__dropdowntoolbar\"></a>  CMFCDropDownToolbarButton::DropDownToolbar  \n Opens a drop-down toolbar.  \n  \n```  \nBOOL DropDownToolbar(CWnd* pWnd);\n```  \n  \n### Parameters  \n [in] `pWnd`  \n The parent window of the drop-down frame, or `NULL` to use the parent window of the drop-down toolbar button.  \n  \n### Return Value  \n Nonzero if the method is successful; otherwise 0.  \n  \n### Remarks  \n The [CMFCDropDownToolbarButton::OnClick](#cmfcdropdowntoolbarbutton__onclick) method calls this method to open the drop-down toolbar when the user presses and holds the toolbar button down.  \n  \n This methods creates the drop-down toolbar by using the [CMFCDropDownFrame::Create](../../mfc/reference/cmfcdropdownframe-class.md#cmfcdropdownframe__create) method. If the parent toolbar is docked vertically, this method positions the drop-down toolbar either to the left-hand or right-hand side of the parent toolbar, depending on the fit. Otherwise, this method positions the drop-down toolbar underneath the parent toolbar.  \n  \n This method fails if `pWnd` is `NULL` and the drop-down toolbar button does not have a parent window.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__exporttomenubutton\"></a>  CMFCDropDownToolbarButton::ExportToMenuButton  \n Copies text from the toolbar button to a menu.  \n  \n```  \nvirtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;\n\n \n```  \n  \n### Parameters  \n [in] `menuButton`  \n A reference to the target menu button.  \n  \n### Return Value  \n Nonzero if the method succeeds; otherwise 0.  \n  \n### Remarks  \n This method calls the base class implementation ( [CMFCToolBarButton::ExportToMenuButton](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__exporttomenubutton)) and then appends to the target menu button a pop-up menu that contains each toolbar menu item in this button. This method does not append sub-menus to the pop-up menu.  \n  \n This method fails if the parent toolbar, `m_pToolBar`, is `NULL` or the base class implementation returns `FALSE`.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__getdropdowntoolbar\"></a>  CMFCDropDownToolbarButton::GetDropDownToolBar  \n Retrieves the drop-down toolbar that is associated with the button.  \n  \n```  \nCMFCToolBar* GetDropDownToolBar() const;\n\n \n```  \n  \n### Return Value  \n The drop-down toolbar that is associated with the button.  \n  \n### Remarks  \n This method returns the `m_pToolBar` data member.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__isdropdown\"></a>  CMFCDropDownToolbarButton::IsDropDown  \n Determines whether the drop-down toolbar is currently open.  \n  \n```  \nBOOL IsDropDown() const;\n\n \n```  \n  \n### Return Value  \n Nonzero if the drop-down toolbar is currently open; otherwise 0.  \n  \n### Remarks  \n The framework opens the drop-down toolbar by using the [CMFCDropDownToolbarButton::DropDownToolbar](#cmfcdropdowntoolbarbutton__dropdowntoolbar) method. The framework closes the drop-down toolbar when the user presses the left-mouse button in the non-client area of the drop-down toolbar.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__isextrasize\"></a>  CMFCDropDownToolbarButton::IsExtraSize  \n Determines whether the button can be displayed with an extended border.  \n  \n```  \nvirtual BOOL IsExtraSize() const;\n\n \n```  \n  \n### Return Value  \n Nonzero if the toolbar button can be displayed with an extended border; otherwise 0.  \n  \n### Remarks  \n For more information about extended borders, see [CMFCToolBarButton::IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__isextrasize).  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__m_uishowbardelay\"></a>  CMFCDropDownToolbarButton::m_uiShowBarDelay  \n Specifies the length of time that a user must hold the mouse button down before the drop-down toolbar appears.  \n  \n```  \nstatic UINT m_uiShowBarDelay;  \n```  \n  \n### Remarks  \n The delay time is measured in milliseconds. The default value is 500. You can set another delay by changing the value of this shared data member.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__oncalculatesize\"></a>  CMFCDropDownToolbarButton::OnCalculateSize  \n Called by the framework to calculate the size of the button for the specified device context and docking state.  \n  \n```  \nvirtual SIZE OnCalculateSize(\n    CDC* pDC,  \n    const CSize& sizeDefault,  \n    BOOL bHorz);\n```  \n  \n### Parameters  \n [in] `pDC`  \n The device context that displays the button.  \n  \n [in] `sizeDefault`  \n The default size of the button.  \n  \n [in] `bHorz`  \n The dock state of the parent toolbar. This parameter is `TRUE` if the toolbar is docked horizontally or is floating, or `FALSE` if the toolbar is docked vertically.  \n  \n### Return Value  \n A `SIZE` structure that contains the dimensions of the button, in pixels.  \n  \n### Remarks  \n This method extends the base class implementation ( [CMFCToolBarButton::OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncalculatesize)) by adding the width of the drop-down arrow to the horizontal dimension of the button size.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__onchangeparentwnd\"></a>  CMFCDropDownToolbarButton::OnChangeParentWnd  \n Called by the framework when the button is inserted into a new toolbar.  \n  \n```  \nvirtual void OnChangeParentWnd(CWnd* pWndParent);\n```  \n  \n### Parameters  \n [in] `pWndParent`  \n The new parent window.  \n  \n### Remarks  \n This method overrides the base class implementation ( [CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onchangeparentwnd)) by clearing the text label ( [CMFCToolBarButton::m_strText](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__m_strtext)) and setting the [CMFCToolBarButton::m_bText](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__m_btext) and [CMFCToolBarButton::m_bUserButton](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__m_buserbutton) data members to `FALSE`.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__onclick\"></a>  CMFCDropDownToolbarButton::OnClick  \n Called by the framework when the user clicks the mouse button.  \n  \n```  \nvirtual BOOL OnClick(\n    CWnd* pWnd,  \n    BOOL bDelay = TRUE);\n```  \n  \n### Parameters  \n [in] `pWnd`  \n The parent window of the toolbar button.  \n  \n [in] `bDelay`  \n `TRUE` if the message should be handled with a delay.  \n  \n### Return Value  \n Nonzero if the button processes the click message; otherwise 0.  \n  \n### Remarks  \n This method extends the base class implementation, [CMFCToolBarButton::OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclick), by updating the state of the drop-down toolbar.  \n  \n When a user clicks the toolbar button, this method creates a timer that waits the length of time specified by the [CMFCDropDownToolbarButton::m_uiShowBarDelay](#cmfcdropdowntoolbarbutton__m_uishowbardelay) data member and then opens the drop-down toolbar by using the [CMFCDropDownToolbarButton::DropDownToolbar](#cmfcdropdowntoolbarbutton__dropdowntoolbar) method. This method closes the drop-down toolbar the second time the user clicks the toolbar button.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__onclickup\"></a>  CMFCDropDownToolbarButton::OnClickUp  \n Called by the framework when the user releases the mouse button.  \n  \n```  \nvirtual BOOL OnClickUp();\n```  \n  \n### Return Value  \n Nonzero if the button processes the click message; otherwise 0.  \n  \n### Remarks  \n This method extends the base class implementation, [CMFCToolBarButton::OnClickUp](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__onclickup), by updating the state of the drop-down toolbar.  \n  \n This method stops the drop-down toolbar timer if it is active. It closes the drop-down toolbar if it is open.  \n  \n For more information about the drop-down toolbar and drop-down toolbar timer, see [CMFCDropDownToolbarButton::OnClick](#cmfcdropdowntoolbarbutton__onclick).  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__oncontexthelp\"></a>  CMFCDropDownToolbarButton::OnContextHelp  \n Called by the framework when the parent toolbar handles a `WM_HELPHITTEST` message.  \n  \n```  \nvirtual BOOL OnContextHelp(CWnd* pWnd);\n```  \n  \n### Parameters  \n [in] `pWnd`  \n The parent window of the toolbar button.  \n  \n### Return Value  \n Nonzero if the button processes the help message; otherwise 0.  \n  \n### Remarks  \n This method extends the base class implementation ( [CMFCToolBarButton::OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncontexthelp)) by calling the [CMFCDropDownToolbarButton::OnClick](#cmfcdropdowntoolbarbutton__onclick) method with `bDelay` set to `FALSE`. This method returns the value that is returned by [CMFCDropDownToolbarButton::OnClick](#cmfcdropdowntoolbarbutton__onclick).  \n  \n For more information about the `WM_HELPHITTEST message, see` [TN028: Context-Sensitive Help Support](../../mfc/tn028-context-sensitive-help-support.md).  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__oncustomizemenu\"></a>  CMFCDropDownToolbarButton::OnCustomizeMenu  \n Modifies the provided menu when the application displays a shortcut menu on the parent toolbar.  \n  \n```  \nvirtual BOOL OnCustomizeMenu(CMenu* pMenu);\n```  \n  \n### Parameters  \n [in] `pMenu`  \n The menu to customize.  \n  \n### Return Value  \n This method returns `TRUE`.  \n  \n### Remarks  \n This method extends the base class implementation ( [CMFCToolBarButton::OnCustomizeMenu](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__oncustomizemenu)) by disabling the following menu items:  \n  \n- **Copy Button Image**  \n  \n- **Button Appearance**  \n  \n- **Image**  \n  \n- **Text**  \n  \n- **Image and Text**  \n  \n Override this method to modify the shortcut menu that the framework displays in customization mode.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__ondraw\"></a>  CMFCDropDownToolbarButton::OnDraw  \n Called by the framework to draw the button by using the specified styles and options.  \n  \n```  \nvirtual void OnDraw(\n    CDC* pDC,  \n    const CRect& rect,  \n    CMFCToolBarImages* pImages,  \n    BOOL bHorz = TRUE,  \n    BOOL bCustomizeMode = FALSE,  \n    BOOL bHighlight = FALSE,  \n    BOOL bDrawBorder = TRUE,  \n    BOOL bGrayDisabledButtons = TRUE);\n```  \n  \n### Parameters  \n [in] `pDC`  \n The device context that displays the button.  \n  \n [in] `rect`  \n The bounding rectangle of the button.  \n  \n [in] `pImages`  \n The collection of toolbar images that is associated with the button.  \n  \n [in] `bHorz`  \n The dock state of the parent toolbar. This parameter is `TRUE` when the button is docked horizontally and `FALSE` when the button is docked vertically.  \n  \n [in] `bCustomizeMode`  \n Specifies whether the toolbar is in customization mode. This parameter is `TRUE` when the toolbar is in customization mode and `FALSE` when the toolbar is not in customization mode.  \n  \n [in] `bHighlight`  \n Specifies whether the button is highlighted. This parameter is `TRUE` when the button is highlighted and `FALSE` when the button is not highlighted.  \n  \n [in] `bDrawBorder`  \n Specifies whether the button should display its border. This parameter is `TRUE` when the button should display its border and `FALSE` when the button should not display its border.  \n  \n [in] `bGrayDisabledButtons`  \n Specifies whether to shade disabled buttons or use the disabled images collection. This parameter is `TRUE` when disabled buttons should be shaded and `FALSE` when this method should use the disabled images collection.  \n  \n### Remarks  \n Override this method to customize toolbar button drawing.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__ondrawoncustomizelist\"></a>  CMFCDropDownToolbarButton::OnDrawOnCustomizeList  \n Called by the framework to draw the button in the **Commands** pane of the **Customize** dialog box.  \n  \n```  \nvirtual int OnDrawOnCustomizeList(\n    CDC* pDC,  \n    const CRect& rect,  \n    BOOL bSelected);\n```  \n  \n### Parameters  \n [in] `pDC`  \n The device context that displays the button.  \n  \n [in] `rect`  \n The bounding rectangle of the button.  \n  \n [in] `bSelected`  \n Whether the button is selected. If this parameter is `TRUE`, the button is selected. If this parameter is `FALSE`, the button is not selected.  \n  \n### Return Value  \n The width, in pixels, of the button on the specified device context.  \n  \n### Remarks  \n This method is called by the customization dialog box ( **Commands** tab) when the button is required to display itself on the owner-draw list box.  \n  \n This method extends the base class implementation ( [CMFCToolBarButton::OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__ondrawoncustomizelist)) by changing the text label of the button to the name of the button (that is,to the value of the `lpszName` parameter that you passed to the constructor).  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__serialize\"></a>  CMFCDropDownToolbarButton::Serialize  \n Reads this object from an archive or writes it to an archive.  \n  \n```  \nvirtual void Serialize(CArchive& ar);\n```  \n  \n### Parameters  \n [in] `ar`  \n The `CArchive` object from which or to which to serialize.  \n  \n### Remarks  \n This method extends the base class implementation ( [CMFCToolBarButton::Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#cmfctoolbarbutton__serialize)) by serializing the resource ID of the parent toolbar. When the archive is loading ( [CArchive::IsLoading](../../mfc/reference/carchive-class.md#carchive__isloading) returns a nonzero value), this method sets the `m_pToolBar` data member to the toolbar that contains the serialized resource ID.  \n  \n##  <a name=\"cmfcdropdowntoolbarbutton__setdefaultcommand\"></a>  CMFCDropDownToolbarButton::SetDefaultCommand  \n Sets the default command that the framework uses when a user clicks the button.  \n  \n```  \nvoid SetDefaultCommand(UINT uiCmd);\n```  \n  \n### Parameters  \n [in] `uiCmd`  \n The ID of the default command.  \n  \n### Remarks  \n Call this method to specify a default command that the framework executes when the user clicks the button. An item with the command ID specified by `uiCmd` must be located in the parent drop-down toolbar.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md)   \n [CMFCToolBar Class](../../mfc/reference/cmfctoolbar-class.md)   \n [CMFCToolBarMenuButton Class](../../mfc/reference/cmfctoolbarmenubutton-class.md)   \n [Walkthrough: Putting Controls On Toolbars](../../mfc/walkthrough-putting-controls-on-toolbars.md)\n\n\n\n"}