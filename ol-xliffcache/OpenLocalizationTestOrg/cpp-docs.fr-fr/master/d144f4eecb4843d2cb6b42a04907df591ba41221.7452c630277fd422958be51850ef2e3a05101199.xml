{"nodes":[{"pos":[12,46],"content":"_CrtMemDifference | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"_CrtMemDifference | Microsoft Docs","pos":[0,34]}]},{"pos":[962,979],"content":"_CrtMemDifference","linkify":"_CrtMemDifference","nodes":[{"content":"_CrtMemDifference","pos":[0,17]}]},{"content":"Compares two memory states and returns their differences (debug version only).","pos":[980,1058]},{"pos":[1067,1073],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1230,1240],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to a <ph id=\"ph1\">`_CrtMemState`</ph> structure that is used to store the differences between the two memory states (returned).","pos":[1259,1376],"source":" Pointer to a `_CrtMemState` structure that is used to store the differences between the two memory states (returned)."},{"content":"Pointer to an earlier memory state (<ph id=\"ph1\">`_CrtMemState`</ph> structure).","pos":[1397,1459],"source":" Pointer to an earlier memory state (`_CrtMemState` structure)."},{"content":"Pointer to a later memory state (<ph id=\"ph1\">`_CrtMemState`</ph> structure).","pos":[1480,1539],"source":" Pointer to a later memory state (`_CrtMemState` structure)."},{"pos":[1548,1560],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"If the memory states are significantly different, <ph id=\"ph1\">`_CrtMemDifference`</ph> returns TRUE.","pos":[1564,1647],"source":"If the memory states are significantly different, `_CrtMemDifference` returns TRUE."},{"content":"Otherwise, the function returns FALSE.","pos":[1648,1686]},{"pos":[1695,1702],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`_CrtMemDifference`</ph> function compares <ph id=\"ph2\">`oldState`</ph> and <ph id=\"ph3\">`newState`</ph> and stores their differences in <ph id=\"ph4\">`stateDiff`</ph>, which can then be used by the application to detect memory leaks and other memory problems.","pos":[1706,1910],"source":"The `_CrtMemDifference` function compares `oldState` and `newState` and stores their differences in `stateDiff`, which can then be used by the application to detect memory leaks and other memory problems."},{"content":"When <bpt id=\"p1\">[</bpt>_DEBUG<ept id=\"p1\">](../../c-runtime-library/debug.md)</ept> is not defined, calls to <ph id=\"ph1\">`_CrtMemDifference`</ph> are removed during preprocessing.","pos":[1911,2037],"source":" When [_DEBUG](../../c-runtime-library/debug.md) is not defined, calls to `_CrtMemDifference` are removed during preprocessing."},{"content":"<ph id=\"ph1\">`newState`</ph> and <ph id=\"ph2\">`oldState`</ph> must each be a valid pointer to a <ph id=\"ph3\">`_CrtMemState`</ph> structure, defined in Crtdbg.h, that has been filled in by <bpt id=\"p1\">[</bpt>_CrtMemCheckpoint<ept id=\"p1\">](../../c-runtime-library/reference/crtmemcheckpoint.md)</ept> before calling <ph id=\"ph4\">`_CrtMemDifference`</ph>.","pos":[2044,2288],"source":"`newState` and `oldState` must each be a valid pointer to a `_CrtMemState` structure, defined in Crtdbg.h, that has been filled in by [_CrtMemCheckpoint](../../c-runtime-library/reference/crtmemcheckpoint.md) before calling `_CrtMemDifference`."},{"content":"<ph id=\"ph1\">`stateDiff`</ph> must be a pointer to a previously allocated instance of the <ph id=\"ph2\">`_CrtMemState`</ph> structure.","pos":[2289,2386],"source":"`stateDiff` must be a pointer to a previously allocated instance of the `_CrtMemState` structure."},{"content":"If <ph id=\"ph1\">`stateDiff`</ph>, <ph id=\"ph2\">`newState`</ph>, or <ph id=\"ph3\">`oldState`</ph> is <ph id=\"ph4\">`NULL`</ph>, the invalid parameter handler is invoked, as described in <bpt id=\"p1\">[</bpt>Parameter Validation<ept id=\"p1\">](../../c-runtime-library/parameter-validation.md)</ept>.","pos":[2387,2570],"source":" If `stateDiff`, `newState`, or `oldState` is `NULL`, the invalid parameter handler is invoked, as described in [Parameter Validation](../../c-runtime-library/parameter-validation.md)."},{"content":"If execution is allowed to continue, <bpt id=\"p1\">[</bpt>errno, _doserrno, _sys_errlist, and _sys_nerr<ept id=\"p1\">](../../c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr.md)</ept> is set to <ph id=\"ph1\">`EINVAL`</ph> and the function returns FALSE.","pos":[2571,2774],"source":" If execution is allowed to continue, [errno, _doserrno, _sys_errlist, and _sys_nerr](../../c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr.md) is set to `EINVAL` and the function returns FALSE."},{"content":"<ph id=\"ph1\">`_CrtMemDifference`</ph> compares the <ph id=\"ph2\">`_CrtMemState`</ph> field values of the blocks in <ph id=\"ph3\">`oldState`</ph> to those in <ph id=\"ph4\">`newState`</ph> and stores the result in <ph id=\"ph5\">`stateDiff`</ph>.","pos":[2781,2930],"source":"`_CrtMemDifference` compares the `_CrtMemState` field values of the blocks in `oldState` to those in `newState` and stores the result in `stateDiff`."},{"content":"When the number of allocated block types or total number of allocated blocks for each type differs between the two memory states, the states are said to be significantly different.","pos":[2931,3111]},{"content":"The difference between the largest amount ever allocated at once for the two states and the difference between total allocations for the two states are also stored in <ph id=\"ph1\">`stateDiff`</ph>.","pos":[3112,3291],"source":" The difference between the largest amount ever allocated at once for the two states and the difference between total allocations for the two states are also stored in `stateDiff`."},{"content":"By default, internal C run-time blocks (<ph id=\"ph1\">`_CRT_BLOCK`</ph>) are not included in memory state operations.","pos":[3298,3396],"source":"By default, internal C run-time blocks (`_CRT_BLOCK`) are not included in memory state operations."},{"content":"The <bpt id=\"p1\">[</bpt>_CrtSetDbgFlag<ept id=\"p1\">](../../c-runtime-library/reference/crtsetdbgflag.md)</ept> function can be used to turn on the <ph id=\"ph1\">`_CRTDBG_CHECK_CRT_DF`</ph> bit of <ph id=\"ph2\">`_crtDbgFlag`</ph> to include these blocks in leak detection and other memory state operations.","pos":[3397,3626],"source":" The [_CrtSetDbgFlag](../../c-runtime-library/reference/crtsetdbgflag.md) function can be used to turn on the `_CRTDBG_CHECK_CRT_DF` bit of `_crtDbgFlag` to include these blocks in leak detection and other memory state operations."},{"content":"Freed memory blocks (<ph id=\"ph1\">`_FREE_BLOCK`</ph>) do not cause <ph id=\"ph2\">`_CrtMemDifference`</ph> to return TRUE.","pos":[3627,3711],"source":" Freed memory blocks (`_FREE_BLOCK`) do not cause `_CrtMemDifference` to return TRUE."},{"content":"For more information about heap state functions and the <ph id=\"ph1\">`_CrtMemState`</ph> structure, see <bpt id=\"p1\">[</bpt>Heap State Reporting Functions<ept id=\"p1\">](/visualstudio/debugger/crt-debug-heap-details)</ept>.","pos":[3718,3884],"source":"For more information about heap state functions and the `_CrtMemState` structure, see [Heap State Reporting Functions](/visualstudio/debugger/crt-debug-heap-details)."},{"content":"For information about how memory blocks are allocated, initialized, and managed in the debug version of the base heap, see <bpt id=\"p1\">[</bpt>CRT Debug Heap Details<ept id=\"p1\">](/visualstudio/debugger/crt-debug-heap-details)</ept>.","pos":[3885,4080],"source":" For information about how memory blocks are allocated, initialized, and managed in the debug version of the base heap, see [CRT Debug Heap Details](/visualstudio/debugger/crt-debug-heap-details)."},{"pos":[4089,4101],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"content":"Routine","pos":[4108,4115]},{"content":"Required header","pos":[4116,4131]},{"content":"Optional header","pos":[4132,4147]},{"content":"<ph id=\"ph1\">\\&lt;</ph>crtdbg.h&gt;","pos":[4234,4245],"source":"\\<crtdbg.h>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>errno.h&gt;","pos":[4246,4256],"source":"\\<errno.h>"},{"pos":[4264,4382],"content":"For more compatibility information, see <bpt id=\"p1\">[</bpt>Compatibility<ept id=\"p1\">](../../c-runtime-library/compatibility.md)</ept> in the Introduction.","source":"For more compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md) in the Introduction."},{"pos":[4389,4499],"content":"<bpt id=\"p1\">**</bpt>Libraries:<ept id=\"p1\">**</ept> Debug versions of <bpt id=\"p2\">[</bpt>CRT Library Features<ept id=\"p2\">](../../c-runtime-library/crt-library-features.md)</ept> only.","source":"**Libraries:** Debug versions of [CRT Library Features](../../c-runtime-library/crt-library-features.md) only."},{"pos":[4508,4533],"content":".NET Framework Equivalent","linkify":".NET Framework Equivalent","nodes":[{"content":".NET Framework Equivalent","pos":[0,25]}]},{"content":"Not applicable.","pos":[4537,4552]},{"content":"To call the standard C function, use <ph id=\"ph1\">`PInvoke`</ph>.","pos":[4553,4600],"source":" To call the standard C function, use `PInvoke`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Platform Invoke Examples<ept id=\"p1\">](http://msdn.microsoft.com/Library/15926806-f0b7-487e-93a6-4e9367ec689f)</ept>.","pos":[4601,4726],"source":" For more information, see [Platform Invoke Examples](http://msdn.microsoft.com/Library/15926806-f0b7-487e-93a6-4e9367ec689f)."},{"pos":[4735,4743],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Debug Routines<ept id=\"p1\">](../../c-runtime-library/debug-routines.md)</ept><ph id=\"ph1\"> </ph>","pos":[4747,4807],"source":"[Debug Routines](../../c-runtime-library/debug-routines.md) "},{"content":"<bpt id=\"p1\"> [</bpt>_crtDbgFlag<ept id=\"p1\">](../../c-runtime-library/crtdbgflag.md)</ept>","pos":[4810,4863],"source":" [_crtDbgFlag](../../c-runtime-library/crtdbgflag.md)"}],"content":"---\ntitle: \"_CrtMemDifference | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\napiname: \n  - \"_CrtMemDifference\"\napilocation: \n  - \"msvcrt.dll\"\n  - \"msvcr80.dll\"\n  - \"msvcr90.dll\"\n  - \"msvcr100.dll\"\n  - \"msvcr100_clr0400.dll\"\n  - \"msvcr110.dll\"\n  - \"msvcr110_clr0400.dll\"\n  - \"msvcr120.dll\"\n  - \"msvcr120_clr0400.dll\"\n  - \"ucrtbase.dll\"\napitype: \"DLLExport\"\nf1_keywords: \n  - \"_CrtMemDifference\"\n  - \"CrtMemDifference\"\ndev_langs: \n  - \"C++\"\n  - \"C\"\nhelpviewer_keywords: \n  - \"CrtMemDifference function\"\n  - \"_CrtMemDifference function\"\nms.assetid: 0f327278-b551-482f-958b-76941f796ba4\ncaps.latest.revision: 16\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# _CrtMemDifference\nCompares two memory states and returns their differences (debug version only).  \n  \n## Syntax  \n  \n```  \nint _CrtMemDifference(   \n   _CrtMemState *stateDiff,  \n   const _CrtMemState *oldState,  \n   const _CrtMemState *newState   \n);  \n```  \n  \n#### Parameters  \n `stateDiff`  \n Pointer to a `_CrtMemState` structure that is used to store the differences between the two memory states (returned).  \n  \n `oldState`  \n Pointer to an earlier memory state (`_CrtMemState` structure).  \n  \n `newState`  \n Pointer to a later memory state (`_CrtMemState` structure).  \n  \n## Return Value  \n If the memory states are significantly different, `_CrtMemDifference` returns TRUE. Otherwise, the function returns FALSE.  \n  \n## Remarks  \n The `_CrtMemDifference` function compares `oldState` and `newState` and stores their differences in `stateDiff`, which can then be used by the application to detect memory leaks and other memory problems. When [_DEBUG](../../c-runtime-library/debug.md) is not defined, calls to `_CrtMemDifference` are removed during preprocessing.  \n  \n `newState` and `oldState` must each be a valid pointer to a `_CrtMemState` structure, defined in Crtdbg.h, that has been filled in by [_CrtMemCheckpoint](../../c-runtime-library/reference/crtmemcheckpoint.md) before calling `_CrtMemDifference`. `stateDiff` must be a pointer to a previously allocated instance of the `_CrtMemState` structure. If `stateDiff`, `newState`, or `oldState` is `NULL`, the invalid parameter handler is invoked, as described in [Parameter Validation](../../c-runtime-library/parameter-validation.md). If execution is allowed to continue, [errno, _doserrno, _sys_errlist, and _sys_nerr](../../c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr.md) is set to `EINVAL` and the function returns FALSE.  \n  \n `_CrtMemDifference` compares the `_CrtMemState` field values of the blocks in `oldState` to those in `newState` and stores the result in `stateDiff`. When the number of allocated block types or total number of allocated blocks for each type differs between the two memory states, the states are said to be significantly different. The difference between the largest amount ever allocated at once for the two states and the difference between total allocations for the two states are also stored in `stateDiff`.  \n  \n By default, internal C run-time blocks (`_CRT_BLOCK`) are not included in memory state operations. The [_CrtSetDbgFlag](../../c-runtime-library/reference/crtsetdbgflag.md) function can be used to turn on the `_CRTDBG_CHECK_CRT_DF` bit of `_crtDbgFlag` to include these blocks in leak detection and other memory state operations. Freed memory blocks (`_FREE_BLOCK`) do not cause `_CrtMemDifference` to return TRUE.  \n  \n For more information about heap state functions and the `_CrtMemState` structure, see [Heap State Reporting Functions](/visualstudio/debugger/crt-debug-heap-details). For information about how memory blocks are allocated, initialized, and managed in the debug version of the base heap, see [CRT Debug Heap Details](/visualstudio/debugger/crt-debug-heap-details).  \n  \n## Requirements  \n  \n|Routine|Required header|Optional header|  \n|-------------|---------------------|---------------------|  \n|`_CrtMemDifference`|\\<crtdbg.h>|\\<errno.h>|  \n  \n For more compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md) in the Introduction.  \n  \n **Libraries:** Debug versions of [CRT Library Features](../../c-runtime-library/crt-library-features.md) only.  \n  \n## .NET Framework Equivalent  \n Not applicable. To call the standard C function, use `PInvoke`. For more information, see [Platform Invoke Examples](http://msdn.microsoft.com/Library/15926806-f0b7-487e-93a6-4e9367ec689f).  \n  \n## See Also  \n [Debug Routines](../../c-runtime-library/debug-routines.md)   \n [_crtDbgFlag](../../c-runtime-library/crtdbgflag.md)"}