{"nodes":[{"pos":[12,100],"content":"Troubleshooting C-C++ Isolated Applications and Side-by-side Assemblies | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Troubleshooting C-C++ Isolated Applications and Side-by-side Assemblies | Microsoft Docs","pos":[0,88]}]},{"content":"Troubleshooting C/C++ Isolated Applications and Side-by-side Assemblies","pos":[726,797]},{"content":"Loading a C/C++ application can fail if dependent libraries cannot be found.","pos":[798,874]},{"content":"This article describes some common reasons why a C/C++ application fails to load, and suggests steps to resolve the problems.","pos":[875,1000]},{"content":"If an application fails to load because it has a manifest that specifies a dependency on a side-by-side assembly, and the assembly is not installed as a private assembly in the same folder as the executable nor in the native assembly cache in the %WINDIR%\\WinSxS\\ folder, one of the following error messages might be displayed, depending on the version of Windows on which you try to run the app.","pos":[1007,1403]},{"content":"The application failed to initialize properly (0xc0000135).","pos":[1413,1472]},{"content":"This application has failed to start because the application configuration is incorrect.","pos":[1482,1570]},{"content":"Reinstalling the application may fix this problem.","pos":[1571,1621]},{"content":"The system cannot execute the specified program.","pos":[1631,1679]},{"content":"If your application has no manifest and depends on a DLL that Windows can’t find in the typical search locations, an error message that resembles this one might be displayed:","pos":[1686,1860]},{"content":"This application has failed to start because <bpt id=\"p1\">*</bpt>a required DLL<ept id=\"p1\">*</ept> was not found.","pos":[1870,1946],"source":"This application has failed to start because *a required DLL* was not found."},{"content":"Re-installing the application may fix this problem.","pos":[1947,1998]},{"content":"If your application is deployed on a computer that doesn't have Visual Studio, and it crashes with error messages that resemble the previous ones, check these things:","pos":[2005,2171]},{"content":"Follow the steps that are described in <bpt id=\"p1\">[</bpt>Understanding the Dependencies of a Visual C++ Application<ept id=\"p1\">](../ide/understanding-the-dependencies-of-a-visual-cpp-application.md)</ept>.","pos":[2181,2351],"source":"Follow the steps that are described in [Understanding the Dependencies of a Visual C++ Application](../ide/understanding-the-dependencies-of-a-visual-cpp-application.md)."},{"content":"The dependency walker can show most dependencies for an application or DLL.","pos":[2352,2427]},{"content":"If you observe that some DLLs are missing, install them on the computer on which you are trying to run your application.","pos":[2428,2548]},{"content":"The operating system loader uses the application manifest to load assemblies that the application depends on.","pos":[2558,2667]},{"content":"The manifest can either be embedded in the binary as a resource, or installed as a separate file in the application folder.","pos":[2668,2791]},{"content":"To check whether the manifest is embedded in the binary, open the binary in <ph id=\"ph1\">[!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)]</ph> and look for RT_MANIFEST in its list of resources.","pos":[2792,2978],"source":" To check whether the manifest is embedded in the binary, open the binary in [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] and look for RT_MANIFEST in its list of resources."},{"content":"If you can't find an embedded manifest, look in the application folder for a file that's named something like &lt;binary_name&gt;.<ph id=\"ph1\">\\&lt;</ph>extension&gt;.manifest.","pos":[2979,3125],"source":" If you can't find an embedded manifest, look in the application folder for a file that's named something like <binary_name>.\\<extension>.manifest."},{"content":"If your application depends on side-by-side assemblies and a manifest is not present, you have to ensure that the linker generates a manifest for your project.","pos":[3135,3294]},{"content":"Check the linker option <bpt id=\"p1\">**</bpt>Generate manifest<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Project Properties<ept id=\"p2\">**</ept> dialog box for the project.","pos":[3295,3398],"source":" Check the linker option **Generate manifest** in the **Project Properties** dialog box for the project."},{"content":"If the manifest is embedded in the binary, ensure that the ID of RT_MANIFEST is correct for this type of the binary.","pos":[3408,3524]},{"content":"For more information about which resource ID to use, see <bpt id=\"p1\">[</bpt>Using Side-by-Side Assemblies as a Resource (Windows)<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa376617.aspx)</ept>.","pos":[3525,3703],"source":" For more information about which resource ID to use, see [Using Side-by-Side Assemblies as a Resource (Windows)](http://msdn.microsoft.com/library/windows/desktop/aa376617.aspx)."},{"content":"If the manifest is in a separate file, open it in an XML editor or text editor.","pos":[3704,3783]},{"content":"For more information about manifests and rules for deployment, see <bpt id=\"p1\">[</bpt>Manifests<ept id=\"p1\">](http://msdn.microsoft.com/library/aa375365)</ept>.","pos":[3784,3907],"source":" For more information about manifests and rules for deployment, see [Manifests](http://msdn.microsoft.com/library/aa375365)."},{"pos":[3919,4208],"content":"[!NOTE]\n If both an embedded manifest and a separate manifest file are present, the operating system loader uses the embedded manifest and ignores the separate file. However, on Windows XP, the opposite is true—the separate manifest file is used and the embedded manifest is ignored.","leadings":["","    > "],"nodes":[{"content":" If both an embedded manifest and a separate manifest file are present, the operating system loader uses the embedded manifest and ignores the separate file. However, on Windows XP, the opposite is true—the separate manifest file is used and the embedded manifest is ignored.","pos":[8,283],"nodes":[{"content":"If both an embedded manifest and a separate manifest file are present, the operating system loader uses the embedded manifest and ignores the separate file.","pos":[1,157]},{"content":"However, on Windows XP, the opposite is true—the separate manifest file is used and the embedded manifest is ignored.","pos":[158,275]}]}]},{"content":"We recommend that you embed a manifest in every DLL because external manifests are ignored when a DLL is loaded though a <ph id=\"ph1\">`LoadLibrary`</ph> call.","pos":[4218,4358],"source":"We recommend that you embed a manifest in every DLL because external manifests are ignored when a DLL is loaded though a `LoadLibrary` call."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Assembly manifests<ept id=\"p1\">](http://msdn.microsoft.com/library/aa374219)</ept>.","pos":[4359,4450],"source":" For more information, see [Assembly manifests](http://msdn.microsoft.com/library/aa374219)."},{"content":"Check that all assemblies that are enumerated in the manifest are correctly installed on the computer.","pos":[4460,4562]},{"content":"Each assembly is specified in the manifest by its name, version number, and processor architecture.","pos":[4563,4662]},{"content":"If your application depends on side-by-side assemblies, check that these assemblies are correctly installed on the computer so that the operating system loader can find them, as described in <bpt id=\"p1\">[</bpt>Assembly Searching Sequence<ept id=\"p1\">](http://msdn.microsoft.com/library/aa374224)</ept>.","pos":[4663,4928],"source":" If your application depends on side-by-side assemblies, check that these assemblies are correctly installed on the computer so that the operating system loader can find them, as described in [Assembly Searching Sequence](http://msdn.microsoft.com/library/aa374224)."},{"content":"Remember that 64-bit assemblies cannot be loaded in 32-bit processes and cannot be executed on 32-bit operating systems.","pos":[4929,5049]},{"content":"Example","pos":[5058,5065]},{"content":"Assume we have an application, appl.exe, that's built by using <ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph>.","pos":[5069,5183],"source":"Assume we have an application, appl.exe, that's built by using [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]."},{"content":"The application manifest either is embedded in appl.exe as the binary resource RT_MANIFEST, which has an ID equal to 1, or is stored as the separate file appl.exe.manifest.","pos":[5184,5356]},{"content":"The content of this manifest resembles this:","pos":[5357,5401]},{"content":"To the operating system loader, this manifest says that appl.exe depends on an assembly named Fabrikam.SxS.Library, version 2.0.20121.0, that's built for a 32-bit x86 processor architecture.","pos":[5772,5962]},{"content":"The dependent side-by-side assembly can be installed either as a shared assembly or as a private assembly.","pos":[5963,6069]},{"content":"The assembly manifest for a shared assembly is installed in the %WINDIR%\\WinSxS\\Manifests\\ folder.","pos":[6076,6174]},{"content":"It identifies the assembly and lists its contents—that is, the DLLs that are part of the assembly:","pos":[6175,6273]},{"content":"Side-by-side assemblies can also use <bpt id=\"p1\">[</bpt>publisher configuration files<ept id=\"p1\">](http://msdn.microsoft.com/library/aa375682)</ept>—also known as policy files—to globally redirect applications and assemblies to use one version of a side-by-side assembly instead of another version of the same assembly.","pos":[6819,7102],"source":"Side-by-side assemblies can also use [publisher configuration files](http://msdn.microsoft.com/library/aa375682)—also known as policy files—to globally redirect applications and assemblies to use one version of a side-by-side assembly instead of another version of the same assembly."},{"content":"You can check the policies for a shared assembly in the %WINDIR%\\WinSxS\\Policies\\ folder.","pos":[7103,7192]},{"content":"Here is an example policy file:","pos":[7193,7224]},{"content":"This policy file specifies that any application or assembly that asks for version 2.0.10000.0 of this assembly should instead use version 2.0.20121.0, which is the current version that's installed on the system.","pos":[7886,8097]},{"content":"If a version of the assembly that's mentioned in the application manifest is specified in the policy file, the loader looks for a version of this assembly that's specified in the manifest in the %WINDIR%\\WinSxS\\ folder, and if this version is not installed, load fails.","pos":[8098,8367]},{"content":"And if assembly version 2.0.20121.0 is not installed, load fails for applications that ask for assembly version 2.0.10000.0.","pos":[8368,8492]},{"content":"However, the assembly can also be installed as a private side-by-side assembly in the installed application folder.","pos":[8499,8614]},{"content":"If the operating system fails to find the assembly as a shared assembly, it looks for it as a private assembly, in the following order:","pos":[8615,8750]},{"content":"Check the application folder for a manifest file that has the name <ph id=\"ph1\">\\&lt;</ph>assemblyName&gt;.manifest.","pos":[8760,8852],"source":"Check the application folder for a manifest file that has the name \\<assemblyName>.manifest."},{"content":"In this example, the loader tries to find Fabrikam.SxS.Library.manifest in the folder that contains appl.exe.","pos":[8853,8962]},{"content":"If it finds the manifest, the loader loads the assembly from the application folder.","pos":[8963,9047]},{"content":"If the assembly is not found, load fails.","pos":[9048,9089]},{"content":"Try to open the <ph id=\"ph1\">\\\\</ph>&lt;assemblyName<ph id=\"ph2\">\\&gt;</ph>\\ folder in the folder that contains appl.exe, and if <ph id=\"ph3\">\\\\</ph>&lt;assemblyName<ph id=\"ph4\">\\&gt;</ph>\\ exists, try to load a manifest file that has the name <ph id=\"ph5\">\\&lt;</ph>assemblyName&gt;.manifest from this folder.","pos":[9099,9301],"source":"Try to open the \\\\<assemblyName\\>\\ folder in the folder that contains appl.exe, and if \\\\<assemblyName\\>\\ exists, try to load a manifest file that has the name \\<assemblyName>.manifest from this folder."},{"content":"If the manifest is found, the loader loads the assembly from the <ph id=\"ph1\">\\\\</ph>&lt;assemblyName<ph id=\"ph2\">\\&gt;</ph>\\ folder.","pos":[9302,9393],"source":" If the manifest is found, the loader loads the assembly from the \\\\<assemblyName\\>\\ folder."},{"content":"If the assembly is not found, load fails.","pos":[9394,9435]},{"content":"For more information about how the loader searches for dependent assemblies, see <bpt id=\"p1\">[</bpt>Assembly Searching Sequence<ept id=\"p1\">](http://msdn.microsoft.com/library/aa374224)</ept>.","pos":[9442,9597],"source":"For more information about how the loader searches for dependent assemblies, see [Assembly Searching Sequence](http://msdn.microsoft.com/library/aa374224)."},{"content":"If the loader fails to find a dependent assembly as a private assembly, load fails and the message \"The system cannot execute the specified program\" is displayed.","pos":[9598,9760]},{"content":"To resolve this error, make sure that dependent assemblies—and DLLs that are part of them—are installed on the computer as either private or shared assemblies.","pos":[9761,9920]},{"content":"See Also","pos":[9929,9937]},{"content":"Concepts of Isolated Applications and Side-by-side Assemblies","pos":[9942,10003]},{"content":"Building C/C++ Isolated Applications and Side-by-side Assemblies","pos":[10085,10149]}],"content":"---\ntitle: \"Troubleshooting C-C++ Isolated Applications and Side-by-side Assemblies | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"troubleshooting side-by-side assemblies\"\n  - \"troubleshooting isolated applications\"\n  - \"troubleshooting Visual C++\"\nms.assetid: 3257257a-1f0b-4ede-8564-9277a7113a35\ncaps.latest.revision: 28\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Troubleshooting C/C++ Isolated Applications and Side-by-side Assemblies\nLoading a C/C++ application can fail if dependent libraries cannot be found. This article describes some common reasons why a C/C++ application fails to load, and suggests steps to resolve the problems.  \n  \n If an application fails to load because it has a manifest that specifies a dependency on a side-by-side assembly, and the assembly is not installed as a private assembly in the same folder as the executable nor in the native assembly cache in the %WINDIR%\\WinSxS\\ folder, one of the following error messages might be displayed, depending on the version of Windows on which you try to run the app.  \n  \n-   The application failed to initialize properly (0xc0000135).  \n  \n-   This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem.  \n  \n-   The system cannot execute the specified program.  \n  \n If your application has no manifest and depends on a DLL that Windows can’t find in the typical search locations, an error message that resembles this one might be displayed:  \n  \n-   This application has failed to start because *a required DLL* was not found. Re-installing the application may fix this problem.  \n  \n If your application is deployed on a computer that doesn't have Visual Studio, and it crashes with error messages that resemble the previous ones, check these things:  \n  \n1.  Follow the steps that are described in [Understanding the Dependencies of a Visual C++ Application](../ide/understanding-the-dependencies-of-a-visual-cpp-application.md). The dependency walker can show most dependencies for an application or DLL. If you observe that some DLLs are missing, install them on the computer on which you are trying to run your application.  \n  \n2.  The operating system loader uses the application manifest to load assemblies that the application depends on. The manifest can either be embedded in the binary as a resource, or installed as a separate file in the application folder. To check whether the manifest is embedded in the binary, open the binary in [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] and look for RT_MANIFEST in its list of resources. If you can't find an embedded manifest, look in the application folder for a file that's named something like <binary_name>.\\<extension>.manifest.  \n  \n3.  If your application depends on side-by-side assemblies and a manifest is not present, you have to ensure that the linker generates a manifest for your project. Check the linker option **Generate manifest** in the **Project Properties** dialog box for the project.  \n  \n4.  If the manifest is embedded in the binary, ensure that the ID of RT_MANIFEST is correct for this type of the binary. For more information about which resource ID to use, see [Using Side-by-Side Assemblies as a Resource (Windows)](http://msdn.microsoft.com/library/windows/desktop/aa376617.aspx). If the manifest is in a separate file, open it in an XML editor or text editor. For more information about manifests and rules for deployment, see [Manifests](http://msdn.microsoft.com/library/aa375365).  \n  \n    > [!NOTE]\n    >  If both an embedded manifest and a separate manifest file are present, the operating system loader uses the embedded manifest and ignores the separate file. However, on Windows XP, the opposite is true—the separate manifest file is used and the embedded manifest is ignored.  \n  \n5.  We recommend that you embed a manifest in every DLL because external manifests are ignored when a DLL is loaded though a `LoadLibrary` call. For more information, see [Assembly manifests](http://msdn.microsoft.com/library/aa374219).  \n  \n6.  Check that all assemblies that are enumerated in the manifest are correctly installed on the computer. Each assembly is specified in the manifest by its name, version number, and processor architecture. If your application depends on side-by-side assemblies, check that these assemblies are correctly installed on the computer so that the operating system loader can find them, as described in [Assembly Searching Sequence](http://msdn.microsoft.com/library/aa374224). Remember that 64-bit assemblies cannot be loaded in 32-bit processes and cannot be executed on 32-bit operating systems.  \n  \n## Example  \n Assume we have an application, appl.exe, that's built by using [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]. The application manifest either is embedded in appl.exe as the binary resource RT_MANIFEST, which has an ID equal to 1, or is stored as the separate file appl.exe.manifest. The content of this manifest resembles this:  \n  \n```  \n<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">  \n  <dependency>  \n    <dependentAssembly>  \n      <assemblyIdentity type=\"win32\" name=\"Fabrikam.SxS.Library\" version=\"2.0.20121.0\" processorArchitecture=\"x86\" publicKeyToken=\"1fc8b3b9a1e18e3e\"></assemblyIdentity>  \n    </dependentAssembly>  \n  </dependency>  \n</assembly>  \n```  \n  \n To the operating system loader, this manifest says that appl.exe depends on an assembly named Fabrikam.SxS.Library, version 2.0.20121.0, that's built for a 32-bit x86 processor architecture. The dependent side-by-side assembly can be installed either as a shared assembly or as a private assembly.  \n  \n The assembly manifest for a shared assembly is installed in the %WINDIR%\\WinSxS\\Manifests\\ folder. It identifies the assembly and lists its contents—that is, the DLLs that are part of the assembly:  \n  \n```  \n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>  \n<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">  \n   <noInheritable/>  \n   <assemblyIdentity type=\"win32\" name=\"Fabrikam.SxS.Library\" version=\"2.0.20121.0\" processorArchitecture=\"x86\" publicKeyToken=\"1fc8b3b9a1e18e3e\"/>  \n   <file name=\"Fabrikam.Main.dll\" hash=\"3ca5156e8212449db6c622c3d10f37d9adb1ab12\" hashalg=\"SHA1\"/>  \n   <file name=\"Fabrikam.Helper.dll\" hash=\"92cf8a9bb066aea821d324ca4695c69e55b2d1c2\" hashalg=\"SHA1\"/>  \n</assembly>  \n```  \n  \n Side-by-side assemblies can also use [publisher configuration files](http://msdn.microsoft.com/library/aa375682)—also known as policy files—to globally redirect applications and assemblies to use one version of a side-by-side assembly instead of another version of the same assembly. You can check the policies for a shared assembly in the %WINDIR%\\WinSxS\\Policies\\ folder. Here is an example policy file:  \n  \n```  \n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>  \n<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">  \n  \n   <assemblyIdentity type=\"win32-policy\" name=\"policy.2.0.Fabrikam.SxS.Library\" version=\"2.0.20121.0\" processorArchitecture=\"x86\" publicKeyToken=\"1fc8b3b9a1e18e3e\"/>  \n   <dependency>  \n      <dependentAssembly>  \n         <assemblyIdentity type=\"win32\" name=\"Fabrikam.SxS.Library\" processorArchitecture=\"x86\" publicKeyToken=\"1fc8b3b9a1e18e3e\"/>  \n         <bindingRedirect oldVersion=\"2.0.10000.0-2.0.20120.99\" newVersion=\"2.0.20121.0\"/>  \n      </dependentAssembly>  \n   </dependency>  \n</assembly>  \n```  \n  \n This policy file specifies that any application or assembly that asks for version 2.0.10000.0 of this assembly should instead use version 2.0.20121.0, which is the current version that's installed on the system. If a version of the assembly that's mentioned in the application manifest is specified in the policy file, the loader looks for a version of this assembly that's specified in the manifest in the %WINDIR%\\WinSxS\\ folder, and if this version is not installed, load fails. And if assembly version 2.0.20121.0 is not installed, load fails for applications that ask for assembly version 2.0.10000.0.  \n  \n However, the assembly can also be installed as a private side-by-side assembly in the installed application folder. If the operating system fails to find the assembly as a shared assembly, it looks for it as a private assembly, in the following order:  \n  \n1.  Check the application folder for a manifest file that has the name \\<assemblyName>.manifest. In this example, the loader tries to find Fabrikam.SxS.Library.manifest in the folder that contains appl.exe. If it finds the manifest, the loader loads the assembly from the application folder. If the assembly is not found, load fails.  \n  \n2.  Try to open the \\\\<assemblyName\\>\\ folder in the folder that contains appl.exe, and if \\\\<assemblyName\\>\\ exists, try to load a manifest file that has the name \\<assemblyName>.manifest from this folder. If the manifest is found, the loader loads the assembly from the \\\\<assemblyName\\>\\ folder. If the assembly is not found, load fails.  \n  \n For more information about how the loader searches for dependent assemblies, see [Assembly Searching Sequence](http://msdn.microsoft.com/library/aa374224). If the loader fails to find a dependent assembly as a private assembly, load fails and the message \"The system cannot execute the specified program\" is displayed. To resolve this error, make sure that dependent assemblies—and DLLs that are part of them—are installed on the computer as either private or shared assemblies.  \n  \n## See Also  \n [Concepts of Isolated Applications and Side-by-side Assemblies](../build/concepts-of-isolated-applications-and-side-by-side-assemblies.md)   \n [Building C/C++ Isolated Applications and Side-by-side Assemblies](../build/building-c-cpp-isolated-applications-and-side-by-side-assemblies.md)"}