{"nodes":[{"pos":[12,44],"content":"CComQIPtr Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComQIPtr Class | Microsoft Docs","pos":[0,32]}]},{"content":"CComQIPtr Class","pos":[642,657]},{"content":"A smart pointer class for managing COM interface pointers.","pos":[658,716]},{"content":"Syntax","pos":[725,731]},{"content":"Parameters","pos":[841,851]},{"content":"A COM interface specifying the type of pointer to be stored.","pos":[862,922]},{"content":"A pointer to the IID of <ph id=\"ph1\">`T`</ph>.","pos":[939,967],"source":" A pointer to the IID of `T`."},{"content":"Members","pos":[976,983]},{"content":"Public Constructors","pos":[993,1012]},{"content":"Name","pos":[1019,1023]},{"content":"Description","pos":[1024,1035]},{"content":"CComQIPtr::CComQIPtr","pos":[1074,1094]},{"content":"Constructor.","pos":[1119,1131]},{"content":"Public Operators","pos":[1142,1158]},{"content":"Name","pos":[1165,1169]},{"content":"Description","pos":[1170,1181]},{"content":"CComQIPtr::operator =","pos":[1220,1241]},{"content":"Assigns a pointer to the member pointer.","pos":[1268,1308]},{"content":"Remarks","pos":[1318,1325]},{"content":"ATL uses <ph id=\"ph1\">`CComQIPtr`</ph> and <bpt id=\"p1\">[</bpt>CComPtr<ept id=\"p1\">](../../atl/reference/ccomptr-class.md)</ept> to manage COM interface pointers, both of which derive from <bpt id=\"p2\">[</bpt>CComPtrBase<ept id=\"p2\">](../../atl/reference/ccomptrbase-class.md)</ept>.","pos":[1329,1518],"source":"ATL uses `CComQIPtr` and [CComPtr](../../atl/reference/ccomptr-class.md) to manage COM interface pointers, both of which derive from [CComPtrBase](../../atl/reference/ccomptrbase-class.md)."},{"content":"Both classes perform automatic reference counting through calls to <ph id=\"ph1\">`AddRef`</ph> and <bpt id=\"p1\">**</bpt>Release<ept id=\"p1\">**</ept>.","pos":[1519,1611],"source":" Both classes perform automatic reference counting through calls to `AddRef` and **Release**."},{"content":"Overloaded operators handle pointer operations.","pos":[1612,1659]},{"content":"Inheritance Hierarchy","pos":[1668,1689]},{"content":"CComPtrBase","pos":[1694,1705]},{"content":"CComPtr","pos":[1756,1763]},{"content":"Requirements","pos":[1829,1841]},{"pos":[1845,1868],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcomcli.h","source":"**Header:** atlcomcli.h"},{"pos":[1915,1935],"content":"CComQIPtr::CComQIPtr"},{"content":"The constructor.","pos":[1939,1955]},{"content":"Parameters","pos":[2115,2125]},{"content":"Used to initialize the interface pointer.","pos":[2137,2178]},{"content":"A COM interface.","pos":[2192,2208]},{"content":"A pointer to the IID of <ph id=\"ph1\">`T`</ph>.","pos":[2225,2253],"source":" A pointer to the IID of `T`."},{"pos":[2302,2323],"content":"CComQIPtr::operator ="},{"content":"The assignment operator.","pos":[2327,2351]},{"content":"Parameters","pos":[2501,2511]},{"content":"Used to initialize the interface pointer.","pos":[2523,2564]},{"content":"A COM interface.","pos":[2578,2594]},{"content":"A pointer to the IID of <ph id=\"ph1\">`T`</ph>.","pos":[2611,2639],"source":" A pointer to the IID of `T`."},{"content":"Return Value","pos":[2649,2661]},{"pos":[2665,2717],"content":"Returns a pointer to the updated <ph id=\"ph1\">`CComQIPtr`</ph> object.","source":"Returns a pointer to the updated `CComQIPtr` object."},{"content":"See Also","pos":[2726,2734]},{"content":"CComPtr::CComPtr","pos":[2739,2755]},{"content":"CComQIPtr::CComQIPtr","pos":[2817,2837]},{"content":"CComPtrBase Class","pos":[2867,2884]},{"content":"Class Overview","pos":[2933,2947]},{"content":"CComQIPtrElementTraits Class","pos":[2987,3015]}],"content":"---\ntitle: \"CComQIPtr Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL.CComQIPtr\"\n  - \"ATL::CComQIPtr\"\n  - \"CComQIPtr\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CComQIPtr class\"\nms.assetid: 969cacb5-05b6-4af4-b683-24911d70242d\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComQIPtr Class\nA smart pointer class for managing COM interface pointers.  \n  \n## Syntax  \n  \n```\ntemplate<class T,  const IID* piid= &__uuidof(T)>  class CComQIPtr: public CComPtr<T>\n```  \n  \n#### Parameters  \n `T`  \n A COM interface specifying the type of pointer to be stored.  \n  \n `piid`  \n A pointer to the IID of `T`.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComQIPtr::CComQIPtr](#ccomqiptr__ccomqiptr)|Constructor.|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComQIPtr::operator =](#ccomqiptr__operator_eq)|Assigns a pointer to the member pointer.|  \n  \n## Remarks  \n ATL uses `CComQIPtr` and [CComPtr](../../atl/reference/ccomptr-class.md) to manage COM interface pointers, both of which derive from [CComPtrBase](../../atl/reference/ccomptrbase-class.md). Both classes perform automatic reference counting through calls to `AddRef` and **Release**. Overloaded operators handle pointer operations.  \n  \n## Inheritance Hierarchy  \n [CComPtrBase](../../atl/reference/ccomptrbase-class.md)  \n  \n [CComPtr](../../atl/reference/ccomptr-class.md)  \n  \n `CComQIPtr`  \n  \n## Requirements  \n **Header:** atlcomcli.h  \n  \n##  <a name=\"ccomqiptr__ccomqiptr\"></a>  CComQIPtr::CComQIPtr  \n The constructor.  \n  \n```\nCComQIPtr() throw();\nCComQIPtr(T* lp) throw();\nCComQIPtr(\n IUnknown* lp) throw();\nCComQIPtr(\n const CComQIPtr<T,\n    piid>& lp) throw();\n```  \n  \n### Parameters  \n `lp`  \n Used to initialize the interface pointer.  \n  \n `T`  \n A COM interface.  \n  \n `piid`  \n A pointer to the IID of `T`.  \n  \n##  <a name=\"ccomqiptr__operator_eq\"></a>  CComQIPtr::operator =  \n The assignment operator.  \n  \n```\nT* operator= (T* lp) throw();\n\nT* operator= (const CComQIPtr<T, piid>& lp) throw();\n\nT* operator= (\n    IUnknown* lp) throw();\n```  \n  \n### Parameters  \n `lp`  \n Used to initialize the interface pointer.  \n  \n `T`  \n A COM interface.  \n  \n `piid`  \n A pointer to the IID of `T`.  \n  \n### Return Value  \n Returns a pointer to the updated `CComQIPtr` object.  \n  \n## See Also  \n [CComPtr::CComPtr](../../atl/reference/ccomptr-class.md#ccomptr__ccomptr)   \n [CComQIPtr::CComQIPtr](#ccomqiptr__ccomqiptr)   \n [CComPtrBase Class](../../atl/reference/ccomptrbase-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)   \n [CComQIPtrElementTraits Class](../../atl/reference/ccomqiptrelementtraits-class.md)\n"}