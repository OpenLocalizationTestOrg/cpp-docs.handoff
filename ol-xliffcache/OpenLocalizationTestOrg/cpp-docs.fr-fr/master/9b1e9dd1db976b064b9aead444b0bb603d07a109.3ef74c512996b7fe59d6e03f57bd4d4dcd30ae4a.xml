{"nodes":[{"pos":[12,50],"content":"CComObjectStack Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComObjectStack Class | Microsoft Docs","pos":[0,38]}]},{"pos":[737,758],"content":"CComObjectStack Class","linkify":"CComObjectStack Class","nodes":[{"content":"CComObjectStack Class","pos":[0,21]}]},{"pos":[759,864],"content":"This class creates a temporary COM object and provides it with a skeletal implementation of <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>.","source":"This class creates a temporary COM object and provides it with a skeletal implementation of **IUnknown**."},{"pos":[873,879],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[965,975],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Your class, derived from <bpt id=\"p1\">[</bpt>CComObjectRoot<ept id=\"p1\">](../../atl/reference/ccomobjectroot-class.md)</ept> or <bpt id=\"p2\">[</bpt>CComObjectRootEx<ept id=\"p2\">](../../atl/reference/ccomobjectrootex-class.md)</ept>, as well as from any other interface you want to support on the object.","pos":[989,1216],"source":" Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md), as well as from any other interface you want to support on the object."},{"pos":[1225,1232],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1242,1261],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1268,1272]},{"content":"Description","pos":[1273,1284]},{"pos":[1322,1391],"content":"<bpt id=\"p1\">[</bpt>CComObjectStack::CComObjectStack<ept id=\"p1\">](#ccomobjectstack__ccomobjectstack)</ept>","source":"[CComObjectStack::CComObjectStack](#ccomobjectstack__ccomobjectstack)"},{"content":"The constructor.","pos":[1392,1408]},{"pos":[1413,1488],"content":"<bpt id=\"p1\">[</bpt>CComObjectStack::~CComObjectStack<ept id=\"p1\">](#ccomobjectstack___dtorccomobjectstack)</ept>","source":"[CComObjectStack::~CComObjectStack](#ccomobjectstack___dtorccomobjectstack)"},{"content":"The destructor.","pos":[1489,1504]},{"pos":[1515,1529],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1536,1540]},{"content":"Description","pos":[1541,1552]},{"pos":[1590,1641],"content":"<bpt id=\"p1\">[</bpt>CComObjectStack::AddRef<ept id=\"p1\">](#ccomobjectstack__addref)</ept>","source":"[CComObjectStack::AddRef](#ccomobjectstack__addref)"},{"content":"Returns zero.","pos":[1642,1655]},{"content":"In debug mode, calls <ph id=\"ph1\">`_ASSERTE`</ph>.","pos":[1656,1688],"source":" In debug mode, calls `_ASSERTE`."},{"pos":[1693,1760],"content":"<bpt id=\"p1\">[</bpt>CComObjectStack::QueryInterface<ept id=\"p1\">](#ccomobjectstack__queryinterface)</ept>","source":"[CComObjectStack::QueryInterface](#ccomobjectstack__queryinterface)"},{"content":"Returns <bpt id=\"p1\">**</bpt>E_NOINTERFACE<ept id=\"p1\">**</ept>.","pos":[1761,1787],"source":"Returns **E_NOINTERFACE**."},{"content":"In debug mode, calls <ph id=\"ph1\">`_ASSERTE`</ph>.","pos":[1788,1820],"source":" In debug mode, calls `_ASSERTE`."},{"pos":[1825,1878],"content":"<bpt id=\"p1\">[</bpt>CComObjectStack::Release<ept id=\"p1\">](#ccomobjectstack__release)</ept>","source":"[CComObjectStack::Release](#ccomobjectstack__release)"},{"content":"Returns zero.","pos":[1879,1892]},{"content":"In debug mode, calls <ph id=\"ph1\">`_ASSERTE`</ph>.","pos":[1893,1925],"source":" In debug mode, calls `_ASSERTE`."},{"content":"~","pos":[1926,1927]},{"pos":[1938,1957],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[1964,1968]},{"content":"Description","pos":[1969,1980]},{"pos":[2018,2097],"content":"<bpt id=\"p1\">[</bpt>CComObjectStack::m_hResFinalConstruct<ept id=\"p1\">](#ccomobjectstack__m_hresfinalconstruct)</ept>","source":"[CComObjectStack::m_hResFinalConstruct](#ccomobjectstack__m_hresfinalconstruct)"},{"pos":[2098,2184],"content":"Contains the <bpt id=\"p1\">**</bpt>HRESULT<ept id=\"p1\">**</ept> returned during construction of the <ph id=\"ph1\">`CComObjectStack`</ph> object.","source":"Contains the **HRESULT** returned during construction of the `CComObjectStack` object."},{"pos":[2194,2201],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`CComObjectStack`</ph> is used to create a temporary COM object and provide the object a skeletal implementation of <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>.","pos":[2205,2329],"source":"`CComObjectStack` is used to create a temporary COM object and provide the object a skeletal implementation of **IUnknown**."},{"content":"Typically, the object is used as a local variable within one function (that is, pushed onto the stack).","pos":[2330,2433]},{"content":"Since the object is destroyed when the function finishes, reference counting is not performed to increase efficiency.","pos":[2434,2551]},{"content":"The following example shows how to create a COM object used inside a function:","pos":[2558,2636]},{"pos":[2643,2725],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_ATL_COM#42<ept id=\"p2\">](../../atl/codesnippet/cpp/ccomobjectstack-class_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_ATL_COM#42](../../atl/codesnippet/cpp/ccomobjectstack-class_1.cpp)]"},{"pos":[2732,2844],"content":"The temporary object <ph id=\"ph1\">`Tempobj`</ph> is pushed onto the stack and automatically disappears when the function finishes.","source":"The temporary object `Tempobj` is pushed onto the stack and automatically disappears when the function finishes."},{"pos":[2853,2874],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2917,2929],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2933,2953],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[2963,3026],"content":"<bpt id=\"p1\">&lt;a name=\"ccomobjectstack__addref\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComObjectStack::AddRef","linkify":"<a name=\"ccomobjectstack__addref\"></a>  CComObjectStack::AddRef","source":"<a name=\"ccomobjectstack__addref\"></a>  CComObjectStack::AddRef"},{"content":"Returns zero.","pos":[3030,3043]},{"pos":[3095,3107],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns zero.","pos":[3111,3124]},{"pos":[3134,3141],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3145,3177],"content":"In debug mode, calls <ph id=\"ph1\">`_ASSERTE`</ph>.","source":"In debug mode, calls `_ASSERTE`."},{"pos":[3187,3268],"content":"<bpt id=\"p1\">&lt;a name=\"ccomobjectstack__ccomobjectstack\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComObjectStack::CComObjectStack","linkify":"<a name=\"ccomobjectstack__ccomobjectstack\"></a>  CComObjectStack::CComObjectStack","source":"<a name=\"ccomobjectstack__ccomobjectstack\"></a>  CComObjectStack::CComObjectStack"},{"content":"The constructor.","pos":[3272,3288]},{"pos":[3342,3349],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Calls <ph id=\"ph1\">`FinalConstruct`</ph> and then sets <bpt id=\"p1\">[</bpt>m_hResFinalConstruct<ept id=\"p1\">](#ccomobjectstack__m_hresfinalconstruct)</ept> to the <ph id=\"ph2\">`HRESULT`</ph> returned by <ph id=\"ph3\">`FinalConstruct`</ph>.","pos":[3353,3499],"source":"Calls `FinalConstruct` and then sets [m_hResFinalConstruct](#ccomobjectstack__m_hresfinalconstruct) to the `HRESULT` returned by `FinalConstruct`."},{"content":"If you have not derived your base class from <bpt id=\"p1\">[</bpt>CComObjectRoot<ept id=\"p1\">](../../atl/reference/ccomobjectroot-class.md)</ept>, you must supply your own <ph id=\"ph1\">`FinalConstruct`</ph> method.","pos":[3500,3657],"source":" If you have not derived your base class from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md), you must supply your own `FinalConstruct` method."},{"content":"The destructor calls <ph id=\"ph1\">`FinalRelease`</ph>.","pos":[3658,3694],"source":" The destructor calls `FinalRelease`."},{"pos":[3704,3791],"content":"<bpt id=\"p1\">&lt;a name=\"ccomobjectstack___dtorccomobjectstack\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComObjectStack::~CComObjectStack","linkify":"<a name=\"ccomobjectstack___dtorccomobjectstack\"></a>  CComObjectStack::~CComObjectStack","source":"<a name=\"ccomobjectstack___dtorccomobjectstack\"></a>  CComObjectStack::~CComObjectStack"},{"content":"The destructor.","pos":[3795,3810]},{"pos":[3852,3859],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3863,3976],"content":"Frees all allocated resources and calls <bpt id=\"p1\">[</bpt>FinalRelease<ept id=\"p1\">](ccomobjectrootex-class.md#ccomobjectrootex__finalrelease)</ept>.","source":"Frees all allocated resources and calls [FinalRelease](ccomobjectrootex-class.md#ccomobjectrootex__finalrelease)."},{"pos":[3986,4077],"content":"<bpt id=\"p1\">&lt;a name=\"ccomobjectstack__m_hresfinalconstruct\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComObjectStack::m_hResFinalConstruct","linkify":"<a name=\"ccomobjectstack__m_hresfinalconstruct\"></a>  CComObjectStack::m_hResFinalConstruct","source":"<a name=\"ccomobjectstack__m_hresfinalconstruct\"></a>  CComObjectStack::m_hResFinalConstruct"},{"pos":[4081,4195],"content":"Contains the <ph id=\"ph1\">`HRESULT`</ph> returned from calling <ph id=\"ph2\">`FinalConstruct`</ph> during construction of the <ph id=\"ph3\">`CComObjectStack`</ph> object.","source":"Contains the `HRESULT` returned from calling `FinalConstruct` during construction of the `CComObjectStack` object."},{"pos":[4252,4331],"content":"<bpt id=\"p1\">&lt;a name=\"ccomobjectstack__queryinterface\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComObjectStack::QueryInterface","linkify":"<a name=\"ccomobjectstack__queryinterface\"></a>  CComObjectStack::QueryInterface","source":"<a name=\"ccomobjectstack__queryinterface\"></a>  CComObjectStack::QueryInterface"},{"pos":[4335,4361],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOINTERFACE<ept id=\"p1\">**</ept>.","source":"Returns **E_NOINTERFACE**."},{"pos":[4436,4448],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[4452,4478],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOINTERFACE<ept id=\"p1\">**</ept>.","source":"Returns **E_NOINTERFACE**."},{"pos":[4488,4495],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4499,4531],"content":"In debug mode, calls <ph id=\"ph1\">`_ASSERTE`</ph>.","source":"In debug mode, calls `_ASSERTE`."},{"pos":[4541,4606],"content":"<bpt id=\"p1\">&lt;a name=\"ccomobjectstack__release\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComObjectStack::Release","linkify":"<a name=\"ccomobjectstack__release\"></a>  CComObjectStack::Release","source":"<a name=\"ccomobjectstack__release\"></a>  CComObjectStack::Release"},{"content":"Returns zero.","pos":[4610,4623]},{"pos":[4676,4688],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns zero.","pos":[4692,4705]},{"pos":[4715,4722],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4726,4758],"content":"In debug mode, calls <ph id=\"ph1\">`_ASSERTE`</ph>.","source":"In debug mode, calls `_ASSERTE`."},{"pos":[4767,4775],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CComAggObject Class<ept id=\"p1\">](../../atl/reference/ccomaggobject-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[4779,4845],"source":"[CComAggObject Class](../../atl/reference/ccomaggobject-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CComObject Class<ept id=\"p1\">](../../atl/reference/ccomobject-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[4848,4909],"source":" [CComObject Class](../../atl/reference/ccomobject-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CComObjectGlobal Class<ept id=\"p1\">](../../atl/reference/ccomobjectglobal-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[4912,4985],"source":" [CComObjectGlobal Class](../../atl/reference/ccomobjectglobal-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","pos":[4988,5038],"source":" [Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"CComObjectStack Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::CComObjectStack\"\n  - \"ATL.CComObjectStack\"\n  - \"ATL::CComObjectStack<Base>\"\n  - \"ATL.CComObjectStack<Base>\"\n  - \"CComObjectStack\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CComObjectStack class\"\nms.assetid: 3da72c40-c834-45f6-bb76-6ac204028d80\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComObjectStack Class\nThis class creates a temporary COM object and provides it with a skeletal implementation of **IUnknown**.  \n  \n## Syntax  \n  \n```\ntemplate <class  Base>  class CComObjectStack\n :  public Base\n```  \n  \n#### Parameters  \n `Base`  \n Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md), as well as from any other interface you want to support on the object.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComObjectStack::CComObjectStack](#ccomobjectstack__ccomobjectstack)|The constructor.|  \n|[CComObjectStack::~CComObjectStack](#ccomobjectstack___dtorccomobjectstack)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComObjectStack::AddRef](#ccomobjectstack__addref)|Returns zero. In debug mode, calls `_ASSERTE`.|  \n|[CComObjectStack::QueryInterface](#ccomobjectstack__queryinterface)|Returns **E_NOINTERFACE**. In debug mode, calls `_ASSERTE`.|  \n|[CComObjectStack::Release](#ccomobjectstack__release)|Returns zero. In debug mode, calls `_ASSERTE`. ~|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComObjectStack::m_hResFinalConstruct](#ccomobjectstack__m_hresfinalconstruct)|Contains the **HRESULT** returned during construction of the `CComObjectStack` object.|  \n  \n## Remarks  \n `CComObjectStack` is used to create a temporary COM object and provide the object a skeletal implementation of **IUnknown**. Typically, the object is used as a local variable within one function (that is, pushed onto the stack). Since the object is destroyed when the function finishes, reference counting is not performed to increase efficiency.  \n  \n The following example shows how to create a COM object used inside a function:  \n  \n [!code-cpp[NVC_ATL_COM#42](../../atl/codesnippet/cpp/ccomobjectstack-class_1.cpp)]  \n  \n The temporary object `Tempobj` is pushed onto the stack and automatically disappears when the function finishes.  \n  \n## Inheritance Hierarchy  \n `Base`  \n  \n `CComObjectStack`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ccomobjectstack__addref\"></a>  CComObjectStack::AddRef  \n Returns zero.  \n  \n```\nSTDMETHOD_(ULONG, AddRef)();\n```  \n  \n### Return Value  \n Returns zero.  \n  \n### Remarks  \n In debug mode, calls `_ASSERTE`.  \n  \n##  <a name=\"ccomobjectstack__ccomobjectstack\"></a>  CComObjectStack::CComObjectStack  \n The constructor.  \n  \n```\nCComObjectStack(void* = NULL);\n```  \n  \n### Remarks  \n Calls `FinalConstruct` and then sets [m_hResFinalConstruct](#ccomobjectstack__m_hresfinalconstruct) to the `HRESULT` returned by `FinalConstruct`. If you have not derived your base class from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md), you must supply your own `FinalConstruct` method. The destructor calls `FinalRelease`.  \n  \n##  <a name=\"ccomobjectstack___dtorccomobjectstack\"></a>  CComObjectStack::~CComObjectStack  \n The destructor.  \n  \n```\nCComObjectStack();\n```  \n  \n### Remarks  \n Frees all allocated resources and calls [FinalRelease](ccomobjectrootex-class.md#ccomobjectrootex__finalrelease).  \n  \n##  <a name=\"ccomobjectstack__m_hresfinalconstruct\"></a>  CComObjectStack::m_hResFinalConstruct  \n Contains the `HRESULT` returned from calling `FinalConstruct` during construction of the `CComObjectStack` object.  \n  \n```\nHRESULT     m_hResFinalConstruct;\n```  \n  \n##  <a name=\"ccomobjectstack__queryinterface\"></a>  CComObjectStack::QueryInterface  \n Returns **E_NOINTERFACE**.  \n  \n```\nHRESULT     QueryInterface(\n    REFIID,\n void**)\n ;\n```  \n  \n### Return Value  \n Returns **E_NOINTERFACE**.  \n  \n### Remarks  \n In debug mode, calls `_ASSERTE`.  \n  \n##  <a name=\"ccomobjectstack__release\"></a>  CComObjectStack::Release  \n Returns zero.  \n  \n```\nSTDMETHOD_(ULONG, Release)();\n```  \n  \n### Return Value  \n Returns zero.  \n  \n### Remarks  \n In debug mode, calls `_ASSERTE`.  \n  \n## See Also  \n [CComAggObject Class](../../atl/reference/ccomaggobject-class.md)   \n [CComObject Class](../../atl/reference/ccomobject-class.md)   \n [CComObjectGlobal Class](../../atl/reference/ccomobjectglobal-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}