{"nodes":[{"pos":[12,47],"content":"CComUnkArray Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComUnkArray Class | Microsoft Docs","pos":[0,35]}]},{"content":"CComUnkArray Class","pos":[764,782]},{"pos":[783,962],"content":"This class stores <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointers, and is designed to be used as a parameter to the <bpt id=\"p2\">[</bpt>IConnectionPointImpl<ept id=\"p2\">](../../atl/reference/iconnectionpointimpl-class.md)</ept> template class.","source":"This class stores **IUnknown** pointers, and is designed to be used as a parameter to the [IConnectionPointImpl](../../atl/reference/iconnectionpointimpl-class.md) template class."},{"content":"Syntax","pos":[971,977]},{"content":"Parameters","pos":[1052,1062]},{"content":"nMaxSize","pos":[1067,1075]},{"content":"The maximum number of <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointers that can be held in the static array.","pos":[1080,1161],"source":" The maximum number of **IUnknown** pointers that can be held in the static array."},{"content":"Members","pos":[1170,1177]},{"content":"Public Constructors","pos":[1187,1206]},{"content":"Name","pos":[1213,1217]},{"content":"Description","pos":[1218,1229]},{"content":"CComUnkArray::CComUnkArray","pos":[1268,1294]},{"content":"Constructor.","pos":[1325,1337]},{"content":"Public Methods","pos":[1348,1362]},{"content":"Name","pos":[1369,1373]},{"content":"Description","pos":[1374,1385]},{"content":"CComUnkArray::Add","pos":[1424,1441]},{"pos":[1463,1524],"content":"Call this method to add an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer to the array.","source":"Call this method to add an **IUnknown** pointer to the array."},{"content":"CComUnkArray::begin","pos":[1530,1549]},{"pos":[1573,1643],"content":"Returns a pointer to the first <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer in the collection.","source":"Returns a pointer to the first **IUnknown** pointer in the collection."},{"content":"CComUnkArray::end","pos":[1649,1666]},{"pos":[1688,1766],"content":"Returns a pointer to one past the last <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer in the collection.","source":"Returns a pointer to one past the last **IUnknown** pointer in the collection."},{"content":"CComUnkArray::GetCookie","pos":[1772,1795]},{"pos":[1823,1903],"content":"Call this method to get the cookie associated with a given <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Call this method to get the cookie associated with a given **IUnknown** pointer."},{"content":"CComUnkArray::GetUnknown","pos":[1909,1933]},{"pos":[1962,2042],"content":"Call this method to get the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer associated with a given cookie.","source":"Call this method to get the **IUnknown** pointer associated with a given cookie."},{"content":"CComUnkArray::Remove","pos":[2048,2068]},{"pos":[2093,2159],"content":"Call this method to remove an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer from the array.","source":"Call this method to remove an **IUnknown** pointer from the array."},{"content":"Remarks","pos":[2169,2176]},{"content":"<bpt id=\"p1\">**</bpt>CComUnkArray<ept id=\"p1\">**</ept> holds a fixed number of <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> pointers, each an interface on a connection point.","pos":[2180,2284],"source":"**CComUnkArray** holds a fixed number of **IUnknown** pointers, each an interface on a connection point."},{"content":"<bpt id=\"p1\">**</bpt>CComUnkArray<ept id=\"p1\">**</ept> can be used as a parameter to the <bpt id=\"p2\">[</bpt>IConnectionPointImpl<ept id=\"p2\">](../../atl/reference/iconnectionpointimpl-class.md)</ept> template class.","pos":[2285,2425],"source":"**CComUnkArray** can be used as a parameter to the [IConnectionPointImpl](../../atl/reference/iconnectionpointimpl-class.md) template class."},{"content":"<bpt id=\"p1\">**</bpt>CComUnkArray<ph id=\"ph1\">\\&lt;</ph>1&gt;<ept id=\"p1\">**</ept> is a template specialization of <bpt id=\"p2\">**</bpt>CComUnkArray<ept id=\"p2\">**</ept> that has been optimized for one connection point.","pos":[2426,2545],"source":"**CComUnkArray\\<1>** is a template specialization of **CComUnkArray** that has been optimized for one connection point."},{"pos":[2552,2729],"content":"The <bpt id=\"p1\">**</bpt>CComUnkArray<ept id=\"p1\">**</ept> methods <bpt id=\"p2\">[</bpt>begin<ept id=\"p2\">](#ccomunkarray__begin)</ept> and <bpt id=\"p3\">[</bpt>end<ept id=\"p3\">](#ccomunkarray__end)</ept> can be used to loop through all connection points (for example, when an event is fired).","source":"The **CComUnkArray** methods [begin](#ccomunkarray__begin) and [end](#ccomunkarray__end) can be used to loop through all connection points (for example, when an event is fired)."},{"pos":[2736,2895],"content":"See <bpt id=\"p1\">[</bpt>Adding Connection Points to an Object<ept id=\"p1\">](../../atl/adding-connection-points-to-an-object.md)</ept> for details on automating creation of connection point proxies.","source":"See [Adding Connection Points to an Object](../../atl/adding-connection-points-to-an-object.md) for details on automating creation of connection point proxies."},{"pos":[2903,3290],"content":"[!NOTE]\n**Note** The class [CComDynamicUnkArray](../../atl/reference/ccomdynamicunkarray-class.md) is used by the **Add Class** wizard when creating a control which has Connection Points. If you wish to specify the number of Connection Points manually, change the reference from **CComDynamicUnkArray** to `CComUnkArray<` *n* `>`, where *n* is the number of connection points required.","leadings":["","> "],"nodes":[{"content":"**Note** The class [CComDynamicUnkArray](../../atl/reference/ccomdynamicunkarray-class.md) is used by the **Add Class** wizard when creating a control which has Connection Points. If you wish to specify the number of Connection Points manually, change the reference from **CComDynamicUnkArray** to `CComUnkArray<` *n* `>`, where *n* is the number of connection points required.","pos":[8,385],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> The class <bpt id=\"p2\">[</bpt>CComDynamicUnkArray<ept id=\"p2\">](../../atl/reference/ccomdynamicunkarray-class.md)</ept> is used by the <bpt id=\"p3\">**</bpt>Add Class<ept id=\"p3\">**</ept> wizard when creating a control which has Connection Points.","pos":[0,179],"source":"**Note** The class [CComDynamicUnkArray](../../atl/reference/ccomdynamicunkarray-class.md) is used by the **Add Class** wizard when creating a control which has Connection Points."},{"content":"If you wish to specify the number of Connection Points manually, change the reference from <bpt id=\"p1\">**</bpt>CComDynamicUnkArray<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`CComUnkArray&lt;`</ph> <bpt id=\"p2\">*</bpt>n<ept id=\"p2\">*</ept> <ph id=\"ph2\">`&gt;`</ph>, where <bpt id=\"p3\">*</bpt>n<ept id=\"p3\">*</ept> is the number of connection points required.","pos":[180,377],"source":" If you wish to specify the number of Connection Points manually, change the reference from **CComDynamicUnkArray** to `CComUnkArray<` *n* `>`, where *n* is the number of connection points required."}]}]},{"content":"Requirements","pos":[3299,3311]},{"pos":[3315,3335],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[3379,3396],"content":"CComUnkArray::Add"},{"pos":[3400,3461],"content":"Call this method to add an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer to the array.","source":"Call this method to add an **IUnknown** pointer to the array."},{"content":"Parameters","pos":[3511,3521]},{"content":"pUnk","pos":[3526,3530]},{"content":"Call this method to add an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer to the array.","pos":[3535,3596],"source":" Call this method to add an **IUnknown** pointer to the array."},{"content":"Return Value","pos":[3606,3618]},{"content":"Returns the cookie associated with the newly added pointer, or 0 if the array is not large enough to contain the new pointer.","pos":[3622,3747]},{"pos":[3793,3812],"content":"CComUnkArray::begin"},{"pos":[3816,3904],"content":"Returns a pointer to the beginning of the collection of <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface pointers.","source":"Returns a pointer to the beginning of the collection of **IUnknown** interface pointers."},{"content":"Return Value","pos":[3954,3966]},{"pos":[3970,4017],"content":"A pointer to an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface pointer.","source":"A pointer to an **IUnknown** interface pointer."},{"content":"Remarks","pos":[4027,4034]},{"content":"The collection contains pointers to interfaces stored locally as <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>.","pos":[4038,4116],"source":"The collection contains pointers to interfaces stored locally as **IUnknown**."},{"content":"You cast each <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface to the real interface type and then call through it.","pos":[4117,4206],"source":" You cast each **IUnknown** interface to the real interface type and then call through it."},{"content":"You do not need to query for the interface first.","pos":[4207,4256]},{"pos":[4263,4345],"content":"Before using the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface, you should check that it is not <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","source":"Before using the **IUnknown** interface, you should check that it is not **NULL**."},{"pos":[4398,4424],"content":"CComUnkArray::CComUnkArray"},{"content":"The constructor.","pos":[4428,4444]},{"content":"Remarks","pos":[4483,4490]},{"pos":[4494,4597],"content":"Sets the collection to hold <ph id=\"ph1\">`nMaxSize`</ph> <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointers, and initializes the pointers to <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","source":"Sets the collection to hold `nMaxSize` **IUnknown** pointers, and initializes the pointers to **NULL**."},{"pos":[4641,4658],"content":"CComUnkArray::end"},{"pos":[4662,4740],"content":"Returns a pointer to one past the last <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer in the collection.","source":"Returns a pointer to one past the last **IUnknown** pointer in the collection."},{"content":"Return Value","pos":[4788,4800]},{"pos":[4804,4851],"content":"A pointer to an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface pointer.","source":"A pointer to an **IUnknown** interface pointer."},{"content":"Remarks","pos":[4861,4868]},{"pos":[4872,5008],"content":"The <ph id=\"ph1\">`CComUnkArray`</ph> methods <bpt id=\"p1\">**</bpt>begin<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>end<ept id=\"p2\">**</ept> can be used to loop through all connection points, for example, when an event is fired.","source":"The `CComUnkArray` methods **begin** and **end** can be used to loop through all connection points, for example, when an event is fired."},{"pos":[5026,5040],"content":"NVC_ATL_COM#44"},{"pos":[5144,5167],"content":"CComUnkArray::GetCookie"},{"pos":[5171,5251],"content":"Call this method to get the cookie associated with a given <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Call this method to get the cookie associated with a given **IUnknown** pointer."},{"content":"Parameters","pos":[5317,5327]},{"content":"The <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer for which the associated cookie is required.","pos":[5343,5412],"source":" The **IUnknown** pointer for which the associated cookie is required."},{"content":"Return Value","pos":[5422,5434]},{"pos":[5438,5549],"content":"Returns the cookie associated with the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer, or 0 if no matching <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> pointer is found.","source":"Returns the cookie associated with the **IUnknown** pointer, or 0 if no matching **IUnknown** pointer is found."},{"content":"Remarks","pos":[5559,5566]},{"pos":[5570,5690],"content":"If there is more than one instance of the same <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer, this function returns the cookie for the first one.","source":"If there is more than one instance of the same **IUnknown** pointer, this function returns the cookie for the first one."},{"pos":[5741,5765],"content":"CComUnkArray::GetUnknown"},{"pos":[5769,5849],"content":"Call this method to get the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer associated with a given cookie.","source":"Call this method to get the **IUnknown** pointer associated with a given cookie."},{"content":"Parameters","pos":[5917,5927]},{"content":"The cookie for which the associated <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer is required.","pos":[5945,6014],"source":" The cookie for which the associated **IUnknown** pointer is required."},{"content":"Return Value","pos":[6024,6036]},{"pos":[6040,6113],"content":"Returns the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer, or NULL if no matching cookie is found.","source":"Returns the **IUnknown** pointer, or NULL if no matching cookie is found."},{"pos":[6160,6180],"content":"CComUnkArray::Remove"},{"pos":[6184,6250],"content":"Call this method to remove an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer from the array.","source":"Call this method to remove an **IUnknown** pointer from the array."},{"content":"Parameters","pos":[6302,6312]},{"content":"The cookie referencing the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer to be removed from the array.","pos":[6330,6407],"source":" The cookie referencing the **IUnknown** pointer to be removed from the array."},{"content":"Return Value","pos":[6417,6429]},{"pos":[6433,6497],"content":"Returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if the pointer is removed, <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> otherwise.","source":"Returns **TRUE** if the pointer is removed, **FALSE** otherwise."},{"content":"See Also","pos":[6506,6514]},{"content":"CComDynamicUnkArray Class","pos":[6519,6544]},{"content":"Class Overview","pos":[6601,6615]}],"content":"---\ntitle: \"CComUnkArray Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL.CComUnkArray\"\n  - \"ATL.CComUnkArray<nMaxSize>\"\n  - \"ATL::CComUnkArray<nMaxSize>\"\n  - \"ATL::CComUnkArray\"\n  - \"CComUnkArray\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"connection points [C++], managing\"\n  - \"CComUnkArray class\"\nms.assetid: 5fd4b378-a7b5-4cc1-8866-8ab72a73639e\ncaps.latest.revision: 17\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComUnkArray Class\nThis class stores **IUnknown** pointers, and is designed to be used as a parameter to the [IConnectionPointImpl](../../atl/reference/iconnectionpointimpl-class.md) template class.  \n  \n## Syntax  \n  \n```\ntemplate<unsigned int nMaxSize>\nclass CComUnkArray\n```  \n  \n#### Parameters  \n *nMaxSize*  \n The maximum number of **IUnknown** pointers that can be held in the static array.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComUnkArray::CComUnkArray](#ccomunkarray__ccomunkarray)|Constructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComUnkArray::Add](#ccomunkarray__add)|Call this method to add an **IUnknown** pointer to the array.|  \n|[CComUnkArray::begin](#ccomunkarray__begin)|Returns a pointer to the first **IUnknown** pointer in the collection.|  \n|[CComUnkArray::end](#ccomunkarray__end)|Returns a pointer to one past the last **IUnknown** pointer in the collection.|  \n|[CComUnkArray::GetCookie](#ccomunkarray__getcookie)|Call this method to get the cookie associated with a given **IUnknown** pointer.|  \n|[CComUnkArray::GetUnknown](#ccomunkarray__getunknown)|Call this method to get the **IUnknown** pointer associated with a given cookie.|  \n|[CComUnkArray::Remove](#ccomunkarray__remove)|Call this method to remove an **IUnknown** pointer from the array.|  \n  \n## Remarks  \n **CComUnkArray** holds a fixed number of **IUnknown** pointers, each an interface on a connection point. **CComUnkArray** can be used as a parameter to the [IConnectionPointImpl](../../atl/reference/iconnectionpointimpl-class.md) template class. **CComUnkArray\\<1>** is a template specialization of **CComUnkArray** that has been optimized for one connection point.  \n  \n The **CComUnkArray** methods [begin](#ccomunkarray__begin) and [end](#ccomunkarray__end) can be used to loop through all connection points (for example, when an event is fired).  \n  \n See [Adding Connection Points to an Object](../../atl/adding-connection-points-to-an-object.md) for details on automating creation of connection point proxies.  \n  \n> [!NOTE]\n> **Note** The class [CComDynamicUnkArray](../../atl/reference/ccomdynamicunkarray-class.md) is used by the **Add Class** wizard when creating a control which has Connection Points. If you wish to specify the number of Connection Points manually, change the reference from **CComDynamicUnkArray** to `CComUnkArray<` *n* `>`, where *n* is the number of connection points required.  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ccomunkarray__add\"></a>  CComUnkArray::Add  \n Call this method to add an **IUnknown** pointer to the array.  \n  \n```\nDWORD Add(IUnknown* pUnk);\n```  \n  \n### Parameters  \n *pUnk*  \n Call this method to add an **IUnknown** pointer to the array.  \n  \n### Return Value  \n Returns the cookie associated with the newly added pointer, or 0 if the array is not large enough to contain the new pointer.  \n  \n##  <a name=\"ccomunkarray__begin\"></a>  CComUnkArray::begin  \n Returns a pointer to the beginning of the collection of **IUnknown** interface pointers.  \n  \n```\nIUnknown**\n    begin();\n```     \n  \n### Return Value  \n A pointer to an **IUnknown** interface pointer.  \n  \n### Remarks  \n The collection contains pointers to interfaces stored locally as **IUnknown**. You cast each **IUnknown** interface to the real interface type and then call through it. You do not need to query for the interface first.  \n  \n Before using the **IUnknown** interface, you should check that it is not **NULL**.  \n  \n##  <a name=\"ccomunkarray__ccomunkarray\"></a>  CComUnkArray::CComUnkArray  \n The constructor.  \n  \n```\nCComUnkArray();\n```  \n  \n### Remarks  \n Sets the collection to hold `nMaxSize` **IUnknown** pointers, and initializes the pointers to **NULL**.  \n  \n##  <a name=\"ccomunkarray__end\"></a>  CComUnkArray::end  \n Returns a pointer to one past the last **IUnknown** pointer in the collection.  \n  \n```\nIUnknown**\n    end();\n```     \n  \n### Return Value  \n A pointer to an **IUnknown** interface pointer.  \n  \n### Remarks  \n The `CComUnkArray` methods **begin** and **end** can be used to loop through all connection points, for example, when an event is fired.  \n  \n [!code-cpp[NVC_ATL_COM#44](../../atl/codesnippet/cpp/ccomunkarray-class_1.cpp)]  \n  \n##  <a name=\"ccomunkarray__getcookie\"></a>  CComUnkArray::GetCookie  \n Call this method to get the cookie associated with a given **IUnknown** pointer.  \n  \n```\nDWORD WINAPI GetCookie(IUnknown** ppFind);\n```  \n  \n### Parameters  \n `ppFind`  \n The **IUnknown** pointer for which the associated cookie is required.  \n  \n### Return Value  \n Returns the cookie associated with the **IUnknown** pointer, or 0 if no matching **IUnknown** pointer is found.  \n  \n### Remarks  \n If there is more than one instance of the same **IUnknown** pointer, this function returns the cookie for the first one.  \n  \n##  <a name=\"ccomunkarray__getunknown\"></a>  CComUnkArray::GetUnknown  \n Call this method to get the **IUnknown** pointer associated with a given cookie.  \n  \n```\nIUnknown* WINAPI GetUnknown(DWORD dwCookie);\n```  \n  \n### Parameters  \n `dwCookie`  \n The cookie for which the associated **IUnknown** pointer is required.  \n  \n### Return Value  \n Returns the **IUnknown** pointer, or NULL if no matching cookie is found.  \n  \n##  <a name=\"ccomunkarray__remove\"></a>  CComUnkArray::Remove  \n Call this method to remove an **IUnknown** pointer from the array.  \n  \n```\nBOOL Remove(DWORD dwCookie);\n```  \n  \n### Parameters  \n `dwCookie`  \n The cookie referencing the **IUnknown** pointer to be removed from the array.  \n  \n### Return Value  \n Returns **TRUE** if the pointer is removed, **FALSE** otherwise.  \n  \n## See Also  \n [CComDynamicUnkArray Class](../../atl/reference/ccomdynamicunkarray-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}