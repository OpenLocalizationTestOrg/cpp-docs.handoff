{"nodes":[{"pos":[12,54],"content":"CInternetConnection Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CInternetConnection Class | Microsoft Docs","pos":[0,42]}]},{"content":"CInternetConnection Class","pos":[689,714]},{"content":"Manages your connection to an Internet server.","pos":[715,761]},{"content":"Syntax","pos":[770,776]},{"content":"Members","pos":[845,852]},{"content":"Public Constructors","pos":[862,881]},{"content":"Name","pos":[888,892]},{"content":"Description","pos":[893,904]},{"content":"CInternetConnection::CInternetConnection","pos":[943,983]},{"pos":[1028,1070],"content":"Constructs a <ph id=\"ph1\">`CInternetConnection`</ph> object.","source":"Constructs a `CInternetConnection` object."},{"content":"Public Methods","pos":[1081,1095]},{"content":"Name","pos":[1102,1106]},{"content":"Description","pos":[1107,1118]},{"content":"CInternetConnection::GetContext","pos":[1157,1188]},{"content":"Gets the context ID for this connection object.","pos":[1224,1271]},{"content":"CInternetConnection::GetServerName","pos":[1277,1311]},{"content":"Gets the name of the server associated with the connection.","pos":[1350,1409]},{"content":"CInternetConnection::GetSession","pos":[1415,1446]},{"pos":[1482,1608],"content":"Gets a pointer to the <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object associated with the connection.","source":"Gets a pointer to the [CInternetSession](../../mfc/reference/cinternetsession-class.md) object associated with the connection."},{"content":"Public Operators","pos":[1619,1635]},{"content":"Name","pos":[1642,1646]},{"content":"Description","pos":[1647,1658]},{"content":"CInternetConnection::operator HINTERNET","pos":[1697,1736]},{"content":"A handle to an Internet session.","pos":[1780,1812]},{"content":"Remarks","pos":[1822,1829]},{"content":"It is the base class for MFC classes <bpt id=\"p1\">[</bpt>CFtpConnection<ept id=\"p1\">](../../mfc/reference/cftpconnection-class.md)</ept>, <bpt id=\"p2\">[</bpt>CHttpConnection<ept id=\"p2\">](../../mfc/reference/chttpconnection-class.md)</ept>, and <bpt id=\"p3\">[</bpt>CGopherConnection<ept id=\"p3\">](../../mfc/reference/cgopherconnection-class.md)</ept>.","pos":[1833,2070],"source":"It is the base class for MFC classes [CFtpConnection](../../mfc/reference/cftpconnection-class.md), [CHttpConnection](../../mfc/reference/chttpconnection-class.md), and [CGopherConnection](../../mfc/reference/cgopherconnection-class.md)."},{"content":"Each of these classes provides additional functionality for communicating with the respective FTP, HTTP, or gopher server.","pos":[2071,2193]},{"pos":[2200,2373],"content":"To communicate directly with an Internet server, you must have a <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object and a <ph id=\"ph1\">`CInternetConnection`</ph> object.","source":"To communicate directly with an Internet server, you must have a [CInternetSession](../../mfc/reference/cinternetsession-class.md) object and a `CInternetConnection` object."},{"pos":[2380,2530],"content":"To learn more about how the WinInet classes work, see the article <bpt id=\"p1\">[</bpt>Internet Programming with WinInet<ept id=\"p1\">](../../mfc/win32-internet-extensions-wininet.md)</ept>.","source":"To learn more about how the WinInet classes work, see the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md)."},{"content":"Inheritance Hierarchy","pos":[2539,2560]},{"content":"CObject","pos":[2565,2572]},{"content":"Requirements","pos":[2648,2660]},{"pos":[2664,2685],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxinet.h","source":"**Header:** afxinet.h"},{"pos":[2752,2792],"content":"CInternetConnection::CInternetConnection"},{"pos":[2796,2874],"content":"This member function is called when a <ph id=\"ph1\">`CInternetConnection`</ph> object is created.","source":"This member function is called when a `CInternetConnection` object is created."},{"content":"Parameters","pos":[3068,3078]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object.","pos":[3096,3184],"source":" A pointer to a [CInternetSession](../../mfc/reference/cinternetsession-class.md) object."},{"content":"A pointer to a string containing the server name.","pos":[3207,3256]},{"content":"The number that identifies the Internet port for this connection.","pos":[3274,3339]},{"content":"The context identifier for the <ph id=\"ph1\">`CInternetConnection`</ph> object.","pos":[3361,3421],"source":" The context identifier for the `CInternetConnection` object."},{"content":"See <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> for more information about <ph id=\"ph1\">`dwContext`</ph>.","pos":[3422,3477],"source":" See **Remarks** for more information about `dwContext`."},{"content":"Remarks","pos":[3487,3494]},{"pos":[3498,3694],"content":"You never call <ph id=\"ph1\">`CInternetConnection`</ph> yourself; instead, call the <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> member function for the type of connection you want to establish:","source":"You never call `CInternetConnection` yourself; instead, call the [CInternetSession](../../mfc/reference/cinternetsession-class.md) member function for the type of connection you want to establish:"},{"content":"CInternetSession::GetFtpConnection","pos":[3703,3737]},{"content":"CInternetSession::GetHttpConnection","pos":[3829,3864]},{"content":"CInternetSession::GetGopherConnection","pos":[3957,3994]},{"content":"The default value for <ph id=\"ph1\">`dwContext`</ph> is sent by MFC to the <ph id=\"ph2\">`CInternetConnection`</ph>-derived object from the <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object that created the <bpt id=\"p2\">**</bpt>InternetConnection<ept id=\"p2\">**</ept>-derived object.","pos":[4087,4317],"source":"The default value for `dwContext` is sent by MFC to the `CInternetConnection`-derived object from the [CInternetSession](../../mfc/reference/cinternetsession-class.md) object that created the **InternetConnection**-derived object."},{"content":"The default is set to 1; however, you can explicitly assign a specific context identifier in the <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__cinternetsession)</ept> constructor for the connection.","pos":[4318,4547],"source":" The default is set to 1; however, you can explicitly assign a specific context identifier in the [CInternetSession](../../mfc/reference/cinternetsession-class.md#cinternetsession__cinternetsession) constructor for the connection."},{"content":"The object and any work it does will be associated with that context ID.","pos":[4548,4620]},{"content":"The context identifier is returned to <bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)</ept> to provide status on the object with which it is identified.","pos":[4621,4838],"source":" The context identifier is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the object with which it is identified."},{"content":"See the article <bpt id=\"p1\">[</bpt>Internet First Steps: WinInet<ept id=\"p1\">](../../mfc/wininet-basics.md)</ept> for more information about the context identifier.","pos":[4839,4966],"source":" See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier."},{"pos":[5024,5055],"content":"CInternetConnection::GetContext"},{"content":"Call this member function to get the context ID for this session.","pos":[5059,5124]},{"content":"Return Value","pos":[5182,5194]},{"content":"The application-assigned context ID.","pos":[5198,5234]},{"content":"Remarks","pos":[5244,5251]},{"content":"The context ID is originally specified in <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> and propagates to <ph id=\"ph1\">`CInternetConnection`</ph>- and <bpt id=\"p2\">[</bpt>CInternetFile<ept id=\"p2\">](../../mfc/reference/cinternetfile-class.md)</ept>-derived classes, unless specified differently in the call to a function that opens the connection.","pos":[5255,5566],"source":"The context ID is originally specified in [CInternetSession](../../mfc/reference/cinternetsession-class.md) and propagates to `CInternetConnection`- and [CInternetFile](../../mfc/reference/cinternetfile-class.md)-derived classes, unless specified differently in the call to a function that opens the connection."},{"content":"The context ID is associated with any operation of the given object and identifies the operation's status information returned by <bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)</ept>.","pos":[5567,5816],"source":" The context ID is associated with any operation of the given object and identifies the operation's status information returned by [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)."},{"pos":[5823,6066],"content":"For more information about how <bpt id=\"p1\">**</bpt>GetContext<ept id=\"p1\">**</ept> works with other WinInet classes to give the user status information, see the article <bpt id=\"p2\">[</bpt>Internet First Steps: WinInet<ept id=\"p2\">](../../mfc/wininet-basics.md)</ept> for more information about the context identifier.","source":"For more information about how **GetContext** works with other WinInet classes to give the user status information, see the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier."},{"pos":[6127,6161],"content":"CInternetConnection::GetServerName"},{"content":"Call this member function to get the name of the server associated with this Internet connection.","pos":[6165,6262]},{"content":"Return Value","pos":[6321,6333]},{"content":"The name of the server this connection object is working with.","pos":[6337,6399]},{"pos":[6457,6488],"content":"CInternetConnection::GetSession"},{"pos":[6492,6607],"content":"Call this member function to get a pointer to the <ph id=\"ph1\">`CInternetSession`</ph> object that's associated with this connection.","source":"Call this member function to get a pointer to the `CInternetSession` object that's associated with this connection."},{"content":"Return Value","pos":[6673,6685]},{"pos":[6689,6825],"content":"A pointer to a <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object associated with this Internet connection object.","source":"A pointer to a [CInternetSession](../../mfc/reference/cinternetsession-class.md) object associated with this Internet connection object."},{"pos":[6891,6930],"content":"CInternetConnection::operator HINTERNET"},{"content":"Use this operator to get the API-level handle for the current Internet session.","pos":[6934,7013]},{"content":"See Also","pos":[7068,7076]},{"content":"CObject Class","pos":[7081,7094]},{"content":"Hierarchy Chart","pos":[7139,7154]}],"content":"---\ntitle: \"CInternetConnection Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CInternetConnection\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"asynchronous connections\"\n  - \"CInternetConnection class\"\n  - \"Internet connections\"\nms.assetid: 62a5d1c3-8471-4e36-a064-48831829b2a7\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CInternetConnection Class\nManages your connection to an Internet server.  \n  \n## Syntax  \n  \n```  \nclass CInternetConnection : public CObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CInternetConnection::CInternetConnection](#cinternetconnection__cinternetconnection)|Constructs a `CInternetConnection` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CInternetConnection::GetContext](#cinternetconnection__getcontext)|Gets the context ID for this connection object.|  \n|[CInternetConnection::GetServerName](#cinternetconnection__getservername)|Gets the name of the server associated with the connection.|  \n|[CInternetConnection::GetSession](#cinternetconnection__getsession)|Gets a pointer to the [CInternetSession](../../mfc/reference/cinternetsession-class.md) object associated with the connection.|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CInternetConnection::operator HINTERNET](#cinternetconnection__operator_hinternet)|A handle to an Internet session.|  \n  \n## Remarks  \n It is the base class for MFC classes [CFtpConnection](../../mfc/reference/cftpconnection-class.md), [CHttpConnection](../../mfc/reference/chttpconnection-class.md), and [CGopherConnection](../../mfc/reference/cgopherconnection-class.md). Each of these classes provides additional functionality for communicating with the respective FTP, HTTP, or gopher server.  \n  \n To communicate directly with an Internet server, you must have a [CInternetSession](../../mfc/reference/cinternetsession-class.md) object and a `CInternetConnection` object.  \n  \n To learn more about how the WinInet classes work, see the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n `CInternetConnection`  \n  \n## Requirements  \n **Header:** afxinet.h  \n  \n##  <a name=\"cinternetconnection__cinternetconnection\"></a>  CInternetConnection::CInternetConnection  \n This member function is called when a `CInternetConnection` object is created.  \n  \n```  \nCInternetConnection(\n    CInternetSession* pSession,  \n    LPCTSTR pstrServer,  \n    INTERNET_PORT nPort = INTERNET_INVALID_PORT_NUMBER,  \n    DWORD_PTR dwContext = 1);\n```  \n  \n### Parameters  \n `pSession`  \n A pointer to a [CInternetSession](../../mfc/reference/cinternetsession-class.md) object.  \n  \n `pstrServer`  \n A pointer to a string containing the server name.  \n  \n `nPort`  \n The number that identifies the Internet port for this connection.  \n  \n `dwContext`  \n The context identifier for the `CInternetConnection` object. See **Remarks** for more information about `dwContext`.  \n  \n### Remarks  \n You never call `CInternetConnection` yourself; instead, call the [CInternetSession](../../mfc/reference/cinternetsession-class.md) member function for the type of connection you want to establish:  \n  \n- [CInternetSession::GetFtpConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getftpconnection)  \n  \n- [CInternetSession::GetHttpConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__gethttpconnection)  \n  \n- [CInternetSession::GetGopherConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getgopherconnection)  \n  \n The default value for `dwContext` is sent by MFC to the `CInternetConnection`-derived object from the [CInternetSession](../../mfc/reference/cinternetsession-class.md) object that created the **InternetConnection**-derived object. The default is set to 1; however, you can explicitly assign a specific context identifier in the [CInternetSession](../../mfc/reference/cinternetsession-class.md#cinternetsession__cinternetsession) constructor for the connection. The object and any work it does will be associated with that context ID. The context identifier is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the object with which it is identified. See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier.  \n  \n##  <a name=\"cinternetconnection__getcontext\"></a>  CInternetConnection::GetContext  \n Call this member function to get the context ID for this session.  \n  \n```  \nDWORD_PTR GetContext() const;\n\n \n```  \n  \n### Return Value  \n The application-assigned context ID.  \n  \n### Remarks  \n The context ID is originally specified in [CInternetSession](../../mfc/reference/cinternetsession-class.md) and propagates to `CInternetConnection`- and [CInternetFile](../../mfc/reference/cinternetfile-class.md)-derived classes, unless specified differently in the call to a function that opens the connection. The context ID is associated with any operation of the given object and identifies the operation's status information returned by [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback).  \n  \n For more information about how **GetContext** works with other WinInet classes to give the user status information, see the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier.  \n  \n##  <a name=\"cinternetconnection__getservername\"></a>  CInternetConnection::GetServerName  \n Call this member function to get the name of the server associated with this Internet connection.  \n  \n```  \nCString GetServerName() const;\n\n \n```  \n  \n### Return Value  \n The name of the server this connection object is working with.  \n  \n##  <a name=\"cinternetconnection__getsession\"></a>  CInternetConnection::GetSession  \n Call this member function to get a pointer to the `CInternetSession` object that's associated with this connection.  \n  \n```  \nCInternetSession* GetSession() const;\n\n \n```  \n  \n### Return Value  \n A pointer to a [CInternetSession](../../mfc/reference/cinternetsession-class.md) object associated with this Internet connection object.  \n  \n##  <a name=\"cinternetconnection__operator_hinternet\"></a>  CInternetConnection::operator HINTERNET  \n Use this operator to get the API-level handle for the current Internet session.  \n  \n```  \noperator HINTERNET() const;\n\n \n```  \n  \n## See Also  \n [CObject Class](../../mfc/reference/cobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n\n\n"}