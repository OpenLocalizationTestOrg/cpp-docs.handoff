{"nodes":[{"pos":[12,49],"content":"CPrintInfo Structure | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CPrintInfo Structure | Microsoft Docs","pos":[0,37]}]},{"content":"CPrintInfo Structure","pos":[612,632]},{"content":"Stores information about a print or print-preview job.","pos":[633,687]},{"content":"Syntax","pos":[696,702]},{"content":"Members","pos":[746,753]},{"content":"Public Methods","pos":[763,777]},{"content":"Name","pos":[784,788]},{"content":"Description","pos":[789,800]},{"content":"CPrintInfo::GetFromPage","pos":[839,862]},{"content":"Returns the number of the first page being printed.","pos":[890,941]},{"content":"CPrintInfo::GetMaxPage","pos":[947,969]},{"content":"Returns the number of the last page of the document.","pos":[996,1048]},{"content":"CPrintInfo::GetMinPage","pos":[1054,1076]},{"content":"Returns the number of the first page of the document.","pos":[1103,1156]},{"content":"CPrintInfo::GetOffsetPage","pos":[1162,1187]},{"content":"Returns the number of the pages preceding the first page of a DocObject item being printed in a combined DocObject print job.","pos":[1217,1342]},{"content":"CPrintInfo::GetToPage","pos":[1348,1369]},{"content":"Returns the number of the last page being printed.","pos":[1395,1445]},{"content":"CPrintInfo::SetMaxPage","pos":[1451,1473]},{"content":"Sets the number of the last page of the document.","pos":[1500,1549]},{"content":"CPrintInfo::SetMinPage","pos":[1555,1577]},{"content":"Sets the number of the first page of the document.","pos":[1604,1654]},{"content":"Public Data Members","pos":[1665,1684]},{"content":"Name","pos":[1691,1695]},{"content":"Description","pos":[1696,1707]},{"content":"CPrintInfo::m_bContinuePrinting","pos":[1746,1777]},{"content":"Contains a flag indicating whether the framework should continue the print loop.","pos":[1813,1893]},{"content":"CPrintInfo::m_bDirect","pos":[1899,1920]},{"content":"Contains a flag indicating whether the document is being printed directly (without displaying the Print dialog box).","pos":[1946,2062]},{"content":"CPrintInfo::m_bDocObject","pos":[2068,2092]},{"content":"Contains a flag indicating whether the document being printed is a DocObject.","pos":[2121,2198]},{"content":"CPrintInfo::m_bPreview","pos":[2204,2226]},{"content":"Contains a flag indicating whether the document is being previewed.","pos":[2253,2320]},{"content":"CPrintInfo::m_dwFlags","pos":[2326,2347]},{"content":"Specifies DocObject printing operations.","pos":[2373,2413]},{"content":"CPrintInfo::m_lpUserData","pos":[2419,2443]},{"content":"Contains a pointer to a user-created structure.","pos":[2472,2519]},{"content":"CPrintInfo::m_nCurPage","pos":[2525,2547]},{"content":"Identifies the number of the page currently being printed.","pos":[2574,2632]},{"content":"CPrintInfo::m_nJobNumber","pos":[2638,2662]},{"content":"Specifies the job number assigned by the operating system for the current print job","pos":[2691,2774]},{"content":"CPrintInfo::m_nNumPreviewPages","pos":[2780,2810]},{"content":"Identifies the number of pages displayed in the preview window; either 1 or 2.","pos":[2845,2923]},{"content":"CPrintInfo::m_nOffsetPage","pos":[2929,2954]},{"content":"Specifies offset of a particular DocObject's first page in a combined DocObject print job.","pos":[2984,3074]},{"content":"CPrintInfo::m_pPD","pos":[3080,3097]},{"pos":[3119,3197],"content":"Contains a pointer to the <ph id=\"ph1\">`CPrintDialog`</ph> object used for the Print dialog box.","source":"Contains a pointer to the `CPrintDialog` object used for the Print dialog box."},{"content":"CPrintInfo::m_rectDraw","pos":[3203,3225]},{"content":"Specifies a rectangle defining the current usable page area.","pos":[3252,3312]},{"content":"CPrintInfo::m_strPageDesc","pos":[3318,3343]},{"content":"Contains a format string for page-number display.","pos":[3373,3422]},{"content":"Remarks","pos":[3432,3439]},{"pos":[3456,3502],"content":"is a structure and does not have a base class."},{"pos":[3509,3658],"content":"The framework creates an object of <ph id=\"ph1\">`CPrintInfo`</ph> each time the Print or Print Preview command is chosen and destroys it when the command is completed.","source":"The framework creates an object of `CPrintInfo` each time the Print or Print Preview command is chosen and destroys it when the command is completed."},{"content":"contains information about both the print job as a whole, such as the range of pages to be printed, and the current status of the print job, such as the page currently being printed.","pos":[3678,3860]},{"content":"Some information is stored in an associated <bpt id=\"p1\">[</bpt>CPrintDialog<ept id=\"p1\">](../../mfc/reference/cprintdialog-class.md)</ept> object; this object contains the values entered by the user in the Print dialog box.","pos":[3861,4047],"source":" Some information is stored in an associated [CPrintDialog](../../mfc/reference/cprintdialog-class.md) object; this object contains the values entered by the user in the Print dialog box."},{"content":"A <ph id=\"ph1\">`CPrintInfo`</ph> object is passed between the framework and your view class during the printing process and is used to exchange information between the two.","pos":[4054,4208],"source":"A `CPrintInfo` object is passed between the framework and your view class during the printing process and is used to exchange information between the two."},{"content":"For example, the framework informs the view class which page of the document to print by assigning a value to the <ph id=\"ph1\">`m_nCurPage`</ph> member of <ph id=\"ph2\">`CPrintInfo`</ph>; the view class retrieves the value and performs the actual printing of the specified page.","pos":[4209,4450],"source":" For example, the framework informs the view class which page of the document to print by assigning a value to the `m_nCurPage` member of `CPrintInfo`; the view class retrieves the value and performs the actual printing of the specified page."},{"content":"Another example is the case in which the length of the document is not known until it is printed.","pos":[4457,4554]},{"content":"In this situation, the view class tests for the end of the document each time a page is printed.","pos":[4555,4651]},{"content":"When the end is reached, the view class sets the <ph id=\"ph1\">`m_bContinuePrinting`</ph> member of <ph id=\"ph2\">`CPrintInfo`</ph> to <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>; this informs the framework to stop the print loop.","pos":[4652,4810],"source":" When the end is reached, the view class sets the `m_bContinuePrinting` member of `CPrintInfo` to **FALSE**; this informs the framework to stop the print loop."},{"content":"is used by the member functions of <ph id=\"ph1\">`CView`</ph> listed under \"See Also.\"","pos":[4830,4897],"source":" is used by the member functions of `CView` listed under \"See Also.\""},{"content":"For more information about the printing architecture provided by the Microsoft Foundation Class Library, see <bpt id=\"p1\">[</bpt>Frame Windows<ept id=\"p1\">](../../mfc/frame-windows.md)</ept> and <bpt id=\"p2\">[</bpt>Document/View Architecture<ept id=\"p2\">](../../mfc/document-view-architecture.md)</ept> and the articles <bpt id=\"p3\">[</bpt>Printing<ept id=\"p3\">](../../mfc/printing.md)</ept> and <bpt id=\"p4\">[</bpt>Printing: Multipage Documents<ept id=\"p4\">](../../mfc/multipage-documents.md)</ept>.","pos":[4898,5246],"source":" For more information about the printing architecture provided by the Microsoft Foundation Class Library, see [Frame Windows](../../mfc/frame-windows.md) and [Document/View Architecture](../../mfc/document-view-architecture.md) and the articles [Printing](../../mfc/printing.md) and [Printing: Multipage Documents](../../mfc/multipage-documents.md)."},{"content":"Inheritance Hierarchy","pos":[5255,5276]},{"content":"Requirements","pos":[5301,5313]},{"pos":[5317,5337],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxext.h","source":"**Header:** afxext.h"},{"pos":[5387,5410],"content":"CPrintInfo::GetFromPage"},{"content":"Call this function to retrieve the number of the first page to be printed.","pos":[5414,5488]},{"content":"Return Value","pos":[5542,5554]},{"content":"The number of the first page to be printed.","pos":[5558,5601]},{"content":"Remarks","pos":[5611,5618]},{"content":"This is the value specified by the user in the Print dialog box, and it is stored in the <ph id=\"ph1\">`CPrintDialog`</ph> object referenced by the <ph id=\"ph2\">`m_pPD`</ph> member.","pos":[5622,5766],"source":"This is the value specified by the user in the Print dialog box, and it is stored in the `CPrintDialog` object referenced by the `m_pPD` member."},{"content":"If the user has not specified a value, the default is the first page of the document.","pos":[5767,5852]},{"pos":[5901,5923],"content":"CPrintInfo::GetMaxPage"},{"content":"Call this function to retrieve the number of the last page of the document.","pos":[5927,6002]},{"content":"Return Value","pos":[6055,6067]},{"content":"The number of the last page of the document.","pos":[6071,6115]},{"content":"Remarks","pos":[6125,6132]},{"pos":[6136,6219],"content":"This value is stored in the <ph id=\"ph1\">`CPrintDialog`</ph> object referenced by the <ph id=\"ph2\">`m_pPD`</ph> member.","source":"This value is stored in the `CPrintDialog` object referenced by the `m_pPD` member."},{"pos":[6268,6290],"content":"CPrintInfo::GetMinPage"},{"content":"Call this function to retrieve the number of the first page of the document.","pos":[6294,6370]},{"content":"Return Value","pos":[6423,6435]},{"content":"The number of the first page of the document.","pos":[6439,6484]},{"content":"Remarks","pos":[6494,6501]},{"pos":[6505,6588],"content":"This value is stored in the <ph id=\"ph1\">`CPrintDialog`</ph> object referenced by the <ph id=\"ph2\">`m_pPD`</ph> member.","source":"This value is stored in the `CPrintDialog` object referenced by the `m_pPD` member."},{"pos":[6640,6665],"content":"CPrintInfo::GetOffsetPage"},{"content":"Call this function to retrieve the offset when printing multiple DocObject items from a DocObject client.","pos":[6669,6774]},{"content":"Return Value","pos":[6830,6842]},{"content":"The number of pages preceding the first page of a DocObject item being printed in a combined DocObject print job.","pos":[6846,6959]},{"content":"Remarks","pos":[6969,6976]},{"content":"This value is referenced by the <bpt id=\"p1\">**</bpt>m_nOffsetPage<ept id=\"p1\">**</ept> member.","pos":[6980,7037],"source":"This value is referenced by the **m_nOffsetPage** member."},{"content":"The first page of your document will be numbered the <bpt id=\"p1\">**</bpt>m_nOffsetPage<ept id=\"p1\">**</ept> value + 1 when printed as a DocObject with other active documents.","pos":[7038,7175],"source":" The first page of your document will be numbered the **m_nOffsetPage** value + 1 when printed as a DocObject with other active documents."},{"content":"The <bpt id=\"p1\">**</bpt>m_nOffsetPage<ept id=\"p1\">**</ept> member is valid only if the <bpt id=\"p2\">**</bpt>m_bDocObject<ept id=\"p2\">**</ept> value is <bpt id=\"p3\">**</bpt>TRUE<ept id=\"p3\">**</ept>.","pos":[7176,7261],"source":" The **m_nOffsetPage** member is valid only if the **m_bDocObject** value is **TRUE**."},{"pos":[7309,7330],"content":"CPrintInfo::GetToPage"},{"content":"Call this function to retrieve the number of the last page to be printed.","pos":[7334,7407]},{"content":"Return Value","pos":[7459,7471]},{"content":"The number of the last page to be printed.","pos":[7475,7517]},{"content":"Remarks","pos":[7527,7534]},{"content":"This is the value specified by the user in the Print dialog box, and it is stored in the <ph id=\"ph1\">`CPrintDialog`</ph> object referenced by the <ph id=\"ph2\">`m_pPD`</ph> member.","pos":[7538,7682],"source":"This is the value specified by the user in the Print dialog box, and it is stored in the `CPrintDialog` object referenced by the `m_pPD` member."},{"content":"If the user has not specified a value, the default is the last page of the document.","pos":[7683,7767]},{"pos":[7825,7856],"content":"CPrintInfo::m_bContinuePrinting"},{"content":"Contains a flag indicating whether the framework should continue the print loop.","pos":[7860,7940]},{"content":"Remarks","pos":[7950,7957]},{"content":"If you are doing print-time pagination, you can set this member to <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> in your override of <ph id=\"ph1\">`CView::OnPrepareDC`</ph> once the end of the document has been reached.","pos":[7961,8125],"source":"If you are doing print-time pagination, you can set this member to **FALSE** in your override of `CView::OnPrepareDC` once the end of the document has been reached."},{"content":"You do not have to modify this variable if you have specified the length of the document at the beginning of the print job using the <ph id=\"ph1\">`SetMaxPage`</ph> member function.","pos":[8126,8288],"source":" You do not have to modify this variable if you have specified the length of the document at the beginning of the print job using the `SetMaxPage` member function."},{"content":"The <ph id=\"ph1\">`m_bContinuePrinting`</ph> member is a public variable of type <bpt id=\"p1\">**</bpt>BOOL<ept id=\"p1\">**</ept>.","pos":[8289,8360],"source":" The `m_bContinuePrinting` member is a public variable of type **BOOL**."},{"pos":[8408,8429],"content":"CPrintInfo::m_bDirect"},{"pos":[8433,8558],"content":"The framework sets this member to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if the Print dialog box will be bypassed for direct printing; <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> otherwise.","source":"The framework sets this member to **TRUE** if the Print dialog box will be bypassed for direct printing; **FALSE** otherwise."},{"content":"Remarks","pos":[8568,8575]},{"pos":[8579,8718],"content":"The Print dialog is normally bypassed when you print from the shell or when printing is done using the command ID <bpt id=\"p1\">**</bpt>ID_FILE_PRINT_DIRECT<ept id=\"p1\">**</ept>.","source":"The Print dialog is normally bypassed when you print from the shell or when printing is done using the command ID **ID_FILE_PRINT_DIRECT**."},{"pos":[8725,9011],"content":"You normally don't change this member, but if you do change it, change it before you call <bpt id=\"p1\">[</bpt>CView::DoPreparePrinting<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__doprepareprinting)</ept> in your override of <bpt id=\"p2\">[</bpt>CView::OnPreparePrinting<ept id=\"p2\">](../../mfc/reference/cview-class.md#cview__onprepareprinting)</ept>.","source":"You normally don't change this member, but if you do change it, change it before you call [CView::DoPreparePrinting](../../mfc/reference/cview-class.md#cview__doprepareprinting) in your override of [CView::OnPreparePrinting](../../mfc/reference/cview-class.md#cview__onprepareprinting)."},{"pos":[9062,9086],"content":"CPrintInfo::m_bDocObject"},{"content":"Contains a flag indicating whether the document being printed is a DocObject.","pos":[9090,9167]},{"content":"Remarks","pos":[9177,9184]},{"pos":[9188,9276],"content":"Data members <ph id=\"ph1\">`m_dwFlags`</ph> and <bpt id=\"p1\">**</bpt>m_nOffsetPage<ept id=\"p1\">**</ept> are invalid unless this flag is <bpt id=\"p2\">**</bpt>TRUE<ept id=\"p2\">**</ept>.","source":"Data members `m_dwFlags` and **m_nOffsetPage** are invalid unless this flag is **TRUE**."},{"pos":[9325,9347],"content":"CPrintInfo::m_bPreview"},{"content":"Contains a flag indicating whether the document is being previewed.","pos":[9351,9418]},{"content":"Remarks","pos":[9428,9435]},{"content":"This is set by the framework depending on which command the user executed.","pos":[9439,9513]},{"content":"The Print dialog box is not displayed for a print-preview job.","pos":[9514,9576]},{"content":"The <bpt id=\"p1\">**</bpt>m_bPreview<ept id=\"p1\">**</ept> member is a public variable of type <bpt id=\"p2\">**</bpt>BOOL<ept id=\"p2\">**</ept>.","pos":[9577,9641],"source":" The **m_bPreview** member is a public variable of type **BOOL**."},{"pos":[9689,9710],"content":"CPrintInfo::m_dwFlags"},{"content":"Contains a combination of flags specifying DocObject printing operations.","pos":[9714,9787]},{"content":"Remarks","pos":[9797,9804]},{"pos":[9808,9863],"content":"Valid only if data member <bpt id=\"p1\">**</bpt>m_bDocObject<ept id=\"p1\">**</ept> is <bpt id=\"p2\">**</bpt>TRUE<ept id=\"p2\">**</ept>.","source":"Valid only if data member **m_bDocObject** is **TRUE**."},{"content":"The flags can be one or more of the following values:","pos":[9870,9923]},{"content":"PRINTFLAG_MAYBOTHERUSER","pos":[9933,9956]},{"content":"PRINTFLAG_PROMPTUSER","pos":[9968,9988]},{"content":"PRINTFLAG_USERMAYCHANGEPRINTER","pos":[10000,10030]},{"content":"PRINTFLAG_RECOMPOSETODEVICE","pos":[10042,10069]},{"content":"PRINTFLAG_DONTACTUALLYPRINT","pos":[10081,10108]},{"content":"PRINTFLAG_FORCEPROPERTIES","pos":[10120,10145]},{"content":"PRINTFLAG_PRINTTOFILE","pos":[10157,10178]},{"pos":[10231,10255],"content":"CPrintInfo::m_lpUserData"},{"content":"Contains a pointer to a user-created structure.","pos":[10259,10306]},{"content":"Remarks","pos":[10316,10323]},{"content":"You can use this to store printing-specific data that you do not want to store in your view class.","pos":[10327,10425]},{"content":"The <bpt id=\"p1\">**</bpt>m_lpUserData<ept id=\"p1\">**</ept> member is a public variable of type <bpt id=\"p2\">**</bpt>LPVOID<ept id=\"p2\">**</ept>.","pos":[10426,10494],"source":" The **m_lpUserData** member is a public variable of type **LPVOID**."},{"pos":[10543,10565],"content":"CPrintInfo::m_nCurPage"},{"content":"Contains the number of the current page.","pos":[10569,10609]},{"content":"Remarks","pos":[10619,10626]},{"content":"The framework calls <ph id=\"ph1\">`CView::OnPrepareDC`</ph> and <ph id=\"ph2\">`CView::OnPrint`</ph> once for each page of the document, specifying a different value for this member each time; its values range from the value returned by <ph id=\"ph3\">`GetFromPage`</ph> to that returned by <ph id=\"ph4\">`GetToPage`</ph>.","pos":[10630,10874],"source":"The framework calls `CView::OnPrepareDC` and `CView::OnPrint` once for each page of the document, specifying a different value for this member each time; its values range from the value returned by `GetFromPage` to that returned by `GetToPage`."},{"content":"Use this member in your overrides of <ph id=\"ph1\">`CView::OnPrepareDC`</ph> and <ph id=\"ph2\">`CView::OnPrint`</ph> to print the specified page of the document.","pos":[10875,10998],"source":" Use this member in your overrides of `CView::OnPrepareDC` and `CView::OnPrint` to print the specified page of the document."},{"content":"When preview mode is first invoked, the framework reads the value of this member to determine which page of the document should be previewed initially.","pos":[11005,11156]},{"content":"You can set the value of this member in your override of <ph id=\"ph1\">`CView::OnPreparePrinting`</ph> to maintain the user's current position in the document when entering preview mode.","pos":[11157,11324],"source":" You can set the value of this member in your override of `CView::OnPreparePrinting` to maintain the user's current position in the document when entering preview mode."},{"content":"The <ph id=\"ph1\">`m_nCurPage`</ph> member is a public variable of type <bpt id=\"p1\">**</bpt>UINT<ept id=\"p1\">**</ept>.","pos":[11325,11387],"source":" The `m_nCurPage` member is a public variable of type **UINT**."},{"pos":[11438,11462],"content":"CPrintInfo::m_nJobNumber"},{"content":"Indicates the job number assigned by the operating system for the current print job.","pos":[11466,11550]},{"content":"Remarks","pos":[11560,11567]},{"pos":[11571,11772],"content":"This value may be <bpt id=\"p1\">**</bpt>SP_ERROR<ept id=\"p1\">**</ept> if the job hasn't yet printed (that is, if the <ph id=\"ph1\">`CPrintInfo`</ph> object is newly constructed and has not yet been used to print), or if there was an error in starting the job.","source":"This value may be **SP_ERROR** if the job hasn't yet printed (that is, if the `CPrintInfo` object is newly constructed and has not yet been used to print), or if there was an error in starting the job."},{"pos":[11829,11859],"content":"CPrintInfo::m_nNumPreviewPages"},{"content":"Contains the number of pages displayed in preview mode; it can be either 1 or 2.","pos":[11863,11943]},{"content":"Remarks","pos":[11953,11960]},{"pos":[11964,12036],"content":"The <bpt id=\"p1\">**</bpt>m_nNumPreviewPages<ept id=\"p1\">**</ept> member is a public variable of type <bpt id=\"p2\">**</bpt>UINT<ept id=\"p2\">**</ept>.","source":"The **m_nNumPreviewPages** member is a public variable of type **UINT**."},{"pos":[12088,12113],"content":"CPrintInfo::m_nOffsetPage"},{"content":"Contains the number of pages preceding the first page of a particular DocObject in a combined DocObject print job.","pos":[12117,12231]},{"pos":[12275,12292],"content":"CPrintInfo::m_pPD"},{"pos":[12296,12399],"content":"Contains a pointer to the <ph id=\"ph1\">`CPrintDialog`</ph> object used to display the Print dialog box for the print job.","source":"Contains a pointer to the `CPrintDialog` object used to display the Print dialog box for the print job."},{"content":"Remarks","pos":[12409,12416]},{"pos":[12420,12500],"content":"The <ph id=\"ph1\">`m_pPD`</ph> member is a public variable declared as a pointer to <ph id=\"ph2\">`CPrintDialog`</ph>.","source":"The `m_pPD` member is a public variable declared as a pointer to `CPrintDialog`."},{"pos":[12549,12571],"content":"CPrintInfo::m_rectDraw"},{"content":"Specifies the usable drawing area of the page in logical coordinates.","pos":[12575,12644]},{"content":"Remarks","pos":[12654,12661]},{"content":"You may want to refer to this in your override of <ph id=\"ph1\">`CView::OnPrint`</ph>.","pos":[12665,12732],"source":"You may want to refer to this in your override of `CView::OnPrint`."},{"content":"You can use this member to keep track of what area remains usable after you print headers, footers, and so on.","pos":[12733,12843]},{"content":"The <bpt id=\"p1\">**</bpt>m_rectDraw<ept id=\"p1\">**</ept> member is a public variable of type <ph id=\"ph1\">`CRect`</ph>.","pos":[12844,12907],"source":" The **m_rectDraw** member is a public variable of type `CRect`."},{"pos":[12959,12984],"content":"CPrintInfo::m_strPageDesc"},{"content":"Contains a format string used to display the page numbers during print preview; this string consists of two substrings, one for single-page display and one for double-page display, each terminated by a '\\n' character.","pos":[12988,13205]},{"content":"Remarks","pos":[13215,13222]},{"content":"The framework uses \"Page %u\\nPages %u-%u\\n\" as the default value.","pos":[13226,13291]},{"content":"If you want a different format for the page numbers, specify a format string in your override of <ph id=\"ph1\">`CView::OnPreparePrinting`</ph>.","pos":[13292,13416],"source":" If you want a different format for the page numbers, specify a format string in your override of `CView::OnPreparePrinting`."},{"content":"The <bpt id=\"p1\">**</bpt>m_strPageDesc<ept id=\"p1\">**</ept> member is a public variable of type <ph id=\"ph1\">`CString`</ph>.","pos":[13417,13485],"source":" The **m_strPageDesc** member is a public variable of type `CString`."},{"pos":[13534,13556],"content":"CPrintInfo::SetMaxPage"},{"content":"Call this function to specify the number of the last page of the document.","pos":[13560,13634]},{"content":"Parameters","pos":[13691,13701]},{"content":"nMaxPage","pos":[13706,13714]},{"content":"Number of the last page of the document.","pos":[13719,13759]},{"content":"Remarks","pos":[13769,13776]},{"content":"This value is stored in the <ph id=\"ph1\">`CPrintDialog`</ph> object referenced by the <ph id=\"ph2\">`m_pPD`</ph> member.","pos":[13780,13863],"source":"This value is stored in the `CPrintDialog` object referenced by the `m_pPD` member."},{"content":"If the length of the document is known before it is printed, call this function from your override of <ph id=\"ph1\">`CView::OnPreparePrinting`</ph>.","pos":[13864,13993],"source":" If the length of the document is known before it is printed, call this function from your override of `CView::OnPreparePrinting`."},{"content":"If the length of the document depends on a setting specified by the user in the Print dialog box, call this function from your override of <ph id=\"ph1\">`CView::OnBeginPrinting`</ph>.","pos":[13994,14158],"source":" If the length of the document depends on a setting specified by the user in the Print dialog box, call this function from your override of `CView::OnBeginPrinting`."},{"content":"If the length of the document is not known until it is printed, use the <ph id=\"ph1\">`m_bContinuePrinting`</ph> member to control the print loop.","pos":[14159,14286],"source":" If the length of the document is not known until it is printed, use the `m_bContinuePrinting` member to control the print loop."},{"content":"Example","pos":[14296,14303]},{"pos":[14308,14416],"content":"See the example for <bpt id=\"p1\">[</bpt>CView::OnPreparePrinting<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__onprepareprinting)</ept>.","source":"See the example for [CView::OnPreparePrinting](../../mfc/reference/cview-class.md#cview__onprepareprinting)."},{"pos":[14465,14487],"content":"CPrintInfo::SetMinPage"},{"content":"Call this function to specify the number of the first page of the document.","pos":[14491,14566]},{"content":"Parameters","pos":[14623,14633]},{"content":"nMinPage","pos":[14638,14646]},{"content":"Number of the first page of the document.","pos":[14651,14692]},{"content":"Remarks","pos":[14702,14709]},{"content":"Page numbers normally start at 1.","pos":[14713,14746]},{"content":"This value is stored in the <ph id=\"ph1\">`CPrintDialog`</ph> object referenced by the <ph id=\"ph2\">`m_pPD`</ph> member.","pos":[14747,14830],"source":" This value is stored in the `CPrintDialog` object referenced by the `m_pPD` member."},{"content":"See Also","pos":[14839,14847]},{"content":"MFC Sample DIBLOOK","pos":[14852,14870]},{"content":"Hierarchy Chart","pos":[14906,14921]},{"content":"CView::OnBeginPrinting","pos":[14958,14980]},{"content":"CView::OnEndPrinting","pos":[15046,15066]},{"content":"CView::OnEndPrintPreview","pos":[15130,15154]},{"content":"CView::OnPrepareDC","pos":[15222,15240]},{"content":"CView::OnPreparePrinting","pos":[15302,15326]},{"content":"CView::OnPrint","pos":[15394,15408]}],"content":"---\ntitle: \"CPrintInfo Structure | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CPrintInfo\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CPrintInfo structure\"\nms.assetid: 0b3de849-d050-4386-9a14-f4c1a25684f7\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CPrintInfo Structure\nStores information about a print or print-preview job.  \n  \n## Syntax  \n  \n```  \nstruct CPrintInfo  \n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPrintInfo::GetFromPage](#cprintinfo__getfrompage)|Returns the number of the first page being printed.|  \n|[CPrintInfo::GetMaxPage](#cprintinfo__getmaxpage)|Returns the number of the last page of the document.|  \n|[CPrintInfo::GetMinPage](#cprintinfo__getminpage)|Returns the number of the first page of the document.|  \n|[CPrintInfo::GetOffsetPage](#cprintinfo__getoffsetpage)|Returns the number of the pages preceding the first page of a DocObject item being printed in a combined DocObject print job.|  \n|[CPrintInfo::GetToPage](#cprintinfo__gettopage)|Returns the number of the last page being printed.|  \n|[CPrintInfo::SetMaxPage](#cprintinfo__setmaxpage)|Sets the number of the last page of the document.|  \n|[CPrintInfo::SetMinPage](#cprintinfo__setminpage)|Sets the number of the first page of the document.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPrintInfo::m_bContinuePrinting](#cprintinfo__m_bcontinueprinting)|Contains a flag indicating whether the framework should continue the print loop.|  \n|[CPrintInfo::m_bDirect](#cprintinfo__m_bdirect)|Contains a flag indicating whether the document is being printed directly (without displaying the Print dialog box).|  \n|[CPrintInfo::m_bDocObject](#cprintinfo__m_bdocobject)|Contains a flag indicating whether the document being printed is a DocObject.|  \n|[CPrintInfo::m_bPreview](#cprintinfo__m_bpreview)|Contains a flag indicating whether the document is being previewed.|  \n|[CPrintInfo::m_dwFlags](#cprintinfo__m_dwflags)|Specifies DocObject printing operations.|  \n|[CPrintInfo::m_lpUserData](#cprintinfo__m_lpuserdata)|Contains a pointer to a user-created structure.|  \n|[CPrintInfo::m_nCurPage](#cprintinfo__m_ncurpage)|Identifies the number of the page currently being printed.|  \n|[CPrintInfo::m_nJobNumber](#cprintinfo__m_njobnumber)|Specifies the job number assigned by the operating system for the current print job|  \n|[CPrintInfo::m_nNumPreviewPages](#cprintinfo__m_nnumpreviewpages)|Identifies the number of pages displayed in the preview window; either 1 or 2.|  \n|[CPrintInfo::m_nOffsetPage](#cprintinfo__m_noffsetpage)|Specifies offset of a particular DocObject's first page in a combined DocObject print job.|  \n|[CPrintInfo::m_pPD](#cprintinfo__m_ppd)|Contains a pointer to the `CPrintDialog` object used for the Print dialog box.|  \n|[CPrintInfo::m_rectDraw](#cprintinfo__m_rectdraw)|Specifies a rectangle defining the current usable page area.|  \n|[CPrintInfo::m_strPageDesc](#cprintinfo__m_strpagedesc)|Contains a format string for page-number display.|  \n  \n## Remarks  \n `CPrintInfo` is a structure and does not have a base class.  \n  \n The framework creates an object of `CPrintInfo` each time the Print or Print Preview command is chosen and destroys it when the command is completed.  \n  \n `CPrintInfo` contains information about both the print job as a whole, such as the range of pages to be printed, and the current status of the print job, such as the page currently being printed. Some information is stored in an associated [CPrintDialog](../../mfc/reference/cprintdialog-class.md) object; this object contains the values entered by the user in the Print dialog box.  \n  \n A `CPrintInfo` object is passed between the framework and your view class during the printing process and is used to exchange information between the two. For example, the framework informs the view class which page of the document to print by assigning a value to the `m_nCurPage` member of `CPrintInfo`; the view class retrieves the value and performs the actual printing of the specified page.  \n  \n Another example is the case in which the length of the document is not known until it is printed. In this situation, the view class tests for the end of the document each time a page is printed. When the end is reached, the view class sets the `m_bContinuePrinting` member of `CPrintInfo` to **FALSE**; this informs the framework to stop the print loop.  \n  \n `CPrintInfo` is used by the member functions of `CView` listed under \"See Also.\" For more information about the printing architecture provided by the Microsoft Foundation Class Library, see [Frame Windows](../../mfc/frame-windows.md) and [Document/View Architecture](../../mfc/document-view-architecture.md) and the articles [Printing](../../mfc/printing.md) and [Printing: Multipage Documents](../../mfc/multipage-documents.md).  \n  \n## Inheritance Hierarchy  \n `CPrintInfo`  \n  \n## Requirements  \n **Header:** afxext.h  \n  \n##  <a name=\"cprintinfo__getfrompage\"></a>  CPrintInfo::GetFromPage  \n Call this function to retrieve the number of the first page to be printed.  \n  \n```  \nUINT GetFromPage() const;\n\n \n```  \n  \n### Return Value  \n The number of the first page to be printed.  \n  \n### Remarks  \n This is the value specified by the user in the Print dialog box, and it is stored in the `CPrintDialog` object referenced by the `m_pPD` member. If the user has not specified a value, the default is the first page of the document.  \n  \n##  <a name=\"cprintinfo__getmaxpage\"></a>  CPrintInfo::GetMaxPage  \n Call this function to retrieve the number of the last page of the document.  \n  \n```  \nUINT GetMaxPage() const;\n\n \n```  \n  \n### Return Value  \n The number of the last page of the document.  \n  \n### Remarks  \n This value is stored in the `CPrintDialog` object referenced by the `m_pPD` member.  \n  \n##  <a name=\"cprintinfo__getminpage\"></a>  CPrintInfo::GetMinPage  \n Call this function to retrieve the number of the first page of the document.  \n  \n```  \nUINT GetMinPage() const;\n\n \n```  \n  \n### Return Value  \n The number of the first page of the document.  \n  \n### Remarks  \n This value is stored in the `CPrintDialog` object referenced by the `m_pPD` member.  \n  \n##  <a name=\"cprintinfo__getoffsetpage\"></a>  CPrintInfo::GetOffsetPage  \n Call this function to retrieve the offset when printing multiple DocObject items from a DocObject client.  \n  \n```  \nUINT GetOffsetPage() const;\n\n \n```  \n  \n### Return Value  \n The number of pages preceding the first page of a DocObject item being printed in a combined DocObject print job.  \n  \n### Remarks  \n This value is referenced by the **m_nOffsetPage** member. The first page of your document will be numbered the **m_nOffsetPage** value + 1 when printed as a DocObject with other active documents. The **m_nOffsetPage** member is valid only if the **m_bDocObject** value is **TRUE**.  \n  \n##  <a name=\"cprintinfo__gettopage\"></a>  CPrintInfo::GetToPage  \n Call this function to retrieve the number of the last page to be printed.  \n  \n```  \nUINT GetToPage() const;\n\n \n```  \n  \n### Return Value  \n The number of the last page to be printed.  \n  \n### Remarks  \n This is the value specified by the user in the Print dialog box, and it is stored in the `CPrintDialog` object referenced by the `m_pPD` member. If the user has not specified a value, the default is the last page of the document.  \n  \n##  <a name=\"cprintinfo__m_bcontinueprinting\"></a>  CPrintInfo::m_bContinuePrinting  \n Contains a flag indicating whether the framework should continue the print loop.  \n  \n### Remarks  \n If you are doing print-time pagination, you can set this member to **FALSE** in your override of `CView::OnPrepareDC` once the end of the document has been reached. You do not have to modify this variable if you have specified the length of the document at the beginning of the print job using the `SetMaxPage` member function. The `m_bContinuePrinting` member is a public variable of type **BOOL**.  \n  \n##  <a name=\"cprintinfo__m_bdirect\"></a>  CPrintInfo::m_bDirect  \n The framework sets this member to **TRUE** if the Print dialog box will be bypassed for direct printing; **FALSE** otherwise.  \n  \n### Remarks  \n The Print dialog is normally bypassed when you print from the shell or when printing is done using the command ID **ID_FILE_PRINT_DIRECT**.  \n  \n You normally don't change this member, but if you do change it, change it before you call [CView::DoPreparePrinting](../../mfc/reference/cview-class.md#cview__doprepareprinting) in your override of [CView::OnPreparePrinting](../../mfc/reference/cview-class.md#cview__onprepareprinting).  \n  \n##  <a name=\"cprintinfo__m_bdocobject\"></a>  CPrintInfo::m_bDocObject  \n Contains a flag indicating whether the document being printed is a DocObject.  \n  \n### Remarks  \n Data members `m_dwFlags` and **m_nOffsetPage** are invalid unless this flag is **TRUE**.  \n  \n##  <a name=\"cprintinfo__m_bpreview\"></a>  CPrintInfo::m_bPreview  \n Contains a flag indicating whether the document is being previewed.  \n  \n### Remarks  \n This is set by the framework depending on which command the user executed. The Print dialog box is not displayed for a print-preview job. The **m_bPreview** member is a public variable of type **BOOL**.  \n  \n##  <a name=\"cprintinfo__m_dwflags\"></a>  CPrintInfo::m_dwFlags  \n Contains a combination of flags specifying DocObject printing operations.  \n  \n### Remarks  \n Valid only if data member **m_bDocObject** is **TRUE**.  \n  \n The flags can be one or more of the following values:  \n  \n- **PRINTFLAG_MAYBOTHERUSER**  \n  \n- **PRINTFLAG_PROMPTUSER**  \n  \n- **PRINTFLAG_USERMAYCHANGEPRINTER**  \n  \n- **PRINTFLAG_RECOMPOSETODEVICE**  \n  \n- **PRINTFLAG_DONTACTUALLYPRINT**  \n  \n- **PRINTFLAG_FORCEPROPERTIES**  \n  \n- **PRINTFLAG_PRINTTOFILE**  \n  \n##  <a name=\"cprintinfo__m_lpuserdata\"></a>  CPrintInfo::m_lpUserData  \n Contains a pointer to a user-created structure.  \n  \n### Remarks  \n You can use this to store printing-specific data that you do not want to store in your view class. The **m_lpUserData** member is a public variable of type **LPVOID**.  \n  \n##  <a name=\"cprintinfo__m_ncurpage\"></a>  CPrintInfo::m_nCurPage  \n Contains the number of the current page.  \n  \n### Remarks  \n The framework calls `CView::OnPrepareDC` and `CView::OnPrint` once for each page of the document, specifying a different value for this member each time; its values range from the value returned by `GetFromPage` to that returned by `GetToPage`. Use this member in your overrides of `CView::OnPrepareDC` and `CView::OnPrint` to print the specified page of the document.  \n  \n When preview mode is first invoked, the framework reads the value of this member to determine which page of the document should be previewed initially. You can set the value of this member in your override of `CView::OnPreparePrinting` to maintain the user's current position in the document when entering preview mode. The `m_nCurPage` member is a public variable of type **UINT**.  \n  \n##  <a name=\"cprintinfo__m_njobnumber\"></a>  CPrintInfo::m_nJobNumber  \n Indicates the job number assigned by the operating system for the current print job.  \n  \n### Remarks  \n This value may be **SP_ERROR** if the job hasn't yet printed (that is, if the `CPrintInfo` object is newly constructed and has not yet been used to print), or if there was an error in starting the job.  \n  \n##  <a name=\"cprintinfo__m_nnumpreviewpages\"></a>  CPrintInfo::m_nNumPreviewPages  \n Contains the number of pages displayed in preview mode; it can be either 1 or 2.  \n  \n### Remarks  \n The **m_nNumPreviewPages** member is a public variable of type **UINT**.  \n  \n##  <a name=\"cprintinfo__m_noffsetpage\"></a>  CPrintInfo::m_nOffsetPage  \n Contains the number of pages preceding the first page of a particular DocObject in a combined DocObject print job.  \n  \n##  <a name=\"cprintinfo__m_ppd\"></a>  CPrintInfo::m_pPD  \n Contains a pointer to the `CPrintDialog` object used to display the Print dialog box for the print job.  \n  \n### Remarks  \n The `m_pPD` member is a public variable declared as a pointer to `CPrintDialog`.  \n  \n##  <a name=\"cprintinfo__m_rectdraw\"></a>  CPrintInfo::m_rectDraw  \n Specifies the usable drawing area of the page in logical coordinates.  \n  \n### Remarks  \n You may want to refer to this in your override of `CView::OnPrint`. You can use this member to keep track of what area remains usable after you print headers, footers, and so on. The **m_rectDraw** member is a public variable of type `CRect`.  \n  \n##  <a name=\"cprintinfo__m_strpagedesc\"></a>  CPrintInfo::m_strPageDesc  \n Contains a format string used to display the page numbers during print preview; this string consists of two substrings, one for single-page display and one for double-page display, each terminated by a '\\n' character.  \n  \n### Remarks  \n The framework uses \"Page %u\\nPages %u-%u\\n\" as the default value. If you want a different format for the page numbers, specify a format string in your override of `CView::OnPreparePrinting`. The **m_strPageDesc** member is a public variable of type `CString`.  \n  \n##  <a name=\"cprintinfo__setmaxpage\"></a>  CPrintInfo::SetMaxPage  \n Call this function to specify the number of the last page of the document.  \n  \n```  \nvoid SetMaxPage(UINT nMaxPage);\n```  \n  \n### Parameters  \n *nMaxPage*  \n Number of the last page of the document.  \n  \n### Remarks  \n This value is stored in the `CPrintDialog` object referenced by the `m_pPD` member. If the length of the document is known before it is printed, call this function from your override of `CView::OnPreparePrinting`. If the length of the document depends on a setting specified by the user in the Print dialog box, call this function from your override of `CView::OnBeginPrinting`. If the length of the document is not known until it is printed, use the `m_bContinuePrinting` member to control the print loop.  \n  \n### Example  \n  See the example for [CView::OnPreparePrinting](../../mfc/reference/cview-class.md#cview__onprepareprinting).  \n  \n##  <a name=\"cprintinfo__setminpage\"></a>  CPrintInfo::SetMinPage  \n Call this function to specify the number of the first page of the document.  \n  \n```  \nvoid SetMinPage(UINT nMinPage);\n```  \n  \n### Parameters  \n *nMinPage*  \n Number of the first page of the document.  \n  \n### Remarks  \n Page numbers normally start at 1. This value is stored in the `CPrintDialog` object referenced by the `m_pPD` member.  \n  \n## See Also  \n [MFC Sample DIBLOOK](../../visual-cpp-samples.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CView::OnBeginPrinting](../../mfc/reference/cview-class.md#cview__onbeginprinting)   \n [CView::OnEndPrinting](../../mfc/reference/cview-class.md#cview__onendprinting)   \n [CView::OnEndPrintPreview](../../mfc/reference/cview-class.md#cview__onendprintpreview)   \n [CView::OnPrepareDC](../../mfc/reference/cview-class.md#cview__onpreparedc)   \n [CView::OnPreparePrinting](../../mfc/reference/cview-class.md#cview__onprepareprinting)   \n [CView::OnPrint](../../mfc/reference/cview-class.md#cview__onprint)\n\n\n\n"}