{"nodes":[{"pos":[12,62],"content":"Understanding the Helper Function | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Understanding the Helper Function | Microsoft Docs","pos":[0,50]}]},{"content":"Understanding the Helper Function","pos":[756,789]},{"content":"The helper function for linker-supported delayed loading is what actually loads the DLL at run time.","pos":[790,890]},{"content":"You can modify the helper function to customize its behavior by writing your own function and linking it to your program instead of using the supplied helper function in Delayimp.lib.","pos":[891,1074]},{"content":"One helper function serves all delay loaded DLLs.","pos":[1075,1124]},{"content":"You can provide your own version of the helper function if you want to do specific processing based on the names of the DLL or imports.","pos":[1131,1266]},{"content":"The helper function performs the following actions:","pos":[1273,1324]},{"content":"Checks the stored handle to the library to see if it has already been loaded","pos":[1334,1410]},{"pos":[1420,1471],"content":"Calls <bpt id=\"p1\">**</bpt>LoadLibrary<ept id=\"p1\">**</ept> to attempt loading of the DLL","source":"Calls **LoadLibrary** to attempt loading of the DLL"},{"pos":[1481,1553],"content":"Calls <bpt id=\"p1\">**</bpt>GetProcAddress<ept id=\"p1\">**</ept> to attempt getting the address of the procedure","source":"Calls **GetProcAddress** to attempt getting the address of the procedure"},{"content":"Returns to the delay import load thunk to call the now-loaded entry point","pos":[1563,1636]},{"content":"The helper function can call back to a notification hook in your program after each of the following actions:","pos":[1643,1752]},{"content":"When the helper function starts up","pos":[1762,1796]},{"pos":[1806,1866],"content":"Just before <bpt id=\"p1\">**</bpt>LoadLibrary<ept id=\"p1\">**</ept> is called in the helper function","source":"Just before **LoadLibrary** is called in the helper function"},{"pos":[1876,1939],"content":"Just before <bpt id=\"p1\">**</bpt>GetProcAddress<ept id=\"p1\">**</ept> is called in the helper function","source":"Just before **GetProcAddress** is called in the helper function"},{"pos":[1949,2009],"content":"If the call to <bpt id=\"p1\">**</bpt>LoadLibrary<ept id=\"p1\">**</ept> in the helper function failed","source":"If the call to **LoadLibrary** in the helper function failed"},{"pos":[2019,2082],"content":"If the call to <bpt id=\"p1\">**</bpt>GetProcAddress<ept id=\"p1\">**</ept> in the helper function failed","source":"If the call to **GetProcAddress** in the helper function failed"},{"content":"After the helper function is done processing","pos":[2092,2136]},{"content":"Each of these hook points can return a value that will alter normal processing of the helper routine in some manner except the return to the delay import load thunk.","pos":[2143,2308]},{"content":"The default helper code can be found in Delayhlp.cpp and Delayimp.h (in vc\\include) and is compiled in Delayimp.lib (in vc\\lib).","pos":[2315,2443]},{"content":"You will need to include this library in your compilations unless you write your own helper function.","pos":[2444,2545]},{"content":"The following topics describe the helper function:","pos":[2552,2602]},{"content":"Changes in the DLL Delayed Loading Helper Function Since Visual C++ 6.0","pos":[2613,2684]},{"content":"Calling Conventions, Parameters, and Return Type","pos":[2794,2842]},{"content":"Structure and Constant Definitions","pos":[2927,2961]},{"content":"Calculating Necessary Values","pos":[3034,3062]},{"content":"Unloading a Delay-Loaded DLL","pos":[3129,3157]},{"content":"See Also","pos":[3233,3241]},{"content":"Linker Support for Delay-Loaded DLLs","pos":[3246,3282]}],"content":"---\ntitle: \"Understanding the Helper Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"delayed loading of DLLs, helper function\"\n  - \"__delayLoadHelper2 function\"\n  - \"delayimp.lib\"\n  - \"__delayLoadHelper function\"\n  - \"delayhlp.cpp\"\n  - \"delayimp.h\"\n  - \"helper functions\"\nms.assetid: 6279c12c-d908-4967-b0b3-cabfc3e91d3d\ncaps.latest.revision: 8\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Understanding the Helper Function\nThe helper function for linker-supported delayed loading is what actually loads the DLL at run time. You can modify the helper function to customize its behavior by writing your own function and linking it to your program instead of using the supplied helper function in Delayimp.lib. One helper function serves all delay loaded DLLs.  \n  \n You can provide your own version of the helper function if you want to do specific processing based on the names of the DLL or imports.  \n  \n The helper function performs the following actions:  \n  \n-   Checks the stored handle to the library to see if it has already been loaded  \n  \n-   Calls **LoadLibrary** to attempt loading of the DLL  \n  \n-   Calls **GetProcAddress** to attempt getting the address of the procedure  \n  \n-   Returns to the delay import load thunk to call the now-loaded entry point  \n  \n The helper function can call back to a notification hook in your program after each of the following actions:  \n  \n-   When the helper function starts up  \n  \n-   Just before **LoadLibrary** is called in the helper function  \n  \n-   Just before **GetProcAddress** is called in the helper function  \n  \n-   If the call to **LoadLibrary** in the helper function failed  \n  \n-   If the call to **GetProcAddress** in the helper function failed  \n  \n-   After the helper function is done processing  \n  \n Each of these hook points can return a value that will alter normal processing of the helper routine in some manner except the return to the delay import load thunk.  \n  \n The default helper code can be found in Delayhlp.cpp and Delayimp.h (in vc\\include) and is compiled in Delayimp.lib (in vc\\lib). You will need to include this library in your compilations unless you write your own helper function.  \n  \n The following topics describe the helper function:  \n  \n-   [Changes in the DLL Delayed Loading Helper Function Since Visual C++ 6.0](../../build/reference/changes-in-the-dll-delayed-loading-helper-function-since-visual-cpp-6-0.md)  \n  \n-   [Calling Conventions, Parameters, and Return Type](../../build/reference/calling-conventions-parameters-and-return-type.md)  \n  \n-   [Structure and Constant Definitions](../../build/reference/structure-and-constant-definitions.md)  \n  \n-   [Calculating Necessary Values](../../build/reference/calculating-necessary-values.md)  \n  \n-   [Unloading a Delay-Loaded DLL](../../build/reference/explicitly-unloading-a-delay-loaded-dll.md)  \n  \n## See Also  \n [Linker Support for Delay-Loaded DLLs](../../build/reference/linker-support-for-delay-loaded-dlls.md)"}