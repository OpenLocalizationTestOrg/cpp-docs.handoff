{"nodes":[{"pos":[12,60],"content":"Using an Existing ADO Recordset | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using an Existing ADO Recordset | Microsoft Docs","pos":[0,48]}]},{"content":"Using an Existing ADO Recordset","pos":[677,708]},{"content":"To mix OLE DB consumer templates and Active Data Objects (ADO), use ADO to open a recordset (corresponding to a rowset in the OLE DB Consumer Templates).","pos":[709,862]},{"content":"When you have a recordset, do the following to connect to an OLE DB rowset:","pos":[863,938]},{"pos":[948,1013],"content":"Call <ph id=\"ph1\">`QueryInterface`</ph> for the <ph id=\"ph2\">`IRowset`</ph> and <ph id=\"ph3\">`IAccessor`</ph> pointers.","source":"Call `QueryInterface` for the `IRowset` and `IAccessor` pointers."},{"pos":[1242,1320],"content":"[!NOTE]\n *lpUnk* points to the **IUnknown** object of the ADO recordset.","leadings":["","    > "],"nodes":[{"content":"<bpt id=\"p1\"> *</bpt>lpUnk<ept id=\"p1\">*</ept> points to the <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> object of the ADO recordset.","pos":[8,72],"source":" *lpUnk* points to the **IUnknown** object of the ADO recordset."}]},{"content":"Attach the accessor and rowset to their appropriate OLE DB consumer template classes.","pos":[1330,1415]},{"content":"See Also","pos":[1688,1696]},{"content":"Using Accessors","pos":[1701,1716]}],"content":"---\ntitle: \"Using an Existing ADO Recordset | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ADO recordsets [C++]\"\n  - \"OLE DB consumer templates, ADO recordsets\"\n  - \"recordsets [C++], using in OLE DB\"\nms.assetid: a9b1de8a-d379-49b1-a26e-578741e9f6a8\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Using an Existing ADO Recordset\nTo mix OLE DB consumer templates and Active Data Objects (ADO), use ADO to open a recordset (corresponding to a rowset in the OLE DB Consumer Templates). When you have a recordset, do the following to connect to an OLE DB rowset:  \n  \n1.  Call `QueryInterface` for the `IRowset` and `IAccessor` pointers.  \n  \n    ```  \n    IRowset* lpRowset = NULL;  \n    IAccessor* lpAccessor = NULL;  \n    lpUnk->QueryInterface(IID_IRowset, (void**)&lpRowset);  \n    lpUnk->QueryInterface(IID_IAccessor, (void**)&lpAccessor);  \n    ```  \n  \n    > [!NOTE]\n    >  *lpUnk* points to the **IUnknown** object of the ADO recordset.  \n  \n2.  Attach the accessor and rowset to their appropriate OLE DB consumer template classes.  \n  \n    ```  \n    CRowset rs;  \n    CAccessor accessor;  \n  \n    accessor.AddAccessorInfo(0ul);      // 0 is the ordinal of an ADO accessor  \n    rs.m_spRowset.Attach(lpRowset);      // use the Attach method of CComPtr<>  \n    rs.SetAccessor(accessor);  \n    ```  \n  \n## See Also  \n [Using Accessors](../../data/oledb/using-accessors.md)"}