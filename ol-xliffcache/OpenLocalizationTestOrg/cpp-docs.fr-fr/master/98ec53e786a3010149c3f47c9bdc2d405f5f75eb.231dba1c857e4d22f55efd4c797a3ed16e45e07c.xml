{"nodes":[{"pos":[12,62],"content":"IAxWinAmbientDispatchEx Interface | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IAxWinAmbientDispatchEx Interface | Microsoft Docs","pos":[0,50]}]},{"content":"IAxWinAmbientDispatchEx Interface","pos":[720,753]},{"content":"This interface implements supplemental ambient properties for a hosted control.","pos":[754,833]},{"pos":[841,991],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,148],"source":" This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"content":"Syntax","pos":[1000,1006]},{"content":"Members","pos":[1146,1153]},{"content":"Methods","pos":[1163,1170]},{"content":"SetAmbientDispatch","pos":[1192,1210]},{"content":"This method is called to supplement the default ambient property interface with a user-defined interface.","pos":[1258,1363]},{"content":"Remarks","pos":[1373,1380]},{"content":"Include this interface in ATL applications that are statically linked to ATL and host ActiveX Controls, especially ActiveX Controls that have Ambient Properties.","pos":[1384,1545]},{"content":"Not including this interface will generate this assertion: \"Did you forget to pass the LIBID to CComModule::Init\"","pos":[1546,1659]},{"content":"This interface is exposed by ATL's ActiveX control hosting objects.","pos":[1666,1733]},{"content":"Derived from <bpt id=\"p1\">[</bpt>IAxWinAmbientDispatch<ept id=\"p1\">](../../atl/reference/iaxwinambientdispatch-interface.md)</ept>, <ph id=\"ph1\">`IAxWinAmbientDispatchEx`</ph> adds a method that allows you to supplement the ambient property interface provided by ATL with one of your own.","pos":[1734,1966],"source":" Derived from [IAxWinAmbientDispatch](../../atl/reference/iaxwinambientdispatch-interface.md), `IAxWinAmbientDispatchEx` adds a method that allows you to supplement the ambient property interface provided by ATL with one of your own."},{"pos":[1973,2190],"content":"<bpt id=\"p1\">[</bpt>AXHost<ept id=\"p1\">](https://msdn.microsoft.com/library/system.windows.forms.axhost.aspx)</ept> will try to load type information about <ph id=\"ph1\">`IAxWinAmbientDispatch`</ph> and <ph id=\"ph2\">`IAxWinAmbientDispatchEx`</ph> from the type library that contains the code.","source":"[AXHost](https://msdn.microsoft.com/library/system.windows.forms.axhost.aspx) will try to load type information about `IAxWinAmbientDispatch` and `IAxWinAmbientDispatchEx` from the type library that contains the code."},{"pos":[2197,2305],"content":"If you are linking to ATL90.dll, <bpt id=\"p1\">**</bpt>AXHost<ept id=\"p1\">**</ept> will load the type information from the type library in the DLL.","source":"If you are linking to ATL90.dll, **AXHost** will load the type information from the type library in the DLL."},{"pos":[2312,2433],"content":"See <bpt id=\"p1\">[</bpt>Hosting ActiveX Controls Using ATL AXHost<ept id=\"p1\">](../../atl/hosting-activex-controls-using-atl-axhost.md)</ept> for more details.","source":"See [Hosting ActiveX Controls Using ATL AXHost](../../atl/hosting-activex-controls-using-atl-axhost.md) for more details."},{"content":"Requirements","pos":[2442,2454]},{"content":"The definition of this interface is available in a number of forms, as shown in the following table.","pos":[2458,2558]},{"content":"Definition Type","pos":[2565,2580]},{"content":"File","pos":[2581,2585]},{"content":"IDL","pos":[2627,2630]},{"content":"atliface.idl","pos":[2631,2643]},{"content":"Type Library","pos":[2648,2660]},{"content":"ATL.dll","pos":[2661,2668]},{"content":"C++","pos":[2673,2676]},{"content":"atliface.h (also included in ATLBase.h)","pos":[2677,2716]},{"pos":[2787,2830],"content":"IAxWinAmbientDispatchEx::SetAmbientDispatch"},{"content":"This method is called to supplement the default ambient property interface with a user-defined interface.","pos":[2834,2939]},{"content":"Parameters","pos":[3042,3052]},{"content":"pDispatch","pos":[3057,3066]},{"content":"Pointer to the new interface.","pos":[3071,3100]},{"content":"Return Value","pos":[3110,3122]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[3126,3182]},{"content":"Remarks","pos":[3192,3199]},{"pos":[3203,3506],"content":"When <ph id=\"ph1\">`SetAmbientDispatch`</ph> is called with a pointer to a new interface, this new interface will be used to invoke any properties or methods asked for by the hosted control â€” if those properties are not already provided by <bpt id=\"p1\">[</bpt>IAxWinAmbientDispatch<ept id=\"p1\">](../../atl/reference/iaxwinambientdispatch-interface.md)</ept>.","source":"When `SetAmbientDispatch` is called with a pointer to a new interface, this new interface will be used to invoke any properties or methods asked for by the hosted control â€” if those properties are not already provided by [IAxWinAmbientDispatch](../../atl/reference/iaxwinambientdispatch-interface.md)."},{"content":"See Also","pos":[3515,3523]},{"content":"IAxWinAmbientDispatch Interface","pos":[3528,3559]}],"content":"---\ntitle: \"IAxWinAmbientDispatchEx Interface | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL.IAxWinAmbientDispatchEx\"\n  - \"IAxWinAmbientDispatchEx\"\n  - \"ATL::IAxWinAmbientDispatchEx\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IAxWinAmbientDispatchEx interface\"\nms.assetid: 2c25e079-6128-4278-bc72-b2c6195ba7ef\ncaps.latest.revision: 25\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IAxWinAmbientDispatchEx Interface\nThis interface implements supplemental ambient properties for a hosted control.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n## Syntax  \n  \n```\nMIDL_INTERFACE(\"B2D0778B - AC99 - 4c58 - A5C8 - E7724E5316B5\") IAxWinAmbientDispatchEx : public IAxWinAmbientDispatch\n```  \n  \n## Members  \n  \n### Methods  \n  \n|||  \n|-|-|  \n|[SetAmbientDispatch](#iaxwinambientdispatchex__setambientdispatch)|This method is called to supplement the default ambient property interface with a user-defined interface.|  \n  \n## Remarks  \n Include this interface in ATL applications that are statically linked to ATL and host ActiveX Controls, especially ActiveX Controls that have Ambient Properties. Not including this interface will generate this assertion: \"Did you forget to pass the LIBID to CComModule::Init\"  \n  \n This interface is exposed by ATL's ActiveX control hosting objects. Derived from [IAxWinAmbientDispatch](../../atl/reference/iaxwinambientdispatch-interface.md), `IAxWinAmbientDispatchEx` adds a method that allows you to supplement the ambient property interface provided by ATL with one of your own.  \n  \n [AXHost](https://msdn.microsoft.com/library/system.windows.forms.axhost.aspx) will try to load type information about `IAxWinAmbientDispatch` and `IAxWinAmbientDispatchEx` from the type library that contains the code.  \n  \n If you are linking to ATL90.dll, **AXHost** will load the type information from the type library in the DLL.  \n  \n See [Hosting ActiveX Controls Using ATL AXHost](../../atl/hosting-activex-controls-using-atl-axhost.md) for more details.  \n  \n## Requirements  \n The definition of this interface is available in a number of forms, as shown in the following table.  \n  \n|Definition Type|File|  \n|---------------------|----------|  \n|IDL|atliface.idl|  \n|Type Library|ATL.dll|  \n|C++|atliface.h (also included in ATLBase.h)|  \n  \n##  <a name=\"iaxwinambientdispatchex__setambientdispatch\"></a>  IAxWinAmbientDispatchEx::SetAmbientDispatch  \n This method is called to supplement the default ambient property interface with a user-defined interface.  \n  \n```\nvirtual HRESULT STDMETHODCALLTYPE SetAmbientDispatch(IDispatch* pDispatch) = 0;\n```  \n  \n### Parameters  \n *pDispatch*  \n Pointer to the new interface.  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n### Remarks  \n When `SetAmbientDispatch` is called with a pointer to a new interface, this new interface will be used to invoke any properties or methods asked for by the hosted control â€” if those properties are not already provided by [IAxWinAmbientDispatch](../../atl/reference/iaxwinambientdispatch-interface.md).  \n  \n## See Also  \n [IAxWinAmbientDispatch Interface](../../atl/reference/iaxwinambientdispatch-interface.md)\n"}