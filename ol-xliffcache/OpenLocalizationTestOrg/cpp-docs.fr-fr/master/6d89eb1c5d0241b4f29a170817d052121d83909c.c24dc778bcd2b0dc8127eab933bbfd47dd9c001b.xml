{"nodes":[{"pos":[12,57],"content":"IPersistStreamInitImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IPersistStreamInitImpl Class | Microsoft Docs","pos":[0,45]}]},{"pos":[843,871],"content":"IPersistStreamInitImpl Class","linkify":"IPersistStreamInitImpl Class","nodes":[{"content":"IPersistStreamInitImpl Class","pos":[0,28]}]},{"pos":[872,1043],"content":"This class implements <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> and provides a default implementation of the <bpt id=\"p2\">[</bpt>IPersistStreamInit<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682273)</ept> interface.","source":"This class implements **IUnknown** and provides a default implementation of the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface."},{"pos":[1051,1201],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,148],"source":" This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"pos":[1210,1216],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1331,1341],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Your class, derived from <ph id=\"ph1\">`IPersistStreamInitImpl`</ph>.","pos":[1352,1402],"source":" Your class, derived from `IPersistStreamInitImpl`."},{"pos":[1411,1418],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1428,1442],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1449,1453]},{"content":"Description","pos":[1454,1465]},{"pos":[1503,1576],"content":"<bpt id=\"p1\">[</bpt>IPersistStreamInitImpl::GetClassID<ept id=\"p1\">](#ipersiststreaminitimpl__getclassid)</ept>","source":"[IPersistStreamInitImpl::GetClassID](#ipersiststreaminitimpl__getclassid)"},{"content":"Retrieves the object's CLSID.","pos":[1577,1606]},{"pos":[1611,1684],"content":"<bpt id=\"p1\">[</bpt>IPersistStreamInitImpl::GetSizeMax<ept id=\"p1\">](#ipersiststreaminitimpl__getsizemax)</ept>","source":"[IPersistStreamInitImpl::GetSizeMax](#ipersiststreaminitimpl__getsizemax)"},{"content":"Retrieves the size of the stream needed to save the object's data.","pos":[1685,1751]},{"content":"The ATL implementation returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","pos":[1752,1797],"source":" The ATL implementation returns **E_NOTIMPL**."},{"pos":[1802,1869],"content":"<bpt id=\"p1\">[</bpt>IPersistStreamInitImpl::InitNew<ept id=\"p1\">](#ipersiststreaminitimpl__initnew)</ept>","source":"[IPersistStreamInitImpl::InitNew](#ipersiststreaminitimpl__initnew)"},{"content":"Initializes a newly created object.","pos":[1870,1905]},{"pos":[1910,1977],"content":"<bpt id=\"p1\">[</bpt>IPersistStreamInitImpl::IsDirty<ept id=\"p1\">](#ipersiststreaminitimpl__isdirty)</ept>","source":"[IPersistStreamInitImpl::IsDirty](#ipersiststreaminitimpl__isdirty)"},{"content":"Checks whether the object's data has changed since it was last saved.","pos":[1978,2047]},{"pos":[2052,2113],"content":"<bpt id=\"p1\">[</bpt>IPersistStreamInitImpl::Load<ept id=\"p1\">](#ipersiststreaminitimpl__load)</ept>","source":"[IPersistStreamInitImpl::Load](#ipersiststreaminitimpl__load)"},{"content":"Loads the object's properties from the specified stream.","pos":[2114,2170]},{"pos":[2175,2236],"content":"<bpt id=\"p1\">[</bpt>IPersistStreamInitImpl::Save<ept id=\"p1\">](#ipersiststreaminitimpl__save)</ept>","source":"[IPersistStreamInitImpl::Save](#ipersiststreaminitimpl__save)"},{"content":"Saves the object's properties to the specified stream.","pos":[2237,2291]},{"pos":[2301,2308],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <bpt id=\"p1\">[</bpt>IPersistStreamInit<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682273)</ept> interface allows a client to request that your object loads and saves its persistent data to a single stream.","pos":[2312,2506],"source":"The [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface allows a client to request that your object loads and saves its persistent data to a single stream."},{"content":"Class <ph id=\"ph1\">`IPersistStreamInitImpl`</ph> provides a default implementation of this interface and implements <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> by sending information to the dump device in debug builds.","pos":[2507,2676],"source":" Class `IPersistStreamInitImpl` provides a default implementation of this interface and implements **IUnknown** by sending information to the dump device in debug builds."},{"pos":[2683,2844],"content":"<bpt id=\"p1\">**</bpt>Related Articles<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>ATL Tutorial<ept id=\"p2\">](../../atl/active-template-library-atl-tutorial.md)</ept>, <bpt id=\"p3\">[</bpt>Creating an ATL Project<ept id=\"p3\">](../../atl/reference/creating-an-atl-project.md)</ept>","source":"**Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)"},{"pos":[2853,2874],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2938,2950],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2954,2974],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[2984,3069],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststreaminitimpl__getclassid\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStreamInitImpl::GetClassID","linkify":"<a name=\"ipersiststreaminitimpl__getclassid\"></a>  IPersistStreamInitImpl::GetClassID","source":"<a name=\"ipersiststreaminitimpl__getclassid\"></a>  IPersistStreamInitImpl::GetClassID"},{"content":"Retrieves the object's CLSID.","pos":[3073,3102]},{"pos":[3165,3172],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3176,3322],"content":"See <bpt id=\"p1\">[</bpt>IPersist::GetClassID<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms688664)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3332,3417],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststreaminitimpl__getsizemax\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStreamInitImpl::GetSizeMax","linkify":"<a name=\"ipersiststreaminitimpl__getsizemax\"></a>  IPersistStreamInitImpl::GetSizeMax","source":"<a name=\"ipersiststreaminitimpl__getsizemax\"></a>  IPersistStreamInitImpl::GetSizeMax"},{"content":"Retrieves the size of the stream needed to save the object's data.","pos":[3421,3487]},{"pos":[3562,3574],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[3578,3600],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[3610,3617],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3621,3777],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::GetSizeMax<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms687287)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::GetSizeMax](http://msdn.microsoft.com/library/windows/desktop/ms687287) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3787,3866],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststreaminitimpl__initnew\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStreamInitImpl::InitNew","linkify":"<a name=\"ipersiststreaminitimpl__initnew\"></a>  IPersistStreamInitImpl::InitNew","source":"<a name=\"ipersiststreaminitimpl__initnew\"></a>  IPersistStreamInitImpl::InitNew"},{"content":"Initializes a newly created object.","pos":[3870,3905]},{"pos":[3950,3957],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3961,4114],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::InitNew<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690234)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4124,4203],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststreaminitimpl__isdirty\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStreamInitImpl::IsDirty","linkify":"<a name=\"ipersiststreaminitimpl__isdirty\"></a>  IPersistStreamInitImpl::IsDirty","source":"<a name=\"ipersiststreaminitimpl__isdirty\"></a>  IPersistStreamInitImpl::IsDirty"},{"content":"Checks whether the object's data has changed since it was last saved.","pos":[4207,4276]},{"pos":[4321,4328],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4332,4485],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::IsDirty<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680092)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms680092) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4495,4568],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststreaminitimpl__load\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStreamInitImpl::Load","linkify":"<a name=\"ipersiststreaminitimpl__load\"></a>  IPersistStreamInitImpl::Load","source":"<a name=\"ipersiststreaminitimpl__load\"></a>  IPersistStreamInitImpl::Load"},{"content":"Loads the object's properties from the specified stream.","pos":[4572,4628]},{"pos":[4683,4690],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"ATL uses the object's property map to retrieve this information.","pos":[4694,4758]},{"pos":[4765,4915],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::Load<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680730)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4925,4998],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststreaminitimpl__save\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStreamInitImpl::Save","linkify":"<a name=\"ipersiststreaminitimpl__save\"></a>  IPersistStreamInitImpl::Save","source":"<a name=\"ipersiststreaminitimpl__save\"></a>  IPersistStreamInitImpl::Save"},{"content":"Saves the object's properties to the specified stream.","pos":[5002,5056]},{"pos":[5130,5137],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"ATL uses the object's property map to store this information.","pos":[5141,5202]},{"pos":[5209,5359],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::Save<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694439)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::Save](http://msdn.microsoft.com/library/windows/desktop/ms694439) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[5368,5376],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Storages and Streams<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380352)</ept><ph id=\"ph1\"> </ph>","pos":[5380,5463],"source":"[Storages and Streams](http://msdn.microsoft.com/library/windows/desktop/aa380352) "},{"content":"<bpt id=\"p1\"> [</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","pos":[5466,5516],"source":" [Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"IPersistStreamInitImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::IPersistStreamInitImpl\"\n  - \"ATL::IPersistStreamInitImpl<T>\"\n  - \"ATL.IPersistStreamInitImpl<T>\"\n  - \"IPersistStreamInitImpl\"\n  - \"ATL.IPersistStreamInitImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IPersistStreamInit ATL implementation\"\n  - \"IPersistStreamInitImpl class\"\n  - \"streams, ATL\"\nms.assetid: ef217c3c-020f-4cf8-871e-ef68e57865b8\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IPersistStreamInitImpl Class\nThis class implements **IUnknown** and provides a default implementation of the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n## Syntax  \n  \n```\ntemplate<class T>  class ATL_NO_VTABLE IPersistStreamInitImpl :  public IPersistStreamInit\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `IPersistStreamInitImpl`.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IPersistStreamInitImpl::GetClassID](#ipersiststreaminitimpl__getclassid)|Retrieves the object's CLSID.|  \n|[IPersistStreamInitImpl::GetSizeMax](#ipersiststreaminitimpl__getsizemax)|Retrieves the size of the stream needed to save the object's data. The ATL implementation returns **E_NOTIMPL**.|  \n|[IPersistStreamInitImpl::InitNew](#ipersiststreaminitimpl__initnew)|Initializes a newly created object.|  \n|[IPersistStreamInitImpl::IsDirty](#ipersiststreaminitimpl__isdirty)|Checks whether the object's data has changed since it was last saved.|  \n|[IPersistStreamInitImpl::Load](#ipersiststreaminitimpl__load)|Loads the object's properties from the specified stream.|  \n|[IPersistStreamInitImpl::Save](#ipersiststreaminitimpl__save)|Saves the object's properties to the specified stream.|  \n  \n## Remarks  \n The [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface allows a client to request that your object loads and saves its persistent data to a single stream. Class `IPersistStreamInitImpl` provides a default implementation of this interface and implements **IUnknown** by sending information to the dump device in debug builds.  \n  \n **Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)  \n  \n## Inheritance Hierarchy  \n `IPersistStreamInit`  \n  \n `IPersistStreamInitImpl`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ipersiststreaminitimpl__getclassid\"></a>  IPersistStreamInitImpl::GetClassID  \n Retrieves the object's CLSID.  \n  \n```\nSTDMETHOD(GetClassID)(CLSID* pClassID);\n```  \n  \n### Remarks  \n See [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__getsizemax\"></a>  IPersistStreamInitImpl::GetSizeMax  \n Retrieves the size of the stream needed to save the object's data.  \n  \n```\nSTDMETHOD(GetSizeMax)(ULARGE_INTEGER FAR* pcbSize);\n```  \n  \n### Return Value  \n Returns **E_NOTIMPL**.  \n  \n### Remarks  \n See [IPersistStreamInit::GetSizeMax](http://msdn.microsoft.com/library/windows/desktop/ms687287) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__initnew\"></a>  IPersistStreamInitImpl::InitNew  \n Initializes a newly created object.  \n  \n```\nSTDMETHOD(InitNew)();\n```  \n  \n### Remarks  \n See [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__isdirty\"></a>  IPersistStreamInitImpl::IsDirty  \n Checks whether the object's data has changed since it was last saved.  \n  \n```\nSTDMETHOD(IsDirty)();\n```  \n  \n### Remarks  \n See [IPersistStreamInit::IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms680092) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__load\"></a>  IPersistStreamInitImpl::Load  \n Loads the object's properties from the specified stream.  \n  \n```\nSTDMETHOD(Load)(LPSTREAM pStm);\n```  \n  \n### Remarks  \n ATL uses the object's property map to retrieve this information.  \n  \n See [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__save\"></a>  IPersistStreamInitImpl::Save  \n Saves the object's properties to the specified stream.  \n  \n```\nSTDMETHOD(Save)(LPSTREAM pStm,  BOOL fClearDirty);\n```  \n  \n### Remarks  \n ATL uses the object's property map to store this information.  \n  \n See [IPersistStreamInit::Save](http://msdn.microsoft.com/library/windows/desktop/ms694439) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [Storages and Streams](http://msdn.microsoft.com/library/windows/desktop/aa380352)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}