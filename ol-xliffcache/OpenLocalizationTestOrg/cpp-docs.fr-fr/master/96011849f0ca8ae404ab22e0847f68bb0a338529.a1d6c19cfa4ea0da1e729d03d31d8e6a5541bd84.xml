{"nodes":[{"pos":[12,46],"content":"CStringData Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CStringData Class | Microsoft Docs","pos":[0,34]}]},{"pos":[641,658],"content":"CStringData Class","linkify":"CStringData Class","nodes":[{"content":"CStringData Class","pos":[0,17]}]},{"content":"This class represents the data of a string object.","pos":[659,709]},{"pos":[718,724],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[765,772],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[782,789],"content":"Methods","linkify":"Methods","nodes":[{"content":"Methods","pos":[0,7]}]},{"pos":[810,840],"content":"<bpt id=\"p1\">[</bpt>AddRef<ept id=\"p1\">](#cstringdata__addref)</ept>","source":"[AddRef](#cstringdata__addref)"},{"content":"Increments the reference count of the string data object.","pos":[841,898]},{"pos":[903,929],"content":"<bpt id=\"p1\">[</bpt>data<ept id=\"p1\">](#cstringdata__data)</ept>","source":"[data](#cstringdata__data)"},{"content":"Retrieves the character data of a string object.","pos":[930,978]},{"pos":[983,1017],"content":"<bpt id=\"p1\">[</bpt>IsLocked<ept id=\"p1\">](#cstringdata__islocked)</ept>","source":"[IsLocked](#cstringdata__islocked)"},{"content":"Determines if the buffer of the associated string object is locked.","pos":[1018,1085]},{"pos":[1090,1124],"content":"<bpt id=\"p1\">[</bpt>IsShared<ept id=\"p1\">](#cstringdata__isshared)</ept>","source":"[IsShared](#cstringdata__isshared)"},{"content":"Determines if the buffer of the associated string object is currently shared.","pos":[1125,1202]},{"pos":[1207,1233],"content":"<bpt id=\"p1\">[</bpt>Lock<ept id=\"p1\">](#cstringdata__lock)</ept>","source":"[Lock](#cstringdata__lock)"},{"content":"Locks the buffer of the associated string object.","pos":[1234,1283]},{"pos":[1288,1320],"content":"<bpt id=\"p1\">[</bpt>Release<ept id=\"p1\">](#cstringdata__release)</ept>","source":"[Release](#cstringdata__release)"},{"content":"Releases the specified string object.","pos":[1321,1358]},{"pos":[1363,1393],"content":"<bpt id=\"p1\">[</bpt>Unlock<ept id=\"p1\">](#cstringdata__unlock)</ept>","source":"[Unlock](#cstringdata__unlock)"},{"content":"Unlocks the buffer of the associated string object.","pos":[1394,1445]},{"pos":[1456,1468],"content":"Data Members","linkify":"Data Members","nodes":[{"content":"Data Members","pos":[0,12]}]},{"pos":[1489,1531],"content":"<bpt id=\"p1\">[</bpt>nAllocLength<ept id=\"p1\">](#cstringdata__nalloclength)</ept>","source":"[nAllocLength](#cstringdata__nalloclength)"},{"pos":[1532,1601],"content":"Length of allocated data in <ph id=\"ph1\">`XCHAR`</ph>s (not including terminating null)","source":"Length of allocated data in `XCHAR`s (not including terminating null)"},{"pos":[1606,1646],"content":"<bpt id=\"p1\">[</bpt>nDataLength<ept id=\"p1\">](#cstringdata__ndatalength)</ept>","source":"[nDataLength](#cstringdata__ndatalength)"},{"pos":[1647,1721],"content":"Length of currently used data in <ph id=\"ph1\">`XCHAR`</ph>s (not including terminating null)","source":"Length of currently used data in `XCHAR`s (not including terminating null)"},{"pos":[1726,1754],"content":"<bpt id=\"p1\">[</bpt>nRefs<ept id=\"p1\">](#cstringdata__nrefs)</ept>","source":"[nRefs](#cstringdata__nrefs)"},{"content":"The current reference count of the object.","pos":[1755,1797]},{"pos":[1802,1840],"content":"<bpt id=\"p1\">[</bpt>pStringMgr<ept id=\"p1\">](#cstringdata__pstringmgr)</ept>","source":"[pStringMgr](#cstringdata__pstringmgr)"},{"content":"A pointer to the string manager of this string object.","pos":[1841,1895]},{"pos":[1905,1912],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This class should only be used by developers implementing custom string managers.","pos":[1916,1997]},{"content":"For more information on custom string managers, see <bpt id=\"p1\">[</bpt>Memory Management and CStringT<ept id=\"p1\">](../../atl-mfc-shared/memory-management-with-cstringt.md)</ept>","pos":[1998,2139],"source":" For more information on custom string managers, see [Memory Management and CStringT](../../atl-mfc-shared/memory-management-with-cstringt.md)"},{"content":"This class encapsulates various types of information and data associated with a higher string object, such as <bpt id=\"p1\">[</bpt>CStringT<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept>, <bpt id=\"p2\">[</bpt>CSimpleStringT<ept id=\"p2\">](../../atl-mfc-shared/reference/csimplestringt-class.md)</ept>, or <bpt id=\"p3\">[</bpt>CFixedStringT<ept id=\"p3\">](../../atl-mfc-shared/reference/cfixedstringt-class.md)</ept> objects.","pos":[2146,2474],"source":"This class encapsulates various types of information and data associated with a higher string object, such as [CStringT](../../atl-mfc-shared/reference/cstringt-class.md), [CSimpleStringT](../../atl-mfc-shared/reference/csimplestringt-class.md), or [CFixedStringT](../../atl-mfc-shared/reference/cfixedstringt-class.md) objects."},{"content":"Every higher string object contains a pointer to its associated <ph id=\"ph1\">`CStringData`</ph> object, allowing multiple string objects to point to the same string data object.","pos":[2475,2634],"source":" Every higher string object contains a pointer to its associated `CStringData` object, allowing multiple string objects to point to the same string data object."},{"content":"This relationship is represented by the reference count ( <ph id=\"ph1\">`nRefs`</ph>) of the <ph id=\"ph2\">`CStringData`</ph> object.","pos":[2635,2730],"source":" This relationship is represented by the reference count ( `nRefs`) of the `CStringData` object."},{"pos":[2738,3009],"content":"[!NOTE]\n In certain cases, a string type (such as **CFixedString**) will not share a string data object with more than one higher string object. For more information on this, see [Memory Management and CStringT](../../atl-mfc-shared/memory-management-with-cstringt.md).","leadings":["","> "],"nodes":[{"content":" In certain cases, a string type (such as **CFixedString**) will not share a string data object with more than one higher string object. For more information on this, see [Memory Management and CStringT](../../atl-mfc-shared/memory-management-with-cstringt.md).","pos":[8,269],"nodes":[{"content":"In certain cases, a string type (such as <bpt id=\"p1\">**</bpt>CFixedString<ept id=\"p1\">**</ept>) will not share a string data object with more than one higher string object.","pos":[1,136],"source":" In certain cases, a string type (such as **CFixedString**) will not share a string data object with more than one higher string object."},{"content":"For more information on this, see <bpt id=\"p1\">[</bpt>Memory Management and CStringT<ept id=\"p1\">](../../atl-mfc-shared/memory-management-with-cstringt.md)</ept>.","pos":[137,261],"source":" For more information on this, see [Memory Management and CStringT](../../atl-mfc-shared/memory-management-with-cstringt.md)."}]}]},{"content":"This data is composed of:","pos":[3016,3041]},{"pos":[3051,3165],"content":"The memory manager (of type <bpt id=\"p1\">[</bpt>IAtlStringMgr<ept id=\"p1\">](../../atl-mfc-shared/reference/iatlstringmgr-class.md)</ept>) of the string.","source":"The memory manager (of type [IAtlStringMgr](../../atl-mfc-shared/reference/iatlstringmgr-class.md)) of the string."},{"pos":[3175,3252],"content":"The current length ( <bpt id=\"p1\">[</bpt>nDataLength<ept id=\"p1\">](#cstringdata__ndatalength)</ept>) of the string.","source":"The current length ( [nDataLength](#cstringdata__ndatalength)) of the string."},{"content":"The allocated length ( <bpt id=\"p1\">[</bpt>nAllocLength<ept id=\"p1\">](#cstringdata__nalloclength)</ept>) of the string.","pos":[3262,3343],"source":"The allocated length ( [nAllocLength](#cstringdata__nalloclength)) of the string."},{"content":"For performance reasons, this can differ from the current string length","pos":[3344,3415]},{"content":"The current reference count ( <bpt id=\"p1\">[</bpt>nRefs<ept id=\"p1\">](#cstringdata__nrefs)</ept>) of the <ph id=\"ph1\">`CStringData`</ph> object.","pos":[3425,3513],"source":"The current reference count ( [nRefs](#cstringdata__nrefs)) of the `CStringData` object."},{"content":"This value is used in determining how many string objects are sharing the same <ph id=\"ph1\">`CStringData`</ph> object.","pos":[3514,3614],"source":" This value is used in determining how many string objects are sharing the same `CStringData` object."},{"pos":[3624,3696],"content":"The actual character buffer ( <bpt id=\"p1\">[</bpt>data<ept id=\"p1\">](#cstringdata__data)</ept>) of the string.","source":"The actual character buffer ( [data](#cstringdata__data)) of the string."},{"pos":[3708,3851],"content":"[!NOTE]\nThe actual character buffer of the string object is allocated by the string manager and is appended to the `CStringData` object.","leadings":["","    >  "],"nodes":[{"content":"The actual character buffer of the string object is allocated by the string manager and is appended to the <ph id=\"ph1\">`CStringData`</ph> object.","pos":[8,136],"source":"The actual character buffer of the string object is allocated by the string manager and is appended to the `CStringData` object."}]},{"pos":[3860,3872],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3876,3900],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlsimpstr.h","source":"**Header:** atlsimpstr.h"},{"pos":[3910,3965],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__addref\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::AddRef","linkify":"<a name=\"cstringdata__addref\"></a>  CStringData::AddRef","source":"<a name=\"cstringdata__addref\"></a>  CStringData::AddRef"},{"content":"Increments the reference count of the string object.","pos":[3969,4021]},{"pos":[4067,4074],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Increments the reference count of the string object.","pos":[4078,4130]},{"pos":[4138,4284],"content":"[!NOTE]\n Do not call this method on a string with a negative reference count, since a negative count indicates that the string buffer is locked.","leadings":["","> "],"nodes":[{"content":"Do not call this method on a string with a negative reference count, since a negative count indicates that the string buffer is locked.","pos":[9,144]}]},{"pos":[4294,4345],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__data\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::data","linkify":"<a name=\"cstringdata__data\"></a>  CStringData::data","source":"<a name=\"cstringdata__data\"></a>  CStringData::data"},{"content":"Returns a pointer to the character buffer of a string object.","pos":[4349,4410]},{"pos":[4455,4467],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to the character buffer of the string object.","pos":[4471,4526]},{"pos":[4536,4543],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to return the current character buffer of the associated string object.","pos":[4547,4637]},{"pos":[4645,4817],"content":"[!NOTE]\n This buffer is not allocated by the `CStringData` object but by the string manager when needed. When allocated, the buffer is appended to the string data object.","leadings":["","> "],"nodes":[{"content":" This buffer is not allocated by the `CStringData` object but by the string manager when needed. When allocated, the buffer is appended to the string data object.","pos":[8,170],"nodes":[{"content":"This buffer is not allocated by the <ph id=\"ph1\">`CStringData`</ph> object but by the string manager when needed.","pos":[1,96],"source":" This buffer is not allocated by the `CStringData` object but by the string manager when needed."},{"content":"When allocated, the buffer is appended to the string data object.","pos":[97,162]}]}]},{"pos":[4827,4886],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__islocked\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::IsLocked","linkify":"<a name=\"cstringdata__islocked\"></a>  CStringData::IsLocked","source":"<a name=\"cstringdata__islocked\"></a>  CStringData::IsLocked"},{"content":"Determines if the character buffer is locked.","pos":[4890,4935]},{"pos":[4989,5001],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[5005,5067],"content":"Returns <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> if the buffer is locked; otherwise <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept>.","source":"Returns **true** if the buffer is locked; otherwise **false**."},{"pos":[5077,5084],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to determine if the character buffer of a string object is currently locked.","pos":[5088,5183]},{"pos":[5193,5252],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__isshared\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::IsShared","linkify":"<a name=\"cstringdata__isshared\"></a>  CStringData::IsShared","source":"<a name=\"cstringdata__isshared\"></a>  CStringData::IsShared"},{"content":"Determines if the character buffer is shared.","pos":[5256,5301]},{"pos":[5355,5367],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[5371,5433],"content":"Returns <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> if the buffer is shared; otherwise <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept>.","source":"Returns **true** if the buffer is shared; otherwise **false**."},{"pos":[5443,5450],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to determine if the character buffer of a string data object is currently shared among multiple string objects.","pos":[5454,5584]},{"pos":[5594,5645],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__lock\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::Lock","linkify":"<a name=\"cstringdata__lock\"></a>  CStringData::Lock","source":"<a name=\"cstringdata__lock\"></a>  CStringData::Lock"},{"content":"Locks the character buffer of the associated string object.","pos":[5649,5708]},{"pos":[5752,5759],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to lock the character buffer of the string data object.","pos":[5763,5837]},{"content":"Locking and unlocking is used when direct access to the character buffer is required by the developer.","pos":[5838,5940]},{"content":"A good example of locking is demonstrated by the <bpt id=\"p1\">[</bpt>LockBuffer<ept id=\"p1\">](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__lockbuffer)</ept> and <bpt id=\"p2\">[</bpt>UnlockBuffer<ept id=\"p2\">](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__unlockbuffer)</ept> methods of <ph id=\"ph1\">`CSimpleStringT`</ph>.","pos":[5941,6218],"source":" A good example of locking is demonstrated by the [LockBuffer](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__lockbuffer) and [UnlockBuffer](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__unlockbuffer) methods of `CSimpleStringT`."},{"pos":[6226,6331],"content":"[!NOTE]\n A character buffer can only be locked if the buffer is not shared among higher string objects.","leadings":["","> "],"nodes":[{"content":"A character buffer can only be locked if the buffer is not shared among higher string objects.","pos":[9,103]}]},{"pos":[6341,6408],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__nalloclength\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::nAllocLength","linkify":"<a name=\"cstringdata__nalloclength\"></a>  CStringData::nAllocLength","source":"<a name=\"cstringdata__nalloclength\"></a>  CStringData::nAllocLength"},{"content":"Length of the allocated character buffer.","pos":[6412,6453]},{"pos":[6494,6501],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6505,6597],"content":"Stores the length of the allocated data buffer in <ph id=\"ph1\">`XCHAR`</ph>s (not including terminating null).","source":"Stores the length of the allocated data buffer in `XCHAR`s (not including terminating null)."},{"pos":[6607,6672],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__ndatalength\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::nDataLength","linkify":"<a name=\"cstringdata__ndatalength\"></a>  CStringData::nDataLength","source":"<a name=\"cstringdata__ndatalength\"></a>  CStringData::nDataLength"},{"content":"Current length of the string object.","pos":[6676,6712]},{"pos":[6752,6759],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6763,6849],"content":"Stores the length of currently used data in <ph id=\"ph1\">`XCHAR`</ph>s (not including terminating null).","source":"Stores the length of currently used data in `XCHAR`s (not including terminating null)."},{"pos":[6859,6912],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__nrefs\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::nRefs","linkify":"<a name=\"cstringdata__nrefs\"></a>  CStringData::nRefs","source":"<a name=\"cstringdata__nrefs\"></a>  CStringData::nRefs"},{"content":"Reference count of the string data object.","pos":[6916,6958]},{"pos":[6993,7000],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Stores the reference count of the string data object.","pos":[7004,7057]},{"content":"This count indicates the number of higher string objects that are associated with the string data object.","pos":[7058,7163]},{"content":"A negative value indicates that the string data object is currently locked.","pos":[7164,7239]},{"pos":[7249,7312],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__pstringmgr\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::pStringMgr","linkify":"<a name=\"cstringdata__pstringmgr\"></a>  CStringData::pStringMgr","source":"<a name=\"cstringdata__pstringmgr\"></a>  CStringData::pStringMgr"},{"content":"The memory manager of the associated string object.","pos":[7316,7367]},{"pos":[7417,7424],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Stores the memory manager for the associated string object.","pos":[7428,7487]},{"content":"For more information on memory managers and strings, see <bpt id=\"p1\">[</bpt>Memory Management and CStringT<ept id=\"p1\">](../../atl-mfc-shared/memory-management-with-cstringt.md)</ept>.","pos":[7488,7635],"source":" For more information on memory managers and strings, see [Memory Management and CStringT](../../atl-mfc-shared/memory-management-with-cstringt.md)."},{"pos":[7645,7702],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__release\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::Release","linkify":"<a name=\"cstringdata__release\"></a>  CStringData::Release","source":"<a name=\"cstringdata__release\"></a>  CStringData::Release"},{"content":"Decrements the reference count of the string data object.","pos":[7706,7763]},{"pos":[7810,7817],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to decrement the reference count, freeing the <ph id=\"ph1\">`CStringData`</ph> structure if the reference count hits zero.","pos":[7821,7943],"source":"Call this function to decrement the reference count, freeing the `CStringData` structure if the reference count hits zero."},{"content":"This is commonly done when a string object is deleted, and therefore no longer needs to reference the string data object.","pos":[7944,8065]},{"pos":[8072,8188],"content":"For example, the following code would call <ph id=\"ph1\">`CStringData::Release`</ph> for the string data object associated with <ph id=\"ph2\">`str1`</ph>:","source":"For example, the following code would call `CStringData::Release` for the string data object associated with `str1`:"},{"pos":[8195,8294],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_ATLMFC_Utilities#104<ept id=\"p2\">](../../atl-mfc-shared/codesnippet/cpp/cstringdata-class_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_ATLMFC_Utilities#104](../../atl-mfc-shared/codesnippet/cpp/cstringdata-class_1.cpp)]"},{"pos":[8304,8359],"content":"<bpt id=\"p1\">&lt;a name=\"cstringdata__unlock\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CStringData::Unlock","linkify":"<a name=\"cstringdata__unlock\"></a>  CStringData::Unlock","source":"<a name=\"cstringdata__unlock\"></a>  CStringData::Unlock"},{"content":"Unlocks the character buffer of the associated string object.","pos":[8363,8424]},{"pos":[8470,8477],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to unlock the character buffer of the string data object.","pos":[8481,8557]},{"content":"Once a buffer is unlocked, it is shareable and can be reference counted.","pos":[8558,8630]},{"pos":[8638,8721],"content":"[!NOTE]\n Each call to `Lock` must be matched by a corresponding call to `Unlock`.","leadings":["","> "],"nodes":[{"content":"Each call to <ph id=\"ph1\">`Lock`</ph> must be matched by a corresponding call to <ph id=\"ph2\">`Unlock`</ph>.","pos":[9,81],"source":" Each call to `Lock` must be matched by a corresponding call to `Unlock`."}]},{"content":"Locking and unlocking is used when the developer must ensure that the string data not be shared.","pos":[8728,8824]},{"content":"A good example of locking is demonstrated by the <bpt id=\"p1\">[</bpt>LockBuffer<ept id=\"p1\">](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__lockbuffer)</ept> and <bpt id=\"p2\">[</bpt>UnlockBuffer<ept id=\"p2\">](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__unlockbuffer)</ept> methods of <ph id=\"ph1\">`CSimpleStringT`</ph>.","pos":[8825,9102],"source":" A good example of locking is demonstrated by the [LockBuffer](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__lockbuffer) and [UnlockBuffer](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__unlockbuffer) methods of `CSimpleStringT`."},{"pos":[9111,9119],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[9123,9171],"source":"[Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>ATL/MFC Shared Classes<ept id=\"p1\">](../../atl-mfc-shared/atl-mfc-shared-classes.md)</ept>","pos":[9174,9247],"source":" [ATL/MFC Shared Classes](../../atl-mfc-shared/atl-mfc-shared-classes.md)"}],"content":"---\ntitle: \"CStringData Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CStringData\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CStringData class\"\n  - \"shared classes, CStringData\"\nms.assetid: 4e31b5ca-3dbe-4fd5-b692-8211fbfb2593\ncaps.latest.revision: 16\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CStringData Class\nThis class represents the data of a string object.  \n  \n## Syntax  \n  \n```\nstruct CStringData\n```  \n  \n## Members  \n  \n### Methods  \n  \n|||  \n|-|-|  \n|[AddRef](#cstringdata__addref)|Increments the reference count of the string data object.|  \n|[data](#cstringdata__data)|Retrieves the character data of a string object.|  \n|[IsLocked](#cstringdata__islocked)|Determines if the buffer of the associated string object is locked.|  \n|[IsShared](#cstringdata__isshared)|Determines if the buffer of the associated string object is currently shared.|  \n|[Lock](#cstringdata__lock)|Locks the buffer of the associated string object.|  \n|[Release](#cstringdata__release)|Releases the specified string object.|  \n|[Unlock](#cstringdata__unlock)|Unlocks the buffer of the associated string object.|  \n  \n### Data Members  \n  \n|||  \n|-|-|  \n|[nAllocLength](#cstringdata__nalloclength)|Length of allocated data in `XCHAR`s (not including terminating null)|  \n|[nDataLength](#cstringdata__ndatalength)|Length of currently used data in `XCHAR`s (not including terminating null)|  \n|[nRefs](#cstringdata__nrefs)|The current reference count of the object.|  \n|[pStringMgr](#cstringdata__pstringmgr)|A pointer to the string manager of this string object.|  \n  \n## Remarks  \n This class should only be used by developers implementing custom string managers. For more information on custom string managers, see [Memory Management and CStringT](../../atl-mfc-shared/memory-management-with-cstringt.md)  \n  \n This class encapsulates various types of information and data associated with a higher string object, such as [CStringT](../../atl-mfc-shared/reference/cstringt-class.md), [CSimpleStringT](../../atl-mfc-shared/reference/csimplestringt-class.md), or [CFixedStringT](../../atl-mfc-shared/reference/cfixedstringt-class.md) objects. Every higher string object contains a pointer to its associated `CStringData` object, allowing multiple string objects to point to the same string data object. This relationship is represented by the reference count ( `nRefs`) of the `CStringData` object.  \n  \n> [!NOTE]\n>  In certain cases, a string type (such as **CFixedString**) will not share a string data object with more than one higher string object. For more information on this, see [Memory Management and CStringT](../../atl-mfc-shared/memory-management-with-cstringt.md).  \n  \n This data is composed of:  \n  \n-   The memory manager (of type [IAtlStringMgr](../../atl-mfc-shared/reference/iatlstringmgr-class.md)) of the string.  \n  \n-   The current length ( [nDataLength](#cstringdata__ndatalength)) of the string.  \n  \n-   The allocated length ( [nAllocLength](#cstringdata__nalloclength)) of the string. For performance reasons, this can differ from the current string length  \n  \n-   The current reference count ( [nRefs](#cstringdata__nrefs)) of the `CStringData` object. This value is used in determining how many string objects are sharing the same `CStringData` object.  \n  \n-   The actual character buffer ( [data](#cstringdata__data)) of the string.  \n  \n    > [!NOTE]\n    >  The actual character buffer of the string object is allocated by the string manager and is appended to the `CStringData` object.  \n  \n## Requirements  \n **Header:** atlsimpstr.h  \n  \n##  <a name=\"cstringdata__addref\"></a>  CStringData::AddRef  \n Increments the reference count of the string object.  \n  \n```\nvoid AddRef() throw();\n```  \n  \n### Remarks  \n Increments the reference count of the string object.  \n  \n> [!NOTE]\n>  Do not call this method on a string with a negative reference count, since a negative count indicates that the string buffer is locked.  \n  \n##  <a name=\"cstringdata__data\"></a>  CStringData::data  \n Returns a pointer to the character buffer of a string object.  \n  \n```\nvoid* data() throw();\n```  \n  \n### Return Value  \n A pointer to the character buffer of the string object.  \n  \n### Remarks  \n Call this function to return the current character buffer of the associated string object.  \n  \n> [!NOTE]\n>  This buffer is not allocated by the `CStringData` object but by the string manager when needed. When allocated, the buffer is appended to the string data object.  \n  \n##  <a name=\"cstringdata__islocked\"></a>  CStringData::IsLocked  \n Determines if the character buffer is locked.  \n  \n```\nbool IsLocked() const throw();\n```  \n  \n### Return Value  \n Returns **true** if the buffer is locked; otherwise **false**.  \n  \n### Remarks  \n Call this function to determine if the character buffer of a string object is currently locked.  \n  \n##  <a name=\"cstringdata__isshared\"></a>  CStringData::IsShared  \n Determines if the character buffer is shared.  \n  \n```\nbool IsShared() const throw();\n```  \n  \n### Return Value  \n Returns **true** if the buffer is shared; otherwise **false**.  \n  \n### Remarks  \n Call this function to determine if the character buffer of a string data object is currently shared among multiple string objects.  \n  \n##  <a name=\"cstringdata__lock\"></a>  CStringData::Lock  \n Locks the character buffer of the associated string object.  \n  \n```\nvoid Lock() throw();\n```  \n  \n### Remarks  \n Call this function to lock the character buffer of the string data object. Locking and unlocking is used when direct access to the character buffer is required by the developer. A good example of locking is demonstrated by the [LockBuffer](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__lockbuffer) and [UnlockBuffer](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__unlockbuffer) methods of `CSimpleStringT`.  \n  \n> [!NOTE]\n>  A character buffer can only be locked if the buffer is not shared among higher string objects.  \n  \n##  <a name=\"cstringdata__nalloclength\"></a>  CStringData::nAllocLength  \n Length of the allocated character buffer.  \n  \n```\nint nAllocLength;\n```  \n  \n### Remarks  \n Stores the length of the allocated data buffer in `XCHAR`s (not including terminating null).  \n  \n##  <a name=\"cstringdata__ndatalength\"></a>  CStringData::nDataLength  \n Current length of the string object.  \n  \n```\nint nDataLength;\n```  \n  \n### Remarks  \n Stores the length of currently used data in `XCHAR`s (not including terminating null).  \n  \n##  <a name=\"cstringdata__nrefs\"></a>  CStringData::nRefs  \n Reference count of the string data object.  \n  \n```\nlong nRefs;\n```  \n  \n### Remarks  \n Stores the reference count of the string data object. This count indicates the number of higher string objects that are associated with the string data object. A negative value indicates that the string data object is currently locked.  \n  \n##  <a name=\"cstringdata__pstringmgr\"></a>  CStringData::pStringMgr  \n The memory manager of the associated string object.  \n  \n```\nIAtlStringMgr* pStringMgr;\n```  \n  \n### Remarks  \n Stores the memory manager for the associated string object. For more information on memory managers and strings, see [Memory Management and CStringT](../../atl-mfc-shared/memory-management-with-cstringt.md).  \n  \n##  <a name=\"cstringdata__release\"></a>  CStringData::Release  \n Decrements the reference count of the string data object.  \n  \n```\nvoid Release() throw();\n```  \n  \n### Remarks  \n Call this function to decrement the reference count, freeing the `CStringData` structure if the reference count hits zero. This is commonly done when a string object is deleted, and therefore no longer needs to reference the string data object.  \n  \n For example, the following code would call `CStringData::Release` for the string data object associated with `str1`:  \n  \n [!code-cpp[NVC_ATLMFC_Utilities#104](../../atl-mfc-shared/codesnippet/cpp/cstringdata-class_1.cpp)]  \n  \n##  <a name=\"cstringdata__unlock\"></a>  CStringData::Unlock  \n Unlocks the character buffer of the associated string object.  \n  \n```\nvoid Unlock() throw();\n```  \n  \n### Remarks  \n Call this function to unlock the character buffer of the string data object. Once a buffer is unlocked, it is shareable and can be reference counted.  \n  \n> [!NOTE]\n>  Each call to `Lock` must be matched by a corresponding call to `Unlock`.  \n  \n Locking and unlocking is used when the developer must ensure that the string data not be shared. A good example of locking is demonstrated by the [LockBuffer](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__lockbuffer) and [UnlockBuffer](../../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__unlockbuffer) methods of `CSimpleStringT`.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [ATL/MFC Shared Classes](../../atl-mfc-shared/atl-mfc-shared-classes.md)\n\n\n"}