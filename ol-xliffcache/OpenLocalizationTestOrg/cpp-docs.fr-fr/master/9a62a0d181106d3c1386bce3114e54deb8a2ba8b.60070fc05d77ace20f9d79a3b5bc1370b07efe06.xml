{"nodes":[{"pos":[12,46],"content":"CRecordView Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CRecordView Class | Microsoft Docs","pos":[0,34]}]},{"pos":[692,709],"content":"CRecordView Class","linkify":"CRecordView Class","nodes":[{"content":"CRecordView Class","pos":[0,17]}]},{"content":"A view that displays database records in controls.","pos":[710,760]},{"pos":[769,775],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[851,858],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[868,890],"content":"Protected Constructors","linkify":"Protected Constructors","nodes":[{"content":"Protected Constructors","pos":[0,22]}]},{"content":"Name","pos":[897,901]},{"content":"Description","pos":[902,913]},{"pos":[951,1004],"content":"<bpt id=\"p1\">[</bpt>CRecordView::CRecordView<ept id=\"p1\">](#crecordview__crecordview)</ept>","source":"[CRecordView::CRecordView](#crecordview__crecordview)"},{"pos":[1005,1039],"content":"Constructs a <ph id=\"ph1\">`CRecordView`</ph> object.","source":"Constructs a `CRecordView` object."},{"pos":[1050,1064],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1071,1075]},{"content":"Description","pos":[1076,1087]},{"pos":[1125,1186],"content":"<bpt id=\"p1\">[</bpt>CRecordView::IsOnFirstRecord<ept id=\"p1\">](#crecordview__isonfirstrecord)</ept>","source":"[CRecordView::IsOnFirstRecord](#crecordview__isonfirstrecord)"},{"content":"Returns nonzero if the current record is the first record in the associated recordset.","pos":[1187,1273]},{"pos":[1278,1337],"content":"<bpt id=\"p1\">[</bpt>CRecordView::IsOnLastRecord<ept id=\"p1\">](#crecordview__isonlastrecord)</ept>","source":"[CRecordView::IsOnLastRecord](#crecordview__isonlastrecord)"},{"content":"Returns nonzero if the current record is the last record in the associated recordset.","pos":[1338,1423]},{"pos":[1428,1487],"content":"<bpt id=\"p1\">[</bpt>CRecordView::OnGetRecordset<ept id=\"p1\">](#crecordview__ongetrecordset)</ept>","source":"[CRecordView::OnGetRecordset](#crecordview__ongetrecordset)"},{"content":"Returns a pointer to an object of a class derived from <ph id=\"ph1\">`CRecordset`</ph>.","pos":[1488,1556],"source":"Returns a pointer to an object of a class derived from `CRecordset`."},{"content":"ClassWizard overrides this function for you and creates the recordset if necessary.","pos":[1557,1640]},{"pos":[1645,1688],"content":"<bpt id=\"p1\">[</bpt>CRecordView::OnMove<ept id=\"p1\">](#crecordview__onmove)</ept>","source":"[CRecordView::OnMove](#crecordview__onmove)"},{"pos":[1700,1717],"content":"Protected Methods","linkify":"Protected Methods","nodes":[{"content":"Protected Methods","pos":[0,17]}]},{"content":"Name","pos":[1724,1728]},{"content":"Description","pos":[1729,1740]},{"pos":[1778,1821],"content":"<bpt id=\"p1\">[</bpt>CRecordView::OnMove<ept id=\"p1\">](#crecordview__onmove)</ept>","source":"[CRecordView::OnMove](#crecordview__onmove)"},{"content":"If the current record has changed, updates it on the data source, then moves to the specified record (next, previous, first, or last).","pos":[1822,1956]},{"pos":[1966,1973],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The view is a form view directly connected to a <ph id=\"ph1\">`CRecordset`</ph> object.","pos":[1977,2045],"source":"The view is a form view directly connected to a `CRecordset` object."},{"content":"The view is created from a dialog template resource and displays the fields of the <ph id=\"ph1\">`CRecordset`</ph> object in the dialog template's controls.","pos":[2046,2183],"source":" The view is created from a dialog template resource and displays the fields of the `CRecordset` object in the dialog template's controls."},{"content":"The <ph id=\"ph1\">`CRecordView`</ph> object uses dialog data exchange (DDX) and record field exchange (RFX) to automate the movement of data between the controls on the form and the fields of the recordset.","pos":[2184,2371],"source":" The `CRecordView` object uses dialog data exchange (DDX) and record field exchange (RFX) to automate the movement of data between the controls on the form and the fields of the recordset."},{"content":"<ph id=\"ph1\">`CRecordView`</ph> also supplies a default implementation for moving to the first, next, previous, or last record and an interface for updating the record currently on view.","pos":[2372,2540],"source":"`CRecordView` also supplies a default implementation for moving to the first, next, previous, or last record and an interface for updating the record currently on view."},{"pos":[2548,2879],"content":"[!NOTE]\n If you are working with the Data Access Objects (DAO) classes rather than the Open Database Connectivity (ODBC) classes, use class [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) instead. For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md).","leadings":["","> "],"nodes":[{"content":" If you are working with the Data Access Objects (DAO) classes rather than the Open Database Connectivity (ODBC) classes, use class [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) instead. For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md).","pos":[8,329],"nodes":[{"content":"If you are working with the Data Access Objects (DAO) classes rather than the Open Database Connectivity (ODBC) classes, use class <bpt id=\"p1\">[</bpt>CDaoRecordView<ept id=\"p1\">](../../mfc/reference/cdaorecordview-class.md)</ept> instead.","pos":[1,202],"source":" If you are working with the Data Access Objects (DAO) classes rather than the Open Database Connectivity (ODBC) classes, use class [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) instead."},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Overview: Database Programming<ept id=\"p1\">](../../data/data-access-programming-mfc-atl.md)</ept>.","pos":[203,321],"source":" For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md)."}]}]},{"content":"The most common way to create your record view is with the Application Wizard.","pos":[2886,2964]},{"content":"Tge Application Wizard creates both the record view class and its associated recordset class as part of your skeleton starter application.","pos":[2965,3103]},{"content":"If you don't create the record view class with the Application Wizard, you can create it later with ClassWizard.","pos":[3104,3216]},{"content":"If you simply need a single form, the Application Wizard approach is easier.","pos":[3217,3293]},{"content":"ClassWizard lets you decide to use a record view later in the development process.","pos":[3294,3376]},{"content":"Using ClassWizard to create a record view and a recordset separately and then connect them is the most flexible approach because it gives you more control in naming the recordset class and its .H/.CPP files.","pos":[3377,3584]},{"content":"This approach also lets you have multiple record views on the same recordset class.","pos":[3585,3668]},{"content":"To make it easy for end-users to move from record to record in the record view, the Application Wizard creates menu (and optionally toolbar) resources for moving to the first, next, previous, or last record.","pos":[3675,3882]},{"content":"If you create a record view class with ClassWizard, you need to create these resources yourself with the menu and bitmap editors.","pos":[3883,4012]},{"pos":[4019,4234],"content":"For information about the default implementation for moving from record to record, see <ph id=\"ph1\">`IsOnFirstRecord`</ph> and <ph id=\"ph2\">`IsOnLastRecord`</ph> and the article <bpt id=\"p1\">[</bpt>Using a Record View<ept id=\"p1\">](../../data/using-a-record-view-mfc-data-access.md)</ept>.","source":"For information about the default implementation for moving from record to record, see `IsOnFirstRecord` and `IsOnLastRecord` and the article [Using a Record View](../../data/using-a-record-view-mfc-data-access.md)."},{"content":"<ph id=\"ph1\">`CRecordView`</ph> keeps track of the user's position in the recordset so that the record view can update the user interface.","pos":[4241,4361],"source":"`CRecordView` keeps track of the user's position in the recordset so that the record view can update the user interface."},{"content":"When the user moves to either end of the recordset, the record view disables user interface objects — such as menu items or toolbar buttons — for moving further in the same direction.","pos":[4362,4545]},{"content":"For more information about declaring and using your record view and recordset classes, see \"Designing and Creating a Record View\" in the article <bpt id=\"p1\">[</bpt>Record Views<ept id=\"p1\">](../../data/record-views-mfc-data-access.md)</ept>.","pos":[4552,4756],"source":"For more information about declaring and using your record view and recordset classes, see \"Designing and Creating a Record View\" in the article [Record Views](../../data/record-views-mfc-data-access.md)."},{"content":"For more information about how record views work and how to use them, see the article <bpt id=\"p1\">[</bpt>Using a Record View<ept id=\"p1\">](../../data/using-a-record-view-mfc-data-access.md)</ept>.","pos":[4757,4916],"source":" For more information about how record views work and how to use them, see the article [Using a Record View](../../data/using-a-record-view-mfc-data-access.md)."},{"pos":[4925,4946],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[4950,4997],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[5004,5057],"content":"<bpt id=\"p1\">[</bpt>CCmdTarget<ept id=\"p1\">](../../mfc/reference/ccmdtarget-class.md)</ept>","source":"[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)"},{"pos":[5064,5105],"content":"<bpt id=\"p1\">[</bpt>CWnd<ept id=\"p1\">](../../mfc/reference/cwnd-class.md)</ept>","source":"[CWnd](../../mfc/reference/cwnd-class.md)"},{"pos":[5112,5155],"content":"<bpt id=\"p1\">[</bpt>CView<ept id=\"p1\">](../../mfc/reference/cview-class.md)</ept>","source":"[CView](../../mfc/reference/cview-class.md)"},{"pos":[5162,5217],"content":"<bpt id=\"p1\">[</bpt>CScrollView<ept id=\"p1\">](../../mfc/reference/cscrollview-class.md)</ept>","source":"[CScrollView](../../mfc/reference/cscrollview-class.md)"},{"pos":[5224,5275],"content":"<bpt id=\"p1\">[</bpt>CFormView<ept id=\"p1\">](../../mfc/reference/cformview-class.md)</ept>","source":"[CFormView](../../mfc/reference/cformview-class.md)"},{"pos":[5304,5316],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[5320,5339],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdb.h","source":"**Header:** afxdb.h"},{"pos":[5349,5414],"content":"<bpt id=\"p1\">&lt;a name=\"crecordview__crecordview\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CRecordView::CRecordView","linkify":"<a name=\"crecordview__crecordview\"></a>  CRecordView::CRecordView","source":"<a name=\"crecordview__crecordview\"></a>  CRecordView::CRecordView"},{"pos":[5418,5608],"content":"When you create an object of a type derived from <ph id=\"ph1\">`CRecordView`</ph>, call either form of the constructor to initialize the view object and identify the dialog resource on which the view is based.","source":"When you create an object of a type derived from `CRecordView`, call either form of the constructor to initialize the view object and identify the dialog resource on which the view is based."},{"pos":[5724,5734],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Contains a null-terminated string that is the name of a dialog template resource.","pos":[5760,5841]},{"content":"Contains the ID number of a dialog template resource.","pos":[5865,5918]},{"pos":[5928,5935],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can either identify the resource by name (pass a string as the argument to the constructor) or by its ID (pass an unsigned integer as the argument).","pos":[5939,6091]},{"content":"Using a resource ID is recommended.","pos":[6092,6127]},{"pos":[6135,6365],"content":"[!NOTE]\n Your derived class *must* supply its own constructor. In the constructor of your derived class, call the constructor `CRecordView::CRecordView` with the resource name or ID as an argument, as shown in the example below.","leadings":["","> "],"nodes":[{"content":" Your derived class *must* supply its own constructor. In the constructor of your derived class, call the constructor `CRecordView::CRecordView` with the resource name or ID as an argument, as shown in the example below.","pos":[8,228],"nodes":[{"content":"Your derived class <bpt id=\"p1\">*</bpt>must<ept id=\"p1\">*</ept> supply its own constructor.","pos":[1,54],"source":" Your derived class *must* supply its own constructor."},{"content":"In the constructor of your derived class, call the constructor <ph id=\"ph1\">`CRecordView::CRecordView`</ph> with the resource name or ID as an argument, as shown in the example below.","pos":[55,220],"source":" In the constructor of your derived class, call the constructor `CRecordView::CRecordView` with the resource name or ID as an argument, as shown in the example below."}]}]},{"content":"<bpt id=\"p1\">**</bpt>CRecordView::OnInitialUpdate<ept id=\"p1\">**</ept> calls <ph id=\"ph1\">`UpdateData`</ph>, which calls <ph id=\"ph2\">`DoDataExchange`</ph>.","pos":[6372,6454],"source":"**CRecordView::OnInitialUpdate** calls `UpdateData`, which calls `DoDataExchange`."},{"content":"This initial call to <ph id=\"ph1\">`DoDataExchange`</ph> connects <ph id=\"ph2\">`CRecordView`</ph> controls (indirectly) to <ph id=\"ph3\">`CRecordset`</ph> field data members created by ClassWizard.","pos":[6455,6596],"source":" This initial call to `DoDataExchange` connects `CRecordView` controls (indirectly) to `CRecordset` field data members created by ClassWizard."},{"content":"These data members cannot be used until after you call the base class <bpt id=\"p1\">**</bpt>CFormView::OnInitialUpdate<ept id=\"p1\">**</ept> member function.","pos":[6597,6714],"source":" These data members cannot be used until after you call the base class **CFormView::OnInitialUpdate** member function."},{"pos":[6722,6917],"content":"[!NOTE]\n If you use ClassWizard, the wizard defines an `enum` value `CRecordView::IDD`, specifies it in the class declaration, and uses it in the member initialization list for the constructor.","leadings":["","> "],"nodes":[{"content":"If you use ClassWizard, the wizard defines an <ph id=\"ph1\">`enum`</ph> value <ph id=\"ph2\">`CRecordView::IDD`</ph>, specifies it in the class declaration, and uses it in the member initialization list for the constructor.","pos":[9,193],"source":" If you use ClassWizard, the wizard defines an `enum` value `CRecordView::IDD`, specifies it in the class declaration, and uses it in the member initialization list for the constructor."}]},{"pos":[6927,6934],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[6938,7020],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCDatabase#32<ept id=\"p2\">](../../mfc/codesnippet/cpp/crecordview-class_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCDatabase#32](../../mfc/codesnippet/cpp/crecordview-class_1.cpp)]"},{"pos":[7030,7103],"content":"<bpt id=\"p1\">&lt;a name=\"crecordview__isonfirstrecord\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CRecordView::IsOnFirstRecord","linkify":"<a name=\"crecordview__isonfirstrecord\"></a>  CRecordView::IsOnFirstRecord","source":"<a name=\"crecordview__isonfirstrecord\"></a>  CRecordView::IsOnFirstRecord"},{"content":"Call this member function to determine whether the current record is the first record in the recordset object associated with this record view.","pos":[7107,7250]},{"pos":[7299,7311],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the current record is the first record in the recordset; otherwise 0.","pos":[7315,7395]},{"pos":[7405,7412],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function is useful for writing your own implementations of default command update handlers written by ClassWizard.","pos":[7416,7535]},{"content":"If the user moves to the first record, the framework disables any user interface objects you have for moving to the first or the previous record.","pos":[7542,7687]},{"pos":[7697,7768],"content":"<bpt id=\"p1\">&lt;a name=\"crecordview__isonlastrecord\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CRecordView::IsOnLastRecord","linkify":"<a name=\"crecordview__isonlastrecord\"></a>  CRecordView::IsOnLastRecord","source":"<a name=\"crecordview__isonlastrecord\"></a>  CRecordView::IsOnLastRecord"},{"content":"Call this member function to determine whether the current record is the last record in the recordset object associated with this record view.","pos":[7772,7914]},{"pos":[7962,7974],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the current record is the last record in the recordset; otherwise 0.","pos":[7978,8057]},{"pos":[8067,8074],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function is useful for writing your own implementations of the default command update handlers that ClassWizard writes to support a user interface for moving from record to record.","pos":[8078,8263]},{"pos":[8271,8951],"content":"[!CAUTION]\n The result of this function is reliable except that the view cannot detect the end of the recordset until the user has moved past it. The user must move beyond the last record before the record view can tell that it must disable any user interface objects for moving to the next or last record. If the user moves past the last record and then moves back to the last record (or before it), the record view can track the user's position in the recordset and disable user interface objects correctly. `IsOnLastRecord` is also unreliable after a call to the implementation function **OnRecordLast**, which handles the `ID_RECORD_LAST` command, or `CRecordset::MoveLast`.","leadings":["","> "],"nodes":[{"content":" The result of this function is reliable except that the view cannot detect the end of the recordset until the user has moved past it. The user must move beyond the last record before the record view can tell that it must disable any user interface objects for moving to the next or last record. If the user moves past the last record and then moves back to the last record (or before it), the record view can track the user's position in the recordset and disable user interface objects correctly. `IsOnLastRecord` is also unreliable after a call to the implementation function **OnRecordLast**, which handles the `ID_RECORD_LAST` command, or `CRecordset::MoveLast`.","pos":[11,678],"nodes":[{"content":"The result of this function is reliable except that the view cannot detect the end of the recordset until the user has moved past it.","pos":[1,134]},{"content":"The user must move beyond the last record before the record view can tell that it must disable any user interface objects for moving to the next or last record.","pos":[135,295]},{"content":"If the user moves past the last record and then moves back to the last record (or before it), the record view can track the user's position in the recordset and disable user interface objects correctly.","pos":[296,498]},{"content":"<ph id=\"ph1\">`IsOnLastRecord`</ph> is also unreliable after a call to the implementation function <bpt id=\"p1\">**</bpt>OnRecordLast<ept id=\"p1\">**</ept>, which handles the <ph id=\"ph2\">`ID_RECORD_LAST`</ph> command, or <ph id=\"ph3\">`CRecordset::MoveLast`</ph>.","pos":[499,667],"source":"`IsOnLastRecord` is also unreliable after a call to the implementation function **OnRecordLast**, which handles the `ID_RECORD_LAST` command, or `CRecordset::MoveLast`."}]}]},{"pos":[8961,9032],"content":"<bpt id=\"p1\">&lt;a name=\"crecordview__ongetrecordset\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CRecordView::OnGetRecordset","linkify":"<a name=\"crecordview__ongetrecordset\"></a>  CRecordView::OnGetRecordset","source":"<a name=\"crecordview__ongetrecordset\"></a>  CRecordView::OnGetRecordset"},{"pos":[9036,9121],"content":"Returns a pointer to the <ph id=\"ph1\">`CRecordset`</ph>-derived object associated with the record view.","source":"Returns a pointer to the `CRecordset`-derived object associated with the record view."},{"pos":[9190,9202],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[9206,9318],"content":"A pointer to a <ph id=\"ph1\">`CRecordset`</ph>-derived object if the object was successfully created; otherwise a <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> pointer.","source":"A pointer to a `CRecordset`-derived object if the object was successfully created; otherwise a **NULL** pointer."},{"pos":[9328,9335],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You must override this member function to construct or obtain a recordset object and return a pointer to it.","pos":[9339,9447]},{"content":"If you declare your record view class with ClassWizard, the wizard writes a default override for you.","pos":[9448,9549]},{"content":"ClassWizard's default implementation returns the recordset pointer stored in the record view if one exists.","pos":[9550,9657]},{"content":"If not, it constructs a recordset object of the type you specified with ClassWizard and calls its <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> member function to open the table or run the query, and then returns a pointer to the object.","pos":[9658,9858],"source":" If not, it constructs a recordset object of the type you specified with ClassWizard and calls its **Open** member function to open the table or run the query, and then returns a pointer to the object."},{"pos":[9865,10003],"content":"For more information and examples, see the article <bpt id=\"p1\">[</bpt>Record Views: Using a Record View<ept id=\"p1\">](../../data/using-a-record-view-mfc-data-access.md)</ept>.","source":"For more information and examples, see the article [Record Views: Using a Record View](../../data/using-a-record-view-mfc-data-access.md)."},{"pos":[10013,10068],"content":"<bpt id=\"p1\">&lt;a name=\"crecordview__onmove\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CRecordView::OnMove","linkify":"<a name=\"crecordview__onmove\"></a>  CRecordView::OnMove","source":"<a name=\"crecordview__onmove\"></a>  CRecordView::OnMove"},{"content":"Call this member function to move to a different record in the recordset and display its fields in the controls of the record view.","pos":[10072,10203]},{"pos":[10270,10280],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"One of the following standard command ID values:","pos":[10304,10352]},{"pos":[10360,10420],"content":"<ph id=\"ph1\">`ID_RECORD_FIRST`</ph> Move to the first record in the recordset.","source":"`ID_RECORD_FIRST` Move to the first record in the recordset."},{"pos":[10428,10486],"content":"<ph id=\"ph1\">`ID_RECORD_LAST`</ph> Move to the last record in the recordset.","source":"`ID_RECORD_LAST` Move to the last record in the recordset."},{"pos":[10494,10552],"content":"<ph id=\"ph1\">`ID_RECORD_NEXT`</ph> Move to the next record in the recordset.","source":"`ID_RECORD_NEXT` Move to the next record in the recordset."},{"pos":[10560,10622],"content":"<ph id=\"ph1\">`ID_RECORD_PREV`</ph> Move to the previous record in the recordset.","source":"`ID_RECORD_PREV` Move to the previous record in the recordset."},{"pos":[10632,10644],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the move was successful; otherwise 0 if the move request was denied.","pos":[10648,10727]},{"pos":[10737,10744],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[10748,10881],"content":"The default implementation calls the appropriate <bpt id=\"p1\">**</bpt>Move<ept id=\"p1\">**</ept> member function of the <ph id=\"ph1\">`CRecordset`</ph> object associated with the record view.","source":"The default implementation calls the appropriate **Move** member function of the `CRecordset` object associated with the record view."},{"pos":[10888,11001],"content":"By default, <ph id=\"ph1\">`OnMove`</ph> updates the current record on the data source if the user has changed it in the record view.","source":"By default, `OnMove` updates the current record on the data source if the user has changed it in the record view."},{"content":"The Application Wizard creates a menu resource with First Record, Last Record, Next Record, and Previous Record menu items.","pos":[11008,11131]},{"content":"If you select the Dockable Toolbar option, the Application Wizard also creates a toolbar with buttons corresponding to these commands.","pos":[11132,11266]},{"content":"If you move past the last record in the recordset, the record view continues to display the last record.","pos":[11273,11377]},{"content":"If you move backward past the first record, the record view continues to display the first record.","pos":[11378,11476]},{"pos":[11484,11822],"content":"[!CAUTION]\n Calling `OnMove` throws an exception if the recordset has no records. Call the appropriate user interface update handler function — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, or **OnUpdateRecordPrev** — before the corresponding move operation to determine whether the recordset has any records.","leadings":["","> "],"nodes":[{"content":" Calling `OnMove` throws an exception if the recordset has no records. Call the appropriate user interface update handler function — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, or **OnUpdateRecordPrev** — before the corresponding move operation to determine whether the recordset has any records.","pos":[11,336],"nodes":[{"content":"Calling <ph id=\"ph1\">`OnMove`</ph> throws an exception if the recordset has no records.","pos":[1,70],"source":" Calling `OnMove` throws an exception if the recordset has no records."},{"content":"Call the appropriate user interface update handler function — <bpt id=\"p1\">**</bpt>OnUpdateRecordFirst<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>OnUpdateRecordLast<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>OnUpdateRecordNext<ept id=\"p3\">**</ept>, or <bpt id=\"p4\">**</bpt>OnUpdateRecordPrev<ept id=\"p4\">**</ept> — before the corresponding move operation to determine whether the recordset has any records.","pos":[71,325],"source":" Call the appropriate user interface update handler function — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, or **OnUpdateRecordPrev** — before the corresponding move operation to determine whether the recordset has any records."}]}]},{"pos":[11831,11839],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CFormView Class<ept id=\"p1\">](../../mfc/reference/cformview-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[11843,11901],"source":"[CFormView Class](../../mfc/reference/cformview-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[11904,11953],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CRecordset Class<ept id=\"p1\">](../../mfc/reference/crecordset-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[11956,12017],"source":" [CRecordset Class](../../mfc/reference/crecordset-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CFormView Class<ept id=\"p1\">](../../mfc/reference/cformview-class.md)</ept>","pos":[12020,12078],"source":" [CFormView Class](../../mfc/reference/cformview-class.md)"}],"content":"---\ntitle: \"CRecordView Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CRecordView\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CRecordView class\"\n  - \"ODBC recordsets, viewing records\"\n  - \"records, viewing ODBC\"\n  - \"views, ODBC\"\nms.assetid: 9b4b0897-bd50-4d48-a0b4-f3323f5ccc55\ncaps.latest.revision: 25\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CRecordView Class\nA view that displays database records in controls.  \n  \n## Syntax  \n  \n```  \nclass AFX_NOVTABLE CRecordView : public CFormView  \n```  \n  \n## Members  \n  \n### Protected Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRecordView::CRecordView](#crecordview__crecordview)|Constructs a `CRecordView` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRecordView::IsOnFirstRecord](#crecordview__isonfirstrecord)|Returns nonzero if the current record is the first record in the associated recordset.|  \n|[CRecordView::IsOnLastRecord](#crecordview__isonlastrecord)|Returns nonzero if the current record is the last record in the associated recordset.|  \n|[CRecordView::OnGetRecordset](#crecordview__ongetrecordset)|Returns a pointer to an object of a class derived from `CRecordset`. ClassWizard overrides this function for you and creates the recordset if necessary.|  \n|[CRecordView::OnMove](#crecordview__onmove)||  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRecordView::OnMove](#crecordview__onmove)|If the current record has changed, updates it on the data source, then moves to the specified record (next, previous, first, or last).|  \n  \n## Remarks  \n The view is a form view directly connected to a `CRecordset` object. The view is created from a dialog template resource and displays the fields of the `CRecordset` object in the dialog template's controls. The `CRecordView` object uses dialog data exchange (DDX) and record field exchange (RFX) to automate the movement of data between the controls on the form and the fields of the recordset. `CRecordView` also supplies a default implementation for moving to the first, next, previous, or last record and an interface for updating the record currently on view.  \n  \n> [!NOTE]\n>  If you are working with the Data Access Objects (DAO) classes rather than the Open Database Connectivity (ODBC) classes, use class [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) instead. For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md).  \n  \n The most common way to create your record view is with the Application Wizard. Tge Application Wizard creates both the record view class and its associated recordset class as part of your skeleton starter application. If you don't create the record view class with the Application Wizard, you can create it later with ClassWizard. If you simply need a single form, the Application Wizard approach is easier. ClassWizard lets you decide to use a record view later in the development process. Using ClassWizard to create a record view and a recordset separately and then connect them is the most flexible approach because it gives you more control in naming the recordset class and its .H/.CPP files. This approach also lets you have multiple record views on the same recordset class.  \n  \n To make it easy for end-users to move from record to record in the record view, the Application Wizard creates menu (and optionally toolbar) resources for moving to the first, next, previous, or last record. If you create a record view class with ClassWizard, you need to create these resources yourself with the menu and bitmap editors.  \n  \n For information about the default implementation for moving from record to record, see `IsOnFirstRecord` and `IsOnLastRecord` and the article [Using a Record View](../../data/using-a-record-view-mfc-data-access.md).  \n  \n `CRecordView` keeps track of the user's position in the recordset so that the record view can update the user interface. When the user moves to either end of the recordset, the record view disables user interface objects — such as menu items or toolbar buttons — for moving further in the same direction.  \n  \n For more information about declaring and using your record view and recordset classes, see \"Designing and Creating a Record View\" in the article [Record Views](../../data/record-views-mfc-data-access.md). For more information about how record views work and how to use them, see the article [Using a Record View](../../data/using-a-record-view-mfc-data-access.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CView](../../mfc/reference/cview-class.md)  \n  \n [CScrollView](../../mfc/reference/cscrollview-class.md)  \n  \n [CFormView](../../mfc/reference/cformview-class.md)  \n  \n `CRecordView`  \n  \n## Requirements  \n **Header:** afxdb.h  \n  \n##  <a name=\"crecordview__crecordview\"></a>  CRecordView::CRecordView  \n When you create an object of a type derived from `CRecordView`, call either form of the constructor to initialize the view object and identify the dialog resource on which the view is based.  \n  \n```  \nexplicit CRecordView(LPCTSTR lpszTemplateName);\n\n \nexplicit CRecordView(UINT nIDTemplate);\n```  \n  \n### Parameters  \n `lpszTemplateName`  \n Contains a null-terminated string that is the name of a dialog template resource.  \n  \n `nIDTemplate`  \n Contains the ID number of a dialog template resource.  \n  \n### Remarks  \n You can either identify the resource by name (pass a string as the argument to the constructor) or by its ID (pass an unsigned integer as the argument). Using a resource ID is recommended.  \n  \n> [!NOTE]\n>  Your derived class *must* supply its own constructor. In the constructor of your derived class, call the constructor `CRecordView::CRecordView` with the resource name or ID as an argument, as shown in the example below.  \n  \n **CRecordView::OnInitialUpdate** calls `UpdateData`, which calls `DoDataExchange`. This initial call to `DoDataExchange` connects `CRecordView` controls (indirectly) to `CRecordset` field data members created by ClassWizard. These data members cannot be used until after you call the base class **CFormView::OnInitialUpdate** member function.  \n  \n> [!NOTE]\n>  If you use ClassWizard, the wizard defines an `enum` value `CRecordView::IDD`, specifies it in the class declaration, and uses it in the member initialization list for the constructor.  \n  \n### Example  \n [!code-cpp[NVC_MFCDatabase#32](../../mfc/codesnippet/cpp/crecordview-class_1.cpp)]  \n  \n##  <a name=\"crecordview__isonfirstrecord\"></a>  CRecordView::IsOnFirstRecord  \n Call this member function to determine whether the current record is the first record in the recordset object associated with this record view.  \n  \n```  \nBOOL IsOnFirstRecord();\n```  \n  \n### Return Value  \n Nonzero if the current record is the first record in the recordset; otherwise 0.  \n  \n### Remarks  \n This function is useful for writing your own implementations of default command update handlers written by ClassWizard.  \n  \n If the user moves to the first record, the framework disables any user interface objects you have for moving to the first or the previous record.  \n  \n##  <a name=\"crecordview__isonlastrecord\"></a>  CRecordView::IsOnLastRecord  \n Call this member function to determine whether the current record is the last record in the recordset object associated with this record view.  \n  \n```  \nBOOL IsOnLastRecord();\n```  \n  \n### Return Value  \n Nonzero if the current record is the last record in the recordset; otherwise 0.  \n  \n### Remarks  \n This function is useful for writing your own implementations of the default command update handlers that ClassWizard writes to support a user interface for moving from record to record.  \n  \n> [!CAUTION]\n>  The result of this function is reliable except that the view cannot detect the end of the recordset until the user has moved past it. The user must move beyond the last record before the record view can tell that it must disable any user interface objects for moving to the next or last record. If the user moves past the last record and then moves back to the last record (or before it), the record view can track the user's position in the recordset and disable user interface objects correctly. `IsOnLastRecord` is also unreliable after a call to the implementation function **OnRecordLast**, which handles the `ID_RECORD_LAST` command, or `CRecordset::MoveLast`.  \n  \n##  <a name=\"crecordview__ongetrecordset\"></a>  CRecordView::OnGetRecordset  \n Returns a pointer to the `CRecordset`-derived object associated with the record view.  \n  \n```  \nvirtual CRecordset* OnGetRecordset() = 0;  \n```  \n  \n### Return Value  \n A pointer to a `CRecordset`-derived object if the object was successfully created; otherwise a **NULL** pointer.  \n  \n### Remarks  \n You must override this member function to construct or obtain a recordset object and return a pointer to it. If you declare your record view class with ClassWizard, the wizard writes a default override for you. ClassWizard's default implementation returns the recordset pointer stored in the record view if one exists. If not, it constructs a recordset object of the type you specified with ClassWizard and calls its **Open** member function to open the table or run the query, and then returns a pointer to the object.  \n  \n For more information and examples, see the article [Record Views: Using a Record View](../../data/using-a-record-view-mfc-data-access.md).  \n  \n##  <a name=\"crecordview__onmove\"></a>  CRecordView::OnMove  \n Call this member function to move to a different record in the recordset and display its fields in the controls of the record view.  \n  \n```  \nvirtual BOOL OnMove(UINT nIDMoveCommand);\n```  \n  \n### Parameters  \n `nIDMoveCommand`  \n One of the following standard command ID values:  \n  \n- `ID_RECORD_FIRST` Move to the first record in the recordset.  \n  \n- `ID_RECORD_LAST` Move to the last record in the recordset.  \n  \n- `ID_RECORD_NEXT` Move to the next record in the recordset.  \n  \n- `ID_RECORD_PREV` Move to the previous record in the recordset.  \n  \n### Return Value  \n Nonzero if the move was successful; otherwise 0 if the move request was denied.  \n  \n### Remarks  \n The default implementation calls the appropriate **Move** member function of the `CRecordset` object associated with the record view.  \n  \n By default, `OnMove` updates the current record on the data source if the user has changed it in the record view.  \n  \n The Application Wizard creates a menu resource with First Record, Last Record, Next Record, and Previous Record menu items. If you select the Dockable Toolbar option, the Application Wizard also creates a toolbar with buttons corresponding to these commands.  \n  \n If you move past the last record in the recordset, the record view continues to display the last record. If you move backward past the first record, the record view continues to display the first record.  \n  \n> [!CAUTION]\n>  Calling `OnMove` throws an exception if the recordset has no records. Call the appropriate user interface update handler function — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, or **OnUpdateRecordPrev** — before the corresponding move operation to determine whether the recordset has any records.  \n  \n## See Also  \n [CFormView Class](../../mfc/reference/cformview-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CRecordset Class](../../mfc/reference/crecordset-class.md)   \n [CFormView Class](../../mfc/reference/cformview-class.md)\n"}