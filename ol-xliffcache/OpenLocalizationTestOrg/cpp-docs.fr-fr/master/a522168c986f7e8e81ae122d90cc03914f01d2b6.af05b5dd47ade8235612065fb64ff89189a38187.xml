{"nodes":[{"pos":[12,56],"content":"Raising Software Exceptions | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Raising Software Exceptions | Microsoft Docs","pos":[0,44]}]},{"content":"Raising Software Exceptions","pos":[974,1001]},{"content":"Some of the most common sources of program errors are not flagged as exceptions by the system.","pos":[1002,1096]},{"content":"For example, if you attempt to allocate a memory block but there is insufficient memory, the run-time or API function does not raise an exception but returns an error code.","pos":[1097,1269]},{"content":"However, you can treat any condition as an exception by detecting that condition in your code and then reporting it by calling the <bpt id=\"p1\">[</bpt>RaiseException<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680552)</ept> function.","pos":[1276,1493],"source":"However, you can treat any condition as an exception by detecting that condition in your code and then reporting it by calling the [RaiseException](http://msdn.microsoft.com/library/windows/desktop/ms680552) function."},{"content":"By flagging errors this way, you can bring the advantages of structured exception handling to any kind of run-time error.","pos":[1494,1615]},{"content":"To use structured exception handling with errors:","pos":[1622,1671]},{"content":"Define your own exception code for the event.","pos":[1681,1726]},{"pos":[1736,1786],"content":"Call <bpt id=\"p1\">**</bpt>RaiseException<ept id=\"p1\">**</ept> when you detect a problem.","source":"Call **RaiseException** when you detect a problem."},{"content":"Use exception-handling filters to test for the exception code you defined.","pos":[1796,1870]},{"content":"The WINERROR.H file shows the format for exception codes.","pos":[1877,1934]},{"content":"To make sure that you do not define a code that conflicts with an existing exception code, set the third most significant bit to 1.","pos":[1935,2066]},{"content":"The four most-significant bits should be set as shown in the following table.","pos":[2067,2144]},{"content":"Bits","pos":[2151,2155]},{"content":"Recommended binary setting","pos":[2156,2182]},{"content":"Description","pos":[2183,2194]},{"content":"31-30","pos":[2265,2270]},{"content":"11","pos":[2271,2273]},{"content":"These two bits describe the basic status of the code:  11 = error, 00 = success, 01 = informational, 10 = warning.","pos":[2274,2388]},{"content":"29","pos":[2393,2395]},{"content":"1","pos":[2396,2397]},{"content":"Client bit.","pos":[2398,2409]},{"content":"Set to 1 for user-defined codes.","pos":[2410,2442]},{"content":"28","pos":[2447,2449]},{"content":"0","pos":[2450,2451]},{"content":"Reserved bit.","pos":[2452,2465]},{"content":"(Leave set to 0.)","pos":[2466,2483]},{"content":"You can set the first two bits to a setting other than 11 binary if you want, although the \"error\" setting is appropriate for most exceptions.","pos":[2491,2633]},{"content":"The important thing to remember is to set bits 29 and 28 as shown in the previous table.","pos":[2634,2722]},{"content":"The resulting error code should therefore have the highest four bits set to hexadecimal E. For example, the following definitions define exception codes that do not conflict with any Windows exception codes.","pos":[2729,2936]},{"content":"(You may, however, need to check which codes are used by third-party DLLs.)","pos":[2937,3012]},{"content":"After you have defined an exception code, you can use it to raise an exception.","pos":[3136,3215]},{"content":"For example, the following code raises the STATUS_INSUFFICIENT_MEM exception in response to a memory allocation problem:","pos":[3216,3336]},{"content":"If you want to simply raise an exception, you can set the last three parameters to 0.","pos":[3470,3555]},{"content":"The three last parameters are useful for passing additional information and setting a flag that prevents handlers from continuing execution.","pos":[3556,3696]},{"content":"See the <bpt id=\"p1\">[</bpt>RaiseException<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680552)</ept> function in the <ph id=\"ph1\">[!INCLUDE[winsdkshort](../atl-mfc-shared/reference/includes/winsdkshort_md.md)]</ph> for more information.","pos":[3697,3899],"source":" See the [RaiseException](http://msdn.microsoft.com/library/windows/desktop/ms680552) function in the [!INCLUDE[winsdkshort](../atl-mfc-shared/reference/includes/winsdkshort_md.md)] for more information."},{"content":"In your exception-handling filters, you can then test for the codes you've defined.","pos":[3906,3989]},{"content":"For example:","pos":[3990,4002]},{"content":"See Also","pos":[4168,4176]},{"content":"Writing an Exception Handler","pos":[4181,4209]},{"content":"Structured Exception Handling (C/C++)","pos":[4256,4293]}],"content":"---\ntitle: \"Raising Software Exceptions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"run-time errors, treating as exceptions\"\n  - \"exception handling, errors as exceptions\"\n  - \"exceptions, flagging errors as exceptions\"\n  - \"errors [C++], treating as exceptions\"\n  - \"exception handling, detecting errors\"\n  - \"structured exception handling, errors as exceptions\"\n  - \"exceptions, software\"\n  - \"RaiseException function\"\n  - \"software exceptions\"\n  - \"formats [C++], exception codes\"\nms.assetid: be1376c3-c46a-4f52-ad1d-c2362840746a\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Raising Software Exceptions\nSome of the most common sources of program errors are not flagged as exceptions by the system. For example, if you attempt to allocate a memory block but there is insufficient memory, the run-time or API function does not raise an exception but returns an error code.  \n  \n However, you can treat any condition as an exception by detecting that condition in your code and then reporting it by calling the [RaiseException](http://msdn.microsoft.com/library/windows/desktop/ms680552) function. By flagging errors this way, you can bring the advantages of structured exception handling to any kind of run-time error.  \n  \n To use structured exception handling with errors:  \n  \n-   Define your own exception code for the event.  \n  \n-   Call **RaiseException** when you detect a problem.  \n  \n-   Use exception-handling filters to test for the exception code you defined.  \n  \n The WINERROR.H file shows the format for exception codes. To make sure that you do not define a code that conflicts with an existing exception code, set the third most significant bit to 1. The four most-significant bits should be set as shown in the following table.  \n  \n|Bits|Recommended binary setting|Description|  \n|----------|--------------------------------|-----------------|  \n|31-30|11|These two bits describe the basic status of the code:  11 = error, 00 = success, 01 = informational, 10 = warning.|  \n|29|1|Client bit. Set to 1 for user-defined codes.|  \n|28|0|Reserved bit. (Leave set to 0.)|  \n  \n You can set the first two bits to a setting other than 11 binary if you want, although the \"error\" setting is appropriate for most exceptions. The important thing to remember is to set bits 29 and 28 as shown in the previous table.  \n  \n The resulting error code should therefore have the highest four bits set to hexadecimal E. For example, the following definitions define exception codes that do not conflict with any Windows exception codes. (You may, however, need to check which codes are used by third-party DLLs.)  \n  \n```  \n#define STATUS_INSUFFICIENT_MEM       0xE0000001  \n#define STATUS_FILE_BAD_FORMAT        0xE0000002  \n```  \n  \n After you have defined an exception code, you can use it to raise an exception. For example, the following code raises the STATUS_INSUFFICIENT_MEM exception in response to a memory allocation problem:  \n  \n```  \nlpstr = _malloc( nBufferSize );  \nif (lpstr == NULL)  \n    RaiseException( STATUS_INSUFFICIENT_MEM, 0, 0, 0);  \n```  \n  \n If you want to simply raise an exception, you can set the last three parameters to 0. The three last parameters are useful for passing additional information and setting a flag that prevents handlers from continuing execution. See the [RaiseException](http://msdn.microsoft.com/library/windows/desktop/ms680552) function in the [!INCLUDE[winsdkshort](../atl-mfc-shared/reference/includes/winsdkshort_md.md)] for more information.  \n  \n In your exception-handling filters, you can then test for the codes you've defined. For example:  \n  \n```  \n__try {  \n    ...  \n}  \n__except (GetExceptionCode() == STATUS_INSUFFICIENT_MEM ||  \n        GetExceptionCode() == STATUS_FILE_BAD_FORMAT )  \n```  \n  \n## See Also  \n [Writing an Exception Handler](../cpp/writing-an-exception-handler.md)   \n [Structured Exception Handling (C/C++)](../cpp/structured-exception-handling-c-cpp.md)"}