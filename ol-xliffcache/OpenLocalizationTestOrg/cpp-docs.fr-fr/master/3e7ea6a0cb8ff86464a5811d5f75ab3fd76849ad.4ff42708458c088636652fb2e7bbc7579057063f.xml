{"nodes":[{"pos":[12,79],"content":"How to: Retrieve Text from the Clipboard (C++-CLI) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Retrieve Text from the Clipboard (C++-CLI) | Microsoft Docs","pos":[0,67]}]},{"content":"How to: Retrieve Text from the Clipboard (C++/CLI)","pos":[653,703]},{"content":"The following code example uses the &lt;xref:System.Windows.Forms.Clipboard.GetDataObject%2A&gt; member function to return a pointer to the &lt;xref:System.Windows.Forms.IDataObject&gt; interface.","pos":[704,888],"source":"The following code example uses the <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> member function to return a pointer to the <xref:System.Windows.Forms.IDataObject> interface."},{"content":"This interface can then be queried for the format of the data and used to retrieve the actual data.","pos":[889,988]},{"content":"Example","pos":[997,1004]},{"content":"See Also","pos":[1757,1765]},{"content":"Windows Operations (C++/CLI)","pos":[1770,1798]},{"content":".NET Programming with C++/CLI (Visual C++)","pos":[1846,1888]}],"content":"---\ntitle: \"How to: Retrieve Text from the Clipboard (C++-CLI) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"text, retrieving from Clipboard\"\n  - \"Clipboard, retrieving text\"\nms.assetid: 99e77ba0-8573-4030-92d8-de8aa7623ee4\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Retrieve Text from the Clipboard (C++/CLI)\nThe following code example uses the <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> member function to return a pointer to the <xref:System.Windows.Forms.IDataObject> interface. This interface can then be queried for the format of the data and used to retrieve the actual data.  \n  \n## Example  \n  \n```  \n// read_clipboard.cpp  \n// compile with: /clr  \n#using <system.dll>  \n#using <system.Drawing.dll>  \n#using <system.windows.forms.dll>  \n  \nusing namespace System;  \nusing namespace System::Windows::Forms;  \n  \n[STAThread] int main( )  \n{  \n   IDataObject^ data = Clipboard::GetDataObject( );  \n  \n   if (data)  \n   {  \n      if (data->GetDataPresent(DataFormats::Text))   \n      {  \n         String^ text = static_cast<String^>  \n           (data->GetData(DataFormats::Text));  \n         Console::WriteLine(text);   \n      }  \n      else  \n         Console::WriteLine(\"Nontext data is in the Clipboard.\");  \n   }  \n   else   \n   {  \n      Console::WriteLine(\"No data was found in the Clipboard.\");  \n   }  \n  \n   return 0;  \n}  \n```  \n  \n## See Also  \n [Windows Operations (C++/CLI)](../dotnet/windows-operations-cpp-cli.md)   \n [.NET Programming with C++/CLI (Visual C++)](../dotnet/dotnet-programming-with-cpp-cli-visual-cpp.md)"}