{"nodes":[{"pos":[12,61],"content":"Compiler Warning (level 4) C4437 | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Compiler Warning (level 4) C4437 | Microsoft Docs","pos":[0,49]}]},{"content":"Compiler Warning (level 4) C4437","pos":[549,581]},{"content":"dynamic_cast from virtual base 'class1' to 'class2' could fail in some contexts        Compile with /vd2 or define 'class2' with #pragma vtordisp(2) in effect","pos":[582,740]},{"content":"This warning is off by default.","pos":[747,778]},{"content":"See <bpt id=\"p1\">[</bpt>Compiler Warnings That Are Off by Default<ept id=\"p1\">](../../preprocessor/compiler-warnings-that-are-off-by-default.md)</ept> for more information.","pos":[779,913],"source":" See [Compiler Warnings That Are Off by Default](../../preprocessor/compiler-warnings-that-are-off-by-default.md) for more information."},{"pos":[920,1011],"content":"The compiler has encountered a <ph id=\"ph1\">`dynamic_cast`</ph> operation with the following characteristics.","source":"The compiler has encountered a `dynamic_cast` operation with the following characteristics."},{"content":"The cast is from a base class pointer to a derived class pointer.","pos":[1021,1086]},{"content":"The derived class virtually inherits the base class.","pos":[1096,1148]},{"pos":[1158,1230],"content":"The derived class does not have a <ph id=\"ph1\">`vtordisp`</ph> field for the virtual base.","source":"The derived class does not have a `vtordisp` field for the virtual base."},{"content":"The cast is not found in a constructor or destructor of the derived class, or some class which further inherits from the derived class (otherwise, compiler warning C4436 will be issued).","pos":[1240,1426]},{"content":"The warning indicates that the <ph id=\"ph1\">`dynamic_cast`</ph> might not perform correctly if it is operating on a partially-constructed object.","pos":[1433,1560],"source":"The warning indicates that the `dynamic_cast` might not perform correctly if it is operating on a partially-constructed object."},{"content":"This situation occurs when the enclosing function is called from a constructor or destructor of a class that inherits the derived class that is named in the warning.","pos":[1562,1727]},{"content":"If the derived class that is named in the warning is never further derived, or the enclosing function is not called during object construction or destruction, the warning can be ignored.","pos":[1729,1915]},{"content":"Example","pos":[1924,1931]},{"pos":[1935,2061],"content":"The following sample generates C4437 and demonstrates the code generation issue that arises from the missing <ph id=\"ph1\">`vtordisp`</ph> field.","source":"The following sample generates C4437 and demonstrates the code generation issue that arises from the missing `vtordisp` field."},{"content":"See Also","pos":[2846,2854]},{"content":"dynamic_cast Operator","pos":[2859,2880]},{"content":"vtordisp","pos":[2923,2931]},{"content":"Compiler Warning (level 1) C4436","pos":[2970,3002]}],"content":"---\ntitle: \"Compiler Warning (level 4) C4437 | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"error-reference\"\ndev_langs: \n  - \"C++\"\nms.assetid: dc07e350-20eb-474c-a7ad-f841ae7ec339\ncaps.latest.revision: 3\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Compiler Warning (level 4) C4437\ndynamic_cast from virtual base 'class1' to 'class2' could fail in some contexts        Compile with /vd2 or define 'class2' with #pragma vtordisp(2) in effect  \n  \n This warning is off by default. See [Compiler Warnings That Are Off by Default](../../preprocessor/compiler-warnings-that-are-off-by-default.md) for more information.  \n  \n The compiler has encountered a `dynamic_cast` operation with the following characteristics.  \n  \n-   The cast is from a base class pointer to a derived class pointer.  \n  \n-   The derived class virtually inherits the base class.  \n  \n-   The derived class does not have a `vtordisp` field for the virtual base.  \n  \n-   The cast is not found in a constructor or destructor of the derived class, or some class which further inherits from the derived class (otherwise, compiler warning C4436 will be issued).  \n  \n The warning indicates that the `dynamic_cast` might not perform correctly if it is operating on a partially-constructed object.  This situation occurs when the enclosing function is called from a constructor or destructor of a class that inherits the derived class that is named in the warning.  If the derived class that is named in the warning is never further derived, or the enclosing function is not called during object construction or destruction, the warning can be ignored.  \n  \n## Example  \n The following sample generates C4437 and demonstrates the code generation issue that arises from the missing `vtordisp` field.  \n  \n```cpp  \n// C4437.cpp  \n// To see the warning and runtime assert, compile with: /W4  \n// To eliminate the warning and assert, compile with: /W4 /vd2  \n//       or compile with: /W4 /DFIX  \n#pragma warning(default : 4437)  \n#include <cassert>  \n  \nstruct A  \n{  \npublic:  \n    virtual ~A() {}  \n};  \n  \n#if defined(FIX)  \n#pragma vtordisp(push, 2)  \n#endif  \nstruct B : virtual A  \n{  \n    B()  \n    {  \n        func();  \n    }  \n  \n    void func()  \n    {  \n        A* a = static_cast<A*>(this);  \n        B* b = dynamic_cast<B*>(a);     // C4437  \n        assert(this == b);              // assert unless compiled with /vd2  \n    }  \n};  \n#if defined(FIX)  \n#pragma vtordisp(pop)  \n#endif  \n  \nstruct C : B  \n{  \n    int i;  \n};  \n  \nint main()  \n{  \n    C c;  \n}  \n```  \n  \n## See Also  \n [dynamic_cast Operator](../../cpp/dynamic-cast-operator.md)   \n [vtordisp](../../preprocessor/vtordisp.md)   \n [Compiler Warning (level 1) C4436](../../error-messages/compiler-warnings/compiler-warning-level-1-c4436.md)"}