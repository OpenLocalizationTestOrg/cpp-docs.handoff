{"nodes":[{"pos":[12,55],"content":"CMFCRibbonUndoButton Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCRibbonUndoButton Class | Microsoft Docs","pos":[0,43]}]},{"pos":[634,660],"content":"CMFCRibbonUndoButton Class","linkify":"CMFCRibbonUndoButton Class","nodes":[{"content":"CMFCRibbonUndoButton Class","pos":[0,26]}]},{"content":"The <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> class implements a drop-down list button that contains the most recent user commands.","pos":[661,773],"source":"The `CMFCRibbonUndoButton` class implements a drop-down list button that contains the most recent user commands."},{"content":"Users can select one or more of the most recent commands from the drop-down list to either redo or undo them.","pos":[774,883]},{"pos":[892,898],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[978,985],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[995,1014],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1021,1025]},{"content":"Description","pos":[1026,1037]},{"pos":[1075,1164],"content":"<bpt id=\"p1\">[</bpt>CMFCRibbonUndoButton::CMFCRibbonUndoButton<ept id=\"p1\">](#cmfcribbonundobutton__cmfcribbonundobutton)</ept>","source":"[CMFCRibbonUndoButton::CMFCRibbonUndoButton](#cmfcribbonundobutton__cmfcribbonundobutton)"},{"pos":[1165,1317],"content":"Constructs a new <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> object by using the command ID that you specify, text label and images from the image list of the parent object.","source":"Constructs a new `CMFCRibbonUndoButton` object by using the command ID that you specify, text label and images from the image list of the parent object."},{"pos":[1328,1342],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1349,1353]},{"content":"Description","pos":[1354,1365]},{"pos":[1403,1478],"content":"<bpt id=\"p1\">[</bpt>CMFCRibbonUndoButton::AddUndoAction<ept id=\"p1\">](#cmfcribbonundobutton__addundoaction)</ept>","source":"[CMFCRibbonUndoButton::AddUndoAction](#cmfcribbonundobutton__addundoaction)"},{"content":"Adds a new action to the list of actions.","pos":[1479,1520]},{"pos":[1525,1604],"content":"<bpt id=\"p1\">[</bpt>CMFCRibbonUndoButton::CleanUpUndoList<ept id=\"p1\">](#cmfcribbonundobutton__cleanupundolist)</ept>","source":"[CMFCRibbonUndoButton::CleanUpUndoList](#cmfcribbonundobutton__cleanupundolist)"},{"content":"Clears the action list, which is the drop-down list.","pos":[1605,1657]},{"pos":[1662,1741],"content":"<bpt id=\"p1\">[</bpt>CMFCRibbonUndoButton::GetActionNumber<ept id=\"p1\">](#cmfcribbonundobutton__getactionnumber)</ept>","source":"[CMFCRibbonUndoButton::GetActionNumber](#cmfcribbonundobutton__getactionnumber)"},{"content":"Determines the number of items that a user selected from the drop-down list.","pos":[1742,1818]},{"pos":[1823,1886],"content":"<bpt id=\"p1\">[</bpt>CMFCRibbonUndoButton::HasMenu<ept id=\"p1\">](#cmfcribbonundobutton__hasmenu)</ept>","source":"[CMFCRibbonUndoButton::HasMenu](#cmfcribbonundobutton__hasmenu)"},{"content":"Indicates whether the object contains a menu.","pos":[1887,1932]},{"pos":[1942,1949],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1953,2031],"content":"The <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> class uses a stack to represent the drop-down list.","source":"The `CMFCRibbonUndoButton` class uses a stack to represent the drop-down list."},{"pos":[2040,2047],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The following example demonstrates how to construct an object of the <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> class, and add a new action to the list of actions.","pos":[2051,2194],"source":"The following example demonstrates how to construct an object of the `CMFCRibbonUndoButton` class, and add a new action to the list of actions."},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>Ribbon Gadgets sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[2195,2281],"source":" This code snippet is part of the [Ribbon Gadgets sample](../../visual-cpp-samples.md)."},{"pos":[2288,2394],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFC_RibbonGadgets#2<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/cmfcribbonundobutton-class_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFC_RibbonGadgets#2](../../mfc/reference/codesnippet/cpp/cmfcribbonundobutton-class_1.cpp)]"},{"pos":[2403,2424],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2428,2475],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[2482,2557],"content":"<bpt id=\"p1\">[</bpt>CMFCRibbonBaseElement<ept id=\"p1\">](../../mfc/reference/cmfcribbonbaseelement-class.md)</ept>","source":"[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)"},{"pos":[2564,2629],"content":"<bpt id=\"p1\">[</bpt>CMFCRibbonButton<ept id=\"p1\">](../../mfc/reference/cmfcribbonbutton-class.md)</ept>","source":"[CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)"},{"pos":[2636,2703],"content":"<bpt id=\"p1\">[</bpt>CMFCRibbonGallery<ept id=\"p1\">](../../mfc/reference/cmfcribbongallery-class.md)</ept>","source":"[CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)"},{"pos":[2710,2783],"content":"<bpt id=\"p1\">[</bpt>CMFCRibbonUndoButton<ept id=\"p1\">](../../mfc/reference/cmfcribbonundobutton-class.md)</ept>","source":"[CMFCRibbonUndoButton](../../mfc/reference/cmfcribbonundobutton-class.md)"},{"pos":[2792,2804],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2808,2841],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxribbonundobutton.h","source":"**Header:** afxribbonundobutton.h"},{"pos":[2851,2938],"content":"<bpt id=\"p1\">&lt;a name=\"cmfcribbonundobutton__addundoaction\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCRibbonUndoButton::AddUndoAction","linkify":"<a name=\"cmfcribbonundobutton__addundoaction\"></a>  CMFCRibbonUndoButton::AddUndoAction","source":"<a name=\"cmfcribbonundobutton__addundoaction\"></a>  CMFCRibbonUndoButton::AddUndoAction"},{"content":"Adds a new action to the list of actions.","pos":[2942,2983]},{"pos":[3047,3057],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] <ph id=\"ph1\">`lpszLabel`</ph>","pos":[3061,3077],"source":"[in] `lpszLabel`"},{"content":"The action label that will be displayed in the drop-down list.","pos":[3081,3143]},{"pos":[3153,3244],"content":"<bpt id=\"p1\">&lt;a name=\"cmfcribbonundobutton__cleanupundolist\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCRibbonUndoButton::CleanUpUndoList","linkify":"<a name=\"cmfcribbonundobutton__cleanupundolist\"></a>  CMFCRibbonUndoButton::CleanUpUndoList","source":"<a name=\"cmfcribbonundobutton__cleanupundolist\"></a>  CMFCRibbonUndoButton::CleanUpUndoList"},{"content":"Clears the action list, which is the drop-down list.","pos":[3248,3300]},{"pos":[3349,3450],"content":"<bpt id=\"p1\">&lt;a name=\"cmfcribbonundobutton__cmfcribbonundobutton\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCRibbonUndoButton::CMFCRibbonUndoButton","linkify":"<a name=\"cmfcribbonundobutton__cmfcribbonundobutton\"></a>  CMFCRibbonUndoButton::CMFCRibbonUndoButton","source":"<a name=\"cmfcribbonundobutton__cmfcribbonundobutton\"></a>  CMFCRibbonUndoButton::CMFCRibbonUndoButton"},{"pos":[3454,3606],"content":"Constructs a new <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> object by using the command ID that you specify, text label and images from the image list of the parent object.","source":"Constructs a new `CMFCRibbonUndoButton` object by using the command ID that you specify, text label and images from the image list of the parent object."},{"pos":[3837,3847],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] <ph id=\"ph1\">`nID`</ph>","pos":[3851,3861],"source":"[in] `nID`"},{"content":"Specifies the command identifier.","pos":[3865,3898]},{"content":"[in] <ph id=\"ph1\">`lpszText`</ph>","pos":[3905,3920],"source":"[in] `lpszText`"},{"content":"Specifies the text label of the button.","pos":[3924,3963]},{"content":"[in] <ph id=\"ph1\">`nSmallImageIndex`</ph>","pos":[3970,3993],"source":"[in] `nSmallImageIndex`"},{"content":"Zero-based index in the image list of the parent object for the button's small image.","pos":[3997,4082]},{"content":"[in] <ph id=\"ph1\">`nLargeImageIndex`</ph>","pos":[4089,4112],"source":"[in] `nLargeImageIndex`"},{"content":"Zero-based index in the image list of the parent object for the of button's large image.","pos":[4116,4204]},{"content":"[in] <ph id=\"ph1\">`hIcon`</ph>","pos":[4211,4223],"source":"[in] `hIcon`"},{"content":"A handle to an icon that you can use as a button's image.","pos":[4227,4284]},{"pos":[4294,4385],"content":"<bpt id=\"p1\">&lt;a name=\"cmfcribbonundobutton__getactionnumber\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCRibbonUndoButton::GetActionNumber","linkify":"<a name=\"cmfcribbonundobutton__getactionnumber\"></a>  CMFCRibbonUndoButton::GetActionNumber","source":"<a name=\"cmfcribbonundobutton__getactionnumber\"></a>  CMFCRibbonUndoButton::GetActionNumber"},{"content":"Determines the number of items that a user selected from the drop-down list.","pos":[4389,4465]},{"pos":[4522,4534],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The number of items that a user selected.","pos":[4538,4579]},{"pos":[4589,4664],"content":"<bpt id=\"p1\">&lt;a name=\"cmfcribbonundobutton__hasmenu\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCRibbonUndoButton::HasMenu","linkify":"<a name=\"cmfcribbonundobutton__hasmenu\"></a>  CMFCRibbonUndoButton::HasMenu","source":"<a name=\"cmfcribbonundobutton__hasmenu\"></a>  CMFCRibbonUndoButton::HasMenu"},{"content":"Indicates whether the object contains a menu.","pos":[4668,4713]},{"pos":[4771,4783],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[4787,4809],"content":"Always returns <ph id=\"ph1\">`TRUE`</ph>.","source":"Always returns `TRUE`."},{"pos":[4819,4826],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4835,4843],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[4847,4895],"source":"[Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Classes<ept id=\"p1\">](../../mfc/reference/mfc-classes.md)</ept><ph id=\"ph1\"> </ph>","pos":[4898,4945],"source":" [Classes](../../mfc/reference/mfc-classes.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CMFCRibbonGallery Class<ept id=\"p1\">](../../mfc/reference/cmfcribbongallery-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[4948,5023],"source":" [CMFCRibbonGallery Class](../../mfc/reference/cmfcribbongallery-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CMFCRibbonButton Class<ept id=\"p1\">](../../mfc/reference/cmfcribbonbutton-class.md)</ept>","pos":[5026,5098],"source":" [CMFCRibbonButton Class](../../mfc/reference/cmfcribbonbutton-class.md)"}],"content":"---\ntitle: \"CMFCRibbonUndoButton Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCRibbonUndoButton\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCRibbonUndoButton class\"\nms.assetid: 5c42adf7-871d-4239-901e-47ae7fb816fc\ncaps.latest.revision: 35\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCRibbonUndoButton Class\nThe `CMFCRibbonUndoButton` class implements a drop-down list button that contains the most recent user commands. Users can select one or more of the most recent commands from the drop-down list to either redo or undo them.  \n  \n## Syntax  \n  \n```  \nclass CMFCRibbonUndoButton : public CMFCRibbonGallery  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCRibbonUndoButton::CMFCRibbonUndoButton](#cmfcribbonundobutton__cmfcribbonundobutton)|Constructs a new `CMFCRibbonUndoButton` object by using the command ID that you specify, text label and images from the image list of the parent object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCRibbonUndoButton::AddUndoAction](#cmfcribbonundobutton__addundoaction)|Adds a new action to the list of actions.|  \n|[CMFCRibbonUndoButton::CleanUpUndoList](#cmfcribbonundobutton__cleanupundolist)|Clears the action list, which is the drop-down list.|  \n|[CMFCRibbonUndoButton::GetActionNumber](#cmfcribbonundobutton__getactionnumber)|Determines the number of items that a user selected from the drop-down list.|  \n|[CMFCRibbonUndoButton::HasMenu](#cmfcribbonundobutton__hasmenu)|Indicates whether the object contains a menu.|  \n  \n## Remarks  \n The `CMFCRibbonUndoButton` class uses a stack to represent the drop-down list.  \n  \n## Example  \n The following example demonstrates how to construct an object of the `CMFCRibbonUndoButton` class, and add a new action to the list of actions. This code snippet is part of the [Ribbon Gadgets sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_RibbonGadgets#2](../../mfc/reference/codesnippet/cpp/cmfcribbonundobutton-class_1.cpp)]  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)  \n  \n [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)  \n  \n [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)  \n  \n [CMFCRibbonUndoButton](../../mfc/reference/cmfcribbonundobutton-class.md)  \n  \n## Requirements  \n **Header:** afxribbonundobutton.h  \n  \n##  <a name=\"cmfcribbonundobutton__addundoaction\"></a>  CMFCRibbonUndoButton::AddUndoAction  \n Adds a new action to the list of actions.  \n  \n```  \nvoid AddUndoAction(LPCTSTR lpszLabel);\n```  \n  \n### Parameters  \n [in] `lpszLabel`  \n The action label that will be displayed in the drop-down list.  \n  \n##  <a name=\"cmfcribbonundobutton__cleanupundolist\"></a>  CMFCRibbonUndoButton::CleanUpUndoList  \n Clears the action list, which is the drop-down list.  \n  \n```  \nvoid CleanUpUndoList();\n```  \n  \n##  <a name=\"cmfcribbonundobutton__cmfcribbonundobutton\"></a>  CMFCRibbonUndoButton::CMFCRibbonUndoButton  \n Constructs a new `CMFCRibbonUndoButton` object by using the command ID that you specify, text label and images from the image list of the parent object.  \n  \n```  \nCMFCRibbonUndoButton(\n    UINT nID,  \n    LPCTSTR lpszText,  \n    int nSmallImageIndex=-1,  \n    int nLargeImageIndex=-1);\n\n \nCMFCRibbonUndoButton(\n    UINT nID,  \n    LPCTSTR lpszText,  \n    HICON hIcon);\n```  \n  \n### Parameters  \n [in] `nID`  \n Specifies the command identifier.  \n  \n [in] `lpszText`  \n Specifies the text label of the button.  \n  \n [in] `nSmallImageIndex`  \n Zero-based index in the image list of the parent object for the button's small image.  \n  \n [in] `nLargeImageIndex`  \n Zero-based index in the image list of the parent object for the of button's large image.  \n  \n [in] `hIcon`  \n A handle to an icon that you can use as a button's image.  \n  \n##  <a name=\"cmfcribbonundobutton__getactionnumber\"></a>  CMFCRibbonUndoButton::GetActionNumber  \n Determines the number of items that a user selected from the drop-down list.  \n  \n```  \nint GetActionNumber() const;\n\n \n```  \n  \n### Return Value  \n The number of items that a user selected.  \n  \n##  <a name=\"cmfcribbonundobutton__hasmenu\"></a>  CMFCRibbonUndoButton::HasMenu  \n Indicates whether the object contains a menu.  \n  \n```  \nvirtual BOOL HasMenu() const;\n\n \n```  \n  \n### Return Value  \n Always returns `TRUE`.  \n  \n### Remarks  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CMFCRibbonGallery Class](../../mfc/reference/cmfcribbongallery-class.md)   \n [CMFCRibbonButton Class](../../mfc/reference/cmfcribbonbutton-class.md)\n"}