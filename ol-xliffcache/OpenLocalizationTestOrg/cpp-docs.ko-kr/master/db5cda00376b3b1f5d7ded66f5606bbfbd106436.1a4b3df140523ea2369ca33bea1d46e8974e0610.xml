{"nodes":[{"pos":[12,65],"content":"OLE DB Resource Pooling and Services | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"OLE DB Resource Pooling and Services | Microsoft Docs","pos":[0,53]}]},{"content":"OLE DB Resource Pooling and Services","pos":[812,848]},{"content":"To work well with OLE DB pooling, or with any OLE DB service, your provider must support aggregation of all objects.","pos":[849,965]},{"content":"This is a requirement of any OLE DB 1.5 or later provider.","pos":[966,1024]},{"content":"It is critical for leveraging services.","pos":[1025,1064]},{"content":"Providers that do not support aggregation cannot be pooled and no additional services are provided.","pos":[1065,1164]},{"content":"To be pooled, providers must support the free thread model.","pos":[1171,1230]},{"content":"The resource pool determines the provider's thread model according to the <bpt id=\"p1\">**</bpt>DBPROP_THREADMODEL<ept id=\"p1\">**</ept> property.","pos":[1231,1337],"source":" The resource pool determines the provider's thread model according to the **DBPROP_THREADMODEL** property."},{"content":"If the provider has a global connection state that might change while the data source is in an initialized state, it should support the new <bpt id=\"p1\">**</bpt>DBPROP_RESETDATASOURCE<ept id=\"p1\">**</ept> property.","pos":[1344,1520],"source":"If the provider has a global connection state that might change while the data source is in an initialized state, it should support the new **DBPROP_RESETDATASOURCE** property."},{"content":"This property is called before a connection is reused and gives the provider the opportunity to clean up state before its next use.","pos":[1521,1652]},{"content":"If the provider cannot clean up some state associated with the connection, it can return <bpt id=\"p1\">**</bpt>DBPROPSTATUS_NOTSETTABLE<ept id=\"p1\">**</ept> for the property and the connection will not be reused.","pos":[1653,1826],"source":" If the provider cannot clean up some state associated with the connection, it can return **DBPROPSTATUS_NOTSETTABLE** for the property and the connection will not be reused."},{"content":"Providers that connect to a remote database and can detect whether that connection might be lost should support the <bpt id=\"p1\">**</bpt>DBPROP_CONNECTIONSTATUS<ept id=\"p1\">**</ept> property.","pos":[1833,1986],"source":"Providers that connect to a remote database and can detect whether that connection might be lost should support the **DBPROP_CONNECTIONSTATUS** property."},{"content":"This property gives the OLE DB services the ability to detect dead connections and make sure they are not returned to the pool.","pos":[1987,2114]},{"content":"Finally, automatic transaction enlistment generally does not work unless it is implemented at the same level that pooling occurs.","pos":[2121,2250]},{"content":"Providers that support automatic transaction enlistment themselves should support disabling this enlistment by exposing the <bpt id=\"p1\">**</bpt>DBPROP_INIT_OLEDBSERVICES<ept id=\"p1\">**</ept> property and disabling enlistment if the <bpt id=\"p2\">**</bpt>DBPROPVAL_OS_TXNENLISTMENT<ept id=\"p2\">**</ept> is deselected.","pos":[2251,2491],"source":" Providers that support automatic transaction enlistment themselves should support disabling this enlistment by exposing the **DBPROP_INIT_OLEDBSERVICES** property and disabling enlistment if the **DBPROPVAL_OS_TXNENLISTMENT** is deselected."},{"content":"See Also","pos":[2500,2508]},{"content":"Advanced Provider Techniques","pos":[2513,2541]}],"content":"---\ntitle: \"OLE DB Resource Pooling and Services | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"resource pooling [OLE DB], provider requirements\"\n  - \"OLE DB, resource pooling\"\n  - \"service providers [OLE DB]\"\n  - \"OLE DB services [OLE DB], provider requirements\"\n  - \"OLE DB services [OLE DB]\"\n  - \"OLE DB providers, resource pooling\"\nms.assetid: 360c36e2-25ae-4caf-8ee7-d4a6b6898f68\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# OLE DB Resource Pooling and Services\nTo work well with OLE DB pooling, or with any OLE DB service, your provider must support aggregation of all objects. This is a requirement of any OLE DB 1.5 or later provider. It is critical for leveraging services. Providers that do not support aggregation cannot be pooled and no additional services are provided.  \n  \n To be pooled, providers must support the free thread model. The resource pool determines the provider's thread model according to the **DBPROP_THREADMODEL** property.  \n  \n If the provider has a global connection state that might change while the data source is in an initialized state, it should support the new **DBPROP_RESETDATASOURCE** property. This property is called before a connection is reused and gives the provider the opportunity to clean up state before its next use. If the provider cannot clean up some state associated with the connection, it can return **DBPROPSTATUS_NOTSETTABLE** for the property and the connection will not be reused.  \n  \n Providers that connect to a remote database and can detect whether that connection might be lost should support the **DBPROP_CONNECTIONSTATUS** property. This property gives the OLE DB services the ability to detect dead connections and make sure they are not returned to the pool.  \n  \n Finally, automatic transaction enlistment generally does not work unless it is implemented at the same level that pooling occurs. Providers that support automatic transaction enlistment themselves should support disabling this enlistment by exposing the **DBPROP_INIT_OLEDBSERVICES** property and disabling enlistment if the **DBPROPVAL_OS_TXNENLISTMENT** is deselected.  \n  \n## See Also  \n [Advanced Provider Techniques](../../data/oledb/advanced-provider-techniques.md)"}