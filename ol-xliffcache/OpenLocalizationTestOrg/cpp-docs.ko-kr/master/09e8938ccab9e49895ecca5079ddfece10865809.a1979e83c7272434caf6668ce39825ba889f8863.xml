{"nodes":[{"pos":[12,65],"content":"Adding an Interface to Your Provider | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Adding an Interface to Your Provider | Microsoft Docs","pos":[0,53]}]},{"content":"Adding an Interface to Your Provider","pos":[618,654]},{"content":"Determine which object you want to add the interface to (usually data source, rowset, command, or session objects created by the OLE DB Provider Wizard).","pos":[655,808]},{"content":"It is possible that the object you need to add the interface to is one that your provider does not currently support.","pos":[809,926]},{"content":"In that case, run the ATL OLE DB Provider Wizard to create the object.","pos":[927,997]},{"content":"Right-click the project in Class View, click <bpt id=\"p1\">**</bpt>Add Class<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> menu, and then click <bpt id=\"p3\">**</bpt>ATL OLE DB Provider<ept id=\"p3\">**</ept>.","pos":[998,1119],"source":" Right-click the project in Class View, click **Add Class** from the **Add** menu, and then click **ATL OLE DB Provider**."},{"content":"You might want to put the interface code in a separate directory and then copy the files to your provider project.","pos":[1120,1234]},{"content":"If you created a new class to support the interface, make the object inherit from that class.","pos":[1241,1334]},{"content":"For example, you might add the class <bpt id=\"p1\">**</bpt>IRowsetIndexImpl<ept id=\"p1\">**</ept> to a rowset object:","pos":[1335,1412],"source":" For example, you might add the class **IRowsetIndexImpl** to a rowset object:"},{"content":"Add the interface to <bpt id=\"p1\">**</bpt>COM_MAP<ept id=\"p1\">**</ept> in the object using the COM_INTERFACE_ENTRY macro.","pos":[1588,1671],"source":"Add the interface to **COM_MAP** in the object using the COM_INTERFACE_ENTRY macro."},{"content":"If there is no map, create one.","pos":[1672,1703]},{"content":"For example:","pos":[1704,1716]},{"content":"For the rowset object, chain the map of its parent object so that the object can delegate to the parent class.","pos":[1825,1935]},{"content":"In this example, add the COM_INTERFACE_ENTRY_CHAIN macro to the map:","pos":[1936,2004]},{"content":"See Also","pos":[2161,2169]},{"content":"Working with OLE DB Provider Templates","pos":[2174,2212]}],"content":"---\ntitle: \"Adding an Interface to Your Provider | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE DB provider templates, object interfaces\"\nms.assetid: b0fc7cf8-428a-4584-9d64-ce9074d0eb66\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Adding an Interface to Your Provider\nDetermine which object you want to add the interface to (usually data source, rowset, command, or session objects created by the OLE DB Provider Wizard). It is possible that the object you need to add the interface to is one that your provider does not currently support. In that case, run the ATL OLE DB Provider Wizard to create the object. Right-click the project in Class View, click **Add Class** from the **Add** menu, and then click **ATL OLE DB Provider**. You might want to put the interface code in a separate directory and then copy the files to your provider project.  \n  \n If you created a new class to support the interface, make the object inherit from that class. For example, you might add the class **IRowsetIndexImpl** to a rowset object:  \n  \n```  \ntemplate <class Creator>  \nclass CAgentRowset :   \npublic CRowsetImpl< CAgentRowset<Creator>, CAgentMan, Creator>,  \n   public IRowsetIndexImpl< ... >   \n```  \n  \n Add the interface to **COM_MAP** in the object using the COM_INTERFACE_ENTRY macro. If there is no map, create one. For example:  \n  \n```  \nBEGIN_COM_MAP(CAgentRowset)  \n     COM_INTERFACE_ENTRY(IRowsetIndex)  \nEND_COM_MAP()  \n```  \n  \n For the rowset object, chain the map of its parent object so that the object can delegate to the parent class. In this example, add the COM_INTERFACE_ENTRY_CHAIN macro to the map:  \n  \n```  \nBEGIN_COM_MAP(CAgentRowset)  \n     COM_INTERFACE_ENTRY(IRowsetIndex)  \n     COM_INTERFACE_ENTRY_CHAIN(CRowsetImpl)  \nEND_COM_MAP()  \n```  \n  \n## See Also  \n [Working with OLE DB Provider Templates](../../data/oledb/working-with-ole-db-provider-templates.md)"}