{"nodes":[{"pos":[12,81],"content":"Using Multiple Result Sets from One Stored Procedure | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using Multiple Result Sets from One Stored Procedure | Microsoft Docs","pos":[0,69]}]},{"content":"Using Multiple Result Sets from One Stored Procedure","pos":[657,709]},{"content":"Most stored procedures return multiple result sets.","pos":[710,761]},{"content":"Such a stored procedure usually includes one or more select statements.","pos":[762,833]},{"content":"The consumer needs to consider this to handle all the result sets.","pos":[834,900]},{"content":"To handle multiple result sets","pos":[910,940]},{"content":"Create a <ph id=\"ph1\">`CCommand`</ph> class with <ph id=\"ph2\">`CMultipleResults`</ph> as a template argument and with the accessor of your choice.","pos":[950,1060],"source":"Create a `CCommand` class with `CMultipleResults` as a template argument and with the accessor of your choice."},{"content":"Usually, this is a dynamic or manual accessor.","pos":[1061,1107]},{"content":"If you use another type of accessor, you might not be able to determine the output columns for each rowset.","pos":[1108,1215]},{"pos":[1225,1348],"content":"Execute the stored procedure as usual and bind the columns (see <bpt id=\"p1\">[</bpt>How Do I Fetch Data?<ept id=\"p1\">](../../data/oledb/fetching-data.md)</ept>).","source":"Execute the stored procedure as usual and bind the columns (see [How Do I Fetch Data?](../../data/oledb/fetching-data.md))."},{"content":"Use the data.","pos":[1358,1371]},{"content":"Call <ph id=\"ph1\">`GetNextResult`</ph> on the <ph id=\"ph2\">`CCommand`</ph> class.","pos":[1381,1426],"source":"Call `GetNextResult` on the `CCommand` class."},{"content":"If another result rowset is available, <ph id=\"ph1\">`GetNextResult`</ph> returns S_OK and you should rebind your columns if you are using a manual accessor.","pos":[1427,1565],"source":" If another result rowset is available, `GetNextResult` returns S_OK and you should rebind your columns if you are using a manual accessor."},{"content":"If <ph id=\"ph1\">`GetNextResult`</ph> returns an error, there are no further result sets available.","pos":[1566,1646],"source":" If `GetNextResult` returns an error, there are no further result sets available."},{"content":"See Also","pos":[1655,1663]},{"content":"Using Stored Procedures","pos":[1668,1691]}],"content":"---\ntitle: \"Using Multiple Result Sets from One Stored Procedure | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"stored procedures, returning result sets\"\n  - \"multiple result sets\"\nms.assetid: c450c12c-a76c-4ae4-9675-071a41eeac05\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Using Multiple Result Sets from One Stored Procedure\nMost stored procedures return multiple result sets. Such a stored procedure usually includes one or more select statements. The consumer needs to consider this to handle all the result sets.  \n  \n### To handle multiple result sets  \n  \n1.  Create a `CCommand` class with `CMultipleResults` as a template argument and with the accessor of your choice. Usually, this is a dynamic or manual accessor. If you use another type of accessor, you might not be able to determine the output columns for each rowset.  \n  \n2.  Execute the stored procedure as usual and bind the columns (see [How Do I Fetch Data?](../../data/oledb/fetching-data.md)).  \n  \n3.  Use the data.  \n  \n4.  Call `GetNextResult` on the `CCommand` class. If another result rowset is available, `GetNextResult` returns S_OK and you should rebind your columns if you are using a manual accessor. If `GetNextResult` returns an error, there are no further result sets available.  \n  \n## See Also  \n [Using Stored Procedures](../../data/oledb/using-stored-procedures.md)"}