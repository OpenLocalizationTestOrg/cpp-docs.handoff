{"nodes":[{"pos":[12,54],"content":"GetCodeForDllCanUnloadNow | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"GetCodeForDllCanUnloadNow | Microsoft Docs","pos":[0,42]}]},{"content":"GetCodeForDllCanUnloadNow","pos":[641,666]},{"content":"Gets the appropriate code for unloading the DLL.","pos":[667,715]},{"content":"Syntax","pos":[724,730]},{"content":"Parameters","pos":[843,853]},{"content":"The zero-based line number for the start of the function.","pos":[873,930]},{"content":"The zero-based line number for the end of the function.","pos":[951,1006]},{"content":"Return Value","pos":[1015,1027]},{"content":"A string containing the code for unloading the DLL.","pos":[1031,1082]},{"content":"Remarks","pos":[1091,1098]},{"content":"Call this member function to retrieve the appropriate code for unloading the DLL.","pos":[1102,1183]},{"content":"Calling this function creates a single string by concatenating the array elements you specify.","pos":[1184,1278]},{"content":"The following table shows code for unloading the DLL.","pos":[1285,1338]},{"content":"Line number","pos":[1345,1356]},{"content":"Code","pos":[1357,1361]},{"content":"0","pos":[1399,1400]},{"content":"AFX_MANAGE_STATE(AfxGetStaticModuleState());","pos":[1401,1445]},{"content":"1","pos":[1450,1451]},{"content":"if (_AtlModule.GetLockCount() &gt; 0)","pos":[1452,1486],"source":"if (_AtlModule.GetLockCount() > 0)"},{"content":"2","pos":[1491,1492]},{"content":"\\treturn S_FALSE;","pos":[1493,1510]},{"content":"3","pos":[1515,1516]},{"content":"return S_OK;","pos":[1517,1529]},{"pos":[1537,1699],"content":"For each of the lines returned, <ph id=\"ph1\">`GetCodeForDllCanUnloadNow`</ph> adds a leading tab (<ph id=\"ph2\">`\\t`</ph>) and a trailing \"CR-LF\" (carriage return - linefeed) character pair (<ph id=\"ph3\">`\\r\\n`</ph>).","source":"For each of the lines returned, `GetCodeForDllCanUnloadNow` adds a leading tab (`\\t`) and a trailing \"CR-LF\" (carriage return - linefeed) character pair (`\\r\\n`)."},{"content":"Example","pos":[1708,1715]},{"content":"See Also","pos":[1926,1934]},{"content":"Customizing C++ Wizards with Common JScript Functions","pos":[1939,1992]},{"content":"JScript Functions for C++ Wizards","pos":[2064,2097]},{"content":"Creating a Custom Wizard","pos":[2149,2173]},{"content":"Designing a Wizard","pos":[2216,2234]},{"content":"GetCodeForDllGetClassObject","pos":[2271,2298]},{"content":"GetCodeForExitInstance","pos":[2344,2366]}],"content":"---\ntitle: \"GetCodeForDllCanUnloadNow | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"GetCodeForDllCanUnloadNow\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetCodeForDllCanUnloadNow method\"\nms.assetid: 24ee3ef7-45be-4778-99e8-6df493f0782b\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# GetCodeForDllCanUnloadNow\nGets the appropriate code for unloading the DLL.  \n  \n## Syntax  \n  \n```  \n  \n      function GetCodeForDllCanUnloadNow(   \n   nLineStart,   \n   nLineEnd    \n);  \n```  \n  \n#### Parameters  \n `nLineStart`  \n The zero-based line number for the start of the function.  \n  \n `nLineEnd`  \n The zero-based line number for the end of the function.  \n  \n## Return Value  \n A string containing the code for unloading the DLL.  \n  \n## Remarks  \n Call this member function to retrieve the appropriate code for unloading the DLL. Calling this function creates a single string by concatenating the array elements you specify.  \n  \n The following table shows code for unloading the DLL.  \n  \n|Line number|Code|  \n|-----------------|----------|  \n|0|AFX_MANAGE_STATE(AfxGetStaticModuleState());|  \n|1|if (_AtlModule.GetLockCount() > 0)|  \n|2|\\treturn S_FALSE;|  \n|3|return S_OK;|  \n  \n For each of the lines returned, `GetCodeForDllCanUnloadNow` adds a leading tab (`\\t`) and a trailing \"CR-LF\" (carriage return - linefeed) character pair (`\\r\\n`).  \n  \n## Example  \n  \n```  \n// Get the lines numbered 1 and 2 above  \nGetCodeForDllCanUnloadNow(1, 2)  \n  \n// returns the following string  \n// \"\\tif (_AtlModule.GetLockCount() > 0)\\r\\n\\t\\treturn S_FALSE;\\r\\n\"  \n  \n```  \n  \n## See Also  \n [Customizing C++ Wizards with Common JScript Functions](../ide/customizing-cpp-wizards-with-common-jscript-functions.md)   \n [JScript Functions for C++ Wizards](../ide/jscript-functions-for-cpp-wizards.md)   \n [Creating a Custom Wizard](../ide/creating-a-custom-wizard.md)   \n [Designing a Wizard](../ide/designing-a-wizard.md)   \n [GetCodeForDllGetClassObject](../ide/getcodefordllgetclassobject.md)   \n [GetCodeForExitInstance](../ide/getcodeforexitinstance.md)"}