{"nodes":[{"pos":[12,50],"content":"Accessors and Rowsets | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Accessors and Rowsets | Microsoft Docs","pos":[0,38]}]},{"content":"Accessors and Rowsets","pos":[1009,1030]},{"content":"To set and retrieve data, OLE DB Templates use an accessor and a rowset through the <bpt id=\"p1\">[</bpt>CAccessorRowset<ept id=\"p1\">](../../data/oledb/caccessorrowset-class.md)</ept> class.","pos":[1031,1182],"source":"To set and retrieve data, OLE DB Templates use an accessor and a rowset through the [CAccessorRowset](../../data/oledb/caccessorrowset-class.md) class."},{"content":"This class can handle multiple accessors of different types.","pos":[1183,1243]},{"content":"Accessor Types","pos":[1252,1266]},{"content":"All accessors derive from <bpt id=\"p1\">[</bpt>CAccessorBase<ept id=\"p1\">](../../data/oledb/caccessorbase-class.md)</ept>.","pos":[1270,1353],"source":"All accessors derive from [CAccessorBase](../../data/oledb/caccessorbase-class.md)."},{"content":"provides both parameter and column binding.","pos":[1370,1413]},{"content":"The following figure shows the accessor types.","pos":[1420,1466]},{"content":"Accessor types","pos":[1475,1489]},{"content":"Accessor Classes","pos":[1555,1571]},{"content":"<bpt id=\"p1\">[</bpt>CAccessor<ept id=\"p1\">](../../data/oledb/caccessor-class.md)</ept> Use this accessor when you know the structure of the database source at design time.","pos":[1581,1714],"source":"[CAccessor](../../data/oledb/caccessor-class.md) Use this accessor when you know the structure of the database source at design time."},{"content":"statically binds a database record, which contains the buffer, to the data source.","pos":[1727,1809]},{"content":"<bpt id=\"p1\">[</bpt>CDynamicAccessor<ept id=\"p1\">](../../data/oledb/cdynamicaccessor-class.md)</ept> Use this accessor when you do not know the structure of the database at design time.","pos":[1819,1966],"source":"[CDynamicAccessor](../../data/oledb/cdynamicaccessor-class.md) Use this accessor when you do not know the structure of the database at design time."},{"content":"calls <ph id=\"ph1\">`IColumnsInfo::GetColumnInfo`</ph> to get the database column information.","pos":[1986,2061],"source":" calls `IColumnsInfo::GetColumnInfo` to get the database column information."},{"content":"It creates and manages an accessor and the buffer.","pos":[2062,2112]},{"content":"<bpt id=\"p1\">[</bpt>CDynamicParameterAccessor<ept id=\"p1\">](../../data/oledb/cdynamicparameteraccessor-class.md)</ept> Use this accessor to handle unknown command types.","pos":[2122,2253],"source":"[CDynamicParameterAccessor](../../data/oledb/cdynamicparameteraccessor-class.md) Use this accessor to handle unknown command types."},{"content":"When you prepare the commands, <ph id=\"ph1\">`CDynamicParameterAccessor`</ph> can get parameter information from the <ph id=\"ph2\">`ICommandWithParameters`</ph> interface, if the provider supports <ph id=\"ph3\">`ICommandWithParameters`</ph>.","pos":[2254,2438],"source":" When you prepare the commands, `CDynamicParameterAccessor` can get parameter information from the `ICommandWithParameters` interface, if the provider supports `ICommandWithParameters`."},{"content":"<bpt id=\"p1\">[</bpt>CDynamicStringAccessor<ept id=\"p1\">](../../data/oledb/cdynamicstringaccessor-class.md)</ept>, <bpt id=\"p2\">[</bpt>CDynamicStringAccessorA<ept id=\"p2\">](../../data/oledb/cdynamicstringaccessora-class.md)</ept>, and <bpt id=\"p3\">[</bpt>CDynamicStringAccessorW<ept id=\"p3\">](../../data/oledb/cdynamicstringaccessorw-class.md)</ept> Use these classes when you have no knowledge of the database schema.","pos":[2448,2751],"source":"[CDynamicStringAccessor](../../data/oledb/cdynamicstringaccessor-class.md), [CDynamicStringAccessorA](../../data/oledb/cdynamicstringaccessora-class.md), and [CDynamicStringAccessorW](../../data/oledb/cdynamicstringaccessorw-class.md) Use these classes when you have no knowledge of the database schema."},{"content":"retrieves data as ANSI strings; <ph id=\"ph1\">`CDynamicStringAccessorW`</ph> retrieves data as Unicode strings.","pos":[2778,2870],"source":" retrieves data as ANSI strings; `CDynamicStringAccessorW` retrieves data as Unicode strings."},{"content":"<bpt id=\"p1\">[</bpt>CManualAccessor<ept id=\"p1\">](../../data/oledb/cmanualaccessor-class.md)</ept> With this class, you can use whatever data types you want if the provider can convert the type.","pos":[2880,3036],"source":"[CManualAccessor](../../data/oledb/cmanualaccessor-class.md) With this class, you can use whatever data types you want if the provider can convert the type."},{"content":"It handles both result columns and command parameters.","pos":[3037,3091]},{"content":"The following table summarizes the support in the OLE DB Template accessor types.","pos":[3098,3179]},{"content":"Accessor type","pos":[3186,3199]},{"content":"Dynamic","pos":[3200,3207]},{"content":"Handles params","pos":[3208,3222]},{"content":"Buffer","pos":[3223,3229]},{"content":"Multiple accessors","pos":[3230,3248]},{"content":"No","pos":[3362,3364]},{"content":"Yes","pos":[3365,3368]},{"content":"User","pos":[3369,3373]},{"content":"Yes","pos":[3374,3377]},{"content":"Yes","pos":[3401,3404]},{"content":"No","pos":[3405,3407]},{"content":"OLE DB Templates","pos":[3408,3424]},{"content":"No","pos":[3425,3427]},{"content":"Yes","pos":[3460,3463]},{"content":"Yes","pos":[3464,3467]},{"content":"OLE DB Templates","pos":[3468,3484]},{"content":"No","pos":[3485,3487]},{"content":"Yes","pos":[3522,3525]},{"content":"No","pos":[3526,3528]},{"content":"OLE DB Templates","pos":[3529,3545]},{"content":"No","pos":[3546,3548]},{"content":"Yes","pos":[3571,3574]},{"content":"Yes","pos":[3575,3578]},{"content":"User","pos":[3579,3583]},{"content":"Yes","pos":[3584,3587]},{"content":"Rowset Types","pos":[3597,3609]},{"content":"The OLE DB Templates support three kinds of rowsets (see the preceding figure): single rowsets (implemented by <bpt id=\"p1\">[</bpt>CRowset<ept id=\"p1\">](../../data/oledb/crowset-class.md)</ept>), bulk rowsets (implemented by <bpt id=\"p2\">[</bpt>CBulkRowset<ept id=\"p2\">](../../data/oledb/cbulkrowset-class.md)</ept>), and array rowsets (implemented by <bpt id=\"p3\">[</bpt>CArrayRowset<ept id=\"p3\">](../../data/oledb/carrayrowset-class.md)</ept>).","pos":[3613,3945],"source":"The OLE DB Templates support three kinds of rowsets (see the preceding figure): single rowsets (implemented by [CRowset](../../data/oledb/crowset-class.md)), bulk rowsets (implemented by [CBulkRowset](../../data/oledb/cbulkrowset-class.md)), and array rowsets (implemented by [CArrayRowset](../../data/oledb/carrayrowset-class.md))."},{"content":"Single rowsets fetch a single row handle when <ph id=\"ph1\">`MoveNext`</ph> is called.","pos":[3946,4013],"source":" Single rowsets fetch a single row handle when `MoveNext` is called."},{"content":"Bulk rowsets can fetch multiple row handles.","pos":[4014,4058]},{"content":"Array rowsets are rowsets that can be accessed using array syntax.","pos":[4059,4125]},{"content":"The following figure shows the rowset types.","pos":[4132,4176]},{"content":"RowsetType graphic","pos":[4185,4203]},{"content":"Rowset Classes","pos":[4265,4279]},{"content":"<bpt id=\"p1\">[</bpt>Schema rowsets<ept id=\"p1\">](../../data/oledb/obtaining-metadata-with-schema-rowsets.md)</ept> do not access data in the data store but instead access information about the data store, called metadata.","pos":[4286,4469],"source":"[Schema rowsets](../../data/oledb/obtaining-metadata-with-schema-rowsets.md) do not access data in the data store but instead access information about the data store, called metadata."},{"content":"Schema rowsets are typically used in situations in which the database structure is not known at compile time and must be obtained at run time.","pos":[4470,4612]},{"content":"See Also","pos":[4621,4629]},{"content":"OLE DB Consumer Templates","pos":[4634,4659]}],"content":"---\ntitle: \"Accessors and Rowsets | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"accessors [C++]\"\n  - \"OLE DB consumer templates, rowset support\"\n  - \"OLE DB consumer templates, accessors\"\n  - \"rowsets [C++], accessing\"\n  - \"bulk rowsets\"\n  - \"CAccessorRowset class, accessor types\"\n  - \"single rowsets\"\n  - \"CArrayRowset class, accessors\"\n  - \"CBulkRowset class, accessors\"\n  - \"array rowsets\"\n  - \"CAccessorBase class\"\n  - \"CRowset class, accessors and rowsets\"\n  - \"accessors [C++], rowsets\"\n  - \"rowsets [C++], supported types\"\nms.assetid: edc9c8b3-1a2d-4c2d-869f-7e058c631042\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Accessors and Rowsets\nTo set and retrieve data, OLE DB Templates use an accessor and a rowset through the [CAccessorRowset](../../data/oledb/caccessorrowset-class.md) class. This class can handle multiple accessors of different types.  \n  \n## Accessor Types  \n All accessors derive from [CAccessorBase](../../data/oledb/caccessorbase-class.md). `CAccessorBase` provides both parameter and column binding.  \n  \n The following figure shows the accessor types.  \n  \n ![Accessor types](../../data/oledb/media/vcaccessortypes.gif \"vcaccessortypes\")  \nAccessor Classes  \n  \n-   [CAccessor](../../data/oledb/caccessor-class.md) Use this accessor when you know the structure of the database source at design time. `CAccessor` statically binds a database record, which contains the buffer, to the data source.  \n  \n-   [CDynamicAccessor](../../data/oledb/cdynamicaccessor-class.md) Use this accessor when you do not know the structure of the database at design time. `CDynamicAccessor` calls `IColumnsInfo::GetColumnInfo` to get the database column information. It creates and manages an accessor and the buffer.  \n  \n-   [CDynamicParameterAccessor](../../data/oledb/cdynamicparameteraccessor-class.md) Use this accessor to handle unknown command types. When you prepare the commands, `CDynamicParameterAccessor` can get parameter information from the `ICommandWithParameters` interface, if the provider supports `ICommandWithParameters`.  \n  \n-   [CDynamicStringAccessor](../../data/oledb/cdynamicstringaccessor-class.md), [CDynamicStringAccessorA](../../data/oledb/cdynamicstringaccessora-class.md), and [CDynamicStringAccessorW](../../data/oledb/cdynamicstringaccessorw-class.md) Use these classes when you have no knowledge of the database schema. `CDynamicStringAccessorA` retrieves data as ANSI strings; `CDynamicStringAccessorW` retrieves data as Unicode strings.  \n  \n-   [CManualAccessor](../../data/oledb/cmanualaccessor-class.md) With this class, you can use whatever data types you want if the provider can convert the type. It handles both result columns and command parameters.  \n  \n The following table summarizes the support in the OLE DB Template accessor types.  \n  \n|Accessor type|Dynamic|Handles params|Buffer|Multiple accessors|  \n|-------------------|-------------|--------------------|------------|------------------------|  \n|`CAccessor`|No|Yes|User|Yes|  \n|`CDynamicAccessor`|Yes|No|OLE DB Templates|No|  \n|`CDynamicParameterAccessor`|Yes|Yes|OLE DB Templates|No|  \n|`CDynamicStringAccessor[A,W]`|Yes|No|OLE DB Templates|No|  \n|`CManualAccessor`|Yes|Yes|User|Yes|  \n  \n## Rowset Types  \n The OLE DB Templates support three kinds of rowsets (see the preceding figure): single rowsets (implemented by [CRowset](../../data/oledb/crowset-class.md)), bulk rowsets (implemented by [CBulkRowset](../../data/oledb/cbulkrowset-class.md)), and array rowsets (implemented by [CArrayRowset](../../data/oledb/carrayrowset-class.md)). Single rowsets fetch a single row handle when `MoveNext` is called. Bulk rowsets can fetch multiple row handles. Array rowsets are rowsets that can be accessed using array syntax.  \n  \n The following figure shows the rowset types.  \n  \n ![RowsetType graphic](../../data/oledb/media/vcrowsettypes.gif \"vcrowsettypes\")  \nRowset Classes  \n  \n [Schema rowsets](../../data/oledb/obtaining-metadata-with-schema-rowsets.md) do not access data in the data store but instead access information about the data store, called metadata. Schema rowsets are typically used in situations in which the database structure is not known at compile time and must be obtained at run time.  \n  \n## See Also  \n [OLE DB Consumer Templates](../../data/oledb/ole-db-consumer-templates-cpp.md)"}