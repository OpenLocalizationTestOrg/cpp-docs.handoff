{"nodes":[{"pos":[12,49],"content":"COleStreamFile Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleStreamFile Class | Microsoft Docs","pos":[0,37]}]},{"content":"COleStreamFile Class","pos":[796,816]},{"pos":[817,911],"content":"Represents a stream of data ( <ph id=\"ph1\">`IStream`</ph>) in a compound file as part of OLE Structured Storage.","source":"Represents a stream of data ( `IStream`) in a compound file as part of OLE Structured Storage."},{"content":"Syntax","pos":[920,926]},{"content":"Members","pos":[988,995]},{"content":"Public Constructors","pos":[1005,1024]},{"content":"Name","pos":[1031,1035]},{"content":"Description","pos":[1036,1047]},{"content":"COleStreamFile::COleStreamFile","pos":[1086,1116]},{"pos":[1151,1188],"content":"Constructs a <ph id=\"ph1\">`COleStreamFile`</ph> object.","source":"Constructs a `COleStreamFile` object."},{"content":"Public Methods","pos":[1199,1213]},{"content":"Name","pos":[1220,1224]},{"content":"Description","pos":[1225,1236]},{"content":"COleStreamFile::Attach","pos":[1275,1297]},{"content":"Associates a stream with the object.","pos":[1324,1360]},{"content":"COleStreamFile::CreateMemoryStream","pos":[1366,1400]},{"content":"Creates a stream from global memory and associates it with the object.","pos":[1439,1509]},{"content":"COleStreamFile::CreateStream","pos":[1515,1543]},{"content":"Creates a stream and associates it with the object.","pos":[1576,1627]},{"content":"COleStreamFile::Detach","pos":[1633,1655]},{"content":"Disassociates the stream from the object.","pos":[1682,1723]},{"content":"COleStreamFile::GetStream","pos":[1729,1754]},{"content":"Returns the current stream.","pos":[1784,1811]},{"content":"COleStreamFile::OpenStream","pos":[1817,1843]},{"content":"Safely opens a stream and associates it with the object.","pos":[1874,1930]},{"content":"Remarks","pos":[1940,1947]},{"pos":[1951,2055],"content":"An <ph id=\"ph1\">`IStorage`</ph> object must exist before the stream can be opened or created unless it is a memory stream.","source":"An `IStorage` object must exist before the stream can be opened or created unless it is a memory stream."},{"pos":[2079,2168],"content":"objects are manipulated exactly like <bpt id=\"p1\">[</bpt>CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md)</ept> objects.","source":" objects are manipulated exactly like [CFile](../../mfc/reference/cfile-class.md) objects."},{"pos":[2175,2323],"content":"For more information about manipulating streams and storages, see the article <bpt id=\"p1\">[</bpt>Containers: Compound Files<ept id=\"p1\">](../../mfc/containers-compound-files.md)</ept>..","source":"For more information about manipulating streams and storages, see the article [Containers: Compound Files](../../mfc/containers-compound-files.md).."},{"pos":[2330,2560],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> and <bpt id=\"p2\">[</bpt>IStorage<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/aa380015)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) and [IStorage](http://msdn.microsoft.com/library/windows/desktop/aa380015) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Inheritance Hierarchy","pos":[2569,2590]},{"content":"CObject","pos":[2595,2602]},{"content":"CFile","pos":[2649,2654]},{"content":"Requirements","pos":[2723,2735]},{"pos":[2739,2759],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxole.h","source":"**Header:** afxole.h"},{"pos":[2808,2830],"content":"COleStreamFile::Attach"},{"pos":[2834,2902],"content":"Associates the supplied OLE stream with the <ph id=\"ph1\">`COleStreamFile`</ph> object.","source":"Associates the supplied OLE stream with the `COleStreamFile` object."},{"content":"Parameters","pos":[2959,2969]},{"content":"Points to the OLE stream ( <ph id=\"ph1\">`IStream`</ph>) to be associated with the object.","pos":[2987,3058],"source":" Points to the OLE stream ( `IStream`) to be associated with the object."},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[3059,3078],"source":" Cannot be **NULL**."},{"content":"Remarks","pos":[3088,3095]},{"content":"The object must not already be associated with an OLE stream.","pos":[3099,3160]},{"pos":[3167,3322],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3379,3409],"content":"COleStreamFile::COleStreamFile"},{"pos":[3413,3447],"content":"Creates a <ph id=\"ph1\">`COleStreamFile`</ph> object.","source":"Creates a `COleStreamFile` object."},{"content":"Parameters","pos":[3514,3524]},{"content":"Pointer to the OLE stream to be associated with the object.","pos":[3542,3601]},{"content":"Remarks","pos":[3611,3618]},{"pos":[3622,3763],"content":"If <ph id=\"ph1\">`lpStream`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the object is not associated with an OLE stream, otherwise, the object is associated with the supplied OLE stream.","source":"If `lpStream` is **NULL**, the object is not associated with an OLE stream, otherwise, the object is associated with the supplied OLE stream."},{"pos":[3770,3925],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3986,4020],"content":"COleStreamFile::CreateMemoryStream"},{"content":"Safely creates a new stream out of global, shared memory where a failure is a normal, expected condition.","pos":[4024,4129]},{"content":"Parameters","pos":[4210,4220]},{"content":"Points to a <bpt id=\"p1\">[</bpt>CFileException<ept id=\"p1\">](../../mfc/reference/cfileexception-class.md)</ept> object or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> that indicates the completion status of the create operation.","pos":[4236,4390],"source":" Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL** that indicates the completion status of the create operation."},{"content":"Supply this parameter if you want to monitor possible exceptions generated by attempting to create the stream.","pos":[4391,4501]},{"content":"Return Value","pos":[4511,4523]},{"content":"Nonzero if the stream is created successfully; otherwise 0.","pos":[4527,4586]},{"content":"Remarks","pos":[4596,4603]},{"content":"The memory is allocated by the OLE subsystem.","pos":[4607,4652]},{"pos":[4659,4828],"content":"For more information, see <bpt id=\"p1\">[</bpt>CreateStreamOnHGlobal<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa378980)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [CreateStreamOnHGlobal](http://msdn.microsoft.com/library/windows/desktop/aa378980) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4883,4911],"content":"COleStreamFile::CreateStream"},{"content":"Safely creates a new stream in the supplied storage object where a failure is a normal, expected condition.","pos":[4915,5022]},{"content":"Parameters","pos":[5225,5235]},{"content":"Points to the OLE storage object that contains the stream to be created.","pos":[5254,5326]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[5327,5346],"source":" Cannot be **NULL**."},{"content":"Name of the stream to be created.","pos":[5373,5406]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[5407,5426],"source":" Cannot be **NULL**."},{"content":"Access mode to use when opening the stream.","pos":[5449,5492]},{"content":"Exclusive, read/write, and create modes are used by default.","pos":[5493,5553]},{"content":"For a complete list of the available modes, see <bpt id=\"p1\">[</bpt>CFile::CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md#cfile__cfile)</ept>.","pos":[5554,5666],"source":" For a complete list of the available modes, see [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile)."},{"content":"Points to a <bpt id=\"p1\">[</bpt>CFileException<ept id=\"p1\">](../../mfc/reference/cfileexception-class.md)</ept> object or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","pos":[5685,5778],"source":" Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL**."},{"content":"Supply this parameter if you want to monitor possible exceptions generated by attempting to create the stream.","pos":[5779,5889]},{"content":"Return Value","pos":[5899,5911]},{"content":"Nonzero if the stream is created successfully; otherwise 0.","pos":[5915,5974]},{"content":"Remarks","pos":[5984,5991]},{"pos":[5995,6074],"content":"A file exception will be thrown if the open fails and <ph id=\"ph1\">`pError`</ph> is not <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"A file exception will be thrown if the open fails and `pError` is not **NULL**."},{"pos":[6081,6251],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStorage::CreateStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380020)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStorage::CreateStream](http://msdn.microsoft.com/library/windows/desktop/aa380020) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6300,6322],"content":"COleStreamFile::Detach"},{"content":"Disassociates the stream from the object without closing the stream.","pos":[6326,6394]},{"content":"Return Value","pos":[6438,6450]},{"pos":[6454,6527],"content":"A pointer to the stream ( <ph id=\"ph1\">`IStream`</ph>) that was associated with the object.","source":"A pointer to the stream ( `IStream`) that was associated with the object."},{"content":"Remarks","pos":[6537,6544]},{"content":"The stream must be closed in some other fashion before the program terminates.","pos":[6548,6626]},{"pos":[6633,6788],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6840,6865],"content":"COleStreamFile::GetStream"},{"content":"Call this function to return a pointer to current stream.","pos":[6869,6926]},{"content":"Return Value","pos":[6982,6994]},{"pos":[6998,7113],"content":"A pointer to the current stream interface ( <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept>).","source":"A pointer to the current stream interface ( [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034))."},{"pos":[7166,7192],"content":"COleStreamFile::OpenStream"},{"content":"Opens an existing stream.","pos":[7196,7221]},{"content":"Parameters","pos":[7411,7421]},{"content":"Points to the OLE storage object that contains the stream to be opened.","pos":[7440,7511]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[7512,7531],"source":" Cannot be **NULL**."},{"content":"Name of the stream to be opened.","pos":[7558,7590]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[7591,7610],"source":" Cannot be **NULL**."},{"content":"Access mode to use when opening the stream.","pos":[7633,7676]},{"content":"Exclusive and read/write modes are used by default.","pos":[7677,7728]},{"content":"For the complete list of the available modes, see <bpt id=\"p1\">[</bpt>CFile::CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md#cfile__cfile)</ept>.","pos":[7729,7843],"source":" For the complete list of the available modes, see [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile)."},{"content":"Points to a <bpt id=\"p1\">[</bpt>CFileException<ept id=\"p1\">](../../mfc/reference/cfileexception-class.md)</ept> object or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","pos":[7862,7955],"source":" Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL**."},{"content":"Supply this parameter if you want to monitor possible exceptions generated by attempting to open the stream.","pos":[7956,8064]},{"content":"Return Value","pos":[8074,8086]},{"content":"Nonzero if the stream is opened successfully; otherwise 0.","pos":[8090,8148]},{"content":"Remarks","pos":[8158,8165]},{"pos":[8169,8248],"content":"A file exception will be thrown if the open fails and <ph id=\"ph1\">`pError`</ph> is not <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"A file exception will be thrown if the open fails and `pError` is not **NULL**."},{"pos":[8255,8423],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStorage::OpenStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380025)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStorage::OpenStream](http://msdn.microsoft.com/library/windows/desktop/aa380025) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"See Also","pos":[8432,8440]},{"content":"CFile Class","pos":[8445,8456]},{"content":"Hierarchy Chart","pos":[8499,8514]}],"content":"---\ntitle: \"COleStreamFile Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleStreamFile\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"data streams [C++]\"\n  - \"streams [C++], OLE\"\n  - \"data streams [C++], OLE\"\n  - \"structured storage in OLE\"\n  - \"OLE structured storage [C++]\"\n  - \"OLE [C++], streams of data\"\n  - \"COleStreamFile class\"\nms.assetid: e4f93698-e17c-4a18-a7c0-4b4df8eb4d93\ncaps.latest.revision: 22\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleStreamFile Class\nRepresents a stream of data ( `IStream`) in a compound file as part of OLE Structured Storage.  \n  \n## Syntax  \n  \n```  \nclass COleStreamFile : public CFile  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleStreamFile::COleStreamFile](#colestreamfile__colestreamfile)|Constructs a `COleStreamFile` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleStreamFile::Attach](#colestreamfile__attach)|Associates a stream with the object.|  \n|[COleStreamFile::CreateMemoryStream](#colestreamfile__creatememorystream)|Creates a stream from global memory and associates it with the object.|  \n|[COleStreamFile::CreateStream](#colestreamfile__createstream)|Creates a stream and associates it with the object.|  \n|[COleStreamFile::Detach](#colestreamfile__detach)|Disassociates the stream from the object.|  \n|[COleStreamFile::GetStream](#colestreamfile__getstream)|Returns the current stream.|  \n|[COleStreamFile::OpenStream](#colestreamfile__openstream)|Safely opens a stream and associates it with the object.|  \n  \n## Remarks  \n An `IStorage` object must exist before the stream can be opened or created unless it is a memory stream.  \n  \n `COleStreamFile` objects are manipulated exactly like [CFile](../../mfc/reference/cfile-class.md) objects.  \n  \n For more information about manipulating streams and storages, see the article [Containers: Compound Files](../../mfc/containers-compound-files.md)..  \n  \n For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) and [IStorage](http://msdn.microsoft.com/library/windows/desktop/aa380015) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CFile](../../mfc/reference/cfile-class.md)  \n  \n `COleStreamFile`  \n  \n## Requirements  \n **Header:** afxole.h  \n  \n##  <a name=\"colestreamfile__attach\"></a>  COleStreamFile::Attach  \n Associates the supplied OLE stream with the `COleStreamFile` object.  \n  \n```  \nvoid Attach(LPSTREAM lpStream);\n```  \n  \n### Parameters  \n `lpStream`  \n Points to the OLE stream ( `IStream`) to be associated with the object. Cannot be **NULL**.  \n  \n### Remarks  \n The object must not already be associated with an OLE stream.  \n  \n For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__colestreamfile\"></a>  COleStreamFile::COleStreamFile  \n Creates a `COleStreamFile` object.  \n  \n```  \nCOleStreamFile(LPSTREAM lpStream = NULL);\n```  \n  \n### Parameters  \n `lpStream`  \n Pointer to the OLE stream to be associated with the object.  \n  \n### Remarks  \n If `lpStream` is **NULL**, the object is not associated with an OLE stream, otherwise, the object is associated with the supplied OLE stream.  \n  \n For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__creatememorystream\"></a>  COleStreamFile::CreateMemoryStream  \n Safely creates a new stream out of global, shared memory where a failure is a normal, expected condition.  \n  \n```  \nBOOL CreateMemoryStream(CFileException* pError = NULL);\n```  \n  \n### Parameters  \n `pError`  \n Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL** that indicates the completion status of the create operation. Supply this parameter if you want to monitor possible exceptions generated by attempting to create the stream.  \n  \n### Return Value  \n Nonzero if the stream is created successfully; otherwise 0.  \n  \n### Remarks  \n The memory is allocated by the OLE subsystem.  \n  \n For more information, see [CreateStreamOnHGlobal](http://msdn.microsoft.com/library/windows/desktop/aa378980) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__createstream\"></a>  COleStreamFile::CreateStream  \n Safely creates a new stream in the supplied storage object where a failure is a normal, expected condition.  \n  \n```  \nBOOL CreateStream(\n    LPSTORAGE lpStorage,  \n    LPCTSTR lpszStreamName,  \n    DWORD nOpenFlags = modeReadWrite|shareExclusive|modeCreate,  \n    CFileException* pError = NULL);\n```  \n  \n### Parameters  \n `lpStorage`  \n Points to the OLE storage object that contains the stream to be created. Cannot be **NULL**.  \n  \n `lpszStreamName`  \n Name of the stream to be created. Cannot be **NULL**.  \n  \n `nOpenFlags`  \n Access mode to use when opening the stream. Exclusive, read/write, and create modes are used by default. For a complete list of the available modes, see [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile).  \n  \n `pError`  \n Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL**. Supply this parameter if you want to monitor possible exceptions generated by attempting to create the stream.  \n  \n### Return Value  \n Nonzero if the stream is created successfully; otherwise 0.  \n  \n### Remarks  \n A file exception will be thrown if the open fails and `pError` is not **NULL**.  \n  \n For more information, see [IStorage::CreateStream](http://msdn.microsoft.com/library/windows/desktop/aa380020) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__detach\"></a>  COleStreamFile::Detach  \n Disassociates the stream from the object without closing the stream.  \n  \n```  \nLPSTREAM Detach();\n```  \n  \n### Return Value  \n A pointer to the stream ( `IStream`) that was associated with the object.  \n  \n### Remarks  \n The stream must be closed in some other fashion before the program terminates.  \n  \n For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__getstream\"></a>  COleStreamFile::GetStream  \n Call this function to return a pointer to current stream.  \n  \n```  \nIStream* GetStream() const;\n\n \n```  \n  \n### Return Value  \n A pointer to the current stream interface ( [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034)).  \n  \n##  <a name=\"colestreamfile__openstream\"></a>  COleStreamFile::OpenStream  \n Opens an existing stream.  \n  \n```  \nBOOL OpenStream(\n    LPSTORAGE lpStorage,  \n    LPCTSTR lpszStreamName,  \n    DWORD nOpenFlags = modeReadWrite|shareExclusive,  \n    CFileException* pError = NULL);\n```  \n  \n### Parameters  \n `lpStorage`  \n Points to the OLE storage object that contains the stream to be opened. Cannot be **NULL**.  \n  \n `lpszStreamName`  \n Name of the stream to be opened. Cannot be **NULL**.  \n  \n `nOpenFlags`  \n Access mode to use when opening the stream. Exclusive and read/write modes are used by default. For the complete list of the available modes, see [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile).  \n  \n `pError`  \n Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL**. Supply this parameter if you want to monitor possible exceptions generated by attempting to open the stream.  \n  \n### Return Value  \n Nonzero if the stream is opened successfully; otherwise 0.  \n  \n### Remarks  \n A file exception will be thrown if the open fails and `pError` is not **NULL**.  \n  \n For more information, see [IStorage::OpenStream](http://msdn.microsoft.com/library/windows/desktop/aa380025) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [CFile Class](../../mfc/reference/cfile-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n\n\n"}