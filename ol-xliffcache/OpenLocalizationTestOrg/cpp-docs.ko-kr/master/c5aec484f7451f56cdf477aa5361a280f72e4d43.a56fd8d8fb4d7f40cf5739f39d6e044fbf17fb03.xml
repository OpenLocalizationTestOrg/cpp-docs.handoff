{"nodes":[{"pos":[12,72],"content":"TN071: MFC IOleCommandTarget Implementation | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"TN071: MFC IOleCommandTarget Implementation | Microsoft Docs","pos":[0,60]}]},{"content":"TN071: MFC IOleCommandTarget Implementation","pos":[658,701]},{"pos":[704,1019],"content":"[!NOTE]\n The following technical note has not been updated since it was first included in the online documentation. As a result, some procedures and topics might be out of date or incorrect. For the latest information, it is recommended that you search for the topic of interest in the online documentation index.","leadings":["","> "],"nodes":[{"content":" The following technical note has not been updated since it was first included in the online documentation. As a result, some procedures and topics might be out of date or incorrect. For the latest information, it is recommended that you search for the topic of interest in the online documentation index.","pos":[8,313],"nodes":[{"content":"The following technical note has not been updated since it was first included in the online documentation.","pos":[1,107]},{"content":"As a result, some procedures and topics might be out of date or incorrect.","pos":[108,182]},{"content":"For the latest information, it is recommended that you search for the topic of interest in the online documentation index.","pos":[183,305]}]}]},{"content":"The <ph id=\"ph1\">`IOleCommandTarget`</ph> interface enables objects and their containers to dispatch commands to each other.","pos":[1026,1132],"source":"The `IOleCommandTarget` interface enables objects and their containers to dispatch commands to each other."},{"content":"For example, an object's toolbars may contain buttons for commands such as <bpt id=\"p1\">**</bpt>Print<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Print Preview<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Save<ept id=\"p3\">**</ept>, <ph id=\"ph1\">`New`</ph>, and <bpt id=\"p4\">**</bpt>Zoom<ept id=\"p4\">**</ept>.","pos":[1133,1268],"source":" For example, an object's toolbars may contain buttons for commands such as **Print**, **Print Preview**, **Save**, `New`, and **Zoom**."},{"content":"If such an object were embedded in a container that supports <ph id=\"ph1\">`IOleCommandTarget`</ph>, the object could enable its buttons and forward the commands to the container for processing when the user clicked them.","pos":[1269,1471],"source":" If such an object were embedded in a container that supports `IOleCommandTarget`, the object could enable its buttons and forward the commands to the container for processing when the user clicked them."},{"content":"If a container wanted the embedded object to print itself, it could make this request by sending a command through the <ph id=\"ph1\">`IOleCommandTarget`</ph> interface of the embedded object.","pos":[1472,1644],"source":" If a container wanted the embedded object to print itself, it could make this request by sending a command through the `IOleCommandTarget` interface of the embedded object."},{"content":"is an Automation-like interface in that it is used by a client to invoke methods on a server.","pos":[1671,1764]},{"content":"However, using <ph id=\"ph1\">`IOleCommandTarget`</ph> saves the overhead of making calls via Automation interfaces because programmers don't have to use the typically expensive <ph id=\"ph2\">`Invoke`</ph> method of <ph id=\"ph3\">`IDispatch`</ph>.","pos":[1765,1954],"source":" However, using `IOleCommandTarget` saves the overhead of making calls via Automation interfaces because programmers don't have to use the typically expensive `Invoke` method of `IDispatch`."},{"content":"In MFC, the <ph id=\"ph1\">`IOleCommandTarget`</ph> interface is used by Active document servers to allow Active document containers to dispatch commands to the server.","pos":[1961,2109],"source":"In MFC, the `IOleCommandTarget` interface is used by Active document servers to allow Active document containers to dispatch commands to the server."},{"content":"The Active document server class, <ph id=\"ph1\">`CDocObjectServerItem`</ph>, uses MFC interface maps (see <bpt id=\"p1\">[</bpt>TN038: MFC/OLE IUnknown Implementation<ept id=\"p1\">](../mfc/tn038-mfc-ole-iunknown-implementation.md)</ept>) to implement the <ph id=\"ph2\">`IOleCommandTarget`</ph> interface.","pos":[2110,2335],"source":" The Active document server class, `CDocObjectServerItem`, uses MFC interface maps (see [TN038: MFC/OLE IUnknown Implementation](../mfc/tn038-mfc-ole-iunknown-implementation.md)) to implement the `IOleCommandTarget` interface."},{"content":"is also implemented in the <bpt id=\"p1\">**</bpt>COleFrameHook<ept id=\"p1\">**</ept> class.","pos":[2362,2413],"source":" is also implemented in the **COleFrameHook** class."},{"content":"<bpt id=\"p1\">**</bpt>COleFrameHook<ept id=\"p1\">**</ept> is an undocumented MFC class that implements the frame window functionality of in-place editing containers.","pos":[2414,2539],"source":"**COleFrameHook** is an undocumented MFC class that implements the frame window functionality of in-place editing containers."},{"content":"<bpt id=\"p1\">**</bpt>COleFrameHook<ept id=\"p1\">**</ept> also uses MFC interface maps to implement the <ph id=\"ph1\">`IOleCommandTarget`</ph> interface.","pos":[2540,2634],"source":"**COleFrameHook** also uses MFC interface maps to implement the `IOleCommandTarget` interface."},{"content":"<bpt id=\"p1\">**</bpt>COleFrameHook<ept id=\"p1\">**</ept>'s implementation of <ph id=\"ph1\">`IOleCommandTarget`</ph> forwards OLE commands to <ph id=\"ph2\">`COleDocObjectItem`</ph>-derived Active document containers.","pos":[2635,2773],"source":"**COleFrameHook**'s implementation of `IOleCommandTarget` forwards OLE commands to `COleDocObjectItem`-derived Active document containers."},{"content":"This allows any MFC Active document container to receive messages from contained Active document servers.","pos":[2774,2879]},{"content":"MFC OLE Command Maps","pos":[2888,2908]},{"content":"MFC developers can take advantage of <ph id=\"ph1\">`IOleCommandTarget`</ph> by using MFC OLE command maps.","pos":[2912,2999],"source":"MFC developers can take advantage of `IOleCommandTarget` by using MFC OLE command maps."},{"content":"OLE command maps are like message maps because they can be used to map OLE commands to member functions of the class that contains the command map.","pos":[3000,3147]},{"content":"To make this work, place macros in the command map to specify the OLE command group of the command you want to handle, the OLE command, and the command ID of the <bpt id=\"p1\">[</bpt>WM_COMMAND<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms647591)</ept> message that will be sent when the OLE command is received.","pos":[3148,3442],"source":" To make this work, place macros in the command map to specify the OLE command group of the command you want to handle, the OLE command, and the command ID of the [WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591) message that will be sent when the OLE command is received."},{"content":"MFC also provides a number of predefined macros for standard OLE commands.","pos":[3443,3517]},{"content":"For a list of the standard OLE commands that were originally designed for use with Microsoft Office applications, see the OLECMDID enumeration, which is defined in docobj.h.","pos":[3518,3691]},{"content":"When an OLE command is received by an MFC application that contains an OLE command map, MFC tries to find the command ID and command group for the requested command in the OLE command map of the application.","pos":[3698,3905]},{"content":"If a match is found, a <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> message is dispatched to the application containing the command map with the ID of the requested command.","pos":[3906,4049],"source":" If a match is found, a **WM_COMMAND** message is dispatched to the application containing the command map with the ID of the requested command."},{"content":"(See the description of <ph id=\"ph1\">`ON_OLECMD`</ph> below.) In this way, OLE commands dispatched to an application are turned into <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> messages by MFC.","pos":[4050,4196],"source":" (See the description of `ON_OLECMD` below.) In this way, OLE commands dispatched to an application are turned into **WM_COMMAND** messages by MFC."},{"content":"The <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> messages are then routed through the application's message maps using the MFC standard <bpt id=\"p2\">[</bpt>command routing<ept id=\"p2\">](../mfc/command-routing.md)</ept> architecture.","pos":[4197,4361],"source":" The **WM_COMMAND** messages are then routed through the application's message maps using the MFC standard [command routing](../mfc/command-routing.md) architecture."},{"content":"Unlike message maps, MFC OLE command maps are not supported by ClassWizard.","pos":[4368,4443]},{"content":"MFC developers must add OLE command map support and OLE command map entries by hand.","pos":[4444,4528]},{"content":"OLE command maps can be added to MFC Active document servers in any class that is in the <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> message-routing chain at the time the Active document is in-place active in a container.","pos":[4529,4721],"source":" OLE command maps can be added to MFC Active document servers in any class that is in the **WM_COMMAND** message-routing chain at the time the Active document is in-place active in a container."},{"content":"These classes include the application's classes derived from <bpt id=\"p1\">[</bpt>CWinApp<ept id=\"p1\">](../mfc/reference/cwinapp-class.md)</ept>, <bpt id=\"p2\">[</bpt>CView<ept id=\"p2\">](../mfc/reference/cview-class.md)</ept>, <bpt id=\"p3\">[</bpt>CDocument<ept id=\"p3\">](../mfc/reference/cdocument-class.md)</ept>, and <bpt id=\"p4\">[</bpt>COleIPFrameWnd<ept id=\"p4\">](../mfc/reference/coleipframewnd-class.md)</ept>.","pos":[4722,4984],"source":" These classes include the application's classes derived from [CWinApp](../mfc/reference/cwinapp-class.md), [CView](../mfc/reference/cview-class.md), [CDocument](../mfc/reference/cdocument-class.md), and [COleIPFrameWnd](../mfc/reference/coleipframewnd-class.md)."},{"content":"In Active document containers, OLE command maps can only be added to the <bpt id=\"p1\">[</bpt>COleDocObjectItem<ept id=\"p1\">](../mfc/reference/coledocobjectitem-class.md)</ept>-derived class.","pos":[4985,5137],"source":" In Active document containers, OLE command maps can only be added to the [COleDocObjectItem](../mfc/reference/coledocobjectitem-class.md)-derived class."},{"content":"Also, in Active document containers, the <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> messages will only be dispatched to the message map in the <ph id=\"ph1\">`COleDocObjectItem`</ph>-derived class.","pos":[5138,5287],"source":" Also, in Active document containers, the **WM_COMMAND** messages will only be dispatched to the message map in the `COleDocObjectItem`-derived class."},{"content":"OLE Command Map Macros","pos":[5296,5318]},{"content":"Use the following macros to add command map functionality to your class:","pos":[5322,5394]},{"content":"This macro goes in the class declaration (typically in the header file) of the class that contains the command map.","pos":[5444,5559]},{"content":"Name of the class that contains the command map.","pos":[5644,5692]},{"content":"Name of the base class of the class that contains the command map.","pos":[5714,5780]},{"content":"This macro marks the beginning of the command map.","pos":[5787,5837]},{"content":"Use this macro in the implementation file for the class that contains the command map.","pos":[5838,5924]},{"content":"This macro marks the end of the command map.","pos":[5969,6013]},{"content":"Use this macro in the implementation file for the class that contains the command map.","pos":[6014,6100]},{"content":"This macro must always follow the <bpt id=\"p1\">**</bpt>BEGIN_OLECMD_MAP<ept id=\"p1\">**</ept> macro.","pos":[6101,6162],"source":" This macro must always follow the **BEGIN_OLECMD_MAP** macro."},{"content":"Pointer to the GUID of the OLE command's command group.","pos":[6244,6299]},{"content":"This parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> for the standard OLE command group.","pos":[6300,6362],"source":" This parameter is **NULL** for the standard OLE command group."},{"content":"olecmdid","pos":[6370,6378]},{"content":"OLE command ID of the command to be invoked.","pos":[6383,6427]},{"content":"ID of the <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> message to be sent to the application containing the command map when this OLE command is invoked.","pos":[6442,6565],"source":" ID of the **WM_COMMAND** message to be sent to the application containing the command map when this OLE command is invoked."},{"content":"Use the <ph id=\"ph1\">`ON_OLECMD`</ph> macro in the command map to add entries for the OLE commands you want to handle.","pos":[6572,6672],"source":"Use the `ON_OLECMD` macro in the command map to add entries for the OLE commands you want to handle."},{"content":"When the OLE commands are received, they will be converted to the specified <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> message and routed through the application's message map using the standard MFC command-routing architecture.","pos":[6673,6873],"source":" When the OLE commands are received, they will be converted to the specified **WM_COMMAND** message and routed through the application's message map using the standard MFC command-routing architecture."},{"content":"Example","pos":[6882,6889]},{"content":"The following example shows how to add OLE command-handling capability to an MFC Active document server to handle the <bpt id=\"p1\">[</bpt>OLECMDID_PRINT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms691264)</ept> OLE command.","pos":[6893,7100],"source":"The following example shows how to add OLE command-handling capability to an MFC Active document server to handle the [OLECMDID_PRINT](http://msdn.microsoft.com/library/windows/desktop/ms691264) OLE command."},{"content":"This example assumes that you used AppWizard to generate an MFC application that is an Active document server.","pos":[7101,7211]},{"pos":[7221,7326],"content":"In your <ph id=\"ph1\">`CView`</ph>-derived class's header file, add the <ph id=\"ph2\">`DECLARE_OLECMD_MAP`</ph> macro to the class declaration.","source":"In your `CView`-derived class's header file, add the `DECLARE_OLECMD_MAP` macro to the class declaration."},{"pos":[7338,7498],"content":"[!NOTE]\n Use the `CView`-derived class because it is one of the classes in the Active document server that is in the **WM_COMMAND** message-routing chain.","leadings":["","    > "],"nodes":[{"content":"Use the <ph id=\"ph1\">`CView`</ph>-derived class because it is one of the classes in the Active document server that is in the <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> message-routing chain.","pos":[9,154],"source":" Use the `CView`-derived class because it is one of the classes in the Active document server that is in the **WM_COMMAND** message-routing chain."}]},{"pos":[7719,7832],"content":"In the implementation file for the <ph id=\"ph1\">`CView`</ph>-derived class, add the <ph id=\"ph2\">`BEGIN_OLECMD_MAP`</ph> and <ph id=\"ph3\">`END_OLECMD_MAP`</ph> macros:","source":"In the implementation file for the `CView`-derived class, add the `BEGIN_OLECMD_MAP` and `END_OLECMD_MAP` macros:"},{"content":"To handle the standard OLE print command, add an <bpt id=\"p1\">[</bpt>ON_OLECMD<ept id=\"p1\">](http://msdn.microsoft.com/library/6c86327c-3d48-42ac-9dae-e0ccd3a81793)</ept> macro to the command map specifying the OLE command ID for the standard print command and <bpt id=\"p2\">**</bpt>ID_FILE_PRINT<ept id=\"p2\">**</ept> for the <bpt id=\"p3\">**</bpt>WM_COMMAND<ept id=\"p3\">**</ept> ID.","pos":[7928,8195],"source":"To handle the standard OLE print command, add an [ON_OLECMD](http://msdn.microsoft.com/library/6c86327c-3d48-42ac-9dae-e0ccd3a81793) macro to the command map specifying the OLE command ID for the standard print command and **ID_FILE_PRINT** for the **WM_COMMAND** ID."},{"content":"<bpt id=\"p1\">**</bpt>ID_FILE_PRINT<ept id=\"p1\">**</ept> is the standard print command ID used by AppWizard-generated MFC applications:","pos":[8196,8292],"source":"**ID_FILE_PRINT** is the standard print command ID used by AppWizard-generated MFC applications:"},{"content":"Note that one of the standard OLE command macros, defined in afxdocob.h, could be used in place of the <ph id=\"ph1\">`ON_OLECMD`</ph> macro because <bpt id=\"p1\">**</bpt>OLECMDID_PRINT<ept id=\"p1\">**</ept> is a standard OLE command ID.","pos":[8447,8624],"source":"Note that one of the standard OLE command macros, defined in afxdocob.h, could be used in place of the `ON_OLECMD` macro because **OLECMDID_PRINT** is a standard OLE command ID."},{"content":"The <ph id=\"ph1\">`ON_OLECMD_PRINT`</ph> macro will accomplish the same task as the <ph id=\"ph2\">`ON_OLECMD`</ph> macro shown above.","pos":[8625,8720],"source":" The `ON_OLECMD_PRINT` macro will accomplish the same task as the `ON_OLECMD` macro shown above."},{"content":"When a container application sends this server an <bpt id=\"p1\">**</bpt>OLECMDID_PRINT<ept id=\"p1\">**</ept> command through the server's <ph id=\"ph1\">`IOleCommandTarget`</ph> interface, the MFC printing command handler will be invoked in the server, causing the server to print the application.","pos":[8727,8964],"source":"When a container application sends this server an **OLECMDID_PRINT** command through the server's `IOleCommandTarget` interface, the MFC printing command handler will be invoked in the server, causing the server to print the application."},{"content":"The Active document container's code to invoke the print command added in the steps above would look something like this:","pos":[8965,9086]},{"content":"See Also","pos":[9734,9742]},{"content":"Technical Notes by Number","pos":[9747,9772]},{"content":"Technical Notes by Category","pos":[9816,9843]}],"content":"---\ntitle: \"TN071: MFC IOleCommandTarget Implementation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"IOleCommandTarget\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"TN071\"\n  - \"IOleCommandTarget interface\"\nms.assetid: 3eef571e-6357-444d-adbb-6f734a0c3161\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# TN071: MFC IOleCommandTarget Implementation\n> [!NOTE]\n>  The following technical note has not been updated since it was first included in the online documentation. As a result, some procedures and topics might be out of date or incorrect. For the latest information, it is recommended that you search for the topic of interest in the online documentation index.  \n  \n The `IOleCommandTarget` interface enables objects and their containers to dispatch commands to each other. For example, an object's toolbars may contain buttons for commands such as **Print**, **Print Preview**, **Save**, `New`, and **Zoom**. If such an object were embedded in a container that supports `IOleCommandTarget`, the object could enable its buttons and forward the commands to the container for processing when the user clicked them. If a container wanted the embedded object to print itself, it could make this request by sending a command through the `IOleCommandTarget` interface of the embedded object.  \n  \n `IOleCommandTarget` is an Automation-like interface in that it is used by a client to invoke methods on a server. However, using `IOleCommandTarget` saves the overhead of making calls via Automation interfaces because programmers don't have to use the typically expensive `Invoke` method of `IDispatch`.  \n  \n In MFC, the `IOleCommandTarget` interface is used by Active document servers to allow Active document containers to dispatch commands to the server. The Active document server class, `CDocObjectServerItem`, uses MFC interface maps (see [TN038: MFC/OLE IUnknown Implementation](../mfc/tn038-mfc-ole-iunknown-implementation.md)) to implement the `IOleCommandTarget` interface.  \n  \n `IOleCommandTarget` is also implemented in the **COleFrameHook** class. **COleFrameHook** is an undocumented MFC class that implements the frame window functionality of in-place editing containers. **COleFrameHook** also uses MFC interface maps to implement the `IOleCommandTarget` interface. **COleFrameHook**'s implementation of `IOleCommandTarget` forwards OLE commands to `COleDocObjectItem`-derived Active document containers. This allows any MFC Active document container to receive messages from contained Active document servers.  \n  \n## MFC OLE Command Maps  \n MFC developers can take advantage of `IOleCommandTarget` by using MFC OLE command maps. OLE command maps are like message maps because they can be used to map OLE commands to member functions of the class that contains the command map. To make this work, place macros in the command map to specify the OLE command group of the command you want to handle, the OLE command, and the command ID of the [WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591) message that will be sent when the OLE command is received. MFC also provides a number of predefined macros for standard OLE commands. For a list of the standard OLE commands that were originally designed for use with Microsoft Office applications, see the OLECMDID enumeration, which is defined in docobj.h.  \n  \n When an OLE command is received by an MFC application that contains an OLE command map, MFC tries to find the command ID and command group for the requested command in the OLE command map of the application. If a match is found, a **WM_COMMAND** message is dispatched to the application containing the command map with the ID of the requested command. (See the description of `ON_OLECMD` below.) In this way, OLE commands dispatched to an application are turned into **WM_COMMAND** messages by MFC. The **WM_COMMAND** messages are then routed through the application's message maps using the MFC standard [command routing](../mfc/command-routing.md) architecture.  \n  \n Unlike message maps, MFC OLE command maps are not supported by ClassWizard. MFC developers must add OLE command map support and OLE command map entries by hand. OLE command maps can be added to MFC Active document servers in any class that is in the **WM_COMMAND** message-routing chain at the time the Active document is in-place active in a container. These classes include the application's classes derived from [CWinApp](../mfc/reference/cwinapp-class.md), [CView](../mfc/reference/cview-class.md), [CDocument](../mfc/reference/cdocument-class.md), and [COleIPFrameWnd](../mfc/reference/coleipframewnd-class.md). In Active document containers, OLE command maps can only be added to the [COleDocObjectItem](../mfc/reference/coledocobjectitem-class.md)-derived class. Also, in Active document containers, the **WM_COMMAND** messages will only be dispatched to the message map in the `COleDocObjectItem`-derived class.  \n  \n## OLE Command Map Macros  \n Use the following macros to add command map functionality to your class:  \n  \n```  \n \nDECLARE_OLECMD_MAP ()  \n \n```  \n  \n This macro goes in the class declaration (typically in the header file) of the class that contains the command map.  \n  \n```  \n \nBEGIN_OLECMD_MAP(\ntheClass  ,   baseClass)  \n \n```  \n  \n `theClass`  \n Name of the class that contains the command map.  \n  \n `baseClass`  \n Name of the base class of the class that contains the command map.  \n  \n This macro marks the beginning of the command map. Use this macro in the implementation file for the class that contains the command map.  \n  \n```  \n \nEND_OLECMD_MAP()  \n \n```  \n  \n This macro marks the end of the command map. Use this macro in the implementation file for the class that contains the command map. This macro must always follow the **BEGIN_OLECMD_MAP** macro.  \n  \n```  \n \nON_OLECMD(\npguid  ,   \nolecmdid  ,\n    id)  \n \n```  \n  \n `pguid`  \n Pointer to the GUID of the OLE command's command group. This parameter is **NULL** for the standard OLE command group.  \n  \n *olecmdid*  \n OLE command ID of the command to be invoked.  \n  \n `id`  \n ID of the **WM_COMMAND** message to be sent to the application containing the command map when this OLE command is invoked.  \n  \n Use the `ON_OLECMD` macro in the command map to add entries for the OLE commands you want to handle. When the OLE commands are received, they will be converted to the specified **WM_COMMAND** message and routed through the application's message map using the standard MFC command-routing architecture.  \n  \n## Example  \n The following example shows how to add OLE command-handling capability to an MFC Active document server to handle the [OLECMDID_PRINT](http://msdn.microsoft.com/library/windows/desktop/ms691264) OLE command. This example assumes that you used AppWizard to generate an MFC application that is an Active document server.  \n  \n1.  In your `CView`-derived class's header file, add the `DECLARE_OLECMD_MAP` macro to the class declaration.  \n  \n    > [!NOTE]\n    >  Use the `CView`-derived class because it is one of the classes in the Active document server that is in the **WM_COMMAND** message-routing chain.  \n  \n ```  \n    class CMyServerView : public CView  \n {  \n    protected: // create from serialization only  \n    CMyServerView();\nDECLARE_DYNCREATE(CMyServerView)  \n    DECLARE_OLECMD_MAP() \n . . .  \n };  \n ```  \n  \n2.  In the implementation file for the `CView`-derived class, add the `BEGIN_OLECMD_MAP` and `END_OLECMD_MAP` macros:  \n  \n ```  \n    BEGIN_OLECMD_MAP(CMyServerView, CView)  \n \n    END_OLECMD_MAP() \n ```  \n  \n3.  To handle the standard OLE print command, add an [ON_OLECMD](http://msdn.microsoft.com/library/6c86327c-3d48-42ac-9dae-e0ccd3a81793) macro to the command map specifying the OLE command ID for the standard print command and **ID_FILE_PRINT** for the **WM_COMMAND** ID. **ID_FILE_PRINT** is the standard print command ID used by AppWizard-generated MFC applications:  \n  \n ```  \n    BEGIN_OLECMD_MAP(CMyServerView,\n    CView)  \n    ON_OLECMD(NULL,\n    OLECMDID_PRINT,\n    ID_FILE_PRINT) \n    END_OLECMD_MAP() \n ```  \n  \n Note that one of the standard OLE command macros, defined in afxdocob.h, could be used in place of the `ON_OLECMD` macro because **OLECMDID_PRINT** is a standard OLE command ID. The `ON_OLECMD_PRINT` macro will accomplish the same task as the `ON_OLECMD` macro shown above.  \n  \n When a container application sends this server an **OLECMDID_PRINT** command through the server's `IOleCommandTarget` interface, the MFC printing command handler will be invoked in the server, causing the server to print the application. The Active document container's code to invoke the print command added in the steps above would look something like this:  \n  \n```  \nvoid CContainerCntrItem::DoOleCmd()  \n{  \n    IOleCommandTarget *pCmd = NULL;  \n    HRESULT hr = E_FAIL;  \n    OLECMD ocm={OLECMDID_PRINT, 0};  \n \n    hr = m_lpObject->QueryInterface(IID_IOleCommandTarget,reinterpret_cast<void**>(&pCmd));\n\n    if(FAILED(hr)) \n    return; \n \n    hr = pCmd->QueryStatus(NULL, 1, &ocm, NULL);\n\n    if(SUCCEEDED(hr)&& (ocm.cmdf& OLECMDF_ENABLED))  \n { *//Command is available and enabled so call it  \n    COleVariant vIn;  \n    COleVariant vOut;  \n    hr = pCmd->Exec(NULL, OLECMDID_PRINT,  \n    OLECMDEXECOPT_DODEFAULT, &vIn, &vOut);\n\n    ASSERT(SUCCEEDED(hr));\n\n }  \n    pCmd->Release();\n\n} \n```  \n  \n## See Also  \n [Technical Notes by Number](../mfc/technical-notes-by-number.md)   \n [Technical Notes by Category](../mfc/technical-notes-by-category.md)\n\n"}