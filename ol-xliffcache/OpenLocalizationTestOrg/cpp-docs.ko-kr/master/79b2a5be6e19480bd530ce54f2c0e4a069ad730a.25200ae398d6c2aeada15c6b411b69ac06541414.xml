{"nodes":[{"pos":[12,50],"content":"CSnapInItemImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CSnapInItemImpl Class | Microsoft Docs","pos":[0,38]}]},{"content":"CSnapInItemImpl Class","pos":[746,767]},{"content":"This class provides methods for implementing a snap-in node object.","pos":[768,835]},{"pos":[843,953],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"content":"Syntax","pos":[962,968]},{"content":"Parameters","pos":[1098,1108]},{"content":"Your class, derived from <ph id=\"ph1\">`CSnapInItemImpl`</ph>.","pos":[1119,1162],"source":" Your class, derived from `CSnapInItemImpl`."},{"content":"bIsExtension","pos":[1170,1182]},{"content":"<bpt id=\"p1\"> **</bpt>TRUE<ept id=\"p1\">**</ept> if the object is a snap-in extension; otherwise <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","pos":[1186,1254],"source":" **TRUE** if the object is a snap-in extension; otherwise **FALSE**."},{"content":"Members","pos":[1263,1270]},{"content":"Public Constructors","pos":[1280,1299]},{"content":"Name","pos":[1306,1310]},{"content":"Description","pos":[1311,1322]},{"content":"CSnapInItemImpl::CSnapInItemImpl","pos":[1361,1393]},{"content":"Constructor.","pos":[1430,1442]},{"content":"Public Methods","pos":[1453,1467]},{"content":"Name","pos":[1474,1478]},{"content":"Description","pos":[1479,1490]},{"content":"CSnapInItemImpl::AddMenuItems","pos":[1529,1558]},{"content":"Adds menu items to a context menu.","pos":[1592,1626]},{"content":"CSnapInItemImpl::Command","pos":[1632,1656]},{"content":"Called by the console when a custom menu item is selected.","pos":[1685,1743]},{"content":"CSnapInItemImpl::CreatePropertyPages","pos":[1749,1785]},{"content":"Adds pages to the property sheet of the snap-in.","pos":[1826,1874]},{"content":"CSnapInItemImpl::FillData","pos":[1880,1905]},{"content":"Copies information on the snap-in object into a specified stream.","pos":[1935,2000]},{"content":"CSnapInItemImpl::GetResultPaneInfo","pos":[2006,2040]},{"pos":[2079,2137],"content":"Retrieves the <bpt id=\"p1\">**</bpt>RESULTDATAITEM<ept id=\"p1\">**</ept> structure of the snap-in.","source":"Retrieves the **RESULTDATAITEM** structure of the snap-in."},{"content":"CSnapInItemImpl::GetResultViewType","pos":[2143,2177]},{"content":"Determines the type of view used by the result pane.","pos":[2216,2268]},{"content":"CSnapInItemImpl::GetScopePaneInfo","pos":[2274,2307]},{"pos":[2345,2402],"content":"Retrieves the <bpt id=\"p1\">**</bpt>SCOPEDATAITEM<ept id=\"p1\">**</ept> structure of the snap-in.","source":"Retrieves the **SCOPEDATAITEM** structure of the snap-in."},{"content":"CSnapInItemImpl::Notify","pos":[2408,2431]},{"content":"Called by the console to notify the snap-in of actions taken by the user.","pos":[2459,2532]},{"content":"CSnapInItemImpl::QueryPagesFor","pos":[2538,2568]},{"content":"Called to see if the snap-in node supports property pages.","pos":[2603,2661]},{"content":"CSnapInItemImpl::SetMenuInsertionFlags","pos":[2667,2705]},{"content":"Modifies the menu insertion flags for a snap-in object.","pos":[2748,2803]},{"content":"CSnapInItemImpl::SetToolbarButtonInfo","pos":[2809,2846]},{"content":"Sets the information of the specified toolbar button.","pos":[2888,2941]},{"content":"CSnapInItemImpl::UpdateMenuState","pos":[2947,2979]},{"content":"Updates the state of a context menu item.","pos":[3016,3057]},{"content":"CSnapInItemImpl::UpdateToolbarButton","pos":[3063,3099]},{"content":"Updates the state of the specified toolbar button.","pos":[3140,3190]},{"content":"Public Data Members","pos":[3201,3220]},{"content":"Name","pos":[3227,3231]},{"content":"Description","pos":[3232,3243]},{"content":"CSnapInItemImpl::m_bstrDisplayName","pos":[3282,3316]},{"content":"The name of the snap-in object.","pos":[3355,3386]},{"content":"CSnapInItemImpl::m_resultDataItem","pos":[3392,3425]},{"pos":[3463,3541],"content":"The Windows <bpt id=\"p1\">**</bpt>RESULTDATAITEM<ept id=\"p1\">**</ept> structure used by the <ph id=\"ph1\">`CSnapInItemImpl`</ph> object.","source":"The Windows **RESULTDATAITEM** structure used by the `CSnapInItemImpl` object."},{"content":"CSnapInItemImpl::m_scopeDataItem","pos":[3547,3579]},{"pos":[3616,3693],"content":"The Windows <bpt id=\"p1\">**</bpt>SCOPEDATAITEM<ept id=\"p1\">**</ept> structure used by the <ph id=\"ph1\">`CSnapInItemImpl`</ph> object.","source":"The Windows **SCOPEDATAITEM** structure used by the `CSnapInItemImpl` object."},{"content":"Remarks","pos":[3703,3710]},{"content":"provides a basic implementation for a snap-in node object, such as adding menu items and toolbars, and forwarding commands for the snap-in node to the appropriate handler function.","pos":[3732,3912]},{"content":"These features are implemented using several different interfaces and map types.","pos":[3913,3993]},{"content":"The default implementation handles notifications sent to the node object by determining the correct instance of the derived class and then forwarding the message to the correct instance.","pos":[3994,4180]},{"content":"Inheritance Hierarchy","pos":[4189,4210]},{"content":"Requirements","pos":[4260,4272]},{"pos":[4276,4297],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlsnap.h","source":"**Header:** atlsnap.h"},{"pos":[4353,4382],"content":"CSnapInItemImpl::AddMenuItems"},{"pos":[4386,4507],"content":"This method implements the Win32 function <bpt id=\"p1\">[</bpt>IExtendContextMenu::AddMenuItems<ept id=\"p1\">](http://msdn.microsoft.com/library/aa814841)</ept>.","source":"This method implements the Win32 function [IExtendContextMenu::AddMenuItems](http://msdn.microsoft.com/library/aa814841)."},{"content":"Parameters","pos":[4635,4645]},{"content":"piCallback","pos":[4650,4660]},{"content":"[in] Pointer to the <bpt id=\"p1\">**</bpt>IContextMenuCallback<ept id=\"p1\">**</ept> that can add items to the context menu.","pos":[4665,4749],"source":" [in] Pointer to the **IContextMenuCallback** that can add items to the context menu."},{"content":"[in, out] Identifies Microsoft Management Console (MMC)-defined, menu-item insertion points that can be used.","pos":[4779,4888]},{"content":"This can be a combination of the following flags:","pos":[4889,4938]},{"pos":[4946,5026],"content":"<bpt id=\"p1\">**</bpt>CCM_INSERTIONALLOWED_TOP<ept id=\"p1\">**</ept> Items can be inserted at the top of a context menu.","source":"**CCM_INSERTIONALLOWED_TOP** Items can be inserted at the top of a context menu."},{"pos":[5034,5111],"content":"<bpt id=\"p1\">**</bpt>CCM_INSERTIONALLOWED_NEW<ept id=\"p1\">**</ept> Items can be inserted in the Create New submenu.","source":"**CCM_INSERTIONALLOWED_NEW** Items can be inserted in the Create New submenu."},{"pos":[5119,5191],"content":"<bpt id=\"p1\">**</bpt>CCM_INSERTIONALLOWED_TASK<ept id=\"p1\">**</ept> Items can be inserted in the Task submenu.","source":"**CCM_INSERTIONALLOWED_TASK** Items can be inserted in the Task submenu."},{"pos":[5199,5331],"content":"<bpt id=\"p1\">**</bpt>CCM_INSERTIONALLOWED_VIEW<ept id=\"p1\">**</ept> Items can be inserted in the toolbar view menu or in the View submenu of the result pane context menu.","source":"**CCM_INSERTIONALLOWED_VIEW** Items can be inserted in the toolbar view menu or in the View submenu of the result pane context menu."},{"pos":[5338,5423],"content":"`type`  \n[in] Specifies the type of object. It can have one of the following values:","leadings":[""," "],"nodes":[{"content":"[in] Specifies the type of object. It can have one of the following values:","pos":[9,84],"nodes":[{"content":"[in] Specifies the type of object.","pos":[0,34]},{"content":"It can have one of the following values:","pos":[35,75]}]}]},{"pos":[5431,5480],"content":"<bpt id=\"p1\">**</bpt>CCT_SCOPE<ept id=\"p1\">**</ept> Data object for scope pane context.","source":"**CCT_SCOPE** Data object for scope pane context."},{"pos":[5488,5539],"content":"<bpt id=\"p1\">**</bpt>CCT_RESULT<ept id=\"p1\">**</ept> Data object for result pane context.","source":"**CCT_RESULT** Data object for result pane context."},{"pos":[5547,5610],"content":"<bpt id=\"p1\">**</bpt>CCT_SNAPIN_MANAGER<ept id=\"p1\">**</ept> Data object for snap-in manager context.","source":"**CCT_SNAPIN_MANAGER** Data object for snap-in manager context."},{"pos":[5618,5672],"content":"<bpt id=\"p1\">**</bpt>CCT_UNINITIALIZED<ept id=\"p1\">**</ept> Data object has an invalid type.","source":"**CCT_UNINITIALIZED** Data object has an invalid type."},{"pos":[5723,5747],"content":"CSnapInItemImpl::Command"},{"pos":[5751,5867],"content":"This method implements the Win32 function <bpt id=\"p1\">[</bpt>IExtendContextMenu::Command<ept id=\"p1\">](http://msdn.microsoft.com/library/aa814842)</ept>.","source":"This method implements the Win32 function [IExtendContextMenu::Command](http://msdn.microsoft.com/library/aa814842)."},{"content":"Parameters","pos":[5941,5951]},{"content":"lCommandID","pos":[5956,5966]},{"content":"[in] Specifies the command identifier of the menu item.","pos":[5971,6026]},{"content":"[in] Specifies the type of object.","pos":[6043,6077]},{"content":"It can have one of the following values:","pos":[6078,6118]},{"pos":[6126,6175],"content":"<bpt id=\"p1\">**</bpt>CCT_SCOPE<ept id=\"p1\">**</ept> Data object for scope pane context.","source":"**CCT_SCOPE** Data object for scope pane context."},{"pos":[6183,6234],"content":"<bpt id=\"p1\">**</bpt>CCT_RESULT<ept id=\"p1\">**</ept> Data object for result pane context.","source":"**CCT_RESULT** Data object for result pane context."},{"pos":[6242,6305],"content":"<bpt id=\"p1\">**</bpt>CCT_SNAPIN_MANAGER<ept id=\"p1\">**</ept> Data object for snap-in manager context.","source":"**CCT_SNAPIN_MANAGER** Data object for snap-in manager context."},{"pos":[6313,6367],"content":"<bpt id=\"p1\">**</bpt>CCT_UNINITIALIZED<ept id=\"p1\">**</ept> Data object has an invalid type.","source":"**CCT_UNINITIALIZED** Data object has an invalid type."},{"pos":[6430,6466],"content":"CSnapInItemImpl::CreatePropertyPages"},{"pos":[6470,6600],"content":"This method implements the Win32 function <bpt id=\"p1\">[</bpt>IExtendPropertySheet::CreatePropertyPages<ept id=\"p1\">](http://msdn.microsoft.com/library/aa814846)</ept>.","source":"This method implements the Win32 function [IExtendPropertySheet::CreatePropertyPages](http://msdn.microsoft.com/library/aa814846)."},{"content":"Parameters","pos":[6745,6755]},{"content":"lpProvider","pos":[6760,6770]},{"content":"[in] Pointer to the <bpt id=\"p1\">**</bpt>IPropertySheetCallback<ept id=\"p1\">**</ept> interface.","pos":[6775,6832],"source":" [in] Pointer to the **IPropertySheetCallback** interface."},{"content":"handle","pos":[6840,6846]},{"content":"[in] Specifies the handle used to route the <bpt id=\"p1\">**</bpt>MMCN_PROPERTY_CHANGE<ept id=\"p1\">**</ept> notification message to the appropriate data class.","pos":[6851,6971],"source":" [in] Specifies the handle used to route the **MMCN_PROPERTY_CHANGE** notification message to the appropriate data class."},{"content":"pUnk","pos":[6979,6983]},{"content":"[in] Pointer to the <bpt id=\"p1\">**</bpt>IExtendPropertySheet<ept id=\"p1\">**</ept> interface on the object that contains context information about the node.","pos":[6988,7106],"source":" [in] Pointer to the **IExtendPropertySheet** interface on the object that contains context information about the node."},{"content":"[in] Specifies the type of object.","pos":[7123,7157]},{"content":"It can have one of the following values:","pos":[7158,7198]},{"pos":[7206,7255],"content":"<bpt id=\"p1\">**</bpt>CCT_SCOPE<ept id=\"p1\">**</ept> Data object for scope pane context.","source":"**CCT_SCOPE** Data object for scope pane context."},{"pos":[7263,7314],"content":"<bpt id=\"p1\">**</bpt>CCT_RESULT<ept id=\"p1\">**</ept> Data object for result pane context.","source":"**CCT_RESULT** Data object for result pane context."},{"pos":[7322,7385],"content":"<bpt id=\"p1\">**</bpt>CCT_SNAPIN_MANAGER<ept id=\"p1\">**</ept> Data object for snap-in manager context.","source":"**CCT_SNAPIN_MANAGER** Data object for snap-in manager context."},{"pos":[7393,7447],"content":"<bpt id=\"p1\">**</bpt>CCT_UNINITIALIZED<ept id=\"p1\">**</ept> Data object has an invalid type.","source":"**CCT_UNINITIALIZED** Data object has an invalid type."},{"pos":[7506,7538],"content":"CSnapInItemImpl::CSnapInItemImpl"},{"pos":[7542,7580],"content":"Constructs a <ph id=\"ph1\">`CSnapInItemImpl`</ph> object.","source":"Constructs a `CSnapInItemImpl` object."},{"pos":[7664,7689],"content":"CSnapInItemImpl::FillData"},{"content":"This function is called to retrieve information about the item.","pos":[7693,7756]},{"content":"Parameters","pos":[7823,7833]},{"content":"[in] The format (text, rich text, or rich text with OLE items) of the Clipboard.","pos":[7845,7925]},{"content":"[in] A pointer to the stream containing the object data.","pos":[7945,8001]},{"content":"Remarks","pos":[8011,8018]},{"pos":[8022,8170],"content":"To properly implement this function, copy the correct information into the stream ( <ph id=\"ph1\">`pStream`</ph>), depending on the Clipboard format indicated by <ph id=\"ph2\">`cf`</ph>.","source":"To properly implement this function, copy the correct information into the stream ( `pStream`), depending on the Clipboard format indicated by `cf`."},{"pos":[8231,8265],"content":"CSnapInItemImpl::GetResultViewType"},{"content":"Call this function to retrieve the type of view for the result pane of the snap-in object.","pos":[8269,8359]},{"content":"Parameters","pos":[8452,8462]},{"content":"ppViewType","pos":[8467,8477]},{"content":"[out] Pointer to the address of the returned view type.","pos":[8482,8537]},{"content":"pViewOptions","pos":[8545,8557]},{"content":"[out] Pointer to the <bpt id=\"p1\">**</bpt>MMC_VIEW_OPTIONS<ept id=\"p1\">**</ept> enumeration, which provides the console with options specified by the owning snap-in.","pos":[8562,8689],"source":" [out] Pointer to the **MMC_VIEW_OPTIONS** enumeration, which provides the console with options specified by the owning snap-in."},{"content":"This value can be one of the following:","pos":[8690,8729]},{"content":"<bpt id=\"p1\">**</bpt>MMC_VIEW_OPTIONS_NOLISTVIEWS<ept id=\"p1\">**</ept> = 0x00000001   Tells the console to refrain from presenting standard list view choices in the <bpt id=\"p2\">**</bpt>View<ept id=\"p2\">**</ept> menu.","pos":[8737,8878],"source":"**MMC_VIEW_OPTIONS_NOLISTVIEWS** = 0x00000001   Tells the console to refrain from presenting standard list view choices in the **View** menu."},{"content":"Allows the snap-in to display its own custom views only in the result view pane.","pos":[8879,8959]},{"content":"This is the only option flag defined at this time.","pos":[8960,9010]},{"pos":[9018,9082],"content":"<bpt id=\"p1\">**</bpt>MMC_VIEW_OPTIONS_NONE<ept id=\"p1\">**</ept> = 0   Allows the default view options.","source":"**MMC_VIEW_OPTIONS_NONE** = 0   Allows the default view options."},{"pos":[9142,9175],"content":"CSnapInItemImpl::GetScopePaneInfo"},{"pos":[9179,9257],"content":"Call this function to retrieve the <bpt id=\"p1\">**</bpt>SCOPEDATAITEM<ept id=\"p1\">**</ept> structure of the snap-in.","source":"Call this function to retrieve the **SCOPEDATAITEM** structure of the snap-in."},{"content":"Parameters","pos":[9330,9340]},{"content":"pScopeDataItem","pos":[9345,9359]},{"content":"[out] A pointer to the <bpt id=\"p1\">**</bpt>SCOPEDATAITEM<ept id=\"p1\">**</ept> structure of the <ph id=\"ph1\">`CSnapInItemImpl`</ph> object.","pos":[9364,9447],"source":" [out] A pointer to the **SCOPEDATAITEM** structure of the `CSnapInItemImpl` object."},{"pos":[9508,9542],"content":"CSnapInItemImpl::GetResultPaneInfo"},{"pos":[9546,9625],"content":"Call this function to retrieve the <bpt id=\"p1\">**</bpt>RESULTDATAITEM<ept id=\"p1\">**</ept> structure of the snap-in.","source":"Call this function to retrieve the **RESULTDATAITEM** structure of the snap-in."},{"content":"Parameters","pos":[9701,9711]},{"content":"pResultDataItem","pos":[9716,9731]},{"content":"[out] A pointer to the <bpt id=\"p1\">**</bpt>RESULTDATAITEM<ept id=\"p1\">**</ept> structure of the <ph id=\"ph1\">`CSnapInItemImpl`</ph> object.","pos":[9736,9820],"source":" [out] A pointer to the **RESULTDATAITEM** structure of the `CSnapInItemImpl` object."},{"pos":[9881,9915],"content":"CSnapInItemImpl::m_bstrDisplayName"},{"content":"Contains the string displayed for the node item.","pos":[9919,9967]},{"pos":[10067,10099],"content":"CSnapInItemImpl::m_scopeDataItem"},{"pos":[10103,10160],"content":"The <ph id=\"ph1\">`SCOPEDATAITEM`</ph> structure of the snap-in data object.","source":"The `SCOPEDATAITEM` structure of the snap-in data object."},{"pos":[10264,10297],"content":"CSnapInItemImpl::m_resultDataItem"},{"pos":[10301,10403],"content":"The <bpt id=\"p1\">[</bpt>RESULTDATAITEM<ept id=\"p1\">](http://msdn.microsoft.com/library/aa815165)</ept> structure of the snap-in data object.","source":"The [RESULTDATAITEM](http://msdn.microsoft.com/library/aa815165) structure of the snap-in data object."},{"pos":[10499,10522],"content":"CSnapInItemImpl::Notify"},{"content":"Called when the snap-in object is acted upon by the user.","pos":[10526,10583]},{"content":"Parameters","pos":[10774,10784]},{"content":"[in] Identifies an action taken by a user.","pos":[10799,10841]},{"content":"The following notifications are possible:","pos":[10842,10883]},{"pos":[10891,10963],"content":"<bpt id=\"p1\">**</bpt>MMCN_ACTIVATE<ept id=\"p1\">**</ept> Sent when a window is being activated and deactivated.","source":"**MMCN_ACTIVATE** Sent when a window is being activated and deactivated."},{"pos":[10971,11029],"content":"<bpt id=\"p1\">**</bpt>MMCN_ADD_IMAGES<ept id=\"p1\">**</ept> Sent to add images to the result pane.","source":"**MMCN_ADD_IMAGES** Sent to add images to the result pane."},{"pos":[11037,11109],"content":"<bpt id=\"p1\">**</bpt>MMCN_BTN_CLICK<ept id=\"p1\">**</ept> Sent when the user clicks one of the toolbar buttons.","source":"**MMCN_BTN_CLICK** Sent when the user clicks one of the toolbar buttons."},{"pos":[11117,11191],"content":"<bpt id=\"p1\">**</bpt>MMCN_CLICK<ept id=\"p1\">**</ept> Sent when a user clicks a mouse button on a list view item.","source":"**MMCN_CLICK** Sent when a user clicks a mouse button on a list view item."},{"pos":[11199,11283],"content":"<bpt id=\"p1\">**</bpt>MMCN_DBLCLICK<ept id=\"p1\">**</ept> Sent when a user double clicks a mouse button on a list view item.","source":"**MMCN_DBLCLICK** Sent when a user double clicks a mouse button on a list view item."},{"pos":[11291,11368],"content":"<bpt id=\"p1\">**</bpt>MMCN_DELETE<ept id=\"p1\">**</ept> Sent to inform the snap-in that the object should be deleted.","source":"**MMCN_DELETE** Sent to inform the snap-in that the object should be deleted."},{"pos":[11376,11446],"content":"<bpt id=\"p1\">**</bpt>MMCN_EXPAND<ept id=\"p1\">**</ept> Sent when a folder needs to be expanded or contracted.","source":"**MMCN_EXPAND** Sent when a folder needs to be expanded or contracted."},{"pos":[11454,11524],"content":"<bpt id=\"p1\">**</bpt>MMCN_MINIMIZED<ept id=\"p1\">**</ept> Sent when a window is being minimized or maximized.","source":"**MMCN_MINIMIZED** Sent when a window is being minimized or maximized."},{"pos":[11532,11639],"content":"<bpt id=\"p1\">**</bpt>MMCN_PROPERTY_CHANGE<ept id=\"p1\">**</ept> Sent to notify a snap-in object that the snap-in object's view is about to change.","source":"**MMCN_PROPERTY_CHANGE** Sent to notify a snap-in object that the snap-in object's view is about to change."},{"pos":[11647,11763],"content":"<bpt id=\"p1\">**</bpt>MMCN_REMOVE_CHILDREN<ept id=\"p1\">**</ept> Sent when the snap-in must delete the entire subtree it has added below the specified node.","source":"**MMCN_REMOVE_CHILDREN** Sent when the snap-in must delete the entire subtree it has added below the specified node."},{"pos":[11771,11866],"content":"<bpt id=\"p1\">**</bpt>MMCN_RENAME<ept id=\"p1\">**</ept> Sent the first time to query for a rename and the second time to do the rename.","source":"**MMCN_RENAME** Sent the first time to query for a rename and the second time to do the rename."},{"pos":[11874,11953],"content":"<bpt id=\"p1\">**</bpt>MMCN_SELECT<ept id=\"p1\">**</ept> Sent when an item in the scope or result view pane is selected.","source":"**MMCN_SELECT** Sent when an item in the scope or result view pane is selected."},{"pos":[11961,12043],"content":"<bpt id=\"p1\">**</bpt>MMCN_SHOW<ept id=\"p1\">**</ept> Sent when a scope item is selected or deselected for the first time.","source":"**MMCN_SHOW** Sent when a scope item is selected or deselected for the first time."},{"pos":[12051,12136],"content":"<bpt id=\"p1\">**</bpt>MMCN_VIEW_CHANGE<ept id=\"p1\">**</ept> Sent when the snap-in can update all views when a change occurs.","source":"**MMCN_VIEW_CHANGE** Sent when the snap-in can update all views when a change occurs."},{"pos":[12143,12190],"content":"`arg`  \n[in] Depends on the notification type.","leadings":[""," "],"nodes":[{"content":"[in] Depends on the notification type.","pos":[8,46]}]},{"pos":[12197,12246],"content":"`param`  \n[in] Depends on the notification type.","leadings":[""," "],"nodes":[{"content":"[in] Depends on the notification type.","pos":[10,48]}]},{"pos":[12253,12438],"content":"*pComponentData*  \n[out] A pointer to the object implementing **IComponentData**. This parameter is **NULL** if the notification is not being forwarded from **IComponentData::Notify**.","leadings":[""," "],"nodes":[{"content":"pComponentData","pos":[1,15]},{"content":"[out] A pointer to the object implementing **IComponentData**. This parameter is **NULL** if the notification is not being forwarded from **IComponentData::Notify**.","pos":[19,184],"nodes":[{"content":"[out] A pointer to the object implementing <bpt id=\"p1\">**</bpt>IComponentData<ept id=\"p1\">**</ept>.","pos":[0,62],"source":"[out] A pointer to the object implementing **IComponentData**."},{"content":"This parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the notification is not being forwarded from <bpt id=\"p2\">**</bpt>IComponentData::Notify<ept id=\"p2\">**</ept>.","pos":[63,165],"source":" This parameter is **NULL** if the notification is not being forwarded from **IComponentData::Notify**."}]}]},{"pos":[12445,12621],"content":"*pComponent*  \n[out] A pointer to the object that implements **IComponent**. This parameter is **NULL** if the notification is not being forwarded from **IComponent::Notify**.","leadings":[""," "],"nodes":[{"content":"pComponent","pos":[1,11]},{"content":"[out] A pointer to the object that implements **IComponent**. This parameter is **NULL** if the notification is not being forwarded from **IComponent::Notify**.","pos":[15,175],"nodes":[{"content":"[out] A pointer to the object that implements <bpt id=\"p1\">**</bpt>IComponent<ept id=\"p1\">**</ept>.","pos":[0,61],"source":"[out] A pointer to the object that implements **IComponent**."},{"content":"This parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the notification is not being forwarded from <bpt id=\"p2\">**</bpt>IComponent::Notify<ept id=\"p2\">**</ept>.","pos":[62,160],"source":" This parameter is **NULL** if the notification is not being forwarded from **IComponent::Notify**."}]}]},{"pos":[12628,12713],"content":"`type`  \n[in] Specifies the type of object. It can have one of the following values:","leadings":[""," "],"nodes":[{"content":"[in] Specifies the type of object. It can have one of the following values:","pos":[9,84],"nodes":[{"content":"[in] Specifies the type of object.","pos":[0,34]},{"content":"It can have one of the following values:","pos":[35,75]}]}]},{"pos":[12721,12770],"content":"<bpt id=\"p1\">**</bpt>CCT_SCOPE<ept id=\"p1\">**</ept> Data object for scope pane context.","source":"**CCT_SCOPE** Data object for scope pane context."},{"pos":[12778,12829],"content":"<bpt id=\"p1\">**</bpt>CCT_RESULT<ept id=\"p1\">**</ept> Data object for result pane context.","source":"**CCT_RESULT** Data object for result pane context."},{"pos":[12837,12900],"content":"<bpt id=\"p1\">**</bpt>CCT_SNAPIN_MANAGER<ept id=\"p1\">**</ept> Data object for snap-in manager context.","source":"**CCT_SNAPIN_MANAGER** Data object for snap-in manager context."},{"pos":[12908,12962],"content":"<bpt id=\"p1\">**</bpt>CCT_UNINITIALIZED<ept id=\"p1\">**</ept> Data object has an invalid type.","source":"**CCT_UNINITIALIZED** Data object has an invalid type."},{"pos":[13019,13049],"content":"CSnapInItemImpl::QueryPagesFor"},{"content":"Called to see if the snap-in node supports property pages.","pos":[13053,13111]},{"pos":[13228,13266],"content":"CSnapInItemImpl::SetMenuInsertionFlags"},{"pos":[13270,13382],"content":"Call this function to modify the menu insertion flags, specified by <ph id=\"ph1\">`pInsertionAllowed`</ph>, for the snap-in object.","source":"Call this function to modify the menu insertion flags, specified by `pInsertionAllowed`, for the snap-in object."},{"content":"Parameters","pos":[13485,13495]},{"content":"bBeforeInsertion","pos":[13500,13516]},{"content":"[in] Nonzero if the function should be called before items are added to the context menu; otherwise 0.","pos":[13521,13623]},{"content":"[in, out] Identifies Microsoft Management Console (MMC)-defined, menu-item insertion points that can be used.","pos":[13653,13762]},{"content":"This can be a combination of the following flags:","pos":[13763,13812]},{"pos":[13820,13900],"content":"<bpt id=\"p1\">**</bpt>CCM_INSERTIONALLOWED_TOP<ept id=\"p1\">**</ept> Items can be inserted at the top of a context menu.","source":"**CCM_INSERTIONALLOWED_TOP** Items can be inserted at the top of a context menu."},{"pos":[13908,13985],"content":"<bpt id=\"p1\">**</bpt>CCM_INSERTIONALLOWED_NEW<ept id=\"p1\">**</ept> Items can be inserted in the Create New submenu.","source":"**CCM_INSERTIONALLOWED_NEW** Items can be inserted in the Create New submenu."},{"pos":[13993,14065],"content":"<bpt id=\"p1\">**</bpt>CCM_INSERTIONALLOWED_TASK<ept id=\"p1\">**</ept> Items can be inserted in the Task submenu.","source":"**CCM_INSERTIONALLOWED_TASK** Items can be inserted in the Task submenu."},{"pos":[14073,14205],"content":"<bpt id=\"p1\">**</bpt>CCM_INSERTIONALLOWED_VIEW<ept id=\"p1\">**</ept> Items can be inserted in the toolbar view menu or in the View submenu of the result pane context menu.","source":"**CCM_INSERTIONALLOWED_VIEW** Items can be inserted in the toolbar view menu or in the View submenu of the result pane context menu."},{"content":"Remarks","pos":[14215,14222]},{"content":"If you are developing a primary snap-in, you can reset any of the insertion flags as a way of restricting the kind of menu items that a third-party extension can add.","pos":[14226,14392]},{"content":"For example, the primary snap-in can clear the <bpt id=\"p1\">**</bpt>CCM_INSERTIONALLOWED_NEW<ept id=\"p1\">**</ept> flag to prevent extensions from adding their own Create New menu items.","pos":[14393,14540],"source":" For example, the primary snap-in can clear the **CCM_INSERTIONALLOWED_NEW** flag to prevent extensions from adding their own Create New menu items."},{"content":"You should not attempt to set bits in <ph id=\"ph1\">`pInsertionAllowed`</ph> that were originally cleared.","pos":[14547,14634],"source":"You should not attempt to set bits in `pInsertionAllowed` that were originally cleared."},{"content":"Future versions of MMC may use bits not currently defined so you should not change bits that are currently not defined.","pos":[14635,14754]},{"pos":[14818,14855],"content":"CSnapInItemImpl::SetToolbarButtonInfo"},{"content":"Call this function to modify any toolbar button styles, of the snap-in object, before the toolbar is created.","pos":[14859,14968]},{"content":"Parameters","pos":[15064,15074]},{"content":"[in] The ID of the toolbar button to be set.","pos":[15086,15130]},{"content":"[in] The state flags of the button.","pos":[15150,15185]},{"content":"Can be one or more of the following:","pos":[15186,15222]},{"pos":[15248,15314],"content":"The button has the <bpt id=\"p1\">**</bpt>TBSTYLE_CHECKED<ept id=\"p1\">**</ept> style and is being pressed.","source":" The button has the **TBSTYLE_CHECKED** style and is being pressed."},{"content":"The button accepts user input.","pos":[15340,15370]},{"content":"A button that does not have this state does not accept user input and is grayed.","pos":[15371,15451]},{"pos":[15476,15532],"content":"The button is not visible and cannot receive user input."},{"pos":[15564,15585],"content":"The button is grayed."},{"pos":[15611,15639],"content":"The button is being pressed."},{"content":"A line break follows the button.","pos":[15662,15694]},{"content":"The button must also have the <ph id=\"ph1\">`TBSTATE_ENABLED`</ph>.","pos":[15695,15743],"source":" The button must also have the `TBSTATE_ENABLED`."},{"pos":[15750,15834],"content":"*fsType*  \n[in] The state flags of the button. Can be one or more of the following:","leadings":[""," "],"nodes":[{"content":"fsType","pos":[1,7]},{"content":"[in] The state flags of the button. Can be one or more of the following:","pos":[11,83],"nodes":[{"content":"[in] The state flags of the button.","pos":[0,35]},{"content":"Can be one or more of the following:","pos":[36,72]}]}]},{"pos":[15859,15890],"content":"Creates a standard push button."},{"content":"Creates a button that toggles between the pressed and not-pressed states each time the user clicks it.","pos":[15914,16016]},{"content":"The button has a different background color when it is in the pressed state.","pos":[16017,16093]},{"pos":[16122,16209],"content":"Creates a check button that stays pressed until another button in the group is pressed."},{"pos":[16233,16314],"content":"Creates a button that stays pressed until another button in the group is pressed."},{"content":"Creates a separator, providing a small gap between button groups.","pos":[16336,16401]},{"content":"A button that has this style does not receive user input.","pos":[16402,16459]},{"pos":[16518,16550],"content":"CSnapInItemImpl::UpdateMenuState"},{"content":"Call this function to modify a menu item before it is inserted into the context menu of the snap-in object.","pos":[16554,16661]},{"content":"Parameters","pos":[16749,16759]},{"content":"[in] The ID of the menu item to be set.","pos":[16771,16810]},{"content":"[in] A pointer to the string for the menu item to be updated.","pos":[16827,16888]},{"content":"[in] Specifies the new state flags.","pos":[16906,16941]},{"content":"This can be a combination of the following flags:","pos":[16942,16991]},{"content":"<bpt id=\"p1\">**</bpt>MF_POPUP<ept id=\"p1\">**</ept> Specifies that this is a submenu within the context menu.","pos":[16999,17069],"source":"**MF_POPUP** Specifies that this is a submenu within the context menu."},{"content":"Menu items, insertion points, and further submenus may be added to this submenu using its <bpt id=\"p1\">**</bpt>lCommandID<ept id=\"p1\">**</ept> as their <bpt id=\"p2\">**</bpt>IInsertionPointID<ept id=\"p2\">**</ept>.","pos":[17070,17206],"source":" Menu items, insertion points, and further submenus may be added to this submenu using its **lCommandID** as their **IInsertionPointID**."},{"pos":[17214,17329],"content":"<bpt id=\"p1\">**</bpt>MF_BITMAP<ept id=\"p1\">**</ept> and <ph id=\"ph1\">`MF_OWNERDRAW`</ph> These flags are not permitted and will result in a return value of <ph id=\"ph2\">`E_INVALIDARG`</ph>.","source":"**MF_BITMAP** and `MF_OWNERDRAW` These flags are not permitted and will result in a return value of `E_INVALIDARG`."},{"content":"<bpt id=\"p1\">**</bpt>MF_SEPARATOR<ept id=\"p1\">**</ept> Draws a horizontal dividing line.","pos":[17337,17387],"source":"**MF_SEPARATOR** Draws a horizontal dividing line."},{"content":"Only <bpt id=\"p1\">**</bpt>IContextMenuProvider<ept id=\"p1\">**</ept> is allowed to add menu items with <bpt id=\"p2\">**</bpt>MF_SEPARATOR<ept id=\"p2\">**</ept> set.","pos":[17388,17473],"source":" Only **IContextMenuProvider** is allowed to add menu items with **MF_SEPARATOR** set."},{"pos":[17481,17538],"content":"<bpt id=\"p1\">**</bpt>MF_CHECKED<ept id=\"p1\">**</ept> Places a check mark next to the menu item.","source":"**MF_CHECKED** Places a check mark next to the menu item."},{"pos":[17546,17641],"content":"<bpt id=\"p1\">**</bpt>MF_DISABLED<ept id=\"p1\">**</ept> Disables the menu item so it cannot be selected, but the flag does not gray it.","source":"**MF_DISABLED** Disables the menu item so it cannot be selected, but the flag does not gray it."},{"pos":[17662,17742],"content":"Enables the menu item so it can be selected, restoring it from its grayed state."},{"pos":[17750,17824],"content":"<bpt id=\"p1\">**</bpt>MF_GRAYED<ept id=\"p1\">**</ept> Disables the menu item, graying it so it cannot be selected.","source":"**MF_GRAYED** Disables the menu item, graying it so it cannot be selected."},{"content":"<bpt id=\"p1\">**</bpt>MF_MENUBARBREAK<ept id=\"p1\">**</ept> Functions the same as the <bpt id=\"p2\">**</bpt>MF_MENUBREAK<ept id=\"p2\">**</ept> flag for a menu bar.","pos":[17832,17915],"source":"**MF_MENUBARBREAK** Functions the same as the **MF_MENUBREAK** flag for a menu bar."},{"content":"For a drop-down menu, submenu, or shortcut menu, the new column is separated from the old column by a vertical line.","pos":[17916,18032]},{"pos":[18040,18200],"content":"<bpt id=\"p1\">**</bpt>MF_MENUBREAK<ept id=\"p1\">**</ept> Places the item on a new line (for a menu bar) or in a new column (for a drop-down menu, submenu, or shortcut menu) without separating columns.","source":"**MF_MENUBREAK** Places the item on a new line (for a menu bar) or in a new column (for a drop-down menu, submenu, or shortcut menu) without separating columns."},{"pos":[18208,18280],"content":"<bpt id=\"p1\">**</bpt>MF_UNCHECKED<ept id=\"p1\">**</ept> Does not place a check mark next to the item (default).","source":"**MF_UNCHECKED** Does not place a check mark next to the item (default)."},{"content":"The following groups of flags cannot be used together:","pos":[18287,18341]},{"pos":[18349,18398],"content":"<bpt id=\"p1\">**</bpt>MF_DISABLED<ept id=\"p1\">**</ept>, <ph id=\"ph1\">`MF_ENABLED`</ph>, and <bpt id=\"p2\">**</bpt>MF_GRAYED<ept id=\"p2\">**</ept>.","source":"**MF_DISABLED**, `MF_ENABLED`, and **MF_GRAYED**."},{"pos":[18406,18447],"content":"<bpt id=\"p1\">**</bpt>MF_MENUBARBREAK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>MF_MENUBREAK<ept id=\"p2\">**</ept>.","source":"**MF_MENUBARBREAK** and **MF_MENUBREAK**."},{"pos":[18455,18491],"content":"<bpt id=\"p1\">**</bpt>MF_CHECKED<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>MF_UNCHECKED<ept id=\"p2\">**</ept>.","source":"**MF_CHECKED** and **MF_UNCHECKED**."},{"pos":[18554,18590],"content":"CSnapInItemImpl::UpdateToolbarButton"},{"content":"Call this function to modify a toolbar button, of the snap-in object, before it is displayed.","pos":[18594,18687]},{"content":"Parameters","pos":[18760,18770]},{"content":"Specifies the button ID of the toolbar button to be updated.","pos":[18782,18842]},{"content":"Specifies a toolbar button state.","pos":[18862,18895]},{"content":"If this state is to be set, return <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>.","pos":[18896,18940],"source":" If this state is to be set, return **TRUE**."},{"content":"This can be a combination of the following flags:","pos":[18941,18990]},{"content":"<bpt id=\"p1\">**</bpt>ENABLED<ept id=\"p1\">**</ept> The button accepts user input.","pos":[18998,19040],"source":"**ENABLED** The button accepts user input."},{"content":"A button that does not have this state does not accept user input and is grayed.","pos":[19041,19121]},{"pos":[19129,19199],"content":"<bpt id=\"p1\">**</bpt>CHECKED<ept id=\"p1\">**</ept> The button has the <bpt id=\"p2\">**</bpt>CHECKED<ept id=\"p2\">**</ept> style and is being pressed.","source":"**CHECKED** The button has the **CHECKED** style and is being pressed."},{"pos":[19207,19274],"content":"<bpt id=\"p1\">**</bpt>HIDDEN<ept id=\"p1\">**</ept> The button is not visible and cannot receive user input.","source":"**HIDDEN** The button is not visible and cannot receive user input."},{"pos":[19282,19321],"content":"<bpt id=\"p1\">**</bpt>INDETERMINATE<ept id=\"p1\">**</ept> The button is grayed.","source":"**INDETERMINATE** The button is grayed."},{"pos":[19329,19375],"content":"<bpt id=\"p1\">**</bpt>BUTTONPRESSED<ept id=\"p1\">**</ept> The button is being pressed.","source":"**BUTTONPRESSED** The button is being pressed."},{"content":"See Also","pos":[19384,19392]},{"content":"Class Overview","pos":[19397,19411]}],"content":"---\ntitle: \"CSnapInItemImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CSnapInItemImpl\"\n  - \"ATL.CSnapInItemImpl\"\n  - \"ATL::CSnapInItemImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"snap-ins, data items\"\n  - \"snap-ins, ATL support for\"\n  - \"CSnapInItemImpl class\"\n  - \"snap-ins\"\nms.assetid: 52caefbd-9eae-49b0-add2-d55524271aa7\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CSnapInItemImpl Class\nThis class provides methods for implementing a snap-in node object.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\ntemplate <class T,  BOOL bIsExtension = FALSE>  class ATL_NO_VTABLE CSnapInItemImpl :  public CSnapInItem\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `CSnapInItemImpl`.  \n  \n *bIsExtension*  \n **TRUE** if the object is a snap-in extension; otherwise **FALSE**.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CSnapInItemImpl::CSnapInItemImpl](#csnapinitemimpl__csnapinitemimpl)|Constructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CSnapInItemImpl::AddMenuItems](#csnapinitemimpl__addmenuitems)|Adds menu items to a context menu.|  \n|[CSnapInItemImpl::Command](#csnapinitemimpl__command)|Called by the console when a custom menu item is selected.|  \n|[CSnapInItemImpl::CreatePropertyPages](#csnapinitemimpl__createpropertypages)|Adds pages to the property sheet of the snap-in.|  \n|[CSnapInItemImpl::FillData](#csnapinitemimpl__filldata)|Copies information on the snap-in object into a specified stream.|  \n|[CSnapInItemImpl::GetResultPaneInfo](#csnapinitemimpl__getresultpaneinfo)|Retrieves the **RESULTDATAITEM** structure of the snap-in.|  \n|[CSnapInItemImpl::GetResultViewType](#csnapinitemimpl__getresultviewtype)|Determines the type of view used by the result pane.|  \n|[CSnapInItemImpl::GetScopePaneInfo](#csnapinitemimpl__getscopepaneinfo)|Retrieves the **SCOPEDATAITEM** structure of the snap-in.|  \n|[CSnapInItemImpl::Notify](#csnapinitemimpl__notify)|Called by the console to notify the snap-in of actions taken by the user.|  \n|[CSnapInItemImpl::QueryPagesFor](#csnapinitemimpl__querypagesfor)|Called to see if the snap-in node supports property pages.|  \n|[CSnapInItemImpl::SetMenuInsertionFlags](#csnapinitemimpl__setmenuinsertionflags)|Modifies the menu insertion flags for a snap-in object.|  \n|[CSnapInItemImpl::SetToolbarButtonInfo](#csnapinitemimpl__settoolbarbuttoninfo)|Sets the information of the specified toolbar button.|  \n|[CSnapInItemImpl::UpdateMenuState](#csnapinitemimpl__updatemenustate)|Updates the state of a context menu item.|  \n|[CSnapInItemImpl::UpdateToolbarButton](#csnapinitemimpl__updatetoolbarbutton)|Updates the state of the specified toolbar button.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CSnapInItemImpl::m_bstrDisplayName](#csnapinitemimpl__m_bstrdisplayname)|The name of the snap-in object.|  \n|[CSnapInItemImpl::m_resultDataItem](#csnapinitemimpl__m_resultdataitem)|The Windows **RESULTDATAITEM** structure used by the `CSnapInItemImpl` object.|  \n|[CSnapInItemImpl::m_scopeDataItem](#csnapinitemimpl__m_scopedataitem)|The Windows **SCOPEDATAITEM** structure used by the `CSnapInItemImpl` object.|  \n  \n## Remarks  \n `CSnapInItemImpl` provides a basic implementation for a snap-in node object, such as adding menu items and toolbars, and forwarding commands for the snap-in node to the appropriate handler function. These features are implemented using several different interfaces and map types. The default implementation handles notifications sent to the node object by determining the correct instance of the derived class and then forwarding the message to the correct instance.  \n  \n## Inheritance Hierarchy  \n `CSnapInItem`  \n  \n `CSnapInItemImpl`  \n  \n## Requirements  \n **Header:** atlsnap.h  \n  \n##  <a name=\"csnapinitemimpl__addmenuitems\"></a>  CSnapInItemImpl::AddMenuItems  \n This method implements the Win32 function [IExtendContextMenu::AddMenuItems](http://msdn.microsoft.com/library/aa814841).  \n  \n```\nAddMenuItems(LPCONTEXTMENUCALLBACK piCallback,\n    long* pInsertionAllowed,\n    DATA_OBJECT_TYPES type);\n```  \n  \n### Parameters  \n *piCallback*  \n [in] Pointer to the **IContextMenuCallback** that can add items to the context menu.  \n  \n `pInsertionAllowed`  \n [in, out] Identifies Microsoft Management Console (MMC)-defined, menu-item insertion points that can be used. This can be a combination of the following flags:  \n  \n- **CCM_INSERTIONALLOWED_TOP** Items can be inserted at the top of a context menu.  \n  \n- **CCM_INSERTIONALLOWED_NEW** Items can be inserted in the Create New submenu.  \n  \n- **CCM_INSERTIONALLOWED_TASK** Items can be inserted in the Task submenu.  \n  \n- **CCM_INSERTIONALLOWED_VIEW** Items can be inserted in the toolbar view menu or in the View submenu of the result pane context menu.  \n  \n `type`  \n [in] Specifies the type of object. It can have one of the following values:  \n  \n- **CCT_SCOPE** Data object for scope pane context.  \n  \n- **CCT_RESULT** Data object for result pane context.  \n  \n- **CCT_SNAPIN_MANAGER** Data object for snap-in manager context.  \n  \n- **CCT_UNINITIALIZED** Data object has an invalid type.  \n  \n##  <a name=\"csnapinitemimpl__command\"></a>  CSnapInItemImpl::Command  \n This method implements the Win32 function [IExtendContextMenu::Command](http://msdn.microsoft.com/library/aa814842).  \n  \n```\nCommand(long lCommandID,  DATA_OBJECT_TYPES type);\n```  \n  \n### Parameters  \n *lCommandID*  \n [in] Specifies the command identifier of the menu item.  \n  \n `type`  \n [in] Specifies the type of object. It can have one of the following values:  \n  \n- **CCT_SCOPE** Data object for scope pane context.  \n  \n- **CCT_RESULT** Data object for result pane context.  \n  \n- **CCT_SNAPIN_MANAGER** Data object for snap-in manager context.  \n  \n- **CCT_UNINITIALIZED** Data object has an invalid type.  \n  \n##  <a name=\"csnapinitemimpl__createpropertypages\"></a>  CSnapInItemImpl::CreatePropertyPages  \n This method implements the Win32 function [IExtendPropertySheet::CreatePropertyPages](http://msdn.microsoft.com/library/aa814846).  \n  \n```\nCreatePropertyPages(LPPROPERTYSHEETCALLBACK lpProvider,\n    long handle,\n    IUnknown* pUnk,\n    DATA_OBJECT_TYPES type);\n```  \n  \n### Parameters  \n *lpProvider*  \n [in] Pointer to the **IPropertySheetCallback** interface.  \n  \n *handle*  \n [in] Specifies the handle used to route the **MMCN_PROPERTY_CHANGE** notification message to the appropriate data class.  \n  \n *pUnk*  \n [in] Pointer to the **IExtendPropertySheet** interface on the object that contains context information about the node.  \n  \n `type`  \n [in] Specifies the type of object. It can have one of the following values:  \n  \n- **CCT_SCOPE** Data object for scope pane context.  \n  \n- **CCT_RESULT** Data object for result pane context.  \n  \n- **CCT_SNAPIN_MANAGER** Data object for snap-in manager context.  \n  \n- **CCT_UNINITIALIZED** Data object has an invalid type.  \n  \n##  <a name=\"csnapinitemimpl__csnapinitemimpl\"></a>  CSnapInItemImpl::CSnapInItemImpl  \n Constructs a `CSnapInItemImpl` object.  \n  \n```\nCSnapInItemImpl();\n```  \n  \n##  <a name=\"csnapinitemimpl__filldata\"></a>  CSnapInItemImpl::FillData  \n This function is called to retrieve information about the item.  \n  \n```\nFillData(CLIPFORMAT cf,  LPSTREAM pStream);\n```  \n  \n### Parameters  \n `cf`  \n [in] The format (text, rich text, or rich text with OLE items) of the Clipboard.  \n  \n `pStream`  \n [in] A pointer to the stream containing the object data.  \n  \n### Remarks  \n To properly implement this function, copy the correct information into the stream ( `pStream`), depending on the Clipboard format indicated by `cf`.  \n  \n##  <a name=\"csnapinitemimpl__getresultviewtype\"></a>  CSnapInItemImpl::GetResultViewType  \n Call this function to retrieve the type of view for the result pane of the snap-in object.  \n  \n```\nGetResultViewType(\n    LPOLESTR* ppViewType,\n    long* pViewOptions);\n```  \n  \n### Parameters  \n *ppViewType*  \n [out] Pointer to the address of the returned view type.  \n  \n *pViewOptions*  \n [out] Pointer to the **MMC_VIEW_OPTIONS** enumeration, which provides the console with options specified by the owning snap-in. This value can be one of the following:  \n  \n- **MMC_VIEW_OPTIONS_NOLISTVIEWS** = 0x00000001   Tells the console to refrain from presenting standard list view choices in the **View** menu. Allows the snap-in to display its own custom views only in the result view pane. This is the only option flag defined at this time.  \n  \n- **MMC_VIEW_OPTIONS_NONE** = 0   Allows the default view options.  \n  \n##  <a name=\"csnapinitemimpl__getscopepaneinfo\"></a>  CSnapInItemImpl::GetScopePaneInfo  \n Call this function to retrieve the **SCOPEDATAITEM** structure of the snap-in.  \n  \n```\nGetScopePaneInfo (SCOPEDATAITEM* pScopeDataItem);\n```  \n  \n### Parameters  \n *pScopeDataItem*  \n [out] A pointer to the **SCOPEDATAITEM** structure of the `CSnapInItemImpl` object.  \n  \n##  <a name=\"csnapinitemimpl__getresultpaneinfo\"></a>  CSnapInItemImpl::GetResultPaneInfo  \n Call this function to retrieve the **RESULTDATAITEM** structure of the snap-in.  \n  \n```\nGetResultPaneInfo (RESULTDATAITEM* pResultDataItem);\n```  \n  \n### Parameters  \n *pResultDataItem*  \n [out] A pointer to the **RESULTDATAITEM** structure of the `CSnapInItemImpl` object.  \n  \n##  <a name=\"csnapinitemimpl__m_bstrdisplayname\"></a>  CSnapInItemImpl::m_bstrDisplayName  \n Contains the string displayed for the node item.  \n  \n```\nCComBSTR m_bstrDisplayName;\n```  \n  \n##  <a name=\"csnapinitemimpl__m_scopedataitem\"></a>  CSnapInItemImpl::m_scopeDataItem  \n The `SCOPEDATAITEM` structure of the snap-in data object.  \n  \n```\nSCOPEDATAITEM m_scopeDataItem;\n```  \n  \n##  <a name=\"csnapinitemimpl__m_resultdataitem\"></a>  CSnapInItemImpl::m_resultDataItem  \n The [RESULTDATAITEM](http://msdn.microsoft.com/library/aa815165) structure of the snap-in data object.  \n  \n```\nRESULTDATAITEM m_resultDataItem;\n```  \n  \n##  <a name=\"csnapinitemimpl__notify\"></a>  CSnapInItemImpl::Notify  \n Called when the snap-in object is acted upon by the user.  \n  \n```\nSTDMETHOD(Notify)(MMC_NOTIFY_TYPE event,\n    long arg,\n    long param,\n    IComponentData* pComponentData,\n    IComponent* pComponent,\n    DATA_OBJECT_TYPES type) = 0;\n```  \n  \n### Parameters  \n `event`  \n [in] Identifies an action taken by a user. The following notifications are possible:  \n  \n- **MMCN_ACTIVATE** Sent when a window is being activated and deactivated.  \n  \n- **MMCN_ADD_IMAGES** Sent to add images to the result pane.  \n  \n- **MMCN_BTN_CLICK** Sent when the user clicks one of the toolbar buttons.  \n  \n- **MMCN_CLICK** Sent when a user clicks a mouse button on a list view item.  \n  \n- **MMCN_DBLCLICK** Sent when a user double clicks a mouse button on a list view item.  \n  \n- **MMCN_DELETE** Sent to inform the snap-in that the object should be deleted.  \n  \n- **MMCN_EXPAND** Sent when a folder needs to be expanded or contracted.  \n  \n- **MMCN_MINIMIZED** Sent when a window is being minimized or maximized.  \n  \n- **MMCN_PROPERTY_CHANGE** Sent to notify a snap-in object that the snap-in object's view is about to change.  \n  \n- **MMCN_REMOVE_CHILDREN** Sent when the snap-in must delete the entire subtree it has added below the specified node.  \n  \n- **MMCN_RENAME** Sent the first time to query for a rename and the second time to do the rename.  \n  \n- **MMCN_SELECT** Sent when an item in the scope or result view pane is selected.  \n  \n- **MMCN_SHOW** Sent when a scope item is selected or deselected for the first time.  \n  \n- **MMCN_VIEW_CHANGE** Sent when the snap-in can update all views when a change occurs.  \n  \n `arg`  \n [in] Depends on the notification type.  \n  \n `param`  \n [in] Depends on the notification type.  \n  \n *pComponentData*  \n [out] A pointer to the object implementing **IComponentData**. This parameter is **NULL** if the notification is not being forwarded from **IComponentData::Notify**.  \n  \n *pComponent*  \n [out] A pointer to the object that implements **IComponent**. This parameter is **NULL** if the notification is not being forwarded from **IComponent::Notify**.  \n  \n `type`  \n [in] Specifies the type of object. It can have one of the following values:  \n  \n- **CCT_SCOPE** Data object for scope pane context.  \n  \n- **CCT_RESULT** Data object for result pane context.  \n  \n- **CCT_SNAPIN_MANAGER** Data object for snap-in manager context.  \n  \n- **CCT_UNINITIALIZED** Data object has an invalid type.  \n  \n##  <a name=\"csnapinitemimpl__querypagesfor\"></a>  CSnapInItemImpl::QueryPagesFor  \n Called to see if the snap-in node supports property pages.  \n  \n```\nQueryPagesFor(DATA_OBJECT_TYPES type);\n```  \n  \n##  <a name=\"csnapinitemimpl__setmenuinsertionflags\"></a>  CSnapInItemImpl::SetMenuInsertionFlags  \n Call this function to modify the menu insertion flags, specified by `pInsertionAllowed`, for the snap-in object.  \n  \n```\nvoid SetMenuInsertionFlags(bool bBeforeInsertion,\n    long* pInsertionAllowed);\n```  \n  \n### Parameters  \n *bBeforeInsertion*  \n [in] Nonzero if the function should be called before items are added to the context menu; otherwise 0.  \n  \n `pInsertionAllowed`  \n [in, out] Identifies Microsoft Management Console (MMC)-defined, menu-item insertion points that can be used. This can be a combination of the following flags:  \n  \n- **CCM_INSERTIONALLOWED_TOP** Items can be inserted at the top of a context menu.  \n  \n- **CCM_INSERTIONALLOWED_NEW** Items can be inserted in the Create New submenu.  \n  \n- **CCM_INSERTIONALLOWED_TASK** Items can be inserted in the Task submenu.  \n  \n- **CCM_INSERTIONALLOWED_VIEW** Items can be inserted in the toolbar view menu or in the View submenu of the result pane context menu.  \n  \n### Remarks  \n If you are developing a primary snap-in, you can reset any of the insertion flags as a way of restricting the kind of menu items that a third-party extension can add. For example, the primary snap-in can clear the **CCM_INSERTIONALLOWED_NEW** flag to prevent extensions from adding their own Create New menu items.  \n  \n You should not attempt to set bits in `pInsertionAllowed` that were originally cleared. Future versions of MMC may use bits not currently defined so you should not change bits that are currently not defined.  \n  \n##  <a name=\"csnapinitemimpl__settoolbarbuttoninfo\"></a>  CSnapInItemImpl::SetToolbarButtonInfo  \n Call this function to modify any toolbar button styles, of the snap-in object, before the toolbar is created.  \n  \n```\nvoid SetToolbarButtonInfo(UINT id,\n    BYTE* fsState,\n    BYTE* fsType);\n```  \n  \n### Parameters  \n `id`  \n [in] The ID of the toolbar button to be set.  \n  \n `fsState`  \n [in] The state flags of the button. Can be one or more of the following:  \n  \n- `TBSTATE_CHECKED` The button has the **TBSTYLE_CHECKED** style and is being pressed.  \n  \n- `TBSTATE_ENABLED` The button accepts user input. A button that does not have this state does not accept user input and is grayed.  \n  \n- `TBSTATE_HIDDEN` The button is not visible and cannot receive user input.  \n  \n- `TBSTATE_INDETERMINATE` The button is grayed.  \n  \n- `TBSTATE_PRESSED` The button is being pressed.  \n  \n- `TBSTATE_WRAP` A line break follows the button. The button must also have the `TBSTATE_ENABLED`.  \n  \n *fsType*  \n [in] The state flags of the button. Can be one or more of the following:  \n  \n- `TBSTYLE_BUTTON` Creates a standard push button.  \n  \n- `TBSTYLE_CHECK` Creates a button that toggles between the pressed and not-pressed states each time the user clicks it. The button has a different background color when it is in the pressed state.  \n  \n- `TBSTYLE_CHECKGROUP` Creates a check button that stays pressed until another button in the group is pressed.  \n  \n- `TBSTYLE_GROUP` Creates a button that stays pressed until another button in the group is pressed.  \n  \n- `TBSTYLE_SEP` Creates a separator, providing a small gap between button groups. A button that has this style does not receive user input.  \n  \n##  <a name=\"csnapinitemimpl__updatemenustate\"></a>  CSnapInItemImpl::UpdateMenuState  \n Call this function to modify a menu item before it is inserted into the context menu of the snap-in object.  \n  \n```\nvoid UpdateMenuState(UINT id,\n    LPTSTR pBuf,\n    UINT* flags);\n```  \n  \n### Parameters  \n `id`  \n [in] The ID of the menu item to be set.  \n  \n `pBuf`  \n [in] A pointer to the string for the menu item to be updated.  \n  \n `flags`  \n [in] Specifies the new state flags. This can be a combination of the following flags:  \n  \n- **MF_POPUP** Specifies that this is a submenu within the context menu. Menu items, insertion points, and further submenus may be added to this submenu using its **lCommandID** as their **IInsertionPointID**.  \n  \n- **MF_BITMAP** and `MF_OWNERDRAW` These flags are not permitted and will result in a return value of `E_INVALIDARG`.  \n  \n- **MF_SEPARATOR** Draws a horizontal dividing line. Only **IContextMenuProvider** is allowed to add menu items with **MF_SEPARATOR** set.  \n  \n- **MF_CHECKED** Places a check mark next to the menu item.  \n  \n- **MF_DISABLED** Disables the menu item so it cannot be selected, but the flag does not gray it.  \n  \n- `MF_ENABLED` Enables the menu item so it can be selected, restoring it from its grayed state.  \n  \n- **MF_GRAYED** Disables the menu item, graying it so it cannot be selected.  \n  \n- **MF_MENUBARBREAK** Functions the same as the **MF_MENUBREAK** flag for a menu bar. For a drop-down menu, submenu, or shortcut menu, the new column is separated from the old column by a vertical line.  \n  \n- **MF_MENUBREAK** Places the item on a new line (for a menu bar) or in a new column (for a drop-down menu, submenu, or shortcut menu) without separating columns.  \n  \n- **MF_UNCHECKED** Does not place a check mark next to the item (default).  \n  \n The following groups of flags cannot be used together:  \n  \n- **MF_DISABLED**, `MF_ENABLED`, and **MF_GRAYED**.  \n  \n- **MF_MENUBARBREAK** and **MF_MENUBREAK**.  \n  \n- **MF_CHECKED** and **MF_UNCHECKED**.  \n  \n##  <a name=\"csnapinitemimpl__updatetoolbarbutton\"></a>  CSnapInItemImpl::UpdateToolbarButton  \n Call this function to modify a toolbar button, of the snap-in object, before it is displayed.  \n  \n```\nBOOL UpdateToolbarButton(UINT id,  BYTE fsState);\n```  \n  \n### Parameters  \n `id`  \n Specifies the button ID of the toolbar button to be updated.  \n  \n `fsState`  \n Specifies a toolbar button state. If this state is to be set, return **TRUE**. This can be a combination of the following flags:  \n  \n- **ENABLED** The button accepts user input. A button that does not have this state does not accept user input and is grayed.  \n  \n- **CHECKED** The button has the **CHECKED** style and is being pressed.  \n  \n- **HIDDEN** The button is not visible and cannot receive user input.  \n  \n- **INDETERMINATE** The button is grayed.  \n  \n- **BUTTONPRESSED** The button is being pressed.  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}