{"nodes":[{"pos":[12,43],"content":"CPalette Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CPalette Class | Microsoft Docs","pos":[0,31]}]},{"content":"CPalette Class","pos":[654,668]},{"content":"Encapsulates a Windows color palette.","pos":[669,706]},{"content":"Syntax","pos":[715,721]},{"content":"Members","pos":[782,789]},{"content":"Public Constructors","pos":[799,818]},{"content":"Name","pos":[825,829]},{"content":"Description","pos":[830,841]},{"content":"CPalette::CPalette","pos":[880,898]},{"content":"Constructs a <ph id=\"ph1\">`CPalette`</ph> object with no attached Windows palette.","pos":[921,985],"source":"Constructs a `CPalette` object with no attached Windows palette."},{"content":"You must initialize the <ph id=\"ph1\">`CPalette`</ph> object with one of the initialization member functions before it can be used.","pos":[986,1098],"source":" You must initialize the `CPalette` object with one of the initialization member functions before it can be used."},{"content":"Public Methods","pos":[1109,1123]},{"content":"Name","pos":[1130,1134]},{"content":"Description","pos":[1135,1146]},{"content":"CPalette::AnimatePalette","pos":[1185,1209]},{"content":"Replaces entries in the logical palette identified by the <ph id=\"ph1\">`CPalette`</ph> object.","pos":[1238,1314],"source":"Replaces entries in the logical palette identified by the `CPalette` object."},{"content":"The application does not have to update its client area, because Windows maps the new entries into the system palette immediately.","pos":[1315,1445]},{"content":"CPalette::CreateHalftonePalette","pos":[1451,1482]},{"pos":[1518,1609],"content":"Creates a halftone palette for the device context and attaches it to the <ph id=\"ph1\">`CPalette`</ph> object.","source":"Creates a halftone palette for the device context and attaches it to the `CPalette` object."},{"content":"CPalette::CreatePalette","pos":[1615,1638]},{"pos":[1666,1739],"content":"Creates a Windows color palette and attaches it to the <ph id=\"ph1\">`CPalette`</ph> object.","source":"Creates a Windows color palette and attaches it to the `CPalette` object."},{"content":"CPalette::FromHandle","pos":[1745,1765]},{"pos":[1790,1879],"content":"Returns a pointer to a <ph id=\"ph1\">`CPalette`</ph> object when given a handle to a Windows palette object.","source":"Returns a pointer to a `CPalette` object when given a handle to a Windows palette object."},{"content":"CPalette::GetEntryCount","pos":[1885,1908]},{"content":"Retrieves the number of palette entries in a logical palette.","pos":[1936,1997]},{"content":"CPalette::GetNearestPaletteIndex","pos":[2003,2035]},{"content":"Returns the index of the entry in the logical palette that most closely matches a color value.","pos":[2072,2166]},{"content":"CPalette::GetPaletteEntries","pos":[2172,2199]},{"content":"Retrieves a range of palette entries in a logical palette.","pos":[2231,2289]},{"content":"CPalette::ResizePalette","pos":[2295,2318]},{"pos":[2346,2456],"content":"Changes the size of the logical palette specified by the <ph id=\"ph1\">`CPalette`</ph> object to the specified number of entries.","source":"Changes the size of the logical palette specified by the `CPalette` object to the specified number of entries."},{"content":"CPalette::SetPaletteEntries","pos":[2462,2489]},{"content":"Sets RGB color values and flags in a range of entries in a logical palette.","pos":[2521,2596]},{"content":"Public Operators","pos":[2607,2623]},{"content":"Name","pos":[2630,2634]},{"content":"Description","pos":[2635,2646]},{"content":"CPalette::operator HPALETTE","pos":[2685,2712]},{"pos":[2744,2794],"content":"Returns the <ph id=\"ph1\">`HPALETTE`</ph> attached to the <ph id=\"ph2\">`CPalette`</ph>.","source":"Returns the `HPALETTE` attached to the `CPalette`."},{"content":"Remarks","pos":[2804,2811]},{"content":"A palette provides an interface between an application and a color output device (such as a display device).","pos":[2815,2923]},{"content":"The interface allows the application to take full advantage of the color capabilities of the output device without severely interfering with the colors displayed by other applications.","pos":[2924,3108]},{"content":"Windows uses the application's logical palette (a list of needed colors) and the system palette (which defines available colors) to determine the colors used.","pos":[3109,3267]},{"content":"A <ph id=\"ph1\">`CPalette`</ph> object provides member functions for manipulating the palette referred to by the object.","pos":[3274,3375],"source":"A `CPalette` object provides member functions for manipulating the palette referred to by the object."},{"content":"Construct a <ph id=\"ph1\">`CPalette`</ph> object and use its member functions to create the actual palette, a graphics device interface (GDI) object, and to manipulate its entries and other properties.","pos":[3376,3558],"source":" Construct a `CPalette` object and use its member functions to create the actual palette, a graphics device interface (GDI) object, and to manipulate its entries and other properties."},{"pos":[3565,3659],"content":"For more information on using <ph id=\"ph1\">`CPalette`</ph>, see <bpt id=\"p1\">[</bpt>Graphic Objects<ept id=\"p1\">](../../mfc/graphic-objects.md)</ept>.","source":"For more information on using `CPalette`, see [Graphic Objects](../../mfc/graphic-objects.md)."},{"content":"Inheritance Hierarchy","pos":[3668,3689]},{"content":"CObject","pos":[3694,3701]},{"content":"CGdiObject","pos":[3748,3758]},{"content":"Requirements","pos":[3826,3838]},{"pos":[3842,3862],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxwin.h","source":"**Header:** afxwin.h"},{"pos":[3913,3937],"content":"CPalette::AnimatePalette"},{"pos":[3941,4015],"content":"Replaces entries in the logical palette attached to the <ph id=\"ph1\">`CPalette`</ph> object.","source":"Replaces entries in the logical palette attached to the `CPalette` object."},{"content":"Parameters","pos":[4146,4156]},{"content":"Specifies the first entry in the palette to be animated.","pos":[4177,4233]},{"content":"Specifies the number of entries in the palette to be animated.","pos":[4257,4319]},{"content":"Points to the first member of an array of <bpt id=\"p1\">[</bpt>PALETTEENTRY<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd162769)</ept> structures to replace the palette entries identified by <ph id=\"ph1\">`nStartIndex`</ph> and <ph id=\"ph2\">`nNumEntries`</ph>.","pos":[4347,4552],"source":" Points to the first member of an array of [PALETTEENTRY](http://msdn.microsoft.com/library/windows/desktop/dd162769) structures to replace the palette entries identified by `nStartIndex` and `nNumEntries`."},{"content":"Remarks","pos":[4562,4569]},{"pos":[4573,4734],"content":"When an application calls <ph id=\"ph1\">`AnimatePalette`</ph>, it does not have to update its client area, because Windows maps the new entries into the system palette immediately.","source":"When an application calls `AnimatePalette`, it does not have to update its client area, because Windows maps the new entries into the system palette immediately."},{"content":"The <ph id=\"ph1\">`AnimatePalette`</ph> function will only change entries with the <bpt id=\"p1\">**</bpt>PC_RESERVED<ept id=\"p1\">**</ept> flag set in the corresponding <bpt id=\"p2\">**</bpt>palPaletteEntry<ept id=\"p2\">**</ept> member of the <bpt id=\"p3\">[</bpt>LOGPALETTE<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/dd145040)</ept> structure that is attached to the <ph id=\"ph2\">`CPalette`</ph> object.","pos":[4741,5010],"source":"The `AnimatePalette` function will only change entries with the **PC_RESERVED** flag set in the corresponding **palPaletteEntry** member of the [LOGPALETTE](http://msdn.microsoft.com/library/windows/desktop/dd145040) structure that is attached to the `CPalette` object."},{"content":"See <bpt id=\"p1\">**</bpt>LOGPALETTE<ept id=\"p1\">**</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for more information about this structure.","pos":[5011,5131],"source":" See **LOGPALETTE** in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about this structure."},{"pos":[5176,5194],"content":"CPalette::CPalette"},{"pos":[5198,5229],"content":"Constructs a <ph id=\"ph1\">`CPalette`</ph> object.","source":"Constructs a `CPalette` object."},{"content":"Remarks","pos":[5266,5273]},{"pos":[5277,5357],"content":"The object has no attached palette until you call <ph id=\"ph1\">`CreatePalette`</ph> to attach one.","source":"The object has no attached palette until you call `CreatePalette` to attach one."},{"pos":[5415,5446],"content":"CPalette::CreateHalftonePalette"},{"content":"Creates a halftone palette for the device context.","pos":[5450,5500]},{"content":"Parameters","pos":[5563,5573]},{"content":"Identifies the device context.","pos":[5586,5616]},{"content":"Return Value","pos":[5626,5638]},{"content":"Nonzero if the function is successful; otherwise 0.","pos":[5642,5693]},{"content":"Remarks","pos":[5703,5710]},{"content":"An application should create a halftone palette when the stretching mode of a device context is set to <bpt id=\"p1\">**</bpt>HALFTONE<ept id=\"p1\">**</ept>.","pos":[5714,5830],"source":"An application should create a halftone palette when the stretching mode of a device context is set to **HALFTONE**."},{"content":"The logical halftone palette returned by the <bpt id=\"p1\">[</bpt>CreateHalftonePalette<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183503)</ept> member function should then be selected and realized into the device context before the <bpt id=\"p2\">[</bpt>CDC::StretchBlt<ept id=\"p2\">](../../mfc/reference/cdc-class.md#cdc__stretchblt)</ept> or <bpt id=\"p3\">[</bpt>StretchDIBits<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/dd145121)</ept> function is called.","pos":[5831,6214],"source":" The logical halftone palette returned by the [CreateHalftonePalette](http://msdn.microsoft.com/library/windows/desktop/dd183503) member function should then be selected and realized into the device context before the [CDC::StretchBlt](../../mfc/reference/cdc-class.md#cdc__stretchblt) or [StretchDIBits](http://msdn.microsoft.com/library/windows/desktop/dd145121) function is called."},{"pos":[6221,6354],"content":"See the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for more information about <ph id=\"ph2\">`CreateHalftonePalette`</ph> and <bpt id=\"p1\">**</bpt>StretchDIBits<ept id=\"p1\">**</ept>.","source":"See the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about `CreateHalftonePalette` and **StretchDIBits**."},{"pos":[6404,6427],"content":"CPalette::CreatePalette"},{"pos":[6431,6549],"content":"Initializes a <ph id=\"ph1\">`CPalette`</ph> object by creating a Windows logical color palette and attaching it to the <ph id=\"ph2\">`CPalette`</ph> object.","source":"Initializes a `CPalette` object by creating a Windows logical color palette and attaching it to the `CPalette` object."},{"content":"Parameters","pos":[6621,6631]},{"content":"Points to a <bpt id=\"p1\">[</bpt>LOGPALETTE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd145040)</ept> structure that contains information about the colors in the logical palette.","pos":[6653,6814],"source":" Points to a [LOGPALETTE](http://msdn.microsoft.com/library/windows/desktop/dd145040) structure that contains information about the colors in the logical palette."},{"content":"Return Value","pos":[6824,6836]},{"content":"Nonzero if successful; otherwise 0.","pos":[6840,6875]},{"content":"Remarks","pos":[6885,6892]},{"pos":[6896,7012],"content":"See the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for more information about the <bpt id=\"p1\">**</bpt>LOGPALETTE<ept id=\"p1\">**</ept> structure.","source":"See the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about the **LOGPALETTE** structure."},{"pos":[7059,7079],"content":"CPalette::FromHandle"},{"pos":[7083,7172],"content":"Returns a pointer to a <ph id=\"ph1\">`CPalette`</ph> object when given a handle to a Windows palette object.","source":"Returns a pointer to a `CPalette` object when given a handle to a Windows palette object."},{"content":"Parameters","pos":[7252,7262]},{"content":"A handle to a Windows GDI color palette.","pos":[7280,7320]},{"content":"Return Value","pos":[7330,7342]},{"pos":[7346,7413],"content":"A pointer to a <ph id=\"ph1\">`CPalette`</ph> object if successful; otherwise <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"A pointer to a `CPalette` object if successful; otherwise **NULL**."},{"content":"Remarks","pos":[7423,7430]},{"content":"If a <ph id=\"ph1\">`CPalette`</ph> object is not already attached to the Windows palette, a temporary <ph id=\"ph2\">`CPalette`</ph> object is created and attached.","pos":[7434,7559],"source":"If a `CPalette` object is not already attached to the Windows palette, a temporary `CPalette` object is created and attached."},{"content":"This temporary <ph id=\"ph1\">`CPalette`</ph> object is valid only until the next time the application has idle time in its event loop, at which time all temporary graphic objects are deleted.","pos":[7560,7732],"source":" This temporary `CPalette` object is valid only until the next time the application has idle time in its event loop, at which time all temporary graphic objects are deleted."},{"content":"In other words, the temporary object is valid only during the processing of one window message.","pos":[7733,7828]},{"pos":[7878,7901],"content":"CPalette::GetEntryCount"},{"content":"Call this member function to retrieve the number of entries in a given logical palette.","pos":[7905,7992]},{"content":"Return Value","pos":[8038,8050]},{"content":"Number of entries in a logical palette.","pos":[8054,8093]},{"pos":[8152,8184],"content":"CPalette::GetNearestPaletteIndex"},{"content":"Returns the index of the entry in the logical palette that most closely matches the specified color value.","pos":[8188,8294]},{"content":"Parameters","pos":[8375,8385]},{"content":"Specifies the color to be matched.","pos":[8402,8436]},{"content":"Return Value","pos":[8446,8458]},{"content":"The index of an entry in a logical palette.","pos":[8462,8505]},{"content":"The entry contains the color that most nearly matches the specified color.","pos":[8506,8580]},{"pos":[8634,8661],"content":"CPalette::GetPaletteEntries"},{"content":"Retrieves a range of palette entries in a logical palette.","pos":[8665,8723]},{"content":"Parameters","pos":[8866,8876]},{"content":"Specifies the first entry in the logical palette to be retrieved.","pos":[8897,8962]},{"content":"Specifies the number of entries in the logical palette to be retrieved.","pos":[8986,9057]},{"content":"Points to an array of <bpt id=\"p1\">[</bpt>PALETTEENTRY<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd162769)</ept> data structures to receive the palette entries.","pos":[9085,9229],"source":" Points to an array of [PALETTEENTRY](http://msdn.microsoft.com/library/windows/desktop/dd162769) data structures to receive the palette entries."},{"content":"The array must contain at least as many data structures as specified by <ph id=\"ph1\">`nNumEntries`</ph>.","pos":[9230,9316],"source":" The array must contain at least as many data structures as specified by `nNumEntries`."},{"content":"Return Value","pos":[9326,9338]},{"content":"The number of entries retrieved from the logical palette; 0 if the function failed.","pos":[9342,9425]},{"pos":[9479,9506],"content":"CPalette::operator HPALETTE"},{"pos":[9510,9592],"content":"Use this operator to get the attached Windows GDI handle of the <ph id=\"ph1\">`CPalette`</ph> object.","source":"Use this operator to get the attached Windows GDI handle of the `CPalette` object."},{"content":"Return Value","pos":[9647,9659]},{"pos":[9663,9770],"content":"If successful, a handle to the Windows GDI object represented by the <ph id=\"ph1\">`CPalette`</ph> object; otherwise <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"If successful, a handle to the Windows GDI object represented by the `CPalette` object; otherwise **NULL**."},{"content":"Remarks","pos":[9780,9787]},{"pos":[9791,9878],"content":"This operator is a casting operator, which supports direct use of an <ph id=\"ph1\">`HPALETTE`</ph> object.","source":"This operator is a casting operator, which supports direct use of an `HPALETTE` object."},{"pos":[9885,10088],"content":"For more information about using graphic objects, see the article <bpt id=\"p1\">[</bpt>Graphic Objects<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd144962)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information about using graphic objects, see the article [Graphic Objects](http://msdn.microsoft.com/library/windows/desktop/dd144962) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[10138,10161],"content":"CPalette::ResizePalette"},{"pos":[10165,10291],"content":"Changes the size of the logical palette attached to the <ph id=\"ph1\">`CPalette`</ph> object to the number of entries specified by <ph id=\"ph2\">`nNumEntries`</ph>.","source":"Changes the size of the logical palette attached to the `CPalette` object to the number of entries specified by `nNumEntries`."},{"content":"Parameters","pos":[10354,10364]},{"content":"Specifies the number of entries in the palette after it has been resized.","pos":[10385,10458]},{"content":"Return Value","pos":[10468,10480]},{"content":"Nonzero if the palette was successfully resized; otherwise 0.","pos":[10484,10545]},{"content":"Remarks","pos":[10555,10562]},{"content":"If an application calls <ph id=\"ph1\">`ResizePalette`</ph> to reduce the size of the palette, the entries remaining in the resized palette are unchanged.","pos":[10566,10700],"source":"If an application calls `ResizePalette` to reduce the size of the palette, the entries remaining in the resized palette are unchanged."},{"content":"If the application calls <ph id=\"ph1\">`ResizePalette`</ph> to enlarge the palette, the additional palette entries are set to black (the red, green, and blue values are all 0), and the flags for all additional entries are set to 0.","pos":[10701,10913],"source":" If the application calls `ResizePalette` to enlarge the palette, the additional palette entries are set to black (the red, green, and blue values are all 0), and the flags for all additional entries are set to 0."},{"pos":[10920,11116],"content":"For more information on the Windows API <ph id=\"ph1\">`ResizePalette`</ph>, see <bpt id=\"p1\">[</bpt>ResizePalette<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd162928)</ept> in the <ph id=\"ph2\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on the Windows API `ResizePalette`, see [ResizePalette](http://msdn.microsoft.com/library/windows/desktop/dd162928) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[11170,11197],"content":"CPalette::SetPaletteEntries"},{"content":"Sets RGB color values and flags in a range of entries in a logical palette.","pos":[11201,11276]},{"content":"Parameters","pos":[11410,11420]},{"content":"Specifies the first entry in the logical palette to be set.","pos":[11441,11500]},{"content":"Specifies the number of entries in the logical palette to be set.","pos":[11524,11589]},{"content":"Points to an array of <bpt id=\"p1\">[</bpt>PALETTEENTRY<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd162769)</ept> data structures to receive the palette entries.","pos":[11617,11761],"source":" Points to an array of [PALETTEENTRY](http://msdn.microsoft.com/library/windows/desktop/dd162769) data structures to receive the palette entries."},{"content":"The array must contain at least as many data structures as specified by <ph id=\"ph1\">`nNumEntries`</ph>.","pos":[11762,11848],"source":" The array must contain at least as many data structures as specified by `nNumEntries`."},{"content":"Return Value","pos":[11858,11870]},{"content":"The number of entries set in the logical palette; 0 if the function failed.","pos":[11874,11949]},{"content":"Remarks","pos":[11959,11966]},{"pos":[11970,12212],"content":"If the logical palette is selected into a device context when the application calls <ph id=\"ph1\">`SetPaletteEntries`</ph>, the changes will not take effect until the application calls <bpt id=\"p1\">[</bpt>CDC::RealizePalette<ept id=\"p1\">](../../mfc/reference/cdc-class.md#cdc__realizepalette)</ept>.","source":"If the logical palette is selected into a device context when the application calls `SetPaletteEntries`, the changes will not take effect until the application calls [CDC::RealizePalette](../../mfc/reference/cdc-class.md#cdc__realizepalette)."},{"pos":[12219,12421],"content":"For more information on the Windows structure <bpt id=\"p1\">**</bpt>PALETTEENTRY<ept id=\"p1\">**</ept>, see <bpt id=\"p2\">[</bpt>PALETTEENTRY<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/dd162769)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on the Windows structure **PALETTEENTRY**, see [PALETTEENTRY](http://msdn.microsoft.com/library/windows/desktop/dd162769) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"See Also","pos":[12430,12438]},{"content":"MFC Sample DIBLOOK","pos":[12443,12461]},{"content":"CGdiObject Class","pos":[12497,12513]},{"content":"Hierarchy Chart","pos":[12561,12576]},{"content":"CPalette::GetPaletteEntries","pos":[12613,12640]},{"content":"CPalette::SetPaletteEntries","pos":[12677,12704]}],"content":"---\ntitle: \"CPalette Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CPalette\"\n  - \"HPALETTE\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CPalette class\"\n  - \"HPALETTE\"\n  - \"color palettes, MFC\"\nms.assetid: 8cd95498-53ed-4852-85e1-70e522541114\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CPalette Class\nEncapsulates a Windows color palette.  \n  \n## Syntax  \n  \n```  \nclass CPalette : public CGdiObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPalette::CPalette](#cpalette__cpalette)|Constructs a `CPalette` object with no attached Windows palette. You must initialize the `CPalette` object with one of the initialization member functions before it can be used.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPalette::AnimatePalette](#cpalette__animatepalette)|Replaces entries in the logical palette identified by the `CPalette` object. The application does not have to update its client area, because Windows maps the new entries into the system palette immediately.|  \n|[CPalette::CreateHalftonePalette](#cpalette__createhalftonepalette)|Creates a halftone palette for the device context and attaches it to the `CPalette` object.|  \n|[CPalette::CreatePalette](#cpalette__createpalette)|Creates a Windows color palette and attaches it to the `CPalette` object.|  \n|[CPalette::FromHandle](#cpalette__fromhandle)|Returns a pointer to a `CPalette` object when given a handle to a Windows palette object.|  \n|[CPalette::GetEntryCount](#cpalette__getentrycount)|Retrieves the number of palette entries in a logical palette.|  \n|[CPalette::GetNearestPaletteIndex](#cpalette__getnearestpaletteindex)|Returns the index of the entry in the logical palette that most closely matches a color value.|  \n|[CPalette::GetPaletteEntries](#cpalette__getpaletteentries)|Retrieves a range of palette entries in a logical palette.|  \n|[CPalette::ResizePalette](#cpalette__resizepalette)|Changes the size of the logical palette specified by the `CPalette` object to the specified number of entries.|  \n|[CPalette::SetPaletteEntries](#cpalette__setpaletteentries)|Sets RGB color values and flags in a range of entries in a logical palette.|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPalette::operator HPALETTE](#cpalette__operator_hpalette)|Returns the `HPALETTE` attached to the `CPalette`.|  \n  \n## Remarks  \n A palette provides an interface between an application and a color output device (such as a display device). The interface allows the application to take full advantage of the color capabilities of the output device without severely interfering with the colors displayed by other applications. Windows uses the application's logical palette (a list of needed colors) and the system palette (which defines available colors) to determine the colors used.  \n  \n A `CPalette` object provides member functions for manipulating the palette referred to by the object. Construct a `CPalette` object and use its member functions to create the actual palette, a graphics device interface (GDI) object, and to manipulate its entries and other properties.  \n  \n For more information on using `CPalette`, see [Graphic Objects](../../mfc/graphic-objects.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CGdiObject](../../mfc/reference/cgdiobject-class.md)  \n  \n `CPalette`  \n  \n## Requirements  \n **Header:** afxwin.h  \n  \n##  <a name=\"cpalette__animatepalette\"></a>  CPalette::AnimatePalette  \n Replaces entries in the logical palette attached to the `CPalette` object.  \n  \n```  \nvoid AnimatePalette(\n    UINT nStartIndex,  \n    UINT nNumEntries,  \n    LPPALETTEENTRY lpPaletteColors);\n```  \n  \n### Parameters  \n `nStartIndex`  \n Specifies the first entry in the palette to be animated.  \n  \n `nNumEntries`  \n Specifies the number of entries in the palette to be animated.  \n  \n `lpPaletteColors`  \n Points to the first member of an array of [PALETTEENTRY](http://msdn.microsoft.com/library/windows/desktop/dd162769) structures to replace the palette entries identified by `nStartIndex` and `nNumEntries`.  \n  \n### Remarks  \n When an application calls `AnimatePalette`, it does not have to update its client area, because Windows maps the new entries into the system palette immediately.  \n  \n The `AnimatePalette` function will only change entries with the **PC_RESERVED** flag set in the corresponding **palPaletteEntry** member of the [LOGPALETTE](http://msdn.microsoft.com/library/windows/desktop/dd145040) structure that is attached to the `CPalette` object. See **LOGPALETTE** in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about this structure.  \n  \n##  <a name=\"cpalette__cpalette\"></a>  CPalette::CPalette  \n Constructs a `CPalette` object.  \n  \n```  \nCPalette();\n```  \n  \n### Remarks  \n The object has no attached palette until you call `CreatePalette` to attach one.  \n  \n##  <a name=\"cpalette__createhalftonepalette\"></a>  CPalette::CreateHalftonePalette  \n Creates a halftone palette for the device context.  \n  \n```  \nBOOL CreateHalftonePalette(CDC* pDC);\n```  \n  \n### Parameters  \n `pDC`  \n Identifies the device context.  \n  \n### Return Value  \n Nonzero if the function is successful; otherwise 0.  \n  \n### Remarks  \n An application should create a halftone palette when the stretching mode of a device context is set to **HALFTONE**. The logical halftone palette returned by the [CreateHalftonePalette](http://msdn.microsoft.com/library/windows/desktop/dd183503) member function should then be selected and realized into the device context before the [CDC::StretchBlt](../../mfc/reference/cdc-class.md#cdc__stretchblt) or [StretchDIBits](http://msdn.microsoft.com/library/windows/desktop/dd145121) function is called.  \n  \n See the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about `CreateHalftonePalette` and **StretchDIBits**.  \n  \n##  <a name=\"cpalette__createpalette\"></a>  CPalette::CreatePalette  \n Initializes a `CPalette` object by creating a Windows logical color palette and attaching it to the `CPalette` object.  \n  \n```  \nBOOL CreatePalette(LPLOGPALETTE lpLogPalette);\n```  \n  \n### Parameters  \n `lpLogPalette`  \n Points to a [LOGPALETTE](http://msdn.microsoft.com/library/windows/desktop/dd145040) structure that contains information about the colors in the logical palette.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n See the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about the **LOGPALETTE** structure.  \n  \n##  <a name=\"cpalette__fromhandle\"></a>  CPalette::FromHandle  \n Returns a pointer to a `CPalette` object when given a handle to a Windows palette object.  \n  \n```  \nstatic CPalette* PASCAL FromHandle(HPALETTE hPalette);\n```  \n  \n### Parameters  \n `hPalette`  \n A handle to a Windows GDI color palette.  \n  \n### Return Value  \n A pointer to a `CPalette` object if successful; otherwise **NULL**.  \n  \n### Remarks  \n If a `CPalette` object is not already attached to the Windows palette, a temporary `CPalette` object is created and attached. This temporary `CPalette` object is valid only until the next time the application has idle time in its event loop, at which time all temporary graphic objects are deleted. In other words, the temporary object is valid only during the processing of one window message.  \n  \n##  <a name=\"cpalette__getentrycount\"></a>  CPalette::GetEntryCount  \n Call this member function to retrieve the number of entries in a given logical palette.  \n  \n```  \nint GetEntryCount();\n```  \n  \n### Return Value  \n Number of entries in a logical palette.  \n  \n##  <a name=\"cpalette__getnearestpaletteindex\"></a>  CPalette::GetNearestPaletteIndex  \n Returns the index of the entry in the logical palette that most closely matches the specified color value.  \n  \n```  \nUINT GetNearestPaletteIndex(COLORREF crColor) const;\n\n \n```  \n  \n### Parameters  \n `crColor`  \n Specifies the color to be matched.  \n  \n### Return Value  \n The index of an entry in a logical palette. The entry contains the color that most nearly matches the specified color.  \n  \n##  <a name=\"cpalette__getpaletteentries\"></a>  CPalette::GetPaletteEntries  \n Retrieves a range of palette entries in a logical palette.  \n  \n```  \nUINT GetPaletteEntries(\n    UINT nStartIndex,  \n    UINT nNumEntries,  \n    LPPALETTEENTRY lpPaletteColors) const;\n\n \n```  \n  \n### Parameters  \n `nStartIndex`  \n Specifies the first entry in the logical palette to be retrieved.  \n  \n `nNumEntries`  \n Specifies the number of entries in the logical palette to be retrieved.  \n  \n `lpPaletteColors`  \n Points to an array of [PALETTEENTRY](http://msdn.microsoft.com/library/windows/desktop/dd162769) data structures to receive the palette entries. The array must contain at least as many data structures as specified by `nNumEntries`.  \n  \n### Return Value  \n The number of entries retrieved from the logical palette; 0 if the function failed.  \n  \n##  <a name=\"cpalette__operator_hpalette\"></a>  CPalette::operator HPALETTE  \n Use this operator to get the attached Windows GDI handle of the `CPalette` object.  \n  \n```  \noperator HPALETTE() const;\n\n \n```  \n  \n### Return Value  \n If successful, a handle to the Windows GDI object represented by the `CPalette` object; otherwise **NULL**.  \n  \n### Remarks  \n This operator is a casting operator, which supports direct use of an `HPALETTE` object.  \n  \n For more information about using graphic objects, see the article [Graphic Objects](http://msdn.microsoft.com/library/windows/desktop/dd144962) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"cpalette__resizepalette\"></a>  CPalette::ResizePalette  \n Changes the size of the logical palette attached to the `CPalette` object to the number of entries specified by `nNumEntries`.  \n  \n```  \nBOOL ResizePalette(UINT nNumEntries);\n```  \n  \n### Parameters  \n `nNumEntries`  \n Specifies the number of entries in the palette after it has been resized.  \n  \n### Return Value  \n Nonzero if the palette was successfully resized; otherwise 0.  \n  \n### Remarks  \n If an application calls `ResizePalette` to reduce the size of the palette, the entries remaining in the resized palette are unchanged. If the application calls `ResizePalette` to enlarge the palette, the additional palette entries are set to black (the red, green, and blue values are all 0), and the flags for all additional entries are set to 0.  \n  \n For more information on the Windows API `ResizePalette`, see [ResizePalette](http://msdn.microsoft.com/library/windows/desktop/dd162928) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"cpalette__setpaletteentries\"></a>  CPalette::SetPaletteEntries  \n Sets RGB color values and flags in a range of entries in a logical palette.  \n  \n```  \nUINT SetPaletteEntries(\n    UINT nStartIndex,  \n    UINT nNumEntries,  \n    LPPALETTEENTRY lpPaletteColors);\n```  \n  \n### Parameters  \n `nStartIndex`  \n Specifies the first entry in the logical palette to be set.  \n  \n `nNumEntries`  \n Specifies the number of entries in the logical palette to be set.  \n  \n `lpPaletteColors`  \n Points to an array of [PALETTEENTRY](http://msdn.microsoft.com/library/windows/desktop/dd162769) data structures to receive the palette entries. The array must contain at least as many data structures as specified by `nNumEntries`.  \n  \n### Return Value  \n The number of entries set in the logical palette; 0 if the function failed.  \n  \n### Remarks  \n If the logical palette is selected into a device context when the application calls `SetPaletteEntries`, the changes will not take effect until the application calls [CDC::RealizePalette](../../mfc/reference/cdc-class.md#cdc__realizepalette).  \n  \n For more information on the Windows structure **PALETTEENTRY**, see [PALETTEENTRY](http://msdn.microsoft.com/library/windows/desktop/dd162769) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [MFC Sample DIBLOOK](../../visual-cpp-samples.md)   \n [CGdiObject Class](../../mfc/reference/cgdiobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CPalette::GetPaletteEntries](#cpalette__getpaletteentries)   \n [CPalette::SetPaletteEntries](#cpalette__setpaletteentries)\n\n\n\n"}