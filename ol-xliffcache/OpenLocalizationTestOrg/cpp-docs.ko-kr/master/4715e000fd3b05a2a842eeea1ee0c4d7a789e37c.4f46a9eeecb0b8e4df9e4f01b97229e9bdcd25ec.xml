{"nodes":[{"pos":[12,72],"content":"MFC ActiveX Controls: Adding Custom Methods | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Adding Custom Methods | Microsoft Docs","pos":[0,60]}]},{"content":"MFC ActiveX Controls: Adding Custom Methods","pos":[642,685]},{"content":"Custom methods differ from stock methods in that they are not already implemented by <ph id=\"ph1\">`COleControl`</ph>.","pos":[686,785],"source":"Custom methods differ from stock methods in that they are not already implemented by `COleControl`."},{"content":"You must supply the implementation for each custom method you add to your control.","pos":[786,868]},{"content":"An ActiveX control user can call a custom method at any time to perform control-specific actions.","pos":[875,972]},{"content":"The dispatch map entry for custom methods is of the form <ph id=\"ph1\">`DISP_FUNCTION`</ph>.","pos":[973,1046],"source":" The dispatch map entry for custom methods is of the form `DISP_FUNCTION`."},{"pos":[1117,1166],"content":"Adding a Custom Method With the Add Method Wizard"},{"content":"The following procedure demonstrates adding the custom method PtInCircle to an ActiveX control's skeleton code.","pos":[1170,1281]},{"content":"PtInCircle determines whether the coordinates passed to the control are inside or outside the circle.","pos":[1282,1383]},{"content":"This same procedure can also be used to add other custom methods.","pos":[1384,1449]},{"content":"Substitute your custom method name and its parameters for the PtInCircle method name and parameters.","pos":[1450,1550]},{"pos":[1558,1811],"content":"[!NOTE]\n This example uses the `InCircle` function from the article Events. For more information on this function, see the article [MFC ActiveX Controls: Adding Custom Events to an ActiveX Control](../mfc/mfc-activex-controls-adding-custom-events.md).","leadings":["","> "],"nodes":[{"content":" This example uses the `InCircle` function from the article Events. For more information on this function, see the article [MFC ActiveX Controls: Adding Custom Events to an ActiveX Control](../mfc/mfc-activex-controls-adding-custom-events.md).","pos":[8,251],"nodes":[{"content":"This example uses the <ph id=\"ph1\">`InCircle`</ph> function from the article Events.","pos":[1,67],"source":" This example uses the `InCircle` function from the article Events."},{"content":"For more information on this function, see the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Adding Custom Events to an ActiveX Control<ept id=\"p1\">](../mfc/mfc-activex-controls-adding-custom-events.md)</ept>.","pos":[68,243],"source":" For more information on this function, see the article [MFC ActiveX Controls: Adding Custom Events to an ActiveX Control](../mfc/mfc-activex-controls-adding-custom-events.md)."}]}]},{"content":"To add the PtInCircle custom method using the Add Method Wizard","pos":[1822,1885]},{"content":"Load the control's project.","pos":[1895,1922]},{"content":"In Class View, expand the library node of your control.","pos":[1932,1987]},{"content":"Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.","pos":[1997,2109]},{"pos":[2119,2187],"content":"From the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Method<ept id=\"p2\">**</ept>.","source":"From the shortcut menu, click **Add** and then click **Add Method**."},{"content":"This opens the Add Method Wizard.","pos":[2198,2231]},{"pos":[2241,2287],"content":"In the <bpt id=\"p1\">**</bpt>Method Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`PtInCircle`</ph>.","source":"In the **Method Name** box, type `PtInCircle`."},{"pos":[2297,2429],"content":"In the <bpt id=\"p1\">**</bpt>Internal Name<ept id=\"p1\">**</ept> box, type the name of the method's internal function or use the default value (in this case, <ph id=\"ph1\">`PtInCircle`</ph>).","source":"In the **Internal Name** box, type the name of the method's internal function or use the default value (in this case, `PtInCircle`)."},{"pos":[2439,2519],"content":"In the <bpt id=\"p1\">**</bpt>Return Type<ept id=\"p1\">**</ept> box, click <bpt id=\"p2\">**</bpt>VARIANT_BOOL<ept id=\"p2\">**</ept> for the method's return type.","source":"In the **Return Type** box, click **VARIANT_BOOL** for the method's return type."},{"pos":[2529,2650],"content":"Using the <bpt id=\"p1\">**</bpt>Parameter Type<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Parameter Name<ept id=\"p2\">**</ept> controls, add a parameter called <ph id=\"ph1\">`xCoord`</ph> (type <bpt id=\"p3\">**</bpt>OLE_XPOS_PIXELS<ept id=\"p3\">**</ept>).","source":"Using the **Parameter Type** and **Parameter Name** controls, add a parameter called `xCoord` (type **OLE_XPOS_PIXELS**)."},{"pos":[2659,2780],"content":"Using the <bpt id=\"p1\">**</bpt>Parameter Type<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Parameter Name<ept id=\"p2\">**</ept> controls, add a parameter called <ph id=\"ph1\">`yCoord`</ph> (type <bpt id=\"p3\">**</bpt>OLE_YPOS_PIXELS<ept id=\"p3\">**</ept>).","source":"Using the **Parameter Type** and **Parameter Name** controls, add a parameter called `yCoord` (type **OLE_YPOS_PIXELS**)."},{"pos":[2790,2807],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Click **Finish**."},{"pos":[2877,2921],"content":"Add Method Wizard Changes for Custom Methods"},{"content":"When you add a custom method, the Add Method Wizard makes some changes to the control class header (.H) and implementation (.CPP) files.","pos":[2925,3061]},{"content":"The following line is added to the dispatch map declaration in the control class header (.H) file:","pos":[3062,3160]},{"pos":[3178,3193],"content":"NVC_MFC_AxUI#18"},{"content":"This code declares a dispatch method handler called <ph id=\"ph1\">`PtInCircle`</ph>.","pos":[3273,3338],"source":"This code declares a dispatch method handler called `PtInCircle`."},{"content":"This function can be called by the control user using the external name PtInCircle.","pos":[3339,3422]},{"content":"The following line is added to the control's .IDL file:","pos":[3429,3484]},{"pos":[3502,3517],"content":"NVC_MFC_AxUI#19"},{"content":"This line assigns the PtInCircle method a specific ID number, the method's position in the Add Method Wizard methods and properties list.","pos":[3599,3736]},{"content":"Because the Add Method Wizard was used to add the custom method, the entry for it was added automatically to the project's .IDL file.","pos":[3737,3870]},{"content":"In addition, the following line, located in the implementation (.CPP) file of the control class, is added to the control's dispatch map:","pos":[3877,4013]},{"pos":[4031,4046],"content":"NVC_MFC_AxUI#20"},{"pos":[4128,4387],"content":"The <ph id=\"ph1\">`DISP_FUNCTION`</ph> macro maps the method PtInCircle to the control's handler function, <ph id=\"ph2\">`PtInCircle`</ph>, declares the return type to be <bpt id=\"p1\">**</bpt>VARIANT_BOOL<ept id=\"p1\">**</ept>, and declares two parameters of type <bpt id=\"p2\">**</bpt>VTS_XPOS_PIXELS<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>VTS_YPOSPIXELS<ept id=\"p3\">**</ept> to be passed to <ph id=\"ph3\">`PtInCircle`</ph>.","source":"The `DISP_FUNCTION` macro maps the method PtInCircle to the control's handler function, `PtInCircle`, declares the return type to be **VARIANT_BOOL**, and declares two parameters of type **VTS_XPOS_PIXELS** and **VTS_YPOSPIXELS** to be passed to `PtInCircle`."},{"content":"Finally, the Add Method Wizard adds the stub function <ph id=\"ph1\">`CSampleCtrl::PtInCircle`</ph> to the bottom of the control's implementation (.CPP) file.","pos":[4394,4532],"source":"Finally, the Add Method Wizard adds the stub function `CSampleCtrl::PtInCircle` to the bottom of the control's implementation (.CPP) file."},{"content":"For <ph id=\"ph1\">`PtInCircle`</ph> to function as stated previously, it must be modified as follows:","pos":[4533,4615],"source":" For `PtInCircle` to function as stated previously, it must be modified as follows:"},{"pos":[4633,4648],"content":"NVC_MFC_AxUI#21"},{"content":"See Also","pos":[4732,4740]},{"content":"MFC ActiveX Controls","pos":[4745,4765]},{"content":"Class View and Object Browser Icons","pos":[4804,4839]}],"content":"---\ntitle: \"MFC ActiveX Controls: Adding Custom Methods | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, methods\"\n  - \"PtInCircle custom method\"\nms.assetid: 8f8dc344-44a0-4021-8db5-4cdd3d700e18\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Adding Custom Methods\nCustom methods differ from stock methods in that they are not already implemented by `COleControl`. You must supply the implementation for each custom method you add to your control.  \n  \n An ActiveX control user can call a custom method at any time to perform control-specific actions. The dispatch map entry for custom methods is of the form `DISP_FUNCTION`.  \n  \n##  <a name=\"_core_adding_a_custom_method_with_classwizard\"></a> Adding a Custom Method With the Add Method Wizard  \n The following procedure demonstrates adding the custom method PtInCircle to an ActiveX control's skeleton code. PtInCircle determines whether the coordinates passed to the control are inside or outside the circle. This same procedure can also be used to add other custom methods. Substitute your custom method name and its parameters for the PtInCircle method name and parameters.  \n  \n> [!NOTE]\n>  This example uses the `InCircle` function from the article Events. For more information on this function, see the article [MFC ActiveX Controls: Adding Custom Events to an ActiveX Control](../mfc/mfc-activex-controls-adding-custom-events.md).  \n  \n#### To add the PtInCircle custom method using the Add Method Wizard  \n  \n1.  Load the control's project.  \n  \n2.  In Class View, expand the library node of your control.  \n  \n3.  Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.  \n  \n4.  From the shortcut menu, click **Add** and then click **Add Method**.  \n  \n     This opens the Add Method Wizard.  \n  \n5.  In the **Method Name** box, type `PtInCircle`.  \n  \n6.  In the **Internal Name** box, type the name of the method's internal function or use the default value (in this case, `PtInCircle`).  \n  \n7.  In the **Return Type** box, click **VARIANT_BOOL** for the method's return type.  \n  \n8.  Using the **Parameter Type** and **Parameter Name** controls, add a parameter called `xCoord` (type **OLE_XPOS_PIXELS**).  \n  \n9. Using the **Parameter Type** and **Parameter Name** controls, add a parameter called `yCoord` (type **OLE_YPOS_PIXELS**).  \n  \n10. Click **Finish**.  \n  \n##  <a name=\"_core_classwizard_changes_for_custom_methods\"></a> Add Method Wizard Changes for Custom Methods  \n When you add a custom method, the Add Method Wizard makes some changes to the control class header (.H) and implementation (.CPP) files. The following line is added to the dispatch map declaration in the control class header (.H) file:  \n  \n [!code-cpp[NVC_MFC_AxUI#18](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_1.h)]  \n  \n This code declares a dispatch method handler called `PtInCircle`. This function can be called by the control user using the external name PtInCircle.  \n  \n The following line is added to the control's .IDL file:  \n  \n [!code-cpp[NVC_MFC_AxUI#19](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_2.idl)]  \n  \n This line assigns the PtInCircle method a specific ID number, the method's position in the Add Method Wizard methods and properties list. Because the Add Method Wizard was used to add the custom method, the entry for it was added automatically to the project's .IDL file.  \n  \n In addition, the following line, located in the implementation (.CPP) file of the control class, is added to the control's dispatch map:  \n  \n [!code-cpp[NVC_MFC_AxUI#20](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_3.cpp)]  \n  \n The `DISP_FUNCTION` macro maps the method PtInCircle to the control's handler function, `PtInCircle`, declares the return type to be **VARIANT_BOOL**, and declares two parameters of type **VTS_XPOS_PIXELS** and **VTS_YPOSPIXELS** to be passed to `PtInCircle`.  \n  \n Finally, the Add Method Wizard adds the stub function `CSampleCtrl::PtInCircle` to the bottom of the control's implementation (.CPP) file. For `PtInCircle` to function as stated previously, it must be modified as follows:  \n  \n [!code-cpp[NVC_MFC_AxUI#21](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_4.cpp)]  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)   \n [Class View and Object Browser Icons](/visualstudio/ide/class-view-and-object-browser-icons)\n\n"}