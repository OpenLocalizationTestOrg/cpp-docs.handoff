{"nodes":[{"pos":[12,81],"content":"How to: Write Data to the Windows Registry (C++-CLI) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Write Data to the Windows Registry (C++-CLI) | Microsoft Docs","pos":[0,69]}]},{"content":"How to: Write Data to the Windows Registry (C++/CLI)","pos":[656,708]},{"content":"The following code example uses the &lt;xref:Microsoft.Win32.Registry.CurrentUser&gt; key to create a writable instance of the &lt;xref:Microsoft.Win32.RegistryKey&gt; class corresponding to the <bpt id=\"p1\">**</bpt>Software<ept id=\"p1\">**</ept> key.","pos":[709,909],"source":"The following code example uses the <xref:Microsoft.Win32.Registry.CurrentUser> key to create a writable instance of the <xref:Microsoft.Win32.RegistryKey> class corresponding to the **Software** key."},{"content":"The &lt;xref:Microsoft.Win32.RegistryKey.CreateSubKey%2A&gt; method is then used to create a new key and add to key/value pairs.","pos":[910,1032],"source":" The <xref:Microsoft.Win32.RegistryKey.CreateSubKey%2A> method is then used to create a new key and add to key/value pairs."},{"content":"Example","pos":[1041,1048]},{"content":"Code","pos":[1058,1062]},{"content":"Remarks","pos":[2128,2135]},{"content":"You can use the .NET Framework to access the registry with the &lt;xref:Microsoft.Win32.Registry&gt; and <bpt id=\"p1\">[</bpt>RegistryKey<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey.aspx)</ept> classes, which are both defined in the &lt;xref:Microsoft.Win32&gt; namespace.","pos":[2139,2399],"source":"You can use the .NET Framework to access the registry with the <xref:Microsoft.Win32.Registry> and [RegistryKey](https://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey.aspx) classes, which are both defined in the <xref:Microsoft.Win32> namespace."},{"content":"The <bpt id=\"p1\">**</bpt>Registry<ept id=\"p1\">**</ept> class is a container for static instances of the &lt;xref:Microsoft.Win32.RegistryKey&gt; class.","pos":[2400,2507],"source":" The **Registry** class is a container for static instances of the <xref:Microsoft.Win32.RegistryKey> class."},{"content":"Each instance represents a root registry node.","pos":[2508,2554]},{"content":"The instances are &lt;xref:Microsoft.Win32.Registry.ClassesRoot&gt;, &lt;xref:Microsoft.Win32.Registry.CurrentConfig&gt;, &lt;xref:Microsoft.Win32.Registry.CurrentUser&gt;, &lt;xref:Microsoft.Win32.Registry.LocalMachine&gt;, and &lt;xref:Microsoft.Win32.Registry.Users&gt;.","pos":[2555,2798],"source":" The instances are <xref:Microsoft.Win32.Registry.ClassesRoot>, <xref:Microsoft.Win32.Registry.CurrentConfig>, <xref:Microsoft.Win32.Registry.CurrentUser>, <xref:Microsoft.Win32.Registry.LocalMachine>, and <xref:Microsoft.Win32.Registry.Users>."},{"content":"See Also","pos":[2807,2815]},{"content":"How to: Read Data from the Windows Registry (C++/CLI)","pos":[2820,2873]},{"content":".NET Programming with C++/CLI (Visual C++)","pos":[2945,2987]}],"content":"---\ntitle: \"How to: Write Data to the Windows Registry (C++-CLI) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"registry, writing to\"\n  - \"Visual C++, writing to Windows Registry\"\nms.assetid: 3d40b978-4baa-4779-bfe3-47e2917b757f\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Write Data to the Windows Registry (C++/CLI)\nThe following code example uses the <xref:Microsoft.Win32.Registry.CurrentUser> key to create a writable instance of the <xref:Microsoft.Win32.RegistryKey> class corresponding to the **Software** key. The <xref:Microsoft.Win32.RegistryKey.CreateSubKey%2A> method is then used to create a new key and add to key/value pairs.  \n  \n## Example  \n  \n### Code  \n  \n```  \n// registry_write.cpp  \n// compile with: /clr  \nusing namespace System;  \nusing namespace Microsoft::Win32;  \n  \nint main()  \n{  \n   // The second OpenSubKey argument indicates that  \n   // the subkey should be writable.   \n   RegistryKey^ rk;  \n   rk  = Registry::CurrentUser->OpenSubKey(\"Software\", true);  \n   if (!rk)  \n   {  \n      Console::WriteLine(\"Failed to open CurrentUser/Software key\");  \n      return -1;  \n   }  \n  \n   RegistryKey^ nk = rk->CreateSubKey(\"NewRegKey\");  \n   if (!nk)  \n   {  \n      Console::WriteLine(\"Failed to create 'NewRegKey'\");  \n      return -1;  \n   }  \n  \n   String^ newValue = \"NewValue\";  \n   try  \n   {  \n      nk->SetValue(\"NewKey\", newValue);  \n      nk->SetValue(\"NewKey2\", 44);  \n   }  \n   catch (Exception^)  \n   {  \n      Console::WriteLine(\"Failed to set new values in 'NewRegKey'\");  \n      return -1;  \n   }  \n  \n   Console::WriteLine(\"New key created.\");  \n   Console::Write(\"Use REGEDIT.EXE to verify \");  \n   Console::WriteLine(\"'CURRENTUSER/Software/NewRegKey'\\n\");  \n   return 0;  \n}  \n```  \n  \n## Remarks  \n You can use the .NET Framework to access the registry with the <xref:Microsoft.Win32.Registry> and [RegistryKey](https://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey.aspx) classes, which are both defined in the <xref:Microsoft.Win32> namespace. The **Registry** class is a container for static instances of the <xref:Microsoft.Win32.RegistryKey> class. Each instance represents a root registry node. The instances are <xref:Microsoft.Win32.Registry.ClassesRoot>, <xref:Microsoft.Win32.Registry.CurrentConfig>, <xref:Microsoft.Win32.Registry.CurrentUser>, <xref:Microsoft.Win32.Registry.LocalMachine>, and <xref:Microsoft.Win32.Registry.Users>.  \n  \n## See Also  \n [How to: Read Data from the Windows Registry (C++/CLI)](../dotnet/how-to-read-data-from-the-windows-registry-cpp-cli.md)   \n [.NET Programming with C++/CLI (Visual C++)](../dotnet/dotnet-programming-with-cpp-cli-visual-cpp.md)"}