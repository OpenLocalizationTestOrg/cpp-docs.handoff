{"nodes":[{"pos":[12,43],"content":"GetProcAddress | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"GetProcAddress | Microsoft Docs","pos":[0,31]}]},{"content":"GetProcAddress","pos":[669,683]},{"content":"Processes explicitly linking to a DLL call <bpt id=\"p1\">[</bpt>GetProcAddress<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683212)</ept> to obtain the address of an exported function in the DLL.","pos":[684,861],"source":"Processes explicitly linking to a DLL call [GetProcAddress](http://msdn.microsoft.com/library/windows/desktop/ms683212) to obtain the address of an exported function in the DLL."},{"content":"You use the returned function pointer to call the DLL function.","pos":[862,925]},{"content":"<bpt id=\"p1\">**</bpt>GetProcAddress<ept id=\"p1\">**</ept> takes as parameters the DLL module handle (returned by either <bpt id=\"p2\">**</bpt>LoadLibrary<ept id=\"p2\">**</ept>, <ph id=\"ph1\">`AfxLoadLibrary`</ph>, or <bpt id=\"p3\">**</bpt>GetModuleHandle<ept id=\"p3\">**</ept>) and takes either the name of the function you want to call or the function's export ordinal.","pos":[926,1158],"source":"**GetProcAddress** takes as parameters the DLL module handle (returned by either **LoadLibrary**, `AfxLoadLibrary`, or **GetModuleHandle**) and takes either the name of the function you want to call or the function's export ordinal."},{"content":"Because you are calling the DLL function through a pointer and there is no compile-time type checking, make sure that the parameters to the function are correct so that you do not overstep the memory allocated on the stack and cause an access violation.","pos":[1165,1418]},{"content":"One way to help provide type-safety is to look at the function prototypes of the exported functions and create matching typedefs for the function pointers.","pos":[1419,1574]},{"content":"For example:","pos":[1575,1587]},{"pos":[2226,2329],"content":"How you specify the function you want when calling <bpt id=\"p1\">**</bpt>GetProcAddress<ept id=\"p1\">**</ept> depends on how the DLL was built.","source":"How you specify the function you want when calling **GetProcAddress** depends on how the DLL was built."},{"content":"You can only obtain the export ordinal if the DLL you are linking to is built with a module definition (.def) file and if the ordinals are listed with the functions in the <bpt id=\"p1\">**</bpt>EXPORTS<ept id=\"p1\">**</ept> section of the DLL's .def file.","pos":[2336,2551],"source":"You can only obtain the export ordinal if the DLL you are linking to is built with a module definition (.def) file and if the ordinals are listed with the functions in the **EXPORTS** section of the DLL's .def file."},{"content":"Calling <bpt id=\"p1\">**</bpt>GetProcAddress<ept id=\"p1\">**</ept> with an export ordinal, as opposed to the function name, is slightly faster if the DLL has many exported functions because the export ordinals serve as indexes into the DLL's export table.","pos":[2552,2767],"source":" Calling **GetProcAddress** with an export ordinal, as opposed to the function name, is slightly faster if the DLL has many exported functions because the export ordinals serve as indexes into the DLL's export table."},{"content":"With an export ordinal, <bpt id=\"p1\">**</bpt>GetProcAddress<ept id=\"p1\">**</ept> can locate the function directly as opposed to comparing the specified name to the function names in the DLL's export table.","pos":[2768,2935],"source":" With an export ordinal, **GetProcAddress** can locate the function directly as opposed to comparing the specified name to the function names in the DLL's export table."},{"content":"However, you should call <bpt id=\"p1\">**</bpt>GetProcAddress<ept id=\"p1\">**</ept> with an export ordinal only if you have control over assigning the ordinals to the exported functions in the .def file.","pos":[2936,3099],"source":" However, you should call **GetProcAddress** with an export ordinal only if you have control over assigning the ordinals to the exported functions in the .def file."},{"content":"What do you want to do?","pos":[3108,3131]},{"content":"Link implicitly","pos":[3142,3157]},{"content":"Determine which linking method to use","pos":[3201,3238]},{"content":"What do you want to know more about?","pos":[3301,3337]},{"content":"LoadLibrary and AfxLoadLibrary","pos":[3348,3378]},{"content":"FreeLibrary","pos":[3434,3445]},{"content":"Exporting from a DLL Using DEF Files","pos":[3517,3553]},{"content":"See Also","pos":[3613,3621]},{"content":"DLLs in Visual C++","pos":[3626,3644]}],"content":"---\ntitle: \"GetProcAddress | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"GetProcAddress\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DLLs [C++], GetProcAddress\"\n  - \"ordinal exports [C++]\"\n  - \"GetProcAddress method\"\nms.assetid: 48d14ae0-47ea-4c5d-96b1-2c158f1a26af\ncaps.latest.revision: 8\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# GetProcAddress\nProcesses explicitly linking to a DLL call [GetProcAddress](http://msdn.microsoft.com/library/windows/desktop/ms683212) to obtain the address of an exported function in the DLL. You use the returned function pointer to call the DLL function. **GetProcAddress** takes as parameters the DLL module handle (returned by either **LoadLibrary**, `AfxLoadLibrary`, or **GetModuleHandle**) and takes either the name of the function you want to call or the function's export ordinal.  \n  \n Because you are calling the DLL function through a pointer and there is no compile-time type checking, make sure that the parameters to the function are correct so that you do not overstep the memory allocated on the stack and cause an access violation. One way to help provide type-safety is to look at the function prototypes of the exported functions and create matching typedefs for the function pointers. For example:  \n  \n```  \ntypedef UINT (CALLBACK* LPFNDLLFUNC1)(DWORD,UINT);  \n...  \n  \nHINSTANCE hDLL;               // Handle to DLL  \nLPFNDLLFUNC1 lpfnDllFunc1;    // Function pointer  \nDWORD dwParam1;  \nUINT  uParam2, uReturnVal;  \n  \nhDLL = LoadLibrary(\"MyDLL\");  \nif (hDLL != NULL)  \n{  \n   lpfnDllFunc1 = (LPFNDLLFUNC1)GetProcAddress(hDLL,  \n                                           \"DLLFunc1\");  \n   if (!lpfnDllFunc1)  \n   {  \n      // handle the error  \n      FreeLibrary(hDLL);  \n      return SOME_ERROR_CODE;  \n   }  \n   else  \n   {  \n      // call the function  \n      uReturnVal = lpfnDllFunc1(dwParam1, uParam2);  \n   }  \n}  \n```  \n  \n How you specify the function you want when calling **GetProcAddress** depends on how the DLL was built.  \n  \n You can only obtain the export ordinal if the DLL you are linking to is built with a module definition (.def) file and if the ordinals are listed with the functions in the **EXPORTS** section of the DLL's .def file. Calling **GetProcAddress** with an export ordinal, as opposed to the function name, is slightly faster if the DLL has many exported functions because the export ordinals serve as indexes into the DLL's export table. With an export ordinal, **GetProcAddress** can locate the function directly as opposed to comparing the specified name to the function names in the DLL's export table. However, you should call **GetProcAddress** with an export ordinal only if you have control over assigning the ordinals to the exported functions in the .def file.  \n  \n## What do you want to do?  \n  \n-   [Link implicitly](../build/linking-implicitly.md)  \n  \n-   [Determine which linking method to use](../build/determining-which-linking-method-to-use.md)  \n  \n## What do you want to know more about?  \n  \n-   [LoadLibrary and AfxLoadLibrary](../build/loadlibrary-and-afxloadlibrary.md)  \n  \n-   [FreeLibrary](http://msdn.microsoft.com/library/windows/desktop/ms683152)  \n  \n-   [Exporting from a DLL Using DEF Files](../build/exporting-from-a-dll-using-def-files.md)  \n  \n## See Also  \n [DLLs in Visual C++](../build/dlls-in-visual-cpp.md)"}