{"nodes":[{"pos":[12,47],"content":"DLLs in Visual C++ | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"DLLs in Visual C++ | Microsoft Docs","pos":[0,35]}]},{"content":"DLLs in Visual C++","pos":[693,711]},{"content":"A dynamic-link library (DLL) is an executable file that acts as a shared library of functions and resources.","pos":[712,820]},{"content":"Dynamic linking enables an executable to call functions or use resources stored in a separate file.","pos":[821,920]},{"content":"These functions and resources can be compiled and deployed separately from the executables that use them.","pos":[921,1026]},{"content":"The operating system can load the DLL into the executable's memory space when the executable is loaded, or on demand at runtime.","pos":[1027,1155]},{"content":"DLLs also make it easy to share functions and resources across executables.","pos":[1156,1231]},{"content":"Multiple applications can access the contents of a single copy of a DLL in memory at the same time.","pos":[1232,1331]},{"content":"Static linking copies all the object code in a .lib file into an executable.","pos":[1338,1414]},{"content":"Dynamic linking includes only the information needed at run time to locate and load the DLL that contains a data item or function.","pos":[1415,1545]},{"content":"When you create a DLL, you also create a .lib file that contains this information.","pos":[1546,1628]},{"content":"When you build an executable that calls the DLL, the linker uses the exported symbols in the .lib file to store this information for the loader.","pos":[1629,1773]},{"content":"When the loader loads a DLL, the DLL is mapped into the memory space of your executable.","pos":[1774,1862]},{"content":"A special function in the DLL, <ph id=\"ph1\">`DllMain`</ph>, is called to perform any initialization the DLL requires.","pos":[1863,1962],"source":" A special function in the DLL, `DllMain`, is called to perform any initialization the DLL requires."},{"content":"Using dynamic linking instead of static linking offers several advantages.","pos":[1969,2043]},{"content":"When you use DLLs, you can save memory space and reduce swapping.","pos":[2044,2109]},{"content":"When multiple applications can use a single copy of a DLL, you can save disk space and download bandwidth.","pos":[2110,2216]},{"content":"DLLs can be deployed and updated separately, which lets you provide after-market support and software updates without having to rebuild and ship all your code.","pos":[2217,2376]},{"content":"DLLs are a convenient way to supply locale-specific resources, which can support multi-language programs, and ease creating international versions of your applications.","pos":[2377,2545]},{"content":"The following topics provide detailed information about how to program DLLs.","pos":[2552,2628]},{"content":"In This Section","pos":[2637,2652]},{"content":"Walkthrough: Creating and Using a Dynamic Link Library (C++)","pos":[2657,2717]},{"content":"Describes how to create and use a DLL using Visual Studio.","pos":[2793,2851]},{"content":"Differences Between Applications and DLLs","pos":[2859,2900]},{"content":"Describes the fundamental differences between applications and DLLs.","pos":[2960,3028]},{"content":"Advantages of Using DLLs","pos":[3036,3060]},{"content":"Describes the advantages of dynamic linking.","pos":[3103,3147]},{"content":"Kinds of DLLs","pos":[3155,3168]},{"content":"Provides information about the different kinds of DLLs that can be built.","pos":[3200,3273]},{"content":"DLL Frequently Asked Questions","pos":[3281,3311]},{"content":"Provides answers to frequently asked questions about DLLs.","pos":[3360,3418]},{"content":"Linking an Executable to a DLL","pos":[3426,3456]},{"content":"Describes explicit and implicit linking to a DLL.","pos":[3505,3554]},{"content":"Initializing a DLL","pos":[3562,3580]},{"content":"Discusses DLL initialization code (such as allocating memory) that must execute when your DLL loads.","pos":[3617,3717]},{"content":"Run-Time Library Behavior","pos":[3725,3750]},{"content":"Describes how the run-time library performs the DLL startup sequence.","pos":[3794,3863]},{"content":"LoadLibrary and AfxLoadLibrary","pos":[3871,3901]},{"content":"Discusses using <bpt id=\"p1\">**</bpt>LoadLibrary<ept id=\"p1\">**</ept> and <ph id=\"ph1\">`AfxLoadLibrary`</ph> to explicitly link to a DLL at runtime.","pos":[3950,4042],"source":" Discusses using **LoadLibrary** and `AfxLoadLibrary` to explicitly link to a DLL at runtime."},{"content":"GetProcAddress","pos":[4050,4064]},{"content":"Discusses using <bpt id=\"p1\">**</bpt>GetProcAddress<ept id=\"p1\">**</ept> to obtain the address of an exported function in the DLL.","pos":[4097,4189],"source":" Discusses using **GetProcAddress** to obtain the address of an exported function in the DLL."},{"content":"FreeLibrary and AfxFreeLibrary","pos":[4197,4227]},{"content":"Discusses using <bpt id=\"p1\">**</bpt>FreeLibrary<ept id=\"p1\">**</ept> and <ph id=\"ph1\">`AfxFreeLibrary`</ph> when the DLL module is no longer needed.","pos":[4276,4369],"source":" Discusses using **FreeLibrary** and `AfxFreeLibrary` when the DLL module is no longer needed."},{"content":"Search Path Used by Windows to Locate a DLL","pos":[4377,4420]},{"content":"Describes the search path that the Windows operating system uses to locate a DLL on the system.","pos":[4482,4577]},{"content":"Module States of a Regular DLL Dynamically Linked to MFC","pos":[4585,4641]},{"content":"Describes the module states of a regular DLL dynamically linked to MFC.","pos":[4716,4787]},{"content":"Extension DLLs","pos":[4795,4809]},{"content":"Explains DLLs that typically implements reusable classes derived from the existing Microsoft Foundation Class Library classes.","pos":[4851,4977]},{"content":"Creating a Resource-Only DLL","pos":[4985,5013]},{"content":"Discusses a resource-only DLL, which contains nothing but resources, such as icons, bitmaps, strings, and dialog boxes.","pos":[5060,5179]},{"content":"Localized Resources in MFC Applications: Satellite DLLs","pos":[5187,5242]},{"content":"Provides enhanced support for satellite DLLs, a feature that helps in creating applications localized for multiple languages.","pos":[5315,5440]},{"content":"Importing and Exporting","pos":[5448,5471]},{"content":"Describes importing public symbols into an application or exporting functions from a DLL","pos":[5513,5601]},{"content":"Active Technology and DLLs","pos":[5609,5635]},{"content":"Allows object servers to be implemented inside a DLL.","pos":[5680,5733]},{"content":"Automation in a DLL","pos":[5741,5760]},{"content":"Describes what the Automation option in the MFC DLL Wizard supplies.","pos":[5798,5866]},{"content":"Naming Conventions for MFC DLLs","pos":[5874,5905]},{"content":"Discusses how the DLLs and libraries included in MFC follow a structured naming convention.","pos":[5955,6046]},{"content":"Calling DLL functions from Visual Basic Applications","pos":[6054,6106]},{"content":"Describes how to call DLL functions from Visual Basic applications.","pos":[6177,6244]},{"content":"Related Sections","pos":[6253,6269]},{"content":"Using MFC as Part of a DLL","pos":[6274,6300]},{"content":"Describes regular DLLs, which let you use the MFC library as part of a Windows dynamic-link library.","pos":[6349,6449]},{"content":"DLL Version of MFC","pos":[6457,6475]},{"content":"Describes how you can use the MFCxx.dll and MFCxxD.dll (where x is the MFC version number) shared dynamic-link libraries with MFC applications and extension DLLs.","pos":[6516,6678]},{"content":"(NOTINBUILD)Visual C++ Programming Methodologies","pos":[6686,6734]},{"content":"Provides links to topics that describe conceptual information about the Visual C++ libraries and topics that discuss various coding technologies and techniques.","pos":[6809,6969]}],"content":"---\ntitle: \"DLLs in Visual C++ | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"executable files [C++]\"\n  - \"dynamic linking [C++]\"\n  - \"linking [C++], dynamic vs. static\"\n  - \"DLLs [C++]\"\n  - \"DLLs [C++], about DLLs\"\nms.assetid: 5216bca4-51e2-466b-b221-0e3e776056f0\ncaps.latest.revision: 16\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# DLLs in Visual C++\nA dynamic-link library (DLL) is an executable file that acts as a shared library of functions and resources. Dynamic linking enables an executable to call functions or use resources stored in a separate file. These functions and resources can be compiled and deployed separately from the executables that use them. The operating system can load the DLL into the executable's memory space when the executable is loaded, or on demand at runtime. DLLs also make it easy to share functions and resources across executables. Multiple applications can access the contents of a single copy of a DLL in memory at the same time.  \n  \n Static linking copies all the object code in a .lib file into an executable. Dynamic linking includes only the information needed at run time to locate and load the DLL that contains a data item or function. When you create a DLL, you also create a .lib file that contains this information. When you build an executable that calls the DLL, the linker uses the exported symbols in the .lib file to store this information for the loader. When the loader loads a DLL, the DLL is mapped into the memory space of your executable. A special function in the DLL, `DllMain`, is called to perform any initialization the DLL requires.  \n  \n Using dynamic linking instead of static linking offers several advantages. When you use DLLs, you can save memory space and reduce swapping. When multiple applications can use a single copy of a DLL, you can save disk space and download bandwidth. DLLs can be deployed and updated separately, which lets you provide after-market support and software updates without having to rebuild and ship all your code. DLLs are a convenient way to supply locale-specific resources, which can support multi-language programs, and ease creating international versions of your applications.  \n  \n The following topics provide detailed information about how to program DLLs.  \n  \n## In This Section  \n [Walkthrough: Creating and Using a Dynamic Link Library (C++)](../build/walkthrough-creating-and-using-a-dynamic-link-library-cpp.md)  \n Describes how to create and use a DLL using Visual Studio.  \n  \n [Differences Between Applications and DLLs](../build/differences-between-applications-and-dlls.md)  \n Describes the fundamental differences between applications and DLLs.  \n  \n [Advantages of Using DLLs](../build/advantages-of-using-dlls.md)  \n Describes the advantages of dynamic linking.  \n  \n [Kinds of DLLs](../build/kinds-of-dlls.md)  \n Provides information about the different kinds of DLLs that can be built.  \n  \n [DLL Frequently Asked Questions](../build/dll-frequently-asked-questions.md)  \n Provides answers to frequently asked questions about DLLs.  \n  \n [Linking an Executable to a DLL](../build/linking-an-executable-to-a-dll.md)  \n Describes explicit and implicit linking to a DLL.  \n  \n [Initializing a DLL](../build/initializing-a-dll.md)  \n Discusses DLL initialization code (such as allocating memory) that must execute when your DLL loads.  \n  \n [Run-Time Library Behavior](../build/run-time-library-behavior.md)  \n Describes how the run-time library performs the DLL startup sequence.  \n  \n [LoadLibrary and AfxLoadLibrary](../build/loadlibrary-and-afxloadlibrary.md)  \n Discusses using **LoadLibrary** and `AfxLoadLibrary` to explicitly link to a DLL at runtime.  \n  \n [GetProcAddress](../build/getprocaddress.md)  \n Discusses using **GetProcAddress** to obtain the address of an exported function in the DLL.  \n  \n [FreeLibrary and AfxFreeLibrary](../build/freelibrary-and-afxfreelibrary.md)  \n Discusses using **FreeLibrary** and `AfxFreeLibrary` when the DLL module is no longer needed.  \n  \n [Search Path Used by Windows to Locate a DLL](../build/search-path-used-by-windows-to-locate-a-dll.md)  \n Describes the search path that the Windows operating system uses to locate a DLL on the system.  \n  \n [Module States of a Regular DLL Dynamically Linked to MFC](../build/module-states-of-a-regular-dll-dynamically-linked-to-mfc.md)  \n Describes the module states of a regular DLL dynamically linked to MFC.  \n  \n [Extension DLLs](../build/extension-dlls-overview.md)  \n Explains DLLs that typically implements reusable classes derived from the existing Microsoft Foundation Class Library classes.  \n  \n [Creating a Resource-Only DLL](../build/creating-a-resource-only-dll.md)  \n Discusses a resource-only DLL, which contains nothing but resources, such as icons, bitmaps, strings, and dialog boxes.  \n  \n [Localized Resources in MFC Applications: Satellite DLLs](../build/localized-resources-in-mfc-applications-satellite-dlls.md)  \n Provides enhanced support for satellite DLLs, a feature that helps in creating applications localized for multiple languages.  \n  \n [Importing and Exporting](../build/importing-and-exporting.md)  \n Describes importing public symbols into an application or exporting functions from a DLL  \n  \n [Active Technology and DLLs](../build/active-technology-and-dlls.md)  \n Allows object servers to be implemented inside a DLL.  \n  \n [Automation in a DLL](../build/automation-in-a-dll.md)  \n Describes what the Automation option in the MFC DLL Wizard supplies.  \n  \n [Naming Conventions for MFC DLLs](../build/naming-conventions-for-mfc-dlls.md)  \n Discusses how the DLLs and libraries included in MFC follow a structured naming convention.  \n  \n [Calling DLL functions from Visual Basic Applications](../build/calling-dll-functions-from-visual-basic-applications.md)  \n Describes how to call DLL functions from Visual Basic applications.  \n  \n## Related Sections  \n [Using MFC as Part of a DLL](../mfc/tn011-using-mfc-as-part-of-a-dll.md)  \n Describes regular DLLs, which let you use the MFC library as part of a Windows dynamic-link library.  \n  \n [DLL Version of MFC](../mfc/tn033-dll-version-of-mfc.md)  \n Describes how you can use the MFCxx.dll and MFCxxD.dll (where x is the MFC version number) shared dynamic-link libraries with MFC applications and extension DLLs.  \n  \n [(NOTINBUILD)Visual C++ Programming Methodologies](http://msdn.microsoft.com/en-us/0822f806-fa81-4b65-bf0f-1e2921f30c95)  \n Provides links to topics that describe conceptual information about the Visual C++ libraries and topics that discuss various coding technologies and techniques."}