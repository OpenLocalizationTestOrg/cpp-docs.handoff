{"nodes":[{"pos":[12,79],"content":"Recordset: Bookmarks and Absolute Positions (ODBC) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Recordset: Bookmarks and Absolute Positions (ODBC) | Microsoft Docs","pos":[0,67]}]},{"content":"Recordset: Bookmarks and Absolute Positions (ODBC)","pos":[1146,1196]},{"content":"This topic applies to the MFC ODBC classes.","pos":[1197,1240]},{"content":"When navigating through a recordset, you often need a way of returning to a particular record.","pos":[1247,1341]},{"content":"A record's bookmark and absolute position provide two such methods.","pos":[1342,1409]},{"content":"This topic explains:","pos":[1416,1436]},{"pos":[1446,1499],"content":"<bpt id=\"p1\">[</bpt>How to use bookmarks<ept id=\"p1\">](#_core_bookmarks_in_mfc_odbc)</ept>.","source":"[How to use bookmarks](#_core_bookmarks_in_mfc_odbc)."},{"pos":[1509,1605],"content":"<bpt id=\"p1\">[</bpt>How to set the current record using absolute positions<ept id=\"p1\">](#_core_absolute_positions_in_mfc_odbc)</ept>.","source":"[How to set the current record using absolute positions](#_core_absolute_positions_in_mfc_odbc)."},{"pos":[1658,1679],"content":"Bookmarks in MFC ODBC"},{"content":"A bookmark uniquely identifies a record.","pos":[1683,1723]},{"content":"When you navigate through a recordset, you cannot always rely on the absolute position of a record because records can be deleted from the recordset.","pos":[1724,1873]},{"content":"The reliable way to keep track of the position of a record is to use its bookmark.","pos":[1874,1956]},{"content":"Class <ph id=\"ph1\">`CRecordset`</ph> supplies member functions for:","pos":[1957,2006],"source":" Class `CRecordset` supplies member functions for:"},{"pos":[2016,2174],"content":"Getting the bookmark of the current record, so you can save it in a variable (<bpt id=\"p1\">[</bpt>GetBookmark<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__getbookmark)</ept>).","source":"Getting the bookmark of the current record, so you can save it in a variable ([GetBookmark](../../mfc/reference/crecordset-class.md#crecordset__getbookmark))."},{"pos":[2184,2364],"content":"Moving quickly to a given record by specifying its bookmark, which you saved earlier in a variable (<bpt id=\"p1\">[</bpt>SetBookmark<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__setbookmark)</ept>).","source":"Moving quickly to a given record by specifying its bookmark, which you saved earlier in a variable ([SetBookmark](../../mfc/reference/crecordset-class.md#crecordset__setbookmark))."},{"content":"The following example illustrates how to use these member functions to mark the current record and later return to it:","pos":[2371,2489]},{"content":"You do not need to extract the underlying data type from the <bpt id=\"p1\">[</bpt>CDBVariant Class<ept id=\"p1\">](../../mfc/reference/cdbvariant-class.md)</ept> object.","pos":[2749,2877],"source":"You do not need to extract the underlying data type from the [CDBVariant Class](../../mfc/reference/cdbvariant-class.md) object."},{"content":"Assign the value with <ph id=\"ph1\">`GetBookmark`</ph> and return to that bookmark with <ph id=\"ph2\">`SetBookmark`</ph>.","pos":[2878,2961],"source":" Assign the value with `GetBookmark` and return to that bookmark with `SetBookmark`."},{"pos":[2969,3799],"content":"[!NOTE]\n Depending on your ODBC driver and recordset type, bookmarks might not be supported. You can easily determine whether bookmarks are supported by calling [CRecordset::CanBookmark](../../mfc/reference/crecordset-class.md#crecordset__canbookmark). Furthermore, if bookmarks are supported, you must explicitly choose to implement them by specifying the **CRecordset::useBookmarks** option in the [CRecordset::Open](../../mfc/reference/crecordset-class.md#crecordset__open) member function. You should also check the persistence of bookmarks after certain recordset operations. For example, if you **Requery** a recordset, bookmarks might no longer be valid. Call [CDatabase::GetBookmarkPersistence](../../mfc/reference/cdatabase-class.md#cdatabase__getbookmarkpersistence) to check whether you can safely call `SetBookmark`.","leadings":["","> "],"nodes":[{"content":" Depending on your ODBC driver and recordset type, bookmarks might not be supported. You can easily determine whether bookmarks are supported by calling [CRecordset::CanBookmark](../../mfc/reference/crecordset-class.md#crecordset__canbookmark). Furthermore, if bookmarks are supported, you must explicitly choose to implement them by specifying the **CRecordset::useBookmarks** option in the [CRecordset::Open](../../mfc/reference/crecordset-class.md#crecordset__open) member function. You should also check the persistence of bookmarks after certain recordset operations. For example, if you **Requery** a recordset, bookmarks might no longer be valid. Call [CDatabase::GetBookmarkPersistence](../../mfc/reference/cdatabase-class.md#cdatabase__getbookmarkpersistence) to check whether you can safely call `SetBookmark`.","pos":[8,828],"nodes":[{"content":"Depending on your ODBC driver and recordset type, bookmarks might not be supported.","pos":[1,84]},{"content":"You can easily determine whether bookmarks are supported by calling <bpt id=\"p1\">[</bpt>CRecordset::CanBookmark<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__canbookmark)</ept>.","pos":[85,244],"source":" You can easily determine whether bookmarks are supported by calling [CRecordset::CanBookmark](../../mfc/reference/crecordset-class.md#crecordset__canbookmark)."},{"content":"Furthermore, if bookmarks are supported, you must explicitly choose to implement them by specifying the <bpt id=\"p1\">**</bpt>CRecordset::useBookmarks<ept id=\"p1\">**</ept> option in the <bpt id=\"p2\">[</bpt>CRecordset::Open<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__open)</ept> member function.","pos":[245,485],"source":" Furthermore, if bookmarks are supported, you must explicitly choose to implement them by specifying the **CRecordset::useBookmarks** option in the [CRecordset::Open](../../mfc/reference/crecordset-class.md#crecordset__open) member function."},{"content":"You should also check the persistence of bookmarks after certain recordset operations.","pos":[486,572]},{"content":"For example, if you <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> a recordset, bookmarks might no longer be valid.","pos":[573,653],"source":" For example, if you **Requery** a recordset, bookmarks might no longer be valid."},{"content":"Call <bpt id=\"p1\">[</bpt>CDatabase::GetBookmarkPersistence<ept id=\"p1\">](../../mfc/reference/cdatabase-class.md#cdatabase__getbookmarkpersistence)</ept> to check whether you can safely call <ph id=\"ph1\">`SetBookmark`</ph>.","pos":[654,820],"source":" Call [CDatabase::GetBookmarkPersistence](../../mfc/reference/cdatabase-class.md#cdatabase__getbookmarkpersistence) to check whether you can safely call `SetBookmark`."}]}]},{"pos":[3861,3891],"content":"Absolute Positions in MFC ODBC"},{"content":"Besides bookmarks, class <ph id=\"ph1\">`CRecordset`</ph> allows you to set the current record by specifying an ordinal position.","pos":[3895,4004],"source":"Besides bookmarks, class `CRecordset` allows you to set the current record by specifying an ordinal position."},{"content":"This is called absolute positioning.","pos":[4005,4041]},{"pos":[4049,4236],"content":"[!NOTE]\n Absolute positioning is not available on forward-only recordsets. For more information about forward-only recordsets, see [Recordset (ODBC)](../../data/odbc/recordset-odbc.md).","leadings":["","> "],"nodes":[{"content":" Absolute positioning is not available on forward-only recordsets. For more information about forward-only recordsets, see [Recordset (ODBC)](../../data/odbc/recordset-odbc.md).","pos":[8,185],"nodes":[{"content":"Absolute positioning is not available on forward-only recordsets.","pos":[1,66]},{"content":"For more information about forward-only recordsets, see <bpt id=\"p1\">[</bpt>Recordset (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-odbc.md)</ept>.","pos":[67,177],"source":" For more information about forward-only recordsets, see [Recordset (ODBC)](../../data/odbc/recordset-odbc.md)."}]}]},{"content":"To move the current record pointer using absolute position, call <bpt id=\"p1\">[</bpt>CRecordset::SetAbsolutePosition<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__setabsoluteposition)</ept>.","pos":[4243,4415],"source":"To move the current record pointer using absolute position, call [CRecordset::SetAbsolutePosition](../../mfc/reference/crecordset-class.md#crecordset__setabsoluteposition)."},{"content":"When you pass a value to <ph id=\"ph1\">`SetAbsolutePosition`</ph>, the record corresponding to that ordinal position becomes the current record.","pos":[4416,4541],"source":" When you pass a value to `SetAbsolutePosition`, the record corresponding to that ordinal position becomes the current record."},{"pos":[4549,4872],"content":"[!NOTE]\n The absolute position of a record is potentially unreliable. If the user deletes records from the recordset, the ordinal position of any subsequent record changes. Bookmarks are the recommended method for moving the current record. For more information, see [Bookmarks in MFC ODBC](#_core_bookmarks_in_mfc_odbc).","leadings":["","> "],"nodes":[{"content":" The absolute position of a record is potentially unreliable. If the user deletes records from the recordset, the ordinal position of any subsequent record changes. Bookmarks are the recommended method for moving the current record. For more information, see [Bookmarks in MFC ODBC](#_core_bookmarks_in_mfc_odbc).","pos":[8,321],"nodes":[{"content":"The absolute position of a record is potentially unreliable.","pos":[1,61]},{"content":"If the user deletes records from the recordset, the ordinal position of any subsequent record changes.","pos":[62,164]},{"content":"Bookmarks are the recommended method for moving the current record.","pos":[165,232]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Bookmarks in MFC ODBC<ept id=\"p1\">](#_core_bookmarks_in_mfc_odbc)</ept>.","pos":[233,313],"source":" For more information, see [Bookmarks in MFC ODBC](#_core_bookmarks_in_mfc_odbc)."}]}]},{"pos":[4879,5007],"content":"For more information about recordset navigation, see <bpt id=\"p1\">[</bpt>Recordset: Scrolling (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-scrolling-odbc.md)</ept>.","source":"For more information about recordset navigation, see [Recordset: Scrolling (ODBC)](../../data/odbc/recordset-scrolling-odbc.md)."},{"content":"See Also","pos":[5016,5024]},{"content":"Recordset (ODBC)","pos":[5029,5045]}],"content":"---\ntitle: \"Recordset: Bookmarks and Absolute Positions (ODBC) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"SetAbsolutePosition\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CDBVariant class, bookmarks\"\n  - \"absolute positions, ODBC recordsets\"\n  - \"bookmarks, CDBVariant\"\n  - \"bookmarks, ODBC recordsets\"\n  - \"ODBC recordsets, absolute positions\"\n  - \"ODBC recordsets, bookmarks\"\n  - \"cursors [ODBC], absolute position in recordsets\"\n  - \"recordsets, bookmarks\"\n  - \"bookmarks\"\n  - \"SetAbsolutePosition method\"\n  - \"recordsets, absolute positions\"\n  - \"positioning records\"\n  - \"SetBookmark method\"\n  - \"record positioning\"\n  - \"GetBookmark method\"\n  - \"SetAbsolutePosition method, bookmarks\"\nms.assetid: 189788d6-33c1-41c5-9265-97db2a5d43cc\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Recordset: Bookmarks and Absolute Positions (ODBC)\nThis topic applies to the MFC ODBC classes.  \n  \n When navigating through a recordset, you often need a way of returning to a particular record. A record's bookmark and absolute position provide two such methods.  \n  \n This topic explains:  \n  \n-   [How to use bookmarks](#_core_bookmarks_in_mfc_odbc).  \n  \n-   [How to set the current record using absolute positions](#_core_absolute_positions_in_mfc_odbc).  \n  \n##  <a name=\"_core_bookmarks_in_mfc_odbc\"></a> Bookmarks in MFC ODBC  \n A bookmark uniquely identifies a record. When you navigate through a recordset, you cannot always rely on the absolute position of a record because records can be deleted from the recordset. The reliable way to keep track of the position of a record is to use its bookmark. Class `CRecordset` supplies member functions for:  \n  \n-   Getting the bookmark of the current record, so you can save it in a variable ([GetBookmark](../../mfc/reference/crecordset-class.md#crecordset__getbookmark)).  \n  \n-   Moving quickly to a given record by specifying its bookmark, which you saved earlier in a variable ([SetBookmark](../../mfc/reference/crecordset-class.md#crecordset__setbookmark)).  \n  \n The following example illustrates how to use these member functions to mark the current record and later return to it:  \n  \n```  \n// rs is a CRecordset or  \n// CRecordset-derived object  \n  \nCDBVariant varRecordToReturnTo;  \nrs.GetBookmark( varRecordToReturnTo );  \n  \n// More code in which you  \n// move to other records  \n  \nrs.SetBookmark( varRecordToReturnTo );  \n```  \n  \n You do not need to extract the underlying data type from the [CDBVariant Class](../../mfc/reference/cdbvariant-class.md) object. Assign the value with `GetBookmark` and return to that bookmark with `SetBookmark`.  \n  \n> [!NOTE]\n>  Depending on your ODBC driver and recordset type, bookmarks might not be supported. You can easily determine whether bookmarks are supported by calling [CRecordset::CanBookmark](../../mfc/reference/crecordset-class.md#crecordset__canbookmark). Furthermore, if bookmarks are supported, you must explicitly choose to implement them by specifying the **CRecordset::useBookmarks** option in the [CRecordset::Open](../../mfc/reference/crecordset-class.md#crecordset__open) member function. You should also check the persistence of bookmarks after certain recordset operations. For example, if you **Requery** a recordset, bookmarks might no longer be valid. Call [CDatabase::GetBookmarkPersistence](../../mfc/reference/cdatabase-class.md#cdatabase__getbookmarkpersistence) to check whether you can safely call `SetBookmark`.  \n  \n##  <a name=\"_core_absolute_positions_in_mfc_odbc\"></a> Absolute Positions in MFC ODBC  \n Besides bookmarks, class `CRecordset` allows you to set the current record by specifying an ordinal position. This is called absolute positioning.  \n  \n> [!NOTE]\n>  Absolute positioning is not available on forward-only recordsets. For more information about forward-only recordsets, see [Recordset (ODBC)](../../data/odbc/recordset-odbc.md).  \n  \n To move the current record pointer using absolute position, call [CRecordset::SetAbsolutePosition](../../mfc/reference/crecordset-class.md#crecordset__setabsoluteposition). When you pass a value to `SetAbsolutePosition`, the record corresponding to that ordinal position becomes the current record.  \n  \n> [!NOTE]\n>  The absolute position of a record is potentially unreliable. If the user deletes records from the recordset, the ordinal position of any subsequent record changes. Bookmarks are the recommended method for moving the current record. For more information, see [Bookmarks in MFC ODBC](#_core_bookmarks_in_mfc_odbc).  \n  \n For more information about recordset navigation, see [Recordset: Scrolling (ODBC)](../../data/odbc/recordset-scrolling-odbc.md).  \n  \n## See Also  \n [Recordset (ODBC)](../../data/odbc/recordset-odbc.md)"}