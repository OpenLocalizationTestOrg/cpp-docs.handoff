{"nodes":[{"pos":[12,65],"content":"Containers: Implementing a Container | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Containers: Implementing a Container | Microsoft Docs","pos":[0,53]}]},{"content":"Containers: Implementing a Container","pos":[643,679]},{"content":"This article summarizes the procedure for implementing a container and points you to other articles that provide more detailed explanations about implementing containers.","pos":[680,850]},{"content":"It also lists some optional OLE features you may want to implement and the articles describing these features.","pos":[851,961]},{"content":"To prepare your CWinApp-derived class","pos":[972,1009]},{"pos":[1019,1112],"content":"Initialize the OLE libraries by calling <bpt id=\"p1\">**</bpt>AfxOleInit<ept id=\"p1\">**</ept> in the <ph id=\"ph1\">`InitInstance`</ph> member function.","source":"Initialize the OLE libraries by calling **AfxOleInit** in the `InitInstance` member function."},{"content":"Call <ph id=\"ph1\">`CDocTemplate::SetContainerInfo`</ph> in <ph id=\"ph2\">`InitInstance`</ph> to assign the menu and accelerator resources used when an embedded item is activated in-place.","pos":[1122,1272],"source":"Call `CDocTemplate::SetContainerInfo` in `InitInstance` to assign the menu and accelerator resources used when an embedded item is activated in-place."},{"content":"For more information on this topic, see <bpt id=\"p1\">[</bpt>Activation<ept id=\"p1\">](../mfc/activation-cpp.md)</ept>.","pos":[1273,1352],"source":" For more information on this topic, see [Activation](../mfc/activation-cpp.md)."},{"content":"These features are provided for you automatically when you use the MFC Application Wizard to create a container application.","pos":[1359,1483]},{"content":"See <bpt id=\"p1\">[</bpt>Creating an MFC EXE Program<ept id=\"p1\">](../mfc/reference/mfc-application-wizard.md)</ept>.","pos":[1484,1562],"source":" See [Creating an MFC EXE Program](../mfc/reference/mfc-application-wizard.md)."},{"content":"To prepare your view class","pos":[1573,1599]},{"content":"Keep track of selected items by maintaining a pointer, or list of pointers if you support multiple selection, to the selected items.","pos":[1609,1741]},{"content":"Your <ph id=\"ph1\">`OnDraw`</ph> function must draw all OLE items.","pos":[1742,1789],"source":" Your `OnDraw` function must draw all OLE items."},{"pos":[1799,1882],"content":"Override <ph id=\"ph1\">`IsSelected`</ph> to check whether the item passed to it is currently selected.","source":"Override `IsSelected` to check whether the item passed to it is currently selected."},{"pos":[1892,1984],"content":"Implement an <bpt id=\"p1\">**</bpt>OnInsertObject<ept id=\"p1\">**</ept> message handler to display the <bpt id=\"p2\">**</bpt>Insert Object<ept id=\"p2\">**</ept> dialog box.","source":"Implement an **OnInsertObject** message handler to display the **Insert Object** dialog box."},{"pos":[1994,2108],"content":"Implement an <ph id=\"ph1\">`OnSetFocus`</ph> message handler to transfer focus from the view to an in-place active OLE embedded item.","source":"Implement an `OnSetFocus` message handler to transfer focus from the view to an in-place active OLE embedded item."},{"pos":[2118,2278],"content":"Implement an <ph id=\"ph1\">`OnSize`</ph> message handler to inform an OLE embedded item that it needs to change its rectangle to reflect the change in size of its containing view.","source":"Implement an `OnSize` message handler to inform an OLE embedded item that it needs to change its rectangle to reflect the change in size of its containing view."},{"content":"Because the implementation of these features varies dramatically from one application to the next, the application wizard provides only a basic implementation.","pos":[2285,2444]},{"content":"You will likely have to customize these functions to get your application to function properly.","pos":[2445,2540]},{"content":"For an example of this, see the <bpt id=\"p1\">[</bpt>CONTAINER<ept id=\"p1\">](../visual-cpp-samples.md)</ept> sample.","pos":[2541,2618],"source":" For an example of this, see the [CONTAINER](../visual-cpp-samples.md) sample."},{"content":"To handle embedded and linked items","pos":[2629,2664]},{"content":"Derive a class from <bpt id=\"p1\">[</bpt>COleClientItem<ept id=\"p1\">](../mfc/reference/coleclientitem-class.md)</ept>.","pos":[2674,2753],"source":"Derive a class from [COleClientItem](../mfc/reference/coleclientitem-class.md)."},{"content":"Objects of this class represent items that have been embedded in or linked to your OLE document.","pos":[2754,2850]},{"content":"Override <bpt id=\"p1\">**</bpt>OnChange<ept id=\"p1\">**</ept>, <ph id=\"ph1\">`OnChangeItemPosition`</ph>, and <ph id=\"ph2\">`OnGetItemPosition`</ph>.","pos":[2860,2931],"source":"Override **OnChange**, `OnChangeItemPosition`, and `OnGetItemPosition`."},{"content":"These functions handle sizing, positioning, and modifying embedded and linked items.","pos":[2932,3016]},{"content":"The application wizard will derive the class for you, but you will likely need to override <bpt id=\"p1\">**</bpt>OnChange<ept id=\"p1\">**</ept> and the other functions listed with it in step 2 in the preceding procedure.","pos":[3023,3203],"source":"The application wizard will derive the class for you, but you will likely need to override **OnChange** and the other functions listed with it in step 2 in the preceding procedure."},{"content":"The skeleton implementations need to be customized for most applications, because these functions are implemented differently from one application to the next.","pos":[3204,3363]},{"content":"For examples of this, see the MFC samples <bpt id=\"p1\">[</bpt>DRAWCLI<ept id=\"p1\">](../visual-cpp-samples.md)</ept> and <bpt id=\"p2\">[</bpt>CONTAINER<ept id=\"p2\">](../visual-cpp-samples.md)</ept>.","pos":[3364,3484],"source":" For examples of this, see the MFC samples [DRAWCLI](../visual-cpp-samples.md) and [CONTAINER](../visual-cpp-samples.md)."},{"content":"You must add a number of items to the container application's menu structure to support OLE.","pos":[3491,3583]},{"content":"For more information on these, see <bpt id=\"p1\">[</bpt>Menus and Resources: Container Additions<ept id=\"p1\">](../mfc/menus-and-resources-container-additions.md)</ept>.","pos":[3584,3713],"source":" For more information on these, see [Menus and Resources: Container Additions](../mfc/menus-and-resources-container-additions.md)."},{"content":"You may also want to support some of the following features in your container application:","pos":[3720,3810]},{"content":"In-place activation when editing an embedded item.","pos":[3820,3870]},{"pos":[3881,3946],"content":"For more information, see <bpt id=\"p1\">[</bpt>Activation<ept id=\"p1\">](../mfc/activation-cpp.md)</ept>.","source":"For more information, see [Activation](../mfc/activation-cpp.md)."},{"content":"Creation of OLE items by dragging and dropping a selection from a server application.","pos":[3956,4041]},{"pos":[4052,4129],"content":"For more information, see <bpt id=\"p1\">[</bpt>Drag and Drop (OLE)<ept id=\"p1\">](../mfc/drag-and-drop-ole.md)</ept>.","source":"For more information, see [Drag and Drop (OLE)](../mfc/drag-and-drop-ole.md)."},{"content":"Links to embedded objects or combination container/server applications.","pos":[4139,4210]},{"pos":[4221,4319],"content":"For more information, see <bpt id=\"p1\">[</bpt>Containers: Advanced Features<ept id=\"p1\">](../mfc/containers-advanced-features.md)</ept>.","source":"For more information, see [Containers: Advanced Features](../mfc/containers-advanced-features.md)."},{"content":"See Also","pos":[4328,4336]},{"content":"Containers","pos":[4341,4351]},{"content":"Containers: Client Items","pos":[4380,4404]}],"content":"---\ntitle: \"Containers: Implementing a Container | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"applications [OLE], OLE container\"\n  - \"OLE containers, implementing\"\nms.assetid: af1e2079-619a-4eac-9327-985ad875823a\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Containers: Implementing a Container\nThis article summarizes the procedure for implementing a container and points you to other articles that provide more detailed explanations about implementing containers. It also lists some optional OLE features you may want to implement and the articles describing these features.  \n  \n#### To prepare your CWinApp-derived class  \n  \n1.  Initialize the OLE libraries by calling **AfxOleInit** in the `InitInstance` member function.  \n  \n2.  Call `CDocTemplate::SetContainerInfo` in `InitInstance` to assign the menu and accelerator resources used when an embedded item is activated in-place. For more information on this topic, see [Activation](../mfc/activation-cpp.md).  \n  \n These features are provided for you automatically when you use the MFC Application Wizard to create a container application. See [Creating an MFC EXE Program](../mfc/reference/mfc-application-wizard.md).  \n  \n#### To prepare your view class  \n  \n1.  Keep track of selected items by maintaining a pointer, or list of pointers if you support multiple selection, to the selected items. Your `OnDraw` function must draw all OLE items.  \n  \n2.  Override `IsSelected` to check whether the item passed to it is currently selected.  \n  \n3.  Implement an **OnInsertObject** message handler to display the **Insert Object** dialog box.  \n  \n4.  Implement an `OnSetFocus` message handler to transfer focus from the view to an in-place active OLE embedded item.  \n  \n5.  Implement an `OnSize` message handler to inform an OLE embedded item that it needs to change its rectangle to reflect the change in size of its containing view.  \n  \n Because the implementation of these features varies dramatically from one application to the next, the application wizard provides only a basic implementation. You will likely have to customize these functions to get your application to function properly. For an example of this, see the [CONTAINER](../visual-cpp-samples.md) sample.  \n  \n#### To handle embedded and linked items  \n  \n1.  Derive a class from [COleClientItem](../mfc/reference/coleclientitem-class.md). Objects of this class represent items that have been embedded in or linked to your OLE document.  \n  \n2.  Override **OnChange**, `OnChangeItemPosition`, and `OnGetItemPosition`. These functions handle sizing, positioning, and modifying embedded and linked items.  \n  \n The application wizard will derive the class for you, but you will likely need to override **OnChange** and the other functions listed with it in step 2 in the preceding procedure. The skeleton implementations need to be customized for most applications, because these functions are implemented differently from one application to the next. For examples of this, see the MFC samples [DRAWCLI](../visual-cpp-samples.md) and [CONTAINER](../visual-cpp-samples.md).  \n  \n You must add a number of items to the container application's menu structure to support OLE. For more information on these, see [Menus and Resources: Container Additions](../mfc/menus-and-resources-container-additions.md).  \n  \n You may also want to support some of the following features in your container application:  \n  \n-   In-place activation when editing an embedded item.  \n  \n     For more information, see [Activation](../mfc/activation-cpp.md).  \n  \n-   Creation of OLE items by dragging and dropping a selection from a server application.  \n  \n     For more information, see [Drag and Drop (OLE)](../mfc/drag-and-drop-ole.md).  \n  \n-   Links to embedded objects or combination container/server applications.  \n  \n     For more information, see [Containers: Advanced Features](../mfc/containers-advanced-features.md).  \n  \n## See Also  \n [Containers](../mfc/containers.md)   \n [Containers: Client Items](../mfc/containers-client-items.md)\n\n"}