{"nodes":[{"pos":[12,71],"content":"Building an Import Library and Export File | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Building an Import Library and Export File | Microsoft Docs","pos":[0,59]}]},{"content":"Building an Import Library and Export File","pos":[1351,1393]},{"content":"To build an import library and export file, use the following syntax:","pos":[1394,1463]},{"content":"When /DEF is specified, LIB creates the output files from export specifications that are passed in the LIB command.","pos":[1539,1654]},{"content":"There are three methods for specifying exports, listed in recommended order of use:","pos":[1655,1738]},{"pos":[1748,1826],"content":"A <bpt id=\"p1\">**</bpt>__declspec(dllexport)<ept id=\"p1\">**</ept> definition in one of the <bpt id=\"p2\">*</bpt>objfiles<ept id=\"p2\">*</ept> or <bpt id=\"p3\">*</bpt>libraries<ept id=\"p3\">*</ept>","source":"A **__declspec(dllexport)** definition in one of the *objfiles* or *libraries*"},{"pos":[1836,1893],"content":"A specification of /EXPORT:<bpt id=\"p1\">*</bpt>name<ept id=\"p1\">*</ept> on the LIB command line","source":"A specification of /EXPORT:*name* on the LIB command line"},{"pos":[1903,1948],"content":"A definition in an <bpt id=\"p1\">**</bpt>EXPORTS<ept id=\"p1\">**</ept> statement in a","source":"A definition in an **EXPORTS** statement in a "},{"content":"These are the same methods you use to specify exports when linking an exporting program.","pos":[1965,2053]},{"content":"A program can use more than one method.","pos":[2054,2093]},{"content":"You can specify parts of the LIB command (such as multiple <bpt id=\"p1\">*</bpt>objfiles<ept id=\"p1\">*</ept> or /EXPORT specifications) in a command file in the LIB command, just as you can in a LINK command.","pos":[2094,2263],"source":" You can specify parts of the LIB command (such as multiple *objfiles* or /EXPORT specifications) in a command file in the LIB command, just as you can in a LINK command."},{"content":"The following options apply to building an import library and export file:","pos":[2270,2344]},{"pos":[2351,2678],"content":"/OUT: *import*  \nOverrides the default output file name for the *import* library being created. When /OUT is not specified, the default name is the base name of the first object file or library in the LIB command and the extension .lib. The export file is given the same base name as the import library and the extension .exp.","leadings":[""," "],"nodes":[{"content":"/OUT: <bpt id=\"p1\">*</bpt>import<ept id=\"p1\">*</ept>","pos":[0,14],"source":"/OUT: *import*"},{"content":"Overrides the default output file name for the *import* library being created. When /OUT is not specified, the default name is the base name of the first object file or library in the LIB command and the extension .lib. The export file is given the same base name as the import library and the extension .exp.","pos":[17,326],"nodes":[{"content":"Overrides the default output file name for the <bpt id=\"p1\">*</bpt>import<ept id=\"p1\">*</ept> library being created.","pos":[0,78],"source":"Overrides the default output file name for the *import* library being created."},{"content":"When /OUT is not specified, the default name is the base name of the first object file or library in the LIB command and the extension .lib.","pos":[79,219]},{"content":"The export file is given the same base name as the import library and the extension .exp.","pos":[220,309]}]}]},{"pos":[2685,2942],"content":"/EXPORT: *entryname*[= *internalname*][,@ `ordinal`[, **NONAME**]][, **DATA**]  \nExports a function from your program to allow other programs to call the function. You can also export data (using the **DATA** keyword). Exports are usually defined in a DLL.","leadings":[""," "],"nodes":[{"content":"/EXPORT: <bpt id=\"p1\">*</bpt>entryname<ept id=\"p1\">*</ept>[= <bpt id=\"p2\">*</bpt>internalname<ept id=\"p2\">*</ept>][,@ <ph id=\"ph1\">`ordinal`</ph>[, <bpt id=\"p3\">**</bpt>NONAME<ept id=\"p3\">**</ept>]][, <bpt id=\"p4\">**</bpt>DATA<ept id=\"p4\">**</ept>]","pos":[0,78],"source":"/EXPORT: *entryname*[= *internalname*][,@ `ordinal`[, **NONAME**]][, **DATA**]"},{"content":"Exports a function from your program to allow other programs to call the function. You can also export data (using the **DATA** keyword). Exports are usually defined in a DLL.","pos":[81,256],"nodes":[{"content":"Exports a function from your program to allow other programs to call the function.","pos":[0,82]},{"content":"You can also export data (using the <bpt id=\"p1\">**</bpt>DATA<ept id=\"p1\">**</ept> keyword).","pos":[83,137],"source":" You can also export data (using the **DATA** keyword)."},{"content":"Exports are usually defined in a DLL.","pos":[138,175]}]}]},{"content":"The <bpt id=\"p1\">*</bpt>entryname<ept id=\"p1\">*</ept> is the name of the function or data item as it is to be used by the calling program.","pos":[2949,3049],"source":"The *entryname* is the name of the function or data item as it is to be used by the calling program."},{"content":"Optionally, you can specify the <bpt id=\"p1\">*</bpt>internalname<ept id=\"p1\">*</ept> as the function known in the defining program; by default, <bpt id=\"p2\">*</bpt>internalname<ept id=\"p2\">*</ept> is the same as <bpt id=\"p3\">*</bpt>entryname<ept id=\"p3\">*</ept>.","pos":[3050,3198],"source":" Optionally, you can specify the *internalname* as the function known in the defining program; by default, *internalname* is the same as *entryname*."},{"content":"The <ph id=\"ph1\">`ordinal`</ph> specifies an index into the export table in the range 1 through 65,535; if you do not specify <ph id=\"ph2\">`ordinal`</ph>, LIB assigns one.","pos":[3199,3334],"source":" The `ordinal` specifies an index into the export table in the range 1 through 65,535; if you do not specify `ordinal`, LIB assigns one."},{"content":"The <bpt id=\"p1\">**</bpt>NONAME<ept id=\"p1\">**</ept> keyword exports the function only as an ordinal, without an <bpt id=\"p2\">*</bpt>entryname<ept id=\"p2\">*</ept>.","pos":[3335,3422],"source":" The **NONAME** keyword exports the function only as an ordinal, without an *entryname*."},{"content":"The <bpt id=\"p1\">**</bpt>DATA<ept id=\"p1\">**</ept> keyword is used to export data-only objects.","pos":[3423,3480],"source":" The **DATA** keyword is used to export data-only objects."},{"pos":[3487,3655],"content":"/INCLUDE: `symbol`  \nAdds the specified symbol to the symbol table. This option is useful for forcing the use of a library object that otherwise would not be included.","leadings":[""," "],"nodes":[{"content":"/INCLUDE:","pos":[0,9]},{"content":"Adds the specified symbol to the symbol table. This option is useful for forcing the use of a library object that otherwise would not be included.","pos":[21,167],"nodes":[{"content":"Adds the specified symbol to the symbol table.","pos":[0,46]},{"content":"This option is useful for forcing the use of a library object that otherwise would not be included.","pos":[47,146]}]}]},{"content":"Note that if you create your import library in a preliminary step, before creating your .dll, you must pass the same set of object files when building the .dll, as you passed when building the import library.","pos":[3662,3870]},{"content":"See Also","pos":[3879,3887]},{"content":"Working with Import Libraries and Export Files","pos":[3892,3938]}],"content":"---\ntitle: \"Building an Import Library and Export File | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"VC.Project.VCLibrarianTool.ModuleDefinitionFile\"\n  - \"VC.Project.VCLibrarianTool.ExportNamedFunctions\"\n  - \"VC.Project.VCLibrarianTool.GenerateDebug\"\n  - \"VC.Project.VCLibrarianTool.ForceSymbolReferences\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OUT library manager option\"\n  - \"INCLUDE library manager option\"\n  - \"/DEF library manager option\"\n  - \"exporting data\"\n  - \"import libraries, building\"\n  - \"-INCLUDE library manager option\"\n  - \"/OUT library manager option\"\n  - \"DEF library manager option\"\n  - \"-DEF library manager option\"\n  - \"-OUT library manager option\"\n  - \"/INCLUDE library manager option\"\n  - \"-EXPORT library manager option\"\n  - \"exporting data, export (.exp) files\"\n  - \"/EXPORT library manager option\"\n  - \"EXPORT library manager option\"\n  - \".lib files\"\n  - \"EXP files\"\nms.assetid: 2fe4f30a-1dd6-4b05-84b5-0752e1dee354\ncaps.latest.revision: 8\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Building an Import Library and Export File\nTo build an import library and export file, use the following syntax:  \n  \n```  \nLIB /DEF[:deffile] [options] [objfiles] [libraries]  \n```  \n  \n When /DEF is specified, LIB creates the output files from export specifications that are passed in the LIB command. There are three methods for specifying exports, listed in recommended order of use:  \n  \n1.  A **__declspec(dllexport)** definition in one of the *objfiles* or *libraries*  \n  \n2.  A specification of /EXPORT:*name* on the LIB command line  \n  \n3.  A definition in an **EXPORTS** statement in a `deffile`  \n  \n These are the same methods you use to specify exports when linking an exporting program. A program can use more than one method. You can specify parts of the LIB command (such as multiple *objfiles* or /EXPORT specifications) in a command file in the LIB command, just as you can in a LINK command.  \n  \n The following options apply to building an import library and export file:  \n  \n /OUT: *import*  \n Overrides the default output file name for the *import* library being created. When /OUT is not specified, the default name is the base name of the first object file or library in the LIB command and the extension .lib. The export file is given the same base name as the import library and the extension .exp.  \n  \n /EXPORT: *entryname*[= *internalname*][,@ `ordinal`[, **NONAME**]][, **DATA**]  \n Exports a function from your program to allow other programs to call the function. You can also export data (using the **DATA** keyword). Exports are usually defined in a DLL.  \n  \n The *entryname* is the name of the function or data item as it is to be used by the calling program. Optionally, you can specify the *internalname* as the function known in the defining program; by default, *internalname* is the same as *entryname*. The `ordinal` specifies an index into the export table in the range 1 through 65,535; if you do not specify `ordinal`, LIB assigns one. The **NONAME** keyword exports the function only as an ordinal, without an *entryname*. The **DATA** keyword is used to export data-only objects.  \n  \n /INCLUDE: `symbol`  \n Adds the specified symbol to the symbol table. This option is useful for forcing the use of a library object that otherwise would not be included.  \n  \n Note that if you create your import library in a preliminary step, before creating your .dll, you must pass the same set of object files when building the .dll, as you passed when building the import library.  \n  \n## See Also  \n [Working with Import Libraries and Export Files](../../build/reference/working-with-import-libraries-and-export-files.md)"}