{"nodes":[{"pos":[12,58],"content":"Containers: Advanced Features | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Containers: Advanced Features | Microsoft Docs","pos":[0,46]}]},{"content":"Containers: Advanced Features","pos":[925,954]},{"content":"This article describes the steps necessary to incorporate optional advanced features into existing container applications.","pos":[955,1077]},{"content":"These features are:","pos":[1078,1097]},{"content":"An application that is both a container and a server","pos":[1108,1160]},{"content":"An OLE link to an embedded object","pos":[1220,1253]},{"pos":[1359,1398],"content":"Creating a Container/Server Application"},{"content":"A container/server application is an application that acts as both a container and a server.","pos":[1402,1494]},{"content":"Microsoft Word for Windows is an example of this.","pos":[1495,1544]},{"content":"You can embed Word for Windows documents in other applications, and you can also embed items in Word for Windows documents.","pos":[1545,1668]},{"content":"The process for modifying your container application to be both a container and a full server (you cannot create a combination container/miniserver application) is similar to the process for creating a full server.","pos":[1669,1883]},{"content":"The article <bpt id=\"p1\">[</bpt>Servers: Implementing a Server<ept id=\"p1\">](../mfc/servers-implementing-a-server.md)</ept> lists a number of tasks required to implement a server application.","pos":[1890,2043],"source":"The article [Servers: Implementing a Server](../mfc/servers-implementing-a-server.md) lists a number of tasks required to implement a server application."},{"content":"If you convert a container application to a container/server application, then you need to perform some of those same tasks, adding code to the container.","pos":[2044,2198]},{"content":"The following lists the important things to consider:","pos":[2199,2252]},{"content":"The container code created by the application wizard already initializes the OLE subsystem.","pos":[2262,2353]},{"content":"You will not need to change or add anything for that support.","pos":[2354,2415]},{"pos":[2425,2529],"content":"Wherever the base class of a document class is <ph id=\"ph1\">`COleDocument`</ph>, change the base class to <ph id=\"ph2\">`COleServerDoc`</ph>.","source":"Wherever the base class of a document class is `COleDocument`, change the base class to `COleServerDoc`."},{"pos":[2539,2665],"content":"Override <ph id=\"ph1\">`COleClientItem::CanActivate`</ph> to avoid editing items in place while the server itself is being used to edit in place.","source":"Override `COleClientItem::CanActivate` to avoid editing items in place while the server itself is being used to edit in place."},{"content":"For example, the MFC OLE sample <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../visual-cpp-samples.md)</ept> has embedded an item created by your container/server application.","pos":[2676,2810],"source":"For example, the MFC OLE sample [OCLIENT](../visual-cpp-samples.md) has embedded an item created by your container/server application."},{"content":"You open the OCLIENT application and in-place edit the item created by your container/server application.","pos":[2811,2916]},{"content":"While editing your application's item, you decide you want to embed an item created by the MFC OLE sample <bpt id=\"p1\">[</bpt>HIERSVR<ept id=\"p1\">](../visual-cpp-samples.md)</ept>.","pos":[2917,3059],"source":" While editing your application's item, you decide you want to embed an item created by the MFC OLE sample [HIERSVR](../visual-cpp-samples.md)."},{"content":"To do this, you cannot use in-place activation.","pos":[3060,3107]},{"content":"You must fully open HIERSVR to activate this item.","pos":[3108,3158]},{"content":"Because the Microsoft Foundation Class Library does not support this OLE feature, overriding <ph id=\"ph1\">`COleClientItem::CanActivate`</ph> allows you to check for this situation and prevent a possible run-time error in your application.","pos":[3159,3379],"source":" Because the Microsoft Foundation Class Library does not support this OLE feature, overriding `COleClientItem::CanActivate` allows you to check for this situation and prevent a possible run-time error in your application."},{"content":"If you are creating a new application and want it to function as a container/server application, choose that option in the OLE Options dialog box in the application wizard and this support will be created automatically.","pos":[3386,3605]},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Overview: Creating an ActiveX Control Container<ept id=\"p1\">](../mfc/reference/creating-an-mfc-activex-control-container.md)</ept>.","pos":[3606,3757],"source":" For more information, see the article [Overview: Creating an ActiveX Control Container](../mfc/reference/creating-an-mfc-activex-control-container.md)."},{"content":"For information about MFC samples, see MFC Samples.","pos":[3758,3809]},{"content":"Note that you cannot insert an MDI application into itself.","pos":[3816,3875]},{"content":"An application that is a container/server cannot be inserted into itself unless it is an SDI application.","pos":[3876,3981]},{"pos":[4038,4063],"content":"Links to Embedded Objects"},{"content":"The Links to Embedded Objects feature enables a user to create a document with an OLE link to an embedded object inside your container application.","pos":[4067,4214]},{"content":"For example, create a document in a word processor containing an embedded spreadsheet.","pos":[4215,4301]},{"content":"If your application supports links to embedded objects, it could paste a link to the spreadsheet contained in the word processor's document.","pos":[4302,4442]},{"content":"This feature allows your application to use the information contained in the spreadsheet without knowing where the word processor originally got it.","pos":[4443,4591]},{"content":"To link to embedded objects in your application","pos":[4602,4649]},{"pos":[4659,4734],"content":"Derive your document class from <ph id=\"ph1\">`COleLinkingDoc`</ph> instead of <ph id=\"ph2\">`COleDocument`</ph>.","source":"Derive your document class from `COleLinkingDoc` instead of `COleDocument`."},{"pos":[4744,4872],"content":"Create an OLE class ID (<bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept>) for your application by using the Class ID Generator included with the OLE Development Tools.","source":"Create an OLE class ID (**CLSID**) for your application by using the Class ID Generator included with the OLE Development Tools."},{"content":"Register the application with OLE.","pos":[4882,4916]},{"pos":[4926,5001],"content":"Create a <ph id=\"ph1\">`COleTemplateServer`</ph> object as a member of your application class.","source":"Create a `COleTemplateServer` object as a member of your application class."},{"pos":[5011,5088],"content":"In your application class's <ph id=\"ph1\">`InitInstance`</ph> member function, do the following:","source":"In your application class's `InitInstance` member function, do the following:"},{"pos":[5102,5228],"content":"Connect your <ph id=\"ph1\">`COleTemplateServer`</ph> object to your document templates by calling the object's <ph id=\"ph2\">`ConnectTemplate`</ph> member function.","source":"Connect your `COleTemplateServer` object to your document templates by calling the object's `ConnectTemplate` member function."},{"pos":[5242,5353],"content":"Call the <bpt id=\"p1\">**</bpt>COleTemplateServer::RegisterAll<ept id=\"p1\">**</ept> member function to register all class objects with the OLE system.","source":"Call the **COleTemplateServer::RegisterAll** member function to register all class objects with the OLE system."},{"content":"Call <ph id=\"ph1\">`COleTemplateServer::UpdateRegistry`</ph>.","pos":[5367,5409],"source":"Call `COleTemplateServer::UpdateRegistry`."},{"content":"The only parameter to <ph id=\"ph1\">`UpdateRegistry`</ph> should be <ph id=\"ph2\">`OAT_CONTAINER`</ph> if the application is not launched with the \"/Embedded\" switch.","pos":[5410,5538],"source":" The only parameter to `UpdateRegistry` should be `OAT_CONTAINER` if the application is not launched with the \"/Embedded\" switch."},{"content":"This registers the application as a container that can support links to embedded objects.","pos":[5539,5628]},{"content":"If the application is launched with the \"/Embedded\" switch, it should not show its main window, similar to a server application.","pos":[5643,5771]},{"content":"The MFC OLE sample <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../visual-cpp-samples.md)</ept> implements this feature.","pos":[5778,5857],"source":"The MFC OLE sample [OCLIENT](../visual-cpp-samples.md) implements this feature."},{"content":"For an example of how this is done, see the <ph id=\"ph1\">`InitInstance`</ph> function in the OCLIENT.CPP file of this sample application.","pos":[5858,5977],"source":" For an example of how this is done, see the `InitInstance` function in the OCLIENT.CPP file of this sample application."},{"content":"See Also","pos":[5986,5994]},{"content":"Containers","pos":[5999,6009]},{"content":"Servers","pos":[6038,6045]}],"content":"---\ntitle: \"Containers: Advanced Features | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"links [C++], to embedded OLE objects\"\n  - \"containers [C++], links to embedded OLE objects\"\n  - \"containers [C++], advanced features\"\n  - \"container/server applications [C++]\"\n  - \"embedded objects [C++]\"\n  - \"OLE controls, containers\"\n  - \"OLE containers, advanced features\"\n  - \"server/container applications\"\n  - \"containers [C++], container applications\"\nms.assetid: 221fd99c-b138-40fa-ad6a-974e3b3ad1f8\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Containers: Advanced Features\nThis article describes the steps necessary to incorporate optional advanced features into existing container applications. These features are:  \n  \n-   [An application that is both a container and a server](#_core_creating_a_container_server_application)  \n  \n-   [An OLE link to an embedded object](#_core_links_to_embedded_objects)  \n  \n##  <a name=\"_core_creating_a_container_server_application\"></a> Creating a Container/Server Application  \n A container/server application is an application that acts as both a container and a server. Microsoft Word for Windows is an example of this. You can embed Word for Windows documents in other applications, and you can also embed items in Word for Windows documents. The process for modifying your container application to be both a container and a full server (you cannot create a combination container/miniserver application) is similar to the process for creating a full server.  \n  \n The article [Servers: Implementing a Server](../mfc/servers-implementing-a-server.md) lists a number of tasks required to implement a server application. If you convert a container application to a container/server application, then you need to perform some of those same tasks, adding code to the container. The following lists the important things to consider:  \n  \n-   The container code created by the application wizard already initializes the OLE subsystem. You will not need to change or add anything for that support.  \n  \n-   Wherever the base class of a document class is `COleDocument`, change the base class to `COleServerDoc`.  \n  \n-   Override `COleClientItem::CanActivate` to avoid editing items in place while the server itself is being used to edit in place.  \n  \n     For example, the MFC OLE sample [OCLIENT](../visual-cpp-samples.md) has embedded an item created by your container/server application. You open the OCLIENT application and in-place edit the item created by your container/server application. While editing your application's item, you decide you want to embed an item created by the MFC OLE sample [HIERSVR](../visual-cpp-samples.md). To do this, you cannot use in-place activation. You must fully open HIERSVR to activate this item. Because the Microsoft Foundation Class Library does not support this OLE feature, overriding `COleClientItem::CanActivate` allows you to check for this situation and prevent a possible run-time error in your application.  \n  \n If you are creating a new application and want it to function as a container/server application, choose that option in the OLE Options dialog box in the application wizard and this support will be created automatically. For more information, see the article [Overview: Creating an ActiveX Control Container](../mfc/reference/creating-an-mfc-activex-control-container.md). For information about MFC samples, see MFC Samples.  \n  \n Note that you cannot insert an MDI application into itself. An application that is a container/server cannot be inserted into itself unless it is an SDI application.  \n  \n##  <a name=\"_core_links_to_embedded_objects\"></a> Links to Embedded Objects  \n The Links to Embedded Objects feature enables a user to create a document with an OLE link to an embedded object inside your container application. For example, create a document in a word processor containing an embedded spreadsheet. If your application supports links to embedded objects, it could paste a link to the spreadsheet contained in the word processor's document. This feature allows your application to use the information contained in the spreadsheet without knowing where the word processor originally got it.  \n  \n#### To link to embedded objects in your application  \n  \n1.  Derive your document class from `COleLinkingDoc` instead of `COleDocument`.  \n  \n2.  Create an OLE class ID (**CLSID**) for your application by using the Class ID Generator included with the OLE Development Tools.  \n  \n3.  Register the application with OLE.  \n  \n4.  Create a `COleTemplateServer` object as a member of your application class.  \n  \n5.  In your application class's `InitInstance` member function, do the following:  \n  \n    -   Connect your `COleTemplateServer` object to your document templates by calling the object's `ConnectTemplate` member function.  \n  \n    -   Call the **COleTemplateServer::RegisterAll** member function to register all class objects with the OLE system.  \n  \n    -   Call `COleTemplateServer::UpdateRegistry`. The only parameter to `UpdateRegistry` should be `OAT_CONTAINER` if the application is not launched with the \"/Embedded\" switch. This registers the application as a container that can support links to embedded objects.  \n  \n         If the application is launched with the \"/Embedded\" switch, it should not show its main window, similar to a server application.  \n  \n The MFC OLE sample [OCLIENT](../visual-cpp-samples.md) implements this feature. For an example of how this is done, see the `InitInstance` function in the OCLIENT.CPP file of this sample application.  \n  \n## See Also  \n [Containers](../mfc/containers.md)   \n [Servers](../mfc/servers.md)\n\n"}