{"nodes":[{"pos":[12,48],"content":"CDaoWorkspace Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDaoWorkspace Class | Microsoft Docs","pos":[0,36]}]},{"pos":[1309,1328],"content":"CDaoWorkspace Class","linkify":"CDaoWorkspace Class","nodes":[{"content":"CDaoWorkspace Class","pos":[0,19]}]},{"content":"Manages a named, password-protected database session from login to logoff, by a single user.","pos":[1329,1421]},{"pos":[1430,1436],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1499,1506],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1516,1535],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1542,1546]},{"content":"Description","pos":[1547,1558]},{"pos":[1596,1657],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::CDaoWorkspace<ept id=\"p1\">](#cdaoworkspace__cdaoworkspace)</ept>","source":"[CDaoWorkspace::CDaoWorkspace](#cdaoworkspace__cdaoworkspace)"},{"content":"Constructs a workspace object.","pos":[1658,1688]},{"content":"Afterwards, call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","pos":[1689,1729],"source":" Afterwards, call **Create** or **Open**."},{"pos":[1740,1754],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1761,1765]},{"content":"Description","pos":[1766,1777]},{"pos":[1815,1862],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::Append<ept id=\"p1\">](#cdaoworkspace__append)</ept>","source":"[CDaoWorkspace::Append](#cdaoworkspace__append)"},{"content":"Appends a newly created workspace to the database engine's Workspaces collection.","pos":[1863,1944]},{"pos":[1949,2004],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::BeginTrans<ept id=\"p1\">](#cdaoworkspace__begintrans)</ept>","source":"[CDaoWorkspace::BeginTrans](#cdaoworkspace__begintrans)"},{"content":"Begins a new transaction, which applies to all databases open in the workspace.","pos":[2005,2084]},{"pos":[2089,2134],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::Close<ept id=\"p1\">](#cdaoworkspace__close)</ept>","source":"[CDaoWorkspace::Close](#cdaoworkspace__close)"},{"content":"Closes the workspace and all of the objects it contains.","pos":[2135,2191]},{"content":"Pending transactions are rolled back.","pos":[2192,2229]},{"pos":[2234,2291],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::CommitTrans<ept id=\"p1\">](#cdaoworkspace__committrans)</ept>","source":"[CDaoWorkspace::CommitTrans](#cdaoworkspace__committrans)"},{"content":"Completes the current transaction and saves the changes.","pos":[2292,2348]},{"pos":[2353,2418],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::CompactDatabase<ept id=\"p1\">](#cdaoworkspace__compactdatabase)</ept>","source":"[CDaoWorkspace::CompactDatabase](#cdaoworkspace__compactdatabase)"},{"content":"Compacts (or duplicates) a database.","pos":[2419,2455]},{"pos":[2460,2507],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::Create<ept id=\"p1\">](#cdaoworkspace__create)</ept>","source":"[CDaoWorkspace::Create](#cdaoworkspace__create)"},{"content":"Creates a new DAO workspace object.","pos":[2508,2543]},{"pos":[2548,2615],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetDatabaseCount<ept id=\"p1\">](#cdaoworkspace__getdatabasecount)</ept>","source":"[CDaoWorkspace::GetDatabaseCount](#cdaoworkspace__getdatabasecount)"},{"content":"Returns the number of DAO database objects in the workspace's Databases collection.","pos":[2616,2699]},{"pos":[2704,2769],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetDatabaseInfo<ept id=\"p1\">](#cdaoworkspace__getdatabaseinfo)</ept>","source":"[CDaoWorkspace::GetDatabaseInfo](#cdaoworkspace__getdatabaseinfo)"},{"content":"Returns information about a specified DAO database defined in the workspace's Databases collection.","pos":[2770,2869]},{"pos":[2874,2929],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetIniPath<ept id=\"p1\">](#cdaoworkspace__getinipath)</ept>","source":"[CDaoWorkspace::GetIniPath](#cdaoworkspace__getinipath)"},{"content":"Returns the location of the Microsoft Jet database engine's initialization settings in the Windows registry.","pos":[2930,3038]},{"pos":[3043,3116],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetIsolateODBCTrans<ept id=\"p1\">](#cdaoworkspace__getisolateodbctrans)</ept>","source":"[CDaoWorkspace::GetIsolateODBCTrans](#cdaoworkspace__getisolateodbctrans)"},{"content":"Returns a value that indicates whether multiple transactions that involve the same ODBC data source are isolated via forced multiple connections to the data source.","pos":[3117,3281]},{"pos":[3286,3351],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetLoginTimeout<ept id=\"p1\">](#cdaoworkspace__getlogintimeout)</ept>","source":"[CDaoWorkspace::GetLoginTimeout](#cdaoworkspace__getlogintimeout)"},{"content":"Returns the number of seconds before an error occurs when the user attempts to log in to an ODBC database.","pos":[3352,3458]},{"pos":[3463,3512],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetName<ept id=\"p1\">](#cdaoworkspace__getname)</ept>","source":"[CDaoWorkspace::GetName](#cdaoworkspace__getname)"},{"content":"Returns the user-defined name for the workspace object.","pos":[3513,3568]},{"pos":[3573,3630],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetUserName<ept id=\"p1\">](#cdaoworkspace__getusername)</ept>","source":"[CDaoWorkspace::GetUserName](#cdaoworkspace__getusername)"},{"content":"Returns the user name specified when the workspace was created.","pos":[3631,3694]},{"content":"This is the name of the workspace owner.","pos":[3695,3735]},{"pos":[3740,3795],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetVersion<ept id=\"p1\">](#cdaoworkspace__getversion)</ept>","source":"[CDaoWorkspace::GetVersion](#cdaoworkspace__getversion)"},{"content":"Returns a string that contains the version of the database engine associated with the workspace.","pos":[3796,3892]},{"pos":[3897,3966],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetWorkspaceCount<ept id=\"p1\">](#cdaoworkspace__getworkspacecount)</ept>","source":"[CDaoWorkspace::GetWorkspaceCount](#cdaoworkspace__getworkspacecount)"},{"content":"Returns the number of DAO workspace objects in the database engine's Workspaces collection.","pos":[3967,4058]},{"pos":[4063,4130],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::GetWorkspaceInfo<ept id=\"p1\">](#cdaoworkspace__getworkspaceinfo)</ept>","source":"[CDaoWorkspace::GetWorkspaceInfo](#cdaoworkspace__getworkspaceinfo)"},{"content":"Returns information about a specified DAO workspace defined in the database engine's Workspaces collection.","pos":[4131,4238]},{"pos":[4243,4286],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::Idle<ept id=\"p1\">](#cdaoworkspace__idle)</ept>","source":"[CDaoWorkspace::Idle](#cdaoworkspace__idle)"},{"content":"Allows the database engine to perform background tasks.","pos":[4287,4342]},{"pos":[4347,4394],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::IsOpen<ept id=\"p1\">](#cdaoworkspace__isopen)</ept>","source":"[CDaoWorkspace::IsOpen](#cdaoworkspace__isopen)"},{"content":"Returns nonzero if the workspace is open.","pos":[4395,4436]},{"pos":[4441,4484],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::Open<ept id=\"p1\">](#cdaoworkspace__open)</ept>","source":"[CDaoWorkspace::Open](#cdaoworkspace__open)"},{"content":"Explicitly opens a workspace object associated with DAO's default workspace.","pos":[4485,4561]},{"pos":[4566,4629],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::RepairDatabase<ept id=\"p1\">](#cdaoworkspace__repairdatabase)</ept>","source":"[CDaoWorkspace::RepairDatabase](#cdaoworkspace__repairdatabase)"},{"content":"Attempts to repair a damaged database.","pos":[4630,4668]},{"pos":[4673,4724],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::Rollback<ept id=\"p1\">](#cdaoworkspace__rollback)</ept>","source":"[CDaoWorkspace::Rollback](#cdaoworkspace__rollback)"},{"content":"Ends the current transaction and does not save the changes.","pos":[4725,4784]},{"pos":[4789,4860],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::SetDefaultPassword<ept id=\"p1\">](#cdaoworkspace__setdefaultpassword)</ept>","source":"[CDaoWorkspace::SetDefaultPassword](#cdaoworkspace__setdefaultpassword)"},{"content":"Sets the password that the database engine uses when a workspace object is created without a specific password.","pos":[4861,4972]},{"pos":[4977,5040],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::SetDefaultUser<ept id=\"p1\">](#cdaoworkspace__setdefaultuser)</ept>","source":"[CDaoWorkspace::SetDefaultUser](#cdaoworkspace__setdefaultuser)"},{"content":"Sets the user name that the database engine uses when a workspace object is created without a specific user name.","pos":[5041,5154]},{"pos":[5159,5214],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::SetIniPath<ept id=\"p1\">](#cdaoworkspace__setinipath)</ept>","source":"[CDaoWorkspace::SetIniPath](#cdaoworkspace__setinipath)"},{"content":"Sets the location of the Microsoft Jet database engine's initialization settings in the Windows registry.","pos":[5215,5320]},{"pos":[5325,5398],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::SetIsolateODBCTrans<ept id=\"p1\">](#cdaoworkspace__setisolateodbctrans)</ept>","source":"[CDaoWorkspace::SetIsolateODBCTrans](#cdaoworkspace__setisolateodbctrans)"},{"content":"Specifies whether multiple transactions that involve the same ODBC data source are isolated by forcing multiple connections to the data source.","pos":[5399,5542]},{"pos":[5547,5612],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::SetLoginTimeout<ept id=\"p1\">](#cdaoworkspace__setlogintimeout)</ept>","source":"[CDaoWorkspace::SetLoginTimeout](#cdaoworkspace__setlogintimeout)"},{"content":"Sets the number of seconds before an error occurs when the user attempts to log in to an ODBC data source.","pos":[5613,5719]},{"pos":[5730,5749],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[5756,5760]},{"content":"Description","pos":[5761,5772]},{"pos":[5810,5875],"content":"<bpt id=\"p1\">[</bpt>CDaoWorkspace::m_pDAOWorkspace<ept id=\"p1\">](#cdaoworkspace__m_pdaoworkspace)</ept>","source":"[CDaoWorkspace::m_pDAOWorkspace](#cdaoworkspace__m_pdaoworkspace)"},{"content":"Points to the underlying DAO workspace object.","pos":[5876,5922]},{"pos":[5932,5939],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In most cases, you will not need multiple workspaces, and you will not need to create explicit workspace objects; when you open database and recordset objects, they use DAO's default workspace.","pos":[5943,6136]},{"content":"However, if needed, you can run multiple sessions at a time by creating additional workspace objects.","pos":[6137,6238]},{"content":"Each workspace object can contain multiple open database objects in its own Databases collection.","pos":[6239,6336]},{"content":"In MFC, a workspace is primarily a transaction manager, specifying a set of open databases all in the same \"transaction space.\"","pos":[6337,6464]},{"pos":[6472,7011],"content":"[!NOTE]\n The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have a \"CDao\" prefix. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC. The DAO-based classes access data through the Microsoft Jet database engine, including ODBC drivers. They also support Data Definition Language (DDL) operations, such as creating databases and adding tables and fields via the classes, without having to call DAO directly.","leadings":["","> "],"nodes":[{"content":" The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have a \"CDao\" prefix. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC. The DAO-based classes access data through the Microsoft Jet database engine, including ODBC drivers. They also support Data Definition Language (DDL) operations, such as creating databases and adding tables and fields via the classes, without having to call DAO directly.","pos":[8,537],"nodes":[{"content":"The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC).","pos":[1,112]},{"content":"All DAO database class names have a \"CDao\" prefix.","pos":[113,163]},{"content":"In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC.","pos":[164,257]},{"content":"The DAO-based classes access data through the Microsoft Jet database engine, including ODBC drivers.","pos":[258,358]},{"content":"They also support Data Definition Language (DDL) operations, such as creating databases and adding tables and fields via the classes, without having to call DAO directly.","pos":[359,529]}]}]},{"pos":[7020,7032],"content":"Capabilities","linkify":"Capabilities","nodes":[{"content":"Capabilities","pos":[0,12]}]},{"pos":[7036,7081],"content":"Class <ph id=\"ph1\">`CDaoWorkspace`</ph> provides the following:","source":"Class `CDaoWorkspace` provides the following:"},{"content":"Explicit access, if needed, to a default workspace, created by initializing the database engine.","pos":[7091,7187]},{"content":"Usually you use DAO's default workspace implicitly by creating database and recordset objects.","pos":[7188,7282]},{"content":"A transaction space in which transactions apply to all databases open in the workspace.","pos":[7292,7379]},{"content":"You can create additional workspaces to manage separate transaction spaces.","pos":[7380,7455]},{"content":"An interface to many properties of the underlying Microsoft Jet database engine (see the static member functions).","pos":[7465,7579]},{"content":"Opening or creating a workspace, or calling a static member function before open or create, initializes the database engine.","pos":[7580,7704]},{"content":"Access to the database engine's Workspaces collection, which stores all active workspaces that have been appended to it.","pos":[7714,7834]},{"content":"You can also create and work with workspaces without appending them to the collection.","pos":[7835,7921]},{"pos":[7930,7938],"content":"Security","linkify":"Security","nodes":[{"content":"Security","pos":[0,8]}]},{"content":"MFC does not implement the Users and Groups collections in DAO, which are used for security control.","pos":[7942,8042]},{"content":"If you need those aspects of DAO, you must program them yourself via direct calls to DAO interfaces.","pos":[8043,8143]},{"content":"For information, see <bpt id=\"p1\">[</bpt>Technical Note 54<ept id=\"p1\">](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)</ept>.","pos":[8144,8254],"source":" For information, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)."},{"pos":[8263,8268],"content":"Usage","linkify":"Usage","nodes":[{"content":"Usage","pos":[0,5]}]},{"pos":[8272,8309],"content":"You can use class <ph id=\"ph1\">`CDaoWorkspace`</ph> to:","source":"You can use class `CDaoWorkspace` to:"},{"content":"Explicitly open the default workspace.","pos":[8319,8357]},{"content":"Usually your use of the default workspace is implicit — when you open new <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> or <bpt id=\"p2\">[</bpt>CDaoRecordset<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md)</ept> objects.","pos":[8368,8571],"source":"Usually your use of the default workspace is implicit — when you open new [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) or [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) objects."},{"content":"But you might need to access it explicitly — for example, to access database engine properties or the Workspaces collection.","pos":[8572,8696]},{"content":"See \"Implicit Use of the Default Workspace\" below.","pos":[8697,8747]},{"content":"Create new workspaces.","pos":[8757,8779]},{"content":"Call <bpt id=\"p1\">[</bpt>Append<ept id=\"p1\">](#cdaoworkspace__append)</ept> if you want to add them to the Workspaces collection.","pos":[8780,8871],"source":" Call [Append](#cdaoworkspace__append) if you want to add them to the Workspaces collection."},{"content":"Open an existing workspace in the Workspaces collection.","pos":[8881,8937]},{"content":"Creating a new workspace that does not already exist in the Workspaces collection is described under the <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoworkspace__create)</ept> member function.","pos":[8944,9098],"source":"Creating a new workspace that does not already exist in the Workspaces collection is described under the [Create](#cdaoworkspace__create) member function."},{"content":"Workspace objects do not persist in any way between datababase engine sessions.","pos":[9099,9178]},{"content":"If your application links MFC statically, ending the application uninitializes the database engine.","pos":[9179,9278]},{"content":"If your application links with MFC dynamically, the database engine is uninitialized when the MFC DLL is unloaded.","pos":[9279,9393]},{"pos":[9400,9573],"content":"Explicitly opening the default workspace, or opening an existing workspace in the Workspaces collection, is described under the <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaoworkspace__open)</ept> member function.","source":"Explicitly opening the default workspace, or opening an existing workspace in the Workspaces collection, is described under the [Open](#cdaoworkspace__open) member function."},{"content":"End a workspace session by closing the workspace with the <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](#cdaoworkspace__close)</ept> member function.","pos":[9580,9685],"source":"End a workspace session by closing the workspace with the [Close](#cdaoworkspace__close) member function."},{"content":"<bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> closes any databases you have not closed previously, rolling back any uncommitted transactions.","pos":[9686,9791],"source":"**Close** closes any databases you have not closed previously, rolling back any uncommitted transactions."},{"pos":[9800,9812],"content":"Transactions","linkify":"Transactions","nodes":[{"content":"Transactions","pos":[0,12]}]},{"content":"DAO manages transactions at the workspace level; hence, transactions on a workspace with multiple open databases apply to all of the databases.","pos":[9816,9959]},{"content":"For example, if two databases have uncommitted updates and you call <bpt id=\"p1\">[</bpt>CommitTrans<ept id=\"p1\">](#cdaoworkspace__committrans)</ept>, all of the updates are committed.","pos":[9960,10105],"source":" For example, if two databases have uncommitted updates and you call [CommitTrans](#cdaoworkspace__committrans), all of the updates are committed."},{"content":"If you want to limit transactions to a single database, you need a separate workspace object for it.","pos":[10106,10206]},{"pos":[10215,10252],"content":"Implicit Use of the Default Workspace","linkify":"Implicit Use of the Default Workspace","nodes":[{"content":"Implicit Use of the Default Workspace","pos":[0,37]}]},{"content":"MFC uses DAO's default workspace implicitly under the following circumstances:","pos":[10256,10334]},{"content":"If you create a new <ph id=\"ph1\">`CDaoDatabase`</ph> object but do not do so through an existing <ph id=\"ph2\">`CDaoWorkspace`</ph> object, MFC creates a temporary workspace object for you, which corresponds to DAO's default workspace.","pos":[10344,10542],"source":"If you create a new `CDaoDatabase` object but do not do so through an existing `CDaoWorkspace` object, MFC creates a temporary workspace object for you, which corresponds to DAO's default workspace."},{"content":"If you do so for multiple databases, all of the database objects are associated with the default workspace.","pos":[10543,10650]},{"content":"You can access a database's workspace through a <ph id=\"ph1\">`CDaoDatabase`</ph> data member.","pos":[10651,10726],"source":" You can access a database's workspace through a `CDaoDatabase` data member."},{"content":"Similarly, if you create a <ph id=\"ph1\">`CDaoRecordset`</ph> object without supplying a pointer to a <ph id=\"ph2\">`CDaoDatabase`</ph> object, MFC creates a temporary database object and, by extension, a temporary workspace object.","pos":[10736,10930],"source":"Similarly, if you create a `CDaoRecordset` object without supplying a pointer to a `CDaoDatabase` object, MFC creates a temporary database object and, by extension, a temporary workspace object."},{"content":"You can access a recordset's database, and indirectly its workspace, through a <ph id=\"ph1\">`CDaoRecordset`</ph> data member.","pos":[10931,11038],"source":" You can access a recordset's database, and indirectly its workspace, through a `CDaoRecordset` data member."},{"pos":[11047,11063],"content":"Other Operations","linkify":"Other Operations","nodes":[{"content":"Other Operations","pos":[0,16]}]},{"content":"Other database operations are also provided, such as repairing a corrupted database or compacting a database.","pos":[11067,11176]},{"pos":[11183,11343],"content":"For information about calling DAO directly and about DAO security, see <bpt id=\"p1\">[</bpt>Technical Note 54<ept id=\"p1\">](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)</ept>.","source":"For information about calling DAO directly and about DAO security, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)."},{"pos":[11352,11373],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[11377,11424],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[11455,11467],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[11471,11491],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdao.h","source":"**Header:** afxdao.h"},{"pos":[11501,11560],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__append\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::Append","linkify":"<a name=\"cdaoworkspace__append\"></a>  CDaoWorkspace::Append","source":"<a name=\"cdaoworkspace__append\"></a>  CDaoWorkspace::Append"},{"pos":[11564,11638],"content":"Call this member function after you call <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoworkspace__create)</ept>.","source":"Call this member function after you call [Create](#cdaoworkspace__create)."},{"pos":[11686,11693],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<bpt id=\"p1\">**</bpt>Append<ept id=\"p1\">**</ept> appends a newly created workspace object to the database engine's Workspaces collection.","pos":[11697,11796],"source":"**Append** appends a newly created workspace object to the database engine's Workspaces collection."},{"content":"Workspaces do not persist between database engine sessions; they are stored only in memory, not on disk.","pos":[11797,11901]},{"content":"You do not have to append a workspace; if you do not, you can still use it.","pos":[11902,11977]},{"pos":[11984,12136],"content":"An appended workspace remains in the Workspaces collection, in an active, open state, until you call its <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](#cdaoworkspace__close)</ept> member function.","source":"An appended workspace remains in the Workspaces collection, in an active, open state, until you call its [Close](#cdaoworkspace__close) member function."},{"content":"For related information, see the topic \"Append Method\" in DAO Help.","pos":[12143,12210]},{"pos":[12220,12287],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__begintrans\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::BeginTrans","linkify":"<a name=\"cdaoworkspace__begintrans\"></a>  CDaoWorkspace::BeginTrans","source":"<a name=\"cdaoworkspace__begintrans\"></a>  CDaoWorkspace::BeginTrans"},{"content":"Call this member function to initiate a transaction.","pos":[12291,12343]},{"pos":[12387,12394],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"After you call <bpt id=\"p1\">**</bpt>BeginTrans<ept id=\"p1\">**</ept>, updates you make to your data or database structure take effect when you commit the transaction.","pos":[12398,12525],"source":"After you call **BeginTrans**, updates you make to your data or database structure take effect when you commit the transaction."},{"content":"Because the workspace defines a single transaction space, the transaction applies to all open databases in the workspace.","pos":[12526,12647]},{"content":"There are two ways to complete the transaction:","pos":[12648,12695]},{"pos":[12705,12835],"content":"Call the <bpt id=\"p1\">[</bpt>CommitTrans<ept id=\"p1\">](#cdaoworkspace__committrans)</ept> member function to commit the transaction and save changes to the data source.","source":"Call the [CommitTrans](#cdaoworkspace__committrans) member function to commit the transaction and save changes to the data source."},{"pos":[12845,12936],"content":"Or call the <bpt id=\"p1\">[</bpt>Rollback<ept id=\"p1\">](#cdaoworkspace__rollback)</ept> member function to cancel the transaction.","source":"Or call the [Rollback](#cdaoworkspace__rollback) member function to cancel the transaction."},{"content":"Closing the workspace object or a database object while a transaction is pending rolls back all pending transactions.","pos":[12943,13060]},{"pos":[13067,13250],"content":"If you need to isolate transactions on one ODBC data source from those on another ODBC data source, see the <bpt id=\"p1\">[</bpt>SetIsolateODBCTrans<ept id=\"p1\">](#cdaoworkspace__setisolateodbctrans)</ept> member function.","source":"If you need to isolate transactions on one ODBC data source from those on another ODBC data source, see the [SetIsolateODBCTrans](#cdaoworkspace__setisolateodbctrans) member function."},{"pos":[13260,13333],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__cdaoworkspace\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::CDaoWorkspace","linkify":"<a name=\"cdaoworkspace__cdaoworkspace\"></a>  CDaoWorkspace::CDaoWorkspace","source":"<a name=\"cdaoworkspace__cdaoworkspace\"></a>  CDaoWorkspace::CDaoWorkspace"},{"pos":[13337,13373],"content":"Constructs a <ph id=\"ph1\">`CDaoWorkspace`</ph> object.","source":"Constructs a `CDaoWorkspace` object."},{"pos":[13415,13422],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"After constructing the C++ object, you have two options:","pos":[13426,13482]},{"pos":[13492,13644],"content":"Call the object's <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaoworkspace__open)</ept> member function to open the default workspace or to open an existing object in the Workspaces collection.","source":"Call the object's [Open](#cdaoworkspace__open) member function to open the default workspace or to open an existing object in the Workspaces collection."},{"content":"Or call the object's <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoworkspace__create)</ept> member function to create a new DAO workspace object.","pos":[13654,13761],"source":"Or call the object's [Create](#cdaoworkspace__create) member function to create a new DAO workspace object."},{"content":"This explicitly starts a new workspace session, which you can refer to via the <ph id=\"ph1\">`CDaoWorkspace`</ph> object.","pos":[13762,13864],"source":" This explicitly starts a new workspace session, which you can refer to via the `CDaoWorkspace` object."},{"content":"After calling <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>, you can call <bpt id=\"p2\">[</bpt>Append<ept id=\"p2\">](#cdaoworkspace__append)</ept> if you want to add the workspace to the database engine's Workspaces collection.","pos":[13865,14017],"source":" After calling **Create**, you can call [Append](#cdaoworkspace__append) if you want to add the workspace to the database engine's Workspaces collection."},{"content":"See the class overview for <bpt id=\"p1\">[</bpt>CDaoWorkspace<ept id=\"p1\">](../../mfc/reference/cdaoworkspace-class.md)</ept> for information about when you need to explicitly create a <ph id=\"ph1\">`CDaoWorkspace`</ph> object.","pos":[14024,14193],"source":"See the class overview for [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) for information about when you need to explicitly create a `CDaoWorkspace` object."},{"content":"Usually, you use workspaces created implicitly when you open a <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object without specifying a workspace or when you open a <bpt id=\"p2\">[</bpt>CDaoRecordset<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md)</ept> object without specifying a database object.","pos":[14194,14476],"source":" Usually, you use workspaces created implicitly when you open a [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object without specifying a workspace or when you open a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object without specifying a database object."},{"content":"MFC DAO objects created in this way use DAO's default workspace, which is created once and reused.","pos":[14477,14575]},{"pos":[14582,14707],"content":"To release a workspace and its contained objects, call the workspace object's <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](#cdaoworkspace__close)</ept> member function.","source":"To release a workspace and its contained objects, call the workspace object's [Close](#cdaoworkspace__close) member function."},{"pos":[14717,14774],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__close\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::Close","linkify":"<a name=\"cdaoworkspace__close\"></a>  CDaoWorkspace::Close","source":"<a name=\"cdaoworkspace__close\"></a>  CDaoWorkspace::Close"},{"content":"Call this member function to close the workspace object.","pos":[14778,14834]},{"pos":[14881,14888],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Closing an open workspace object releases the underlying DAO object and, if the workspace is a member of the Workspaces collection, removes it from the collection.","pos":[14892,15055]},{"content":"Calling <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> is good programming practice.","pos":[15056,15103],"source":" Calling **Close** is good programming practice."},{"pos":[15111,15721],"content":"[!CAUTION]\n Closing a workspace object closes any open databases in the workspace. This results in any recordsets open in the databases being closed as well, and any pending edits or updates are rolled back. For related information, see the [CDaoDatabase::Close](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__close), [CDaoRecordset::Close](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__close), [CDaoTableDef::Close](../../mfc/reference/cdaotabledef-class.md#cdaotabledef__close), and [CDaoQueryDef::Close](../../mfc/reference/cdaoquerydef-class.md#cdaoquerydef__close) member functions.","leadings":["","> "],"nodes":[{"content":" Closing a workspace object closes any open databases in the workspace. This results in any recordsets open in the databases being closed as well, and any pending edits or updates are rolled back. For related information, see the [CDaoDatabase::Close](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__close), [CDaoRecordset::Close](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__close), [CDaoTableDef::Close](../../mfc/reference/cdaotabledef-class.md#cdaotabledef__close), and [CDaoQueryDef::Close](../../mfc/reference/cdaoquerydef-class.md#cdaoquerydef__close) member functions.","pos":[11,608],"nodes":[{"content":"Closing a workspace object closes any open databases in the workspace.","pos":[1,71]},{"content":"This results in any recordsets open in the databases being closed as well, and any pending edits or updates are rolled back.","pos":[72,196]},{"content":"For related information, see the <bpt id=\"p1\">[</bpt>CDaoDatabase::Close<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__close)</ept>, <bpt id=\"p2\">[</bpt>CDaoRecordset::Close<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__close)</ept>, <bpt id=\"p3\">[</bpt>CDaoTableDef::Close<ept id=\"p3\">](../../mfc/reference/cdaotabledef-class.md#cdaotabledef__close)</ept>, and <bpt id=\"p4\">[</bpt>CDaoQueryDef::Close<ept id=\"p4\">](../../mfc/reference/cdaoquerydef-class.md#cdaoquerydef__close)</ept> member functions.","pos":[197,597],"source":" For related information, see the [CDaoDatabase::Close](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__close), [CDaoRecordset::Close](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__close), [CDaoTableDef::Close](../../mfc/reference/cdaotabledef-class.md#cdaotabledef__close), and [CDaoQueryDef::Close](../../mfc/reference/cdaoquerydef-class.md#cdaoquerydef__close) member functions."}]}]},{"content":"Workspace objects are not permanent; they only exist while references to them exist.","pos":[15728,15812]},{"content":"This means that when the database engine session ends, the workspace and its Databases collection do not persist.","pos":[15813,15926]},{"content":"You must re-create them for the next session by opening your workspace and database(s) again.","pos":[15927,16020]},{"content":"For related information, see the topic \"Close Method\" in DAO Help.","pos":[16027,16093]},{"pos":[16103,16172],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__committrans\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::CommitTrans","linkify":"<a name=\"cdaoworkspace__committrans\"></a>  CDaoWorkspace::CommitTrans","source":"<a name=\"cdaoworkspace__committrans\"></a>  CDaoWorkspace::CommitTrans"},{"content":"Call this member function to commit a transaction — save a group of edits and updates to one or more databases in the workspace.","pos":[16176,16304]},{"pos":[16349,16356],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"A transaction consists of a series of changes to the database's data or its structure, beginning with a call to <bpt id=\"p1\">[</bpt>BeginTrans<ept id=\"p1\">](#cdaoworkspace__begintrans)</ept>.","pos":[16360,16513],"source":"A transaction consists of a series of changes to the database's data or its structure, beginning with a call to [BeginTrans](#cdaoworkspace__begintrans)."},{"content":"When you complete the transaction, either commit it or roll it back (cancel the changes) with <bpt id=\"p1\">[</bpt>Rollback<ept id=\"p1\">](#cdaoworkspace__rollback)</ept>.","pos":[16514,16645],"source":" When you complete the transaction, either commit it or roll it back (cancel the changes) with [Rollback](#cdaoworkspace__rollback)."},{"content":"By default, without transactions, updates to records are committed immediately.","pos":[16646,16725]},{"content":"Calling <bpt id=\"p1\">**</bpt>BeginTrans<ept id=\"p1\">**</ept> causes commitment of updates to be delayed until you call <bpt id=\"p2\">**</bpt>CommitTrans<ept id=\"p2\">**</ept>.","pos":[16726,16823],"source":" Calling **BeginTrans** causes commitment of updates to be delayed until you call **CommitTrans**."},{"pos":[16831,17187],"content":"[!CAUTION]\n Within one workspace, transactions are always global to the workspace and are not limited to only one database or recordset. If you perform operations on more than one database or recordset within a workspace transaction, **CommitTrans** commits all pending updates, and **Rollback** restores all operations on those databases and recordsets.","leadings":["","> "],"nodes":[{"content":" Within one workspace, transactions are always global to the workspace and are not limited to only one database or recordset. If you perform operations on more than one database or recordset within a workspace transaction, **CommitTrans** commits all pending updates, and **Rollback** restores all operations on those databases and recordsets.","pos":[11,354],"nodes":[{"content":"Within one workspace, transactions are always global to the workspace and are not limited to only one database or recordset.","pos":[1,125]},{"content":"If you perform operations on more than one database or recordset within a workspace transaction, <bpt id=\"p1\">**</bpt>CommitTrans<ept id=\"p1\">**</ept> commits all pending updates, and <bpt id=\"p2\">**</bpt>Rollback<ept id=\"p2\">**</ept> restores all operations on those databases and recordsets.","pos":[126,343],"source":" If you perform operations on more than one database or recordset within a workspace transaction, **CommitTrans** commits all pending updates, and **Rollback** restores all operations on those databases and recordsets."}]}]},{"content":"When you close a database or workspace with pending transactions, the transactions are all rolled back.","pos":[17194,17297]},{"pos":[17305,17414],"content":"[!NOTE]\n This is not a two-phase commit mechanism. If one update fails to commit, others still will commit.","leadings":["","> "],"nodes":[{"content":" This is not a two-phase commit mechanism. If one update fails to commit, others still will commit.","pos":[8,107],"nodes":[{"content":"This is not a two-phase commit mechanism.","pos":[1,42]},{"content":"If one update fails to commit, others still will commit.","pos":[43,99]}]}]},{"pos":[17424,17501],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__compactdatabase\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::CompactDatabase","linkify":"<a name=\"cdaoworkspace__compactdatabase\"></a>  CDaoWorkspace::CompactDatabase","source":"<a name=\"cdaoworkspace__compactdatabase\"></a>  CDaoWorkspace::CompactDatabase"},{"content":"Call this member function to compact a specified Microsoft Jet (.MDB) database.","pos":[17505,17584]},{"pos":[17932,17942],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The name of an existing, closed database.","pos":[17963,18004]},{"content":"It can be a full path and filename, such as \"C:<ph id=\"ph1\">\\\\</ph>\\MYDB.MDB\".","pos":[18005,18065],"source":" It can be a full path and filename, such as \"C:\\\\\\MYDB.MDB\"."},{"content":"If the filename has an extension, you must specify it.","pos":[18066,18120]},{"content":"If your network supports the uniform naming convention (UNC), you can also specify a network path, such as \"<ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">\\\\</ph><ph id=\"ph3\">\\\\</ph>\\MYSERVER<ph id=\"ph4\">\\\\</ph>\\MYSHARE<ph id=\"ph5\">\\\\</ph>\\MYDIR<ph id=\"ph6\">\\\\</ph>\\MYDB.MDB\".","pos":[18121,18275],"source":" If your network supports the uniform naming convention (UNC), you can also specify a network path, such as \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB.MDB\"."},{"content":"(Double backslashes are required in the path strings because \"<ph id=\"ph1\">\\\\</ph>\" is the C++ escape character.)","pos":[18276,18371],"source":" (Double backslashes are required in the path strings because \"\\\\\" is the C++ escape character.)"},{"content":"The full path of the compacted database that you are creating.","pos":[18396,18458]},{"content":"You can also specify a network path as with <ph id=\"ph1\">`lpszSrcName`</ph>.","pos":[18459,18517],"source":" You can also specify a network path as with `lpszSrcName`."},{"content":"You cannot use the <ph id=\"ph1\">`lpszDestName`</ph> argument to specify the same database file as <ph id=\"ph2\">`lpszSrcName`</ph>.","pos":[18518,18612],"source":" You cannot use the `lpszDestName` argument to specify the same database file as `lpszSrcName`."},{"content":"A password, used when you want to compact a password-protected database.","pos":[18637,18709]},{"content":"Note that if you use the version of <ph id=\"ph1\">`CompactDatabase`</ph> that takes a password, you must supply all parameters.","pos":[18710,18818],"source":" Note that if you use the version of `CompactDatabase` that takes a password, you must supply all parameters."},{"content":"Also, because this is a connect parameter, it requires special formatting, as follows: ;PWD= <ph id=\"ph1\">`lpszPassword`</ph>.","pos":[18819,18927],"source":" Also, because this is a connect parameter, it requires special formatting, as follows: ;PWD= `lpszPassword`."},{"content":"For example: ;PWD=\"Happy\".","pos":[18928,18954]},{"content":"(The leading semicolon is required.)","pos":[18955,18991]},{"content":"A string expression used to specify collating order for creating <ph id=\"ph1\">`lpszDestName`</ph>.","pos":[19014,19094],"source":" A string expression used to specify collating order for creating `lpszDestName`."},{"content":"If you omit this argument by accepting the default value of <bpt id=\"p1\">**</bpt>dbLangGeneral<ept id=\"p1\">**</ept> (see below), the locale of the new database is the same as that of the old database.","pos":[19095,19257],"source":" If you omit this argument by accepting the default value of **dbLangGeneral** (see below), the locale of the new database is the same as that of the old database."},{"content":"Possible values are:","pos":[19258,19278]},{"pos":[19286,19368],"content":"<bpt id=\"p1\">**</bpt>dbLangGeneral<ept id=\"p1\">**</ept> English, German, French, Portuguese, Italian, and Modern Spanish","source":"**dbLangGeneral** English, German, French, Portuguese, Italian, and Modern Spanish"},{"pos":[19376,19399],"content":"<bpt id=\"p1\">**</bpt>dbLangArabic<ept id=\"p1\">**</ept> Arabic","source":"**dbLangArabic** Arabic"},{"pos":[19407,19433],"content":"<bpt id=\"p1\">**</bpt>dbLangCyrillic<ept id=\"p1\">**</ept> Russian","source":"**dbLangCyrillic** Russian"},{"pos":[19441,19462],"content":"<bpt id=\"p1\">**</bpt>dbLangCzech<ept id=\"p1\">**</ept> Czech","source":"**dbLangCzech** Czech"},{"pos":[19470,19491],"content":"<bpt id=\"p1\">**</bpt>dbLangDutch<ept id=\"p1\">**</ept> Dutch","source":"**dbLangDutch** Dutch"},{"pos":[19499,19520],"content":"<bpt id=\"p1\">**</bpt>dbLangGreek<ept id=\"p1\">**</ept> Greek","source":"**dbLangGreek** Greek"},{"pos":[19528,19551],"content":"<bpt id=\"p1\">**</bpt>dbLangHebrew<ept id=\"p1\">**</ept> Hebrew","source":"**dbLangHebrew** Hebrew"},{"pos":[19559,19588],"content":"<bpt id=\"p1\">**</bpt>dbLangHungarian<ept id=\"p1\">**</ept> Hungarian","source":"**dbLangHungarian** Hungarian"},{"pos":[19596,19625],"content":"<bpt id=\"p1\">**</bpt>dbLangIcelandic<ept id=\"p1\">**</ept> Icelandic","source":"**dbLangIcelandic** Icelandic"},{"pos":[19633,19715],"content":"<bpt id=\"p1\">**</bpt>dbLangNordic<ept id=\"p1\">**</ept> Nordic languages (Microsoft Jet database engine version 1.0 only)","source":"**dbLangNordic** Nordic languages (Microsoft Jet database engine version 1.0 only)"},{"pos":[19723,19761],"content":"<bpt id=\"p1\">**</bpt>dbLangNorwdan<ept id=\"p1\">**</ept> Norwegian and Danish","source":"**dbLangNorwdan** Norwegian and Danish"},{"pos":[19769,19792],"content":"<bpt id=\"p1\">**</bpt>dbLangPolish<ept id=\"p1\">**</ept> Polish","source":"**dbLangPolish** Polish"},{"pos":[19800,19837],"content":"<bpt id=\"p1\">**</bpt>dbLangSpanish<ept id=\"p1\">**</ept> Traditional Spanish","source":"**dbLangSpanish** Traditional Spanish"},{"pos":[19845,19882],"content":"<bpt id=\"p1\">**</bpt>dbLangSwedfin<ept id=\"p1\">**</ept> Swedish and Finnish","source":"**dbLangSwedfin** Swedish and Finnish"},{"pos":[19890,19915],"content":"<bpt id=\"p1\">**</bpt>dbLangTurkish<ept id=\"p1\">**</ept> Turkish","source":"**dbLangTurkish** Turkish"},{"pos":[19922,20359],"content":"`nOptions`  \nIndicates one or more options for the target database, `lpszDestName`. If you omit this argument by accepting the default value, the `lpszDestName` will have the same encryption and the same version as `lpszSrcName`. You can combine the **dbEncrypt** or **dbDecrypt** option with one of the version options using the bitwise-OR operator. Possible values, which specify a database format, not a database engine version, are:","leadings":[""," "],"nodes":[{"content":"Indicates one or more options for the target database, `lpszDestName`. If you omit this argument by accepting the default value, the `lpszDestName` will have the same encryption and the same version as `lpszSrcName`. You can combine the **dbEncrypt** or **dbDecrypt** option with one of the version options using the bitwise-OR operator. Possible values, which specify a database format, not a database engine version, are:","pos":[13,436],"nodes":[{"content":"Indicates one or more options for the target database, <ph id=\"ph1\">`lpszDestName`</ph>.","pos":[0,70],"source":"Indicates one or more options for the target database, `lpszDestName`."},{"content":"If you omit this argument by accepting the default value, the <ph id=\"ph1\">`lpszDestName`</ph> will have the same encryption and the same version as <ph id=\"ph2\">`lpszSrcName`</ph>.","pos":[71,216],"source":" If you omit this argument by accepting the default value, the `lpszDestName` will have the same encryption and the same version as `lpszSrcName`."},{"content":"You can combine the <bpt id=\"p1\">**</bpt>dbEncrypt<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>dbDecrypt<ept id=\"p2\">**</ept> option with one of the version options using the bitwise-OR operator.","pos":[217,337],"source":" You can combine the **dbEncrypt** or **dbDecrypt** option with one of the version options using the bitwise-OR operator."},{"content":"Possible values, which specify a database format, not a database engine version, are:","pos":[338,423]}]}]},{"pos":[20367,20419],"content":"<bpt id=\"p1\">**</bpt>dbEncrypt<ept id=\"p1\">**</ept> Encrypt the database while compacting.","source":"**dbEncrypt** Encrypt the database while compacting."},{"pos":[20427,20479],"content":"<bpt id=\"p1\">**</bpt>dbDecrypt<ept id=\"p1\">**</ept> Decrypt the database while compacting.","source":"**dbDecrypt** Decrypt the database while compacting."},{"pos":[20487,20594],"content":"<bpt id=\"p1\">**</bpt>dbVersion10<ept id=\"p1\">**</ept> Create a database that uses the Microsoft Jet database engine version 1.0 while compacting.","source":"**dbVersion10** Create a database that uses the Microsoft Jet database engine version 1.0 while compacting."},{"pos":[20602,20709],"content":"<bpt id=\"p1\">**</bpt>dbVersion11<ept id=\"p1\">**</ept> Create a database that uses the Microsoft Jet database engine version 1.1 while compacting.","source":"**dbVersion11** Create a database that uses the Microsoft Jet database engine version 1.1 while compacting."},{"pos":[20717,20824],"content":"<bpt id=\"p1\">**</bpt>dbVersion20<ept id=\"p1\">**</ept> Create a database that uses the Microsoft Jet database engine version 2.0 while compacting.","source":"**dbVersion20** Create a database that uses the Microsoft Jet database engine version 2.0 while compacting."},{"pos":[20832,20939],"content":"<bpt id=\"p1\">**</bpt>dbVersion30<ept id=\"p1\">**</ept> Create a database that uses the Microsoft Jet database engine version 3.0 while compacting.","source":"**dbVersion30** Create a database that uses the Microsoft Jet database engine version 3.0 while compacting."},{"content":"You can use <bpt id=\"p1\">**</bpt>dbEncrypt<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>dbDecrypt<ept id=\"p2\">**</ept> in the options argument to specify whether to encrypt or to decrypt the database as it is compacted.","pos":[20946,21089],"source":"You can use **dbEncrypt** or **dbDecrypt** in the options argument to specify whether to encrypt or to decrypt the database as it is compacted."},{"content":"If you omit an encryption constant or if you include both <bpt id=\"p1\">**</bpt>dbDecrypt<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>dbEncrypt<ept id=\"p2\">**</ept>, <ph id=\"ph1\">`lpszDestName`</ph> will have the same encryption as <ph id=\"ph2\">`lpszSrcName`</ph>.","pos":[21090,21243],"source":" If you omit an encryption constant or if you include both **dbDecrypt** and **dbEncrypt**, `lpszDestName` will have the same encryption as `lpszSrcName`."},{"content":"You can use one of the version constants in the options argument to specify the version of the data format for the compacted database.","pos":[21244,21378]},{"content":"This constant affects only the version of the data format of <ph id=\"ph1\">`lpszDestName`</ph>.","pos":[21379,21455],"source":" This constant affects only the version of the data format of `lpszDestName`."},{"content":"You can specify only one version constant.","pos":[21456,21498]},{"content":"If you omit a version constant, <ph id=\"ph1\">`lpszDestName`</ph> will have the same version as <ph id=\"ph2\">`lpszSrcName`</ph>.","pos":[21499,21590],"source":" If you omit a version constant, `lpszDestName` will have the same version as `lpszSrcName`."},{"content":"You can compact <ph id=\"ph1\">`lpszDestName`</ph> only to a version that is the same or later than that of <ph id=\"ph2\">`lpszSrcName`</ph>.","pos":[21591,21693],"source":" You can compact `lpszDestName` only to a version that is the same or later than that of `lpszSrcName`."},{"pos":[21701,21877],"content":"[!CAUTION]\n If a database is not encrypted, it is possible, even if you implement user/password security, to directly read the binary disk file that constitutes the database.","leadings":["","> "],"nodes":[{"content":"If a database is not encrypted, it is possible, even if you implement user/password security, to directly read the binary disk file that constitutes the database.","pos":[12,174]}]},{"pos":[21887,21894],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"As you change data in a database, the database file can become fragmented and use more disk space than necessary.","pos":[21898,22011]},{"content":"Periodically, you should compact your database to defragment the database file.","pos":[22012,22091]},{"content":"The compacted database is usually smaller.","pos":[22092,22134]},{"content":"You can also choose to change the collating order, the encryption, or the version of the data format while you copy and compact the database.","pos":[22135,22276]},{"pos":[22284,22585],"content":"[!CAUTION]\n The `CompactDatabase` member function will not correctly convert a complete Microsoft Access database from one version to another. Only the data format is converted. Microsoft Access-defined objects, such as forms and reports, are not converted. However, the data is correctly converted.","leadings":["","> "],"nodes":[{"content":" The `CompactDatabase` member function will not correctly convert a complete Microsoft Access database from one version to another. Only the data format is converted. Microsoft Access-defined objects, such as forms and reports, are not converted. However, the data is correctly converted.","pos":[11,299],"nodes":[{"content":"The <ph id=\"ph1\">`CompactDatabase`</ph> member function will not correctly convert a complete Microsoft Access database from one version to another.","pos":[1,131],"source":" The `CompactDatabase` member function will not correctly convert a complete Microsoft Access database from one version to another."},{"content":"Only the data format is converted.","pos":[132,166]},{"content":"Microsoft Access-defined objects, such as forms and reports, are not converted.","pos":[167,246]},{"content":"However, the data is correctly converted.","pos":[247,288]}]}]},{"pos":[22593,22662],"content":"[!TIP]\n You can also use `CompactDatabase` to copy a database file.","leadings":["","> "],"nodes":[{"content":"You can also use <ph id=\"ph1\">`CompactDatabase`</ph> to copy a database file.","pos":[8,67],"source":" You can also use `CompactDatabase` to copy a database file."}]},{"content":"For more information about compacting databases, see the topic \"CompactDatabase Method\" in DAO Help.","pos":[22669,22769]},{"pos":[22779,22838],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__create\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::Create","linkify":"<a name=\"cdaoworkspace__create\"></a>  CDaoWorkspace::Create","source":"<a name=\"cdaoworkspace__create\"></a>  CDaoWorkspace::Create"},{"pos":[22842,22958],"content":"Call this member function to create a new DAO workspace object and associate it with the MFC <ph id=\"ph1\">`CDaoWorkspace`</ph> object.","source":"Call this member function to create a new DAO workspace object and associate it with the MFC `CDaoWorkspace` object."},{"pos":[23083,23093],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A string with up to 14 characters that uniquely names the new workspace object.","pos":[23111,23190]},{"content":"You must supply a name.","pos":[23191,23214]},{"content":"For related information, see the topic \"Name Property\" in DAO Help.","pos":[23215,23282]},{"content":"<bpt id=\"p1\">*</bpt>lpszUserName<ept id=\"p1\">*</ept>","pos":[23289,23303],"source":"*lpszUserName*"},{"content":"The user name of the workspace's owner.","pos":[23307,23346]},{"content":"For requirements, see the <ph id=\"ph1\">`lpszDefaultUser`</ph> parameter to the <bpt id=\"p1\">[</bpt>SetDefaultUser<ept id=\"p1\">](#cdaoworkspace__setdefaultuser)</ept> member function.","pos":[23347,23473],"source":" For requirements, see the `lpszDefaultUser` parameter to the [SetDefaultUser](#cdaoworkspace__setdefaultuser) member function."},{"content":"For related information, see the topic \"UserName Property\" in DAO Help.","pos":[23474,23545]},{"content":"The password for the new workspace object.","pos":[23570,23612]},{"content":"A password can be up to 14 characters long and can contain any character except ASCII 0 (null).","pos":[23613,23708]},{"content":"Passwords are case-sensitive.","pos":[23709,23738]},{"content":"For related information, see the topic \"Password Property\" in DAO Help.","pos":[23739,23810]},{"pos":[23820,23827],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The overall creation process is:","pos":[23831,23863]},{"pos":[23873,23939],"content":"Construct a <bpt id=\"p1\">[</bpt>CDaoWorkspace<ept id=\"p1\">](#cdaoworkspace__cdaoworkspace)</ept> object.","source":"Construct a [CDaoWorkspace](#cdaoworkspace__cdaoworkspace) object."},{"content":"Call the object's <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> member function to create the underlying DAO workspace.","pos":[23949,24033],"source":"Call the object's **Create** member function to create the underlying DAO workspace."},{"content":"You must specify a workspace name.","pos":[24034,24068]},{"content":"Optionally call <bpt id=\"p1\">[</bpt>Append<ept id=\"p1\">](#cdaoworkspace__append)</ept> if you want to add the workspace to the database engine's Workspaces collection.","pos":[24078,24207],"source":"Optionally call [Append](#cdaoworkspace__append) if you want to add the workspace to the database engine's Workspaces collection."},{"content":"You can work with the workspace without appending it.","pos":[24208,24261]},{"content":"After the <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> call, the workspace object is in an open state, ready for use.","pos":[24268,24351],"source":"After the **Create** call, the workspace object is in an open state, ready for use."},{"content":"You do not call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> after <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept>.","pos":[24352,24394],"source":" You do not call **Open** after **Create**."},{"content":"You do not call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> if the workspace already exists in the Workspaces collection.","pos":[24395,24483],"source":" You do not call **Create** if the workspace already exists in the Workspaces collection."},{"content":"<bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> initializes the database engine if it has not already been initialized for your application.","pos":[24484,24587],"source":"**Create** initializes the database engine if it has not already been initialized for your application."},{"pos":[24597,24676],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getdatabasecount\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetDatabaseCount","linkify":"<a name=\"cdaoworkspace__getdatabasecount\"></a>  CDaoWorkspace::GetDatabaseCount","source":"<a name=\"cdaoworkspace__getdatabasecount\"></a>  CDaoWorkspace::GetDatabaseCount"},{"content":"Call this member function to retrieve the number of DAO database objects in the workspace's Databases collection — the number of open databases in the workspace.","pos":[24680,24841]},{"pos":[24892,24904],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The number of open databases in the workspace.","pos":[24908,24954]},{"pos":[24964,24971],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`GetDatabaseCount`</ph> is useful if you need to loop through all defined databases in the workspace's Databases collection.","pos":[24975,25094],"source":"`GetDatabaseCount` is useful if you need to loop through all defined databases in the workspace's Databases collection."},{"content":"To obtain information about a given database in the collection, see <bpt id=\"p1\">[</bpt>GetDatabaseInfo<ept id=\"p1\">](#cdaoworkspace__getdatabaseinfo)</ept>.","pos":[25095,25214],"source":" To obtain information about a given database in the collection, see [GetDatabaseInfo](#cdaoworkspace__getdatabaseinfo)."},{"content":"Typical usage is to call <ph id=\"ph1\">`GetDatabaseCount`</ph> for the number of open databases, then use that number as a loop index for repeated calls to <ph id=\"ph2\">`GetDatabaseInfo`</ph>.","pos":[25215,25370],"source":" Typical usage is to call `GetDatabaseCount` for the number of open databases, then use that number as a loop index for repeated calls to `GetDatabaseInfo`."},{"pos":[25380,25457],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getdatabaseinfo\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetDatabaseInfo","linkify":"<a name=\"cdaoworkspace__getdatabaseinfo\"></a>  CDaoWorkspace::GetDatabaseInfo","source":"<a name=\"cdaoworkspace__getdatabaseinfo\"></a>  CDaoWorkspace::GetDatabaseInfo"},{"content":"Call this member function to obtain various kinds of information about a database open in the workspace.","pos":[25461,25565]},{"pos":[25841,25851],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The zero-based index of the database object in the workspace's Databases collection, for lookup by index.","pos":[25867,25972]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoDatabaseInfo<ept id=\"p1\">](../../mfc/reference/cdaodatabaseinfo-structure.md)</ept> object that returns the information requested.","pos":[25991,26124],"source":" A reference to a [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) object that returns the information requested."},{"content":"Options that specify which information about the database to retrieve.","pos":[26150,26220]},{"content":"The available options are listed here along with what they cause the function to return:","pos":[26221,26309]},{"pos":[26317,26379],"content":"<ph id=\"ph1\">`AFX_DAO_PRIMARY_INFO`</ph> (Default) Name, Updatable, Transactions","source":"`AFX_DAO_PRIMARY_INFO` (Default) Name, Updatable, Transactions"},{"pos":[26387,26477],"content":"<ph id=\"ph1\">`AFX_DAO_SECONDARY_INFO`</ph> Primary information plus: Version, Collating Order, Query Timeout","source":"`AFX_DAO_SECONDARY_INFO` Primary information plus: Version, Collating Order, Query Timeout"},{"pos":[26485,26551],"content":"<ph id=\"ph1\">`AFX_DAO_ALL_INFO`</ph> Primary and secondary information plus: Connect","source":"`AFX_DAO_ALL_INFO` Primary and secondary information plus: Connect"},{"pos":[26558,26716],"content":"`lpszName`  \nThe name of the database object, for lookup by name. The name is a string with up to 14 characters that uniquely names the new workspace object.","leadings":[""," "],"nodes":[{"content":"The name of the database object, for lookup by name. The name is a string with up to 14 characters that uniquely names the new workspace object.","pos":[13,157],"nodes":[{"content":"The name of the database object, for lookup by name.","pos":[0,52]},{"content":"The name is a string with up to 14 characters that uniquely names the new workspace object.","pos":[53,144]}]}]},{"pos":[26726,26733],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"One version of the function lets you look up a database by index.","pos":[26737,26802]},{"content":"The other version lets you look up a database by name.","pos":[26803,26857]},{"content":"For a description of the information returned in <ph id=\"ph1\">`dbinfo`</ph>, see the <bpt id=\"p1\">[</bpt>CDaoDatabaseInfo<ept id=\"p1\">](../../mfc/reference/cdaodatabaseinfo-structure.md)</ept> structure.","pos":[26864,27011],"source":"For a description of the information returned in `dbinfo`, see the [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) structure."},{"content":"This structure has members that correspond to the items of information listed above in the description of <ph id=\"ph1\">`dwInfoOptions`</ph>.","pos":[27012,27134],"source":" This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`."},{"content":"When you request information at one level, you get information for any prior levels as well.","pos":[27135,27227]},{"pos":[27237,27304],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getinipath\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetIniPath","linkify":"<a name=\"cdaoworkspace__getinipath\"></a>  CDaoWorkspace::GetIniPath","source":"<a name=\"cdaoworkspace__getinipath\"></a>  CDaoWorkspace::GetIniPath"},{"content":"Call this member function to obtain the location of the Microsoft Jet database engine's initialization settings in the Windows registry.","pos":[27308,27444]},{"pos":[27505,27517],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[27521,27616],"content":"A <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> containing the registry location.","source":"A [CString](../../atl-mfc-shared/reference/cstringt-class.md) containing the registry location."},{"pos":[27626,27633],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can use the location to obtain information about settings for the database engine.","pos":[27637,27723]},{"content":"The information returned is actually the name of a registry subkey.","pos":[27724,27791]},{"content":"For related information, see the topics \"IniPath Property\" and \"Customizing Windows Registry Settings for Data Access\" in DAO Help.","pos":[27798,27929]},{"pos":[27939,28024],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getisolateodbctrans\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetIsolateODBCTrans","linkify":"<a name=\"cdaoworkspace__getisolateodbctrans\"></a>  CDaoWorkspace::GetIsolateODBCTrans","source":"<a name=\"cdaoworkspace__getisolateodbctrans\"></a>  CDaoWorkspace::GetIsolateODBCTrans"},{"content":"Call this member function to get the current value of the DAO IsolateODBCTrans property for the workspace.","pos":[28028,28134]},{"pos":[28187,28199],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if ODBC transactions are isolated; otherwise 0.","pos":[28203,28258]},{"pos":[28268,28275],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In some situations, you might need to have multiple simultaneous transactions pending on the same ODBC database.","pos":[28279,28391]},{"content":"To do this, you need to open a separate workspace for each transaction.","pos":[28392,28463]},{"content":"Keep in mind that although each workspace can have its own ODBC connection to the database, this slows system performance.","pos":[28464,28586]},{"content":"Because transaction isolation is not normally required, ODBC connections from multiple workspace objects opened by the same user are shared by default.","pos":[28587,28738]},{"content":"Some ODBC servers, such as Microsoft SQL Server, do not allow simultaneous transactions on a single connection.","pos":[28745,28856]},{"content":"If you need to have more than one transaction at a time pending against such a database, set the IsolateODBCTrans property to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> on each workspace as soon as you open it.","pos":[28857,29033],"source":" If you need to have more than one transaction at a time pending against such a database, set the IsolateODBCTrans property to **TRUE** on each workspace as soon as you open it."},{"content":"This forces a separate ODBC connection for each workspace.","pos":[29034,29092]},{"content":"For related information, see the topic \"IsolateODBCTrans Property\" in DAO Help.","pos":[29099,29178]},{"pos":[29188,29265],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getlogintimeout\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetLoginTimeout","linkify":"<a name=\"cdaoworkspace__getlogintimeout\"></a>  CDaoWorkspace::GetLoginTimeout","source":"<a name=\"cdaoworkspace__getlogintimeout\"></a>  CDaoWorkspace::GetLoginTimeout"},{"content":"Call this member function to get the current value of the DAO LoginTimeout property for the workspace.","pos":[29269,29371]},{"pos":[29435,29447],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The number of seconds before an error occurs when you attempt to log in to an ODBC database.","pos":[29451,29543]},{"pos":[29553,29560],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This value represents the number of seconds before an error occurs when you attempt to log in to an ODBC database.","pos":[29564,29678]},{"content":"The default LoginTimeout setting is 20 seconds.","pos":[29679,29726]},{"content":"When LoginTimeout is set to 0, no timeout occurs and the communication with the data source might stop responding.","pos":[29727,29841]},{"content":"When you are attempting to log in to an ODBC database, such as Microsoft SQL Server, the connection may fail as a result of network errors or because the server is not running.","pos":[29848,30024]},{"content":"Rather than waiting for the default 20 seconds to connect, you can specify how long the database engine waits before it produces an error.","pos":[30025,30163]},{"content":"Logging in to the server happens implicitly as part of a number of different events, such as running a query on an external server database.","pos":[30164,30304]},{"content":"For related information, see the topic \"LoginTimeout Property\" in DAO Help.","pos":[30311,30386]},{"pos":[30396,30457],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getname\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetName","linkify":"<a name=\"cdaoworkspace__getname\"></a>  CDaoWorkspace::GetName","source":"<a name=\"cdaoworkspace__getname\"></a>  CDaoWorkspace::GetName"},{"pos":[30461,30582],"content":"Call this member function to get the user-defined name of the DAO workspace object underlying the <ph id=\"ph1\">`CDaoWorkspace`</ph> object.","source":"Call this member function to get the user-defined name of the DAO workspace object underlying the `CDaoWorkspace` object."},{"pos":[30626,30638],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[30642,30765],"content":"A <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> containing the user-defined name of the DAO workspace object.","source":"A [CString](../../atl-mfc-shared/reference/cstringt-class.md) containing the user-defined name of the DAO workspace object."},{"pos":[30775,30782],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The name is useful for accessing the DAO workspace object in the database engine's Workspaces collection by name.","pos":[30786,30899]},{"content":"For related information, see the topic \"Name Property\" in DAO Help.","pos":[30906,30973]},{"pos":[30983,31052],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getusername\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetUserName","linkify":"<a name=\"cdaoworkspace__getusername\"></a>  CDaoWorkspace::GetUserName","source":"<a name=\"cdaoworkspace__getusername\"></a>  CDaoWorkspace::GetUserName"},{"content":"Call this member function to obtain the name of the owner of the workspace.","pos":[31056,31131]},{"pos":[31179,31191],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[31195,31307],"content":"A <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> that represents the owner of the workspace object.","source":"A [CString](../../atl-mfc-shared/reference/cstringt-class.md) that represents the owner of the workspace object."},{"pos":[31317,31324],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"To get or set the permissions for the workspace owner, call DAO directly to check the Permissions property setting; this determines what permissions that user has.","pos":[31328,31491]},{"content":"To work with permissions, you need a SYSTEM.MDA file.","pos":[31492,31545]},{"content":"For information about calling DAO directly, see <bpt id=\"p1\">[</bpt>Technical Note 54<ept id=\"p1\">](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)</ept>.","pos":[31552,31689],"source":"For information about calling DAO directly, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)."},{"content":"For related information, see the topic \"UserName Property\" in DAO Help.","pos":[31690,31761]},{"pos":[31771,31838],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getversion\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetVersion","linkify":"<a name=\"cdaoworkspace__getversion\"></a>  CDaoWorkspace::GetVersion","source":"<a name=\"cdaoworkspace__getversion\"></a>  CDaoWorkspace::GetVersion"},{"content":"Call this member function to determine the version of the Microsoft Jet database engine in use.","pos":[31842,31937]},{"pos":[31998,32010],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[32014,32153],"content":"A <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> that indicates the version of the database engine associated with the object.","source":"A [CString](../../atl-mfc-shared/reference/cstringt-class.md) that indicates the version of the database engine associated with the object."},{"pos":[32163,32170],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The value returned represents the version number in the form \"major.minor\"; for example, \"3.0\".","pos":[32174,32269]},{"content":"The product version number (for example, 3.0) consists of the version number (3), a period, and the release number (0).","pos":[32270,32389]},{"content":"For related information, see the topic \"Version Property\" in DAO Help.","pos":[32396,32466]},{"pos":[32476,32557],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getworkspacecount\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetWorkspaceCount","linkify":"<a name=\"cdaoworkspace__getworkspacecount\"></a>  CDaoWorkspace::GetWorkspaceCount","source":"<a name=\"cdaoworkspace__getworkspacecount\"></a>  CDaoWorkspace::GetWorkspaceCount"},{"content":"Call this member function to retrieve the number of DAO workspace objects in the database engine's Workspaces collection.","pos":[32561,32682]},{"pos":[32734,32746],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The number of open workspaces in the Workspaces collection.","pos":[32750,32809]},{"pos":[32819,32826],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This count does not include any open workspaces not appended to the collection.","pos":[32830,32909]},{"content":"<ph id=\"ph1\">`GetWorkspaceCount`</ph> is useful if you need to loop through all defined workspaces in the Workspaces collection.","pos":[32910,33020],"source":"`GetWorkspaceCount` is useful if you need to loop through all defined workspaces in the Workspaces collection."},{"content":"To obtain information about a given workspace in the collection, see <bpt id=\"p1\">[</bpt>GetWorkspaceInfo<ept id=\"p1\">](#cdaoworkspace__getworkspaceinfo)</ept>.","pos":[33021,33143],"source":" To obtain information about a given workspace in the collection, see [GetWorkspaceInfo](#cdaoworkspace__getworkspaceinfo)."},{"content":"Typical usage is to call <ph id=\"ph1\">`GetWorkspaceCount`</ph> for the number of open workspaces, then use that number as a loop index for repeated calls to <ph id=\"ph2\">`GetWorkspaceInfo`</ph>.","pos":[33144,33302],"source":" Typical usage is to call `GetWorkspaceCount` for the number of open workspaces, then use that number as a loop index for repeated calls to `GetWorkspaceInfo`."},{"pos":[33312,33391],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__getworkspaceinfo\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::GetWorkspaceInfo","linkify":"<a name=\"cdaoworkspace__getworkspaceinfo\"></a>  CDaoWorkspace::GetWorkspaceInfo","source":"<a name=\"cdaoworkspace__getworkspaceinfo\"></a>  CDaoWorkspace::GetWorkspaceInfo"},{"content":"Call this member function to obtain various kinds of information about a workspace open in the session.","pos":[33395,33498]},{"pos":[33784,33794],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The zero-based index of the database object in the Workspaces collection, for lookup by index.","pos":[33810,33904]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoWorkspaceInfo<ept id=\"p1\">](../../mfc/reference/cdaoworkspaceinfo-structure.md)</ept> object that returns the information requested.","pos":[33926,34061],"source":" A reference to a [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) object that returns the information requested."},{"content":"Options that specify which information about the workspace to retrieve.","pos":[34087,34158]},{"content":"The available options are listed here along with what they cause the function to return:","pos":[34159,34247]},{"pos":[34255,34292],"content":"<ph id=\"ph1\">`AFX_DAO_PRIMARY_INFO`</ph> (Default) Name","source":"`AFX_DAO_PRIMARY_INFO` (Default) Name"},{"pos":[34300,34360],"content":"<ph id=\"ph1\">`AFX_DAO_SECONDARY_INFO`</ph> Primary information plus: User Name","source":"`AFX_DAO_SECONDARY_INFO` Primary information plus: User Name"},{"pos":[34368,34444],"content":"<ph id=\"ph1\">`AFX_DAO_ALL_INFO`</ph> Primary and secondary information plus: Isolate ODBCTrans","source":"`AFX_DAO_ALL_INFO` Primary and secondary information plus: Isolate ODBCTrans"},{"pos":[34451,34610],"content":"`lpszName`  \nThe name of the workspace object, for lookup by name. The name is a string with up to 14 characters that uniquely names the new workspace object.","leadings":[""," "],"nodes":[{"content":"The name of the workspace object, for lookup by name. The name is a string with up to 14 characters that uniquely names the new workspace object.","pos":[13,158],"nodes":[{"content":"The name of the workspace object, for lookup by name.","pos":[0,53]},{"content":"The name is a string with up to 14 characters that uniquely names the new workspace object.","pos":[54,145]}]}]},{"pos":[34620,34627],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"For a description of the information returned in <ph id=\"ph1\">`wkspcinfo`</ph>, see the <bpt id=\"p1\">[</bpt>CDaoWorkspaceInfo<ept id=\"p1\">](../../mfc/reference/cdaoworkspaceinfo-structure.md)</ept> structure.","pos":[34631,34783],"source":"For a description of the information returned in `wkspcinfo`, see the [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) structure."},{"content":"This structure has members that correspond to the items of information listed above in the description of <ph id=\"ph1\">`dwInfoOptions`</ph>.","pos":[34784,34906],"source":" This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`."},{"content":"When you request information at one level, you get information for prior levels as well.","pos":[34907,34995]},{"pos":[35005,35060],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__idle\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::Idle","linkify":"<a name=\"cdaoworkspace__idle\"></a>  CDaoWorkspace::Idle","source":"<a name=\"cdaoworkspace__idle\"></a>  CDaoWorkspace::Idle"},{"pos":[35064,35220],"content":"Call <bpt id=\"p1\">**</bpt>Idle<ept id=\"p1\">**</ept> to provide the database engine with the opportunity to perform background tasks that may not be up-to-date because of intense data processing.","source":"Call **Idle** to provide the database engine with the opportunity to perform background tasks that may not be up-to-date because of intense data processing."},{"pos":[35297,35307],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"An action to take during the idle processing.","pos":[35324,35369]},{"content":"Currently the only valid action is <bpt id=\"p1\">**</bpt>dbFreeLocks<ept id=\"p1\">**</ept>.","pos":[35370,35421],"source":" Currently the only valid action is **dbFreeLocks**."},{"pos":[35431,35438],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This is often true in multiuser, multitasking environments in which there is not enough background processing time to keep all records in a recordset current.","pos":[35442,35600]},{"pos":[35608,35793],"content":"[!NOTE]\n Calling **Idle** is not necessary with databases created with version 3.0 of the Microsoft Jet database engine. Use **Idle** only for databases created with earlier versions.","leadings":["","> "],"nodes":[{"content":" Calling **Idle** is not necessary with databases created with version 3.0 of the Microsoft Jet database engine. Use **Idle** only for databases created with earlier versions.","pos":[8,183],"nodes":[{"content":"Calling <bpt id=\"p1\">**</bpt>Idle<ept id=\"p1\">**</ept> is not necessary with databases created with version 3.0 of the Microsoft Jet database engine.","pos":[1,112],"source":" Calling **Idle** is not necessary with databases created with version 3.0 of the Microsoft Jet database engine."},{"content":"Use <bpt id=\"p1\">**</bpt>Idle<ept id=\"p1\">**</ept> only for databases created with earlier versions.","pos":[113,175],"source":" Use **Idle** only for databases created with earlier versions."}]}]},{"content":"Usually, read locks are removed and data in local dynaset-type recordset objects is updated only when no other actions (including mouse movements) are occurring.","pos":[35800,35961]},{"content":"If you periodically call <bpt id=\"p1\">**</bpt>Idle<ept id=\"p1\">**</ept>, you provide the database engine with time to catch up on background processing tasks by releasing unneeded read locks.","pos":[35962,36115],"source":" If you periodically call **Idle**, you provide the database engine with time to catch up on background processing tasks by releasing unneeded read locks."},{"content":"Specifying the <bpt id=\"p1\">**</bpt>dbFreeLocks<ept id=\"p1\">**</ept> constant as an argument delays processing until all read locks are released.","pos":[36116,36223],"source":" Specifying the **dbFreeLocks** constant as an argument delays processing until all read locks are released."},{"content":"This member function is not needed in single-user environments unless multiple instances of an application are running.","pos":[36230,36349]},{"content":"The <bpt id=\"p1\">**</bpt>Idle<ept id=\"p1\">**</ept> member function may increase performance in a multiuser environment because it forces the database engine to flush data to disk, releasing locks on memory.","pos":[36350,36518],"source":" The **Idle** member function may increase performance in a multiuser environment because it forces the database engine to flush data to disk, releasing locks on memory."},{"content":"You can also release read locks by making operations part of a transaction.","pos":[36519,36594]},{"content":"For related information, see the topic \"Idle Method\" in DAO Help.","pos":[36601,36666]},{"pos":[36676,36735],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__isopen\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::IsOpen","linkify":"<a name=\"cdaoworkspace__isopen\"></a>  CDaoWorkspace::IsOpen","source":"<a name=\"cdaoworkspace__isopen\"></a>  CDaoWorkspace::IsOpen"},{"pos":[36739,36964],"content":"Call this member function to determine whether the <ph id=\"ph1\">`CDaoWorkspace`</ph> object is open — that is, whether the MFC object has been initialized by a call to <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaoworkspace__open)</ept> or a call to <bpt id=\"p2\">[</bpt>Create<ept id=\"p2\">](#cdaoworkspace__create)</ept>.","source":"Call this member function to determine whether the `CDaoWorkspace` object is open — that is, whether the MFC object has been initialized by a call to [Open](#cdaoworkspace__open) or a call to [Create](#cdaoworkspace__create)."},{"pos":[37013,37025],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the workspace object is open; otherwise 0.","pos":[37029,37082]},{"pos":[37092,37099],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can call any of the member functions of a workspace that is in an open state.","pos":[37103,37184]},{"pos":[37194,37271],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__m_pdaoworkspace\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::m_pDAOWorkspace","linkify":"<a name=\"cdaoworkspace__m_pdaoworkspace\"></a>  CDaoWorkspace::m_pDAOWorkspace","source":"<a name=\"cdaoworkspace__m_pdaoworkspace\"></a>  CDaoWorkspace::m_pDAOWorkspace"},{"content":"A pointer to the underlying DAO workspace object.","pos":[37275,37324]},{"pos":[37334,37341],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Use this data member if you need direct access to the underlying DAO object.","pos":[37345,37421]},{"content":"You can call the DAO object's interfaces through this pointer.","pos":[37422,37484]},{"pos":[37491,37638],"content":"For information about accessing DAO objects directly, see <bpt id=\"p1\">[</bpt>Technical Note 54<ept id=\"p1\">](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)</ept>.","source":"For information about accessing DAO objects directly, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)."},{"pos":[37648,37703],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__open\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::Open","linkify":"<a name=\"cdaoworkspace__open\"></a>  CDaoWorkspace::Open","source":"<a name=\"cdaoworkspace__open\"></a>  CDaoWorkspace::Open"},{"content":"Explicitly opens a workspace object associated with DAO's default workspace.","pos":[37707,37783]},{"pos":[37852,37862],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The name of the DAO workspace object to open — a string with up to 14 characters that uniquely names the workspace.","pos":[37880,37995]},{"content":"Accept the default value <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> to explicitly open the default workspace.","pos":[37996,38071],"source":" Accept the default value **NULL** to explicitly open the default workspace."},{"content":"For naming requirements, see the <ph id=\"ph1\">`lpszName`</ph> parameter for <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoworkspace__create)</ept>.","pos":[38072,38163],"source":" For naming requirements, see the `lpszName` parameter for [Create](#cdaoworkspace__create)."},{"content":"For related information, see the topic \"Name Property\" in DAO Help.","pos":[38164,38231]},{"pos":[38241,38248],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[38252,38350],"content":"After constructing a <ph id=\"ph1\">`CDaoWorkspace`</ph> object, call this member function to do one of the following:","source":"After constructing a `CDaoWorkspace` object, call this member function to do one of the following:"},{"content":"Explicitly open the default workspace.","pos":[38360,38398]},{"content":"Pass <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> for <ph id=\"ph1\">`lpszName`</ph>.","pos":[38399,38428],"source":" Pass **NULL** for `lpszName`."},{"content":"Open an existing <ph id=\"ph1\">`CDaoWorkspace`</ph> object, a member of the Workspaces collection, by name.","pos":[38438,38526],"source":"Open an existing `CDaoWorkspace` object, a member of the Workspaces collection, by name."},{"content":"Pass a valid name for an existing workspace object.","pos":[38527,38578]},{"pos":[38585,38740],"content":"<bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> puts the workspace object into an open state and also initializes the database engine if it has not already been initialized for your application.","source":"**Open** puts the workspace object into an open state and also initializes the database engine if it has not already been initialized for your application."},{"pos":[38747,39001],"content":"Although many <ph id=\"ph1\">`CDaoWorkspace`</ph> member functions can only be called after the workspace has been opened, the following member functions, which operate on the database engine, are available after construction of the C++ object but before a call to <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>:","source":"Although many `CDaoWorkspace` member functions can only be called after the workspace has been opened, the following member functions, which operate on the database engine, are available after construction of the C++ object but before a call to **Open**:"},{"pos":[39025,39057],"content":"<bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoworkspace__create)</ept>","source":"[Create](#cdaoworkspace__create)"},{"pos":[39058,39098],"content":"<bpt id=\"p1\">[</bpt>GetVersion<ept id=\"p1\">](#cdaoworkspace__getversion)</ept>","source":"[GetVersion](#cdaoworkspace__getversion)"},{"pos":[39099,39147],"content":"<bpt id=\"p1\">[</bpt>SetDefaultUser<ept id=\"p1\">](#cdaoworkspace__setdefaultuser)</ept>","source":"[SetDefaultUser](#cdaoworkspace__setdefaultuser)"},{"pos":[39152,39192],"content":"<bpt id=\"p1\">[</bpt>GetIniPath<ept id=\"p1\">](#cdaoworkspace__getinipath)</ept>","source":"[GetIniPath](#cdaoworkspace__getinipath)"},{"pos":[39193,39221],"content":"<bpt id=\"p1\">[</bpt>Idle<ept id=\"p1\">](#cdaoworkspace__idle)</ept>","source":"[Idle](#cdaoworkspace__idle)"},{"pos":[39222,39262],"content":"<bpt id=\"p1\">[</bpt>SetIniPath<ept id=\"p1\">](#cdaoworkspace__setinipath)</ept>","source":"[SetIniPath](#cdaoworkspace__setinipath)"},{"pos":[39267,39317],"content":"<bpt id=\"p1\">[</bpt>GetLoginTimeout<ept id=\"p1\">](#cdaoworkspace__getlogintimeout)</ept>","source":"[GetLoginTimeout](#cdaoworkspace__getlogintimeout)"},{"pos":[39318,39374],"content":"<bpt id=\"p1\">[</bpt>SetDefaultPassword<ept id=\"p1\">](#cdaoworkspace__setdefaultpassword)</ept>","source":"[SetDefaultPassword](#cdaoworkspace__setdefaultpassword)"},{"pos":[39375,39425],"content":"<bpt id=\"p1\">[</bpt>SetLoginTimeout<ept id=\"p1\">](#cdaoworkspace__setlogintimeout)</ept>","source":"[SetLoginTimeout](#cdaoworkspace__setlogintimeout)"},{"pos":[39436,39511],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__repairdatabase\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::RepairDatabase","linkify":"<a name=\"cdaoworkspace__repairdatabase\"></a>  CDaoWorkspace::RepairDatabase","source":"<a name=\"cdaoworkspace__repairdatabase\"></a>  CDaoWorkspace::RepairDatabase"},{"content":"Call this member function if you need to attempt to repair a corrupted database that accesses the Microsoft Jet database engine.","pos":[39515,39643]},{"pos":[39721,39731],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The path and filename for an existing Microsoft Jet engine database file.","pos":[39749,39822]},{"content":"If you omit the path, only the current directory is searched.","pos":[39823,39884]},{"content":"If your system supports the uniform naming convention (UNC), you can also specify a network path, such as: \"<ph id=\"ph1\">\\\\</ph><ph id=\"ph2\">\\\\</ph><ph id=\"ph3\">\\\\</ph>\\MYSERVER<ph id=\"ph4\">\\\\</ph>\\MYSHARE<ph id=\"ph5\">\\\\</ph>\\MYDIR<ph id=\"ph6\">\\\\</ph>\\MYDB.MDB\".","pos":[39885,40039],"source":" If your system supports the uniform naming convention (UNC), you can also specify a network path, such as: \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB.MDB\"."},{"content":"(Double backslashes are required in the path string because \"<ph id=\"ph1\">\\\\</ph>\" is the C++ escape character.)","pos":[40040,40134],"source":" (Double backslashes are required in the path string because \"\\\\\" is the C++ escape character.)"},{"pos":[40144,40151],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You must close the database specified by <ph id=\"ph1\">`lpszName`</ph> before you repair it.","pos":[40155,40228],"source":"You must close the database specified by `lpszName` before you repair it."},{"content":"In a multiuser environment, other users cannot have <ph id=\"ph1\">`lpszName`</ph> open while you are repairing it.","pos":[40229,40324],"source":" In a multiuser environment, other users cannot have `lpszName` open while you are repairing it."},{"content":"If <ph id=\"ph1\">`lpszName`</ph> is not closed or is not available for exclusive use, an error occurs.","pos":[40325,40408],"source":" If `lpszName` is not closed or is not available for exclusive use, an error occurs."},{"content":"This member function attempts to repair a database that was marked as possibly corrupt by an incomplete write operation.","pos":[40415,40535]},{"content":"This can occur if an application using the Microsoft Jet database engine is closed unexpectedly because of a power outage or computer hardware problem.","pos":[40536,40687]},{"content":"If you complete the operation and call the <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__close)</ept> member function or you quit the application in a usual way, the database will not be marked as possibly corrupt.","pos":[40688,40914],"source":" If you complete the operation and call the [Close](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__close) member function or you quit the application in a usual way, the database will not be marked as possibly corrupt."},{"pos":[40922,41124],"content":"[!NOTE]\n After repairing a database, it is also a good idea to compact it using the [CompactDatabase](#cdaoworkspace__compactdatabase) member function to defragment the file and to recover disk space.","leadings":["","> "],"nodes":[{"content":"After repairing a database, it is also a good idea to compact it using the <bpt id=\"p1\">[</bpt>CompactDatabase<ept id=\"p1\">](#cdaoworkspace__compactdatabase)</ept> member function to defragment the file and to recover disk space.","pos":[9,200],"source":" After repairing a database, it is also a good idea to compact it using the [CompactDatabase](#cdaoworkspace__compactdatabase) member function to defragment the file and to recover disk space."}]},{"content":"For more information about repairing databases, see the topic \"RepairDatabase Method\" in DAO Help.","pos":[41131,41229]},{"pos":[41239,41302],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__rollback\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::Rollback","linkify":"<a name=\"cdaoworkspace__rollback\"></a>  CDaoWorkspace::Rollback","source":"<a name=\"cdaoworkspace__rollback\"></a>  CDaoWorkspace::Rollback"},{"content":"Call this member function to end the current transaction and restore all databases in the workspace to their condition before the transaction was begun.","pos":[41306,41458]},{"pos":[41500,41507],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[41515,41836],"content":"[!CAUTION]\n Within one workspace object, transactions are always global to the workspace and are not limited to only one database or recordset. If you perform operations on more than one database or recordset within a workspace transaction, **Rollback** restores all operations on all of those databases and recordsets.","leadings":["","> "],"nodes":[{"content":" Within one workspace object, transactions are always global to the workspace and are not limited to only one database or recordset. If you perform operations on more than one database or recordset within a workspace transaction, **Rollback** restores all operations on all of those databases and recordsets.","pos":[11,319],"nodes":[{"content":"Within one workspace object, transactions are always global to the workspace and are not limited to only one database or recordset.","pos":[1,132]},{"content":"If you perform operations on more than one database or recordset within a workspace transaction, <bpt id=\"p1\">**</bpt>Rollback<ept id=\"p1\">**</ept> restores all operations on all of those databases and recordsets.","pos":[133,308],"source":" If you perform operations on more than one database or recordset within a workspace transaction, **Rollback** restores all operations on all of those databases and recordsets."}]}]},{"content":"If you close a workspace object without saving or rolling back any pending transactions, the transactions are automatically rolled back.","pos":[41843,41979]},{"content":"If you call <bpt id=\"p1\">[</bpt>CommitTrans<ept id=\"p1\">](#cdaoworkspace__committrans)</ept> or <bpt id=\"p2\">**</bpt>Rollback<ept id=\"p2\">**</ept> without first calling <bpt id=\"p3\">[</bpt>BeginTrans<ept id=\"p3\">](#cdaoworkspace__begintrans)</ept>, an error occurs.","pos":[41980,42131],"source":" If you call [CommitTrans](#cdaoworkspace__committrans) or **Rollback** without first calling [BeginTrans](#cdaoworkspace__begintrans), an error occurs."},{"pos":[42139,42762],"content":"[!NOTE]\n When you begin a transaction, the database engine records its operations in a file kept in the directory specified by the TEMP environment variable on the workstation. If the transaction log file exhausts the available storage on your TEMP drive, the database engine will cause MFC to throw a `CDaoException` (DAO error 2004). At this point, if you call **CommitTrans**, an indeterminate number of operations are committed but the remaining uncompleted operations are lost, and the operation has to be restarted. Calling **Rollback** releases the transaction log and rolls back all operations in the transaction.","leadings":["","> "],"nodes":[{"content":" When you begin a transaction, the database engine records its operations in a file kept in the directory specified by the TEMP environment variable on the workstation. If the transaction log file exhausts the available storage on your TEMP drive, the database engine will cause MFC to throw a `CDaoException` (DAO error 2004). At this point, if you call **CommitTrans**, an indeterminate number of operations are committed but the remaining uncompleted operations are lost, and the operation has to be restarted. Calling **Rollback** releases the transaction log and rolls back all operations in the transaction.","pos":[8,621],"nodes":[{"content":"When you begin a transaction, the database engine records its operations in a file kept in the directory specified by the TEMP environment variable on the workstation.","pos":[1,168]},{"content":"If the transaction log file exhausts the available storage on your TEMP drive, the database engine will cause MFC to throw a <ph id=\"ph1\">`CDaoException`</ph> (DAO error 2004).","pos":[169,327],"source":" If the transaction log file exhausts the available storage on your TEMP drive, the database engine will cause MFC to throw a `CDaoException` (DAO error 2004)."},{"content":"At this point, if you call <bpt id=\"p1\">**</bpt>CommitTrans<ept id=\"p1\">**</ept>, an indeterminate number of operations are committed but the remaining uncompleted operations are lost, and the operation has to be restarted.","pos":[328,513],"source":" At this point, if you call **CommitTrans**, an indeterminate number of operations are committed but the remaining uncompleted operations are lost, and the operation has to be restarted."},{"content":"Calling <bpt id=\"p1\">**</bpt>Rollback<ept id=\"p1\">**</ept> releases the transaction log and rolls back all operations in the transaction.","pos":[514,613],"source":" Calling **Rollback** releases the transaction log and rolls back all operations in the transaction."}]}]},{"pos":[42772,42855],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__setdefaultpassword\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::SetDefaultPassword","linkify":"<a name=\"cdaoworkspace__setdefaultpassword\"></a>  CDaoWorkspace::SetDefaultPassword","source":"<a name=\"cdaoworkspace__setdefaultpassword\"></a>  CDaoWorkspace::SetDefaultPassword"},{"content":"Call this member function to set the default password that the database engine uses when a workspace object is created without a specific password.","pos":[42859,43006]},{"pos":[43092,43102],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The default password.","pos":[43124,43145]},{"content":"A password can be up to 14 characters long and can contain any character except ASCII 0 (null).","pos":[43146,43241]},{"content":"Passwords are case-sensitive.","pos":[43242,43271]},{"pos":[43281,43288],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The default password that you set applies to new workspaces you create after the call.","pos":[43292,43378]},{"content":"When you create subsequent workspaces, you do not need to specify a password in the <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoworkspace__create)</ept> call.","pos":[43379,43501],"source":" When you create subsequent workspaces, you do not need to specify a password in the [Create](#cdaoworkspace__create) call."},{"content":"To use this member function:","pos":[43508,43536]},{"pos":[43546,43608],"content":"Construct a <ph id=\"ph1\">`CDaoWorkspace`</ph> object but do not call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>.","source":"Construct a `CDaoWorkspace` object but do not call **Create**."},{"pos":[43618,43711],"content":"Call <ph id=\"ph1\">`SetDefaultPassword`</ph> and, if you like, <bpt id=\"p1\">[</bpt>SetDefaultUser<ept id=\"p1\">](#cdaoworkspace__setdefaultuser)</ept>.","source":"Call `SetDefaultPassword` and, if you like, [SetDefaultUser](#cdaoworkspace__setdefaultuser)."},{"pos":[43721,43813],"content":"Call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> for this workspace object or subsequent ones, without specifying a password.","source":"Call **Create** for this workspace object or subsequent ones, without specifying a password."},{"content":"By default, the DefaultUser property is set to \"admin\" and the DefaultPassword property is set to an empty string (\"\").","pos":[43820,43939]},{"content":"For more about security, see the topic \"Permissions Property\" in DAO Help.","pos":[43946,44020]},{"content":"For related information, see the topics \"DefaultPassword Property\" and \"DefaultUser Property\" in DAO Help.","pos":[44021,44127]},{"pos":[44137,44212],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__setdefaultuser\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::SetDefaultUser","linkify":"<a name=\"cdaoworkspace__setdefaultuser\"></a>  CDaoWorkspace::SetDefaultUser","source":"<a name=\"cdaoworkspace__setdefaultuser\"></a>  CDaoWorkspace::SetDefaultUser"},{"content":"Call this member function to set the default user name that the database engine uses when a workspace object is created without a specific user name.","pos":[44216,44365]},{"pos":[44450,44460],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The default user name.","pos":[44485,44507]},{"content":"A user name can be 1 – 20 characters long and include alphabetic characters, accented characters, numbers, spaces, and symbols except for: \" (quotation marks), / (forward slash), \\ (backslash), <ph id=\"ph1\">\\[</ph> <ph id=\"ph2\">\\]</ph> (brackets), : (colon), &amp;#124; (pipe), <ph id=\"ph3\">\\&lt;</ph> (less-than sign), &gt; (greater-than sign), + (plus sign), = (equal sign), ; (semicolon), , ( comma),  (question mark), * (asterisk), leading spaces, and control characters (ASCII 00 to ASCII 31).","pos":[44508,44942],"source":" A user name can be 1 – 20 characters long and include alphabetic characters, accented characters, numbers, spaces, and symbols except for: \" (quotation marks), / (forward slash), \\ (backslash), \\[ \\] (brackets), : (colon), &#124; (pipe), \\< (less-than sign), > (greater-than sign), + (plus sign), = (equal sign), ; (semicolon), , ( comma),  (question mark), * (asterisk), leading spaces, and control characters (ASCII 00 to ASCII 31)."},{"content":"For related information, see the topic \"UserName Property\" in DAO Help.","pos":[44943,45014]},{"pos":[45024,45031],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The default user name that you set applies to new workspaces you create after the call.","pos":[45035,45122]},{"content":"When you create subsequent workspaces, you do not need to specify a user name in the <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoworkspace__create)</ept> call.","pos":[45123,45246],"source":" When you create subsequent workspaces, you do not need to specify a user name in the [Create](#cdaoworkspace__create) call."},{"content":"To use this member function:","pos":[45253,45281]},{"pos":[45291,45353],"content":"Construct a <ph id=\"ph1\">`CDaoWorkspace`</ph> object but do not call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>.","source":"Construct a `CDaoWorkspace` object but do not call **Create**."},{"pos":[45363,45460],"content":"Call <ph id=\"ph1\">`SetDefaultUser`</ph> and, if you like, <bpt id=\"p1\">[</bpt>SetDefaultPassword<ept id=\"p1\">](#cdaoworkspace__setdefaultpassword)</ept>.","source":"Call `SetDefaultUser` and, if you like, [SetDefaultPassword](#cdaoworkspace__setdefaultpassword)."},{"pos":[45470,45563],"content":"Call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> for this workspace object or subsequent ones, without specifying a user name.","source":"Call **Create** for this workspace object or subsequent ones, without specifying a user name."},{"content":"By default, the DefaultUser property is set to \"admin\" and the DefaultPassword property is set to an empty string (\"\").","pos":[45570,45689]},{"content":"For related information, see the topics \"DefaultUser Property\" and \"DefaultPassword Property\" in DAO Help.","pos":[45696,45802]},{"pos":[45812,45879],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__setinipath\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::SetIniPath","linkify":"<a name=\"cdaoworkspace__setinipath\"></a>  CDaoWorkspace::SetIniPath","source":"<a name=\"cdaoworkspace__setinipath\"></a>  CDaoWorkspace::SetIniPath"},{"content":"Call this member function to specify the location of Windows registry settings for the Microsoft Jet database engine.","pos":[45883,46000]},{"pos":[46084,46094],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>lpszRegistrySubkey<ept id=\"p1\">*</ept>","pos":[46098,46118],"source":"*lpszRegistrySubkey*"},{"content":"A string containing the name of a Windows registry subkey for the location of Microsoft Jet database engine settings or parameters needed for installable ISAM databases.","pos":[46122,46291]},{"pos":[46301,46308],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call <ph id=\"ph1\">`SetIniPath`</ph> only if you need to specify special settings.","pos":[46312,46375],"source":"Call `SetIniPath` only if you need to specify special settings."},{"content":"For more information, see the topic \"IniPath Property\" in DAO Help.","pos":[46376,46443]},{"pos":[46451,46665],"content":"[!NOTE]\n Call `SetIniPath` during application installation, not when the application runs. `SetIniPath` must be called before you open any workspaces, databases, or recordsets; otherwise, MFC throws an exception.","leadings":["","> "],"nodes":[{"content":" Call `SetIniPath` during application installation, not when the application runs. `SetIniPath` must be called before you open any workspaces, databases, or recordsets; otherwise, MFC throws an exception.","pos":[8,212],"nodes":[{"content":"Call <ph id=\"ph1\">`SetIniPath`</ph> during application installation, not when the application runs.","pos":[1,82],"source":" Call `SetIniPath` during application installation, not when the application runs."},{"content":"<ph id=\"ph1\">`SetIniPath`</ph> must be called before you open any workspaces, databases, or recordsets; otherwise, MFC throws an exception.","pos":[83,204],"source":"`SetIniPath` must be called before you open any workspaces, databases, or recordsets; otherwise, MFC throws an exception."}]}]},{"content":"You can use this mechanism to configure the database engine with user-provided registry settings.","pos":[46672,46769]},{"content":"The scope of this attribute is limited to your application and cannot be changed without restarting your application.","pos":[46770,46887]},{"pos":[46897,46982],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__setisolateodbctrans\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::SetIsolateODBCTrans","linkify":"<a name=\"cdaoworkspace__setisolateodbctrans\"></a>  CDaoWorkspace::SetIsolateODBCTrans","source":"<a name=\"cdaoworkspace__setisolateodbctrans\"></a>  CDaoWorkspace::SetIsolateODBCTrans"},{"content":"Call this member function to set the value of the DAO IsolateODBCTrans property for the workspace.","pos":[46986,47084]},{"pos":[47159,47169],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>bIsolateODBCTrans<ept id=\"p1\">*</ept>","pos":[47173,47192],"source":"*bIsolateODBCTrans*"},{"content":"Pass <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if you want to begin isolating ODBC transactions.","pos":[47196,47259],"source":" Pass **TRUE** if you want to begin isolating ODBC transactions."},{"content":"Pass <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> if you want to stop isolating ODBC transactions.","pos":[47260,47323],"source":" Pass **FALSE** if you want to stop isolating ODBC transactions."},{"pos":[47333,47340],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In some situations, you might need to have multiple simultaneous transactions pending on the same ODBC database.","pos":[47344,47456]},{"content":"To do this, you need to open a separate workspace for each transaction.","pos":[47457,47528]},{"content":"Although each workspace can have its own ODBC connection to the database, this slows system performance.","pos":[47529,47633]},{"content":"Because transaction isolation is not normally required, ODBC connections from multiple workspace objects opened by the same user are shared by default.","pos":[47634,47785]},{"content":"Some ODBC servers, such as Microsoft SQL Server, do not allow simultaneous transactions on a single connection.","pos":[47792,47903]},{"content":"If you need to have more than one transaction at a time pending against such a database, set the IsolateODBCTrans property to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> on each workspace as soon as you open it.","pos":[47904,48080],"source":" If you need to have more than one transaction at a time pending against such a database, set the IsolateODBCTrans property to **TRUE** on each workspace as soon as you open it."},{"content":"This forces a separate ODBC connection for each workspace.","pos":[48081,48139]},{"pos":[48149,48226],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoworkspace__setlogintimeout\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoWorkspace::SetLoginTimeout","linkify":"<a name=\"cdaoworkspace__setlogintimeout\"></a>  CDaoWorkspace::SetLoginTimeout","source":"<a name=\"cdaoworkspace__setlogintimeout\"></a>  CDaoWorkspace::SetLoginTimeout"},{"content":"Call this member function to set the value of the DAO LoginTimeout property for the workspace.","pos":[48230,48324]},{"pos":[48401,48411],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The number of seconds before an error occurs when you attempt to log in to an ODBC database.","pos":[48429,48521]},{"pos":[48531,48538],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This value represents the number of seconds before an error occurs when you attempt to log in to an ODBC database.","pos":[48542,48656]},{"content":"The default LoginTimeout setting is 20 seconds.","pos":[48657,48704]},{"content":"When LoginTimeout is set to 0, no timeout occurs and the communication with the data source might stop responding.","pos":[48705,48819]},{"content":"When you are attempting to log in to an ODBC database, such as Microsoft SQL Server, the connection may fail as a result of network errors or because the server is not running.","pos":[48826,49002]},{"content":"Rather than waiting for the default 20 seconds to connect, you can specify how long the database engine waits before it produces an error.","pos":[49003,49141]},{"content":"Logging on to the server happens implicitly as part of a number of different events, such as running a query on an external server database.","pos":[49142,49282]},{"content":"The timeout value is determined by the current setting of the LoginTimeout property.","pos":[49283,49367]},{"content":"For related information, see the topic \"LoginTimeout Property\" in DAO Help.","pos":[49374,49449]},{"pos":[49458,49466],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CObject Class<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[49470,49524],"source":"[CObject Class](../../mfc/reference/cobject-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[49527,49576],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDaoDatabase Class<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[49579,49644],"source":" [CDaoDatabase Class](../../mfc/reference/cdaodatabase-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDaoRecordset Class<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[49647,49714],"source":" [CDaoRecordset Class](../../mfc/reference/cdaorecordset-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDaoTableDef Class<ept id=\"p1\">](../../mfc/reference/cdaotabledef-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[49717,49782],"source":" [CDaoTableDef Class](../../mfc/reference/cdaotabledef-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDaoQueryDef Class<ept id=\"p1\">](../../mfc/reference/cdaoquerydef-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[49785,49850],"source":" [CDaoQueryDef Class](../../mfc/reference/cdaoquerydef-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDaoException Class<ept id=\"p1\">](../../mfc/reference/cdaoexception-class.md)</ept>","pos":[49853,49919],"source":" [CDaoException Class](../../mfc/reference/cdaoexception-class.md)"}],"content":"---\ntitle: \"CDaoWorkspace Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDaoWorkspace\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DAO workspaces [C++]\"\n  - \"transaction spaces [C++], DAO workspace\"\n  - \"ODBC classes [C++], vs. DAO classes\"\n  - \"default workspaces [C++], DAO\"\n  - \"workspaces [C++], DAO\"\n  - \"sessions [C++], DAO workspace\"\n  - \"Workspace class\"\n  - \"CDaoWorkspace class\"\n  - \"workspaces [C++], interface to database engine\"\n  - \"Workspaces collection\"\n  - \"persistence [C++], DAO workspace\"\n  - \"workspaces [C++], default\"\n  - \"defaults [C++], workspaces\"\n  - \"DAO workspaces [C++], CDaoWorkspace class\"\n  - \"security [MFC], DAO workspaces\"\n  - \"security [MFC]\"\n  - \"database engine [C++], accessing via workspace\"\n  - \"transaction spaces [C++]\"\n  - \"DDLs [C++]\"\n  - \"workspaces [C++], persistence\"\n  - \"default workspaces [C++]\"\nms.assetid: 64f60de6-4df1-4d4a-a65b-c489b5257d52\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDaoWorkspace Class\nManages a named, password-protected database session from login to logoff, by a single user.  \n  \n## Syntax  \n  \n```  \nclass CDaoWorkspace : public CObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoWorkspace::CDaoWorkspace](#cdaoworkspace__cdaoworkspace)|Constructs a workspace object. Afterwards, call **Create** or **Open**.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoWorkspace::Append](#cdaoworkspace__append)|Appends a newly created workspace to the database engine's Workspaces collection.|  \n|[CDaoWorkspace::BeginTrans](#cdaoworkspace__begintrans)|Begins a new transaction, which applies to all databases open in the workspace.|  \n|[CDaoWorkspace::Close](#cdaoworkspace__close)|Closes the workspace and all of the objects it contains. Pending transactions are rolled back.|  \n|[CDaoWorkspace::CommitTrans](#cdaoworkspace__committrans)|Completes the current transaction and saves the changes.|  \n|[CDaoWorkspace::CompactDatabase](#cdaoworkspace__compactdatabase)|Compacts (or duplicates) a database.|  \n|[CDaoWorkspace::Create](#cdaoworkspace__create)|Creates a new DAO workspace object.|  \n|[CDaoWorkspace::GetDatabaseCount](#cdaoworkspace__getdatabasecount)|Returns the number of DAO database objects in the workspace's Databases collection.|  \n|[CDaoWorkspace::GetDatabaseInfo](#cdaoworkspace__getdatabaseinfo)|Returns information about a specified DAO database defined in the workspace's Databases collection.|  \n|[CDaoWorkspace::GetIniPath](#cdaoworkspace__getinipath)|Returns the location of the Microsoft Jet database engine's initialization settings in the Windows registry.|  \n|[CDaoWorkspace::GetIsolateODBCTrans](#cdaoworkspace__getisolateodbctrans)|Returns a value that indicates whether multiple transactions that involve the same ODBC data source are isolated via forced multiple connections to the data source.|  \n|[CDaoWorkspace::GetLoginTimeout](#cdaoworkspace__getlogintimeout)|Returns the number of seconds before an error occurs when the user attempts to log in to an ODBC database.|  \n|[CDaoWorkspace::GetName](#cdaoworkspace__getname)|Returns the user-defined name for the workspace object.|  \n|[CDaoWorkspace::GetUserName](#cdaoworkspace__getusername)|Returns the user name specified when the workspace was created. This is the name of the workspace owner.|  \n|[CDaoWorkspace::GetVersion](#cdaoworkspace__getversion)|Returns a string that contains the version of the database engine associated with the workspace.|  \n|[CDaoWorkspace::GetWorkspaceCount](#cdaoworkspace__getworkspacecount)|Returns the number of DAO workspace objects in the database engine's Workspaces collection.|  \n|[CDaoWorkspace::GetWorkspaceInfo](#cdaoworkspace__getworkspaceinfo)|Returns information about a specified DAO workspace defined in the database engine's Workspaces collection.|  \n|[CDaoWorkspace::Idle](#cdaoworkspace__idle)|Allows the database engine to perform background tasks.|  \n|[CDaoWorkspace::IsOpen](#cdaoworkspace__isopen)|Returns nonzero if the workspace is open.|  \n|[CDaoWorkspace::Open](#cdaoworkspace__open)|Explicitly opens a workspace object associated with DAO's default workspace.|  \n|[CDaoWorkspace::RepairDatabase](#cdaoworkspace__repairdatabase)|Attempts to repair a damaged database.|  \n|[CDaoWorkspace::Rollback](#cdaoworkspace__rollback)|Ends the current transaction and does not save the changes.|  \n|[CDaoWorkspace::SetDefaultPassword](#cdaoworkspace__setdefaultpassword)|Sets the password that the database engine uses when a workspace object is created without a specific password.|  \n|[CDaoWorkspace::SetDefaultUser](#cdaoworkspace__setdefaultuser)|Sets the user name that the database engine uses when a workspace object is created without a specific user name.|  \n|[CDaoWorkspace::SetIniPath](#cdaoworkspace__setinipath)|Sets the location of the Microsoft Jet database engine's initialization settings in the Windows registry.|  \n|[CDaoWorkspace::SetIsolateODBCTrans](#cdaoworkspace__setisolateodbctrans)|Specifies whether multiple transactions that involve the same ODBC data source are isolated by forcing multiple connections to the data source.|  \n|[CDaoWorkspace::SetLoginTimeout](#cdaoworkspace__setlogintimeout)|Sets the number of seconds before an error occurs when the user attempts to log in to an ODBC data source.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoWorkspace::m_pDAOWorkspace](#cdaoworkspace__m_pdaoworkspace)|Points to the underlying DAO workspace object.|  \n  \n## Remarks  \n In most cases, you will not need multiple workspaces, and you will not need to create explicit workspace objects; when you open database and recordset objects, they use DAO's default workspace. However, if needed, you can run multiple sessions at a time by creating additional workspace objects. Each workspace object can contain multiple open database objects in its own Databases collection. In MFC, a workspace is primarily a transaction manager, specifying a set of open databases all in the same \"transaction space.\"  \n  \n> [!NOTE]\n>  The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have a \"CDao\" prefix. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC. The DAO-based classes access data through the Microsoft Jet database engine, including ODBC drivers. They also support Data Definition Language (DDL) operations, such as creating databases and adding tables and fields via the classes, without having to call DAO directly.  \n  \n## Capabilities  \n Class `CDaoWorkspace` provides the following:  \n  \n-   Explicit access, if needed, to a default workspace, created by initializing the database engine. Usually you use DAO's default workspace implicitly by creating database and recordset objects.  \n  \n-   A transaction space in which transactions apply to all databases open in the workspace. You can create additional workspaces to manage separate transaction spaces.  \n  \n-   An interface to many properties of the underlying Microsoft Jet database engine (see the static member functions). Opening or creating a workspace, or calling a static member function before open or create, initializes the database engine.  \n  \n-   Access to the database engine's Workspaces collection, which stores all active workspaces that have been appended to it. You can also create and work with workspaces without appending them to the collection.  \n  \n## Security  \n MFC does not implement the Users and Groups collections in DAO, which are used for security control. If you need those aspects of DAO, you must program them yourself via direct calls to DAO interfaces. For information, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  \n  \n## Usage  \n You can use class `CDaoWorkspace` to:  \n  \n-   Explicitly open the default workspace.  \n  \n     Usually your use of the default workspace is implicit — when you open new [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) or [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) objects. But you might need to access it explicitly — for example, to access database engine properties or the Workspaces collection. See \"Implicit Use of the Default Workspace\" below.  \n  \n-   Create new workspaces. Call [Append](#cdaoworkspace__append) if you want to add them to the Workspaces collection.  \n  \n-   Open an existing workspace in the Workspaces collection.  \n  \n Creating a new workspace that does not already exist in the Workspaces collection is described under the [Create](#cdaoworkspace__create) member function. Workspace objects do not persist in any way between datababase engine sessions. If your application links MFC statically, ending the application uninitializes the database engine. If your application links with MFC dynamically, the database engine is uninitialized when the MFC DLL is unloaded.  \n  \n Explicitly opening the default workspace, or opening an existing workspace in the Workspaces collection, is described under the [Open](#cdaoworkspace__open) member function.  \n  \n End a workspace session by closing the workspace with the [Close](#cdaoworkspace__close) member function. **Close** closes any databases you have not closed previously, rolling back any uncommitted transactions.  \n  \n## Transactions  \n DAO manages transactions at the workspace level; hence, transactions on a workspace with multiple open databases apply to all of the databases. For example, if two databases have uncommitted updates and you call [CommitTrans](#cdaoworkspace__committrans), all of the updates are committed. If you want to limit transactions to a single database, you need a separate workspace object for it.  \n  \n## Implicit Use of the Default Workspace  \n MFC uses DAO's default workspace implicitly under the following circumstances:  \n  \n-   If you create a new `CDaoDatabase` object but do not do so through an existing `CDaoWorkspace` object, MFC creates a temporary workspace object for you, which corresponds to DAO's default workspace. If you do so for multiple databases, all of the database objects are associated with the default workspace. You can access a database's workspace through a `CDaoDatabase` data member.  \n  \n-   Similarly, if you create a `CDaoRecordset` object without supplying a pointer to a `CDaoDatabase` object, MFC creates a temporary database object and, by extension, a temporary workspace object. You can access a recordset's database, and indirectly its workspace, through a `CDaoRecordset` data member.  \n  \n## Other Operations  \n Other database operations are also provided, such as repairing a corrupted database or compacting a database.  \n  \n For information about calling DAO directly and about DAO security, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n `CDaoWorkspace`  \n  \n## Requirements  \n **Header:** afxdao.h  \n  \n##  <a name=\"cdaoworkspace__append\"></a>  CDaoWorkspace::Append  \n Call this member function after you call [Create](#cdaoworkspace__create).  \n  \n```  \nvirtual void Append();\n```  \n  \n### Remarks  \n **Append** appends a newly created workspace object to the database engine's Workspaces collection. Workspaces do not persist between database engine sessions; they are stored only in memory, not on disk. You do not have to append a workspace; if you do not, you can still use it.  \n  \n An appended workspace remains in the Workspaces collection, in an active, open state, until you call its [Close](#cdaoworkspace__close) member function.  \n  \n For related information, see the topic \"Append Method\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__begintrans\"></a>  CDaoWorkspace::BeginTrans  \n Call this member function to initiate a transaction.  \n  \n```  \nvoid BeginTrans();\n```  \n  \n### Remarks  \n After you call **BeginTrans**, updates you make to your data or database structure take effect when you commit the transaction. Because the workspace defines a single transaction space, the transaction applies to all open databases in the workspace. There are two ways to complete the transaction:  \n  \n-   Call the [CommitTrans](#cdaoworkspace__committrans) member function to commit the transaction and save changes to the data source.  \n  \n-   Or call the [Rollback](#cdaoworkspace__rollback) member function to cancel the transaction.  \n  \n Closing the workspace object or a database object while a transaction is pending rolls back all pending transactions.  \n  \n If you need to isolate transactions on one ODBC data source from those on another ODBC data source, see the [SetIsolateODBCTrans](#cdaoworkspace__setisolateodbctrans) member function.  \n  \n##  <a name=\"cdaoworkspace__cdaoworkspace\"></a>  CDaoWorkspace::CDaoWorkspace  \n Constructs a `CDaoWorkspace` object.  \n  \n```  \nCDaoWorkspace();\n```  \n  \n### Remarks  \n After constructing the C++ object, you have two options:  \n  \n-   Call the object's [Open](#cdaoworkspace__open) member function to open the default workspace or to open an existing object in the Workspaces collection.  \n  \n-   Or call the object's [Create](#cdaoworkspace__create) member function to create a new DAO workspace object. This explicitly starts a new workspace session, which you can refer to via the `CDaoWorkspace` object. After calling **Create**, you can call [Append](#cdaoworkspace__append) if you want to add the workspace to the database engine's Workspaces collection.  \n  \n See the class overview for [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) for information about when you need to explicitly create a `CDaoWorkspace` object. Usually, you use workspaces created implicitly when you open a [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object without specifying a workspace or when you open a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object without specifying a database object. MFC DAO objects created in this way use DAO's default workspace, which is created once and reused.  \n  \n To release a workspace and its contained objects, call the workspace object's [Close](#cdaoworkspace__close) member function.  \n  \n##  <a name=\"cdaoworkspace__close\"></a>  CDaoWorkspace::Close  \n Call this member function to close the workspace object.  \n  \n```  \nvirtual void Close();\n```  \n  \n### Remarks  \n Closing an open workspace object releases the underlying DAO object and, if the workspace is a member of the Workspaces collection, removes it from the collection. Calling **Close** is good programming practice.  \n  \n> [!CAUTION]\n>  Closing a workspace object closes any open databases in the workspace. This results in any recordsets open in the databases being closed as well, and any pending edits or updates are rolled back. For related information, see the [CDaoDatabase::Close](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__close), [CDaoRecordset::Close](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__close), [CDaoTableDef::Close](../../mfc/reference/cdaotabledef-class.md#cdaotabledef__close), and [CDaoQueryDef::Close](../../mfc/reference/cdaoquerydef-class.md#cdaoquerydef__close) member functions.  \n  \n Workspace objects are not permanent; they only exist while references to them exist. This means that when the database engine session ends, the workspace and its Databases collection do not persist. You must re-create them for the next session by opening your workspace and database(s) again.  \n  \n For related information, see the topic \"Close Method\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__committrans\"></a>  CDaoWorkspace::CommitTrans  \n Call this member function to commit a transaction — save a group of edits and updates to one or more databases in the workspace.  \n  \n```  \nvoid CommitTrans();\n```  \n  \n### Remarks  \n A transaction consists of a series of changes to the database's data or its structure, beginning with a call to [BeginTrans](#cdaoworkspace__begintrans). When you complete the transaction, either commit it or roll it back (cancel the changes) with [Rollback](#cdaoworkspace__rollback). By default, without transactions, updates to records are committed immediately. Calling **BeginTrans** causes commitment of updates to be delayed until you call **CommitTrans**.  \n  \n> [!CAUTION]\n>  Within one workspace, transactions are always global to the workspace and are not limited to only one database or recordset. If you perform operations on more than one database or recordset within a workspace transaction, **CommitTrans** commits all pending updates, and **Rollback** restores all operations on those databases and recordsets.  \n  \n When you close a database or workspace with pending transactions, the transactions are all rolled back.  \n  \n> [!NOTE]\n>  This is not a two-phase commit mechanism. If one update fails to commit, others still will commit.  \n  \n##  <a name=\"cdaoworkspace__compactdatabase\"></a>  CDaoWorkspace::CompactDatabase  \n Call this member function to compact a specified Microsoft Jet (.MDB) database.  \n  \n```  \nstatic void PASCAL CompactDatabase(\n    LPCTSTR lpszSrcName,  \n    LPCTSTR lpszDestName,  \n    LPCTSTR lpszLocale = dbLangGeneral,  \n    int nOptions = 0);\n\n \nstatic void PASCAL CompactDatabase(\n    LPCTSTR lpszSrcName,  \n    LPCTSTR lpszDestName,  \n    LPCTSTR lpszLocale,  \n    int nOptions,  \n    LPCTSTR lpszPassword);\n```  \n  \n### Parameters  \n `lpszSrcName`  \n The name of an existing, closed database. It can be a full path and filename, such as \"C:\\\\\\MYDB.MDB\". If the filename has an extension, you must specify it. If your network supports the uniform naming convention (UNC), you can also specify a network path, such as \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB.MDB\". (Double backslashes are required in the path strings because \"\\\\\" is the C++ escape character.)  \n  \n `lpszDestName`  \n The full path of the compacted database that you are creating. You can also specify a network path as with `lpszSrcName`. You cannot use the `lpszDestName` argument to specify the same database file as `lpszSrcName`.  \n  \n `lpszPassword`  \n A password, used when you want to compact a password-protected database. Note that if you use the version of `CompactDatabase` that takes a password, you must supply all parameters. Also, because this is a connect parameter, it requires special formatting, as follows: ;PWD= `lpszPassword`. For example: ;PWD=\"Happy\". (The leading semicolon is required.)  \n  \n `lpszLocale`  \n A string expression used to specify collating order for creating `lpszDestName`. If you omit this argument by accepting the default value of **dbLangGeneral** (see below), the locale of the new database is the same as that of the old database. Possible values are:  \n  \n- **dbLangGeneral** English, German, French, Portuguese, Italian, and Modern Spanish  \n  \n- **dbLangArabic** Arabic  \n  \n- **dbLangCyrillic** Russian  \n  \n- **dbLangCzech** Czech  \n  \n- **dbLangDutch** Dutch  \n  \n- **dbLangGreek** Greek  \n  \n- **dbLangHebrew** Hebrew  \n  \n- **dbLangHungarian** Hungarian  \n  \n- **dbLangIcelandic** Icelandic  \n  \n- **dbLangNordic** Nordic languages (Microsoft Jet database engine version 1.0 only)  \n  \n- **dbLangNorwdan** Norwegian and Danish  \n  \n- **dbLangPolish** Polish  \n  \n- **dbLangSpanish** Traditional Spanish  \n  \n- **dbLangSwedfin** Swedish and Finnish  \n  \n- **dbLangTurkish** Turkish  \n  \n `nOptions`  \n Indicates one or more options for the target database, `lpszDestName`. If you omit this argument by accepting the default value, the `lpszDestName` will have the same encryption and the same version as `lpszSrcName`. You can combine the **dbEncrypt** or **dbDecrypt** option with one of the version options using the bitwise-OR operator. Possible values, which specify a database format, not a database engine version, are:  \n  \n- **dbEncrypt** Encrypt the database while compacting.  \n  \n- **dbDecrypt** Decrypt the database while compacting.  \n  \n- **dbVersion10** Create a database that uses the Microsoft Jet database engine version 1.0 while compacting.  \n  \n- **dbVersion11** Create a database that uses the Microsoft Jet database engine version 1.1 while compacting.  \n  \n- **dbVersion20** Create a database that uses the Microsoft Jet database engine version 2.0 while compacting.  \n  \n- **dbVersion30** Create a database that uses the Microsoft Jet database engine version 3.0 while compacting.  \n  \n You can use **dbEncrypt** or **dbDecrypt** in the options argument to specify whether to encrypt or to decrypt the database as it is compacted. If you omit an encryption constant or if you include both **dbDecrypt** and **dbEncrypt**, `lpszDestName` will have the same encryption as `lpszSrcName`. You can use one of the version constants in the options argument to specify the version of the data format for the compacted database. This constant affects only the version of the data format of `lpszDestName`. You can specify only one version constant. If you omit a version constant, `lpszDestName` will have the same version as `lpszSrcName`. You can compact `lpszDestName` only to a version that is the same or later than that of `lpszSrcName`.  \n  \n> [!CAUTION]\n>  If a database is not encrypted, it is possible, even if you implement user/password security, to directly read the binary disk file that constitutes the database.  \n  \n### Remarks  \n As you change data in a database, the database file can become fragmented and use more disk space than necessary. Periodically, you should compact your database to defragment the database file. The compacted database is usually smaller. You can also choose to change the collating order, the encryption, or the version of the data format while you copy and compact the database.  \n  \n> [!CAUTION]\n>  The `CompactDatabase` member function will not correctly convert a complete Microsoft Access database from one version to another. Only the data format is converted. Microsoft Access-defined objects, such as forms and reports, are not converted. However, the data is correctly converted.  \n  \n> [!TIP]\n>  You can also use `CompactDatabase` to copy a database file.  \n  \n For more information about compacting databases, see the topic \"CompactDatabase Method\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__create\"></a>  CDaoWorkspace::Create  \n Call this member function to create a new DAO workspace object and associate it with the MFC `CDaoWorkspace` object.  \n  \n```  \nvirtual void Create(\n    LPCTSTR lpszName,  \n    LPCTSTR lpszUserName,  \n    LPCTSTR lpszPassword);\n```  \n  \n### Parameters  \n `lpszName`  \n A string with up to 14 characters that uniquely names the new workspace object. You must supply a name. For related information, see the topic \"Name Property\" in DAO Help.  \n  \n *lpszUserName*  \n The user name of the workspace's owner. For requirements, see the `lpszDefaultUser` parameter to the [SetDefaultUser](#cdaoworkspace__setdefaultuser) member function. For related information, see the topic \"UserName Property\" in DAO Help.  \n  \n `lpszPassword`  \n The password for the new workspace object. A password can be up to 14 characters long and can contain any character except ASCII 0 (null). Passwords are case-sensitive. For related information, see the topic \"Password Property\" in DAO Help.  \n  \n### Remarks  \n The overall creation process is:  \n  \n1.  Construct a [CDaoWorkspace](#cdaoworkspace__cdaoworkspace) object.  \n  \n2.  Call the object's **Create** member function to create the underlying DAO workspace. You must specify a workspace name.  \n  \n3.  Optionally call [Append](#cdaoworkspace__append) if you want to add the workspace to the database engine's Workspaces collection. You can work with the workspace without appending it.  \n  \n After the **Create** call, the workspace object is in an open state, ready for use. You do not call **Open** after **Create**. You do not call **Create** if the workspace already exists in the Workspaces collection. **Create** initializes the database engine if it has not already been initialized for your application.  \n  \n##  <a name=\"cdaoworkspace__getdatabasecount\"></a>  CDaoWorkspace::GetDatabaseCount  \n Call this member function to retrieve the number of DAO database objects in the workspace's Databases collection — the number of open databases in the workspace.  \n  \n```  \nshort GetDatabaseCount();\n```  \n  \n### Return Value  \n The number of open databases in the workspace.  \n  \n### Remarks  \n `GetDatabaseCount` is useful if you need to loop through all defined databases in the workspace's Databases collection. To obtain information about a given database in the collection, see [GetDatabaseInfo](#cdaoworkspace__getdatabaseinfo). Typical usage is to call `GetDatabaseCount` for the number of open databases, then use that number as a loop index for repeated calls to `GetDatabaseInfo`.  \n  \n##  <a name=\"cdaoworkspace__getdatabaseinfo\"></a>  CDaoWorkspace::GetDatabaseInfo  \n Call this member function to obtain various kinds of information about a database open in the workspace.  \n  \n```  \nvoid GetDatabaseInfo(\n    int nIndex,  \n    CDaoDatabaseInfo& dbinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n\n \nvoid GetDatabaseInfo(\n    LPCTSTR lpszName,  \n    CDaoDatabaseInfo& dbinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n```  \n  \n### Parameters  \n `nIndex`  \n The zero-based index of the database object in the workspace's Databases collection, for lookup by index.  \n  \n `dbinfo`  \n A reference to a [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) object that returns the information requested.  \n  \n `dwInfoOptions`  \n Options that specify which information about the database to retrieve. The available options are listed here along with what they cause the function to return:  \n  \n- `AFX_DAO_PRIMARY_INFO` (Default) Name, Updatable, Transactions  \n  \n- `AFX_DAO_SECONDARY_INFO` Primary information plus: Version, Collating Order, Query Timeout  \n  \n- `AFX_DAO_ALL_INFO` Primary and secondary information plus: Connect  \n  \n `lpszName`  \n The name of the database object, for lookup by name. The name is a string with up to 14 characters that uniquely names the new workspace object.  \n  \n### Remarks  \n One version of the function lets you look up a database by index. The other version lets you look up a database by name.  \n  \n For a description of the information returned in `dbinfo`, see the [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) structure. This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`. When you request information at one level, you get information for any prior levels as well.  \n  \n##  <a name=\"cdaoworkspace__getinipath\"></a>  CDaoWorkspace::GetIniPath  \n Call this member function to obtain the location of the Microsoft Jet database engine's initialization settings in the Windows registry.  \n  \n```  \nstatic CString PASCAL GetIniPath();\n```  \n  \n### Return Value  \n A [CString](../../atl-mfc-shared/reference/cstringt-class.md) containing the registry location.  \n  \n### Remarks  \n You can use the location to obtain information about settings for the database engine. The information returned is actually the name of a registry subkey.  \n  \n For related information, see the topics \"IniPath Property\" and \"Customizing Windows Registry Settings for Data Access\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__getisolateodbctrans\"></a>  CDaoWorkspace::GetIsolateODBCTrans  \n Call this member function to get the current value of the DAO IsolateODBCTrans property for the workspace.  \n  \n```  \nBOOL GetIsolateODBCTrans();\n```  \n  \n### Return Value  \n Nonzero if ODBC transactions are isolated; otherwise 0.  \n  \n### Remarks  \n In some situations, you might need to have multiple simultaneous transactions pending on the same ODBC database. To do this, you need to open a separate workspace for each transaction. Keep in mind that although each workspace can have its own ODBC connection to the database, this slows system performance. Because transaction isolation is not normally required, ODBC connections from multiple workspace objects opened by the same user are shared by default.  \n  \n Some ODBC servers, such as Microsoft SQL Server, do not allow simultaneous transactions on a single connection. If you need to have more than one transaction at a time pending against such a database, set the IsolateODBCTrans property to **TRUE** on each workspace as soon as you open it. This forces a separate ODBC connection for each workspace.  \n  \n For related information, see the topic \"IsolateODBCTrans Property\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__getlogintimeout\"></a>  CDaoWorkspace::GetLoginTimeout  \n Call this member function to get the current value of the DAO LoginTimeout property for the workspace.  \n  \n```  \nstatic short PASCAL GetLoginTimeout();\n```  \n  \n### Return Value  \n The number of seconds before an error occurs when you attempt to log in to an ODBC database.  \n  \n### Remarks  \n This value represents the number of seconds before an error occurs when you attempt to log in to an ODBC database. The default LoginTimeout setting is 20 seconds. When LoginTimeout is set to 0, no timeout occurs and the communication with the data source might stop responding.  \n  \n When you are attempting to log in to an ODBC database, such as Microsoft SQL Server, the connection may fail as a result of network errors or because the server is not running. Rather than waiting for the default 20 seconds to connect, you can specify how long the database engine waits before it produces an error. Logging in to the server happens implicitly as part of a number of different events, such as running a query on an external server database.  \n  \n For related information, see the topic \"LoginTimeout Property\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__getname\"></a>  CDaoWorkspace::GetName  \n Call this member function to get the user-defined name of the DAO workspace object underlying the `CDaoWorkspace` object.  \n  \n```  \nCString GetName();\n```  \n  \n### Return Value  \n A [CString](../../atl-mfc-shared/reference/cstringt-class.md) containing the user-defined name of the DAO workspace object.  \n  \n### Remarks  \n The name is useful for accessing the DAO workspace object in the database engine's Workspaces collection by name.  \n  \n For related information, see the topic \"Name Property\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__getusername\"></a>  CDaoWorkspace::GetUserName  \n Call this member function to obtain the name of the owner of the workspace.  \n  \n```  \nCString GetUserName();\n```  \n  \n### Return Value  \n A [CString](../../atl-mfc-shared/reference/cstringt-class.md) that represents the owner of the workspace object.  \n  \n### Remarks  \n To get or set the permissions for the workspace owner, call DAO directly to check the Permissions property setting; this determines what permissions that user has. To work with permissions, you need a SYSTEM.MDA file.  \n  \n For information about calling DAO directly, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md). For related information, see the topic \"UserName Property\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__getversion\"></a>  CDaoWorkspace::GetVersion  \n Call this member function to determine the version of the Microsoft Jet database engine in use.  \n  \n```  \nstatic CString PASCAL GetVersion();\n```  \n  \n### Return Value  \n A [CString](../../atl-mfc-shared/reference/cstringt-class.md) that indicates the version of the database engine associated with the object.  \n  \n### Remarks  \n The value returned represents the version number in the form \"major.minor\"; for example, \"3.0\". The product version number (for example, 3.0) consists of the version number (3), a period, and the release number (0).  \n  \n For related information, see the topic \"Version Property\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__getworkspacecount\"></a>  CDaoWorkspace::GetWorkspaceCount  \n Call this member function to retrieve the number of DAO workspace objects in the database engine's Workspaces collection.  \n  \n```  \nshort GetWorkspaceCount();\n```  \n  \n### Return Value  \n The number of open workspaces in the Workspaces collection.  \n  \n### Remarks  \n This count does not include any open workspaces not appended to the collection. `GetWorkspaceCount` is useful if you need to loop through all defined workspaces in the Workspaces collection. To obtain information about a given workspace in the collection, see [GetWorkspaceInfo](#cdaoworkspace__getworkspaceinfo). Typical usage is to call `GetWorkspaceCount` for the number of open workspaces, then use that number as a loop index for repeated calls to `GetWorkspaceInfo`.  \n  \n##  <a name=\"cdaoworkspace__getworkspaceinfo\"></a>  CDaoWorkspace::GetWorkspaceInfo  \n Call this member function to obtain various kinds of information about a workspace open in the session.  \n  \n```  \nvoid GetWorkspaceInfo(\n    int nIndex,  \n    CDaoWorkspaceInfo& wkspcinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n\n \nvoid GetWorkspaceInfo(\n    LPCTSTR lpszName,  \n    CDaoWorkspaceInfo& wkspcinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n```  \n  \n### Parameters  \n `nIndex`  \n The zero-based index of the database object in the Workspaces collection, for lookup by index.  \n  \n `wkspcinfo`  \n A reference to a [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) object that returns the information requested.  \n  \n `dwInfoOptions`  \n Options that specify which information about the workspace to retrieve. The available options are listed here along with what they cause the function to return:  \n  \n- `AFX_DAO_PRIMARY_INFO` (Default) Name  \n  \n- `AFX_DAO_SECONDARY_INFO` Primary information plus: User Name  \n  \n- `AFX_DAO_ALL_INFO` Primary and secondary information plus: Isolate ODBCTrans  \n  \n `lpszName`  \n The name of the workspace object, for lookup by name. The name is a string with up to 14 characters that uniquely names the new workspace object.  \n  \n### Remarks  \n For a description of the information returned in `wkspcinfo`, see the [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) structure. This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`. When you request information at one level, you get information for prior levels as well.  \n  \n##  <a name=\"cdaoworkspace__idle\"></a>  CDaoWorkspace::Idle  \n Call **Idle** to provide the database engine with the opportunity to perform background tasks that may not be up-to-date because of intense data processing.  \n  \n```  \nstatic void PASCAL Idle(int nAction = dbFreeLocks);\n```  \n  \n### Parameters  \n `nAction`  \n An action to take during the idle processing. Currently the only valid action is **dbFreeLocks**.  \n  \n### Remarks  \n This is often true in multiuser, multitasking environments in which there is not enough background processing time to keep all records in a recordset current.  \n  \n> [!NOTE]\n>  Calling **Idle** is not necessary with databases created with version 3.0 of the Microsoft Jet database engine. Use **Idle** only for databases created with earlier versions.  \n  \n Usually, read locks are removed and data in local dynaset-type recordset objects is updated only when no other actions (including mouse movements) are occurring. If you periodically call **Idle**, you provide the database engine with time to catch up on background processing tasks by releasing unneeded read locks. Specifying the **dbFreeLocks** constant as an argument delays processing until all read locks are released.  \n  \n This member function is not needed in single-user environments unless multiple instances of an application are running. The **Idle** member function may increase performance in a multiuser environment because it forces the database engine to flush data to disk, releasing locks on memory. You can also release read locks by making operations part of a transaction.  \n  \n For related information, see the topic \"Idle Method\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__isopen\"></a>  CDaoWorkspace::IsOpen  \n Call this member function to determine whether the `CDaoWorkspace` object is open — that is, whether the MFC object has been initialized by a call to [Open](#cdaoworkspace__open) or a call to [Create](#cdaoworkspace__create).  \n  \n```  \nBOOL IsOpen() const;\n\n \n```  \n  \n### Return Value  \n Nonzero if the workspace object is open; otherwise 0.  \n  \n### Remarks  \n You can call any of the member functions of a workspace that is in an open state.  \n  \n##  <a name=\"cdaoworkspace__m_pdaoworkspace\"></a>  CDaoWorkspace::m_pDAOWorkspace  \n A pointer to the underlying DAO workspace object.  \n  \n### Remarks  \n Use this data member if you need direct access to the underlying DAO object. You can call the DAO object's interfaces through this pointer.  \n  \n For information about accessing DAO objects directly, see [Technical Note 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).  \n  \n##  <a name=\"cdaoworkspace__open\"></a>  CDaoWorkspace::Open  \n Explicitly opens a workspace object associated with DAO's default workspace.  \n  \n```  \nvirtual void Open(LPCTSTR lpszName = NULL);\n```  \n  \n### Parameters  \n `lpszName`  \n The name of the DAO workspace object to open — a string with up to 14 characters that uniquely names the workspace. Accept the default value **NULL** to explicitly open the default workspace. For naming requirements, see the `lpszName` parameter for [Create](#cdaoworkspace__create). For related information, see the topic \"Name Property\" in DAO Help.  \n  \n### Remarks  \n After constructing a `CDaoWorkspace` object, call this member function to do one of the following:  \n  \n-   Explicitly open the default workspace. Pass **NULL** for `lpszName`.  \n  \n-   Open an existing `CDaoWorkspace` object, a member of the Workspaces collection, by name. Pass a valid name for an existing workspace object.  \n  \n **Open** puts the workspace object into an open state and also initializes the database engine if it has not already been initialized for your application.  \n  \n Although many `CDaoWorkspace` member functions can only be called after the workspace has been opened, the following member functions, which operate on the database engine, are available after construction of the C++ object but before a call to **Open**:  \n  \n||||  \n|-|-|-|  \n|[Create](#cdaoworkspace__create)|[GetVersion](#cdaoworkspace__getversion)|[SetDefaultUser](#cdaoworkspace__setdefaultuser)|  \n|[GetIniPath](#cdaoworkspace__getinipath)|[Idle](#cdaoworkspace__idle)|[SetIniPath](#cdaoworkspace__setinipath)|  \n|[GetLoginTimeout](#cdaoworkspace__getlogintimeout)|[SetDefaultPassword](#cdaoworkspace__setdefaultpassword)|[SetLoginTimeout](#cdaoworkspace__setlogintimeout)|  \n  \n##  <a name=\"cdaoworkspace__repairdatabase\"></a>  CDaoWorkspace::RepairDatabase  \n Call this member function if you need to attempt to repair a corrupted database that accesses the Microsoft Jet database engine.  \n  \n```  \nstatic void PASCAL RepairDatabase(LPCTSTR lpszName);\n```  \n  \n### Parameters  \n `lpszName`  \n The path and filename for an existing Microsoft Jet engine database file. If you omit the path, only the current directory is searched. If your system supports the uniform naming convention (UNC), you can also specify a network path, such as: \"\\\\\\\\\\\\\\MYSERVER\\\\\\MYSHARE\\\\\\MYDIR\\\\\\MYDB.MDB\". (Double backslashes are required in the path string because \"\\\\\" is the C++ escape character.)  \n  \n### Remarks  \n You must close the database specified by `lpszName` before you repair it. In a multiuser environment, other users cannot have `lpszName` open while you are repairing it. If `lpszName` is not closed or is not available for exclusive use, an error occurs.  \n  \n This member function attempts to repair a database that was marked as possibly corrupt by an incomplete write operation. This can occur if an application using the Microsoft Jet database engine is closed unexpectedly because of a power outage or computer hardware problem. If you complete the operation and call the [Close](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__close) member function or you quit the application in a usual way, the database will not be marked as possibly corrupt.  \n  \n> [!NOTE]\n>  After repairing a database, it is also a good idea to compact it using the [CompactDatabase](#cdaoworkspace__compactdatabase) member function to defragment the file and to recover disk space.  \n  \n For more information about repairing databases, see the topic \"RepairDatabase Method\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__rollback\"></a>  CDaoWorkspace::Rollback  \n Call this member function to end the current transaction and restore all databases in the workspace to their condition before the transaction was begun.  \n  \n```  \nvoid Rollback();\n```  \n  \n### Remarks  \n  \n> [!CAUTION]\n>  Within one workspace object, transactions are always global to the workspace and are not limited to only one database or recordset. If you perform operations on more than one database or recordset within a workspace transaction, **Rollback** restores all operations on all of those databases and recordsets.  \n  \n If you close a workspace object without saving or rolling back any pending transactions, the transactions are automatically rolled back. If you call [CommitTrans](#cdaoworkspace__committrans) or **Rollback** without first calling [BeginTrans](#cdaoworkspace__begintrans), an error occurs.  \n  \n> [!NOTE]\n>  When you begin a transaction, the database engine records its operations in a file kept in the directory specified by the TEMP environment variable on the workstation. If the transaction log file exhausts the available storage on your TEMP drive, the database engine will cause MFC to throw a `CDaoException` (DAO error 2004). At this point, if you call **CommitTrans**, an indeterminate number of operations are committed but the remaining uncompleted operations are lost, and the operation has to be restarted. Calling **Rollback** releases the transaction log and rolls back all operations in the transaction.  \n  \n##  <a name=\"cdaoworkspace__setdefaultpassword\"></a>  CDaoWorkspace::SetDefaultPassword  \n Call this member function to set the default password that the database engine uses when a workspace object is created without a specific password.  \n  \n```  \nstatic void PASCAL SetDefaultPassword(LPCTSTR lpszPassword);\n```  \n  \n### Parameters  \n `lpszPassword`  \n The default password. A password can be up to 14 characters long and can contain any character except ASCII 0 (null). Passwords are case-sensitive.  \n  \n### Remarks  \n The default password that you set applies to new workspaces you create after the call. When you create subsequent workspaces, you do not need to specify a password in the [Create](#cdaoworkspace__create) call.  \n  \n To use this member function:  \n  \n1.  Construct a `CDaoWorkspace` object but do not call **Create**.  \n  \n2.  Call `SetDefaultPassword` and, if you like, [SetDefaultUser](#cdaoworkspace__setdefaultuser).  \n  \n3.  Call **Create** for this workspace object or subsequent ones, without specifying a password.  \n  \n By default, the DefaultUser property is set to \"admin\" and the DefaultPassword property is set to an empty string (\"\").  \n  \n For more about security, see the topic \"Permissions Property\" in DAO Help. For related information, see the topics \"DefaultPassword Property\" and \"DefaultUser Property\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__setdefaultuser\"></a>  CDaoWorkspace::SetDefaultUser  \n Call this member function to set the default user name that the database engine uses when a workspace object is created without a specific user name.  \n  \n```  \nstatic void PASCAL SetDefaultUser(LPCTSTR lpszDefaultUser);\n```  \n  \n### Parameters  \n `lpszDefaultUser`  \n The default user name. A user name can be 1 – 20 characters long and include alphabetic characters, accented characters, numbers, spaces, and symbols except for: \" (quotation marks), / (forward slash), \\ (backslash), \\[ \\] (brackets), : (colon), &#124; (pipe), \\< (less-than sign), > (greater-than sign), + (plus sign), = (equal sign), ; (semicolon), , ( comma),  (question mark), * (asterisk), leading spaces, and control characters (ASCII 00 to ASCII 31). For related information, see the topic \"UserName Property\" in DAO Help.  \n  \n### Remarks  \n The default user name that you set applies to new workspaces you create after the call. When you create subsequent workspaces, you do not need to specify a user name in the [Create](#cdaoworkspace__create) call.  \n  \n To use this member function:  \n  \n1.  Construct a `CDaoWorkspace` object but do not call **Create**.  \n  \n2.  Call `SetDefaultUser` and, if you like, [SetDefaultPassword](#cdaoworkspace__setdefaultpassword).  \n  \n3.  Call **Create** for this workspace object or subsequent ones, without specifying a user name.  \n  \n By default, the DefaultUser property is set to \"admin\" and the DefaultPassword property is set to an empty string (\"\").  \n  \n For related information, see the topics \"DefaultUser Property\" and \"DefaultPassword Property\" in DAO Help.  \n  \n##  <a name=\"cdaoworkspace__setinipath\"></a>  CDaoWorkspace::SetIniPath  \n Call this member function to specify the location of Windows registry settings for the Microsoft Jet database engine.  \n  \n```  \nstatic void PASCAL SetIniPath(LPCTSTR lpszRegistrySubKey);\n```  \n  \n### Parameters  \n *lpszRegistrySubkey*  \n A string containing the name of a Windows registry subkey for the location of Microsoft Jet database engine settings or parameters needed for installable ISAM databases.  \n  \n### Remarks  \n Call `SetIniPath` only if you need to specify special settings. For more information, see the topic \"IniPath Property\" in DAO Help.  \n  \n> [!NOTE]\n>  Call `SetIniPath` during application installation, not when the application runs. `SetIniPath` must be called before you open any workspaces, databases, or recordsets; otherwise, MFC throws an exception.  \n  \n You can use this mechanism to configure the database engine with user-provided registry settings. The scope of this attribute is limited to your application and cannot be changed without restarting your application.  \n  \n##  <a name=\"cdaoworkspace__setisolateodbctrans\"></a>  CDaoWorkspace::SetIsolateODBCTrans  \n Call this member function to set the value of the DAO IsolateODBCTrans property for the workspace.  \n  \n```  \nvoid SetIsolateODBCTrans(BOOL bIsolateODBCTrans);\n```  \n  \n### Parameters  \n *bIsolateODBCTrans*  \n Pass **TRUE** if you want to begin isolating ODBC transactions. Pass **FALSE** if you want to stop isolating ODBC transactions.  \n  \n### Remarks  \n In some situations, you might need to have multiple simultaneous transactions pending on the same ODBC database. To do this, you need to open a separate workspace for each transaction. Although each workspace can have its own ODBC connection to the database, this slows system performance. Because transaction isolation is not normally required, ODBC connections from multiple workspace objects opened by the same user are shared by default.  \n  \n Some ODBC servers, such as Microsoft SQL Server, do not allow simultaneous transactions on a single connection. If you need to have more than one transaction at a time pending against such a database, set the IsolateODBCTrans property to **TRUE** on each workspace as soon as you open it. This forces a separate ODBC connection for each workspace.  \n  \n##  <a name=\"cdaoworkspace__setlogintimeout\"></a>  CDaoWorkspace::SetLoginTimeout  \n Call this member function to set the value of the DAO LoginTimeout property for the workspace.  \n  \n```  \nstatic void PASCAL SetLoginTimeout(short nSeconds);\n```  \n  \n### Parameters  \n `nSeconds`  \n The number of seconds before an error occurs when you attempt to log in to an ODBC database.  \n  \n### Remarks  \n This value represents the number of seconds before an error occurs when you attempt to log in to an ODBC database. The default LoginTimeout setting is 20 seconds. When LoginTimeout is set to 0, no timeout occurs and the communication with the data source might stop responding.  \n  \n When you are attempting to log in to an ODBC database, such as Microsoft SQL Server, the connection may fail as a result of network errors or because the server is not running. Rather than waiting for the default 20 seconds to connect, you can specify how long the database engine waits before it produces an error. Logging on to the server happens implicitly as part of a number of different events, such as running a query on an external server database. The timeout value is determined by the current setting of the LoginTimeout property.  \n  \n For related information, see the topic \"LoginTimeout Property\" in DAO Help.  \n  \n## See Also  \n [CObject Class](../../mfc/reference/cobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CDaoDatabase Class](../../mfc/reference/cdaodatabase-class.md)   \n [CDaoRecordset Class](../../mfc/reference/cdaorecordset-class.md)   \n [CDaoTableDef Class](../../mfc/reference/cdaotabledef-class.md)   \n [CDaoQueryDef Class](../../mfc/reference/cdaoquerydef-class.md)   \n [CDaoException Class](../../mfc/reference/cdaoexception-class.md)\n"}