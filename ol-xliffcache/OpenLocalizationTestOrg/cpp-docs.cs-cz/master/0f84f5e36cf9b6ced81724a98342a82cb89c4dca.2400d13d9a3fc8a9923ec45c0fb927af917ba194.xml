{"nodes":[{"pos":[12,66],"content":"Mixed (Native and Managed) Assemblies | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Mixed (Native and Managed) Assemblies | Microsoft Docs","pos":[0,54]}]},{"content":"Mixed (Native and Managed) Assemblies","pos":[939,976]},{"content":"Mixed assemblies are capable of containing both unmanaged machine instructions and MSIL instructions.","pos":[977,1078]},{"content":"This allows them to call and be called by .NET components, while retaining compatibility with components that are entirely unmanaged.","pos":[1079,1212]},{"content":"Using mixed assemblies, developers can author applications using a mixture of managed and unmanaged functionality.","pos":[1213,1327]},{"content":"This makes mixed assemblies ideal for migrating existing Visual C++ applications to the .NET Platform.","pos":[1328,1430]},{"content":"For example, an existing application consisting entirely of unmanaged functions can be brought to the .NET platform by recompiling just one module with the <bpt id=\"p1\">**</bpt>/clr<ept id=\"p1\">**</ept> compiler switch.","pos":[1437,1618],"source":"For example, an existing application consisting entirely of unmanaged functions can be brought to the .NET platform by recompiling just one module with the **/clr** compiler switch."},{"content":"This module is then able to use .NET features, but remains compatible with the remainder of the application.","pos":[1619,1727]},{"content":"In this way, an application can be converted to the .NET platform in a gradual, piece-by-piece fashion.","pos":[1728,1831]},{"content":"It is even possible to decide between managed and unmanaged compilation on a function-by-function basis within the same file (see <bpt id=\"p1\">[</bpt>managed, unmanaged<ept id=\"p1\">](../preprocessor/managed-unmanaged.md)</ept>).","pos":[1832,2022],"source":" It is even possible to decide between managed and unmanaged compilation on a function-by-function basis within the same file (see [managed, unmanaged](../preprocessor/managed-unmanaged.md))."},{"content":"Visual C++ supports the generation of three distinct types of managed assemblies: mixed, pure, and verifiable.","pos":[2029,2139]},{"content":"The latter two are discussed in <bpt id=\"p1\">[</bpt>Pure and Verifiable Code (C++/CLI)<ept id=\"p1\">](../dotnet/pure-and-verifiable-code-cpp-cli.md)</ept>.","pos":[2140,2256],"source":" The latter two are discussed in [Pure and Verifiable Code (C++/CLI)](../dotnet/pure-and-verifiable-code-cpp-cli.md)."},{"content":"In This Section","pos":[2265,2280]},{"content":"How to: Migrate to /clr","pos":[2285,2308]},{"content":"Describes the recommended steps for either introducing or upgrading .NET functionality in your application.","pos":[2349,2456]},{"content":"How to: Compile MFC and ATL Code By Using /clr","pos":[2464,2510]},{"content":"Discusses how to compile existing MFC and ATL programs to target the Common Language Runtime.","pos":[2574,2667]},{"content":"Initialization of Mixed Assemblies","pos":[2675,2709]},{"content":"Describes the \"loader lock\" problem and solutions.","pos":[2763,2813]},{"content":"Library Support for Mixed Assemblies","pos":[2821,2857]},{"content":"Discusses how to use native libraries in <bpt id=\"p1\">**</bpt>/clr<ept id=\"p1\">**</ept> compilations.","pos":[2913,2976],"source":" Discusses how to use native libraries in **/clr** compilations."},{"content":"Performance Considerations","pos":[2984,3010]},{"content":"Describes the performance implications of mixed assemblies and data marshaling.","pos":[3072,3151]},{"content":"Application Domains and Visual C++","pos":[3159,3193]},{"content":"Discusses Visual C++ support for application domains.","pos":[3247,3300]},{"content":"Double Thunking","pos":[3308,3323]},{"content":"Discusses the performance implications of a native entry point for a managed function.","pos":[3362,3448]},{"content":"Avoiding Exceptions on CLR Shutdown When Consuming COM Objects Built with /clr","pos":[3456,3534]},{"content":"Discusses how to ensure proper shutdown of a managed application that consumes a COM object compiled with <bpt id=\"p1\">**</bpt>/clr<ept id=\"p1\">**</ept>.","pos":[3631,3746],"source":" Discusses how to ensure proper shutdown of a managed application that consumes a COM object compiled with **/clr**."},{"content":"How to: Create a Partially Trusted Application by Removing Dependency on the CRT Library DLL","pos":[3754,3846]},{"content":"Discusses how to create a partially trusted Common Language Runtime application using <ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph> by removing dependency on msvcm90.dll.","pos":[3904,4079],"source":" Discusses how to create a partially trusted Common Language Runtime application using [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] by removing dependency on msvcm90.dll."},{"pos":[4086,4431],"content":"For more information about coding guidelines for mixed assemblies, see the MSDN article \"An Overview of Managed/Unmanaged Code Interoperability\" at <bpt id=\"p1\">[</bpt>http://msdn.microsoft.com/netframework/default.aspx?pull=/library/dndotnet/html/manunmancode.asp<ept id=\"p1\">](http://msdn.microsoft.com/netframework/default.aspx?pull=/library/dndotnet/html/manunmancode.asp)</ept>.","source":"For more information about coding guidelines for mixed assemblies, see the MSDN article \"An Overview of Managed/Unmanaged Code Interoperability\" at [http://msdn.microsoft.com/netframework/default.aspx?pull=/library/dndotnet/html/manunmancode.asp](http://msdn.microsoft.com/netframework/default.aspx?pull=/library/dndotnet/html/manunmancode.asp)."},{"content":"See Also","pos":[4440,4448]},{"content":"Native and .NET Interoperability","pos":[4453,4485]}],"content":"---\ntitle: \"Mixed (Native and Managed) Assemblies | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"interop [C++], mixed assemblies\"\n  - \"/clr compiler option [C++], mixed assemblies\"\n  - \"managed code [C++], interoperability\"\n  - \"interoperability [C++], mixed assemblies\"\n  - \"mixed DLL loading [C++]\"\n  - \"mixed assemblies [C++], about mixed assemblies\"\n  - \"assemblies [C++], mixed\"\n  - \"mixed assemblies [C++]\"\n  - \"native code [C++], .NET interoperatibility\"\nms.assetid: 4299dfce-392f-4933-8bf0-5da2f0d1c282\ncaps.latest.revision: 35\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Mixed (Native and Managed) Assemblies\nMixed assemblies are capable of containing both unmanaged machine instructions and MSIL instructions. This allows them to call and be called by .NET components, while retaining compatibility with components that are entirely unmanaged. Using mixed assemblies, developers can author applications using a mixture of managed and unmanaged functionality. This makes mixed assemblies ideal for migrating existing Visual C++ applications to the .NET Platform.  \n  \n For example, an existing application consisting entirely of unmanaged functions can be brought to the .NET platform by recompiling just one module with the **/clr** compiler switch. This module is then able to use .NET features, but remains compatible with the remainder of the application. In this way, an application can be converted to the .NET platform in a gradual, piece-by-piece fashion. It is even possible to decide between managed and unmanaged compilation on a function-by-function basis within the same file (see [managed, unmanaged](../preprocessor/managed-unmanaged.md)).  \n  \n Visual C++ supports the generation of three distinct types of managed assemblies: mixed, pure, and verifiable. The latter two are discussed in [Pure and Verifiable Code (C++/CLI)](../dotnet/pure-and-verifiable-code-cpp-cli.md).  \n  \n## In This Section  \n [How to: Migrate to /clr](../dotnet/how-to-migrate-to-clr.md)  \n Describes the recommended steps for either introducing or upgrading .NET functionality in your application.  \n  \n [How to: Compile MFC and ATL Code By Using /clr](../dotnet/how-to-compile-mfc-and-atl-code-by-using-clr.md)  \n Discusses how to compile existing MFC and ATL programs to target the Common Language Runtime.  \n  \n [Initialization of Mixed Assemblies](../dotnet/initialization-of-mixed-assemblies.md)  \n Describes the \"loader lock\" problem and solutions.  \n  \n [Library Support for Mixed Assemblies](../dotnet/library-support-for-mixed-assemblies.md)  \n Discusses how to use native libraries in **/clr** compilations.  \n  \n [Performance Considerations](../dotnet/performance-considerations-for-interop-cpp.md)  \n Describes the performance implications of mixed assemblies and data marshaling.  \n  \n [Application Domains and Visual C++](../dotnet/application-domains-and-visual-cpp.md)  \n Discusses Visual C++ support for application domains.  \n  \n [Double Thunking](../dotnet/double-thunking-cpp.md)  \n Discusses the performance implications of a native entry point for a managed function.  \n  \n [Avoiding Exceptions on CLR Shutdown When Consuming COM Objects Built with /clr](../dotnet/avoiding-exceptions-on-clr-shutdown-when-consuming-com-objects-built-with-clr.md)  \n Discusses how to ensure proper shutdown of a managed application that consumes a COM object compiled with **/clr**.  \n  \n [How to: Create a Partially Trusted Application by Removing Dependency on the CRT Library DLL](../dotnet/create-a-partially-trusted-application.md)  \n Discusses how to create a partially trusted Common Language Runtime application using [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] by removing dependency on msvcm90.dll.  \n  \n For more information about coding guidelines for mixed assemblies, see the MSDN article \"An Overview of Managed/Unmanaged Code Interoperability\" at [http://msdn.microsoft.com/netframework/default.aspx?pull=/library/dndotnet/html/manunmancode.asp](http://msdn.microsoft.com/netframework/default.aspx?pull=/library/dndotnet/html/manunmancode.asp).  \n  \n## See Also  \n [Native and .NET Interoperability](../dotnet/native-and-dotnet-interoperability.md)"}