{"nodes":[{"pos":[12,49],"content":"CDaoRecordView Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDaoRecordView Class | Microsoft Docs","pos":[0,37]}]},{"content":"CDaoRecordView Class","pos":[841,861]},{"content":"A view that displays database records in controls.","pos":[862,912]},{"content":"Syntax","pos":[921,927]},{"content":"Members","pos":[1006,1013]},{"content":"Protected Constructors","pos":[1023,1045]},{"content":"Name","pos":[1052,1056]},{"content":"Description","pos":[1057,1068]},{"content":"CDaoRecordView::CDaoRecordView","pos":[1107,1137]},{"pos":[1172,1209],"content":"Constructs a <ph id=\"ph1\">`CDaoRecordView`</ph> object.","source":"Constructs a `CDaoRecordView` object."},{"content":"Public Methods","pos":[1220,1234]},{"content":"Name","pos":[1241,1245]},{"content":"Description","pos":[1246,1257]},{"content":"CDaoRecordView::IsOnFirstRecord","pos":[1296,1327]},{"content":"Returns nonzero if the current record is the first record in the associated recordset.","pos":[1363,1449]},{"content":"CDaoRecordView::IsOnLastRecord","pos":[1455,1485]},{"content":"Returns nonzero if the current record is the last record in the associated recordset.","pos":[1520,1605]},{"content":"CDaoRecordView::OnGetRecordset","pos":[1611,1641]},{"content":"Returns a pointer to an object of a class derived from <ph id=\"ph1\">`CDaoRecordset`</ph>.","pos":[1676,1747],"source":"Returns a pointer to an object of a class derived from `CDaoRecordset`."},{"content":"ClassWizard overrides this function for you and creates the recordset if necessary.","pos":[1748,1831]},{"content":"CDaoRecordView::OnMove","pos":[1837,1859]},{"content":"If the current record has changed, updates it on the data source, then moves to the specified record (next, previous, first, or last).","pos":[1886,2020]},{"content":"Remarks","pos":[2030,2037]},{"content":"The view is a form view directly connected to a <ph id=\"ph1\">`CDaoRecordset`</ph> object.","pos":[2041,2112],"source":"The view is a form view directly connected to a `CDaoRecordset` object."},{"content":"The view is created from a dialog template resource and displays the fields of the <ph id=\"ph1\">`CDaoRecordset`</ph> object in the dialog template's controls.","pos":[2113,2253],"source":" The view is created from a dialog template resource and displays the fields of the `CDaoRecordset` object in the dialog template's controls."},{"content":"The <ph id=\"ph1\">`CDaoRecordView`</ph> object uses dialog data exchange (DDX) and DAO record field exchange (DFX) to automate the movement of data between the controls on the form and the fields of the recordset.","pos":[2254,2448],"source":" The `CDaoRecordView` object uses dialog data exchange (DDX) and DAO record field exchange (DFX) to automate the movement of data between the controls on the form and the fields of the recordset."},{"content":"also supplies a default implementation for moving to the first, next, previous, or last record and an interface for updating the record currently in view.","pos":[2466,2620]},{"pos":[2628,2970],"content":"[!NOTE]\n The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes; the DAO classes generally offer superior capabilities because they use the Microsoft Jet database engine.","leadings":["","> "],"nodes":[{"content":" The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes; the DAO classes generally offer superior capabilities because they use the Microsoft Jet database engine.","pos":[8,340],"nodes":[{"content":"The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC).","pos":[1,112]},{"content":"All DAO database class names have the \"CDao\" prefix.","pos":[113,165]},{"content":"You can still access ODBC data sources with the DAO classes; the DAO classes generally offer superior capabilities because they use the Microsoft Jet database engine.","pos":[166,332]}]}]},{"content":"The most common way to create your record view is with the Application Wizard.","pos":[2977,3055]},{"content":"The Application Wizard creates both the record view class and its associated recordset class as part of your skeleton starter application.","pos":[3056,3194]},{"content":"If you simply need a single form, the Application Wizard approach is easier.","pos":[3201,3277]},{"content":"ClassWizard lets you decide to use a record view later in the development process.","pos":[3278,3360]},{"content":"If you don't create the record view class with the Application Wizard, you can create it later with ClassWizard.","pos":[3361,3473]},{"content":"Using ClassWizard to create a record view and a recordset separately and then connect them is the most flexible approach because it gives you more control in naming the recordset class and its .H/.CPP files.","pos":[3474,3681]},{"content":"This approach also lets you have multiple record views on the same recordset class.","pos":[3682,3765]},{"content":"To make it easy for end-users to move from record to record in the record view, the Application Wizard creates menu (and optionally toolbar) resources for moving to the first, next, previous, or last record.","pos":[3772,3979]},{"content":"If you create a record view class with ClassWizard, you need to create these resources yourself with the menu and bitmap editors.","pos":[3980,4109]},{"pos":[4116,4389],"content":"For information about the default implementation for moving from record to record, see <ph id=\"ph1\">`IsOnFirstRecord`</ph> and <ph id=\"ph2\">`IsOnLastRecord`</ph> and the article <bpt id=\"p1\">[</bpt>Using a Record View<ept id=\"p1\">](../../data/using-a-record-view-mfc-data-access.md)</ept>, which applies to both <ph id=\"ph3\">`CRecordView`</ph> and <ph id=\"ph4\">`CDaoRecordView`</ph>.","source":"For information about the default implementation for moving from record to record, see `IsOnFirstRecord` and `IsOnLastRecord` and the article [Using a Record View](../../data/using-a-record-view-mfc-data-access.md), which applies to both `CRecordView` and `CDaoRecordView`."},{"content":"keeps track of the user's position in the recordset so that the record view can update the user interface.","pos":[4413,4519]},{"content":"When the user moves to either end of the recordset, the record view disables user interface objects — such as menu items or toolbar buttons — for moving further in the same direction.","pos":[4520,4703]},{"content":"For more information about declaring and using your record view and recordset classes, see \"Designing and Creating a Record View\" in the article <bpt id=\"p1\">[</bpt>Record Views<ept id=\"p1\">](../../data/record-views-mfc-data-access.md)</ept>.","pos":[4710,4914],"source":"For more information about declaring and using your record view and recordset classes, see \"Designing and Creating a Record View\" in the article [Record Views](../../data/record-views-mfc-data-access.md)."},{"content":"For more information about how record views work and how to use them, see the article <bpt id=\"p1\">[</bpt>Using a Record View<ept id=\"p1\">](../../data/using-a-record-view-mfc-data-access.md)</ept>.","pos":[4915,5074],"source":" For more information about how record views work and how to use them, see the article [Using a Record View](../../data/using-a-record-view-mfc-data-access.md)."},{"content":"All the articles mentioned above apply to both <ph id=\"ph1\">`CRecordView`</ph> and <ph id=\"ph2\">`CDaoRecordView`</ph>.","pos":[5075,5157],"source":" All the articles mentioned above apply to both `CRecordView` and `CDaoRecordView`."},{"content":"Inheritance Hierarchy","pos":[5166,5187]},{"content":"CObject","pos":[5192,5199]},{"content":"CCmdTarget","pos":[5246,5256]},{"content":"CWnd","pos":[5306,5310]},{"content":"CView","pos":[5354,5359]},{"content":"CScrollView","pos":[5404,5415]},{"content":"CFormView","pos":[5466,5475]},{"content":"Requirements","pos":[5548,5560]},{"pos":[5564,5584],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdao.h","source":"**Header:** afxdao.h"},{"pos":[5641,5671],"content":"CDaoRecordView::CDaoRecordView"},{"pos":[5675,5868],"content":"When you create an object of a type derived from <ph id=\"ph1\">`CDaoRecordView`</ph>, call either form of the constructor to initialize the view object and identify the dialog resource on which the view is based.","source":"When you create an object of a type derived from `CDaoRecordView`, call either form of the constructor to initialize the view object and identify the dialog resource on which the view is based."},{"content":"Parameters","pos":[5990,6000]},{"content":"Contains a null-terminated string that is the name of a dialog template resource.","pos":[6026,6107]},{"content":"Contains the ID number of a dialog template resource.","pos":[6131,6184]},{"content":"Remarks","pos":[6194,6201]},{"content":"You can either identify the resource by name (pass a string as the argument to the constructor) or by its ID (pass an unsigned integer as the argument).","pos":[6205,6357]},{"content":"Using a resource ID is recommended.","pos":[6358,6393]},{"pos":[6401,6604],"content":"[!NOTE]\n Your derived class must supply its own constructor. In the constructor of your derived class, call the constructor `CDaoRecordView::CDaoRecordView` with the resource name or ID as an argument.","leadings":["","> "],"nodes":[{"content":" Your derived class must supply its own constructor. In the constructor of your derived class, call the constructor `CDaoRecordView::CDaoRecordView` with the resource name or ID as an argument.","pos":[8,201],"nodes":[{"content":"Your derived class must supply its own constructor.","pos":[1,52]},{"content":"In the constructor of your derived class, call the constructor <ph id=\"ph1\">`CDaoRecordView::CDaoRecordView`</ph> with the resource name or ID as an argument.","pos":[53,193],"source":" In the constructor of your derived class, call the constructor `CDaoRecordView::CDaoRecordView` with the resource name or ID as an argument."}]}]},{"content":"<bpt id=\"p1\">**</bpt>CDaoRecordView::OnInitialUpdate<ept id=\"p1\">**</ept> calls <ph id=\"ph1\">`CWnd::UpdateData`</ph>, which calls <ph id=\"ph2\">`CWnd::DoDataExchange`</ph>.","pos":[6611,6708],"source":"**CDaoRecordView::OnInitialUpdate** calls `CWnd::UpdateData`, which calls `CWnd::DoDataExchange`."},{"content":"This initial call to <ph id=\"ph1\">`DoDataExchange`</ph> connects <ph id=\"ph2\">`CDaoRecordView`</ph> controls (indirectly) to <ph id=\"ph3\">`CDaoRecordset`</ph> field data members created by ClassWizard.","pos":[6709,6856],"source":" This initial call to `DoDataExchange` connects `CDaoRecordView` controls (indirectly) to `CDaoRecordset` field data members created by ClassWizard."},{"content":"These data members cannot be used until after you call the base class <bpt id=\"p1\">**</bpt>CFormView::OnInitialUpdate<ept id=\"p1\">**</ept> member function.","pos":[6857,6974],"source":" These data members cannot be used until after you call the base class **CFormView::OnInitialUpdate** member function."},{"pos":[6982,7165],"content":"[!NOTE]\n If you use ClassWizard, the wizard defines an `enum` value `CDaoRecordView::IDD` in the class declaration and uses it in the member initialization list for the constructor.","leadings":["","> "],"nodes":[{"content":"If you use ClassWizard, the wizard defines an <ph id=\"ph1\">`enum`</ph> value <ph id=\"ph2\">`CDaoRecordView::IDD`</ph> in the class declaration and uses it in the member initialization list for the constructor.","pos":[9,181],"source":" If you use ClassWizard, the wizard defines an `enum` value `CDaoRecordView::IDD` in the class declaration and uses it in the member initialization list for the constructor."}]},{"pos":[7183,7201],"content":"NVC_MFCDatabase#35"},{"pos":[7315,7346],"content":"CDaoRecordView::IsOnFirstRecord"},{"content":"Call this member function to determine whether the current record is the first record in the recordset object associated with this record view.","pos":[7350,7493]},{"content":"Return Value","pos":[7542,7554]},{"content":"Nonzero if the current record is the first record in the recordset; otherwise 0.","pos":[7558,7638]},{"content":"Remarks","pos":[7648,7655]},{"content":"This function is useful for writing your own implementations of the default command update handlers written by ClassWizard.","pos":[7659,7782]},{"content":"If the user moves to the first record, the framework disables any user interface objects (for example, menu items or toolbar buttons) you have for moving to the first or the previous record.","pos":[7789,7979]},{"pos":[8036,8066],"content":"CDaoRecordView::IsOnLastRecord"},{"content":"Call this member function to determine whether the current record is the last record in the recordset object associated with this record view.","pos":[8070,8212]},{"content":"Return Value","pos":[8260,8272]},{"content":"Nonzero if the current record is the last record in the recordset; otherwise 0.","pos":[8276,8355]},{"content":"Remarks","pos":[8365,8372]},{"content":"This function is useful for writing your own implementations of the default command update handlers that ClassWizard writes to support a user interface for moving from record to record.","pos":[8376,8561]},{"pos":[8569,9101],"content":"[!CAUTION]\n The result of this function is reliable except that the view may not be able to detect the end of the recordset until the user has moved past it. The user might have to move beyond the last record before the record view can tell that it must disable any user interface objects for moving to the next or last record. If the user moves past the last record and then moves back to the last record (or before it), the record view can track the user's position in the recordset and disable user interface objects correctly.","leadings":["","> "],"nodes":[{"content":" The result of this function is reliable except that the view may not be able to detect the end of the recordset until the user has moved past it. The user might have to move beyond the last record before the record view can tell that it must disable any user interface objects for moving to the next or last record. If the user moves past the last record and then moves back to the last record (or before it), the record view can track the user's position in the recordset and disable user interface objects correctly.","pos":[11,530],"nodes":[{"content":"The result of this function is reliable except that the view may not be able to detect the end of the recordset until the user has moved past it.","pos":[1,146]},{"content":"The user might have to move beyond the last record before the record view can tell that it must disable any user interface objects for moving to the next or last record.","pos":[147,316]},{"content":"If the user moves past the last record and then moves back to the last record (or before it), the record view can track the user's position in the recordset and disable user interface objects correctly.","pos":[317,519]}]}]},{"pos":[9158,9188],"content":"CDaoRecordView::OnGetRecordset"},{"pos":[9192,9280],"content":"Returns a pointer to the <ph id=\"ph1\">`CDaoRecordset`</ph>-derived object associated with the record view.","source":"Returns a pointer to the `CDaoRecordset`-derived object associated with the record view."},{"content":"Return Value","pos":[9352,9364]},{"pos":[9368,9483],"content":"A pointer to a <ph id=\"ph1\">`CDaoRecordset`</ph>-derived object if the object was successfully created; otherwise a <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> pointer.","source":"A pointer to a `CDaoRecordset`-derived object if the object was successfully created; otherwise a **NULL** pointer."},{"content":"Remarks","pos":[9493,9500]},{"content":"You must override this member function to construct or obtain a recordset object and return a pointer to it.","pos":[9504,9612]},{"content":"If you declare your record view class with ClassWizard, the wizard writes a default override for you.","pos":[9613,9714]},{"content":"ClassWizard's default implementation returns the recordset pointer stored in the record view if one exists.","pos":[9715,9822]},{"content":"If not, it constructs a recordset object of the type you specified with ClassWizard and calls its <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> member function to open the table or run the query, and then returns a pointer to the object.","pos":[9823,10023],"source":" If not, it constructs a recordset object of the type you specified with ClassWizard and calls its **Open** member function to open the table or run the query, and then returns a pointer to the object."},{"pos":[10030,10168],"content":"For more information and examples, see the article <bpt id=\"p1\">[</bpt>Record Views: Using a Record View<ept id=\"p1\">](../../data/using-a-record-view-mfc-data-access.md)</ept>.","source":"For more information and examples, see the article [Record Views: Using a Record View](../../data/using-a-record-view-mfc-data-access.md)."},{"pos":[10217,10239],"content":"CDaoRecordView::OnMove"},{"content":"Call this member function to move to a different record in the recordset and display its fields in the controls of the record view.","pos":[10243,10374]},{"content":"Parameters","pos":[10441,10451]},{"content":"One of the following standard command ID values:","pos":[10475,10523]},{"pos":[10549,10591],"content":"Move to the first record in the recordset."},{"pos":[10616,10657],"content":"Move to the last record in the recordset."},{"pos":[10682,10723],"content":"Move to the next record in the recordset."},{"pos":[10748,10793],"content":"Move to the previous record in the recordset."},{"content":"Return Value","pos":[10803,10815]},{"content":"Nonzero if the move was successful; otherwise 0 if the move request was denied.","pos":[10819,10898]},{"content":"Remarks","pos":[10908,10915]},{"pos":[10919,11051],"content":"The default implementation calls the appropriate Move member function of the <ph id=\"ph1\">`CDaoRecordset`</ph> object associated with the record view.","source":"The default implementation calls the appropriate Move member function of the `CDaoRecordset` object associated with the record view."},{"pos":[11058,11171],"content":"By default, <ph id=\"ph1\">`OnMove`</ph> updates the current record on the data source if the user has changed it in the record view.","source":"By default, `OnMove` updates the current record on the data source if the user has changed it in the record view."},{"content":"The Application Wizard creates a menu resource with First Record, Last Record, Next Record, and Previous Record menu items.","pos":[11178,11301]},{"content":"If you select the Initial Toolbar option, the Application Wizard also creates a toolbar with buttons corresponding to these commands.","pos":[11302,11435]},{"content":"If you move past the last record in the recordset, the record view continues to display the last record.","pos":[11442,11546]},{"content":"If you move backward past the first record, the record view continues to display the first record.","pos":[11547,11645]},{"pos":[11653,11991],"content":"[!CAUTION]\n Calling `OnMove` throws an exception if the recordset has no records. Call the appropriate user interface update handler function — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, or **OnUpdateRecordPrev** — before the corresponding move operation to determine whether the recordset has any records.","leadings":["","> "],"nodes":[{"content":" Calling `OnMove` throws an exception if the recordset has no records. Call the appropriate user interface update handler function — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, or **OnUpdateRecordPrev** — before the corresponding move operation to determine whether the recordset has any records.","pos":[11,336],"nodes":[{"content":"Calling <ph id=\"ph1\">`OnMove`</ph> throws an exception if the recordset has no records.","pos":[1,70],"source":" Calling `OnMove` throws an exception if the recordset has no records."},{"content":"Call the appropriate user interface update handler function — <bpt id=\"p1\">**</bpt>OnUpdateRecordFirst<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>OnUpdateRecordLast<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>OnUpdateRecordNext<ept id=\"p3\">**</ept>, or <bpt id=\"p4\">**</bpt>OnUpdateRecordPrev<ept id=\"p4\">**</ept> — before the corresponding move operation to determine whether the recordset has any records.","pos":[71,325],"source":" Call the appropriate user interface update handler function — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, or **OnUpdateRecordPrev** — before the corresponding move operation to determine whether the recordset has any records."}]}]},{"content":"See Also","pos":[12000,12008]},{"content":"CFormView Class","pos":[12013,12028]},{"content":"Hierarchy Chart","pos":[12075,12090]},{"content":"CDaoRecordset Class","pos":[12127,12146]},{"content":"CDaoTableDef Class","pos":[12197,12215]},{"content":"CDaoQueryDef Class","pos":[12265,12283]},{"content":"CDaoDatabase Class","pos":[12333,12351]},{"content":"CDaoWorkspace Class","pos":[12401,12420]},{"content":"CFormView Class","pos":[12471,12486]}],"content":"---\ntitle: \"CDaoRecordView Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDaoRecordView\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CDaoRecordView class\"\n  - \"data-bound controls [C++], DAO controls\"\n  - \"data binding [C++], DAO views\"\n  - \"bound controls [C++], displaying database data\"\n  - \"application wizards [C++], creating record views\"\n  - \"controls [MFC], data binding\"\nms.assetid: 5aa7d0e2-bd05-413e-b216-80c404ce18ac\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDaoRecordView Class\nA view that displays database records in controls.  \n  \n## Syntax  \n  \n```  \nclass AFX_NOVTABLE CDaoRecordView : public CFormView  \n```  \n  \n## Members  \n  \n### Protected Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoRecordView::CDaoRecordView](#cdaorecordview__cdaorecordview)|Constructs a `CDaoRecordView` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoRecordView::IsOnFirstRecord](#cdaorecordview__isonfirstrecord)|Returns nonzero if the current record is the first record in the associated recordset.|  \n|[CDaoRecordView::IsOnLastRecord](#cdaorecordview__isonlastrecord)|Returns nonzero if the current record is the last record in the associated recordset.|  \n|[CDaoRecordView::OnGetRecordset](#cdaorecordview__ongetrecordset)|Returns a pointer to an object of a class derived from `CDaoRecordset`. ClassWizard overrides this function for you and creates the recordset if necessary.|  \n|[CDaoRecordView::OnMove](#cdaorecordview__onmove)|If the current record has changed, updates it on the data source, then moves to the specified record (next, previous, first, or last).|  \n  \n## Remarks  \n The view is a form view directly connected to a `CDaoRecordset` object. The view is created from a dialog template resource and displays the fields of the `CDaoRecordset` object in the dialog template's controls. The `CDaoRecordView` object uses dialog data exchange (DDX) and DAO record field exchange (DFX) to automate the movement of data between the controls on the form and the fields of the recordset. `CDaoRecordView` also supplies a default implementation for moving to the first, next, previous, or last record and an interface for updating the record currently in view.  \n  \n> [!NOTE]\n>  The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes; the DAO classes generally offer superior capabilities because they use the Microsoft Jet database engine.  \n  \n The most common way to create your record view is with the Application Wizard. The Application Wizard creates both the record view class and its associated recordset class as part of your skeleton starter application.  \n  \n If you simply need a single form, the Application Wizard approach is easier. ClassWizard lets you decide to use a record view later in the development process. If you don't create the record view class with the Application Wizard, you can create it later with ClassWizard. Using ClassWizard to create a record view and a recordset separately and then connect them is the most flexible approach because it gives you more control in naming the recordset class and its .H/.CPP files. This approach also lets you have multiple record views on the same recordset class.  \n  \n To make it easy for end-users to move from record to record in the record view, the Application Wizard creates menu (and optionally toolbar) resources for moving to the first, next, previous, or last record. If you create a record view class with ClassWizard, you need to create these resources yourself with the menu and bitmap editors.  \n  \n For information about the default implementation for moving from record to record, see `IsOnFirstRecord` and `IsOnLastRecord` and the article [Using a Record View](../../data/using-a-record-view-mfc-data-access.md), which applies to both `CRecordView` and `CDaoRecordView`.  \n  \n `CDaoRecordView` keeps track of the user's position in the recordset so that the record view can update the user interface. When the user moves to either end of the recordset, the record view disables user interface objects — such as menu items or toolbar buttons — for moving further in the same direction.  \n  \n For more information about declaring and using your record view and recordset classes, see \"Designing and Creating a Record View\" in the article [Record Views](../../data/record-views-mfc-data-access.md). For more information about how record views work and how to use them, see the article [Using a Record View](../../data/using-a-record-view-mfc-data-access.md). All the articles mentioned above apply to both `CRecordView` and `CDaoRecordView`.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CView](../../mfc/reference/cview-class.md)  \n  \n [CScrollView](../../mfc/reference/cscrollview-class.md)  \n  \n [CFormView](../../mfc/reference/cformview-class.md)  \n  \n `CDaoRecordView`  \n  \n## Requirements  \n **Header:** afxdao.h  \n  \n##  <a name=\"cdaorecordview__cdaorecordview\"></a>  CDaoRecordView::CDaoRecordView  \n When you create an object of a type derived from `CDaoRecordView`, call either form of the constructor to initialize the view object and identify the dialog resource on which the view is based.  \n  \n```  \nexplicit CDaoRecordView(LPCTSTR lpszTemplateName);\n\n \nexplicit CDaoRecordView(UINT nIDTemplate);\n```  \n  \n### Parameters  \n `lpszTemplateName`  \n Contains a null-terminated string that is the name of a dialog template resource.  \n  \n `nIDTemplate`  \n Contains the ID number of a dialog template resource.  \n  \n### Remarks  \n You can either identify the resource by name (pass a string as the argument to the constructor) or by its ID (pass an unsigned integer as the argument). Using a resource ID is recommended.  \n  \n> [!NOTE]\n>  Your derived class must supply its own constructor. In the constructor of your derived class, call the constructor `CDaoRecordView::CDaoRecordView` with the resource name or ID as an argument.  \n  \n **CDaoRecordView::OnInitialUpdate** calls `CWnd::UpdateData`, which calls `CWnd::DoDataExchange`. This initial call to `DoDataExchange` connects `CDaoRecordView` controls (indirectly) to `CDaoRecordset` field data members created by ClassWizard. These data members cannot be used until after you call the base class **CFormView::OnInitialUpdate** member function.  \n  \n> [!NOTE]\n>  If you use ClassWizard, the wizard defines an `enum` value `CDaoRecordView::IDD` in the class declaration and uses it in the member initialization list for the constructor.  \n  \n [!code-cpp[NVC_MFCDatabase#35](../../mfc/codesnippet/cpp/cdaorecordview-class_1.cpp)]  \n  \n##  <a name=\"cdaorecordview__isonfirstrecord\"></a>  CDaoRecordView::IsOnFirstRecord  \n Call this member function to determine whether the current record is the first record in the recordset object associated with this record view.  \n  \n```  \nBOOL IsOnFirstRecord();\n```  \n  \n### Return Value  \n Nonzero if the current record is the first record in the recordset; otherwise 0.  \n  \n### Remarks  \n This function is useful for writing your own implementations of the default command update handlers written by ClassWizard.  \n  \n If the user moves to the first record, the framework disables any user interface objects (for example, menu items or toolbar buttons) you have for moving to the first or the previous record.  \n  \n##  <a name=\"cdaorecordview__isonlastrecord\"></a>  CDaoRecordView::IsOnLastRecord  \n Call this member function to determine whether the current record is the last record in the recordset object associated with this record view.  \n  \n```  \nBOOL IsOnLastRecord();\n```  \n  \n### Return Value  \n Nonzero if the current record is the last record in the recordset; otherwise 0.  \n  \n### Remarks  \n This function is useful for writing your own implementations of the default command update handlers that ClassWizard writes to support a user interface for moving from record to record.  \n  \n> [!CAUTION]\n>  The result of this function is reliable except that the view may not be able to detect the end of the recordset until the user has moved past it. The user might have to move beyond the last record before the record view can tell that it must disable any user interface objects for moving to the next or last record. If the user moves past the last record and then moves back to the last record (or before it), the record view can track the user's position in the recordset and disable user interface objects correctly.  \n  \n##  <a name=\"cdaorecordview__ongetrecordset\"></a>  CDaoRecordView::OnGetRecordset  \n Returns a pointer to the `CDaoRecordset`-derived object associated with the record view.  \n  \n```  \nvirtual CDaoRecordset* OnGetRecordset() = 0;  \n```  \n  \n### Return Value  \n A pointer to a `CDaoRecordset`-derived object if the object was successfully created; otherwise a **NULL** pointer.  \n  \n### Remarks  \n You must override this member function to construct or obtain a recordset object and return a pointer to it. If you declare your record view class with ClassWizard, the wizard writes a default override for you. ClassWizard's default implementation returns the recordset pointer stored in the record view if one exists. If not, it constructs a recordset object of the type you specified with ClassWizard and calls its **Open** member function to open the table or run the query, and then returns a pointer to the object.  \n  \n For more information and examples, see the article [Record Views: Using a Record View](../../data/using-a-record-view-mfc-data-access.md).  \n  \n##  <a name=\"cdaorecordview__onmove\"></a>  CDaoRecordView::OnMove  \n Call this member function to move to a different record in the recordset and display its fields in the controls of the record view.  \n  \n```  \nvirtual BOOL OnMove(UINT nIDMoveCommand);\n```  \n  \n### Parameters  \n `nIDMoveCommand`  \n One of the following standard command ID values:  \n  \n- `ID_RECORD_FIRST` Move to the first record in the recordset.  \n  \n- `ID_RECORD_LAST` Move to the last record in the recordset.  \n  \n- `ID_RECORD_NEXT` Move to the next record in the recordset.  \n  \n- `ID_RECORD_PREV` Move to the previous record in the recordset.  \n  \n### Return Value  \n Nonzero if the move was successful; otherwise 0 if the move request was denied.  \n  \n### Remarks  \n The default implementation calls the appropriate Move member function of the `CDaoRecordset` object associated with the record view.  \n  \n By default, `OnMove` updates the current record on the data source if the user has changed it in the record view.  \n  \n The Application Wizard creates a menu resource with First Record, Last Record, Next Record, and Previous Record menu items. If you select the Initial Toolbar option, the Application Wizard also creates a toolbar with buttons corresponding to these commands.  \n  \n If you move past the last record in the recordset, the record view continues to display the last record. If you move backward past the first record, the record view continues to display the first record.  \n  \n> [!CAUTION]\n>  Calling `OnMove` throws an exception if the recordset has no records. Call the appropriate user interface update handler function — **OnUpdateRecordFirst**, **OnUpdateRecordLast**, **OnUpdateRecordNext**, or **OnUpdateRecordPrev** — before the corresponding move operation to determine whether the recordset has any records.  \n  \n## See Also  \n [CFormView Class](../../mfc/reference/cformview-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CDaoRecordset Class](../../mfc/reference/cdaorecordset-class.md)   \n [CDaoTableDef Class](../../mfc/reference/cdaotabledef-class.md)   \n [CDaoQueryDef Class](../../mfc/reference/cdaoquerydef-class.md)   \n [CDaoDatabase Class](../../mfc/reference/cdaodatabase-class.md)   \n [CDaoWorkspace Class](../../mfc/reference/cdaoworkspace-class.md)   \n [CFormView Class](../../mfc/reference/cformview-class.md)\n"}