{"nodes":[{"pos":[12,46],"content":"COleControl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleControl Class | Microsoft Docs","pos":[0,34]}]},{"pos":[747,764],"content":"COleControl Class","linkify":"COleControl Class","nodes":[{"content":"COleControl Class","pos":[0,17]}]},{"content":"A powerful base class for developing OLE controls.","pos":[765,815]},{"pos":[824,830],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[888,895],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[905,924],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[931,935]},{"content":"Description","pos":[936,947]},{"pos":[985,1038],"content":"<bpt id=\"p1\">[</bpt>COleControl::COleControl<ept id=\"p1\">](#colecontrol__colecontrol)</ept>","source":"[COleControl::COleControl](#colecontrol__colecontrol)"},{"pos":[1039,1070],"content":"Creates a <ph id=\"ph1\">`COleControl`</ph> object.","source":"Creates a `COleControl` object."},{"pos":[1081,1095],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1102,1106]},{"content":"Description","pos":[1107,1118]},{"pos":[1156,1221],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientAppearance<ept id=\"p1\">](#colecontrol__ambientappearance)</ept>","source":"[COleControl::AmbientAppearance](#colecontrol__ambientappearance)"},{"content":"Retrieves the current appearance of the control.","pos":[1222,1270]},{"pos":[1275,1338],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientBackColor<ept id=\"p1\">](#colecontrol__ambientbackcolor)</ept>","source":"[COleControl::AmbientBackColor](#colecontrol__ambientbackcolor)"},{"content":"Returns the value of the ambient BackColor property.","pos":[1339,1391]},{"pos":[1396,1463],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientDisplayName<ept id=\"p1\">](#colecontrol__ambientdisplayname)</ept>","source":"[COleControl::AmbientDisplayName](#colecontrol__ambientdisplayname)"},{"content":"Returns the name of the control as specified by the container.","pos":[1464,1526]},{"pos":[1531,1584],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientFont<ept id=\"p1\">](#colecontrol__ambientfont)</ept>","source":"[COleControl::AmbientFont](#colecontrol__ambientfont)"},{"content":"Returns the value of the ambient Font property.","pos":[1585,1632]},{"pos":[1637,1700],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientForeColor<ept id=\"p1\">](#colecontrol__ambientforecolor)</ept>","source":"[COleControl::AmbientForeColor](#colecontrol__ambientforecolor)"},{"content":"Returns the value of the ambient ForeColor property.","pos":[1701,1753]},{"pos":[1758,1819],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientLocaleID<ept id=\"p1\">](#colecontrol__ambientlocaleid)</ept>","source":"[COleControl::AmbientLocaleID](#colecontrol__ambientlocaleid)"},{"content":"Returns the container's locale ID.","pos":[1820,1854]},{"pos":[1859,1924],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientScaleUnits<ept id=\"p1\">](#colecontrol__ambientscaleunits)</ept>","source":"[COleControl::AmbientScaleUnits](#colecontrol__ambientscaleunits)"},{"content":"Returns the type of units used by the container.","pos":[1925,1973]},{"pos":[1978,2053],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientShowGrabHandles<ept id=\"p1\">](#colecontrol__ambientshowgrabhandles)</ept>","source":"[COleControl::AmbientShowGrabHandles](#colecontrol__ambientshowgrabhandles)"},{"content":"Determines if grab handles should be displayed.","pos":[2054,2101]},{"pos":[2106,2175],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientShowHatching<ept id=\"p1\">](#colecontrol__ambientshowhatching)</ept>","source":"[COleControl::AmbientShowHatching](#colecontrol__ambientshowhatching)"},{"content":"Determines if hatching should be displayed.","pos":[2176,2219]},{"pos":[2224,2287],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientTextAlign<ept id=\"p1\">](#colecontrol__ambienttextalign)</ept>","source":"[COleControl::AmbientTextAlign](#colecontrol__ambienttextalign)"},{"content":"Returns the type of text alignment specified by the container.","pos":[2288,2350]},{"pos":[2355,2412],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientUIDead<ept id=\"p1\">](#colecontrol__ambientuidead)</ept>","source":"[COleControl::AmbientUIDead](#colecontrol__ambientuidead)"},{"content":"Determines if the control should respond to user-interface actions.","pos":[2413,2480]},{"pos":[2485,2546],"content":"<bpt id=\"p1\">[</bpt>COleControl::AmbientUserMode<ept id=\"p1\">](#colecontrol__ambientusermode)</ept>","source":"[COleControl::AmbientUserMode](#colecontrol__ambientusermode)"},{"content":"Determines the mode of the container.","pos":[2547,2584]},{"pos":[2589,2660],"content":"<bpt id=\"p1\">[</bpt>COleControl::BoundPropertyChanged<ept id=\"p1\">](#colecontrol__boundpropertychanged)</ept>","source":"[COleControl::BoundPropertyChanged](#colecontrol__boundpropertychanged)"},{"content":"Notifies the container that a bound property has been changed.","pos":[2661,2723]},{"pos":[2728,2807],"content":"<bpt id=\"p1\">[</bpt>COleControl::BoundPropertyRequestEdit<ept id=\"p1\">](#colecontrol__boundpropertyrequestedit)</ept>","source":"[COleControl::BoundPropertyRequestEdit](#colecontrol__boundpropertyrequestedit)"},{"content":"Requests permission to edit the property value.","pos":[2808,2855]},{"pos":[2860,2919],"content":"<bpt id=\"p1\">[</bpt>COleControl::ClientToParent<ept id=\"p1\">](#colecontrol__clienttoparent)</ept>","source":"[COleControl::ClientToParent](#colecontrol__clienttoparent)"},{"content":"Translates a point relative to the control's origin to a point relative to its container's origin.","pos":[2920,3018]},{"pos":[3023,3080],"content":"<bpt id=\"p1\">[</bpt>COleControl::ClipCaretRect<ept id=\"p1\">](#colecontrol__clipcaretrect)</ept>","source":"[COleControl::ClipCaretRect](#colecontrol__clipcaretrect)"},{"content":"Adjusts a caret rectangle if it is overlapped by a control.","pos":[3081,3140]},{"pos":[3145,3212],"content":"<bpt id=\"p1\">[</bpt>COleControl::ControlInfoChanged<ept id=\"p1\">](#colecontrol__controlinfochanged)</ept>","source":"[COleControl::ControlInfoChanged](#colecontrol__controlinfochanged)"},{"content":"Call this function after the set of mnemonics handled by the control has changed.","pos":[3213,3294]},{"pos":[3299,3354],"content":"<bpt id=\"p1\">[</bpt>COleControl::DisplayError<ept id=\"p1\">](#colecontrol__displayerror)</ept>","source":"[COleControl::DisplayError](#colecontrol__displayerror)"},{"content":"Displays stock Error events to the control's user.","pos":[3355,3405]},{"pos":[3410,3455],"content":"<bpt id=\"p1\">[</bpt>COleControl::DoClick<ept id=\"p1\">](#colecontrol__doclick)</ept>","source":"[COleControl::DoClick](#colecontrol__doclick)"},{"pos":[3456,3501],"content":"Implementation of the stock <ph id=\"ph1\">`DoClick`</ph> method.","source":"Implementation of the stock `DoClick` method."},{"pos":[3506,3565],"content":"<bpt id=\"p1\">[</bpt>COleControl::DoPropExchange<ept id=\"p1\">](#colecontrol__dopropexchange)</ept>","source":"[COleControl::DoPropExchange](#colecontrol__dopropexchange)"},{"pos":[3566,3618],"content":"Serializes the properties of a <ph id=\"ph1\">`COleControl`</ph> object.","source":"Serializes the properties of a `COleControl` object."},{"pos":[3623,3688],"content":"<bpt id=\"p1\">[</bpt>COleControl::DoSuperclassPaint<ept id=\"p1\">](#colecontrol__dosuperclasspaint)</ept>","source":"[COleControl::DoSuperclassPaint](#colecontrol__dosuperclasspaint)"},{"content":"Redraws an OLE control that has been subclassed from a Windows control.","pos":[3689,3760]},{"pos":[3765,3830],"content":"<bpt id=\"p1\">[</bpt>COleControl::EnableSimpleFrame<ept id=\"p1\">](#colecontrol__enablesimpleframe)</ept>","source":"[COleControl::EnableSimpleFrame](#colecontrol__enablesimpleframe)"},{"content":"Enables simple frame support for a control.","pos":[3831,3874]},{"pos":[3879,3938],"content":"<bpt id=\"p1\">[</bpt>COleControl::ExchangeExtent<ept id=\"p1\">](#colecontrol__exchangeextent)</ept>","source":"[COleControl::ExchangeExtent](#colecontrol__exchangeextent)"},{"content":"Serializes the control's width and height.","pos":[3939,3981]},{"pos":[3986,4053],"content":"<bpt id=\"p1\">[</bpt>COleControl::ExchangeStockProps<ept id=\"p1\">](#colecontrol__exchangestockprops)</ept>","source":"[COleControl::ExchangeStockProps](#colecontrol__exchangestockprops)"},{"content":"Serializes the control's stock properties.","pos":[4054,4096]},{"pos":[4101,4162],"content":"<bpt id=\"p1\">[</bpt>COleControl::ExchangeVersion<ept id=\"p1\">](#colecontrol__exchangeversion)</ept>","source":"[COleControl::ExchangeVersion](#colecontrol__exchangeversion)"},{"content":"Serializes the control's version number.","pos":[4163,4203]},{"pos":[4208,4257],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireClick<ept id=\"p1\">](#colecontrol__fireclick)</ept>","source":"[COleControl::FireClick](#colecontrol__fireclick)"},{"pos":[4258,4288],"content":"Fires the stock <ph id=\"ph1\">`Click`</ph> event.","source":"Fires the stock `Click` event."},{"pos":[4293,4348],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireDblClick<ept id=\"p1\">](#colecontrol__firedblclick)</ept>","source":"[COleControl::FireDblClick](#colecontrol__firedblclick)"},{"pos":[4349,4382],"content":"Fires the stock <ph id=\"ph1\">`DblClick`</ph> event.","source":"Fires the stock `DblClick` event."},{"pos":[4387,4436],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireError<ept id=\"p1\">](#colecontrol__fireerror)</ept>","source":"[COleControl::FireError](#colecontrol__fireerror)"},{"pos":[4437,4467],"content":"Fires the stock <ph id=\"ph1\">`Error`</ph> event.","source":"Fires the stock `Error` event."},{"pos":[4472,4521],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireEvent<ept id=\"p1\">](#colecontrol__fireevent)</ept>","source":"[COleControl::FireEvent](#colecontrol__fireevent)"},{"content":"Fires a custom event.","pos":[4522,4543]},{"pos":[4548,4601],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireKeyDown<ept id=\"p1\">](#colecontrol__firekeydown)</ept>","source":"[COleControl::FireKeyDown](#colecontrol__firekeydown)"},{"pos":[4602,4634],"content":"Fires the stock <ph id=\"ph1\">`KeyDown`</ph> event.","source":"Fires the stock `KeyDown` event."},{"pos":[4639,4694],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireKeyPress<ept id=\"p1\">](#colecontrol__firekeypress)</ept>","source":"[COleControl::FireKeyPress](#colecontrol__firekeypress)"},{"pos":[4695,4728],"content":"Fires the stock <ph id=\"ph1\">`KeyPress`</ph> event.","source":"Fires the stock `KeyPress` event."},{"pos":[4733,4782],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireKeyUp<ept id=\"p1\">](#colecontrol__firekeyup)</ept>","source":"[COleControl::FireKeyUp](#colecontrol__firekeyup)"},{"pos":[4783,4813],"content":"Fires the stock <ph id=\"ph1\">`KeyUp`</ph> event.","source":"Fires the stock `KeyUp` event."},{"pos":[4818,4875],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireMouseDown<ept id=\"p1\">](#colecontrol__firemousedown)</ept>","source":"[COleControl::FireMouseDown](#colecontrol__firemousedown)"},{"pos":[4876,4910],"content":"Fires the stock <ph id=\"ph1\">`MouseDown`</ph> event.","source":"Fires the stock `MouseDown` event."},{"pos":[4915,4972],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireMouseMove<ept id=\"p1\">](#colecontrol__firemousemove)</ept>","source":"[COleControl::FireMouseMove](#colecontrol__firemousemove)"},{"pos":[4973,5007],"content":"Fires the stock <ph id=\"ph1\">`MouseMove`</ph> event.","source":"Fires the stock `MouseMove` event."},{"pos":[5012,5065],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireMouseUp<ept id=\"p1\">](#colecontrol__firemouseup)</ept>","source":"[COleControl::FireMouseUp](#colecontrol__firemouseup)"},{"pos":[5066,5098],"content":"Fires the stock <ph id=\"ph1\">`MouseUp`</ph> event.","source":"Fires the stock `MouseUp` event."},{"pos":[5103,5174],"content":"<bpt id=\"p1\">[</bpt>COleControl::FireReadyStateChange<ept id=\"p1\">](#colecontrol__firereadystatechange)</ept>","source":"[COleControl::FireReadyStateChange](#colecontrol__firereadystatechange)"},{"content":"Fires an event when the control's ready state changes.","pos":[5175,5229]},{"pos":[5234,5303],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetActivationPolicy<ept id=\"p1\">](#colecontrol__getactivationpolicy)</ept>","source":"[COleControl::GetActivationPolicy](#colecontrol__getactivationpolicy)"},{"pos":[5304,5403],"content":"Alters the default activation behavior of a control that supports the <ph id=\"ph1\">`IPointerInactive`</ph> interface.","source":"Alters the default activation behavior of a control that supports the `IPointerInactive` interface."},{"pos":[5408,5475],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetAmbientProperty<ept id=\"p1\">](#colecontrol__getambientproperty)</ept>","source":"[COleControl::GetAmbientProperty](#colecontrol__getambientproperty)"},{"content":"Returns the value of the specified ambient property.","pos":[5476,5528]},{"pos":[5533,5590],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetAppearance<ept id=\"p1\">](#colecontrol__getappearance)</ept>","source":"[COleControl::GetAppearance](#colecontrol__getappearance)"},{"content":"Returns the value of the stock Appearance property.","pos":[5591,5642]},{"pos":[5647,5702],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetBackColor<ept id=\"p1\">](#colecontrol__getbackcolor)</ept>","source":"[COleControl::GetBackColor](#colecontrol__getbackcolor)"},{"content":"Returns the value of the stock BackColor property.","pos":[5703,5753]},{"pos":[5758,5817],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetBorderStyle<ept id=\"p1\">](#colecontrol__getborderstyle)</ept>","source":"[COleControl::GetBorderStyle](#colecontrol__getborderstyle)"},{"content":"Returns the value of the stock BorderStyle property.","pos":[5818,5870]},{"pos":[5875,5926],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetCapture<ept id=\"p1\">](#colecontrol__getcapture)</ept>","source":"[COleControl::GetCapture](#colecontrol__getcapture)"},{"content":"Determines whether a windowless, activated control object has the mouse capture.","pos":[5927,6007]},{"pos":[6012,6063],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetClassID<ept id=\"p1\">](#colecontrol__getclassid)</ept>","source":"[COleControl::GetClassID](#colecontrol__getclassid)"},{"content":"Retrieves the OLE class ID of the control.","pos":[6064,6106]},{"pos":[6111,6172],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetClientOffset<ept id=\"p1\">](#colecontrol__getclientoffset)</ept>","source":"[COleControl::GetClientOffset](#colecontrol__getclientoffset)"},{"content":"Retrieves the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area.","pos":[6173,6307]},{"pos":[6312,6369],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetClientRect<ept id=\"p1\">](#colecontrol__getclientrect)</ept>","source":"[COleControl::GetClientRect](#colecontrol__getclientrect)"},{"content":"Retrieves the size of the control's client area.","pos":[6370,6418]},{"pos":[6423,6480],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetClientSite<ept id=\"p1\">](#colecontrol__getclientsite)</ept>","source":"[COleControl::GetClientSite](#colecontrol__getclientsite)"},{"content":"Queries an object for the pointer to its current client site within its container.","pos":[6481,6563]},{"pos":[6568,6629],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetControlFlags<ept id=\"p1\">](#colecontrol__getcontrolflags)</ept>","source":"[COleControl::GetControlFlags](#colecontrol__getcontrolflags)"},{"content":"Retrieves the control flag settings.","pos":[6630,6666]},{"pos":[6671,6730],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetControlSize<ept id=\"p1\">](#colecontrol__getcontrolsize)</ept>","source":"[COleControl::GetControlSize](#colecontrol__getcontrolsize)"},{"content":"Returns the position and size of the OLE control.","pos":[6731,6780]},{"pos":[6785,6826],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetDC<ept id=\"p1\">](#colecontrol__getdc)</ept>","source":"[COleControl::GetDC](#colecontrol__getdc)"},{"content":"Provides a means for a windowless control to get a device context from its container.","pos":[6827,6912]},{"pos":[6917,6968],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetEnabled<ept id=\"p1\">](#colecontrol__getenabled)</ept>","source":"[COleControl::GetEnabled](#colecontrol__getenabled)"},{"content":"Returns the value of the stock Enabled property.","pos":[6969,7017]},{"pos":[7022,7089],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetExtendedControl<ept id=\"p1\">](#colecontrol__getextendedcontrol)</ept>","source":"[COleControl::GetExtendedControl](#colecontrol__getextendedcontrol)"},{"content":"Retrieves a pointer to an extended control object belonging to the container.","pos":[7090,7167]},{"pos":[7172,7219],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetFocus<ept id=\"p1\">](#colecontrol__getfocus)</ept>","source":"[COleControl::GetFocus](#colecontrol__getfocus)"},{"content":"Determines whether the control has the focus.","pos":[7220,7265]},{"pos":[7270,7315],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetFont<ept id=\"p1\">](#colecontrol__getfont)</ept>","source":"[COleControl::GetFont](#colecontrol__getfont)"},{"content":"Returns the value of the stock Font property.","pos":[7316,7361]},{"pos":[7366,7433],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetFontTextMetrics<ept id=\"p1\">](#colecontrol__getfonttextmetrics)</ept>","source":"[COleControl::GetFontTextMetrics](#colecontrol__getfonttextmetrics)"},{"pos":[7434,7480],"content":"Returns the metrics of a <ph id=\"ph1\">`CFontHolder`</ph> object.","source":"Returns the metrics of a `CFontHolder` object."},{"pos":[7485,7540],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetForeColor<ept id=\"p1\">](#colecontrol__getforecolor)</ept>","source":"[COleControl::GetForeColor](#colecontrol__getforecolor)"},{"content":"Returns the value of the stock ForeColor property.","pos":[7541,7591]},{"pos":[7596,7641],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetHwnd<ept id=\"p1\">](#colecontrol__gethwnd)</ept>","source":"[COleControl::GetHwnd](#colecontrol__gethwnd)"},{"content":"Returns the value of the stock hWnd property.","pos":[7642,7687]},{"pos":[7692,7755],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetMessageString<ept id=\"p1\">](#colecontrol__getmessagestring)</ept>","source":"[COleControl::GetMessageString](#colecontrol__getmessagestring)"},{"content":"Provides status bar text for a menu item.","pos":[7756,7797]},{"pos":[7802,7863],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetNotSupported<ept id=\"p1\">](#colecontrol__getnotsupported)</ept>","source":"[COleControl::GetNotSupported](#colecontrol__getnotsupported)"},{"content":"Prevents access to a control's property value by the user.","pos":[7864,7922]},{"pos":[7927,7984],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetReadyState<ept id=\"p1\">](#colecontrol__getreadystate)</ept>","source":"[COleControl::GetReadyState](#colecontrol__getreadystate)"},{"content":"Returns the control's readiness state.","pos":[7985,8023]},{"pos":[8028,8095],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetRectInContainer<ept id=\"p1\">](#colecontrol__getrectincontainer)</ept>","source":"[COleControl::GetRectInContainer](#colecontrol__getrectincontainer)"},{"content":"Returns the control's rectangle relative to its container.","pos":[8096,8154]},{"pos":[8159,8228],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetStockTextMetrics<ept id=\"p1\">](#colecontrol__getstocktextmetrics)</ept>","source":"[COleControl::GetStockTextMetrics](#colecontrol__getstocktextmetrics)"},{"content":"Returns the metrics of the stock Font property.","pos":[8229,8276]},{"pos":[8281,8326],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetText<ept id=\"p1\">](#colecontrol__gettext)</ept>","source":"[COleControl::GetText](#colecontrol__gettext)"},{"content":"Returns the value of the stock Text or Caption property.","pos":[8327,8383]},{"pos":[8388,8465],"content":"<bpt id=\"p1\">[</bpt>COleControl::GetWindowlessDropTarget<ept id=\"p1\">](#colecontrol__getwindowlessdroptarget)</ept>","source":"[COleControl::GetWindowlessDropTarget](#colecontrol__getwindowlessdroptarget)"},{"content":"Override to allow a windowless control to be the target of drag and drop operations.","pos":[8466,8550]},{"pos":[8555,8614],"content":"<bpt id=\"p1\">[</bpt>COleControl::InitializeIIDs<ept id=\"p1\">](#colecontrol__initializeiids)</ept>","source":"[COleControl::InitializeIIDs](#colecontrol__initializeiids)"},{"content":"Informs the base class of the IIDs the control will use.","pos":[8615,8671]},{"pos":[8676,8737],"content":"<bpt id=\"p1\">[</bpt>COleControl::InternalGetFont<ept id=\"p1\">](#colecontrol__internalgetfont)</ept>","source":"[COleControl::InternalGetFont](#colecontrol__internalgetfont)"},{"pos":[8738,8797],"content":"Returns a <ph id=\"ph1\">`CFontHolder`</ph> object for the stock Font property.","source":"Returns a `CFontHolder` object for the stock Font property."},{"pos":[8802,8863],"content":"<bpt id=\"p1\">[</bpt>COleControl::InternalGetText<ept id=\"p1\">](#colecontrol__internalgettext)</ept>","source":"[COleControl::InternalGetText](#colecontrol__internalgettext)"},{"content":"Retrieves the stock Caption or Text property.","pos":[8864,8909]},{"pos":[8914,8987],"content":"<bpt id=\"p1\">[</bpt>COleControl::InternalSetReadyState<ept id=\"p1\">](#colecontrol__internalsetreadystate)</ept>","source":"[COleControl::InternalSetReadyState](#colecontrol__internalsetreadystate)"},{"content":"Sets the control's readiness state and fires the ready-state-change event.","pos":[8988,9062]},{"pos":[9067,9132],"content":"<bpt id=\"p1\">[</bpt>COleControl::InvalidateControl<ept id=\"p1\">](#colecontrol__invalidatecontrol)</ept>","source":"[COleControl::InvalidateControl](#colecontrol__invalidatecontrol)"},{"content":"Invalidates an area of the displayed control, causing it to be redrawn.","pos":[9133,9204]},{"pos":[9209,9266],"content":"<bpt id=\"p1\">[</bpt>COleControl::InvalidateRgn<ept id=\"p1\">](#colecontrol__invalidatergn)</ept>","source":"[COleControl::InvalidateRgn](#colecontrol__invalidatergn)"},{"content":"Invalidates the container window's client area within the given region.","pos":[9267,9338]},{"content":"Can be used to redraw windowless controls in the region.","pos":[9339,9395]},{"pos":[9400,9461],"content":"<bpt id=\"p1\">[</bpt>COleControl::IsConvertingVBX<ept id=\"p1\">](#colecontrol__isconvertingvbx)</ept>","source":"[COleControl::IsConvertingVBX](#colecontrol__isconvertingvbx)"},{"content":"Allows specialized loading of an OLE control.","pos":[9462,9507]},{"pos":[9512,9563],"content":"<bpt id=\"p1\">[</bpt>COleControl::IsModified<ept id=\"p1\">](#colecontrol__ismodified)</ept>","source":"[COleControl::IsModified](#colecontrol__ismodified)"},{"content":"Determines if the control state has changed.","pos":[9564,9608]},{"pos":[9613,9674],"content":"<bpt id=\"p1\">[</bpt>COleControl::IsOptimizedDraw<ept id=\"p1\">](#colecontrol__isoptimizeddraw)</ept>","source":"[COleControl::IsOptimizedDraw](#colecontrol__isoptimizeddraw)"},{"content":"Indicates whether the container supports optimized drawing for the current drawing operation.","pos":[9675,9768]},{"pos":[9773,9842],"content":"<bpt id=\"p1\">[</bpt>COleControl::IsSubclassedControl<ept id=\"p1\">](#colecontrol__issubclassedcontrol)</ept>","source":"[COleControl::IsSubclassedControl](#colecontrol__issubclassedcontrol)"},{"content":"Called to determine if the control subclasses a Windows control.","pos":[9843,9907]},{"pos":[9912,9951],"content":"<bpt id=\"p1\">[</bpt>COleControl::Load<ept id=\"p1\">](#colecontrol__load)</ept>","source":"[COleControl::Load](#colecontrol__load)"},{"content":"Resets any previous asynchronous data and initiates a new load of the control's asynchronous property.","pos":[9952,10054]},{"pos":[10059,10124],"content":"<bpt id=\"p1\">[</bpt>COleControl::LockInPlaceActive<ept id=\"p1\">](#colecontrol__lockinplaceactive)</ept>","source":"[COleControl::LockInPlaceActive](#colecontrol__lockinplaceactive)"},{"content":"Determines if your control can be deactivated by the container.","pos":[10125,10188]},{"pos":[10193,10270],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnAmbientPropertyChange<ept id=\"p1\">](#colecontrol__onambientpropertychange)</ept>","source":"[COleControl::OnAmbientPropertyChange](#colecontrol__onambientpropertychange)"},{"content":"Called when an ambient property is changed.","pos":[10271,10314]},{"pos":[10319,10388],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnAppearanceChanged<ept id=\"p1\">](#colecontrol__onappearancechanged)</ept>","source":"[COleControl::OnAppearanceChanged](#colecontrol__onappearancechanged)"},{"content":"Called when the stock Appearance property is changed.","pos":[10389,10442]},{"pos":[10447,10514],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnBackColorChanged<ept id=\"p1\">](#colecontrol__onbackcolorchanged)</ept>","source":"[COleControl::OnBackColorChanged](#colecontrol__onbackcolorchanged)"},{"content":"Called when the stock BackColor property is changed.","pos":[10515,10567]},{"pos":[10572,10643],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnBorderStyleChanged<ept id=\"p1\">](#colecontrol__onborderstylechanged)</ept>","source":"[COleControl::OnBorderStyleChanged](#colecontrol__onborderstylechanged)"},{"content":"Called when the stock BorderStyle property is changed.","pos":[10644,10698]},{"pos":[10703,10748],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnClick<ept id=\"p1\">](#colecontrol__onclick)</ept>","source":"[COleControl::OnClick](#colecontrol__onclick)"},{"content":"Called to fire the stock Click event.","pos":[10749,10786]},{"pos":[10791,10836],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnClose<ept id=\"p1\">](#colecontrol__onclose)</ept>","source":"[COleControl::OnClose](#colecontrol__onclose)"},{"pos":[10837,10900],"content":"Notifies the control that <ph id=\"ph1\">`IOleControl::Close`</ph> has been called.","source":"Notifies the control that `IOleControl::Close` has been called."},{"pos":[10905,10952],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnDoVerb<ept id=\"p1\">](#colecontrol__ondoverb)</ept>","source":"[COleControl::OnDoVerb](#colecontrol__ondoverb)"},{"content":"Called after a control verb has been executed.","pos":[10953,10999]},{"pos":[11004,11047],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnDraw<ept id=\"p1\">](#colecontrol__ondraw)</ept>","source":"[COleControl::OnDraw](#colecontrol__ondraw)"},{"content":"Called when a control is requested to redraw itself.","pos":[11048,11100]},{"pos":[11105,11164],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnDrawMetafile<ept id=\"p1\">](#colecontrol__ondrawmetafile)</ept>","source":"[COleControl::OnDrawMetafile](#colecontrol__ondrawmetafile)"},{"content":"Called by the container when a control is requested to redraw itself using a metafile device context.","pos":[11165,11266]},{"pos":[11271,11314],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnEdit<ept id=\"p1\">](#colecontrol__onedit)</ept>","source":"[COleControl::OnEdit](#colecontrol__onedit)"},{"content":"Called by the container to UI Activate an OLE control.","pos":[11315,11369]},{"pos":[11374,11437],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnEnabledChanged<ept id=\"p1\">](#colecontrol__onenabledchanged)</ept>","source":"[COleControl::OnEnabledChanged](#colecontrol__onenabledchanged)"},{"content":"Called when the stock Enabled property is changed.","pos":[11438,11488]},{"pos":[11493,11546],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnEnumVerbs<ept id=\"p1\">](#colecontrol__onenumverbs)</ept>","source":"[COleControl::OnEnumVerbs](#colecontrol__onenumverbs)"},{"content":"Called by the container to enumerate a control's verbs.","pos":[11547,11602]},{"pos":[11607,11664],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnEventAdvise<ept id=\"p1\">](#colecontrol__oneventadvise)</ept>","source":"[COleControl::OnEventAdvise](#colecontrol__oneventadvise)"},{"content":"Called when event handlers are connected or disconnected from a control.","pos":[11665,11737]},{"pos":[11742,11799],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnFontChanged<ept id=\"p1\">](#colecontrol__onfontchanged)</ept>","source":"[COleControl::OnFontChanged](#colecontrol__onfontchanged)"},{"content":"Called when the stock Font property is changed.","pos":[11800,11847]},{"pos":[11852,11919],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnForeColorChanged<ept id=\"p1\">](#colecontrol__onforecolorchanged)</ept>","source":"[COleControl::OnForeColorChanged](#colecontrol__onforecolorchanged)"},{"content":"Called when the stock ForeColor property is changed.","pos":[11920,11972]},{"pos":[11977,12036],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnFreezeEvents<ept id=\"p1\">](#colecontrol__onfreezeevents)</ept>","source":"[COleControl::OnFreezeEvents](#colecontrol__onfreezeevents)"},{"content":"Called when a control's events are frozen or unfrozen.","pos":[12037,12091]},{"pos":[12096,12153],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetColorSet<ept id=\"p1\">](#colecontrol__ongetcolorset)</ept>","source":"[COleControl::OnGetColorSet](#colecontrol__ongetcolorset)"},{"pos":[12154,12222],"content":"Notifies the control that <ph id=\"ph1\">`IOleObject::GetColorSet`</ph> has been called.","source":"Notifies the control that `IOleObject::GetColorSet` has been called."},{"pos":[12227,12290],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetControlInfo<ept id=\"p1\">](#colecontrol__ongetcontrolinfo)</ept>","source":"[COleControl::OnGetControlInfo](#colecontrol__ongetcontrolinfo)"},{"content":"Provides mnemonic information to the container.","pos":[12291,12338]},{"pos":[12343,12410],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetDisplayString<ept id=\"p1\">](#colecontrol__ongetdisplaystring)</ept>","source":"[COleControl::OnGetDisplayString](#colecontrol__ongetdisplaystring)"},{"content":"Called to obtain a string to represent a property value.","pos":[12411,12467]},{"pos":[12472,12535],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetInPlaceMenu<ept id=\"p1\">](#colecontrol__ongetinplacemenu)</ept>","source":"[COleControl::OnGetInPlaceMenu](#colecontrol__ongetinplacemenu)"},{"content":"Requests the handle of the control's menu that will be merged with the container menu.","pos":[12536,12622]},{"pos":[12627,12694],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetNaturalExtent<ept id=\"p1\">](#colecontrol__ongetnaturalextent)</ept>","source":"[COleControl::OnGetNaturalExtent](#colecontrol__ongetnaturalextent)"},{"content":"Override to retrieve the control's display size closest to the proposed size and extent mode.","pos":[12695,12788]},{"pos":[12793,12868],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetPredefinedStrings<ept id=\"p1\">](#colecontrol__ongetpredefinedstrings)</ept>","source":"[COleControl::OnGetPredefinedStrings](#colecontrol__ongetpredefinedstrings)"},{"content":"Returns strings representing possible values for a property.","pos":[12869,12929]},{"pos":[12934,13005],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetPredefinedValue<ept id=\"p1\">](#colecontrol__ongetpredefinedvalue)</ept>","source":"[COleControl::OnGetPredefinedValue](#colecontrol__ongetpredefinedvalue)"},{"content":"Returns the value corresponding to a predefined string.","pos":[13006,13061]},{"pos":[13066,13127],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetViewExtent<ept id=\"p1\">](#colecontrol__ongetviewextent)</ept>","source":"[COleControl::OnGetViewExtent](#colecontrol__ongetviewextent)"},{"content":"Override to retrieve the size of the control's display areas (can be used to enable two-pass drawing).","pos":[13128,13230]},{"pos":[13235,13292],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetViewRect<ept id=\"p1\">](#colecontrol__ongetviewrect)</ept>","source":"[COleControl::OnGetViewRect](#colecontrol__ongetviewrect)"},{"content":"Override to convert control's size into a rectangle starting at a specific position.","pos":[13293,13377]},{"pos":[13382,13443],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnGetViewStatus<ept id=\"p1\">](#colecontrol__ongetviewstatus)</ept>","source":"[COleControl::OnGetViewStatus](#colecontrol__ongetviewstatus)"},{"content":"Override to retrieve the control's view status.","pos":[13444,13491]},{"pos":[13496,13555],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnHideToolBars<ept id=\"p1\">](#colecontrol__onhidetoolbars)</ept>","source":"[COleControl::OnHideToolBars](#colecontrol__onhidetoolbars)"},{"content":"Called by the container when the control is UI deactivated.","pos":[13556,13615]},{"pos":[13620,13689],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnInactiveMouseMove<ept id=\"p1\">](#colecontrol__oninactivemousemove)</ept>","source":"[COleControl::OnInactiveMouseMove](#colecontrol__oninactivemousemove)"},{"pos":[13690,13818],"content":"Override to have the container for the inactive control under the mouse pointer dispatch <ph id=\"ph1\">`WM_MOUSEMOVE`</ph> messages to the control.","source":"Override to have the container for the inactive control under the mouse pointer dispatch `WM_MOUSEMOVE` messages to the control."},{"pos":[13823,13892],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnInactiveSetCursor<ept id=\"p1\">](#colecontrol__oninactivesetcursor)</ept>","source":"[COleControl::OnInactiveSetCursor](#colecontrol__oninactivesetcursor)"},{"pos":[13893,14021],"content":"Override to have the container for the inactive control under the mouse pointer dispatch <ph id=\"ph1\">`WM_SETCURSOR`</ph> messages to the control.","source":"Override to have the container for the inactive control under the mouse pointer dispatch `WM_SETCURSOR` messages to the control."},{"pos":[14026,14085],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnKeyDownEvent<ept id=\"p1\">](#colecontrol__onkeydownevent)</ept>","source":"[COleControl::OnKeyDownEvent](#colecontrol__onkeydownevent)"},{"content":"Called after the stock KeyDown event has been fired.","pos":[14086,14138]},{"pos":[14143,14204],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnKeyPressEvent<ept id=\"p1\">](#colecontrol__onkeypressevent)</ept>","source":"[COleControl::OnKeyPressEvent](#colecontrol__onkeypressevent)"},{"content":"Called after the stock KeyPress event has been fired.","pos":[14205,14258]},{"pos":[14263,14318],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnKeyUpEvent<ept id=\"p1\">](#colecontrol__onkeyupevent)</ept>","source":"[COleControl::OnKeyUpEvent](#colecontrol__onkeyupevent)"},{"content":"Called after the stock KeyUp event has been fired.","pos":[14319,14369]},{"pos":[14374,14443],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnMapPropertyToPage<ept id=\"p1\">](#colecontrol__onmappropertytopage)</ept>","source":"[COleControl::OnMapPropertyToPage](#colecontrol__onmappropertytopage)"},{"content":"Indicates which property page to use for editing a property.","pos":[14444,14504]},{"pos":[14509,14560],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnMnemonic<ept id=\"p1\">](#colecontrol__onmnemonic)</ept>","source":"[COleControl::OnMnemonic](#colecontrol__onmnemonic)"},{"content":"Called when a mnemonic key of the control has been pressed.","pos":[14561,14620]},{"pos":[14625,14680],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnProperties<ept id=\"p1\">](#colecontrol__onproperties)</ept>","source":"[COleControl::OnProperties](#colecontrol__onproperties)"},{"content":"Called when the control's \"Properties\" verb has been invoked.","pos":[14681,14742]},{"pos":[14747,14808],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnQueryHitPoint<ept id=\"p1\">](#colecontrol__onqueryhitpoint)</ept>","source":"[COleControl::OnQueryHitPoint](#colecontrol__onqueryhitpoint)"},{"content":"Override to query whether a control's display overlaps a given point.","pos":[14809,14878]},{"pos":[14883,14942],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnQueryHitRect<ept id=\"p1\">](#colecontrol__onqueryhitrect)</ept>","source":"[COleControl::OnQueryHitRect](#colecontrol__onqueryhitrect)"},{"content":"Override to query whether a control's display overlaps any point in a given rectangle.","pos":[14943,15029]},{"pos":[15034,15089],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnRenderData<ept id=\"p1\">](#colecontrol__onrenderdata)</ept>","source":"[COleControl::OnRenderData](#colecontrol__onrenderdata)"},{"content":"Called by the framework to retrieve data in the specified format.","pos":[15090,15155]},{"pos":[15160,15223],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnRenderFileData<ept id=\"p1\">](#colecontrol__onrenderfiledata)</ept>","source":"[COleControl::OnRenderFileData](#colecontrol__onrenderfiledata)"},{"content":"Called by the framework to retrieve data from a file in the specified format.","pos":[15224,15301]},{"pos":[15306,15373],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnRenderGlobalData<ept id=\"p1\">](#colecontrol__onrenderglobaldata)</ept>","source":"[COleControl::OnRenderGlobalData](#colecontrol__onrenderglobaldata)"},{"content":"Called by the framework to retrieve data from global memory in the specified format.","pos":[15374,15458]},{"pos":[15463,15518],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnResetState<ept id=\"p1\">](#colecontrol__onresetstate)</ept>","source":"[COleControl::OnResetState](#colecontrol__onresetstate)"},{"content":"Resets a control's properties to the default values.","pos":[15519,15571]},{"pos":[15576,15637],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnSetClientSite<ept id=\"p1\">](#colecontrol__onsetclientsite)</ept>","source":"[COleControl::OnSetClientSite](#colecontrol__onsetclientsite)"},{"pos":[15638,15709],"content":"Notifies the control that <ph id=\"ph1\">`IOleControl::SetClientSite`</ph> has been called.","source":"Notifies the control that `IOleControl::SetClientSite` has been called."},{"pos":[15714,15763],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnSetData<ept id=\"p1\">](#colecontrol__onsetdata)</ept>","source":"[COleControl::OnSetData](#colecontrol__onsetdata)"},{"content":"Replaces the control's data with another value.","pos":[15764,15811]},{"pos":[15816,15869],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnSetExtent<ept id=\"p1\">](#colecontrol__onsetextent)</ept>","source":"[COleControl::OnSetExtent](#colecontrol__onsetextent)"},{"content":"Called after the control's extent has changed.","pos":[15870,15916]},{"pos":[15921,15984],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnSetObjectRects<ept id=\"p1\">](#colecontrol__onsetobjectrects)</ept>","source":"[COleControl::OnSetObjectRects](#colecontrol__onsetobjectrects)"},{"content":"Called after the control's dimensions have been changed.","pos":[15985,16041]},{"pos":[16046,16105],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnShowToolBars<ept id=\"p1\">](#colecontrol__onshowtoolbars)</ept>","source":"[COleControl::OnShowToolBars](#colecontrol__onshowtoolbars)"},{"content":"Called when the control has been UI activated.","pos":[16106,16152]},{"pos":[16157,16214],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnTextChanged<ept id=\"p1\">](#colecontrol__ontextchanged)</ept>","source":"[COleControl::OnTextChanged](#colecontrol__ontextchanged)"},{"content":"Called when the stock Text or Caption property is changed.","pos":[16215,16273]},{"pos":[16278,16347],"content":"<bpt id=\"p1\">[</bpt>COleControl::OnWindowlessMessage<ept id=\"p1\">](#colecontrol__onwindowlessmessage)</ept>","source":"[COleControl::OnWindowlessMessage](#colecontrol__onwindowlessmessage)"},{"content":"Processes window messages (other than mouse and keyboard messages) for windowless controls.","pos":[16348,16439]},{"pos":[16444,16503],"content":"<bpt id=\"p1\">[</bpt>COleControl::ParentToClient<ept id=\"p1\">](#colecontrol__parenttoclient)</ept>","source":"[COleControl::ParentToClient](#colecontrol__parenttoclient)"},{"content":"Translates a point relative to the container's origin to a point relative to the control's origin.","pos":[16504,16602]},{"pos":[16607,16668],"content":"<bpt id=\"p1\">[</bpt>COleControl::PostModalDialog<ept id=\"p1\">](#colecontrol__postmodaldialog)</ept>","source":"[COleControl::PostModalDialog](#colecontrol__postmodaldialog)"},{"content":"Notifies the container that a modal dialog box has been closed.","pos":[16669,16732]},{"pos":[16737,16796],"content":"<bpt id=\"p1\">[</bpt>COleControl::PreModalDialog<ept id=\"p1\">](#colecontrol__premodaldialog)</ept>","source":"[COleControl::PreModalDialog](#colecontrol__premodaldialog)"},{"content":"Notifies the container that a modal dialog box is about to be displayed.","pos":[16797,16869]},{"pos":[16874,16947],"content":"<bpt id=\"p1\">[</bpt>COleControl::RecreateControlWindow<ept id=\"p1\">](#colecontrol__recreatecontrolwindow)</ept>","source":"[COleControl::RecreateControlWindow](#colecontrol__recreatecontrolwindow)"},{"content":"Destroys and re-creates the control's window.","pos":[16948,16993]},{"pos":[16998,17043],"content":"<bpt id=\"p1\">[</bpt>COleControl::Refresh<ept id=\"p1\">](#colecontrol__refresh)</ept>","source":"[COleControl::Refresh](#colecontrol__refresh)"},{"content":"Forces a repaint of a control's appearance.","pos":[17044,17087]},{"pos":[17092,17151],"content":"<bpt id=\"p1\">[</bpt>COleControl::ReleaseCapture<ept id=\"p1\">](#colecontrol__releasecapture)</ept>","source":"[COleControl::ReleaseCapture](#colecontrol__releasecapture)"},{"content":"Releases mouse capture.","pos":[17152,17175]},{"pos":[17180,17229],"content":"<bpt id=\"p1\">[</bpt>COleControl::ReleaseDC<ept id=\"p1\">](#colecontrol__releasedc)</ept>","source":"[COleControl::ReleaseDC](#colecontrol__releasedc)"},{"content":"Releases the display device context of a container of a windowless control.","pos":[17230,17305]},{"pos":[17310,17383],"content":"<bpt id=\"p1\">[</bpt>COleControl::ReparentControlWindow<ept id=\"p1\">](#colecontrol__reparentcontrolwindow)</ept>","source":"[COleControl::ReparentControlWindow](#colecontrol__reparentcontrolwindow)"},{"content":"Resets the parent of the control window.","pos":[17384,17424]},{"pos":[17429,17490],"content":"<bpt id=\"p1\">[</bpt>COleControl::ResetStockProps<ept id=\"p1\">](#colecontrol__resetstockprops)</ept>","source":"[COleControl::ResetStockProps](#colecontrol__resetstockprops)"},{"pos":[17491,17558],"content":"Initializes <ph id=\"ph1\">`COleControl`</ph> stock properties to their default values.","source":"Initializes `COleControl` stock properties to their default values."},{"pos":[17563,17618],"content":"<bpt id=\"p1\">[</bpt>COleControl::ResetVersion<ept id=\"p1\">](#colecontrol__resetversion)</ept>","source":"[COleControl::ResetVersion](#colecontrol__resetversion)"},{"content":"Initializes the version number to a given value.","pos":[17619,17667]},{"pos":[17672,17727],"content":"<bpt id=\"p1\">[</bpt>COleControl::ScrollWindow<ept id=\"p1\">](#colecontrol__scrollwindow)</ept>","source":"[COleControl::ScrollWindow](#colecontrol__scrollwindow)"},{"content":"Allows a windowless control to scroll an area within its in-place active image on the display.","pos":[17728,17822]},{"pos":[17827,17890],"content":"<bpt id=\"p1\">[</bpt>COleControl::SelectFontObject<ept id=\"p1\">](#colecontrol__selectfontobject)</ept>","source":"[COleControl::SelectFontObject](#colecontrol__selectfontobject)"},{"content":"Selects a custom Font property into a device context.","pos":[17891,17944]},{"pos":[17949,18010],"content":"<bpt id=\"p1\">[</bpt>COleControl::SelectStockFont<ept id=\"p1\">](#colecontrol__selectstockfont)</ept>","source":"[COleControl::SelectStockFont](#colecontrol__selectstockfont)"},{"content":"Selects the stock Font property into a device context.","pos":[18011,18065]},{"pos":[18070,18131],"content":"<bpt id=\"p1\">[</bpt>COleControl::SerializeExtent<ept id=\"p1\">](#colecontrol__serializeextent)</ept>","source":"[COleControl::SerializeExtent](#colecontrol__serializeextent)"},{"content":"Serializes or initializes the display space for the control.","pos":[18132,18192]},{"pos":[18197,18266],"content":"<bpt id=\"p1\">[</bpt>COleControl::SerializeStockProps<ept id=\"p1\">](#colecontrol__serializestockprops)</ept>","source":"[COleControl::SerializeStockProps](#colecontrol__serializestockprops)"},{"pos":[18267,18328],"content":"Serializes or initializes the <ph id=\"ph1\">`COleControl`</ph> stock properties.","source":"Serializes or initializes the `COleControl` stock properties."},{"pos":[18333,18396],"content":"<bpt id=\"p1\">[</bpt>COleControl::SerializeVersion<ept id=\"p1\">](#colecontrol__serializeversion)</ept>","source":"[COleControl::SerializeVersion](#colecontrol__serializeversion)"},{"content":"Serializes or initializes the control's version information.","pos":[18397,18457]},{"pos":[18462,18519],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetAppearance<ept id=\"p1\">](#colecontrol__setappearance)</ept>","source":"[COleControl::SetAppearance](#colecontrol__setappearance)"},{"content":"Sets the value of the stock Appearance property.","pos":[18520,18568]},{"pos":[18573,18628],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetBackColor<ept id=\"p1\">](#colecontrol__setbackcolor)</ept>","source":"[COleControl::SetBackColor](#colecontrol__setbackcolor)"},{"content":"Sets the value of the stock BackColor property.","pos":[18629,18676]},{"pos":[18681,18740],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetBorderStyle<ept id=\"p1\">](#colecontrol__setborderstyle)</ept>","source":"[COleControl::SetBorderStyle](#colecontrol__setborderstyle)"},{"content":"Sets the value of the stock BorderStyle property.","pos":[18741,18790]},{"pos":[18795,18846],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetCapture<ept id=\"p1\">](#colecontrol__setcapture)</ept>","source":"[COleControl::SetCapture](#colecontrol__setcapture)"},{"content":"Causes the control's container window to take possession of the mouse capture on the control's behalf.","pos":[18847,18949]},{"pos":[18954,19013],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetControlSize<ept id=\"p1\">](#colecontrol__setcontrolsize)</ept>","source":"[COleControl::SetControlSize](#colecontrol__setcontrolsize)"},{"content":"Sets the position and size of the OLE control.","pos":[19014,19060]},{"pos":[19065,19116],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetEnabled<ept id=\"p1\">](#colecontrol__setenabled)</ept>","source":"[COleControl::SetEnabled](#colecontrol__setenabled)"},{"content":"Sets the value of the stock Enabled property.","pos":[19117,19162]},{"pos":[19167,19214],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetFocus<ept id=\"p1\">](#colecontrol__setfocus)</ept>","source":"[COleControl::SetFocus](#colecontrol__setfocus)"},{"content":"Causes the control's container window to take possession of the input focus on the control's behalf.","pos":[19215,19315]},{"pos":[19320,19365],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetFont<ept id=\"p1\">](#colecontrol__setfont)</ept>","source":"[COleControl::SetFont](#colecontrol__setfont)"},{"content":"Sets the value of the stock Font property.","pos":[19366,19408]},{"pos":[19413,19468],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetForeColor<ept id=\"p1\">](#colecontrol__setforecolor)</ept>","source":"[COleControl::SetForeColor](#colecontrol__setforecolor)"},{"content":"Sets the value of the stock ForeColor property.","pos":[19469,19516]},{"pos":[19521,19580],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetInitialSize<ept id=\"p1\">](#colecontrol__setinitialsize)</ept>","source":"[COleControl::SetInitialSize](#colecontrol__setinitialsize)"},{"content":"Sets the size of an OLE control when first displayed in a container.","pos":[19581,19649]},{"pos":[19654,19715],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetModifiedFlag<ept id=\"p1\">](#colecontrol__setmodifiedflag)</ept>","source":"[COleControl::SetModifiedFlag](#colecontrol__setmodifiedflag)"},{"content":"Changes the modified state of a control.","pos":[19716,19756]},{"pos":[19761,19822],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetNotPermitted<ept id=\"p1\">](#colecontrol__setnotpermitted)</ept>","source":"[COleControl::SetNotPermitted](#colecontrol__setnotpermitted)"},{"content":"Indicates that an edit request has failed.","pos":[19823,19865]},{"pos":[19870,19931],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetNotSupported<ept id=\"p1\">](#colecontrol__setnotsupported)</ept>","source":"[COleControl::SetNotSupported](#colecontrol__setnotsupported)"},{"content":"Prevents modification to a control's property value by the user.","pos":[19932,19996]},{"pos":[20001,20068],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetRectInContainer<ept id=\"p1\">](#colecontrol__setrectincontainer)</ept>","source":"[COleControl::SetRectInContainer](#colecontrol__setrectincontainer)"},{"content":"Sets the control's rectangle relative to its container.","pos":[20069,20124]},{"pos":[20129,20174],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetText<ept id=\"p1\">](#colecontrol__settext)</ept>","source":"[COleControl::SetText](#colecontrol__settext)"},{"content":"Sets the value of the stock Text or Caption property.","pos":[20175,20228]},{"pos":[20233,20284],"content":"<bpt id=\"p1\">[</bpt>COleControl::ThrowError<ept id=\"p1\">](#colecontrol__throwerror)</ept>","source":"[COleControl::ThrowError](#colecontrol__throwerror)"},{"content":"Signals that an error has occurred in an OLE control.","pos":[20285,20338]},{"pos":[20343,20404],"content":"<bpt id=\"p1\">[</bpt>COleControl::TransformCoords<ept id=\"p1\">](#colecontrol__transformcoords)</ept>","source":"[COleControl::TransformCoords](#colecontrol__transformcoords)"},{"content":"Transforms coordinate values between a container and the control.","pos":[20405,20470]},{"pos":[20475,20534],"content":"<bpt id=\"p1\">[</bpt>COleControl::TranslateColor<ept id=\"p1\">](#colecontrol__translatecolor)</ept>","source":"[COleControl::TranslateColor](#colecontrol__translatecolor)"},{"pos":[20535,20591],"content":"Converts an <bpt id=\"p1\">**</bpt>OLE_COLOR<ept id=\"p1\">**</ept> value to a <bpt id=\"p2\">**</bpt>COLORREF<ept id=\"p2\">**</ept> value.","source":"Converts an **OLE_COLOR** value to a **COLORREF** value."},{"pos":[20596,20685],"content":"<bpt id=\"p1\">[</bpt>COleControl::WillAmbientsBeValidDuringLoad<ept id=\"p1\">](#colecontrol__willambientsbevalidduringload)</ept>","source":"[COleControl::WillAmbientsBeValidDuringLoad](#colecontrol__willambientsbevalidduringload)"},{"content":"Determines whether ambient properties will be available the next time the control is loaded.","pos":[20686,20778]},{"pos":[20783,20834],"content":"<bpt id=\"p1\">[</bpt>COleControl::WindowProc<ept id=\"p1\">](#colecontrol__windowproc)</ept>","source":"[COleControl::WindowProc](#colecontrol__windowproc)"},{"pos":[20835,20891],"content":"Provides a Windows procedure for a <ph id=\"ph1\">`COleControl`</ph> object.","source":"Provides a Windows procedure for a `COleControl` object."},{"pos":[20902,20919],"content":"Protected Methods","linkify":"Protected Methods","nodes":[{"content":"Protected Methods","pos":[0,17]}]},{"content":"Name","pos":[20926,20930]},{"content":"Description","pos":[20931,20942]},{"pos":[20980,21033],"content":"<bpt id=\"p1\">[</bpt>COleControl::DrawContent<ept id=\"p1\">](#colecontrol__drawcontent)</ept>","source":"[COleControl::DrawContent](#colecontrol__drawcontent)"},{"content":"Called by the framework when the control's appearance needs to be updated.","pos":[21034,21108]},{"pos":[21113,21168],"content":"<bpt id=\"p1\">[</bpt>COleControl::DrawMetafile<ept id=\"p1\">](#colecontrol__drawmetafile)</ept>","source":"[COleControl::DrawMetafile](#colecontrol__drawmetafile)"},{"content":"Called by the framework when the metafile device context is being used.","pos":[21169,21240]},{"pos":[21245,21306],"content":"<bpt id=\"p1\">[</bpt>COleControl::IsInvokeAllowed<ept id=\"p1\">](#colecontrol__isinvokeallowed)</ept>","source":"[COleControl::IsInvokeAllowed](#colecontrol__isinvokeallowed)"},{"content":"Enables automation method invocation.","pos":[21307,21344]},{"pos":[21349,21422],"content":"<bpt id=\"p1\">[</bpt>COleControl::SetInitialDataFormats<ept id=\"p1\">](#colecontrol__setinitialdataformats)</ept>","source":"[COleControl::SetInitialDataFormats](#colecontrol__setinitialdataformats)"},{"content":"Called by the framework to initialize the list of data formats supported by the control.","pos":[21423,21511]},{"pos":[21521,21528],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[21532,21740],"content":"Derived from <ph id=\"ph1\">`CWnd`</ph>, this class inherits all the functionality of a Windows window object plus additional functionality specific to OLE, such as event firing and the ability to support methods and properties.","source":"Derived from `CWnd`, this class inherits all the functionality of a Windows window object plus additional functionality specific to OLE, such as event firing and the ability to support methods and properties."},{"content":"OLE controls can be inserted into OLE container applications and communicate with the container by using a two-way system of event firing and exposing methods and properties to the container.","pos":[21747,21938]},{"content":"Note that standard OLE containers only support the basic functionality of an OLE control.","pos":[21939,22028]},{"content":"They are unable to support extended features of an OLE control.","pos":[22029,22092]},{"content":"Event firing occurs when events are sent to the container as a result of certain actions taking place in the control.","pos":[22093,22210]},{"content":"In turn, the container communicates with the control by using an exposed set of methods and properties analogous to the member functions and data members of a C++ class.","pos":[22211,22380]},{"content":"This approach allows the developer to control the appearance of the control and notify the container when certain actions occur.","pos":[22381,22509]},{"pos":[22518,22537],"content":"Windowless Controls","linkify":"Windowless Controls","nodes":[{"content":"Windowless Controls","pos":[0,19]}]},{"content":"OLE controls can be used in-place active without a window.","pos":[22541,22599]},{"content":"Windowless controls have significant advantages:","pos":[22600,22648]},{"content":"Windowless controls can be transparent and non-rectangular","pos":[22658,22716]},{"content":"Windowless controls reduce instance size and creation time of the object","pos":[22726,22798]},{"content":"Controls do not need a window.","pos":[22805,22835]},{"content":"Services that a window offers can easily be provided via a single shared window (usually the container's) and a bit of dispatching code.","pos":[22836,22972]},{"content":"Having a window is mostly an unnecessary complication on the object.","pos":[22973,23041]},{"content":"When windowless activation is used, the container (which does have a window) is responsible for providing services that would otherwise have been provided by the control's own window.","pos":[23048,23231]},{"content":"For example, if your control needs to query the keyboard focus, query the mouse capture, or obtain a device context, these operations are managed by the container.","pos":[23232,23395]},{"content":"The <ph id=\"ph1\">`COleControl`</ph><bpt id=\"p1\">[</bpt>windowless-operation member functions<ept id=\"p1\">](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df)</ept> invoke these operations on the container.","pos":[23396,23564],"source":" The `COleControl`[windowless-operation member functions](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) invoke these operations on the container."},{"content":"When windowless activation is enabled, the container delegates input messages to the control's <ph id=\"ph1\">`IOleInPlaceObjectWindowless`</ph> interface (an extension of <bpt id=\"p1\">[</bpt>IOleInPlaceObject<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms692646)</ept> for windowless support).","pos":[23571,23827],"source":"When windowless activation is enabled, the container delegates input messages to the control's `IOleInPlaceObjectWindowless` interface (an extension of [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) for windowless support)."},{"content":"<ph id=\"ph1\">`COleControl`</ph>'s implementation of this interface will dispatch these messages through your control's message map, after adjusting the mouse coordinates appropriately.","pos":[23828,23994],"source":"`COleControl`'s implementation of this interface will dispatch these messages through your control's message map, after adjusting the mouse coordinates appropriately."},{"content":"You can process these messages like ordinary window messages, by adding the corresponding entries to the message map.","pos":[23995,24112]},{"pos":[24119,24293],"content":"In a windowless control, you should always use the <ph id=\"ph1\">`COleControl`</ph> member functions instead of the corresponding <ph id=\"ph2\">`CWnd`</ph> member functions or their related Windows API functions.","source":"In a windowless control, you should always use the `COleControl` member functions instead of the corresponding `CWnd` member functions or their related Windows API functions."},{"content":"OLE control objects can also create a window only when they become active, but the amount of work needed for the inactive-active transition goes up and the speed of the transition goes down.","pos":[24300,24490]},{"content":"There are cases when this is a problem: as an example, consider a grid of text boxes.","pos":[24491,24576]},{"content":"When cursoring up and down through the column, each control must be in-place activated and then deactivated.","pos":[24577,24685]},{"content":"The speed of the inactive/active transition will directly affect the scrolling speed.","pos":[24686,24771]},{"content":"For more information on developing an OLE control framework, see the articles <bpt id=\"p1\">[</bpt>MFC ActiveX Controls<ept id=\"p1\">](../../mfc/mfc-activex-controls.md)</ept> and <bpt id=\"p2\">[</bpt>Overview: Creating an MFC ActiveX Control Program<ept id=\"p2\">](../../mfc/reference/mfc-activex-control-wizard.md)</ept>.","pos":[24778,25021],"source":"For more information on developing an OLE control framework, see the articles [MFC ActiveX Controls](../../mfc/mfc-activex-controls.md) and [Overview: Creating an MFC ActiveX Control Program](../../mfc/reference/mfc-activex-control-wizard.md)."},{"content":"For information on optimizing OLE controls, including windowless and flicker-free controls, see <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Optimization<ept id=\"p1\">](../../mfc/mfc-activex-controls-optimization.md)</ept>.","pos":[25022,25203],"source":" For information on optimizing OLE controls, including windowless and flicker-free controls, see [MFC ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md)."},{"pos":[25212,25233],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[25237,25284],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[25291,25344],"content":"<bpt id=\"p1\">[</bpt>CCmdTarget<ept id=\"p1\">](../../mfc/reference/ccmdtarget-class.md)</ept>","source":"[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)"},{"pos":[25351,25392],"content":"<bpt id=\"p1\">[</bpt>CWnd<ept id=\"p1\">](../../mfc/reference/cwnd-class.md)</ept>","source":"[CWnd](../../mfc/reference/cwnd-class.md)"},{"pos":[25421,25433],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[25437,25457],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxctl.h","source":"**Header:** afxctl.h"},{"pos":[25467,25542],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientbackcolor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientBackColor","linkify":"<a name=\"colecontrol__ambientbackcolor\"></a>  COleControl::AmbientBackColor","source":"<a name=\"colecontrol__ambientbackcolor\"></a>  COleControl::AmbientBackColor"},{"content":"Returns the value of the ambient BackColor property.","pos":[25546,25598]},{"pos":[25653,25665],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The current value of the container's ambient BackColor property, if any.","pos":[25669,25741]},{"content":"If the property is not supported, this function returns the system-defined Windows background color.","pos":[25742,25842]},{"pos":[25852,25859],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The ambient BackColor property is available to all controls and is defined by the container.","pos":[25863,25955]},{"content":"Note that the container is not required to support this property.","pos":[25956,26021]},{"pos":[26031,26110],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientdisplayname\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientDisplayName","linkify":"<a name=\"colecontrol__ambientdisplayname\"></a>  COleControl::AmbientDisplayName","source":"<a name=\"colecontrol__ambientdisplayname\"></a>  COleControl::AmbientDisplayName"},{"content":"The name the container has assigned to the control can be used in error messages displayed to the user.","pos":[26114,26217]},{"pos":[26272,26284],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The name of the OLE control.","pos":[26288,26316]},{"content":"The default is a zero-length string.","pos":[26317,26353]},{"pos":[26363,26370],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that the container is not required to support this property.","pos":[26374,26439]},{"pos":[26449,26514],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientfont\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientFont","linkify":"<a name=\"colecontrol__ambientfont\"></a>  COleControl::AmbientFont","source":"<a name=\"colecontrol__ambientfont\"></a>  COleControl::AmbientFont"},{"content":"Returns the value of the ambient Font property.","pos":[26518,26565]},{"pos":[26616,26628],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to the container's ambient Font dispatch interface.","pos":[26632,26693]},{"content":"The default value is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[26694,26724],"source":" The default value is **NULL**."},{"content":"If the return is not equal to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, you are responsible for releasing the font by calling its <bpt id=\"p2\">[</bpt>IUnknown::Release<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682317)</ept> member function.","pos":[26725,26919],"source":" If the return is not equal to **NULL**, you are responsible for releasing the font by calling its [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) member function."},{"pos":[26929,26936],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The ambient Font property is defined by the container and available to all controls.Note that the container is not required to support this property.","pos":[26940,27089]},{"pos":[27099,27174],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientforecolor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientForeColor","linkify":"<a name=\"colecontrol__ambientforecolor\"></a>  COleControl::AmbientForeColor","source":"<a name=\"colecontrol__ambientforecolor\"></a>  COleControl::AmbientForeColor"},{"content":"Returns the value of the ambient ForeColor property.","pos":[27178,27230]},{"pos":[27285,27297],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The current value of the container's ambient ForeColor property, if any.","pos":[27301,27373]},{"content":"If not supported, this function returns the system-defined Windows text color.","pos":[27374,27452]},{"pos":[27462,27469],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The ambient ForeColor property is available to all controls and is defined by the container.","pos":[27473,27565]},{"content":"Note that the container is not required to support this property.","pos":[27566,27631]},{"pos":[27641,27714],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientlocaleid\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientLocaleID","linkify":"<a name=\"colecontrol__ambientlocaleid\"></a>  COleControl::AmbientLocaleID","source":"<a name=\"colecontrol__ambientlocaleid\"></a>  COleControl::AmbientLocaleID"},{"content":"Returns the container's locale ID.","pos":[27718,27752]},{"pos":[27801,27813],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The value of the container's LocaleID property, if any.","pos":[27817,27872]},{"content":"If this property is not supported, this function returns 0.","pos":[27873,27932]},{"pos":[27942,27949],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The control can use the LocaleID to adapt its user interface for specific locales.","pos":[27953,28035]},{"content":"Note that the container is not required to support this property.","pos":[28036,28101]},{"pos":[28111,28188],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientappearance\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientAppearance","linkify":"<a name=\"colecontrol__ambientappearance\"></a>  COleControl::AmbientAppearance","source":"<a name=\"colecontrol__ambientappearance\"></a>  COleControl::AmbientAppearance"},{"content":"Retrieves the current appearance setting for the control object.","pos":[28192,28256]},{"pos":[28308,28320],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The appearance of the control:","pos":[28324,28354]},{"pos":[28362,28383],"content":"<bpt id=\"p1\">**</bpt>0<ept id=\"p1\">**</ept> Flat appearance","source":"**0** Flat appearance"},{"pos":[28391,28410],"content":"<bpt id=\"p1\">**</bpt>1<ept id=\"p1\">**</ept> 3D appearance","source":"**1** 3D appearance"},{"pos":[28420,28427],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[28431,28542],"content":"Call this function to retrieve the current value of the <bpt id=\"p1\">**</bpt>DISPID_AMBIENT_APPEARANCE<ept id=\"p1\">**</ept> property for the control.","source":"Call this function to retrieve the current value of the **DISPID_AMBIENT_APPEARANCE** property for the control."},{"pos":[28552,28629],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientscaleunits\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientScaleUnits","linkify":"<a name=\"colecontrol__ambientscaleunits\"></a>  COleControl::AmbientScaleUnits","source":"<a name=\"colecontrol__ambientscaleunits\"></a>  COleControl::AmbientScaleUnits"},{"content":"Returns the type of units used by the container.","pos":[28633,28681]},{"pos":[28735,28747],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A string containing the ambient ScaleUnits of the container.","pos":[28751,28811]},{"content":"If this property is not supported, this function returns a zero-length string.","pos":[28812,28890]},{"pos":[28900,28907],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The container's ambient ScaleUnits property can be used to display positions or dimensions, labeled with the chosen unit, such as twips or centimeters.","pos":[28911,29062]},{"content":"Note that the container is not required to support this property.","pos":[29063,29128]},{"pos":[29138,29225],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientshowgrabhandles\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientShowGrabHandles","linkify":"<a name=\"colecontrol__ambientshowgrabhandles\"></a>  COleControl::AmbientShowGrabHandles","source":"<a name=\"colecontrol__ambientshowgrabhandles\"></a>  COleControl::AmbientShowGrabHandles"},{"content":"Determines whether the container allows the control to display grab handles for itself when active.","pos":[29229,29328]},{"pos":[29384,29396],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if grab handles should be displayed; otherwise 0.","pos":[29400,29457]},{"content":"If this property is not supported, this function returns nonzero.","pos":[29458,29523]},{"pos":[29533,29540],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that the container is not required to support this property.","pos":[29544,29609]},{"pos":[29619,29700],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientshowhatching\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientShowHatching","linkify":"<a name=\"colecontrol__ambientshowhatching\"></a>  COleControl::AmbientShowHatching","source":"<a name=\"colecontrol__ambientshowhatching\"></a>  COleControl::AmbientShowHatching"},{"content":"Determines whether the container allows the control to display itself with a hatched pattern when UI active.","pos":[29704,29812]},{"pos":[29865,29877],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the hatched pattern should be shown; otherwise 0.","pos":[29881,29941]},{"content":"If this property is not supported, this function returns nonzero.","pos":[29942,30007]},{"pos":[30017,30024],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that the container is not required to support this property.","pos":[30028,30093]},{"pos":[30103,30178],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambienttextalign\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientTextAlign","linkify":"<a name=\"colecontrol__ambienttextalign\"></a>  COleControl::AmbientTextAlign","source":"<a name=\"colecontrol__ambienttextalign\"></a>  COleControl::AmbientTextAlign"},{"content":"Determines the ambient text alignment preferred by the control container.","pos":[30182,30255]},{"pos":[30306,30318],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The status of the container's ambient TextAlign property.","pos":[30322,30379]},{"content":"If this property is not supported, this function returns 0.","pos":[30380,30439]},{"content":"The following is a list of valid return values:","pos":[30446,30493]},{"content":"Return value","pos":[30500,30512]},{"content":"Meaning","pos":[30513,30520]},{"content":"0","pos":[30562,30563]},{"content":"General alignment (numbers to the right, text to the left).","pos":[30564,30623]},{"content":"1","pos":[30628,30629]},{"content":"Left justify","pos":[30630,30642]},{"content":"2","pos":[30647,30648]},{"content":"Center","pos":[30649,30655]},{"content":"3","pos":[30660,30661]},{"content":"Right justify","pos":[30662,30675]},{"pos":[30686,30693],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This property is available to all embedded controls and is defined by the container.","pos":[30697,30781]},{"content":"Note that the container is not required to support this property.","pos":[30782,30847]},{"pos":[30857,30926],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientuidead\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientUIDead","linkify":"<a name=\"colecontrol__ambientuidead\"></a>  COleControl::AmbientUIDead","source":"<a name=\"colecontrol__ambientuidead\"></a>  COleControl::AmbientUIDead"},{"content":"Determines if the container wants the control to respond to user-interface actions.","pos":[30930,31013]},{"pos":[31060,31072],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control should respond to user-interface actions; otherwise 0.","pos":[31076,31153]},{"content":"If this property is not supported, this function returns 0.","pos":[31154,31213]},{"pos":[31223,31230],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[31234,31301],"content":"For example, a container might set this to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> in design mode.","source":"For example, a container might set this to **TRUE** in design mode."},{"pos":[31311,31384],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ambientusermode\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::AmbientUserMode","linkify":"<a name=\"colecontrol__ambientusermode\"></a>  COleControl::AmbientUserMode","source":"<a name=\"colecontrol__ambientusermode\"></a>  COleControl::AmbientUserMode"},{"content":"Determines if the container is in design mode or user mode.","pos":[31388,31447]},{"pos":[31496,31508],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the container is in user mode; otherwise 0 (in design mode).","pos":[31512,31583]},{"content":"If this property is not supported, this function returns TRUE.","pos":[31584,31646]},{"pos":[31656,31663],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[31667,31735],"content":"For example, a container might set this to <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> in design mode.","source":"For example, a container might set this to **FALSE** in design mode."},{"pos":[31745,31828],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__boundpropertychanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::BoundPropertyChanged","linkify":"<a name=\"colecontrol__boundpropertychanged\"></a>  COleControl::BoundPropertyChanged","source":"<a name=\"colecontrol__boundpropertychanged\"></a>  COleControl::BoundPropertyChanged"},{"content":"Signals that the bound property value has changed.","pos":[31832,31882]},{"pos":[31949,31959],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The dispatch ID of a bound property of the control.","pos":[31975,32026]},{"pos":[32036,32043],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This must be called every time the value of the property changes, even in cases where the change was not made through the property Set method.","pos":[32047,32189]},{"content":"Be particularly aware of bound properties that are mapped to member variables.","pos":[32190,32268]},{"content":"Any time such a member variable changes, <ph id=\"ph1\">`BoundPropertyChanged`</ph> must be called.","pos":[32269,32348],"source":" Any time such a member variable changes, `BoundPropertyChanged` must be called."},{"pos":[32358,32449],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__boundpropertyrequestedit\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::BoundPropertyRequestEdit","linkify":"<a name=\"colecontrol__boundpropertyrequestedit\"></a>  COleControl::BoundPropertyRequestEdit","source":"<a name=\"colecontrol__boundpropertyrequestedit\"></a>  COleControl::BoundPropertyRequestEdit"},{"pos":[32453,32571],"content":"Requests permission from the <ph id=\"ph1\">`IPropertyNotifySink`</ph> interface to change a bound property value provided by the control.","source":"Requests permission from the `IPropertyNotifySink` interface to change a bound property value provided by the control."},{"pos":[32642,32652],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The dispatch ID of a bound property of the control.","pos":[32668,32719]},{"pos":[32729,32741],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the change is permitted; otherwise 0.","pos":[32745,32793]},{"content":"The default value is nonzero.","pos":[32794,32823]},{"pos":[32833,32840],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If permission is denied, the control must not let the value of the property change.","pos":[32844,32927]},{"content":"This can be done by ignoring or failing the action that attempted to change the property value.","pos":[32928,33023]},{"pos":[33033,33104],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__clienttoparent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ClientToParent","linkify":"<a name=\"colecontrol__clienttoparent\"></a>  COleControl::ClientToParent","source":"<a name=\"colecontrol__clienttoparent\"></a>  COleControl::ClientToParent"},{"pos":[33108,33171],"content":"Translates the coordinates of <ph id=\"ph1\">`pPoint`</ph> into parent coordinates.","source":"Translates the coordinates of `pPoint` into parent coordinates."},{"pos":[33275,33285],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the bounds of the OLE control within the container.","pos":[33305,33367]},{"content":"Not the client area but the area of the entire control including borders and scroll bars.","pos":[33368,33457]},{"content":"Pointer to the OLE client area point to be translated into the coordinates of the parent (container).","pos":[33476,33577]},{"pos":[33587,33594],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"On input <ph id=\"ph1\">`pPoint`</ph> is relative to the origin of the client area of the OLE control (upper left corner of the client area of the control).","pos":[33598,33734],"source":"On input `pPoint` is relative to the origin of the client area of the OLE control (upper left corner of the client area of the control)."},{"content":"On output <ph id=\"ph1\">`pPoint`</ph> is relative to the origin of the parent (upper left corner of the container).","pos":[33735,33831],"source":" On output `pPoint` is relative to the origin of the parent (upper left corner of the container)."},{"pos":[33841,33910],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__clipcaretrect\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ClipCaretRect","linkify":"<a name=\"colecontrol__clipcaretrect\"></a>  COleControl::ClipCaretRect","source":"<a name=\"colecontrol__clipcaretrect\"></a>  COleControl::ClipCaretRect"},{"content":"Adjusts a caret rectangle if it is entirely or partially covered by overlapping, opaque objects.","pos":[33914,34010]},{"pos":[34070,34080],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"On input, a pointer to a <bpt id=\"p1\">[</bpt>RECT<ept id=\"p1\">](../../mfc/reference/rect-structure1.md)</ept> structure that contains the caret area to be adjusted.","pos":[34096,34222],"source":" On input, a pointer to a [RECT](../../mfc/reference/rect-structure1.md) structure that contains the caret area to be adjusted."},{"content":"On output, the adjusted caret area, or <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the caret rectangle is completely covered.","pos":[34223,34316],"source":" On output, the adjusted caret area, or **NULL** if the caret rectangle is completely covered."},{"pos":[34326,34338],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[34342,34377]},{"pos":[34387,34394],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"A caret is a flashing line, block, or bitmap that typically indicates where text or graphics will be inserted.","pos":[34398,34508]},{"content":"A windowless object cannot safely show a caret without first checking whether the caret is partially or totally hidden by overlapping objects.","pos":[34515,34657]},{"content":"In order to make that possible, an object can use <ph id=\"ph1\">`ClipCaretRect`</ph> to get the caret adjusted (reduced) to ensure it fits in the clipping region.","pos":[34658,34801],"source":" In order to make that possible, an object can use `ClipCaretRect` to get the caret adjusted (reduced) to ensure it fits in the clipping region."},{"content":"Objects creating a caret should submit the caret rectangle to <ph id=\"ph1\">`ClipCaretRect`</ph> and use the adjusted rectangle for the caret.","pos":[34808,34931],"source":"Objects creating a caret should submit the caret rectangle to `ClipCaretRect` and use the adjusted rectangle for the caret."},{"content":"If the caret is entirely hidden, this method will return <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> and the caret should not be shown at all in this case.","pos":[34932,35053],"source":" If the caret is entirely hidden, this method will return **FALSE** and the caret should not be shown at all in this case."},{"pos":[35063,35128],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__colecontrol\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::COleControl","linkify":"<a name=\"colecontrol__colecontrol\"></a>  COleControl::COleControl","source":"<a name=\"colecontrol__colecontrol\"></a>  COleControl::COleControl"},{"pos":[35132,35166],"content":"Constructs a <ph id=\"ph1\">`COleControl`</ph> object.","source":"Constructs a `COleControl` object."},{"pos":[35206,35213],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function is normally not called directly.","pos":[35217,35263]},{"content":"Instead the OLE control is usually created by its class factory.","pos":[35264,35328]},{"pos":[35338,35417],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__controlinfochanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ControlInfoChanged","linkify":"<a name=\"colecontrol__controlinfochanged\"></a>  COleControl::ControlInfoChanged","source":"<a name=\"colecontrol__controlinfochanged\"></a>  COleControl::ControlInfoChanged"},{"content":"Call this function when the set of mnemonics supported by the control has changed.","pos":[35421,35503]},{"pos":[35555,35562],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Upon receiving this notification, the control's container obtains the new set of mnemonics by making a call to <bpt id=\"p1\">[</bpt>IOleControl::GetControlInfo<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms693730)</ept>.","pos":[35566,35767],"source":"Upon receiving this notification, the control's container obtains the new set of mnemonics by making a call to [IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730)."},{"content":"Note that the container is not required to respond to this notification.","pos":[35768,35840]},{"pos":[35850,35917],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__displayerror\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::DisplayError","linkify":"<a name=\"colecontrol__displayerror\"></a>  COleControl::DisplayError","source":"<a name=\"colecontrol__displayerror\"></a>  COleControl::DisplayError"},{"content":"Called by the framework after the stock Error event has been handled (unless the event handler has suppressed the display of the error).","pos":[35921,36057]},{"pos":[36232,36242],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>scode<ept id=\"p1\">*</ept>","pos":[36246,36253],"source":"*scode*"},{"content":"The status code value to be reported.","pos":[36257,36294]},{"content":"For a complete list of possible codes, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Advanced Topics<ept id=\"p1\">](../../mfc/mfc-activex-controls-advanced-topics.md)</ept>.","pos":[36295,36437],"source":" For a complete list of possible codes, see the article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md)."},{"content":"The description of the error being reported.","pos":[36465,36509]},{"content":"<bpt id=\"p1\">*</bpt>lpszSource<ept id=\"p1\">*</ept>","pos":[36516,36528],"source":"*lpszSource*"},{"content":"The name of the module generating the error (typically, the name of the OLE control module).","pos":[36532,36624]},{"content":"The name of the help file containing a description of the error.","pos":[36649,36713]},{"content":"The Help Context ID of the error being reported.","pos":[36733,36781]},{"pos":[36791,36798],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[36802,36918],"content":"The default behavior displays a message box containing the description of the error, contained in <ph id=\"ph1\">`lpszDescription`</ph>.","source":"The default behavior displays a message box containing the description of the error, contained in `lpszDescription`."},{"content":"Override this function to customize how errors are displayed.","pos":[36925,36986]},{"pos":[36996,37053],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__doclick\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::DoClick","linkify":"<a name=\"colecontrol__doclick\"></a>  COleControl::DoClick","source":"<a name=\"colecontrol__doclick\"></a>  COleControl::DoClick"},{"content":"Simulates a mouse click action on the control.","pos":[37057,37103]},{"pos":[37144,37151],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[37155,37293],"content":"The overridable <ph id=\"ph1\">`COleControl::OnClick`</ph> member function will be called, and a stock Click event will be fired, if supported by the control.","source":"The overridable `COleControl::OnClick` member function will be called, and a stock Click event will be fired, if supported by the control."},{"content":"This function is supported by the <ph id=\"ph1\">`COleControl`</ph> base class as a stock method, called DoClick.","pos":[37300,37393],"source":"This function is supported by the `COleControl` base class as a stock method, called DoClick."},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Methods<ept id=\"p1\">](../../mfc/mfc-activex-controls-methods.md)</ept>.","pos":[37394,37503],"source":" For more information, see the article [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md)."},{"pos":[37513,37584],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__dopropexchange\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::DoPropExchange","linkify":"<a name=\"colecontrol__dopropexchange\"></a>  COleControl::DoPropExchange","source":"<a name=\"colecontrol__dopropexchange\"></a>  COleControl::DoPropExchange"},{"content":"Called by the framework when loading or storing a control from a persistent storage representation, such as a stream or property set.","pos":[37588,37721]},{"pos":[37795,37805],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a <ph id=\"ph1\">`CPropExchange`</ph> object.","pos":[37818,37856],"source":" A pointer to a `CPropExchange` object."},{"content":"The framework supplies this object to establish the context of the property exchange, including its direction.","pos":[37857,37967]},{"pos":[37977,37984],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[37988,38126],"content":"This function normally makes calls to the <bpt id=\"p1\">**</bpt>PX_<ept id=\"p1\">**</ept> family of functions to load or store specific user-defined properties of an OLE control.","source":"This function normally makes calls to the **PX_** family of functions to load or store specific user-defined properties of an OLE control."},{"content":"If Control Wizard has been used to create the OLE control project, the overridden version of this function will serialize the stock properties supported by <ph id=\"ph1\">`COleControl`</ph> with a call to the base class function, <ph id=\"ph2\">`COleControl::DoPropExchange`</ph>.","pos":[38133,38373],"source":"If Control Wizard has been used to create the OLE control project, the overridden version of this function will serialize the stock properties supported by `COleControl` with a call to the base class function, `COleControl::DoPropExchange`."},{"content":"As you add user-defined properties to your OLE control you will need to modify this function to serialize your new properties.","pos":[38374,38500]},{"content":"For more information on serialization, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Serializing<ept id=\"p1\">](../../mfc/mfc-activex-controls-serializing.md)</ept>.","pos":[38501,38635],"source":" For more information on serialization, see the article [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md)."},{"pos":[38645,38722],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__dosuperclasspaint\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::DoSuperclassPaint","linkify":"<a name=\"colecontrol__dosuperclasspaint\"></a>  COleControl::DoSuperclassPaint","source":"<a name=\"colecontrol__dosuperclasspaint\"></a>  COleControl::DoSuperclassPaint"},{"content":"Redraws an OLE control that has been subclassed from a Windows control.","pos":[38726,38797]},{"pos":[38890,38900],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to the device context of the control container.","pos":[38913,38970]},{"content":"The area in which the control is to be drawn.","pos":[38991,39036]},{"pos":[39046,39053],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to properly handle the painting of a nonactive OLE control.","pos":[39057,39135]},{"content":"This function should only be used if the OLE control subclasses a Windows control and should be called in the <ph id=\"ph1\">`OnDraw`</ph> function of your control.","pos":[39136,39280],"source":" This function should only be used if the OLE control subclasses a Windows control and should be called in the `OnDraw` function of your control."},{"pos":[39287,39491],"content":"For more information on this function and subclassing a Windows control, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Subclassing a Windows Control<ept id=\"p1\">](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)</ept>.","source":"For more information on this function and subclassing a Windows control, see the article [ActiveX Controls: Subclassing a Windows Control](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)."},{"pos":[39501,39566],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__drawcontent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::DrawContent","linkify":"<a name=\"colecontrol__drawcontent\"></a>  COleControl::DrawContent","source":"<a name=\"colecontrol__drawcontent\"></a>  COleControl::DrawContent"},{"content":"Called by the framework when the control's appearance needs to be updated.","pos":[39570,39644]},{"pos":[39719,39729],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the device context.","pos":[39742,39772]},{"content":"Rectangular area to be drawn in.","pos":[39787,39819]},{"pos":[39829,39836],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[39840,39903],"content":"This function directly calls the overridable <ph id=\"ph1\">`OnDraw`</ph> function.","source":"This function directly calls the overridable `OnDraw` function."},{"pos":[39913,39980],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__drawmetafile\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::DrawMetafile","linkify":"<a name=\"colecontrol__drawmetafile\"></a>  COleControl::DrawMetafile","source":"<a name=\"colecontrol__drawmetafile\"></a>  COleControl::DrawMetafile"},{"content":"Called by the framework when the metafile device context is being used.","pos":[39984,40055]},{"pos":[40131,40141],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the metafile device context.","pos":[40154,40193]},{"content":"Rectangular area to be drawn in.","pos":[40208,40240]},{"pos":[40250,40327],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__enablesimpleframe\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::EnableSimpleFrame","linkify":"<a name=\"colecontrol__enablesimpleframe\"></a>  COleControl::EnableSimpleFrame","source":"<a name=\"colecontrol__enablesimpleframe\"></a>  COleControl::EnableSimpleFrame"},{"content":"Enables the simple frame characteristic for an OLE control.","pos":[40331,40390]},{"pos":[40441,40448],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This characteristic allows a control to support visual containment of other controls, but not true OLE containment.","pos":[40452,40567]},{"content":"An example would be a group box with several controls inside.","pos":[40568,40629]},{"content":"These controls are not OLE contained, but they are in the same group box.","pos":[40630,40703]},{"pos":[40713,40784],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__exchangeextent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ExchangeExtent","linkify":"<a name=\"colecontrol__exchangeextent\"></a>  COleControl::ExchangeExtent","source":"<a name=\"colecontrol__exchangeextent\"></a>  COleControl::ExchangeExtent"},{"pos":[40788,40887],"content":"Serializes or initializes the state of the control's extent (its dimensions in <bpt id=\"p1\">**</bpt>HIMETRIC<ept id=\"p1\">**</ept> units).","source":"Serializes or initializes the state of the control's extent (its dimensions in **HIMETRIC** units)."},{"pos":[40953,40963],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CPropExchange<ept id=\"p1\">](../../mfc/reference/cpropexchange-class.md)</ept> object.","pos":[40976,41058],"source":" A pointer to a [CPropExchange](../../mfc/reference/cpropexchange-class.md) object."},{"content":"The framework supplies this object to establish the context of the property exchange, including its direction.","pos":[41059,41169]},{"pos":[41179,41191],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the function succeeded; 0 otherwise.","pos":[41195,41242]},{"pos":[41252,41259],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[41263,41359],"content":"This function is normally called by the default implementation of <ph id=\"ph1\">`COleControl::DoPropExchange`</ph>.","source":"This function is normally called by the default implementation of `COleControl::DoPropExchange`."},{"pos":[41369,41448],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__exchangestockprops\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ExchangeStockProps","linkify":"<a name=\"colecontrol__exchangestockprops\"></a>  COleControl::ExchangeStockProps","source":"<a name=\"colecontrol__exchangestockprops\"></a>  COleControl::ExchangeStockProps"},{"content":"Serializes or initializes the state of the control's stock properties.","pos":[41452,41522]},{"pos":[41592,41602],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CPropExchange<ept id=\"p1\">](../../mfc/reference/cpropexchange-class.md)</ept> object.","pos":[41615,41697],"source":" A pointer to a [CPropExchange](../../mfc/reference/cpropexchange-class.md) object."},{"content":"The framework supplies this object to establish the context of the property exchange, including its direction.","pos":[41698,41808]},{"pos":[41818,41825],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[41829,41925],"content":"This function is normally called by the default implementation of <ph id=\"ph1\">`COleControl::DoPropExchange`</ph>.","source":"This function is normally called by the default implementation of `COleControl::DoPropExchange`."},{"pos":[41935,42008],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__exchangeversion\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ExchangeVersion","linkify":"<a name=\"colecontrol__exchangeversion\"></a>  COleControl::ExchangeVersion","source":"<a name=\"colecontrol__exchangeversion\"></a>  COleControl::ExchangeVersion"},{"content":"Serializes or initializes the state of a control's version information.","pos":[42012,42083]},{"pos":[42213,42223],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a <ph id=\"ph1\">`CPropExchange`</ph> object.","pos":[42236,42274],"source":" A pointer to a `CPropExchange` object."},{"content":"The framework supplies this object to establish the context of the property exchange, including its direction.","pos":[42275,42385]},{"content":"The current version number of the control.","pos":[42414,42456]},{"content":"Indicates whether persistent data should be converted to the latest format when saved, or maintained in the same format that was loaded.","pos":[42477,42613]},{"pos":[42623,42635],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero of the function succeeded; 0 otherwise.","pos":[42639,42686]},{"pos":[42696,42703],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Typically, this will be the first function called by a control's override of <ph id=\"ph1\">`COleControl::DoPropExchange`</ph>.","pos":[42707,42814],"source":"Typically, this will be the first function called by a control's override of `COleControl::DoPropExchange`."},{"content":"When loading, this function reads the version number of the persistent data, and sets the version attribute of the <bpt id=\"p1\">[</bpt>CPropExchange<ept id=\"p1\">](../../mfc/reference/cpropexchange-class.md)</ept> object accordingly.","pos":[42815,43009],"source":" When loading, this function reads the version number of the persistent data, and sets the version attribute of the [CPropExchange](../../mfc/reference/cpropexchange-class.md) object accordingly."},{"content":"When saving, this function writes the version number of the persistent data.","pos":[43010,43086]},{"pos":[43093,43240],"content":"For more information on persistence and versioning, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Serializing<ept id=\"p1\">](../../mfc/mfc-activex-controls-serializing.md)</ept>.","source":"For more information on persistence and versioning, see the article [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md)."},{"pos":[43250,43311],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__fireclick\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireClick","linkify":"<a name=\"colecontrol__fireclick\"></a>  COleControl::FireClick","source":"<a name=\"colecontrol__fireclick\"></a>  COleControl::FireClick"},{"content":"Called by the framework when the mouse is clicked over an active control.","pos":[43315,43388]},{"pos":[43431,43438],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If this event is defined as a custom event, you determine when the event is fired.","pos":[43442,43524]},{"content":"For automatic firing of a Click event to occur, the control's Event map must have a stock Click event defined.","pos":[43531,43641]},{"pos":[43651,43718],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__firedblclick\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireDblClick","linkify":"<a name=\"colecontrol__firedblclick\"></a>  COleControl::FireDblClick","source":"<a name=\"colecontrol__firedblclick\"></a>  COleControl::FireDblClick"},{"content":"Called by the framework when the mouse is double-clicked over an active control.","pos":[43722,43802]},{"pos":[43848,43855],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If this event is defined as a custom event, you determine when the event is fired.","pos":[43859,43941]},{"content":"For automatic firing of a DblClick event to occur, the control's Event map must have a stock DblClick event defined.","pos":[43948,44064]},{"pos":[44074,44135],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__fireerror\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireError","linkify":"<a name=\"colecontrol__fireerror\"></a>  COleControl::FireError","source":"<a name=\"colecontrol__fireerror\"></a>  COleControl::FireError"},{"content":"Fires the stock Error event.","pos":[44139,44167]},{"pos":[44281,44291],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>scode<ept id=\"p1\">*</ept>","pos":[44295,44302],"source":"*scode*"},{"content":"The status code value to be reported.","pos":[44306,44343]},{"content":"For a complete list of possible codes, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Advanced Topics<ept id=\"p1\">](../../mfc/mfc-activex-controls-advanced-topics.md)</ept>.","pos":[44344,44486],"source":" For a complete list of possible codes, see the article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md)."},{"content":"The description of the error being reported.","pos":[44514,44558]},{"content":"The Help ID of the error being reported.","pos":[44578,44618]},{"pos":[44628,44635],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This event provides a way of signalling, at appropriate places in your code, that an error has occurred within your control.","pos":[44639,44763]},{"content":"Unlike other stock events, such as Click or MouseMove, Error is never fired by the framework.","pos":[44764,44857]},{"pos":[44864,45029],"content":"To report an error that occurs during a property get function, property set function, or automation method, call <bpt id=\"p1\">[</bpt>COleControl::ThrowError<ept id=\"p1\">](#colecontrol__throwerror)</ept>.","source":"To report an error that occurs during a property get function, property set function, or automation method, call [COleControl::ThrowError](#colecontrol__throwerror)."},{"content":"The implementation of an OLE control's Stock Error event uses an <ph id=\"ph1\">`SCODE`</ph> value.","pos":[45036,45115],"source":"The implementation of an OLE control's Stock Error event uses an `SCODE` value."},{"content":"If your control uses this event, and is intended to be used in Visual Basic 4.0, you will receive errors because the <ph id=\"ph1\">`SCODE`</ph> value is not supported in Visual Basic.","pos":[45116,45280],"source":" If your control uses this event, and is intended to be used in Visual Basic 4.0, you will receive errors because the `SCODE` value is not supported in Visual Basic."},{"content":"To fix this, manually change the <ph id=\"ph1\">`SCODE`</ph> parameter in the control's .ODL file to a <bpt id=\"p1\">**</bpt>long<ept id=\"p1\">**</ept>.","pos":[45287,45379],"source":"To fix this, manually change the `SCODE` parameter in the control's .ODL file to a **long**."},{"content":"In addition, any custom event, method, or property that uses an <ph id=\"ph1\">`SCODE`</ph> parameter also causes the same problem.","pos":[45380,45491],"source":" In addition, any custom event, method, or property that uses an `SCODE` parameter also causes the same problem."},{"pos":[45501,45562],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__fireevent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireEvent","linkify":"<a name=\"colecontrol__fireevent\"></a>  COleControl::FireEvent","source":"<a name=\"colecontrol__fireevent\"></a>  COleControl::FireEvent"},{"content":"Fires a user-defined event from your control with any number of optional arguments,.","pos":[45566,45650]},{"pos":[45751,45761],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The dispatch ID of the event to be fired.","pos":[45777,45818]},{"content":"A descriptor for the event's parameter types.","pos":[45839,45884]},{"pos":[45894,45901],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Usually this function should not be called directly.","pos":[45905,45957]},{"content":"Instead you will call the event-firing functions in the event map section of your control's class declaration.","pos":[45958,46068]},{"content":"The <ph id=\"ph1\">`pbParams`</ph> argument is a space-separated list of <bpt id=\"p1\">**</bpt>VTS_<ept id=\"p1\">**</ept>.","pos":[46075,46137],"source":"The `pbParams` argument is a space-separated list of **VTS_**."},{"content":"One or more of these values, separated by spaces (not commas), specifies the function's parameter list.","pos":[46138,46241]},{"content":"Possible values are as follows:","pos":[46242,46273]},{"content":"Symbol","pos":[46280,46286]},{"content":"Parameter type","pos":[46287,46301]},{"pos":[46344,46357],"content":"<bpt id=\"p1\">**</bpt>VTS_COLOR<ept id=\"p1\">**</ept>","source":"**VTS_COLOR**"},{"pos":[46358,46371],"content":"<bpt id=\"p1\">**</bpt>OLE_COLOR<ept id=\"p1\">**</ept>","source":"**OLE_COLOR**"},{"pos":[46376,46388],"content":"<bpt id=\"p1\">**</bpt>VTS_FONT<ept id=\"p1\">**</ept>","source":"**VTS_FONT**"},{"pos":[46389,46404],"content":"<bpt id=\"p1\">**</bpt>IFontDisp<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**IFontDisp\\***"},{"pos":[46409,46423],"content":"<bpt id=\"p1\">**</bpt>VTS_HANDLE<ept id=\"p1\">**</ept>","source":"**VTS_HANDLE**"},{"pos":[46435,46450],"content":"<bpt id=\"p1\">**</bpt>VTS_PICTURE<ept id=\"p1\">**</ept>","source":"**VTS_PICTURE**"},{"pos":[46451,46469],"content":"<bpt id=\"p1\">**</bpt>IPictureDisp<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**IPictureDisp\\***"},{"pos":[46474,46494],"content":"<bpt id=\"p1\">**</bpt>VTS_OPTEXCLUSIVE<ept id=\"p1\">**</ept>","source":"**VTS_OPTEXCLUSIVE**"},{"pos":[46495,46517],"content":"<bpt id=\"p1\">**</bpt>OLE_OPTEXCLUSIVE<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**OLE_OPTEXCLUSIVE\\***"},{"pos":[46522,46538],"content":"<bpt id=\"p1\">**</bpt>VTS_TRISTATE<ept id=\"p1\">**</ept>","source":"**VTS_TRISTATE**"},{"pos":[46539,46555],"content":"<bpt id=\"p1\">**</bpt>OLE_TRISTATE<ept id=\"p1\">**</ept>","source":"**OLE_TRISTATE**"},{"pos":[46560,46581],"content":"<bpt id=\"p1\">**</bpt>VTS_XPOS_HIMETRIC<ept id=\"p1\">**</ept>","source":"**VTS_XPOS_HIMETRIC**"},{"pos":[46582,46603],"content":"<bpt id=\"p1\">**</bpt>OLE_XPOS_HIMETRIC<ept id=\"p1\">**</ept>","source":"**OLE_XPOS_HIMETRIC**"},{"pos":[46608,46629],"content":"<bpt id=\"p1\">**</bpt>VTS_YPOS_HIMETRIC<ept id=\"p1\">**</ept>","source":"**VTS_YPOS_HIMETRIC**"},{"pos":[46630,46651],"content":"<bpt id=\"p1\">**</bpt>OLE_YPOS_HIMETRIC<ept id=\"p1\">**</ept>","source":"**OLE_YPOS_HIMETRIC**"},{"pos":[46656,46675],"content":"<bpt id=\"p1\">**</bpt>VTS_XPOS_PIXELS<ept id=\"p1\">**</ept>","source":"**VTS_XPOS_PIXELS**"},{"pos":[46676,46695],"content":"<bpt id=\"p1\">**</bpt>OLE_XPOS_PIXELS<ept id=\"p1\">**</ept>","source":"**OLE_XPOS_PIXELS**"},{"pos":[46700,46719],"content":"<bpt id=\"p1\">**</bpt>VTS_YPOS_PIXELS<ept id=\"p1\">**</ept>","source":"**VTS_YPOS_PIXELS**"},{"pos":[46720,46739],"content":"<bpt id=\"p1\">**</bpt>OLE_YPOS_PIXELS<ept id=\"p1\">**</ept>","source":"**OLE_YPOS_PIXELS**"},{"pos":[46744,46764],"content":"<bpt id=\"p1\">**</bpt>VTS_XSIZE_PIXELS<ept id=\"p1\">**</ept>","source":"**VTS_XSIZE_PIXELS**"},{"pos":[46765,46785],"content":"<bpt id=\"p1\">**</bpt>OLE_XSIZE_PIXELS<ept id=\"p1\">**</ept>","source":"**OLE_XSIZE_PIXELS**"},{"pos":[46790,46810],"content":"<bpt id=\"p1\">**</bpt>VTS_YSIZE_PIXELS<ept id=\"p1\">**</ept>","source":"**VTS_YSIZE_PIXELS**"},{"pos":[46811,46831],"content":"<bpt id=\"p1\">**</bpt>OLE_XSIZE_PIXELS<ept id=\"p1\">**</ept>","source":"**OLE_XSIZE_PIXELS**"},{"pos":[46836,46858],"content":"<bpt id=\"p1\">**</bpt>VTS_XSIZE_HIMETRIC<ept id=\"p1\">**</ept>","source":"**VTS_XSIZE_HIMETRIC**"},{"pos":[46859,46881],"content":"<bpt id=\"p1\">**</bpt>OLE_XSIZE_HIMETRIC<ept id=\"p1\">**</ept>","source":"**OLE_XSIZE_HIMETRIC**"},{"pos":[46886,46908],"content":"<bpt id=\"p1\">**</bpt>VTS_YSIZE_HIMETRIC<ept id=\"p1\">**</ept>","source":"**VTS_YSIZE_HIMETRIC**"},{"pos":[46909,46931],"content":"<bpt id=\"p1\">**</bpt>OLE_XSIZE_HIMETRIC<ept id=\"p1\">**</ept>","source":"**OLE_XSIZE_HIMETRIC**"},{"pos":[46940,47271],"content":"[!NOTE]\n Additional variant constants have been defined for all variant types, with the exception of **VTS_FONT** and **VTS_PICTURE**, that provide a pointer to the variant data constant. These constants are named using the **VTS_P**`constantname` convention. For example, **VTS_PCOLOR** is a pointer to a **VTS_COLOR** constant.","leadings":["","> "],"nodes":[{"content":" Additional variant constants have been defined for all variant types, with the exception of **VTS_FONT** and **VTS_PICTURE**, that provide a pointer to the variant data constant. These constants are named using the **VTS_P**`constantname` convention. For example, **VTS_PCOLOR** is a pointer to a **VTS_COLOR** constant.","pos":[8,329],"nodes":[{"content":"Additional variant constants have been defined for all variant types, with the exception of <bpt id=\"p1\">**</bpt>VTS_FONT<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>VTS_PICTURE<ept id=\"p2\">**</ept>, that provide a pointer to the variant data constant.","pos":[1,179],"source":" Additional variant constants have been defined for all variant types, with the exception of **VTS_FONT** and **VTS_PICTURE**, that provide a pointer to the variant data constant."},{"content":"These constants are named using the <bpt id=\"p1\">**</bpt>VTS_P<ept id=\"p1\">**</ept><ph id=\"ph1\">`constantname`</ph> convention.","pos":[180,251],"source":" These constants are named using the **VTS_P**`constantname` convention."},{"content":"For example, <bpt id=\"p1\">**</bpt>VTS_PCOLOR<ept id=\"p1\">**</ept> is a pointer to a <bpt id=\"p2\">**</bpt>VTS_COLOR<ept id=\"p2\">**</ept> constant.","pos":[252,321],"source":" For example, **VTS_PCOLOR** is a pointer to a **VTS_COLOR** constant."}]}]},{"pos":[47281,47346],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__firekeydown\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireKeyDown","linkify":"<a name=\"colecontrol__firekeydown\"></a>  COleControl::FireKeyDown","source":"<a name=\"colecontrol__firekeydown\"></a>  COleControl::FireKeyDown"},{"content":"Called by the framework when a key is pressed while the control is UI active.","pos":[47350,47427]},{"pos":[47516,47526],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the virtual key code value of the pressed key.","pos":[47542,47599]},{"content":"For a list of of standard virtual key codes, see Winuser.h","pos":[47600,47658]},{"content":"Contains a combination of the following flags:","pos":[47682,47728]},{"pos":[47736,47795],"content":"<bpt id=\"p1\">**</bpt>SHIFT_MASK<ept id=\"p1\">**</ept> The SHIFT key was pressed during the action.","source":"**SHIFT_MASK** The SHIFT key was pressed during the action."},{"pos":[47803,47860],"content":"<bpt id=\"p1\">**</bpt>CTRL_MASK<ept id=\"p1\">**</ept> The CTRL key was pressed during the action.","source":"**CTRL_MASK** The CTRL key was pressed during the action."},{"pos":[47868,47923],"content":"<bpt id=\"p1\">**</bpt>ALT_MASK<ept id=\"p1\">**</ept> The ALT key was pressed during the action.","source":"**ALT_MASK** The ALT key was pressed during the action."},{"pos":[47933,47940],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If this event is defined as a custom event, you determine when the event is fired.","pos":[47944,48026]},{"content":"For automatic firing of a KeyDown event to occur, the control's Event map must have a stock KeyDown event defined.","pos":[48033,48147]},{"pos":[48157,48224],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__firekeypress\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireKeyPress","linkify":"<a name=\"colecontrol__firekeypress\"></a>  COleControl::FireKeyPress","source":"<a name=\"colecontrol__firekeypress\"></a>  COleControl::FireKeyPress"},{"content":"Called by the framework when a key is pressed and released while the custom control is UI Active within the container.","pos":[48228,48346]},{"pos":[48406,48416],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to the character value of the key pressed.","pos":[48432,48484]},{"pos":[48494,48501],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If this event is defined as a custom event, you determine when the event is fired.","pos":[48505,48587]},{"content":"The recipient of the event may modify <ph id=\"ph1\">`pnChar`</ph>, for example, convert all lowercase characters to uppercase.","pos":[48594,48701],"source":"The recipient of the event may modify `pnChar`, for example, convert all lowercase characters to uppercase."},{"content":"If you want to examine the modified character, override <ph id=\"ph1\">`OnKeyPressEvent`</ph>.","pos":[48702,48776],"source":" If you want to examine the modified character, override `OnKeyPressEvent`."},{"content":"For automatic firing of a KeyPress event to occur, the control's Event map must have a stock KeyPress event defined.","pos":[48783,48899]},{"pos":[48909,48970],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__firekeyup\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireKeyUp","linkify":"<a name=\"colecontrol__firekeyup\"></a>  COleControl::FireKeyUp","source":"<a name=\"colecontrol__firekeyup\"></a>  COleControl::FireKeyUp"},{"content":"Called by the framework when a key is released while the custom control is UI Active within the container.","pos":[48974,49080]},{"pos":[49167,49177],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the virtual key code value of the released key.","pos":[49193,49251]},{"content":"For a list of of standard virtual key codes, see Winuser.h","pos":[49252,49310]},{"content":"Contains a combination of the following flags:","pos":[49334,49380]},{"pos":[49388,49447],"content":"<bpt id=\"p1\">**</bpt>SHIFT_MASK<ept id=\"p1\">**</ept> The SHIFT key was pressed during the action.","source":"**SHIFT_MASK** The SHIFT key was pressed during the action."},{"pos":[49455,49512],"content":"<bpt id=\"p1\">**</bpt>CTRL_MASK<ept id=\"p1\">**</ept> The CTRL key was pressed during the action.","source":"**CTRL_MASK** The CTRL key was pressed during the action."},{"pos":[49520,49575],"content":"<bpt id=\"p1\">**</bpt>ALT_MASK<ept id=\"p1\">**</ept> The ALT key was pressed during the action.","source":"**ALT_MASK** The ALT key was pressed during the action."},{"pos":[49585,49592],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If this event is defined as a custom event, you determine when the event is fired.","pos":[49596,49678]},{"content":"For automatic firing of a KeyUp event to occur, the control's Event map must have a stock KeyUp event defined.","pos":[49685,49795]},{"pos":[49805,49874],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__firemousedown\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireMouseDown","linkify":"<a name=\"colecontrol__firemousedown\"></a>  COleControl::FireMouseDown","source":"<a name=\"colecontrol__firemousedown\"></a>  COleControl::FireMouseDown"},{"content":"Called by the framework when a mouse button is pressed over an active custom control.","pos":[49878,49963]},{"pos":[50103,50113],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The numeric value of the mouse button pressed.","pos":[50130,50176]},{"content":"It can contain one of the following values:","pos":[50177,50220]},{"pos":[50228,50283],"content":"<bpt id=\"p1\">**</bpt>LEFT_BUTTON<ept id=\"p1\">**</ept> The left mouse button was pressed down.","source":"**LEFT_BUTTON** The left mouse button was pressed down."},{"pos":[50291,50350],"content":"<bpt id=\"p1\">**</bpt>MIDDLE_BUTTON<ept id=\"p1\">**</ept> The middle mouse button was pressed down.","source":"**MIDDLE_BUTTON** The middle mouse button was pressed down."},{"pos":[50358,50415],"content":"<bpt id=\"p1\">**</bpt>RIGHT_BUTTON<ept id=\"p1\">**</ept> The right mouse button was pressed down.","source":"**RIGHT_BUTTON** The right mouse button was pressed down."},{"pos":[50422,50485],"content":"`nShiftState`  \nContains a combination of the following flags:","leadings":[""," "],"nodes":[{"content":"Contains a combination of the following flags:","pos":[16,62]}]},{"pos":[50493,50552],"content":"<bpt id=\"p1\">**</bpt>SHIFT_MASK<ept id=\"p1\">**</ept> The SHIFT key was pressed during the action.","source":"**SHIFT_MASK** The SHIFT key was pressed during the action."},{"pos":[50560,50617],"content":"<bpt id=\"p1\">**</bpt>CTRL_MASK<ept id=\"p1\">**</ept> The CTRL key was pressed during the action.","source":"**CTRL_MASK** The CTRL key was pressed during the action."},{"pos":[50625,50680],"content":"<bpt id=\"p1\">**</bpt>ALT_MASK<ept id=\"p1\">**</ept> The ALT key was pressed during the action.","source":"**ALT_MASK** The ALT key was pressed during the action."},{"pos":[50687,50837],"content":"*x*  \nThe x-coordinate of the cursor when a mouse button was pressed down. The coordinate is relative to the upper-left corner of the control window.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>x<ept id=\"p1\">*</ept>","pos":[0,3],"source":"*x*"},{"content":"The x-coordinate of the cursor when a mouse button was pressed down. The coordinate is relative to the upper-left corner of the control window.","pos":[6,149],"nodes":[{"content":"The x-coordinate of the cursor when a mouse button was pressed down.","pos":[0,68]},{"content":"The coordinate is relative to the upper-left corner of the control window.","pos":[69,143]}]}]},{"pos":[50844,50994],"content":"*y*  \nThe y-coordinate of the cursor when a mouse button was pressed down. The coordinate is relative to the upper-left corner of the control window.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>y<ept id=\"p1\">*</ept>","pos":[0,3],"source":"*y*"},{"content":"The y-coordinate of the cursor when a mouse button was pressed down. The coordinate is relative to the upper-left corner of the control window.","pos":[6,149],"nodes":[{"content":"The y-coordinate of the cursor when a mouse button was pressed down.","pos":[0,68]},{"content":"The coordinate is relative to the upper-left corner of the control window.","pos":[69,143]}]}]},{"pos":[51004,51011],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If this event is defined as a custom event, you determine when the event is fired.","pos":[51015,51097]},{"content":"For automatic firing of a MouseDown event to occur, the control's Event map must have a stock MouseDown event defined.","pos":[51104,51222]},{"pos":[51232,51301],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__firemousemove\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireMouseMove","linkify":"<a name=\"colecontrol__firemousemove\"></a>  COleControl::FireMouseMove","source":"<a name=\"colecontrol__firemousemove\"></a>  COleControl::FireMouseMove"},{"content":"Called by the framework when the cursor is moved over an active custom control.","pos":[51305,51384]},{"pos":[51524,51534],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The numeric value of the mouse buttons pressed.","pos":[51551,51598]},{"content":"Contains a combination of the following values:","pos":[51599,51646]},{"pos":[51654,51727],"content":"<bpt id=\"p1\">**</bpt>LEFT_BUTTON<ept id=\"p1\">**</ept> The left mouse button was pressed down during the action.","source":"**LEFT_BUTTON** The left mouse button was pressed down during the action."},{"pos":[51735,51812],"content":"<bpt id=\"p1\">**</bpt>MIDDLE_BUTTON<ept id=\"p1\">**</ept> The middle mouse button was pressed down during the action.","source":"**MIDDLE_BUTTON** The middle mouse button was pressed down during the action."},{"pos":[51820,51895],"content":"<bpt id=\"p1\">**</bpt>RIGHT_BUTTON<ept id=\"p1\">**</ept> The right mouse button was pressed down during the action.","source":"**RIGHT_BUTTON** The right mouse button was pressed down during the action."},{"pos":[51902,51965],"content":"`nShiftState`  \nContains a combination of the following flags:","leadings":[""," "],"nodes":[{"content":"Contains a combination of the following flags:","pos":[16,62]}]},{"pos":[51973,52032],"content":"<bpt id=\"p1\">**</bpt>SHIFT_MASK<ept id=\"p1\">**</ept> The SHIFT key was pressed during the action.","source":"**SHIFT_MASK** The SHIFT key was pressed during the action."},{"pos":[52040,52097],"content":"<bpt id=\"p1\">**</bpt>CTRL_MASK<ept id=\"p1\">**</ept> The CTRL key was pressed during the action.","source":"**CTRL_MASK** The CTRL key was pressed during the action."},{"pos":[52105,52160],"content":"<bpt id=\"p1\">**</bpt>ALT_MASK<ept id=\"p1\">**</ept> The ALT key was pressed during the action.","source":"**ALT_MASK** The ALT key was pressed during the action."},{"pos":[52167,52280],"content":"*x*  \nThe x-coordinate of the cursor. The coordinate is relative to the upper-left corner of the control window.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>x<ept id=\"p1\">*</ept>","pos":[0,3],"source":"*x*"},{"content":"The x-coordinate of the cursor. The coordinate is relative to the upper-left corner of the control window.","pos":[6,112],"nodes":[{"content":"The x-coordinate of the cursor.","pos":[0,31]},{"content":"The coordinate is relative to the upper-left corner of the control window.","pos":[32,106]}]}]},{"pos":[52287,52400],"content":"*y*  \nThe y-coordinate of the cursor. The coordinate is relative to the upper-left corner of the control window.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>y<ept id=\"p1\">*</ept>","pos":[0,3],"source":"*y*"},{"content":"The y-coordinate of the cursor. The coordinate is relative to the upper-left corner of the control window.","pos":[6,112],"nodes":[{"content":"The y-coordinate of the cursor.","pos":[0,31]},{"content":"The coordinate is relative to the upper-left corner of the control window.","pos":[32,106]}]}]},{"pos":[52410,52417],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If this event is defined as a custom event, you determine when the event is fired.","pos":[52421,52503]},{"content":"For automatic firing of a MouseMove event to occur, the control's Event map must have a stock MouseMove event defined.","pos":[52510,52628]},{"pos":[52638,52703],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__firemouseup\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireMouseUp","linkify":"<a name=\"colecontrol__firemouseup\"></a>  COleControl::FireMouseUp","source":"<a name=\"colecontrol__firemouseup\"></a>  COleControl::FireMouseUp"},{"content":"Called by the framework when a mouse button is released over an active custom control.","pos":[52707,52793]},{"pos":[52931,52941],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The numeric value of the mouse button released.","pos":[52958,53005]},{"content":"It can have one of the following values:","pos":[53006,53046]},{"pos":[53054,53105],"content":"<bpt id=\"p1\">**</bpt>LEFT_BUTTON<ept id=\"p1\">**</ept> The left mouse button was released.","source":"**LEFT_BUTTON** The left mouse button was released."},{"pos":[53113,53168],"content":"<bpt id=\"p1\">**</bpt>MIDDLE_BUTTON<ept id=\"p1\">**</ept> The middle mouse button was released.","source":"**MIDDLE_BUTTON** The middle mouse button was released."},{"pos":[53176,53229],"content":"<bpt id=\"p1\">**</bpt>RIGHT_BUTTON<ept id=\"p1\">**</ept> The right mouse button was released.","source":"**RIGHT_BUTTON** The right mouse button was released."},{"pos":[53236,53299],"content":"`nShiftState`  \nContains a combination of the following flags:","leadings":[""," "],"nodes":[{"content":"Contains a combination of the following flags:","pos":[16,62]}]},{"pos":[53307,53366],"content":"<bpt id=\"p1\">**</bpt>SHIFT_MASK<ept id=\"p1\">**</ept> The SHIFT key was pressed during the action.","source":"**SHIFT_MASK** The SHIFT key was pressed during the action."},{"pos":[53374,53431],"content":"<bpt id=\"p1\">**</bpt>CTRL_MASK<ept id=\"p1\">**</ept> The CTRL key was pressed during the action.","source":"**CTRL_MASK** The CTRL key was pressed during the action."},{"pos":[53439,53494],"content":"<bpt id=\"p1\">**</bpt>ALT_MASK<ept id=\"p1\">**</ept> The ALT key was pressed during the action.","source":"**ALT_MASK** The ALT key was pressed during the action."},{"pos":[53501,53647],"content":"*x*  \nThe x-coordinate of the cursor when a mouse button was released. The coordinate is relative to the upper-left corner of the control window.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>x<ept id=\"p1\">*</ept>","pos":[0,3],"source":"*x*"},{"content":"The x-coordinate of the cursor when a mouse button was released. The coordinate is relative to the upper-left corner of the control window.","pos":[6,145],"nodes":[{"content":"The x-coordinate of the cursor when a mouse button was released.","pos":[0,64]},{"content":"The coordinate is relative to the upper-left corner of the control window.","pos":[65,139]}]}]},{"pos":[53654,53798],"content":"*y*  \nThe y-coordinate of a cursor when a mouse button was released. The coordinate is relative to the upper-left corner of the control window.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>y<ept id=\"p1\">*</ept>","pos":[0,3],"source":"*y*"},{"content":"The y-coordinate of a cursor when a mouse button was released. The coordinate is relative to the upper-left corner of the control window.","pos":[6,143],"nodes":[{"content":"The y-coordinate of a cursor when a mouse button was released.","pos":[0,62]},{"content":"The coordinate is relative to the upper-left corner of the control window.","pos":[63,137]}]}]},{"pos":[53808,53815],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If this event is defined as a custom event, you determine when the event is fired.","pos":[53819,53901]},{"content":"For automatic firing of a MouseUp event to occur, the control's Event map must have a stock MouseUp event defined.","pos":[53908,54022]},{"pos":[54032,54115],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__firereadystatechange\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::FireReadyStateChange","linkify":"<a name=\"colecontrol__firereadystatechange\"></a>  COleControl::FireReadyStateChange","source":"<a name=\"colecontrol__firereadystatechange\"></a>  COleControl::FireReadyStateChange"},{"content":"Fires an event with the current value of the ready state of control.","pos":[54119,54187]},{"pos":[54241,54248],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The ready state can be one of the following values:","pos":[54252,54303]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_UNINITIALIZED<ept id=\"p1\">**</ept>","pos":[54310,54338],"source":"**READYSTATE_UNINITIALIZED**"},{"content":"Default initialization state","pos":[54342,54370]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_LOADING<ept id=\"p1\">**</ept>","pos":[54377,54399],"source":"**READYSTATE_LOADING**"},{"content":"Control is currently loading its properties","pos":[54403,54446]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_LOADED<ept id=\"p1\">**</ept>","pos":[54453,54474],"source":"**READYSTATE_LOADED**"},{"content":"Control has been initialized","pos":[54478,54506]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_INTERACTIVE<ept id=\"p1\">**</ept>","pos":[54513,54539],"source":"**READYSTATE_INTERACTIVE**"},{"content":"Control has enough data to be interactive but not all asynchronous data is yet loaded","pos":[54543,54628]},{"content":"Control has all its data","pos":[54660,54684]},{"pos":[54691,54785],"content":"Use <bpt id=\"p1\">[</bpt>GetReadyState<ept id=\"p1\">](#colecontrol__getreadystate)</ept> to determine the control's current readiness.","source":"Use [GetReadyState](#colecontrol__getreadystate) to determine the control's current readiness."},{"pos":[54792,54934],"content":"<bpt id=\"p1\">[</bpt>InternalSetReadyState<ept id=\"p1\">](#colecontrol__internalsetreadystate)</ept> changes the ready state to the value supplied, then calls <ph id=\"ph1\">`FireReadyStateChange`</ph>.","source":"[InternalSetReadyState](#colecontrol__internalsetreadystate) changes the ready state to the value supplied, then calls `FireReadyStateChange`."},{"pos":[54944,55025],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getactivationpolicy\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetActivationPolicy","linkify":"<a name=\"colecontrol__getactivationpolicy\"></a>  COleControl::GetActivationPolicy","source":"<a name=\"colecontrol__getactivationpolicy\"></a>  COleControl::GetActivationPolicy"},{"pos":[55029,55128],"content":"Alters the default activation behavior of a control that supports the <ph id=\"ph1\">`IPointerInactive`</ph> interface.","source":"Alters the default activation behavior of a control that supports the `IPointerInactive` interface."},{"pos":[55190,55202],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A combination of flags from the <bpt id=\"p1\">**</bpt>POINTERINACTIVE<ept id=\"p1\">**</ept> enumeration.","pos":[55206,55270],"source":"A combination of flags from the **POINTERINACTIVE** enumeration."},{"content":"Possible flags are:","pos":[55271,55290]},{"content":"<bpt id=\"p1\">**</bpt>POINTERINACTIVE_ACTIVATEONENTRY<ept id=\"p1\">**</ept>","pos":[55297,55332],"source":"**POINTERINACTIVE_ACTIVATEONENTRY**"},{"content":"The object should be in-place activated when the mouse enters it during a mouse move operation.","pos":[55336,55431]},{"content":"<bpt id=\"p1\">**</bpt>POINTERINACTIVE_DEACTIVATEONLEAVE<ept id=\"p1\">**</ept>","pos":[55438,55475],"source":"**POINTERINACTIVE_DEACTIVATEONLEAVE**"},{"content":"The object should be deactivated when the mouse leaves the object during a mouse move operation.","pos":[55479,55575]},{"content":"<bpt id=\"p1\">**</bpt>POINTERINACTIVE_ACTIVATEONDRAG<ept id=\"p1\">**</ept>","pos":[55582,55616],"source":"**POINTERINACTIVE_ACTIVATEONDRAG**"},{"content":"The object should be in-place activated when the mouse is dragged over it during a drag and drop operation.","pos":[55620,55727]},{"pos":[55737,55744],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"When the <ph id=\"ph1\">`IPointerInactive`</ph> interface is enabled, the container will delegate <ph id=\"ph2\">`WM_SETCURSOR`</ph> and <ph id=\"ph3\">`WM_MOUSEMOVE`</ph> messages to it.","pos":[55748,55875],"source":"When the `IPointerInactive` interface is enabled, the container will delegate `WM_SETCURSOR` and `WM_MOUSEMOVE` messages to it."},{"content":"<ph id=\"ph1\">`COleControl`</ph>'s implementation of this interface will dispatch these messages through your control's message map, after adjusting the mouse coordinates appropriately.","pos":[55876,56042],"source":"`COleControl`'s implementation of this interface will dispatch these messages through your control's message map, after adjusting the mouse coordinates appropriately."},{"pos":[56049,56314],"content":"Whenever the container receives a <ph id=\"ph1\">`WM_SETCURSOR`</ph> or <ph id=\"ph2\">`WM_MOUSEMOVE`</ph> message with the mouse pointer over an inactive object supporting <ph id=\"ph3\">`IPointerInactive`</ph>, it should call <ph id=\"ph4\">`GetActivationPolicy`</ph> on the interface and return flags from the <bpt id=\"p1\">**</bpt>POINTERINACTIVE<ept id=\"p1\">**</ept> enumeration.","source":"Whenever the container receives a `WM_SETCURSOR` or `WM_MOUSEMOVE` message with the mouse pointer over an inactive object supporting `IPointerInactive`, it should call `GetActivationPolicy` on the interface and return flags from the **POINTERINACTIVE** enumeration."},{"content":"You can process these messages just like ordinary window messages, by adding the corresponding entries to the message map.","pos":[56321,56443]},{"content":"In your handlers, avoid using the <ph id=\"ph1\">`m_hWnd`</ph> member variable (or any member functions that uses it) without first checking that its value is non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[56444,56597],"source":" In your handlers, avoid using the `m_hWnd` member variable (or any member functions that uses it) without first checking that its value is non- **NULL**."},{"content":"Any object intended to do more than set the mouse cursor and/or fire a mouse move event, such as give special visual feedback, should return the <bpt id=\"p1\">**</bpt>POINTERINACTIVE_ACTIVATEONENTRY<ept id=\"p1\">**</ept> flag and draw the feedback only when active.","pos":[56604,56829],"source":"Any object intended to do more than set the mouse cursor and/or fire a mouse move event, such as give special visual feedback, should return the **POINTERINACTIVE_ACTIVATEONENTRY** flag and draw the feedback only when active."},{"content":"If the object returns this flag, the container should activate it in-place immediately and then forward it the same message that triggered the call to <ph id=\"ph1\">`GetActivationPolicy`</ph>.","pos":[56830,57003],"source":" If the object returns this flag, the container should activate it in-place immediately and then forward it the same message that triggered the call to `GetActivationPolicy`."},{"content":"If both the <bpt id=\"p1\">**</bpt>POINTERINACTIVE_ACTIVATEONENTRY<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>POINTERINACTIVE_DEACTIVATEONLEAVE<ept id=\"p2\">**</ept> flags are returned, then the object will only be activated when the mouse is over the object.","pos":[57010,57193],"source":"If both the **POINTERINACTIVE_ACTIVATEONENTRY** and **POINTERINACTIVE_DEACTIVATEONLEAVE** flags are returned, then the object will only be activated when the mouse is over the object."},{"content":"If only the <bpt id=\"p1\">**</bpt>POINTERINACTIVE_ACTIVATEONENTRY<ept id=\"p1\">**</ept> flag is returned, then the object will only be activated once when the mouse first enters the object.","pos":[57194,57343],"source":" If only the **POINTERINACTIVE_ACTIVATEONENTRY** flag is returned, then the object will only be activated once when the mouse first enters the object."},{"content":"You may also want an inactive control to be the target of an OLE drag and drop operation.","pos":[57350,57439]},{"content":"This requires activating the control at the moment the user drags an object over it, so that the control's window can be registered as a drop target.","pos":[57440,57589]},{"content":"To cause activation to occur during a drag, return the <bpt id=\"p1\">**</bpt>POINTERINACTIVE_ACTIVATEONDRAG<ept id=\"p1\">**</ept> flag:","pos":[57590,57685],"source":" To cause activation to occur during a drag, return the **POINTERINACTIVE_ACTIVATEONDRAG** flag:"},{"pos":[57692,57780],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#1<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]"},{"content":"The information communicated by <ph id=\"ph1\">`GetActivationPolicy`</ph> should not be cached by a container.","pos":[57787,57877],"source":"The information communicated by `GetActivationPolicy` should not be cached by a container."},{"content":"Instead, this method should be called every time the mouse enters an inactive object.","pos":[57878,57963]},{"pos":[57970,58259],"content":"If an inactive object does not request to be in-place activated when the mouse enters it, its container should dispatch subsequent <ph id=\"ph1\">`WM_SETCURSOR`</ph> messages to this object by calling <bpt id=\"p1\">[</bpt>OnInactiveSetCursor<ept id=\"p1\">](#colecontrol__oninactivesetcursor)</ept> as long as the mouse pointer stays over the object.","source":"If an inactive object does not request to be in-place activated when the mouse enters it, its container should dispatch subsequent `WM_SETCURSOR` messages to this object by calling [OnInactiveSetCursor](#colecontrol__oninactivesetcursor) as long as the mouse pointer stays over the object."},{"content":"Enabling the <ph id=\"ph1\">`IPointerInactive`</ph> interface typically means that you want the control to be capable of processing mouse messages at all times.","pos":[58266,58406],"source":"Enabling the `IPointerInactive` interface typically means that you want the control to be capable of processing mouse messages at all times."},{"content":"To get this behaviour in a container that doesn't support the <ph id=\"ph1\">`IPointerInactive`</ph> interface, you will need to have your control always activated when visible, which means the control should have the <bpt id=\"p1\">**</bpt>OLEMISC_ACTIVATEWHENVISIBLE<ept id=\"p1\">**</ept> flag among its miscellaneous flags.","pos":[58407,58672],"source":" To get this behaviour in a container that doesn't support the `IPointerInactive` interface, you will need to have your control always activated when visible, which means the control should have the **OLEMISC_ACTIVATEWHENVISIBLE** flag among its miscellaneous flags."},{"content":"However, to prevent this flag from taking effect in a container that does support <ph id=\"ph1\">`IPointerInactive`</ph>, you can also specify the <bpt id=\"p1\">**</bpt>OLEMISC_IGNOREACTIVATEWHENVISIBLE<ept id=\"p1\">**</ept> flag:","pos":[58673,58843],"source":" However, to prevent this flag from taking effect in a container that does support `IPointerInactive`, you can also specify the **OLEMISC_IGNOREACTIVATEWHENVISIBLE** flag:"},{"pos":[58850,58939],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#10<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]"},{"pos":[58949,59028],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getambientproperty\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetAmbientProperty","linkify":"<a name=\"colecontrol__getambientproperty\"></a>  COleControl::GetAmbientProperty","source":"<a name=\"colecontrol__getambientproperty\"></a>  COleControl::GetAmbientProperty"},{"content":"Gets the value of an ambient property of the container.","pos":[59032,59087]},{"pos":[59199,59209],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>dwDispid<ept id=\"p1\">*</ept>","pos":[59213,59223],"source":"*dwDispid*"},{"content":"The dispatch ID of the desired ambient property.","pos":[59227,59275]},{"content":"A variant type tag that specifies the type of the value to be returned in <ph id=\"ph1\">`pvProp`</ph>.","pos":[59294,59377],"source":" A variant type tag that specifies the type of the value to be returned in `pvProp`."},{"content":"A pointer to the address of the variable that will receive the property value or return value.","pos":[59396,59490]},{"content":"The actual type of this pointer must match the type specified by <ph id=\"ph1\">`vtProp`</ph>.","pos":[59491,59565],"source":" The actual type of this pointer must match the type specified by `vtProp`."},{"content":"vtProp","pos":[59572,59578]},{"content":"Type of pvProp","pos":[59579,59593]},{"pos":[59646,59656],"content":"<bpt id=\"p1\">**</bpt>BOOL<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**BOOL\\***"},{"pos":[59671,59684],"content":"<bpt id=\"p1\">**</bpt>CString<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**CString\\***"},{"pos":[59697,59708],"content":"<bpt id=\"p1\">**</bpt>short<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**short\\***"},{"pos":[59721,59731],"content":"<bpt id=\"p1\">**</bpt>long<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**long\\***"},{"pos":[59744,59755],"content":"<bpt id=\"p1\">**</bpt>float<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**float\\***"},{"pos":[59768,59780],"content":"<bpt id=\"p1\">**</bpt>double<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**double\\***"},{"pos":[59793,59801],"content":"<bpt id=\"p1\">**</bpt>CY<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**CY\\***"},{"pos":[59806,59818],"content":"<bpt id=\"p1\">**</bpt>VT_COLOR<ept id=\"p1\">**</ept>","source":"**VT_COLOR**"},{"pos":[59819,59834],"content":"<bpt id=\"p1\">**</bpt>OLE_COLOR<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**OLE_COLOR\\***"},{"pos":[59839,59854],"content":"<bpt id=\"p1\">**</bpt>VT_DISPATCH<ept id=\"p1\">**</ept>","source":"**VT_DISPATCH**"},{"pos":[59855,59871],"content":"<bpt id=\"p1\">**</bpt>LPDISPATCH<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**LPDISPATCH\\***"},{"pos":[59876,59887],"content":"<bpt id=\"p1\">**</bpt>VT_FONT<ept id=\"p1\">**</ept>","source":"**VT_FONT**"},{"pos":[59888,59904],"content":"<bpt id=\"p1\">**</bpt>LPFONTDISP<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**LPFONTDISP\\***"},{"pos":[59915,59927],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the ambient property is supported; otherwise 0.","pos":[59931,59989]},{"pos":[59999,60006],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If you use <ph id=\"ph1\">`GetAmbientProperty`</ph> to retrieve the ambient DisplayName and ScaleUnits properties, set <ph id=\"ph2\">`vtProp`</ph> to <ph id=\"ph3\">`VT_BSTR`</ph> and <ph id=\"ph4\">`pvProp`</ph> to <bpt id=\"p1\">**</bpt>CString<ph id=\"ph5\">\\*</ph><ept id=\"p1\">**</ept>.","pos":[60010,60161],"source":"If you use `GetAmbientProperty` to retrieve the ambient DisplayName and ScaleUnits properties, set `vtProp` to `VT_BSTR` and `pvProp` to **CString\\***."},{"content":"If you are retrieving the ambient Font property, set <ph id=\"ph1\">`vtProp`</ph> to <bpt id=\"p1\">**</bpt>VT_FONT<ept id=\"p1\">**</ept> and <ph id=\"ph2\">`pvProp`</ph> to <bpt id=\"p2\">**</bpt>LPFONTDISP<ph id=\"ph3\">\\*</ph><ept id=\"p2\">**</ept>.","pos":[60162,60272],"source":" If you are retrieving the ambient Font property, set `vtProp` to **VT_FONT** and `pvProp` to **LPFONTDISP\\***."},{"pos":[60279,60461],"content":"Note that functions have already been provided for common ambient properties, such as <bpt id=\"p1\">[</bpt>AmbientBackColor<ept id=\"p1\">](#colecontrol__ambientbackcolor)</ept> and <bpt id=\"p2\">[</bpt>AmbientFont<ept id=\"p2\">](#colecontrol__ambientfont)</ept>.","source":"Note that functions have already been provided for common ambient properties, such as [AmbientBackColor](#colecontrol__ambientbackcolor) and [AmbientFont](#colecontrol__ambientfont)."},{"pos":[60471,60540],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getappearance\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetAppearance","linkify":"<a name=\"colecontrol__getappearance\"></a>  COleControl::GetAppearance","source":"<a name=\"colecontrol__getappearance\"></a>  COleControl::GetAppearance"},{"content":"Implements the Get function of your control's stock Appearance property.","pos":[60544,60616]},{"pos":[60665,60677],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The return value specifies the current appearance setting as a <bpt id=\"p1\">**</bpt>short<ept id=\"p1\">**</ept> ( <ph id=\"ph1\">`VT_I2`</ph>) value, if successful.","pos":[60681,60786],"source":"The return value specifies the current appearance setting as a **short** ( `VT_I2`) value, if successful."},{"content":"This value is zero if the control's appearance is flat and 1 if the control's appearance is 3D.","pos":[60787,60882]},{"pos":[60892,60959],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getbackcolor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetBackColor","linkify":"<a name=\"colecontrol__getbackcolor\"></a>  COleControl::GetBackColor","source":"<a name=\"colecontrol__getbackcolor\"></a>  COleControl::GetBackColor"},{"content":"Implements the Get function of your control's stock BackColor property.","pos":[60963,61034]},{"pos":[61085,61097],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The return value specifies the current background color as a <bpt id=\"p1\">**</bpt>OLE_COLOR<ept id=\"p1\">**</ept> value, if successful.","pos":[61101,61197],"source":"The return value specifies the current background color as a **OLE_COLOR** value, if successful."},{"content":"This value can be translated to a <bpt id=\"p1\">**</bpt>COLORREF<ept id=\"p1\">**</ept> value with a call to <ph id=\"ph1\">`TranslateColor`</ph>.","pos":[61198,61283],"source":" This value can be translated to a **COLORREF** value with a call to `TranslateColor`."},{"pos":[61293,61364],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getborderstyle\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetBorderStyle","linkify":"<a name=\"colecontrol__getborderstyle\"></a>  COleControl::GetBorderStyle","source":"<a name=\"colecontrol__getborderstyle\"></a>  COleControl::GetBorderStyle"},{"content":"Implements the Get function of your control's stock BorderStyle property.","pos":[61368,61441]},{"pos":[61490,61502],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"1 if the control has a normal border; 0 if the control has no border.","pos":[61506,61575]},{"pos":[61585,61648],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getcapture\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetCapture","linkify":"<a name=\"colecontrol__getcapture\"></a>  COleControl::GetCapture","source":"<a name=\"colecontrol__getcapture\"></a>  COleControl::GetCapture"},{"pos":[61652,61718],"content":"Determines whether the <ph id=\"ph1\">`COleControl`</ph> object has the mouse capture.","source":"Determines whether the `COleControl` object has the mouse capture."},{"pos":[61763,61775],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[61779,61975],"content":"If the control is activated and windowless, returns <bpt id=\"p1\">**</bpt>this<ept id=\"p1\">**</ept> if the control currently has the mouse capture (as determined by the control's container), or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> if it does not have the capture.","source":"If the control is activated and windowless, returns **this** if the control currently has the mouse capture (as determined by the control's container), or **NULL** if it does not have the capture."},{"pos":[61982,62075],"content":"Otherwise, returns the <ph id=\"ph1\">`CWnd`</ph> object that has the mouse capture (same as <ph id=\"ph2\">`CWnd::GetCapture`</ph>).","source":"Otherwise, returns the `CWnd` object that has the mouse capture (same as `CWnd::GetCapture`)."},{"pos":[62085,62092],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[62096,62209],"content":"An activated windowless control receives the mouse capture when <bpt id=\"p1\">[</bpt>SetCapture<ept id=\"p1\">](#colecontrol__setcapture)</ept> is called.","source":"An activated windowless control receives the mouse capture when [SetCapture](#colecontrol__setcapture) is called."},{"pos":[62219,62282],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getclassid\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetClassID","linkify":"<a name=\"colecontrol__getclassid\"></a>  COleControl::GetClassID","source":"<a name=\"colecontrol__getclassid\"></a>  COleControl::GetClassID"},{"content":"Called by the framework to retrieve the OLE class ID of the control.","pos":[62286,62354]},{"pos":[62429,62439],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pclsid<ept id=\"p1\">*</ept>","pos":[62443,62451],"source":"*pclsid*"},{"content":"Pointer to the location of the class ID.","pos":[62455,62495]},{"pos":[62505,62517],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the call was not successful; otherwise 0.","pos":[62521,62573]},{"pos":[62583,62590],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[62594,62703],"content":"Usually implemented by the <bpt id=\"p1\">[</bpt>IMPLEMENT_OLECREATE_EX<ept id=\"p1\">](class-factories-and-licensing.md#implement_olecreate_ex)</ept>.","source":"Usually implemented by the [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)."},{"pos":[62713,62786],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getclientoffset\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetClientOffset","linkify":"<a name=\"colecontrol__getclientoffset\"></a>  COleControl::GetClientOffset","source":"<a name=\"colecontrol__getclientoffset\"></a>  COleControl::GetClientOffset"},{"content":"Retrieves the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area.","pos":[62790,62924]},{"pos":[63027,63037],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pdxOffset<ept id=\"p1\">*</ept>","pos":[63041,63052],"source":"*pdxOffset*"},{"content":"Pointer to the horizontal offset of the OLE control's client area.","pos":[63056,63122]},{"content":"<bpt id=\"p1\">*</bpt>pdyOffset<ept id=\"p1\">*</ept>","pos":[63129,63140],"source":"*pdyOffset*"},{"content":"Pointer to the vertical offset of the OLE control's client area.","pos":[63144,63208]},{"pos":[63218,63225],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The OLE control has a rectangular area within its container.","pos":[63229,63289]},{"content":"The client area of the control is the control area excluding borders and scroll bars.","pos":[63290,63375]},{"content":"The offset retrieved by <ph id=\"ph1\">`GetClientOffset`</ph> is the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area.","pos":[63376,63545],"source":" The offset retrieved by `GetClientOffset` is the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area."},{"content":"If your control has non-client elements other than the standard borders and scrollbars, override this member function to specify the offset.","pos":[63546,63686]},{"pos":[63696,63765],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getclientrect\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetClientRect","linkify":"<a name=\"colecontrol__getclientrect\"></a>  COleControl::GetClientRect","source":"<a name=\"colecontrol__getclientrect\"></a>  COleControl::GetClientRect"},{"content":"Retrieves the size of the control's client area.","pos":[63769,63817]},{"pos":[63894,63904],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to a <ph id=\"ph1\">`RECT`</ph> structure containing the dimensions of the windowless control's client area; that is, the control's size minus window borders, frames, scroll bars, and so on.","pos":[63920,64098],"source":" Pointer to a `RECT` structure containing the dimensions of the windowless control's client area; that is, the control's size minus window borders, frames, scroll bars, and so on."},{"content":"The <ph id=\"ph1\">`lpRect`</ph> parameter indicates the size of the control's client rectangle, not its position.","pos":[64099,64193],"source":" The `lpRect` parameter indicates the size of the control's client rectangle, not its position."},{"pos":[64203,64272],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getclientsite\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetClientSite","linkify":"<a name=\"colecontrol__getclientsite\"></a>  COleControl::GetClientSite","source":"<a name=\"colecontrol__getclientsite\"></a>  COleControl::GetClientSite"},{"content":"Queries an object for the pointer to its current client site within its container.","pos":[64276,64358]},{"pos":[64416,64428],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to the control's current client site in its container.","pos":[64432,64496]},{"pos":[64506,64513],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The returned pointer points to an instance of <ph id=\"ph1\">`IOleClientSite`</ph>.","pos":[64517,64580],"source":"The returned pointer points to an instance of `IOleClientSite`."},{"content":"The <ph id=\"ph1\">`IOleClientSite`</ph> interface, implemented by containers, is the object's view of its context: where it is anchored in the document, where it gets its storage, user interface, and other resources.","pos":[64581,64778],"source":" The `IOleClientSite` interface, implemented by containers, is the object's view of its context: where it is anchored in the document, where it gets its storage, user interface, and other resources."},{"pos":[64788,64861],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getcontrolflags\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetControlFlags","linkify":"<a name=\"colecontrol__getcontrolflags\"></a>  COleControl::GetControlFlags","source":"<a name=\"colecontrol__getcontrolflags\"></a>  COleControl::GetControlFlags"},{"content":"Retrieves the control flag settings.","pos":[64865,64901]},{"pos":[64959,64971],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"An ORed combination of the flags in the ControlFlags enumeration:","pos":[64975,65040]},{"pos":[65293,65300],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[65304,65373],"content":"By default, <ph id=\"ph1\">`GetControlFlags`</ph> returns <ph id=\"ph2\">`fastBeginPaint | clipPaintDC`</ph>.","source":"By default, `GetControlFlags` returns `fastBeginPaint | clipPaintDC`."},{"content":"If set, uses a begin-paint function tailored for OLE controls instead of the <bpt id=\"p1\">[</bpt>BeginPaint<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183362)</ept> API (set by default).","pos":[65400,65571],"source":" If set, uses a begin-paint function tailored for OLE controls instead of the [BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) API (set by default)."},{"content":"If not set, disables the call to <ph id=\"ph1\">`IntersectClipRect`</ph> made by <ph id=\"ph2\">`COleControl`</ph> and gains a small speed advantage.","pos":[65595,65704],"source":" If not set, disables the call to `IntersectClipRect` made by `COleControl` and gains a small speed advantage."},{"content":"If you are using windowless activation, the flag has no effect.","pos":[65705,65768]},{"content":"If set, provides mouse interaction while your control is inactive by enabling <ph id=\"ph1\">`COleControl`</ph>'s implementation of the <ph id=\"ph2\">`IPointerInactive`</ph> interface, which is disabled by default.","pos":[65796,65971],"source":" If set, provides mouse interaction while your control is inactive by enabling `COleControl`'s implementation of the `IPointerInactive` interface, which is disabled by default."},{"content":"If set, eliminates extra drawing operations and the accompanying visual flicker.","pos":[66001,66081]},{"content":"Use when your control draws itself identically in the inactive and active states.","pos":[66082,66163]},{"content":"If you are using windowless activation, the flag has no effect.","pos":[66164,66227]},{"content":"If set, indicates your control uses windowless activation.","pos":[66258,66316]},{"content":"If set, indicates that the control will perform optimized drawing, if the container supports it.","pos":[66344,66440]},{"pos":[66447,66618],"content":"For more information about <ph id=\"ph1\">`GetControlFlags`</ph> and other optimizations of OLE controls, see <bpt id=\"p1\">[</bpt>ActiveX Controls: Optimization<ept id=\"p1\">](../../mfc/mfc-activex-controls-optimization.md)</ept>.","source":"For more information about `GetControlFlags` and other optimizations of OLE controls, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md)."},{"pos":[66628,66699],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getcontrolsize\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetControlSize","linkify":"<a name=\"colecontrol__getcontrolsize\"></a>  COleControl::GetControlSize","source":"<a name=\"colecontrol__getcontrolsize\"></a>  COleControl::GetControlSize"},{"content":"Retrieves the size of the OLE control window.","pos":[66703,66748]},{"pos":[66825,66835],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pcx<ept id=\"p1\">*</ept>","pos":[66839,66844],"source":"*pcx*"},{"content":"Specifies the width of the control in pixels.","pos":[66848,66893]},{"content":"<bpt id=\"p1\">*</bpt>pcy<ept id=\"p1\">*</ept>","pos":[66900,66905],"source":"*pcy*"},{"content":"Specifies the height of the control in pixels.","pos":[66909,66955]},{"pos":[66965,66972],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that all coordinates for control windows are relative to the upper-left corner of the control.","pos":[66976,67075]},{"pos":[67085,67138],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getdc\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetDC","linkify":"<a name=\"colecontrol__getdc\"></a>  COleControl::GetDC","source":"<a name=\"colecontrol__getdc\"></a>  COleControl::GetDC"},{"content":"Provides for a windowless object to get a screen (or compatible) device context from its container.","pos":[67142,67241]},{"pos":[67342,67352],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>lprcRect<ept id=\"p1\">*</ept>","pos":[67356,67366],"source":"*lprcRect*"},{"content":"A pointer to the rectangle the windowless control wants to redraw, in client coordinates of the control.","pos":[67370,67474]},{"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> means the full object's extent.","pos":[67475,67515],"source":"**NULL** means the full object's extent."},{"content":"Drawing attributes of the device context.","pos":[67535,67576]},{"content":"Choices are:","pos":[67577,67589]},{"content":"<bpt id=\"p1\">**</bpt>OLEDC_NODRAW<ept id=\"p1\">**</ept> Indicates that the object won't use the device context to perform any drawing but merely to get information about the display device.","pos":[67597,67747],"source":"**OLEDC_NODRAW** Indicates that the object won't use the device context to perform any drawing but merely to get information about the display device."},{"content":"The container should simply pass the window's DC without further processing.","pos":[67748,67824]},{"content":"<bpt id=\"p1\">**</bpt>OLEDC_PAINTBKGND<ept id=\"p1\">**</ept> Requests that the container paint the background before returning the DC.","pos":[67832,67926],"source":"**OLEDC_PAINTBKGND** Requests that the container paint the background before returning the DC."},{"content":"An object should use this flag if it is requesting a DC for redrawing an area with transparent background.","pos":[67927,68033]},{"content":"<bpt id=\"p1\">**</bpt>OLEDC_OFFSCREEN<ept id=\"p1\">**</ept> Informs the container that the object wishes to render into an off-screen bitmap that should then be copied to the screen.","pos":[68041,68183],"source":"**OLEDC_OFFSCREEN** Informs the container that the object wishes to render into an off-screen bitmap that should then be copied to the screen."},{"content":"An object should use this flag when the drawing operation it is about to perform generates a lot of flicker.","pos":[68184,68292]},{"content":"The container is free to honor this request or not.","pos":[68293,68344]},{"content":"However, if this flag is not set, the container must hand back an on-screen DC.","pos":[68345,68424]},{"content":"This allows objects to perform direct screen operations such as showing a selection (via an <bpt id=\"p1\">**</bpt>XOR<ept id=\"p1\">**</ept> operation).","pos":[68425,68536],"source":" This allows objects to perform direct screen operations such as showing a selection (via an **XOR** operation)."},{"pos":[68546,68558],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Pointer to the display device context for the container <ph id=\"ph1\">`CWnd`</ph> client area if successful; otherwise, the return value is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[68562,68692],"source":"Pointer to the display device context for the container `CWnd` client area if successful; otherwise, the return value is **NULL**."},{"content":"The display device context can be used in subsequent GDI functions to draw in the client area of the container's window.","pos":[68693,68813]},{"pos":[68823,68830],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <bpt id=\"p1\">[</bpt>ReleaseDC<ept id=\"p1\">](#colecontrol__releasedc)</ept> member function must be called to release the context after painting.","pos":[68834,68944],"source":"The [ReleaseDC](#colecontrol__releasedc) member function must be called to release the context after painting."},{"content":"When calling <ph id=\"ph1\">`GetDC`</ph>, objects pass the rectangle they wish to draw into in their own client coordinates.","pos":[68945,69049],"source":" When calling `GetDC`, objects pass the rectangle they wish to draw into in their own client coordinates."},{"content":"<ph id=\"ph1\">`GetDC`</ph> translates these to coordinates of the container client area.","pos":[69050,69119],"source":"`GetDC` translates these to coordinates of the container client area."},{"content":"The object should not request a desired drawing rectangle larger than its own client area rectangle, the size of which can be retrieved with <bpt id=\"p1\">[</bpt>GetClientRect<ept id=\"p1\">](#colecontrol__getclientrect)</ept>.","pos":[69120,69306],"source":" The object should not request a desired drawing rectangle larger than its own client area rectangle, the size of which can be retrieved with [GetClientRect](#colecontrol__getclientrect)."},{"content":"This prevents objects from inadvertently drawing where they are not supposed to.","pos":[69307,69387]},{"pos":[69397,69460],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getenabled\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetEnabled","linkify":"<a name=\"colecontrol__getenabled\"></a>  COleControl::GetEnabled","source":"<a name=\"colecontrol__getenabled\"></a>  COleControl::GetEnabled"},{"content":"Implements the Get function of your control's stock Enabled property.","pos":[69464,69533]},{"pos":[69577,69589],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control is enabled; otherwise 0.","pos":[69593,69640]},{"pos":[69650,69729],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getextendedcontrol\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetExtendedControl","linkify":"<a name=\"colecontrol__getextendedcontrol\"></a>  COleControl::GetExtendedControl","source":"<a name=\"colecontrol__getextendedcontrol\"></a>  COleControl::GetExtendedControl"},{"content":"Obtains a pointer to an object maintained by the container that represents the control with an extended set of properties.","pos":[69733,69855]},{"pos":[69913,69925],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to the container's extended control object.","pos":[69929,69982]},{"content":"If there is no object available, the value is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[69983,70038],"source":" If there is no object available, the value is **NULL**."},{"content":"This object may be manipulated through its <ph id=\"ph1\">`IDispatch`</ph> interface.","pos":[70045,70110],"source":"This object may be manipulated through its `IDispatch` interface."},{"content":"You can also use <ph id=\"ph1\">`QueryInterface`</ph> to obtain other available interfaces provided by the object.","pos":[70111,70205],"source":" You can also use `QueryInterface` to obtain other available interfaces provided by the object."},{"content":"However, the object is not required to support a specific set of interfaces.","pos":[70206,70282]},{"content":"Note that relying on the specific features of a container's extended control object limits the portability of your control to other arbitrary containers.","pos":[70283,70436]},{"pos":[70446,70453],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The function that calls this function is responsible for releasing the pointer when finished with the object.","pos":[70457,70566]},{"content":"Note that the container is not required to support this object.","pos":[70567,70630]},{"pos":[70640,70699],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getfocus\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetFocus","linkify":"<a name=\"colecontrol__getfocus\"></a>  COleControl::GetFocus","source":"<a name=\"colecontrol__getfocus\"></a>  COleControl::GetFocus"},{"pos":[70703,70761],"content":"Determines whether the <ph id=\"ph1\">`COleControl`</ph> object has the focus.","source":"Determines whether the `COleControl` object has the focus."},{"pos":[70804,70816],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[70820,71015],"content":"If the control is activated and windowless, returns <bpt id=\"p1\">**</bpt>this<ept id=\"p1\">**</ept> if the control currently has the keyboard focus (as determined by the control's container), or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> if it does not have the focus.","source":"If the control is activated and windowless, returns **this** if the control currently has the keyboard focus (as determined by the control's container), or **NULL** if it does not have the focus."},{"pos":[71022,71105],"content":"Otherwise, returns the <ph id=\"ph1\">`CWnd`</ph> object that has the focus (same as <ph id=\"ph2\">`CWnd::GetFocus`</ph>).","source":"Otherwise, returns the `CWnd` object that has the focus (same as `CWnd::GetFocus`)."},{"pos":[71115,71122],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[71126,71227],"content":"An activated windowless control receives the focus when <bpt id=\"p1\">[</bpt>SetFocus<ept id=\"p1\">](#colecontrol__setfocus)</ept> is called.","source":"An activated windowless control receives the focus when [SetFocus](#colecontrol__setfocus) is called."},{"pos":[71237,71294],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getfont\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetFont","linkify":"<a name=\"colecontrol__getfont\"></a>  COleControl::GetFont","source":"<a name=\"colecontrol__getfont\"></a>  COleControl::GetFont"},{"content":"Implements the Get function of the stock Font property.","pos":[71298,71353]},{"pos":[71400,71412],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to the font dispatch interface of the control's stock Font property.","pos":[71416,71494]},{"pos":[71504,71511],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that the caller must release the object when finished.","pos":[71515,71574]},{"content":"Within the implementation of the control, use <ph id=\"ph1\">`InternalGetFont`</ph> to access the control's stock Font object.","pos":[71575,71681],"source":" Within the implementation of the control, use `InternalGetFont` to access the control's stock Font object."},{"content":"For more information on using fonts in your control, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Using Fonts in an ActiveX Control<ept id=\"p1\">](../../mfc/mfc-activex-controls-using-fonts.md)</ept>.","pos":[71682,71852],"source":" For more information on using fonts in your control, see the article [ActiveX Controls: Using Fonts in an ActiveX Control](../../mfc/mfc-activex-controls-using-fonts.md)."},{"pos":[71862,71941],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getfonttextmetrics\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetFontTextMetrics","linkify":"<a name=\"colecontrol__getfonttextmetrics\"></a>  COleControl::GetFontTextMetrics","source":"<a name=\"colecontrol__getfonttextmetrics\"></a>  COleControl::GetFontTextMetrics"},{"pos":[71945,72021],"content":"Measures the text metrics for any <ph id=\"ph1\">`CFontHolder`</ph> object owned by the control.","source":"Measures the text metrics for any `CFontHolder` object owned by the control."},{"pos":[72126,72136],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to a <bpt id=\"p1\">[</bpt>TEXTMETRIC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd145132)</ept> structure.","pos":[72150,72246],"source":" Pointer to a [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) structure."},{"content":"Reference to a <bpt id=\"p1\">[</bpt>CFontHolder<ept id=\"p1\">](../../mfc/reference/cfontholder-class.md)</ept> object.","pos":[72269,72347],"source":" Reference to a [CFontHolder](../../mfc/reference/cfontholder-class.md) object."},{"pos":[72357,72364],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Such a font can be selected with the <bpt id=\"p1\">[</bpt>COleControl::SelectFontObject<ept id=\"p1\">](#colecontrol__selectfontobject)</ept> function.","pos":[72368,72478],"source":"Such a font can be selected with the [COleControl::SelectFontObject](#colecontrol__selectfontobject) function."},{"content":"<ph id=\"ph1\">`GetFontTextMetrics`</ph> will initialize the <ph id=\"ph2\">`TEXTMETRIC`</ph> structure pointed to by <ph id=\"ph3\">`lptm`</ph> with valid metrics information about <ph id=\"ph4\">`fontHolder`</ph>'s font if successful, or fill the structure with zeros if not successful.","pos":[72479,72687],"source":"`GetFontTextMetrics` will initialize the `TEXTMETRIC` structure pointed to by `lptm` with valid metrics information about `fontHolder`'s font if successful, or fill the structure with zeros if not successful."},{"content":"You should use this function instead of <bpt id=\"p1\">[</bpt>GetTextMetrics<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd144941)</ept> when painting your control because controls, like any embedded OLE object, may be required to render themselves into a metafile.","pos":[72688,72933],"source":" You should use this function instead of [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) when painting your control because controls, like any embedded OLE object, may be required to render themselves into a metafile."},{"content":"The <ph id=\"ph1\">`TEXTMETRIC`</ph> structure for the default font is refreshed when the <bpt id=\"p1\">[</bpt>SelectFontObject<ept id=\"p1\">](#colecontrol__selectfontobject)</ept> function is called.","pos":[72940,73080],"source":"The `TEXTMETRIC` structure for the default font is refreshed when the [SelectFontObject](#colecontrol__selectfontobject) function is called."},{"content":"You should call <ph id=\"ph1\">`GetFontTextMetrics`</ph> only after selecting the stock Font property to assure the information it provides is valid.","pos":[73081,73210],"source":" You should call `GetFontTextMetrics` only after selecting the stock Font property to assure the information it provides is valid."},{"pos":[73220,73287],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getforecolor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetForeColor","linkify":"<a name=\"colecontrol__getforecolor\"></a>  COleControl::GetForeColor","source":"<a name=\"colecontrol__getforecolor\"></a>  COleControl::GetForeColor"},{"content":"Implements the Get function of the stock ForeColor property.","pos":[73291,73351]},{"pos":[73402,73414],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The return value specifies the current foreground color as a <bpt id=\"p1\">**</bpt>OLE_COLOR<ept id=\"p1\">**</ept> value, if successful.","pos":[73418,73514],"source":"The return value specifies the current foreground color as a **OLE_COLOR** value, if successful."},{"content":"This value can be translated to a <bpt id=\"p1\">[</bpt>COLORREF<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183449)</ept> value with a call to <ph id=\"ph1\">`TranslateColor`</ph>.","pos":[73515,73658],"source":" This value can be translated to a [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) value with a call to `TranslateColor`."},{"pos":[73668,73725],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__gethwnd\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetHwnd","linkify":"<a name=\"colecontrol__gethwnd\"></a>  COleControl::GetHwnd","source":"<a name=\"colecontrol__gethwnd\"></a>  COleControl::GetHwnd"},{"content":"Implements the Get function of the stock hWnd property.","pos":[73729,73784]},{"pos":[73831,73843],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[73847,73907],"content":"The OLE control's window handle, if any; otherwise <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"The OLE control's window handle, if any; otherwise **NULL**."},{"pos":[73917,73992],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getmessagestring\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetMessageString","linkify":"<a name=\"colecontrol__getmessagestring\"></a>  COleControl::GetMessageString","source":"<a name=\"colecontrol__getmessagestring\"></a>  COleControl::GetMessageString"},{"pos":[73996,74109],"content":"Called by the framework to obtain a short string that describes the purpose of the menu item identified by <ph id=\"ph1\">`nID`</ph>.","source":"Called by the framework to obtain a short string that describes the purpose of the menu item identified by `nID`."},{"pos":[74214,74224],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A menu item ID.","pos":[74237,74252]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> object through which a string will be returned.","pos":[74273,74397],"source":" A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object through which a string will be returned."},{"pos":[74407,74414],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This can be used to obtain a message for display in a status bar while the menu item is highlighted.","pos":[74418,74518]},{"content":"The default implementation attempts to load a string resource identified by <ph id=\"ph1\">`nID`</ph>.","pos":[74519,74601],"source":" The default implementation attempts to load a string resource identified by `nID`."},{"pos":[74611,74684],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getnotsupported\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetNotSupported","linkify":"<a name=\"colecontrol__getnotsupported\"></a>  COleControl::GetNotSupported","source":"<a name=\"colecontrol__getnotsupported\"></a>  COleControl::GetNotSupported"},{"content":"Prevents access to a control's property value by the user.","pos":[74688,74746]},{"pos":[74795,74802],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function in place of the Get function of any property where retrieval of the property by the control's user is not supported.","pos":[74806,74941]},{"content":"One example would be a property that is write only.","pos":[74942,74993]},{"pos":[75003,75072],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getreadystate\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetReadyState","linkify":"<a name=\"colecontrol__getreadystate\"></a>  COleControl::GetReadyState","source":"<a name=\"colecontrol__getreadystate\"></a>  COleControl::GetReadyState"},{"content":"Returns the readiness state of the control.","pos":[75076,75119]},{"pos":[75166,75178],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The readiness state of the control, one of the following values:","pos":[75182,75246]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_UNINITIALIZED<ept id=\"p1\">**</ept>","pos":[75253,75281],"source":"**READYSTATE_UNINITIALIZED**"},{"content":"Default initialization state","pos":[75285,75313]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_LOADING<ept id=\"p1\">**</ept>","pos":[75320,75342],"source":"**READYSTATE_LOADING**"},{"content":"Control is currently loading its properties","pos":[75346,75389]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_LOADED<ept id=\"p1\">**</ept>","pos":[75396,75417],"source":"**READYSTATE_LOADED**"},{"content":"Control has been initialized","pos":[75421,75449]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_INTERACTIVE<ept id=\"p1\">**</ept>","pos":[75456,75482],"source":"**READYSTATE_INTERACTIVE**"},{"content":"Control has enough data to be interactive but not all asynchronous data is yet loaded","pos":[75486,75571]},{"content":"Control has all its data","pos":[75603,75627]},{"pos":[75637,75644],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Most simple controls never need to differentiate between <bpt id=\"p1\">**</bpt>LOADED<ept id=\"p1\">**</ept> and <ph id=\"ph1\">`INTERACTIVE`</ph>.","pos":[75648,75734],"source":"Most simple controls never need to differentiate between **LOADED** and `INTERACTIVE`."},{"content":"However, controls that support data path properties may not be ready to be interactive until at least some data is received asynchronously.","pos":[75735,75874]},{"content":"A control should attempt to become interactive as soon as possible.","pos":[75875,75942]},{"pos":[75952,76031],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getrectincontainer\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetRectInContainer","linkify":"<a name=\"colecontrol__getrectincontainer\"></a>  COleControl::GetRectInContainer","source":"<a name=\"colecontrol__getrectincontainer\"></a>  COleControl::GetRectInContainer"},{"content":"Obtains the coordinates of the control's rectangle relative to the container, expressed in device units.","pos":[76035,76139]},{"pos":[76204,76214],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to the rectangle structure into which the control's coordinates will be copied.","pos":[76230,76319]},{"pos":[76329,76341],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control is in-place active; otherwise 0.","pos":[76345,76400]},{"pos":[76410,76417],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The rectangle is only valid if the control is in-place active.","pos":[76421,76483]},{"pos":[76493,76574],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getstocktextmetrics\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetStockTextMetrics","linkify":"<a name=\"colecontrol__getstocktextmetrics\"></a>  COleControl::GetStockTextMetrics","source":"<a name=\"colecontrol__getstocktextmetrics\"></a>  COleControl::GetStockTextMetrics"},{"pos":[76578,76732],"content":"Measures the text metrics for the control's stock Font property, which can be selected with the <bpt id=\"p1\">[</bpt>SelectStockFont<ept id=\"p1\">](#colecontrol__selectstockfont)</ept> function.","source":"Measures the text metrics for the control's stock Font property, which can be selected with the [SelectStockFont](#colecontrol__selectstockfont) function."},{"pos":[76802,76812],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>TEXTMETRIC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd145132)</ept> structure.","pos":[76826,76924],"source":" A pointer to a [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) structure."},{"pos":[76934,76941],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`GetStockTextMetrics`</ph> function will initialize the <ph id=\"ph2\">`TEXTMETRIC`</ph> structure pointed to by <ph id=\"ph3\">`lptm`</ph> with valid metrics information if successful, or fill the structure with zeros if not successful.","pos":[76945,77141],"source":"The `GetStockTextMetrics` function will initialize the `TEXTMETRIC` structure pointed to by `lptm` with valid metrics information if successful, or fill the structure with zeros if not successful."},{"content":"Use this function instead of <bpt id=\"p1\">[</bpt>GetTextMetrics<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd144941)</ept> when painting your control because controls, like any embedded OLE object, may be required to render themselves into a metafile.","pos":[77142,77376],"source":" Use this function instead of [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) when painting your control because controls, like any embedded OLE object, may be required to render themselves into a metafile."},{"content":"The <ph id=\"ph1\">`TEXTMETRIC`</ph> structure for the default font is refreshed when the <ph id=\"ph2\">`SelectStockFont`</ph> function is called.","pos":[77383,77490],"source":"The `TEXTMETRIC` structure for the default font is refreshed when the `SelectStockFont` function is called."},{"content":"You should call this function only after selecting the stock font to assure the information it provides is valid.","pos":[77491,77604]},{"pos":[77614,77671],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__gettext\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetText","linkify":"<a name=\"colecontrol__gettext\"></a>  COleControl::GetText","source":"<a name=\"colecontrol__gettext\"></a>  COleControl::GetText"},{"content":"Implements the Get function of the stock Text or Caption property.","pos":[77675,77741]},{"pos":[77782,77794],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The current value of the control text string or a zero-length string if no string is present.","pos":[77798,77891]},{"pos":[77899,78046],"content":"[!NOTE]\n For more information on the `BSTR` data type, see [Data Types](../../mfc/reference/data-types-mfc.md) in the Macros and Globals section.","leadings":["","> "],"nodes":[{"content":"For more information on the <ph id=\"ph1\">`BSTR`</ph> data type, see <bpt id=\"p1\">[</bpt>Data Types<ept id=\"p1\">](../../mfc/reference/data-types-mfc.md)</ept> in the Macros and Globals section.","pos":[9,145],"source":" For more information on the `BSTR` data type, see [Data Types](../../mfc/reference/data-types-mfc.md) in the Macros and Globals section."}]},{"pos":[78056,78063],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that the caller of this function must call <ph id=\"ph1\">`SysFreeString`</ph> on the string returned in order to free the resource.","pos":[78067,78184],"source":"Note that the caller of this function must call `SysFreeString` on the string returned in order to free the resource."},{"content":"Within the implementation of the control, use <ph id=\"ph1\">`InternalGetText`</ph> to access the control's stock Text or Caption property.","pos":[78185,78304],"source":" Within the implementation of the control, use `InternalGetText` to access the control's stock Text or Caption property."},{"pos":[78314,78403],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__getwindowlessdroptarget\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::GetWindowlessDropTarget","linkify":"<a name=\"colecontrol__getwindowlessdroptarget\"></a>  COleControl::GetWindowlessDropTarget","source":"<a name=\"colecontrol__getwindowlessdroptarget\"></a>  COleControl::GetWindowlessDropTarget"},{"pos":[78407,78528],"content":"Override <ph id=\"ph1\">`GetWindowlessDropTarget`</ph> when you want a windowless control to be the target of an OLE drag and drop operation.","source":"Override `GetWindowlessDropTarget` when you want a windowless control to be the target of an OLE drag and drop operation."},{"pos":[78601,78613],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Pointer to the object's <ph id=\"ph1\">`IDropTarget`</ph> interface.","pos":[78617,78665],"source":"Pointer to the object's `IDropTarget` interface."},{"content":"Since it does not have a window, a windowless object cannot register an <ph id=\"ph1\">`IDropTarget`</ph> interface.","pos":[78666,78762],"source":" Since it does not have a window, a windowless object cannot register an `IDropTarget` interface."},{"content":"However, to participate in drag and drop, a windowless object can still implement the interface and return it in <ph id=\"ph1\">`GetWindowlessDropTarget`</ph>.","pos":[78763,78902],"source":" However, to participate in drag and drop, a windowless object can still implement the interface and return it in `GetWindowlessDropTarget`."},{"pos":[78912,78919],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Normally, this would require that the control's window be registered as a drop target.","pos":[78923,79009]},{"content":"But since the control has no window of its own, the container will use its own window as a drop target.","pos":[79010,79113]},{"content":"The control simply needs to provide an implementation of the <ph id=\"ph1\">`IDropTarget`</ph> interface to which the container can delegate calls at the appropriate time.","pos":[79114,79265],"source":" The control simply needs to provide an implementation of the `IDropTarget` interface to which the container can delegate calls at the appropriate time."},{"content":"For example:","pos":[79266,79278]},{"pos":[79285,79373],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#2<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]"},{"pos":[79383,79454],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__initializeiids\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::InitializeIIDs","linkify":"<a name=\"colecontrol__initializeiids\"></a>  COleControl::InitializeIIDs","source":"<a name=\"colecontrol__initializeiids\"></a>  COleControl::InitializeIIDs"},{"content":"Informs the base class of the IIDs the control will use.","pos":[79458,79514]},{"pos":[79612,79622],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>piidPrimary<ept id=\"p1\">*</ept>","pos":[79626,79639],"source":"*piidPrimary*"},{"content":"Pointer to the interface ID of the control's primary dispatch interface.","pos":[79643,79715]},{"content":"<bpt id=\"p1\">*</bpt>piidEvents<ept id=\"p1\">*</ept>","pos":[79722,79734],"source":"*piidEvents*"},{"content":"Pointer to the interface ID of the control's event interface.","pos":[79738,79799]},{"pos":[79809,79816],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function in the control's constructor to inform the base class of the interface IDs your control will be using.","pos":[79820,79941]},{"pos":[79951,80024],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__internalgetfont\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::InternalGetFont","linkify":"<a name=\"colecontrol__internalgetfont\"></a>  COleControl::InternalGetFont","source":"<a name=\"colecontrol__internalgetfont\"></a>  COleControl::InternalGetFont"},{"content":"Accesses the stock Font property of your control","pos":[80028,80076]},{"pos":[80133,80145],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[80149,80265],"content":"A reference to a <bpt id=\"p1\">[</bpt>CFontHolder<ept id=\"p1\">](../../mfc/reference/cfontholder-class.md)</ept> object that contains the stock Font object.","source":"A reference to a [CFontHolder](../../mfc/reference/cfontholder-class.md) object that contains the stock Font object."},{"pos":[80275,80348],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__internalgettext\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::InternalGetText","linkify":"<a name=\"colecontrol__internalgettext\"></a>  COleControl::InternalGetText","source":"<a name=\"colecontrol__internalgettext\"></a>  COleControl::InternalGetText"},{"content":"Accesses the stock Text or Caption property of your control.","pos":[80352,80412]},{"pos":[80471,80483],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A reference to the control text string.","pos":[80487,80526]},{"pos":[80536,80621],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__internalsetreadystate\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::InternalSetReadyState","linkify":"<a name=\"colecontrol__internalsetreadystate\"></a>  COleControl::InternalSetReadyState","source":"<a name=\"colecontrol__internalsetreadystate\"></a>  COleControl::InternalSetReadyState"},{"content":"Sets the readiness state of the control.","pos":[80625,80665]},{"pos":[80739,80749],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>lNewReadyState<ept id=\"p1\">*</ept>","pos":[80753,80769],"source":"*lNewReadyState*"},{"content":"The readiness state to set for the control, one of the following values:","pos":[80773,80845]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_UNINITIALIZED<ept id=\"p1\">**</ept>","pos":[80852,80880],"source":"**READYSTATE_UNINITIALIZED**"},{"content":"Default initialization state","pos":[80884,80912]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_LOADING<ept id=\"p1\">**</ept>","pos":[80919,80941],"source":"**READYSTATE_LOADING**"},{"content":"Control is currently loading its properties","pos":[80945,80988]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_LOADED<ept id=\"p1\">**</ept>","pos":[80995,81016],"source":"**READYSTATE_LOADED**"},{"content":"Control has been initialized","pos":[81020,81048]},{"content":"<bpt id=\"p1\">**</bpt>READYSTATE_INTERACTIVE<ept id=\"p1\">**</ept>","pos":[81055,81081],"source":"**READYSTATE_INTERACTIVE**"},{"content":"Control has enough data to be interactive but not all asynchronous data is yet loaded","pos":[81085,81170]},{"content":"Control has all its data","pos":[81202,81226]},{"pos":[81236,81243],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Most simple controls never need to differentiate between <bpt id=\"p1\">**</bpt>LOADED<ept id=\"p1\">**</ept> and <ph id=\"ph1\">`INTERACTIVE`</ph>.","pos":[81247,81333],"source":"Most simple controls never need to differentiate between **LOADED** and `INTERACTIVE`."},{"content":"However, controls that support data path properties may not be ready to be interactive until at least some data is received asynchronously.","pos":[81334,81473]},{"content":"A control should attempt to become interactive as soon as possible.","pos":[81474,81541]},{"pos":[81551,81628],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__invalidatecontrol\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::InvalidateControl","linkify":"<a name=\"colecontrol__invalidatecontrol\"></a>  COleControl::InvalidateControl","source":"<a name=\"colecontrol__invalidatecontrol\"></a>  COleControl::InvalidateControl"},{"content":"Forces the control to redraw itself.","pos":[81632,81668]},{"pos":[81771,81781],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to the region of the control to be invalidated.","pos":[81797,81854]},{"content":"Specifies whether the background within the update region is to be erased when the update region is processed.","pos":[81873,81983]},{"pos":[81993,82000],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If <ph id=\"ph1\">`lpRect`</ph> has a <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> value, the entire control will be redrawn.","pos":[82004,82073],"source":"If `lpRect` has a **NULL** value, the entire control will be redrawn."},{"content":"If <ph id=\"ph1\">`lpRect`</ph> is not <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, this indicates the portion of the control's rectangle that is to be invalidated.","pos":[82074,82183],"source":" If `lpRect` is not **NULL**, this indicates the portion of the control's rectangle that is to be invalidated."},{"content":"In cases where the control has no window, or is currently not active, the rectangle is ignored, and a call is made to the client site's <bpt id=\"p1\">[</bpt>IAdviseSink::OnViewChange<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694337)</ept> member function.","pos":[82184,82424],"source":" In cases where the control has no window, or is currently not active, the rectangle is ignored, and a call is made to the client site's [IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337) member function."},{"content":"Use this function instead of <ph id=\"ph1\">`CWnd::InvalidateRect`</ph> or <ph id=\"ph2\">`InvalidateRect`</ph>.","pos":[82425,82497],"source":" Use this function instead of `CWnd::InvalidateRect` or `InvalidateRect`."},{"pos":[82507,82576],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__invalidatergn\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::InvalidateRgn","linkify":"<a name=\"colecontrol__invalidatergn\"></a>  COleControl::InvalidateRgn","source":"<a name=\"colecontrol__invalidatergn\"></a>  COleControl::InvalidateRgn"},{"content":"Invalidates the container window's client area within the given region.","pos":[82580,82651]},{"pos":[82733,82743],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CRgn<ept id=\"p1\">](../../mfc/reference/crgn-class.md)</ept> object that identifies the display region of the OLE object to invalidate, in client coordinates of the containing window.","pos":[82757,82936],"source":" A pointer to a [CRgn](../../mfc/reference/crgn-class.md) object that identifies the display region of the OLE object to invalidate, in client coordinates of the containing window."},{"content":"If this parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the extent is the entire object.","pos":[82937,83000],"source":" If this parameter is **NULL**, the extent is the entire object."},{"content":"Specifies whether the background within the invalidated region is to be erased.","pos":[83019,83098]},{"content":"If <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the background is erased.","pos":[83099,83137],"source":" If **TRUE**, the background is erased."},{"content":"If <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, the background remains unchanged.","pos":[83138,83185],"source":" If **FALSE**, the background remains unchanged."},{"pos":[83195,83202],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This can be used to redraw windowless controls within the container.","pos":[83206,83274]},{"content":"The invalidated region, along with all other areas in the update region, is marked for painting when the next <bpt id=\"p1\">[</bpt>WM_PAINT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd145213)</ept> message is sent.","pos":[83275,83472],"source":" The invalidated region, along with all other areas in the update region, is marked for painting when the next [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) message is sent."},{"pos":[83479,83613],"content":"If <ph id=\"ph1\">`bErase`</ph> is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> for any part of the update region, the background in the entire region, not just in the given part, is erased.","source":"If `bErase` is **TRUE** for any part of the update region, the background in the entire region, not just in the given part, is erased."},{"pos":[83623,83696],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__isconvertingvbx\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::IsConvertingVBX","linkify":"<a name=\"colecontrol__isconvertingvbx\"></a>  COleControl::IsConvertingVBX","source":"<a name=\"colecontrol__isconvertingvbx\"></a>  COleControl::IsConvertingVBX"},{"content":"Allows specialized loading of an OLE control.","pos":[83700,83745]},{"pos":[83794,83806],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control is being converted; otherwise 0.","pos":[83810,83865]},{"pos":[83875,83882],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"When converting a form that uses VBX controls to one that uses OLE controls, special loading code for the OLE controls may be required.","pos":[83886,84021]},{"content":"For example, if you are loading an instance of your OLE control, you might have a call to <bpt id=\"p1\">[</bpt>PX_Font<ept id=\"p1\">](persistence-of-ole-controls.md#px_font)</ept> in your <ph id=\"ph1\">`DoPropExchange`</ph>:","pos":[84022,84187],"source":" For example, if you are loading an instance of your OLE control, you might have a call to [PX_Font](persistence-of-ole-controls.md#px_font) in your `DoPropExchange`:"},{"pos":[84194,84282],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#3<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]"},{"content":"However, VBX controls did not have a Font object; each font property was saved individually.","pos":[84289,84381]},{"content":"In this case, you would use <ph id=\"ph1\">`IsConvertingVBX`</ph> to distinguish between these two cases:","pos":[84382,84467],"source":" In this case, you would use `IsConvertingVBX` to distinguish between these two cases:"},{"pos":[84474,84562],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#4<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]"},{"content":"Another case would be if your VBX control saved proprietary binary data (in its <bpt id=\"p1\">**</bpt>VBM_SAVEPROPERTY<ept id=\"p1\">**</ept> message handler), and your OLE control saves its binary data in a different format.","pos":[84569,84753],"source":"Another case would be if your VBX control saved proprietary binary data (in its **VBM_SAVEPROPERTY** message handler), and your OLE control saves its binary data in a different format."},{"content":"If you want your OLE control to be backward-compatible with the VBX control, you could read both the old and new formats using the <ph id=\"ph1\">`IsConvertingVBX`</ph> function by distinguishing whether the VBX control or the OLE control was being loaded.","pos":[84754,84990],"source":" If you want your OLE control to be backward-compatible with the VBX control, you could read both the old and new formats using the `IsConvertingVBX` function by distinguishing whether the VBX control or the OLE control was being loaded."},{"content":"In your control's <ph id=\"ph1\">`DoPropExchange`</ph> function, you can check for this condition and if true, execute load code specific to this conversion (such as the previous examples).","pos":[84997,85166],"source":"In your control's `DoPropExchange` function, you can check for this condition and if true, execute load code specific to this conversion (such as the previous examples)."},{"content":"If the control is not being converted, you can execute normal load code.","pos":[85167,85239]},{"content":"This ability is only applicable to controls being converted from VBX counterparts.","pos":[85240,85322]},{"pos":[85332,85405],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__isinvokeallowed\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::IsInvokeAllowed","linkify":"<a name=\"colecontrol__isinvokeallowed\"></a>  COleControl::IsInvokeAllowed","source":"<a name=\"colecontrol__isinvokeallowed\"></a>  COleControl::IsInvokeAllowed"},{"content":"Enables automation method invocation.","pos":[85409,85446]},{"pos":[85508,85520],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control has been initialized; otherwise 0.","pos":[85524,85581]},{"pos":[85591,85598],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The framework's implementation of <bpt id=\"p1\">**</bpt>IDispatch::Invoke<ept id=\"p1\">**</ept> calls <bpt id=\"p2\">**</bpt>IsInvokeAllowed<ept id=\"p2\">**</ept> to determine if a given function (identified by <ph id=\"ph1\">`dispid`</ph>) may be invoked.","pos":[85602,85757],"source":"The framework's implementation of **IDispatch::Invoke** calls **IsInvokeAllowed** to determine if a given function (identified by `dispid`) may be invoked."},{"content":"The default behavior for an OLE control is to allow automation methods to be invoked only if the control has been initialized; however, <bpt id=\"p1\">**</bpt>IsInvokeAllowed<ept id=\"p1\">**</ept> is a virtual function and may be overridden if necessary (for example, when the control is being used as an automation server).","pos":[85758,86041],"source":" The default behavior for an OLE control is to allow automation methods to be invoked only if the control has been initialized; however, **IsInvokeAllowed** is a virtual function and may be overridden if necessary (for example, when the control is being used as an automation server)."},{"content":"For more information, see Knowledge Base article Q166472, \"HOWTO: Use an OLE Control as an Automation Server.\"","pos":[86042,86152]},{"content":"Knowledge Base articles are available in the MSDN Library Visual Studio documentation or at <bpt id=\"p1\">[</bpt>http://support.microsoft.com<ept id=\"p1\">](http://support.microsoft.com/)</ept>.","pos":[86153,86307],"source":" Knowledge Base articles are available in the MSDN Library Visual Studio documentation or at [http://support.microsoft.com](http://support.microsoft.com/)."},{"pos":[86317,86380],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ismodified\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::IsModified","linkify":"<a name=\"colecontrol__ismodified\"></a>  COleControl::IsModified","source":"<a name=\"colecontrol__ismodified\"></a>  COleControl::IsModified"},{"content":"Determines if the control's state has been modified.","pos":[86384,86436]},{"pos":[86480,86492],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control's state has been modified since it was last saved; otherwise 0.","pos":[86496,86582]},{"pos":[86592,86599],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The state of a control is modified when a property changes value.","pos":[86603,86668]},{"pos":[86678,86751],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__isoptimizeddraw\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::IsOptimizedDraw","linkify":"<a name=\"colecontrol__isoptimizeddraw\"></a>  COleControl::IsOptimizedDraw","source":"<a name=\"colecontrol__isoptimizeddraw\"></a>  COleControl::IsOptimizedDraw"},{"content":"Determines whether the container supports optimized drawing for the current drawing operation.","pos":[86755,86849]},{"pos":[86898,86910],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[86914,87022],"content":"<bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if the container supports optimized drawing for the current drawing operation; otherwise <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","source":"**TRUE** if the container supports optimized drawing for the current drawing operation; otherwise **FALSE**."},{"pos":[87032,87039],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If optimized drawing is supported, then the control need not select old objects (pens, brushes, fonts, etc.) into the device context when drawing is finished.","pos":[87043,87201]},{"pos":[87211,87292],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__issubclassedcontrol\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::IsSubclassedControl","linkify":"<a name=\"colecontrol__issubclassedcontrol\"></a>  COleControl::IsSubclassedControl","source":"<a name=\"colecontrol__issubclassedcontrol\"></a>  COleControl::IsSubclassedControl"},{"content":"Called by the framework to determine if the control subclasses a Windows control.","pos":[87296,87377]},{"pos":[87438,87450],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control is subclassed; otherwise 0.","pos":[87454,87504]},{"pos":[87514,87521],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[87525,87626],"content":"You must override this function and return <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if your OLE control subclasses a Windows control.","source":"You must override this function and return **TRUE** if your OLE control subclasses a Windows control."},{"pos":[87636,87687],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__load\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::Load","linkify":"<a name=\"colecontrol__load\"></a>  COleControl::Load","source":"<a name=\"colecontrol__load\"></a>  COleControl::Load"},{"content":"Resets any previous data loaded asynchronously and initiates a new loading of the control's asynchronous property.","pos":[87691,87805]},{"pos":[87891,87901],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>strNewPath<ept id=\"p1\">*</ept>","pos":[87905,87917],"source":"*strNewPath*"},{"content":"A pointer to a string containing the path that references the absolute location of the asynchronous control property.","pos":[87921,88038]},{"content":"<bpt id=\"p1\">*</bpt>prop<ept id=\"p1\">*</ept>","pos":[88045,88051],"source":"*prop*"},{"content":"A <bpt id=\"p1\">[</bpt>CDataPathProperty<ept id=\"p1\">](../../mfc/reference/cdatapathproperty-class.md)</ept> object implementing an asynchronous control property.","pos":[88055,88178],"source":" A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) object implementing an asynchronous control property."},{"pos":[88188,88265],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__lockinplaceactive\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::LockInPlaceActive","linkify":"<a name=\"colecontrol__lockinplaceactive\"></a>  COleControl::LockInPlaceActive","source":"<a name=\"colecontrol__lockinplaceactive\"></a>  COleControl::LockInPlaceActive"},{"content":"Prevents the container from deactivating your control.","pos":[88269,88323]},{"pos":[88384,88394],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\"> **</bpt>TRUE<ept id=\"p1\">**</ept> if the in-place active state of the control is to be locked; <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> if it is to be unlocked.","pos":[88408,88513],"source":" **TRUE** if the in-place active state of the control is to be locked; **FALSE** if it is to be unlocked."},{"pos":[88523,88535],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the lock was successful; otherwise 0.","pos":[88539,88587]},{"pos":[88597,88604],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that every locking of the control must be paired with an unlocking of the control when finished.","pos":[88608,88709]},{"content":"You should only lock your control for short periods, such as while firing an event.","pos":[88710,88793]},{"pos":[88803,88892],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onambientpropertychange\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnAmbientPropertyChange","linkify":"<a name=\"colecontrol__onambientpropertychange\"></a>  COleControl::OnAmbientPropertyChange","source":"<a name=\"colecontrol__onambientpropertychange\"></a>  COleControl::OnAmbientPropertyChange"},{"content":"Called by the framework when an ambient property of the container has changed value.","pos":[88896,88980]},{"pos":[89058,89068],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>dispID<ept id=\"p1\">*</ept>","pos":[89072,89080],"source":"*dispID*"},{"content":"The dispatch ID of the ambient property that changed, or <bpt id=\"p1\">**</bpt>DISPID_UNKNOWN<ept id=\"p1\">**</ept> if multiple properties have changed.","pos":[89084,89196],"source":" The dispatch ID of the ambient property that changed, or **DISPID_UNKNOWN** if multiple properties have changed."},{"pos":[89206,89287],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onappearancechanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnAppearanceChanged","linkify":"<a name=\"colecontrol__onappearancechanged\"></a>  COleControl::OnAppearanceChanged","source":"<a name=\"colecontrol__onappearancechanged\"></a>  COleControl::OnAppearanceChanged"},{"content":"Called by the framework when the stock Appearance property value has changed.","pos":[89291,89368]},{"pos":[89430,89437],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function if you want notification after this property changes.","pos":[89441,89517]},{"content":"The default implementation calls <ph id=\"ph1\">`InvalidateControl`</ph>.","pos":[89518,89571],"source":" The default implementation calls `InvalidateControl`."},{"pos":[89581,89660],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onbackcolorchanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnBackColorChanged","linkify":"<a name=\"colecontrol__onbackcolorchanged\"></a>  COleControl::OnBackColorChanged","source":"<a name=\"colecontrol__onbackcolorchanged\"></a>  COleControl::OnBackColorChanged"},{"content":"Called by the framework when the stock BackColor property value has changed.","pos":[89664,89740]},{"pos":[89800,89807],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function if you want notification after this property changes.","pos":[89811,89887]},{"content":"The default implementation calls <ph id=\"ph1\">`InvalidateControl`</ph>.","pos":[89888,89941],"source":" The default implementation calls `InvalidateControl`."},{"pos":[89951,90034],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onborderstylechanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnBorderStyleChanged","linkify":"<a name=\"colecontrol__onborderstylechanged\"></a>  COleControl::OnBorderStyleChanged","source":"<a name=\"colecontrol__onborderstylechanged\"></a>  COleControl::OnBorderStyleChanged"},{"content":"Called by the framework when the stock BorderStyle property value has changed.","pos":[90038,90116]},{"pos":[90178,90185],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[90189,90242],"content":"The default implementation calls <ph id=\"ph1\">`InvalidateControl`</ph>.","source":"The default implementation calls `InvalidateControl`."},{"content":"Override this function if you want notification after this property changes.","pos":[90249,90325]},{"pos":[90335,90392],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onclick\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnClick","linkify":"<a name=\"colecontrol__onclick\"></a>  COleControl::OnClick","source":"<a name=\"colecontrol__onclick\"></a>  COleControl::OnClick"},{"content":"Called by the framework when a mouse button has been clicked or the DoClick stock method has been invoked.","pos":[90396,90502]},{"pos":[90565,90575],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>iButton<ept id=\"p1\">*</ept>","pos":[90579,90588],"source":"*iButton*"},{"content":"Index of a mouse button.","pos":[90592,90616]},{"content":"Can have one of the following values:","pos":[90617,90654]},{"pos":[90662,90712],"content":"<bpt id=\"p1\">**</bpt>LEFT_BUTTON<ept id=\"p1\">**</ept> The left mouse button was clicked.","source":"**LEFT_BUTTON** The left mouse button was clicked."},{"pos":[90720,90774],"content":"<bpt id=\"p1\">**</bpt>MIDDLE_BUTTON<ept id=\"p1\">**</ept> The middle mouse button was clicked.","source":"**MIDDLE_BUTTON** The middle mouse button was clicked."},{"pos":[90782,90834],"content":"<bpt id=\"p1\">**</bpt>RIGHT_BUTTON<ept id=\"p1\">**</ept> The right mouse button was clicked.","source":"**RIGHT_BUTTON** The right mouse button was clicked."},{"pos":[90844,90851],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[90855,90913],"content":"The default implementation calls <ph id=\"ph1\">`COleControl::FireClick`</ph>.","source":"The default implementation calls `COleControl::FireClick`."},{"content":"Override this member function to modify or extend the default handling.","pos":[90920,90991]},{"pos":[91001,91058],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onclose\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnClose","linkify":"<a name=\"colecontrol__onclose\"></a>  COleControl::OnClose","source":"<a name=\"colecontrol__onclose\"></a>  COleControl::OnClose"},{"pos":[91062,91162],"content":"Called by the framework when the container has called the control's <bpt id=\"p1\">**</bpt>IOleControl::Close<ept id=\"p1\">**</ept> function.","source":"Called by the framework when the container has called the control's **IOleControl::Close** function."},{"pos":[91229,91239],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Flag that indicates whether the object should be saved before loading.","pos":[91261,91331]},{"content":"Valid values are:","pos":[91332,91349]},{"pos":[91443,91450],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[91454,91602],"content":"By default, <ph id=\"ph1\">`OnClose`</ph> saves the control object if it has been modified and <ph id=\"ph2\">`dwSaveOption`</ph> is either <ph id=\"ph3\">`OLECLOSE_SAVEIFDIRTY`</ph> or <ph id=\"ph4\">`OLECLOSE_PROMPTSAVE`</ph>.","source":"By default, `OnClose` saves the control object if it has been modified and `dwSaveOption` is either `OLECLOSE_SAVEIFDIRTY` or `OLECLOSE_PROMPTSAVE`."},{"pos":[91612,91671],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ondoverb\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnDoVerb","linkify":"<a name=\"colecontrol__ondoverb\"></a>  COleControl::OnDoVerb","source":"<a name=\"colecontrol__ondoverb\"></a>  COleControl::OnDoVerb"},{"pos":[91675,91767],"content":"Called by the framework when the container calls the <bpt id=\"p1\">**</bpt>IOleObject::DoVerb<ept id=\"p1\">**</ept> member function.","source":"Called by the framework when the container calls the **IOleObject::DoVerb** member function."},{"pos":[91896,91906],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The index of the control verb to be invoked.","pos":[91921,91965]},{"content":"A pointer to the Windows message that caused the verb to be invoked.","pos":[91983,92051]},{"content":"The handle to the parent window of the control.","pos":[92074,92121]},{"content":"If the execution of the verb creates a window (or windows), <ph id=\"ph1\">`hWndParent`</ph> should be used as the parent.","pos":[92122,92224],"source":" If the execution of the verb creates a window (or windows), `hWndParent` should be used as the parent."},{"content":"A pointer to a RECT structure into which the coordinates of the control, relative to the container, will be copied.","pos":[92243,92358]},{"pos":[92368,92380],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if call was successful; otherwise 0.","pos":[92384,92428]},{"pos":[92438,92445],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[92449,92581],"content":"The default implementation uses the <ph id=\"ph1\">`ON_OLEVERB`</ph> and <ph id=\"ph2\">`ON_STDOLEVERB`</ph> message map entries to determine the proper function to invoke.","source":"The default implementation uses the `ON_OLEVERB` and `ON_STDOLEVERB` message map entries to determine the proper function to invoke."},{"content":"Override this function to change the default handling of verb.","pos":[92588,92650]},{"pos":[92660,92715],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ondraw\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnDraw","linkify":"<a name=\"colecontrol__ondraw\"></a>  COleControl::OnDraw","source":"<a name=\"colecontrol__ondraw\"></a>  COleControl::OnDraw"},{"content":"Called by the framework to draw the OLE control in the specified bounding rectangle using the specified device context.","pos":[92719,92838]},{"pos":[92958,92968],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The device context in which the drawing occurs.","pos":[92981,93028]},{"content":"The rectangular area of the control, including the border.","pos":[93049,93107]},{"content":"The rectangular area of the control that is invalid.","pos":[93129,93181]},{"pos":[93191,93198],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`OnDraw`</ph> is typically called for screen display, passing a screen device context as <ph id=\"ph2\">`pDC`</ph>.","pos":[93202,93292],"source":"`OnDraw` is typically called for screen display, passing a screen device context as `pDC`."},{"content":"The <ph id=\"ph1\">`rcBounds`</ph> parameter identifies the rectangle in the target device context (relative to its current mapping mode).","pos":[93293,93411],"source":" The `rcBounds` parameter identifies the rectangle in the target device context (relative to its current mapping mode)."},{"content":"The <ph id=\"ph1\">`rcInvalid`</ph> parameter is the actual rectangle that is invalid.","pos":[93412,93478],"source":" The `rcInvalid` parameter is the actual rectangle that is invalid."},{"content":"In some cases this will be a smaller area than <ph id=\"ph1\">`rcBounds`</ph>.","pos":[93479,93537],"source":" In some cases this will be a smaller area than `rcBounds`."},{"pos":[93547,93618],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ondrawmetafile\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnDrawMetafile","linkify":"<a name=\"colecontrol__ondrawmetafile\"></a>  COleControl::OnDrawMetafile","source":"<a name=\"colecontrol__ondrawmetafile\"></a>  COleControl::OnDrawMetafile"},{"content":"Called by the framework to draw the OLE control in the specified bounding rectangle using the specified metafile device context.","pos":[93622,93750]},{"pos":[93848,93858],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The device context in which the drawing occurs.","pos":[93871,93918]},{"content":"The rectangular area of the control, including the border.","pos":[93939,93997]},{"pos":[94007,94014],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[94018,94095],"content":"The default implementation calls the <bpt id=\"p1\">[</bpt>OnDraw<ept id=\"p1\">](#colecontrol__ondraw)</ept> function.","source":"The default implementation calls the [OnDraw](#colecontrol__ondraw) function."},{"pos":[94105,94160],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onedit\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnEdit","linkify":"<a name=\"colecontrol__onedit\"></a>  COleControl::OnEdit","source":"<a name=\"colecontrol__onedit\"></a>  COleControl::OnEdit"},{"content":"Causes the control to be UI activated.","pos":[94164,94202]},{"pos":[94311,94321],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to the Windows message that invoked the verb.","pos":[94336,94391]},{"content":"A handle to the parent window of the control.","pos":[94414,94459]},{"content":"A pointer to the rectangle used by the control in the container.","pos":[94478,94542]},{"pos":[94552,94564],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the call is successful; otherwise 0.","pos":[94568,94615]},{"pos":[94625,94632],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[94636,94714],"content":"This has the same effect as invoking the control's <ph id=\"ph1\">`OLEIVERB_UIACTIVATE`</ph> verb.","source":"This has the same effect as invoking the control's `OLEIVERB_UIACTIVATE` verb."},{"content":"This function is typically used as the handler function for an <ph id=\"ph1\">`ON_OLEVERB`</ph> message map entry.","pos":[94721,94815],"source":"This function is typically used as the handler function for an `ON_OLEVERB` message map entry."},{"content":"This makes an \"Edit\" verb available on the control's \"Object\" menu.","pos":[94816,94883]},{"content":"For example:","pos":[94884,94896]},{"pos":[94903,94991],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#5<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]"},{"pos":[95001,95076],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onenabledchanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnEnabledChanged","linkify":"<a name=\"colecontrol__onenabledchanged\"></a>  COleControl::OnEnabledChanged","source":"<a name=\"colecontrol__onenabledchanged\"></a>  COleControl::OnEnabledChanged"},{"content":"Called by the framework when the stock Enabled property value has changed.","pos":[95080,95154]},{"pos":[95212,95219],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function if you want notification after this property changes.","pos":[95223,95299]},{"content":"The default implementation calls <bpt id=\"p1\">[</bpt>InvalidateControl<ept id=\"p1\">](#colecontrol__invalidatecontrol)</ept>.","pos":[95300,95386],"source":" The default implementation calls [InvalidateControl](#colecontrol__invalidatecontrol)."},{"pos":[95396,95461],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onenumverbs\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnEnumVerbs","linkify":"<a name=\"colecontrol__onenumverbs\"></a>  COleControl::OnEnumVerbs","source":"<a name=\"colecontrol__onenumverbs\"></a>  COleControl::OnEnumVerbs"},{"pos":[95465,95560],"content":"Called by the framework when the container calls the <bpt id=\"p1\">**</bpt>IOleObject::EnumVerbs<ept id=\"p1\">**</ept> member function.","source":"Called by the framework when the container calls the **IOleObject::EnumVerbs** member function."},{"pos":[95641,95651],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to the <bpt id=\"p1\">**</bpt>IEnumOLEVERB<ept id=\"p1\">**</ept> object that enumerates the control's verbs.","pos":[95674,95751],"source":" A pointer to the **IEnumOLEVERB** object that enumerates the control's verbs."},{"pos":[95761,95773],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if verbs are available; otherwise 0.","pos":[95777,95821]},{"pos":[95831,95838],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[95842,95924],"content":"The default implementation enumerates the <ph id=\"ph1\">`ON_OLEVERB`</ph> entries in the message map.","source":"The default implementation enumerates the `ON_OLEVERB` entries in the message map."},{"content":"Override this function to change the default way of enumerating verbs.","pos":[95931,96001]},{"pos":[96011,96080],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__oneventadvise\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnEventAdvise","linkify":"<a name=\"colecontrol__oneventadvise\"></a>  COleControl::OnEventAdvise","source":"<a name=\"colecontrol__oneventadvise\"></a>  COleControl::OnEventAdvise"},{"content":"Called by the framework when an event handler is connected to or disconnected from an OLE control.","pos":[96084,96182]},{"pos":[96249,96259],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\"> **</bpt>TRUE<ept id=\"p1\">**</ept> indicates that an event handler has been connected to the control.","pos":[96275,96351],"source":" **TRUE** indicates that an event handler has been connected to the control."},{"content":"<bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> indicates that an event handler has been disconnected from the control.","pos":[96352,96433],"source":"**FALSE** indicates that an event handler has been disconnected from the control."},{"pos":[96443,96512],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onfontchanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnFontChanged","linkify":"<a name=\"colecontrol__onfontchanged\"></a>  COleControl::OnFontChanged","source":"<a name=\"colecontrol__onfontchanged\"></a>  COleControl::OnFontChanged"},{"content":"Called by the framework when the stock Font property value has changed.","pos":[96516,96587]},{"pos":[96642,96649],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The default implementation calls <ph id=\"ph1\">`COleControl::InvalidateControl`</ph>.","pos":[96653,96719],"source":"The default implementation calls `COleControl::InvalidateControl`."},{"content":"If the control is subclassing a Windows control, the default implementation also sends a <bpt id=\"p1\">**</bpt>WM_SETFONT<ept id=\"p1\">**</ept> message to the control's window.","pos":[96720,96856],"source":" If the control is subclassing a Windows control, the default implementation also sends a **WM_SETFONT** message to the control's window."},{"content":"Override this function if you want notification after this property changes.","pos":[96863,96939]},{"pos":[96949,96956],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[96960,97048],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#6<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]"},{"pos":[97058,97137],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onforecolorchanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnForeColorChanged","linkify":"<a name=\"colecontrol__onforecolorchanged\"></a>  COleControl::OnForeColorChanged","source":"<a name=\"colecontrol__onforecolorchanged\"></a>  COleControl::OnForeColorChanged"},{"content":"Called by the framework when the stock ForeColor property value has changed.","pos":[97141,97217]},{"pos":[97277,97284],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[97288,97341],"content":"The default implementation calls <ph id=\"ph1\">`InvalidateControl`</ph>.","source":"The default implementation calls `InvalidateControl`."},{"content":"Override this function if you want notification after this property changes.","pos":[97348,97424]},{"pos":[97434,97505],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onfreezeevents\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnFreezeEvents","linkify":"<a name=\"colecontrol__onfreezeevents\"></a>  COleControl::OnFreezeEvents","source":"<a name=\"colecontrol__onfreezeevents\"></a>  COleControl::OnFreezeEvents"},{"pos":[97509,97589],"content":"Called by the framework after the container calls <bpt id=\"p1\">**</bpt>IOleControl::FreezeEvents<ept id=\"p1\">**</ept>.","source":"Called by the framework after the container calls **IOleControl::FreezeEvents**."},{"pos":[97657,97667],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\"> **</bpt>TRUE<ept id=\"p1\">**</ept> if the control's event handling is frozen; otherwise <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","pos":[97683,97756],"source":" **TRUE** if the control's event handling is frozen; otherwise **FALSE**."},{"pos":[97766,97773],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The default implementation does nothing.","pos":[97777,97817]},{"content":"Override this function if you want additional behavior when event handling is frozen or unfrozen.","pos":[97824,97921]},{"pos":[97931,98000],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetcolorset\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetColorSet","linkify":"<a name=\"colecontrol__ongetcolorset\"></a>  COleControl::OnGetColorSet","source":"<a name=\"colecontrol__ongetcolorset\"></a>  COleControl::OnGetColorSet"},{"pos":[98004,98102],"content":"Called by the framework when the container calls the <bpt id=\"p1\">**</bpt>IViewObject::GetColorSet<ept id=\"p1\">**</ept> member function.","source":"Called by the framework when the container calls the **IViewObject::GetColorSet** member function."},{"pos":[98237,98247],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to the target device for which the picture should be rendered.","pos":[98260,98329]},{"content":"If this value is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the picture should be rendered for a default target device, usually a display device.","pos":[98330,98442],"source":" If this value is **NULL**, the picture should be rendered for a default target device, usually a display device."},{"content":"Specifies the information context on the target device indicated by <ph id=\"ph1\">`ptd`</ph>.","pos":[98467,98541],"source":" Specifies the information context on the target device indicated by `ptd`."},{"content":"This parameter can be a device context, but is not one necessarily.","pos":[98542,98609]},{"content":"If <ph id=\"ph1\">`ptd`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, <ph id=\"ph2\">`hicTargetDev`</ph> should also be <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","pos":[98610,98671],"source":" If `ptd` is **NULL**, `hicTargetDev` should also be **NULL**."},{"content":"<bpt id=\"p1\">*</bpt>ppColorSet<ept id=\"p1\">*</ept>","pos":[98678,98690],"source":"*ppColorSet*"},{"content":"A pointer to the location into which the set of colors that would be used should be copied.","pos":[98694,98785]},{"content":"If the function does not return the color set, <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> is returned.","pos":[98786,98854],"source":" If the function does not return the color set, **NULL** is returned."},{"pos":[98864,98876],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if a valid color set is returned; otherwise 0.","pos":[98880,98934]},{"pos":[98944,98951],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The container calls this function to obtain all the colors needed to draw the OLE control.","pos":[98955,99045]},{"content":"The container can use the color sets obtained in conjunction with the colors it needs to set the overall color palette.","pos":[99046,99165]},{"content":"The default implementation returns <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[99166,99211],"source":" The default implementation returns **FALSE**."},{"content":"Override this function to do any special processing of this request.","pos":[99218,99286]},{"pos":[99296,99371],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetcontrolinfo\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetControlInfo","linkify":"<a name=\"colecontrol__ongetcontrolinfo\"></a>  COleControl::OnGetControlInfo","source":"<a name=\"colecontrol__ongetcontrolinfo\"></a>  COleControl::OnGetControlInfo"},{"content":"Called by the framework when the control's container has requested information about the control.","pos":[99375,99472]},{"pos":[99556,99566],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to a <bpt id=\"p1\">[</bpt>CONTROLINFO<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680734)</ept> structure to be filled in.","pos":[99588,99701],"source":" Pointer to a [CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734) structure to be filled in."},{"pos":[99711,99718],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This information consists primarily of a description of the control's mnemonic keys.","pos":[99722,99806]},{"content":"The default implementation fills <ph id=\"ph1\">`pControlInfo`</ph> with default information.","pos":[99807,99880],"source":" The default implementation fills `pControlInfo` with default information."},{"content":"Override this function if your control needs to process mnemonic keys.","pos":[99887,99957]},{"pos":[99967,100046],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetdisplaystring\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetDisplayString","linkify":"<a name=\"colecontrol__ongetdisplaystring\"></a>  COleControl::OnGetDisplayString","source":"<a name=\"colecontrol__ongetdisplaystring\"></a>  COleControl::OnGetDisplayString"},{"pos":[100050,100166],"content":"Called by the framework to obtain a string that represents the current value of the property identified by <ph id=\"ph1\">`dispid`</ph>.","source":"Called by the framework to obtain a string that represents the current value of the property identified by `dispid`."},{"pos":[100269,100279],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The dispatch ID of a property of the control.","pos":[100295,100340]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> object through which a string will be returned.","pos":[100361,100485],"source":" A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object through which a string will be returned."},{"pos":[100495,100507],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[100511,100576],"content":"Nonzero if a string has been returned in <bpt id=\"p1\">*</bpt>strValue;<ept id=\"p1\">*</ept> otherwise 0.","source":"Nonzero if a string has been returned in *strValue;* otherwise 0."},{"pos":[100586,100593],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function if your control has a property whose value cannot be directly converted to a string and you want the property's value to be displayed in a container-supplied property browser.","pos":[100597,100795]},{"pos":[100805,100880],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetinplacemenu\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetInPlaceMenu","linkify":"<a name=\"colecontrol__ongetinplacemenu\"></a>  COleControl::OnGetInPlaceMenu","source":"<a name=\"colecontrol__ongetinplacemenu\"></a>  COleControl::OnGetInPlaceMenu"},{"content":"Called by the framework when the control is UI activated to obtain the menu to be merged into the container's existing menu.","pos":[100884,101008]},{"pos":[101067,101079],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The handle of the control's menu, or <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the control has none.","pos":[101083,101153],"source":"The handle of the control's menu, or **NULL** if the control has none."},{"content":"The default implementation returns <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[101154,101198],"source":" The default implementation returns **NULL**."},{"pos":[101208,101215],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[101219,101348],"content":"For more information on merging OLE resources, see the article <bpt id=\"p1\">[</bpt>Menus and Resources (OLE)<ept id=\"p1\">](../../mfc/menus-and-resources-ole.md)</ept>.","source":"For more information on merging OLE resources, see the article [Menus and Resources (OLE)](../../mfc/menus-and-resources-ole.md)."},{"pos":[101358,101437],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetnaturalextent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetNaturalExtent","linkify":"<a name=\"colecontrol__ongetnaturalextent\"></a>  COleControl::OnGetNaturalExtent","source":"<a name=\"colecontrol__ongetnaturalextent\"></a>  COleControl::OnGetNaturalExtent"},{"pos":[101441,101538],"content":"Called by the framework in response to a container's <bpt id=\"p1\">**</bpt>IViewObjectEx::GetNaturalExtent<ept id=\"p1\">**</ept> request.","source":"Called by the framework in response to a container's **IViewObjectEx::GetNaturalExtent** request."},{"pos":[101732,101742],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies how the object is to be represented.","pos":[101760,101806]},{"content":"Representations include content, an icon, a thumbnail, or a printed document.","pos":[101807,101884]},{"content":"Valid values are taken from the enumeration <bpt id=\"p1\">[</bpt>DVASPECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690318)</ept> or <bpt id=\"p2\">**</bpt>DVASPECT2<ept id=\"p2\">**</ept>.","pos":[101885,102017],"source":" Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**."},{"content":"<bpt id=\"p1\">*</bpt>lindex<ept id=\"p1\">*</ept>","pos":[102024,102032],"source":"*lindex*"},{"content":"The portion of the object that is of interest.","pos":[102036,102082]},{"content":"Currently only -1 is valid.","pos":[102083,102110]},{"content":"Points to the <bpt id=\"p1\">[</bpt>DVTARGETDEVICE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms686613)</ept> structure defining the target device for which the object's size should be returned.","pos":[102126,102301],"source":" Points to the [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) structure defining the target device for which the object's size should be returned."},{"content":"Specifies the information context for the target device indicated by the <ph id=\"ph1\">`ptd`</ph> parameter from which the object can extract device metrics and test the device's capabilities.","pos":[102326,102499],"source":" Specifies the information context for the target device indicated by the `ptd` parameter from which the object can extract device metrics and test the device's capabilities."},{"content":"If <ph id=\"ph1\">`ptd`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the object should ignore the value in the <ph id=\"ph2\">`hicTargetDev`</ph> parameter.","pos":[102500,102589],"source":" If `ptd` is **NULL**, the object should ignore the value in the `hicTargetDev` parameter."},{"content":"<bpt id=\"p1\">*</bpt>pExtentInfo<ept id=\"p1\">*</ept>","pos":[102596,102609],"source":"*pExtentInfo*"},{"content":"Points to the <bpt id=\"p1\">**</bpt>DVEXTENTINFO<ept id=\"p1\">**</ept> structure that specifies sizing data.","pos":[102613,102681],"source":" Points to the **DVEXTENTINFO** structure that specifies sizing data."},{"content":"The <bpt id=\"p1\">**</bpt>DVEXTENTINFO<ept id=\"p1\">**</ept> structure is:","pos":[102682,102716],"source":" The **DVEXTENTINFO** structure is:"},{"pos":[102871,102934],"content":"The structure member <ph id=\"ph1\">`dwExtentMode`</ph> can take one of two values:","source":"The structure member `dwExtentMode` can take one of two values:"},{"pos":[102942,103038],"content":"<bpt id=\"p1\">**</bpt>DVEXTENT_CONTENT<ept id=\"p1\">**</ept> Inquire how big the control should be to exactly fit content (snap-to-size)","source":"**DVEXTENT_CONTENT** Inquire how big the control should be to exactly fit content (snap-to-size)"},{"pos":[103046,103112],"content":"<bpt id=\"p1\">**</bpt>DVEXTENT_INTEGRAL<ept id=\"p1\">**</ept> When resizing, pass proposed size to control","source":"**DVEXTENT_INTEGRAL** When resizing, pass proposed size to control"},{"pos":[103119,103252],"content":"`psizel`  \nPoints to sizing data returned by control. The returned sizing data is set to -1 for any dimension that was not adjusted.","leadings":[""," "],"nodes":[{"content":"Points to sizing data returned by control. The returned sizing data is set to -1 for any dimension that was not adjusted.","pos":[11,132],"nodes":[{"content":"Points to sizing data returned by control.","pos":[0,42]},{"content":"The returned sizing data is set to -1 for any dimension that was not adjusted.","pos":[43,121]}]}]},{"pos":[103262,103274],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if it successfully returns or adjusts the size; otherwise 0.","pos":[103278,103346]},{"pos":[103356,103363],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function to return the object's display size closest to the proposed size and extent mode in the <bpt id=\"p1\">**</bpt>DVEXTENTINFO<ept id=\"p1\">**</ept> structure.","pos":[103367,103505],"source":"Override this function to return the object's display size closest to the proposed size and extent mode in the **DVEXTENTINFO** structure."},{"content":"The default implementation returns <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> and makes no adjustments to the size.","pos":[103506,103588],"source":" The default implementation returns **FALSE** and makes no adjustments to the size."},{"pos":[103598,103685],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetpredefinedstrings\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetPredefinedStrings","linkify":"<a name=\"colecontrol__ongetpredefinedstrings\"></a>  COleControl::OnGetPredefinedStrings","source":"<a name=\"colecontrol__ongetpredefinedstrings\"></a>  COleControl::OnGetPredefinedStrings"},{"content":"Called by the framework to obtain a set of predefined strings representing the possible values for a property.","pos":[103689,103799]},{"pos":[103948,103958],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The dispatch ID of a property of the control.","pos":[103974,104019]},{"content":"A string array to be filled in with return values.","pos":[104044,104094]},{"content":"A <ph id=\"ph1\">`DWORD`</ph> array to be filled in with return values.","pos":[104119,104170],"source":" A `DWORD` array to be filled in with return values."},{"pos":[104180,104192],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[104196,104269],"content":"Nonzero if elements have been added to <ph id=\"ph1\">`pStringArray`</ph> and <ph id=\"ph2\">`pCookieArray`</ph>.","source":"Nonzero if elements have been added to `pStringArray` and `pCookieArray`."},{"pos":[104279,104286],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function if your control has a property with a set of possible values that can be represented by strings.","pos":[104290,104409]},{"content":"For each element added to <ph id=\"ph1\">`pStringArray`</ph>, you should add a corresponding \"cookie\" element to <bpt id=\"p1\">*</bpt>pCookieArray.<ept id=\"p1\">*</ept>","pos":[104410,104518],"source":" For each element added to `pStringArray`, you should add a corresponding \"cookie\" element to *pCookieArray.*"},{"content":"These \"cookie\" values may later be passed by the framework to the <ph id=\"ph1\">`COleControl::OnGetPredefinedValue`</ph> function.","pos":[104519,104630],"source":" These \"cookie\" values may later be passed by the framework to the `COleControl::OnGetPredefinedValue` function."},{"pos":[104640,104723],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetpredefinedvalue\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetPredefinedValue","linkify":"<a name=\"colecontrol__ongetpredefinedvalue\"></a>  COleControl::OnGetPredefinedValue","source":"<a name=\"colecontrol__ongetpredefinedvalue\"></a>  COleControl::OnGetPredefinedValue"},{"pos":[104727,104894],"content":"Called by the framework to obtain the value corresponding to one of the predefined strings previously returned by an override of <ph id=\"ph1\">`COleControl::OnGetPredefinedStrings`</ph>.","source":"Called by the framework to obtain the value corresponding to one of the predefined strings previously returned by an override of `COleControl::OnGetPredefinedStrings`."},{"pos":[105021,105031],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The dispatch ID of a property of the control.","pos":[105047,105092]},{"content":"A cookie value previously returned by an override of <ph id=\"ph1\">`COleControl::OnGetPredefinedStrings`</ph>.","pos":[105113,105204],"source":" A cookie value previously returned by an override of `COleControl::OnGetPredefinedStrings`."},{"content":"Pointer to a <bpt id=\"p1\">**</bpt>VARIANT<ept id=\"p1\">**</ept> structure through which a property value will be returned.","pos":[105225,105308],"source":" Pointer to a **VARIANT** structure through which a property value will be returned."},{"pos":[105318,105330],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[105334,105398],"content":"Nonzero if a value has been returned in <ph id=\"ph1\">`lpvarOut`</ph>; otherwise 0.","source":"Nonzero if a value has been returned in `lpvarOut`; otherwise 0."},{"pos":[105408,105481],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetviewextent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetViewExtent","linkify":"<a name=\"colecontrol__ongetviewextent\"></a>  COleControl::OnGetViewExtent","source":"<a name=\"colecontrol__ongetviewextent\"></a>  COleControl::OnGetViewExtent"},{"pos":[105485,105632],"content":"Called by the framework in response to a container's <bpt id=\"p1\">[</bpt>IViewObject2::GetExtent<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms684032)</ept> request.","source":"Called by the framework in response to a container's [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) request."},{"pos":[105775,105785],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>dwDrawAspect<ept id=\"p1\">*</ept>","pos":[105789,105803],"source":"*dwDrawAspect*"},{"content":"<ph id=\"ph1\"> `DWORD`</ph> describing which form, or aspect, of an object is to be displayed.","pos":[105806,105881],"source":" `DWORD` describing which form, or aspect, of an object is to be displayed."},{"content":"Valid values are taken from the enumeration <bpt id=\"p1\">[</bpt>DVASPECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690318)</ept> or <bpt id=\"p2\">**</bpt>DVASPECT2<ept id=\"p2\">**</ept>.","pos":[105882,106014],"source":" Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**."},{"content":"<bpt id=\"p1\">*</bpt>lindex<ept id=\"p1\">*</ept>","pos":[106021,106029],"source":"*lindex*"},{"content":"The portion of the object that is of interest.","pos":[106033,106079]},{"content":"Currently only –1 is valid.","pos":[106080,106107]},{"content":"Points to the <bpt id=\"p1\">[</bpt>DVTARGETDEVICE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms686613)</ept> structure defining the target device for which the object's size should be returned.","pos":[106123,106298],"source":" Points to the [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) structure defining the target device for which the object's size should be returned."},{"content":"<bpt id=\"p1\">*</bpt>lpsizel<ept id=\"p1\">*</ept>","pos":[106305,106314],"source":"*lpsizel*"},{"content":"Points to the location where the object's size is returned.","pos":[106318,106377]},{"pos":[106387,106399],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if extent information is successfully returned; otherwise 0.","pos":[106403,106471]},{"pos":[106481,106488],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function if your control uses two-pass drawing, and its opaque and transparent parts have different dimensions.","pos":[106492,106617]},{"pos":[106627,106696],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetviewrect\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetViewRect","linkify":"<a name=\"colecontrol__ongetviewrect\"></a>  COleControl::OnGetViewRect","source":"<a name=\"colecontrol__ongetviewrect\"></a>  COleControl::OnGetViewRect"},{"pos":[106700,106788],"content":"Called by the framework in response to a container's <bpt id=\"p1\">**</bpt>IViewObjectEx::GetRect<ept id=\"p1\">**</ept> request.","source":"Called by the framework in response to a container's **IViewObjectEx::GetRect** request."},{"pos":[106877,106887],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<ph id=\"ph1\"> `DWORD`</ph> describing which form, or aspect, of an object is to be displayed.","pos":[106904,106979],"source":" `DWORD` describing which form, or aspect, of an object is to be displayed."},{"content":"Valid values are taken from the enumeration <bpt id=\"p1\">[</bpt>DVASPECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690318)</ept> or <bpt id=\"p2\">**</bpt>DVASPECT2<ept id=\"p2\">**</ept>:","pos":[106980,107112],"source":" Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**:"},{"content":"<ph id=\"ph1\">`DVASPECT_CONTENT`</ph> Bounding rectangle of the whole object.","pos":[107120,107178],"source":"`DVASPECT_CONTENT` Bounding rectangle of the whole object."},{"content":"Top-left corner at the object's origin and size equal to the extent returned by <bpt id=\"p1\">**</bpt>GetViewExtent<ept id=\"p1\">**</ept><bpt id=\"p2\">*</bpt>.<ept id=\"p2\">*</ept>","pos":[107179,107279],"source":" Top-left corner at the object's origin and size equal to the extent returned by **GetViewExtent***.*"},{"content":"<bpt id=\"p1\">**</bpt>DVASPECT_OPAQUE<ept id=\"p1\">**</ept> Objects with a rectangular opaque region return that rectangle.","pos":[107287,107370],"source":"**DVASPECT_OPAQUE** Objects with a rectangular opaque region return that rectangle."},{"content":"Others fail.","pos":[107371,107383]},{"pos":[107391,107470],"content":"<bpt id=\"p1\">**</bpt>DVASPECT_TRANSPARENT<ept id=\"p1\">**</ept> Rectangle covering all transparent or irregular parts.","source":"**DVASPECT_TRANSPARENT** Rectangle covering all transparent or irregular parts."},{"pos":[107477,107711],"content":"`pRect`  \nPoints to the [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) structure specifying the rectangle in which the object should be drawn. This parameter controls the positioning and stretching of the object.","leadings":[""," "],"nodes":[{"content":"Points to the [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) structure specifying the rectangle in which the object should be drawn. This parameter controls the positioning and stretching of the object.","pos":[10,233],"nodes":[{"content":"Points to the <bpt id=\"p1\">[</bpt>RECTL<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd162907)</ept> structure specifying the rectangle in which the object should be drawn.","pos":[0,153],"source":"Points to the [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) structure specifying the rectangle in which the object should be drawn."},{"content":"This parameter controls the positioning and stretching of the object.","pos":[154,223]}]}]},{"pos":[107721,107733],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the rectangle sized to the object is successfully returned; otherwise 0.","pos":[107737,107820]},{"pos":[107830,107837],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The object's size is converted by <ph id=\"ph1\">`OnGetViewRect`</ph> into a rectangle starting at a specific position (the default is the upper left corner of the display).","pos":[107841,107994],"source":"The object's size is converted by `OnGetViewRect` into a rectangle starting at a specific position (the default is the upper left corner of the display)."},{"content":"Override this function if your control uses two-pass drawing, and its opaque and transparent parts have different dimensions.","pos":[107995,108120]},{"pos":[108130,108203],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ongetviewstatus\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnGetViewStatus","linkify":"<a name=\"colecontrol__ongetviewstatus\"></a>  COleControl::OnGetViewStatus","source":"<a name=\"colecontrol__ongetviewstatus\"></a>  COleControl::OnGetViewStatus"},{"pos":[108207,108301],"content":"Called by the framework in response to a container's <bpt id=\"p1\">**</bpt>IViewObjectEx::GetViewStatus<ept id=\"p1\">**</ept> request.","source":"Called by the framework in response to a container's **IViewObjectEx::GetViewStatus** request."},{"pos":[108359,108371],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"One of the values of the <bpt id=\"p1\">**</bpt>VIEWSTATUS<ept id=\"p1\">**</ept> enumeration if successful; otherwise 0.","pos":[108375,108454],"source":"One of the values of the **VIEWSTATUS** enumeration if successful; otherwise 0."},{"content":"Possible values are any combination of the following:","pos":[108455,108508]},{"content":"<bpt id=\"p1\">**</bpt>VIEWSTATUS_OPAQUE<ept id=\"p1\">**</ept>","pos":[108515,108536],"source":"**VIEWSTATUS_OPAQUE**"},{"content":"Object is completely opaque.","pos":[108540,108568]},{"content":"If this bit is not set, the object contains transparent parts.","pos":[108569,108631]},{"content":"This bit applies only to content-related aspects and not to <ph id=\"ph1\">`DVASPECT_ICON`</ph> or <ph id=\"ph2\">`DVASPECT_DOCPRINT`</ph>.","pos":[108632,108731],"source":" This bit applies only to content-related aspects and not to `DVASPECT_ICON` or `DVASPECT_DOCPRINT`."},{"content":"<bpt id=\"p1\">**</bpt>VIEWSTATUS_SOLIDBKGND<ept id=\"p1\">**</ept>","pos":[108738,108763],"source":"**VIEWSTATUS_SOLIDBKGND**"},{"content":"Object has a solid background (consisting in a solid color, not a brush pattern).","pos":[108767,108848]},{"content":"This bit is meaningful only if <bpt id=\"p1\">**</bpt>VIEWSTATUS_OPAQUE<ept id=\"p1\">**</ept> is set and applies only to content-related aspects and not to <ph id=\"ph1\">`DVASPECT_ICON`</ph> or <ph id=\"ph2\">`DVASPECT_DOCPRINT`</ph>.","pos":[108849,109003],"source":" This bit is meaningful only if **VIEWSTATUS_OPAQUE** is set and applies only to content-related aspects and not to `DVASPECT_ICON` or `DVASPECT_DOCPRINT`."},{"content":"<bpt id=\"p1\">**</bpt>VIEWSTATUS_DVASPECTOPAQUE<ept id=\"p1\">**</ept>","pos":[109010,109039],"source":"**VIEWSTATUS_DVASPECTOPAQUE**"},{"content":"Object supports <bpt id=\"p1\">**</bpt>DVASPECT_OPAQUE<ept id=\"p1\">**</ept>.","pos":[109043,109079],"source":" Object supports **DVASPECT_OPAQUE**."},{"content":"All <bpt id=\"p1\">**</bpt>IViewObjectEx<ept id=\"p1\">**</ept> methods that take a drawing aspect as a parameter can be called with this aspect.","pos":[109080,109183],"source":" All **IViewObjectEx** methods that take a drawing aspect as a parameter can be called with this aspect."},{"content":"<bpt id=\"p1\">**</bpt>VIEWSTATUS_DVASPECTTRANSPARENT<ept id=\"p1\">**</ept>","pos":[109190,109224],"source":"**VIEWSTATUS_DVASPECTTRANSPARENT**"},{"content":"Object supports <bpt id=\"p1\">**</bpt>DVASPECT_TRANSPARENT<ept id=\"p1\">**</ept>.","pos":[109228,109269],"source":" Object supports **DVASPECT_TRANSPARENT**."},{"content":"All <bpt id=\"p1\">**</bpt>IViewObjectEx<ept id=\"p1\">**</ept> methods that take a drawing aspect as a parameter can be called with this aspect.","pos":[109270,109373],"source":" All **IViewObjectEx** methods that take a drawing aspect as a parameter can be called with this aspect."},{"pos":[109383,109390],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function if your control uses two-pass drawing.","pos":[109394,109455]},{"content":"The default implementation returns <bpt id=\"p1\">**</bpt>VIEWSTATUS_OPAQUE<ept id=\"p1\">**</ept>.","pos":[109456,109513],"source":" The default implementation returns **VIEWSTATUS_OPAQUE**."},{"pos":[109523,109594],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onhidetoolbars\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnHideToolBars","linkify":"<a name=\"colecontrol__onhidetoolbars\"></a>  COleControl::OnHideToolBars","source":"<a name=\"colecontrol__onhidetoolbars\"></a>  COleControl::OnHideToolBars"},{"content":"Called by the framework when the control is UI deactivated.","pos":[109598,109657]},{"pos":[109713,109720],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[109724,109798],"content":"The implementation should hide all toolbars displayed by <ph id=\"ph1\">`OnShowToolbars`</ph>.","source":"The implementation should hide all toolbars displayed by `OnShowToolbars`."},{"pos":[109808,109889],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__oninactivemousemove\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnInactiveMouseMove","linkify":"<a name=\"colecontrol__oninactivemousemove\"></a>  COleControl::OnInactiveMouseMove","source":"<a name=\"colecontrol__oninactivemousemove\"></a>  COleControl::OnInactiveMouseMove"},{"pos":[109893,110004],"content":"Called by the container for the inactive object under the mouse pointer on receipt of a <ph id=\"ph1\">`WM_MOUSEMOVE`</ph> message.","source":"Called by the container for the inactive object under the mouse pointer on receipt of a `WM_MOUSEMOVE` message."},{"pos":[110134,110144],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The object bounding rectangle, in client coordinates of the containing window.","pos":[110164,110242]},{"content":"Tells the object its exact position and size on the screen when the <ph id=\"ph1\">`WM_MOUSEMOVE`</ph> message was received.","pos":[110243,110347],"source":" Tells the object its exact position and size on the screen when the `WM_MOUSEMOVE` message was received."},{"content":"<bpt id=\"p1\">*</bpt>x<ept id=\"p1\">*</ept>","pos":[110354,110357],"source":"*x*"},{"content":"The x coordinate of the mouse location in client coordinates of the containing window.","pos":[110361,110447]},{"content":"<bpt id=\"p1\">*</bpt>y<ept id=\"p1\">*</ept>","pos":[110454,110457],"source":"*y*"},{"content":"The y coordinate of the mouse location in client coordinates of the containing window.","pos":[110461,110547]},{"content":"Identifies the current state of the keyboard modifier keys on the keyboard.","pos":[110570,110645]},{"content":"Valid values can be a combination of any of the flags <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>MK_SHIFT<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>MK_ALT<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>MK_BUTTON<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>MK_LBUTTON<ept id=\"p5\">**</ept>, <bpt id=\"p6\">**</bpt>MK_MBUTTON<ept id=\"p6\">**</ept>, and <bpt id=\"p7\">**</bpt>MK_RBUTTON<ept id=\"p7\">**</ept>.","pos":[110646,110808],"source":" Valid values can be a combination of any of the flags **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_BUTTON**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**."},{"pos":[110818,110825],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that window client coordinates (pixels) are used to pass the mouse cursor position.","pos":[110829,110917]},{"content":"This is made possible by also passing the bounding rectangle of the object in the same coordinate system.","pos":[110918,111023]},{"pos":[111033,111114],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__oninactivesetcursor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnInactiveSetCursor","linkify":"<a name=\"colecontrol__oninactivesetcursor\"></a>  COleControl::OnInactiveSetCursor","source":"<a name=\"colecontrol__oninactivesetcursor\"></a>  COleControl::OnInactiveSetCursor"},{"pos":[111118,111229],"content":"Called by the container for the inactive object under the mouse pointer on receipt of a <ph id=\"ph1\">`WM_SETCURSOR`</ph> message.","source":"Called by the container for the inactive object under the mouse pointer on receipt of a `WM_SETCURSOR` message."},{"pos":[111380,111390],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The object bounding rectangle, in client coordinates of the containing window.","pos":[111410,111488]},{"content":"Tells the object its exact position and size on the screen when the <ph id=\"ph1\">`WM_SETCURSOR`</ph> message was received.","pos":[111489,111593],"source":" Tells the object its exact position and size on the screen when the `WM_SETCURSOR` message was received."},{"content":"<bpt id=\"p1\">*</bpt>x<ept id=\"p1\">*</ept>","pos":[111600,111603],"source":"*x*"},{"content":"The x coordinate of the mouse location in client coordinates of the containing window.","pos":[111607,111693]},{"content":"<bpt id=\"p1\">*</bpt>y<ept id=\"p1\">*</ept>","pos":[111700,111703],"source":"*y*"},{"content":"The y coordinate of the mouse location in client coordinates of the containing window.","pos":[111707,111793]},{"content":"<bpt id=\"p1\">*</bpt>dwMouseMsg<ept id=\"p1\">*</ept>","pos":[111800,111812],"source":"*dwMouseMsg*"},{"content":"The identifier of the mouse message for which a <ph id=\"ph1\">`WM_SETCURSOR`</ph> occurred.","pos":[111816,111888],"source":" The identifier of the mouse message for which a `WM_SETCURSOR` occurred."},{"content":"<bpt id=\"p1\">*</bpt>bSetAlways<ept id=\"p1\">*</ept>","pos":[111895,111907],"source":"*bSetAlways*"},{"content":"Specifies whether or not the object must set the cursor.","pos":[111911,111967]},{"content":"If <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the object must set the cursor; if <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>, the cursor is not obligated to set the cursor, and should return <bpt id=\"p3\">**</bpt>S_FALSE<ept id=\"p3\">**</ept> in that case.","pos":[111968,112117],"source":" If **TRUE**, the object must set the cursor; if **FALSE**, the cursor is not obligated to set the cursor, and should return **S_FALSE** in that case."},{"pos":[112127,112139],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[112143,112178]},{"pos":[112188,112195],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that window client coordinates (pixels) are used to pass the mouse cursor position.","pos":[112199,112287]},{"content":"This is made possible by also passing the bounding rectangle of the object in the same coordinate system.","pos":[112288,112393]},{"pos":[112403,112474],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onkeydownevent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnKeyDownEvent","linkify":"<a name=\"colecontrol__onkeydownevent\"></a>  COleControl::OnKeyDownEvent","source":"<a name=\"colecontrol__onkeydownevent\"></a>  COleControl::OnKeyDownEvent"},{"content":"Called by the framework after a stock KeyDown event has been processed.","pos":[112478,112549]},{"pos":[112648,112658],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The virtual key code value of the pressed key.","pos":[112673,112719]},{"content":"For a list of standard virtual key codes, see Winuser.h","pos":[112720,112775]},{"content":"Contains a combination of the following flags:","pos":[112799,112845]},{"pos":[112853,112912],"content":"<bpt id=\"p1\">**</bpt>SHIFT_MASK<ept id=\"p1\">**</ept> The SHIFT key was pressed during the action.","source":"**SHIFT_MASK** The SHIFT key was pressed during the action."},{"pos":[112920,112977],"content":"<bpt id=\"p1\">**</bpt>CTRL_MASK<ept id=\"p1\">**</ept> The CTRL key was pressed during the action.","source":"**CTRL_MASK** The CTRL key was pressed during the action."},{"pos":[112985,113040],"content":"<bpt id=\"p1\">**</bpt>ALT_MASK<ept id=\"p1\">**</ept> The ALT key was pressed during the action.","source":"**ALT_MASK** The ALT key was pressed during the action."},{"pos":[113050,113057],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function if your control needs access to the key information after the event has been fired.","pos":[113061,113167]},{"pos":[113177,113250],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onkeypressevent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnKeyPressEvent","linkify":"<a name=\"colecontrol__onkeypressevent\"></a>  COleControl::OnKeyPressEvent","source":"<a name=\"colecontrol__onkeypressevent\"></a>  COleControl::OnKeyPressEvent"},{"content":"Called by the framework after the stock KeyPress event has been fired.","pos":[113254,113324]},{"pos":[113393,113403],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Contains the virtual key code value of the key pressed.","pos":[113418,113473]},{"content":"For a list of standard virtual key codes, see Winuser.h","pos":[113474,113529]},{"pos":[113539,113546],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[113550,113618],"content":"Note that the <ph id=\"ph1\">`nChar`</ph> value may have been modified by the container.","source":"Note that the `nChar` value may have been modified by the container."},{"content":"Override this function if you want notification after this event occurs.","pos":[113625,113697]},{"pos":[113707,113774],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onkeyupevent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnKeyUpEvent","linkify":"<a name=\"colecontrol__onkeyupevent\"></a>  COleControl::OnKeyUpEvent","source":"<a name=\"colecontrol__onkeyupevent\"></a>  COleControl::OnKeyUpEvent"},{"content":"Called by the framework after a stock KeyDown event has been processed.","pos":[113778,113849]},{"pos":[113946,113956],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The virtual key code value of the pressed key.","pos":[113971,114017]},{"content":"For a list of standard virtual key codes, see Winuser.h","pos":[114018,114073]},{"content":"Contains a combination of the following flags:","pos":[114097,114143]},{"pos":[114151,114210],"content":"<bpt id=\"p1\">**</bpt>SHIFT_MASK<ept id=\"p1\">**</ept> The SHIFT key was pressed during the action.","source":"**SHIFT_MASK** The SHIFT key was pressed during the action."},{"pos":[114218,114275],"content":"<bpt id=\"p1\">**</bpt>CTRL_MASK<ept id=\"p1\">**</ept> The CTRL key was pressed during the action.","source":"**CTRL_MASK** The CTRL key was pressed during the action."},{"pos":[114283,114338],"content":"<bpt id=\"p1\">**</bpt>ALT_MASK<ept id=\"p1\">**</ept> The ALT key was pressed during the action.","source":"**ALT_MASK** The ALT key was pressed during the action."},{"pos":[114348,114355],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function if your control needs access to the key information after the event has been fired.","pos":[114359,114465]},{"pos":[114475,114556],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onmappropertytopage\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnMapPropertyToPage","linkify":"<a name=\"colecontrol__onmappropertytopage\"></a>  COleControl::OnMapPropertyToPage","source":"<a name=\"colecontrol__onmappropertytopage\"></a>  COleControl::OnMapPropertyToPage"},{"content":"Called by the framework to obtain the class ID of a property page that implements editing of the specified property.","pos":[114560,114676]},{"pos":[114806,114816],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The dispatch ID of a property of the control.","pos":[114832,114877]},{"content":"Pointer to a <bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept> structure through which a class ID will be returned.","pos":[114897,114972],"source":" Pointer to a **CLSID** structure through which a class ID will be returned."},{"content":"<bpt id=\"p1\">*</bpt>pbPageOptional<ept id=\"p1\">*</ept>","pos":[114979,114995],"source":"*pbPageOptional*"},{"content":"Returns an indicator of whether use of the specified property page is optional.","pos":[114999,115078]},{"pos":[115088,115100],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[115104,115170],"content":"Nonzero if a class ID has been returned in <ph id=\"ph1\">`lpclsid`</ph>; otherwise 0.","source":"Nonzero if a class ID has been returned in `lpclsid`; otherwise 0."},{"pos":[115180,115187],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Override this function to provide a way to invoke your control's property pages from the container's property browser.","pos":[115191,115309]},{"pos":[115319,115382],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onmnemonic\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnMnemonic","linkify":"<a name=\"colecontrol__onmnemonic\"></a>  COleControl::OnMnemonic","source":"<a name=\"colecontrol__onmnemonic\"></a>  COleControl::OnMnemonic"},{"content":"Called by the framework when the container has detected that a mnemonic key of the OLE control has been pressed.","pos":[115386,115498]},{"pos":[115560,115570],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the Windows message generated by a mnemonic key press.","pos":[115584,115649]},{"pos":[115659,115726],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onproperties\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnProperties","linkify":"<a name=\"colecontrol__onproperties\"></a>  COleControl::OnProperties","source":"<a name=\"colecontrol__onproperties\"></a>  COleControl::OnProperties"},{"content":"Called by the framework when the control's properties verb has been invoked by the container.","pos":[115730,115823]},{"pos":[115938,115948],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to the Windows message that invoked the verb.","pos":[115963,116018]},{"content":"A handle to the parent window of the control.","pos":[116041,116086]},{"content":"A pointer to the rectangle used by the control in the container.","pos":[116105,116169]},{"pos":[116179,116191],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the call is successful; otherwise 0.","pos":[116195,116242]},{"pos":[116252,116259],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The default implementation displays a modal property dialog box.","pos":[116263,116327]},{"content":"You can also use this function to cause the display of your control's property pages.","pos":[116334,116419]},{"content":"Make a call to the <ph id=\"ph1\">`OnProperties`</ph> function, passing the handle of your control's parent in the <ph id=\"ph2\">`hWndParent`</ph> parameter.","pos":[116420,116538],"source":" Make a call to the `OnProperties` function, passing the handle of your control's parent in the `hWndParent` parameter."},{"content":"In this case, the values of the <ph id=\"ph1\">`lpMsg`</ph> and <ph id=\"ph2\">`lpRect`</ph> parameters are ignored.","pos":[116539,116615],"source":" In this case, the values of the `lpMsg` and `lpRect` parameters are ignored."},{"pos":[116625,116698],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onqueryhitpoint\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnQueryHitPoint","linkify":"<a name=\"colecontrol__onqueryhitpoint\"></a>  COleControl::OnQueryHitPoint","source":"<a name=\"colecontrol__onqueryhitpoint\"></a>  COleControl::OnQueryHitPoint"},{"pos":[116702,116796],"content":"Called by the framework in response to a container's <bpt id=\"p1\">**</bpt>IViewObjectEx::QueryHitPoint<ept id=\"p1\">**</ept> request.","source":"Called by the framework in response to a container's **IViewObjectEx::QueryHitPoint** request."},{"pos":[116959,116969],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies how the object is represented.","pos":[116987,117027]},{"content":"Valid values are taken from the enumeration <bpt id=\"p1\">[</bpt>DVASPECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690318)</ept> or <bpt id=\"p2\">**</bpt>DVASPECT2<ept id=\"p2\">**</ept>.","pos":[117028,117160],"source":" Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**."},{"content":"Pointer to a <ph id=\"ph1\">`RECT`</ph> structure specifying the bounding rectangle of the OLE control client area.","pos":[117184,117279],"source":" Pointer to a `RECT` structure specifying the bounding rectangle of the OLE control client area."},{"content":"Pointer to the <bpt id=\"p1\">**</bpt>POINT<ept id=\"p1\">**</ept> structure specifying the point to be checked for a hit.","pos":[117298,117378],"source":" Pointer to the **POINT** structure specifying the point to be checked for a hit."},{"content":"The point is specified in OLE client area coordinates.","pos":[117379,117433]},{"content":"The distance that defines \"close\" to the point checked for a hit.","pos":[117456,117521]},{"content":"Pointer to the result of the hit query.","pos":[117544,117583]},{"content":"One of the following values:","pos":[117584,117612]},{"pos":[117620,117691],"content":"<bpt id=\"p1\">**</bpt>HITRESULT_OUTSIDE<ept id=\"p1\">**</ept> <ph id=\"ph1\">`ptlLoc`</ph> is outside the OLE object and not close.","source":"**HITRESULT_OUTSIDE** `ptlLoc` is outside the OLE object and not close."},{"content":"<bpt id=\"p1\">**</bpt>HITRESULT_TRANSPARENT<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>ptlLoc<ept id=\"p2\">*</ept> is within the bounds of the OLE object, but not close to the image.","pos":[117699,117801],"source":"**HITRESULT_TRANSPARENT** *ptlLoc* is within the bounds of the OLE object, but not close to the image."},{"content":"For example, a point in the middle of a transparent circle could be <bpt id=\"p1\">**</bpt>HITRESULT_TRANSPARENT<ept id=\"p1\">**</ept>.","pos":[117802,117896],"source":" For example, a point in the middle of a transparent circle could be **HITRESULT_TRANSPARENT**."},{"content":"<bpt id=\"p1\">**</bpt>HITRESULT_CLOSE<ept id=\"p1\">**</ept> <ph id=\"ph1\">`ptlLoc`</ph> is inside or outside the OLE object but close enough to the object to be considered inside.","pos":[117904,118024],"source":"**HITRESULT_CLOSE** `ptlLoc` is inside or outside the OLE object but close enough to the object to be considered inside."},{"content":"Small, thin, or detailed objects may use this value.","pos":[118025,118077]},{"content":"Even if a point is outside the bounding rectangle of an object it may still be close (this is needed for hitting small objects).","pos":[118078,118206]},{"pos":[118214,118275],"content":"<bpt id=\"p1\">**</bpt>HITRESULT_HIT<ept id=\"p1\">**</ept> <ph id=\"ph1\">`ptlLoc`</ph> is within the image of the object.","source":"**HITRESULT_HIT** `ptlLoc` is within the image of the object."},{"pos":[118285,118297],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if a hit result is successfully returned; otherwise 0.","pos":[118301,118363]},{"content":"A hit is an overlap with the OLE control display area.","pos":[118364,118418]},{"pos":[118428,118435],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Queries whether an object's display rectangle overlaps the given point (hits the point).","pos":[118439,118527]},{"content":"<ph id=\"ph1\">`QueryHitPoint`</ph> can be overridden to test hits for non-rectangular objects.","pos":[118528,118603],"source":"`QueryHitPoint` can be overridden to test hits for non-rectangular objects."},{"pos":[118613,118684],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onqueryhitrect\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnQueryHitRect","linkify":"<a name=\"colecontrol__onqueryhitrect\"></a>  COleControl::OnQueryHitRect","source":"<a name=\"colecontrol__onqueryhitrect\"></a>  COleControl::OnQueryHitRect"},{"pos":[118688,118781],"content":"Called by the framework in response to a container's <bpt id=\"p1\">**</bpt>IViewObjectEx::QueryHitRect<ept id=\"p1\">**</ept> request.","source":"Called by the framework in response to a container's **IViewObjectEx::QueryHitRect** request."},{"pos":[118953,118963],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies how the object is to be represented.","pos":[118981,119027]},{"content":"Valid values are taken from the enumeration <bpt id=\"p1\">[</bpt>DVASPECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690318)</ept> or <bpt id=\"p2\">**</bpt>DVASPECT2<ept id=\"p2\">**</ept>.","pos":[119028,119160],"source":" Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**."},{"content":"Pointer to a <ph id=\"ph1\">`RECT`</ph> structure specifying the bounding rectangle of the OLE control client area.","pos":[119184,119279],"source":" Pointer to a `RECT` structure specifying the bounding rectangle of the OLE control client area."},{"content":"<bpt id=\"p1\">*</bpt>prcLoc<ept id=\"p1\">*</ept>","pos":[119286,119294],"source":"*prcLoc*"},{"content":"Pointer to the <ph id=\"ph1\">`RECT`</ph> structure specifying the rectangle to be checked for a hit (overlap with the object rectangle), relative to the upper left corner of the object.","pos":[119298,119464],"source":" Pointer to the `RECT` structure specifying the rectangle to be checked for a hit (overlap with the object rectangle), relative to the upper left corner of the object."},{"content":"Not used.","pos":[119487,119496]},{"content":"Pointer to the result of the hit query.","pos":[119519,119558]},{"content":"One of the following values:","pos":[119559,119587]},{"pos":[119595,119668],"content":"<bpt id=\"p1\">**</bpt>HITRESULT_OUTSIDE<ept id=\"p1\">**</ept> no point in the rectangle is hit by the OLE object.","source":"**HITRESULT_OUTSIDE** no point in the rectangle is hit by the OLE object."},{"pos":[119676,119759],"content":"<bpt id=\"p1\">**</bpt>HITRESULT_HIT<ept id=\"p1\">**</ept> at least one point in the rectangle would be a hit on the object.","source":"**HITRESULT_HIT** at least one point in the rectangle would be a hit on the object."},{"pos":[119769,119781],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if a hit result is successfully returned; otherwise 0.","pos":[119785,119847]},{"pos":[119857,119864],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Queries whether an object's display rectangle overlaps any point in the given rectangle (hits the rectangle).","pos":[119868,119977]},{"content":"<ph id=\"ph1\">`QueryHitRect`</ph> can be overridden to test hits for non-rectangular objects.","pos":[119978,120052],"source":"`QueryHitRect` can be overridden to test hits for non-rectangular objects."},{"pos":[120062,120129],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onrenderdata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnRenderData","linkify":"<a name=\"colecontrol__onrenderdata\"></a>  COleControl::OnRenderData","source":"<a name=\"colecontrol__onrenderdata\"></a>  COleControl::OnRenderData"},{"content":"Called by the framework to retrieve data in the specified format.","pos":[120133,120198]},{"pos":[120311,120321],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure specifying the format in which information is requested.","pos":[120342,120494],"source":" Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested."},{"content":"Points to a <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure in which the data is to be returned.","pos":[120518,120648],"source":" Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in which the data is to be returned."},{"pos":[120658,120670],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[120674,120709]},{"pos":[120719,120726],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The specified format is one previously placed in the control object using the <bpt id=\"p1\">[</bpt>DelayRenderData<ept id=\"p1\">](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderdata)</ept> or <bpt id=\"p2\">[</bpt>DelayRenderFileData<ept id=\"p2\">](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderfiledata)</ept> member functions for delayed rendering.","pos":[120730,121048],"source":"The specified format is one previously placed in the control object using the [DelayRenderData](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderdata) or [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderfiledata) member functions for delayed rendering."},{"content":"The default implementation of this function calls <ph id=\"ph1\">`OnRenderFileData`</ph> or <ph id=\"ph2\">`OnRenderGlobalData`</ph>, respectively, if the supplied storage medium is either a file or memory.","pos":[121049,121215],"source":" The default implementation of this function calls `OnRenderFileData` or `OnRenderGlobalData`, respectively, if the supplied storage medium is either a file or memory."},{"content":"If the requested format is <ph id=\"ph1\">`CF_METAFILEPICT`</ph> or the persistent property set format, the default implementation renders the appropriate data and returns nonzero.","pos":[121216,121376],"source":" If the requested format is `CF_METAFILEPICT` or the persistent property set format, the default implementation renders the appropriate data and returns nonzero."},{"content":"Otherwise, it returns 0 and does nothing.","pos":[121377,121418]},{"content":"If <bpt id=\"p1\">*</bpt>lpStgMedium-&gt;tymed<ept id=\"p1\">*</ept> is <bpt id=\"p2\">**</bpt>TYMED_NULL<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>STGMEDIUM<ept id=\"p3\">**</ept> should be allocated and filled as specified by <bpt id=\"p4\">*</bpt>lpFormatEtc-&gt;tymed<ept id=\"p4\">*</ept>.","pos":[121425,121554],"source":"If *lpStgMedium->tymed* is **TYMED_NULL**, the **STGMEDIUM** should be allocated and filled as specified by *lpFormatEtc->tymed*."},{"content":"If not <bpt id=\"p1\">**</bpt>TYMED_NULL<ept id=\"p1\">**</ept>, the <bpt id=\"p2\">**</bpt>STGMEDIUM<ept id=\"p2\">**</ept> should be filled in place with the data.","pos":[121555,121636],"source":" If not **TYMED_NULL**, the **STGMEDIUM** should be filled in place with the data."},{"content":"Override this function to provide your data in the requested format and medium.","pos":[121643,121722]},{"content":"Depending on your data, you may want to override one of the other versions of this function instead.","pos":[121723,121823]},{"content":"If your data is small and fixed in size, override <ph id=\"ph1\">`OnRenderGlobalData`</ph>.","pos":[121824,121895],"source":" If your data is small and fixed in size, override `OnRenderGlobalData`."},{"content":"If your data is in a file, or is of variable size, override <ph id=\"ph1\">`OnRenderFileData`</ph>.","pos":[121896,121975],"source":" If your data is in a file, or is of variable size, override `OnRenderFileData`."},{"pos":[121982,122114],"content":"For more information, see the <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>STGMEDIUM<ept id=\"p2\">**</ept> structures in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the **FORMATETC** and **STGMEDIUM** structures in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[122124,122199],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onrenderfiledata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnRenderFileData","linkify":"<a name=\"colecontrol__onrenderfiledata\"></a>  COleControl::OnRenderFileData","source":"<a name=\"colecontrol__onrenderfiledata\"></a>  COleControl::OnRenderFileData"},{"content":"Called by the framework to retrieve data in the specified format when the storage medium is a file.","pos":[122203,122302]},{"pos":[122408,122418],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure specifying the format in which information is requested.","pos":[122439,122591],"source":" Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested."},{"content":"Points to a <bpt id=\"p1\">[</bpt>CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md)</ept> object in which the data is to be rendered.","pos":[122609,122708],"source":" Points to a [CFile](../../mfc/reference/cfile-class.md) object in which the data is to be rendered."},{"pos":[122718,122730],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[122734,122769]},{"pos":[122779,122786],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The specified format is one previously placed in the control object using the <bpt id=\"p1\">[</bpt>DelayRenderData<ept id=\"p1\">](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderdata)</ept> member function for delayed rendering.","pos":[122790,123001],"source":"The specified format is one previously placed in the control object using the [DelayRenderData](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderdata) member function for delayed rendering."},{"content":"The default implementation of this function simply returns <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[123002,123071],"source":" The default implementation of this function simply returns **FALSE**."},{"content":"Override this function to provide your data in the requested format and medium.","pos":[123078,123157]},{"content":"Depending on your data, you might want to override one of the other versions of this function instead.","pos":[123158,123260]},{"content":"If you want to handle multiple storage mediums, override <ph id=\"ph1\">`OnRenderData`</ph>.","pos":[123261,123333],"source":" If you want to handle multiple storage mediums, override `OnRenderData`."},{"content":"If your data is in a file, or is of variable size, override <ph id=\"ph1\">`OnRenderFileData`</ph>.","pos":[123334,123413],"source":" If your data is in a file, or is of variable size, override `OnRenderFileData`."},{"pos":[123420,123533],"content":"For more information, see the <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the **FORMATETC** structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[123543,123622],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onrenderglobaldata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnRenderGlobalData","linkify":"<a name=\"colecontrol__onrenderglobaldata\"></a>  COleControl::OnRenderGlobalData","source":"<a name=\"colecontrol__onrenderglobaldata\"></a>  COleControl::OnRenderGlobalData"},{"content":"Called by the framework to retrieve data in the specified format when the specified storage medium is global memory.","pos":[123626,123742]},{"pos":[123855,123865],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure specifying the format in which information is requested.","pos":[123886,124038],"source":" Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested."},{"content":"Points to a handle to global memory in which the data is to be returned.","pos":[124059,124131]},{"content":"If no memory has been allocated, this parameter can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[124132,124196],"source":" If no memory has been allocated, this parameter can be **NULL**."},{"pos":[124206,124218],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[124222,124257]},{"pos":[124267,124274],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The specified format is one previously placed in the control object using the <bpt id=\"p1\">[</bpt>DelayRenderData<ept id=\"p1\">](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderdata)</ept> member function for delayed rendering.","pos":[124278,124489],"source":"The specified format is one previously placed in the control object using the [DelayRenderData](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderdata) member function for delayed rendering."},{"content":"The default implementation of this function simply returns <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[124490,124559],"source":" The default implementation of this function simply returns **FALSE**."},{"content":"If <ph id=\"ph1\">`phGlobal`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, then a new <ph id=\"ph2\">`HGLOBAL`</ph> should be allocated and returned in <ph id=\"ph3\">`phGlobal`</ph>.","pos":[124566,124661],"source":"If `phGlobal` is **NULL**, then a new `HGLOBAL` should be allocated and returned in `phGlobal`."},{"content":"Otherwise, the <ph id=\"ph1\">`HGLOBAL`</ph> specified by <ph id=\"ph2\">`phGlobal`</ph> should be filled with the data.","pos":[124662,124742],"source":" Otherwise, the `HGLOBAL` specified by `phGlobal` should be filled with the data."},{"content":"The amount of data placed in the <ph id=\"ph1\">`HGLOBAL`</ph> must not exceed the current size of the memory block.","pos":[124743,124839],"source":" The amount of data placed in the `HGLOBAL` must not exceed the current size of the memory block."},{"content":"Also, the block cannot be reallocated to a larger size.","pos":[124840,124895]},{"content":"Override this function to provide your data in the requested format and medium.","pos":[124902,124981]},{"content":"Depending on your data, you may want to override one of the other versions of this function instead.","pos":[124982,125082]},{"content":"If you want to handle multiple storage mediums, override <ph id=\"ph1\">`OnRenderData`</ph>.","pos":[125083,125155],"source":" If you want to handle multiple storage mediums, override `OnRenderData`."},{"content":"If your data is in a file, or is of variable size, override <ph id=\"ph1\">`OnRenderFileData`</ph>.","pos":[125156,125235],"source":" If your data is in a file, or is of variable size, override `OnRenderFileData`."},{"pos":[125242,125355],"content":"For more information, see the <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the **FORMATETC** structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[125365,125432],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onresetstate\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnResetState","linkify":"<a name=\"colecontrol__onresetstate\"></a>  COleControl::OnResetState","source":"<a name=\"colecontrol__onresetstate\"></a>  COleControl::OnResetState"},{"content":"Called by the framework when the control's properties should be set to their default values.","pos":[125436,125528]},{"pos":[125582,125589],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[125593,125764],"content":"The default implementation calls <bpt id=\"p1\">[</bpt>DoPropExchange<ept id=\"p1\">](#colecontrol__dopropexchange)</ept>, passing a <ph id=\"ph1\">`CPropExchange`</ph> object that causes properties to be set to their default values.","source":"The default implementation calls [DoPropExchange](#colecontrol__dopropexchange), passing a `CPropExchange` object that causes properties to be set to their default values."},{"content":"The control writer can insert initialization code for the OLE control in this overridable.","pos":[125771,125861]},{"content":"This function is called when <bpt id=\"p1\">[</bpt>IPersistStream::Load<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680568)</ept> or <bpt id=\"p2\">[</bpt>IPersistStorage::Load<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms680557)</ept> fails, or <bpt id=\"p3\">[</bpt>IPersistStreamInit::InitNew<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/ms690234)</ept> or <bpt id=\"p4\">[</bpt>IPersistStorage::InitNew<ept id=\"p4\">](http://msdn.microsoft.com/library/windows/desktop/ms687194)</ept> is called, without first calling either <bpt id=\"p5\">**</bpt>IPersistStream::Load<ept id=\"p5\">**</ept> or <bpt id=\"p6\">**</bpt>IPersistStorage::Load<ept id=\"p6\">**</ept>.","pos":[125862,126345],"source":" This function is called when [IPersistStream::Load](http://msdn.microsoft.com/library/windows/desktop/ms680568) or [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) fails, or [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) or [IPersistStorage::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) is called, without first calling either **IPersistStream::Load** or **IPersistStorage::Load**."},{"pos":[126355,126428],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onsetclientsite\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnSetClientSite","linkify":"<a name=\"colecontrol__onsetclientsite\"></a>  COleControl::OnSetClientSite","source":"<a name=\"colecontrol__onsetclientsite\"></a>  COleControl::OnSetClientSite"},{"pos":[126432,126540],"content":"Called by the framework when the container has called the control's <bpt id=\"p1\">**</bpt>IOleControl::SetClientSite<ept id=\"p1\">**</ept> function.","source":"Called by the framework when the container has called the control's **IOleControl::SetClientSite** function."},{"pos":[126597,126604],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[126608,126734],"content":"By default, <ph id=\"ph1\">`OnSetClientSite`</ph> checks whether data path properties are loaded and, if they are, calls <ph id=\"ph2\">`DoDataPathPropExchange`</ph>.","source":"By default, `OnSetClientSite` checks whether data path properties are loaded and, if they are, calls `DoDataPathPropExchange`."},{"content":"Override this function to do any special processing of this notification.","pos":[126741,126814]},{"content":"In particular, overrides of this function should call the base class.","pos":[126815,126884]},{"pos":[126894,126955],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onsetdata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnSetData","linkify":"<a name=\"colecontrol__onsetdata\"></a>  COleControl::OnSetData","source":"<a name=\"colecontrol__onsetdata\"></a>  COleControl::OnSetData"},{"content":"Called by the framework to replace the control's data with the specified data.","pos":[126959,127037]},{"pos":[127164,127174],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure specifying the format of the data.","pos":[127195,127324],"source":" Pointer to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format of the data."},{"content":"Pointer to a <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure in which the data resides.","pos":[127348,127469],"source":" Pointer to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in which the data resides."},{"content":"<bpt id=\"p1\"> **</bpt>TRUE<ept id=\"p1\">**</ept> if the control should free the storage medium; <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> if the control should not free the storage medium.","pos":[127489,127606],"source":" **TRUE** if the control should free the storage medium; **FALSE** if the control should not free the storage medium."},{"pos":[127616,127628],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[127632,127667]},{"pos":[127677,127684],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If the data is in the persistent property set format, the default implementation modifies the control's state accordingly.","pos":[127688,127810]},{"content":"Otherwise, the default implementation does nothing.","pos":[127811,127862]},{"content":"If <ph id=\"ph1\">`bRelease`</ph> is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, then a call to <bpt id=\"p2\">**</bpt>ReleaseStgMedium<ept id=\"p2\">**</ept> is made; otherwise not.","pos":[127863,127949],"source":" If `bRelease` is **TRUE**, then a call to **ReleaseStgMedium** is made; otherwise not."},{"content":"Override this function to replace the control's data with the specified data.","pos":[127956,128033]},{"pos":[128040,128172],"content":"For more information, see the <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>STGMEDIUM<ept id=\"p2\">**</ept> structures in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the **FORMATETC** and **STGMEDIUM** structures in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[128182,128247],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onsetextent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnSetExtent","linkify":"<a name=\"colecontrol__onsetextent\"></a>  COleControl::OnSetExtent","source":"<a name=\"colecontrol__onsetextent\"></a>  COleControl::OnSetExtent"},{"pos":[128251,128431],"content":"Called by the framework when the control's extent needs to be changed, as a result of a call to <bpt id=\"p1\">[</bpt>IOleObject::SetExtent<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694330)</ept>.","source":"Called by the framework when the control's extent needs to be changed, as a result of a call to [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330)."},{"pos":[128499,128509],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to the <bpt id=\"p1\">**</bpt>SIZEL<ept id=\"p1\">**</ept> structure that uses long integers to represent the width and height of the control, expressed in <bpt id=\"p2\">**</bpt>HIMETRIC<ept id=\"p2\">**</ept> units.","pos":[128526,128669],"source":" A pointer to the **SIZEL** structure that uses long integers to represent the width and height of the control, expressed in **HIMETRIC** units."},{"pos":[128679,128691],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the size change was accepted; otherwise 0.","pos":[128695,128748]},{"pos":[128758,128765],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The default implementation handles the resizing of the control's extent.","pos":[128769,128841]},{"content":"If the control is in-place active, a call to the container's <bpt id=\"p1\">**</bpt>OnPosRectChanged<ept id=\"p1\">**</ept> is then made.","pos":[128842,128937],"source":" If the control is in-place active, a call to the container's **OnPosRectChanged** is then made."},{"content":"Override this function to alter the default resizing of your control.","pos":[128944,129013]},{"pos":[129023,129098],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onsetobjectrects\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnSetObjectRects","linkify":"<a name=\"colecontrol__onsetobjectrects\"></a>  COleControl::OnSetObjectRects","source":"<a name=\"colecontrol__onsetobjectrects\"></a>  COleControl::OnSetObjectRects"},{"pos":[129102,129245],"content":"Called by the framework to implement a call to <bpt id=\"p1\">[</bpt>IOleInPlaceObject::SetObjectRects<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683767)</ept>.","source":"Called by the framework to implement a call to [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767)."},{"pos":[129351,129361],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>lpRectPos<ept id=\"p1\">*</ept>","pos":[129365,129376],"source":"*lpRectPos*"},{"content":"A pointer to a RECT structure indicating the control's new position and size relative to the container.","pos":[129380,129483]},{"content":"A pointer to a <ph id=\"ph1\">`RECT`</ph> structure indicating a rectangular area to which the control is to be clipped.","pos":[129506,129606],"source":" A pointer to a `RECT` structure indicating a rectangular area to which the control is to be clipped."},{"pos":[129616,129628],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the repositioning was accepted; otherwise 0.","pos":[129632,129687]},{"pos":[129697,129704],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[129708,129831],"content":"The default implementation automatically handles the repositioning and resizing of the control window and returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>.","source":"The default implementation automatically handles the repositioning and resizing of the control window and returns **TRUE**."},{"content":"Override this function to alter the default behavior of this function.","pos":[129838,129908]},{"pos":[129918,129989],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onshowtoolbars\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnShowToolBars","linkify":"<a name=\"colecontrol__onshowtoolbars\"></a>  COleControl::OnShowToolBars","source":"<a name=\"colecontrol__onshowtoolbars\"></a>  COleControl::OnShowToolBars"},{"content":"Called by the framework when the control has been UI activated.","pos":[129993,130056]},{"pos":[130112,130119],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The default implementation does nothing.","pos":[130123,130163]},{"pos":[130173,130242],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__ontextchanged\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnTextChanged","linkify":"<a name=\"colecontrol__ontextchanged\"></a>  COleControl::OnTextChanged","source":"<a name=\"colecontrol__ontextchanged\"></a>  COleControl::OnTextChanged"},{"content":"Called by the framework when the stock Caption or Text property value has changed.","pos":[130246,130328]},{"pos":[130383,130390],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[130394,130447],"content":"The default implementation calls <ph id=\"ph1\">`InvalidateControl`</ph>.","source":"The default implementation calls `InvalidateControl`."},{"content":"Override this function if you want notification after this property changes.","pos":[130454,130530]},{"pos":[130540,130621],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__onwindowlessmessage\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::OnWindowlessMessage","linkify":"<a name=\"colecontrol__onwindowlessmessage\"></a>  COleControl::OnWindowlessMessage","source":"<a name=\"colecontrol__onwindowlessmessage\"></a>  COleControl::OnWindowlessMessage"},{"pos":[130625,130735],"content":"Called by the framework in response to a container's <bpt id=\"p1\">**</bpt>IOleInPlaceObjectWindowless::OnWindowMessage<ept id=\"p1\">**</ept> request.","source":"Called by the framework in response to a container's **IOleInPlaceObjectWindowless::OnWindowMessage** request."},{"pos":[130870,130880],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Message identifier as passed by Windows.","pos":[130893,130933]},{"content":"As passed by Windows.","pos":[130952,130973]},{"content":"Specifies additional message-specific information.","pos":[130974,131024]},{"content":"The contents of this parameter depend on the value of the <ph id=\"ph1\">`msg`</ph> parameter.","pos":[131025,131099],"source":" The contents of this parameter depend on the value of the `msg` parameter."},{"content":"As passed by Windows.","pos":[131118,131139]},{"content":"Specifies additional message-specific information.","pos":[131140,131190]},{"content":"The contents of this parameter depend on the value of the <ph id=\"ph1\">`msg`</ph> parameter.","pos":[131191,131265],"source":" The contents of this parameter depend on the value of the `msg` parameter."},{"content":"<bpt id=\"p1\">*</bpt>plResult<ept id=\"p1\">*</ept>","pos":[131272,131282],"source":"*plResult*"},{"content":"Windows result code.","pos":[131286,131306]},{"content":"Specifies the result of the message processing and depends on the message sent.","pos":[131307,131386]},{"pos":[131396,131408],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[131412,131447]},{"pos":[131457,131464],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Processes window messages for windowless controls.","pos":[131468,131518]},{"content":"<ph id=\"ph1\">`COleControl`</ph>'s <ph id=\"ph2\">`OnWindowlessMessage`</ph> should be used for window messages other than mouse messages and keyboard messages.","pos":[131519,131640],"source":"`COleControl`'s `OnWindowlessMessage` should be used for window messages other than mouse messages and keyboard messages."},{"content":"<ph id=\"ph1\">`COleControl`</ph> provides <bpt id=\"p1\">[</bpt>SetCapture<ept id=\"p1\">](#colecontrol__setcapture)</ept> and <bpt id=\"p2\">[</bpt>SetFocus<ept id=\"p2\">](#colecontrol__setfocus)</ept> specifically to get mouse capture and keyboard focus for windowless OLE objects.","pos":[131641,131822],"source":"`COleControl` provides [SetCapture](#colecontrol__setcapture) and [SetFocus](#colecontrol__setfocus) specifically to get mouse capture and keyboard focus for windowless OLE objects."},{"content":"Because windowless objects do not have a window, they need a mechanism to let the container dispatch messages to them.","pos":[131829,131947]},{"content":"A windowless OLE object gets messages from its container, through the <ph id=\"ph1\">`OnWindowMessage`</ph> method on the <ph id=\"ph2\">`IOleInPlaceObjectWindowless`</ph> interface (an extension of <bpt id=\"p1\">[</bpt>IOleInPlaceObject<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms692646)</ept> for windowless support).","pos":[131948,132211],"source":" A windowless OLE object gets messages from its container, through the `OnWindowMessage` method on the `IOleInPlaceObjectWindowless` interface (an extension of [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) for windowless support)."},{"content":"<ph id=\"ph1\">`OnWindowMessage`</ph> does not take an <ph id=\"ph2\">`HWND`</ph> parameter.","pos":[132212,132264],"source":"`OnWindowMessage` does not take an `HWND` parameter."},{"pos":[132274,132345],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__parenttoclient\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ParentToClient","linkify":"<a name=\"colecontrol__parenttoclient\"></a>  COleControl::ParentToClient","source":"<a name=\"colecontrol__parenttoclient\"></a>  COleControl::ParentToClient"},{"pos":[132349,132412],"content":"Translates the coordinates of <ph id=\"ph1\">`pPoint`</ph> into client coordinates.","source":"Translates the coordinates of `pPoint` into client coordinates."},{"pos":[132547,132557],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the bounds of the OLE control within the container.","pos":[132577,132639]},{"content":"Not the client area but the area of the entire control including borders and scroll bars.","pos":[132640,132729]},{"content":"Pointer to the parent (container) point to be translated into the coordinates of the client area of the control.","pos":[132748,132860]},{"content":"Specifies whether or not hit testing is to be done on the point.","pos":[132881,132945]},{"pos":[132955,132967],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"If <ph id=\"ph1\">`bHitTest`</ph> is <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, returns <bpt id=\"p2\">**</bpt>HTNOWHERE<ept id=\"p2\">**</ept>.","pos":[132971,133021],"source":"If `bHitTest` is **FALSE**, returns **HTNOWHERE**."},{"content":"If <ph id=\"ph1\">`bHitTest`</ph> is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, returns the location in which the parent (container) point landed in the client area of the OLE control and is one of the following mouse hit-test values:","pos":[133022,133203],"source":" If `bHitTest` is **TRUE**, returns the location in which the parent (container) point landed in the client area of the OLE control and is one of the following mouse hit-test values:"},{"pos":[133211,133285],"content":"<bpt id=\"p1\">**</bpt>HTBORDER<ept id=\"p1\">**</ept> In the border of a window that does not have a sizing border.","source":"**HTBORDER** In the border of a window that does not have a sizing border."},{"pos":[133293,133351],"content":"<bpt id=\"p1\">**</bpt>HTBOTTOM<ept id=\"p1\">**</ept> In the lower horizontal border of the window.","source":"**HTBOTTOM** In the lower horizontal border of the window."},{"pos":[133359,133422],"content":"<bpt id=\"p1\">**</bpt>HTBOTTOMLEFT<ept id=\"p1\">**</ept> In the lower-left corner of the window border.","source":"**HTBOTTOMLEFT** In the lower-left corner of the window border."},{"pos":[133430,133495],"content":"<bpt id=\"p1\">**</bpt>HTBOTTOMRIGHT<ept id=\"p1\">**</ept> In the lower-right corner of the window border.","source":"**HTBOTTOMRIGHT** In the lower-right corner of the window border."},{"pos":[133503,133537],"content":"<bpt id=\"p1\">**</bpt>HTCAPTION<ept id=\"p1\">**</ept> In a title-bar area.","source":"**HTCAPTION** In a title-bar area."},{"pos":[133545,133575],"content":"<bpt id=\"p1\">**</bpt>HTCLIENT<ept id=\"p1\">**</ept> In a client area.","source":"**HTCLIENT** In a client area."},{"pos":[133583,133774],"content":"<bpt id=\"p1\">**</bpt>HTERROR<ept id=\"p1\">**</ept> On the screen background or on a dividing line between windows (same as <bpt id=\"p2\">**</bpt>HTNOWHERE<ept id=\"p2\">**</ept> except that the <bpt id=\"p3\">**</bpt>DefWndProc<ept id=\"p3\">**</ept> Windows function produces a system beep to indicate an error).","source":"**HTERROR** On the screen background or on a dividing line between windows (same as **HTNOWHERE** except that the **DefWndProc** Windows function produces a system beep to indicate an error)."},{"pos":[133782,133810],"content":"<bpt id=\"p1\">**</bpt>HTGROWBOX<ept id=\"p1\">**</ept> In a size box.","source":"**HTGROWBOX** In a size box."},{"pos":[133818,133861],"content":"<bpt id=\"p1\">**</bpt>HTHSCROLL<ept id=\"p1\">**</ept> In the horizontal scroll bar.","source":"**HTHSCROLL** In the horizontal scroll bar."},{"pos":[133869,133913],"content":"<bpt id=\"p1\">**</bpt>HTLEFT<ept id=\"p1\">**</ept> In the left border of the window.","source":"**HTLEFT** In the left border of the window."},{"pos":[133921,133958],"content":"<bpt id=\"p1\">**</bpt>HTMAXBUTTON<ept id=\"p1\">**</ept> In a Maximize button.","source":"**HTMAXBUTTON** In a Maximize button."},{"pos":[133966,133992],"content":"<bpt id=\"p1\">**</bpt>HTMENU<ept id=\"p1\">**</ept> In a menu area.","source":"**HTMENU** In a menu area."},{"pos":[134000,134037],"content":"<bpt id=\"p1\">**</bpt>HTMINBUTTON<ept id=\"p1\">**</ept> In a Minimize button.","source":"**HTMINBUTTON** In a Minimize button."},{"pos":[134045,134122],"content":"<bpt id=\"p1\">**</bpt>HTNOWHERE<ept id=\"p1\">**</ept> On the screen background or on a dividing line between windows.","source":"**HTNOWHERE** On the screen background or on a dividing line between windows."},{"pos":[134130,134164],"content":"<bpt id=\"p1\">**</bpt>HTREDUCE<ept id=\"p1\">**</ept> In a Minimize button.","source":"**HTREDUCE** In a Minimize button."},{"pos":[134172,134218],"content":"<bpt id=\"p1\">**</bpt>HTRIGHT<ept id=\"p1\">**</ept> In the right border of the window.","source":"**HTRIGHT** In the right border of the window."},{"pos":[134226,134275],"content":"<bpt id=\"p1\">**</bpt>HTSIZE<ept id=\"p1\">**</ept> In a size box (same as <bpt id=\"p2\">**</bpt>HTGROWBOX<ept id=\"p2\">**</ept>).","source":"**HTSIZE** In a size box (same as **HTGROWBOX**)."},{"pos":[134283,134354],"content":"<bpt id=\"p1\">**</bpt>HTSYSMENU<ept id=\"p1\">**</ept> In a Control menu or in a Close button in a child window.","source":"**HTSYSMENU** In a Control menu or in a Close button in a child window."},{"pos":[134362,134417],"content":"<bpt id=\"p1\">**</bpt>HTTOP<ept id=\"p1\">**</ept> In the upper horizontal border of the window.","source":"**HTTOP** In the upper horizontal border of the window."},{"pos":[134425,134485],"content":"<bpt id=\"p1\">**</bpt>HTTOPLEFT<ept id=\"p1\">**</ept> In the upper-left corner of the window border.","source":"**HTTOPLEFT** In the upper-left corner of the window border."},{"pos":[134493,134555],"content":"<bpt id=\"p1\">**</bpt>HTTOPRIGHT<ept id=\"p1\">**</ept> In the upper-right corner of the window border.","source":"**HTTOPRIGHT** In the upper-right corner of the window border."},{"pos":[134563,134629],"content":"<bpt id=\"p1\">**</bpt>HTTRANSPARENT<ept id=\"p1\">**</ept> In a window currently covered by another window.","source":"**HTTRANSPARENT** In a window currently covered by another window."},{"pos":[134637,134678],"content":"<bpt id=\"p1\">**</bpt>HTVSCROLL<ept id=\"p1\">**</ept> In the vertical scroll bar.","source":"**HTVSCROLL** In the vertical scroll bar."},{"pos":[134686,134718],"content":"<bpt id=\"p1\">**</bpt>HTZOOM<ept id=\"p1\">**</ept> In a Maximize button.","source":"**HTZOOM** In a Maximize button."},{"pos":[134728,134735],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"On input <ph id=\"ph1\">`pPoint`</ph> is relative to the origin of the parent (upper left corner of the container).","pos":[134739,134834],"source":"On input `pPoint` is relative to the origin of the parent (upper left corner of the container)."},{"content":"On output <ph id=\"ph1\">`pPoint`</ph> is relative to the origin of the client area of the OLE control (upper left corner of the client area of the control).","pos":[134835,134972],"source":" On output `pPoint` is relative to the origin of the client area of the OLE control (upper left corner of the client area of the control)."},{"pos":[134982,135055],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__postmodaldialog\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::PostModalDialog","linkify":"<a name=\"colecontrol__postmodaldialog\"></a>  COleControl::PostModalDialog","source":"<a name=\"colecontrol__postmodaldialog\"></a>  COleControl::PostModalDialog"},{"content":"Notifies the container that a modal dialog box has been closed.","pos":[135059,135122]},{"pos":[135193,135203],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Handle to the parent window of the modal dialog box.","pos":[135223,135275]},{"pos":[135285,135292],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function after displaying any modal dialog box.","pos":[135296,135353]},{"content":"You must call this function so that the container can enable any top-level windows disabled by <ph id=\"ph1\">`PreModalDialog`</ph>.","pos":[135354,135466],"source":" You must call this function so that the container can enable any top-level windows disabled by `PreModalDialog`."},{"content":"This function should be paired with a call to <ph id=\"ph1\">`PreModalDialog`</ph>.","pos":[135467,135530],"source":" This function should be paired with a call to `PreModalDialog`."},{"pos":[135540,135611],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__premodaldialog\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::PreModalDialog","linkify":"<a name=\"colecontrol__premodaldialog\"></a>  COleControl::PreModalDialog","source":"<a name=\"colecontrol__premodaldialog\"></a>  COleControl::PreModalDialog"},{"content":"Notifies the container that a modal dialog box is about to be displayed.","pos":[135615,135687]},{"pos":[135757,135767],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Handle to the parent window of the modal dialog box.","pos":[135787,135839]},{"pos":[135849,135856],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function before displaying any modal dialog box.","pos":[135860,135918]},{"content":"You must call this function so that the container can disable all its top-level windows.","pos":[135919,136007]},{"content":"After the modal dialog box has been displayed, you must then call <ph id=\"ph1\">`PostModalDialog`</ph>.","pos":[136008,136092],"source":" After the modal dialog box has been displayed, you must then call `PostModalDialog`."},{"pos":[136102,136187],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__recreatecontrolwindow\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::RecreateControlWindow","linkify":"<a name=\"colecontrol__recreatecontrolwindow\"></a>  COleControl::RecreateControlWindow","source":"<a name=\"colecontrol__recreatecontrolwindow\"></a>  COleControl::RecreateControlWindow"},{"content":"Destroys and re-creates the control's window.","pos":[136191,136236]},{"pos":[136291,136298],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This may be necessary if you need to change the window's style bits.","pos":[136302,136370]},{"pos":[136380,136437],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__refresh\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::Refresh","linkify":"<a name=\"colecontrol__refresh\"></a>  COleControl::Refresh","source":"<a name=\"colecontrol__refresh\"></a>  COleControl::Refresh"},{"content":"Forces a repaint of the OLE control.","pos":[136441,136477]},{"pos":[136518,136525],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function is supported by the <ph id=\"ph1\">`COleControl`</ph> base class as a stock method, called Refresh.","pos":[136529,136622],"source":"This function is supported by the `COleControl` base class as a stock method, called Refresh."},{"content":"This allows users of your OLE control to repaint the control at a specific time.","pos":[136623,136703]},{"content":"For more information on this method, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Methods<ept id=\"p1\">](../../mfc/mfc-activex-controls-methods.md)</ept>.","pos":[136704,136828],"source":" For more information on this method, see the article [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md)."},{"pos":[136838,136909],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__releasecapture\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ReleaseCapture","linkify":"<a name=\"colecontrol__releasecapture\"></a>  COleControl::ReleaseCapture","source":"<a name=\"colecontrol__releasecapture\"></a>  COleControl::ReleaseCapture"},{"content":"Releases mouse capture.","pos":[136913,136936]},{"pos":[136984,136996],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[137000,137035]},{"pos":[137045,137052],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If the control currently has the mouse capture, the capture is released.","pos":[137056,137128]},{"content":"Otherwise, this function has no effect.","pos":[137129,137168]},{"pos":[137178,137239],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__releasedc\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ReleaseDC","linkify":"<a name=\"colecontrol__releasedc\"></a>  COleControl::ReleaseDC","source":"<a name=\"colecontrol__releasedc\"></a>  COleControl::ReleaseDC"},{"content":"Releases the display device context of a container of a windowless control, freeing the device context for use by other applications.","pos":[137243,137376]},{"pos":[137426,137436],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Identifies the container device context to be released.","pos":[137449,137504]},{"pos":[137514,137526],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[137530,137565]},{"pos":[137575,137582],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[137586,137670],"content":"The application must call <ph id=\"ph1\">`ReleaseDC`</ph> for each call to <bpt id=\"p1\">[</bpt>GetDC<ept id=\"p1\">](#colecontrol__getdc)</ept>.","source":"The application must call `ReleaseDC` for each call to [GetDC](#colecontrol__getdc)."},{"pos":[137680,137765],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__reparentcontrolwindow\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ReparentControlWindow","linkify":"<a name=\"colecontrol__reparentcontrolwindow\"></a>  COleControl::ReparentControlWindow","source":"<a name=\"colecontrol__reparentcontrolwindow\"></a>  COleControl::ReparentControlWindow"},{"content":"Sets the parent of the control.","pos":[137769,137800]},{"pos":[137905,137915],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>hWndOuter<ept id=\"p1\">*</ept>","pos":[137919,137930],"source":"*hWndOuter*"},{"content":"The handle of the control window.","pos":[137934,137967]},{"content":"The handle of the new parent window.","pos":[137990,138026]},{"pos":[138036,138043],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to reset the parent of the control window.","pos":[138047,138108]},{"pos":[138118,138191],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__resetstockprops\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ResetStockProps","linkify":"<a name=\"colecontrol__resetstockprops\"></a>  COleControl::ResetStockProps","source":"<a name=\"colecontrol__resetstockprops\"></a>  COleControl::ResetStockProps"},{"pos":[138195,138279],"content":"Initializes the state of the <ph id=\"ph1\">`COleControl`</ph> stock properties to their default values.","source":"Initializes the state of the `COleControl` stock properties to their default values."},{"pos":[138328,138335],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The properties are: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, hWnd, and Text.","pos":[138339,138445]},{"content":"For a description of stock properties, see <bpt id=\"p1\">[</bpt>ActiveX Controls: Adding Stock Properties<ept id=\"p1\">](../../mfc/mfc-activex-controls-adding-stock-properties.md)</ept>.","pos":[138446,138592],"source":" For a description of stock properties, see [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md)."},{"content":"You can improve a control's binary initialization performance by using <ph id=\"ph1\">`ResetStockProps`</ph> and <ph id=\"ph2\">`ResetVersion`</ph> to override <ph id=\"ph3\">`COleControl::OnResetState`</ph>.","pos":[138599,138747],"source":"You can improve a control's binary initialization performance by using `ResetStockProps` and `ResetVersion` to override `COleControl::OnResetState`."},{"content":"See the example below.","pos":[138748,138770]},{"content":"For further information on optimizing initialization, see <bpt id=\"p1\">[</bpt>ActiveX Controls: Optimization<ept id=\"p1\">](../../mfc/mfc-activex-controls-optimization.md)</ept>.","pos":[138771,138910],"source":" For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md)."},{"pos":[138920,138927],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[138931,139019],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#7<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]"},{"pos":[139029,139096],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__resetversion\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ResetVersion","linkify":"<a name=\"colecontrol__resetversion\"></a>  COleControl::ResetVersion","source":"<a name=\"colecontrol__resetversion\"></a>  COleControl::ResetVersion"},{"content":"Initializes the version number to specified value.","pos":[139100,139150]},{"pos":[139218,139228],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The version number to be assigned to the control.","pos":[139254,139303]},{"pos":[139313,139320],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can improve a control's binary initialization performance by using <ph id=\"ph1\">`ResetVersion`</ph> and <ph id=\"ph2\">`ResetStockProps`</ph> to override <ph id=\"ph3\">`COleControl::OnResetState`</ph>.","pos":[139324,139472],"source":"You can improve a control's binary initialization performance by using `ResetVersion` and `ResetStockProps` to override `COleControl::OnResetState`."},{"content":"See the example at <bpt id=\"p1\">[</bpt>ResetStockProps<ept id=\"p1\">](#colecontrol__resetstockprops)</ept>.","pos":[139473,139541],"source":" See the example at [ResetStockProps](#colecontrol__resetstockprops)."},{"content":"For further information on optimizing initialization, see <bpt id=\"p1\">[</bpt>ActiveX Controls: Optimization<ept id=\"p1\">](../../mfc/mfc-activex-controls-optimization.md)</ept>.","pos":[139542,139681],"source":" For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md)."},{"pos":[139691,139758],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__scrollwindow\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ScrollWindow","linkify":"<a name=\"colecontrol__scrollwindow\"></a>  COleControl::ScrollWindow","source":"<a name=\"colecontrol__scrollwindow\"></a>  COleControl::ScrollWindow"},{"content":"Allows a windowless OLE object to scroll an area within its in-place active image on the screen.","pos":[139762,139858]},{"pos":[139995,140005],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies the amount, in device units, of horizontal scrolling.","pos":[140022,140085]},{"content":"This parameter must be a negative value to scroll to the left.","pos":[140086,140148]},{"content":"Specifies the amount, in device units, of vertical scrolling.","pos":[140168,140229]},{"content":"This parameter must be a negative value to scroll upward.","pos":[140230,140287]},{"content":"Points to a <bpt id=\"p1\">[</bpt>CRect<ept id=\"p1\">](../../atl-mfc-shared/reference/crect-class.md)</ept> object or RECT structure that specifies the portion of the OLE object's client area to scroll, in client coordinates of the containing window.","pos":[140306,140515],"source":" Points to a [CRect](../../atl-mfc-shared/reference/crect-class.md) object or RECT structure that specifies the portion of the OLE object's client area to scroll, in client coordinates of the containing window."},{"content":"If <ph id=\"ph1\">`lpRect`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the entire OLE object's client area is scrolled.","pos":[140516,140589],"source":" If `lpRect` is **NULL**, the entire OLE object's client area is scrolled."},{"content":"Points to a <ph id=\"ph1\">`CRect`</ph> object or <ph id=\"ph2\">`RECT`</ph> structure that specifies the rectangle to clip to.","pos":[140612,140699],"source":" Points to a `CRect` object or `RECT` structure that specifies the rectangle to clip to."},{"content":"Only pixels inside the rectangle are scrolled.","pos":[140700,140746]},{"content":"Bits outside the rectangle are not affected even if they are in the <ph id=\"ph1\">`lpRect`</ph> rectangle.","pos":[140747,140834],"source":" Bits outside the rectangle are not affected even if they are in the `lpRect` rectangle."},{"content":"If <ph id=\"ph1\">`lpClipRect`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, no clipping is performed on the scroll rectangle.","pos":[140835,140913],"source":" If `lpClipRect` is **NULL**, no clipping is performed on the scroll rectangle."},{"pos":[140923,140998],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__selectfontobject\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SelectFontObject","linkify":"<a name=\"colecontrol__selectfontobject\"></a>  COleControl::SelectFontObject","source":"<a name=\"colecontrol__selectfontobject\"></a>  COleControl::SelectFontObject"},{"content":"Selects a font into a device context.","pos":[141002,141039]},{"pos":[141135,141145],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to a device context object.","pos":[141158,141193]},{"content":"Reference to the <bpt id=\"p1\">[</bpt>CFontHolder<ept id=\"p1\">](../../mfc/reference/cfontholder-class.md)</ept> object representing the font to be selected.","pos":[141216,141333],"source":" Reference to the [CFontHolder](../../mfc/reference/cfontholder-class.md) object representing the font to be selected."},{"pos":[141343,141355],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to the previously selected font.","pos":[141359,141401]},{"content":"When the caller has finished all drawing operations that use <bpt id=\"p1\">*</bpt>fontHolder,<ept id=\"p1\">*</ept> it should reselect the previously selected font by passing it as a parameter to <bpt id=\"p2\">[</bpt>CDC::SelectObject<ept id=\"p2\">](../../mfc/reference/cdc-class.md#cdc__selectobject)</ept>.","pos":[141402,141629],"source":" When the caller has finished all drawing operations that use *fontHolder,* it should reselect the previously selected font by passing it as a parameter to [CDC::SelectObject](../../mfc/reference/cdc-class.md#cdc__selectobject)."},{"pos":[141639,141712],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__selectstockfont\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SelectStockFont","linkify":"<a name=\"colecontrol__selectstockfont\"></a>  COleControl::SelectStockFont","source":"<a name=\"colecontrol__selectstockfont\"></a>  COleControl::SelectStockFont"},{"content":"Selects the stock Font property into a device context.","pos":[141716,141770]},{"pos":[141829,141839],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The device context into which the font will be selected.","pos":[141852,141908]},{"pos":[141918,141930],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to the previously selected <ph id=\"ph1\">`CFont`</ph> object.","pos":[141934,141986],"source":"A pointer to the previously selected `CFont` object."},{"content":"You should use <bpt id=\"p1\">[</bpt>CDC::SelectObject<ept id=\"p1\">](../../mfc/reference/cdc-class.md#cdc__selectobject)</ept> to select this font back into the device context when you are finished.","pos":[141987,142145],"source":" You should use [CDC::SelectObject](../../mfc/reference/cdc-class.md#cdc__selectobject) to select this font back into the device context when you are finished."},{"pos":[142155,142228],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__serializeextent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SerializeExtent","linkify":"<a name=\"colecontrol__serializeextent\"></a>  COleControl::SerializeExtent","source":"<a name=\"colecontrol__serializeextent\"></a>  COleControl::SerializeExtent"},{"content":"Serializes or initializes the state of the display space allotted to the control.","pos":[142232,142313]},{"pos":[142374,142384],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A <ph id=\"ph1\">`CArchive`</ph> object to serialize to or from.","pos":[142396,142440],"source":" A `CArchive` object to serialize to or from."},{"pos":[142450,142457],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can improve a control's binary persistence performance by using <ph id=\"ph1\">`SerializeExtent`</ph>, <ph id=\"ph2\">`SerializeStockProps`</ph>, and <ph id=\"ph3\">`SerializeVersion`</ph> to override <bpt id=\"p1\">**</bpt>COleControl::Serialize<ept id=\"p1\">**</ept>.","pos":[142461,142633],"source":"You can improve a control's binary persistence performance by using `SerializeExtent`, `SerializeStockProps`, and `SerializeVersion` to override **COleControl::Serialize**."},{"content":"See the example below.","pos":[142634,142656]},{"content":"For further information on optimizing initialization, see <bpt id=\"p1\">[</bpt>ActiveX Controls: Optimization<ept id=\"p1\">](../../mfc/mfc-activex-controls-optimization.md)</ept>.","pos":[142657,142796],"source":" For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md)."},{"pos":[142806,142813],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[142817,142905],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#8<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]"},{"pos":[142915,142996],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__serializestockprops\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SerializeStockProps","linkify":"<a name=\"colecontrol__serializestockprops\"></a>  COleControl::SerializeStockProps","source":"<a name=\"colecontrol__serializestockprops\"></a>  COleControl::SerializeStockProps"},{"pos":[143000,143155],"content":"Serializes or initializes the state of the <ph id=\"ph1\">`COleControl`</ph> stock properties: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, and Text.","source":"Serializes or initializes the state of the `COleControl` stock properties: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, and Text."},{"pos":[143220,143230],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A <ph id=\"ph1\">`CArchive`</ph> object to serialize to or from.","pos":[143242,143286],"source":" A `CArchive` object to serialize to or from."},{"pos":[143296,143303],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[143307,143453],"content":"For a description of stock properties, see <bpt id=\"p1\">[</bpt>ActiveX Controls: Adding Stock Properties<ept id=\"p1\">](../../mfc/mfc-activex-controls-adding-stock-properties.md)</ept>.","source":"For a description of stock properties, see [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md)."},{"content":"You can improve a control's binary persistence performance by using <ph id=\"ph1\">`SerializeStockProps`</ph>, <ph id=\"ph2\">`SerializeExtent`</ph>, and <ph id=\"ph3\">`SerializeVersion`</ph> to override <bpt id=\"p1\">**</bpt>COleControl::Serialize<ept id=\"p1\">**</ept>.","pos":[143460,143632],"source":"You can improve a control's binary persistence performance by using `SerializeStockProps`, `SerializeExtent`, and `SerializeVersion` to override **COleControl::Serialize**."},{"content":"For an example, see the code at <bpt id=\"p1\">[</bpt>SerializeExtent<ept id=\"p1\">](#colecontrol__serializeextent)</ept>.","pos":[143633,143714],"source":" For an example, see the code at [SerializeExtent](#colecontrol__serializeextent)."},{"content":"For further information on optimizing initialization, see <bpt id=\"p1\">[</bpt>ActiveX Controls: Optimization<ept id=\"p1\">](../../mfc/mfc-activex-controls-optimization.md)</ept>.","pos":[143715,143854],"source":" For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md)."},{"pos":[143864,143939],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__serializeversion\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SerializeVersion","linkify":"<a name=\"colecontrol__serializeversion\"></a>  COleControl::SerializeVersion","source":"<a name=\"colecontrol__serializeversion\"></a>  COleControl::SerializeVersion"},{"content":"Serializes or initializes the state of a control's version information.","pos":[143943,144014]},{"pos":[144136,144146],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A <ph id=\"ph1\">`CArchive`</ph> object to serialize to or from.","pos":[144158,144202],"source":" A `CArchive` object to serialize to or from."},{"content":"The current version number of the control.","pos":[144231,144273]},{"content":"Indicates whether persistent data should be converted to the latest format when it is saved, or maintained in the same format it had when it was loaded.","pos":[144294,144446]},{"pos":[144456,144468],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The version number of the control.","pos":[144472,144506]},{"content":"If the specified archive is loading, <ph id=\"ph1\">`SerializeVersion`</ph> returns the version loaded from that archive.","pos":[144507,144608],"source":" If the specified archive is loading, `SerializeVersion` returns the version loaded from that archive."},{"content":"Otherwise, it returns the currently loaded version.","pos":[144609,144660]},{"pos":[144670,144677],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can improve a control's binary persistence performance by using <ph id=\"ph1\">`SerializeVersion`</ph>, <ph id=\"ph2\">`SerializeExtent`</ph>, and <ph id=\"ph3\">`SerializeStockProps`</ph> to override <bpt id=\"p1\">**</bpt>COleControl::Serialize<ept id=\"p1\">**</ept>.","pos":[144681,144853],"source":"You can improve a control's binary persistence performance by using `SerializeVersion`, `SerializeExtent`, and `SerializeStockProps` to override **COleControl::Serialize**."},{"content":"For an example, see the code at <bpt id=\"p1\">[</bpt>SerializeExtent<ept id=\"p1\">](#colecontrol__serializeextent)</ept>.","pos":[144854,144935],"source":" For an example, see the code at [SerializeExtent](#colecontrol__serializeextent)."},{"content":"For further information on optimizing initialization, see <bpt id=\"p1\">[</bpt>ActiveX Controls: Optimization<ept id=\"p1\">](../../mfc/mfc-activex-controls-optimization.md)</ept>.","pos":[144936,145075],"source":" For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md)."},{"pos":[145085,145154],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setappearance\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetAppearance","linkify":"<a name=\"colecontrol__setappearance\"></a>  COleControl::SetAppearance","source":"<a name=\"colecontrol__setappearance\"></a>  COleControl::SetAppearance"},{"content":"Sets the stock Appearance property value of your control.","pos":[145158,145215]},{"pos":[145280,145290],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>sAppearance<ept id=\"p1\">*</ept>","pos":[145294,145307],"source":"*sAppearance*"},{"content":"A <bpt id=\"p1\">**</bpt>short<ept id=\"p1\">**</ept> ( <ph id=\"ph1\">`VT_I2`</ph>) value to be used for the appearance of your control.","pos":[145311,145386],"source":" A **short** ( `VT_I2`) value to be used for the appearance of your control."},{"content":"A value of zero sets the control's appearance to flat and a value of 1 sets the control's appearance to 3D.","pos":[145387,145494]},{"pos":[145504,145511],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[145515,145629],"content":"For more about stock properties, see <bpt id=\"p1\">[</bpt>ActiveX Controls: Properties<ept id=\"p1\">](../../mfc/mfc-activex-controls-properties.md)</ept>.","source":"For more about stock properties, see [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md)."},{"pos":[145639,145706],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setbackcolor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetBackColor","linkify":"<a name=\"colecontrol__setbackcolor\"></a>  COleControl::SetBackColor","source":"<a name=\"colecontrol__setbackcolor\"></a>  COleControl::SetBackColor"},{"content":"Sets the stock BackColor property value of your control.","pos":[145710,145766]},{"pos":[145833,145843],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>dwBackColor<ept id=\"p1\">*</ept>","pos":[145847,145860],"source":"*dwBackColor*"},{"content":"An <bpt id=\"p1\">**</bpt>OLE_COLOR<ept id=\"p1\">**</ept> value to be used for background drawing of your control.","pos":[145864,145937],"source":" An **OLE_COLOR** value to be used for background drawing of your control."},{"pos":[145947,145954],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[145958,146125],"content":"For more information on using this property and other related properties, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Properties<ept id=\"p1\">](../../mfc/mfc-activex-controls-properties.md)</ept>.","source":"For more information on using this property and other related properties, see the article [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md)."},{"pos":[146135,146206],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setborderstyle\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetBorderStyle","linkify":"<a name=\"colecontrol__setborderstyle\"></a>  COleControl::SetBorderStyle","source":"<a name=\"colecontrol__setborderstyle\"></a>  COleControl::SetBorderStyle"},{"content":"Sets the stock BorderStyle property value of your control.","pos":[146210,146268]},{"pos":[146334,146344],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>sBorderStyle<ept id=\"p1\">*</ept>","pos":[146348,146362],"source":"*sBorderStyle*"},{"content":"The new border style for the control; 0 indicates no border and 1 indicates a normal border.","pos":[146366,146458]},{"pos":[146468,146475],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[146479,146556],"content":"The control window will then be re-created and <ph id=\"ph1\">`OnBorderStyleChanged`</ph> called.","source":"The control window will then be re-created and `OnBorderStyleChanged` called."},{"pos":[146566,146629],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setcapture\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetCapture","linkify":"<a name=\"colecontrol__setcapture\"></a>  COleControl::SetCapture","source":"<a name=\"colecontrol__setcapture\"></a>  COleControl::SetCapture"},{"content":"Causes the control's container window to take possession of the mouse capture on the control's behalf.","pos":[146633,146735]},{"pos":[146780,146792],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[146796,146873],"content":"A pointer to the <bpt id=\"p1\">**</bpt>CWnd<ept id=\"p1\">**</ept> window object that previously received mouse input.","source":"A pointer to the **CWnd** window object that previously received mouse input."},{"pos":[146883,146890],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If the control is activated and windowless, this function causes the control's container window to take possession of the mouse capture, on the control's behalf.","pos":[146894,147055]},{"content":"Otherwise, this function causes the control itself to take possession of the mouse capture (same as <ph id=\"ph1\">`CWnd::SetCapture`</ph>).","pos":[147056,147176],"source":" Otherwise, this function causes the control itself to take possession of the mouse capture (same as `CWnd::SetCapture`)."},{"pos":[147186,147257],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setcontrolsize\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetControlSize","linkify":"<a name=\"colecontrol__setcontrolsize\"></a>  COleControl::SetControlSize","source":"<a name=\"colecontrol__setcontrolsize\"></a>  COleControl::SetControlSize"},{"content":"Sets the size of the OLE control window and notifies the container that the control site is changing.","pos":[147261,147362]},{"pos":[147429,147439],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies the new width of the control in pixels.","pos":[147451,147500]},{"content":"Specifies the new height of the control in pixels.","pos":[147515,147565]},{"pos":[147575,147587],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the call was successful; otherwise 0.","pos":[147591,147639]},{"pos":[147649,147656],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function should not be used in your control's constructor.","pos":[147660,147723]},{"content":"Note that all coordinates for control windows are relative to the upper-left corner of the control.","pos":[147730,147829]},{"pos":[147839,147902],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setenabled\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetEnabled","linkify":"<a name=\"colecontrol__setenabled\"></a>  COleControl::SetEnabled","source":"<a name=\"colecontrol__setenabled\"></a>  COleControl::SetEnabled"},{"content":"Sets the stock Enabled property value of your control.","pos":[147906,147960]},{"pos":[148017,148027],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\"> **</bpt>TRUE<ept id=\"p1\">**</ept> if the control is to be enabled; otherwise <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","pos":[148044,148107],"source":" **TRUE** if the control is to be enabled; otherwise **FALSE**."},{"pos":[148117,148124],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[148128,148187],"content":"After setting this property, <bpt id=\"p1\">**</bpt>OnEnabledChange<ept id=\"p1\">**</ept> is called.","source":"After setting this property, **OnEnabledChange** is called."},{"pos":[148197,148256],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setfocus\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetFocus","linkify":"<a name=\"colecontrol__setfocus\"></a>  COleControl::SetFocus","source":"<a name=\"colecontrol__setfocus\"></a>  COleControl::SetFocus"},{"content":"Causes the control's container window to take possession of the input focus on the control's behalf.","pos":[148260,148360]},{"pos":[148403,148415],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[148419,148535],"content":"A pointer to the <bpt id=\"p1\">**</bpt>CWnd<ept id=\"p1\">**</ept> window object that previously had the input focus, or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> if there is no such window.","source":"A pointer to the **CWnd** window object that previously had the input focus, or **NULL** if there is no such window."},{"pos":[148545,148552],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If the control is activated and windowless, this function causes the control's container window to take possession of the input focus, on the control's behalf.","pos":[148556,148715]},{"content":"The input focus directs keyboard input to the container's window, and the container dispatches all subsequent keyboard messages to the OLE object that calls <ph id=\"ph1\">`SetFocus`</ph>.","pos":[148716,148884],"source":" The input focus directs keyboard input to the container's window, and the container dispatches all subsequent keyboard messages to the OLE object that calls `SetFocus`."},{"content":"Any window that previously had the input focus loses it.","pos":[148885,148941]},{"pos":[148948,149087],"content":"If the control is not windowless, this function causes the control itself to take possession of the input focus (same as <ph id=\"ph1\">`CWnd::SetFocus`</ph>).","source":"If the control is not windowless, this function causes the control itself to take possession of the input focus (same as `CWnd::SetFocus`)."},{"pos":[149097,149154],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setfont\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetFont","linkify":"<a name=\"colecontrol__setfont\"></a>  COleControl::SetFont","source":"<a name=\"colecontrol__setfont\"></a>  COleControl::SetFont"},{"content":"Sets the stock Font property of your control.","pos":[149158,149203]},{"pos":[149264,149274],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pFontDisp<ept id=\"p1\">*</ept>","pos":[149278,149289],"source":"*pFontDisp*"},{"content":"A pointer to a Font dispatch interface.","pos":[149293,149332]},{"pos":[149342,149409],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setforecolor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetForeColor","linkify":"<a name=\"colecontrol__setforecolor\"></a>  COleControl::SetForeColor","source":"<a name=\"colecontrol__setforecolor\"></a>  COleControl::SetForeColor"},{"content":"Sets the stock ForeColor property value of your control.","pos":[149413,149469]},{"pos":[149536,149546],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>dwForeColor<ept id=\"p1\">*</ept>","pos":[149550,149563],"source":"*dwForeColor*"},{"content":"An <bpt id=\"p1\">**</bpt>OLE_COLOR<ept id=\"p1\">**</ept> value to be used for foreground drawing of your control.","pos":[149567,149640],"source":" An **OLE_COLOR** value to be used for foreground drawing of your control."},{"pos":[149650,149657],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[149661,149828],"content":"For more information on using this property and other related properties, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Properties<ept id=\"p1\">](../../mfc/mfc-activex-controls-properties.md)</ept>.","source":"For more information on using this property and other related properties, see the article [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md)."},{"pos":[149838,149923],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setinitialdataformats\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetInitialDataFormats","linkify":"<a name=\"colecontrol__setinitialdataformats\"></a>  COleControl::SetInitialDataFormats","source":"<a name=\"colecontrol__setinitialdataformats\"></a>  COleControl::SetInitialDataFormats"},{"content":"Called by the framework to initialize the list of data formats supported by the control.","pos":[149927,150015]},{"pos":[150078,150085],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[150089,150189],"content":"The default implementation specifies two formats: <ph id=\"ph1\">`CF_METAFILEPICT`</ph> and the persistent property set.","source":"The default implementation specifies two formats: `CF_METAFILEPICT` and the persistent property set."},{"pos":[150199,150270],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setinitialsize\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetInitialSize","linkify":"<a name=\"colecontrol__setinitialsize\"></a>  COleControl::SetInitialSize","source":"<a name=\"colecontrol__setinitialsize\"></a>  COleControl::SetInitialSize"},{"content":"Sets the size of an OLE control when first displayed in a container.","pos":[150274,150342]},{"pos":[150415,150425],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The initial width of the OLE control in pixels.","pos":[150437,150484]},{"content":"The initial height of the OLE control in pixels.","pos":[150499,150547]},{"pos":[150557,150564],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function in your constructor to set the initial size of your control.","pos":[150568,150647]},{"content":"The initial size is measured in device units, or pixels.","pos":[150648,150704]},{"content":"It is recommended that this call be made in your control's constructor.","pos":[150705,150776]},{"pos":[150786,150859],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setmodifiedflag\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetModifiedFlag","linkify":"<a name=\"colecontrol__setmodifiedflag\"></a>  COleControl::SetModifiedFlag","source":"<a name=\"colecontrol__setmodifiedflag\"></a>  COleControl::SetModifiedFlag"},{"content":"Changes the modified state of a control.","pos":[150863,150903]},{"pos":[150973,150983],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The new value for the control's modified flag.","pos":[151002,151048]},{"content":"<bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> indicates that the control's state has been modified; <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> indicates that the control's state has just been saved.","pos":[151049,151177],"source":"**TRUE** indicates that the control's state has been modified; **FALSE** indicates that the control's state has just been saved."},{"pos":[151187,151194],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function whenever a change occurs that would affect your control's persistent state.","pos":[151198,151292]},{"content":"For example, if the value of a persistent property changes, call this function with <ph id=\"ph1\">`bModified`</ph><bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>.","pos":[151293,151397],"source":" For example, if the value of a persistent property changes, call this function with `bModified`**TRUE**."},{"pos":[151407,151480],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setnotpermitted\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetNotPermitted","linkify":"<a name=\"colecontrol__setnotpermitted\"></a>  COleControl::SetNotPermitted","source":"<a name=\"colecontrol__setnotpermitted\"></a>  COleControl::SetNotPermitted"},{"content":"Indicates that an edit request has failed.","pos":[151484,151526]},{"pos":[151575,151582],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function when <ph id=\"ph1\">`BoundPropertyRequestEdit`</ph> fails.","pos":[151586,151643],"source":"Call this function when `BoundPropertyRequestEdit` fails."},{"content":"This function throws an exception of type <bpt id=\"p1\">**</bpt>COleDispScodeException<ept id=\"p1\">**</ept> to indicate that the set operation was not permitted.","pos":[151644,151766],"source":" This function throws an exception of type **COleDispScodeException** to indicate that the set operation was not permitted."},{"pos":[151776,151849],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setnotsupported\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetNotSupported","linkify":"<a name=\"colecontrol__setnotsupported\"></a>  COleControl::SetNotSupported","source":"<a name=\"colecontrol__setnotsupported\"></a>  COleControl::SetNotSupported"},{"content":"Prevents modification to a control's property value by the user.","pos":[151853,151917]},{"pos":[151966,151973],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function in place of the Set function of any property where modification of the property value by the control's user is not supported.","pos":[151977,152121]},{"content":"One example would be a property that is read only.","pos":[152122,152172]},{"pos":[152182,152261],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__setrectincontainer\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetRectInContainer","linkify":"<a name=\"colecontrol__setrectincontainer\"></a>  COleControl::SetRectInContainer","source":"<a name=\"colecontrol__setrectincontainer\"></a>  COleControl::SetRectInContainer"},{"content":"Sets the coordinates of the control's rectangle relative to the container, expressed in device units.","pos":[152265,152366]},{"pos":[152432,152442],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a rectangle containing the control's new coordinates relative to the container.","pos":[152458,152550]},{"pos":[152560,152572],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the call was successful; otherwise 0.","pos":[152576,152624]},{"pos":[152634,152641],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[152645,152750],"content":"If the control is open, it is resized; otherwise the container's <bpt id=\"p1\">**</bpt>OnPosRectChanged<ept id=\"p1\">**</ept> function is called.","source":"If the control is open, it is resized; otherwise the container's **OnPosRectChanged** function is called."},{"pos":[152760,152817],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__settext\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::SetText","linkify":"<a name=\"colecontrol__settext\"></a>  COleControl::SetText","source":"<a name=\"colecontrol__settext\"></a>  COleControl::SetText"},{"content":"Sets the value of your control's stock Caption or Text property.","pos":[152821,152885]},{"pos":[152941,152951],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a character string.","pos":[152968,153000]},{"pos":[153010,153017],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Note that the stock Caption and Text properties are both mapped to the same value.","pos":[153021,153103]},{"content":"This means that any changes made to either property will automatically change both properties.","pos":[153104,153198]},{"content":"In general, a control should support either the stock Caption or Text property, but not both.","pos":[153199,153292]},{"pos":[153302,153365],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__throwerror\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::ThrowError","linkify":"<a name=\"colecontrol__throwerror\"></a>  COleControl::ThrowError","source":"<a name=\"colecontrol__throwerror\"></a>  COleControl::ThrowError"},{"content":"Signals the occurrence of an error in your control.","pos":[153369,153420]},{"pos":[153625,153635],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The status code value to be reported.","pos":[153647,153684]},{"content":"For a complete list of possible codes, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Advanced Topics<ept id=\"p1\">](../../mfc/mfc-activex-controls-advanced-topics.md)</ept>.","pos":[153685,153827],"source":" For a complete list of possible codes, see the article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md)."},{"content":"The string resource ID of the exception to be reported.","pos":[153854,153909]},{"content":"The help ID of the topic to be reported on.","pos":[153929,153972]},{"content":"A string containing an explanation of the exception to be reported.","pos":[153999,154066]},{"pos":[154076,154083],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function should only be called from within a Get or Set function for an OLE property, or the implementation of an OLE automation method.","pos":[154087,154228]},{"content":"If you need to signal errors that occur at other times, you should fire the stock Error event.","pos":[154229,154323]},{"pos":[154333,154406],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__transformcoords\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::TransformCoords","linkify":"<a name=\"colecontrol__transformcoords\"></a>  COleControl::TransformCoords","source":"<a name=\"colecontrol__transformcoords\"></a>  COleControl::TransformCoords"},{"pos":[154410,154499],"content":"Transforms coordinate values between <bpt id=\"p1\">**</bpt>HIMETRIC<ept id=\"p1\">**</ept> units and the container's native units.","source":"Transforms coordinate values between **HIMETRIC** units and the container's native units."},{"pos":[154623,154633],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>lpptlHimetric<ept id=\"p1\">*</ept>","pos":[154637,154652],"source":"*lpptlHimetric*"},{"content":"Pointer to a <bpt id=\"p1\">**</bpt>POINTL<ept id=\"p1\">**</ept> structure containing coordinates in <bpt id=\"p2\">**</bpt>HIMETRIC<ept id=\"p2\">**</ept> units.","pos":[154656,154735],"source":" Pointer to a **POINTL** structure containing coordinates in **HIMETRIC** units."},{"content":"<bpt id=\"p1\">*</bpt>lpptfContainer<ept id=\"p1\">*</ept>","pos":[154742,154758],"source":"*lpptfContainer*"},{"content":"Pointer to a <bpt id=\"p1\">**</bpt>POINTF<ept id=\"p1\">**</ept> structure containing coordinates in the container's unit size.","pos":[154762,154848],"source":" Pointer to a **POINTF** structure containing coordinates in the container's unit size."},{"content":"A combination of the following values:","pos":[154866,154904]},{"pos":[154912,154965],"content":"<bpt id=\"p1\">**</bpt>XFORMCOORDS_POSITION<ept id=\"p1\">**</ept> A position in the container.","source":"**XFORMCOORDS_POSITION** A position in the container."},{"pos":[154973,155018],"content":"<bpt id=\"p1\">**</bpt>XFORMCOORDS_SIZE<ept id=\"p1\">**</ept> A size in the container.","source":"**XFORMCOORDS_SIZE** A size in the container."},{"pos":[155026,155116],"content":"<bpt id=\"p1\">**</bpt>XFORMCOORDS_HIMETRICTOCONTAINER<ept id=\"p1\">**</ept> Transform <bpt id=\"p2\">**</bpt>HIMETRIC<ept id=\"p2\">**</ept> units to the container's units.","source":"**XFORMCOORDS_HIMETRICTOCONTAINER** Transform **HIMETRIC** units to the container's units."},{"pos":[155124,155214],"content":"<bpt id=\"p1\">**</bpt>XFORMCOORDS_CONTAINERTOHIMETRIC<ept id=\"p1\">**</ept> Transform the container's units to <bpt id=\"p2\">**</bpt>HIMETRIC<ept id=\"p2\">**</ept> units.","source":"**XFORMCOORDS_CONTAINERTOHIMETRIC** Transform the container's units to **HIMETRIC** units."},{"pos":[155224,155231],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The first two flags, <bpt id=\"p1\">**</bpt>XFORMCOORDS_POSITION<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>XFORMCOORDS_SIZE<ept id=\"p2\">**</ept>, indicate whether the coordinates should be treated as a position or a size.","pos":[155235,155382],"source":"The first two flags, **XFORMCOORDS_POSITION** and **XFORMCOORDS_SIZE**, indicate whether the coordinates should be treated as a position or a size."},{"content":"The remaining two flags indicate the direction of transformation.","pos":[155383,155448]},{"pos":[155458,155529],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__translatecolor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::TranslateColor","linkify":"<a name=\"colecontrol__translatecolor\"></a>  COleControl::TranslateColor","source":"<a name=\"colecontrol__translatecolor\"></a>  COleControl::TranslateColor"},{"pos":[155533,155677],"content":"Converts a color value from the <bpt id=\"p1\">**</bpt>OLE_COLOR<ept id=\"p1\">**</ept> data type to the <bpt id=\"p2\">[</bpt>COLORREF<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/dd183449)</ept> data type.","source":"Converts a color value from the **OLE_COLOR** data type to the [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) data type."},{"pos":[155780,155790],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A <bpt id=\"p1\">**</bpt>OLE_COLOR<ept id=\"p1\">**</ept> data type.","pos":[155808,155834],"source":" A **OLE_COLOR** data type."},{"content":"For more information, see the Windows <bpt id=\"p1\">[</bpt>OleTranslateColor<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694353)</ept> function.","pos":[155835,155962],"source":" For more information, see the Windows [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353) function."},{"content":"A handle to an optional palette; can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[155979,156028],"source":" A handle to an optional palette; can be **NULL**."},{"pos":[156038,156050],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[156054,156190],"content":"An RGB (red, green, blue) 32-bit color value that defines the solid color closest to the <ph id=\"ph1\">`clrColor`</ph> value that the device can represent.","source":"An RGB (red, green, blue) 32-bit color value that defines the solid color closest to the `clrColor` value that the device can represent."},{"pos":[156200,156207],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[156211,156380],"content":"This function is useful to translate the stock ForeColor and BackColor properties to <bpt id=\"p1\">**</bpt>COLORREF<ept id=\"p1\">**</ept> types used by <bpt id=\"p2\">[</bpt>CDC<ept id=\"p2\">](../../mfc/reference/cdc-class.md)</ept> member functions.","source":"This function is useful to translate the stock ForeColor and BackColor properties to **COLORREF** types used by [CDC](../../mfc/reference/cdc-class.md) member functions."},{"pos":[156390,156491],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__willambientsbevalidduringload\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::WillAmbientsBeValidDuringLoad","linkify":"<a name=\"colecontrol__willambientsbevalidduringload\"></a>  COleControl::WillAmbientsBeValidDuringLoad","source":"<a name=\"colecontrol__willambientsbevalidduringload\"></a>  COleControl::WillAmbientsBeValidDuringLoad"},{"content":"Determines whether your control should use the values of ambient properties as default values, when it is subsequently loaded from its persistent state.","pos":[156495,156647]},{"pos":[156710,156722],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero indicates that ambient properties will be valid; otherwise ambient properties will not be valid.","pos":[156726,156830]},{"pos":[156840,156847],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In some containers, your control may not have access to its ambient properties during the initial call to the override of <ph id=\"ph1\">`COleControl::DoPropExchange`</ph>.","pos":[156851,157003],"source":"In some containers, your control may not have access to its ambient properties during the initial call to the override of `COleControl::DoPropExchange`."},{"content":"This is the case if the container calls <bpt id=\"p1\">[</bpt>IPersistStreamInit::Load<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680730)</ept> or <bpt id=\"p2\">[</bpt>IPersistStorage::Load<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms680557)</ept> prior to calling <bpt id=\"p3\">[</bpt>IOleObject::SetClientSite<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/ms684013)</ept> (that is, if it does not honor the <bpt id=\"p4\">**</bpt>OLEMISC_SETCLIENTSITEFIRST<ept id=\"p4\">**</ept> status bit).","pos":[157004,157401],"source":" This is the case if the container calls [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) or [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) prior to calling [IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (that is, if it does not honor the **OLEMISC_SETCLIENTSITEFIRST** status bit)."},{"pos":[157411,157474],"content":"<bpt id=\"p1\">&lt;a name=\"colecontrol__windowproc\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleControl::WindowProc","linkify":"<a name=\"colecontrol__windowproc\"></a>  COleControl::WindowProc","source":"<a name=\"colecontrol__windowproc\"></a>  COleControl::WindowProc"},{"pos":[157478,157534],"content":"Provides a Windows procedure for a <ph id=\"ph1\">`COleControl`</ph> object.","source":"Provides a Windows procedure for a `COleControl` object."},{"pos":[157648,157658],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies the Windows message to be processed.","pos":[157675,157721]},{"content":"Provides additional information used in processing the message.","pos":[157740,157803]},{"content":"The parameter value depends on the message.","pos":[157804,157847]},{"content":"Provides additional information used in processing the message.","pos":[157866,157929]},{"content":"The parameter value depends on the message.","pos":[157930,157973]},{"pos":[157983,157995],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The return value of the message dispatched.","pos":[157999,158042]},{"pos":[158052,158059],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Call this function to dispatch specific messages through the control's message map.","pos":[158063,158146]},{"pos":[158155,158163],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>MFC Sample CIRC3<ept id=\"p1\">](../../visual-cpp-samples.md)</ept><ph id=\"ph1\"> </ph>","pos":[158167,158215],"source":"[MFC Sample CIRC3](../../visual-cpp-samples.md) "},{"content":"<bpt id=\"p1\"> [</bpt>MFC Sample TESTHELP<ept id=\"p1\">](../../visual-cpp-samples.md)</ept><ph id=\"ph1\"> </ph>","pos":[158218,158270],"source":" [MFC Sample TESTHELP](../../visual-cpp-samples.md) "},{"content":"<bpt id=\"p1\"> [</bpt>COlePropertyPage Class<ept id=\"p1\">](../../mfc/reference/colepropertypage-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[158273,158346],"source":" [COlePropertyPage Class](../../mfc/reference/colepropertypage-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CWnd Class<ept id=\"p1\">](../../mfc/reference/cwnd-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[158349,158398],"source":" [CWnd Class](../../mfc/reference/cwnd-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[158401,158450],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CFontHolder Class<ept id=\"p1\">](../../mfc/reference/cfontholder-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[158453,158516],"source":" [CFontHolder Class](../../mfc/reference/cfontholder-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CPictureHolder Class<ept id=\"p1\">](../../mfc/reference/cpictureholder-class.md)</ept>","pos":[158519,158587],"source":" [CPictureHolder Class](../../mfc/reference/cpictureholder-class.md)"}],"content":"---\ntitle: \"COleControl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleControl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE controls, MFC\"\n  - \"windowless controls, MFC\"\n  - \"windowless controls\"\n  - \"controls [MFC], OLE\"\n  - \"controls [MFC], windowless\"\n  - \"COleControl class\"\nms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123\ncaps.latest.revision: 25\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleControl Class\nA powerful base class for developing OLE controls.  \n  \n## Syntax  \n  \n```  \nclass COleControl : public CWnd  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleControl::COleControl](#colecontrol__colecontrol)|Creates a `COleControl` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleControl::AmbientAppearance](#colecontrol__ambientappearance)|Retrieves the current appearance of the control.|  \n|[COleControl::AmbientBackColor](#colecontrol__ambientbackcolor)|Returns the value of the ambient BackColor property.|  \n|[COleControl::AmbientDisplayName](#colecontrol__ambientdisplayname)|Returns the name of the control as specified by the container.|  \n|[COleControl::AmbientFont](#colecontrol__ambientfont)|Returns the value of the ambient Font property.|  \n|[COleControl::AmbientForeColor](#colecontrol__ambientforecolor)|Returns the value of the ambient ForeColor property.|  \n|[COleControl::AmbientLocaleID](#colecontrol__ambientlocaleid)|Returns the container's locale ID.|  \n|[COleControl::AmbientScaleUnits](#colecontrol__ambientscaleunits)|Returns the type of units used by the container.|  \n|[COleControl::AmbientShowGrabHandles](#colecontrol__ambientshowgrabhandles)|Determines if grab handles should be displayed.|  \n|[COleControl::AmbientShowHatching](#colecontrol__ambientshowhatching)|Determines if hatching should be displayed.|  \n|[COleControl::AmbientTextAlign](#colecontrol__ambienttextalign)|Returns the type of text alignment specified by the container.|  \n|[COleControl::AmbientUIDead](#colecontrol__ambientuidead)|Determines if the control should respond to user-interface actions.|  \n|[COleControl::AmbientUserMode](#colecontrol__ambientusermode)|Determines the mode of the container.|  \n|[COleControl::BoundPropertyChanged](#colecontrol__boundpropertychanged)|Notifies the container that a bound property has been changed.|  \n|[COleControl::BoundPropertyRequestEdit](#colecontrol__boundpropertyrequestedit)|Requests permission to edit the property value.|  \n|[COleControl::ClientToParent](#colecontrol__clienttoparent)|Translates a point relative to the control's origin to a point relative to its container's origin.|  \n|[COleControl::ClipCaretRect](#colecontrol__clipcaretrect)|Adjusts a caret rectangle if it is overlapped by a control.|  \n|[COleControl::ControlInfoChanged](#colecontrol__controlinfochanged)|Call this function after the set of mnemonics handled by the control has changed.|  \n|[COleControl::DisplayError](#colecontrol__displayerror)|Displays stock Error events to the control's user.|  \n|[COleControl::DoClick](#colecontrol__doclick)|Implementation of the stock `DoClick` method.|  \n|[COleControl::DoPropExchange](#colecontrol__dopropexchange)|Serializes the properties of a `COleControl` object.|  \n|[COleControl::DoSuperclassPaint](#colecontrol__dosuperclasspaint)|Redraws an OLE control that has been subclassed from a Windows control.|  \n|[COleControl::EnableSimpleFrame](#colecontrol__enablesimpleframe)|Enables simple frame support for a control.|  \n|[COleControl::ExchangeExtent](#colecontrol__exchangeextent)|Serializes the control's width and height.|  \n|[COleControl::ExchangeStockProps](#colecontrol__exchangestockprops)|Serializes the control's stock properties.|  \n|[COleControl::ExchangeVersion](#colecontrol__exchangeversion)|Serializes the control's version number.|  \n|[COleControl::FireClick](#colecontrol__fireclick)|Fires the stock `Click` event.|  \n|[COleControl::FireDblClick](#colecontrol__firedblclick)|Fires the stock `DblClick` event.|  \n|[COleControl::FireError](#colecontrol__fireerror)|Fires the stock `Error` event.|  \n|[COleControl::FireEvent](#colecontrol__fireevent)|Fires a custom event.|  \n|[COleControl::FireKeyDown](#colecontrol__firekeydown)|Fires the stock `KeyDown` event.|  \n|[COleControl::FireKeyPress](#colecontrol__firekeypress)|Fires the stock `KeyPress` event.|  \n|[COleControl::FireKeyUp](#colecontrol__firekeyup)|Fires the stock `KeyUp` event.|  \n|[COleControl::FireMouseDown](#colecontrol__firemousedown)|Fires the stock `MouseDown` event.|  \n|[COleControl::FireMouseMove](#colecontrol__firemousemove)|Fires the stock `MouseMove` event.|  \n|[COleControl::FireMouseUp](#colecontrol__firemouseup)|Fires the stock `MouseUp` event.|  \n|[COleControl::FireReadyStateChange](#colecontrol__firereadystatechange)|Fires an event when the control's ready state changes.|  \n|[COleControl::GetActivationPolicy](#colecontrol__getactivationpolicy)|Alters the default activation behavior of a control that supports the `IPointerInactive` interface.|  \n|[COleControl::GetAmbientProperty](#colecontrol__getambientproperty)|Returns the value of the specified ambient property.|  \n|[COleControl::GetAppearance](#colecontrol__getappearance)|Returns the value of the stock Appearance property.|  \n|[COleControl::GetBackColor](#colecontrol__getbackcolor)|Returns the value of the stock BackColor property.|  \n|[COleControl::GetBorderStyle](#colecontrol__getborderstyle)|Returns the value of the stock BorderStyle property.|  \n|[COleControl::GetCapture](#colecontrol__getcapture)|Determines whether a windowless, activated control object has the mouse capture.|  \n|[COleControl::GetClassID](#colecontrol__getclassid)|Retrieves the OLE class ID of the control.|  \n|[COleControl::GetClientOffset](#colecontrol__getclientoffset)|Retrieves the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area.|  \n|[COleControl::GetClientRect](#colecontrol__getclientrect)|Retrieves the size of the control's client area.|  \n|[COleControl::GetClientSite](#colecontrol__getclientsite)|Queries an object for the pointer to its current client site within its container.|  \n|[COleControl::GetControlFlags](#colecontrol__getcontrolflags)|Retrieves the control flag settings.|  \n|[COleControl::GetControlSize](#colecontrol__getcontrolsize)|Returns the position and size of the OLE control.|  \n|[COleControl::GetDC](#colecontrol__getdc)|Provides a means for a windowless control to get a device context from its container.|  \n|[COleControl::GetEnabled](#colecontrol__getenabled)|Returns the value of the stock Enabled property.|  \n|[COleControl::GetExtendedControl](#colecontrol__getextendedcontrol)|Retrieves a pointer to an extended control object belonging to the container.|  \n|[COleControl::GetFocus](#colecontrol__getfocus)|Determines whether the control has the focus.|  \n|[COleControl::GetFont](#colecontrol__getfont)|Returns the value of the stock Font property.|  \n|[COleControl::GetFontTextMetrics](#colecontrol__getfonttextmetrics)|Returns the metrics of a `CFontHolder` object.|  \n|[COleControl::GetForeColor](#colecontrol__getforecolor)|Returns the value of the stock ForeColor property.|  \n|[COleControl::GetHwnd](#colecontrol__gethwnd)|Returns the value of the stock hWnd property.|  \n|[COleControl::GetMessageString](#colecontrol__getmessagestring)|Provides status bar text for a menu item.|  \n|[COleControl::GetNotSupported](#colecontrol__getnotsupported)|Prevents access to a control's property value by the user.|  \n|[COleControl::GetReadyState](#colecontrol__getreadystate)|Returns the control's readiness state.|  \n|[COleControl::GetRectInContainer](#colecontrol__getrectincontainer)|Returns the control's rectangle relative to its container.|  \n|[COleControl::GetStockTextMetrics](#colecontrol__getstocktextmetrics)|Returns the metrics of the stock Font property.|  \n|[COleControl::GetText](#colecontrol__gettext)|Returns the value of the stock Text or Caption property.|  \n|[COleControl::GetWindowlessDropTarget](#colecontrol__getwindowlessdroptarget)|Override to allow a windowless control to be the target of drag and drop operations.|  \n|[COleControl::InitializeIIDs](#colecontrol__initializeiids)|Informs the base class of the IIDs the control will use.|  \n|[COleControl::InternalGetFont](#colecontrol__internalgetfont)|Returns a `CFontHolder` object for the stock Font property.|  \n|[COleControl::InternalGetText](#colecontrol__internalgettext)|Retrieves the stock Caption or Text property.|  \n|[COleControl::InternalSetReadyState](#colecontrol__internalsetreadystate)|Sets the control's readiness state and fires the ready-state-change event.|  \n|[COleControl::InvalidateControl](#colecontrol__invalidatecontrol)|Invalidates an area of the displayed control, causing it to be redrawn.|  \n|[COleControl::InvalidateRgn](#colecontrol__invalidatergn)|Invalidates the container window's client area within the given region. Can be used to redraw windowless controls in the region.|  \n|[COleControl::IsConvertingVBX](#colecontrol__isconvertingvbx)|Allows specialized loading of an OLE control.|  \n|[COleControl::IsModified](#colecontrol__ismodified)|Determines if the control state has changed.|  \n|[COleControl::IsOptimizedDraw](#colecontrol__isoptimizeddraw)|Indicates whether the container supports optimized drawing for the current drawing operation.|  \n|[COleControl::IsSubclassedControl](#colecontrol__issubclassedcontrol)|Called to determine if the control subclasses a Windows control.|  \n|[COleControl::Load](#colecontrol__load)|Resets any previous asynchronous data and initiates a new load of the control's asynchronous property.|  \n|[COleControl::LockInPlaceActive](#colecontrol__lockinplaceactive)|Determines if your control can be deactivated by the container.|  \n|[COleControl::OnAmbientPropertyChange](#colecontrol__onambientpropertychange)|Called when an ambient property is changed.|  \n|[COleControl::OnAppearanceChanged](#colecontrol__onappearancechanged)|Called when the stock Appearance property is changed.|  \n|[COleControl::OnBackColorChanged](#colecontrol__onbackcolorchanged)|Called when the stock BackColor property is changed.|  \n|[COleControl::OnBorderStyleChanged](#colecontrol__onborderstylechanged)|Called when the stock BorderStyle property is changed.|  \n|[COleControl::OnClick](#colecontrol__onclick)|Called to fire the stock Click event.|  \n|[COleControl::OnClose](#colecontrol__onclose)|Notifies the control that `IOleControl::Close` has been called.|  \n|[COleControl::OnDoVerb](#colecontrol__ondoverb)|Called after a control verb has been executed.|  \n|[COleControl::OnDraw](#colecontrol__ondraw)|Called when a control is requested to redraw itself.|  \n|[COleControl::OnDrawMetafile](#colecontrol__ondrawmetafile)|Called by the container when a control is requested to redraw itself using a metafile device context.|  \n|[COleControl::OnEdit](#colecontrol__onedit)|Called by the container to UI Activate an OLE control.|  \n|[COleControl::OnEnabledChanged](#colecontrol__onenabledchanged)|Called when the stock Enabled property is changed.|  \n|[COleControl::OnEnumVerbs](#colecontrol__onenumverbs)|Called by the container to enumerate a control's verbs.|  \n|[COleControl::OnEventAdvise](#colecontrol__oneventadvise)|Called when event handlers are connected or disconnected from a control.|  \n|[COleControl::OnFontChanged](#colecontrol__onfontchanged)|Called when the stock Font property is changed.|  \n|[COleControl::OnForeColorChanged](#colecontrol__onforecolorchanged)|Called when the stock ForeColor property is changed.|  \n|[COleControl::OnFreezeEvents](#colecontrol__onfreezeevents)|Called when a control's events are frozen or unfrozen.|  \n|[COleControl::OnGetColorSet](#colecontrol__ongetcolorset)|Notifies the control that `IOleObject::GetColorSet` has been called.|  \n|[COleControl::OnGetControlInfo](#colecontrol__ongetcontrolinfo)|Provides mnemonic information to the container.|  \n|[COleControl::OnGetDisplayString](#colecontrol__ongetdisplaystring)|Called to obtain a string to represent a property value.|  \n|[COleControl::OnGetInPlaceMenu](#colecontrol__ongetinplacemenu)|Requests the handle of the control's menu that will be merged with the container menu.|  \n|[COleControl::OnGetNaturalExtent](#colecontrol__ongetnaturalextent)|Override to retrieve the control's display size closest to the proposed size and extent mode.|  \n|[COleControl::OnGetPredefinedStrings](#colecontrol__ongetpredefinedstrings)|Returns strings representing possible values for a property.|  \n|[COleControl::OnGetPredefinedValue](#colecontrol__ongetpredefinedvalue)|Returns the value corresponding to a predefined string.|  \n|[COleControl::OnGetViewExtent](#colecontrol__ongetviewextent)|Override to retrieve the size of the control's display areas (can be used to enable two-pass drawing).|  \n|[COleControl::OnGetViewRect](#colecontrol__ongetviewrect)|Override to convert control's size into a rectangle starting at a specific position.|  \n|[COleControl::OnGetViewStatus](#colecontrol__ongetviewstatus)|Override to retrieve the control's view status.|  \n|[COleControl::OnHideToolBars](#colecontrol__onhidetoolbars)|Called by the container when the control is UI deactivated.|  \n|[COleControl::OnInactiveMouseMove](#colecontrol__oninactivemousemove)|Override to have the container for the inactive control under the mouse pointer dispatch `WM_MOUSEMOVE` messages to the control.|  \n|[COleControl::OnInactiveSetCursor](#colecontrol__oninactivesetcursor)|Override to have the container for the inactive control under the mouse pointer dispatch `WM_SETCURSOR` messages to the control.|  \n|[COleControl::OnKeyDownEvent](#colecontrol__onkeydownevent)|Called after the stock KeyDown event has been fired.|  \n|[COleControl::OnKeyPressEvent](#colecontrol__onkeypressevent)|Called after the stock KeyPress event has been fired.|  \n|[COleControl::OnKeyUpEvent](#colecontrol__onkeyupevent)|Called after the stock KeyUp event has been fired.|  \n|[COleControl::OnMapPropertyToPage](#colecontrol__onmappropertytopage)|Indicates which property page to use for editing a property.|  \n|[COleControl::OnMnemonic](#colecontrol__onmnemonic)|Called when a mnemonic key of the control has been pressed.|  \n|[COleControl::OnProperties](#colecontrol__onproperties)|Called when the control's \"Properties\" verb has been invoked.|  \n|[COleControl::OnQueryHitPoint](#colecontrol__onqueryhitpoint)|Override to query whether a control's display overlaps a given point.|  \n|[COleControl::OnQueryHitRect](#colecontrol__onqueryhitrect)|Override to query whether a control's display overlaps any point in a given rectangle.|  \n|[COleControl::OnRenderData](#colecontrol__onrenderdata)|Called by the framework to retrieve data in the specified format.|  \n|[COleControl::OnRenderFileData](#colecontrol__onrenderfiledata)|Called by the framework to retrieve data from a file in the specified format.|  \n|[COleControl::OnRenderGlobalData](#colecontrol__onrenderglobaldata)|Called by the framework to retrieve data from global memory in the specified format.|  \n|[COleControl::OnResetState](#colecontrol__onresetstate)|Resets a control's properties to the default values.|  \n|[COleControl::OnSetClientSite](#colecontrol__onsetclientsite)|Notifies the control that `IOleControl::SetClientSite` has been called.|  \n|[COleControl::OnSetData](#colecontrol__onsetdata)|Replaces the control's data with another value.|  \n|[COleControl::OnSetExtent](#colecontrol__onsetextent)|Called after the control's extent has changed.|  \n|[COleControl::OnSetObjectRects](#colecontrol__onsetobjectrects)|Called after the control's dimensions have been changed.|  \n|[COleControl::OnShowToolBars](#colecontrol__onshowtoolbars)|Called when the control has been UI activated.|  \n|[COleControl::OnTextChanged](#colecontrol__ontextchanged)|Called when the stock Text or Caption property is changed.|  \n|[COleControl::OnWindowlessMessage](#colecontrol__onwindowlessmessage)|Processes window messages (other than mouse and keyboard messages) for windowless controls.|  \n|[COleControl::ParentToClient](#colecontrol__parenttoclient)|Translates a point relative to the container's origin to a point relative to the control's origin.|  \n|[COleControl::PostModalDialog](#colecontrol__postmodaldialog)|Notifies the container that a modal dialog box has been closed.|  \n|[COleControl::PreModalDialog](#colecontrol__premodaldialog)|Notifies the container that a modal dialog box is about to be displayed.|  \n|[COleControl::RecreateControlWindow](#colecontrol__recreatecontrolwindow)|Destroys and re-creates the control's window.|  \n|[COleControl::Refresh](#colecontrol__refresh)|Forces a repaint of a control's appearance.|  \n|[COleControl::ReleaseCapture](#colecontrol__releasecapture)|Releases mouse capture.|  \n|[COleControl::ReleaseDC](#colecontrol__releasedc)|Releases the display device context of a container of a windowless control.|  \n|[COleControl::ReparentControlWindow](#colecontrol__reparentcontrolwindow)|Resets the parent of the control window.|  \n|[COleControl::ResetStockProps](#colecontrol__resetstockprops)|Initializes `COleControl` stock properties to their default values.|  \n|[COleControl::ResetVersion](#colecontrol__resetversion)|Initializes the version number to a given value.|  \n|[COleControl::ScrollWindow](#colecontrol__scrollwindow)|Allows a windowless control to scroll an area within its in-place active image on the display.|  \n|[COleControl::SelectFontObject](#colecontrol__selectfontobject)|Selects a custom Font property into a device context.|  \n|[COleControl::SelectStockFont](#colecontrol__selectstockfont)|Selects the stock Font property into a device context.|  \n|[COleControl::SerializeExtent](#colecontrol__serializeextent)|Serializes or initializes the display space for the control.|  \n|[COleControl::SerializeStockProps](#colecontrol__serializestockprops)|Serializes or initializes the `COleControl` stock properties.|  \n|[COleControl::SerializeVersion](#colecontrol__serializeversion)|Serializes or initializes the control's version information.|  \n|[COleControl::SetAppearance](#colecontrol__setappearance)|Sets the value of the stock Appearance property.|  \n|[COleControl::SetBackColor](#colecontrol__setbackcolor)|Sets the value of the stock BackColor property.|  \n|[COleControl::SetBorderStyle](#colecontrol__setborderstyle)|Sets the value of the stock BorderStyle property.|  \n|[COleControl::SetCapture](#colecontrol__setcapture)|Causes the control's container window to take possession of the mouse capture on the control's behalf.|  \n|[COleControl::SetControlSize](#colecontrol__setcontrolsize)|Sets the position and size of the OLE control.|  \n|[COleControl::SetEnabled](#colecontrol__setenabled)|Sets the value of the stock Enabled property.|  \n|[COleControl::SetFocus](#colecontrol__setfocus)|Causes the control's container window to take possession of the input focus on the control's behalf.|  \n|[COleControl::SetFont](#colecontrol__setfont)|Sets the value of the stock Font property.|  \n|[COleControl::SetForeColor](#colecontrol__setforecolor)|Sets the value of the stock ForeColor property.|  \n|[COleControl::SetInitialSize](#colecontrol__setinitialsize)|Sets the size of an OLE control when first displayed in a container.|  \n|[COleControl::SetModifiedFlag](#colecontrol__setmodifiedflag)|Changes the modified state of a control.|  \n|[COleControl::SetNotPermitted](#colecontrol__setnotpermitted)|Indicates that an edit request has failed.|  \n|[COleControl::SetNotSupported](#colecontrol__setnotsupported)|Prevents modification to a control's property value by the user.|  \n|[COleControl::SetRectInContainer](#colecontrol__setrectincontainer)|Sets the control's rectangle relative to its container.|  \n|[COleControl::SetText](#colecontrol__settext)|Sets the value of the stock Text or Caption property.|  \n|[COleControl::ThrowError](#colecontrol__throwerror)|Signals that an error has occurred in an OLE control.|  \n|[COleControl::TransformCoords](#colecontrol__transformcoords)|Transforms coordinate values between a container and the control.|  \n|[COleControl::TranslateColor](#colecontrol__translatecolor)|Converts an **OLE_COLOR** value to a **COLORREF** value.|  \n|[COleControl::WillAmbientsBeValidDuringLoad](#colecontrol__willambientsbevalidduringload)|Determines whether ambient properties will be available the next time the control is loaded.|  \n|[COleControl::WindowProc](#colecontrol__windowproc)|Provides a Windows procedure for a `COleControl` object.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleControl::DrawContent](#colecontrol__drawcontent)|Called by the framework when the control's appearance needs to be updated.|  \n|[COleControl::DrawMetafile](#colecontrol__drawmetafile)|Called by the framework when the metafile device context is being used.|  \n|[COleControl::IsInvokeAllowed](#colecontrol__isinvokeallowed)|Enables automation method invocation.|  \n|[COleControl::SetInitialDataFormats](#colecontrol__setinitialdataformats)|Called by the framework to initialize the list of data formats supported by the control.|  \n  \n## Remarks  \n Derived from `CWnd`, this class inherits all the functionality of a Windows window object plus additional functionality specific to OLE, such as event firing and the ability to support methods and properties.  \n  \n OLE controls can be inserted into OLE container applications and communicate with the container by using a two-way system of event firing and exposing methods and properties to the container. Note that standard OLE containers only support the basic functionality of an OLE control. They are unable to support extended features of an OLE control. Event firing occurs when events are sent to the container as a result of certain actions taking place in the control. In turn, the container communicates with the control by using an exposed set of methods and properties analogous to the member functions and data members of a C++ class. This approach allows the developer to control the appearance of the control and notify the container when certain actions occur.  \n  \n## Windowless Controls  \n OLE controls can be used in-place active without a window. Windowless controls have significant advantages:  \n  \n-   Windowless controls can be transparent and non-rectangular  \n  \n-   Windowless controls reduce instance size and creation time of the object  \n  \n Controls do not need a window. Services that a window offers can easily be provided via a single shared window (usually the container's) and a bit of dispatching code. Having a window is mostly an unnecessary complication on the object.  \n  \n When windowless activation is used, the container (which does have a window) is responsible for providing services that would otherwise have been provided by the control's own window. For example, if your control needs to query the keyboard focus, query the mouse capture, or obtain a device context, these operations are managed by the container. The `COleControl`[windowless-operation member functions](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) invoke these operations on the container.  \n  \n When windowless activation is enabled, the container delegates input messages to the control's `IOleInPlaceObjectWindowless` interface (an extension of [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) for windowless support). `COleControl`'s implementation of this interface will dispatch these messages through your control's message map, after adjusting the mouse coordinates appropriately. You can process these messages like ordinary window messages, by adding the corresponding entries to the message map.  \n  \n In a windowless control, you should always use the `COleControl` member functions instead of the corresponding `CWnd` member functions or their related Windows API functions.  \n  \n OLE control objects can also create a window only when they become active, but the amount of work needed for the inactive-active transition goes up and the speed of the transition goes down. There are cases when this is a problem: as an example, consider a grid of text boxes. When cursoring up and down through the column, each control must be in-place activated and then deactivated. The speed of the inactive/active transition will directly affect the scrolling speed.  \n  \n For more information on developing an OLE control framework, see the articles [MFC ActiveX Controls](../../mfc/mfc-activex-controls.md) and [Overview: Creating an MFC ActiveX Control Program](../../mfc/reference/mfc-activex-control-wizard.md). For information on optimizing OLE controls, including windowless and flicker-free controls, see [MFC ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n `COleControl`  \n  \n## Requirements  \n **Header:** afxctl.h  \n  \n##  <a name=\"colecontrol__ambientbackcolor\"></a>  COleControl::AmbientBackColor  \n Returns the value of the ambient BackColor property.  \n  \n```  \nOLE_COLOR AmbientBackColor();\n```  \n  \n### Return Value  \n The current value of the container's ambient BackColor property, if any. If the property is not supported, this function returns the system-defined Windows background color.  \n  \n### Remarks  \n The ambient BackColor property is available to all controls and is defined by the container. Note that the container is not required to support this property.  \n  \n##  <a name=\"colecontrol__ambientdisplayname\"></a>  COleControl::AmbientDisplayName  \n The name the container has assigned to the control can be used in error messages displayed to the user.  \n  \n```  \nCString AmbientDisplayName();\n```  \n  \n### Return Value  \n The name of the OLE control. The default is a zero-length string.  \n  \n### Remarks  \n Note that the container is not required to support this property.  \n  \n##  <a name=\"colecontrol__ambientfont\"></a>  COleControl::AmbientFont  \n Returns the value of the ambient Font property.  \n  \n```  \nLPFONTDISP AmbientFont();\n```  \n  \n### Return Value  \n A pointer to the container's ambient Font dispatch interface. The default value is **NULL**. If the return is not equal to **NULL**, you are responsible for releasing the font by calling its [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) member function.  \n  \n### Remarks  \n The ambient Font property is defined by the container and available to all controls.Note that the container is not required to support this property.  \n  \n##  <a name=\"colecontrol__ambientforecolor\"></a>  COleControl::AmbientForeColor  \n Returns the value of the ambient ForeColor property.  \n  \n```  \nOLE_COLOR AmbientForeColor();\n```  \n  \n### Return Value  \n The current value of the container's ambient ForeColor property, if any. If not supported, this function returns the system-defined Windows text color.  \n  \n### Remarks  \n The ambient ForeColor property is available to all controls and is defined by the container. Note that the container is not required to support this property.  \n  \n##  <a name=\"colecontrol__ambientlocaleid\"></a>  COleControl::AmbientLocaleID  \n Returns the container's locale ID.  \n  \n```  \nLCID AmbientLocaleID();\n```  \n  \n### Return Value  \n The value of the container's LocaleID property, if any. If this property is not supported, this function returns 0.  \n  \n### Remarks  \n The control can use the LocaleID to adapt its user interface for specific locales. Note that the container is not required to support this property.  \n  \n##  <a name=\"colecontrol__ambientappearance\"></a>  COleControl::AmbientAppearance  \n Retrieves the current appearance setting for the control object.  \n  \n```  \nshort AmbientAppearance();\n```  \n  \n### Return Value  \n The appearance of the control:  \n  \n- **0** Flat appearance  \n  \n- **1** 3D appearance  \n  \n### Remarks  \n Call this function to retrieve the current value of the **DISPID_AMBIENT_APPEARANCE** property for the control.  \n  \n##  <a name=\"colecontrol__ambientscaleunits\"></a>  COleControl::AmbientScaleUnits  \n Returns the type of units used by the container.  \n  \n```  \nCString AmbientScaleUnits();\n```  \n  \n### Return Value  \n A string containing the ambient ScaleUnits of the container. If this property is not supported, this function returns a zero-length string.  \n  \n### Remarks  \n The container's ambient ScaleUnits property can be used to display positions or dimensions, labeled with the chosen unit, such as twips or centimeters. Note that the container is not required to support this property.  \n  \n##  <a name=\"colecontrol__ambientshowgrabhandles\"></a>  COleControl::AmbientShowGrabHandles  \n Determines whether the container allows the control to display grab handles for itself when active.  \n  \n```  \nBOOL AmbientShowGrabHandles();\n```  \n  \n### Return Value  \n Nonzero if grab handles should be displayed; otherwise 0. If this property is not supported, this function returns nonzero.  \n  \n### Remarks  \n Note that the container is not required to support this property.  \n  \n##  <a name=\"colecontrol__ambientshowhatching\"></a>  COleControl::AmbientShowHatching  \n Determines whether the container allows the control to display itself with a hatched pattern when UI active.  \n  \n```  \nBOOL AmbientShowHatching();\n```  \n  \n### Return Value  \n Nonzero if the hatched pattern should be shown; otherwise 0. If this property is not supported, this function returns nonzero.  \n  \n### Remarks  \n Note that the container is not required to support this property.  \n  \n##  <a name=\"colecontrol__ambienttextalign\"></a>  COleControl::AmbientTextAlign  \n Determines the ambient text alignment preferred by the control container.  \n  \n```  \nshort AmbientTextAlign();\n```  \n  \n### Return Value  \n The status of the container's ambient TextAlign property. If this property is not supported, this function returns 0.  \n  \n The following is a list of valid return values:  \n  \n|Return value|Meaning|  \n|------------------|-------------|  \n|0|General alignment (numbers to the right, text to the left).|  \n|1|Left justify|  \n|2|Center|  \n|3|Right justify|  \n  \n### Remarks  \n This property is available to all embedded controls and is defined by the container. Note that the container is not required to support this property.  \n  \n##  <a name=\"colecontrol__ambientuidead\"></a>  COleControl::AmbientUIDead  \n Determines if the container wants the control to respond to user-interface actions.  \n  \n```  \nBOOL AmbientUIDead();\n```  \n  \n### Return Value  \n Nonzero if the control should respond to user-interface actions; otherwise 0. If this property is not supported, this function returns 0.  \n  \n### Remarks  \n For example, a container might set this to **TRUE** in design mode.  \n  \n##  <a name=\"colecontrol__ambientusermode\"></a>  COleControl::AmbientUserMode  \n Determines if the container is in design mode or user mode.  \n  \n```  \nBOOL AmbientUserMode();\n```  \n  \n### Return Value  \n Nonzero if the container is in user mode; otherwise 0 (in design mode). If this property is not supported, this function returns TRUE.  \n  \n### Remarks  \n For example, a container might set this to **FALSE** in design mode.  \n  \n##  <a name=\"colecontrol__boundpropertychanged\"></a>  COleControl::BoundPropertyChanged  \n Signals that the bound property value has changed.  \n  \n```  \nvoid BoundPropertyChanged(DISPID dispid);\n```  \n  \n### Parameters  \n `dispid`  \n The dispatch ID of a bound property of the control.  \n  \n### Remarks  \n This must be called every time the value of the property changes, even in cases where the change was not made through the property Set method. Be particularly aware of bound properties that are mapped to member variables. Any time such a member variable changes, `BoundPropertyChanged` must be called.  \n  \n##  <a name=\"colecontrol__boundpropertyrequestedit\"></a>  COleControl::BoundPropertyRequestEdit  \n Requests permission from the `IPropertyNotifySink` interface to change a bound property value provided by the control.  \n  \n```  \nBOOL BoundPropertyRequestEdit(DISPID dispid);\n```  \n  \n### Parameters  \n `dispid`  \n The dispatch ID of a bound property of the control.  \n  \n### Return Value  \n Nonzero if the change is permitted; otherwise 0. The default value is nonzero.  \n  \n### Remarks  \n If permission is denied, the control must not let the value of the property change. This can be done by ignoring or failing the action that attempted to change the property value.  \n  \n##  <a name=\"colecontrol__clienttoparent\"></a>  COleControl::ClientToParent  \n Translates the coordinates of `pPoint` into parent coordinates.  \n  \n```  \nvirtual void ClientToParent(\n    LPCRECT lprcBounds, LPPOINT pPoint) const;\n\n \n```  \n  \n### Parameters  \n `lprcBounds`  \n Pointer to the bounds of the OLE control within the container. Not the client area but the area of the entire control including borders and scroll bars.  \n  \n `pPoint`  \n Pointer to the OLE client area point to be translated into the coordinates of the parent (container).  \n  \n### Remarks  \n On input `pPoint` is relative to the origin of the client area of the OLE control (upper left corner of the client area of the control). On output `pPoint` is relative to the origin of the parent (upper left corner of the container).  \n  \n##  <a name=\"colecontrol__clipcaretrect\"></a>  COleControl::ClipCaretRect  \n Adjusts a caret rectangle if it is entirely or partially covered by overlapping, opaque objects.  \n  \n```  \nBOOL ClipCaretRect(LPRECT lpRect);\n```  \n  \n### Parameters  \n `lpRect`  \n On input, a pointer to a [RECT](../../mfc/reference/rect-structure1.md) structure that contains the caret area to be adjusted. On output, the adjusted caret area, or **NULL** if the caret rectangle is completely covered.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n A caret is a flashing line, block, or bitmap that typically indicates where text or graphics will be inserted.  \n  \n A windowless object cannot safely show a caret without first checking whether the caret is partially or totally hidden by overlapping objects. In order to make that possible, an object can use `ClipCaretRect` to get the caret adjusted (reduced) to ensure it fits in the clipping region.  \n  \n Objects creating a caret should submit the caret rectangle to `ClipCaretRect` and use the adjusted rectangle for the caret. If the caret is entirely hidden, this method will return **FALSE** and the caret should not be shown at all in this case.  \n  \n##  <a name=\"colecontrol__colecontrol\"></a>  COleControl::COleControl  \n Constructs a `COleControl` object.  \n  \n```  \nCOleControl();\n```  \n  \n### Remarks  \n This function is normally not called directly. Instead the OLE control is usually created by its class factory.  \n  \n##  <a name=\"colecontrol__controlinfochanged\"></a>  COleControl::ControlInfoChanged  \n Call this function when the set of mnemonics supported by the control has changed.  \n  \n```  \nvoid ControlInfoChanged();\n```  \n  \n### Remarks  \n Upon receiving this notification, the control's container obtains the new set of mnemonics by making a call to [IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730). Note that the container is not required to respond to this notification.  \n  \n##  <a name=\"colecontrol__displayerror\"></a>  COleControl::DisplayError  \n Called by the framework after the stock Error event has been handled (unless the event handler has suppressed the display of the error).  \n  \n```  \nvirtual void DisplayError(\n    SCODE scode,  \n    LPCTSTR lpszDescription,  \n    LPCTSTR lpszSource,  \n    LPCTSTR lpszHelpFile,  \n    UINT nHelpID);\n```  \n  \n### Parameters  \n *scode*  \n The status code value to be reported. For a complete list of possible codes, see the article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).  \n  \n `lpszDescription`  \n The description of the error being reported.  \n  \n *lpszSource*  \n The name of the module generating the error (typically, the name of the OLE control module).  \n  \n `lpszHelpFile`  \n The name of the help file containing a description of the error.  \n  \n `nHelpID`  \n The Help Context ID of the error being reported.  \n  \n### Remarks  \n The default behavior displays a message box containing the description of the error, contained in `lpszDescription`.  \n  \n Override this function to customize how errors are displayed.  \n  \n##  <a name=\"colecontrol__doclick\"></a>  COleControl::DoClick  \n Simulates a mouse click action on the control.  \n  \n```  \nvoid DoClick();\n```  \n  \n### Remarks  \n The overridable `COleControl::OnClick` member function will be called, and a stock Click event will be fired, if supported by the control.  \n  \n This function is supported by the `COleControl` base class as a stock method, called DoClick. For more information, see the article [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).  \n  \n##  <a name=\"colecontrol__dopropexchange\"></a>  COleControl::DoPropExchange  \n Called by the framework when loading or storing a control from a persistent storage representation, such as a stream or property set.  \n  \n```  \nvirtual void DoPropExchange(CPropExchange* pPX);\n```  \n  \n### Parameters  \n `pPX`  \n A pointer to a `CPropExchange` object. The framework supplies this object to establish the context of the property exchange, including its direction.  \n  \n### Remarks  \n This function normally makes calls to the **PX_** family of functions to load or store specific user-defined properties of an OLE control.  \n  \n If Control Wizard has been used to create the OLE control project, the overridden version of this function will serialize the stock properties supported by `COleControl` with a call to the base class function, `COleControl::DoPropExchange`. As you add user-defined properties to your OLE control you will need to modify this function to serialize your new properties. For more information on serialization, see the article [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md).  \n  \n##  <a name=\"colecontrol__dosuperclasspaint\"></a>  COleControl::DoSuperclassPaint  \n Redraws an OLE control that has been subclassed from a Windows control.  \n  \n```  \nvoid DoSuperclassPaint(\n    CDC* pDC,  \n    const CRect& rcBounds);\n```  \n  \n### Parameters  \n `pDC`  \n A pointer to the device context of the control container.  \n  \n `rcBounds`  \n The area in which the control is to be drawn.  \n  \n### Remarks  \n Call this function to properly handle the painting of a nonactive OLE control. This function should only be used if the OLE control subclasses a Windows control and should be called in the `OnDraw` function of your control.  \n  \n For more information on this function and subclassing a Windows control, see the article [ActiveX Controls: Subclassing a Windows Control](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).  \n  \n##  <a name=\"colecontrol__drawcontent\"></a>  COleControl::DrawContent  \n Called by the framework when the control's appearance needs to be updated.  \n  \n```  \nvoid DrawContent(\n    CDC* pDC,  \n    CRect& rc);\n```  \n  \n### Parameters  \n `pDC`  \n Pointer to the device context.  \n  \n `rc`  \n Rectangular area to be drawn in.  \n  \n### Remarks  \n This function directly calls the overridable `OnDraw` function.  \n  \n##  <a name=\"colecontrol__drawmetafile\"></a>  COleControl::DrawMetafile  \n Called by the framework when the metafile device context is being used.  \n  \n```  \nvoid DrawMetafile(\n    CDC* pDC,  \n    CRect& rc);\n```  \n  \n### Parameters  \n `pDC`  \n Pointer to the metafile device context.  \n  \n `rc`  \n Rectangular area to be drawn in.  \n  \n##  <a name=\"colecontrol__enablesimpleframe\"></a>  COleControl::EnableSimpleFrame  \n Enables the simple frame characteristic for an OLE control.  \n  \n```  \nvoid EnableSimpleFrame();\n```  \n  \n### Remarks  \n This characteristic allows a control to support visual containment of other controls, but not true OLE containment. An example would be a group box with several controls inside. These controls are not OLE contained, but they are in the same group box.  \n  \n##  <a name=\"colecontrol__exchangeextent\"></a>  COleControl::ExchangeExtent  \n Serializes or initializes the state of the control's extent (its dimensions in **HIMETRIC** units).  \n  \n```  \nBOOL ExchangeExtent(CPropExchange* pPX);\n```  \n  \n### Parameters  \n `pPX`  \n A pointer to a [CPropExchange](../../mfc/reference/cpropexchange-class.md) object. The framework supplies this object to establish the context of the property exchange, including its direction.  \n  \n### Return Value  \n Nonzero if the function succeeded; 0 otherwise.  \n  \n### Remarks  \n This function is normally called by the default implementation of `COleControl::DoPropExchange`.  \n  \n##  <a name=\"colecontrol__exchangestockprops\"></a>  COleControl::ExchangeStockProps  \n Serializes or initializes the state of the control's stock properties.  \n  \n```  \nvoid ExchangeStockProps(CPropExchange* pPX);\n```  \n  \n### Parameters  \n `pPX`  \n A pointer to a [CPropExchange](../../mfc/reference/cpropexchange-class.md) object. The framework supplies this object to establish the context of the property exchange, including its direction.  \n  \n### Remarks  \n This function is normally called by the default implementation of `COleControl::DoPropExchange`.  \n  \n##  <a name=\"colecontrol__exchangeversion\"></a>  COleControl::ExchangeVersion  \n Serializes or initializes the state of a control's version information.  \n  \n```  \nBOOL ExchangeVersion(\n    CPropExchange* pPX,  \n    DWORD dwVersionDefault,  \n    BOOL bConvert = TRUE);\n```  \n  \n### Parameters  \n `pPX`  \n A pointer to a `CPropExchange` object. The framework supplies this object to establish the context of the property exchange, including its direction.  \n  \n `dwVersionDefault`  \n The current version number of the control.  \n  \n `bConvert`  \n Indicates whether persistent data should be converted to the latest format when saved, or maintained in the same format that was loaded.  \n  \n### Return Value  \n Nonzero of the function succeeded; 0 otherwise.  \n  \n### Remarks  \n Typically, this will be the first function called by a control's override of `COleControl::DoPropExchange`. When loading, this function reads the version number of the persistent data, and sets the version attribute of the [CPropExchange](../../mfc/reference/cpropexchange-class.md) object accordingly. When saving, this function writes the version number of the persistent data.  \n  \n For more information on persistence and versioning, see the article [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md).  \n  \n##  <a name=\"colecontrol__fireclick\"></a>  COleControl::FireClick  \n Called by the framework when the mouse is clicked over an active control.  \n  \n```  \nvoid FireClick();\n```  \n  \n### Remarks  \n If this event is defined as a custom event, you determine when the event is fired.  \n  \n For automatic firing of a Click event to occur, the control's Event map must have a stock Click event defined.  \n  \n##  <a name=\"colecontrol__firedblclick\"></a>  COleControl::FireDblClick  \n Called by the framework when the mouse is double-clicked over an active control.  \n  \n```  \nvoid FireDblClick();\n```  \n  \n### Remarks  \n If this event is defined as a custom event, you determine when the event is fired.  \n  \n For automatic firing of a DblClick event to occur, the control's Event map must have a stock DblClick event defined.  \n  \n##  <a name=\"colecontrol__fireerror\"></a>  COleControl::FireError  \n Fires the stock Error event.  \n  \n```  \nvoid FireError(\n    SCODE scode,  \n    LPCTSTR lpszDescription,  \n    UINT nHelpID = 0);\n```  \n  \n### Parameters  \n *scode*  \n The status code value to be reported. For a complete list of possible codes, see the article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).  \n  \n `lpszDescription`  \n The description of the error being reported.  \n  \n `nHelpID`  \n The Help ID of the error being reported.  \n  \n### Remarks  \n This event provides a way of signalling, at appropriate places in your code, that an error has occurred within your control. Unlike other stock events, such as Click or MouseMove, Error is never fired by the framework.  \n  \n To report an error that occurs during a property get function, property set function, or automation method, call [COleControl::ThrowError](#colecontrol__throwerror).  \n  \n The implementation of an OLE control's Stock Error event uses an `SCODE` value. If your control uses this event, and is intended to be used in Visual Basic 4.0, you will receive errors because the `SCODE` value is not supported in Visual Basic.  \n  \n To fix this, manually change the `SCODE` parameter in the control's .ODL file to a **long**. In addition, any custom event, method, or property that uses an `SCODE` parameter also causes the same problem.  \n  \n##  <a name=\"colecontrol__fireevent\"></a>  COleControl::FireEvent  \n Fires a user-defined event from your control with any number of optional arguments,.  \n  \n```  \nvoid AFX_CDECL FireEvent(\n    DISPID dispid,  \n    BYTE* pbParams,  \n ...);\n```  \n  \n### Parameters  \n `dispid`  \n The dispatch ID of the event to be fired.  \n  \n `pbParams`  \n A descriptor for the event's parameter types.  \n  \n### Remarks  \n Usually this function should not be called directly. Instead you will call the event-firing functions in the event map section of your control's class declaration.  \n  \n The `pbParams` argument is a space-separated list of **VTS_**. One or more of these values, separated by spaces (not commas), specifies the function's parameter list. Possible values are as follows:  \n  \n|Symbol|Parameter type|  \n|------------|--------------------|  \n|**VTS_COLOR**|**OLE_COLOR**|  \n|**VTS_FONT**|**IFontDisp\\***|  \n|**VTS_HANDLE**|`HWND`|  \n|**VTS_PICTURE**|**IPictureDisp\\***|  \n|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\\***|  \n|**VTS_TRISTATE**|**OLE_TRISTATE**|  \n|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  \n|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  \n|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  \n|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  \n|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  \n|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  \n|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  \n|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  \n  \n> [!NOTE]\n>  Additional variant constants have been defined for all variant types, with the exception of **VTS_FONT** and **VTS_PICTURE**, that provide a pointer to the variant data constant. These constants are named using the **VTS_P**`constantname` convention. For example, **VTS_PCOLOR** is a pointer to a **VTS_COLOR** constant.  \n  \n##  <a name=\"colecontrol__firekeydown\"></a>  COleControl::FireKeyDown  \n Called by the framework when a key is pressed while the control is UI active.  \n  \n```  \nvoid FireKeyDown(\n    USHORT* pnChar,  \n    short nShiftState);\n```  \n  \n### Parameters  \n `pnChar`  \n Pointer to the virtual key code value of the pressed key. For a list of of standard virtual key codes, see Winuser.h  \n  \n `nShiftState`  \n Contains a combination of the following flags:  \n  \n- **SHIFT_MASK** The SHIFT key was pressed during the action.  \n  \n- **CTRL_MASK** The CTRL key was pressed during the action.  \n  \n- **ALT_MASK** The ALT key was pressed during the action.  \n  \n### Remarks  \n If this event is defined as a custom event, you determine when the event is fired.  \n  \n For automatic firing of a KeyDown event to occur, the control's Event map must have a stock KeyDown event defined.  \n  \n##  <a name=\"colecontrol__firekeypress\"></a>  COleControl::FireKeyPress  \n Called by the framework when a key is pressed and released while the custom control is UI Active within the container.  \n  \n```  \nvoid FireKeyPress(USHORT* pnChar);\n```  \n  \n### Parameters  \n `pnChar`  \n A pointer to the character value of the key pressed.  \n  \n### Remarks  \n If this event is defined as a custom event, you determine when the event is fired.  \n  \n The recipient of the event may modify `pnChar`, for example, convert all lowercase characters to uppercase. If you want to examine the modified character, override `OnKeyPressEvent`.  \n  \n For automatic firing of a KeyPress event to occur, the control's Event map must have a stock KeyPress event defined.  \n  \n##  <a name=\"colecontrol__firekeyup\"></a>  COleControl::FireKeyUp  \n Called by the framework when a key is released while the custom control is UI Active within the container.  \n  \n```  \nvoid FireKeyUp(\n    USHORT* pnChar,  \n    short nShiftState);\n```  \n  \n### Parameters  \n `pnChar`  \n Pointer to the virtual key code value of the released key. For a list of of standard virtual key codes, see Winuser.h  \n  \n `nShiftState`  \n Contains a combination of the following flags:  \n  \n- **SHIFT_MASK** The SHIFT key was pressed during the action.  \n  \n- **CTRL_MASK** The CTRL key was pressed during the action.  \n  \n- **ALT_MASK** The ALT key was pressed during the action.  \n  \n### Remarks  \n If this event is defined as a custom event, you determine when the event is fired.  \n  \n For automatic firing of a KeyUp event to occur, the control's Event map must have a stock KeyUp event defined.  \n  \n##  <a name=\"colecontrol__firemousedown\"></a>  COleControl::FireMouseDown  \n Called by the framework when a mouse button is pressed over an active custom control.  \n  \n```  \nvoid FireMouseDown(\n    short nButton,  \n    short nShiftState,  \n    OLE_XPOS_PIXELS x,  \n    OLE_YPOS_PIXELS y);\n```  \n  \n### Parameters  \n `nButton`  \n The numeric value of the mouse button pressed. It can contain one of the following values:  \n  \n- **LEFT_BUTTON** The left mouse button was pressed down.  \n  \n- **MIDDLE_BUTTON** The middle mouse button was pressed down.  \n  \n- **RIGHT_BUTTON** The right mouse button was pressed down.  \n  \n `nShiftState`  \n Contains a combination of the following flags:  \n  \n- **SHIFT_MASK** The SHIFT key was pressed during the action.  \n  \n- **CTRL_MASK** The CTRL key was pressed during the action.  \n  \n- **ALT_MASK** The ALT key was pressed during the action.  \n  \n *x*  \n The x-coordinate of the cursor when a mouse button was pressed down. The coordinate is relative to the upper-left corner of the control window.  \n  \n *y*  \n The y-coordinate of the cursor when a mouse button was pressed down. The coordinate is relative to the upper-left corner of the control window.  \n  \n### Remarks  \n If this event is defined as a custom event, you determine when the event is fired.  \n  \n For automatic firing of a MouseDown event to occur, the control's Event map must have a stock MouseDown event defined.  \n  \n##  <a name=\"colecontrol__firemousemove\"></a>  COleControl::FireMouseMove  \n Called by the framework when the cursor is moved over an active custom control.  \n  \n```  \nvoid FireMouseMove(\n    short nButton,  \n    short nShiftState,  \n    OLE_XPOS_PIXELS x,  \n    OLE_YPOS_PIXELS y);\n```  \n  \n### Parameters  \n `nButton`  \n The numeric value of the mouse buttons pressed. Contains a combination of the following values:  \n  \n- **LEFT_BUTTON** The left mouse button was pressed down during the action.  \n  \n- **MIDDLE_BUTTON** The middle mouse button was pressed down during the action.  \n  \n- **RIGHT_BUTTON** The right mouse button was pressed down during the action.  \n  \n `nShiftState`  \n Contains a combination of the following flags:  \n  \n- **SHIFT_MASK** The SHIFT key was pressed during the action.  \n  \n- **CTRL_MASK** The CTRL key was pressed during the action.  \n  \n- **ALT_MASK** The ALT key was pressed during the action.  \n  \n *x*  \n The x-coordinate of the cursor. The coordinate is relative to the upper-left corner of the control window.  \n  \n *y*  \n The y-coordinate of the cursor. The coordinate is relative to the upper-left corner of the control window.  \n  \n### Remarks  \n If this event is defined as a custom event, you determine when the event is fired.  \n  \n For automatic firing of a MouseMove event to occur, the control's Event map must have a stock MouseMove event defined.  \n  \n##  <a name=\"colecontrol__firemouseup\"></a>  COleControl::FireMouseUp  \n Called by the framework when a mouse button is released over an active custom control.  \n  \n```  \nvoid FireMouseUp(\n    short nButton,  \n    short nShiftState,  \n    OLE_XPOS_PIXELS x,  \n    OLE_YPOS_PIXELS y);\n```  \n  \n### Parameters  \n `nButton`  \n The numeric value of the mouse button released. It can have one of the following values:  \n  \n- **LEFT_BUTTON** The left mouse button was released.  \n  \n- **MIDDLE_BUTTON** The middle mouse button was released.  \n  \n- **RIGHT_BUTTON** The right mouse button was released.  \n  \n `nShiftState`  \n Contains a combination of the following flags:  \n  \n- **SHIFT_MASK** The SHIFT key was pressed during the action.  \n  \n- **CTRL_MASK** The CTRL key was pressed during the action.  \n  \n- **ALT_MASK** The ALT key was pressed during the action.  \n  \n *x*  \n The x-coordinate of the cursor when a mouse button was released. The coordinate is relative to the upper-left corner of the control window.  \n  \n *y*  \n The y-coordinate of a cursor when a mouse button was released. The coordinate is relative to the upper-left corner of the control window.  \n  \n### Remarks  \n If this event is defined as a custom event, you determine when the event is fired.  \n  \n For automatic firing of a MouseUp event to occur, the control's Event map must have a stock MouseUp event defined.  \n  \n##  <a name=\"colecontrol__firereadystatechange\"></a>  COleControl::FireReadyStateChange  \n Fires an event with the current value of the ready state of control.  \n  \n```  \nvoid FireReadyStateChange();\n```  \n  \n### Remarks  \n The ready state can be one of the following values:  \n  \n **READYSTATE_UNINITIALIZED**  \n Default initialization state  \n  \n **READYSTATE_LOADING**  \n Control is currently loading its properties  \n  \n **READYSTATE_LOADED**  \n Control has been initialized  \n  \n **READYSTATE_INTERACTIVE**  \n Control has enough data to be interactive but not all asynchronous data is yet loaded  \n  \n `READYSTATE_COMPLETE`  \n Control has all its data  \n  \n Use [GetReadyState](#colecontrol__getreadystate) to determine the control's current readiness.  \n  \n [InternalSetReadyState](#colecontrol__internalsetreadystate) changes the ready state to the value supplied, then calls `FireReadyStateChange`.  \n  \n##  <a name=\"colecontrol__getactivationpolicy\"></a>  COleControl::GetActivationPolicy  \n Alters the default activation behavior of a control that supports the `IPointerInactive` interface.  \n  \n```  \nvirtual DWORD GetActivationPolicy();\n```  \n  \n### Return Value  \n A combination of flags from the **POINTERINACTIVE** enumeration. Possible flags are:  \n  \n **POINTERINACTIVE_ACTIVATEONENTRY**  \n The object should be in-place activated when the mouse enters it during a mouse move operation.  \n  \n **POINTERINACTIVE_DEACTIVATEONLEAVE**  \n The object should be deactivated when the mouse leaves the object during a mouse move operation.  \n  \n **POINTERINACTIVE_ACTIVATEONDRAG**  \n The object should be in-place activated when the mouse is dragged over it during a drag and drop operation.  \n  \n### Remarks  \n When the `IPointerInactive` interface is enabled, the container will delegate `WM_SETCURSOR` and `WM_MOUSEMOVE` messages to it. `COleControl`'s implementation of this interface will dispatch these messages through your control's message map, after adjusting the mouse coordinates appropriately.  \n  \n Whenever the container receives a `WM_SETCURSOR` or `WM_MOUSEMOVE` message with the mouse pointer over an inactive object supporting `IPointerInactive`, it should call `GetActivationPolicy` on the interface and return flags from the **POINTERINACTIVE** enumeration.  \n  \n You can process these messages just like ordinary window messages, by adding the corresponding entries to the message map. In your handlers, avoid using the `m_hWnd` member variable (or any member functions that uses it) without first checking that its value is non- **NULL**.  \n  \n Any object intended to do more than set the mouse cursor and/or fire a mouse move event, such as give special visual feedback, should return the **POINTERINACTIVE_ACTIVATEONENTRY** flag and draw the feedback only when active. If the object returns this flag, the container should activate it in-place immediately and then forward it the same message that triggered the call to `GetActivationPolicy`.  \n  \n If both the **POINTERINACTIVE_ACTIVATEONENTRY** and **POINTERINACTIVE_DEACTIVATEONLEAVE** flags are returned, then the object will only be activated when the mouse is over the object. If only the **POINTERINACTIVE_ACTIVATEONENTRY** flag is returned, then the object will only be activated once when the mouse first enters the object.  \n  \n You may also want an inactive control to be the target of an OLE drag and drop operation. This requires activating the control at the moment the user drags an object over it, so that the control's window can be registered as a drop target. To cause activation to occur during a drag, return the **POINTERINACTIVE_ACTIVATEONDRAG** flag:  \n  \n [!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  \n  \n The information communicated by `GetActivationPolicy` should not be cached by a container. Instead, this method should be called every time the mouse enters an inactive object.  \n  \n If an inactive object does not request to be in-place activated when the mouse enters it, its container should dispatch subsequent `WM_SETCURSOR` messages to this object by calling [OnInactiveSetCursor](#colecontrol__oninactivesetcursor) as long as the mouse pointer stays over the object.  \n  \n Enabling the `IPointerInactive` interface typically means that you want the control to be capable of processing mouse messages at all times. To get this behaviour in a container that doesn't support the `IPointerInactive` interface, you will need to have your control always activated when visible, which means the control should have the **OLEMISC_ACTIVATEWHENVISIBLE** flag among its miscellaneous flags. However, to prevent this flag from taking effect in a container that does support `IPointerInactive`, you can also specify the **OLEMISC_IGNOREACTIVATEWHENVISIBLE** flag:  \n  \n [!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  \n  \n##  <a name=\"colecontrol__getambientproperty\"></a>  COleControl::GetAmbientProperty  \n Gets the value of an ambient property of the container.  \n  \n```  \nBOOL GetAmbientProperty(\n    DISPID dispid,  \n    VARTYPE vtProp,  \n    void* pvProp);\n```  \n  \n### Parameters  \n *dwDispid*  \n The dispatch ID of the desired ambient property.  \n  \n `vtProp`  \n A variant type tag that specifies the type of the value to be returned in `pvProp`.  \n  \n `pvProp`  \n A pointer to the address of the variable that will receive the property value or return value. The actual type of this pointer must match the type specified by `vtProp`.  \n  \n|vtProp|Type of pvProp|  \n|------------|--------------------|  \n|`VT_BOOL`|**BOOL\\***|  \n|`VT_BSTR`|**CString\\***|  \n|`VT_I2`|**short\\***|  \n|`VT_I4`|**long\\***|  \n|`VT_R4`|**float\\***|  \n|`VT_R8`|**double\\***|  \n|`VT_CY`|**CY\\***|  \n|**VT_COLOR**|**OLE_COLOR\\***|  \n|**VT_DISPATCH**|**LPDISPATCH\\***|  \n|**VT_FONT**|**LPFONTDISP\\***|  \n  \n### Return Value  \n Nonzero if the ambient property is supported; otherwise 0.  \n  \n### Remarks  \n If you use `GetAmbientProperty` to retrieve the ambient DisplayName and ScaleUnits properties, set `vtProp` to `VT_BSTR` and `pvProp` to **CString\\***. If you are retrieving the ambient Font property, set `vtProp` to **VT_FONT** and `pvProp` to **LPFONTDISP\\***.  \n  \n Note that functions have already been provided for common ambient properties, such as [AmbientBackColor](#colecontrol__ambientbackcolor) and [AmbientFont](#colecontrol__ambientfont).  \n  \n##  <a name=\"colecontrol__getappearance\"></a>  COleControl::GetAppearance  \n Implements the Get function of your control's stock Appearance property.  \n  \n```  \nshort GetAppearance ();\n```  \n  \n### Return Value  \n The return value specifies the current appearance setting as a **short** ( `VT_I2`) value, if successful. This value is zero if the control's appearance is flat and 1 if the control's appearance is 3D.  \n  \n##  <a name=\"colecontrol__getbackcolor\"></a>  COleControl::GetBackColor  \n Implements the Get function of your control's stock BackColor property.  \n  \n```  \nOLE_COLOR GetBackColor();\n```  \n  \n### Return Value  \n The return value specifies the current background color as a **OLE_COLOR** value, if successful. This value can be translated to a **COLORREF** value with a call to `TranslateColor`.  \n  \n##  <a name=\"colecontrol__getborderstyle\"></a>  COleControl::GetBorderStyle  \n Implements the Get function of your control's stock BorderStyle property.  \n  \n```  \nshort GetBorderStyle();\n```  \n  \n### Return Value  \n 1 if the control has a normal border; 0 if the control has no border.  \n  \n##  <a name=\"colecontrol__getcapture\"></a>  COleControl::GetCapture  \n Determines whether the `COleControl` object has the mouse capture.  \n  \n```  \nCWnd* GetCapture();\n```  \n  \n### Return Value  \n If the control is activated and windowless, returns **this** if the control currently has the mouse capture (as determined by the control's container), or **NULL** if it does not have the capture.  \n  \n Otherwise, returns the `CWnd` object that has the mouse capture (same as `CWnd::GetCapture`).  \n  \n### Remarks  \n An activated windowless control receives the mouse capture when [SetCapture](#colecontrol__setcapture) is called.  \n  \n##  <a name=\"colecontrol__getclassid\"></a>  COleControl::GetClassID  \n Called by the framework to retrieve the OLE class ID of the control.  \n  \n```  \nvirtual HRESULT GetClassID(LPCLSID pclsid) = 0;  \n```  \n  \n### Parameters  \n *pclsid*  \n Pointer to the location of the class ID.  \n  \n### Return Value  \n Nonzero if the call was not successful; otherwise 0.  \n  \n### Remarks  \n Usually implemented by the [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).  \n  \n##  <a name=\"colecontrol__getclientoffset\"></a>  COleControl::GetClientOffset  \n Retrieves the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area.  \n  \n```  \nvirtual void GetClientOffset(\n    long* pdxOffset, long* pdyOffset) const;\n\n \n```  \n  \n### Parameters  \n *pdxOffset*  \n Pointer to the horizontal offset of the OLE control's client area.  \n  \n *pdyOffset*  \n Pointer to the vertical offset of the OLE control's client area.  \n  \n### Remarks  \n The OLE control has a rectangular area within its container. The client area of the control is the control area excluding borders and scroll bars. The offset retrieved by `GetClientOffset` is the difference between the upper left corner of the control's rectangular area and the upper left corner of its client area. If your control has non-client elements other than the standard borders and scrollbars, override this member function to specify the offset.  \n  \n##  <a name=\"colecontrol__getclientrect\"></a>  COleControl::GetClientRect  \n Retrieves the size of the control's client area.  \n  \n```  \nvirtual void GetClientRect(LPRECT lpRect) const;\n\n \n```  \n  \n### Parameters  \n `lpRect`  \n Pointer to a `RECT` structure containing the dimensions of the windowless control's client area; that is, the control's size minus window borders, frames, scroll bars, and so on. The `lpRect` parameter indicates the size of the control's client rectangle, not its position.  \n  \n##  <a name=\"colecontrol__getclientsite\"></a>  COleControl::GetClientSite  \n Queries an object for the pointer to its current client site within its container.  \n  \n```  \nLPOLECLIENTSITE GetClientSite();\n```  \n  \n### Return Value  \n A pointer to the control's current client site in its container.  \n  \n### Remarks  \n The returned pointer points to an instance of `IOleClientSite`. The `IOleClientSite` interface, implemented by containers, is the object's view of its context: where it is anchored in the document, where it gets its storage, user interface, and other resources.  \n  \n##  <a name=\"colecontrol__getcontrolflags\"></a>  COleControl::GetControlFlags  \n Retrieves the control flag settings.  \n  \n```  \nvirtual DWORD GetControlFlags();\n```  \n  \n### Return Value  \n An ORed combination of the flags in the ControlFlags enumeration:  \n  \n `enum ControlFlags {`  \n  \n `fastBeginPaint = 0x0001,`  \n  \n `clipPaintDC = 0x0002,`  \n  \n `pointerInactive = 0x0004,`  \n  \n `noFlickerActivate = 0x0008,`  \n  \n `windowlessActivate = 0x0010,`  \n  \n `canOptimizeDraw = 0x0020,`  \n  \n `};`  \n  \n### Remarks  \n By default, `GetControlFlags` returns `fastBeginPaint | clipPaintDC`.  \n  \n `fastBeginPaint`  \n If set, uses a begin-paint function tailored for OLE controls instead of the [BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) API (set by default).  \n  \n `clipPaintDC`  \n If not set, disables the call to `IntersectClipRect` made by `COleControl` and gains a small speed advantage. If you are using windowless activation, the flag has no effect.  \n  \n `pointerInactive`  \n If set, provides mouse interaction while your control is inactive by enabling `COleControl`'s implementation of the `IPointerInactive` interface, which is disabled by default.  \n  \n `noFlickerActivate`  \n If set, eliminates extra drawing operations and the accompanying visual flicker. Use when your control draws itself identically in the inactive and active states. If you are using windowless activation, the flag has no effect.  \n  \n `windowlessActivate`  \n If set, indicates your control uses windowless activation.  \n  \n `canOptimizeDraw`  \n If set, indicates that the control will perform optimized drawing, if the container supports it.  \n  \n For more information about `GetControlFlags` and other optimizations of OLE controls, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).  \n  \n##  <a name=\"colecontrol__getcontrolsize\"></a>  COleControl::GetControlSize  \n Retrieves the size of the OLE control window.  \n  \n```  \nvoid GetControlSize(\n    int* pcx,  \n    int* pcy);\n```  \n  \n### Parameters  \n *pcx*  \n Specifies the width of the control in pixels.  \n  \n *pcy*  \n Specifies the height of the control in pixels.  \n  \n### Remarks  \n Note that all coordinates for control windows are relative to the upper-left corner of the control.  \n  \n##  <a name=\"colecontrol__getdc\"></a>  COleControl::GetDC  \n Provides for a windowless object to get a screen (or compatible) device context from its container.  \n  \n```  \nCDC* GetDC(\n    LPCRECT lprcRect = NULL, DWORD dwFlags = OLEDC_PAINTBKGND);\n```  \n  \n### Parameters  \n *lprcRect*  \n A pointer to the rectangle the windowless control wants to redraw, in client coordinates of the control. **NULL** means the full object's extent.  \n  \n `dwFlags`  \n Drawing attributes of the device context. Choices are:  \n  \n- **OLEDC_NODRAW** Indicates that the object won't use the device context to perform any drawing but merely to get information about the display device. The container should simply pass the window's DC without further processing.  \n  \n- **OLEDC_PAINTBKGND** Requests that the container paint the background before returning the DC. An object should use this flag if it is requesting a DC for redrawing an area with transparent background.  \n  \n- **OLEDC_OFFSCREEN** Informs the container that the object wishes to render into an off-screen bitmap that should then be copied to the screen. An object should use this flag when the drawing operation it is about to perform generates a lot of flicker. The container is free to honor this request or not. However, if this flag is not set, the container must hand back an on-screen DC. This allows objects to perform direct screen operations such as showing a selection (via an **XOR** operation).  \n  \n### Return Value  \n Pointer to the display device context for the container `CWnd` client area if successful; otherwise, the return value is **NULL**. The display device context can be used in subsequent GDI functions to draw in the client area of the container's window.  \n  \n### Remarks  \n The [ReleaseDC](#colecontrol__releasedc) member function must be called to release the context after painting. When calling `GetDC`, objects pass the rectangle they wish to draw into in their own client coordinates. `GetDC` translates these to coordinates of the container client area. The object should not request a desired drawing rectangle larger than its own client area rectangle, the size of which can be retrieved with [GetClientRect](#colecontrol__getclientrect). This prevents objects from inadvertently drawing where they are not supposed to.  \n  \n##  <a name=\"colecontrol__getenabled\"></a>  COleControl::GetEnabled  \n Implements the Get function of your control's stock Enabled property.  \n  \n```  \nBOOL GetEnabled();\n```  \n  \n### Return Value  \n Nonzero if the control is enabled; otherwise 0.  \n  \n##  <a name=\"colecontrol__getextendedcontrol\"></a>  COleControl::GetExtendedControl  \n Obtains a pointer to an object maintained by the container that represents the control with an extended set of properties.  \n  \n```  \nLPDISPATCH GetExtendedControl();\n```  \n  \n### Return Value  \n A pointer to the container's extended control object. If there is no object available, the value is **NULL**.  \n  \n This object may be manipulated through its `IDispatch` interface. You can also use `QueryInterface` to obtain other available interfaces provided by the object. However, the object is not required to support a specific set of interfaces. Note that relying on the specific features of a container's extended control object limits the portability of your control to other arbitrary containers.  \n  \n### Remarks  \n The function that calls this function is responsible for releasing the pointer when finished with the object. Note that the container is not required to support this object.  \n  \n##  <a name=\"colecontrol__getfocus\"></a>  COleControl::GetFocus  \n Determines whether the `COleControl` object has the focus.  \n  \n```  \nCWnd* GetFocus();\n```  \n  \n### Return Value  \n If the control is activated and windowless, returns **this** if the control currently has the keyboard focus (as determined by the control's container), or **NULL** if it does not have the focus.  \n  \n Otherwise, returns the `CWnd` object that has the focus (same as `CWnd::GetFocus`).  \n  \n### Remarks  \n An activated windowless control receives the focus when [SetFocus](#colecontrol__setfocus) is called.  \n  \n##  <a name=\"colecontrol__getfont\"></a>  COleControl::GetFont  \n Implements the Get function of the stock Font property.  \n  \n```  \nLPFONTDISP GetFont();\n```  \n  \n### Return Value  \n A pointer to the font dispatch interface of the control's stock Font property.  \n  \n### Remarks  \n Note that the caller must release the object when finished. Within the implementation of the control, use `InternalGetFont` to access the control's stock Font object. For more information on using fonts in your control, see the article [ActiveX Controls: Using Fonts in an ActiveX Control](../../mfc/mfc-activex-controls-using-fonts.md).  \n  \n##  <a name=\"colecontrol__getfonttextmetrics\"></a>  COleControl::GetFontTextMetrics  \n Measures the text metrics for any `CFontHolder` object owned by the control.  \n  \n```  \nvoid GetFontTextMetrics(\n    LPTEXTMETRIC lptm,  \n    CFontHolder& fontHolder);\n```  \n  \n### Parameters  \n `lptm`  \n Pointer to a [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) structure.  \n  \n `fontHolder`  \n Reference to a [CFontHolder](../../mfc/reference/cfontholder-class.md) object.  \n  \n### Remarks  \n Such a font can be selected with the [COleControl::SelectFontObject](#colecontrol__selectfontobject) function. `GetFontTextMetrics` will initialize the `TEXTMETRIC` structure pointed to by `lptm` with valid metrics information about `fontHolder`'s font if successful, or fill the structure with zeros if not successful. You should use this function instead of [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) when painting your control because controls, like any embedded OLE object, may be required to render themselves into a metafile.  \n  \n The `TEXTMETRIC` structure for the default font is refreshed when the [SelectFontObject](#colecontrol__selectfontobject) function is called. You should call `GetFontTextMetrics` only after selecting the stock Font property to assure the information it provides is valid.  \n  \n##  <a name=\"colecontrol__getforecolor\"></a>  COleControl::GetForeColor  \n Implements the Get function of the stock ForeColor property.  \n  \n```  \nOLE_COLOR GetForeColor();\n```  \n  \n### Return Value  \n The return value specifies the current foreground color as a **OLE_COLOR** value, if successful. This value can be translated to a [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) value with a call to `TranslateColor`.  \n  \n##  <a name=\"colecontrol__gethwnd\"></a>  COleControl::GetHwnd  \n Implements the Get function of the stock hWnd property.  \n  \n```  \nOLE_HANDLE GetHwnd();\n```  \n  \n### Return Value  \n The OLE control's window handle, if any; otherwise **NULL**.  \n  \n##  <a name=\"colecontrol__getmessagestring\"></a>  COleControl::GetMessageString  \n Called by the framework to obtain a short string that describes the purpose of the menu item identified by `nID`.  \n  \n```  \nvirtual void GetMessageString(\n    UINT nID,  \n    CString& rMessage) const;\n\n \n```  \n  \n### Parameters  \n `nID`  \n A menu item ID.  \n  \n `rMessage`  \n A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object through which a string will be returned.  \n  \n### Remarks  \n This can be used to obtain a message for display in a status bar while the menu item is highlighted. The default implementation attempts to load a string resource identified by `nID`.  \n  \n##  <a name=\"colecontrol__getnotsupported\"></a>  COleControl::GetNotSupported  \n Prevents access to a control's property value by the user.  \n  \n```  \nvoid GetNotSupported();\n```  \n  \n### Remarks  \n Call this function in place of the Get function of any property where retrieval of the property by the control's user is not supported. One example would be a property that is write only.  \n  \n##  <a name=\"colecontrol__getreadystate\"></a>  COleControl::GetReadyState  \n Returns the readiness state of the control.  \n  \n```  \nlong GetReadyState();\n```  \n  \n### Return Value  \n The readiness state of the control, one of the following values:  \n  \n **READYSTATE_UNINITIALIZED**  \n Default initialization state  \n  \n **READYSTATE_LOADING**  \n Control is currently loading its properties  \n  \n **READYSTATE_LOADED**  \n Control has been initialized  \n  \n **READYSTATE_INTERACTIVE**  \n Control has enough data to be interactive but not all asynchronous data is yet loaded  \n  \n `READYSTATE_COMPLETE`  \n Control has all its data  \n  \n### Remarks  \n Most simple controls never need to differentiate between **LOADED** and `INTERACTIVE`. However, controls that support data path properties may not be ready to be interactive until at least some data is received asynchronously. A control should attempt to become interactive as soon as possible.  \n  \n##  <a name=\"colecontrol__getrectincontainer\"></a>  COleControl::GetRectInContainer  \n Obtains the coordinates of the control's rectangle relative to the container, expressed in device units.  \n  \n```  \nBOOL GetRectInContainer(LPRECT lpRect);\n```  \n  \n### Parameters  \n `lpRect`  \n A pointer to the rectangle structure into which the control's coordinates will be copied.  \n  \n### Return Value  \n Nonzero if the control is in-place active; otherwise 0.  \n  \n### Remarks  \n The rectangle is only valid if the control is in-place active.  \n  \n##  <a name=\"colecontrol__getstocktextmetrics\"></a>  COleControl::GetStockTextMetrics  \n Measures the text metrics for the control's stock Font property, which can be selected with the [SelectStockFont](#colecontrol__selectstockfont) function.  \n  \n```  \nvoid GetStockTextMetrics(LPTEXTMETRIC lptm);\n```  \n  \n### Parameters  \n `lptm`  \n A pointer to a [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) structure.  \n  \n### Remarks  \n The `GetStockTextMetrics` function will initialize the `TEXTMETRIC` structure pointed to by `lptm` with valid metrics information if successful, or fill the structure with zeros if not successful. Use this function instead of [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) when painting your control because controls, like any embedded OLE object, may be required to render themselves into a metafile.  \n  \n The `TEXTMETRIC` structure for the default font is refreshed when the `SelectStockFont` function is called. You should call this function only after selecting the stock font to assure the information it provides is valid.  \n  \n##  <a name=\"colecontrol__gettext\"></a>  COleControl::GetText  \n Implements the Get function of the stock Text or Caption property.  \n  \n```  \nBSTR GetText();\n```  \n  \n### Return Value  \n The current value of the control text string or a zero-length string if no string is present.  \n  \n> [!NOTE]\n>  For more information on the `BSTR` data type, see [Data Types](../../mfc/reference/data-types-mfc.md) in the Macros and Globals section.  \n  \n### Remarks  \n Note that the caller of this function must call `SysFreeString` on the string returned in order to free the resource. Within the implementation of the control, use `InternalGetText` to access the control's stock Text or Caption property.  \n  \n##  <a name=\"colecontrol__getwindowlessdroptarget\"></a>  COleControl::GetWindowlessDropTarget  \n Override `GetWindowlessDropTarget` when you want a windowless control to be the target of an OLE drag and drop operation.  \n  \n```  \nvirtual IDropTarget* GetWindowlessDropTarget();\n```  \n  \n### Return Value  \n Pointer to the object's `IDropTarget` interface. Since it does not have a window, a windowless object cannot register an `IDropTarget` interface. However, to participate in drag and drop, a windowless object can still implement the interface and return it in `GetWindowlessDropTarget`.  \n  \n### Remarks  \n Normally, this would require that the control's window be registered as a drop target. But since the control has no window of its own, the container will use its own window as a drop target. The control simply needs to provide an implementation of the `IDropTarget` interface to which the container can delegate calls at the appropriate time. For example:  \n  \n [!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  \n  \n##  <a name=\"colecontrol__initializeiids\"></a>  COleControl::InitializeIIDs  \n Informs the base class of the IIDs the control will use.  \n  \n```  \nvoid InitializeIIDs(\n    const IID* piidPrimary, const IID* piidEvents);\n```  \n  \n### Parameters  \n *piidPrimary*  \n Pointer to the interface ID of the control's primary dispatch interface.  \n  \n *piidEvents*  \n Pointer to the interface ID of the control's event interface.  \n  \n### Remarks  \n Call this function in the control's constructor to inform the base class of the interface IDs your control will be using.  \n  \n##  <a name=\"colecontrol__internalgetfont\"></a>  COleControl::InternalGetFont  \n Accesses the stock Font property of your control  \n  \n```  \nCFontHolder& InternalGetFont();\n```  \n  \n### Return Value  \n A reference to a [CFontHolder](../../mfc/reference/cfontholder-class.md) object that contains the stock Font object.  \n  \n##  <a name=\"colecontrol__internalgettext\"></a>  COleControl::InternalGetText  \n Accesses the stock Text or Caption property of your control.  \n  \n```  \nconst CString& InternalGetText();\n```  \n  \n### Return Value  \n A reference to the control text string.  \n  \n##  <a name=\"colecontrol__internalsetreadystate\"></a>  COleControl::InternalSetReadyState  \n Sets the readiness state of the control.  \n  \n```  \nvoid InternalSetReadyState(long lNewReadyState);\n```  \n  \n### Parameters  \n *lNewReadyState*  \n The readiness state to set for the control, one of the following values:  \n  \n **READYSTATE_UNINITIALIZED**  \n Default initialization state  \n  \n **READYSTATE_LOADING**  \n Control is currently loading its properties  \n  \n **READYSTATE_LOADED**  \n Control has been initialized  \n  \n **READYSTATE_INTERACTIVE**  \n Control has enough data to be interactive but not all asynchronous data is yet loaded  \n  \n `READYSTATE_COMPLETE`  \n Control has all its data  \n  \n### Remarks  \n Most simple controls never need to differentiate between **LOADED** and `INTERACTIVE`. However, controls that support data path properties may not be ready to be interactive until at least some data is received asynchronously. A control should attempt to become interactive as soon as possible.  \n  \n##  <a name=\"colecontrol__invalidatecontrol\"></a>  COleControl::InvalidateControl  \n Forces the control to redraw itself.  \n  \n```  \nvoid InvalidateControl(\n    LPCRECT lpRect = NULL,  \n    BOOL bErase = TRUE);\n```  \n  \n### Parameters  \n `lpRect`  \n A pointer to the region of the control to be invalidated.  \n  \n `bErase`  \n Specifies whether the background within the update region is to be erased when the update region is processed.  \n  \n### Remarks  \n If `lpRect` has a **NULL** value, the entire control will be redrawn. If `lpRect` is not **NULL**, this indicates the portion of the control's rectangle that is to be invalidated. In cases where the control has no window, or is currently not active, the rectangle is ignored, and a call is made to the client site's [IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337) member function. Use this function instead of `CWnd::InvalidateRect` or `InvalidateRect`.  \n  \n##  <a name=\"colecontrol__invalidatergn\"></a>  COleControl::InvalidateRgn  \n Invalidates the container window's client area within the given region.  \n  \n```  \nvoid InvalidateRgn(\n    CRgn* pRgn, BOOL bErase = TRUE);\n```  \n  \n### Parameters  \n `pRgn`  \n A pointer to a [CRgn](../../mfc/reference/crgn-class.md) object that identifies the display region of the OLE object to invalidate, in client coordinates of the containing window. If this parameter is **NULL**, the extent is the entire object.  \n  \n `bErase`  \n Specifies whether the background within the invalidated region is to be erased. If **TRUE**, the background is erased. If **FALSE**, the background remains unchanged.  \n  \n### Remarks  \n This can be used to redraw windowless controls within the container. The invalidated region, along with all other areas in the update region, is marked for painting when the next [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) message is sent.  \n  \n If `bErase` is **TRUE** for any part of the update region, the background in the entire region, not just in the given part, is erased.  \n  \n##  <a name=\"colecontrol__isconvertingvbx\"></a>  COleControl::IsConvertingVBX  \n Allows specialized loading of an OLE control.  \n  \n```  \nBOOL IsConvertingVBX();\n```  \n  \n### Return Value  \n Nonzero if the control is being converted; otherwise 0.  \n  \n### Remarks  \n When converting a form that uses VBX controls to one that uses OLE controls, special loading code for the OLE controls may be required. For example, if you are loading an instance of your OLE control, you might have a call to [PX_Font](persistence-of-ole-controls.md#px_font) in your `DoPropExchange`:  \n  \n [!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  \n  \n However, VBX controls did not have a Font object; each font property was saved individually. In this case, you would use `IsConvertingVBX` to distinguish between these two cases:  \n  \n [!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  \n  \n Another case would be if your VBX control saved proprietary binary data (in its **VBM_SAVEPROPERTY** message handler), and your OLE control saves its binary data in a different format. If you want your OLE control to be backward-compatible with the VBX control, you could read both the old and new formats using the `IsConvertingVBX` function by distinguishing whether the VBX control or the OLE control was being loaded.  \n  \n In your control's `DoPropExchange` function, you can check for this condition and if true, execute load code specific to this conversion (such as the previous examples). If the control is not being converted, you can execute normal load code. This ability is only applicable to controls being converted from VBX counterparts.  \n  \n##  <a name=\"colecontrol__isinvokeallowed\"></a>  COleControl::IsInvokeAllowed  \n Enables automation method invocation.  \n  \n```  \nBOOL IsInvokeAllowed(DISPID dispid);\n```  \n  \n### Return Value  \n Nonzero if the control has been initialized; otherwise 0.  \n  \n### Remarks  \n The framework's implementation of **IDispatch::Invoke** calls **IsInvokeAllowed** to determine if a given function (identified by `dispid`) may be invoked. The default behavior for an OLE control is to allow automation methods to be invoked only if the control has been initialized; however, **IsInvokeAllowed** is a virtual function and may be overridden if necessary (for example, when the control is being used as an automation server). For more information, see Knowledge Base article Q166472, \"HOWTO: Use an OLE Control as an Automation Server.\" Knowledge Base articles are available in the MSDN Library Visual Studio documentation or at [http://support.microsoft.com](http://support.microsoft.com/).  \n  \n##  <a name=\"colecontrol__ismodified\"></a>  COleControl::IsModified  \n Determines if the control's state has been modified.  \n  \n```  \nBOOL IsModified();\n```  \n  \n### Return Value  \n Nonzero if the control's state has been modified since it was last saved; otherwise 0.  \n  \n### Remarks  \n The state of a control is modified when a property changes value.  \n  \n##  <a name=\"colecontrol__isoptimizeddraw\"></a>  COleControl::IsOptimizedDraw  \n Determines whether the container supports optimized drawing for the current drawing operation.  \n  \n```  \nBOOL IsOptimizedDraw();\n```  \n  \n### Return Value  \n **TRUE** if the container supports optimized drawing for the current drawing operation; otherwise **FALSE**.  \n  \n### Remarks  \n If optimized drawing is supported, then the control need not select old objects (pens, brushes, fonts, etc.) into the device context when drawing is finished.  \n  \n##  <a name=\"colecontrol__issubclassedcontrol\"></a>  COleControl::IsSubclassedControl  \n Called by the framework to determine if the control subclasses a Windows control.  \n  \n```  \nvirtual BOOL IsSubclassedControl();\n```  \n  \n### Return Value  \n Nonzero if the control is subclassed; otherwise 0.  \n  \n### Remarks  \n You must override this function and return **TRUE** if your OLE control subclasses a Windows control.  \n  \n##  <a name=\"colecontrol__load\"></a>  COleControl::Load  \n Resets any previous data loaded asynchronously and initiates a new loading of the control's asynchronous property.  \n  \n```  \nvoid Load(\n    LPCTSTR strNewPath, CDataPathProperty& prop);\n```  \n  \n### Parameters  \n *strNewPath*  \n A pointer to a string containing the path that references the absolute location of the asynchronous control property.  \n  \n *prop*  \n A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) object implementing an asynchronous control property.  \n  \n##  <a name=\"colecontrol__lockinplaceactive\"></a>  COleControl::LockInPlaceActive  \n Prevents the container from deactivating your control.  \n  \n```  \nBOOL LockInPlaceActive(BOOL bLock);\n```  \n  \n### Parameters  \n `bLock`  \n **TRUE** if the in-place active state of the control is to be locked; **FALSE** if it is to be unlocked.  \n  \n### Return Value  \n Nonzero if the lock was successful; otherwise 0.  \n  \n### Remarks  \n Note that every locking of the control must be paired with an unlocking of the control when finished. You should only lock your control for short periods, such as while firing an event.  \n  \n##  <a name=\"colecontrol__onambientpropertychange\"></a>  COleControl::OnAmbientPropertyChange  \n Called by the framework when an ambient property of the container has changed value.  \n  \n```  \nvirtual void OnAmbientPropertyChange(DISPID dispid);\n```  \n  \n### Parameters  \n *dispID*  \n The dispatch ID of the ambient property that changed, or **DISPID_UNKNOWN** if multiple properties have changed.  \n  \n##  <a name=\"colecontrol__onappearancechanged\"></a>  COleControl::OnAppearanceChanged  \n Called by the framework when the stock Appearance property value has changed.  \n  \n```  \nvirtual void OnAppearanceChanged ();\n```  \n  \n### Remarks  \n Override this function if you want notification after this property changes. The default implementation calls `InvalidateControl`.  \n  \n##  <a name=\"colecontrol__onbackcolorchanged\"></a>  COleControl::OnBackColorChanged  \n Called by the framework when the stock BackColor property value has changed.  \n  \n```  \nvirtual void OnBackColorChanged();\n```  \n  \n### Remarks  \n Override this function if you want notification after this property changes. The default implementation calls `InvalidateControl`.  \n  \n##  <a name=\"colecontrol__onborderstylechanged\"></a>  COleControl::OnBorderStyleChanged  \n Called by the framework when the stock BorderStyle property value has changed.  \n  \n```  \nvirtual void OnBorderStyleChanged();\n```  \n  \n### Remarks  \n The default implementation calls `InvalidateControl`.  \n  \n Override this function if you want notification after this property changes.  \n  \n##  <a name=\"colecontrol__onclick\"></a>  COleControl::OnClick  \n Called by the framework when a mouse button has been clicked or the DoClick stock method has been invoked.  \n  \n```  \nvirtual void OnClick(USHORT iButton);\n```  \n  \n### Parameters  \n *iButton*  \n Index of a mouse button. Can have one of the following values:  \n  \n- **LEFT_BUTTON** The left mouse button was clicked.  \n  \n- **MIDDLE_BUTTON** The middle mouse button was clicked.  \n  \n- **RIGHT_BUTTON** The right mouse button was clicked.  \n  \n### Remarks  \n The default implementation calls `COleControl::FireClick`.  \n  \n Override this member function to modify or extend the default handling.  \n  \n##  <a name=\"colecontrol__onclose\"></a>  COleControl::OnClose  \n Called by the framework when the container has called the control's **IOleControl::Close** function.  \n  \n```  \nvirtual void OnClose(DWORD dwSaveOption);\n```  \n  \n### Parameters  \n `dwSaveOption`  \n Flag that indicates whether the object should be saved before loading. Valid values are:  \n  \n- `OLECLOSE_SAVEIFDIRTY`  \n  \n- `OLECLOSE_NOSAVE`  \n  \n- `OLECLOSE_PROMPTSAVE`  \n  \n### Remarks  \n By default, `OnClose` saves the control object if it has been modified and `dwSaveOption` is either `OLECLOSE_SAVEIFDIRTY` or `OLECLOSE_PROMPTSAVE`.  \n  \n##  <a name=\"colecontrol__ondoverb\"></a>  COleControl::OnDoVerb  \n Called by the framework when the container calls the **IOleObject::DoVerb** member function.  \n  \n```  \nvirtual BOOL OnDoVerb(\n    LONG iVerb,  \n    LPMSG lpMsg,  \n    HWND hWndParent,  \n    LPCRECT lpRect);\n```  \n  \n### Parameters  \n `iVerb`  \n The index of the control verb to be invoked.  \n  \n `lpMsg`  \n A pointer to the Windows message that caused the verb to be invoked.  \n  \n `hWndParent`  \n The handle to the parent window of the control. If the execution of the verb creates a window (or windows), `hWndParent` should be used as the parent.  \n  \n `lpRect`  \n A pointer to a RECT structure into which the coordinates of the control, relative to the container, will be copied.  \n  \n### Return Value  \n Nonzero if call was successful; otherwise 0.  \n  \n### Remarks  \n The default implementation uses the `ON_OLEVERB` and `ON_STDOLEVERB` message map entries to determine the proper function to invoke.  \n  \n Override this function to change the default handling of verb.  \n  \n##  <a name=\"colecontrol__ondraw\"></a>  COleControl::OnDraw  \n Called by the framework to draw the OLE control in the specified bounding rectangle using the specified device context.  \n  \n```  \nvirtual void OnDraw(\n    CDC* pDC,  \n    const CRect& rcBounds,  \n    const CRect& rcInvalid);\n```  \n  \n### Parameters  \n `pDC`  \n The device context in which the drawing occurs.  \n  \n `rcBounds`  \n The rectangular area of the control, including the border.  \n  \n `rcInvalid`  \n The rectangular area of the control that is invalid.  \n  \n### Remarks  \n `OnDraw` is typically called for screen display, passing a screen device context as `pDC`. The `rcBounds` parameter identifies the rectangle in the target device context (relative to its current mapping mode). The `rcInvalid` parameter is the actual rectangle that is invalid. In some cases this will be a smaller area than `rcBounds`.  \n  \n##  <a name=\"colecontrol__ondrawmetafile\"></a>  COleControl::OnDrawMetafile  \n Called by the framework to draw the OLE control in the specified bounding rectangle using the specified metafile device context.  \n  \n```  \nvirtual void OnDrawMetafile(\n    CDC* pDC,  \n    const CRect& rcBounds);\n```  \n  \n### Parameters  \n `pDC`  \n The device context in which the drawing occurs.  \n  \n `rcBounds`  \n The rectangular area of the control, including the border.  \n  \n### Remarks  \n The default implementation calls the [OnDraw](#colecontrol__ondraw) function.  \n  \n##  <a name=\"colecontrol__onedit\"></a>  COleControl::OnEdit  \n Causes the control to be UI activated.  \n  \n```  \nvirtual BOOL OnEdit(\n    LPMSG lpMsg,  \n    HWND hWndParent,  \n    LPCRECT lpRect);\n```  \n  \n### Parameters  \n `lpMsg`  \n A pointer to the Windows message that invoked the verb.  \n  \n `hWndParent`  \n A handle to the parent window of the control.  \n  \n `lpRect`  \n A pointer to the rectangle used by the control in the container.  \n  \n### Return Value  \n Nonzero if the call is successful; otherwise 0.  \n  \n### Remarks  \n This has the same effect as invoking the control's `OLEIVERB_UIACTIVATE` verb.  \n  \n This function is typically used as the handler function for an `ON_OLEVERB` message map entry. This makes an \"Edit\" verb available on the control's \"Object\" menu. For example:  \n  \n [!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  \n  \n##  <a name=\"colecontrol__onenabledchanged\"></a>  COleControl::OnEnabledChanged  \n Called by the framework when the stock Enabled property value has changed.  \n  \n```  \nvirtual void OnEnabledChanged();\n```  \n  \n### Remarks  \n Override this function if you want notification after this property changes. The default implementation calls [InvalidateControl](#colecontrol__invalidatecontrol).  \n  \n##  <a name=\"colecontrol__onenumverbs\"></a>  COleControl::OnEnumVerbs  \n Called by the framework when the container calls the **IOleObject::EnumVerbs** member function.  \n  \n```  \nvirtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);\n```  \n  \n### Parameters  \n `ppenumOleVerb`  \n A pointer to the **IEnumOLEVERB** object that enumerates the control's verbs.  \n  \n### Return Value  \n Nonzero if verbs are available; otherwise 0.  \n  \n### Remarks  \n The default implementation enumerates the `ON_OLEVERB` entries in the message map.  \n  \n Override this function to change the default way of enumerating verbs.  \n  \n##  <a name=\"colecontrol__oneventadvise\"></a>  COleControl::OnEventAdvise  \n Called by the framework when an event handler is connected to or disconnected from an OLE control.  \n  \n```  \nvirtual void OnEventAdvise(BOOL bAdvise);\n```  \n  \n### Parameters  \n `bAdvise`  \n **TRUE** indicates that an event handler has been connected to the control. **FALSE** indicates that an event handler has been disconnected from the control.  \n  \n##  <a name=\"colecontrol__onfontchanged\"></a>  COleControl::OnFontChanged  \n Called by the framework when the stock Font property value has changed.  \n  \n```  \nvirtual void OnFontChanged();\n```  \n  \n### Remarks  \n The default implementation calls `COleControl::InvalidateControl`. If the control is subclassing a Windows control, the default implementation also sends a **WM_SETFONT** message to the control's window.  \n  \n Override this function if you want notification after this property changes.  \n  \n### Example  \n [!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  \n  \n##  <a name=\"colecontrol__onforecolorchanged\"></a>  COleControl::OnForeColorChanged  \n Called by the framework when the stock ForeColor property value has changed.  \n  \n```  \nvirtual void OnForeColorChanged();\n```  \n  \n### Remarks  \n The default implementation calls `InvalidateControl`.  \n  \n Override this function if you want notification after this property changes.  \n  \n##  <a name=\"colecontrol__onfreezeevents\"></a>  COleControl::OnFreezeEvents  \n Called by the framework after the container calls **IOleControl::FreezeEvents**.  \n  \n```  \nvirtual void OnFreezeEvents(BOOL bFreeze);\n```  \n  \n### Parameters  \n `bFreeze`  \n **TRUE** if the control's event handling is frozen; otherwise **FALSE**.  \n  \n### Remarks  \n The default implementation does nothing.  \n  \n Override this function if you want additional behavior when event handling is frozen or unfrozen.  \n  \n##  <a name=\"colecontrol__ongetcolorset\"></a>  COleControl::OnGetColorSet  \n Called by the framework when the container calls the **IViewObject::GetColorSet** member function.  \n  \n```  \nvirtual BOOL OnGetColorSet(\n    DVTARGETDEVICE* ptd,  \n    HDC hicTargetDev,  \n    LPLOGPALETTE* ppColorSet);\n```  \n  \n### Parameters  \n `ptd`  \n Points to the target device for which the picture should be rendered. If this value is **NULL**, the picture should be rendered for a default target device, usually a display device.  \n  \n `hicTargetDev`  \n Specifies the information context on the target device indicated by `ptd`. This parameter can be a device context, but is not one necessarily. If `ptd` is **NULL**, `hicTargetDev` should also be **NULL**.  \n  \n *ppColorSet*  \n A pointer to the location into which the set of colors that would be used should be copied. If the function does not return the color set, **NULL** is returned.  \n  \n### Return Value  \n Nonzero if a valid color set is returned; otherwise 0.  \n  \n### Remarks  \n The container calls this function to obtain all the colors needed to draw the OLE control. The container can use the color sets obtained in conjunction with the colors it needs to set the overall color palette. The default implementation returns **FALSE**.  \n  \n Override this function to do any special processing of this request.  \n  \n##  <a name=\"colecontrol__ongetcontrolinfo\"></a>  COleControl::OnGetControlInfo  \n Called by the framework when the control's container has requested information about the control.  \n  \n```  \nvirtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);\n```  \n  \n### Parameters  \n `pControlInfo`  \n Pointer to a [CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734) structure to be filled in.  \n  \n### Remarks  \n This information consists primarily of a description of the control's mnemonic keys. The default implementation fills `pControlInfo` with default information.  \n  \n Override this function if your control needs to process mnemonic keys.  \n  \n##  <a name=\"colecontrol__ongetdisplaystring\"></a>  COleControl::OnGetDisplayString  \n Called by the framework to obtain a string that represents the current value of the property identified by `dispid`.  \n  \n```  \nvirtual BOOL OnGetDisplayString(\n    DISPID dispid,  \n    CString& strValue);\n```  \n  \n### Parameters  \n `dispid`  \n The dispatch ID of a property of the control.  \n  \n `strValue`  \n A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object through which a string will be returned.  \n  \n### Return Value  \n Nonzero if a string has been returned in *strValue;* otherwise 0.  \n  \n### Remarks  \n Override this function if your control has a property whose value cannot be directly converted to a string and you want the property's value to be displayed in a container-supplied property browser.  \n  \n##  <a name=\"colecontrol__ongetinplacemenu\"></a>  COleControl::OnGetInPlaceMenu  \n Called by the framework when the control is UI activated to obtain the menu to be merged into the container's existing menu.  \n  \n```  \nvirtual HMENU OnGetInPlaceMenu();\n```  \n  \n### Return Value  \n The handle of the control's menu, or **NULL** if the control has none. The default implementation returns **NULL**.  \n  \n### Remarks  \n For more information on merging OLE resources, see the article [Menus and Resources (OLE)](../../mfc/menus-and-resources-ole.md).  \n  \n##  <a name=\"colecontrol__ongetnaturalextent\"></a>  COleControl::OnGetNaturalExtent  \n Called by the framework in response to a container's **IViewObjectEx::GetNaturalExtent** request.  \n  \n```  \nvirtual BOOL OnGetNaturalExtent(\n    DWORD dwAspect,\n    LONG lindex,\n    DVTARGETDEVICE* ptd,\n    HDC hicTargetDev,\n    DVEXTENTINFO* pExtentInfo,\n    LPSIZEL psizel);\n```  \n  \n### Parameters  \n `dwAspect`  \n Specifies how the object is to be represented. Representations include content, an icon, a thumbnail, or a printed document. Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**.  \n  \n *lindex*  \n The portion of the object that is of interest. Currently only -1 is valid.  \n  \n `ptd`  \n Points to the [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) structure defining the target device for which the object's size should be returned.  \n  \n `hicTargetDev`  \n Specifies the information context for the target device indicated by the `ptd` parameter from which the object can extract device metrics and test the device's capabilities. If `ptd` is **NULL**, the object should ignore the value in the `hicTargetDev` parameter.  \n  \n *pExtentInfo*  \n Points to the **DVEXTENTINFO** structure that specifies sizing data. The **DVEXTENTINFO** structure is:  \n  \n `typedef struct  tagExtentInfo`  \n  \n `{`  \n  \n `UINT cb;`  \n  \n `DWORD dwExtentMode;`  \n  \n `SIZEL sizelProposed;`  \n  \n `}   DVEXTENTINFO;`  \n  \n The structure member `dwExtentMode` can take one of two values:  \n  \n- **DVEXTENT_CONTENT** Inquire how big the control should be to exactly fit content (snap-to-size)  \n  \n- **DVEXTENT_INTEGRAL** When resizing, pass proposed size to control  \n  \n `psizel`  \n Points to sizing data returned by control. The returned sizing data is set to -1 for any dimension that was not adjusted.  \n  \n### Return Value  \n Nonzero if it successfully returns or adjusts the size; otherwise 0.  \n  \n### Remarks  \n Override this function to return the object's display size closest to the proposed size and extent mode in the **DVEXTENTINFO** structure. The default implementation returns **FALSE** and makes no adjustments to the size.  \n  \n##  <a name=\"colecontrol__ongetpredefinedstrings\"></a>  COleControl::OnGetPredefinedStrings  \n Called by the framework to obtain a set of predefined strings representing the possible values for a property.  \n  \n```  \nvirtual BOOL OnGetPredefinedStrings(\n    DISPID dispid,  \n    CStringArray* pStringArray,  \n    CDWordArray* pCookieArray);\n```  \n  \n### Parameters  \n `dispid`  \n The dispatch ID of a property of the control.  \n  \n `pStringArray`  \n A string array to be filled in with return values.  \n  \n `pCookieArray`  \n A `DWORD` array to be filled in with return values.  \n  \n### Return Value  \n Nonzero if elements have been added to `pStringArray` and `pCookieArray`.  \n  \n### Remarks  \n Override this function if your control has a property with a set of possible values that can be represented by strings. For each element added to `pStringArray`, you should add a corresponding \"cookie\" element to *pCookieArray.* These \"cookie\" values may later be passed by the framework to the `COleControl::OnGetPredefinedValue` function.  \n  \n##  <a name=\"colecontrol__ongetpredefinedvalue\"></a>  COleControl::OnGetPredefinedValue  \n Called by the framework to obtain the value corresponding to one of the predefined strings previously returned by an override of `COleControl::OnGetPredefinedStrings`.  \n  \n```  \nvirtual BOOL OnGetPredefinedValue(\n    DISPID dispid,  \n    DWORD dwCookie,  \n    VARIANT* lpvarOut);\n```  \n  \n### Parameters  \n `dispid`  \n The dispatch ID of a property of the control.  \n  \n `dwCookie`  \n A cookie value previously returned by an override of `COleControl::OnGetPredefinedStrings`.  \n  \n `lpvarOut`  \n Pointer to a **VARIANT** structure through which a property value will be returned.  \n  \n### Return Value  \n Nonzero if a value has been returned in `lpvarOut`; otherwise 0.  \n  \n##  <a name=\"colecontrol__ongetviewextent\"></a>  COleControl::OnGetViewExtent  \n Called by the framework in response to a container's [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) request.  \n  \n```  \nvirtual BOOL OnGetViewExtent(\n    DWORD dwDrawAspect,\n    LONG lindex,\n    DVTARGETDEVICE* ptd,\n    LPSIZEL lpsizel);\n```  \n  \n### Parameters  \n *dwDrawAspect*  \n `DWORD` describing which form, or aspect, of an object is to be displayed. Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**.  \n  \n *lindex*  \n The portion of the object that is of interest. Currently only –1 is valid.  \n  \n `ptd`  \n Points to the [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) structure defining the target device for which the object's size should be returned.  \n  \n *lpsizel*  \n Points to the location where the object's size is returned.  \n  \n### Return Value  \n Nonzero if extent information is successfully returned; otherwise 0.  \n  \n### Remarks  \n Override this function if your control uses two-pass drawing, and its opaque and transparent parts have different dimensions.  \n  \n##  <a name=\"colecontrol__ongetviewrect\"></a>  COleControl::OnGetViewRect  \n Called by the framework in response to a container's **IViewObjectEx::GetRect** request.  \n  \n```  \nvirtual BOOL OnGetViewRect(\n    DWORD dwAspect, LPRECTL pRect);\n```  \n  \n### Parameters  \n `dwAspect`  \n `DWORD` describing which form, or aspect, of an object is to be displayed. Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**:  \n  \n- `DVASPECT_CONTENT` Bounding rectangle of the whole object. Top-left corner at the object's origin and size equal to the extent returned by **GetViewExtent***.*  \n  \n- **DVASPECT_OPAQUE** Objects with a rectangular opaque region return that rectangle. Others fail.  \n  \n- **DVASPECT_TRANSPARENT** Rectangle covering all transparent or irregular parts.  \n  \n `pRect`  \n Points to the [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) structure specifying the rectangle in which the object should be drawn. This parameter controls the positioning and stretching of the object.  \n  \n### Return Value  \n Nonzero if the rectangle sized to the object is successfully returned; otherwise 0.  \n  \n### Remarks  \n The object's size is converted by `OnGetViewRect` into a rectangle starting at a specific position (the default is the upper left corner of the display). Override this function if your control uses two-pass drawing, and its opaque and transparent parts have different dimensions.  \n  \n##  <a name=\"colecontrol__ongetviewstatus\"></a>  COleControl::OnGetViewStatus  \n Called by the framework in response to a container's **IViewObjectEx::GetViewStatus** request.  \n  \n```  \nvirtual DWORD OnGetViewStatus();\n```  \n  \n### Return Value  \n One of the values of the **VIEWSTATUS** enumeration if successful; otherwise 0. Possible values are any combination of the following:  \n  \n **VIEWSTATUS_OPAQUE**  \n Object is completely opaque. If this bit is not set, the object contains transparent parts. This bit applies only to content-related aspects and not to `DVASPECT_ICON` or `DVASPECT_DOCPRINT`.  \n  \n **VIEWSTATUS_SOLIDBKGND**  \n Object has a solid background (consisting in a solid color, not a brush pattern). This bit is meaningful only if **VIEWSTATUS_OPAQUE** is set and applies only to content-related aspects and not to `DVASPECT_ICON` or `DVASPECT_DOCPRINT`.  \n  \n **VIEWSTATUS_DVASPECTOPAQUE**  \n Object supports **DVASPECT_OPAQUE**. All **IViewObjectEx** methods that take a drawing aspect as a parameter can be called with this aspect.  \n  \n **VIEWSTATUS_DVASPECTTRANSPARENT**  \n Object supports **DVASPECT_TRANSPARENT**. All **IViewObjectEx** methods that take a drawing aspect as a parameter can be called with this aspect.  \n  \n### Remarks  \n Override this function if your control uses two-pass drawing. The default implementation returns **VIEWSTATUS_OPAQUE**.  \n  \n##  <a name=\"colecontrol__onhidetoolbars\"></a>  COleControl::OnHideToolBars  \n Called by the framework when the control is UI deactivated.  \n  \n```  \nvirtual void OnHideToolBars();\n```  \n  \n### Remarks  \n The implementation should hide all toolbars displayed by `OnShowToolbars`.  \n  \n##  <a name=\"colecontrol__oninactivemousemove\"></a>  COleControl::OnInactiveMouseMove  \n Called by the container for the inactive object under the mouse pointer on receipt of a `WM_MOUSEMOVE` message.  \n  \n```  \nvirtual void OnInactiveMouseMove(\n    LPCRECT lprcBounds,\n    long x,\n    long y,\n    DWORD dwKeyState);\n```  \n  \n### Parameters  \n `lprcBounds`  \n The object bounding rectangle, in client coordinates of the containing window. Tells the object its exact position and size on the screen when the `WM_MOUSEMOVE` message was received.  \n  \n *x*  \n The x coordinate of the mouse location in client coordinates of the containing window.  \n  \n *y*  \n The y coordinate of the mouse location in client coordinates of the containing window.  \n  \n `dwKeyState`  \n Identifies the current state of the keyboard modifier keys on the keyboard. Valid values can be a combination of any of the flags **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_BUTTON**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**.  \n  \n### Remarks  \n Note that window client coordinates (pixels) are used to pass the mouse cursor position. This is made possible by also passing the bounding rectangle of the object in the same coordinate system.  \n  \n##  <a name=\"colecontrol__oninactivesetcursor\"></a>  COleControl::OnInactiveSetCursor  \n Called by the container for the inactive object under the mouse pointer on receipt of a `WM_SETCURSOR` message.  \n  \n```  \nvirtual BOOL OnInactiveSetCursor(\n    LPCRECT lprcBounds,\n    long x,\n    long y,\n    DWORD dwMouseMsg,\n    BOOL bSetAlways);\n```  \n  \n### Parameters  \n `lprcBounds`  \n The object bounding rectangle, in client coordinates of the containing window. Tells the object its exact position and size on the screen when the `WM_SETCURSOR` message was received.  \n  \n *x*  \n The x coordinate of the mouse location in client coordinates of the containing window.  \n  \n *y*  \n The y coordinate of the mouse location in client coordinates of the containing window.  \n  \n *dwMouseMsg*  \n The identifier of the mouse message for which a `WM_SETCURSOR` occurred.  \n  \n *bSetAlways*  \n Specifies whether or not the object must set the cursor. If **TRUE**, the object must set the cursor; if **FALSE**, the cursor is not obligated to set the cursor, and should return **S_FALSE** in that case.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n Note that window client coordinates (pixels) are used to pass the mouse cursor position. This is made possible by also passing the bounding rectangle of the object in the same coordinate system.  \n  \n##  <a name=\"colecontrol__onkeydownevent\"></a>  COleControl::OnKeyDownEvent  \n Called by the framework after a stock KeyDown event has been processed.  \n  \n```  \nvirtual void OnKeyDownEvent(\n    USHORT nChar,  \n    USHORT nShiftState);\n```  \n  \n### Parameters  \n `nChar`  \n The virtual key code value of the pressed key. For a list of standard virtual key codes, see Winuser.h  \n  \n `nShiftState`  \n Contains a combination of the following flags:  \n  \n- **SHIFT_MASK** The SHIFT key was pressed during the action.  \n  \n- **CTRL_MASK** The CTRL key was pressed during the action.  \n  \n- **ALT_MASK** The ALT key was pressed during the action.  \n  \n### Remarks  \n Override this function if your control needs access to the key information after the event has been fired.  \n  \n##  <a name=\"colecontrol__onkeypressevent\"></a>  COleControl::OnKeyPressEvent  \n Called by the framework after the stock KeyPress event has been fired.  \n  \n```  \nvirtual void OnKeyPressEvent(USHORT nChar);\n```  \n  \n### Parameters  \n `nChar`  \n Contains the virtual key code value of the key pressed. For a list of standard virtual key codes, see Winuser.h  \n  \n### Remarks  \n Note that the `nChar` value may have been modified by the container.  \n  \n Override this function if you want notification after this event occurs.  \n  \n##  <a name=\"colecontrol__onkeyupevent\"></a>  COleControl::OnKeyUpEvent  \n Called by the framework after a stock KeyDown event has been processed.  \n  \n```  \nvirtual void OnKeyUpEvent(\n    USHORT nChar,  \n    USHORT nShiftState);\n```  \n  \n### Parameters  \n `nChar`  \n The virtual key code value of the pressed key. For a list of standard virtual key codes, see Winuser.h  \n  \n `nShiftState`  \n Contains a combination of the following flags:  \n  \n- **SHIFT_MASK** The SHIFT key was pressed during the action.  \n  \n- **CTRL_MASK** The CTRL key was pressed during the action.  \n  \n- **ALT_MASK** The ALT key was pressed during the action.  \n  \n### Remarks  \n Override this function if your control needs access to the key information after the event has been fired.  \n  \n##  <a name=\"colecontrol__onmappropertytopage\"></a>  COleControl::OnMapPropertyToPage  \n Called by the framework to obtain the class ID of a property page that implements editing of the specified property.  \n  \n```  \nvirtual BOOL OnMapPropertyToPage(\n    DISPID dispid,  \n    LPCLSID lpclsid,  \n    BOOL* pbPageOptional);\n```  \n  \n### Parameters  \n `dispid`  \n The dispatch ID of a property of the control.  \n  \n `lpclsid`  \n Pointer to a **CLSID** structure through which a class ID will be returned.  \n  \n *pbPageOptional*  \n Returns an indicator of whether use of the specified property page is optional.  \n  \n### Return Value  \n Nonzero if a class ID has been returned in `lpclsid`; otherwise 0.  \n  \n### Remarks  \n Override this function to provide a way to invoke your control's property pages from the container's property browser.  \n  \n##  <a name=\"colecontrol__onmnemonic\"></a>  COleControl::OnMnemonic  \n Called by the framework when the container has detected that a mnemonic key of the OLE control has been pressed.  \n  \n```  \nvirtual void OnMnemonic(LPMSG pMsg);\n```  \n  \n### Parameters  \n `pMsg`  \n Pointer to the Windows message generated by a mnemonic key press.  \n  \n##  <a name=\"colecontrol__onproperties\"></a>  COleControl::OnProperties  \n Called by the framework when the control's properties verb has been invoked by the container.  \n  \n```  \nvirtual BOOL OnProperties(\n    LPMSG lpMsg,  \n    HWND hWndParent,  \n    LPCRECT lpRect);\n```  \n  \n### Parameters  \n `lpMsg`  \n A pointer to the Windows message that invoked the verb.  \n  \n `hWndParent`  \n A handle to the parent window of the control.  \n  \n `lpRect`  \n A pointer to the rectangle used by the control in the container.  \n  \n### Return Value  \n Nonzero if the call is successful; otherwise 0.  \n  \n### Remarks  \n The default implementation displays a modal property dialog box.  \n  \n You can also use this function to cause the display of your control's property pages. Make a call to the `OnProperties` function, passing the handle of your control's parent in the `hWndParent` parameter. In this case, the values of the `lpMsg` and `lpRect` parameters are ignored.  \n  \n##  <a name=\"colecontrol__onqueryhitpoint\"></a>  COleControl::OnQueryHitPoint  \n Called by the framework in response to a container's **IViewObjectEx::QueryHitPoint** request.  \n  \n```  \nvirtual BOOL OnQueryHitPoint(\n    DWORD dwAspect,\n    LPCRECT pRectBounds,\n    POINT ptlLoc,\n    LONG lCloseHint,\n    DWORD* pHitResult);\n```  \n  \n### Parameters  \n `dwAspect`  \n Specifies how the object is represented. Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**.  \n  \n `pRectBounds`  \n Pointer to a `RECT` structure specifying the bounding rectangle of the OLE control client area.  \n  \n `ptlLoc`  \n Pointer to the **POINT** structure specifying the point to be checked for a hit. The point is specified in OLE client area coordinates.  \n  \n `lCloseHint`  \n The distance that defines \"close\" to the point checked for a hit.  \n  \n `pHitResult`  \n Pointer to the result of the hit query. One of the following values:  \n  \n- **HITRESULT_OUTSIDE** `ptlLoc` is outside the OLE object and not close.  \n  \n- **HITRESULT_TRANSPARENT** *ptlLoc* is within the bounds of the OLE object, but not close to the image. For example, a point in the middle of a transparent circle could be **HITRESULT_TRANSPARENT**.  \n  \n- **HITRESULT_CLOSE** `ptlLoc` is inside or outside the OLE object but close enough to the object to be considered inside. Small, thin, or detailed objects may use this value. Even if a point is outside the bounding rectangle of an object it may still be close (this is needed for hitting small objects).  \n  \n- **HITRESULT_HIT** `ptlLoc` is within the image of the object.  \n  \n### Return Value  \n Nonzero if a hit result is successfully returned; otherwise 0. A hit is an overlap with the OLE control display area.  \n  \n### Remarks  \n Queries whether an object's display rectangle overlaps the given point (hits the point). `QueryHitPoint` can be overridden to test hits for non-rectangular objects.  \n  \n##  <a name=\"colecontrol__onqueryhitrect\"></a>  COleControl::OnQueryHitRect  \n Called by the framework in response to a container's **IViewObjectEx::QueryHitRect** request.  \n  \n```  \nvirtual BOOL OnQueryHitRect(\n    DWORD dwAspect,  \n    LPCRECT pRectBounds,  \n    LPCRECT prcLoc,  \n    LONG lCloseHint,  \n    DWORD* pHitResult);\n```  \n  \n### Parameters  \n `dwAspect`  \n Specifies how the object is to be represented. Valid values are taken from the enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) or **DVASPECT2**.  \n  \n `pRectBounds`  \n Pointer to a `RECT` structure specifying the bounding rectangle of the OLE control client area.  \n  \n *prcLoc*  \n Pointer to the `RECT` structure specifying the rectangle to be checked for a hit (overlap with the object rectangle), relative to the upper left corner of the object.  \n  \n `lCloseHint`  \n Not used.  \n  \n `pHitResult`  \n Pointer to the result of the hit query. One of the following values:  \n  \n- **HITRESULT_OUTSIDE** no point in the rectangle is hit by the OLE object.  \n  \n- **HITRESULT_HIT** at least one point in the rectangle would be a hit on the object.  \n  \n### Return Value  \n Nonzero if a hit result is successfully returned; otherwise 0.  \n  \n### Remarks  \n Queries whether an object's display rectangle overlaps any point in the given rectangle (hits the rectangle). `QueryHitRect` can be overridden to test hits for non-rectangular objects.  \n  \n##  <a name=\"colecontrol__onrenderdata\"></a>  COleControl::OnRenderData  \n Called by the framework to retrieve data in the specified format.  \n  \n```  \nvirtual BOOL OnRenderData(\n    LPFORMATETC lpFormatEtc,  \n    LPSTGMEDIUM lpStgMedium);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested.  \n  \n `lpStgMedium`  \n Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in which the data is to be returned.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n The specified format is one previously placed in the control object using the [DelayRenderData](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderdata) or [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderfiledata) member functions for delayed rendering. The default implementation of this function calls `OnRenderFileData` or `OnRenderGlobalData`, respectively, if the supplied storage medium is either a file or memory. If the requested format is `CF_METAFILEPICT` or the persistent property set format, the default implementation renders the appropriate data and returns nonzero. Otherwise, it returns 0 and does nothing.  \n  \n If *lpStgMedium->tymed* is **TYMED_NULL**, the **STGMEDIUM** should be allocated and filled as specified by *lpFormatEtc->tymed*. If not **TYMED_NULL**, the **STGMEDIUM** should be filled in place with the data.  \n  \n Override this function to provide your data in the requested format and medium. Depending on your data, you may want to override one of the other versions of this function instead. If your data is small and fixed in size, override `OnRenderGlobalData`. If your data is in a file, or is of variable size, override `OnRenderFileData`.  \n  \n For more information, see the **FORMATETC** and **STGMEDIUM** structures in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colecontrol__onrenderfiledata\"></a>  COleControl::OnRenderFileData  \n Called by the framework to retrieve data in the specified format when the storage medium is a file.  \n  \n```  \nvirtual BOOL OnRenderFileData(\n    LPFORMATETC lpFormatEtc,  \n    CFile* pFile);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested.  \n  \n `pFile`  \n Points to a [CFile](../../mfc/reference/cfile-class.md) object in which the data is to be rendered.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n The specified format is one previously placed in the control object using the [DelayRenderData](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderdata) member function for delayed rendering. The default implementation of this function simply returns **FALSE**.  \n  \n Override this function to provide your data in the requested format and medium. Depending on your data, you might want to override one of the other versions of this function instead. If you want to handle multiple storage mediums, override `OnRenderData`. If your data is in a file, or is of variable size, override `OnRenderFileData`.  \n  \n For more information, see the **FORMATETC** structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colecontrol__onrenderglobaldata\"></a>  COleControl::OnRenderGlobalData  \n Called by the framework to retrieve data in the specified format when the specified storage medium is global memory.  \n  \n```  \nvirtual BOOL OnRenderGlobalData(\n    LPFORMATETC lpFormatEtc,  \n    HGLOBAL* phGlobal);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested.  \n  \n `phGlobal`  \n Points to a handle to global memory in which the data is to be returned. If no memory has been allocated, this parameter can be **NULL**.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n The specified format is one previously placed in the control object using the [DelayRenderData](../../mfc/reference/coledatasource-class.md#coledatasource__delayrenderdata) member function for delayed rendering. The default implementation of this function simply returns **FALSE**.  \n  \n If `phGlobal` is **NULL**, then a new `HGLOBAL` should be allocated and returned in `phGlobal`. Otherwise, the `HGLOBAL` specified by `phGlobal` should be filled with the data. The amount of data placed in the `HGLOBAL` must not exceed the current size of the memory block. Also, the block cannot be reallocated to a larger size.  \n  \n Override this function to provide your data in the requested format and medium. Depending on your data, you may want to override one of the other versions of this function instead. If you want to handle multiple storage mediums, override `OnRenderData`. If your data is in a file, or is of variable size, override `OnRenderFileData`.  \n  \n For more information, see the **FORMATETC** structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colecontrol__onresetstate\"></a>  COleControl::OnResetState  \n Called by the framework when the control's properties should be set to their default values.  \n  \n```  \nvirtual void OnResetState();\n```  \n  \n### Remarks  \n The default implementation calls [DoPropExchange](#colecontrol__dopropexchange), passing a `CPropExchange` object that causes properties to be set to their default values.  \n  \n The control writer can insert initialization code for the OLE control in this overridable. This function is called when [IPersistStream::Load](http://msdn.microsoft.com/library/windows/desktop/ms680568) or [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) fails, or [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) or [IPersistStorage::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) is called, without first calling either **IPersistStream::Load** or **IPersistStorage::Load**.  \n  \n##  <a name=\"colecontrol__onsetclientsite\"></a>  COleControl::OnSetClientSite  \n Called by the framework when the container has called the control's **IOleControl::SetClientSite** function.  \n  \n```  \nvirtual void OnSetClientSite();\n```  \n  \n### Remarks  \n By default, `OnSetClientSite` checks whether data path properties are loaded and, if they are, calls `DoDataPathPropExchange`.  \n  \n Override this function to do any special processing of this notification. In particular, overrides of this function should call the base class.  \n  \n##  <a name=\"colecontrol__onsetdata\"></a>  COleControl::OnSetData  \n Called by the framework to replace the control's data with the specified data.  \n  \n```  \nvirtual BOOL OnSetData(\n    LPFORMATETC lpFormatEtc,\n    LPSTGMEDIUM lpStgMedium,\n    BOOL bRelease);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Pointer to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format of the data.  \n  \n `lpStgMedium`  \n Pointer to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in which the data resides.  \n  \n `bRelease`  \n **TRUE** if the control should free the storage medium; **FALSE** if the control should not free the storage medium.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n If the data is in the persistent property set format, the default implementation modifies the control's state accordingly. Otherwise, the default implementation does nothing. If `bRelease` is **TRUE**, then a call to **ReleaseStgMedium** is made; otherwise not.  \n  \n Override this function to replace the control's data with the specified data.  \n  \n For more information, see the **FORMATETC** and **STGMEDIUM** structures in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colecontrol__onsetextent\"></a>  COleControl::OnSetExtent  \n Called by the framework when the control's extent needs to be changed, as a result of a call to [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330).  \n  \n```  \nvirtual BOOL OnSetExtent(LPSIZEL lpSizeL);\n```  \n  \n### Parameters  \n `lpSizeL`  \n A pointer to the **SIZEL** structure that uses long integers to represent the width and height of the control, expressed in **HIMETRIC** units.  \n  \n### Return Value  \n Nonzero if the size change was accepted; otherwise 0.  \n  \n### Remarks  \n The default implementation handles the resizing of the control's extent. If the control is in-place active, a call to the container's **OnPosRectChanged** is then made.  \n  \n Override this function to alter the default resizing of your control.  \n  \n##  <a name=\"colecontrol__onsetobjectrects\"></a>  COleControl::OnSetObjectRects  \n Called by the framework to implement a call to [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767).  \n  \n```  \nvirtual BOOL OnSetObjectRects(\n    LPCRECT lpRectPos,  \n    LPCRECT lpRectClip);\n```  \n  \n### Parameters  \n *lpRectPos*  \n A pointer to a RECT structure indicating the control's new position and size relative to the container.  \n  \n `lpRectClip`  \n A pointer to a `RECT` structure indicating a rectangular area to which the control is to be clipped.  \n  \n### Return Value  \n Nonzero if the repositioning was accepted; otherwise 0.  \n  \n### Remarks  \n The default implementation automatically handles the repositioning and resizing of the control window and returns **TRUE**.  \n  \n Override this function to alter the default behavior of this function.  \n  \n##  <a name=\"colecontrol__onshowtoolbars\"></a>  COleControl::OnShowToolBars  \n Called by the framework when the control has been UI activated.  \n  \n```  \nvirtual void OnShowToolBars();\n```  \n  \n### Remarks  \n The default implementation does nothing.  \n  \n##  <a name=\"colecontrol__ontextchanged\"></a>  COleControl::OnTextChanged  \n Called by the framework when the stock Caption or Text property value has changed.  \n  \n```  \nvirtual void OnTextChanged();\n```  \n  \n### Remarks  \n The default implementation calls `InvalidateControl`.  \n  \n Override this function if you want notification after this property changes.  \n  \n##  <a name=\"colecontrol__onwindowlessmessage\"></a>  COleControl::OnWindowlessMessage  \n Called by the framework in response to a container's **IOleInPlaceObjectWindowless::OnWindowMessage** request.  \n  \n```  \nvirtual BOOL OnWindowlessMessage(\n    UINT msg,\n    WPARAM wParam,\n    LPARAM lParam,\n    LRESULT* plResult);\n```  \n  \n### Parameters  \n `msg`  \n Message identifier as passed by Windows.  \n  \n `wParam`  \n As passed by Windows. Specifies additional message-specific information. The contents of this parameter depend on the value of the `msg` parameter.  \n  \n `lParam`  \n As passed by Windows. Specifies additional message-specific information. The contents of this parameter depend on the value of the `msg` parameter.  \n  \n *plResult*  \n Windows result code. Specifies the result of the message processing and depends on the message sent.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n Processes window messages for windowless controls. `COleControl`'s `OnWindowlessMessage` should be used for window messages other than mouse messages and keyboard messages. `COleControl` provides [SetCapture](#colecontrol__setcapture) and [SetFocus](#colecontrol__setfocus) specifically to get mouse capture and keyboard focus for windowless OLE objects.  \n  \n Because windowless objects do not have a window, they need a mechanism to let the container dispatch messages to them. A windowless OLE object gets messages from its container, through the `OnWindowMessage` method on the `IOleInPlaceObjectWindowless` interface (an extension of [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) for windowless support). `OnWindowMessage` does not take an `HWND` parameter.  \n  \n##  <a name=\"colecontrol__parenttoclient\"></a>  COleControl::ParentToClient  \n Translates the coordinates of `pPoint` into client coordinates.  \n  \n```  \nvirtual UINT ParentToClient(\n    LPCRECT lprcBounds,\n    LPPOINT pPoint,\n    BOOL bHitTest = FALSE) const;\n\n \n```  \n  \n### Parameters  \n `lprcBounds`  \n Pointer to the bounds of the OLE control within the container. Not the client area but the area of the entire control including borders and scroll bars.  \n  \n `pPoint`  \n Pointer to the parent (container) point to be translated into the coordinates of the client area of the control.  \n  \n `bHitTest`  \n Specifies whether or not hit testing is to be done on the point.  \n  \n### Return Value  \n If `bHitTest` is **FALSE**, returns **HTNOWHERE**. If `bHitTest` is **TRUE**, returns the location in which the parent (container) point landed in the client area of the OLE control and is one of the following mouse hit-test values:  \n  \n- **HTBORDER** In the border of a window that does not have a sizing border.  \n  \n- **HTBOTTOM** In the lower horizontal border of the window.  \n  \n- **HTBOTTOMLEFT** In the lower-left corner of the window border.  \n  \n- **HTBOTTOMRIGHT** In the lower-right corner of the window border.  \n  \n- **HTCAPTION** In a title-bar area.  \n  \n- **HTCLIENT** In a client area.  \n  \n- **HTERROR** On the screen background or on a dividing line between windows (same as **HTNOWHERE** except that the **DefWndProc** Windows function produces a system beep to indicate an error).  \n  \n- **HTGROWBOX** In a size box.  \n  \n- **HTHSCROLL** In the horizontal scroll bar.  \n  \n- **HTLEFT** In the left border of the window.  \n  \n- **HTMAXBUTTON** In a Maximize button.  \n  \n- **HTMENU** In a menu area.  \n  \n- **HTMINBUTTON** In a Minimize button.  \n  \n- **HTNOWHERE** On the screen background or on a dividing line between windows.  \n  \n- **HTREDUCE** In a Minimize button.  \n  \n- **HTRIGHT** In the right border of the window.  \n  \n- **HTSIZE** In a size box (same as **HTGROWBOX**).  \n  \n- **HTSYSMENU** In a Control menu or in a Close button in a child window.  \n  \n- **HTTOP** In the upper horizontal border of the window.  \n  \n- **HTTOPLEFT** In the upper-left corner of the window border.  \n  \n- **HTTOPRIGHT** In the upper-right corner of the window border.  \n  \n- **HTTRANSPARENT** In a window currently covered by another window.  \n  \n- **HTVSCROLL** In the vertical scroll bar.  \n  \n- **HTZOOM** In a Maximize button.  \n  \n### Remarks  \n On input `pPoint` is relative to the origin of the parent (upper left corner of the container). On output `pPoint` is relative to the origin of the client area of the OLE control (upper left corner of the client area of the control).  \n  \n##  <a name=\"colecontrol__postmodaldialog\"></a>  COleControl::PostModalDialog  \n Notifies the container that a modal dialog box has been closed.  \n  \n```  \nvoid PostModalDialog(HWND hWndParent = NULL);\n```  \n  \n### Parameters  \n `hWndParent`  \n Handle to the parent window of the modal dialog box.  \n  \n### Remarks  \n Call this function after displaying any modal dialog box. You must call this function so that the container can enable any top-level windows disabled by `PreModalDialog`. This function should be paired with a call to `PreModalDialog`.  \n  \n##  <a name=\"colecontrol__premodaldialog\"></a>  COleControl::PreModalDialog  \n Notifies the container that a modal dialog box is about to be displayed.  \n  \n```  \nvoid PreModalDialog(HWND hWndParent = NULL);\n```  \n  \n### Parameters  \n `hWndParent`  \n Handle to the parent window of the modal dialog box.  \n  \n### Remarks  \n Call this function before displaying any modal dialog box. You must call this function so that the container can disable all its top-level windows. After the modal dialog box has been displayed, you must then call `PostModalDialog`.  \n  \n##  <a name=\"colecontrol__recreatecontrolwindow\"></a>  COleControl::RecreateControlWindow  \n Destroys and re-creates the control's window.  \n  \n```  \nvoid RecreateControlWindow();\n```  \n  \n### Remarks  \n This may be necessary if you need to change the window's style bits.  \n  \n##  <a name=\"colecontrol__refresh\"></a>  COleControl::Refresh  \n Forces a repaint of the OLE control.  \n  \n```  \nvoid Refresh();\n```  \n  \n### Remarks  \n This function is supported by the `COleControl` base class as a stock method, called Refresh. This allows users of your OLE control to repaint the control at a specific time. For more information on this method, see the article [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).  \n  \n##  <a name=\"colecontrol__releasecapture\"></a>  COleControl::ReleaseCapture  \n Releases mouse capture.  \n  \n```  \nBOOL ReleaseCapture();\n```  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n If the control currently has the mouse capture, the capture is released. Otherwise, this function has no effect.  \n  \n##  <a name=\"colecontrol__releasedc\"></a>  COleControl::ReleaseDC  \n Releases the display device context of a container of a windowless control, freeing the device context for use by other applications.  \n  \n```  \nint ReleaseDC(CDC* pDC);\n```  \n  \n### Parameters  \n `pDC`  \n Identifies the container device context to be released.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n The application must call `ReleaseDC` for each call to [GetDC](#colecontrol__getdc).  \n  \n##  <a name=\"colecontrol__reparentcontrolwindow\"></a>  COleControl::ReparentControlWindow  \n Sets the parent of the control.  \n  \n```  \nvirtual void ReparentControlWindow(\n    HWND hWndOuter,  \n    HWND hWndParent);\n```  \n  \n### Parameters  \n *hWndOuter*  \n The handle of the control window.  \n  \n `hWndParent`  \n The handle of the new parent window.  \n  \n### Remarks  \n Call this function to reset the parent of the control window.  \n  \n##  <a name=\"colecontrol__resetstockprops\"></a>  COleControl::ResetStockProps  \n Initializes the state of the `COleControl` stock properties to their default values.  \n  \n```  \nvoid ResetStockProps();\n```  \n  \n### Remarks  \n The properties are: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, hWnd, and Text. For a description of stock properties, see [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).  \n  \n You can improve a control's binary initialization performance by using `ResetStockProps` and `ResetVersion` to override `COleControl::OnResetState`. See the example below. For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).  \n  \n### Example  \n [!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  \n  \n##  <a name=\"colecontrol__resetversion\"></a>  COleControl::ResetVersion  \n Initializes the version number to specified value.  \n  \n```  \nvoid ResetVersion(DWORD dwVersionDefault);\n```  \n  \n### Parameters  \n `dwVersionDefault`  \n The version number to be assigned to the control.  \n  \n### Remarks  \n You can improve a control's binary initialization performance by using `ResetVersion` and `ResetStockProps` to override `COleControl::OnResetState`. See the example at [ResetStockProps](#colecontrol__resetstockprops). For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).  \n  \n##  <a name=\"colecontrol__scrollwindow\"></a>  COleControl::ScrollWindow  \n Allows a windowless OLE object to scroll an area within its in-place active image on the screen.  \n  \n```  \nvoid ScrollWindow(\n    int xAmount,\n    int yAmount,\n    LPCRECT lpRect = NULL,\n    LPCRECT lpClipRect = NULL);\n```  \n  \n### Parameters  \n `xAmount`  \n Specifies the amount, in device units, of horizontal scrolling. This parameter must be a negative value to scroll to the left.  \n  \n `yAmount`  \n Specifies the amount, in device units, of vertical scrolling. This parameter must be a negative value to scroll upward.  \n  \n `lpRect`  \n Points to a [CRect](../../atl-mfc-shared/reference/crect-class.md) object or RECT structure that specifies the portion of the OLE object's client area to scroll, in client coordinates of the containing window. If `lpRect` is **NULL**, the entire OLE object's client area is scrolled.  \n  \n `lpClipRect`  \n Points to a `CRect` object or `RECT` structure that specifies the rectangle to clip to. Only pixels inside the rectangle are scrolled. Bits outside the rectangle are not affected even if they are in the `lpRect` rectangle. If `lpClipRect` is **NULL**, no clipping is performed on the scroll rectangle.  \n  \n##  <a name=\"colecontrol__selectfontobject\"></a>  COleControl::SelectFontObject  \n Selects a font into a device context.  \n  \n```  \nCFont* SelectFontObject(\n    CDC* pDC,  \n    CFontHolder& fontHolder);\n```  \n  \n### Parameters  \n `pDC`  \n Pointer to a device context object.  \n  \n `fontHolder`  \n Reference to the [CFontHolder](../../mfc/reference/cfontholder-class.md) object representing the font to be selected.  \n  \n### Return Value  \n A pointer to the previously selected font. When the caller has finished all drawing operations that use *fontHolder,* it should reselect the previously selected font by passing it as a parameter to [CDC::SelectObject](../../mfc/reference/cdc-class.md#cdc__selectobject).  \n  \n##  <a name=\"colecontrol__selectstockfont\"></a>  COleControl::SelectStockFont  \n Selects the stock Font property into a device context.  \n  \n```  \nCFont* SelectStockFont(CDC* pDC);\n```  \n  \n### Parameters  \n `pDC`  \n The device context into which the font will be selected.  \n  \n### Return Value  \n A pointer to the previously selected `CFont` object. You should use [CDC::SelectObject](../../mfc/reference/cdc-class.md#cdc__selectobject) to select this font back into the device context when you are finished.  \n  \n##  <a name=\"colecontrol__serializeextent\"></a>  COleControl::SerializeExtent  \n Serializes or initializes the state of the display space allotted to the control.  \n  \n```  \nvoid SerializeExtent(CArchive& ar);\n```  \n  \n### Parameters  \n `ar`  \n A `CArchive` object to serialize to or from.  \n  \n### Remarks  \n You can improve a control's binary persistence performance by using `SerializeExtent`, `SerializeStockProps`, and `SerializeVersion` to override **COleControl::Serialize**. See the example below. For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).  \n  \n### Example  \n [!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  \n  \n##  <a name=\"colecontrol__serializestockprops\"></a>  COleControl::SerializeStockProps  \n Serializes or initializes the state of the `COleControl` stock properties: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, and Text.  \n  \n```  \nvoid SerializeStockProps(CArchive& ar);\n```  \n  \n### Parameters  \n `ar`  \n A `CArchive` object to serialize to or from.  \n  \n### Remarks  \n For a description of stock properties, see [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).  \n  \n You can improve a control's binary persistence performance by using `SerializeStockProps`, `SerializeExtent`, and `SerializeVersion` to override **COleControl::Serialize**. For an example, see the code at [SerializeExtent](#colecontrol__serializeextent). For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).  \n  \n##  <a name=\"colecontrol__serializeversion\"></a>  COleControl::SerializeVersion  \n Serializes or initializes the state of a control's version information.  \n  \n```  \nDWORD SerializeVersion(\n    CArchive& ar,\n    DWORD dwVersionDefault,\n    BOOL bConvert = TRUE);\n```  \n  \n### Parameters  \n `ar`  \n A `CArchive` object to serialize to or from.  \n  \n `dwVersionDefault`  \n The current version number of the control.  \n  \n `bConvert`  \n Indicates whether persistent data should be converted to the latest format when it is saved, or maintained in the same format it had when it was loaded.  \n  \n### Return Value  \n The version number of the control. If the specified archive is loading, `SerializeVersion` returns the version loaded from that archive. Otherwise, it returns the currently loaded version.  \n  \n### Remarks  \n You can improve a control's binary persistence performance by using `SerializeVersion`, `SerializeExtent`, and `SerializeStockProps` to override **COleControl::Serialize**. For an example, see the code at [SerializeExtent](#colecontrol__serializeextent). For further information on optimizing initialization, see [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).  \n  \n##  <a name=\"colecontrol__setappearance\"></a>  COleControl::SetAppearance  \n Sets the stock Appearance property value of your control.  \n  \n```  \nvoid SetAppearance (short sAppearance);\n```  \n  \n### Parameters  \n *sAppearance*  \n A **short** ( `VT_I2`) value to be used for the appearance of your control. A value of zero sets the control's appearance to flat and a value of 1 sets the control's appearance to 3D.  \n  \n### Remarks  \n For more about stock properties, see [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).  \n  \n##  <a name=\"colecontrol__setbackcolor\"></a>  COleControl::SetBackColor  \n Sets the stock BackColor property value of your control.  \n  \n```  \nvoid SetBackColor(OLE_COLOR dwBackColor);\n```  \n  \n### Parameters  \n *dwBackColor*  \n An **OLE_COLOR** value to be used for background drawing of your control.  \n  \n### Remarks  \n For more information on using this property and other related properties, see the article [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).  \n  \n##  <a name=\"colecontrol__setborderstyle\"></a>  COleControl::SetBorderStyle  \n Sets the stock BorderStyle property value of your control.  \n  \n```  \nvoid SetBorderStyle(short sBorderStyle);\n```  \n  \n### Parameters  \n *sBorderStyle*  \n The new border style for the control; 0 indicates no border and 1 indicates a normal border.  \n  \n### Remarks  \n The control window will then be re-created and `OnBorderStyleChanged` called.  \n  \n##  <a name=\"colecontrol__setcapture\"></a>  COleControl::SetCapture  \n Causes the control's container window to take possession of the mouse capture on the control's behalf.  \n  \n```  \nCWnd* SetCapture();\n```  \n  \n### Return Value  \n A pointer to the **CWnd** window object that previously received mouse input.  \n  \n### Remarks  \n If the control is activated and windowless, this function causes the control's container window to take possession of the mouse capture, on the control's behalf. Otherwise, this function causes the control itself to take possession of the mouse capture (same as `CWnd::SetCapture`).  \n  \n##  <a name=\"colecontrol__setcontrolsize\"></a>  COleControl::SetControlSize  \n Sets the size of the OLE control window and notifies the container that the control site is changing.  \n  \n```  \nBOOL SetControlSize(\n    int cx, int cy);\n```  \n  \n### Parameters  \n `cx`  \n Specifies the new width of the control in pixels.  \n  \n `cy`  \n Specifies the new height of the control in pixels.  \n  \n### Return Value  \n Nonzero if the call was successful; otherwise 0.  \n  \n### Remarks  \n This function should not be used in your control's constructor.  \n  \n Note that all coordinates for control windows are relative to the upper-left corner of the control.  \n  \n##  <a name=\"colecontrol__setenabled\"></a>  COleControl::SetEnabled  \n Sets the stock Enabled property value of your control.  \n  \n```  \nvoid SetEnabled(BOOL bEnabled);\n```  \n  \n### Parameters  \n `bEnabled`  \n **TRUE** if the control is to be enabled; otherwise **FALSE**.  \n  \n### Remarks  \n After setting this property, **OnEnabledChange** is called.  \n  \n##  <a name=\"colecontrol__setfocus\"></a>  COleControl::SetFocus  \n Causes the control's container window to take possession of the input focus on the control's behalf.  \n  \n```  \nCWnd* SetFocus();\n```  \n  \n### Return Value  \n A pointer to the **CWnd** window object that previously had the input focus, or **NULL** if there is no such window.  \n  \n### Remarks  \n If the control is activated and windowless, this function causes the control's container window to take possession of the input focus, on the control's behalf. The input focus directs keyboard input to the container's window, and the container dispatches all subsequent keyboard messages to the OLE object that calls `SetFocus`. Any window that previously had the input focus loses it.  \n  \n If the control is not windowless, this function causes the control itself to take possession of the input focus (same as `CWnd::SetFocus`).  \n  \n##  <a name=\"colecontrol__setfont\"></a>  COleControl::SetFont  \n Sets the stock Font property of your control.  \n  \n```  \nvoid SetFont(LPFONTDISP pFontDisp);\n```  \n  \n### Parameters  \n *pFontDisp*  \n A pointer to a Font dispatch interface.  \n  \n##  <a name=\"colecontrol__setforecolor\"></a>  COleControl::SetForeColor  \n Sets the stock ForeColor property value of your control.  \n  \n```  \nvoid SetForeColor(OLE_COLOR dwForeColor);\n```  \n  \n### Parameters  \n *dwForeColor*  \n An **OLE_COLOR** value to be used for foreground drawing of your control.  \n  \n### Remarks  \n For more information on using this property and other related properties, see the article [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).  \n  \n##  <a name=\"colecontrol__setinitialdataformats\"></a>  COleControl::SetInitialDataFormats  \n Called by the framework to initialize the list of data formats supported by the control.  \n  \n```  \nvirtual void SetInitialDataFormats();\n```  \n  \n### Remarks  \n The default implementation specifies two formats: `CF_METAFILEPICT` and the persistent property set.  \n  \n##  <a name=\"colecontrol__setinitialsize\"></a>  COleControl::SetInitialSize  \n Sets the size of an OLE control when first displayed in a container.  \n  \n```  \nvoid SetInitialSize(\n    int cx,  \n    int cy);\n```  \n  \n### Parameters  \n `cx`  \n The initial width of the OLE control in pixels.  \n  \n `cy`  \n The initial height of the OLE control in pixels.  \n  \n### Remarks  \n Call this function in your constructor to set the initial size of your control. The initial size is measured in device units, or pixels. It is recommended that this call be made in your control's constructor.  \n  \n##  <a name=\"colecontrol__setmodifiedflag\"></a>  COleControl::SetModifiedFlag  \n Changes the modified state of a control.  \n  \n```  \nvoid SetModifiedFlag(BOOL bModified = TRUE);\n```  \n  \n### Parameters  \n `bModified`  \n The new value for the control's modified flag. **TRUE** indicates that the control's state has been modified; **FALSE** indicates that the control's state has just been saved.  \n  \n### Remarks  \n Call this function whenever a change occurs that would affect your control's persistent state. For example, if the value of a persistent property changes, call this function with `bModified`**TRUE**.  \n  \n##  <a name=\"colecontrol__setnotpermitted\"></a>  COleControl::SetNotPermitted  \n Indicates that an edit request has failed.  \n  \n```  \nvoid SetNotPermitted();\n```  \n  \n### Remarks  \n Call this function when `BoundPropertyRequestEdit` fails. This function throws an exception of type **COleDispScodeException** to indicate that the set operation was not permitted.  \n  \n##  <a name=\"colecontrol__setnotsupported\"></a>  COleControl::SetNotSupported  \n Prevents modification to a control's property value by the user.  \n  \n```  \nvoid SetNotSupported();\n```  \n  \n### Remarks  \n Call this function in place of the Set function of any property where modification of the property value by the control's user is not supported. One example would be a property that is read only.  \n  \n##  <a name=\"colecontrol__setrectincontainer\"></a>  COleControl::SetRectInContainer  \n Sets the coordinates of the control's rectangle relative to the container, expressed in device units.  \n  \n```  \nBOOL SetRectInContainer(LPCRECT lpRect);\n```  \n  \n### Parameters  \n `lpRect`  \n A pointer to a rectangle containing the control's new coordinates relative to the container.  \n  \n### Return Value  \n Nonzero if the call was successful; otherwise 0.  \n  \n### Remarks  \n If the control is open, it is resized; otherwise the container's **OnPosRectChanged** function is called.  \n  \n##  <a name=\"colecontrol__settext\"></a>  COleControl::SetText  \n Sets the value of your control's stock Caption or Text property.  \n  \n```  \nvoid SetText(LPCTSTR pszText);\n```  \n  \n### Parameters  \n `pszText`  \n A pointer to a character string.  \n  \n### Remarks  \n Note that the stock Caption and Text properties are both mapped to the same value. This means that any changes made to either property will automatically change both properties. In general, a control should support either the stock Caption or Text property, but not both.  \n  \n##  <a name=\"colecontrol__throwerror\"></a>  COleControl::ThrowError  \n Signals the occurrence of an error in your control.  \n  \n```  \nvoid ThrowError(\n    SCODE sc,  \n    UINT nDescriptionID,  \n    UINT nHelpID = -1);\n\n \nvoid ThrowError(\n    SCODE sc,  \n    LPCTSTR pszDescription = NULL,  \n    UINT nHelpID = 0);\n```  \n  \n### Parameters  \n `sc`  \n The status code value to be reported. For a complete list of possible codes, see the article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).  \n  \n `nDescriptionID`  \n The string resource ID of the exception to be reported.  \n  \n `nHelpID`  \n The help ID of the topic to be reported on.  \n  \n `pszDescription`  \n A string containing an explanation of the exception to be reported.  \n  \n### Remarks  \n This function should only be called from within a Get or Set function for an OLE property, or the implementation of an OLE automation method. If you need to signal errors that occur at other times, you should fire the stock Error event.  \n  \n##  <a name=\"colecontrol__transformcoords\"></a>  COleControl::TransformCoords  \n Transforms coordinate values between **HIMETRIC** units and the container's native units.  \n  \n```  \nvoid TransformCoords(\n    POINTL* lpptlHimetric,  \n    POINTF* lpptfContainer,  \n    DWORD flags);\n```  \n  \n### Parameters  \n *lpptlHimetric*  \n Pointer to a **POINTL** structure containing coordinates in **HIMETRIC** units.  \n  \n *lpptfContainer*  \n Pointer to a **POINTF** structure containing coordinates in the container's unit size.  \n  \n `flags`  \n A combination of the following values:  \n  \n- **XFORMCOORDS_POSITION** A position in the container.  \n  \n- **XFORMCOORDS_SIZE** A size in the container.  \n  \n- **XFORMCOORDS_HIMETRICTOCONTAINER** Transform **HIMETRIC** units to the container's units.  \n  \n- **XFORMCOORDS_CONTAINERTOHIMETRIC** Transform the container's units to **HIMETRIC** units.  \n  \n### Remarks  \n The first two flags, **XFORMCOORDS_POSITION** and **XFORMCOORDS_SIZE**, indicate whether the coordinates should be treated as a position or a size. The remaining two flags indicate the direction of transformation.  \n  \n##  <a name=\"colecontrol__translatecolor\"></a>  COleControl::TranslateColor  \n Converts a color value from the **OLE_COLOR** data type to the [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) data type.  \n  \n```  \nCOLORREF TranslateColor(\n    OLE_COLOR clrColor,  \n    HPALETTE hpal = NULL);\n```  \n  \n### Parameters  \n `clrColor`  \n A **OLE_COLOR** data type. For more information, see the Windows [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353) function.  \n  \n `hpal`  \n A handle to an optional palette; can be **NULL**.  \n  \n### Return Value  \n An RGB (red, green, blue) 32-bit color value that defines the solid color closest to the `clrColor` value that the device can represent.  \n  \n### Remarks  \n This function is useful to translate the stock ForeColor and BackColor properties to **COLORREF** types used by [CDC](../../mfc/reference/cdc-class.md) member functions.  \n  \n##  <a name=\"colecontrol__willambientsbevalidduringload\"></a>  COleControl::WillAmbientsBeValidDuringLoad  \n Determines whether your control should use the values of ambient properties as default values, when it is subsequently loaded from its persistent state.  \n  \n```  \nBOOL WillAmbientsBeValidDuringLoad();\n```  \n  \n### Return Value  \n Nonzero indicates that ambient properties will be valid; otherwise ambient properties will not be valid.  \n  \n### Remarks  \n In some containers, your control may not have access to its ambient properties during the initial call to the override of `COleControl::DoPropExchange`. This is the case if the container calls [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) or [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) prior to calling [IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (that is, if it does not honor the **OLEMISC_SETCLIENTSITEFIRST** status bit).  \n  \n##  <a name=\"colecontrol__windowproc\"></a>  COleControl::WindowProc  \n Provides a Windows procedure for a `COleControl` object.  \n  \n```  \nvirtual LRESULT WindowProc(\n    UINT message,  \n    WPARAM wParam,  \n    LPARAM lParam);\n```  \n  \n### Parameters  \n `message`  \n Specifies the Windows message to be processed.  \n  \n `wParam`  \n Provides additional information used in processing the message. The parameter value depends on the message.  \n  \n `lParam`  \n Provides additional information used in processing the message. The parameter value depends on the message.  \n  \n### Return Value  \n The return value of the message dispatched.  \n  \n### Remarks  \n Call this function to dispatch specific messages through the control's message map.  \n  \n## See Also  \n [MFC Sample CIRC3](../../visual-cpp-samples.md)   \n [MFC Sample TESTHELP](../../visual-cpp-samples.md)   \n [COlePropertyPage Class](../../mfc/reference/colepropertypage-class.md)   \n [CWnd Class](../../mfc/reference/cwnd-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CFontHolder Class](../../mfc/reference/cfontholder-class.md)   \n [CPictureHolder Class](../../mfc/reference/cpictureholder-class.md)\n"}