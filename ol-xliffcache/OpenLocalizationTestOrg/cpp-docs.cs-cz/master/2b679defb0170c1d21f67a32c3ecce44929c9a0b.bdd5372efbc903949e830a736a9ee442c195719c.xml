{"nodes":[{"pos":[12,45],"content":"CDockState Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDockState Class | Microsoft Docs","pos":[0,33]}]},{"content":"CDockState Class","pos":[773,789]},{"pos":[790,926],"content":"A serialized <ph id=\"ph1\">`CObject`</ph> class that loads, unloads, or clears the state of one or more docking control bars in persistent memory (a file).","source":"A serialized `CObject` class that loads, unloads, or clears the state of one or more docking control bars in persistent memory (a file)."},{"content":"Syntax","pos":[935,941]},{"content":"Members","pos":[1001,1008]},{"content":"Public Methods","pos":[1018,1032]},{"content":"Name","pos":[1039,1043]},{"content":"Description","pos":[1044,1055]},{"content":"CDockState::Clear","pos":[1094,1111]},{"content":"Clears the dock state information.","pos":[1133,1167]},{"content":"CDockState::GetVersion","pos":[1173,1195]},{"content":"Retrieves the version number of the stored bar state.","pos":[1222,1275]},{"content":"CDockState::LoadState","pos":[1281,1302]},{"content":"Retrieves state information from the registry or .INI file.","pos":[1328,1387]},{"content":"CDockState::SaveState","pos":[1393,1414]},{"content":"Saves state information to the registry or INI file.","pos":[1440,1492]},{"content":"Public Data Members","pos":[1503,1522]},{"content":"Name","pos":[1529,1533]},{"content":"Description","pos":[1534,1545]},{"content":"CDockState::m_arrBarInfo","pos":[1584,1608]},{"content":"Array of pointers to the stored dock state information with one entry for each control bar.","pos":[1637,1728]},{"content":"Remarks","pos":[1738,1745]},{"content":"The dock state includes the size and position of the bar and whether or not it is docked.","pos":[1749,1838]},{"content":"When retrieving the stored dock state, <ph id=\"ph1\">`CDockState`</ph> checks the bar's position and, if the bar is not visible with the current screen settings, <ph id=\"ph2\">`CDockState`</ph> scales the bar's position so that it is visible.","pos":[1839,2043],"source":" When retrieving the stored dock state, `CDockState` checks the bar's position and, if the bar is not visible with the current screen settings, `CDockState` scales the bar's position so that it is visible."},{"content":"The main purpose of <ph id=\"ph1\">`CDockState`</ph> is to hold the entire state of a number of control bars and to allow that state to be saved and loaded either to the registry, the application's .INI file, or in binary form as part of a <ph id=\"ph2\">`CArchive`</ph> object's contents.","pos":[2044,2293],"source":" The main purpose of `CDockState` is to hold the entire state of a number of control bars and to allow that state to be saved and loaded either to the registry, the application's .INI file, or in binary form as part of a `CArchive` object's contents."},{"content":"The bar can be any dockable control bar, including a toolbar, status bar, or dialog bar.","pos":[2300,2388]},{"content":"objects are written and read to or from a file via a <ph id=\"ph1\">`CArchive`</ph> object.","pos":[2402,2473],"source":" objects are written and read to or from a file via a `CArchive` object."},{"content":"<bpt id=\"p1\">[</bpt>CFrameWnd::GetDockState<ept id=\"p1\">](../../mfc/reference/cframewnd-class.md#cframewnd__getdockstate)</ept> retrieves the state information of all the frame window's <ph id=\"ph1\">`CControlBar`</ph> objects and puts it into the <ph id=\"ph2\">`CDockState`</ph> object.","pos":[2480,2691],"source":"[CFrameWnd::GetDockState](../../mfc/reference/cframewnd-class.md#cframewnd__getdockstate) retrieves the state information of all the frame window's `CControlBar` objects and puts it into the `CDockState` object."},{"content":"You can then write the contents of the <ph id=\"ph1\">`CDockState`</ph> object to storage with <bpt id=\"p1\">[</bpt>Serialize<ept id=\"p1\">](../../mfc/reference/cobject-class.md#cobject__serialize)</ept> or <bpt id=\"p2\">[</bpt>CDockState::SaveState<ept id=\"p2\">](#cdockstate__savestate)</ept>.","pos":[2692,2887],"source":" You can then write the contents of the `CDockState` object to storage with [Serialize](../../mfc/reference/cobject-class.md#cobject__serialize) or [CDockState::SaveState](#cdockstate__savestate)."},{"content":"If you later want to restore the state of the control bars in the frame window, you can load the state with <ph id=\"ph1\">`Serialize`</ph> or <bpt id=\"p1\">[</bpt>CDockState::LoadState<ept id=\"p1\">](#cdockstate__loadstate)</ept>, then use <bpt id=\"p2\">[</bpt>CFrameWnd::SetDockState<ept id=\"p2\">](../../mfc/reference/cframewnd-class.md#cframewnd__setdockstate)</ept> to apply the saved state to the frame window's control bars.","pos":[2888,3219],"source":" If you later want to restore the state of the control bars in the frame window, you can load the state with `Serialize` or [CDockState::LoadState](#cdockstate__loadstate), then use [CFrameWnd::SetDockState](../../mfc/reference/cframewnd-class.md#cframewnd__setdockstate) to apply the saved state to the frame window's control bars."},{"pos":[3226,3458],"content":"For more information on docking control bars, see the articles <bpt id=\"p1\">[</bpt>Control Bars<ept id=\"p1\">](../../mfc/control-bars.md)</ept>, <bpt id=\"p2\">[</bpt>Toolbars: Docking and Floating<ept id=\"p2\">](../../mfc/docking-and-floating-toolbars.md)</ept>, and <bpt id=\"p3\">[</bpt>Frame Windows<ept id=\"p3\">](../../mfc/frame-windows.md)</ept>.","source":"For more information on docking control bars, see the articles [Control Bars](../../mfc/control-bars.md), [Toolbars: Docking and Floating](../../mfc/docking-and-floating-toolbars.md), and [Frame Windows](../../mfc/frame-windows.md)."},{"content":"Inheritance Hierarchy","pos":[3467,3488]},{"content":"CObject","pos":[3493,3500]},{"content":"Requirements","pos":[3567,3579]},{"pos":[3583,3603],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxadv.h","source":"**Header:** afxadv.h"},{"pos":[3647,3664],"content":"CDockState::Clear"},{"pos":[3668,3754],"content":"Call this function to clear all docking information stored in the <ph id=\"ph1\">`CDockState`</ph> object.","source":"Call this function to clear all docking information stored in the `CDockState` object."},{"content":"Remarks","pos":[3793,3800]},{"content":"This includes not only whether the bar is docked or not, but the bar's size and position and whether or not it is visible.","pos":[3804,3926]},{"pos":[3975,3997],"content":"CDockState::GetVersion"},{"content":"Call this function to retrieve the version number of the stored bar state.","pos":[4001,4075]},{"content":"Return Value","pos":[4120,4132]},{"content":"1 if the stored bar information is older than current bar state; 2 if the stored bar information is the same as the current bar state.","pos":[4136,4270]},{"content":"Remarks","pos":[4280,4287]},{"content":"Version support enables a revised bar to add new persistent properties and still be able to detect and load the persistent state created by an earlier version of the bar.","pos":[4291,4461]},{"pos":[4509,4530],"content":"CDockState::LoadState"},{"content":"Call this function to retrieve state information from the registry or .INI file.","pos":[4534,4614]},{"content":"Parameters","pos":[4680,4690]},{"content":"Points to a null-teminated string that specifies the name of a section in the initialization file or a key in the Windows registry where state information is stored.","pos":[4715,4880]},{"content":"Remarks","pos":[4890,4897]},{"content":"The profile name is the section of the application's .INI file or the registry that contains the bars' state information.","pos":[4901,5022]},{"content":"You can save control bar state information to the registry or .INI file with <ph id=\"ph1\">`SaveState`</ph>.","pos":[5023,5112],"source":" You can save control bar state information to the registry or .INI file with `SaveState`."},{"pos":[5163,5187],"content":"CDockState::m_arrBarInfo"},{"pos":[5191,5360],"content":"A <ph id=\"ph1\">`CPtrArray`</ph> object that is an array of pointers to the stored control bar information for each control bar that has saved state information in the <ph id=\"ph2\">`CDockState`</ph> object.","source":"A `CPtrArray` object that is an array of pointers to the stored control bar information for each control bar that has saved state information in the `CDockState` object."},{"pos":[5449,5470],"content":"CDockState::SaveState"},{"content":"Call this function to save the state information to the registry or .INI file.","pos":[5474,5552]},{"content":"Parameters","pos":[5618,5628]},{"content":"Points to a null-teminated string that specifies the name of a section in the initialization file or a key in the Windows registry where state information is stored.","pos":[5653,5818]},{"content":"Remarks","pos":[5828,5835]},{"content":"The profile name is the section of the application's .INI file or the registry that contains the control bar's state information.","pos":[5839,5968]},{"content":"also saves the current screen size.","pos":[5981,6016]},{"content":"You can retrieve control bar information from the registry or .INI file with <ph id=\"ph1\">`LoadState`</ph>.","pos":[6017,6106],"source":" You can retrieve control bar information from the registry or .INI file with `LoadState`."},{"content":"See Also","pos":[6115,6123]},{"content":"CObject Class","pos":[6128,6141]},{"content":"Hierarchy Chart","pos":[6186,6201]}],"content":"---\ntitle: \"CDockState Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDockState\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"dock state\"\n  - \"size\"\n  - \"docking control bars\"\n  - \"CDockState class\"\n  - \"states, dockable control bar\"\n  - \"position, control bar\"\n  - \"size, control bar\"\n  - \"docking tool windows\"\nms.assetid: 09e7c10b-3abd-4cb2-ad36-42420fe6bc36\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDockState Class\nA serialized `CObject` class that loads, unloads, or clears the state of one or more docking control bars in persistent memory (a file).  \n  \n## Syntax  \n  \n```  \nclass CDockState : public CObject  \n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDockState::Clear](#cdockstate__clear)|Clears the dock state information.|  \n|[CDockState::GetVersion](#cdockstate__getversion)|Retrieves the version number of the stored bar state.|  \n|[CDockState::LoadState](#cdockstate__loadstate)|Retrieves state information from the registry or .INI file.|  \n|[CDockState::SaveState](#cdockstate__savestate)|Saves state information to the registry or INI file.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDockState::m_arrBarInfo](#cdockstate__m_arrbarinfo)|Array of pointers to the stored dock state information with one entry for each control bar.|  \n  \n## Remarks  \n The dock state includes the size and position of the bar and whether or not it is docked. When retrieving the stored dock state, `CDockState` checks the bar's position and, if the bar is not visible with the current screen settings, `CDockState` scales the bar's position so that it is visible. The main purpose of `CDockState` is to hold the entire state of a number of control bars and to allow that state to be saved and loaded either to the registry, the application's .INI file, or in binary form as part of a `CArchive` object's contents.  \n  \n The bar can be any dockable control bar, including a toolbar, status bar, or dialog bar. `CDockState` objects are written and read to or from a file via a `CArchive` object.  \n  \n [CFrameWnd::GetDockState](../../mfc/reference/cframewnd-class.md#cframewnd__getdockstate) retrieves the state information of all the frame window's `CControlBar` objects and puts it into the `CDockState` object. You can then write the contents of the `CDockState` object to storage with [Serialize](../../mfc/reference/cobject-class.md#cobject__serialize) or [CDockState::SaveState](#cdockstate__savestate). If you later want to restore the state of the control bars in the frame window, you can load the state with `Serialize` or [CDockState::LoadState](#cdockstate__loadstate), then use [CFrameWnd::SetDockState](../../mfc/reference/cframewnd-class.md#cframewnd__setdockstate) to apply the saved state to the frame window's control bars.  \n  \n For more information on docking control bars, see the articles [Control Bars](../../mfc/control-bars.md), [Toolbars: Docking and Floating](../../mfc/docking-and-floating-toolbars.md), and [Frame Windows](../../mfc/frame-windows.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n `CDockState`  \n  \n## Requirements  \n **Header:** afxadv.h  \n  \n##  <a name=\"cdockstate__clear\"></a>  CDockState::Clear  \n Call this function to clear all docking information stored in the `CDockState` object.  \n  \n```  \nvoid Clear();\n```  \n  \n### Remarks  \n This includes not only whether the bar is docked or not, but the bar's size and position and whether or not it is visible.  \n  \n##  <a name=\"cdockstate__getversion\"></a>  CDockState::GetVersion  \n Call this function to retrieve the version number of the stored bar state.  \n  \n```  \nDWORD GetVersion();\n```  \n  \n### Return Value  \n 1 if the stored bar information is older than current bar state; 2 if the stored bar information is the same as the current bar state.  \n  \n### Remarks  \n Version support enables a revised bar to add new persistent properties and still be able to detect and load the persistent state created by an earlier version of the bar.  \n  \n##  <a name=\"cdockstate__loadstate\"></a>  CDockState::LoadState  \n Call this function to retrieve state information from the registry or .INI file.  \n  \n```  \nvoid LoadState(LPCTSTR lpszProfileName);\n```  \n  \n### Parameters  \n `lpszProfileName`  \n Points to a null-teminated string that specifies the name of a section in the initialization file or a key in the Windows registry where state information is stored.  \n  \n### Remarks  \n The profile name is the section of the application's .INI file or the registry that contains the bars' state information. You can save control bar state information to the registry or .INI file with `SaveState`.  \n  \n##  <a name=\"cdockstate__m_arrbarinfo\"></a>  CDockState::m_arrBarInfo  \n A `CPtrArray` object that is an array of pointers to the stored control bar information for each control bar that has saved state information in the `CDockState` object.  \n  \n```  \nCPtrArray m_arrBarInfo;  \n```  \n  \n##  <a name=\"cdockstate__savestate\"></a>  CDockState::SaveState  \n Call this function to save the state information to the registry or .INI file.  \n  \n```  \nvoid SaveState(LPCTSTR lpszProfileName);\n```  \n  \n### Parameters  \n `lpszProfileName`  \n Points to a null-teminated string that specifies the name of a section in the initialization file or a key in the Windows registry where state information is stored.  \n  \n### Remarks  \n The profile name is the section of the application's .INI file or the registry that contains the control bar's state information. `SaveState` also saves the current screen size. You can retrieve control bar information from the registry or .INI file with `LoadState`.  \n  \n## See Also  \n [CObject Class](../../mfc/reference/cobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n"}