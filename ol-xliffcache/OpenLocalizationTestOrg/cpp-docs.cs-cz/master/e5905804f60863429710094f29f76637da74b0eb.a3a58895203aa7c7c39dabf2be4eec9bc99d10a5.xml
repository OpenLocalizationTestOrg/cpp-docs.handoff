{"nodes":[{"pos":[12,54],"content":"CMFCPreviewCtrlImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCPreviewCtrlImpl Class | Microsoft Docs","pos":[0,42]}]},{"content":"CMFCPreviewCtrlImpl Class","pos":[664,689]},{"content":"This class implements a window that is placed on a host window provided by the Shell for Rich Preview.","pos":[690,792]},{"content":"Syntax","pos":[801,807]},{"content":"Members","pos":[874,881]},{"content":"Public Constructors","pos":[891,910]},{"content":"Name","pos":[917,921]},{"content":"Description","pos":[922,933]},{"content":"CMFCPreviewCtrlImpl::~CMFCPreviewCtrlImpl","pos":[972,1013]},{"content":"Destructs a preview control object.","pos":[1043,1078]},{"content":"CMFCPreviewCtrlImpl::CMFCPreviewCtrlImpl","pos":[1084,1124]},{"content":"Constructs a preview control object.","pos":[1169,1205]},{"content":"Public Methods","pos":[1216,1230]},{"content":"Name","pos":[1237,1241]},{"content":"Description","pos":[1242,1253]},{"content":"CMFCPreviewCtrlImpl::Create","pos":[1292,1319]},{"content":"Overloaded.","pos":[1351,1362]},{"content":"Called by a Rich Preview handler to create the Windows window.","pos":[1363,1425]},{"content":"CMFCPreviewCtrlImpl::Destroy","pos":[1431,1459]},{"content":"Called by a Rich Preview handler when it needs to destroy this control.","pos":[1492,1563]},{"content":"CMFCPreviewCtrlImpl::Focus","pos":[1569,1595]},{"content":"Sets input focus to this control.","pos":[1626,1659]},{"content":"CMFCPreviewCtrlImpl::GetDocument","pos":[1665,1697]},{"content":"Returns a document connected to this preview control.","pos":[1734,1787]},{"content":"CMFCPreviewCtrlImpl::Redraw","pos":[1793,1820]},{"content":"Tells this control to redraw.","pos":[1852,1881]},{"content":"CMFCPreviewCtrlImpl::SetDocument","pos":[1887,1919]},{"content":"Called by the preview handler to create a relationship between the document implementation and the preview control.","pos":[1956,2071]},{"content":"CMFCPreviewCtrlImpl::SetHost","pos":[2077,2105]},{"content":"Sets a new parent for this control.","pos":[2138,2173]},{"content":"CMFCPreviewCtrlImpl::SetPreviewVisuals","pos":[2179,2217]},{"content":"Called by a Rich Preview handler when it needs to set visuals of rich preview content.","pos":[2260,2346]},{"content":"CMFCPreviewCtrlImpl::SetRect","pos":[2352,2380]},{"content":"Sets a new bounding rectangle for this control.","pos":[2413,2460]},{"content":"Protected Methods","pos":[2471,2488]},{"content":"Name","pos":[2495,2499]},{"content":"Description","pos":[2500,2511]},{"content":"CMFCPreviewCtrlImpl::DoPaint","pos":[2550,2578]},{"content":"Called by the framework to render the preview.","pos":[2611,2657]},{"content":"Protected Data Members","pos":[2668,2690]},{"content":"Name","pos":[2697,2701]},{"content":"Description","pos":[2702,2713]},{"content":"CMFCPreviewCtrlImpl::m_clrBackColor","pos":[2752,2787]},{"content":"Background color of preview window.","pos":[2827,2862]},{"content":"CMFCPreviewCtrlImpl::m_clrTextColor","pos":[2868,2903]},{"content":"Text color of preview window.","pos":[2943,2972]},{"content":"CMFCPreviewCtrlImpl::m_font","pos":[2978,3005]},{"content":"Font used to display text in the preview window.","pos":[3037,3085]},{"content":"CMFCPreviewCtrlImpl::m_pDocument","pos":[3091,3123]},{"content":"A pointer to a document whose content is previewed in the control.","pos":[3160,3226]},{"content":"Requirements","pos":[3236,3248]},{"pos":[3252,3272],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxwin.h","source":"**Header:** afxwin.h"},{"content":"Inheritance Hierarchy","pos":[3283,3304]},{"content":"CObject","pos":[3309,3316]},{"content":"CCmdTarget","pos":[3363,3373]},{"content":"CWnd","pos":[3423,3427]},{"content":"CMFCPreviewCtrlImpl","pos":[3471,3490]},{"pos":[3602,3642],"content":"CMFCPreviewCtrlImpl::CMFCPreviewCtrlImpl"},{"content":"Constructs a preview control object.","pos":[3643,3679]},{"content":"Syntax","pos":[3685,3691]},{"content":"CMFCPreviewCtrlImpl();","pos":[3692,3714]},{"pos":[3764,3791],"content":"CMFCPreviewCtrlImpl::Create"},{"content":"Overloaded.","pos":[3792,3803]},{"content":"Called by a Rich Preview handler to create the Windows window.","pos":[3804,3866]},{"content":"Syntax","pos":[3876,3882]},{"content":"Parameters","pos":[4080,4090]},{"content":"A handle to the host window supplied by the Shell for Rich Preview.","pos":[4110,4177]},{"content":"Specifies the initial size and position of the window.","pos":[4193,4247]},{"content":"A pointer to a creation context.","pos":[4268,4300]},{"content":"Return Value","pos":[4310,4322]},{"pos":[4333,4374],"content":"if creation succeeded; otherwise <ph id=\"ph1\">`FALSE`</ph>.","source":" if creation succeeded; otherwise `FALSE`."},{"pos":[4427,4455],"content":"CMFCPreviewCtrlImpl::Destroy"},{"content":"Called by a Rich Preview handler when it needs to destroy this control.","pos":[4456,4527]},{"content":"Syntax","pos":[4537,4543]},{"pos":[4637,4665],"content":"CMFCPreviewCtrlImpl::DoPaint"},{"content":"Called by the framework to render the preview.","pos":[4668,4714]},{"content":"Syntax","pos":[4724,4730]},{"content":"Parameters","pos":[4803,4813]},{"content":"A pointer to a device context for painting.","pos":[4826,4869]},{"pos":[4919,4945],"content":"CMFCPreviewCtrlImpl::Focus"},{"content":"Sets input focus to this control.","pos":[4948,4981]},{"content":"Syntax","pos":[4991,4997]},{"pos":[5090,5122],"content":"CMFCPreviewCtrlImpl::GetDocument"},{"content":"Returns a document connected to this preview control.","pos":[5123,5176]},{"content":"Syntax","pos":[5186,5192]},{"content":"Return Value","pos":[5250,5262]},{"content":"A pointer to a document, whose content is previewed in the control.","pos":[5266,5333]},{"pos":[5389,5424],"content":"CMFCPreviewCtrlImpl::m_clrBackColor"},{"content":"Background color of the preview window.","pos":[5427,5466]},{"content":"Syntax","pos":[5476,5482]},{"pos":[5582,5617],"content":"CMFCPreviewCtrlImpl::m_clrTextColor"},{"content":"Text color of the preview window.","pos":[5618,5651]},{"content":"Syntax","pos":[5661,5667]},{"pos":[5758,5835],"content":"CMFCPreviewCtrlImpl::m_font  Font used to display text in the preview window."},{"content":"Syntax","pos":[5845,5851]},{"pos":[5936,5968],"content":"CMFCPreviewCtrlImpl::m_pDocument"},{"content":"A pointer to a document whose content is previewed in the control.","pos":[5971,6037]},{"content":"Syntax","pos":[6047,6053]},{"pos":[6149,6176],"content":"CMFCPreviewCtrlImpl::Redraw"},{"content":"Tells this control to redraw.","pos":[6179,6208]},{"content":"Syntax","pos":[6218,6224]},{"pos":[6318,6350],"content":"CMFCPreviewCtrlImpl::SetDocument"},{"content":"Called by the preview handler to create a relationship between the document implementation and the preview control.","pos":[6352,6467]},{"content":"Syntax","pos":[6477,6483]},{"content":"Parameters","pos":[6559,6569]},{"content":"A pointer to the document implementation.","pos":[6588,6629]},{"pos":[6680,6708],"content":"CMFCPreviewCtrlImpl::SetHost"},{"content":"Sets a new parent for this control.","pos":[6711,6746]},{"content":"Syntax","pos":[6756,6762]},{"content":"Parameters","pos":[6837,6847]},{"content":"A handle to the new parent window.","pos":[6867,6901]},{"pos":[6962,7000],"content":"CMFCPreviewCtrlImpl::SetPreviewVisuals"},{"content":"Called by a Rich Preview handler when it needs to set visuals of rich preview content.","pos":[7003,7089]},{"content":"Syntax","pos":[7099,7105]},{"content":"Parameters","pos":[7240,7250]},{"content":"Background color of preview window.","pos":[7267,7302]},{"content":"Text color of preview window.","pos":[7322,7351]},{"content":"Font used to display text in the preview window.","pos":[7367,7415]},{"pos":[7466,7494],"content":"CMFCPreviewCtrlImpl::SetRect"},{"content":"Sets a new bounding rectangle for this control.","pos":[7497,7544]},{"content":"Syntax","pos":[7554,7560]},{"content":"Parameters","pos":[7654,7664]},{"content":"Specifies the new size and position of the preview control.","pos":[7677,7736]},{"content":"Specifies whether the control should be redrawn.","pos":[7756,7804]},{"content":"Remarks","pos":[7814,7821]},{"content":"Usually a new bounding rectangle is set when the host control is resized.","pos":[7825,7898]},{"pos":[7946,7987],"content":"CMFCPreviewCtrlImpl::~CMFCPreviewCtrlImpl"},{"content":"Destructs a preview control object.","pos":[7990,8025]},{"content":"Syntax","pos":[8035,8041]}],"content":"---\ntitle: \"CMFCPreviewCtrlImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCPreviewCtrlImpl\"\n  - \"afxwin/CMFCPreviewCtrlImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCPreviewCtrlImpl class\"\nms.assetid: 06257fa0-54c9-478d-9d68-c9698c3f93ed\ncaps.latest.revision: 28\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCPreviewCtrlImpl Class\nThis class implements a window that is placed on a host window provided by the Shell for Rich Preview.  \n  \n## Syntax  \n  \n```  \nclass CMFCPreviewCtrlImpl : public CWnd;  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCPreviewCtrlImpl::~CMFCPreviewCtrlImpl](#cmfcpreviewctrlimpl__dtor)|Destructs a preview control object.|  \n|[CMFCPreviewCtrlImpl::CMFCPreviewCtrlImpl](#cmfcpreviewctrlimpl__cmfcpreviewctrlimpl)|Constructs a preview control object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCPreviewCtrlImpl::Create](#cmfcpreviewctrlimpl__create)|Overloaded. Called by a Rich Preview handler to create the Windows window.|  \n|[CMFCPreviewCtrlImpl::Destroy](#cmfcpreviewctrlimpl__destroy)|Called by a Rich Preview handler when it needs to destroy this control.|  \n|[CMFCPreviewCtrlImpl::Focus](#cmfcpreviewctrlimpl__focus)|Sets input focus to this control.|  \n|[CMFCPreviewCtrlImpl::GetDocument](#cmfcpreviewctrlimpl__getdocument)|Returns a document connected to this preview control.|  \n|[CMFCPreviewCtrlImpl::Redraw](#cmfcpreviewctrlimpl__redraw)|Tells this control to redraw.|  \n|[CMFCPreviewCtrlImpl::SetDocument](#cmfcpreviewctrlimpl__setdocument)|Called by the preview handler to create a relationship between the document implementation and the preview control.|  \n|[CMFCPreviewCtrlImpl::SetHost](#cmfcpreviewctrlimpl__sethost)|Sets a new parent for this control.|  \n|[CMFCPreviewCtrlImpl::SetPreviewVisuals](#cmfcpreviewctrlimpl__setpreviewvisuals)|Called by a Rich Preview handler when it needs to set visuals of rich preview content.|  \n|[CMFCPreviewCtrlImpl::SetRect](#cmfcpreviewctrlimpl__setrect)|Sets a new bounding rectangle for this control.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCPreviewCtrlImpl::DoPaint](#cmfcpreviewctrlimpl__dopaint)|Called by the framework to render the preview.|  \n  \n### Protected Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCPreviewCtrlImpl::m_clrBackColor](#cmfcpreviewctrlimpl__m_clrbackcolor)|Background color of preview window.|  \n|[CMFCPreviewCtrlImpl::m_clrTextColor](#cmfcpreviewctrlimpl__m_clrtextcolor)|Text color of preview window.|  \n|[CMFCPreviewCtrlImpl::m_font](#cmfcpreviewctrlimpl__m_font)|Font used to display text in the preview window.|  \n|[CMFCPreviewCtrlImpl::m_pDocument](#cmfcpreviewctrlimpl__m_pdocument)|A pointer to a document whose content is previewed in the control.|  \n  \n## Requirements  \n **Header:** afxwin.h    \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CMFCPreviewCtrlImpl](../../mfc/reference/cmfcpreviewctrlimpl-class.md)\n\n## <a name=\"cmfcpreviewctrlimpl__cmfcpreviewctrlimpl\"></a> CMFCPreviewCtrlImpl::CMFCPreviewCtrlImpl\nConstructs a preview control object.\n\n### Syntax\nCMFCPreviewCtrlImpl();  \n\n## <a name=\"cmfcpreviewctrlimpl__create\"></a> CMFCPreviewCtrlImpl::Create\nOverloaded. Called by a Rich Preview handler to create the Windows window.  \n  \n### Syntax  \n  \n```  \nvirtual BOOL Create(  \n   HWND hWndParent,  \n   const RECT* prc  \n);  \nvirtual BOOL Create(  \n   HWND hWndParent,  \n   const RECT* prc,  \n   CCreateContext* pContext  \n);  \n```  \n  \n### Parameters  \n `hWndParent`  \n A handle to the host window supplied by the Shell for Rich Preview.  \n  \n `prc`  \n Specifies the initial size and position of the window.  \n  \n `pContext`  \n A pointer to a creation context.  \n  \n### Return Value  \n `TRUE` if creation succeeded; otherwise `FALSE`.  \n  \n## <a name=\"cmfcpreviewctrlimpl__destroy\"></a> CMFCPreviewCtrlImpl::Destroy\nCalled by a Rich Preview handler when it needs to destroy this control.  \n  \n### Syntax  \n  \n```  \nvirtual void Destroy();  \n```  \n  \n## <a name=\"cmfcpreviewctrlimpl__dopaint\"></a> CMFCPreviewCtrlImpl::DoPaint  \nCalled by the framework to render the preview.  \n  \n### Syntax  \n  \n```  \nvirtual void DoPaint(  \n   CPaintDC* pDC  \n);  \n```  \n  \n### Parameters  \n `pDC`  \n A pointer to a device context for painting.  \n\n\n## <a name=\"cmfcpreviewctrlimpl__focus\"></a> CMFCPreviewCtrlImpl::Focus  \nSets input focus to this control.  \n  \n### Syntax  \n  \n```  \nvirtual void Focus();  \n```  \n## <a name=\"cmfcpreviewctrlimpl__getdocument\"></a> CMFCPreviewCtrlImpl::GetDocument\nReturns a document connected to this preview control.  \n  \n### Syntax  \n  \n```  \nATL::IDocument* GetDocument();  \n```  \n  \n### Return Value  \n A pointer to a document, whose content is previewed in the control.\n\n## <a name=\"cmfcpreviewctrlimpl__m_clrbackcolor\"></a> CMFCPreviewCtrlImpl::m_clrBackColor  \nBackground color of the preview window.  \n  \n### Syntax  \n  \n```  \nCOLORREF m_clrBackColor;  \n```  \n\n## <a name=\"cmfcpreviewctrlimpl__m_clrtextcolor\"></a> CMFCPreviewCtrlImpl::m_clrTextColor\nText color of the preview window.  \n  \n### Syntax  \n  \n```  \nCOLORREF m_clrTextColor;  \n```  \n## <a name=\"cmfcpreviewctrlimpl__m_font\"></a> CMFCPreviewCtrlImpl::m_font  Font used to display text in the preview window.  \n  \n### Syntax  \n  \n```  \nCFont m_font;  \n```  \n## <a name=\"cmfcpreviewctrlimpl__m_pdocument\"></a> CMFCPreviewCtrlImpl::m_pDocument  \nA pointer to a document whose content is previewed in the control.  \n  \n### Syntax  \n  \n```  \nATL::IDocument* m_pDocument;  \n```  \n\n## <a name=\"cmfcpreviewctrlimpl__redraw\"></a> CMFCPreviewCtrlImpl::Redraw  \nTells this control to redraw.  \n  \n### Syntax  \n  \n```  \nvirtual void Redraw();  \n```  \n## <a name=\"cmfcpreviewctrlimpl__setdocument\"></a> CMFCPreviewCtrlImpl::SetDocument \nCalled by the preview handler to create a relationship between the document implementation and the preview control.  \n  \n### Syntax  \n  \n```  \nvoid SetDocument(  \n   IDocument* pDocument  \n);  \n```  \n  \n### Parameters  \n `pDocument`  \n A pointer to the document implementation.  \n\n## <a name=\"cmfcpreviewctrlimpl__sethost\"></a> CMFCPreviewCtrlImpl::SetHost  \nSets a new parent for this control.  \n  \n### Syntax  \n  \n```  \nvirtual void SetHost(  \n   HWND hWndParent  \n);  \n```  \n  \n### Parameters  \n `hWndParent`  \n A handle to the new parent window.  \n\n## <a name=\"cmfcpreviewctrlimpl__setpreviewvisuals\"></a> CMFCPreviewCtrlImpl::SetPreviewVisuals  \nCalled by a Rich Preview handler when it needs to set visuals of rich preview content.  \n  \n### Syntax  \n  \n```  \nvirtual void SetPreviewVisuals(  \n   COLORREF clrBack,  \n   COLORREF clrText,  \n   const LOGFONTW *plf  \n);  \n```  \n  \n### Parameters  \n `clrBack`  \n Background color of preview window.  \n  \n `clrText`  \n Text color of preview window.  \n  \n `plf`  \n Font used to display text in the preview window. \n\n##  <a name=\"cmfcpreviewctrlimpl__setrect\"></a> CMFCPreviewCtrlImpl::SetRect  \nSets a new bounding rectangle for this control.  \n  \n### Syntax  \n  \n```  \nvirtual void SetRect(  \n   const RECT* prc,  \n   BOOL bRedraw  \n);  \n```  \n  \n### Parameters  \n `prc`  \n Specifies the new size and position of the preview control.  \n  \n `bRedraw`  \n Specifies whether the control should be redrawn.  \n  \n### Remarks  \n Usually a new bounding rectangle is set when the host control is resized.  \n\n## <a name=\"cmfcpreviewctrlimpl__dtor\"></a> CMFCPreviewCtrlImpl::~CMFCPreviewCtrlImpl  \nDestructs a preview control object.  \n  \n### Syntax  \n  \n```  \nvirtual ~CMFCPreviewCtrlImpl();  \n```  \n  \n"}