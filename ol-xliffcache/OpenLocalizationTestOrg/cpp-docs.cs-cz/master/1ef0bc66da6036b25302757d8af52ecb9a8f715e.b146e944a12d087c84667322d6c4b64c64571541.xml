{"nodes":[{"pos":[12,72],"content":"Creating the Project (ATL Tutorial, Part 1) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Creating the Project (ATL Tutorial, Part 1) | Microsoft Docs","pos":[0,60]}]},{"content":"Creating the Project (ATL Tutorial, Part 1)","pos":[565,608]},{"content":"This tutorial walks you step-by-step through a nonattributed ATL project that creates an ActiveX object that displays a polygon.","pos":[609,737]},{"content":"The object includes options for allowing the user to change the number of sides making up the polygon, and code to refresh the display.","pos":[738,873]},{"pos":[881,973],"content":"[!NOTE]\n ATL and MFC are not generally supported in the Express editions of Visual Studio.","leadings":["","> "],"nodes":[{"content":"ATL and MFC are not generally supported in the Express editions of Visual Studio.","pos":[9,90]}]},{"pos":[981,1326],"content":"[!NOTE]\n This tutorial creates the same source code as the Polygon sample. If you want to avoid entering the source code manually, you can download it from the [Polygon sample abstract](../visual-cpp-samples.md). You can then refer to the Polygon source code as you work through the tutorial, or use it to check for errors in your own project.","leadings":["","> "],"nodes":[{"content":" This tutorial creates the same source code as the Polygon sample. If you want to avoid entering the source code manually, you can download it from the [Polygon sample abstract](../visual-cpp-samples.md). You can then refer to the Polygon source code as you work through the tutorial, or use it to check for errors in your own project.","pos":[8,343],"nodes":[{"content":"This tutorial creates the same source code as the Polygon sample.","pos":[1,66]},{"content":"If you want to avoid entering the source code manually, you can download it from the <bpt id=\"p1\">[</bpt>Polygon sample abstract<ept id=\"p1\">](../visual-cpp-samples.md)</ept>.","pos":[67,204],"source":" If you want to avoid entering the source code manually, you can download it from the [Polygon sample abstract](../visual-cpp-samples.md)."},{"content":"You can then refer to the Polygon source code as you work through the tutorial, or use it to check for errors in your own project.","pos":[205,335]}]}]},{"content":"To create the initial ATL project using the ATL Project Wizard","pos":[1336,1398]},{"pos":[1408,1517],"content":"In the Visual Studio development environment, click <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu, and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"In the Visual Studio development environment, click **New** on the **File** menu, and then click **Project**."},{"pos":[1527,1595],"content":"Click the <bpt id=\"p1\">**</bpt>Visual C++ Projects<ept id=\"p1\">**</ept> folder and select <bpt id=\"p2\">**</bpt>ATL Project<ept id=\"p2\">**</ept>.","source":"Click the **Visual C++ Projects** folder and select **ATL Project**."},{"pos":[1605,1640],"content":"Type <ph id=\"ph1\">`Polygon`</ph> as the project name.","source":"Type `Polygon` as the project name."},{"content":"The location for the source code will usually default to My Documents\\Visual Studio Projects, and a new folder will be created automatically.","pos":[1651,1792]},{"pos":[1802,1848],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> and the ATL Project Wizard opens.","source":"Click **OK** and the ATL Project Wizard opens."},{"pos":[1858,1918],"content":"Click <bpt id=\"p1\">**</bpt>Application Settings<ept id=\"p1\">**</ept> to see the options available.","source":"Click **Application Settings** to see the options available."},{"pos":[1928,2043],"content":"As you are creating a control, and a control must be an in-process server, leave the <bpt id=\"p1\">**</bpt>Application type<ept id=\"p1\">**</ept> as a DLL.","source":"As you are creating a control, and a control must be an in-process server, leave the **Application type** as a DLL."},{"pos":[2053,2123],"content":"Leave the other options at their default values, and click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Leave the other options at their default values, and click **Finish**."},{"content":"The ATL Project Wizard will create the project by generating several files.","pos":[2130,2205]},{"content":"You can view these files in Solution Explorer by expanding the Polygon object.","pos":[2206,2284]},{"content":"The files are listed below.","pos":[2285,2312]},{"content":"File","pos":[2319,2323]},{"content":"Description","pos":[2324,2335]},{"content":"Polygon.cpp","pos":[2373,2384]},{"content":"Contains the implementation of <ph id=\"ph1\">`DllMain`</ph>, <ph id=\"ph2\">`DllCanUnloadNow`</ph>, <ph id=\"ph3\">`DllGetClassObject`</ph>, <ph id=\"ph4\">`DllRegisterServer`</ph>, and <ph id=\"ph5\">`DllUnregisterServer`</ph>.","pos":[2385,2514],"source":"Contains the implementation of `DllMain`, `DllCanUnloadNow`, `DllGetClassObject`, `DllRegisterServer`, and `DllUnregisterServer`."},{"content":"Also contains the object map, which is a list of the ATL objects in your project.","pos":[2515,2596]},{"content":"This is initially blank.","pos":[2597,2621]},{"content":"Polygon.def","pos":[2626,2637]},{"content":"This module-definition file provides the linker with information about the exports required by your DLL.","pos":[2638,2742]},{"content":"Polygon.idl","pos":[2747,2758]},{"content":"The interface definition language file, which describes the interfaces specific to your objects.","pos":[2759,2855]},{"content":"Polygon.rgs","pos":[2860,2871]},{"content":"This registry script contains information for registering your program's DLL.","pos":[2872,2949]},{"content":"Polygon.rc","pos":[2954,2964]},{"content":"The resource file, which initially contains the version information and a string containing the project name.","pos":[2965,3074]},{"content":"Resource.h","pos":[3079,3089]},{"content":"The header file for the resource file.","pos":[3090,3128]},{"content":"Polygonps.def","pos":[3133,3146]},{"content":"This module definition file provides the linker with information about the exports required by the proxy and stub code that support calls across apartments.","pos":[3147,3303]},{"content":"stdafx.cpp","pos":[3308,3318]},{"pos":[3319,3378],"content":"The file that will <ph id=\"ph1\">`#include`</ph> the ATL implementation files.","source":"The file that will `#include` the ATL implementation files."},{"content":"stdafx.h","pos":[3383,3391]},{"pos":[3392,3443],"content":"The file that will <ph id=\"ph1\">`#include`</ph> the ATL header files.","source":"The file that will `#include` the ATL header files."},{"pos":[3454,3510],"content":"In Solution Explorer, right-click the <ph id=\"ph1\">`Polygon`</ph> project.","source":"In Solution Explorer, right-click the `Polygon` project."},{"pos":[3520,3563],"content":"On the shortcut menu, click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","source":"On the shortcut menu, click **Properties**."},{"content":"Click on <bpt id=\"p1\">**</bpt>Linker<ept id=\"p1\">**</ept>.","pos":[3573,3593],"source":"Click on **Linker**."},{"content":"Change the <bpt id=\"p1\">**</bpt>Per-UserRedirection<ept id=\"p1\">**</ept> option to <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>.","pos":[3594,3647],"source":" Change the **Per-UserRedirection** option to **Yes**."},{"pos":[3657,3670],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"In the next step, you will add a control to your project.","pos":[3677,3734]},{"content":"On to Step 2","pos":[3742,3754]},{"content":"See Also","pos":[3812,3820]},{"content":"Tutorial","pos":[3825,3833]}],"content":"---\ntitle: \"Creating the Project (ATL Tutorial, Part 1) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nms.assetid: f6b727d1-390a-4b27-b82f-daadcd9fc059\ncaps.latest.revision: 16\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Creating the Project (ATL Tutorial, Part 1)\nThis tutorial walks you step-by-step through a nonattributed ATL project that creates an ActiveX object that displays a polygon. The object includes options for allowing the user to change the number of sides making up the polygon, and code to refresh the display.  \n  \n> [!NOTE]\n>  ATL and MFC are not generally supported in the Express editions of Visual Studio.  \n  \n> [!NOTE]\n>  This tutorial creates the same source code as the Polygon sample. If you want to avoid entering the source code manually, you can download it from the [Polygon sample abstract](../visual-cpp-samples.md). You can then refer to the Polygon source code as you work through the tutorial, or use it to check for errors in your own project.  \n  \n### To create the initial ATL project using the ATL Project Wizard  \n  \n1.  In the Visual Studio development environment, click **New** on the **File** menu, and then click **Project**.  \n  \n2.  Click the **Visual C++ Projects** folder and select **ATL Project**.  \n  \n3.  Type `Polygon` as the project name.  \n  \n     The location for the source code will usually default to My Documents\\Visual Studio Projects, and a new folder will be created automatically.  \n  \n4.  Click **OK** and the ATL Project Wizard opens.  \n  \n5.  Click **Application Settings** to see the options available.  \n  \n6.  As you are creating a control, and a control must be an in-process server, leave the **Application type** as a DLL.  \n  \n7.  Leave the other options at their default values, and click **Finish**.  \n  \n The ATL Project Wizard will create the project by generating several files. You can view these files in Solution Explorer by expanding the Polygon object. The files are listed below.  \n  \n|File|Description|  \n|----------|-----------------|  \n|Polygon.cpp|Contains the implementation of `DllMain`, `DllCanUnloadNow`, `DllGetClassObject`, `DllRegisterServer`, and `DllUnregisterServer`. Also contains the object map, which is a list of the ATL objects in your project. This is initially blank.|  \n|Polygon.def|This module-definition file provides the linker with information about the exports required by your DLL.|  \n|Polygon.idl|The interface definition language file, which describes the interfaces specific to your objects.|  \n|Polygon.rgs|This registry script contains information for registering your program's DLL.|  \n|Polygon.rc|The resource file, which initially contains the version information and a string containing the project name.|  \n|Resource.h|The header file for the resource file.|  \n|Polygonps.def|This module definition file provides the linker with information about the exports required by the proxy and stub code that support calls across apartments.|  \n|stdafx.cpp|The file that will `#include` the ATL implementation files.|  \n|stdafx.h|The file that will `#include` the ATL header files.|  \n  \n1.  In Solution Explorer, right-click the `Polygon` project.  \n  \n2.  On the shortcut menu, click **Properties**.  \n  \n3.  Click on **Linker**. Change the **Per-UserRedirection** option to **Yes**.  \n  \n4.  Click **OK**.  \n  \n In the next step, you will add a control to your project.  \n  \n [On to Step 2](../atl/adding-a-control-atl-tutorial-part-2.md)  \n  \n## See Also  \n [Tutorial](../atl/active-template-library-atl-tutorial.md)\n\n"}