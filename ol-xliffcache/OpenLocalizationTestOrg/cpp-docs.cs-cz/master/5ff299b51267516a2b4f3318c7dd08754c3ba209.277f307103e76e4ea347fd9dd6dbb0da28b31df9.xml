{"nodes":[{"pos":[12,58],"content":"CComAutoCriticalSection Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComAutoCriticalSection Class | Microsoft Docs","pos":[0,46]}]},{"content":"CComAutoCriticalSection Class","pos":[712,741]},{"pos":[768,852],"content":"provides methods for obtaining and releasing ownership of a critical section object."},{"content":"Syntax","pos":[861,867]},{"content":"Members","pos":[948,955]},{"content":"Public Constructors","pos":[965,984]},{"content":"Name","pos":[991,995]},{"content":"Description","pos":[996,1007]},{"content":"CComAutoCriticalSection::CComAutoCriticalSection","pos":[1046,1094]},{"content":"The constructor.","pos":[1147,1163]},{"content":"CComAutoCriticalSection::~CComAutoCriticalSection","pos":[1169,1218]},{"content":"The destructor.","pos":[1276,1291]},{"content":"Remarks","pos":[1301,1308]},{"pos":[1338,1537],"content":"is similar to class <bpt id=\"p1\">[</bpt>CComCriticalSection<ept id=\"p1\">](../../atl/reference/ccomcriticalsection-class.md)</ept>, except <ph id=\"ph1\">`CComAutoCriticalSection`</ph> automatically initializes the critical section object in the constructor.","source":" is similar to class [CComCriticalSection](../../atl/reference/ccomcriticalsection-class.md), except `CComAutoCriticalSection` automatically initializes the critical section object in the constructor."},{"content":"Typically, you use <ph id=\"ph1\">`CComAutoCriticalSection`</ph> through the <ph id=\"ph2\">`typedef`</ph> name <bpt id=\"p1\">[</bpt>AutoCriticalSection<ept id=\"p1\">](ccommultithreadmodel-class.md#ccommultithreadmodel__autocriticalsection)</ept>.","pos":[1544,1711],"source":"Typically, you use `CComAutoCriticalSection` through the `typedef` name [AutoCriticalSection](ccommultithreadmodel-class.md#ccommultithreadmodel__autocriticalsection)."},{"content":"This name references <ph id=\"ph1\">`CComAutoCriticalSection`</ph> when <bpt id=\"p1\">[</bpt>CComMultiThreadModel<ept id=\"p1\">](../../atl/reference/ccommultithreadmodel-class.md)</ept> is being used.","pos":[1712,1852],"source":" This name references `CComAutoCriticalSection` when [CComMultiThreadModel](../../atl/reference/ccommultithreadmodel-class.md) is being used."},{"pos":[1860,2007],"content":"The <ph id=\"ph1\">`Init`</ph> and <ph id=\"ph2\">`Term`</ph> methods from <bpt id=\"p1\">[</bpt>CComCriticalSection<ept id=\"p1\">](../../atl/reference/ccomcriticalsection-class.md)</ept> are not available when using this class.","source":"The `Init` and `Term` methods from [CComCriticalSection](../../atl/reference/ccomcriticalsection-class.md) are not available when using this class."},{"content":"Inheritance Hierarchy","pos":[2016,2037]},{"content":"CComCriticalSection","pos":[2042,2061]},{"content":"Requirements","pos":[2153,2165]},{"pos":[2169,2190],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcore.h","source":"**Header:** atlcore.h"},{"pos":[2265,2313],"content":"CComAutoCriticalSection::CComAutoCriticalSection"},{"content":"The constructor.","pos":[2317,2333]},{"content":"Remarks","pos":[2383,2390]},{"pos":[2394,2554],"content":"Calls the Win32 function <bpt id=\"p1\">[</bpt>InitializeCriticalSection<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683472)</ept>, which initializes the critical section object.","source":"Calls the Win32 function [InitializeCriticalSection](http://msdn.microsoft.com/library/windows/desktop/ms683472), which initializes the critical section object."},{"pos":[2634,2683],"content":"CComAutoCriticalSection::~CComAutoCriticalSection"},{"content":"The destructor.","pos":[2687,2702]},{"content":"Remarks","pos":[2761,2768]},{"pos":[2772,2950],"content":"The destructor calls <bpt id=\"p1\">[</bpt>DeleteCriticalSection<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682552)</ept>, which releases all system resources used by the critical section object.","source":"The destructor calls [DeleteCriticalSection](http://msdn.microsoft.com/library/windows/desktop/ms682552), which releases all system resources used by the critical section object."},{"content":"See Also","pos":[2959,2967]},{"content":"CComFakeCriticalSection Class","pos":[2972,3001]},{"content":"Class Overview","pos":[3062,3076]},{"content":"CComCriticalSection Class","pos":[3116,3141]}],"content":"---\ntitle: \"CComAutoCriticalSection Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL.CComAutoCriticalSection\"\n  - \"ATL::CComAutoCriticalSection\"\n  - \"CComAutoCriticalSection\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CComAutoCriticalSection class\"\nms.assetid: 491a9d90-3398-4f90-88f5-fd2172a46b30\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComAutoCriticalSection Class\n`CComAutoCriticalSection` provides methods for obtaining and releasing ownership of a critical section object.  \n  \n## Syntax  \n  \n```\nclass CComAutoCriticalSection : public CComCriticalSection\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComAutoCriticalSection::CComAutoCriticalSection](#ccomautocriticalsection__ccomautocriticalsection)|The constructor.|  \n|[CComAutoCriticalSection::~CComAutoCriticalSection](#ccomautocriticalsection___dtorccomautocriticalsection)|The destructor.|  \n  \n## Remarks  \n `CComAutoCriticalSection` is similar to class [CComCriticalSection](../../atl/reference/ccomcriticalsection-class.md), except `CComAutoCriticalSection` automatically initializes the critical section object in the constructor.  \n  \n Typically, you use `CComAutoCriticalSection` through the `typedef` name [AutoCriticalSection](ccommultithreadmodel-class.md#ccommultithreadmodel__autocriticalsection). This name references `CComAutoCriticalSection` when [CComMultiThreadModel](../../atl/reference/ccommultithreadmodel-class.md) is being used.  \n\n  \n The `Init` and `Term` methods from [CComCriticalSection](../../atl/reference/ccomcriticalsection-class.md) are not available when using this class.  \n  \n## Inheritance Hierarchy  \n [CComCriticalSection](../../atl/reference/ccomcriticalsection-class.md)  \n  \n `CComAutoCriticalSection`  \n  \n## Requirements  \n **Header:** atlcore.h  \n  \n##  <a name=\"ccomautocriticalsection__ccomautocriticalsection\"></a>  CComAutoCriticalSection::CComAutoCriticalSection  \n The constructor.  \n  \n```\nCComAutoCriticalSection();\n```  \n  \n### Remarks  \n Calls the Win32 function [InitializeCriticalSection](http://msdn.microsoft.com/library/windows/desktop/ms683472), which initializes the critical section object.  \n  \n##  <a name=\"ccomautocriticalsection___dtorccomautocriticalsection\"></a>  CComAutoCriticalSection::~CComAutoCriticalSection  \n The destructor.  \n  \n```\n~CComAutoCriticalSection() throw();\n```  \n  \n### Remarks  \n The destructor calls [DeleteCriticalSection](http://msdn.microsoft.com/library/windows/desktop/ms682552), which releases all system resources used by the critical section object.  \n  \n## See Also  \n [CComFakeCriticalSection Class](../../atl/reference/ccomfakecriticalsection-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)   \n [CComCriticalSection Class](../../atl/reference/ccomcriticalsection-class.md)\n"}