{"nodes":[{"pos":[12,57],"content":"COleChangeSourceDialog Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleChangeSourceDialog Class | Microsoft Docs","pos":[0,45]}]},{"content":"COleChangeSourceDialog Class","pos":[795,823]},{"content":"Used for the OLE Change Source dialog box.","pos":[824,866]},{"content":"Syntax","pos":[875,881]},{"content":"Members","pos":[956,963]},{"content":"Public Constructors","pos":[973,992]},{"content":"Name","pos":[999,1003]},{"content":"Description","pos":[1004,1015]},{"content":"COleChangeSourceDialog::COleChangeSourceDialog","pos":[1054,1100]},{"pos":[1151,1196],"content":"Constructs a <ph id=\"ph1\">`COleChangeSourceDialog`</ph> object.","source":"Constructs a `COleChangeSourceDialog` object."},{"content":"Public Methods","pos":[1207,1221]},{"content":"Name","pos":[1228,1232]},{"content":"Description","pos":[1233,1244]},{"content":"COleChangeSourceDialog::DoModal","pos":[1283,1314]},{"content":"Displays the OLE Change Source dialog box.","pos":[1350,1392]},{"content":"COleChangeSourceDialog::GetDisplayName","pos":[1398,1436]},{"content":"Gets the complete source display name.","pos":[1479,1517]},{"content":"COleChangeSourceDialog::GetFileName","pos":[1523,1558]},{"content":"Gets the filename from the source name.","pos":[1598,1637]},{"content":"COleChangeSourceDialog::GetFromPrefix","pos":[1643,1680]},{"content":"Gets the prefix of the previous source.","pos":[1722,1761]},{"content":"COleChangeSourceDialog::GetItemName","pos":[1767,1802]},{"content":"Gets the item name from the source name.","pos":[1842,1882]},{"content":"COleChangeSourceDialog::GetToPrefix","pos":[1888,1923]},{"content":"Gets the prefix of the new source","pos":[1963,1996]},{"content":"COleChangeSourceDialog::IsValidSource","pos":[2002,2039]},{"content":"Indicates if the source is valid.","pos":[2081,2114]},{"content":"Public Data Members","pos":[2125,2144]},{"content":"Name","pos":[2151,2155]},{"content":"Description","pos":[2156,2167]},{"content":"COleChangeSourceDialog::m_cs","pos":[2206,2234]},{"content":"A structure that controls the behavior of the dialog box.","pos":[2267,2324]},{"content":"Remarks","pos":[2334,2341]},{"content":"Create an object of class <ph id=\"ph1\">`COleChangeSourceDialog`</ph> when you want to call this dialog box.","pos":[2345,2434],"source":"Create an object of class `COleChangeSourceDialog` when you want to call this dialog box."},{"content":"After a <ph id=\"ph1\">`COleChangeSourceDialog`</ph> object has been constructed, you can use the <bpt id=\"p1\">[</bpt>m_cs<ept id=\"p1\">](#colechangesourcedialog__m_cs)</ept> structure to initialize the values or states of controls in the dialog box.","pos":[2435,2626],"source":" After a `COleChangeSourceDialog` object has been constructed, you can use the [m_cs](#colechangesourcedialog__m_cs) structure to initialize the values or states of controls in the dialog box."},{"content":"The <ph id=\"ph1\">`m_cs`</ph> structure is of type <bpt id=\"p1\">[</bpt>OLEUICHANGESOURCE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept>.","pos":[2627,2739],"source":" The `m_cs` structure is of type [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160)."},{"content":"For more information about using this dialog class, see the <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#colechangesourcedialog__domodal)</ept> member function.","pos":[2740,2860],"source":" For more information about using this dialog class, see the [DoModal](#colechangesourcedialog__domodal) member function."},{"pos":[2867,3042],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUICHANGESOURCE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept> structure in <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3049,3175],"content":"For more information about OLE-specific dialog boxes, see the article <bpt id=\"p1\">[</bpt>Dialog Boxes in OLE<ept id=\"p1\">](../../mfc/dialog-boxes-in-ole.md)</ept>.","source":"For more information about OLE-specific dialog boxes, see the article [Dialog Boxes in OLE](../../mfc/dialog-boxes-in-ole.md)."},{"content":"Inheritance Hierarchy","pos":[3184,3205]},{"content":"CObject","pos":[3210,3217]},{"content":"CCmdTarget","pos":[3264,3274]},{"content":"CWnd","pos":[3324,3328]},{"content":"CDialog","pos":[3372,3379]},{"content":"CCommonDialog","pos":[3426,3439]},{"content":"COleDialog","pos":[3492,3502]},{"content":"Requirements","pos":[3584,3596]},{"pos":[3600,3622],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxodlgs.h","source":"**Header:** afxodlgs.h"},{"pos":[3695,3741],"content":"COleChangeSourceDialog::COleChangeSourceDialog"},{"pos":[3745,3804],"content":"This function constructs a <ph id=\"ph1\">`COleChangeSourceDialog`</ph> object.","source":"This function constructs a `COleChangeSourceDialog` object."},{"content":"Parameters","pos":[3921,3931]},{"content":"Pointer to the linked <bpt id=\"p1\">[</bpt>COleClientItem<ept id=\"p1\">](../../mfc/reference/coleclientitem-class.md)</ept> whose source is to be updated.","pos":[3946,4060],"source":" Pointer to the linked [COleClientItem](../../mfc/reference/coleclientitem-class.md) whose source is to be updated."},{"content":"Points to the parent or owner window object (of type <ph id=\"ph1\">`CWnd`</ph>) to which the dialog object belongs.","pos":[4083,4179],"source":" Points to the parent or owner window object (of type `CWnd`) to which the dialog object belongs."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the parent window of the dialog box will be set to the main application window.","pos":[4180,4278],"source":" If it is **NULL**, the parent window of the dialog box will be set to the main application window."},{"content":"Remarks","pos":[4288,4295]},{"pos":[4299,4388],"content":"To display the dialog box, call the <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#colechangesourcedialog__domodal)</ept> function.","source":"To display the dialog box, call the [DoModal](#colechangesourcedialog__domodal) function."},{"pos":[4395,4663],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUICHANGESOURCE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept> structure and <bpt id=\"p2\">[</bpt>OleUIChangeSource<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682497)</ept> function in <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure and [OleUIChangeSource](http://msdn.microsoft.com/library/windows/desktop/ms682497) function in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4721,4752],"content":"COleChangeSourceDialog::DoModal"},{"content":"Call this function to display the OLE Change Source dialog box.","pos":[4756,4819]},{"content":"Return Value","pos":[4871,4883]},{"content":"Completion status for the dialog box.","pos":[4887,4924]},{"content":"One of the following values:","pos":[4925,4953]},{"pos":[4961,5015],"content":"<bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept> if the dialog box was successfully displayed.","source":"**IDOK** if the dialog box was successfully displayed."},{"pos":[5023,5072],"content":"<bpt id=\"p1\">**</bpt>IDCANCEL<ept id=\"p1\">**</ept> if the user canceled the dialog box.","source":"**IDCANCEL** if the user canceled the dialog box."},{"content":"<bpt id=\"p1\">**</bpt>IDABORT<ept id=\"p1\">**</ept> if an error occurred.","pos":[5080,5113],"source":"**IDABORT** if an error occurred."},{"content":"If <bpt id=\"p1\">**</bpt>IDABORT<ept id=\"p1\">**</ept> is returned, call the <bpt id=\"p2\">[</bpt>COleDialog::GetLastError<ept id=\"p2\">](../../mfc/reference/coledialog-class.md#coledialog__getlasterror)</ept> member function to get more information about the type of error that occurred.","pos":[5114,5322],"source":" If **IDABORT** is returned, call the [COleDialog::GetLastError](../../mfc/reference/coledialog-class.md#coledialog__getlasterror) member function to get more information about the type of error that occurred."},{"content":"For a listing of possible errors, see the <bpt id=\"p1\">[</bpt>OleUIChangeSource<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682497)</ept> function in <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[5323,5509],"source":" For a listing of possible errors, see the [OleUIChangeSource](http://msdn.microsoft.com/library/windows/desktop/ms682497) function in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Remarks","pos":[5519,5526]},{"pos":[5530,5751],"content":"If you want to initialize the various dialog box controls by setting members of the <bpt id=\"p1\">[</bpt>m_cs<ept id=\"p1\">](#colechangesourcedialog__m_cs)</ept> structure, you should do this before calling <ph id=\"ph1\">`DoModal`</ph>, but after the dialog object is constructed.","source":"If you want to initialize the various dialog box controls by setting members of the [m_cs](#colechangesourcedialog__m_cs) structure, you should do this before calling `DoModal`, but after the dialog object is constructed."},{"content":"If <ph id=\"ph1\">`DoModal`</ph> returns <bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept>, you can call member functions to retrieve user-entered settings or information from the dialog box.","pos":[5758,5888],"source":"If `DoModal` returns **IDOK**, you can call member functions to retrieve user-entered settings or information from the dialog box."},{"content":"The following list names typical query functions:","pos":[5889,5938]},{"content":"GetFileName","pos":[5947,5958]},{"content":"GetDisplayName","pos":[6006,6020]},{"content":"GetItemName","pos":[6071,6082]},{"pos":[6186,6224],"content":"COleChangeSourceDialog::GetDisplayName"},{"content":"Call this function to retrieve the complete display name for the linked client item.","pos":[6228,6312]},{"content":"Return Value","pos":[6363,6375]},{"pos":[6379,6521],"content":"The complete source display name (moniker) for the <bpt id=\"p1\">[</bpt>COleClientItem<ept id=\"p1\">](../../mfc/reference/coleclientitem-class.md)</ept> specified in the constructor.","source":"The complete source display name (moniker) for the [COleClientItem](../../mfc/reference/coleclientitem-class.md) specified in the constructor."},{"pos":[6583,6618],"content":"COleChangeSourceDialog::GetFileName"},{"content":"Call this function to retrieve the file moniker portion of the display name for the linked client item.","pos":[6622,6725]},{"content":"Return Value","pos":[6773,6785]},{"pos":[6789,6940],"content":"The file moniker portion of the source display name for the <bpt id=\"p1\">[</bpt>COleClientItem<ept id=\"p1\">](../../mfc/reference/coleclientitem-class.md)</ept> specified in the constructor.","source":"The file moniker portion of the source display name for the [COleClientItem](../../mfc/reference/coleclientitem-class.md) specified in the constructor."},{"content":"Remarks","pos":[6950,6957]},{"content":"The file moniker together with the item moniker gives the complete display name.","pos":[6961,7041]},{"pos":[7105,7142],"content":"COleChangeSourceDialog::GetFromPrefix"},{"content":"Call this function to get the previous prefix string for the source.","pos":[7146,7214]},{"content":"Return Value","pos":[7264,7276]},{"content":"The previous prefix string of the source.","pos":[7280,7321]},{"content":"Remarks","pos":[7331,7338]},{"pos":[7342,7433],"content":"Call this function only after <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#colechangesourcedialog__domodal)</ept> returns <bpt id=\"p2\">**</bpt>IDOK<ept id=\"p2\">**</ept>.","source":"Call this function only after [DoModal](#colechangesourcedialog__domodal) returns **IDOK**."},{"pos":[7440,7592],"content":"This value comes directly from the <bpt id=\"p1\">**</bpt>lpszFrom<ept id=\"p1\">**</ept> member of the <bpt id=\"p2\">[</bpt>OLEUICHANGESOURCE<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept> structure.","source":"This value comes directly from the **lpszFrom** member of the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure."},{"pos":[7599,7774],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUICHANGESOURCE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept> structure in <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[7836,7871],"content":"COleChangeSourceDialog::GetItemName"},{"content":"Call this function to retrieve the item moniker portion of the display name for the linked client item.","pos":[7875,7978]},{"content":"Return Value","pos":[8026,8038]},{"pos":[8042,8193],"content":"The item moniker portion of the source display name for the <bpt id=\"p1\">[</bpt>COleClientItem<ept id=\"p1\">](../../mfc/reference/coleclientitem-class.md)</ept> specified in the constructor.","source":"The item moniker portion of the source display name for the [COleClientItem](../../mfc/reference/coleclientitem-class.md) specified in the constructor."},{"content":"Remarks","pos":[8203,8210]},{"content":"The file moniker together with the item moniker gives the complete display name.","pos":[8214,8294]},{"pos":[8356,8391],"content":"COleChangeSourceDialog::GetToPrefix"},{"content":"Call this function to get the new prefix string for the source.","pos":[8395,8458]},{"content":"Return Value","pos":[8506,8518]},{"content":"The new prefix string of the source.","pos":[8522,8558]},{"content":"Remarks","pos":[8568,8575]},{"pos":[8579,8670],"content":"Call this function only after <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#colechangesourcedialog__domodal)</ept> returns <bpt id=\"p2\">**</bpt>IDOK<ept id=\"p2\">**</ept>.","source":"Call this function only after [DoModal](#colechangesourcedialog__domodal) returns **IDOK**."},{"pos":[8677,8827],"content":"This value comes directly from the <bpt id=\"p1\">**</bpt>lpszTo<ept id=\"p1\">**</ept> member of the <bpt id=\"p2\">[</bpt>OLEUICHANGESOURCE<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept> structure.","source":"This value comes directly from the **lpszTo** member of the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure."},{"pos":[8834,9009],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUICHANGESOURCE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept> structure in <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[9064,9092],"content":"COleChangeSourceDialog::m_cs"},{"pos":[9096,9216],"content":"This data member is a structure of type <bpt id=\"p1\">[</bpt>OLEUICHANGESOURCE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept>.","source":"This data member is a structure of type [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160)."},{"content":"Remarks","pos":[9267,9274]},{"content":"is used to control the behavior of the OLE Change Source dialog box.","pos":[9298,9366]},{"content":"Members of this structure can be modified directly.","pos":[9367,9418]},{"pos":[9425,9600],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUICHANGESOURCE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept> structure in <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[9664,9701],"content":"COleChangeSourceDialog::IsValidSource"},{"content":"Call this function to determine if the new source is valid.","pos":[9705,9764]},{"content":"Return Value","pos":[9811,9823]},{"content":"Nonzero if the new source is valid, otherwise 0.","pos":[9827,9875]},{"content":"Remarks","pos":[9885,9892]},{"pos":[9896,9987],"content":"Call this function only after <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#colechangesourcedialog__domodal)</ept> returns <bpt id=\"p2\">**</bpt>IDOK<ept id=\"p2\">**</ept>.","source":"Call this function only after [DoModal](#colechangesourcedialog__domodal) returns **IDOK**."},{"pos":[9994,10169],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUICHANGESOURCE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682160)</ept> structure in <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"See Also","pos":[10178,10186]},{"content":"COleDialog Class","pos":[10191,10207]},{"content":"Hierarchy Chart","pos":[10255,10270]},{"content":"COleDialog Class","pos":[10307,10323]}],"content":"---\ntitle: \"COleChangeSourceDialog Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleChangeSourceDialog\"\n  - \"OLEUICHANGESOURCE\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE Change Source dialog box\"\n  - \"COleChangeSourceDialog class\"\n  - \"dialog boxes, OLE\"\n  - \"OLE dialog boxes, Change Source\"\n  - \"OleUIChangeSource structure\"\nms.assetid: d0e08be7-21ef-45e1-97af-fe27d99e3bac\ncaps.latest.revision: 22\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleChangeSourceDialog Class\nUsed for the OLE Change Source dialog box.  \n  \n## Syntax  \n  \n```  \nclass COleChangeSourceDialog : public COleDialog  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleChangeSourceDialog::COleChangeSourceDialog](#colechangesourcedialog__colechangesourcedialog)|Constructs a `COleChangeSourceDialog` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleChangeSourceDialog::DoModal](#colechangesourcedialog__domodal)|Displays the OLE Change Source dialog box.|  \n|[COleChangeSourceDialog::GetDisplayName](#colechangesourcedialog__getdisplayname)|Gets the complete source display name.|  \n|[COleChangeSourceDialog::GetFileName](#colechangesourcedialog__getfilename)|Gets the filename from the source name.|  \n|[COleChangeSourceDialog::GetFromPrefix](#colechangesourcedialog__getfromprefix)|Gets the prefix of the previous source.|  \n|[COleChangeSourceDialog::GetItemName](#colechangesourcedialog__getitemname)|Gets the item name from the source name.|  \n|[COleChangeSourceDialog::GetToPrefix](#colechangesourcedialog__gettoprefix)|Gets the prefix of the new source|  \n|[COleChangeSourceDialog::IsValidSource](#colechangesourcedialog__isvalidsource)|Indicates if the source is valid.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleChangeSourceDialog::m_cs](#colechangesourcedialog__m_cs)|A structure that controls the behavior of the dialog box.|  \n  \n## Remarks  \n Create an object of class `COleChangeSourceDialog` when you want to call this dialog box. After a `COleChangeSourceDialog` object has been constructed, you can use the [m_cs](#colechangesourcedialog__m_cs) structure to initialize the values or states of controls in the dialog box. The `m_cs` structure is of type [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160). For more information about using this dialog class, see the [DoModal](#colechangesourcedialog__domodal) member function.  \n  \n For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information about OLE-specific dialog boxes, see the article [Dialog Boxes in OLE](../../mfc/dialog-boxes-in-ole.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CDialog](../../mfc/reference/cdialog-class.md)  \n  \n [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  \n  \n [COleDialog](../../mfc/reference/coledialog-class.md)  \n  \n `COleChangeSourceDialog`  \n  \n## Requirements  \n **Header:** afxodlgs.h  \n  \n##  <a name=\"colechangesourcedialog__colechangesourcedialog\"></a>  COleChangeSourceDialog::COleChangeSourceDialog  \n This function constructs a `COleChangeSourceDialog` object.  \n  \n```  \nexplicit COleChangeSourceDialog(\n    COleClientItem* pItem,  \n    CWnd* pParentWnd = NULL);\n```  \n  \n### Parameters  \n `pItem`  \n Pointer to the linked [COleClientItem](../../mfc/reference/coleclientitem-class.md) whose source is to be updated.  \n  \n `pParentWnd`  \n Points to the parent or owner window object (of type `CWnd`) to which the dialog object belongs. If it is **NULL**, the parent window of the dialog box will be set to the main application window.  \n  \n### Remarks  \n To display the dialog box, call the [DoModal](#colechangesourcedialog__domodal) function.  \n  \n For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure and [OleUIChangeSource](http://msdn.microsoft.com/library/windows/desktop/ms682497) function in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colechangesourcedialog__domodal\"></a>  COleChangeSourceDialog::DoModal  \n Call this function to display the OLE Change Source dialog box.  \n  \n```  \nvirtual INT_PTR DoModal();\n```  \n  \n### Return Value  \n Completion status for the dialog box. One of the following values:  \n  \n- **IDOK** if the dialog box was successfully displayed.  \n  \n- **IDCANCEL** if the user canceled the dialog box.  \n  \n- **IDABORT** if an error occurred. If **IDABORT** is returned, call the [COleDialog::GetLastError](../../mfc/reference/coledialog-class.md#coledialog__getlasterror) member function to get more information about the type of error that occurred. For a listing of possible errors, see the [OleUIChangeSource](http://msdn.microsoft.com/library/windows/desktop/ms682497) function in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Remarks  \n If you want to initialize the various dialog box controls by setting members of the [m_cs](#colechangesourcedialog__m_cs) structure, you should do this before calling `DoModal`, but after the dialog object is constructed.  \n  \n If `DoModal` returns **IDOK**, you can call member functions to retrieve user-entered settings or information from the dialog box. The following list names typical query functions:  \n  \n- [GetFileName](#colechangesourcedialog__getfilename)  \n  \n- [GetDisplayName](#colechangesourcedialog__getdisplayname)  \n  \n- [GetItemName](#colechangesourcedialog__getitemname)  \n  \n##  <a name=\"colechangesourcedialog__getdisplayname\"></a>  COleChangeSourceDialog::GetDisplayName  \n Call this function to retrieve the complete display name for the linked client item.  \n  \n```  \nCString GetDisplayName();\n```  \n  \n### Return Value  \n The complete source display name (moniker) for the [COleClientItem](../../mfc/reference/coleclientitem-class.md) specified in the constructor.  \n  \n##  <a name=\"colechangesourcedialog__getfilename\"></a>  COleChangeSourceDialog::GetFileName  \n Call this function to retrieve the file moniker portion of the display name for the linked client item.  \n  \n```  \nCString GetFileName();\n```  \n  \n### Return Value  \n The file moniker portion of the source display name for the [COleClientItem](../../mfc/reference/coleclientitem-class.md) specified in the constructor.  \n  \n### Remarks  \n The file moniker together with the item moniker gives the complete display name.  \n  \n##  <a name=\"colechangesourcedialog__getfromprefix\"></a>  COleChangeSourceDialog::GetFromPrefix  \n Call this function to get the previous prefix string for the source.  \n  \n```  \nCString GetFromPrefix();\n```  \n  \n### Return Value  \n The previous prefix string of the source.  \n  \n### Remarks  \n Call this function only after [DoModal](#colechangesourcedialog__domodal) returns **IDOK**.  \n  \n This value comes directly from the **lpszFrom** member of the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure.  \n  \n For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colechangesourcedialog__getitemname\"></a>  COleChangeSourceDialog::GetItemName  \n Call this function to retrieve the item moniker portion of the display name for the linked client item.  \n  \n```  \nCString GetItemName();\n```  \n  \n### Return Value  \n The item moniker portion of the source display name for the [COleClientItem](../../mfc/reference/coleclientitem-class.md) specified in the constructor.  \n  \n### Remarks  \n The file moniker together with the item moniker gives the complete display name.  \n  \n##  <a name=\"colechangesourcedialog__gettoprefix\"></a>  COleChangeSourceDialog::GetToPrefix  \n Call this function to get the new prefix string for the source.  \n  \n```  \nCString GetToPrefix();\n```  \n  \n### Return Value  \n The new prefix string of the source.  \n  \n### Remarks  \n Call this function only after [DoModal](#colechangesourcedialog__domodal) returns **IDOK**.  \n  \n This value comes directly from the **lpszTo** member of the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure.  \n  \n For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colechangesourcedialog__m_cs\"></a>  COleChangeSourceDialog::m_cs  \n This data member is a structure of type [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160).  \n  \n```  \nOLEUICHANGESOURCE m_cs;  \n```  \n  \n### Remarks  \n `OLEUICHANGESOURCE` is used to control the behavior of the OLE Change Source dialog box. Members of this structure can be modified directly.  \n  \n For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colechangesourcedialog__isvalidsource\"></a>  COleChangeSourceDialog::IsValidSource  \n Call this function to determine if the new source is valid.  \n  \n```  \nBOOL IsValidSource();\n```  \n  \n### Return Value  \n Nonzero if the new source is valid, otherwise 0.  \n  \n### Remarks  \n Call this function only after [DoModal](#colechangesourcedialog__domodal) returns **IDOK**.  \n  \n For more information, see the [OLEUICHANGESOURCE](http://msdn.microsoft.com/library/windows/desktop/ms682160) structure in [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [COleDialog Class](../../mfc/reference/coledialog-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [COleDialog Class](../../mfc/reference/coledialog-class.md)\n"}