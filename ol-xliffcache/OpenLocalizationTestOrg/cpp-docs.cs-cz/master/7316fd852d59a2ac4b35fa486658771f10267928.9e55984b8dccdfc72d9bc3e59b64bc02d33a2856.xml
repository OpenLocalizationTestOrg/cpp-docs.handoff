{"nodes":[{"pos":[12,75],"content":"MFC ActiveX Controls: Adding Custom Properties | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Adding Custom Properties | Microsoft Docs","pos":[0,63]}]},{"content":"MFC ActiveX Controls: Adding Custom Properties","pos":[648,694]},{"content":"Custom properties differ from stock properties in that custom properties are not already implemented by the <ph id=\"ph1\">`COleControl`</ph> class.","pos":[695,823],"source":"Custom properties differ from stock properties in that custom properties are not already implemented by the `COleControl` class."},{"content":"A custom property is used to expose a certain state or appearance of an ActiveX control to a programmer using the control.","pos":[824,946]},{"content":"This article describes how to add a custom property to the ActiveX control using the Add Property Wizard and explains the resulting code modifications.","pos":[953,1104]},{"content":"Topics include:","pos":[1105,1120]},{"content":"Using the Add Property Wizard to add a custom property","pos":[1131,1185]},{"content":"Add Property Wizard changes for custom properties","pos":[1248,1297]},{"content":"Custom properties come in four varieties of implementation: Member Variable, Member Variable with Notification, Get/Set Methods, and Parameterized.","pos":[1355,1502]},{"content":"Member Variable Implementation","pos":[1512,1542]},{"content":"This implementation represents the property's state as a member variable in the control class.","pos":[1553,1647]},{"content":"Use the Member Variable implementation when it is not important to know when the property value changes.","pos":[1648,1752]},{"content":"Of the three types, this implementation creates the least amount of support code for the property.","pos":[1753,1851]},{"content":"The dispatch map entry macro for member variable implementation is <bpt id=\"p1\">[</bpt>DISP_PROPERTY<ept id=\"p1\">](../mfc/reference/dispatch-maps.md#disp_property)</ept>.","pos":[1852,1984],"source":" The dispatch map entry macro for member variable implementation is [DISP_PROPERTY](../mfc/reference/dispatch-maps.md#disp_property)."},{"content":"Member Variable with Notification Implementation","pos":[1994,2042]},{"content":"This implementation consists of a member variable and a notification function created by the Add Property Wizard.","pos":[2053,2166]},{"content":"The notification function is automatically called by the framework after the property value changes.","pos":[2167,2267]},{"content":"Use the Member Variable with Notification implementation when you need to be notified after a property value has changed.","pos":[2268,2389]},{"content":"This implementation requires more time because it requires a function call.","pos":[2390,2465]},{"content":"The dispatch map entry macro for this implementation is <bpt id=\"p1\">[</bpt>DISP_PROPERTY_NOTIFY<ept id=\"p1\">](../mfc/reference/dispatch-maps.md#disp_property_notify)</ept>.","pos":[2466,2601],"source":" The dispatch map entry macro for this implementation is [DISP_PROPERTY_NOTIFY](../mfc/reference/dispatch-maps.md#disp_property_notify)."},{"content":"Get/Set Methods Implementation","pos":[2611,2641]},{"content":"This implementation consists of a pair of member functions in the control class.","pos":[2652,2732]},{"content":"The Get/Set Methods implementation automatically calls the Get member function when the control's user requests the current value of the property and the Set member function when the control's user requests that the property be changed.","pos":[2733,2969]},{"content":"Use this implementation when you need to compute the value of a property during run time, validate a value passed by the control's user before changing the actual property, or implement a read- or write-only property type.","pos":[2970,3192]},{"content":"The dispatch map entry macro for this implementation is <bpt id=\"p1\">[</bpt>DISP_PROPERTY_EX<ept id=\"p1\">](../mfc/reference/dispatch-maps.md#disp_property_ex)</ept>.","pos":[3193,3320],"source":" The dispatch map entry macro for this implementation is [DISP_PROPERTY_EX](../mfc/reference/dispatch-maps.md#disp_property_ex)."},{"content":"The following section, <bpt id=\"p1\">[</bpt>Using the Add Property Wizard to Add a Custom Property<ept id=\"p1\">](#_core_using_classwizard_to_add_a_custom_property)</ept>, uses the CircleOffset custom property to demonstrate this implementation.","pos":[3321,3526],"source":" The following section, [Using the Add Property Wizard to Add a Custom Property](#_core_using_classwizard_to_add_a_custom_property), uses the CircleOffset custom property to demonstrate this implementation."},{"content":"Parameterized Implementation","pos":[3536,3564]},{"content":"Parameterized implementation is supported by the Add Property Wizard.","pos":[3575,3644]},{"content":"A parameterized property (sometimes called a property array) can be used to access a set of values through a single property of your control.","pos":[3645,3786]},{"content":"The dispatch map entry macro for this implementation is <ph id=\"ph1\">`DISP_PROPERTY_PARAM`</ph>.","pos":[3787,3865],"source":" The dispatch map entry macro for this implementation is `DISP_PROPERTY_PARAM`."},{"content":"For more information on implementing this type, see <bpt id=\"p1\">[</bpt>Implementing a Parameterized Property<ept id=\"p1\">](../mfc/mfc-activex-controls-advanced-topics.md)</ept> in the article ActiveX Controls: Advanced Topics.","pos":[3866,4055],"source":" For more information on implementing this type, see [Implementing a Parameterized Property](../mfc/mfc-activex-controls-advanced-topics.md) in the article ActiveX Controls: Advanced Topics."},{"pos":[4129,4183],"content":"Using the Add Property Wizard to Add a Custom Property"},{"content":"The following procedure demonstrates adding a custom property, CircleOffset, which uses the Get/Set Methods implementation.","pos":[4187,4310]},{"content":"The CircleOffset custom property allows the control's user to offset the circle from the center of the control's bounding rectangle.","pos":[4311,4443]},{"content":"The procedure for adding custom properties with an implementation other than Get/Set Methods is very similar.","pos":[4444,4553]},{"content":"This same procedure can also be used to add other custom properties you want.","pos":[4560,4637]},{"content":"Substitute your custom property name for the CircleOffset property name and parameters.","pos":[4638,4725]},{"content":"To add the CircleOffset custom property using the Add Property Wizard","pos":[4736,4805]},{"content":"Load your control's project.","pos":[4815,4843]},{"content":"In Class View, expand the library node of your control.","pos":[4853,4908]},{"content":"Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.","pos":[4918,5030]},{"pos":[5040,5110],"content":"From the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Property<ept id=\"p2\">**</ept>.","source":"From the shortcut menu, click **Add** and then click **Add Property**."},{"pos":[5121,5195],"content":"This opens the <bpt id=\"p1\">[</bpt>Add Property Wizard<ept id=\"p1\">](../ide/names-add-property-wizard.md)</ept>.","source":"This opens the [Add Property Wizard](../ide/names-add-property-wizard.md)."},{"pos":[5205,5255],"content":"In the <bpt id=\"p1\">**</bpt>Property Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`CircleOffset`</ph>.","source":"In the **Property Name** box, type `CircleOffset`."},{"pos":[5265,5320],"content":"For <bpt id=\"p1\">**</bpt>Implementation Type<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Get/Set Methods<ept id=\"p2\">**</ept>.","source":"For **Implementation Type**, click **Get/Set Methods**."},{"pos":[5330,5377],"content":"In the <bpt id=\"p1\">**</bpt>Property Type<ept id=\"p1\">**</ept> box, select <bpt id=\"p2\">**</bpt>short<ept id=\"p2\">**</ept>.","source":"In the **Property Type** box, select **short**."},{"content":"Type unique names for your Get and Set Functions, or accept the default names.","pos":[5387,5465]},{"pos":[5474,5491],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Click **Finish**."},{"pos":[5564,5613],"content":"Add Property Wizard Changes for Custom Properties"},{"content":"When you add the CircleOffset custom property, the Add Property Wizard makes changes to the header (.H) and the implementation (.CPP) files of the control class.","pos":[5617,5778]},{"pos":[5785,5902],"content":"The following lines are added to the .H file to declare two functions called <ph id=\"ph1\">`GetCircleOffset`</ph> and <ph id=\"ph2\">`SetCircleOffset`</ph>:","source":"The following lines are added to the .H file to declare two functions called `GetCircleOffset` and `SetCircleOffset`:"},{"pos":[5920,5935],"content":"NVC_MFC_AxUI#25"},{"content":"The following line is added to your control's .IDL file:","pos":[6018,6074]},{"pos":[6092,6107],"content":"NVC_MFC_AxUI#26"},{"content":"This line assigns the CircleOffset property a specific ID number, taken from the method's position in the methods and properties list of the Add Property Wizard.","pos":[6192,6353]},{"content":"In addition, the following line is added to the dispatch map (in the .CPP file of the control class) to map the CircleOffset property to the control's two handler functions:","pos":[6360,6533]},{"pos":[6551,6566],"content":"NVC_MFC_AxUI#27"},{"content":"Finally, the implementations of the <ph id=\"ph1\">`GetCircleOffset`</ph> and <ph id=\"ph2\">`SetCircleOffset`</ph> functions are added to the end of the control's .CPP file.","pos":[6651,6785],"source":"Finally, the implementations of the `GetCircleOffset` and `SetCircleOffset` functions are added to the end of the control's .CPP file."},{"content":"In most cases, you will modify the Get function to return the value of the property.","pos":[6786,6870]},{"content":"The Set function will usually contain code that should be executed either before or after the property changes.","pos":[6871,6982]},{"pos":[7000,7015],"content":"NVC_MFC_AxUI#28"},{"content":"Note that the Add Property Wizard automatically adds a call, to <bpt id=\"p1\">[</bpt>SetModifiedFlag<ept id=\"p1\">](../mfc/reference/colecontrol-class.md#colecontrol__setmodifiedflag)</ept>, to the body of the Set function.","pos":[7100,7283],"source":"Note that the Add Property Wizard automatically adds a call, to [SetModifiedFlag](../mfc/reference/colecontrol-class.md#colecontrol__setmodifiedflag), to the body of the Set function."},{"content":"Calling this function marks the control as modified.","pos":[7284,7336]},{"content":"If a control has been modified, its new state will be saved when the container is saved.","pos":[7337,7425]},{"content":"This function should be called whenever a property, saved as part of the control's persistent state, changes value.","pos":[7426,7541]},{"content":"See Also","pos":[7550,7558]},{"content":"MFC ActiveX Controls","pos":[7563,7583]},{"content":"MFC ActiveX Controls: Properties","pos":[7622,7654]},{"content":"MFC ActiveX Controls: Methods","pos":[7704,7733]},{"content":"COleControl Class","pos":[7780,7797]}],"content":"---\ntitle: \"MFC ActiveX Controls: Adding Custom Properties | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, properties\"\n  - \"properties [MFC], custom\"\nms.assetid: 85af5167-74c7-427b-b8f3-e0d7b73942e5\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Adding Custom Properties\nCustom properties differ from stock properties in that custom properties are not already implemented by the `COleControl` class. A custom property is used to expose a certain state or appearance of an ActiveX control to a programmer using the control.  \n  \n This article describes how to add a custom property to the ActiveX control using the Add Property Wizard and explains the resulting code modifications. Topics include:  \n  \n-   [Using the Add Property Wizard to add a custom property](#_core_using_classwizard_to_add_a_custom_property)  \n  \n-   [Add Property Wizard changes for custom properties](#_core_classwizard_changes_for_custom_properties)  \n  \n Custom properties come in four varieties of implementation: Member Variable, Member Variable with Notification, Get/Set Methods, and Parameterized.  \n  \n-   Member Variable Implementation  \n  \n     This implementation represents the property's state as a member variable in the control class. Use the Member Variable implementation when it is not important to know when the property value changes. Of the three types, this implementation creates the least amount of support code for the property. The dispatch map entry macro for member variable implementation is [DISP_PROPERTY](../mfc/reference/dispatch-maps.md#disp_property).  \n  \n-   Member Variable with Notification Implementation  \n  \n     This implementation consists of a member variable and a notification function created by the Add Property Wizard. The notification function is automatically called by the framework after the property value changes. Use the Member Variable with Notification implementation when you need to be notified after a property value has changed. This implementation requires more time because it requires a function call. The dispatch map entry macro for this implementation is [DISP_PROPERTY_NOTIFY](../mfc/reference/dispatch-maps.md#disp_property_notify).  \n  \n-   Get/Set Methods Implementation  \n  \n     This implementation consists of a pair of member functions in the control class. The Get/Set Methods implementation automatically calls the Get member function when the control's user requests the current value of the property and the Set member function when the control's user requests that the property be changed. Use this implementation when you need to compute the value of a property during run time, validate a value passed by the control's user before changing the actual property, or implement a read- or write-only property type. The dispatch map entry macro for this implementation is [DISP_PROPERTY_EX](../mfc/reference/dispatch-maps.md#disp_property_ex). The following section, [Using the Add Property Wizard to Add a Custom Property](#_core_using_classwizard_to_add_a_custom_property), uses the CircleOffset custom property to demonstrate this implementation.  \n  \n-   Parameterized Implementation  \n  \n     Parameterized implementation is supported by the Add Property Wizard. A parameterized property (sometimes called a property array) can be used to access a set of values through a single property of your control. The dispatch map entry macro for this implementation is `DISP_PROPERTY_PARAM`. For more information on implementing this type, see [Implementing a Parameterized Property](../mfc/mfc-activex-controls-advanced-topics.md) in the article ActiveX Controls: Advanced Topics.  \n  \n##  <a name=\"_core_using_classwizard_to_add_a_custom_property\"></a> Using the Add Property Wizard to Add a Custom Property  \n The following procedure demonstrates adding a custom property, CircleOffset, which uses the Get/Set Methods implementation. The CircleOffset custom property allows the control's user to offset the circle from the center of the control's bounding rectangle. The procedure for adding custom properties with an implementation other than Get/Set Methods is very similar.  \n  \n This same procedure can also be used to add other custom properties you want. Substitute your custom property name for the CircleOffset property name and parameters.  \n  \n#### To add the CircleOffset custom property using the Add Property Wizard  \n  \n1.  Load your control's project.  \n  \n2.  In Class View, expand the library node of your control.  \n  \n3.  Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.  \n  \n4.  From the shortcut menu, click **Add** and then click **Add Property**.  \n  \n     This opens the [Add Property Wizard](../ide/names-add-property-wizard.md).  \n  \n5.  In the **Property Name** box, type `CircleOffset`.  \n  \n6.  For **Implementation Type**, click **Get/Set Methods**.  \n  \n7.  In the **Property Type** box, select **short**.  \n  \n8.  Type unique names for your Get and Set Functions, or accept the default names.  \n  \n9. Click **Finish**.  \n  \n##  <a name=\"_core_classwizard_changes_for_custom_properties\"></a> Add Property Wizard Changes for Custom Properties  \n When you add the CircleOffset custom property, the Add Property Wizard makes changes to the header (.H) and the implementation (.CPP) files of the control class.  \n  \n The following lines are added to the .H file to declare two functions called `GetCircleOffset` and `SetCircleOffset`:  \n  \n [!code-cpp[NVC_MFC_AxUI#25](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_1.h)]  \n  \n The following line is added to your control's .IDL file:  \n  \n [!code-cpp[NVC_MFC_AxUI#26](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_2.idl)]  \n  \n This line assigns the CircleOffset property a specific ID number, taken from the method's position in the methods and properties list of the Add Property Wizard.  \n  \n In addition, the following line is added to the dispatch map (in the .CPP file of the control class) to map the CircleOffset property to the control's two handler functions:  \n  \n [!code-cpp[NVC_MFC_AxUI#27](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_3.cpp)]  \n  \n Finally, the implementations of the `GetCircleOffset` and `SetCircleOffset` functions are added to the end of the control's .CPP file. In most cases, you will modify the Get function to return the value of the property. The Set function will usually contain code that should be executed either before or after the property changes.  \n  \n [!code-cpp[NVC_MFC_AxUI#28](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_4.cpp)]  \n  \n Note that the Add Property Wizard automatically adds a call, to [SetModifiedFlag](../mfc/reference/colecontrol-class.md#colecontrol__setmodifiedflag), to the body of the Set function. Calling this function marks the control as modified. If a control has been modified, its new state will be saved when the container is saved. This function should be called whenever a property, saved as part of the control's persistent state, changes value.  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)   \n [MFC ActiveX Controls: Properties](../mfc/mfc-activex-controls-properties.md)   \n [MFC ActiveX Controls: Methods](../mfc/mfc-activex-controls-methods.md)   \n [COleControl Class](../mfc/reference/colecontrol-class.md)\n"}