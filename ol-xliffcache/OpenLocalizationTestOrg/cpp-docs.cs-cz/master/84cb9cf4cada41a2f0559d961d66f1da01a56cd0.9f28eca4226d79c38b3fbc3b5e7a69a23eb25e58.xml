{"nodes":[{"pos":[12,53],"content":"Manipulating Image Lists | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Manipulating Image Lists | Microsoft Docs","pos":[0,41]}]},{"content":"Manipulating Image Lists","pos":[656,680]},{"content":"The <bpt id=\"p1\">[</bpt>Replace<ept id=\"p1\">](../mfc/reference/cimagelist-class.md#cimagelist__replace)</ept> member function replaces an image in an image list (<bpt id=\"p2\">[</bpt>CImageList<ept id=\"p2\">](../mfc/reference/cimagelist-class.md)</ept>) with a new image.","pos":[681,874],"source":"The [Replace](../mfc/reference/cimagelist-class.md#cimagelist__replace) member function replaces an image in an image list ([CImageList](../mfc/reference/cimagelist-class.md)) with a new image."},{"content":"This function is also useful if you need to dynamically increase the number of images in an image list object.","pos":[875,985]},{"content":"The <bpt id=\"p1\">[</bpt>SetImageCount<ept id=\"p1\">](../mfc/reference/cimagelist-class.md#cimagelist__setimagecount)</ept> function dynamically changes the number of images stored in the image list.","pos":[986,1145],"source":" The [SetImageCount](../mfc/reference/cimagelist-class.md#cimagelist__setimagecount) function dynamically changes the number of images stored in the image list."},{"content":"If you increase the size of the image list, call <bpt id=\"p1\">**</bpt>Replace<ept id=\"p1\">**</ept> to add images to the new image slots.","pos":[1146,1244],"source":" If you increase the size of the image list, call **Replace** to add images to the new image slots."},{"content":"If you decrease the size of the image list, the images beyond the new size are freed.","pos":[1245,1330]},{"content":"The <bpt id=\"p1\">[</bpt>Remove<ept id=\"p1\">](../mfc/reference/cimagelist-class.md#cimagelist__remove)</ept> member function removes an image from an image list.","pos":[1337,1459],"source":"The [Remove](../mfc/reference/cimagelist-class.md#cimagelist__remove) member function removes an image from an image list."},{"content":"The <bpt id=\"p1\">[</bpt>Copy<ept id=\"p1\">](../mfc/reference/cimagelist-class.md#cimagelist__copy)</ept> member function can copy or swap images within an image list.","pos":[1460,1587],"source":" The [Copy](../mfc/reference/cimagelist-class.md#cimagelist__copy) member function can copy or swap images within an image list."},{"content":"This function allows you to indicate whether the source image should be copied to the destination index or the source and destination images should be swapped.","pos":[1588,1747]},{"content":"To create a new image list by merging two image lists, use the appropriate overload of the <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](../mfc/reference/cimagelist-class.md#cimagelist__create)</ept> member function.","pos":[1754,1927],"source":"To create a new image list by merging two image lists, use the appropriate overload of the [Create](../mfc/reference/cimagelist-class.md#cimagelist__create) member function."},{"content":"This overload of <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> merges the first image of the existing image lists, storing the resultant image in a new image list object.","pos":[1928,2063],"source":" This overload of **Create** merges the first image of the existing image lists, storing the resultant image in a new image list object."},{"content":"The new image is created by drawing the second image transparently over the first.","pos":[2064,2146]},{"content":"The mask for the new image is the result of performing a logical-OR operation on the bits of the masks for the two existing images.","pos":[2147,2278]},{"content":"This is repeated until all images are merged and added to the new image list object.","pos":[2285,2369]},{"pos":[2376,2632],"content":"You can write the image information to an archive by calling the <bpt id=\"p1\">[</bpt>Write<ept id=\"p1\">](../mfc/reference/cimagelist-class.md#cimagelist__write)</ept> member function, and read it back by calling the <bpt id=\"p2\">[</bpt>Read<ept id=\"p2\">](../mfc/reference/cimagelist-class.md#cimagelist__read)</ept> member function.","source":"You can write the image information to an archive by calling the [Write](../mfc/reference/cimagelist-class.md#cimagelist__write) member function, and read it back by calling the [Read](../mfc/reference/cimagelist-class.md#cimagelist__read) member function."},{"pos":[2639,3144],"content":"The <bpt id=\"p1\">[</bpt>GetSafeHandle<ept id=\"p1\">](../mfc/reference/cimagelist-class.md#cimagelist__getsafehandle)</ept>, <bpt id=\"p2\">[</bpt>Attach<ept id=\"p2\">](../mfc/reference/cimagelist-class.md#cimagelist__attach)</ept>, and <bpt id=\"p3\">[</bpt>Detach<ept id=\"p3\">](../mfc/reference/cimagelist-class.md#cimagelist__detach)</ept> member functions allow you to manipulate the handle of the image list attached to the <ph id=\"ph1\">`CImageList`</ph> object, while the <bpt id=\"p4\">[</bpt>DeleteImageList<ept id=\"p4\">](../mfc/reference/cimagelist-class.md#cimagelist__deleteimagelist)</ept> member function deletes the image list without destroying the <ph id=\"ph2\">`CImageList`</ph> object.","source":"The [GetSafeHandle](../mfc/reference/cimagelist-class.md#cimagelist__getsafehandle), [Attach](../mfc/reference/cimagelist-class.md#cimagelist__attach), and [Detach](../mfc/reference/cimagelist-class.md#cimagelist__detach) member functions allow you to manipulate the handle of the image list attached to the `CImageList` object, while the [DeleteImageList](../mfc/reference/cimagelist-class.md#cimagelist__deleteimagelist) member function deletes the image list without destroying the `CImageList` object."},{"content":"See Also","pos":[3153,3161]},{"content":"Using CImageList","pos":[3166,3182]},{"content":"Controls","pos":[3217,3225]}],"content":"---\ntitle: \"Manipulating Image Lists | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"image lists [C++], manipulating\"\n  - \"lists [C++], image\"\n  - \"CImageList class, manipulating\"\nms.assetid: 043418f8-077e-4dce-b8bb-2b7b0d7b5156\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Manipulating Image Lists\nThe [Replace](../mfc/reference/cimagelist-class.md#cimagelist__replace) member function replaces an image in an image list ([CImageList](../mfc/reference/cimagelist-class.md)) with a new image. This function is also useful if you need to dynamically increase the number of images in an image list object. The [SetImageCount](../mfc/reference/cimagelist-class.md#cimagelist__setimagecount) function dynamically changes the number of images stored in the image list. If you increase the size of the image list, call **Replace** to add images to the new image slots. If you decrease the size of the image list, the images beyond the new size are freed.  \n  \n The [Remove](../mfc/reference/cimagelist-class.md#cimagelist__remove) member function removes an image from an image list. The [Copy](../mfc/reference/cimagelist-class.md#cimagelist__copy) member function can copy or swap images within an image list. This function allows you to indicate whether the source image should be copied to the destination index or the source and destination images should be swapped.  \n  \n To create a new image list by merging two image lists, use the appropriate overload of the [Create](../mfc/reference/cimagelist-class.md#cimagelist__create) member function. This overload of **Create** merges the first image of the existing image lists, storing the resultant image in a new image list object. The new image is created by drawing the second image transparently over the first. The mask for the new image is the result of performing a logical-OR operation on the bits of the masks for the two existing images.  \n  \n This is repeated until all images are merged and added to the new image list object.  \n  \n You can write the image information to an archive by calling the [Write](../mfc/reference/cimagelist-class.md#cimagelist__write) member function, and read it back by calling the [Read](../mfc/reference/cimagelist-class.md#cimagelist__read) member function.  \n  \n The [GetSafeHandle](../mfc/reference/cimagelist-class.md#cimagelist__getsafehandle), [Attach](../mfc/reference/cimagelist-class.md#cimagelist__attach), and [Detach](../mfc/reference/cimagelist-class.md#cimagelist__detach) member functions allow you to manipulate the handle of the image list attached to the `CImageList` object, while the [DeleteImageList](../mfc/reference/cimagelist-class.md#cimagelist__deleteimagelist) member function deletes the image list without destroying the `CImageList` object.  \n  \n## See Also  \n [Using CImageList](../mfc/using-cimagelist.md)   \n [Controls](../mfc/controls-mfc.md)\n\n"}