{"nodes":[{"pos":[12,38],"content":"db_column | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"db_column | Microsoft Docs","pos":[0,26]}]},{"content":"db_column","pos":[616,625]},{"content":"Binds a specified column to a variable in the rowset.","pos":[626,679]},{"content":"Syntax","pos":[688,694]},{"content":"Parameters","pos":[837,847]},{"content":"The ordinal column number (<bpt id=\"p1\">**</bpt>DBCOLUMNINFO<ept id=\"p1\">**</ept> ordinal) or column name (ANSI or Unicode string) corresponding to a field in the rowset to which to bind data.","pos":[864,1018],"source":" The ordinal column number (**DBCOLUMNINFO** ordinal) or column name (ANSI or Unicode string) corresponding to a field in the rowset to which to bind data."},{"content":"If you use numbers, you can skip consecutive ordinals (for example: 1, 2, 3, 5).","pos":[1019,1099]},{"content":"The name may contain spaces if the OLE DB provider you use supports it.","pos":[1100,1171]},{"content":"For example, you can use either of the following formats:","pos":[1172,1229]},{"content":"<bpt id=\"p1\">*</bpt>dbtype<ept id=\"p1\">*</ept> (optional)","pos":[1334,1353],"source":"*dbtype* (optional)"},{"content":"An OLE DB <bpt id=\"p1\">[</bpt>Type Indicator<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms711251.aspx)</ept> for the column entry.","pos":[1357,1461],"source":" An OLE DB [Type Indicator](https://msdn.microsoft.com/en-us/library/ms711251.aspx) for the column entry."},{"content":"<bpt id=\"p1\">*</bpt>precision<ept id=\"p1\">*</ept> (optional)","pos":[1468,1490],"source":"*precision* (optional)"},{"content":"The precision to be used for the column entry.","pos":[1494,1540]},{"content":"For details, see the description of the <ph id=\"ph1\">`bPrecision`</ph> element of the <bpt id=\"p1\">[</bpt>DBBINDING structure<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms716845.aspx)</ept>","pos":[1541,1686],"source":" For details, see the description of the `bPrecision` element of the [DBBINDING structure](https://msdn.microsoft.com/en-us/library/ms716845.aspx)"},{"content":"<bpt id=\"p1\">*</bpt>scale<ept id=\"p1\">*</ept> (optional)","pos":[1693,1711],"source":"*scale* (optional)"},{"content":"The scale to be used for the column entry.","pos":[1715,1757]},{"content":"For details, see the description of <ph id=\"ph1\">`bScale`</ph> element of the <bpt id=\"p1\">[</bpt>DBBINDING structure<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms716845.aspx)</ept>","pos":[1758,1895],"source":" For details, see the description of `bScale` element of the [DBBINDING structure](https://msdn.microsoft.com/en-us/library/ms716845.aspx)"},{"content":"<bpt id=\"p1\">*</bpt>status<ept id=\"p1\">*</ept> (optional)","pos":[1902,1921],"source":"*status* (optional)"},{"content":"A member variable used to hold the status of this column.","pos":[1925,1982]},{"content":"The status indicates whether the column value is a data value or some other value, such as <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[1983,2083],"source":" The status indicates whether the column value is a data value or some other value, such as **NULL**."},{"content":"For possible values, see <bpt id=\"p1\">[</bpt>Status<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms722617.aspx)</ept> in the <bpt id=\"p2\">*</bpt>OLE DB Programmer's Reference<ept id=\"p2\">*</ept>.","pos":[2084,2213],"source":" For possible values, see [Status](https://msdn.microsoft.com/en-us/library/ms722617.aspx) in the *OLE DB Programmer's Reference*."},{"content":"<bpt id=\"p1\">*</bpt>length<ept id=\"p1\">*</ept> (optional)","pos":[2220,2239],"source":"*length* (optional)"},{"content":"A member variable used to hold the size of the column in bytes.","pos":[2243,2306]},{"content":"Remarks","pos":[2315,2322]},{"content":"<bpt id=\"p1\">**</bpt>db_column<ept id=\"p1\">**</ept> binds the specified table column to a variable in the rowset.","pos":[2326,2401],"source":"**db_column** binds the specified table column to a variable in the rowset."},{"content":"It delimits member data that can participate in OLE DB <ph id=\"ph1\">`IAccessor`</ph>-based binding.","pos":[2402,2483],"source":" It delimits member data that can participate in OLE DB `IAccessor`-based binding."},{"content":"This attribute sets up the column map normally defined using the OLE DB consumer macros <bpt id=\"p1\">[</bpt>BEGIN_COLUMN_MAP<ept id=\"p1\">](../data/oledb/begin-column-map.md)</ept>, <bpt id=\"p2\">[</bpt>END_COLUMN_MAP<ept id=\"p2\">](../data/oledb/end-column-map.md)</ept>, and <bpt id=\"p3\">[</bpt>COLUMN_ENTRY<ept id=\"p3\">](../data/oledb/column-entry.md)</ept>.","pos":[2484,2728],"source":" This attribute sets up the column map normally defined using the OLE DB consumer macros [BEGIN_COLUMN_MAP](../data/oledb/begin-column-map.md), [END_COLUMN_MAP](../data/oledb/end-column-map.md), and [COLUMN_ENTRY](../data/oledb/column-entry.md)."},{"content":"These manipulate the OLE DB <bpt id=\"p1\">[</bpt>DBBINDING structure<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms716845.aspx)</ept> to bind the specified column.","pos":[2729,2864],"source":" These manipulate the OLE DB [DBBINDING structure](https://msdn.microsoft.com/en-us/library/ms716845.aspx) to bind the specified column."},{"content":"Each member you mark with the <bpt id=\"p1\">**</bpt>db_column<ept id=\"p1\">**</ept> attribute will occupy one entry in the column map in the form of a column entry.","pos":[2865,2989],"source":" Each member you mark with the **db_column** attribute will occupy one entry in the column map in the form of a column entry."},{"content":"Therefore, you call this attribute where you would put the column map, that is, in the command or table class.","pos":[2990,3100]},{"pos":[3107,3244],"content":"Use <bpt id=\"p1\">**</bpt>db_column<ept id=\"p1\">**</ept> in conjunction with either the <bpt id=\"p2\">[</bpt>db_table<ept id=\"p2\">](../windows/db-table.md)</ept> or <bpt id=\"p3\">[</bpt>db_command<ept id=\"p3\">](../windows/db-command.md)</ept> attributes.","source":"Use **db_column** in conjunction with either the [db_table](../windows/db-table.md) or [db_command](../windows/db-command.md) attributes."},{"content":"When the consumer attribute provider applies this attribute to a class, the compiler will rename the class to _<bpt id=\"p1\">*</bpt>YourClassName<ept id=\"p1\">*</ept>Accessor, where <bpt id=\"p2\">*</bpt>YourClassName<ept id=\"p2\">*</ept> is the name you gave the class, and the compiler will also create a class called <bpt id=\"p3\">*</bpt>YourClassName,<ept id=\"p3\">*</ept> which derives from <ph id=\"ph1\">\\_</ph><bpt id=\"p4\">*</bpt>YourClassName<ept id=\"p4\">*</ept>Accessor.","pos":[3251,3552],"source":"When the consumer attribute provider applies this attribute to a class, the compiler will rename the class to _*YourClassName*Accessor, where *YourClassName* is the name you gave the class, and the compiler will also create a class called *YourClassName,* which derives from \\_*YourClassName*Accessor."},{"content":"In Class View, you will see both classes.","pos":[3554,3595]},{"pos":[3602,3841],"content":"For examples of this attribute used in an application, see the samples <bpt id=\"p1\">[</bpt>AtlAgent<ept id=\"p1\">](http://msdn.microsoft.com/en-us/52bef5da-c1a0-4223-b4e6-9e464b6db409)</ept>, and <bpt id=\"p2\">[</bpt>MultiRead<ept id=\"p2\">](http://msdn.microsoft.com/en-us/5a2a915a-77dc-492f-94b2-1b809995dd5e)</ept>.","source":"For examples of this attribute used in an application, see the samples [AtlAgent](http://msdn.microsoft.com/en-us/52bef5da-c1a0-4223-b4e6-9e464b6db409), and [MultiRead](http://msdn.microsoft.com/en-us/5a2a915a-77dc-492f-94b2-1b809995dd5e)."},{"content":"Example","pos":[3850,3857]},{"pos":[3861,3964],"content":"This sample binds a column in a table to a <bpt id=\"p1\">**</bpt>long<ept id=\"p1\">**</ept> data member and specifies status and length fields.","source":"This sample binds a column in a table to a **long** data member and specifies status and length fields."},{"content":"Example","pos":[4349,4356]},{"pos":[4360,4483],"content":"This sample binds four columns to a <bpt id=\"p1\">**</bpt>long<ept id=\"p1\">**</ept>, a character string, a timestamp, and a <bpt id=\"p2\">**</bpt>DB_NUMERIC<ept id=\"p2\">**</ept> integer, in that order.","source":"This sample binds four columns to a **long**, a character string, a timestamp, and a **DB_NUMERIC** integer, in that order."},{"content":"Requirements","pos":[4894,4906]},{"content":"Attribute Context","pos":[4916,4933]},{"content":"Applies to","pos":[4956,4966]},{"pos":[4969,5004],"content":"<bpt id=\"p1\">**</bpt>class<ept id=\"p1\">**</ept>, <ph id=\"ph1\">`struct`</ph>, member, method","source":"**class**, `struct`, member, method"},{"content":"Repeatable","pos":[5011,5021]},{"content":"No","pos":[5024,5026]},{"content":"Required attributes","pos":[5033,5052]},{"content":"None","pos":[5055,5059]},{"content":"Invalid attributes","pos":[5066,5084]},{"content":"None","pos":[5087,5091]},{"pos":[5099,5209],"content":"For more information about the attribute contexts, see <bpt id=\"p1\">[</bpt>Attribute Contexts<ept id=\"p1\">](../windows/attribute-contexts.md)</ept>.","source":"For more information about the attribute contexts, see [Attribute Contexts](../windows/attribute-contexts.md)."},{"content":"See Also","pos":[5218,5226]},{"content":"OLE DB Consumer Attributes","pos":[5231,5257]},{"content":"Class Attributes","pos":[5306,5322]},{"content":"Attributes Samples","pos":[5361,5379]}],"content":"---\ntitle: \"db_column | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\nf1_keywords: \n  - \"vc-attr.db_column\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"db_column attribute\"\nms.assetid: 58da4afc-f69c-4ae6-af9a-3f9515f56081\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# db_column\nBinds a specified column to a variable in the rowset.  \n  \n## Syntax  \n  \n```  \n  \n      [ db_column(   \n   ordinal,   \n   dbtype,   \n   precision,   \n   scale,   \n   status,   \n   length   \n) ]  \n```  \n  \n#### Parameters  \n `ordinal`  \n The ordinal column number (**DBCOLUMNINFO** ordinal) or column name (ANSI or Unicode string) corresponding to a field in the rowset to which to bind data. If you use numbers, you can skip consecutive ordinals (for example: 1, 2, 3, 5). The name may contain spaces if the OLE DB provider you use supports it. For example, you can use either of the following formats:  \n  \n```  \n[db_column(\"2\")] TCHAR szCity[30];  \n[db_column(L\"city_name\")] TCHAR szCity[30];  \n```  \n  \n *dbtype* (optional)  \n An OLE DB [Type Indicator](https://msdn.microsoft.com/en-us/library/ms711251.aspx) for the column entry.  \n  \n *precision* (optional)  \n The precision to be used for the column entry. For details, see the description of the `bPrecision` element of the [DBBINDING structure](https://msdn.microsoft.com/en-us/library/ms716845.aspx)  \n  \n *scale* (optional)  \n The scale to be used for the column entry. For details, see the description of `bScale` element of the [DBBINDING structure](https://msdn.microsoft.com/en-us/library/ms716845.aspx)  \n  \n *status* (optional)  \n A member variable used to hold the status of this column. The status indicates whether the column value is a data value or some other value, such as **NULL**. For possible values, see [Status](https://msdn.microsoft.com/en-us/library/ms722617.aspx) in the *OLE DB Programmer's Reference*.  \n  \n *length* (optional)  \n A member variable used to hold the size of the column in bytes.  \n  \n## Remarks  \n **db_column** binds the specified table column to a variable in the rowset. It delimits member data that can participate in OLE DB `IAccessor`-based binding. This attribute sets up the column map normally defined using the OLE DB consumer macros [BEGIN_COLUMN_MAP](../data/oledb/begin-column-map.md), [END_COLUMN_MAP](../data/oledb/end-column-map.md), and [COLUMN_ENTRY](../data/oledb/column-entry.md). These manipulate the OLE DB [DBBINDING structure](https://msdn.microsoft.com/en-us/library/ms716845.aspx) to bind the specified column. Each member you mark with the **db_column** attribute will occupy one entry in the column map in the form of a column entry. Therefore, you call this attribute where you would put the column map, that is, in the command or table class.  \n  \n Use **db_column** in conjunction with either the [db_table](../windows/db-table.md) or [db_command](../windows/db-command.md) attributes.  \n  \n When the consumer attribute provider applies this attribute to a class, the compiler will rename the class to _*YourClassName*Accessor, where *YourClassName* is the name you gave the class, and the compiler will also create a class called *YourClassName,* which derives from \\_*YourClassName*Accessor.  In Class View, you will see both classes.  \n  \n For examples of this attribute used in an application, see the samples [AtlAgent](http://msdn.microsoft.com/en-us/52bef5da-c1a0-4223-b4e6-9e464b6db409), and [MultiRead](http://msdn.microsoft.com/en-us/5a2a915a-77dc-492f-94b2-1b809995dd5e).  \n  \n## Example  \n This sample binds a column in a table to a **long** data member and specifies status and length fields.  \n  \n```  \n// db_column_1.cpp  \n// compile with: /LD  \n#include <atlbase.h>  \n#include <atlplus.h>  \n#include <atldbcli.h>  \n  \n[ db_command(L\"Select * from Products\") ]  \nclass CProducts {  \n   DBSTATUS m_dwProductIDStatus;  \n   DBLENGTH m_dwProductIDLength;  \n  \n   [ db_column(\"1\", status=\"m_dwProductIDStatus\", length=\"m_dwProductIDLength\") ] LONG m_ProductID;  \n};  \n```  \n  \n## Example  \n This sample binds four columns to a **long**, a character string, a timestamp, and a **DB_NUMERIC** integer, in that order.  \n  \n```  \n// db_column_2.cpp  \n// compile with: /LD  \n#include <atlbase.h>  \n#include <atlplus.h>  \n#include <atldbcli.h>  \n  \n[ db_command(L\"Select * from Products\") ]  \nclass CProducts {  \n   [db_column(\"1\")] LONG m_OrderID;  \n   [db_column(\"2\")] TCHAR m_CustomerID[6];  \n   [db_column(\"4\")] DB_NUMERIC m_OrderDate;     \n   [db_column(\"7\", dbtype=\"DBTYPE_NUMERIC\")] DB_NUMERIC m_ShipVia;  \n};  \n```  \n  \n## Requirements  \n  \n### Attribute Context  \n  \n|||  \n|-|-|  \n|**Applies to**|**class**, `struct`, member, method|  \n|**Repeatable**|No|  \n|**Required attributes**|None|  \n|**Invalid attributes**|None|  \n  \n For more information about the attribute contexts, see [Attribute Contexts](../windows/attribute-contexts.md).  \n  \n## See Also  \n [OLE DB Consumer Attributes](../windows/ole-db-consumer-attributes.md)   \n [Class Attributes](../windows/class-attributes.md)   \n [Attributes Samples](http://msdn.microsoft.com/en-us/558ebdb2-082f-44dc-b442-d8d33bf7bdb8)"}