{"nodes":[{"pos":[12,55],"content":"COM Interface Entry Points | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COM Interface Entry Points | Microsoft Docs","pos":[0,43]}]},{"content":"COM Interface Entry Points","pos":[778,804]},{"pos":[805,1032],"content":"For member functions of a COM interface, use the <bpt id=\"p1\">[</bpt>METHOD_PROLOGUE<ept id=\"p1\">](http://msdn.microsoft.com/library/e94c4939-64ea-42de-a501-55594c952828)</ept> macro to maintain the proper global state when calling methods of an exported interface.","source":"For member functions of a COM interface, use the [METHOD_PROLOGUE](http://msdn.microsoft.com/library/e94c4939-64ea-42de-a501-55594c952828) macro to maintain the proper global state when calling methods of an exported interface."},{"content":"Typically, member functions of interfaces implemented by <ph id=\"ph1\">`CCmdTarget`</ph>-derived objects already use this macro to provide automatic initialization of the <ph id=\"ph2\">`pThis`</ph> pointer.","pos":[1039,1207],"source":"Typically, member functions of interfaces implemented by `CCmdTarget`-derived objects already use this macro to provide automatic initialization of the `pThis` pointer."},{"content":"For example:","pos":[1208,1220]},{"pos":[1238,1263],"content":"NVC_MFCConnectionPoints#5"},{"pos":[1329,1469],"content":"For additional information, see <bpt id=\"p1\">[</bpt>Technical Note 38<ept id=\"p1\">](../mfc/tn038-mfc-ole-iunknown-implementation.md)</ept> on MFC/OLE <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> implementation.","source":"For additional information, see [Technical Note 38](../mfc/tn038-mfc-ole-iunknown-implementation.md) on MFC/OLE **IUnknown** implementation."},{"pos":[1476,1518],"content":"The <ph id=\"ph1\">`METHOD_PROLOGUE`</ph> macro is defined as:","source":"The `METHOD_PROLOGUE` macro is defined as:"},{"content":"The portion of the macro concerned with managing the global state is:","pos":[1735,1804]},{"content":"In this expression, <bpt id=\"p1\">*</bpt>m_pModuleState<ept id=\"p1\">*</ept> is assumed to be a member variable of the containing object.","pos":[1861,1958],"source":"In this expression, *m_pModuleState* is assumed to be a member variable of the containing object."},{"content":"It is implemented by the <ph id=\"ph1\">`CCmdTarget`</ph> base class and is initialized to the appropriate value by <ph id=\"ph2\">`COleObjectFactory`</ph>, when the object is instantiated.","pos":[1959,2108],"source":" It is implemented by the `CCmdTarget` base class and is initialized to the appropriate value by `COleObjectFactory`, when the object is instantiated."},{"content":"See Also","pos":[2117,2125]},{"content":"Managing the State Data of MFC Modules","pos":[2130,2168]}],"content":"---\ntitle: \"COM Interface Entry Points | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"entry points, COM interfaces\"\n  - \"state management, OLE/COM interfaces\"\n  - \"MFC COM, COM interface entry points\"\n  - \"OLE, interface entry points\"\n  - \"MFC, managing state data\"\n  - \"COM interfaces, entry points\"\nms.assetid: 9e7421dc-0731-4748-9e1b-90acbaf26d77\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COM Interface Entry Points\nFor member functions of a COM interface, use the [METHOD_PROLOGUE](http://msdn.microsoft.com/library/e94c4939-64ea-42de-a501-55594c952828) macro to maintain the proper global state when calling methods of an exported interface.  \n  \n Typically, member functions of interfaces implemented by `CCmdTarget`-derived objects already use this macro to provide automatic initialization of the `pThis` pointer. For example:  \n  \n [!code-cpp[NVC_MFCConnectionPoints#5](../mfc/codesnippet/cpp/com-interface-entry-points_1.cpp)]  \n  \n For additional information, see [Technical Note 38](../mfc/tn038-mfc-ole-iunknown-implementation.md) on MFC/OLE **IUnknown** implementation.  \n  \n The `METHOD_PROLOGUE` macro is defined as:  \n  \n `#define METHOD_PROLOGUE(theClass, localClass) \\`  \n  \n `theClass* pThis = \\`  \n  \n `((theClass*)((BYTE*)this - offsetof(theClass, m_x##localClass))); \\`  \n  \n `AFX_MANAGE_STATE(pThis->m_pModuleState) \\`  \n  \n The portion of the macro concerned with managing the global state is:  \n  \n `AFX_MANAGE_STATE( pThis->m_pModuleState )`  \n  \n In this expression, *m_pModuleState* is assumed to be a member variable of the containing object. It is implemented by the `CCmdTarget` base class and is initialized to the appropriate value by `COleObjectFactory`, when the object is instantiated.  \n  \n## See Also  \n [Managing the State Data of MFC Modules](../mfc/managing-the-state-data-of-mfc-modules.md)\n\n"}