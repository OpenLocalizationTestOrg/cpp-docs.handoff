{"nodes":[{"pos":[12,73],"content":"Isolation of the MFC Common Controls Library | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Isolation of the MFC Common Controls Library | Microsoft Docs","pos":[0,61]}]},{"content":"Isolation of the MFC Common Controls Library","pos":[611,655]},{"content":"The Common Controls library is now isolated within MFC, allowing different modules (such as user DLLs) to use different versions of the Common Controls library by specifying the version in their manifests.","pos":[656,861]},{"content":"An MFC application (or user code called by MFC) makes calls to Common Controls library APIs through wrapper functions named <ph id=\"ph1\">`Afx`</ph><bpt id=\"p1\">*</bpt>FunctionName<ept id=\"p1\">*</ept>, where <bpt id=\"p2\">*</bpt>FunctionName<ept id=\"p2\">*</ept> is the name of a Common Controls API.","pos":[868,1071],"source":"An MFC application (or user code called by MFC) makes calls to Common Controls library APIs through wrapper functions named `Afx`*FunctionName*, where *FunctionName* is the name of a Common Controls API."},{"content":"Those wrapper functions are defined in afxcomctl32.h and afxcomctl32.inl.","pos":[1072,1145]},{"pos":[1152,1539],"content":"You can use the <bpt id=\"p1\">[</bpt>AFX_COMCTL32_IF_EXISTS<ept id=\"p1\">](http://msdn.microsoft.com/library/60b3af72-7113-43d7-9db5-012f40971d0d)</ept> and <bpt id=\"p2\">[</bpt>AFX_COMCTL32_IF_EXISTS2<ept id=\"p2\">](http://msdn.microsoft.com/library/ed7dab14-fcce-4ca6-983d-196062104c60)</ept> macros (defined in afxcomctl32.h) to determine whether the Common Controls library implements a certain API instead of calling <bpt id=\"p3\">[</bpt>GetProcAddress<ept id=\"p3\">](../build/getprocaddress.md)</ept>.","source":"You can use the [AFX_COMCTL32_IF_EXISTS](http://msdn.microsoft.com/library/60b3af72-7113-43d7-9db5-012f40971d0d) and [AFX_COMCTL32_IF_EXISTS2](http://msdn.microsoft.com/library/ed7dab14-fcce-4ca6-983d-196062104c60) macros (defined in afxcomctl32.h) to determine whether the Common Controls library implements a certain API instead of calling [GetProcAddress](../build/getprocaddress.md)."},{"content":"Technically, you make calls to Common Controls Library APIs through a wrapper class, <ph id=\"ph1\">`CComCtlWrapper`</ph> (defined in afxcomctl32.h).","pos":[1546,1675],"source":"Technically, you make calls to Common Controls Library APIs through a wrapper class, `CComCtlWrapper` (defined in afxcomctl32.h)."},{"content":"is also responsible for the loading and unloading of comctl32.dll.","pos":[1693,1759]},{"content":"The MFC Module State contains a pointer to an instance of <ph id=\"ph1\">`CComCtlWrapper`</ph>.","pos":[1760,1835],"source":" The MFC Module State contains a pointer to an instance of `CComCtlWrapper`."},{"content":"You can access the wrapper class using the <ph id=\"ph1\">`afxComCtlWrapper`</ph> macro.","pos":[1836,1904],"source":" You can access the wrapper class using the `afxComCtlWrapper` macro."},{"content":"Note that calling Common Controls API directly (not using the MFC wrapper functions) from an MFC application or user DLL will work in most cases, because the MFC application or user DLL is bound to the Common Controls library it requested in its manifest).","pos":[1911,2167]},{"content":"However, the MFC code itself has to use the wrappers, because MFC code might be called from user DLLs with different Common Controls library versions.","pos":[2168,2318]}],"content":"---\ntitle: \"Isolation of the MFC Common Controls Library | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC, Common Controls library\"\nms.assetid: 7471e6f0-49b0-47f7-86e7-8d6bc3541694\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Isolation of the MFC Common Controls Library\nThe Common Controls library is now isolated within MFC, allowing different modules (such as user DLLs) to use different versions of the Common Controls library by specifying the version in their manifests.  \n  \n An MFC application (or user code called by MFC) makes calls to Common Controls library APIs through wrapper functions named `Afx`*FunctionName*, where *FunctionName* is the name of a Common Controls API. Those wrapper functions are defined in afxcomctl32.h and afxcomctl32.inl.  \n  \n You can use the [AFX_COMCTL32_IF_EXISTS](http://msdn.microsoft.com/library/60b3af72-7113-43d7-9db5-012f40971d0d) and [AFX_COMCTL32_IF_EXISTS2](http://msdn.microsoft.com/library/ed7dab14-fcce-4ca6-983d-196062104c60) macros (defined in afxcomctl32.h) to determine whether the Common Controls library implements a certain API instead of calling [GetProcAddress](../build/getprocaddress.md).  \n  \n Technically, you make calls to Common Controls Library APIs through a wrapper class, `CComCtlWrapper` (defined in afxcomctl32.h). `CComCtlWrapper` is also responsible for the loading and unloading of comctl32.dll. The MFC Module State contains a pointer to an instance of `CComCtlWrapper`. You can access the wrapper class using the `afxComCtlWrapper` macro.  \n  \n Note that calling Common Controls API directly (not using the MFC wrapper functions) from an MFC application or user DLL will work in most cases, because the MFC application or user DLL is bound to the Common Controls library it requested in its manifest). However, the MFC code itself has to use the wrappers, because MFC code might be called from user DLLs with different Common Controls library versions.\n\n"}