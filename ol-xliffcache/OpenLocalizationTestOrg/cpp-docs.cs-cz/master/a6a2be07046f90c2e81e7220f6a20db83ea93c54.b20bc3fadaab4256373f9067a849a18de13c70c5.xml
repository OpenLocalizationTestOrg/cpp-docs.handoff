{"nodes":[{"pos":[12,48],"content":"CStreamRowset Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CStreamRowset Class | Microsoft Docs","pos":[0,36]}]},{"content":"CStreamRowset Class","pos":[731,750]},{"pos":[751,796],"content":"Used in a <ph id=\"ph1\">`CCommand`</ph> or <ph id=\"ph2\">`CTable`</ph> declaration.","source":"Used in a `CCommand` or `CTable` declaration."},{"content":"Syntax","pos":[805,811]},{"content":"Parameters","pos":[904,914]},{"content":"An accessor class.","pos":[933,951]},{"content":"Members","pos":[960,967]},{"content":"Methods","pos":[977,984]},{"content":"CStreamRowset","pos":[1006,1019]},{"content":"Constructor.","pos":[1070,1082]},{"content":"Instantiates and initializes the <ph id=\"ph1\">`CStreamRowset`</ph> object.","pos":[1083,1139],"source":" Instantiates and initializes the `CStreamRowset` object."},{"content":"Close","pos":[1145,1150]},{"pos":[1193,1313],"content":"Releases the <bpt id=\"p1\">[</bpt>ISequentialStream<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms718035.aspx)</ept> interface pointer in the class.","source":"Releases the [ISequentialStream](https://msdn.microsoft.com/en-us/library/ms718035.aspx) interface pointer in the class."},{"content":"Remarks","pos":[1323,1330]},{"pos":[1334,1410],"content":"Use <ph id=\"ph1\">`CStreamRowset`</ph> in your <ph id=\"ph2\">`CCommand`</ph> or <ph id=\"ph3\">`CTable`</ph> declaration, for example:","source":"Use `CStreamRowset` in your `CCommand` or `CTable` declaration, for example:"},{"pos":[1428,1449],"content":"NVC_OLEDB_Consumer#11"},{"content":"or","pos":[1518,1520]},{"pos":[1538,1559],"content":"NVC_OLEDB_Consumer#12"},{"content":"returns an <ph id=\"ph1\">`ISequentialStream`</ph> pointer, which is stored in <ph id=\"ph2\">`m_spStream`</ph>.","pos":[1648,1720],"source":" returns an `ISequentialStream` pointer, which is stored in `m_spStream`."},{"content":"You then use the <bpt id=\"p1\">**</bpt>Read<ept id=\"p1\">**</ept> method to retrieve the (Unicode string) data in XML format.","pos":[1721,1806],"source":" You then use the **Read** method to retrieve the (Unicode string) data in XML format."},{"content":"For example:","pos":[1807,1819]},{"pos":[1837,1858],"content":"NVC_OLEDB_Consumer#13"},{"content":"SQL Server 2000 performs the XML formatting, and will return all columns and all rows of the rowset as one XML string.","pos":[1927,2045]},{"pos":[2053,2109],"content":"[!NOTE]\n This feature works with SQL Server 2000 only.","leadings":["","> "],"nodes":[{"content":"This feature works with SQL Server 2000 only.","pos":[9,54]}]},{"content":"Requirements","pos":[2118,2130]},{"pos":[2134,2156],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldbcli.h","source":"**Header:** atldbcli.h"},{"content":"See Also","pos":[2165,2173]},{"content":"OLE DB Consumer Templates","pos":[2178,2203]},{"content":"OLE DB Consumer Templates Reference","pos":[2261,2296]}],"content":"---\ntitle: \"CStreamRowset Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"ATL::CStreamRowset<TAccessor>\"\n  - \"ATL::CStreamRowset\"\n  - \"CStreamRowset\"\n  - \"ATL.CStreamRowset<TAccessor>\"\n  - \"ATL.CStreamRowset\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CStreamRowset class\"\nms.assetid: a106e953-a38a-464e-8ea5-28963d9e4811\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CStreamRowset Class\nUsed in a `CCommand` or `CTable` declaration.  \n  \n## Syntax  \n  \n```  \ntemplate <class TAccessor = CAccessorBase>  \nclass CStreamRowset  \n```  \n  \n#### Parameters  \n `TAccessor`  \n An accessor class.  \n  \n## Members  \n  \n### Methods  \n  \n|||  \n|-|-|  \n|[CStreamRowset](../../data/oledb/cstreamrowset-cstreamrowset.md)|Constructor. Instantiates and initializes the `CStreamRowset` object.|  \n|[Close](../../data/oledb/cstreamrowset-close.md)|Releases the [ISequentialStream](https://msdn.microsoft.com/en-us/library/ms718035.aspx) interface pointer in the class.|  \n  \n## Remarks  \n Use `CStreamRowset` in your `CCommand` or `CTable` declaration, for example:  \n  \n [!code-cpp[NVC_OLEDB_Consumer#11](../../data/oledb/codesnippet/cpp/cstreamrowset-class_1.cpp)]  \n  \n or  \n  \n [!code-cpp[NVC_OLEDB_Consumer#12](../../data/oledb/codesnippet/cpp/cstreamrowset-class_2.cpp)]  \n  \n `ICommand::Execute` returns an `ISequentialStream` pointer, which is stored in `m_spStream`. You then use the **Read** method to retrieve the (Unicode string) data in XML format. For example:  \n  \n [!code-cpp[NVC_OLEDB_Consumer#13](../../data/oledb/codesnippet/cpp/cstreamrowset-class_3.cpp)]  \n  \n SQL Server 2000 performs the XML formatting, and will return all columns and all rows of the rowset as one XML string.  \n  \n> [!NOTE]\n>  This feature works with SQL Server 2000 only.  \n  \n## Requirements  \n **Header:** atldbcli.h  \n  \n## See Also  \n [OLE DB Consumer Templates](../../data/oledb/ole-db-consumer-templates-cpp.md)   \n [OLE DB Consumer Templates Reference](../../data/oledb/ole-db-consumer-templates-reference.md)"}