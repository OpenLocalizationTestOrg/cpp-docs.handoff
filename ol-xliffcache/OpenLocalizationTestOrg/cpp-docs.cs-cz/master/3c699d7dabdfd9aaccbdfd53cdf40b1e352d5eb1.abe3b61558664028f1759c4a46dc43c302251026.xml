{"nodes":[{"pos":[12,90],"content":"Data Source: Programmatically Configuring an ODBC Data Source | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Data Source: Programmatically Configuring an ODBC Data Source | Microsoft Docs","pos":[0,78]}]},{"content":"Data Source: Programmatically Configuring an ODBC Data Source","pos":[783,844]},{"content":"This topic explains how you can configure Open Database Connectivity (ODBC) data source names programmatically.","pos":[845,956]},{"content":"This gives you flexibility to access data without forcing the user to explicitly use the ODBC Administrator or other programs to specify the names of data sources.","pos":[957,1120]},{"content":"Typically, a user runs ODBC Administrator to create a data source if the associated database management system (DBMS) supports this operation.","pos":[1127,1269]},{"content":"When creating a Microsoft Access ODBC data source through ODBC Administrator, you are given two choices: you can select an existing .mdb file or you can create a new .mdb file.","pos":[1276,1452]},{"content":"There is no programmatic way of creating the .mdb file from your MFC ODBC application.","pos":[1453,1539]},{"content":"Therefore, if your application requires that you place data into a Microsoft Access data source (.mdb file), you most likely want to have an empty .mdb file that you can use or copy whenever you need it.","pos":[1540,1743]},{"content":"However, many DBMSs allow programmatic data source creation.","pos":[1750,1810]},{"content":"Some data sources maintain a directory specification for databases.","pos":[1811,1878]},{"content":"That is, a directory is the data source and each table within the data source is stored in a separate file (in the case of dBASE, each table is a .dbf file).","pos":[1879,2036]},{"content":"Drivers for other ODBC databases, such as Microsoft Access and SQL Server, require that some specific criteria be satisfied before a data source can be established.","pos":[2037,2201]},{"content":"For example, when using the SQL Server ODBC driver, you need to have established a SQL Server computer.","pos":[2202,2305]},{"pos":[2364,2391],"content":"SQLConfigDataSource Example"},{"pos":[2395,2533],"content":"The following example uses the <bpt id=\"p1\">**</bpt>::SQLConfigDataSource<ept id=\"p1\">**</ept> ODBC API function to create a new Excel data source called New Excel Data Source:","source":"The following example uses the **::SQLConfigDataSource** ODBC API function to create a new Excel data source called New Excel Data Source:"},{"content":"Note that the data source is actually a directory (C:\\EXCELDIR); this directory must exist.","pos":[2868,2959]},{"content":"The Excel driver uses directories as its data sources and files as the individual tables (one table per .xls file).","pos":[2960,3075]},{"pos":[3082,3291],"content":"For more information about creating tables, see <bpt id=\"p1\">[</bpt>Data Source: Programmatically Creating a Table in an ODBC Data Source<ept id=\"p1\">](../../data/odbc/data-source-programmatically-creating-a-table-in-an-odbc-data-source.md)</ept>.","source":"For more information about creating tables, see [Data Source: Programmatically Creating a Table in an ODBC Data Source](../../data/odbc/data-source-programmatically-creating-a-table-in-an-odbc-data-source.md)."},{"content":"The following information discusses the parameters that need to be passed to the <bpt id=\"p1\">**</bpt>::SQLConfigDataSource<ept id=\"p1\">**</ept> ODBC API function.","pos":[3298,3423],"source":"The following information discusses the parameters that need to be passed to the **::SQLConfigDataSource** ODBC API function."},{"content":"To use <bpt id=\"p1\">**</bpt>::SQLConfigDataSource<ept id=\"p1\">**</ept>, you must include the Odbcinst.h header file and use the Odbcinst.lib import library.","pos":[3424,3542],"source":" To use **::SQLConfigDataSource**, you must include the Odbcinst.h header file and use the Odbcinst.lib import library."},{"content":"Also, Odbccp32.dll must be in the path at run time (or Odbcinst.dll for 16 bit).","pos":[3543,3623]},{"content":"You can create an ODBC data source name using ODBC Administrator or a similar utility.","pos":[3630,3716]},{"content":"However, sometimes it is desirable to create a data source name directly from your application to obtain access without requiring the user to run a separate utility.","pos":[3717,3882]},{"content":"ODBC Administrator (typically installed in Control Panel) creates a new data source by putting entries in the Windows registry (or, for 16 bit, in the Odbc.ini file).","pos":[3889,4055]},{"content":"The ODBC Driver Manager queries this file to obtain the required information about the data source.","pos":[4056,4155]},{"content":"It is important to know what information needs to be placed in the registry because you need to supply it with the call to <bpt id=\"p1\">**</bpt>::SQLConfigDataSource<ept id=\"p1\">**</ept>.","pos":[4156,4305],"source":" It is important to know what information needs to be placed in the registry because you need to supply it with the call to **::SQLConfigDataSource**."},{"content":"Although this information could be written directly to the registry without using <bpt id=\"p1\">**</bpt>::SQLConfigDataSource<ept id=\"p1\">**</ept>, any application that does so is relying on the current technique that the Driver Manager uses to maintain its data.","pos":[4312,4536],"source":"Although this information could be written directly to the registry without using **::SQLConfigDataSource**, any application that does so is relying on the current technique that the Driver Manager uses to maintain its data."},{"content":"If a later revision to the ODBC Driver Manager implements record keeping about data sources in a different way, any application that uses this technique is broken.","pos":[4537,4700]},{"content":"It is generally advisable to use an API function when one is provided.","pos":[4701,4771]},{"content":"For example, your code is portable from 16 bit to 32 bit if you use the <bpt id=\"p1\">**</bpt>::SQLConfigDataSource<ept id=\"p1\">**</ept> function, because the function correctly writes to the Odbc.ini file or to the registry.","pos":[4772,4958],"source":" For example, your code is portable from 16 bit to 32 bit if you use the **::SQLConfigDataSource** function, because the function correctly writes to the Odbc.ini file or to the registry."},{"pos":[5020,5050],"content":"SQLConfigDataSource Parameters"},{"content":"The following explains the parameters of the <bpt id=\"p1\">**</bpt>::SQLConfigDataSource<ept id=\"p1\">**</ept> function.","pos":[5054,5134],"source":"The following explains the parameters of the **::SQLConfigDataSource** function."},{"content":"Much of the information is taken from the ODBC API <bpt id=\"p1\">*</bpt>Programmer's Reference<ept id=\"p1\">*</ept> supplied with Visual C++ version 1.5 and later.","pos":[5135,5258],"source":" Much of the information is taken from the ODBC API *Programmer's Reference* supplied with Visual C++ version 1.5 and later."},{"pos":[5309,5327],"content":"Function Prototype"},{"content":"Remarks","pos":[5453,5460]},{"pos":[5514,5534],"content":"Parameters and Usage"},{"content":"hwndParent","pos":[5539,5549]},{"content":"The window specified as the owner of any dialog boxes that either the ODBC Driver Manager or the specific ODBC driver creates to obtain additional information from the user about the new data source.","pos":[5554,5753]},{"content":"If the <ph id=\"ph1\">`lpszAttributes`</ph> parameter does not supply enough information, a dialog box appears.","pos":[5754,5845],"source":" If the `lpszAttributes` parameter does not supply enough information, a dialog box appears."},{"content":"The <bpt id=\"p1\">*</bpt>hwndParent<ept id=\"p1\">*</ept> parameter might be <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","pos":[5846,5891],"source":" The *hwndParent* parameter might be **NULL**."},{"content":"The driver description.","pos":[5914,5937]},{"content":"This is the name presented to users rather than the physical driver name (the DLL).","pos":[5938,6021]},{"content":"List of attributes in the form \"keyname=value\".","pos":[6048,6095]},{"content":"These strings are separated by null terminators with two consecutive null terminators at the end of the list.","pos":[6096,6205]},{"content":"These attributes are primarily default driver-specific entries, which go into the registry for the new data source.","pos":[6206,6321]},{"content":"One important key that is not mentioned in the ODBC API reference for this function is \"DSN\" (\"data source name\"), which specifies the name of the new data source.","pos":[6322,6485]},{"content":"The rest of the entries are specific to the driver for the new data source.","pos":[6486,6561]},{"content":"Often it is not necessary to supply all of the entries because the driver can prompt the user with dialog boxes for the new values.","pos":[6562,6693]},{"content":"(Set <bpt id=\"p1\">*</bpt>hwndParent<ept id=\"p1\">*</ept> to <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> to cause this.) You might want to explicitly supply default values so that the user is not prompted.","pos":[6694,6824],"source":" (Set *hwndParent* to **NULL** to cause this.) You might want to explicitly supply default values so that the user is not prompted."},{"content":"To determine the description of a driver for the lpszDriver parameter using ODBC Administrator","pos":[6837,6931]},{"content":"Run ODBC Administrator.","pos":[6941,6964]},{"pos":[6974,6988],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"content":"This gives you a list of installed drivers and their descriptions.","pos":[6995,7061]},{"content":"Use this description as the <ph id=\"ph1\">`lpszDriver`</ph> parameter.","pos":[7062,7113],"source":" Use this description as the `lpszDriver` parameter."},{"content":"Note that you use the entire description, such as \"Excel Files (*.xls)\", including the file name extension and parentheses if they exist in the description.","pos":[7114,7270]},{"content":"As an alternative, you can examine the registry (or, for 16 bit, the file Odbcinst.ini), which contains a list of all driver entries and descriptions under the registry key \"ODBC Drivers\" (or the section [ODBC Drivers] in Odbcinst.ini).","pos":[7277,7513]},{"pos":[7520,7726],"content":"One way to find the keynames and values for the <ph id=\"ph1\">`lpszAttributes`</ph> parameter is to examine the Odbc.ini file for an already configured data source (perhaps one that has been configured by ODBC Administrator).","source":"One way to find the keynames and values for the `lpszAttributes` parameter is to examine the Odbc.ini file for an already configured data source (perhaps one that has been configured by ODBC Administrator)."},{"content":"To find keynames and values for the lpszAttributes parameter","pos":[7739,7799]},{"content":"Run the Windows registry editor (or, for 16 bit, open the Odbc.ini file).","pos":[7809,7882]},{"content":"Find the ODBC data sources information using one of the following:","pos":[7892,7958]},{"pos":[7972,8077],"content":"For 32 bit, find the key <bpt id=\"p1\">**</bpt>HKEY_CURRENT_USER\\Software\\ODBC\\ODBC.INI\\ODBC Data Sources<ept id=\"p1\">**</ept> in the left pane.","source":"For 32 bit, find the key **HKEY_CURRENT_USER\\Software\\ODBC\\ODBC.INI\\ODBC Data Sources** in the left pane."},{"content":"The right pane lists entries of the form: \"pub: REG_SZ:<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&lt;data source name&gt;</ph><ept id=\"p1\">*</ept>\", where <bpt id=\"p2\">*</bpt><ph id=\"ph2\">&lt;data source name&gt;</ph><ept id=\"p2\">*</ept> is a data source that has already been configured with the desired settings for the driver you intend to use.","pos":[8092,8306],"source":"The right pane lists entries of the form: \"pub: REG_SZ:*<data source name>*\", where *<data source name>* is a data source that has already been configured with the desired settings for the driver you intend to use."},{"content":"Select the data source you want, for example, SQL Server.","pos":[8307,8364]},{"content":"The items following the string \"pub:\" are, in order, the keyname and value to use in your <ph id=\"ph1\">`lpszAttributes`</ph> parameter.","pos":[8365,8482],"source":" The items following the string \"pub:\" are, in order, the keyname and value to use in your `lpszAttributes` parameter."},{"pos":[8496,8580],"content":"For 16 bit, find the section in the Odbc.ini file marked by [<bpt id=\"p1\">*</bpt><ph id=\"ph1\">\\&lt;</ph>data source name&gt;<ept id=\"p1\">*</ept>].","source":"For 16 bit, find the section in the Odbc.ini file marked by [*\\<data source name>*]."},{"content":"The lines following this line are of the form \"keyname=value\".","pos":[8595,8657]},{"content":"These are exactly the entries to use in your <ph id=\"ph1\">`lpszAttributes`</ph> parameter.","pos":[8658,8730],"source":" These are exactly the entries to use in your `lpszAttributes` parameter."},{"content":"You might also want to examine the documentation for the specific driver you are going to use.","pos":[8737,8831]},{"content":"You can find useful information in the online Help for the driver, which you can access by running ODBC Administrator.","pos":[8832,8950]},{"content":"These Help files are usually placed in the WINDOWS\\SYSTEM directory for Windows NT, Windows 3.1, or Windows 95.","pos":[8951,9062]},{"content":"To obtain online Help for your ODBC driver","pos":[9075,9117]},{"content":"Run ODBC Administrator.","pos":[9127,9150]},{"pos":[9160,9174],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"content":"Select the driver name.","pos":[9184,9207]},{"pos":[9217,9230],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"When ODBC Administrator displays the information for creating a new data source for that particular driver, click <bpt id=\"p1\">**</bpt>Help<ept id=\"p1\">**</ept>.","pos":[9237,9360],"source":"When ODBC Administrator displays the information for creating a new data source for that particular driver, click **Help**."},{"content":"This opens the Help file for that particular driver, which generally contains important information concerning the use of the driver.","pos":[9361,9494]},{"content":"See Also","pos":[9503,9511]},{"content":"Data Source (ODBC)","pos":[9516,9534]}],"content":"---\ntitle: \"Data Source: Programmatically Configuring an ODBC Data Source | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"SQLConfigDataSource\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ODBC data sources, configuring\"\n  - \"SQLConfigDataSource method example\"\n  - \"ODBC connections, configuring\"\n  - \"configuring ODBC data sources\"\nms.assetid: b8cabe9b-9e12-4d73-ae36-7cb12dee3213\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Data Source: Programmatically Configuring an ODBC Data Source\nThis topic explains how you can configure Open Database Connectivity (ODBC) data source names programmatically. This gives you flexibility to access data without forcing the user to explicitly use the ODBC Administrator or other programs to specify the names of data sources.  \n  \n Typically, a user runs ODBC Administrator to create a data source if the associated database management system (DBMS) supports this operation.  \n  \n When creating a Microsoft Access ODBC data source through ODBC Administrator, you are given two choices: you can select an existing .mdb file or you can create a new .mdb file. There is no programmatic way of creating the .mdb file from your MFC ODBC application. Therefore, if your application requires that you place data into a Microsoft Access data source (.mdb file), you most likely want to have an empty .mdb file that you can use or copy whenever you need it.  \n  \n However, many DBMSs allow programmatic data source creation. Some data sources maintain a directory specification for databases. That is, a directory is the data source and each table within the data source is stored in a separate file (in the case of dBASE, each table is a .dbf file). Drivers for other ODBC databases, such as Microsoft Access and SQL Server, require that some specific criteria be satisfied before a data source can be established. For example, when using the SQL Server ODBC driver, you need to have established a SQL Server computer.  \n  \n##  <a name=\"_core_sqlconfigdatasource_example\"></a> SQLConfigDataSource Example  \n The following example uses the **::SQLConfigDataSource** ODBC API function to create a new Excel data source called New Excel Data Source:  \n  \n```  \nSQLConfigDataSource(NULL,ODBC_ADD_DSN, \"Excel Files (*.xls)\",   \n                   \"DSN=New Excel Data Source\\0\"   \n                   \"Description=New Excel Data Source\\0\"   \n                   \"FileType=Excel\\0\"   \n                   \"DataDirectory=C:\\\\EXCELDIR\\0\"   \n                   \"MaxScanRows=20\\0\");  \n```  \n  \n Note that the data source is actually a directory (C:\\EXCELDIR); this directory must exist. The Excel driver uses directories as its data sources and files as the individual tables (one table per .xls file).  \n  \n For more information about creating tables, see [Data Source: Programmatically Creating a Table in an ODBC Data Source](../../data/odbc/data-source-programmatically-creating-a-table-in-an-odbc-data-source.md).  \n  \n The following information discusses the parameters that need to be passed to the **::SQLConfigDataSource** ODBC API function. To use **::SQLConfigDataSource**, you must include the Odbcinst.h header file and use the Odbcinst.lib import library. Also, Odbccp32.dll must be in the path at run time (or Odbcinst.dll for 16 bit).  \n  \n You can create an ODBC data source name using ODBC Administrator or a similar utility. However, sometimes it is desirable to create a data source name directly from your application to obtain access without requiring the user to run a separate utility.  \n  \n ODBC Administrator (typically installed in Control Panel) creates a new data source by putting entries in the Windows registry (or, for 16 bit, in the Odbc.ini file). The ODBC Driver Manager queries this file to obtain the required information about the data source. It is important to know what information needs to be placed in the registry because you need to supply it with the call to **::SQLConfigDataSource**.  \n  \n Although this information could be written directly to the registry without using **::SQLConfigDataSource**, any application that does so is relying on the current technique that the Driver Manager uses to maintain its data. If a later revision to the ODBC Driver Manager implements record keeping about data sources in a different way, any application that uses this technique is broken. It is generally advisable to use an API function when one is provided. For example, your code is portable from 16 bit to 32 bit if you use the **::SQLConfigDataSource** function, because the function correctly writes to the Odbc.ini file or to the registry.  \n  \n##  <a name=\"_core_sqlconfigdatasource_parameters\"></a> SQLConfigDataSource Parameters  \n The following explains the parameters of the **::SQLConfigDataSource** function. Much of the information is taken from the ODBC API *Programmer's Reference* supplied with Visual C++ version 1.5 and later.  \n  \n###  <a name=\"_core_function_prototype\"></a> Function Prototype  \n  \n```  \nBOOL SQLConfigDataSource(HWND hwndParent,UINT fRequest, LPCSTR lpszDriver, LPCSTR lpszAttributes);  \n```  \n  \n### Remarks  \n  \n####  <a name=\"_core_parameters_and_usage\"></a> Parameters and Usage  \n *hwndParent*  \n The window specified as the owner of any dialog boxes that either the ODBC Driver Manager or the specific ODBC driver creates to obtain additional information from the user about the new data source. If the `lpszAttributes` parameter does not supply enough information, a dialog box appears. The *hwndParent* parameter might be **NULL**.  \n  \n `lpszDriver`  \n The driver description. This is the name presented to users rather than the physical driver name (the DLL).  \n  \n `lpszAttributes`  \n List of attributes in the form \"keyname=value\". These strings are separated by null terminators with two consecutive null terminators at the end of the list. These attributes are primarily default driver-specific entries, which go into the registry for the new data source. One important key that is not mentioned in the ODBC API reference for this function is \"DSN\" (\"data source name\"), which specifies the name of the new data source. The rest of the entries are specific to the driver for the new data source. Often it is not necessary to supply all of the entries because the driver can prompt the user with dialog boxes for the new values. (Set *hwndParent* to **NULL** to cause this.) You might want to explicitly supply default values so that the user is not prompted.  \n  \n###### To determine the description of a driver for the lpszDriver parameter using ODBC Administrator  \n  \n1.  Run ODBC Administrator.  \n  \n2.  Click **Add**.  \n  \n This gives you a list of installed drivers and their descriptions. Use this description as the `lpszDriver` parameter. Note that you use the entire description, such as \"Excel Files (*.xls)\", including the file name extension and parentheses if they exist in the description.  \n  \n As an alternative, you can examine the registry (or, for 16 bit, the file Odbcinst.ini), which contains a list of all driver entries and descriptions under the registry key \"ODBC Drivers\" (or the section [ODBC Drivers] in Odbcinst.ini).  \n  \n One way to find the keynames and values for the `lpszAttributes` parameter is to examine the Odbc.ini file for an already configured data source (perhaps one that has been configured by ODBC Administrator).  \n  \n###### To find keynames and values for the lpszAttributes parameter  \n  \n1.  Run the Windows registry editor (or, for 16 bit, open the Odbc.ini file).  \n  \n2.  Find the ODBC data sources information using one of the following:  \n  \n    -   For 32 bit, find the key **HKEY_CURRENT_USER\\Software\\ODBC\\ODBC.INI\\ODBC Data Sources** in the left pane.  \n  \n         The right pane lists entries of the form: \"pub: REG_SZ:*<data source name>*\", where *<data source name>* is a data source that has already been configured with the desired settings for the driver you intend to use. Select the data source you want, for example, SQL Server. The items following the string \"pub:\" are, in order, the keyname and value to use in your `lpszAttributes` parameter.  \n  \n    -   For 16 bit, find the section in the Odbc.ini file marked by [*\\<data source name>*].  \n  \n         The lines following this line are of the form \"keyname=value\". These are exactly the entries to use in your `lpszAttributes` parameter.  \n  \n You might also want to examine the documentation for the specific driver you are going to use. You can find useful information in the online Help for the driver, which you can access by running ODBC Administrator. These Help files are usually placed in the WINDOWS\\SYSTEM directory for Windows NT, Windows 3.1, or Windows 95.  \n  \n###### To obtain online Help for your ODBC driver  \n  \n1.  Run ODBC Administrator.  \n  \n2.  Click **Add**.  \n  \n3.  Select the driver name.  \n  \n4.  Click **OK**.  \n  \n When ODBC Administrator displays the information for creating a new data source for that particular driver, click **Help**. This opens the Help file for that particular driver, which generally contains important information concerning the use of the driver.  \n  \n## See Also  \n [Data Source (ODBC)](../../data/odbc/data-source-odbc.md)"}