{"nodes":[{"pos":[12,49],"content":"COleDataSource Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleDataSource Class | Microsoft Docs","pos":[0,37]}]},{"content":"COleDataSource Class","pos":[958,978]},{"content":"Acts as a cache into which an application places the data that it will offer during data transfer operations, such as Clipboard or drag-and-drop operations.","pos":[979,1135]},{"content":"Syntax","pos":[1144,1150]},{"content":"Members","pos":[1217,1224]},{"content":"Public Constructors","pos":[1234,1253]},{"content":"Name","pos":[1260,1264]},{"content":"Description","pos":[1265,1276]},{"content":"COleDataSource::COleDataSource","pos":[1315,1345]},{"pos":[1380,1417],"content":"Constructs a <ph id=\"ph1\">`COleDataSource`</ph> object.","source":"Constructs a `COleDataSource` object."},{"content":"Public Methods","pos":[1428,1442]},{"content":"Name","pos":[1449,1453]},{"content":"Description","pos":[1454,1465]},{"content":"COleDataSource::CacheData","pos":[1504,1529]},{"pos":[1559,1625],"content":"Offers data in a specified format using a <bpt id=\"p1\">**</bpt>STGMEDIUM<ept id=\"p1\">**</ept> structure.","source":"Offers data in a specified format using a **STGMEDIUM** structure."},{"content":"COleDataSource::CacheGlobalData","pos":[1631,1662]},{"pos":[1698,1751],"content":"Offers data in a specified format using an <ph id=\"ph1\">`HGLOBAL`</ph>.","source":"Offers data in a specified format using an `HGLOBAL`."},{"content":"COleDataSource::DelayRenderData","pos":[1757,1788]},{"content":"Offers data in a specified format using delayed rendering.","pos":[1824,1882]},{"content":"COleDataSource::DelayRenderFileData","pos":[1888,1923]},{"pos":[1963,2018],"content":"Offers data in a specified format in a <ph id=\"ph1\">`CFile`</ph> pointer.","source":"Offers data in a specified format in a `CFile` pointer."},{"content":"COleDataSource::DelaySetData","pos":[2024,2052]},{"pos":[2085,2142],"content":"Called for every format that is supported in <ph id=\"ph1\">`OnSetData`</ph>.","source":"Called for every format that is supported in `OnSetData`."},{"content":"COleDataSource::DoDragDrop","pos":[2148,2174]},{"content":"Performs drag-and-drop operations with a data source.","pos":[2205,2258]},{"content":"COleDataSource::Empty","pos":[2264,2285]},{"pos":[2311,2355],"content":"Empties the <ph id=\"ph1\">`COleDataSource`</ph> object of data.","source":"Empties the `COleDataSource` object of data."},{"content":"COleDataSource::FlushClipboard","pos":[2361,2391]},{"content":"Renders all data to the Clipboard.","pos":[2426,2460]},{"content":"COleDataSource::GetClipboardOwner","pos":[2466,2499]},{"content":"Verifies that the data placed on the Clipboard is still there.","pos":[2537,2599]},{"content":"COleDataSource::OnRenderData","pos":[2605,2633]},{"content":"Retrieves data as part of delayed rendering.","pos":[2666,2710]},{"content":"COleDataSource::OnRenderFileData","pos":[2716,2748]},{"pos":[2785,2844],"content":"Retrieves data into a <ph id=\"ph1\">`CFile`</ph> as part of delayed rendering.","source":"Retrieves data into a `CFile` as part of delayed rendering."},{"content":"COleDataSource::OnRenderGlobalData","pos":[2850,2884]},{"pos":[2923,2985],"content":"Retrieves data into an <ph id=\"ph1\">`HGLOBAL`</ph> as part of delayed rendering.","source":"Retrieves data into an `HGLOBAL` as part of delayed rendering."},{"content":"COleDataSource::OnSetData","pos":[2991,3016]},{"pos":[3046,3104],"content":"Called to replace the data in the <ph id=\"ph1\">`COleDataSource`</ph> object.","source":"Called to replace the data in the `COleDataSource` object."},{"content":"COleDataSource::SetClipboard","pos":[3110,3138]},{"pos":[3171,3221],"content":"Places a <ph id=\"ph1\">`COleDataSource`</ph> object on the Clipboard.","source":"Places a `COleDataSource` object on the Clipboard."},{"content":"Remarks","pos":[3231,3238]},{"content":"You can create OLE data sources directly.","pos":[3242,3283]},{"content":"Alternately, the <bpt id=\"p1\">[</bpt>COleClientItem<ept id=\"p1\">](../../mfc/reference/coleclientitem-class.md)</ept> and <bpt id=\"p2\">[</bpt>COleServerItem<ept id=\"p2\">](../../mfc/reference/coleserveritem-class.md)</ept> classes create OLE data sources in response to their <ph id=\"ph1\">`CopyToClipboard`</ph> and <ph id=\"ph2\">`DoDragDrop`</ph> member functions.","pos":[3284,3534],"source":" Alternately, the [COleClientItem](../../mfc/reference/coleclientitem-class.md) and [COleServerItem](../../mfc/reference/coleserveritem-class.md) classes create OLE data sources in response to their `CopyToClipboard` and `DoDragDrop` member functions."},{"content":"See <bpt id=\"p1\">[</bpt>COleServerItem::CopyToClipboard<ept id=\"p1\">](../../mfc/reference/coleserveritem-class.md#coleserveritem__copytoclipboard)</ept> for a brief description.","pos":[3535,3674],"source":" See [COleServerItem::CopyToClipboard](../../mfc/reference/coleserveritem-class.md#coleserveritem__copytoclipboard) for a brief description."},{"content":"Override the <ph id=\"ph1\">`OnGetClipboardData`</ph> member function of your client item or server item class to add additional Clipboard formats to the data in the OLE data source created for the <ph id=\"ph2\">`CopyToClipboard`</ph> or <ph id=\"ph3\">`DoDragDrop`</ph> member function.","pos":[3675,3903],"source":" Override the `OnGetClipboardData` member function of your client item or server item class to add additional Clipboard formats to the data in the OLE data source created for the `CopyToClipboard` or `DoDragDrop` member function."},{"content":"Whenever you want to prepare data for a transfer, you should create an object of this class and fill it with your data using the most appropriate method for your data.","pos":[3910,4077]},{"content":"The way it is inserted into a data source is directly affected by whether the data is supplied immediately (immediate rendering) or on demand (delayed rendering).","pos":[4078,4240]},{"content":"For every Clipboard format in which you are providing data by passing the Clipboard format to be used (and an optional <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure), call <bpt id=\"p2\">[</bpt>DelayRenderData<ept id=\"p2\">](#coledatasource__delayrenderdata)</ept>.","pos":[4241,4501],"source":" For every Clipboard format in which you are providing data by passing the Clipboard format to be used (and an optional [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure), call [DelayRenderData](#coledatasource__delayrenderdata)."},{"content":"For more information about data sources and data transfer, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources (OLE)<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-ole.md)</ept>.","pos":[4508,4669],"source":"For more information about data sources and data transfer, see the article [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md)."},{"content":"In addition, the article <bpt id=\"p1\">[</bpt>Clipboard Topics<ept id=\"p1\">](../../mfc/clipboard.md)</ept> describes the OLE Clipboard mechanism.","pos":[4670,4776],"source":" In addition, the article [Clipboard Topics](../../mfc/clipboard.md) describes the OLE Clipboard mechanism."},{"content":"Inheritance Hierarchy","pos":[4785,4806]},{"content":"CObject","pos":[4811,4818]},{"content":"CCmdTarget","pos":[4865,4875]},{"content":"Requirements","pos":[4949,4961]},{"pos":[4965,4985],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxole.h","source":"**Header:** afxole.h"},{"pos":[5037,5062],"content":"COleDataSource::CacheData"},{"content":"Call this function to specify a format in which data is offered during data transfer operations.","pos":[5066,5162]},{"content":"Parameters","pos":[5298,5308]},{"content":"The Clipboard format in which the data is to be offered.","pos":[5326,5382]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[5383,5584],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure containing the data in the format specified.","pos":[5608,5746],"source":" Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure containing the data in the format specified."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which the data is to be offered.","pos":[5770,5921],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be offered."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[5922,6062],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[6063,6158],"source":" If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure."},{"content":"Remarks","pos":[6168,6175]},{"content":"You must supply the data, because this function provides it by using immediate rendering.","pos":[6179,6268]},{"content":"The data is cached until needed.","pos":[6269,6301]},{"content":"Supply the data using a <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure.","pos":[6308,6414],"source":"Supply the data using a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure."},{"content":"You can also use the <ph id=\"ph1\">`CacheGlobalData`</ph> member function if the amount of data you are supplying is small enough to be transferred efficiently using an <ph id=\"ph2\">`HGLOBAL`</ph>.","pos":[6415,6575],"source":" You can also use the `CacheGlobalData` member function if the amount of data you are supplying is small enough to be transferred efficiently using an `HGLOBAL`."},{"pos":[6582,6730],"content":"After the call to <ph id=\"ph1\">`CacheData`</ph> the <bpt id=\"p1\">**</bpt>ptd<ept id=\"p1\">**</ept> member of <ph id=\"ph2\">`lpFormatEtc`</ph> and the contents of <ph id=\"ph3\">`lpStgMedium`</ph> are owned by the data object, not by the caller.","source":"After the call to `CacheData` the **ptd** member of `lpFormatEtc` and the contents of `lpStgMedium` are owned by the data object, not by the caller."},{"content":"To use delayed rendering, call the <bpt id=\"p1\">[</bpt>DelayRenderData<ept id=\"p1\">](#coledatasource__delayrenderdata)</ept> or <bpt id=\"p2\">[</bpt>DelayRenderFileData<ept id=\"p2\">](#coledatasource__delayrenderfiledata)</ept> member function.","pos":[6737,6903],"source":"To use delayed rendering, call the [DelayRenderData](#coledatasource__delayrenderdata) or [DelayRenderFileData](#coledatasource__delayrenderfiledata) member function."},{"content":"For more information on delayed rendering as handled by MFC, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources: Manipulation<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-manipulation.md)</ept>.","pos":[6904,7084],"source":" For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md)."},{"pos":[7091,7341],"content":"For more information, see the <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> and <bpt id=\"p2\">[</bpt>FORMATETC<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structures in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph><bpt id=\"p3\">*</bpt>.<ept id=\"p3\">*</ept>","source":"For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structures in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*"},{"pos":[7348,7519],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[7577,7608],"content":"COleDataSource::CacheGlobalData"},{"content":"Call this function to specify a format in which data is offered during data transfer operations.","pos":[7612,7708]},{"content":"Parameters","pos":[7842,7852]},{"content":"The Clipboard format in which the data is to be offered.","pos":[7870,7926]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[7927,8128],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"hGlobal","pos":[8136,8143]},{"content":"Handle to the global memory block containing the data in the format specified.","pos":[8148,8226]},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which the data is to be offered.","pos":[8250,8401],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be offered."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[8402,8542],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[8543,8638],"source":" If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure."},{"content":"Remarks","pos":[8648,8655]},{"content":"This function provides the data using immediate rendering, so you must supply the data when calling the function; the data is cached until needed.","pos":[8659,8805]},{"content":"Use the <ph id=\"ph1\">`CacheData`</ph> member function if you are supplying a large amount of data or if you require a structured storage medium.","pos":[8806,8932],"source":" Use the `CacheData` member function if you are supplying a large amount of data or if you require a structured storage medium."},{"content":"To use delayed rendering, call the <bpt id=\"p1\">[</bpt>DelayRenderData<ept id=\"p1\">](#coledatasource__delayrenderdata)</ept> or <bpt id=\"p2\">[</bpt>DelayRenderFileData<ept id=\"p2\">](#coledatasource__delayrenderfiledata)</ept> member function.","pos":[8939,9105],"source":"To use delayed rendering, call the [DelayRenderData](#coledatasource__delayrenderdata) or [DelayRenderFileData](#coledatasource__delayrenderfiledata) member function."},{"content":"For more information on delayed rendering as handled by MFC, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources: Manipulation<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-manipulation.md)</ept>.","pos":[9106,9286],"source":" For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md)."},{"pos":[9293,9466],"content":"For more information, see the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph><bpt id=\"p2\">*</bpt>.<ept id=\"p2\">*</ept>","source":"For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*"},{"pos":[9473,9644],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[9701,9731],"content":"COleDataSource::COleDataSource"},{"pos":[9735,9772],"content":"Constructs a <ph id=\"ph1\">`COleDataSource`</ph> object.","source":"Constructs a `COleDataSource` object."},{"pos":[9863,9894],"content":"COleDataSource::DelayRenderData"},{"content":"Call this function to specify a format in which data is offered during data transfer operations.","pos":[9898,9994]},{"content":"Parameters","pos":[10105,10115]},{"content":"The Clipboard format in which the data is to be offered.","pos":[10133,10189]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[10190,10391],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which the data is to be offered.","pos":[10415,10566],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be offered."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[10567,10707],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[10708,10803],"source":" If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure."},{"content":"Remarks","pos":[10813,10820]},{"content":"This function provides the data using delayed rendering, so the data is not supplied immediately.","pos":[10824,10921]},{"content":"The <bpt id=\"p1\">[</bpt>OnRenderData<ept id=\"p1\">](#coledatasource__onrenderdata)</ept> or <bpt id=\"p2\">[</bpt>OnRenderGlobalData<ept id=\"p2\">](#coledatasource__onrenderglobaldata)</ept> member function is called to request the data.","pos":[10922,11079],"source":" The [OnRenderData](#coledatasource__onrenderdata) or [OnRenderGlobalData](#coledatasource__onrenderglobaldata) member function is called to request the data."},{"content":"Use this function if you are not going to supply your data through a <ph id=\"ph1\">`CFile`</ph> object.","pos":[11086,11170],"source":"Use this function if you are not going to supply your data through a `CFile` object."},{"content":"If you are going to supply the data through a <ph id=\"ph1\">`CFile`</ph> object, call the <bpt id=\"p1\">[</bpt>DelayRenderFileData<ept id=\"p1\">](#coledatasource__delayrenderfiledata)</ept> member function.","pos":[11171,11318],"source":" If you are going to supply the data through a `CFile` object, call the [DelayRenderFileData](#coledatasource__delayrenderfiledata) member function."},{"content":"For more information on delayed rendering as handled by MFC, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources: Manipulation<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-manipulation.md)</ept>.","pos":[11319,11499],"source":" For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md)."},{"pos":[11506,11654],"content":"To use immediate rendering, call the <bpt id=\"p1\">[</bpt>CacheData<ept id=\"p1\">](#coledatasource__cachedata)</ept> or <bpt id=\"p2\">[</bpt>CacheGlobalData<ept id=\"p2\">](#coledatasource__cacheglobaldata)</ept> member function.","source":"To use immediate rendering, call the [CacheData](#coledatasource__cachedata) or [CacheGlobalData](#coledatasource__cacheglobaldata) member function."},{"pos":[11661,11834],"content":"For more information, see the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph><bpt id=\"p2\">*</bpt>.<ept id=\"p2\">*</ept>","source":"For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*"},{"pos":[11841,12012],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[12074,12109],"content":"COleDataSource::DelayRenderFileData"},{"content":"Call this function to specify a format in which data is offered during data transfer operations.","pos":[12113,12209]},{"content":"Parameters","pos":[12324,12334]},{"content":"The Clipboard format in which the data is to be offered.","pos":[12352,12408]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[12409,12610],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which the data is to be offered.","pos":[12634,12785],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be offered."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[12786,12926],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[12927,13022],"source":" If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure."},{"content":"Remarks","pos":[13032,13039]},{"content":"This function provides the data using delayed rendering, so the data is not supplied immediately.","pos":[13043,13140]},{"content":"The <bpt id=\"p1\">[</bpt>OnRenderFileData<ept id=\"p1\">](#coledatasource__onrenderfiledata)</ept> member function is called to request the data.","pos":[13141,13245],"source":" The [OnRenderFileData](#coledatasource__onrenderfiledata) member function is called to request the data."},{"content":"Use this function if you are going to use a <ph id=\"ph1\">`CFile`</ph> object to supply the data.","pos":[13252,13330],"source":"Use this function if you are going to use a `CFile` object to supply the data."},{"content":"If you are not going to use a <ph id=\"ph1\">`CFile`</ph> object, call the <bpt id=\"p1\">[</bpt>DelayRenderData<ept id=\"p1\">](#coledatasource__delayrenderdata)</ept> member function.","pos":[13331,13454],"source":" If you are not going to use a `CFile` object, call the [DelayRenderData](#coledatasource__delayrenderdata) member function."},{"content":"For more information on delayed rendering as handled by MFC, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources: Manipulation<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-manipulation.md)</ept>.","pos":[13455,13635],"source":" For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md)."},{"pos":[13642,13790],"content":"To use immediate rendering, call the <bpt id=\"p1\">[</bpt>CacheData<ept id=\"p1\">](#coledatasource__cachedata)</ept> or <bpt id=\"p2\">[</bpt>CacheGlobalData<ept id=\"p2\">](#coledatasource__cacheglobaldata)</ept> member function.","source":"To use immediate rendering, call the [CacheData](#coledatasource__cachedata) or [CacheGlobalData](#coledatasource__cacheglobaldata) member function."},{"pos":[13797,13970],"content":"For more information, see the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph><bpt id=\"p2\">*</bpt>.<ept id=\"p2\">*</ept>","source":"For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*"},{"pos":[13977,14148],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[14203,14231],"content":"COleDataSource::DelaySetData"},{"content":"Call this function to support changing the contents of the data source.","pos":[14235,14306]},{"content":"Parameters","pos":[14414,14424]},{"content":"The Clipboard format in which the data is to be placed.","pos":[14442,14497]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[14498,14699],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which the data is to be replaced.","pos":[14723,14875],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be replaced."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[14876,15016],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[15017,15112],"source":" If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure."},{"content":"Remarks","pos":[15122,15129]},{"content":"<bpt id=\"p1\">[</bpt>OnSetData<ept id=\"p1\">](#coledatasource__onsetdata)</ept> will be called by the framework when this happens.","pos":[15133,15223],"source":"[OnSetData](#coledatasource__onsetdata) will be called by the framework when this happens."},{"content":"This is only used when the framework returns the data source from <bpt id=\"p1\">[</bpt>COleServerItem::GetDataSource<ept id=\"p1\">](../../mfc/reference/coleserveritem-class.md#coleserveritem__getdatasource)</ept>.","pos":[15224,15397],"source":" This is only used when the framework returns the data source from [COleServerItem::GetDataSource](../../mfc/reference/coleserveritem-class.md#coleserveritem__getdatasource)."},{"content":"If <ph id=\"ph1\">`DelaySetData`</ph> is not called, your <ph id=\"ph2\">`OnSetData`</ph> function will never be called.","pos":[15398,15478],"source":" If `DelaySetData` is not called, your `OnSetData` function will never be called."},{"content":"should be called for each Clipboard or <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> format you support.","pos":[15494,15566],"source":" should be called for each Clipboard or **FORMATETC** format you support."},{"pos":[15573,15746],"content":"For more information, see the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph><bpt id=\"p2\">*</bpt>.<ept id=\"p2\">*</ept>","source":"For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*"},{"pos":[15753,15924],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[15977,16003],"content":"COleDataSource::DoDragDrop"},{"pos":[16007,16205],"content":"Call the <ph id=\"ph1\">`DoDragDrop`</ph> member function to perform a drag-and-drop operation for this data source, typically in an <bpt id=\"p1\">[</bpt>CWnd::OnLButtonDown<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__onlbuttondown)</ept> handler.","source":"Call the `DoDragDrop` member function to perform a drag-and-drop operation for this data source, typically in an [CWnd::OnLButtonDown](../../mfc/reference/cwnd-class.md#cwnd__onlbuttondown) handler."},{"content":"Parameters","pos":[16405,16415]},{"content":"Drag-and-drop operations that are allowed on this data source.","pos":[16434,16496]},{"content":"Can be one or more of the following:","pos":[16497,16533]},{"pos":[16559,16595],"content":"A copy operation could be performed."},{"pos":[16621,16657],"content":"A move operation could be performed."},{"pos":[16683,16754],"content":"A link from the dropped data to the original data could be established."},{"pos":[16782,16833],"content":"Indicates that a drag scroll operation could occur."},{"pos":[16840,16987],"content":"`lpRectStartDrag`  \nPointer to the rectangle that defines where the drag actually starts. For more information, see the following Remarks section.","leadings":[""," "],"nodes":[{"content":"Pointer to the rectangle that defines where the drag actually starts. For more information, see the following Remarks section.","pos":[20,146],"nodes":[{"content":"Pointer to the rectangle that defines where the drag actually starts.","pos":[0,69]},{"content":"For more information, see the following Remarks section.","pos":[70,126]}]}]},{"pos":[16994,17156],"content":"*pDropSource*  \nPoints to a drop source. If **NULL** then a default implementation of [COleDropSource](../../mfc/reference/coledropsource-class.md) will be used.","leadings":[""," "],"nodes":[{"content":"pDropSource","pos":[1,12]},{"content":"Points to a drop source. If **NULL** then a default implementation of [COleDropSource](../../mfc/reference/coledropsource-class.md) will be used.","pos":[16,161],"nodes":[{"content":"Points to a drop source.","pos":[0,24]},{"content":"If <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> then a default implementation of <bpt id=\"p2\">[</bpt>COleDropSource<ept id=\"p2\">](../../mfc/reference/coledropsource-class.md)</ept> will be used.","pos":[25,145],"source":" If **NULL** then a default implementation of [COleDropSource](../../mfc/reference/coledropsource-class.md) will be used."}]}]},{"content":"Return Value","pos":[17166,17178]},{"pos":[17182,17375],"content":"Drop effect generated by the drag-and-drop operation; otherwise <ph id=\"ph1\">`DROPEFFECT_NONE`</ph> if the operation never begins because the user released the mouse button before leaving the supplied rectangle.","source":"Drop effect generated by the drag-and-drop operation; otherwise `DROPEFFECT_NONE` if the operation never begins because the user released the mouse button before leaving the supplied rectangle."},{"content":"Remarks","pos":[17385,17392]},{"content":"The drag-and-drop operation does not start immediately.","pos":[17396,17451]},{"content":"It waits until the mouse cursor leaves the rectangle specified by <ph id=\"ph1\">`lpRectStartDrag`</ph> or until a specified number of milliseconds have passed.","pos":[17452,17592],"source":" It waits until the mouse cursor leaves the rectangle specified by `lpRectStartDrag` or until a specified number of milliseconds have passed."},{"content":"If <ph id=\"ph1\">`lpRectStartDrag`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the size of the rectangle is one pixel.","pos":[17593,17666],"source":" If `lpRectStartDrag` is **NULL**, the size of the rectangle is one pixel."},{"content":"The delay time is specified by a registry key setting.","pos":[17673,17727]},{"content":"You can change the delay time by calling <bpt id=\"p1\">[</bpt>CWinApp::WriteProfileString<ept id=\"p1\">](../../mfc/reference/cwinapp-class.md#cwinapp__writeprofilestring)</ept> or <bpt id=\"p2\">[</bpt>CWinApp::WriteProfileInt<ept id=\"p2\">](../../mfc/reference/cwinapp-class.md#cwinapp__writeprofileint)</ept>.","pos":[17728,17958],"source":" You can change the delay time by calling [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#cwinapp__writeprofilestring) or [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#cwinapp__writeprofileint)."},{"content":"If you do not specify the delay time, a default value of 200 milliseconds is used.","pos":[17959,18041]},{"content":"Drag delay time is stored as follows:","pos":[18042,18079]},{"content":"Windows NT   Drag delay time is stored in HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\NT\\CurrentVersion\\IniFileMapping\\win.ini\\Windows\\DragDelay.","pos":[18089,18236]},{"content":"Windows 3.x   Drag delay time is stored in the WIN.INI file, under the [Windows} section.","pos":[18246,18335]},{"content":"Windows 95/98   Drag delay time is stored in a cached version of WIN.INI.","pos":[18345,18418]},{"pos":[18425,18674],"content":"For more information about how drag delay information is stored in either the registry or the .INI file, see <bpt id=\"p1\">[</bpt>WriteProfileString<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms725504)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information about how drag delay information is stored in either the registry or the .INI file, see [WriteProfileString](http://msdn.microsoft.com/library/windows/desktop/ms725504) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[18681,18818],"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Drag and Drop: Implementing a Drop Source<ept id=\"p1\">](../../mfc/drag-and-drop-implementing-a-drop-source.md)</ept>.","source":"For more information, see the article [Drag and Drop: Implementing a Drop Source](../../mfc/drag-and-drop-implementing-a-drop-source.md)."},{"pos":[18866,18887],"content":"COleDataSource::Empty"},{"pos":[18891,18955],"content":"Call this function to empty the <ph id=\"ph1\">`COleDataSource`</ph> object of data.","source":"Call this function to empty the `COleDataSource` object of data."},{"content":"Remarks","pos":[18994,19001]},{"content":"Both cached and delay render formats are emptied so they can be reused.","pos":[19005,19076]},{"pos":[19083,19247],"content":"For more information, see <bpt id=\"p1\">[</bpt>ReleaseStgMedium<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms693491)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [ReleaseStgMedium](http://msdn.microsoft.com/library/windows/desktop/ms693491) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[19304,19334],"content":"COleDataSource::FlushClipboard"},{"content":"Renders data that is on the Clipboard, and then lets you paste data from the Clipboard after your application shuts down.","pos":[19338,19459]},{"content":"Remarks","pos":[19521,19528]},{"pos":[19532,19611],"content":"Use <bpt id=\"p1\">[</bpt>SetClipboard<ept id=\"p1\">](#coledatasource__setclipboard)</ept> to put data on the Clipboard.","source":"Use [SetClipboard](#coledatasource__setclipboard) to put data on the Clipboard."},{"pos":[19671,19704],"content":"COleDataSource::GetClipboardOwner"},{"pos":[19708,19874],"content":"Determines whether the data on the Clipboard has changed since <bpt id=\"p1\">[</bpt>SetClipboard<ept id=\"p1\">](#coledatasource__setclipboard)</ept> was last called and, if so, identifies the current owner.","source":"Determines whether the data on the Clipboard has changed since [SetClipboard](#coledatasource__setclipboard) was last called and, if so, identifies the current owner."},{"content":"Return Value","pos":[19950,19962]},{"pos":[19966,20119],"content":"The data source currently on the Clipboard, or <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if there is nothing on the Clipboard or if the Clipboard is not owned by the calling application.","source":"The data source currently on the Clipboard, or **NULL** if there is nothing on the Clipboard or if the Clipboard is not owned by the calling application."},{"pos":[20174,20202],"content":"COleDataSource::OnRenderData"},{"content":"Called by the framework to retrieve data in the specified format.","pos":[20206,20271]},{"content":"Parameters","pos":[20384,20394]},{"content":"Points to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure specifying the format in which information is requested.","pos":[20415,20567],"source":" Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested."},{"content":"Points to a <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure in which the data is to be returned.","pos":[20591,20721],"source":" Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in which the data is to be returned."},{"content":"Return Value","pos":[20731,20743]},{"content":"Nonzero if successful; otherwise 0.","pos":[20747,20782]},{"content":"Remarks","pos":[20792,20799]},{"content":"The specified format is one previously placed in the <ph id=\"ph1\">`COleDataSource`</ph> object using the <bpt id=\"p1\">[</bpt>DelayRenderData<ept id=\"p1\">](#coledatasource__delayrenderdata)</ept> or <bpt id=\"p2\">[</bpt>DelayRenderFileData<ept id=\"p2\">](#coledatasource__delayrenderfiledata)</ept> member function for delayed rendering.","pos":[20803,21043],"source":"The specified format is one previously placed in the `COleDataSource` object using the [DelayRenderData](#coledatasource__delayrenderdata) or [DelayRenderFileData](#coledatasource__delayrenderfiledata) member function for delayed rendering."},{"content":"The default implementation of this function will call <bpt id=\"p1\">[</bpt>OnRenderFileData<ept id=\"p1\">](#coledatasource__onrenderfiledata)</ept> or <bpt id=\"p2\">[</bpt>OnRenderGlobalData<ept id=\"p2\">](#coledatasource__onrenderglobaldata)</ept> if the supplied storage medium is either a file or memory, respectively.","pos":[21044,21285],"source":" The default implementation of this function will call [OnRenderFileData](#coledatasource__onrenderfiledata) or [OnRenderGlobalData](#coledatasource__onrenderglobaldata) if the supplied storage medium is either a file or memory, respectively."},{"content":"If neither of these formats are supplied, then the default implementation will return 0 and do nothing.","pos":[21286,21389]},{"content":"For more information on delayed rendering as handled by MFC, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources: Manipulation<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-manipulation.md)</ept>.","pos":[21390,21570],"source":" For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md)."},{"content":"If <ph id=\"ph1\">`lpStgMedium`-&gt; </ph><bpt id=\"p1\">*</bpt>tymed<ept id=\"p1\">*</ept> is <bpt id=\"p2\">**</bpt>TYMED_NULL<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>STGMEDIUM<ept id=\"p3\">**</ept> should be allocated and filled as specified by <bpt id=\"p4\">*</bpt>lpFormatEtc-&gt;tymed<ept id=\"p4\">*</ept>.","pos":[21577,21709],"source":"If `lpStgMedium`-> *tymed* is **TYMED_NULL**, the **STGMEDIUM** should be allocated and filled as specified by *lpFormatEtc->tymed*."},{"content":"If it is not <bpt id=\"p1\">**</bpt>TYMED_NULL<ept id=\"p1\">**</ept>, the <bpt id=\"p2\">**</bpt>STGMEDIUM<ept id=\"p2\">**</ept> should be filled in place with the data.","pos":[21710,21797],"source":" If it is not **TYMED_NULL**, the **STGMEDIUM** should be filled in place with the data."},{"content":"This is an advanced overridable.","pos":[21804,21836]},{"content":"Override this function to supply your data in the requested format and medium.","pos":[21837,21915]},{"content":"Depending on your data, you may want to override one of the other versions of this function instead.","pos":[21916,22016]},{"content":"If your data is small and fixed in size, override <ph id=\"ph1\">`OnRenderGlobalData`</ph>.","pos":[22017,22088],"source":" If your data is small and fixed in size, override `OnRenderGlobalData`."},{"content":"If your data is in a file, or is of variable size, override <ph id=\"ph1\">`OnRenderFileData`</ph>.","pos":[22089,22168],"source":" If your data is in a file, or is of variable size, override `OnRenderFileData`."},{"pos":[22175,22603],"content":"For more information, see the <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> and <bpt id=\"p2\">[</bpt>FORMATETC<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structures, the <bpt id=\"p3\">[</bpt>TYMED<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/ms691227)</ept> enumeration type, and <bpt id=\"p4\">[</bpt>IDataObject::GetData<ept id=\"p4\">](http://msdn.microsoft.com/library/windows/desktop/ms678431)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph><bpt id=\"p5\">*</bpt>.<ept id=\"p5\">*</ept>","source":"For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structures, the [TYMED](http://msdn.microsoft.com/library/windows/desktop/ms691227) enumeration type, and [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*"},{"pos":[22662,22694],"content":"COleDataSource::OnRenderFileData"},{"content":"Called by the framework to retrieve data in the specified format when the specified storage medium is a file.","pos":[22698,22807]},{"content":"Parameters","pos":[22913,22923]},{"content":"Points to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure specifying the format in which information is requested.","pos":[22944,23096],"source":" Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested."},{"content":"Points to a <bpt id=\"p1\">[</bpt>CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md)</ept> object in which the data is to be rendered.","pos":[23114,23213],"source":" Points to a [CFile](../../mfc/reference/cfile-class.md) object in which the data is to be rendered."},{"content":"Return Value","pos":[23223,23235]},{"content":"Nonzero if successful; otherwise 0.","pos":[23239,23274]},{"content":"Remarks","pos":[23284,23291]},{"content":"The specified format is one previously placed in the <ph id=\"ph1\">`COleDataSource`</ph> object using the <bpt id=\"p1\">[</bpt>DelayRenderData<ept id=\"p1\">](#coledatasource__delayrenderdata)</ept> member function for delayed rendering.","pos":[23295,23472],"source":"The specified format is one previously placed in the `COleDataSource` object using the [DelayRenderData](#coledatasource__delayrenderdata) member function for delayed rendering."},{"content":"The default implementation of this function simply returns <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[23473,23542],"source":" The default implementation of this function simply returns **FALSE**."},{"content":"This is an advanced overridable.","pos":[23549,23581]},{"content":"Override this function to supply your data in the requested format and medium.","pos":[23582,23660]},{"content":"Depending on your data, you might want to override one of the other versions of this function instead.","pos":[23661,23763]},{"content":"If you want to handle multiple storage media, override <bpt id=\"p1\">[</bpt>OnRenderData<ept id=\"p1\">](#coledatasource__onrenderdata)</ept>.","pos":[23764,23865],"source":" If you want to handle multiple storage media, override [OnRenderData](#coledatasource__onrenderdata)."},{"content":"If your data is in a file, or is of variable size, override <ph id=\"ph1\">`OnRenderFileData`</ph>.","pos":[23866,23945],"source":" If your data is in a file, or is of variable size, override `OnRenderFileData`."},{"content":"For more information on delayed rendering as handled by MFC, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources: Manipulation<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-manipulation.md)</ept>.","pos":[23946,24126],"source":" For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md)."},{"pos":[24133,24393],"content":"For more information, see the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure and <bpt id=\"p2\">[</bpt>IDataObject::GetData<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms678431)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph><bpt id=\"p3\">*</bpt>.<ept id=\"p3\">*</ept>","source":"For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure and [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*"},{"pos":[24454,24488],"content":"COleDataSource::OnRenderGlobalData"},{"content":"Called by the framework to retrieve data in the specified format when the specified storage medium is global memory.","pos":[24492,24608]},{"content":"Parameters","pos":[24721,24731]},{"content":"Points to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure specifying the format in which information is requested.","pos":[24752,24904],"source":" Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested."},{"content":"Points to a handle to global memory in which the data is to be returned.","pos":[24925,24997]},{"content":"If one has not yet been allocated, this parameter can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[24998,25064],"source":" If one has not yet been allocated, this parameter can be **NULL**."},{"content":"Return Value","pos":[25074,25086]},{"content":"Nonzero if successful; otherwise 0.","pos":[25090,25125]},{"content":"Remarks","pos":[25135,25142]},{"content":"The specified format is one previously placed in the <ph id=\"ph1\">`COleDataSource`</ph> object using the <bpt id=\"p1\">[</bpt>DelayRenderData<ept id=\"p1\">](#coledatasource__delayrenderdata)</ept> member function for delayed rendering.","pos":[25146,25323],"source":"The specified format is one previously placed in the `COleDataSource` object using the [DelayRenderData](#coledatasource__delayrenderdata) member function for delayed rendering."},{"content":"The default implementation of this function simply returns <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[25324,25393],"source":" The default implementation of this function simply returns **FALSE**."},{"content":"If <ph id=\"ph1\">`phGlobal`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, then a new <ph id=\"ph2\">`HGLOBAL`</ph> should be allocated and returned in <ph id=\"ph3\">`phGlobal`</ph>.","pos":[25400,25495],"source":"If `phGlobal` is **NULL**, then a new `HGLOBAL` should be allocated and returned in `phGlobal`."},{"content":"Otherwise, the <ph id=\"ph1\">`HGLOBAL`</ph> specified by <ph id=\"ph2\">`phGlobal`</ph> should be filled with the data.","pos":[25496,25576],"source":" Otherwise, the `HGLOBAL` specified by `phGlobal` should be filled with the data."},{"content":"The amount of data placed in the <ph id=\"ph1\">`HGLOBAL`</ph> must not exceed the current size of the memory block.","pos":[25577,25673],"source":" The amount of data placed in the `HGLOBAL` must not exceed the current size of the memory block."},{"content":"Also, the block cannot be reallocated to a larger size.","pos":[25674,25729]},{"content":"This is an advanced overridable.","pos":[25736,25768]},{"content":"Override this function to supply your data in the requested format and medium.","pos":[25769,25847]},{"content":"Depending on your data, you may want to override one of the other versions of this function instead.","pos":[25848,25948]},{"content":"If you want to handle multiple storage media, override <bpt id=\"p1\">[</bpt>OnRenderData<ept id=\"p1\">](#coledatasource__onrenderdata)</ept>.","pos":[25949,26050],"source":" If you want to handle multiple storage media, override [OnRenderData](#coledatasource__onrenderdata)."},{"content":"If your data is in a file, or is of variable size, override <bpt id=\"p1\">[</bpt>OnRenderFileData<ept id=\"p1\">](#coledatasource__onrenderfiledata)</ept>.","pos":[26051,26165],"source":" If your data is in a file, or is of variable size, override [OnRenderFileData](#coledatasource__onrenderfiledata)."},{"content":"For more information on delayed rendering as handled by MFC, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources: Manipulation<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-manipulation.md)</ept>.","pos":[26166,26346],"source":" For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md)."},{"pos":[26353,26613],"content":"For more information, see the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure and <bpt id=\"p2\">[</bpt>IDataObject::GetData<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms678431)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph><bpt id=\"p3\">*</bpt>.<ept id=\"p3\">*</ept>","source":"For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure and [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*"},{"pos":[26665,26690],"content":"COleDataSource::OnSetData"},{"pos":[26694,26800],"content":"Called by the framework to set or replace the data in the <ph id=\"ph1\">`COleDataSource`</ph> object in the specified format.","source":"Called by the framework to set or replace the data in the `COleDataSource` object in the specified format."},{"content":"Parameters","pos":[26931,26941]},{"content":"Points to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure specifying the format in which data is being replaced.","pos":[26962,27112],"source":" Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which data is being replaced."},{"content":"Points to the <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure containing the data that will replace the current contents of the <ph id=\"ph1\">`COleDataSource`</ph> object.","pos":[27136,27322],"source":" Points to the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure containing the data that will replace the current contents of the `COleDataSource` object."},{"content":"Indicates who has ownership of the storage medium after completing the function call.","pos":[27343,27428]},{"content":"The caller decides who is responsible for releasing the resources allocated on behalf of the storage medium.","pos":[27429,27537]},{"content":"The caller does this by setting <ph id=\"ph1\">`bRelease`</ph>.","pos":[27538,27581],"source":" The caller does this by setting `bRelease`."},{"content":"If <ph id=\"ph1\">`bRelease`</ph> is nonzero, the data source takes ownership, freeing the medium when it has finished using it.","pos":[27582,27690],"source":" If `bRelease` is nonzero, the data source takes ownership, freeing the medium when it has finished using it."},{"content":"When <ph id=\"ph1\">`bRelease`</ph> is 0, the caller retains ownership and the data source can use the storage medium only for the duration of the call.","pos":[27691,27823],"source":" When `bRelease` is 0, the caller retains ownership and the data source can use the storage medium only for the duration of the call."},{"content":"Return Value","pos":[27833,27845]},{"content":"Nonzero if successful; otherwise 0.","pos":[27849,27884]},{"content":"Remarks","pos":[27894,27901]},{"content":"The data source does not take ownership of the data until it has successfully obtained it.","pos":[27905,27995]},{"content":"That is, it does not take ownership if <ph id=\"ph1\">`OnSetData`</ph> returns 0.","pos":[27996,28057],"source":" That is, it does not take ownership if `OnSetData` returns 0."},{"content":"If the data source takes ownership, it frees the storage medium by calling the <bpt id=\"p1\">[</bpt>ReleaseStgMedium<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms693491)</ept> function.","pos":[28058,28225],"source":" If the data source takes ownership, it frees the storage medium by calling the [ReleaseStgMedium](http://msdn.microsoft.com/library/windows/desktop/ms693491) function."},{"content":"The default implementation does nothing.","pos":[28232,28272]},{"content":"Override this function to replace the data in the specified format.","pos":[28273,28340]},{"content":"This is an advanced overridable.","pos":[28341,28373]},{"pos":[28380,28814],"content":"For more information, see the <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> and <bpt id=\"p2\">[</bpt>FORMATETC<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structures and the <bpt id=\"p3\">[</bpt>ReleaseStgMedium<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/ms693491)</ept> and <bpt id=\"p4\">[</bpt>IDataObject::GetData<ept id=\"p4\">](http://msdn.microsoft.com/library/windows/desktop/ms678431)</ept> functions in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph><bpt id=\"p5\">*</bpt>.<ept id=\"p5\">*</ept>","source":"For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structures and the [ReleaseStgMedium](http://msdn.microsoft.com/library/windows/desktop/ms693491) and [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) functions in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*"},{"pos":[28869,28897],"content":"COleDataSource::SetClipboard"},{"pos":[28901,29229],"content":"Puts the data contained in the <ph id=\"ph1\">`COleDataSource`</ph> object on the Clipboard after calling one of the following functions: <bpt id=\"p1\">[</bpt>CacheData<ept id=\"p1\">](#coledatasource__cachedata)</ept>, <bpt id=\"p2\">[</bpt>CacheGlobalData<ept id=\"p2\">](#coledatasource__cacheglobaldata)</ept>, <bpt id=\"p3\">[</bpt>DelayRenderData<ept id=\"p3\">](#coledatasource__delayrenderdata)</ept>, or <bpt id=\"p4\">[</bpt>DelayRenderFileData<ept id=\"p4\">](#coledatasource__delayrenderfiledata)</ept>.","source":"Puts the data contained in the `COleDataSource` object on the Clipboard after calling one of the following functions: [CacheData](#coledatasource__cachedata), [CacheGlobalData](#coledatasource__cacheglobaldata), [DelayRenderData](#coledatasource__delayrenderdata), or [DelayRenderFileData](#coledatasource__delayrenderfiledata)."},{"content":"See Also","pos":[29274,29282]},{"content":"MFC Sample HIERSVR","pos":[29287,29305]},{"content":"MFC Sample OCLIENT","pos":[29341,29359]},{"content":"CCmdTarget Class","pos":[29395,29411]},{"content":"Hierarchy Chart","pos":[29459,29474]},{"content":"COleDataObject Class","pos":[29511,29531]}],"content":"---\ntitle: \"COleDataSource Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleDataSource\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"drag and drop [C++], MFC support\"\n  - \"Clipboard [C++], OLE support\"\n  - \"uniform data transfer\"\n  - \"OLE [C++], uniform data transfer\"\n  - \"Clipboard [C++], MFC support\"\n  - \"OLE Clipboard [C++], support\"\n  - \"IDataObject, MFC encapsulation\"\n  - \"data transfer [C++], OLE\"\n  - \"COleDataSource class\"\n  - \"OLE data transfer [C++]\"\n  - \"uniform data transfer, OLE\"\nms.assetid: 02c8ee7d-8e10-4463-8613-bb2a0305ca69\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleDataSource Class\nActs as a cache into which an application places the data that it will offer during data transfer operations, such as Clipboard or drag-and-drop operations.  \n  \n## Syntax  \n  \n```  \nclass COleDataSource : public CCmdTarget  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDataSource::COleDataSource](#coledatasource__coledatasource)|Constructs a `COleDataSource` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDataSource::CacheData](#coledatasource__cachedata)|Offers data in a specified format using a **STGMEDIUM** structure.|  \n|[COleDataSource::CacheGlobalData](#coledatasource__cacheglobaldata)|Offers data in a specified format using an `HGLOBAL`.|  \n|[COleDataSource::DelayRenderData](#coledatasource__delayrenderdata)|Offers data in a specified format using delayed rendering.|  \n|[COleDataSource::DelayRenderFileData](#coledatasource__delayrenderfiledata)|Offers data in a specified format in a `CFile` pointer.|  \n|[COleDataSource::DelaySetData](#coledatasource__delaysetdata)|Called for every format that is supported in `OnSetData`.|  \n|[COleDataSource::DoDragDrop](#coledatasource__dodragdrop)|Performs drag-and-drop operations with a data source.|  \n|[COleDataSource::Empty](#coledatasource__empty)|Empties the `COleDataSource` object of data.|  \n|[COleDataSource::FlushClipboard](#coledatasource__flushclipboard)|Renders all data to the Clipboard.|  \n|[COleDataSource::GetClipboardOwner](#coledatasource__getclipboardowner)|Verifies that the data placed on the Clipboard is still there.|  \n|[COleDataSource::OnRenderData](#coledatasource__onrenderdata)|Retrieves data as part of delayed rendering.|  \n|[COleDataSource::OnRenderFileData](#coledatasource__onrenderfiledata)|Retrieves data into a `CFile` as part of delayed rendering.|  \n|[COleDataSource::OnRenderGlobalData](#coledatasource__onrenderglobaldata)|Retrieves data into an `HGLOBAL` as part of delayed rendering.|  \n|[COleDataSource::OnSetData](#coledatasource__onsetdata)|Called to replace the data in the `COleDataSource` object.|  \n|[COleDataSource::SetClipboard](#coledatasource__setclipboard)|Places a `COleDataSource` object on the Clipboard.|  \n  \n## Remarks  \n You can create OLE data sources directly. Alternately, the [COleClientItem](../../mfc/reference/coleclientitem-class.md) and [COleServerItem](../../mfc/reference/coleserveritem-class.md) classes create OLE data sources in response to their `CopyToClipboard` and `DoDragDrop` member functions. See [COleServerItem::CopyToClipboard](../../mfc/reference/coleserveritem-class.md#coleserveritem__copytoclipboard) for a brief description. Override the `OnGetClipboardData` member function of your client item or server item class to add additional Clipboard formats to the data in the OLE data source created for the `CopyToClipboard` or `DoDragDrop` member function.  \n  \n Whenever you want to prepare data for a transfer, you should create an object of this class and fill it with your data using the most appropriate method for your data. The way it is inserted into a data source is directly affected by whether the data is supplied immediately (immediate rendering) or on demand (delayed rendering). For every Clipboard format in which you are providing data by passing the Clipboard format to be used (and an optional [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure), call [DelayRenderData](#coledatasource__delayrenderdata).  \n  \n For more information about data sources and data transfer, see the article [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md). In addition, the article [Clipboard Topics](../../mfc/clipboard.md) describes the OLE Clipboard mechanism.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n `COleDataSource`  \n  \n## Requirements  \n **Header:** afxole.h  \n  \n##  <a name=\"coledatasource__cachedata\"></a>  COleDataSource::CacheData  \n Call this function to specify a format in which data is offered during data transfer operations.  \n  \n```  \nvoid CacheData(\n    CLIPFORMAT cfFormat,  \n    LPSTGMEDIUM lpStgMedium,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The Clipboard format in which the data is to be offered. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpStgMedium`  \n Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure containing the data in the format specified.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be offered. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Remarks  \n You must supply the data, because this function provides it by using immediate rendering. The data is cached until needed.  \n  \n Supply the data using a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure. You can also use the `CacheGlobalData` member function if the amount of data you are supplying is small enough to be transferred efficiently using an `HGLOBAL`.  \n  \n After the call to `CacheData` the **ptd** member of `lpFormatEtc` and the contents of `lpStgMedium` are owned by the data object, not by the caller.  \n  \n To use delayed rendering, call the [DelayRenderData](#coledatasource__delayrenderdata) or [DelayRenderFileData](#coledatasource__delayrenderfiledata) member function. For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md).  \n  \n For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structures in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledatasource__cacheglobaldata\"></a>  COleDataSource::CacheGlobalData  \n Call this function to specify a format in which data is offered during data transfer operations.  \n  \n```  \nvoid CacheGlobalData(\n    CLIPFORMAT cfFormat,  \n    HGLOBAL hGlobal,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The Clipboard format in which the data is to be offered. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n *hGlobal*  \n Handle to the global memory block containing the data in the format specified.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be offered. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Remarks  \n This function provides the data using immediate rendering, so you must supply the data when calling the function; the data is cached until needed. Use the `CacheData` member function if you are supplying a large amount of data or if you require a structured storage medium.  \n  \n To use delayed rendering, call the [DelayRenderData](#coledatasource__delayrenderdata) or [DelayRenderFileData](#coledatasource__delayrenderfiledata) member function. For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md).  \n  \n For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledatasource__coledatasource\"></a>  COleDataSource::COleDataSource  \n Constructs a `COleDataSource` object.  \n  \n```  \nCOleDataSource();\n```  \n  \n##  <a name=\"coledatasource__delayrenderdata\"></a>  COleDataSource::DelayRenderData  \n Call this function to specify a format in which data is offered during data transfer operations.  \n  \n```  \nvoid DelayRenderData(\n    CLIPFORMAT cfFormat,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The Clipboard format in which the data is to be offered. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be offered. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Remarks  \n This function provides the data using delayed rendering, so the data is not supplied immediately. The [OnRenderData](#coledatasource__onrenderdata) or [OnRenderGlobalData](#coledatasource__onrenderglobaldata) member function is called to request the data.  \n  \n Use this function if you are not going to supply your data through a `CFile` object. If you are going to supply the data through a `CFile` object, call the [DelayRenderFileData](#coledatasource__delayrenderfiledata) member function. For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md).  \n  \n To use immediate rendering, call the [CacheData](#coledatasource__cachedata) or [CacheGlobalData](#coledatasource__cacheglobaldata) member function.  \n  \n For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledatasource__delayrenderfiledata\"></a>  COleDataSource::DelayRenderFileData  \n Call this function to specify a format in which data is offered during data transfer operations.  \n  \n```  \nvoid DelayRenderFileData(\n    CLIPFORMAT cfFormat,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The Clipboard format in which the data is to be offered. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be offered. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Remarks  \n This function provides the data using delayed rendering, so the data is not supplied immediately. The [OnRenderFileData](#coledatasource__onrenderfiledata) member function is called to request the data.  \n  \n Use this function if you are going to use a `CFile` object to supply the data. If you are not going to use a `CFile` object, call the [DelayRenderData](#coledatasource__delayrenderdata) member function. For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md).  \n  \n To use immediate rendering, call the [CacheData](#coledatasource__cachedata) or [CacheGlobalData](#coledatasource__cacheglobaldata) member function.  \n  \n For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledatasource__delaysetdata\"></a>  COleDataSource::DelaySetData  \n Call this function to support changing the contents of the data source.  \n  \n```  \nvoid DelaySetData(\n    CLIPFORMAT cfFormat,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The Clipboard format in which the data is to be placed. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which the data is to be replaced. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Remarks  \n [OnSetData](#coledatasource__onsetdata) will be called by the framework when this happens. This is only used when the framework returns the data source from [COleServerItem::GetDataSource](../../mfc/reference/coleserveritem-class.md#coleserveritem__getdatasource). If `DelaySetData` is not called, your `OnSetData` function will never be called. `DelaySetData` should be called for each Clipboard or **FORMATETC** format you support.  \n  \n For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledatasource__dodragdrop\"></a>  COleDataSource::DoDragDrop  \n Call the `DoDragDrop` member function to perform a drag-and-drop operation for this data source, typically in an [CWnd::OnLButtonDown](../../mfc/reference/cwnd-class.md#cwnd__onlbuttondown) handler.  \n  \n```  \nDROPEFFECT DoDragDrop(\n    DWORD dwEffects = DROPEFFECT_COPY|DROPEFFECT_MOVE|DROPEFFECT_LINK,  \n    LPCRECT lpRectStartDrag = NULL,  \n    COleDropSource* pDropSource = NULL);\n```  \n  \n### Parameters  \n `dwEffects`  \n Drag-and-drop operations that are allowed on this data source. Can be one or more of the following:  \n  \n- `DROPEFFECT_COPY` A copy operation could be performed.  \n  \n- `DROPEFFECT_MOVE` A move operation could be performed.  \n  \n- `DROPEFFECT_LINK` A link from the dropped data to the original data could be established.  \n  \n- `DROPEFFECT_SCROLL` Indicates that a drag scroll operation could occur.  \n  \n `lpRectStartDrag`  \n Pointer to the rectangle that defines where the drag actually starts. For more information, see the following Remarks section.  \n  \n *pDropSource*  \n Points to a drop source. If **NULL** then a default implementation of [COleDropSource](../../mfc/reference/coledropsource-class.md) will be used.  \n  \n### Return Value  \n Drop effect generated by the drag-and-drop operation; otherwise `DROPEFFECT_NONE` if the operation never begins because the user released the mouse button before leaving the supplied rectangle.  \n  \n### Remarks  \n The drag-and-drop operation does not start immediately. It waits until the mouse cursor leaves the rectangle specified by `lpRectStartDrag` or until a specified number of milliseconds have passed. If `lpRectStartDrag` is **NULL**, the size of the rectangle is one pixel.  \n  \n The delay time is specified by a registry key setting. You can change the delay time by calling [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#cwinapp__writeprofilestring) or [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#cwinapp__writeprofileint). If you do not specify the delay time, a default value of 200 milliseconds is used. Drag delay time is stored as follows:  \n  \n-   Windows NT   Drag delay time is stored in HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\NT\\CurrentVersion\\IniFileMapping\\win.ini\\Windows\\DragDelay.  \n  \n-   Windows 3.x   Drag delay time is stored in the WIN.INI file, under the [Windows} section.  \n  \n-   Windows 95/98   Drag delay time is stored in a cached version of WIN.INI.  \n  \n For more information about how drag delay information is stored in either the registry or the .INI file, see [WriteProfileString](http://msdn.microsoft.com/library/windows/desktop/ms725504) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see the article [Drag and Drop: Implementing a Drop Source](../../mfc/drag-and-drop-implementing-a-drop-source.md).  \n  \n##  <a name=\"coledatasource__empty\"></a>  COleDataSource::Empty  \n Call this function to empty the `COleDataSource` object of data.  \n  \n```  \nvoid Empty();\n```  \n  \n### Remarks  \n Both cached and delay render formats are emptied so they can be reused.  \n  \n For more information, see [ReleaseStgMedium](http://msdn.microsoft.com/library/windows/desktop/ms693491) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledatasource__flushclipboard\"></a>  COleDataSource::FlushClipboard  \n Renders data that is on the Clipboard, and then lets you paste data from the Clipboard after your application shuts down.  \n  \n```  \nstatic void PASCAL FlushClipboard();\n```  \n  \n### Remarks  \n Use [SetClipboard](#coledatasource__setclipboard) to put data on the Clipboard.  \n  \n##  <a name=\"coledatasource__getclipboardowner\"></a>  COleDataSource::GetClipboardOwner  \n Determines whether the data on the Clipboard has changed since [SetClipboard](#coledatasource__setclipboard) was last called and, if so, identifies the current owner.  \n  \n```  \nstatic COleDataSource* PASCAL GetClipboardOwner();\n```  \n  \n### Return Value  \n The data source currently on the Clipboard, or **NULL** if there is nothing on the Clipboard or if the Clipboard is not owned by the calling application.  \n  \n##  <a name=\"coledatasource__onrenderdata\"></a>  COleDataSource::OnRenderData  \n Called by the framework to retrieve data in the specified format.  \n  \n```  \nvirtual BOOL OnRenderData(\n    LPFORMATETC lpFormatEtc,  \n    LPSTGMEDIUM lpStgMedium);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested.  \n  \n `lpStgMedium`  \n Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in which the data is to be returned.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n The specified format is one previously placed in the `COleDataSource` object using the [DelayRenderData](#coledatasource__delayrenderdata) or [DelayRenderFileData](#coledatasource__delayrenderfiledata) member function for delayed rendering. The default implementation of this function will call [OnRenderFileData](#coledatasource__onrenderfiledata) or [OnRenderGlobalData](#coledatasource__onrenderglobaldata) if the supplied storage medium is either a file or memory, respectively. If neither of these formats are supplied, then the default implementation will return 0 and do nothing. For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md).  \n  \n If `lpStgMedium`-> *tymed* is **TYMED_NULL**, the **STGMEDIUM** should be allocated and filled as specified by *lpFormatEtc->tymed*. If it is not **TYMED_NULL**, the **STGMEDIUM** should be filled in place with the data.  \n  \n This is an advanced overridable. Override this function to supply your data in the requested format and medium. Depending on your data, you may want to override one of the other versions of this function instead. If your data is small and fixed in size, override `OnRenderGlobalData`. If your data is in a file, or is of variable size, override `OnRenderFileData`.  \n  \n For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structures, the [TYMED](http://msdn.microsoft.com/library/windows/desktop/ms691227) enumeration type, and [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*  \n  \n##  <a name=\"coledatasource__onrenderfiledata\"></a>  COleDataSource::OnRenderFileData  \n Called by the framework to retrieve data in the specified format when the specified storage medium is a file.  \n  \n```  \nvirtual BOOL OnRenderFileData(\n    LPFORMATETC lpFormatEtc,  \n    CFile* pFile);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested.  \n  \n `pFile`  \n Points to a [CFile](../../mfc/reference/cfile-class.md) object in which the data is to be rendered.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n The specified format is one previously placed in the `COleDataSource` object using the [DelayRenderData](#coledatasource__delayrenderdata) member function for delayed rendering. The default implementation of this function simply returns **FALSE**.  \n  \n This is an advanced overridable. Override this function to supply your data in the requested format and medium. Depending on your data, you might want to override one of the other versions of this function instead. If you want to handle multiple storage media, override [OnRenderData](#coledatasource__onrenderdata). If your data is in a file, or is of variable size, override `OnRenderFileData`. For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md).  \n  \n For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure and [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*  \n  \n##  <a name=\"coledatasource__onrenderglobaldata\"></a>  COleDataSource::OnRenderGlobalData  \n Called by the framework to retrieve data in the specified format when the specified storage medium is global memory.  \n  \n```  \nvirtual BOOL OnRenderGlobalData(\n    LPFORMATETC lpFormatEtc,  \n    HGLOBAL* phGlobal);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which information is requested.  \n  \n `phGlobal`  \n Points to a handle to global memory in which the data is to be returned. If one has not yet been allocated, this parameter can be **NULL**.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n The specified format is one previously placed in the `COleDataSource` object using the [DelayRenderData](#coledatasource__delayrenderdata) member function for delayed rendering. The default implementation of this function simply returns **FALSE**.  \n  \n If `phGlobal` is **NULL**, then a new `HGLOBAL` should be allocated and returned in `phGlobal`. Otherwise, the `HGLOBAL` specified by `phGlobal` should be filled with the data. The amount of data placed in the `HGLOBAL` must not exceed the current size of the memory block. Also, the block cannot be reallocated to a larger size.  \n  \n This is an advanced overridable. Override this function to supply your data in the requested format and medium. Depending on your data, you may want to override one of the other versions of this function instead. If you want to handle multiple storage media, override [OnRenderData](#coledatasource__onrenderdata). If your data is in a file, or is of variable size, override [OnRenderFileData](#coledatasource__onrenderfiledata). For more information on delayed rendering as handled by MFC, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md).  \n  \n For more information, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure and [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*  \n  \n##  <a name=\"coledatasource__onsetdata\"></a>  COleDataSource::OnSetData  \n Called by the framework to set or replace the data in the `COleDataSource` object in the specified format.  \n  \n```  \nvirtual BOOL OnSetData(\n    LPFORMATETC lpFormatEtc,  \n    LPSTGMEDIUM lpStgMedium,  \n    BOOL bRelease);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure specifying the format in which data is being replaced.  \n  \n `lpStgMedium`  \n Points to the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure containing the data that will replace the current contents of the `COleDataSource` object.  \n  \n `bRelease`  \n Indicates who has ownership of the storage medium after completing the function call. The caller decides who is responsible for releasing the resources allocated on behalf of the storage medium. The caller does this by setting `bRelease`. If `bRelease` is nonzero, the data source takes ownership, freeing the medium when it has finished using it. When `bRelease` is 0, the caller retains ownership and the data source can use the storage medium only for the duration of the call.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n The data source does not take ownership of the data until it has successfully obtained it. That is, it does not take ownership if `OnSetData` returns 0. If the data source takes ownership, it frees the storage medium by calling the [ReleaseStgMedium](http://msdn.microsoft.com/library/windows/desktop/ms693491) function.  \n  \n The default implementation does nothing. Override this function to replace the data in the specified format. This is an advanced overridable.  \n  \n For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structures and the [ReleaseStgMedium](http://msdn.microsoft.com/library/windows/desktop/ms693491) and [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) functions in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]*.*  \n  \n##  <a name=\"coledatasource__setclipboard\"></a>  COleDataSource::SetClipboard  \n Puts the data contained in the `COleDataSource` object on the Clipboard after calling one of the following functions: [CacheData](#coledatasource__cachedata), [CacheGlobalData](#coledatasource__cacheglobaldata), [DelayRenderData](#coledatasource__delayrenderdata), or [DelayRenderFileData](#coledatasource__delayrenderfiledata).  \n  \n```  \nvoid SetClipboard();\n```  \n  \n## See Also  \n [MFC Sample HIERSVR](../../visual-cpp-samples.md)   \n [MFC Sample OCLIENT](../../visual-cpp-samples.md)   \n [CCmdTarget Class](../../mfc/reference/ccmdtarget-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [COleDataObject Class](../../mfc/reference/coledataobject-class.md)\n"}