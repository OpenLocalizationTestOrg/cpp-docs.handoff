{"nodes":[{"pos":[12,47],"content":"Scheduler Policies | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Scheduler Policies | Microsoft Docs","pos":[0,35]}]},{"content":"Scheduler Policies","pos":[575,593]},{"content":"This document describes the role of scheduler policies in the Concurrency Runtime.","pos":[594,676]},{"content":"A <bpt id=\"p1\">*</bpt>scheduler policy<ept id=\"p1\">*</ept> controls the strategy that the scheduler uses when it manages tasks.","pos":[677,766],"source":" A *scheduler policy* controls the strategy that the scheduler uses when it manages tasks."},{"content":"For example, consider an application that requires some tasks to execute at <ph id=\"ph1\">`THREAD_PRIORITY_NORMAL`</ph> and other tasks to execute at <ph id=\"ph2\">`THREAD_PRIORITY_HIGHEST`</ph>.","pos":[767,924],"source":" For example, consider an application that requires some tasks to execute at `THREAD_PRIORITY_NORMAL` and other tasks to execute at `THREAD_PRIORITY_HIGHEST`."},{"content":"You can create two scheduler instances: one that specifies the <ph id=\"ph1\">`ContextPriority`</ph> policy to be <ph id=\"ph2\">`THREAD_PRIORITY_NORMAL`</ph> and another that specifies the same policy to be <ph id=\"ph3\">`THREAD_PRIORITY_HIGHEST`</ph>.","pos":[926,1120],"source":"  You can create two scheduler instances: one that specifies the `ContextPriority` policy to be `THREAD_PRIORITY_NORMAL` and another that specifies the same policy to be `THREAD_PRIORITY_HIGHEST`."},{"content":"By using scheduler policies, you can divide the available processing resources and assign a fixed set of resources to each scheduler.","pos":[1127,1260]},{"content":"For example, consider a parallel algorithm that does not scale beyond four processors.","pos":[1261,1347]},{"content":"You can create a scheduler policy that limits its tasks to use no more than four processors concurrently.","pos":[1348,1453]},{"pos":[1461,1931],"content":"[!TIP]\n The Concurrency Runtime provides a default scheduler. Therefore, you don't have to create one in your application. Because the Task Scheduler helps you fine-tune the performance of your applications, we recommend that you start with the [Parallel Patterns Library (PPL)](../../parallel/concrt/parallel-patterns-library-ppl.md) or the [Asynchronous Agents Library](../../parallel/concrt/asynchronous-agents-library.md) if you are new to the Concurrency Runtime.","leadings":["","> "],"nodes":[{"content":" The Concurrency Runtime provides a default scheduler. Therefore, you don't have to create one in your application. Because the Task Scheduler helps you fine-tune the performance of your applications, we recommend that you start with the [Parallel Patterns Library (PPL)](../../parallel/concrt/parallel-patterns-library-ppl.md) or the [Asynchronous Agents Library](../../parallel/concrt/asynchronous-agents-library.md) if you are new to the Concurrency Runtime.","pos":[7,468],"nodes":[{"content":"The Concurrency Runtime provides a default scheduler.","pos":[1,54]},{"content":"Therefore, you don't have to create one in your application.","pos":[55,115]},{"content":"Because the Task Scheduler helps you fine-tune the performance of your applications, we recommend that you start with the <bpt id=\"p1\">[</bpt>Parallel Patterns Library (PPL)<ept id=\"p1\">](../../parallel/concrt/parallel-patterns-library-ppl.md)</ept> or the <bpt id=\"p2\">[</bpt>Asynchronous Agents Library<ept id=\"p2\">](../../parallel/concrt/asynchronous-agents-library.md)</ept> if you are new to the Concurrency Runtime.","pos":[116,461],"source":" Because the Task Scheduler helps you fine-tune the performance of your applications, we recommend that you start with the [Parallel Patterns Library (PPL)](../../parallel/concrt/parallel-patterns-library-ppl.md) or the [Asynchronous Agents Library](../../parallel/concrt/asynchronous-agents-library.md) if you are new to the Concurrency Runtime."}]}]},{"content":"When you use the <bpt id=\"p1\">[</bpt>concurrency::CurrentScheduler::Create<ept id=\"p1\">](reference/currentscheduler-class.md#create)</ept>, <bpt id=\"p2\">[</bpt>concurrency::Scheduler::Create<ept id=\"p2\">](reference/scheduler-class.md#create)</ept>, or <bpt id=\"p3\">[</bpt>concurrency::Scheduler::SetDefaultSchedulerPolicy<ept id=\"p3\">](reference/scheduler-class.md#setdefaultschedulerpolicy)</ept> method to create a scheduler instance, you provide a <bpt id=\"p4\">[</bpt>concurrency::SchedulerPolicy<ept id=\"p4\">](../../parallel/concrt/reference/schedulerpolicy-class.md)</ept> object that contains a collection of key-value pairs that specify the behavior of the scheduler.","pos":[1938,2460],"source":"When you use the [concurrency::CurrentScheduler::Create](reference/currentscheduler-class.md#create), [concurrency::Scheduler::Create](reference/scheduler-class.md#create), or [concurrency::Scheduler::SetDefaultSchedulerPolicy](reference/scheduler-class.md#setdefaultschedulerpolicy) method to create a scheduler instance, you provide a [concurrency::SchedulerPolicy](../../parallel/concrt/reference/schedulerpolicy-class.md) object that contains a collection of key-value pairs that specify the behavior of the scheduler."},{"content":"The <ph id=\"ph1\">`SchedulerPolicy`</ph> constructor takes a variable number of arguments.","pos":[2461,2532],"source":" The `SchedulerPolicy` constructor takes a variable number of arguments."},{"content":"The first argument is the number of policy elements that you are about to specify.","pos":[2533,2615]},{"content":"The remaining arguments are key-value pairs for each policy element.","pos":[2616,2684]},{"content":"The following example creates a <ph id=\"ph1\">`SchedulerPolicy`</ph> object that specifies three policy elements.","pos":[2685,2779],"source":" The following example creates a `SchedulerPolicy` object that specifies three policy elements."},{"content":"The runtime uses default values for the policy keys that are not specified.","pos":[2780,2855]},{"pos":[2874,2899],"content":"concrt-scheduler-policy#2"},{"content":"The <bpt id=\"p1\">[</bpt>concurrency::PolicyElementKey<ept id=\"p1\">](reference/concurrency-namespace-enums.md#policyelementkey)</ept> enumeration defines the policy keys that are associated with the Task Scheduler.","pos":[2973,3148],"source":"The [concurrency::PolicyElementKey](reference/concurrency-namespace-enums.md#policyelementkey) enumeration defines the policy keys that are associated with the Task Scheduler."},{"content":"The following table describes the policy keys and the default value that the runtime uses for each of them.","pos":[3149,3256]},{"content":"Policy Key","pos":[3263,3273]},{"content":"Description","pos":[3274,3285]},{"content":"Default Value","pos":[3286,3299]},{"pos":[3379,3532],"content":"A <bpt id=\"p1\">[</bpt>concurrency::SchedulerType<ept id=\"p1\">](reference/concurrency-namespace-enums.md#schedulertype)</ept> value that specifies the type of threads to use to schedule tasks.","source":"A [concurrency::SchedulerType](reference/concurrency-namespace-enums.md#schedulertype) value that specifies the type of threads to use to schedule tasks."},{"content":"(use normal threads).","pos":[3551,3572]},{"content":"This is the only valid value for this key.","pos":[3573,3615]},{"pos":[3637,3744],"content":"An <ph id=\"ph1\">`unsigned int`</ph> value that specifies the maximum number of concurrency resources that the scheduler uses.","source":"An `unsigned int` value that specifies the maximum number of concurrency resources that the scheduler uses."},{"content":"concurrency::MaxExecutionResources","pos":[3746,3780]},{"pos":[3872,3979],"content":"An <ph id=\"ph1\">`unsigned int`</ph> value that specifies the minimum number of concurrency resources that the scheduler uses.","source":"An `unsigned int` value that specifies the minimum number of concurrency resources that the scheduler uses."},{"pos":[4019,4115],"content":"An <ph id=\"ph1\">`unsigned int`</ph> value that specifies how many threads to allocate to each processing resource.","source":"An `unsigned int` value that specifies how many threads to allocate to each processing resource."},{"pos":[4148,4282],"content":"An <ph id=\"ph1\">`unsigned int`</ph> value that specifies the maximum number of contexts that can be cached in the local queue of each virtual processor.","source":"An `unsigned int` value that specifies the maximum number of contexts that can be cached in the local queue of each virtual processor."},{"pos":[4310,4414],"content":"An <ph id=\"ph1\">`unsigned int`</ph> value that specifies the size of the stack, in kilobytes, to reserve for each context.","source":"An `unsigned int` value that specifies the size of the stack, in kilobytes, to reserve for each context."},{"pos":[4419,4447],"content":"(use the default stack size)"},{"content":"An <ph id=\"ph1\">`int`</ph> value that specifies the thread priority of each context.","pos":[4470,4536],"source":"An `int` value that specifies the thread priority of each context."},{"content":"This can be any value that you can pass to <bpt id=\"p1\">[</bpt>SetThreadPriority<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms686277)</ept> or <ph id=\"ph1\">`INHERIT_THREAD_PRIORITY`</ph>.","pos":[4537,4689],"source":" This can be any value that you can pass to [SetThreadPriority](http://msdn.microsoft.com/library/windows/desktop/ms686277) or `INHERIT_THREAD_PRIORITY`."},{"content":"|A <bpt id=\"p1\">[</bpt>concurrency::SchedulingProtocolType<ept id=\"p1\">](reference/concurrency-namespace-enums.md#schedulingprotocoltype)</ept> value that specifies the scheduling algorithm to use.|","pos":[4740,4900],"source":"|A [concurrency::SchedulingProtocolType](reference/concurrency-namespace-enums.md#schedulingprotocoltype) value that specifies the scheduling algorithm to use.|"},{"content":"|A <bpt id=\"p1\">[</bpt>concurrency::DynamicProgressFeedbackType<ept id=\"p1\">](reference/concurrency-namespace-enums.md#dynamicprogressfeedbacktype)</ept> value that specifies whether to rebalance resources according to statistics-based progress information.","pos":[4960,5179],"source":"|A [concurrency::DynamicProgressFeedbackType](reference/concurrency-namespace-enums.md#dynamicprogressfeedbacktype) value that specifies whether to rebalance resources according to statistics-based progress information."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> Do not set this policy to <ph id=\"ph1\">`ProgressFeedbackDisabled`</ph> because it is reserved for use by the runtime.|","pos":[5192,5301],"source":"**Note** Do not set this policy to `ProgressFeedbackDisabled` because it is reserved for use by the runtime.|"},{"content":"Each scheduler uses its own policy when it schedules tasks.","pos":[5335,5394]},{"content":"The policies that are associated with one scheduler do not affect the behavior of any other scheduler.","pos":[5395,5497]},{"content":"In addition, you cannot change the scheduler policy after you create the <ph id=\"ph1\">`Scheduler`</ph> object.","pos":[5498,5590],"source":" In addition, you cannot change the scheduler policy after you create the `Scheduler` object."},{"pos":[5598,5839],"content":"[!IMPORTANT]\n Use only scheduler policies to control the attributes for threads that the runtime creates. Do not change the thread affinity or priority of threads that are created by the runtime because that might cause undefined behavior.","leadings":["","> "],"nodes":[{"content":" Use only scheduler policies to control the attributes for threads that the runtime creates. Do not change the thread affinity or priority of threads that are created by the runtime because that might cause undefined behavior.","pos":[13,239],"nodes":[{"content":"Use only scheduler policies to control the attributes for threads that the runtime creates.","pos":[1,92]},{"content":"Do not change the thread affinity or priority of threads that are created by the runtime because that might cause undefined behavior.","pos":[93,226]}]}]},{"content":"The runtime creates a default scheduler for you if you do not explicitly create one.","pos":[5846,5930]},{"content":"If you want to use the default scheduler in your application, but you want to specify a policy for that scheduler to use, call the <bpt id=\"p1\">[</bpt>concurrency::Scheduler::SetDefaultSchedulerPolicy<ept id=\"p1\">](reference/scheduler-class.md#setdefaultschedulerpolicy)</ept> method before you schedule parallel work.","pos":[5931,6211],"source":" If you want to use the default scheduler in your application, but you want to specify a policy for that scheduler to use, call the [concurrency::Scheduler::SetDefaultSchedulerPolicy](reference/scheduler-class.md#setdefaultschedulerpolicy) method before you schedule parallel work."},{"content":"If you do not call the <ph id=\"ph1\">`Scheduler::SetDefaultSchedulerPolicy`</ph> method, the runtime uses the default policy values from the table.","pos":[6212,6340],"source":" If you do not call the `Scheduler::SetDefaultSchedulerPolicy` method, the runtime uses the default policy values from the table."},{"content":"Use the <bpt id=\"p1\">[</bpt>concurrency::CurrentScheduler::GetPolicy<ept id=\"p1\">](reference/currentscheduler-class.md#getpolicy)</ept> and the <bpt id=\"p2\">[</bpt>concurrency::Scheduler::GetPolicy<ept id=\"p2\">](reference/scheduler-class.md#getpolicy)</ept> methods to retrieve a copy of the scheduler policy.","pos":[6347,6580],"source":"Use the [concurrency::CurrentScheduler::GetPolicy](reference/currentscheduler-class.md#getpolicy) and the [concurrency::Scheduler::GetPolicy](reference/scheduler-class.md#getpolicy) methods to retrieve a copy of the scheduler policy."},{"content":"The policy values that you receive from these methods can differ from the policy values that you specify when you create the scheduler.","pos":[6581,6716]},{"content":"Example","pos":[6725,6732]},{"pos":[6736,7103],"content":"To examine examples that use specific scheduler policies to control the behavior of the scheduler, see <bpt id=\"p1\">[</bpt>How to: Specify Specific Scheduler Policies<ept id=\"p1\">](../../parallel/concrt/how-to-specify-specific-scheduler-policies.md)</ept> and <bpt id=\"p2\">[</bpt>How to: Create Agents that Use Specific Scheduler Policies<ept id=\"p2\">](../../parallel/concrt/how-to-create-agents-that-use-specific-scheduler-policies.md)</ept>.","source":"To examine examples that use specific scheduler policies to control the behavior of the scheduler, see [How to: Specify Specific Scheduler Policies](../../parallel/concrt/how-to-specify-specific-scheduler-policies.md) and [How to: Create Agents that Use Specific Scheduler Policies](../../parallel/concrt/how-to-create-agents-that-use-specific-scheduler-policies.md)."},{"content":"See Also","pos":[7112,7120]},{"content":"Task Scheduler","pos":[7125,7139]},{"content":"How to: Specify Specific Scheduler Policies","pos":[7207,7250]},{"content":"How to: Create Agents that Use Specific Scheduler Policies","pos":[7326,7384]}],"content":"---\ntitle: \"Scheduler Policies | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"scheduler policies\"\nms.assetid: 58fb68bd-4a57-40a8-807b-6edb6f083cd9\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Scheduler Policies\nThis document describes the role of scheduler policies in the Concurrency Runtime. A *scheduler policy* controls the strategy that the scheduler uses when it manages tasks. For example, consider an application that requires some tasks to execute at `THREAD_PRIORITY_NORMAL` and other tasks to execute at `THREAD_PRIORITY_HIGHEST`.  You can create two scheduler instances: one that specifies the `ContextPriority` policy to be `THREAD_PRIORITY_NORMAL` and another that specifies the same policy to be `THREAD_PRIORITY_HIGHEST`.  \n  \n By using scheduler policies, you can divide the available processing resources and assign a fixed set of resources to each scheduler. For example, consider a parallel algorithm that does not scale beyond four processors. You can create a scheduler policy that limits its tasks to use no more than four processors concurrently.  \n  \n> [!TIP]\n>  The Concurrency Runtime provides a default scheduler. Therefore, you don't have to create one in your application. Because the Task Scheduler helps you fine-tune the performance of your applications, we recommend that you start with the [Parallel Patterns Library (PPL)](../../parallel/concrt/parallel-patterns-library-ppl.md) or the [Asynchronous Agents Library](../../parallel/concrt/asynchronous-agents-library.md) if you are new to the Concurrency Runtime.  \n  \n When you use the [concurrency::CurrentScheduler::Create](reference/currentscheduler-class.md#create), [concurrency::Scheduler::Create](reference/scheduler-class.md#create), or [concurrency::Scheduler::SetDefaultSchedulerPolicy](reference/scheduler-class.md#setdefaultschedulerpolicy) method to create a scheduler instance, you provide a [concurrency::SchedulerPolicy](../../parallel/concrt/reference/schedulerpolicy-class.md) object that contains a collection of key-value pairs that specify the behavior of the scheduler. The `SchedulerPolicy` constructor takes a variable number of arguments. The first argument is the number of policy elements that you are about to specify. The remaining arguments are key-value pairs for each policy element. The following example creates a `SchedulerPolicy` object that specifies three policy elements. The runtime uses default values for the policy keys that are not specified.  \n\n  \n [!code-cpp[concrt-scheduler-policy#2](../../parallel/concrt/codesnippet/cpp/scheduler-policies_1.cpp)]  \n  \n\n The [concurrency::PolicyElementKey](reference/concurrency-namespace-enums.md#policyelementkey) enumeration defines the policy keys that are associated with the Task Scheduler. The following table describes the policy keys and the default value that the runtime uses for each of them.  \n  \n|Policy Key|Description|Default Value|  \n|----------------|-----------------|-------------------|  \n|`SchedulerKind`|A [concurrency::SchedulerType](reference/concurrency-namespace-enums.md#schedulertype) value that specifies the type of threads to use to schedule tasks.|`ThreadScheduler` (use normal threads). This is the only valid value for this key.|  \n|`MaxConcurrency`|An `unsigned int` value that specifies the maximum number of concurrency resources that the scheduler uses.|[concurrency::MaxExecutionResources](reference/concurrency-namespace-constants1.md#maxexecutionresources)|  \n|`MinConcurrency`|An `unsigned int` value that specifies the minimum number of concurrency resources that the scheduler uses.|`1`|  \n|`TargetOversubscriptionFactor`|An `unsigned int` value that specifies how many threads to allocate to each processing resource.|`1`|  \n|`LocalContextCacheSize`|An `unsigned int` value that specifies the maximum number of contexts that can be cached in the local queue of each virtual processor.|`8`|  \n|`ContextStackSize`|An `unsigned int` value that specifies the size of the stack, in kilobytes, to reserve for each context.|`0` (use the default stack size)|  \n|`ContextPriority`|An `int` value that specifies the thread priority of each context. This can be any value that you can pass to [SetThreadPriority](http://msdn.microsoft.com/library/windows/desktop/ms686277) or `INHERIT_THREAD_PRIORITY`.|`THREAD_PRIORITY_NORMAL`|  \n\n|`SchedulingProtocol`|A [concurrency::SchedulingProtocolType](reference/concurrency-namespace-enums.md#schedulingprotocoltype) value that specifies the scheduling algorithm to use.|`EnhanceScheduleGroupLocality`|  \n|`DynamicProgressFeedback`|A [concurrency::DynamicProgressFeedbackType](reference/concurrency-namespace-enums.md#dynamicprogressfeedbacktype) value that specifies whether to rebalance resources according to statistics-based progress information.<br /><br /> **Note** Do not set this policy to `ProgressFeedbackDisabled` because it is reserved for use by the runtime.|`ProgressFeedbackEnabled`|  \n\n  \n Each scheduler uses its own policy when it schedules tasks. The policies that are associated with one scheduler do not affect the behavior of any other scheduler. In addition, you cannot change the scheduler policy after you create the `Scheduler` object.  \n  \n> [!IMPORTANT]\n>  Use only scheduler policies to control the attributes for threads that the runtime creates. Do not change the thread affinity or priority of threads that are created by the runtime because that might cause undefined behavior.  \n  \n The runtime creates a default scheduler for you if you do not explicitly create one. If you want to use the default scheduler in your application, but you want to specify a policy for that scheduler to use, call the [concurrency::Scheduler::SetDefaultSchedulerPolicy](reference/scheduler-class.md#setdefaultschedulerpolicy) method before you schedule parallel work. If you do not call the `Scheduler::SetDefaultSchedulerPolicy` method, the runtime uses the default policy values from the table.  \n  \n Use the [concurrency::CurrentScheduler::GetPolicy](reference/currentscheduler-class.md#getpolicy) and the [concurrency::Scheduler::GetPolicy](reference/scheduler-class.md#getpolicy) methods to retrieve a copy of the scheduler policy. The policy values that you receive from these methods can differ from the policy values that you specify when you create the scheduler.  \n  \n## Example  \n To examine examples that use specific scheduler policies to control the behavior of the scheduler, see [How to: Specify Specific Scheduler Policies](../../parallel/concrt/how-to-specify-specific-scheduler-policies.md) and [How to: Create Agents that Use Specific Scheduler Policies](../../parallel/concrt/how-to-create-agents-that-use-specific-scheduler-policies.md).  \n  \n## See Also  \n [Task Scheduler](../../parallel/concrt/task-scheduler-concurrency-runtime.md)   \n [How to: Specify Specific Scheduler Policies](../../parallel/concrt/how-to-specify-specific-scheduler-policies.md)   \n [How to: Create Agents that Use Specific Scheduler Policies](../../parallel/concrt/how-to-create-agents-that-use-specific-scheduler-policies.md)\n\n"}