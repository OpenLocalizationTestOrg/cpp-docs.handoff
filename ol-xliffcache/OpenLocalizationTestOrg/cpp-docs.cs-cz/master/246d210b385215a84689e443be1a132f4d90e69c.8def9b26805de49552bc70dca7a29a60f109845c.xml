{"nodes":[{"pos":[12,55],"content":"CComCompositeControl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComCompositeControl Class | Microsoft Docs","pos":[0,43]}]},{"pos":[819,845],"content":"CComCompositeControl Class","linkify":"CComCompositeControl Class","nodes":[{"content":"CComCompositeControl Class","pos":[0,26]}]},{"content":"This class provides the methods required to implement a composite control.","pos":[846,920]},{"pos":[928,1038],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"pos":[1047,1053],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1166,1176],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Your class, derived from <bpt id=\"p1\">[</bpt>CComObjectRoot<ept id=\"p1\">](../../atl/reference/ccomobjectroot-class.md)</ept> or <bpt id=\"p2\">[</bpt>CComObjectRootEx<ept id=\"p2\">](../../atl/reference/ccomobjectrootex-class.md)</ept>, as well as from any other interfaces you want to support for your composite control.","pos":[1187,1428],"source":" Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md), as well as from any other interfaces you want to support for your composite control."},{"pos":[1437,1444],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1454,1473],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1480,1484]},{"content":"Description","pos":[1485,1496]},{"pos":[1534,1623],"content":"<bpt id=\"p1\">[</bpt>CComCompositeControl::CComCompositeControl<ept id=\"p1\">](#ccomcompositecontrol__ccomcompositecontrol)</ept>","source":"[CComCompositeControl::CComCompositeControl](#ccomcompositecontrol__ccomcompositecontrol)"},{"content":"The constructor.","pos":[1624,1640]},{"pos":[1645,1740],"content":"<bpt id=\"p1\">[</bpt>CComCompositeControl::~CComCompositeControl<ept id=\"p1\">](#ccomcompositecontrol___dtorccomcompositecontrol)</ept>","source":"[CComCompositeControl::~CComCompositeControl](#ccomcompositecontrol___dtorccomcompositecontrol)"},{"content":"The destructor.","pos":[1741,1756]},{"pos":[1767,1781],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1788,1792]},{"content":"Description","pos":[1793,1804]},{"pos":[1842,1917],"content":"<bpt id=\"p1\">[</bpt>CComCompositeControl::AdviseSinkMap<ept id=\"p1\">](#ccomcompositecontrol__advisesinkmap)</ept>","source":"[CComCompositeControl::AdviseSinkMap](#ccomcompositecontrol__advisesinkmap)"},{"content":"Call this method to advise or unadvise all controls hosted by the composite control.","pos":[1918,2002]},{"pos":[2007,2076],"content":"<bpt id=\"p1\">[</bpt>CComCompositeControl::CalcExtent<ept id=\"p1\">](#ccomcompositecontrol__calcextent)</ept>","source":"[CComCompositeControl::CalcExtent](#ccomcompositecontrol__calcextent)"},{"pos":[2077,2196],"content":"Call this method to calculate the size in <bpt id=\"p1\">**</bpt>HIMETRIC<ept id=\"p1\">**</ept> units of the dialog resource used to host the composite control.","source":"Call this method to calculate the size in **HIMETRIC** units of the dialog resource used to host the composite control."},{"pos":[2201,2262],"content":"<bpt id=\"p1\">[</bpt>CComCompositeControl::Create<ept id=\"p1\">](#ccomcompositecontrol__create)</ept>","source":"[CComCompositeControl::Create](#ccomcompositecontrol__create)"},{"content":"This method is called to create the control window for the composite control.","pos":[2263,2340]},{"pos":[2345,2432],"content":"<bpt id=\"p1\">[</bpt>CComCompositeControl::CreateControlWindow<ept id=\"p1\">](#ccomcompositecontrol__createcontrolwindow)</ept>","source":"[CComCompositeControl::CreateControlWindow](#ccomcompositecontrol__createcontrolwindow)"},{"content":"Call this method to create the control window and advise any hosted control.","pos":[2433,2509]},{"pos":[2514,2621],"content":"<bpt id=\"p1\">[</bpt>CComCompositeControl::SetBackgroundColorFromAmbient<ept id=\"p1\">](#ccomcompositecontrol__setbackgroundcolorfromambient)</ept>","source":"[CComCompositeControl::SetBackgroundColorFromAmbient](#ccomcompositecontrol__setbackgroundcolorfromambient)"},{"content":"Call this method to set the background color of the composite control using the container's background color.","pos":[2622,2731]},{"pos":[2742,2761],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[2768,2772]},{"content":"Description","pos":[2773,2784]},{"pos":[2822,2901],"content":"<bpt id=\"p1\">[</bpt>CComCompositeControl::m_hbrBackground<ept id=\"p1\">](#ccomcompositecontrol__m_hbrbackground)</ept>","source":"[CComCompositeControl::m_hbrBackground](#ccomcompositecontrol__m_hbrbackground)"},{"content":"The background brush.","pos":[2902,2923]},{"pos":[2928,2999],"content":"<bpt id=\"p1\">[</bpt>CComCompositeControl::m_hWndFocus<ept id=\"p1\">](#ccomcompositecontrol__m_hwndfocus)</ept>","source":"[CComCompositeControl::m_hWndFocus](#ccomcompositecontrol__m_hwndfocus)"},{"content":"The handle of the window that currently has focus.","pos":[3000,3050]},{"pos":[3060,3067],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Classes derived from class <ph id=\"ph1\">`CComCompositeControl`</ph> inherit the functionality of an ActiveX composite control.","pos":[3071,3179],"source":"Classes derived from class `CComCompositeControl` inherit the functionality of an ActiveX composite control."},{"content":"ActiveX controls derived from <ph id=\"ph1\">`CComCompositeControl`</ph> are hosted by a standard dialog box.","pos":[3180,3269],"source":" ActiveX controls derived from `CComCompositeControl` are hosted by a standard dialog box."},{"content":"These types of controls are called composite controls because they are able to host other controls (native Windows controls and ActiveX controls).","pos":[3270,3416]},{"content":"<ph id=\"ph1\">`CComCompositeControl`</ph> identifies the dialog resource to use in creating the composite control by looking for an enumerated data member in the child class.","pos":[3423,3578],"source":"`CComCompositeControl` identifies the dialog resource to use in creating the composite control by looking for an enumerated data member in the child class."},{"content":"The member IDD of this child class is set to the resource ID of the dialog resource that will be used as the control's window.","pos":[3579,3705]},{"content":"The following is an example of the data member that the class derived from <ph id=\"ph1\">`CComCompositeControl`</ph> should contain to identify the dialog resource to be used for the control's window:","pos":[3706,3887],"source":" The following is an example of the data member that the class derived from `CComCompositeControl` should contain to identify the dialog resource to be used for the control's window:"},{"pos":[3894,3979],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_ATL_COM#13<ept id=\"p2\">](../../atl/codesnippet/cpp/ccomcompositecontrol-class_1.h)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_ATL_COM#13](../../atl/codesnippet/cpp/ccomcompositecontrol-class_1.h)]"},{"pos":[3987,4093],"content":"[!NOTE]\n Composite controls are always windowed controls, although they can contain windowless controls.","leadings":["","> "],"nodes":[{"content":"Composite controls are always windowed controls, although they can contain windowless controls.","pos":[9,104]}]},{"content":"A control implemented by a <ph id=\"ph1\">`CComCompositeControl`</ph>-derived class has default tabbing behavior built in.","pos":[4100,4202],"source":"A control implemented by a `CComCompositeControl`-derived class has default tabbing behavior built in."},{"content":"When the control receives focus by being tabbed to in a containing application, successively pressing the TAB key will cause the focus to be cycled through all of the composite control's contained controls, then out of the composite control and on to the next item in the tab order of the container.","pos":[4203,4502]},{"content":"The tab order of the hosted controls is determined by the dialog resource and determines the order in which tabbing will occur.","pos":[4503,4630]},{"pos":[4638,5020],"content":"[!NOTE]\n In order for accelerators to work properly with a `CComCompositeControl`, it is necessary to load an accelerator table as the control is created, pass the handle and number of accelerators back into [IOleControlImpl::GetControlInfo](../../atl/reference/iolecontrolimpl-class.md#iolecontrolimpl__getcontrolinfo), and finally destroy the table when the control is released.","leadings":["","> "],"nodes":[{"content":"In order for accelerators to work properly with a <ph id=\"ph1\">`CComCompositeControl`</ph>, it is necessary to load an accelerator table as the control is created, pass the handle and number of accelerators back into <bpt id=\"p1\">[</bpt>IOleControlImpl::GetControlInfo<ept id=\"p1\">](../../atl/reference/iolecontrolimpl-class.md#iolecontrolimpl__getcontrolinfo)</ept>, and finally destroy the table when the control is released.","pos":[9,380],"source":" In order for accelerators to work properly with a `CComCompositeControl`, it is necessary to load an accelerator table as the control is created, pass the handle and number of accelerators back into [IOleControlImpl::GetControlInfo](../../atl/reference/iolecontrolimpl-class.md#iolecontrolimpl__getcontrolinfo), and finally destroy the table when the control is released."}]},{"pos":[5029,5036],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5040,5125],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_ATL_COM#14<ept id=\"p2\">](../../atl/codesnippet/cpp/ccomcompositecontrol-class_2.h)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_ATL_COM#14](../../atl/codesnippet/cpp/ccomcompositecontrol-class_2.h)]"},{"pos":[5134,5155],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[5175,5238],"content":"<bpt id=\"p1\">[</bpt>CComControlBase<ept id=\"p1\">](../../atl/reference/ccomcontrolbase-class.md)</ept>","source":"[CComControlBase](../../atl/reference/ccomcontrolbase-class.md)"},{"pos":[5245,5300],"content":"<bpt id=\"p1\">[</bpt>CComControl<ept id=\"p1\">](../../atl/reference/ccomcontrol-class.md)</ept>","source":"[CComControl](../../atl/reference/ccomcontrol-class.md)"},{"pos":[5338,5350],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[5354,5374],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlctl.h","source":"**Header:** atlctl.h"},{"pos":[5384,5471],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcompositecontrol__advisesinkmap\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCompositeControl::AdviseSinkMap","linkify":"<a name=\"ccomcompositecontrol__advisesinkmap\"></a>  CComCompositeControl::AdviseSinkMap","source":"<a name=\"ccomcompositecontrol__advisesinkmap\"></a>  CComCompositeControl::AdviseSinkMap"},{"content":"Call this method to advise or unadvise all controls hosted by the composite control.","pos":[5475,5559]},{"pos":[5619,5629],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"True if all controls are to be advised; otherwise false.","pos":[5646,5702]},{"pos":[5712,5724],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"All controls in the event sink map were connected or disconnected from their event source successfully.","pos":[5738,5841]},{"content":"<bpt id=\"p1\">**</bpt>E_FAIL<ept id=\"p1\">**</ept>","pos":[5848,5858],"source":"**E_FAIL**"},{"content":"Not all controls in the event sink map could be connected or disconnected from their event source successfully.","pos":[5862,5973]},{"content":"This error usually indicates a problem with an entry in the control's event sink map or a problem with a template argument used in an <ph id=\"ph1\">`IDispEventImpl`</ph> or <ph id=\"ph2\">`IDispEventSimpleImpl`</ph> base class.","pos":[5995,6183],"source":" This error usually indicates a problem with an entry in the control's event sink map or a problem with a template argument used in an `IDispEventImpl` or `IDispEventSimpleImpl` base class."},{"content":"<bpt id=\"p1\">**</bpt>CONNECT_E_ADVISELIMIT<ept id=\"p1\">**</ept>","pos":[6190,6215],"source":"**CONNECT_E_ADVISELIMIT**"},{"content":"The connection point has already reached its limit of connections and cannot accept any more.","pos":[6219,6312]},{"content":"<bpt id=\"p1\">**</bpt>CONNECT_E_CANNOTCONNECT<ept id=\"p1\">**</ept>","pos":[6319,6346],"source":"**CONNECT_E_CANNOTCONNECT**"},{"content":"The sink does not support the interface required by this connection point.","pos":[6350,6424]},{"content":"<bpt id=\"p1\">**</bpt>CONNECT_E_NOCONNECTION<ept id=\"p1\">**</ept>","pos":[6431,6457],"source":"**CONNECT_E_NOCONNECTION**"},{"content":"The cookie value does not represent a valid connection.","pos":[6461,6516]},{"content":"This error usually indicates a problem with an entry in the control's event sink map or a problem with a template argument used in an <ph id=\"ph1\">`IDispEventImpl`</ph> or <ph id=\"ph2\">`IDispEventSimpleImpl`</ph> base class.","pos":[6517,6705],"source":" This error usually indicates a problem with an entry in the control's event sink map or a problem with a template argument used in an `IDispEventImpl` or `IDispEventSimpleImpl` base class."},{"pos":[6715,6722],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The base implementation of this method searches through the entries in the event sink map.","pos":[6726,6816]},{"content":"It then advises or unadvises the connection points to the COM objects described by the event sink map's sink entries.","pos":[6817,6934]},{"content":"This member method also relies on the fact that the derived class inherits from one instance of <ph id=\"ph1\">`IDispEventImpl`</ph> for every control in the sink map that is to be advised or unadvised.","pos":[6935,7117],"source":" This member method also relies on the fact that the derived class inherits from one instance of `IDispEventImpl` for every control in the sink map that is to be advised or unadvised."},{"pos":[7127,7208],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcompositecontrol__calcextent\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCompositeControl::CalcExtent","linkify":"<a name=\"ccomcompositecontrol__calcextent\"></a>  CComCompositeControl::CalcExtent","source":"<a name=\"ccomcompositecontrol__calcextent\"></a>  CComCompositeControl::CalcExtent"},{"pos":[7212,7331],"content":"Call this method to calculate the size in <bpt id=\"p1\">**</bpt>HIMETRIC<ept id=\"p1\">**</ept> units of the dialog resource used to host the composite control.","source":"Call this method to calculate the size in **HIMETRIC** units of the dialog resource used to host the composite control."},{"pos":[7383,7393],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A reference to a <bpt id=\"p1\">**</bpt>SIZE<ept id=\"p1\">**</ept> structure to be filled by this method.","pos":[7407,7471],"source":" A reference to a **SIZE** structure to be filled by this method."},{"pos":[7481,7493],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"TRUE if the control is hosted by a dialog box; otherwise FALSE.","pos":[7497,7560]},{"pos":[7570,7577],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7581,7626],"content":"The size is returned in the <ph id=\"ph1\">`size`</ph> parameter.","source":"The size is returned in the `size` parameter."},{"pos":[7636,7709],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcompositecontrol__create\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCompositeControl::Create","linkify":"<a name=\"ccomcompositecontrol__create\"></a>  CComCompositeControl::Create","source":"<a name=\"ccomcompositecontrol__create\"></a>  CComCompositeControl::Create"},{"content":"This method is called to create the control window for the composite control.","pos":[7713,7790]},{"pos":[7897,7907],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A handle to the parent window of the control.","pos":[7927,7972]},{"content":"Reserved.","pos":[7990,7999]},{"content":"Data to be passed to the control during control creation.","pos":[8023,8080]},{"content":"The data passed as <ph id=\"ph1\">`dwInitParam`</ph> will show up as the <bpt id=\"p1\">**</bpt>LPARAM<ept id=\"p1\">**</ept> parameter of the <bpt id=\"p2\">[</bpt>WM_INITDIALOG<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms645428)</ept> message, which will be sent to the composite control when it gets created.","pos":[8081,8312],"source":" The data passed as `dwInitParam` will show up as the **LPARAM** parameter of the [WM_INITDIALOG](http://msdn.microsoft.com/library/windows/desktop/ms645428) message, which will be sent to the composite control when it gets created."},{"pos":[8322,8334],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A handle to the newly created composite control dialog box.","pos":[8338,8397]},{"pos":[8407,8414],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This method is usually called during in-place activation of the control.","pos":[8418,8490]},{"pos":[8500,8601],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcompositecontrol__ccomcompositecontrol\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCompositeControl::CComCompositeControl","linkify":"<a name=\"ccomcompositecontrol__ccomcompositecontrol\"></a>  CComCompositeControl::CComCompositeControl","source":"<a name=\"ccomcompositecontrol__ccomcompositecontrol\"></a>  CComCompositeControl::CComCompositeControl"},{"content":"The constructor.","pos":[8605,8621]},{"pos":[8668,8675],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[8679,8872],"content":"Initializes the <bpt id=\"p1\">[</bpt>CComCompositeControl::m_hbrBackground<ept id=\"p1\">](#ccomcompositecontrol__m_hbrbackground)</ept> and <bpt id=\"p2\">[</bpt>CComCompositeControl::m_hWndFocus<ept id=\"p2\">](#ccomcompositecontrol__m_hwndfocus)</ept> data members to NULL.","source":"Initializes the [CComCompositeControl::m_hbrBackground](#ccomcompositecontrol__m_hbrbackground) and [CComCompositeControl::m_hWndFocus](#ccomcompositecontrol__m_hwndfocus) data members to NULL."},{"pos":[8882,8989],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcompositecontrol___dtorccomcompositecontrol\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCompositeControl::~CComCompositeControl","linkify":"<a name=\"ccomcompositecontrol___dtorccomcompositecontrol\"></a>  CComCompositeControl::~CComCompositeControl","source":"<a name=\"ccomcompositecontrol___dtorccomcompositecontrol\"></a>  CComCompositeControl::~CComCompositeControl"},{"content":"The destructor.","pos":[8993,9008]},{"pos":[9056,9063],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Deletes the background object, if it exists.","pos":[9067,9111]},{"pos":[9121,9220],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcompositecontrol__createcontrolwindow\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCompositeControl::CreateControlWindow","linkify":"<a name=\"ccomcompositecontrol__createcontrolwindow\"></a>  CComCompositeControl::CreateControlWindow","source":"<a name=\"ccomcompositecontrol__createcontrolwindow\"></a>  CComCompositeControl::CreateControlWindow"},{"content":"Call this method to create the control window and advise any hosted controls.","pos":[9224,9301]},{"pos":[9392,9402],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A handle to the parent window of the control.","pos":[9422,9467]},{"content":"The position rectangle of the composite control in client coordinates relative to <ph id=\"ph1\">`hWndParent`</ph>.","pos":[9485,9580],"source":" The position rectangle of the composite control in client coordinates relative to `hWndParent`."},{"pos":[9590,9602],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns a handle to the newly created composite control dialog box.","pos":[9606,9673]},{"pos":[9683,9690],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[9694,9854],"content":"This method calls <bpt id=\"p1\">[</bpt>CComCompositeControl::Create<ept id=\"p1\">](#ccomcompositecontrol__create)</ept> and <bpt id=\"p2\">[</bpt>CComCompositeControl::AdviseSinkMap<ept id=\"p2\">](#ccomcompositecontrol__advisesinkmap)</ept>.","source":"This method calls [CComCompositeControl::Create](#ccomcompositecontrol__create) and [CComCompositeControl::AdviseSinkMap](#ccomcompositecontrol__advisesinkmap)."},{"pos":[9864,9955],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcompositecontrol__m_hbrbackground\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCompositeControl::m_hbrBackground","linkify":"<a name=\"ccomcompositecontrol__m_hbrbackground\"></a>  CComCompositeControl::m_hbrBackground","source":"<a name=\"ccomcompositecontrol__m_hbrbackground\"></a>  CComCompositeControl::m_hbrBackground"},{"content":"The background brush.","pos":[9959,9980]},{"pos":[10027,10110],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcompositecontrol__m_hwndfocus\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCompositeControl::m_hWndFocus","linkify":"<a name=\"ccomcompositecontrol__m_hwndfocus\"></a>  CComCompositeControl::m_hWndFocus","source":"<a name=\"ccomcompositecontrol__m_hwndfocus\"></a>  CComCompositeControl::m_hWndFocus"},{"content":"The handle of the window that currently has focus.","pos":[10114,10164]},{"pos":[10205,10324],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcompositecontrol__setbackgroundcolorfromambient\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCompositeControl::SetBackgroundColorFromAmbient","linkify":"<a name=\"ccomcompositecontrol__setbackgroundcolorfromambient\"></a>  CComCompositeControl::SetBackgroundColorFromAmbient","source":"<a name=\"ccomcompositecontrol__setbackgroundcolorfromambient\"></a>  CComCompositeControl::SetBackgroundColorFromAmbient"},{"content":"Call this method to set the background color of the composite control using the container's background color.","pos":[10328,10437]},{"pos":[10501,10513],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[10517,10573]},{"pos":[10582,10590],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CComControl Class<ept id=\"p1\">](../../atl/reference/ccomcontrol-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[10594,10656],"source":"[CComControl Class](../../atl/reference/ccomcontrol-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Composite Control Fundamentals<ept id=\"p1\">](../../atl/atl-composite-control-fundamentals.md)</ept><ph id=\"ph1\"> </ph>","pos":[10659,10742],"source":" [Composite Control Fundamentals](../../atl/atl-composite-control-fundamentals.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","pos":[10745,10795],"source":" [Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"CComCompositeControl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CComCompositeControl\"\n  - \"ATL::CComCompositeControl\"\n  - \"ATL.CComCompositeControl<T>\"\n  - \"ATL.CComCompositeControl\"\n  - \"ATL::CComCompositeControl<T>\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CComCompositeControl class\"\n  - \"composite controls, CComCompositeControl class\"\nms.assetid: 1304b931-27e8-4fbc-be8e-bb226ad887fb\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComCompositeControl Class\nThis class provides the methods required to implement a composite control.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\ntemplate <class T>  class CComCompositeControl :  public CComControl<T,CAxDialogImpl<T>>\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md), as well as from any other interfaces you want to support for your composite control.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComCompositeControl::CComCompositeControl](#ccomcompositecontrol__ccomcompositecontrol)|The constructor.|  \n|[CComCompositeControl::~CComCompositeControl](#ccomcompositecontrol___dtorccomcompositecontrol)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComCompositeControl::AdviseSinkMap](#ccomcompositecontrol__advisesinkmap)|Call this method to advise or unadvise all controls hosted by the composite control.|  \n|[CComCompositeControl::CalcExtent](#ccomcompositecontrol__calcextent)|Call this method to calculate the size in **HIMETRIC** units of the dialog resource used to host the composite control.|  \n|[CComCompositeControl::Create](#ccomcompositecontrol__create)|This method is called to create the control window for the composite control.|  \n|[CComCompositeControl::CreateControlWindow](#ccomcompositecontrol__createcontrolwindow)|Call this method to create the control window and advise any hosted control.|  \n|[CComCompositeControl::SetBackgroundColorFromAmbient](#ccomcompositecontrol__setbackgroundcolorfromambient)|Call this method to set the background color of the composite control using the container's background color.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComCompositeControl::m_hbrBackground](#ccomcompositecontrol__m_hbrbackground)|The background brush.|  \n|[CComCompositeControl::m_hWndFocus](#ccomcompositecontrol__m_hwndfocus)|The handle of the window that currently has focus.|  \n  \n## Remarks  \n Classes derived from class `CComCompositeControl` inherit the functionality of an ActiveX composite control. ActiveX controls derived from `CComCompositeControl` are hosted by a standard dialog box. These types of controls are called composite controls because they are able to host other controls (native Windows controls and ActiveX controls).  \n  \n `CComCompositeControl` identifies the dialog resource to use in creating the composite control by looking for an enumerated data member in the child class. The member IDD of this child class is set to the resource ID of the dialog resource that will be used as the control's window. The following is an example of the data member that the class derived from `CComCompositeControl` should contain to identify the dialog resource to be used for the control's window:  \n  \n [!code-cpp[NVC_ATL_COM#13](../../atl/codesnippet/cpp/ccomcompositecontrol-class_1.h)]  \n  \n> [!NOTE]\n>  Composite controls are always windowed controls, although they can contain windowless controls.  \n  \n A control implemented by a `CComCompositeControl`-derived class has default tabbing behavior built in. When the control receives focus by being tabbed to in a containing application, successively pressing the TAB key will cause the focus to be cycled through all of the composite control's contained controls, then out of the composite control and on to the next item in the tab order of the container. The tab order of the hosted controls is determined by the dialog resource and determines the order in which tabbing will occur.  \n  \n> [!NOTE]\n>  In order for accelerators to work properly with a `CComCompositeControl`, it is necessary to load an accelerator table as the control is created, pass the handle and number of accelerators back into [IOleControlImpl::GetControlInfo](../../atl/reference/iolecontrolimpl-class.md#iolecontrolimpl__getcontrolinfo), and finally destroy the table when the control is released.  \n  \n## Example  \n [!code-cpp[NVC_ATL_COM#14](../../atl/codesnippet/cpp/ccomcompositecontrol-class_2.h)]  \n  \n## Inheritance Hierarchy  \n `WinBase`  \n  \n [CComControlBase](../../atl/reference/ccomcontrolbase-class.md)  \n  \n [CComControl](../../atl/reference/ccomcontrol-class.md)  \n  \n `CComCompositeControl`  \n  \n## Requirements  \n **Header:** atlctl.h  \n  \n##  <a name=\"ccomcompositecontrol__advisesinkmap\"></a>  CComCompositeControl::AdviseSinkMap  \n Call this method to advise or unadvise all controls hosted by the composite control.  \n  \n```\nHRESULT AdviseSinkMap(bool bAdvise);\n```  \n  \n### Parameters  \n `bAdvise`  \n True if all controls are to be advised; otherwise false.  \n  \n### Return Value  \n `S_OK`  \n All controls in the event sink map were connected or disconnected from their event source successfully.  \n  \n **E_FAIL**  \n Not all controls in the event sink map could be connected or disconnected from their event source successfully.  \n  \n `E_POINTER`  \n This error usually indicates a problem with an entry in the control's event sink map or a problem with a template argument used in an `IDispEventImpl` or `IDispEventSimpleImpl` base class.  \n  \n **CONNECT_E_ADVISELIMIT**  \n The connection point has already reached its limit of connections and cannot accept any more.  \n  \n **CONNECT_E_CANNOTCONNECT**  \n The sink does not support the interface required by this connection point.  \n  \n **CONNECT_E_NOCONNECTION**  \n The cookie value does not represent a valid connection. This error usually indicates a problem with an entry in the control's event sink map or a problem with a template argument used in an `IDispEventImpl` or `IDispEventSimpleImpl` base class.  \n  \n### Remarks  \n The base implementation of this method searches through the entries in the event sink map. It then advises or unadvises the connection points to the COM objects described by the event sink map's sink entries. This member method also relies on the fact that the derived class inherits from one instance of `IDispEventImpl` for every control in the sink map that is to be advised or unadvised.  \n  \n##  <a name=\"ccomcompositecontrol__calcextent\"></a>  CComCompositeControl::CalcExtent  \n Call this method to calculate the size in **HIMETRIC** units of the dialog resource used to host the composite control.  \n  \n```\nBOOL CalcExtent(SIZE& size);\n```  \n  \n### Parameters  \n `size`  \n A reference to a **SIZE** structure to be filled by this method.  \n  \n### Return Value  \n TRUE if the control is hosted by a dialog box; otherwise FALSE.  \n  \n### Remarks  \n The size is returned in the `size` parameter.  \n  \n##  <a name=\"ccomcompositecontrol__create\"></a>  CComCompositeControl::Create  \n This method is called to create the control window for the composite control.  \n  \n```\nHWND Create(HWND hWndParent,\n    RECT& /* rcPos */,\n    LPARAM dwInitParam = NULL);\n```  \n  \n### Parameters  \n `hWndParent`  \n A handle to the parent window of the control.  \n  \n `rcPos`  \n Reserved.  \n  \n `dwInitParam`  \n Data to be passed to the control during control creation. The data passed as `dwInitParam` will show up as the **LPARAM** parameter of the [WM_INITDIALOG](http://msdn.microsoft.com/library/windows/desktop/ms645428) message, which will be sent to the composite control when it gets created.  \n  \n### Return Value  \n A handle to the newly created composite control dialog box.  \n  \n### Remarks  \n This method is usually called during in-place activation of the control.  \n  \n##  <a name=\"ccomcompositecontrol__ccomcompositecontrol\"></a>  CComCompositeControl::CComCompositeControl  \n The constructor.  \n  \n```\nCComCompositeControl();\n```  \n  \n### Remarks  \n Initializes the [CComCompositeControl::m_hbrBackground](#ccomcompositecontrol__m_hbrbackground) and [CComCompositeControl::m_hWndFocus](#ccomcompositecontrol__m_hwndfocus) data members to NULL.  \n  \n##  <a name=\"ccomcompositecontrol___dtorccomcompositecontrol\"></a>  CComCompositeControl::~CComCompositeControl  \n The destructor.  \n  \n```\n~CComCompositeControl();\n```  \n  \n### Remarks  \n Deletes the background object, if it exists.  \n  \n##  <a name=\"ccomcompositecontrol__createcontrolwindow\"></a>  CComCompositeControl::CreateControlWindow  \n Call this method to create the control window and advise any hosted controls.  \n  \n```\nvirtual HWND CreateControlWindow(HWND hWndParent,\n    RECT& rcPos);\n```  \n  \n### Parameters  \n `hWndParent`  \n A handle to the parent window of the control.  \n  \n `rcPos`  \n The position rectangle of the composite control in client coordinates relative to `hWndParent`.  \n  \n### Return Value  \n Returns a handle to the newly created composite control dialog box.  \n  \n### Remarks  \n This method calls [CComCompositeControl::Create](#ccomcompositecontrol__create) and [CComCompositeControl::AdviseSinkMap](#ccomcompositecontrol__advisesinkmap).  \n  \n##  <a name=\"ccomcompositecontrol__m_hbrbackground\"></a>  CComCompositeControl::m_hbrBackground  \n The background brush.  \n  \n```\nHBRUSH m_hbrBackground;\n```  \n  \n##  <a name=\"ccomcompositecontrol__m_hwndfocus\"></a>  CComCompositeControl::m_hWndFocus  \n The handle of the window that currently has focus.  \n  \n```\nHWND m_hWndFocus;\n```  \n  \n##  <a name=\"ccomcompositecontrol__setbackgroundcolorfromambient\"></a>  CComCompositeControl::SetBackgroundColorFromAmbient  \n Call this method to set the background color of the composite control using the container's background color.  \n  \n```\nHRESULT SetBackgroundColorFromAmbient();\n```  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n## See Also  \n [CComControl Class](../../atl/reference/ccomcontrol-class.md)   \n [Composite Control Fundamentals](../../atl/atl-composite-control-fundamentals.md)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}