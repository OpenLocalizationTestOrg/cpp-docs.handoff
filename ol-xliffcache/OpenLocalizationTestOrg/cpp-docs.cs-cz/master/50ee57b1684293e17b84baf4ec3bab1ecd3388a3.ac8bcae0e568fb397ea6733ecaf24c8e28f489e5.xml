{"nodes":[{"pos":[12,48],"content":"CPropExchange Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CPropExchange Class | Microsoft Docs","pos":[0,36]}]},{"content":"CPropExchange Class","pos":[671,690]},{"content":"Supports the implementation of persistence for your OLE controls.","pos":[691,756]},{"content":"Syntax","pos":[765,771]},{"content":"Members","pos":[830,837]},{"content":"Public Methods","pos":[847,861]},{"content":"Name","pos":[868,872]},{"content":"Description","pos":[873,884]},{"content":"CPropExchange::ExchangeBlobProp","pos":[923,954]},{"content":"Exchanges a binary large object (BLOB) property.","pos":[990,1038]},{"content":"CPropExchange::ExchangeFontProp","pos":[1044,1075]},{"content":"Exchanges a font property.","pos":[1111,1137]},{"content":"CPropExchange::ExchangePersistentProp","pos":[1143,1180]},{"content":"Exchanges a property between a control and a file.","pos":[1222,1272]},{"content":"CPropExchange::ExchangeProp","pos":[1278,1305]},{"content":"Exchanges properties of any built-in type.","pos":[1337,1379]},{"content":"CPropExchange::ExchangeVersion","pos":[1385,1415]},{"content":"Exchanges the version number of an OLE control.","pos":[1450,1497]},{"content":"CPropExchange::GetVersion","pos":[1503,1528]},{"content":"Retrieves the version number of an OLE control.","pos":[1558,1605]},{"content":"CPropExchange::IsAsynchronous","pos":[1611,1640]},{"content":"Determines if property exchanges are done asynchronously.","pos":[1674,1731]},{"content":"CPropExchange::IsLoading","pos":[1737,1761]},{"content":"Indicates whether properties are being loaded into the control or saved from it.","pos":[1790,1870]},{"content":"Remarks","pos":[1880,1887]},{"pos":[1907,1934],"content":"does not have a base class."},{"content":"Establishes the context and direction of a property exchange.","pos":[1941,2002]},{"content":"Persistence is the exchange of the control's state information, usually represented by its properties, between the control itself and a medium.","pos":[2009,2152]},{"pos":[2159,2330],"content":"The framework constructs an object derived from <ph id=\"ph1\">`CPropExchange`</ph> when it is notified that an OLE control's properties are to be loaded from or stored to persistent storage.","source":"The framework constructs an object derived from `CPropExchange` when it is notified that an OLE control's properties are to be loaded from or stored to persistent storage."},{"content":"The framework passes a pointer to this <ph id=\"ph1\">`CPropExchange`</ph> object to your control's <ph id=\"ph2\">`DoPropExchange`</ph> function.","pos":[2337,2443],"source":"The framework passes a pointer to this `CPropExchange` object to your control's `DoPropExchange` function."},{"content":"If you used a wizard to create the starter files for your control, your control's <ph id=\"ph1\">`DoPropExchange`</ph> function calls <ph id=\"ph2\">`COleControl::DoPropExchange`</ph>.","pos":[2444,2588],"source":" If you used a wizard to create the starter files for your control, your control's `DoPropExchange` function calls `COleControl::DoPropExchange`."},{"content":"The base-class version exchanges the control's stock properties; you modify your derived class's version to exchange properties you have added to your control.","pos":[2589,2748]},{"content":"can be used to serialize a control's properties or initialize a control's properties upon the load or creation of a control.","pos":[2771,2895]},{"content":"The <ph id=\"ph1\">`ExchangeProp`</ph> and <ph id=\"ph2\">`ExchangeFontProp`</ph> member functions of <ph id=\"ph3\">`CPropExchange`</ph> are able to store properties to and load them from different media.","pos":[2896,3041],"source":" The `ExchangeProp` and `ExchangeFontProp` member functions of `CPropExchange` are able to store properties to and load them from different media."},{"pos":[3048,3200],"content":"For more information on using <ph id=\"ph1\">`CPropExchange`</ph>, see the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Property Pages<ept id=\"p1\">](../../mfc/mfc-activex-controls-property-pages.md)</ept>.","source":"For more information on using `CPropExchange`, see the article [MFC ActiveX Controls: Property Pages](../../mfc/mfc-activex-controls-property-pages.md)."},{"content":"Inheritance Hierarchy","pos":[3209,3230]},{"content":"Requirements","pos":[3258,3270]},{"pos":[3274,3294],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxctl.h","source":"**Header:** afxctl.h"},{"pos":[3352,3383],"content":"CPropExchange::ExchangeBlobProp"},{"content":"Serializes a property that stores binary large object (BLOB) data.","pos":[3387,3453]},{"content":"Parameters","pos":[3599,3609]},{"content":"The name of the property being exchanged.","pos":[3630,3671]},{"content":"Pointer to a variable pointing to where the property is stored (variable is typically a member of your class).","pos":[3690,3800]},{"content":"Default value for the property.","pos":[3825,3856]},{"content":"Return Value","pos":[3866,3878]},{"content":"Nonzero if the exchange was successful; 0 if unsuccessful.","pos":[3882,3940]},{"content":"Remarks","pos":[3950,3957]},{"content":"The property's value is read from or written to, as appropriate, the variable referenced by <ph id=\"ph1\">`phBlob`</ph>.","pos":[3961,4062],"source":"The property's value is read from or written to, as appropriate, the variable referenced by `phBlob`."},{"content":"If <ph id=\"ph1\">`hBlobDefault`</ph> is specified, it will be used as the property's default value.","pos":[4063,4143],"source":" If `hBlobDefault` is specified, it will be used as the property's default value."},{"content":"This value is used if, for any reason, the control's serialization fails.","pos":[4144,4217]},{"pos":[4224,4407],"content":"The functions <bpt id=\"p1\">**</bpt>CArchivePropExchange::ExchangeBlobProp<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>CResetPropExchange::ExchangeBlobProp<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>CPropsetPropExchange::ExchangeBlobProp<ept id=\"p3\">**</ept> override this pure virtual function.","source":"The functions **CArchivePropExchange::ExchangeBlobProp**, **CResetPropExchange::ExchangeBlobProp**, and **CPropsetPropExchange::ExchangeBlobProp** override this pure virtual function."},{"pos":[4465,4496],"content":"CPropExchange::ExchangeFontProp"},{"content":"Exchanges a font property between a storage medium and the control.","pos":[4500,4567]},{"content":"Parameters","pos":[4748,4758]},{"content":"The name of the property being exchanged.","pos":[4779,4820]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CFontHolder<ept id=\"p1\">](../../mfc/reference/cfontholder-class.md)</ept> object that contains the font property.","pos":[4837,4949],"source":" A reference to a [CFontHolder](../../mfc/reference/cfontholder-class.md) object that contains the font property."},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>FONTDESC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms692782)</ept> structure containing values for initializing the default state of the font property when <ph id=\"ph1\">`pFontDispAmbient`</ph> is <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","pos":[4971,5177],"source":" A pointer to a [FONTDESC](http://msdn.microsoft.com/library/windows/desktop/ms692782) structure containing values for initializing the default state of the font property when `pFontDispAmbient` is **NULL**."},{"content":"A pointer to the <bpt id=\"p1\">**</bpt>IFontDisp<ept id=\"p1\">**</ept> interface of a font to be used for initializing the default state of the font property.","pos":[5206,5324],"source":" A pointer to the **IFontDisp** interface of a font to be used for initializing the default state of the font property."},{"content":"Return Value","pos":[5334,5346]},{"content":"Nonzero if the exchange was successful; 0 if unsuccessful.","pos":[5350,5408]},{"content":"Remarks","pos":[5418,5425]},{"content":"If the font property is being loaded from the medium to the control, the font's characteristics are retrieved from the medium and the <ph id=\"ph1\">`CFontHolder`</ph> object referenced by <ph id=\"ph2\">`font`</ph> is initialized with them.","pos":[5429,5630],"source":"If the font property is being loaded from the medium to the control, the font's characteristics are retrieved from the medium and the `CFontHolder` object referenced by `font` is initialized with them."},{"content":"If the font property is being stored, the characteristics in the font object are written to the medium.","pos":[5631,5734]},{"pos":[5741,5924],"content":"The functions <bpt id=\"p1\">**</bpt>CArchivePropExchange::ExchangeFontProp<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>CResetPropExchange::ExchangeFontProp<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>CPropsetPropExchange::ExchangeFontProp<ept id=\"p3\">**</ept> override this pure virtual function.","source":"The functions **CArchivePropExchange::ExchangeFontProp**, **CResetPropExchange::ExchangeFontProp**, and **CPropsetPropExchange::ExchangeFontProp** override this pure virtual function."},{"pos":[5988,6025],"content":"CPropExchange::ExchangePersistentProp"},{"content":"Exchanges a property between the control and a file.","pos":[6029,6081]},{"content":"Parameters","pos":[6246,6256]},{"content":"The name of the property being exchanged.","pos":[6277,6318]},{"content":"A pointer to a variable containing a pointer to the property's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface (this variable is typically a member of your class).","pos":[6336,6474],"source":" A pointer to a variable containing a pointer to the property's **IUnknown** interface (this variable is typically a member of your class)."},{"content":"Interface ID of the interface on the property that the control will use.","pos":[6490,6562]},{"content":"Default value for the property.","pos":[6586,6617]},{"content":"Return Value","pos":[6627,6639]},{"content":"Nonzero if the exchange was successful; 0 if unsuccessful.","pos":[6643,6701]},{"content":"Remarks","pos":[6711,6718]},{"content":"If the property is being loaded from the file to the control, the property is created and initialized from the file.","pos":[6722,6838]},{"content":"If the property is being stored, its value is written to the file.","pos":[6839,6905]},{"pos":[6912,7113],"content":"The functions <bpt id=\"p1\">**</bpt>CArchivePropExchange::ExchangePersistentProp<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>CResetPropExchange::ExchangePersistentProp<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>CPropsetPropExchange::ExchangePersistentProp<ept id=\"p3\">**</ept> override this pure virtual function.","source":"The functions **CArchivePropExchange::ExchangePersistentProp**, **CResetPropExchange::ExchangePersistentProp**, and **CPropsetPropExchange::ExchangePersistentProp** override this pure virtual function."},{"pos":[7167,7194],"content":"CPropExchange::ExchangeProp"},{"content":"Exchanges a property between a storage medium and the control.","pos":[7198,7260]},{"content":"Parameters","pos":[7423,7433]},{"content":"The name of the property being exchanged.","pos":[7454,7495]},{"content":"A symbol specifying the type of the property being exchanged.","pos":[7514,7575]},{"content":"Possible values are:","pos":[7576,7596]},{"content":"Symbol","pos":[7603,7609]},{"content":"Property Type","pos":[7610,7623]},{"content":"short","pos":[7675,7680]},{"content":"long","pos":[7697,7701]},{"content":"BOOL","pos":[7720,7724]},{"content":"CY","pos":[7765,7767]},{"content":"float","pos":[7784,7789]},{"content":"double","pos":[7806,7812]},{"content":"A pointer to the property's value.","pos":[7834,7868]},{"content":"pvDefault","pos":[7876,7885]},{"content":"Pointer to a default value for the property.","pos":[7890,7934]},{"content":"Return Value","pos":[7944,7956]},{"content":"Nonzero if the exchange was successful; 0 if unsuccessful.","pos":[7960,8018]},{"content":"Remarks","pos":[8028,8035]},{"content":"If the property is being loaded from the medium to the control, the property's value is retrieved from the medium and stored in the object pointed to by <ph id=\"ph1\">`pvProp`</ph>.","pos":[8039,8201],"source":"If the property is being loaded from the medium to the control, the property's value is retrieved from the medium and stored in the object pointed to by `pvProp`."},{"content":"If the property is being stored to the medium, the value of the object pointed to by <ph id=\"ph1\">`pvProp`</ph> is written to the medium.","pos":[8202,8321],"source":" If the property is being stored to the medium, the value of the object pointed to by `pvProp` is written to the medium."},{"pos":[8328,8499],"content":"The functions <bpt id=\"p1\">**</bpt>CArchivePropExchange::ExchangeProp<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>CResetPropExchange::ExchangeProp<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>CPropsetPropExchange::ExchangeProp<ept id=\"p3\">**</ept> override this pure virtual function.","source":"The functions **CArchivePropExchange::ExchangeProp**, **CResetPropExchange::ExchangeProp**, and **CPropsetPropExchange::ExchangeProp** override this pure virtual function."},{"pos":[8556,8586],"content":"CPropExchange::ExchangeVersion"},{"content":"Called by the framework to handle persistence of a version number.","pos":[8590,8656]},{"content":"Parameters","pos":[8791,8801]},{"content":"dwVersionLoaded","pos":[8806,8821]},{"content":"Reference to a variable where the version number of the persistent data being loaded will be stored.","pos":[8826,8926]},{"content":"The current version number of the control.","pos":[8955,8997]},{"content":"Indicates whether to convert persistent data to the current version or keep it at the same version that was loaded.","pos":[9018,9133]},{"content":"Return Value","pos":[9143,9155]},{"content":"Nonzero if the function succeeded; 0 otherwise.","pos":[9159,9206]},{"pos":[9258,9283],"content":"CPropExchange::GetVersion"},{"content":"Call this function to retrieve the version number of the control.","pos":[9287,9352]},{"content":"Return Value","pos":[9397,9409]},{"content":"The version number of the control.","pos":[9413,9447]},{"pos":[9503,9532],"content":"CPropExchange::IsAsynchronous"},{"content":"Determines if property exchanges are done asynchronously.","pos":[9536,9593]},{"content":"Return Value","pos":[9641,9653]},{"content":"Returns TRUE if properties are exchanged asynchronously, otherwise FALSE.","pos":[9657,9730]},{"pos":[9781,9805],"content":"CPropExchange::IsLoading"},{"content":"Call this function to determine whether properties are being loaded to the control or saved from it.","pos":[9809,9909]},{"content":"Return Value","pos":[9952,9964]},{"content":"Nonzero if properties are being loaded; otherwise 0.","pos":[9968,10020]},{"content":"See Also","pos":[10029,10037]},{"content":"Hierarchy Chart","pos":[10042,10057]},{"content":"COleControl::DoPropExchange","pos":[10094,10121]}],"content":"---\ntitle: \"CPropExchange Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CPropExchange\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CPropExchange class\"\n  - \"OLE controls, persistence\"\n  - \"controls [MFC], OLE\"\nms.assetid: ed872180-e770-4942-892a-92139d501fab\ncaps.latest.revision: 22\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CPropExchange Class\nSupports the implementation of persistence for your OLE controls.  \n  \n## Syntax  \n  \n```  \nclass AFX_NOVTABLE CPropExchange  \n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPropExchange::ExchangeBlobProp](#cpropexchange__exchangeblobprop)|Exchanges a binary large object (BLOB) property.|  \n|[CPropExchange::ExchangeFontProp](#cpropexchange__exchangefontprop)|Exchanges a font property.|  \n|[CPropExchange::ExchangePersistentProp](#cpropexchange__exchangepersistentprop)|Exchanges a property between a control and a file.|  \n|[CPropExchange::ExchangeProp](#cpropexchange__exchangeprop)|Exchanges properties of any built-in type.|  \n|[CPropExchange::ExchangeVersion](#cpropexchange__exchangeversion)|Exchanges the version number of an OLE control.|  \n|[CPropExchange::GetVersion](#cpropexchange__getversion)|Retrieves the version number of an OLE control.|  \n|[CPropExchange::IsAsynchronous](#cpropexchange__isasynchronous)|Determines if property exchanges are done asynchronously.|  \n|[CPropExchange::IsLoading](#cpropexchange__isloading)|Indicates whether properties are being loaded into the control or saved from it.|  \n  \n## Remarks  \n `CPropExchange` does not have a base class.  \n  \n Establishes the context and direction of a property exchange.  \n  \n Persistence is the exchange of the control's state information, usually represented by its properties, between the control itself and a medium.  \n  \n The framework constructs an object derived from `CPropExchange` when it is notified that an OLE control's properties are to be loaded from or stored to persistent storage.  \n  \n The framework passes a pointer to this `CPropExchange` object to your control's `DoPropExchange` function. If you used a wizard to create the starter files for your control, your control's `DoPropExchange` function calls `COleControl::DoPropExchange`. The base-class version exchanges the control's stock properties; you modify your derived class's version to exchange properties you have added to your control.  \n  \n `CPropExchange` can be used to serialize a control's properties or initialize a control's properties upon the load or creation of a control. The `ExchangeProp` and `ExchangeFontProp` member functions of `CPropExchange` are able to store properties to and load them from different media.  \n  \n For more information on using `CPropExchange`, see the article [MFC ActiveX Controls: Property Pages](../../mfc/mfc-activex-controls-property-pages.md).  \n  \n## Inheritance Hierarchy  \n `CPropExchange`  \n  \n## Requirements  \n **Header:** afxctl.h  \n  \n##  <a name=\"cpropexchange__exchangeblobprop\"></a>  CPropExchange::ExchangeBlobProp  \n Serializes a property that stores binary large object (BLOB) data.  \n  \n```  \nvirtual BOOL ExchangeBlobProp(\n    LPCTSTR pszPropName,  \n    HGLOBAL* phBlob,  \n    HGLOBAL hBlobDefault = NULL) = 0;  \n```  \n  \n### Parameters  \n `pszPropName`  \n The name of the property being exchanged.  \n  \n `phBlob`  \n Pointer to a variable pointing to where the property is stored (variable is typically a member of your class).  \n  \n `hBlobDefault`  \n Default value for the property.  \n  \n### Return Value  \n Nonzero if the exchange was successful; 0 if unsuccessful.  \n  \n### Remarks  \n The property's value is read from or written to, as appropriate, the variable referenced by `phBlob`. If `hBlobDefault` is specified, it will be used as the property's default value. This value is used if, for any reason, the control's serialization fails.  \n  \n The functions **CArchivePropExchange::ExchangeBlobProp**, **CResetPropExchange::ExchangeBlobProp**, and **CPropsetPropExchange::ExchangeBlobProp** override this pure virtual function.  \n  \n##  <a name=\"cpropexchange__exchangefontprop\"></a>  CPropExchange::ExchangeFontProp  \n Exchanges a font property between a storage medium and the control.  \n  \n```  \nvirtual BOOL ExchangeFontProp(\n    LPCTSTR pszPropName,  \n    CFontHolder& font,  \n    const FONTDESC* pFontDesc,  \n    LPFONTDISP pFontDispAmbient) = 0;  \n```  \n  \n### Parameters  \n `pszPropName`  \n The name of the property being exchanged.  \n  \n `font`  \n A reference to a [CFontHolder](../../mfc/reference/cfontholder-class.md) object that contains the font property.  \n  \n `pFontDesc`  \n A pointer to a [FONTDESC](http://msdn.microsoft.com/library/windows/desktop/ms692782) structure containing values for initializing the default state of the font property when `pFontDispAmbient` is **NULL**.  \n  \n `pFontDispAmbient`  \n A pointer to the **IFontDisp** interface of a font to be used for initializing the default state of the font property.  \n  \n### Return Value  \n Nonzero if the exchange was successful; 0 if unsuccessful.  \n  \n### Remarks  \n If the font property is being loaded from the medium to the control, the font's characteristics are retrieved from the medium and the `CFontHolder` object referenced by `font` is initialized with them. If the font property is being stored, the characteristics in the font object are written to the medium.  \n  \n The functions **CArchivePropExchange::ExchangeFontProp**, **CResetPropExchange::ExchangeFontProp**, and **CPropsetPropExchange::ExchangeFontProp** override this pure virtual function.  \n  \n##  <a name=\"cpropexchange__exchangepersistentprop\"></a>  CPropExchange::ExchangePersistentProp  \n Exchanges a property between the control and a file.  \n  \n```  \nvirtual BOOL ExchangePersistentProp(\n    LPCTSTR pszPropName,  \n    LPUNKNOWN* ppUnk,  \n    REFIID iid,  \n    LPUNKNOWN pUnkDefault) = 0;  \n```  \n  \n### Parameters  \n `pszPropName`  \n The name of the property being exchanged.  \n  \n `ppUnk`  \n A pointer to a variable containing a pointer to the property's **IUnknown** interface (this variable is typically a member of your class).  \n  \n `iid`  \n Interface ID of the interface on the property that the control will use.  \n  \n `pUnkDefault`  \n Default value for the property.  \n  \n### Return Value  \n Nonzero if the exchange was successful; 0 if unsuccessful.  \n  \n### Remarks  \n If the property is being loaded from the file to the control, the property is created and initialized from the file. If the property is being stored, its value is written to the file.  \n  \n The functions **CArchivePropExchange::ExchangePersistentProp**, **CResetPropExchange::ExchangePersistentProp**, and **CPropsetPropExchange::ExchangePersistentProp** override this pure virtual function.  \n  \n##  <a name=\"cpropexchange__exchangeprop\"></a>  CPropExchange::ExchangeProp  \n Exchanges a property between a storage medium and the control.  \n  \n```  \nvirtual BOOL ExchangeProp(\n    LPCTSTR pszPropName,  \n    VARTYPE vtProp,  \n    void* pvProp,  \n    const void* pvDefault = NULL) = 0 ;  \n```  \n  \n### Parameters  \n `pszPropName`  \n The name of the property being exchanged.  \n  \n `vtProp`  \n A symbol specifying the type of the property being exchanged. Possible values are:  \n  \n|Symbol|Property Type|  \n|------------|-------------------|  \n|`VT_I2`|**short**|  \n|`VT_I4`|**long**|  \n|`VT_BOOL`|**BOOL**|  \n|`VT_BSTR`|`CString`|  \n|`VT_CY`|**CY**|  \n|`VT_R4`|**float**|  \n|`VT_R8`|**double**|  \n  \n `pvProp`  \n A pointer to the property's value.  \n  \n *pvDefault*  \n Pointer to a default value for the property.  \n  \n### Return Value  \n Nonzero if the exchange was successful; 0 if unsuccessful.  \n  \n### Remarks  \n If the property is being loaded from the medium to the control, the property's value is retrieved from the medium and stored in the object pointed to by `pvProp`. If the property is being stored to the medium, the value of the object pointed to by `pvProp` is written to the medium.  \n  \n The functions **CArchivePropExchange::ExchangeProp**, **CResetPropExchange::ExchangeProp**, and **CPropsetPropExchange::ExchangeProp** override this pure virtual function.  \n  \n##  <a name=\"cpropexchange__exchangeversion\"></a>  CPropExchange::ExchangeVersion  \n Called by the framework to handle persistence of a version number.  \n  \n```  \nvirtual BOOL ExchangeVersion(\n    DWORD& dwVersionLoaded,  \n    DWORD dwVersionDefault,  \n    BOOL bConvert);\n```  \n  \n### Parameters  \n *dwVersionLoaded*  \n Reference to a variable where the version number of the persistent data being loaded will be stored.  \n  \n `dwVersionDefault`  \n The current version number of the control.  \n  \n `bConvert`  \n Indicates whether to convert persistent data to the current version or keep it at the same version that was loaded.  \n  \n### Return Value  \n Nonzero if the function succeeded; 0 otherwise.  \n  \n##  <a name=\"cpropexchange__getversion\"></a>  CPropExchange::GetVersion  \n Call this function to retrieve the version number of the control.  \n  \n```  \nDWORD GetVersion();\n```  \n  \n### Return Value  \n The version number of the control.  \n  \n##  <a name=\"cpropexchange__isasynchronous\"></a>  CPropExchange::IsAsynchronous  \n Determines if property exchanges are done asynchronously.  \n  \n```  \nBOOL IsAsynchronous();\n```  \n  \n### Return Value  \n Returns TRUE if properties are exchanged asynchronously, otherwise FALSE.  \n  \n##  <a name=\"cpropexchange__isloading\"></a>  CPropExchange::IsLoading  \n Call this function to determine whether properties are being loaded to the control or saved from it.  \n  \n```  \nBOOL IsLoading();\n```  \n  \n### Return Value  \n Nonzero if properties are being loaded; otherwise 0.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [COleControl::DoPropExchange](../../mfc/reference/colecontrol-class.md#colecontrol__dopropexchange)\n\n\n\n"}