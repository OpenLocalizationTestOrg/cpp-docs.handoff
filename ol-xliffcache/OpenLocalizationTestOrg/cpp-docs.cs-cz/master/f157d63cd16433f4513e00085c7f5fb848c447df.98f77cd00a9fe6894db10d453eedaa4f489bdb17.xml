{"nodes":[{"pos":[12,52],"content":"CMFCCmdUsageCount Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCCmdUsageCount Class | Microsoft Docs","pos":[0,40]}]},{"pos":[625,648],"content":"CMFCCmdUsageCount Class","linkify":"CMFCCmdUsageCount Class","nodes":[{"content":"CMFCCmdUsageCount Class","pos":[0,23]}]},{"content":"Tracks the usage count of Windows messages, such as when the user selects an item from a menu.","pos":[649,743]},{"pos":[752,758],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[825,832],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[842,861],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[882,886]},{"content":"Description","pos":[887,898]},{"content":"Default constructor.","pos":[942,962]},{"content":"Destructor.","pos":[1007,1018]},{"pos":[1029,1043],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1064,1068]},{"content":"Description","pos":[1069,1080]},{"pos":[1085,1140],"content":"<bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::AddCmd<ept id=\"p1\">](#cmfccmdusagecount__addcmd)</ept>","source":"[CMFCCmdUsageCount::AddCmd](#cmfccmdusagecount__addcmd)"},{"content":"Increments by one the counter that is associated with the given command.","pos":[1141,1213]},{"pos":[1218,1277],"content":"<bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::GetCount<ept id=\"p1\">](#cmfccmdusagecount__getcount)</ept>","source":"[CMFCCmdUsageCount::GetCount](#cmfccmdusagecount__getcount)"},{"content":"Retrieves the usage count that is associated with the given command ID.","pos":[1278,1349]},{"pos":[1354,1437],"content":"<bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::HasEnoughInformation<ept id=\"p1\">](#cmfccmdusagecount__hasenoughinformation)</ept>","source":"[CMFCCmdUsageCount::HasEnoughInformation](#cmfccmdusagecount__hasenoughinformation)"},{"content":"Determines whether this object has collected the minimum amount of tracking data.","pos":[1438,1519]},{"pos":[1524,1605],"content":"<bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::IsFreqeuntlyUsedCmd<ept id=\"p1\">](#cmfccmdusagecount__isfreqeuntlyusedcmd)</ept>","source":"[CMFCCmdUsageCount::IsFreqeuntlyUsedCmd](#cmfccmdusagecount__isfreqeuntlyusedcmd)"},{"content":"Determines whether the given command is frequently used.","pos":[1606,1662]},{"pos":[1667,1720],"content":"<bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::Reset<ept id=\"p1\">](#cmfccmdusagecount__reset)</ept>","source":"[CMFCCmdUsageCount::Reset](#cmfccmdusagecount__reset)"},{"content":"Clears the usage count of all commands.","pos":[1721,1760]},{"pos":[1765,1826],"content":"<bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::Serialize<ept id=\"p1\">](#cmfccmdusagecount__serialize)</ept>","source":"[CMFCCmdUsageCount::Serialize](#cmfccmdusagecount__serialize)"},{"content":"Reads this object from an archive or writes it to an archive.","pos":[1827,1888]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CObject::Serialize<ept id=\"p1\">](../../mfc/reference/cobject-class.md#cobject__serialize)</ept>.)","pos":[1889,1979],"source":" (Overrides [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize).)"},{"pos":[1984,2047],"content":"<bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::SetOptions<ept id=\"p1\">](#cmfccmdusagecount__setoptions)</ept>","source":"[CMFCCmdUsageCount::SetOptions](#cmfccmdusagecount__setoptions)"},{"pos":[2048,2113],"content":"Sets the values of shared <ph id=\"ph1\">`CMFCCmdUsageCount`</ph> class data members.","source":"Sets the values of shared `CMFCCmdUsageCount` class data members."},{"pos":[2124,2136],"content":"Data Members","linkify":"Data Members","nodes":[{"content":"Data Members","pos":[0,12]}]},{"content":"Name","pos":[2157,2161]},{"content":"Description","pos":[2162,2173]},{"pos":[2191,2248],"content":"A <ph id=\"ph1\">`CMap`</ph> object that maps commands to their usage counts.","source":"A `CMap` object that maps commands to their usage counts."},{"content":"The minimum usage percentage for a command to be frequently used.","pos":[2277,2342]},{"content":"The start counter that is used to determine whether this object has collected the minimum amount of tracking data.","pos":[2363,2477]},{"content":"The count of all tracked commands.","pos":[2498,2532]},{"pos":[2543,2550],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`CMFCCmdUsageCount`</ph> class maps each numeric Windows message identifier to a 32-bit unsigned integer counter.","pos":[2554,2666],"source":"The `CMFCCmdUsageCount` class maps each numeric Windows message identifier to a 32-bit unsigned integer counter."},{"content":"<ph id=\"ph1\">`CMFCToolBar`</ph> uses this class to display frequently-used toolbar items.","pos":[2667,2738],"source":"`CMFCToolBar` uses this class to display frequently-used toolbar items."},{"content":"For more information about <ph id=\"ph1\">`CMFCToolBar`</ph>, see <bpt id=\"p1\">[</bpt>CMFCToolBar Class<ept id=\"p1\">](../../mfc/reference/cmfctoolbar-class.md)</ept>.","pos":[2739,2847],"source":" For more information about `CMFCToolBar`, see [CMFCToolBar Class](../../mfc/reference/cmfctoolbar-class.md)."},{"content":"You can persist <ph id=\"ph1\">`CMFCCmdUsageCount`</ph> class data between runs of your program.","pos":[2854,2930],"source":"You can persist `CMFCCmdUsageCount` class data between runs of your program."},{"content":"Use the <bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::Serialize<ept id=\"p1\">](#cmfccmdusagecount__serialize)</ept> method to serialize class member data and the <bpt id=\"p2\">[</bpt>CMFCCmdUsageCount::SetOptions<ept id=\"p2\">](#cmfccmdusagecount__setoptions)</ept> method to set shared member data.","pos":[2931,3144],"source":" Use the [CMFCCmdUsageCount::Serialize](#cmfccmdusagecount__serialize) method to serialize class member data and the [CMFCCmdUsageCount::SetOptions](#cmfccmdusagecount__setoptions) method to set shared member data."},{"pos":[3153,3174],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3178,3225],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[3232,3299],"content":"<bpt id=\"p1\">[</bpt>CMFCCmdUsageCount<ept id=\"p1\">](../../mfc/reference/cmfccmdusagecount-class.md)</ept>","source":"[CMFCCmdUsageCount](../../mfc/reference/cmfccmdusagecount-class.md)"},{"pos":[3308,3320],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3324,3354],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxcmdusagecount.h","source":"**Header:** afxcmdusagecount.h"},{"pos":[3364,3431],"content":"<bpt id=\"p1\">&lt;a name=\"cmfccmdusagecount__addcmd\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCCmdUsageCount::AddCmd","linkify":"<a name=\"cmfccmdusagecount__addcmd\"></a>  CMFCCmdUsageCount::AddCmd","source":"<a name=\"cmfccmdusagecount__addcmd\"></a>  CMFCCmdUsageCount::AddCmd"},{"content":"Increments by one the counter that is associated with the given command.","pos":[3435,3507]},{"pos":[3557,3567],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Parameter","pos":[3588,3597]},{"content":"Description","pos":[3598,3609]},{"pos":[3614,3626],"content":"[in] <ph id=\"ph1\">`uiCmd`</ph>","source":"[in] `uiCmd`"},{"content":"Specifies the command counter to increment.","pos":[3627,3670]},{"pos":[3681,3688],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3692,3811],"content":"This method adds a new entry to the map structure of command counts, <ph id=\"ph1\">`m_CmdUsage`</ph>, if the entry does not already exist.","source":"This method adds a new entry to the map structure of command counts, `m_CmdUsage`, if the entry does not already exist."},{"content":"This method does nothing in the following cases:","pos":[3818,3866]},{"pos":[3876,4062],"content":"The toolbar framework is in customization mode (the <bpt id=\"p1\">[</bpt>CMFCToolBar::IsCustomizeMode<ept id=\"p1\">](../../mfc/reference/cmfctoolbar-class.md#cmfctoolbar__iscustomizemode)</ept> method returns a nonzero value).","source":"The toolbar framework is in customization mode (the [CMFCToolBar::IsCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#cmfctoolbar__iscustomizemode) method returns a nonzero value)."},{"pos":[4072,4148],"content":"The command refers to a submenu or menu separator ( <ph id=\"ph1\">`uiCmd`</ph> equals 0 or -1).","source":"The command refers to a submenu or menu separator ( `uiCmd` equals 0 or -1)."},{"pos":[4156,4259],"content":"<ph id=\"ph1\">`uiCmd`</ph> refers to a standard command (the global <ph id=\"ph2\">`IsStandardCommand`</ph> function returns a nonzero value).","source":"`uiCmd` refers to a standard command (the global `IsStandardCommand` function returns a nonzero value)."},{"pos":[4269,4340],"content":"<bpt id=\"p1\">&lt;a name=\"cmfccmdusagecount__getcount\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCCmdUsageCount::GetCount","linkify":"<a name=\"cmfccmdusagecount__getcount\"></a>  CMFCCmdUsageCount::GetCount","source":"<a name=\"cmfccmdusagecount__getcount\"></a>  CMFCCmdUsageCount::GetCount"},{"content":"Retrieves the usage count that is associated with the given command ID.","pos":[4344,4415]},{"pos":[4476,4486],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Parameter","pos":[4507,4516]},{"content":"Description","pos":[4517,4528]},{"pos":[4533,4545],"content":"[in] <ph id=\"ph1\">`uiCmd`</ph>","source":"[in] `uiCmd`"},{"content":"The ID of the command counter to retrieve.","pos":[4546,4588]},{"pos":[4599,4611],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The usage count that is associated with the given command ID.","pos":[4615,4676]},{"pos":[4686,4781],"content":"<bpt id=\"p1\">&lt;a name=\"cmfccmdusagecount__hasenoughinformation\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCCmdUsageCount::HasEnoughInformation","linkify":"<a name=\"cmfccmdusagecount__hasenoughinformation\"></a>  CMFCCmdUsageCount::HasEnoughInformation","source":"<a name=\"cmfccmdusagecount__hasenoughinformation\"></a>  CMFCCmdUsageCount::HasEnoughInformation"},{"content":"Determines whether this object has received the minimum amount of tracking data.","pos":[4785,4865]},{"pos":[4928,4940],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if this object has received the minimum amount of tracking data; otherwise 0.","pos":[4944,5029]},{"pos":[5039,5046],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This method returns a nonzero value if the total count, <ph id=\"ph1\">`m_nTotalUsage`</ph>, of all tracked commands is equal to or larger than the initial count, <ph id=\"ph2\">`m_nStartCount`</ph>.","pos":[5050,5209],"source":"This method returns a nonzero value if the total count, `m_nTotalUsage`, of all tracked commands is equal to or larger than the initial count, `m_nStartCount`."},{"content":"By default, the framework sets the initial count 0.","pos":[5210,5261]},{"content":"You can override this value by using the <bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::SetOptions<ept id=\"p1\">](#cmfccmdusagecount__setoptions)</ept> method.","pos":[5262,5374],"source":" You can override this value by using the [CMFCCmdUsageCount::SetOptions](#cmfccmdusagecount__setoptions) method."},{"pos":[5381,5567],"content":"This method is used by <bpt id=\"p1\">[</bpt>CMFCMenuBar::IsShowAllCommands<ept id=\"p1\">](../../mfc/reference/cmfcmenubar-class.md#cmfcmenubar__isshowallcommands)</ept> to determine whether to show all available menu commands.","source":"This method is used by [CMFCMenuBar::IsShowAllCommands](../../mfc/reference/cmfcmenubar-class.md#cmfcmenubar__isshowallcommands) to determine whether to show all available menu commands."},{"pos":[5577,5670],"content":"<bpt id=\"p1\">&lt;a name=\"cmfccmdusagecount__isfreqeuntlyusedcmd\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCCmdUsageCount::IsFreqeuntlyUsedCmd","linkify":"<a name=\"cmfccmdusagecount__isfreqeuntlyusedcmd\"></a>  CMFCCmdUsageCount::IsFreqeuntlyUsedCmd","source":"<a name=\"cmfccmdusagecount__isfreqeuntlyusedcmd\"></a>  CMFCCmdUsageCount::IsFreqeuntlyUsedCmd"},{"content":"Determines whether the given command is frequently used.","pos":[5674,5730]},{"pos":[5802,5812],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Parameter","pos":[5833,5842]},{"content":"Description","pos":[5843,5854]},{"pos":[5859,5871],"content":"[in] <ph id=\"ph1\">`uiCmd`</ph>","source":"[in] `uiCmd`"},{"content":"Specifies the command to check.","pos":[5872,5903]},{"pos":[5914,5926],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the command is frequently used; otherwise 0.","pos":[5930,5985]},{"pos":[5995,6002],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This method returns 0 if the total command usage, <ph id=\"ph1\">`m_nTotalUsage`</ph>, is 0.","pos":[6006,6078],"source":"This method returns 0 if the total command usage, `m_nTotalUsage`, is 0."},{"content":"Otherwise, this method returns nonzero if the percentage of which the specified command is used is larger than the minimum percentage, <ph id=\"ph1\">`m_nMinUsagePercentage`</ph>.","pos":[6079,6238],"source":" Otherwise, this method returns nonzero if the percentage of which the specified command is used is larger than the minimum percentage, `m_nMinUsagePercentage`."},{"content":"By default, the framework sets the minimum percentage to 5.","pos":[6239,6298]},{"content":"You can override this value by using the <bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::SetOptions<ept id=\"p1\">](#cmfccmdusagecount__setoptions)</ept> method.","pos":[6299,6411],"source":" You can override this value by using the [CMFCCmdUsageCount::SetOptions](#cmfccmdusagecount__setoptions) method."},{"content":"If the minimum percentage is 0, this method returns nonzero if the specified command count is larger than 0.","pos":[6412,6520]},{"pos":[6527,6700],"content":"<bpt id=\"p1\">[</bpt>CMFCToolBar::IsCommandRarelyUsed<ept id=\"p1\">](../../mfc/reference/cmfctoolbar-class.md#cmfctoolbar__iscommandrarelyused)</ept> uses this method to determine whether a command is rarely used.","source":"[CMFCToolBar::IsCommandRarelyUsed](../../mfc/reference/cmfctoolbar-class.md#cmfctoolbar__iscommandrarelyused) uses this method to determine whether a command is rarely used."},{"pos":[6710,6775],"content":"<bpt id=\"p1\">&lt;a name=\"cmfccmdusagecount__reset\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCCmdUsageCount::Reset","linkify":"<a name=\"cmfccmdusagecount__reset\"></a>  CMFCCmdUsageCount::Reset","source":"<a name=\"cmfccmdusagecount__reset\"></a>  CMFCCmdUsageCount::Reset"},{"content":"Clears the usage count of all commands.","pos":[6779,6818]},{"pos":[6857,6864],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6868,7030],"content":"Call this method to clear all entries from the map structure of command counts, <ph id=\"ph1\">`m_CmdUsage`</ph>, and to reset the total command usage, <ph id=\"ph2\">`m_nTotalUsage`</ph>, counter to 0.","source":"Call this method to clear all entries from the map structure of command counts, `m_CmdUsage`, and to reset the total command usage, `m_nTotalUsage`, counter to 0."},{"pos":[7040,7113],"content":"<bpt id=\"p1\">&lt;a name=\"cmfccmdusagecount__serialize\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCCmdUsageCount::Serialize","linkify":"<a name=\"cmfccmdusagecount__serialize\"></a>  CMFCCmdUsageCount::Serialize","source":"<a name=\"cmfccmdusagecount__serialize\"></a>  CMFCCmdUsageCount::Serialize"},{"content":"Reads this object from an archive, or writes it to an archive.","pos":[7117,7179]},{"pos":[7242,7252],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Parameter","pos":[7273,7282]},{"content":"Description","pos":[7283,7294]},{"pos":[7299,7308],"content":"[in] <ph id=\"ph1\">`ar`</ph>","source":"[in] `ar`"},{"pos":[7309,7353],"content":"A <ph id=\"ph1\">`CArchive`</ph> object to serialize from or to.","source":"A `CArchive` object to serialize from or to."},{"pos":[7364,7371],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7375,7536],"content":"This method serializes the map structure of command counts, <ph id=\"ph1\">`m_CmdUsage`</ph>, and the total command usage, <ph id=\"ph2\">`m_nTotalUsage`</ph>, counter from or to the specified archive.","source":"This method serializes the map structure of command counts, `m_CmdUsage`, and the total command usage, `m_nTotalUsage`, counter from or to the specified archive."},{"pos":[7543,7664],"content":"For serialization examples, see <bpt id=\"p1\">[</bpt>Serialization: Serializing an Object<ept id=\"p1\">](../../mfc/serialization-serializing-an-object.md)</ept>.","source":"For serialization examples, see [Serialization: Serializing an Object](../../mfc/serialization-serializing-an-object.md)."},{"pos":[7674,7749],"content":"<bpt id=\"p1\">&lt;a name=\"cmfccmdusagecount__setoptions\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMFCCmdUsageCount::SetOptions","linkify":"<a name=\"cmfccmdusagecount__setoptions\"></a>  CMFCCmdUsageCount::SetOptions","source":"<a name=\"cmfccmdusagecount__setoptions\"></a>  CMFCCmdUsageCount::SetOptions"},{"pos":[7753,7818],"content":"Sets the values of shared <ph id=\"ph1\">`CMFCCmdUsageCount`</ph> class data members.","source":"Sets the values of shared `CMFCCmdUsageCount` class data members."},{"pos":[7932,7942],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Parameter","pos":[7963,7972]},{"content":"Description","pos":[7973,7984]},{"pos":[7989,8007],"content":"[in] <ph id=\"ph1\">`nStartCount`</ph>","source":"[in] `nStartCount`"},{"content":"The new initial count of all tracked commands.","pos":[8008,8054]},{"pos":[8059,8085],"content":"[in] <ph id=\"ph1\">`nMinUsagePercentage`</ph>","source":"[in] `nMinUsagePercentage`"},{"content":"The new minimum usage percentage.","pos":[8086,8119]},{"pos":[8130,8142],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[8146,8255],"content":"<ph id=\"ph1\">`TRUE`</ph> if the method succeeds, <ph id=\"ph2\">`FALSE`</ph> if the <ph id=\"ph3\">`nMinUsagePercentage`</ph> parameter is larger than or equal to 100.","source":"`TRUE` if the method succeeds, `FALSE` if the `nMinUsagePercentage` parameter is larger than or equal to 100."},{"pos":[8265,8272],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This method sets the shared <ph id=\"ph1\">`CMFCCmdUsageCount`</ph> class data members <ph id=\"ph2\">`m_nStartCount`</ph> and <ph id=\"ph3\">`m_nMinUsagePercentage`</ph> to <ph id=\"ph4\">`nStartCount`</ph> and <ph id=\"ph5\">`nMinUsagePercentage`</ph>, respectively.","pos":[8276,8444],"source":"This method sets the shared `CMFCCmdUsageCount` class data members `m_nStartCount` and `m_nMinUsagePercentage` to `nStartCount` and `nMinUsagePercentage`, respectively."},{"content":"<ph id=\"ph1\">`m_nStartCount`</ph> is used by the <bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::HasEnoughInformation<ept id=\"p1\">](#cmfccmdusagecount__hasenoughinformation)</ept> method to determine whether this object has collected the minimum amount of tracking data.","pos":[8445,8650],"source":"`m_nStartCount` is used by the [CMFCCmdUsageCount::HasEnoughInformation](#cmfccmdusagecount__hasenoughinformation) method to determine whether this object has collected the minimum amount of tracking data."},{"content":"<ph id=\"ph1\">`m_nMinUsagePercentage`</ph> is used by the <bpt id=\"p1\">[</bpt>CMFCCmdUsageCount::IsFreqeuntlyUsedCmd<ept id=\"p1\">](#cmfccmdusagecount__isfreqeuntlyusedcmd)</ept> method to determine whether a given command is frequently used.","pos":[8651,8835],"source":"`m_nMinUsagePercentage` is used by the [CMFCCmdUsageCount::IsFreqeuntlyUsedCmd](#cmfccmdusagecount__isfreqeuntlyusedcmd) method to determine whether a given command is frequently used."},{"pos":[8842,8971],"content":"In Debug builds this method generates an assertion failure if the <ph id=\"ph1\">`nMinUsagePercentage`</ph> parameter is larger than or equal to 100.","source":"In Debug builds this method generates an assertion failure if the `nMinUsagePercentage` parameter is larger than or equal to 100."},{"pos":[8980,8988],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[8992,9040],"source":"[Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Classes<ept id=\"p1\">](../../mfc/reference/mfc-classes.md)</ept><ph id=\"ph1\"> </ph>","pos":[9043,9090],"source":" [Classes](../../mfc/reference/mfc-classes.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CMFCToolBar Class<ept id=\"p1\">](../../mfc/reference/cmfctoolbar-class.md)</ept>","pos":[9093,9155],"source":" [CMFCToolBar Class](../../mfc/reference/cmfctoolbar-class.md)"}],"content":"---\ntitle: \"CMFCCmdUsageCount Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCCmdUsageCount\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCCmdUsageCount class\"\nms.assetid: 9c33b783-37c0-43ea-9f31-3c75e246c841\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCCmdUsageCount Class\nTracks the usage count of Windows messages, such as when the user selects an item from a menu.  \n  \n## Syntax  \n  \n```  \nclass CMFCCmdUsageCount : public CObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|||  \n|-|-|  \n|Name|Description|  \n|`CMFCCmdUsageCount::CMFCCmdUsageCount`|Default constructor.|  \n|`CMFCCmdUsageCount::~CMFCCmdUsageCount`|Destructor.|  \n  \n### Public Methods  \n  \n|||  \n|-|-|  \n|Name|Description|  \n|[CMFCCmdUsageCount::AddCmd](#cmfccmdusagecount__addcmd)|Increments by one the counter that is associated with the given command.|  \n|[CMFCCmdUsageCount::GetCount](#cmfccmdusagecount__getcount)|Retrieves the usage count that is associated with the given command ID.|  \n|[CMFCCmdUsageCount::HasEnoughInformation](#cmfccmdusagecount__hasenoughinformation)|Determines whether this object has collected the minimum amount of tracking data.|  \n|[CMFCCmdUsageCount::IsFreqeuntlyUsedCmd](#cmfccmdusagecount__isfreqeuntlyusedcmd)|Determines whether the given command is frequently used.|  \n|[CMFCCmdUsageCount::Reset](#cmfccmdusagecount__reset)|Clears the usage count of all commands.|  \n|[CMFCCmdUsageCount::Serialize](#cmfccmdusagecount__serialize)|Reads this object from an archive or writes it to an archive. (Overrides [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize).)|  \n|[CMFCCmdUsageCount::SetOptions](#cmfccmdusagecount__setoptions)|Sets the values of shared `CMFCCmdUsageCount` class data members.|  \n  \n### Data Members  \n  \n|||  \n|-|-|  \n|Name|Description|  \n|`m_CmdUsage`|A `CMap` object that maps commands to their usage counts.|  \n|`m_nMinUsagePercentage`|The minimum usage percentage for a command to be frequently used.|  \n|`m_nStartCount`|The start counter that is used to determine whether this object has collected the minimum amount of tracking data.|  \n|`m_nTotalUsage`|The count of all tracked commands.|  \n  \n### Remarks  \n The `CMFCCmdUsageCount` class maps each numeric Windows message identifier to a 32-bit unsigned integer counter. `CMFCToolBar` uses this class to display frequently-used toolbar items. For more information about `CMFCToolBar`, see [CMFCToolBar Class](../../mfc/reference/cmfctoolbar-class.md).  \n  \n You can persist `CMFCCmdUsageCount` class data between runs of your program. Use the [CMFCCmdUsageCount::Serialize](#cmfccmdusagecount__serialize) method to serialize class member data and the [CMFCCmdUsageCount::SetOptions](#cmfccmdusagecount__setoptions) method to set shared member data.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CMFCCmdUsageCount](../../mfc/reference/cmfccmdusagecount-class.md)  \n  \n## Requirements  \n **Header:** afxcmdusagecount.h  \n  \n##  <a name=\"cmfccmdusagecount__addcmd\"></a>  CMFCCmdUsageCount::AddCmd  \n Increments by one the counter that is associated with the given command.  \n  \n```  \nvoid AddCmd(UINT uiCmd);\n```  \n  \n### Parameters  \n  \n|||  \n|-|-|  \n|Parameter|Description|  \n|[in] `uiCmd`|Specifies the command counter to increment.|  \n  \n### Remarks  \n This method adds a new entry to the map structure of command counts, `m_CmdUsage`, if the entry does not already exist.  \n  \n This method does nothing in the following cases:  \n  \n-   The toolbar framework is in customization mode (the [CMFCToolBar::IsCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#cmfctoolbar__iscustomizemode) method returns a nonzero value).  \n  \n-   The command refers to a submenu or menu separator ( `uiCmd` equals 0 or -1).  \n  \n- `uiCmd` refers to a standard command (the global `IsStandardCommand` function returns a nonzero value).  \n  \n##  <a name=\"cmfccmdusagecount__getcount\"></a>  CMFCCmdUsageCount::GetCount  \n Retrieves the usage count that is associated with the given command ID.  \n  \n```  \nUINT GetCount(UINT uiCmd) const;\n\n \n```  \n  \n### Parameters  \n  \n|||  \n|-|-|  \n|Parameter|Description|  \n|[in] `uiCmd`|The ID of the command counter to retrieve.|  \n  \n### Return Value  \n The usage count that is associated with the given command ID.  \n  \n##  <a name=\"cmfccmdusagecount__hasenoughinformation\"></a>  CMFCCmdUsageCount::HasEnoughInformation  \n Determines whether this object has received the minimum amount of tracking data.  \n  \n```  \nBOOL HasEnoughInformation() const;\n\n \n```  \n  \n### Return Value  \n Nonzero if this object has received the minimum amount of tracking data; otherwise 0.  \n  \n### Remarks  \n This method returns a nonzero value if the total count, `m_nTotalUsage`, of all tracked commands is equal to or larger than the initial count, `m_nStartCount`. By default, the framework sets the initial count 0. You can override this value by using the [CMFCCmdUsageCount::SetOptions](#cmfccmdusagecount__setoptions) method.  \n  \n This method is used by [CMFCMenuBar::IsShowAllCommands](../../mfc/reference/cmfcmenubar-class.md#cmfcmenubar__isshowallcommands) to determine whether to show all available menu commands.  \n  \n##  <a name=\"cmfccmdusagecount__isfreqeuntlyusedcmd\"></a>  CMFCCmdUsageCount::IsFreqeuntlyUsedCmd  \n Determines whether the given command is frequently used.  \n  \n```  \nBOOL IsFreqeuntlyUsedCmd(UINT uiCmd) const;\n\n \n```  \n  \n### Parameters  \n  \n|||  \n|-|-|  \n|Parameter|Description|  \n|[in] `uiCmd`|Specifies the command to check.|  \n  \n### Return Value  \n Nonzero if the command is frequently used; otherwise 0.  \n  \n### Remarks  \n This method returns 0 if the total command usage, `m_nTotalUsage`, is 0. Otherwise, this method returns nonzero if the percentage of which the specified command is used is larger than the minimum percentage, `m_nMinUsagePercentage`. By default, the framework sets the minimum percentage to 5. You can override this value by using the [CMFCCmdUsageCount::SetOptions](#cmfccmdusagecount__setoptions) method. If the minimum percentage is 0, this method returns nonzero if the specified command count is larger than 0.  \n  \n [CMFCToolBar::IsCommandRarelyUsed](../../mfc/reference/cmfctoolbar-class.md#cmfctoolbar__iscommandrarelyused) uses this method to determine whether a command is rarely used.  \n  \n##  <a name=\"cmfccmdusagecount__reset\"></a>  CMFCCmdUsageCount::Reset  \n Clears the usage count of all commands.  \n  \n```  \nvoid Reset();\n```  \n  \n### Remarks  \n Call this method to clear all entries from the map structure of command counts, `m_CmdUsage`, and to reset the total command usage, `m_nTotalUsage`, counter to 0.  \n  \n##  <a name=\"cmfccmdusagecount__serialize\"></a>  CMFCCmdUsageCount::Serialize  \n Reads this object from an archive, or writes it to an archive.  \n  \n```  \nvirtual void Serialize(CArchive& ar);\n```  \n  \n### Parameters  \n  \n|||  \n|-|-|  \n|Parameter|Description|  \n|[in] `ar`|A `CArchive` object to serialize from or to.|  \n  \n### Remarks  \n This method serializes the map structure of command counts, `m_CmdUsage`, and the total command usage, `m_nTotalUsage`, counter from or to the specified archive.  \n  \n For serialization examples, see [Serialization: Serializing an Object](../../mfc/serialization-serializing-an-object.md).  \n  \n##  <a name=\"cmfccmdusagecount__setoptions\"></a>  CMFCCmdUsageCount::SetOptions  \n Sets the values of shared `CMFCCmdUsageCount` class data members.  \n  \n```  \nstatic BOOL __stdcall SetOptions(\n    UINT nStartCount,  \n    UINT nMinUsagePercentage);\n```  \n  \n### Parameters  \n  \n|||  \n|-|-|  \n|Parameter|Description|  \n|[in] `nStartCount`|The new initial count of all tracked commands.|  \n|[in] `nMinUsagePercentage`|The new minimum usage percentage.|  \n  \n### Return Value  \n `TRUE` if the method succeeds, `FALSE` if the `nMinUsagePercentage` parameter is larger than or equal to 100.  \n  \n### Remarks  \n This method sets the shared `CMFCCmdUsageCount` class data members `m_nStartCount` and `m_nMinUsagePercentage` to `nStartCount` and `nMinUsagePercentage`, respectively. `m_nStartCount` is used by the [CMFCCmdUsageCount::HasEnoughInformation](#cmfccmdusagecount__hasenoughinformation) method to determine whether this object has collected the minimum amount of tracking data. `m_nMinUsagePercentage` is used by the [CMFCCmdUsageCount::IsFreqeuntlyUsedCmd](#cmfccmdusagecount__isfreqeuntlyusedcmd) method to determine whether a given command is frequently used.  \n  \n In Debug builds this method generates an assertion failure if the `nMinUsagePercentage` parameter is larger than or equal to 100.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CMFCToolBar Class](../../mfc/reference/cmfctoolbar-class.md)\n"}