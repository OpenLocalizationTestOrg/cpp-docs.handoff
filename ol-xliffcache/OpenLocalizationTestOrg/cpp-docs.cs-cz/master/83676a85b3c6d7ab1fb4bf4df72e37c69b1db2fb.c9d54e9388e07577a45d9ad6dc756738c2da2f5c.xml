{"nodes":[{"pos":[12,53],"content":"ODBC Classes and Threads | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ODBC Classes and Threads | Microsoft Docs","pos":[0,41]}]},{"content":"ODBC Classes and Threads","pos":[662,686]},{"content":"Beginning with MFC 4.2, there is multithreading support for the MFC ODBC classes.","pos":[687,768]},{"content":"Note, however, that MFC does not provide multithreading support for the DAO classes.","pos":[769,853]},{"content":"The multithreading support for the ODBC classes has some limitations.","pos":[860,929]},{"content":"Because these classes wrap the ODBC API, they are restricted to the multithreading support of the components on which they are built.","pos":[930,1063]},{"content":"For example, many ODBC drivers are not thread-safe; therefore, the MFC ODBC classes are not thread-safe if you use them with one of these drivers.","pos":[1064,1210]},{"content":"You should verify whether your particular driver is thread-safe.","pos":[1211,1275]},{"content":"When creating a multithreaded application, you should be very careful in using multiple threads to manipulate the same object.","pos":[1282,1408]},{"content":"For example, using the same <ph id=\"ph1\">`CRecordset`</ph> object in two threads might cause problems when retrieving data; a fetch operation in one thread might overwrite the data fetched in the other thread.","pos":[1409,1600],"source":" For example, using the same `CRecordset` object in two threads might cause problems when retrieving data; a fetch operation in one thread might overwrite the data fetched in the other thread."},{"content":"A more common use of the MFC ODBC classes in separate threads is to share an open <ph id=\"ph1\">`CDatabase`</ph> object across threads to use the same ODBC connection, with a separate <ph id=\"ph2\">`CRecordset`</ph> object in each thread.","pos":[1601,1801],"source":" A more common use of the MFC ODBC classes in separate threads is to share an open `CDatabase` object across threads to use the same ODBC connection, with a separate `CRecordset` object in each thread."},{"content":"Note that you should not pass an unopened <ph id=\"ph1\">`CDatabase`</ph> object to a <ph id=\"ph2\">`CRecordset`</ph> object in another thread.","pos":[1802,1906],"source":" Note that you should not pass an unopened `CDatabase` object to a `CRecordset` object in another thread."},{"pos":[1914,2245],"content":"[!NOTE]\n If you must have multiple threads manipulate the same object, you should implement the appropriate synchronization mechanisms, such as critical sections. Be aware that certain operations, such as **Open**, are not protected. You should be sure that these operations will not be called concurrently from separate threads.","leadings":["","> "],"nodes":[{"content":" If you must have multiple threads manipulate the same object, you should implement the appropriate synchronization mechanisms, such as critical sections. Be aware that certain operations, such as **Open**, are not protected. You should be sure that these operations will not be called concurrently from separate threads.","pos":[8,329],"nodes":[{"content":"If you must have multiple threads manipulate the same object, you should implement the appropriate synchronization mechanisms, such as critical sections.","pos":[1,154]},{"content":"Be aware that certain operations, such as <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>, are not protected.","pos":[155,225],"source":" Be aware that certain operations, such as **Open**, are not protected."},{"content":"You should be sure that these operations will not be called concurrently from separate threads.","pos":[226,321]}]}]},{"pos":[2252,2412],"content":"For more information about creating multithreaded applications, see <bpt id=\"p1\">[</bpt>Multithreading Topics<ept id=\"p1\">](../../parallel/multithreading-support-for-older-code-visual-cpp.md)</ept>.","source":"For more information about creating multithreaded applications, see [Multithreading Topics](../../parallel/multithreading-support-for-older-code-visual-cpp.md)."},{"content":"See Also","pos":[2421,2429]},{"content":"Open Database Connectivity (ODBC)","pos":[2434,2467]},{"content":"Data Access Programming (MFC/ATL)","pos":[2526,2559]}],"content":"---\ntitle: \"ODBC Classes and Threads | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ODBC classes, and threads\"\n  - \"ODBC, multithreaded applications\"\n  - \"threading [MFC], ODBC support\"\nms.assetid: 16543926-7331-41a6-ba50-72288f2a61b7\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# ODBC Classes and Threads\nBeginning with MFC 4.2, there is multithreading support for the MFC ODBC classes. Note, however, that MFC does not provide multithreading support for the DAO classes.  \n  \n The multithreading support for the ODBC classes has some limitations. Because these classes wrap the ODBC API, they are restricted to the multithreading support of the components on which they are built. For example, many ODBC drivers are not thread-safe; therefore, the MFC ODBC classes are not thread-safe if you use them with one of these drivers. You should verify whether your particular driver is thread-safe.  \n  \n When creating a multithreaded application, you should be very careful in using multiple threads to manipulate the same object. For example, using the same `CRecordset` object in two threads might cause problems when retrieving data; a fetch operation in one thread might overwrite the data fetched in the other thread. A more common use of the MFC ODBC classes in separate threads is to share an open `CDatabase` object across threads to use the same ODBC connection, with a separate `CRecordset` object in each thread. Note that you should not pass an unopened `CDatabase` object to a `CRecordset` object in another thread.  \n  \n> [!NOTE]\n>  If you must have multiple threads manipulate the same object, you should implement the appropriate synchronization mechanisms, such as critical sections. Be aware that certain operations, such as **Open**, are not protected. You should be sure that these operations will not be called concurrently from separate threads.  \n  \n For more information about creating multithreaded applications, see [Multithreading Topics](../../parallel/multithreading-support-for-older-code-visual-cpp.md).  \n  \n## See Also  \n [Open Database Connectivity (ODBC)](../../data/odbc/open-database-connectivity-odbc.md)   \n [Data Access Programming (MFC/ATL)](../../data/data-access-programming-mfc-atl.md)"}