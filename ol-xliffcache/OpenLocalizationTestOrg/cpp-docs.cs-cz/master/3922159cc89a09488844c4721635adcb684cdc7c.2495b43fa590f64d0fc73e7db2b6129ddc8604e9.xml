{"nodes":[{"pos":[12,75],"content":"Details of ATL Support Added by the ATL Wizard | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Details of ATL Support Added by the ATL Wizard | Microsoft Docs","pos":[0,63]}]},{"pos":[667,713],"content":"Details of ATL Support Added by the ATL Wizard","linkify":"Details of ATL Support Added by the ATL Wizard","nodes":[{"content":"Details of ATL Support Added by the ATL Wizard","pos":[0,46]}]},{"pos":[714,965],"content":"When you <bpt id=\"p1\">[</bpt>add ATL support to an existing MFC executable or DLL<ept id=\"p1\">](../../mfc/reference/adding-atl-support-to-your-mfc-project.md)</ept>, Visual C++ makes the following modifications to the existing MFC project (in this example, the project is called <ph id=\"ph1\">`MFCEXE`</ph>):","source":"When you [add ATL support to an existing MFC executable or DLL](../../mfc/reference/adding-atl-support-to-your-mfc-project.md), Visual C++ makes the following modifications to the existing MFC project (in this example, the project is called `MFCEXE`):"},{"content":"Two new files (an .idl file and an .rgs file, used to register the server) are added.","pos":[975,1060]},{"content":"In the main application header and implementation files (Mfcexe.h and Mfcexe.cpp), a new class (derived from <bpt id=\"p1\">**</bpt>CAtlMFCModule<ept id=\"p1\">**</ept>) is added.","pos":[1070,1207],"source":"In the main application header and implementation files (Mfcexe.h and Mfcexe.cpp), a new class (derived from **CAtlMFCModule**) is added."},{"content":"In addition to the new class, code is added to <ph id=\"ph1\">`InitInstance`</ph> for registration.","pos":[1208,1287],"source":" In addition to the new class, code is added to `InitInstance` for registration."},{"content":"Code is also added to the <ph id=\"ph1\">`ExitInstance`</ph> function for revoking the class object.","pos":[1288,1368],"source":" Code is also added to the `ExitInstance` function for revoking the class object."},{"content":"In the header file, Finally, two new header files (Initguid.h and Mfcexe_i.c) are included in the implementation file, declaring and initializing the new GUIDs for the <bpt id=\"p1\">**</bpt>CAtlMFCModule<ept id=\"p1\">**</ept>-derived class.","pos":[1369,1569],"source":" In the header file, Finally, two new header files (Initguid.h and Mfcexe_i.c) are included in the implementation file, declaring and initializing the new GUIDs for the **CAtlMFCModule**-derived class."},{"content":"To register the server properly, an entry for the new .rgs file is added to the project's resource file.","pos":[1579,1683]},{"pos":[1692,1714],"content":"Notes for DLL Projects","linkify":"Notes for DLL Projects","nodes":[{"content":"Notes for DLL Projects","pos":[0,22]}]},{"content":"When you add ATL support to an MFC DLL project, you will see some differences.","pos":[1718,1796]},{"content":"Code is added to the <bpt id=\"p1\">**</bpt>DLLRegisterServer<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>DLLUnregisterServer<ept id=\"p2\">**</ept> functions for registering and unregistering the DLL.","pos":[1797,1920],"source":" Code is added to the **DLLRegisterServer** and **DLLUnregisterServer** functions for registering and unregistering the DLL."},{"content":"Code is also added to <bpt id=\"p1\">[</bpt>DllCanUnloadNow<ept id=\"p1\">](../../atl/reference/catldllmodulet-class.md#catldllmodulet__dllcanunloadnow)</ept> and <bpt id=\"p2\">[</bpt>DllGetClassObject<ept id=\"p2\">](../../atl/reference/catldllmodulet-class.md#catldllmodulet__dllgetclassobject)</ept>.","pos":[1921,2141],"source":" Code is also added to [DllCanUnloadNow](../../atl/reference/catldllmodulet-class.md#catldllmodulet__dllcanunloadnow) and [DllGetClassObject](../../atl/reference/catldllmodulet-class.md#catldllmodulet__dllgetclassobject)."},{"pos":[2150,2158],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>ATL Support in an MFC Project<ept id=\"p1\">](../../mfc/reference/adding-atl-support-to-your-mfc-project.md)</ept><ph id=\"ph1\"> </ph>","pos":[2162,2257],"source":"[ATL Support in an MFC Project](../../mfc/reference/adding-atl-support-to-your-mfc-project.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Adding Functionality with Code Wizards<ept id=\"p1\">](../../ide/adding-functionality-with-code-wizards-cpp.md)</ept><ph id=\"ph1\"> </ph>","pos":[2260,2359],"source":" [Adding Functionality with Code Wizards](../../ide/adding-functionality-with-code-wizards-cpp.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Adding a Class<ept id=\"p1\">](../../ide/adding-a-class-visual-cpp.md)</ept><ph id=\"ph1\"> </ph>","pos":[2362,2420],"source":" [Adding a Class](../../ide/adding-a-class-visual-cpp.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Adding a Member Function<ept id=\"p1\">](../../ide/adding-a-member-function-visual-cpp.md)</ept><ph id=\"ph1\"> </ph>","pos":[2423,2501],"source":" [Adding a Member Function](../../ide/adding-a-member-function-visual-cpp.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Adding a Member Variable<ept id=\"p1\">](../../ide/adding-a-member-variable-visual-cpp.md)</ept><ph id=\"ph1\"> </ph>","pos":[2504,2582],"source":" [Adding a Member Variable](../../ide/adding-a-member-variable-visual-cpp.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Overriding a Virtual Function<ept id=\"p1\">](../../ide/overriding-a-virtual-function-visual-cpp.md)</ept><ph id=\"ph1\"> </ph>","pos":[2585,2673],"source":" [Overriding a Virtual Function](../../ide/overriding-a-virtual-function-visual-cpp.md) "},{"content":"<bpt id=\"p1\"> [</bpt>MFC Message Handler<ept id=\"p1\">](../../mfc/reference/adding-an-mfc-message-handler.md)</ept><ph id=\"ph1\"> </ph>","pos":[2676,2753],"source":" [MFC Message Handler](../../mfc/reference/adding-an-mfc-message-handler.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Navigating the Class Structure<ept id=\"p1\">](../../ide/navigating-the-class-structure-visual-cpp.md)</ept>","pos":[2756,2845],"source":" [Navigating the Class Structure](../../ide/navigating-the-class-structure-visual-cpp.md)"}],"content":"---\ntitle: \"Details of ATL Support Added by the ATL Wizard | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.codewiz.atl.support\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC, ATL support\"\n  - \"ATL, MFC projects\"\nms.assetid: aa66bad0-008f-4886-94c1-2a0a0d04bce4\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Details of ATL Support Added by the ATL Wizard\nWhen you [add ATL support to an existing MFC executable or DLL](../../mfc/reference/adding-atl-support-to-your-mfc-project.md), Visual C++ makes the following modifications to the existing MFC project (in this example, the project is called `MFCEXE`):  \n  \n-   Two new files (an .idl file and an .rgs file, used to register the server) are added.  \n  \n-   In the main application header and implementation files (Mfcexe.h and Mfcexe.cpp), a new class (derived from **CAtlMFCModule**) is added. In addition to the new class, code is added to `InitInstance` for registration. Code is also added to the `ExitInstance` function for revoking the class object. In the header file, Finally, two new header files (Initguid.h and Mfcexe_i.c) are included in the implementation file, declaring and initializing the new GUIDs for the **CAtlMFCModule**-derived class.  \n  \n-   To register the server properly, an entry for the new .rgs file is added to the project's resource file.  \n  \n## Notes for DLL Projects  \n When you add ATL support to an MFC DLL project, you will see some differences. Code is added to the **DLLRegisterServer** and **DLLUnregisterServer** functions for registering and unregistering the DLL. Code is also added to [DllCanUnloadNow](../../atl/reference/catldllmodulet-class.md#catldllmodulet__dllcanunloadnow) and [DllGetClassObject](../../atl/reference/catldllmodulet-class.md#catldllmodulet__dllgetclassobject).  \n  \n## See Also  \n [ATL Support in an MFC Project](../../mfc/reference/adding-atl-support-to-your-mfc-project.md)   \n [Adding Functionality with Code Wizards](../../ide/adding-functionality-with-code-wizards-cpp.md)   \n [Adding a Class](../../ide/adding-a-class-visual-cpp.md)   \n [Adding a Member Function](../../ide/adding-a-member-function-visual-cpp.md)   \n [Adding a Member Variable](../../ide/adding-a-member-variable-visual-cpp.md)   \n [Overriding a Virtual Function](../../ide/overriding-a-virtual-function-visual-cpp.md)   \n [MFC Message Handler](../../mfc/reference/adding-an-mfc-message-handler.md)   \n [Navigating the Class Structure](../../ide/navigating-the-class-structure-visual-cpp.md)\n"}