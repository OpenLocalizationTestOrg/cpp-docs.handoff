{"nodes":[{"pos":[12,53],"content":"COM Map Global Functions | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COM Map Global Functions | Microsoft Docs","pos":[0,41]}]},{"content":"COM Map Global Functions","pos":[605,629]},{"pos":[630,703],"content":"These functions provide support for COM Map <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> implementations.","source":"These functions provide support for COM Map **IUnknown** implementations."},{"content":"AtlInternalQueryInterface","pos":[725,750]},{"pos":[780,836],"content":"Delegates to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> of a nonaggregated object.","source":"Delegates to the **IUnknown** of a nonaggregated object."},{"content":"InlineIsEqualIUnknown","pos":[842,863]},{"pos":[889,960],"content":"Generates efficient code for comparing interfaces against <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>.","source":"Generates efficient code for comparing interfaces against **IUnknown**."},{"pos":[1013,1038],"content":"AtlInternalQueryInterface"},{"content":"Retrieves a pointer to the requested interface.","pos":[1042,1089]},{"content":"Parameters","pos":[1246,1256]},{"content":"[in] A pointer to the object that contains the COM map of interfaces exposed to <ph id=\"ph1\">`QueryInterface`</ph>.","pos":[1271,1368],"source":" [in] A pointer to the object that contains the COM map of interfaces exposed to `QueryInterface`."},{"content":"[in] An array of <bpt id=\"p1\">**</bpt>_ATL_INTMAP_ENTRY<ept id=\"p1\">**</ept> structures that access a map of available interfaces.","pos":[1389,1481],"source":" [in] An array of **_ATL_INTMAP_ENTRY** structures that access a map of available interfaces."},{"content":"[in] The GUID of the interface being requested.","pos":[1497,1544]},{"content":"[out] A pointer to the interface pointer specified in <ph id=\"ph1\">`iid`</ph>, or <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the interface is not found.","pos":[1566,1669],"source":" [out] A pointer to the interface pointer specified in `iid`, or **NULL** if the interface is not found."},{"content":"Return Value","pos":[1679,1691]},{"content":"One of the standard HRESULT values.","pos":[1695,1730]},{"content":"Remarks","pos":[1740,1747]},{"content":"only handles interfaces in the COM map table.","pos":[1779,1824]},{"content":"If your object is aggregated, <ph id=\"ph1\">`AtlInternalQueryInterface`</ph> does not delegate to the outer unknown.","pos":[1825,1922],"source":" If your object is aggregated, `AtlInternalQueryInterface` does not delegate to the outer unknown."},{"content":"You can enter interfaces into the COM map table with the macro <bpt id=\"p1\">[</bpt>COM_INTERFACE_ENTRY<ept id=\"p1\">](http://msdn.microsoft.com/library/19dcb768-2e1f-4b8d-a618-453a01a4bd00)</ept> or one of its variants.","pos":[1923,2103],"source":" You can enter interfaces into the COM map table with the macro [COM_INTERFACE_ENTRY](http://msdn.microsoft.com/library/19dcb768-2e1f-4b8d-a618-453a01a4bd00) or one of its variants."},{"content":"Example","pos":[2113,2120]},{"pos":[2135,2155],"content":"NVC_ATL_Windowing#94"},{"pos":[2263,2284],"content":"InlineIsEqualIUnknown"},{"pos":[2288,2357],"content":"Call this function, for the special case of testing for <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>.","source":"Call this function, for the special case of testing for **IUnknown**."},{"content":"Parameters","pos":[2423,2433]},{"content":"rguid1","pos":[2438,2444]},{"content":"[in] The GUID to compare to <bpt id=\"p1\">**</bpt>IID_IUnknown<ept id=\"p1\">**</ept>.","pos":[2449,2494],"source":" [in] The GUID to compare to **IID_IUnknown**."},{"content":"See Also","pos":[2503,2511]},{"content":"Functions","pos":[2516,2525]},{"content":"COM Map Macros","pos":[2570,2584]}],"content":"---\ntitle: \"COM Map Global Functions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"COM interfaces, COM map global functions\"\nms.assetid: b9612d30-eb23-46ef-8093-d56f237d3cf1\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COM Map Global Functions\nThese functions provide support for COM Map **IUnknown** implementations.  \n  \n|||  \n|-|-|  \n|[AtlInternalQueryInterface](#atlinternalqueryinterface)|Delegates to the **IUnknown** of a nonaggregated object.|  \n|[InlineIsEqualIUnknown](#inlineisequaliunknown)|Generates efficient code for comparing interfaces against **IUnknown**.|  \n  \n##  <a name=\"atlinternalqueryinterface\"></a>  AtlInternalQueryInterface  \n Retrieves a pointer to the requested interface.  \n  \n```\nHRESULT     AtlInternalQueryInterface(\n    void* pThis,\n    const _ATL_INTMAP_ENTRY* pEntries,\n    REFIID iid,\n    void** ppvObject);\n```  \n  \n### Parameters  \n `pThis`  \n [in] A pointer to the object that contains the COM map of interfaces exposed to `QueryInterface`.  \n  \n `pEntries`  \n [in] An array of **_ATL_INTMAP_ENTRY** structures that access a map of available interfaces.  \n  \n `iid`  \n [in] The GUID of the interface being requested.  \n  \n `ppvObject`  \n [out] A pointer to the interface pointer specified in `iid`, or **NULL** if the interface is not found.  \n  \n### Return Value  \n One of the standard HRESULT values.  \n  \n### Remarks  \n `AtlInternalQueryInterface` only handles interfaces in the COM map table. If your object is aggregated, `AtlInternalQueryInterface` does not delegate to the outer unknown. You can enter interfaces into the COM map table with the macro [COM_INTERFACE_ENTRY](http://msdn.microsoft.com/library/19dcb768-2e1f-4b8d-a618-453a01a4bd00) or one of its variants.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#94](../../atl/codesnippet/cpp/com-map-global-functions_1.cpp)]  \n  \n##  <a name=\"inlineisequaliunknown\"></a>  InlineIsEqualIUnknown  \n Call this function, for the special case of testing for **IUnknown**.  \n  \n```\nBOOL InlineIsEqualUnknown(REFGUID rguid1);\n```  \n  \n### Parameters  \n *rguid1*  \n [in] The GUID to compare to **IID_IUnknown**.  \n  \n## See Also  \n [Functions](../../atl/reference/atl-functions.md)   \n [COM Map Macros](../../atl/reference/com-map-macros.md)\n"}