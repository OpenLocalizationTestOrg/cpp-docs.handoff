{"nodes":[{"pos":[12,55],"content":"CAtlAutoThreadModule Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CAtlAutoThreadModule Class | Microsoft Docs","pos":[0,43]}]},{"pos":[697,723],"content":"CAtlAutoThreadModule Class","linkify":"CAtlAutoThreadModule Class","nodes":[{"content":"CAtlAutoThreadModule Class","pos":[0,26]}]},{"content":"This class implements a thread-pooled, apartment-model COM server.","pos":[724,790]},{"pos":[798,908],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"pos":[917,923],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1026,1033],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`CAtlAutoThreadModule`</ph> derives from <bpt id=\"p1\">[</bpt>CAtlAutoThreadModuleT<ept id=\"p1\">](../../atl/reference/catlautothreadmodulet-class.md)</ept> and implements a thread-pooled, apartment-model COM server.","pos":[1037,1208],"source":"`CAtlAutoThreadModule` derives from [CAtlAutoThreadModuleT](../../atl/reference/catlautothreadmodulet-class.md) and implements a thread-pooled, apartment-model COM server."},{"content":"<ph id=\"ph1\">`CAtlAutoThreadModule`</ph> uses <bpt id=\"p1\">[</bpt>CComApartment<ept id=\"p1\">](../../atl/reference/ccomapartment-class.md)</ept> to manage an apartment for each thread in the module.","pos":[1209,1350],"source":"`CAtlAutoThreadModule` uses [CComApartment](../../atl/reference/ccomapartment-class.md) to manage an apartment for each thread in the module."},{"content":"You must use the <bpt id=\"p1\">[</bpt>DECLARE_CLASSFACTORY_AUTO_THREAD<ept id=\"p1\">](http://msdn.microsoft.com/library/19d7105e-03e8-4412-9f5e-5384c8a5e18f)</ept> macro in your object's class definition to specify <bpt id=\"p2\">[</bpt>CComClassFactoryAutoThread<ept id=\"p2\">](../../atl/reference/ccomclassfactoryautothread-class.md)</ept> as the class factory.","pos":[1357,1639],"source":"You must use the [DECLARE_CLASSFACTORY_AUTO_THREAD](http://msdn.microsoft.com/library/19d7105e-03e8-4412-9f5e-5384c8a5e18f) macro in your object's class definition to specify [CComClassFactoryAutoThread](../../atl/reference/ccomclassfactoryautothread-class.md) as the class factory."},{"content":"You should then add a single instance of a class derived from <ph id=\"ph1\">`CAtlAutoThreadModuleT`</ph> such as <ph id=\"ph2\">`CAtlAutoThreadModule`</ph>.","pos":[1640,1757],"source":" You should then add a single instance of a class derived from `CAtlAutoThreadModuleT` such as `CAtlAutoThreadModule`."},{"content":"For example:","pos":[1758,1770]},{"pos":[1846,1970],"content":"[!NOTE]\n This class replaces the obsolete [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) class.","leadings":["","> "],"nodes":[{"content":"This class replaces the obsolete <bpt id=\"p1\">[</bpt>CComAutoThreadModule<ept id=\"p1\">](../../atl/reference/ccomautothreadmodule-class.md)</ept> class.","pos":[9,122],"source":" This class replaces the obsolete [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) class."}]},{"pos":[1979,2000],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2033,2108],"content":"<bpt id=\"p1\">[</bpt>CAtlAutoThreadModuleT<ept id=\"p1\">](../../atl/reference/catlautothreadmodulet-class.md)</ept>","source":"[CAtlAutoThreadModuleT](../../atl/reference/catlautothreadmodulet-class.md)"},{"pos":[2146,2158],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2162,2183],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlbase.h","source":"**Header:** atlbase.h"},{"pos":[2192,2200],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CAtlAutoThreadModuleT Class<ept id=\"p1\">](../../atl/reference/catlautothreadmodulet-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[2204,2286],"source":"[CAtlAutoThreadModuleT Class](../../atl/reference/catlautothreadmodulet-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IAtlAutoThreadModule Class<ept id=\"p1\">](../../atl/reference/iatlautothreadmodule-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[2289,2370],"source":" [IAtlAutoThreadModule Class](../../atl/reference/iatlautothreadmodule-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept><ph id=\"ph1\"> </ph>","pos":[2373,2424],"source":" [Class Overview](../../atl/atl-class-overview.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Module Classes<ept id=\"p1\">](../../atl/atl-module-classes.md)</ept>","pos":[2427,2477],"source":" [Module Classes](../../atl/atl-module-classes.md)"}],"content":"---\ntitle: \"CAtlAutoThreadModule Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL.CAtlAutoThreadModule\"\n  - \"CAtlAutoThreadModule\"\n  - \"ATL::CAtlAutoThreadModule\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CAtlAutoThreadModule class\"\nms.assetid: 3be834aa-55ef-403e-94ae-41979691b15f\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CAtlAutoThreadModule Class\nThis class implements a thread-pooled, apartment-model COM server.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\nclass CAtlAutoThreadModule :  public CAtlAutoThreadModuleT<CAtlAutoThreadModule>\n```  \n  \n## Remarks  \n `CAtlAutoThreadModule` derives from [CAtlAutoThreadModuleT](../../atl/reference/catlautothreadmodulet-class.md) and implements a thread-pooled, apartment-model COM server. `CAtlAutoThreadModule` uses [CComApartment](../../atl/reference/ccomapartment-class.md) to manage an apartment for each thread in the module.  \n  \n You must use the [DECLARE_CLASSFACTORY_AUTO_THREAD](http://msdn.microsoft.com/library/19d7105e-03e8-4412-9f5e-5384c8a5e18f) macro in your object's class definition to specify [CComClassFactoryAutoThread](../../atl/reference/ccomclassfactoryautothread-class.md) as the class factory. You should then add a single instance of a class derived from `CAtlAutoThreadModuleT` such as `CAtlAutoThreadModule`. For example:  \n  \n `CAtlAutoThreadModule _AtlAutoModule; // name is immaterial.`  \n  \n> [!NOTE]\n>  This class replaces the obsolete [CComAutoThreadModule](../../atl/reference/ccomautothreadmodule-class.md) class.  \n  \n## Inheritance Hierarchy  \n `IAtlAutoThreadModule`  \n  \n [CAtlAutoThreadModuleT](../../atl/reference/catlautothreadmodulet-class.md)  \n  \n `CAtlAutoThreadModule`  \n  \n## Requirements  \n **Header:** atlbase.h  \n  \n## See Also  \n [CAtlAutoThreadModuleT Class](../../atl/reference/catlautothreadmodulet-class.md)   \n [IAtlAutoThreadModule Class](../../atl/reference/iatlautothreadmodule-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)   \n [Module Classes](../../atl/atl-module-classes.md)"}