{"nodes":[{"pos":[12,58],"content":"Adding an ATL OLE DB Consumer | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Adding an ATL OLE DB Consumer | Microsoft Docs","pos":[0,46]}]},{"pos":[691,720],"content":"Adding an ATL OLE DB Consumer","linkify":"Adding an ATL OLE DB Consumer","nodes":[{"content":"Adding an ATL OLE DB Consumer","pos":[0,29]}]},{"content":"Use this wizard to add an ATL OLE DB consumer to a project.","pos":[721,780]},{"content":"An ATL OLE DB consumer consists of an OLE DB accessor class and data bindings necessary to access a data source.","pos":[781,893]},{"content":"The project must have been created as an ATL COM application, or as an MFC or Win32 application that contains ATL support (which the ATL OLE DB Consumer Wizard adds automatically).","pos":[894,1074]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> You can add an OLE DB consumer to an MFC project.","pos":[1081,1139],"source":"**Note** You can add an OLE DB consumer to an MFC project."},{"content":"If you do, the ATL OLE DB Consumer Wizard adds the necessary COM support to your project.","pos":[1140,1229]},{"content":"This assumes that when you created the MFC project, you selected the <bpt id=\"p1\">**</bpt>ActiveX controls<ept id=\"p1\">**</ept> check box (in the <bpt id=\"p2\">**</bpt>Advanced Features<ept id=\"p2\">**</ept> page of the MFC Project Application Wizard), which is checked by default.","pos":[1230,1433],"source":" This assumes that when you created the MFC project, you selected the **ActiveX controls** check box (in the **Advanced Features** page of the MFC Project Application Wizard), which is checked by default."},{"content":"Selecting this option ensures that the application calls <bpt id=\"p1\">**</bpt>CoInitialize<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>CoUninitialize<ept id=\"p2\">**</ept>.","pos":[1434,1531],"source":" Selecting this option ensures that the application calls **CoInitialize** and **CoUninitialize**."},{"content":"If you did not select <bpt id=\"p1\">**</bpt>ActiveX controls<ept id=\"p1\">**</ept> when you created the MFC project, you need to call <bpt id=\"p2\">**</bpt>CoInitialize<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>CoUninitialize<ept id=\"p3\">**</ept> in your main code.","pos":[1532,1684],"source":" If you did not select **ActiveX controls** when you created the MFC project, you need to call **CoInitialize** and **CoUninitialize** in your main code."},{"pos":[1694,1739],"content":"To add an ATL OLE DB consumer to your project","linkify":"To add an ATL OLE DB consumer to your project","nodes":[{"content":"To add an ATL OLE DB consumer to your project","pos":[0,45]}]},{"content":"In Class View, right-click the project.","pos":[1749,1788]},{"content":"On the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Class<ept id=\"p2\">**</ept>.","pos":[1789,1854],"source":" On the shortcut menu, click **Add** and then click **Add Class**."},{"pos":[1864,1968],"content":"In the Visual C++ folder, double-click the <bpt id=\"p1\">**</bpt>ATL OLE DB Consumer<ept id=\"p1\">**</ept> icon or select it and click <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","source":"In the Visual C++ folder, double-click the **ATL OLE DB Consumer** icon or select it and click **Open**."},{"content":"The ATL OLE DB Consumer Wizard opens.","pos":[1979,2016]},{"pos":[2026,2138],"content":"Define settings as described in <bpt id=\"p1\">[</bpt>ATL OLE DB Consumer Wizard<ept id=\"p1\">](../../atl/reference/atl-ole-db-consumer-wizard.md)</ept>.","source":"Define settings as described in [ATL OLE DB Consumer Wizard](../../atl/reference/atl-ole-db-consumer-wizard.md)."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to close the wizard.","pos":[2148,2185],"source":"Click **Finish** to close the wizard."},{"content":"The newly created OLE DB consumer code will be inserted in your project.","pos":[2186,2258]},{"pos":[2267,2275],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[2279,2376],"content":"<bpt id=\"p1\">[</bpt>Adding Functionality with Code Wizards<ept id=\"p1\">](../../ide/adding-functionality-with-code-wizards-cpp.md)</ept>","source":"[Adding Functionality with Code Wizards](../../ide/adding-functionality-with-code-wizards-cpp.md)"}],"content":"---\ntitle: \"Adding an ATL OLE DB Consumer | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ATL projects, adding ATL OLE DB consumers\"\n  - \"OLE DB, adding ATL OLE DB consumer to projects\"\n  - \"ATL OLE DB consumers\"\nms.assetid: f940a513-4e42-4148-b521-dd0d7dc89fa2\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Adding an ATL OLE DB Consumer\nUse this wizard to add an ATL OLE DB consumer to a project. An ATL OLE DB consumer consists of an OLE DB accessor class and data bindings necessary to access a data source. The project must have been created as an ATL COM application, or as an MFC or Win32 application that contains ATL support (which the ATL OLE DB Consumer Wizard adds automatically).  \n  \n **Note** You can add an OLE DB consumer to an MFC project. If you do, the ATL OLE DB Consumer Wizard adds the necessary COM support to your project. This assumes that when you created the MFC project, you selected the **ActiveX controls** check box (in the **Advanced Features** page of the MFC Project Application Wizard), which is checked by default. Selecting this option ensures that the application calls **CoInitialize** and **CoUninitialize**. If you did not select **ActiveX controls** when you created the MFC project, you need to call **CoInitialize** and **CoUninitialize** in your main code.  \n  \n### To add an ATL OLE DB consumer to your project  \n  \n1.  In Class View, right-click the project. On the shortcut menu, click **Add** and then click **Add Class**.  \n  \n2.  In the Visual C++ folder, double-click the **ATL OLE DB Consumer** icon or select it and click **Open**.  \n  \n     The ATL OLE DB Consumer Wizard opens.  \n  \n3.  Define settings as described in [ATL OLE DB Consumer Wizard](../../atl/reference/atl-ole-db-consumer-wizard.md).  \n  \n4.  Click **Finish** to close the wizard. The newly created OLE DB consumer code will be inserted in your project.  \n  \n## See Also  \n [Adding Functionality with Code Wizards](../../ide/adding-functionality-with-code-wizards-cpp.md)\n\n"}