{"nodes":[{"pos":[12,71],"content":"Windows Runtime C++ Template Library (WRL) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Windows Runtime C++ Template Library (WRL) | Microsoft Docs","pos":[0,59]}]},{"content":"Windows Runtime C++ Template Library (WRL)","pos":[580,622]},{"pos":[623,881],"content":"The <ph id=\"ph1\">[!INCLUDE[cppwrl](../windows/includes/cppwrl_md.md)]</ph> (<ph id=\"ph2\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph>) is a template library that provides a low-level way to author and use <ph id=\"ph3\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> components.","source":"The [!INCLUDE[cppwrl](../windows/includes/cppwrl_md.md)] ([!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]) is a template library that provides a low-level way to author and use [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] components."},{"content":"Benefits","pos":[890,898]},{"content":"The <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> enables you to more easily implement and consume Component Object Model (COM) components.","pos":[902,1060],"source":"The [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] enables you to more easily implement and consume Component Object Model (COM) components."},{"content":"It provides housekeeping techniques like reference-counting to manage the lifetime of objects and testing <ph id=\"ph1\">`HRESULT`</ph> values to determine whether an operation succeeded or failed.","pos":[1061,1238],"source":" It provides housekeeping techniques like reference-counting to manage the lifetime of objects and testing `HRESULT` values to determine whether an operation succeeded or failed."},{"content":"To successfully use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph>, you must carefully follow these rules and techniques.","pos":[1239,1382],"source":" To successfully use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)], you must carefully follow these rules and techniques."},{"content":"The <ph id=\"ph1\">[!INCLUDE[cppwrt](../build/reference/includes/cppwrt_md.md)]</ph> (<ph id=\"ph2\">[!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]</ph>) is a high-level, language-based way to use <ph id=\"ph3\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> components.","pos":[1389,1636],"source":"The [!INCLUDE[cppwrt](../build/reference/includes/cppwrt_md.md)] ([!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]) is a high-level, language-based way to use [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] components."},{"content":"Both the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]</ph> simplify the writing of code for the <ph id=\"ph3\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> by automatically performing housekeeping tasks on your behalf.","pos":[1637,1940],"source":" Both the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] and [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)] simplify the writing of code for the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] by automatically performing housekeeping tasks on your behalf."},{"content":"The <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> and <ph id=\"ph2\">[!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]</ph> provide different benefits.","pos":[1947,2120],"source":"The [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] and [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)] provide different benefits."},{"content":"Here are some reasons you might want to use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> instead of <ph id=\"ph2\">[!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]</ph>:","pos":[2121,2318],"source":" Here are some reasons you might want to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] instead of [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]:"},{"pos":[2393,2655],"content":"adds little abstraction over the <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> Application Binary Interface (ABI), giving you the ability to control the underlying code to better create or consume <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> APIs.","source":" adds little abstraction over the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] Application Binary Interface (ABI), giving you the ability to control the underlying code to better create or consume [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] APIs."},{"content":"represents COM <ph id=\"ph1\">`HRESULT`</ph> values as exceptions.","pos":[2738,2784],"source":" represents COM `HRESULT` values as exceptions."},{"content":"If you’ve inherited a code base that uses COM, or one that doesn’t use exceptions, you might find that the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> is a more natural way to work with the <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> because you don't have to use exceptions.","pos":[2785,3090],"source":" If you’ve inherited a code base that uses COM, or one that doesn’t use exceptions, you might find that the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] is a more natural way to work with the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] because you don't have to use exceptions."},{"pos":[3102,3641],"content":"[!NOTE]\n The [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses `HRESULT` values and does not throw exceptions. In addition, the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses smart pointers and the RAII pattern to help guarantee that objects are destroyed correctly when your application code throws an exception. For more info about smart pointers and RAII, see [Smart Pointers](../cpp/smart-pointers-modern-cpp.md) and [Objects Own Resources (RAII)](../cpp/objects-own-resources-raii.md).","leadings":["","    > "],"nodes":[{"content":" The [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses `HRESULT` values and does not throw exceptions. In addition, the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses smart pointers and the RAII pattern to help guarantee that objects are destroyed correctly when your application code throws an exception. For more info about smart pointers and RAII, see [Smart Pointers](../cpp/smart-pointers-modern-cpp.md) and [Objects Own Resources (RAII)](../cpp/objects-own-resources-raii.md).","pos":[8,533],"nodes":[{"content":"The <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> uses <ph id=\"ph2\">`HRESULT`</ph> values and does not throw exceptions.","pos":[1,122],"source":" The [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses `HRESULT` values and does not throw exceptions."},{"content":"In addition, the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> uses smart pointers and the RAII pattern to help guarantee that objects are destroyed correctly when your application code throws an exception.","pos":[123,348],"source":" In addition, the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses smart pointers and the RAII pattern to help guarantee that objects are destroyed correctly when your application code throws an exception."},{"content":"For more info about smart pointers and RAII, see <bpt id=\"p1\">[</bpt>Smart Pointers<ept id=\"p1\">](../cpp/smart-pointers-modern-cpp.md)</ept> and <bpt id=\"p2\">[</bpt>Objects Own Resources (RAII)<ept id=\"p2\">](../cpp/objects-own-resources-raii.md)</ept>.","pos":[349,525],"source":" For more info about smart pointers and RAII, see [Smart Pointers](../cpp/smart-pointers-modern-cpp.md) and [Objects Own Resources (RAII)](../cpp/objects-own-resources-raii.md)."}]}]},{"content":"The purpose and design of the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> is inspired by the Active Template Library (ATL), which is a set of template-based C++ classes that simplify the programming of COM objects.","pos":[3651,3886],"source":"The purpose and design of the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] is inspired by the Active Template Library (ATL), which is a set of template-based C++ classes that simplify the programming of COM objects."},{"content":"Because <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> uses standard C++ to wrap the <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph>, you can more easily port and interact with many existing COM components written in ATL to the <ph id=\"ph3\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph>.","pos":[3887,4191],"source":" Because [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses standard C++ to wrap the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], you can more easily port and interact with many existing COM components written in ATL to the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]."},{"content":"If you already know ATL, you might find that <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> programming is easier.","pos":[4192,4324],"source":" If you already know ATL, you might find that [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] programming is easier."},{"content":"Getting Started","pos":[4333,4348]},{"pos":[4352,4491],"content":"Here are some resources that can help you get working with the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> right away.","source":"Here are some resources that can help you get working with the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] right away."},{"content":"The Windows Runtime Library (WRL)","pos":[4499,4532]},{"content":"In this Channel 9 video, learn more about how the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> helps you write <ph id=\"ph2\">[!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)]</ph> apps and how to author and consume <ph id=\"ph3\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> components.","pos":[4661,4964],"source":" In this Channel 9 video, learn more about how the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] helps you write [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] apps and how to author and consume [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] components."},{"content":"How to: Activate and Use a Windows Runtime Component","pos":[4972,5024]},{"content":"Shows how to use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> to initialize the <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> and activate and use a <ph id=\"ph3\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> component.","pos":[5106,5349],"source":" Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to initialize the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] and activate and use a [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component."},{"content":"How to: Complete Asynchronous Operations","pos":[5357,5397]},{"content":"Shows how to use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> to start asynchronous operations and perform work when the operations complete.","pos":[5467,5632],"source":" Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to start asynchronous operations and perform work when the operations complete."},{"content":"How to: Handle Events","pos":[5640,5661]},{"content":"Shows how to use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> to subscribe to and handle the events of a <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> object.","pos":[5712,5901],"source":" Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to subscribe to and handle the events of a [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] object."},{"content":"Walkthrough: Creating a Basic Windows Runtime Component","pos":[5909,5964]},{"content":"Shows how to use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> to create a basic <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> component that adds two numbers.","pos":[6049,6238],"source":" Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to create a basic [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component that adds two numbers."},{"content":"Also demonstrates how to raise events and use the component from a <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)]</ph> app that uses JavaScript.","pos":[6239,6404],"source":" Also demonstrates how to raise events and use the component from a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app that uses JavaScript."},{"content":"Walkthrough: Creating a Windows Store app using WRL and Media Foundation","pos":[6412,6484]},{"content":"Learn how to create a <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)]</ph> app that uses <bpt id=\"p1\">[</bpt>Microsoft Media Foundation<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/apps/ms694197)</ept>.","pos":[6576,6771],"source":" Learn how to create a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app that uses [Microsoft Media Foundation](http://msdn.microsoft.com/library/windows/apps/ms694197)."},{"content":"How to: Create a Classic COM Component","pos":[6779,6817]},{"content":"Shows how to use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> to create a basic COM component and a basic way to register and consume the COM component from a desktop app.","pos":[6885,7080],"source":" Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to create a basic COM component and a basic way to register and consume the COM component from a desktop app."},{"content":"How to: Instantiate WRL Components Directly","pos":[7088,7131]},{"content":"Learn how to use the <bpt id=\"p1\">[</bpt>Microsoft::WRL::Make<ept id=\"p1\">](../windows/make-function.md)</ept> and <bpt id=\"p2\">[</bpt>Microsoft::WRL::Details::MakeAndInitialize<ept id=\"p2\">](../windows/makeandinitialize-function.md)</ept> functions to instantiate a component from the module that defines it.","pos":[7194,7427],"source":" Learn how to use the [Microsoft::WRL::Make](../windows/make-function.md) and [Microsoft::WRL::Details::MakeAndInitialize](../windows/makeandinitialize-function.md) functions to instantiate a component from the module that defines it."},{"content":"How to: Use winmdidl.exe and midlrt.exe to create .h files from windows metadata","pos":[7435,7515]},{"content":"Shows how to consume custom Windows Runtime components from WRL by creating an IDL file from the .winmd metadata.","pos":[7599,7712]},{"content":"Walkthrough: Connecting Using Tasks and XML HTTP Requests","pos":[7720,7777]},{"content":"Shows how to use the <bpt id=\"p1\">[</bpt>IXMLHTTPRequest2<ept id=\"p1\">](http://msdn.microsoft.com/en-us/bbc11c4a-aecf-4d6d-8275-3e852e309908)</ept> and <bpt id=\"p2\">[</bpt>IXMLHTTPRequest2Callback<ept id=\"p2\">](http://msdn.microsoft.com/en-us/aa4b3f4c-6e28-458b-be25-6cce8865fc71)</ept> interfaces together with tasks to send HTTP GET and POST requests to a web service in a <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)]</ph> app.","pos":[7862,8238],"source":" Shows how to use the [IXMLHTTPRequest2](http://msdn.microsoft.com/en-us/bbc11c4a-aecf-4d6d-8275-3e852e309908) and [IXMLHTTPRequest2Callback](http://msdn.microsoft.com/en-us/aa4b3f4c-6e28-458b-be25-6cce8865fc71) interfaces together with tasks to send HTTP GET and POST requests to a web service in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app."},{"content":"Bing Maps Trip Optimizer sample","pos":[8246,8277]},{"content":"Uses the <ph id=\"ph1\">`HttpRequest`</ph> class that's defined in <bpt id=\"p1\">[</bpt>Walkthrough: Connecting Using Tasks and XML HTTP Requests<ept id=\"p1\">](../parallel/concrt/walkthrough-connecting-using-tasks-and-xml-http-requests.md)</ept> in the context of a complete <ph id=\"ph2\">[!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)]</ph> app.","pos":[8348,8641],"source":" Uses the `HttpRequest` class that's defined in [Walkthrough: Connecting Using Tasks and XML HTTP Requests](../parallel/concrt/walkthrough-connecting-using-tasks-and-xml-http-requests.md) in the context of a complete [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app."},{"content":"Creating a Windows Runtime DLL component with C++ sample","pos":[8649,8705]},{"content":"Shows how to use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> to create an in-process DLL component and consume it from C++/CX, JavaScript, and C#.","pos":[8790,8961],"source":" Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to create an in-process DLL component and consume it from C++/CX, JavaScript, and C#."},{"content":"DirectX marble maze game sample","pos":[8969,9000]},{"content":"Demonstrates how to use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> to manage the lifetime of COM components such as DirectX and Media Foundation in the context of a complete 3-D game.","pos":[9083,9292],"source":" Demonstrates how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to manage the lifetime of COM components such as DirectX and Media Foundation in the context of a complete 3-D game."},{"content":"Sending toast notifications from desktop apps sample","pos":[9300,9352]},{"content":"Demonstrates how to use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> to work with toast notifications from a desktop app.","pos":[9441,9586],"source":" Demonstrates how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to work with toast notifications from a desktop app."},{"pos":[9660,9675],"content":"Compared to ATL"},{"content":"resembles the Active Template Library (ATL) because you can use it to create small, fast COM objects.","pos":[9744,9845]},{"content":"and ATL also share concepts such as definition of objects in modules, explicit registration of interfaces, and open creation of objects by using factories.","pos":[9911,10066]},{"content":"You might be comfortable with <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> if you're familiar with ATL.","pos":[10067,10190],"source":" You might be comfortable with [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] if you're familiar with ATL."},{"content":"supports the COM functionality that is required for <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)]</ph> apps.","pos":[10262,10392],"source":" supports the COM functionality that is required for [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] apps."},{"content":"Therefore, it differs from the ATL because it omits direct support for COM features such as:","pos":[10393,10485]},{"content":"aggregation","pos":[10495,10506]},{"content":"stock implementations","pos":[10516,10537]},{"pos":[10547,10576],"content":"dual interfaces (<ph id=\"ph1\">`IDispatch`</ph>)","source":"dual interfaces (`IDispatch`)"},{"content":"standard enumerator interfaces","pos":[10586,10616]},{"content":"connection points","pos":[10626,10643]},{"content":"tear-off interfaces","pos":[10653,10672]},{"content":"OLE embedding","pos":[10682,10695]},{"content":"ActiveX controls","pos":[10705,10721]},{"content":"COM+","pos":[10731,10735]},{"content":"Concepts","pos":[10744,10752]},{"content":"provides types that represent a few basic concepts.","pos":[10821,10872]},{"content":"The following sections describe those types.","pos":[10873,10917]},{"content":"ComPtr","pos":[10927,10933]},{"content":"<bpt id=\"p1\">[</bpt>ComPtr<ept id=\"p1\">](../windows/comptr-class.md)</ept> is a <bpt id=\"p2\">*</bpt>smart pointer<ept id=\"p2\">*</ept> type that represents the interface that's specified by the template parameter.","pos":[10937,11073],"source":"[ComPtr](../windows/comptr-class.md) is a *smart pointer* type that represents the interface that's specified by the template parameter."},{"content":"Use <ph id=\"ph1\">`ComPtr`</ph> to declare a variable that can access the members of an object that's derived from the interface.","pos":[11074,11184],"source":" Use `ComPtr` to declare a variable that can access the members of an object that's derived from the interface."},{"content":"automatically maintains a reference count for the underlying interface pointer and releases the interface when the reference count goes to zero.","pos":[11194,11338]},{"content":"RuntimeClass","pos":[11348,11360]},{"content":"<bpt id=\"p1\">[</bpt>RuntimeClass<ept id=\"p1\">](../windows/runtimeclass-class.md)</ept> represents an instantiated class that inherits a set of specified interfaces.","pos":[11364,11490],"source":"[RuntimeClass](../windows/runtimeclass-class.md) represents an instantiated class that inherits a set of specified interfaces."},{"content":"A <ph id=\"ph1\">`RuntimeClass`</ph> object can provide a combination of support for one or more <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> COM interfaces, or a weak reference to a component.","pos":[11491,11672],"source":" A `RuntimeClass` object can provide a combination of support for one or more [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] COM interfaces, or a weak reference to a component."},{"content":"Module","pos":[11682,11688]},{"content":"<bpt id=\"p1\">[</bpt>Module<ept id=\"p1\">](../windows/module-class.md)</ept> represents a collection of related objects.","pos":[11692,11772],"source":"[Module](../windows/module-class.md) represents a collection of related objects."},{"content":"A <ph id=\"ph1\">`Module`</ph> object manages class factories, which create objects, and registration, which enables other applications to use an object.","pos":[11773,11906],"source":" A `Module` object manages class factories, which create objects, and registration, which enables other applications to use an object."},{"content":"Callback","pos":[11916,11924]},{"content":"The <bpt id=\"p1\">[</bpt>Callback<ept id=\"p1\">](../windows/callback-function-windows-runtime-cpp-template-library.md)</ept> function creates an object whose member function is an event handler (a callback method).","pos":[11928,12102],"source":"The [Callback](../windows/callback-function-windows-runtime-cpp-template-library.md) function creates an object whose member function is an event handler (a callback method)."},{"content":"Use the <ph id=\"ph1\">`Callback`</ph> function to write asynchronous operations.","pos":[12103,12164],"source":" Use the `Callback` function to write asynchronous operations."},{"content":"EventSource","pos":[12174,12185]},{"content":"<bpt id=\"p1\">[</bpt>EventSource<ept id=\"p1\">](../windows/eventsource-class.md)</ept> is used to manage <bpt id=\"p2\">*</bpt>delegate<ept id=\"p2\">*</ept> event handlers.","pos":[12189,12280],"source":"[EventSource](../windows/eventsource-class.md) is used to manage *delegate* event handlers."},{"content":"Use <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> to implement a delegate, and use <ph id=\"ph2\">`EventSource`</ph> to add, remove, and invoke delegates.","pos":[12281,12434],"source":" Use [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to implement a delegate, and use `EventSource` to add, remove, and invoke delegates."},{"content":"AsyncBase","pos":[12444,12453]},{"content":"<bpt id=\"p1\">[</bpt>AsyncBase<ept id=\"p1\">](../windows/asyncbase-class.md)</ept> provides virtual methods that represent the <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> asynchronous programming model.","pos":[12457,12628],"source":"[AsyncBase](../windows/asyncbase-class.md) provides virtual methods that represent the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] asynchronous programming model."},{"content":"Override the members in this class to create a custom class that can start, stop, or check the progress of an asynchronous operation.","pos":[12629,12762]},{"content":"FtmBase","pos":[12772,12779]},{"content":"<bpt id=\"p1\">[</bpt>FtmBase<ept id=\"p1\">](../windows/ftmbase-class.md)</ept> represents a free-threaded marshaler object.","pos":[12783,12866],"source":"[FtmBase](../windows/ftmbase-class.md) represents a free-threaded marshaler object."},{"content":"creates a global interface table (GIT), and helps manage marshaling and proxy objects.","pos":[12877,12963]},{"content":"WeakRef","pos":[12973,12980]},{"content":"<bpt id=\"p1\">[</bpt>WeakRef<ept id=\"p1\">](../windows/weakref-class.md)</ept> is a smart-pointer type that represents a <bpt id=\"p2\">*</bpt>weak reference<ept id=\"p2\">*</ept>, which references an object that might or might not be accessible.","pos":[12984,13148],"source":"[WeakRef](../windows/weakref-class.md) is a smart-pointer type that represents a *weak reference*, which references an object that might or might not be accessible."},{"content":"A <ph id=\"ph1\">`WeakRef`</ph> object can be used by only the <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph>, and not by classic COM.","pos":[13149,13269],"source":" A `WeakRef` object can be used by only the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], and not by classic COM."},{"content":"A <ph id=\"ph1\">`WeakRef`</ph> object typically represents an object whose existence is controlled by an external thread or application.","pos":[13276,13393],"source":"A `WeakRef` object typically represents an object whose existence is controlled by an external thread or application."},{"content":"For example, a <ph id=\"ph1\">`WeakRef`</ph> object can reference a file object.","pos":[13394,13454],"source":" For example, a `WeakRef` object can reference a file object."},{"content":"When the file is open, the <ph id=\"ph1\">`WeakRef`</ph> is valid and the referenced file is accessible.","pos":[13455,13539],"source":" When the file is open, the `WeakRef` is valid and the referenced file is accessible."},{"content":"But when the file is closed, the <ph id=\"ph1\">`WeakRef`</ph> is invalid and the file is not accessible.","pos":[13540,13625],"source":" But when the file is closed, the `WeakRef` is invalid and the file is not accessible."},{"content":"Related Topics","pos":[13634,13648]},{"content":"Class Library Project Template","pos":[13670,13700]},{"content":"Describes how to access the WRL Class Library project template.","pos":[13752,13815]},{"content":"This template helps simplify the task of using Visual Studio to create <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> components.","pos":[13816,13951],"source":" This template helps simplify the task of using Visual Studio to create [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] components."},{"content":"Key APIs by Category","pos":[13957,13977]},{"pos":[14019,14136],"content":"Highlights the primary <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> types, functions, and macros.","source":"Highlights the primary [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] types, functions, and macros."},{"content":"Reference","pos":[14142,14151]},{"pos":[14182,14286],"content":"Contains reference information for the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph>.","source":"Contains reference information for the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]."},{"content":"Quick Reference (Windows Runtime and Visual C++)","pos":[14292,14340]},{"pos":[14389,14563],"content":"Briefly describes the <ph id=\"ph1\">[!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]</ph> features that support the <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph>.","source":"Briefly describes the [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)] features that support the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]."},{"content":"Using Windows Runtime Components in Visual C++","pos":[14569,14615]},{"pos":[14664,14835],"content":"Shows how to use <ph id=\"ph1\">[!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]</ph> to create a basic <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> component.","source":"Shows how to use [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)] to create a basic [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component."}],"content":"---\ntitle: \"Windows Runtime C++ Template Library (WRL) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nms.assetid: b915afce-553b-44a7-b8dc-0ab601758eb0\ncaps.latest.revision: 32\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Windows Runtime C++ Template Library (WRL)\nThe [!INCLUDE[cppwrl](../windows/includes/cppwrl_md.md)] ([!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]) is a template library that provides a low-level way to author and use [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] components.  \n  \n## Benefits  \n The [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] enables you to more easily implement and consume Component Object Model (COM) components. It provides housekeeping techniques like reference-counting to manage the lifetime of objects and testing `HRESULT` values to determine whether an operation succeeded or failed. To successfully use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)], you must carefully follow these rules and techniques.  \n  \n The [!INCLUDE[cppwrt](../build/reference/includes/cppwrt_md.md)] ([!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]) is a high-level, language-based way to use [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] components. Both the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] and [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)] simplify the writing of code for the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] by automatically performing housekeeping tasks on your behalf.  \n  \n The [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] and [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)] provide different benefits. Here are some reasons you might want to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] instead of [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)]:  \n  \n-   [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] adds little abstraction over the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] Application Binary Interface (ABI), giving you the ability to control the underlying code to better create or consume [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] APIs.  \n  \n-   [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)] represents COM `HRESULT` values as exceptions. If you’ve inherited a code base that uses COM, or one that doesn’t use exceptions, you might find that the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] is a more natural way to work with the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] because you don't have to use exceptions.  \n  \n    > [!NOTE]\n    >  The [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses `HRESULT` values and does not throw exceptions. In addition, the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses smart pointers and the RAII pattern to help guarantee that objects are destroyed correctly when your application code throws an exception. For more info about smart pointers and RAII, see [Smart Pointers](../cpp/smart-pointers-modern-cpp.md) and [Objects Own Resources (RAII)](../cpp/objects-own-resources-raii.md).  \n  \n-   The purpose and design of the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] is inspired by the Active Template Library (ATL), which is a set of template-based C++ classes that simplify the programming of COM objects. Because [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] uses standard C++ to wrap the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], you can more easily port and interact with many existing COM components written in ATL to the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]. If you already know ATL, you might find that [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] programming is easier.  \n  \n## Getting Started  \n Here are some resources that can help you get working with the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] right away.  \n  \n [The Windows Runtime Library (WRL)](http://channel9.msdn.com/Events/Windows-Camp/Developing-Windows-8-Metro-style-apps-in-Cpp/The-Windows-Runtime-Library-WRL-)  \n In this Channel 9 video, learn more about how the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] helps you write [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] apps and how to author and consume [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] components.  \n  \n [How to: Activate and Use a Windows Runtime Component](../windows/how-to-activate-and-use-a-windows-runtime-component-using-wrl.md)  \n Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to initialize the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] and activate and use a [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component.  \n  \n [How to: Complete Asynchronous Operations](../windows/how-to-complete-asynchronous-operations-using-wrl.md)  \n Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to start asynchronous operations and perform work when the operations complete.  \n  \n [How to: Handle Events](../windows/how-to-handle-events-using-wrl.md)  \n Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to subscribe to and handle the events of a [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] object.  \n  \n [Walkthrough: Creating a Basic Windows Runtime Component](../windows/walkthrough-creating-a-basic-windows-runtime-component-using-wrl.md)  \n Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to create a basic [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component that adds two numbers. Also demonstrates how to raise events and use the component from a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app that uses JavaScript.  \n  \n [Walkthrough: Creating a Windows Store app using WRL and Media Foundation](../windows/walkthrough-creating-a-windows-store-app-using-wrl-and-media-foundation.md)  \n Learn how to create a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app that uses [Microsoft Media Foundation](http://msdn.microsoft.com/library/windows/apps/ms694197).  \n  \n [How to: Create a Classic COM Component](../windows/how-to-create-a-classic-com-component-using-wrl.md)  \n Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to create a basic COM component and a basic way to register and consume the COM component from a desktop app.  \n  \n [How to: Instantiate WRL Components Directly](../windows/how-to-instantiate-wrl-components-directly.md)  \n Learn how to use the [Microsoft::WRL::Make](../windows/make-function.md) and [Microsoft::WRL::Details::MakeAndInitialize](../windows/makeandinitialize-function.md) functions to instantiate a component from the module that defines it.  \n  \n [How to: Use winmdidl.exe and midlrt.exe to create .h files from windows metadata](../windows/use-winmdidl-and-midlrt-to-create-h-files-from-windows-metadata.md)  \n Shows how to consume custom Windows Runtime components from WRL by creating an IDL file from the .winmd metadata.  \n  \n [Walkthrough: Connecting Using Tasks and XML HTTP Requests](../parallel/concrt/walkthrough-connecting-using-tasks-and-xml-http-requests.md)  \n Shows how to use the [IXMLHTTPRequest2](http://msdn.microsoft.com/en-us/bbc11c4a-aecf-4d6d-8275-3e852e309908) and [IXMLHTTPRequest2Callback](http://msdn.microsoft.com/en-us/aa4b3f4c-6e28-458b-be25-6cce8865fc71) interfaces together with tasks to send HTTP GET and POST requests to a web service in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app.  \n  \n [Bing Maps Trip Optimizer sample](http://code.msdn.microsoft.com/Bing-Maps-trip-optimizer-c4e037f7)  \n Uses the `HttpRequest` class that's defined in [Walkthrough: Connecting Using Tasks and XML HTTP Requests](../parallel/concrt/walkthrough-connecting-using-tasks-and-xml-http-requests.md) in the context of a complete [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app.  \n  \n [Creating a Windows Runtime DLL component with C++ sample](http://code.msdn.microsoft.com/windowsapps/Creating-a-Windows-Runtime-6c399797)  \n Shows how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to create an in-process DLL component and consume it from C++/CX, JavaScript, and C#.  \n  \n [DirectX marble maze game sample](http://code.msdn.microsoft.com/windowsapps/DirectX-Marble-Maze-Game-e4806345)  \n Demonstrates how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to manage the lifetime of COM components such as DirectX and Media Foundation in the context of a complete 3-D game.  \n  \n [Sending toast notifications from desktop apps sample](http://code.msdn.microsoft.com/windowsdesktop/Sending-toast-notifications-71e230a2)  \n Demonstrates how to use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to work with toast notifications from a desktop app.  \n  \n## [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] Compared to ATL  \n [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] resembles the Active Template Library (ATL) because you can use it to create small, fast COM objects. [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] and ATL also share concepts such as definition of objects in modules, explicit registration of interfaces, and open creation of objects by using factories. You might be comfortable with [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] if you're familiar with ATL.  \n  \n [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] supports the COM functionality that is required for [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] apps. Therefore, it differs from the ATL because it omits direct support for COM features such as:  \n  \n-   aggregation  \n  \n-   stock implementations  \n  \n-   dual interfaces (`IDispatch`)  \n  \n-   standard enumerator interfaces  \n  \n-   connection points  \n  \n-   tear-off interfaces  \n  \n-   OLE embedding  \n  \n-   ActiveX controls  \n  \n-   COM+  \n  \n## Concepts  \n [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] provides types that represent a few basic concepts. The following sections describe those types.  \n  \n### ComPtr  \n [ComPtr](../windows/comptr-class.md) is a *smart pointer* type that represents the interface that's specified by the template parameter. Use `ComPtr` to declare a variable that can access the members of an object that's derived from the interface. `ComPtr` automatically maintains a reference count for the underlying interface pointer and releases the interface when the reference count goes to zero.  \n  \n### RuntimeClass  \n [RuntimeClass](../windows/runtimeclass-class.md) represents an instantiated class that inherits a set of specified interfaces. A `RuntimeClass` object can provide a combination of support for one or more [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] COM interfaces, or a weak reference to a component.  \n  \n### Module  \n [Module](../windows/module-class.md) represents a collection of related objects. A `Module` object manages class factories, which create objects, and registration, which enables other applications to use an object.  \n  \n### Callback  \n The [Callback](../windows/callback-function-windows-runtime-cpp-template-library.md) function creates an object whose member function is an event handler (a callback method). Use the `Callback` function to write asynchronous operations.  \n  \n### EventSource  \n [EventSource](../windows/eventsource-class.md) is used to manage *delegate* event handlers. Use [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] to implement a delegate, and use `EventSource` to add, remove, and invoke delegates.  \n  \n### AsyncBase  \n [AsyncBase](../windows/asyncbase-class.md) provides virtual methods that represent the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] asynchronous programming model. Override the members in this class to create a custom class that can start, stop, or check the progress of an asynchronous operation.  \n  \n### FtmBase  \n [FtmBase](../windows/ftmbase-class.md) represents a free-threaded marshaler object. `FtmBase` creates a global interface table (GIT), and helps manage marshaling and proxy objects.  \n  \n### WeakRef  \n [WeakRef](../windows/weakref-class.md) is a smart-pointer type that represents a *weak reference*, which references an object that might or might not be accessible. A `WeakRef` object can be used by only the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], and not by classic COM.  \n  \n A `WeakRef` object typically represents an object whose existence is controlled by an external thread or application. For example, a `WeakRef` object can reference a file object. When the file is open, the `WeakRef` is valid and the referenced file is accessible. But when the file is closed, the `WeakRef` is invalid and the file is not accessible.  \n  \n## Related Topics  \n  \n|||  \n|-|-|  \n|[Class Library Project Template](../windows/wrl-class-library-project-template.md)|Describes how to access the WRL Class Library project template. This template helps simplify the task of using Visual Studio to create [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] components.|  \n|[Key APIs by Category](../windows/key-wrl-apis-by-category.md)|Highlights the primary [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] types, functions, and macros.|  \n|[Reference](../windows/wrl-reference.md)|Contains reference information for the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)].|  \n|[Quick Reference (Windows Runtime and Visual C++)](http://go.microsoft.com/fwlink/?LinkId=229180)|Briefly describes the [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)] features that support the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)].|  \n|[Using Windows Runtime Components in Visual C++](http://go.microsoft.com/fwlink/?LinkId=229155)|Shows how to use [!INCLUDE[cppwrt_short](../build/reference/includes/cppwrt_short_md.md)] to create a basic [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component.|"}