{"nodes":[{"pos":[12,50],"content":"CRecentFileList Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CRecentFileList Class | Microsoft Docs","pos":[0,38]}]},{"content":"CRecentFileList Class","pos":[673,694]},{"content":"Supports control of the most recently used (MRU) file list.","pos":[695,754]},{"content":"Syntax","pos":[763,769]},{"content":"Members","pos":[817,824]},{"content":"Public Constructors","pos":[834,853]},{"content":"Name","pos":[860,864]},{"content":"Description","pos":[865,876]},{"content":"CRecentFileList::CRecentFileList","pos":[915,947]},{"pos":[984,1022],"content":"Constructs a <ph id=\"ph1\">`CRecentFileList`</ph> object.","source":"Constructs a `CRecentFileList` object."},{"content":"Public Methods","pos":[1033,1047]},{"content":"Name","pos":[1054,1058]},{"content":"Description","pos":[1059,1070]},{"content":"CRecentFileList::Add","pos":[1109,1129]},{"content":"Adds a file to the MRU file list.","pos":[1154,1187]},{"content":"CRecentFileList::GetDisplayName","pos":[1193,1224]},{"content":"Provides a display name for menu display of an MRU filename.","pos":[1260,1320]},{"content":"CRecentFileList::GetSize","pos":[1326,1350]},{"content":"Retrieves the number of files in the MRU file list.","pos":[1379,1430]},{"content":"CRecentFileList::ReadList","pos":[1436,1461]},{"content":"Reads the MRU file list from the registry or .INI file.","pos":[1491,1546]},{"content":"CRecentFileList::Remove","pos":[1552,1575]},{"content":"Removes a file from the MRU file list.","pos":[1603,1641]},{"content":"CRecentFileList::UpdateMenu","pos":[1647,1674]},{"content":"Updates the menu display of the MRU file list.","pos":[1706,1752]},{"content":"CRecentFileList::WriteList","pos":[1758,1784]},{"content":"Writes the MRU file list from the registry or .INI file.","pos":[1815,1871]},{"content":"Public Operators","pos":[1882,1898]},{"content":"Name","pos":[1905,1909]},{"content":"Description","pos":[1910,1921]},{"content":"CRecentFileList::operator [ ]","pos":[1960,1989]},{"pos":[2022,2069],"content":"Returns a <ph id=\"ph1\">`CString`</ph> object at a given position.","source":"Returns a `CString` object at a given position."},{"content":"Remarks","pos":[2079,2086]},{"content":"Files can be added to or deleted from the MRU file list, the file list can be read from or written to the registry or an .INI file, and the menu displaying the MRU file list can be updated.","pos":[2090,2279]},{"content":"For more information about MRU menu items, see","pos":[2286,2332]},{"content":"Knowledge Base article Q243751 : HOWTO: Add Command Handlers for MRU Menu Items in MFC Application","pos":[2342,2440]},{"content":"Inheritance Hierarchy","pos":[2449,2470]},{"content":"Requirements","pos":[2500,2512]},{"pos":[2516,2536],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxadv.h","source":"**Header:** afxadv.h"},{"pos":[2583,2603],"content":"CRecentFileList::Add"},{"content":"Adds a file to the most recently used (MRU) file list.","pos":[2607,2661]},{"content":"Parameters","pos":[2986,2996]},{"content":"Specifies pathname to be added to the list.","pos":[3018,3061]},{"content":"Specifies Application User Model ID for the application.","pos":[3083,3139]},{"content":"Specifies a pointer to Shell Item to be added to the list.","pos":[3157,3215]},{"content":"Specifies a pointer to Shell Link to be added to the list.","pos":[3233,3291]},{"content":"Specifies the IDLIST for the shell item that should be added to the recent docs folder.","pos":[3308,3395]},{"content":"Remarks","pos":[3405,3412]},{"content":"The file name will be added to the top of the MRU list.","pos":[3416,3471]},{"content":"If the file name already exists in the MRU list, it will be moved to the top.","pos":[3472,3549]},{"pos":[3608,3640],"content":"CRecentFileList::CRecentFileList"},{"pos":[3644,3682],"content":"Constructs a <ph id=\"ph1\">`CRecentFileList`</ph> object.","source":"Constructs a `CRecentFileList` object."},{"content":"Parameters","pos":[3866,3876]},{"content":"Offset for the numbering in the menu display of the MRU (most recently used) file list.","pos":[3892,3979]},{"content":"Points to the name of the section of the registry or the application's .INI file where the MRU file list is read and/or written.","pos":[4003,4131]},{"content":"Points to a format string to be used for the names of the entries stored in the registry or the application's .INI file.","pos":[4159,4279]},{"content":"Maximum number of files in the MRU file list.","pos":[4297,4342]},{"content":"Maximum length, in characters, available for the menu display of a filename in the MRU file list.","pos":[4366,4463]},{"content":"Remarks","pos":[4473,4480]},{"content":"The format string pointed to by <ph id=\"ph1\">`lpszEntryFormat`</ph> should contain \"%d\", which will be used for substituting the index of each MRU item.","pos":[4484,4618],"source":"The format string pointed to by `lpszEntryFormat` should contain \"%d\", which will be used for substituting the index of each MRU item."},{"content":"For example, if the format string is <ph id=\"ph1\">`\"file%d\"`</ph> then the entries will be named <ph id=\"ph2\">`file0`</ph>, <ph id=\"ph3\">`file1`</ph>, and so on.","pos":[4619,4726],"source":" For example, if the format string is `\"file%d\"` then the entries will be named `file0`, `file1`, and so on."},{"pos":[4784,4815],"content":"CRecentFileList::GetDisplayName"},{"content":"Obtains a display name for a file in the MRU file list, for use in the menu display of the MRU list.","pos":[4819,4919]},{"content":"Parameters","pos":[5100,5110]},{"content":"Full path of the file whose name is to be displayed in the menu list of MRU files.","pos":[5127,5209]},{"content":"Zero-based index of the file in the MRU file list.","pos":[5228,5278]},{"content":"lpszCurDir","pos":[5286,5296]},{"content":"String holding the current directory.","pos":[5301,5338]},{"content":"nCurDir","pos":[5346,5353]},{"content":"Length of the current directory string.","pos":[5358,5397]},{"content":"If nonzero, indicates that the base name of the file should be returned, even if it exceeds the maximum display length (passed as the <ph id=\"ph1\">`nMaxDispLen`</ph> parameter to the <ph id=\"ph2\">`CRecentFileList`</ph> constructor).","pos":[5422,5618],"source":" If nonzero, indicates that the base name of the file should be returned, even if it exceeds the maximum display length (passed as the `nMaxDispLen` parameter to the `CRecentFileList` constructor)."},{"content":"Return Value","pos":[5628,5640]},{"pos":[5644,5743],"content":"<bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> if there is no filename at the specified index in the most recently used (MRU) file list.","source":"**FALSE** if there is no filename at the specified index in the most recently used (MRU) file list."},{"content":"Remarks","pos":[5753,5760]},{"content":"If the file is in the current directory, the function leaves the directory off the display.","pos":[5764,5855]},{"content":"If the filename is too long, the directory and extension are stripped.","pos":[5856,5926]},{"content":"If the filename is still too long, the display name is set to an empty string unless <ph id=\"ph1\">`bAtLeastName`</ph> is nonzero.","pos":[5927,6038],"source":" If the filename is still too long, the display name is set to an empty string unless `bAtLeastName` is nonzero."},{"pos":[6089,6113],"content":"CRecentFileList::GetSize"},{"content":"Retrieves the number of files in the MRU file list.","pos":[6117,6168]},{"content":"Return Value","pos":[6217,6229]},{"content":"The number of files in the current most recently used (MRU) file list.","pos":[6233,6303]},{"pos":[6358,6387],"content":"CRecentFileList::operator [ ]"},{"pos":[6391,6506],"content":"The overloaded subscript ( <ph id=\"ph1\">`[]`</ph>) operator returns a single <ph id=\"ph2\">`CString`</ph> specified by the zero-based index in <ph id=\"ph3\">`nIndex`</ph>.","source":"The overloaded subscript ( `[]`) operator returns a single `CString` specified by the zero-based index in `nIndex`."},{"content":"Parameters","pos":[6565,6575]},{"content":"Zero-based index of a <ph id=\"ph1\">`CString`</ph> in a set of <ph id=\"ph2\">`CString`</ph>s.","pos":[6591,6646],"source":" Zero-based index of a `CString` in a set of `CString`s."},{"pos":[6698,6723],"content":"CRecentFileList::ReadList"},{"content":"Reads the most recently used (MRU) file list from the registry or the application's .INI file.","pos":[6727,6821]},{"pos":[6911,6934],"content":"CRecentFileList::Remove"},{"content":"Removes a file from the MRU file list.","pos":[6938,6976]},{"content":"Parameters","pos":[7034,7044]},{"content":"Zero-based index of the file to be removed from the most recently used (MRU) file list.","pos":[7060,7147]},{"pos":[7201,7228],"content":"CRecentFileList::UpdateMenu"},{"content":"Updates the menu display of the MRU file list.","pos":[7232,7278]},{"content":"Parameters","pos":[7344,7354]},{"content":"A pointer to the <bpt id=\"p1\">[</bpt>CCmdUI<ept id=\"p1\">](../../mfc/reference/ccmdui-class.md)</ept> object for the most recently used (MRU) file list menu.","pos":[7370,7488],"source":" A pointer to the [CCmdUI](../../mfc/reference/ccmdui-class.md) object for the most recently used (MRU) file list menu."},{"pos":[7541,7567],"content":"CRecentFileList::WriteList"},{"content":"Writes the most recently used (MRU) file list into the registry or the application's .INI file.","pos":[7571,7666]},{"content":"See Also","pos":[7716,7724]},{"content":"Hierarchy Chart","pos":[7729,7744]}],"content":"---\ntitle: \"CRecentFileList Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CRecentFileList\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"files [C++], most recently used\"\n  - \"MRU files\"\n  - \"CRecentFileList class\"\nms.assetid: a77f0524-7584-4582-849a-7e97b76d186e\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CRecentFileList Class\nSupports control of the most recently used (MRU) file list.  \n  \n## Syntax  \n  \n```  \nclass CRecentFileList  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRecentFileList::CRecentFileList](#crecentfilelist__crecentfilelist)|Constructs a `CRecentFileList` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRecentFileList::Add](#crecentfilelist__add)|Adds a file to the MRU file list.|  \n|[CRecentFileList::GetDisplayName](#crecentfilelist__getdisplayname)|Provides a display name for menu display of an MRU filename.|  \n|[CRecentFileList::GetSize](#crecentfilelist__getsize)|Retrieves the number of files in the MRU file list.|  \n|[CRecentFileList::ReadList](#crecentfilelist__readlist)|Reads the MRU file list from the registry or .INI file.|  \n|[CRecentFileList::Remove](#crecentfilelist__remove)|Removes a file from the MRU file list.|  \n|[CRecentFileList::UpdateMenu](#crecentfilelist__updatemenu)|Updates the menu display of the MRU file list.|  \n|[CRecentFileList::WriteList](#crecentfilelist__writelist)|Writes the MRU file list from the registry or .INI file.|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRecentFileList::operator [ ]](#crecentfilelist__operator_at)|Returns a `CString` object at a given position.|  \n  \n## Remarks  \n Files can be added to or deleted from the MRU file list, the file list can be read from or written to the registry or an .INI file, and the menu displaying the MRU file list can be updated.  \n  \n For more information about MRU menu items, see  \n  \n-   Knowledge Base article Q243751 : HOWTO: Add Command Handlers for MRU Menu Items in MFC Application  \n  \n## Inheritance Hierarchy  \n `CRecentFileList`  \n  \n## Requirements  \n **Header:** afxadv.h  \n  \n##  <a name=\"crecentfilelist__add\"></a>  CRecentFileList::Add  \n Adds a file to the most recently used (MRU) file list.  \n  \n```  \nvirtual void Add(\n    LPCTSTR lpszPathName);\n\n \nvirtual void Add(\n    LPCTSTR lpszPathName,\n    LPCTSTR lpszAppID);\n\n \nvoid Add(\n    IShellItem* pItem,\n    LPCTSTR lpszAppID);\n\n \nvoid Add(\n    IShellLink* pLink,\n    LPCTSTR lpszAppID);\n\n \nvoid Add(\n    PIDLIST_ABSOLUTE pidl,\n    LPCTSTR lpszAppID);\n```  \n  \n### Parameters  \n `lpszPathName`  \n Specifies pathname to be added to the list.  \n  \n `lpszAppID`  \n Specifies Application User Model ID for the application.  \n  \n `pItem`  \n Specifies a pointer to Shell Item to be added to the list.  \n  \n `pLink`  \n Specifies a pointer to Shell Link to be added to the list.  \n  \n `pidl`  \n Specifies the IDLIST for the shell item that should be added to the recent docs folder.  \n  \n### Remarks  \n The file name will be added to the top of the MRU list. If the file name already exists in the MRU list, it will be moved to the top.  \n  \n##  <a name=\"crecentfilelist__crecentfilelist\"></a>  CRecentFileList::CRecentFileList  \n Constructs a `CRecentFileList` object.  \n  \n```  \nCRecentFileList(\n    UINT nStart,  \n    LPCTSTR lpszSection,  \n    LPCTSTR lpszEntryFormat,  \n    int nSize,  \n    int nMaxDispLen = AFX_ABBREV_FILENAME_LEN);\n```  \n  \n### Parameters  \n `nStart`  \n Offset for the numbering in the menu display of the MRU (most recently used) file list.  \n  \n `lpszSection`  \n Points to the name of the section of the registry or the application's .INI file where the MRU file list is read and/or written.  \n  \n `lpszEntryFormat`  \n Points to a format string to be used for the names of the entries stored in the registry or the application's .INI file.  \n  \n `nSize`  \n Maximum number of files in the MRU file list.  \n  \n `nMaxDispLen`  \n Maximum length, in characters, available for the menu display of a filename in the MRU file list.  \n  \n### Remarks  \n The format string pointed to by `lpszEntryFormat` should contain \"%d\", which will be used for substituting the index of each MRU item. For example, if the format string is `\"file%d\"` then the entries will be named `file0`, `file1`, and so on.  \n  \n##  <a name=\"crecentfilelist__getdisplayname\"></a>  CRecentFileList::GetDisplayName  \n Obtains a display name for a file in the MRU file list, for use in the menu display of the MRU list.  \n  \n```  \nvirtual BOOL GetDisplayName(\n    CString& strName,  \n    int nIndex,  \n    LPCTSTR lpszCurDir,  \n    int nCurDir,  \n    BOOL bAtLeastName = TRUE) const;\n\n \n```  \n  \n### Parameters  \n `strName`  \n Full path of the file whose name is to be displayed in the menu list of MRU files.  \n  \n `nIndex`  \n Zero-based index of the file in the MRU file list.  \n  \n *lpszCurDir*  \n String holding the current directory.  \n  \n *nCurDir*  \n Length of the current directory string.  \n  \n `bAtLeastName`  \n If nonzero, indicates that the base name of the file should be returned, even if it exceeds the maximum display length (passed as the `nMaxDispLen` parameter to the `CRecentFileList` constructor).  \n  \n### Return Value  \n **FALSE** if there is no filename at the specified index in the most recently used (MRU) file list.  \n  \n### Remarks  \n If the file is in the current directory, the function leaves the directory off the display. If the filename is too long, the directory and extension are stripped. If the filename is still too long, the display name is set to an empty string unless `bAtLeastName` is nonzero.  \n  \n##  <a name=\"crecentfilelist__getsize\"></a>  CRecentFileList::GetSize  \n Retrieves the number of files in the MRU file list.  \n  \n```  \nint GetSize() const;\n\n \n```  \n  \n### Return Value  \n The number of files in the current most recently used (MRU) file list.  \n  \n##  <a name=\"crecentfilelist__operator_at\"></a>  CRecentFileList::operator [ ]  \n The overloaded subscript ( `[]`) operator returns a single `CString` specified by the zero-based index in `nIndex`.  \n  \n```  \nCString& operator[ ](int nindex);\n```  \n  \n### Parameters  \n `nIndex`  \n Zero-based index of a `CString` in a set of `CString`s.  \n  \n##  <a name=\"crecentfilelist__readlist\"></a>  CRecentFileList::ReadList  \n Reads the most recently used (MRU) file list from the registry or the application's .INI file.  \n  \n```  \nvirtual void ReadList();\n```  \n  \n##  <a name=\"crecentfilelist__remove\"></a>  CRecentFileList::Remove  \n Removes a file from the MRU file list.  \n  \n```  \nvirtual void Remove(int nIndex);\n```  \n  \n### Parameters  \n `nIndex`  \n Zero-based index of the file to be removed from the most recently used (MRU) file list.  \n  \n##  <a name=\"crecentfilelist__updatemenu\"></a>  CRecentFileList::UpdateMenu  \n Updates the menu display of the MRU file list.  \n  \n```  \nvirtual void UpdateMenu(CCmdUI* pCmdUI);\n```  \n  \n### Parameters  \n `pCmdUI`  \n A pointer to the [CCmdUI](../../mfc/reference/ccmdui-class.md) object for the most recently used (MRU) file list menu.  \n  \n##  <a name=\"crecentfilelist__writelist\"></a>  CRecentFileList::WriteList  \n Writes the most recently used (MRU) file list into the registry or the application's .INI file.  \n  \n```  \nvirtual void WriteList();\n```  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n\n\n"}