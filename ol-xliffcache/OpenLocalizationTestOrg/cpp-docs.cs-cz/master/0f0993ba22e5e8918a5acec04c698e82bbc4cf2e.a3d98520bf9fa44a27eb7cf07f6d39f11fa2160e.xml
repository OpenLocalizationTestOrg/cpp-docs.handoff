{"nodes":[{"pos":[12,54],"content":"CComContainedObject Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComContainedObject Class | Microsoft Docs","pos":[0,42]}]},{"content":"CComContainedObject Class","pos":[706,731]},{"pos":[732,874],"content":"This class implements <bpt id=\"p1\">[</bpt>IUnknown<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680509)</ept> by delegating to the owner object's <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept>.","source":"This class implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) by delegating to the owner object's **IUnknown**."},{"pos":[882,992],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"content":"Syntax","pos":[1001,1007]},{"content":"Parameters","pos":[1094,1104]},{"content":"Your class, derived from <bpt id=\"p1\">[</bpt>CComObjectRoot<ept id=\"p1\">](../../atl/reference/ccomobjectroot-class.md)</ept> or <bpt id=\"p2\">[</bpt>CComObjectRootEx<ept id=\"p2\">](../../atl/reference/ccomobjectrootex-class.md)</ept>.","pos":[1118,1274],"source":" Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md)."},{"content":"Members","pos":[1283,1290]},{"content":"Public Constructors","pos":[1300,1319]},{"content":"Name","pos":[1326,1330]},{"content":"Description","pos":[1331,1342]},{"content":"CComContainedObject::CComContainedObject","pos":[1381,1421]},{"content":"The constructor.","pos":[1466,1482]},{"content":"Initializes the member pointer to the owner object's <ph id=\"ph1\">`IUnknown`</ph>.","pos":[1483,1547],"source":" Initializes the member pointer to the owner object's `IUnknown`."},{"content":"CComContainedObject::~CComContainedObject","pos":[1553,1594]},{"content":"The destructor.","pos":[1644,1659]},{"content":"Public Methods","pos":[1670,1684]},{"content":"Name","pos":[1691,1695]},{"content":"Description","pos":[1696,1707]},{"content":"CComContainedObject::AddRef","pos":[1746,1773]},{"content":"Increments the reference count on the owner object.","pos":[1805,1856]},{"content":"CComContainedObject::GetControllingUnknown","pos":[1862,1904]},{"pos":[1951,1991],"content":"Retrieves the owner object's <ph id=\"ph1\">`IUnknown`</ph>.","source":"Retrieves the owner object's `IUnknown`."},{"content":"CComContainedObject::QueryInterface","pos":[1997,2032]},{"content":"Retrieves a pointer to the interface requested on the owner object.","pos":[2072,2139]},{"content":"CComContainedObject::Release","pos":[2145,2173]},{"content":"Decrements the reference count on the owner object.","pos":[2206,2257]},{"content":"Remarks","pos":[2267,2274]},{"content":"ATL uses <ph id=\"ph1\">`CComContainedObject`</ph> in classes <bpt id=\"p1\">[</bpt>CComAggObject<ept id=\"p1\">](../../atl/reference/ccomaggobject-class.md)</ept>, <bpt id=\"p2\">[</bpt>CComPolyObject<ept id=\"p2\">](../../atl/reference/ccompolyobject-class.md)</ept>, and <bpt id=\"p3\">[</bpt>CComCachedTearOffObject<ept id=\"p3\">](../../atl/reference/ccomcachedtearoffobject-class.md)</ept>.","pos":[2278,2528],"source":"ATL uses `CComContainedObject` in classes [CComAggObject](../../atl/reference/ccomaggobject-class.md), [CComPolyObject](../../atl/reference/ccompolyobject-class.md), and [CComCachedTearOffObject](../../atl/reference/ccomcachedtearoffobject-class.md)."},{"content":"implements <bpt id=\"p1\">[</bpt>IUnknown<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680509)</ept> by delegating to the owner object's <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept>.","pos":[2551,2682],"source":" implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) by delegating to the owner object's **IUnknown**."},{"content":"(The owner is either the outer object of an aggregation, or the object for which a tear-off interface is being created.) <ph id=\"ph1\">`CComContainedObject`</ph> calls <ph id=\"ph2\">`CComObjectRootEx`</ph>'s <ph id=\"ph3\">`OuterQueryInterface`</ph>, <ph id=\"ph4\">`OuterAddRef`</ph>, and <ph id=\"ph5\">`OuterRelease`</ph>, all inherited through <ph id=\"ph6\">`Base`</ph>.","pos":[2683,2940],"source":" (The owner is either the outer object of an aggregation, or the object for which a tear-off interface is being created.) `CComContainedObject` calls `CComObjectRootEx`'s `OuterQueryInterface`, `OuterAddRef`, and `OuterRelease`, all inherited through `Base`."},{"content":"Inheritance Hierarchy","pos":[2949,2970]},{"content":"Requirements","pos":[3017,3029]},{"pos":[3033,3053],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[3107,3134],"content":"CComContainedObject::AddRef"},{"content":"Increments the reference count on the owner object.","pos":[3138,3189]},{"content":"Return Value","pos":[3241,3253]},{"content":"A value that may be useful for diagnostics or testing.","pos":[3257,3311]},{"pos":[3378,3418],"content":"CComContainedObject::CComContainedObject"},{"content":"The constructor.","pos":[3422,3438]},{"content":"Parameters","pos":[3492,3502]},{"content":"[in] The owner object's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>.","pos":[3514,3551],"source":" [in] The owner object's **IUnknown**."},{"content":"Remarks","pos":[3561,3568]},{"pos":[3572,3659],"content":"Sets the <ph id=\"ph1\">`m_pOuterUnknown`</ph> member pointer (inherited through the <ph id=\"ph2\">`Base`</ph> class) to <ph id=\"ph3\">`pv`</ph>.","source":"Sets the `m_pOuterUnknown` member pointer (inherited through the `Base` class) to `pv`."},{"pos":[3731,3772],"content":"CComContainedObject::~CComContainedObject"},{"content":"The destructor.","pos":[3776,3791]},{"content":"Remarks","pos":[3838,3845]},{"content":"Frees all allocated resources.","pos":[3849,3879]},{"pos":[3948,3990],"content":"CComContainedObject::GetControllingUnknown"},{"pos":[3994,4119],"content":"Returns the <ph id=\"ph1\">`m_pOuterUnknown`</ph> member pointer (inherited through the <bpt id=\"p1\">*</bpt>Base<ept id=\"p1\">*</ept> class) that holds the owner object's <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept>.","source":"Returns the `m_pOuterUnknown` member pointer (inherited through the *Base* class) that holds the owner object's **IUnknown**."},{"content":"Return Value","pos":[4177,4189]},{"pos":[4193,4225],"content":"The owner object's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>.","source":"The owner object's **IUnknown**."},{"content":"Remarks","pos":[4235,4242]},{"pos":[4246,4412],"content":"This method may be virtual if <ph id=\"ph1\">`Base`</ph> has declared the <bpt id=\"p1\">[</bpt>DECLARE_GET_CONTROLLING_UNKNOWN<ept id=\"p1\">](http://msdn.microsoft.com/library/82b0199a-a9d5-4f95-a711-fa1ae18e1f77)</ept> macro.","source":"This method may be virtual if `Base` has declared the [DECLARE_GET_CONTROLLING_UNKNOWN](http://msdn.microsoft.com/library/82b0199a-a9d5-4f95-a711-fa1ae18e1f77) macro."},{"pos":[4474,4509],"content":"CComContainedObject::QueryInterface"},{"content":"Retrieves a pointer to the interface requested on the owner object.","pos":[4513,4580]},{"content":"Parameters","pos":[4744,4754]},{"content":"[in] The identifier of the interface being requested.","pos":[4767,4820]},{"content":"[out] A pointer to the interface pointer identified by <ph id=\"ph1\">`iid`</ph>.","pos":[4842,4903],"source":" [out] A pointer to the interface pointer identified by `iid`."},{"content":"If the object does not support this interface, <ph id=\"ph1\">`ppvObject`</ph> is set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[4904,4982],"source":" If the object does not support this interface, `ppvObject` is set to **NULL**."},{"content":"[out] A pointer to the interface pointer identified by type <ph id=\"ph1\">`Q`</ph>.","pos":[4997,5061],"source":" [out] A pointer to the interface pointer identified by type `Q`."},{"content":"If the object does not support this interface, <ph id=\"ph1\">`pp`</ph> is set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[5062,5133],"source":" If the object does not support this interface, `pp` is set to **NULL**."},{"content":"Return Value","pos":[5143,5155]},{"pos":[5159,5186],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"pos":[5241,5269],"content":"CComContainedObject::Release"},{"content":"Decrements the reference count on the owner object.","pos":[5273,5324]},{"content":"Return Value","pos":[5377,5389]},{"content":"In debug builds, <bpt id=\"p1\">**</bpt>Release<ept id=\"p1\">**</ept> returns a value that may be useful for diagnostics or testing.","pos":[5393,5484],"source":"In debug builds, **Release** returns a value that may be useful for diagnostics or testing."},{"content":"In non-debug builds, <bpt id=\"p1\">**</bpt>Release<ept id=\"p1\">**</ept> always returns 0.","pos":[5485,5535],"source":" In non-debug builds, **Release** always returns 0."},{"content":"See Also","pos":[5544,5552]},{"content":"Class Overview","pos":[5557,5571]}],"content":"---\ntitle: \"CComContainedObject Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CComContainedObject\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"aggregate objects [C++], in ATL\"\n  - \"aggregation [C++], ATL objects\"\n  - \"CComContainedObject class\"\nms.assetid: e8616b41-c200-47b8-bf2c-fb9f713ebdad\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComContainedObject Class\nThis class implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) by delegating to the owner object's **IUnknown**.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\ntemplate<class Base>  class CComContainedObject :  public Base\n```  \n  \n#### Parameters  \n `Base`  \n Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md).  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComContainedObject::CComContainedObject](#ccomcontainedobject__ccomcontainedobject)|The constructor. Initializes the member pointer to the owner object's `IUnknown`.|  \n|[CComContainedObject::~CComContainedObject](#ccomcontainedobject___dtorccomcontainedobject)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComContainedObject::AddRef](#ccomcontainedobject__addref)|Increments the reference count on the owner object.|  \n|[CComContainedObject::GetControllingUnknown](#ccomcontainedobject__getcontrollingunknown)|Retrieves the owner object's `IUnknown`.|  \n|[CComContainedObject::QueryInterface](#ccomcontainedobject__queryinterface)|Retrieves a pointer to the interface requested on the owner object.|  \n|[CComContainedObject::Release](#ccomcontainedobject__release)|Decrements the reference count on the owner object.|  \n  \n## Remarks  \n ATL uses `CComContainedObject` in classes [CComAggObject](../../atl/reference/ccomaggobject-class.md), [CComPolyObject](../../atl/reference/ccompolyobject-class.md), and [CComCachedTearOffObject](../../atl/reference/ccomcachedtearoffobject-class.md). `CComContainedObject` implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) by delegating to the owner object's **IUnknown**. (The owner is either the outer object of an aggregation, or the object for which a tear-off interface is being created.) `CComContainedObject` calls `CComObjectRootEx`'s `OuterQueryInterface`, `OuterAddRef`, and `OuterRelease`, all inherited through `Base`.  \n  \n## Inheritance Hierarchy  \n `Base`  \n  \n `CComContainedObject`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ccomcontainedobject__addref\"></a>  CComContainedObject::AddRef  \n Increments the reference count on the owner object.  \n  \n```\nSTDMETHOD_(ULONG, AddRef)();\n```  \n  \n### Return Value  \n A value that may be useful for diagnostics or testing.  \n  \n##  <a name=\"ccomcontainedobject__ccomcontainedobject\"></a>  CComContainedObject::CComContainedObject  \n The constructor.  \n  \n```\nCComContainedObject(void* pv);\n```  \n  \n### Parameters  \n `pv`  \n [in] The owner object's **IUnknown**.  \n  \n### Remarks  \n Sets the `m_pOuterUnknown` member pointer (inherited through the `Base` class) to `pv`.  \n  \n##  <a name=\"ccomcontainedobject___dtorccomcontainedobject\"></a>  CComContainedObject::~CComContainedObject  \n The destructor.  \n  \n```\n~CComContainedObject();\n```  \n  \n### Remarks  \n Frees all allocated resources.  \n  \n##  <a name=\"ccomcontainedobject__getcontrollingunknown\"></a>  CComContainedObject::GetControllingUnknown  \n Returns the `m_pOuterUnknown` member pointer (inherited through the *Base* class) that holds the owner object's **IUnknown**.  \n  \n```\nIUnknown* GetControllingUnknown();\n```  \n  \n### Return Value  \n The owner object's **IUnknown**.  \n  \n### Remarks  \n This method may be virtual if `Base` has declared the [DECLARE_GET_CONTROLLING_UNKNOWN](http://msdn.microsoft.com/library/82b0199a-a9d5-4f95-a711-fa1ae18e1f77) macro.  \n  \n##  <a name=\"ccomcontainedobject__queryinterface\"></a>  CComContainedObject::QueryInterface  \n Retrieves a pointer to the interface requested on the owner object.  \n  \n```\nSTDMETHOD(QueryInterface)(REFIID iid,\n    void** ppvObject);\n\n    template <class Q>  HRESULT STDMETHODCALLTYPE QueryInterface(\n    Q** pp);\n```  \n  \n### Parameters  \n `iid`  \n [in] The identifier of the interface being requested.  \n  \n `ppvObject`  \n [out] A pointer to the interface pointer identified by `iid`. If the object does not support this interface, `ppvObject` is set to **NULL**.  \n  \n `pp`  \n [out] A pointer to the interface pointer identified by type `Q`. If the object does not support this interface, `pp` is set to **NULL**.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n##  <a name=\"ccomcontainedobject__release\"></a>  CComContainedObject::Release  \n Decrements the reference count on the owner object.  \n  \n```\nSTDMETHOD_(ULONG, Release)();\n```  \n  \n### Return Value  \n In debug builds, **Release** returns a value that may be useful for diagnostics or testing. In non-debug builds, **Release** always returns 0.  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}