{"nodes":[{"pos":[12,44],"content":"COleCmdUI Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleCmdUI Class | Microsoft Docs","pos":[0,32]}]},{"pos":[772,787],"content":"COleCmdUI Class","linkify":"COleCmdUI Class","nodes":[{"content":"COleCmdUI Class","pos":[0,15]}]},{"pos":[788,933],"content":"Implements a method for MFC to update the state of user-interface objects related to the <ph id=\"ph1\">`IOleCommandTarget`</ph>-driven features of your application.","source":"Implements a method for MFC to update the state of user-interface objects related to the `IOleCommandTarget`-driven features of your application."},{"pos":[942,948],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1006,1013],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1023,1042],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1049,1053]},{"content":"Description","pos":[1054,1065]},{"pos":[1103,1148],"content":"<bpt id=\"p1\">[</bpt>COleCmdUI::COleCmdUI<ept id=\"p1\">](#colecmdui__colecmdui)</ept>","source":"[COleCmdUI::COleCmdUI](#colecmdui__colecmdui)"},{"pos":[1149,1181],"content":"Constructs a <ph id=\"ph1\">`COleCmdUI`</ph> object.","source":"Constructs a `COleCmdUI` object."},{"pos":[1192,1206],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1213,1217]},{"content":"Description","pos":[1218,1229]},{"pos":[1267,1306],"content":"<bpt id=\"p1\">[</bpt>COleCmdUI::Enable<ept id=\"p1\">](#colecmdui__enable)</ept>","source":"[COleCmdUI::Enable](#colecmdui__enable)"},{"content":"Sets or clears the enable command flag.","pos":[1307,1346]},{"pos":[1351,1394],"content":"<bpt id=\"p1\">[</bpt>COleCmdUI::SetCheck<ept id=\"p1\">](#colecmdui__setcheck)</ept>","source":"[COleCmdUI::SetCheck](#colecmdui__setcheck)"},{"content":"Sets the state of an on/off toggle command.","pos":[1395,1438]},{"pos":[1443,1484],"content":"<bpt id=\"p1\">[</bpt>COleCmdUI::SetText<ept id=\"p1\">](#colecmdui__settext)</ept>","source":"[COleCmdUI::SetText](#colecmdui__settext)"},{"content":"Returns a text name or status string for a command.","pos":[1485,1536]},{"pos":[1546,1553],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In an application that is not enabled for DocObjects, when the user views a menu in the application, MFC processes <bpt id=\"p1\">**</bpt>UPDATE_COMMAND_UI<ept id=\"p1\">**</ept> notifcations.","pos":[1557,1707],"source":"In an application that is not enabled for DocObjects, when the user views a menu in the application, MFC processes **UPDATE_COMMAND_UI** notifcations."},{"content":"Each notification is given a <bpt id=\"p1\">[</bpt>CCmdUI<ept id=\"p1\">](../../mfc/reference/ccmdui-class.md)</ept> object that can be manipulated to reflect the state of a particular command.","pos":[1708,1859],"source":" Each notification is given a [CCmdUI](../../mfc/reference/ccmdui-class.md) object that can be manipulated to reflect the state of a particular command."},{"content":"However, when your application is enabled for DocObjects, MFC processes <bpt id=\"p1\">**</bpt>UPDATE_OLE_COMMAND_UI<ept id=\"p1\">**</ept> notifications and assigns <ph id=\"ph1\">`COleCmdUI`</ph> objects.","pos":[1860,2004],"source":" However, when your application is enabled for DocObjects, MFC processes **UPDATE_OLE_COMMAND_UI** notifications and assigns `COleCmdUI` objects."},{"content":"<ph id=\"ph1\">`COleCmdUI`</ph> allows a DocObject to receive commands that originate in its container's user interface (such as FileNew, Open, Print, and so on), and allows a container to receive commands that originate in the DocObject's user interface.","pos":[2011,2246],"source":"`COleCmdUI` allows a DocObject to receive commands that originate in its container's user interface (such as FileNew, Open, Print, and so on), and allows a container to receive commands that originate in the DocObject's user interface."},{"content":"Although <ph id=\"ph1\">`IDispatch`</ph> could be used to dispatch the same commands, <ph id=\"ph2\">`IOleCommandTarget`</ph> provides a simpler way to query and execute because it relies on a standard set of commands, usually without arguments, and no type information is involved.","pos":[2247,2489],"source":" Although `IDispatch` could be used to dispatch the same commands, `IOleCommandTarget` provides a simpler way to query and execute because it relies on a standard set of commands, usually without arguments, and no type information is involved."},{"content":"<ph id=\"ph1\">`COleCmdUI`</ph> can be used to enable, update, and set other properties of DocObject user interface commands.","pos":[2490,2595],"source":"`COleCmdUI` can be used to enable, update, and set other properties of DocObject user interface commands."},{"content":"When you want to invoke the command, call <bpt id=\"p1\">[</bpt>COleServerDoc::OnExecOleCmd<ept id=\"p1\">](../../mfc/reference/coleserverdoc-class.md#coleserverdoc__onexecolecmd)</ept>.","pos":[2596,2740],"source":" When you want to invoke the command, call [COleServerDoc::OnExecOleCmd](../../mfc/reference/coleserverdoc-class.md#coleserverdoc__onexecolecmd)."},{"content":"For further information on DocObjects, see <bpt id=\"p1\">[</bpt>CDocObjectServer<ept id=\"p1\">](../../mfc/reference/cdocobjectserver-class.md)</ept> and <bpt id=\"p2\">[</bpt>CDocObjectServerItem<ept id=\"p2\">](../../mfc/reference/cdocobjectserveritem-class.md)</ept>.","pos":[2747,2934],"source":"For further information on DocObjects, see [CDocObjectServer](../../mfc/reference/cdocobjectserver-class.md) and [CDocObjectServerItem](../../mfc/reference/cdocobjectserveritem-class.md)."},{"content":"Also see <bpt id=\"p1\">[</bpt>Internet First Steps: Active Documents<ept id=\"p1\">](../../mfc/active-documents-on-the-internet.md)</ept> and <bpt id=\"p2\">[</bpt>Active Documents<ept id=\"p2\">](../../mfc/active-documents-on-the-internet.md)</ept>.","pos":[2935,3102],"source":" Also see [Internet First Steps: Active Documents](../../mfc/active-documents-on-the-internet.md) and [Active Documents](../../mfc/active-documents-on-the-internet.md)."},{"pos":[3111,3132],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3136,3181],"content":"<bpt id=\"p1\">[</bpt>CCmdUI<ept id=\"p1\">](../../mfc/reference/ccmdui-class.md)</ept>","source":"[CCmdUI](../../mfc/reference/ccmdui-class.md)"},{"pos":[3208,3220],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3224,3247],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdocobj.h","source":"**Header:** afxdocobj.h"},{"pos":[3257,3314],"content":"<bpt id=\"p1\">&lt;a name=\"colecmdui__colecmdui\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleCmdUI::COleCmdUI","linkify":"<a name=\"colecmdui__colecmdui\"></a>  COleCmdUI::COleCmdUI","source":"<a name=\"colecmdui__colecmdui\"></a>  COleCmdUI::COleCmdUI"},{"pos":[3318,3402],"content":"Constructs a <ph id=\"ph1\">`COleCmdUI`</ph> object associated with a particular user-interface command.","source":"Constructs a `COleCmdUI` object associated with a particular user-interface command."},{"pos":[3506,3516],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A list of supported commands associated with the given GUID.","pos":[3532,3592]},{"content":"The <bpt id=\"p1\">**</bpt>OLECMD<ept id=\"p1\">**</ept> structure associates commands with command flags.","pos":[3593,3657],"source":" The **OLECMD** structure associates commands with command flags."},{"content":"<bpt id=\"p1\">*</bpt>cCmds<ept id=\"p1\">*</ept>","pos":[3664,3671],"source":"*cCmds*"},{"content":"The count of commands in <ph id=\"ph1\">`rgCmds`</ph>.","pos":[3675,3709],"source":" The count of commands in `rgCmds`."},{"content":"A pointer to a GUID that identifies a set of commands.","pos":[3728,3782]},{"pos":[3792,3799],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`COleCmdUI`</ph> object provides a programmatic interface for updating DocObject user-interface objects such as menu items or control-bar buttons.","pos":[3803,3948],"source":"The `COleCmdUI` object provides a programmatic interface for updating DocObject user-interface objects such as menu items or control-bar buttons."},{"content":"The user-interface objects can be enabled, disabled, checked, and/or cleared through the <ph id=\"ph1\">`COleCmdUI`</ph> object.","pos":[3949,4057],"source":" The user-interface objects can be enabled, disabled, checked, and/or cleared through the `COleCmdUI` object."},{"pos":[4067,4118],"content":"<bpt id=\"p1\">&lt;a name=\"colecmdui__enable\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleCmdUI::Enable","linkify":"<a name=\"colecmdui__enable\"></a>  COleCmdUI::Enable","source":"<a name=\"colecmdui__enable\"></a>  COleCmdUI::Enable"},{"pos":[4122,4309],"content":"Call this function to set the command flag of the <ph id=\"ph1\">`COleCmdUI`</ph> object to <bpt id=\"p1\">**</bpt>OLECOMDF_ENABLED<ept id=\"p1\">**</ept>, which tells the interface the command is available and enabled, or to clear the command flag.","source":"Call this function to set the command flag of the `COleCmdUI` object to **OLECOMDF_ENABLED**, which tells the interface the command is available and enabled, or to clear the command flag."},{"pos":[4365,4375],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Indicates whether the command associated with the <ph id=\"ph1\">`COleCmdUI`</ph> object should be enabled or disabled.","pos":[4388,4487],"source":" Indicates whether the command associated with the `COleCmdUI` object should be enabled or disabled."},{"content":"Nonzero enables the command; 0 disables the command.","pos":[4488,4540]},{"pos":[4550,4605],"content":"<bpt id=\"p1\">&lt;a name=\"colecmdui__setcheck\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleCmdUI::SetCheck","linkify":"<a name=\"colecmdui__setcheck\"></a>  COleCmdUI::SetCheck","source":"<a name=\"colecmdui__setcheck\"></a>  COleCmdUI::SetCheck"},{"content":"Call this function to set the state of an on/off toggle command.","pos":[4609,4673]},{"pos":[4733,4743],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A value determining the state to set an on/off toggle command.","pos":[4759,4821]},{"content":"Values are:","pos":[4822,4833]},{"content":"Value","pos":[4840,4845]},{"content":"Description","pos":[4846,4857]},{"pos":[4896,4901],"content":"<bpt id=\"p1\">**</bpt>1<ept id=\"p1\">**</ept>","source":"**1**"},{"content":"Sets the command to on.","pos":[4902,4925]},{"pos":[4930,4935],"content":"<bpt id=\"p1\">**</bpt>2<ept id=\"p1\">**</ept>","source":"**2**"},{"content":"Sets the command to indeterminate; the state cannot be determined because the attribute of this command is in both on and off states in the relevant selection.","pos":[4936,5095]},{"content":"any other value","pos":[5100,5115]},{"content":"Sets the command to off.","pos":[5116,5140]},{"pos":[5151,5204],"content":"<bpt id=\"p1\">&lt;a name=\"colecmdui__settext\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleCmdUI::SetText","linkify":"<a name=\"colecmdui__settext\"></a>  COleCmdUI::SetText","source":"<a name=\"colecmdui__settext\"></a>  COleCmdUI::SetText"},{"content":"Call this function to return a text name or status string for a command.","pos":[5208,5280]},{"pos":[5345,5355],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to the text to be used with the command.","pos":[5373,5423]},{"pos":[5432,5440],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CCmdUI Class<ept id=\"p1\">](../../mfc/reference/ccmdui-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[5444,5496],"source":"[CCmdUI Class](../../mfc/reference/ccmdui-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept>","pos":[5499,5547],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md)"}],"content":"---\ntitle: \"COleCmdUI Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleCmdUI\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"document object server\"\n  - \"COleCmdUI class\"\n  - \"servers [C++], ActiveX documents\"\n  - \"docobject server\"\n  - \"servers [C++], doc objects\"\n  - \"ActiveX documents [C++], document server\"\nms.assetid: a2d5ce08-6657-45d3-8673-2a9f32d50eec\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleCmdUI Class\nImplements a method for MFC to update the state of user-interface objects related to the `IOleCommandTarget`-driven features of your application.  \n  \n## Syntax  \n  \n```  \nclass COleCmdUI : public CCmdUI  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleCmdUI::COleCmdUI](#colecmdui__colecmdui)|Constructs a `COleCmdUI` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleCmdUI::Enable](#colecmdui__enable)|Sets or clears the enable command flag.|  \n|[COleCmdUI::SetCheck](#colecmdui__setcheck)|Sets the state of an on/off toggle command.|  \n|[COleCmdUI::SetText](#colecmdui__settext)|Returns a text name or status string for a command.|  \n  \n## Remarks  \n In an application that is not enabled for DocObjects, when the user views a menu in the application, MFC processes **UPDATE_COMMAND_UI** notifcations. Each notification is given a [CCmdUI](../../mfc/reference/ccmdui-class.md) object that can be manipulated to reflect the state of a particular command. However, when your application is enabled for DocObjects, MFC processes **UPDATE_OLE_COMMAND_UI** notifications and assigns `COleCmdUI` objects.  \n  \n `COleCmdUI` allows a DocObject to receive commands that originate in its container's user interface (such as FileNew, Open, Print, and so on), and allows a container to receive commands that originate in the DocObject's user interface. Although `IDispatch` could be used to dispatch the same commands, `IOleCommandTarget` provides a simpler way to query and execute because it relies on a standard set of commands, usually without arguments, and no type information is involved. `COleCmdUI` can be used to enable, update, and set other properties of DocObject user interface commands. When you want to invoke the command, call [COleServerDoc::OnExecOleCmd](../../mfc/reference/coleserverdoc-class.md#coleserverdoc__onexecolecmd).  \n  \n For further information on DocObjects, see [CDocObjectServer](../../mfc/reference/cdocobjectserver-class.md) and [CDocObjectServerItem](../../mfc/reference/cdocobjectserveritem-class.md). Also see [Internet First Steps: Active Documents](../../mfc/active-documents-on-the-internet.md) and [Active Documents](../../mfc/active-documents-on-the-internet.md).  \n  \n## Inheritance Hierarchy  \n [CCmdUI](../../mfc/reference/ccmdui-class.md)  \n  \n `COleCmdUI`  \n  \n## Requirements  \n **Header:** afxdocobj.h  \n  \n##  <a name=\"colecmdui__colecmdui\"></a>  COleCmdUI::COleCmdUI  \n Constructs a `COleCmdUI` object associated with a particular user-interface command.  \n  \n```  \nCOleCmdUI(\n    OLECMD* rgCmds,  \n    ULONG cCmds,  \n    const GUID* m_pGroup);\n```  \n  \n### Parameters  \n `rgCmds`  \n A list of supported commands associated with the given GUID. The **OLECMD** structure associates commands with command flags.  \n  \n *cCmds*  \n The count of commands in `rgCmds`.  \n  \n `pGroup`  \n A pointer to a GUID that identifies a set of commands.  \n  \n### Remarks  \n The `COleCmdUI` object provides a programmatic interface for updating DocObject user-interface objects such as menu items or control-bar buttons. The user-interface objects can be enabled, disabled, checked, and/or cleared through the `COleCmdUI` object.  \n  \n##  <a name=\"colecmdui__enable\"></a>  COleCmdUI::Enable  \n Call this function to set the command flag of the `COleCmdUI` object to **OLECOMDF_ENABLED**, which tells the interface the command is available and enabled, or to clear the command flag.  \n  \n```  \nvirtual void Enable(BOOL bOn);\n```  \n  \n### Parameters  \n `bOn`  \n Indicates whether the command associated with the `COleCmdUI` object should be enabled or disabled. Nonzero enables the command; 0 disables the command.  \n  \n##  <a name=\"colecmdui__setcheck\"></a>  COleCmdUI::SetCheck  \n Call this function to set the state of an on/off toggle command.  \n  \n```  \nvirtual void SetCheck(int nCheck);\n```  \n  \n### Parameters  \n `nCheck`  \n A value determining the state to set an on/off toggle command. Values are:  \n  \n|Value|Description|  \n|-----------|-----------------|  \n|**1**|Sets the command to on.|  \n|**2**|Sets the command to indeterminate; the state cannot be determined because the attribute of this command is in both on and off states in the relevant selection.|  \n|any other value|Sets the command to off.|  \n  \n##  <a name=\"colecmdui__settext\"></a>  COleCmdUI::SetText  \n Call this function to return a text name or status string for a command.  \n  \n```  \nvirtual void SetText(LPCTSTR lpszText);\n```  \n  \n### Parameters  \n `lpszText`  \n A pointer to the text to be used with the command.  \n  \n## See Also  \n [CCmdUI Class](../../mfc/reference/ccmdui-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n\n\n"}