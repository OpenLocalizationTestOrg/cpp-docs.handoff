{"nodes":[{"pos":[12,52],"content":"CGopherConnection Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CGopherConnection Class | Microsoft Docs","pos":[0,40]}]},{"content":"CGopherConnection Class","pos":[880,903]},{"content":"Manages your connection to a gopher Internet server.","pos":[904,956]},{"pos":[964,1203],"content":"[!NOTE]\n The classes `CGopherConnection`, `CGopherFile`, `CGopherFileFind`, `CGopherLocator` and their members have been deprecated because they do not work on the Windows XP platform, but they will continue to work on earlier platforms.","leadings":["","> "],"nodes":[{"content":"The classes <ph id=\"ph1\">`CGopherConnection`</ph>, <ph id=\"ph2\">`CGopherFile`</ph>, <ph id=\"ph3\">`CGopherFileFind`</ph>, <ph id=\"ph4\">`CGopherLocator`</ph> and their members have been deprecated because they do not work on the Windows XP platform, but they will continue to work on earlier platforms.","pos":[9,237],"source":" The classes `CGopherConnection`, `CGopherFile`, `CGopherFileFind`, `CGopherLocator` and their members have been deprecated because they do not work on the Windows XP platform, but they will continue to work on earlier platforms."}]},{"content":"Syntax","pos":[1212,1218]},{"content":"Members","pos":[1297,1304]},{"content":"Public Constructors","pos":[1314,1333]},{"content":"Name","pos":[1340,1344]},{"content":"Description","pos":[1345,1356]},{"content":"CGopherConnection::CGopherConnection","pos":[1395,1431]},{"pos":[1472,1512],"content":"Constructs a <ph id=\"ph1\">`CGopherConnection`</ph> object.","source":"Constructs a `CGopherConnection` object."},{"content":"Public Methods","pos":[1523,1537]},{"content":"Name","pos":[1544,1548]},{"content":"Description","pos":[1549,1560]},{"content":"CGopherConnection::CreateLocator","pos":[1599,1631]},{"pos":[1668,1780],"content":"Creates a <bpt id=\"p1\">[</bpt>CGopherLocator<ept id=\"p1\">](../../mfc/reference/cgopherlocator-class.md)</ept> object to find files on a gopher server.","source":"Creates a [CGopherLocator](../../mfc/reference/cgopherlocator-class.md) object to find files on a gopher server."},{"content":"CGopherConnection::GetAttribute","pos":[1786,1817]},{"content":"Retrieves attribute information about the gopher object.","pos":[1853,1909]},{"content":"CGopherConnection::OpenFile","pos":[1915,1942]},{"content":"Opens a gopher file.","pos":[1974,1994]},{"content":"Remarks","pos":[2004,2011]},{"content":"The gopher service is one of three Internet services recognized by the MFC WinInet classes.","pos":[2015,2106]},{"pos":[2113,2383],"content":"The class <ph id=\"ph1\">`CGopherConnection`</ph> contains a constructor and three additional member functions that manage the gopher service: <bpt id=\"p1\">[</bpt>OpenFile<ept id=\"p1\">](#cgopherconnection__openfile)</ept>, <bpt id=\"p2\">[</bpt>CreateLocator<ept id=\"p2\">](#cgopherconnection__createlocator)</ept>, and <bpt id=\"p3\">[</bpt>GetAttribute<ept id=\"p3\">](#cgopherconnection__getattribute)</ept>.","source":"The class `CGopherConnection` contains a constructor and three additional member functions that manage the gopher service: [OpenFile](#cgopherconnection__openfile), [CreateLocator](#cgopherconnection__createlocator), and [GetAttribute](#cgopherconnection__getattribute)."},{"content":"To communicate with a gopher Internet server, you must first create an instance of <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept>, and then call <bpt id=\"p2\">[</bpt>CInternetSession::GetGopherConnection<ept id=\"p2\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__getgopherconnection)</ept>, which creates the <ph id=\"ph1\">`CGopherConnection`</ph> object and returns a pointer to it.","pos":[2390,2753],"source":"To communicate with a gopher Internet server, you must first create an instance of [CInternetSession](../../mfc/reference/cinternetsession-class.md), and then call [CInternetSession::GetGopherConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getgopherconnection), which creates the `CGopherConnection` object and returns a pointer to it."},{"content":"You never create a <ph id=\"ph1\">`CGopherConnection`</ph> object directly.","pos":[2754,2809],"source":" You never create a `CGopherConnection` object directly."},{"content":"To learn more about how <ph id=\"ph1\">`CGopherConnection`</ph> works with the other MFC Internet classes, see the article <bpt id=\"p1\">[</bpt>Internet Programming with WinInet<ept id=\"p1\">](../../mfc/win32-internet-extensions-wininet.md)</ept>.","pos":[2816,3003],"source":"To learn more about how `CGopherConnection` works with the other MFC Internet classes, see the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md)."},{"content":"For more information about using the other two supported Internet services, FTP and HTTP see the classes <bpt id=\"p1\">[</bpt>CHttpConnection<ept id=\"p1\">](../../mfc/reference/chttpconnection-class.md)</ept> and <bpt id=\"p2\">[</bpt>CFtpConnection<ept id=\"p2\">](../../mfc/reference/cftpconnection-class.md)</ept>.","pos":[3004,3239],"source":" For more information about using the other two supported Internet services, FTP and HTTP see the classes [CHttpConnection](../../mfc/reference/chttpconnection-class.md) and [CFtpConnection](../../mfc/reference/cftpconnection-class.md)."},{"content":"Inheritance Hierarchy","pos":[3248,3269]},{"content":"CObject","pos":[3274,3281]},{"content":"CInternetConnection","pos":[3328,3347]},{"content":"Requirements","pos":[3433,3445]},{"pos":[3449,3470],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxinet.h","source":"**Header:** afxinet.h"},{"pos":[3533,3569],"content":"CGopherConnection::CGopherConnection"},{"pos":[3573,3646],"content":"This member function is called to construct a <ph id=\"ph1\">`CGopherConnection`</ph> object.","source":"This member function is called to construct a `CGopherConnection` object."},{"content":"Parameters","pos":[4044,4054]},{"content":"A pointer to the related <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object.","pos":[4072,4170],"source":" A pointer to the related [CInternetSession](../../mfc/reference/cinternetsession-class.md) object."},{"content":"The Windows handle of the current Internet session.","pos":[4193,4244]},{"content":"A pointer to a string containing the FTP server name.","pos":[4267,4320]},{"content":"The context identifier for the operation.","pos":[4342,4383]},{"content":"identifies the operation's status information returned by <bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)</ept>.","pos":[4396,4573],"source":" identifies the operation's status information returned by [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)."},{"content":"The default is set to 1; however, you can explicitly assign a specific context ID for the operation.","pos":[4574,4674]},{"content":"The object and any work it does will be associated with that context ID.","pos":[4675,4747]},{"content":"Pointer to a null-terminated string that specifies the name of the user to log in.","pos":[4772,4854]},{"content":"If <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default is anonymous.","pos":[4855,4893],"source":" If **NULL**, the default is anonymous."},{"content":"A pointer to a null-terminated string that specifies the password to use to log in.","pos":[4918,5001]},{"content":"If both <ph id=\"ph1\">`pstrPassword`</ph> and <ph id=\"ph2\">`pstrUserName`</ph> are <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default anonymous password is the user's email name.","pos":[5002,5114],"source":" If both `pstrPassword` and `pstrUserName` are **NULL**, the default anonymous password is the user's email name."},{"content":"If <ph id=\"ph1\">`pstrPassword`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> (or an empty string) but <ph id=\"ph2\">`pstrUserName`</ph> is not <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>, a blank password is used.","pos":[5115,5227],"source":" If `pstrPassword` is **NULL** (or an empty string) but `pstrUserName` is not **NULL**, a blank password is used."},{"content":"The following table describes the behavior for the four possible settings of <ph id=\"ph1\">`pstrUserName`</ph> and <ph id=\"ph2\">`pstrPassword`</ph>:","pos":[5228,5339],"source":" The following table describes the behavior for the four possible settings of `pstrUserName` and `pstrPassword`:"},{"content":"Username sent to FTP server","pos":[5376,5403]},{"content":"Password sent to FTP server","pos":[5404,5431]},{"pos":[5550,5565],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or \" \"","source":"**NULL** or \" \""},{"pos":[5566,5581],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or \" \"","source":"**NULL** or \" \""},{"content":"\"anonymous\"","pos":[5582,5593]},{"content":"User's email name","pos":[5594,5611]},{"pos":[5616,5636],"content":"Non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> String","source":"Non- **NULL** String"},{"pos":[5637,5652],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or \" \"","source":"**NULL** or \" \""},{"content":"\" \"","pos":[5668,5671]},{"pos":[5676,5705],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> Non- <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> String","source":"**NULL** Non- **NULL** String"},{"content":"ERROR","pos":[5708,5713]},{"content":"ERROR","pos":[5718,5723]},{"pos":[5731,5751],"content":"Non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> String","source":"Non- **NULL** String"},{"pos":[5752,5772],"content":"Non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> String","source":"Non- **NULL** String"},{"content":"A number that identifies the TCP/IP port to use on the server.","pos":[5821,5883]},{"content":"Remarks","pos":[5893,5900]},{"content":"You never create a <ph id=\"ph1\">`CGopherConnection`</ph> directly.","pos":[5904,5952],"source":"You never create a `CGopherConnection` directly."},{"content":"Rather, call <bpt id=\"p1\">[</bpt>CInternetSession::GetGopherConnection<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__getgopherconnection)</ept>, which creates a <ph id=\"ph1\">`CGopherConnection`</ph> object and returns a pointer to it.","pos":[5953,6163],"source":" Rather, call [CInternetSession::GetGopherConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getgopherconnection), which creates a `CGopherConnection` object and returns a pointer to it."},{"pos":[6222,6254],"content":"CGopherConnection::CreateLocator"},{"content":"Call this member function to create a gopher locator to find or identify a file on a gopher server.","pos":[6258,6357]},{"content":"Parameters","pos":[6790,6800]},{"content":"A pointer to a string containing the name of the gopher document or directory to be retrieved.","pos":[6827,6921]},{"content":"If the <ph id=\"ph1\">`pstrDisplayString`</ph> parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default directory for the gopher server is returned.","pos":[6922,7028],"source":" If the `pstrDisplayString` parameter is **NULL**, the default directory for the gopher server is returned."},{"content":"A pointer to the selector string to be sent to the gopher server in order to retrieve an item.","pos":[7059,7153]},{"content":"can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[7175,7191],"source":" can be **NULL**."},{"content":"dwGopherType","pos":[7199,7211]},{"content":"This specifies whether <ph id=\"ph1\">`pstrSelectorString`</ph> refers to a directory or document, and whether the request is gopher or gopher+.","pos":[7216,7340],"source":" This specifies whether `pstrSelectorString` refers to a directory or document, and whether the request is gopher or gopher+."},{"content":"See the attributes for the structure <bpt id=\"p1\">[</bpt>GOPHER_FIND_DATA<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa384215)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[7341,7516],"source":" See the attributes for the structure [GOPHER_FIND_DATA](http://msdn.microsoft.com/library/windows/desktop/aa384215) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"A pointer to a string identifying the file to open.","pos":[7540,7591]},{"content":"Generally, this string is returned from a call to <bpt id=\"p1\">[</bpt>CGopherFileFind::GetLocator<ept id=\"p1\">](../../mfc/reference/cgopherfilefind-class.md#cgopherfilefind__getlocator)</ept>.","pos":[7592,7746],"source":" Generally, this string is returned from a call to [CGopherFileFind::GetLocator](../../mfc/reference/cgopherfilefind-class.md#cgopherfilefind__getlocator)."},{"content":"pstrServerName","pos":[7754,7768]},{"content":"A pointer to a string containing the gopher server name.","pos":[7773,7829]},{"content":"The number identifying the Internet port for this connection.","pos":[7847,7908]},{"content":"Return Value","pos":[7918,7930]},{"pos":[7934,8005],"content":"A <bpt id=\"p1\">[</bpt>CGopherLocator<ept id=\"p1\">](../../mfc/reference/cgopherlocator-class.md)</ept> object.","source":"A [CGopherLocator](../../mfc/reference/cgopherlocator-class.md) object."},{"content":"Remarks","pos":[8015,8022]},{"content":"The static version of the member function requires you to specify a server, while the non-static version uses the server name from the connection object.","pos":[8026,8179]},{"content":"In order to retrieve information from a gopher server, an application must first get a gopher locator.","pos":[8186,8288]},{"content":"The application must then treat the locator as an opaque token (that is, the application can use the locator but not directly manipulate or compare it).","pos":[8289,8441]},{"content":"Normally, the application uses the locator for calls to the <bpt id=\"p1\">[</bpt>CGopherFileFind::FindFile<ept id=\"p1\">](../../mfc/reference/cgopherfilefind-class.md#cgopherfilefind__findfile)</ept> member function to retrieve a specific piece of information.","pos":[8442,8662],"source":" Normally, the application uses the locator for calls to the [CGopherFileFind::FindFile](../../mfc/reference/cgopherfilefind-class.md#cgopherfilefind__findfile) member function to retrieve a specific piece of information."},{"pos":[8720,8751],"content":"CGopherConnection::GetAttribute"},{"content":"Call this member function to retrieve specific attribute information about an item from the gopher server.","pos":[8755,8861]},{"content":"Parameters","pos":[8999,9009]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CGopherLocator<ept id=\"p1\">](../../mfc/reference/cgopherlocator-class.md)</ept> object.","pos":[9029,9115],"source":" A reference to a [CGopherLocator](../../mfc/reference/cgopherlocator-class.md) object."},{"content":"strRequestedAttributes","pos":[9123,9145]},{"content":"A space-delimited string specifying the names of the requested attributes.","pos":[9150,9224]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> that receives the locator type.","pos":[9246,9354],"source":" A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) that receives the locator type."},{"content":"Return Value","pos":[9364,9376]},{"content":"Nonzero if successful; otherwise 0.","pos":[9380,9415]},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[9416,9579],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"pos":[9633,9660],"content":"CGopherConnection::OpenFile"},{"content":"Call this member function to open a file on a gopher server.","pos":[9664,9724]},{"content":"Parameters","pos":[9892,9902]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CGopherLocator<ept id=\"p1\">](../../mfc/reference/cgopherlocator-class.md)</ept> object.","pos":[9922,10008],"source":" A reference to a [CGopherLocator](../../mfc/reference/cgopherlocator-class.md) object."},{"content":"Any combination of INTERNET_FLAG_* flags.","pos":[10028,10069]},{"content":"See <bpt id=\"p1\">[</bpt>CInternetSession::OpenUrl<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__openurl)</ept> for further information on INTERNET_FLAG_<ph id=\"ph1\">\\*</ph> flags.","pos":[10070,10225],"source":" See [CInternetSession::OpenUrl](../../mfc/reference/cinternetsession-class.md#cinternetsession__openurl) for further information on INTERNET_FLAG_\\* flags."},{"content":"A pointer to a file-view string.","pos":[10246,10278]},{"content":"If several views of the file exist at the server, this parameter specifies which file view to open.","pos":[10279,10378]},{"content":"If <ph id=\"ph1\">`pstrView`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default file view is used.","pos":[10379,10436],"source":" If `pstrView` is **NULL**, the default file view is used."},{"content":"The context ID for the file being opened.","pos":[10458,10499]},{"content":"See <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> for more information about <ph id=\"ph1\">`dwContext`</ph>.","pos":[10500,10555],"source":" See **Remarks** for more information about `dwContext`."},{"content":"Return Value","pos":[10565,10577]},{"pos":[10581,10674],"content":"A pointer to the <bpt id=\"p1\">[</bpt>CGopherFile<ept id=\"p1\">](../../mfc/reference/cgopherfile-class.md)</ept> object to be opened.","source":"A pointer to the [CGopherFile](../../mfc/reference/cgopherfile-class.md) object to be opened."},{"content":"Remarks","pos":[10684,10691]},{"content":"Override the <ph id=\"ph1\">`dwContext`</ph> default to set the context identifier to a value of your choosing.","pos":[10695,10786],"source":"Override the `dwContext` default to set the context identifier to a value of your choosing."},{"content":"The context identifier is associated with this specific operation of the <ph id=\"ph1\">`CGopherConnection`</ph> object created by its <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object.","pos":[10787,10975],"source":" The context identifier is associated with this specific operation of the `CGopherConnection` object created by its [CInternetSession](../../mfc/reference/cinternetsession-class.md) object."},{"content":"The value is returned to <bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)</ept> to provide status on the operation with which it is identified.","pos":[10976,11183],"source":" The value is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the operation with which it is identified."},{"content":"See the article <bpt id=\"p1\">[</bpt>Internet First Steps: WinInet<ept id=\"p1\">](../../mfc/wininet-basics.md)</ept> for more information about the context identifier.","pos":[11184,11311],"source":" See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier."},{"content":"See Also","pos":[11320,11328]},{"content":"CInternetConnection Class","pos":[11333,11358]},{"content":"Hierarchy Chart","pos":[11415,11430]},{"content":"CFtpConnection Class","pos":[11467,11487]},{"content":"CHttpConnection Class","pos":[11539,11560]},{"content":"CInternetConnection Class","pos":[11613,11638]},{"content":"CGopherLocator Class","pos":[11695,11715]},{"content":"CGopherFile Class","pos":[11767,11784]},{"content":"CInternetSession Class","pos":[11833,11855]}],"content":"---\ntitle: \"CGopherConnection Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CGopherConnection\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"servers, connecting to\"\n  - \"Internet server, gopher\"\n  - \"connecting to servers, gopher servers\"\n  - \"protocols, gopher\"\n  - \"services, gopher\"\n  - \"CGopherConnection class\"\n  - \"gopher protocol\"\n  - \"gopher server\"\n  - \"connecting to servers\"\n  - \"Internet connections, gopher\"\nms.assetid: b5b96aea-ac99-430e-bd84-d1372b43f78f\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CGopherConnection Class\nManages your connection to a gopher Internet server.  \n  \n> [!NOTE]\n>  The classes `CGopherConnection`, `CGopherFile`, `CGopherFileFind`, `CGopherLocator` and their members have been deprecated because they do not work on the Windows XP platform, but they will continue to work on earlier platforms.  \n  \n## Syntax  \n  \n```  \nclass CGopherConnection : public CInternetConnection  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CGopherConnection::CGopherConnection](#cgopherconnection__cgopherconnection)|Constructs a `CGopherConnection` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CGopherConnection::CreateLocator](#cgopherconnection__createlocator)|Creates a [CGopherLocator](../../mfc/reference/cgopherlocator-class.md) object to find files on a gopher server.|  \n|[CGopherConnection::GetAttribute](#cgopherconnection__getattribute)|Retrieves attribute information about the gopher object.|  \n|[CGopherConnection::OpenFile](#cgopherconnection__openfile)|Opens a gopher file.|  \n  \n## Remarks  \n The gopher service is one of three Internet services recognized by the MFC WinInet classes.  \n  \n The class `CGopherConnection` contains a constructor and three additional member functions that manage the gopher service: [OpenFile](#cgopherconnection__openfile), [CreateLocator](#cgopherconnection__createlocator), and [GetAttribute](#cgopherconnection__getattribute).  \n  \n To communicate with a gopher Internet server, you must first create an instance of [CInternetSession](../../mfc/reference/cinternetsession-class.md), and then call [CInternetSession::GetGopherConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getgopherconnection), which creates the `CGopherConnection` object and returns a pointer to it. You never create a `CGopherConnection` object directly.  \n  \n To learn more about how `CGopherConnection` works with the other MFC Internet classes, see the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md). For more information about using the other two supported Internet services, FTP and HTTP see the classes [CHttpConnection](../../mfc/reference/chttpconnection-class.md) and [CFtpConnection](../../mfc/reference/cftpconnection-class.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CInternetConnection](../../mfc/reference/cinternetconnection-class.md)  \n  \n `CGopherConnection`  \n  \n## Requirements  \n **Header:** afxinet.h  \n  \n##  <a name=\"cgopherconnection__cgopherconnection\"></a>  CGopherConnection::CGopherConnection  \n This member function is called to construct a `CGopherConnection` object.  \n  \n```  \nCGopherConnection(\n    CInternetSession* pSession,  \n    HINTERNET hConnected,  \n    LPCTSTR pstrServer,  \n    DWORD_PTR dwContext);\n\n \nCGopherConnection(\n    CInternetSession* pSession,  \n    LPCTSTR pstrServer,  \n    LPCTSTR pstrUserName = NULL,  \n    LPCTSTR pstrPassword = NULL,  \n    DWORD_PTR dwContext = 0,  \n    INTERNET_PORT nPort = INTERNET_INVALID_PORT_NUMBER);\n```  \n  \n### Parameters  \n `pSession`  \n A pointer to the related [CInternetSession](../../mfc/reference/cinternetsession-class.md) object.  \n  \n `hConnected`  \n The Windows handle of the current Internet session.  \n  \n `pstrServer`  \n A pointer to a string containing the FTP server name.  \n  \n `dwContext`  \n The context identifier for the operation. `dwContext` identifies the operation's status information returned by [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback). The default is set to 1; however, you can explicitly assign a specific context ID for the operation. The object and any work it does will be associated with that context ID.  \n  \n `pstrUserName`  \n Pointer to a null-terminated string that specifies the name of the user to log in. If **NULL**, the default is anonymous.  \n  \n `pstrPassword`  \n A pointer to a null-terminated string that specifies the password to use to log in. If both `pstrPassword` and `pstrUserName` are **NULL**, the default anonymous password is the user's email name. If `pstrPassword` is **NULL** (or an empty string) but `pstrUserName` is not **NULL**, a blank password is used. The following table describes the behavior for the four possible settings of `pstrUserName` and `pstrPassword`:  \n  \n|`pstrUserName`|`pstrPassword`|Username sent to FTP server|Password sent to FTP server|  \n|--------------------|--------------------|---------------------------------|---------------------------------|  \n|**NULL** or \" \"|**NULL** or \" \"|\"anonymous\"|User's email name|  \n|Non- **NULL** String|**NULL** or \" \"|`pstrUserName`|\" \"|  \n|**NULL** Non- **NULL** String|**ERROR**|**ERROR**||  \n|Non- **NULL** String|Non- **NULL** String|`pstrUserName`|`pstrPassword`|  \n  \n `nPort`  \n A number that identifies the TCP/IP port to use on the server.  \n  \n### Remarks  \n You never create a `CGopherConnection` directly. Rather, call [CInternetSession::GetGopherConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getgopherconnection), which creates a `CGopherConnection` object and returns a pointer to it.  \n  \n##  <a name=\"cgopherconnection__createlocator\"></a>  CGopherConnection::CreateLocator  \n Call this member function to create a gopher locator to find or identify a file on a gopher server.  \n  \n```  \nCGopherLocator CreateLocator(\n    LPCTSTR pstrDisplayString,  \n    LPCTSTR pstrSelectorString,  \n    DWORD dwGopherType);\n\n \nstatic CGopherLocator CreateLocator(\n    LPCTSTR pstrLocator);\n\n \nstatic CGopherLocator CreateLocator(\n    LPCTSTR pstrServerName,  \n    LPCTSTR pstrDisplayString,  \n    LPCTSTR pstrSelectorString,  \n    DWORD dwGopherType,  \n    INTERNET_PORT nPort = INTERNET_INVALID_PORT_NUMBER);\n```  \n  \n### Parameters  \n `pstrDisplayString`  \n A pointer to a string containing the name of the gopher document or directory to be retrieved. If the `pstrDisplayString` parameter is **NULL**, the default directory for the gopher server is returned.  \n  \n `pstrSelectorString`  \n A pointer to the selector string to be sent to the gopher server in order to retrieve an item. `pstrSelectorString` can be **NULL**.  \n  \n *dwGopherType*  \n This specifies whether `pstrSelectorString` refers to a directory or document, and whether the request is gopher or gopher+. See the attributes for the structure [GOPHER_FIND_DATA](http://msdn.microsoft.com/library/windows/desktop/aa384215) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n `pstrLocator`  \n A pointer to a string identifying the file to open. Generally, this string is returned from a call to [CGopherFileFind::GetLocator](../../mfc/reference/cgopherfilefind-class.md#cgopherfilefind__getlocator).  \n  \n *pstrServerName*  \n A pointer to a string containing the gopher server name.  \n  \n `nPort`  \n The number identifying the Internet port for this connection.  \n  \n### Return Value  \n A [CGopherLocator](../../mfc/reference/cgopherlocator-class.md) object.  \n  \n### Remarks  \n The static version of the member function requires you to specify a server, while the non-static version uses the server name from the connection object.  \n  \n In order to retrieve information from a gopher server, an application must first get a gopher locator. The application must then treat the locator as an opaque token (that is, the application can use the locator but not directly manipulate or compare it). Normally, the application uses the locator for calls to the [CGopherFileFind::FindFile](../../mfc/reference/cgopherfilefind-class.md#cgopherfilefind__findfile) member function to retrieve a specific piece of information.  \n  \n##  <a name=\"cgopherconnection__getattribute\"></a>  CGopherConnection::GetAttribute  \n Call this member function to retrieve specific attribute information about an item from the gopher server.  \n  \n```  \nBOOL GetAttribute(\n    CGopherLocator& refLocator    CString strRequestedAttributes,  \n    CString& strResult,);\n```  \n  \n### Parameters  \n `refLocator`  \n A reference to a [CGopherLocator](../../mfc/reference/cgopherlocator-class.md) object.  \n  \n *strRequestedAttributes*  \n A space-delimited string specifying the names of the requested attributes.  \n  \n `strResult`  \n A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) that receives the locator type.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n##  <a name=\"cgopherconnection__openfile\"></a>  CGopherConnection::OpenFile  \n Call this member function to open a file on a gopher server.  \n  \n```  \nCGopherFile* OpenFile(\n    CGopherLocator& refLocator,  \n    DWORD dwFlags = 0,  \n    LPCTSTR pstrView = NULL,  \n    DWORD_PTR dwContext = 1);\n```  \n  \n### Parameters  \n `refLocator`  \n A reference to a [CGopherLocator](../../mfc/reference/cgopherlocator-class.md) object.  \n  \n `dwFlags`  \n Any combination of INTERNET_FLAG_* flags. See [CInternetSession::OpenUrl](../../mfc/reference/cinternetsession-class.md#cinternetsession__openurl) for further information on INTERNET_FLAG_\\* flags.  \n  \n `pstrView`  \n A pointer to a file-view string. If several views of the file exist at the server, this parameter specifies which file view to open. If `pstrView` is **NULL**, the default file view is used.  \n  \n `dwContext`  \n The context ID for the file being opened. See **Remarks** for more information about `dwContext`.  \n  \n### Return Value  \n A pointer to the [CGopherFile](../../mfc/reference/cgopherfile-class.md) object to be opened.  \n  \n### Remarks  \n Override the `dwContext` default to set the context identifier to a value of your choosing. The context identifier is associated with this specific operation of the `CGopherConnection` object created by its [CInternetSession](../../mfc/reference/cinternetsession-class.md) object. The value is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the operation with which it is identified. See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier.  \n  \n## See Also  \n [CInternetConnection Class](../../mfc/reference/cinternetconnection-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CFtpConnection Class](../../mfc/reference/cftpconnection-class.md)   \n [CHttpConnection Class](../../mfc/reference/chttpconnection-class.md)   \n [CInternetConnection Class](../../mfc/reference/cinternetconnection-class.md)   \n [CGopherLocator Class](../../mfc/reference/cgopherlocator-class.md)   \n [CGopherFile Class](../../mfc/reference/cgopherfile-class.md)   \n [CInternetSession Class](../../mfc/reference/cinternetsession-class.md)\n"}