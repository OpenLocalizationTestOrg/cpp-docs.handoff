{"nodes":[{"pos":[12,79],"content":"Defining a Message Handler for a Reflected Message | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Defining a Message Handler for a Reflected Message | Microsoft Docs","pos":[0,67]}]},{"content":"Defining a Message Handler for a Reflected Message","pos":[705,755]},{"content":"Once you have created a new MFC control class, you can define message handlers for it.","pos":[756,842]},{"content":"Reflected message handlers allow your control class to handle its own messages before the message is received by the parent.","pos":[843,967]},{"content":"You can use the MFC <bpt id=\"p1\">[</bpt>CWnd::SendMessage<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__sendmessage)</ept> function to send messages from your control to a parent window.","pos":[968,1124],"source":" You can use the MFC [CWnd::SendMessage](../../mfc/reference/cwnd-class.md#cwnd__sendmessage) function to send messages from your control to a parent window."},{"content":"With this functionality you could, for example, create a list box that will redraw itself rather than relying on the parent window to do so (owner drawn).","pos":[1131,1285]},{"content":"For more information on reflected messages, see <bpt id=\"p1\">[</bpt>Handling Reflected Messages<ept id=\"p1\">](../../mfc/handling-reflected-messages.md)</ept>.","pos":[1286,1406],"source":" For more information on reflected messages, see [Handling Reflected Messages](../../mfc/handling-reflected-messages.md)."},{"pos":[1413,1570],"content":"To create an <bpt id=\"p1\">[</bpt>ActiveX control<ept id=\"p1\">](../../mfc/activex-controls-on-the-internet.md)</ept> with the same functionality, you must create a project for the ActiveX control.","source":"To create an [ActiveX control](../../mfc/activex-controls-on-the-internet.md) with the same functionality, you must create a project for the ActiveX control."},{"pos":[1578,1749],"content":"[!NOTE]\n You cannot add a reflected message (OCM_*Message*) for an ActiveX control using the Properties window, as described below. You must add these messages manually.","leadings":["","> "],"nodes":[{"content":" You cannot add a reflected message (OCM_*Message*) for an ActiveX control using the Properties window, as described below. You must add these messages manually.","pos":[8,169],"nodes":[{"content":"You cannot add a reflected message (OCM_<bpt id=\"p1\">*</bpt>Message<ept id=\"p1\">*</ept>) for an ActiveX control using the Properties window, as described below.","pos":[1,123],"source":" You cannot add a reflected message (OCM_*Message*) for an ActiveX control using the Properties window, as described below."},{"content":"You must add these messages manually.","pos":[124,161]}]}]},{"content":"To define a message handler for a reflected message from the Properties window","pos":[1759,1837]},{"content":"Add a control, such as a list, a rebar control, a toolbar, or a tree control, to your MFC project.","pos":[1847,1945]},{"content":"In Class View, click the name of your control class.","pos":[1955,2007]},{"pos":[2017,2150],"content":"In the <bpt id=\"p1\">[</bpt>Properties window<ept id=\"p1\">](/visualstudio/ide/reference/properties-window)</ept>, the control class name appears in the <bpt id=\"p2\">**</bpt>Class Name<ept id=\"p2\">**</ept> list.","source":"In the [Properties window](/visualstudio/ide/reference/properties-window), the control class name appears in the **Class Name** list."},{"pos":[2160,2254],"content":"Click the <bpt id=\"p1\">**</bpt>Messages<ept id=\"p1\">**</ept> button to display the Windows messages available to add to the control.","source":"Click the **Messages** button to display the Windows messages available to add to the control."},{"content":"Scroll down the list of messages in the Properties window until you see the heading <bpt id=\"p1\">**</bpt>Reflected<ept id=\"p1\">**</ept>.","pos":[2264,2362],"source":"Scroll down the list of messages in the Properties window until you see the heading **Reflected**."},{"content":"Alternately, click the <bpt id=\"p1\">**</bpt>Categories<ept id=\"p1\">**</ept> button and collapse the view to see the <bpt id=\"p2\">**</bpt>Reflected<ept id=\"p2\">**</ept> heading.","pos":[2363,2463],"source":" Alternately, click the **Categories** button and collapse the view to see the **Reflected** heading."},{"content":"Select the reflected message for which you want to define a handler.","pos":[2473,2541]},{"content":"Reflected messages are marked with an equal sign (=).","pos":[2542,2595]},{"content":"Click the cell in the right column in the Properties window to display the suggested name of the handler as <ph id=\"ph1\">\\&lt;</ph>add&gt;<bpt id=\"p1\">*</bpt>HandlerName<ept id=\"p1\">*</ept>.","pos":[2605,2733],"source":"Click the cell in the right column in the Properties window to display the suggested name of the handler as \\<add>*HandlerName*."},{"content":"(For example, the <bpt id=\"p1\">**</bpt>=WM_CTLCOLOR<ept id=\"p1\">**</ept> message handler suggests <ph id=\"ph1\">\\&lt;</ph>add&gt;<bpt id=\"p2\">**</bpt>CtlColor<ept id=\"p2\">**</ept>).","pos":[2734,2814],"source":" (For example, the **=WM_CTLCOLOR** message handler suggests \\<add>**CtlColor**)."},{"content":"Click the suggested name to accept.","pos":[2824,2859]},{"content":"The handler is added to your project.","pos":[2860,2897]},{"content":"Message handler names that you have added appear in the right column of the reflected messages window.","pos":[2908,3010]},{"content":"To edit or delete a message handler, repeat steps 4 through 7.","pos":[3019,3081]},{"content":"Click the cell containing the handler name to edit or delete and click the appropriate task.","pos":[3082,3174]},{"content":"See Also","pos":[3183,3191]},{"content":"Mapping Messages to Functions","pos":[3196,3225]},{"content":"Adding Functionality with Code Wizards","pos":[3286,3324]},{"content":"Adding a Class","pos":[3388,3402]},{"content":"Adding a Member Function","pos":[3449,3473]},{"content":"Adding a Member Variable","pos":[3530,3554]},{"content":"Overriding a Virtual Function","pos":[3611,3640]},{"content":"MFC Message Handler","pos":[3702,3721]},{"content":"Navigating the Class Structure","pos":[3782,3812]}],"content":"---\ntitle: \"Defining a Message Handler for a Reflected Message | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.codewiz.defining.msg.msghandler\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"messages, reflected\"\n  - \"message handling, reflected messages\"\nms.assetid: 5a403528-58c5-46e7-90d5-4a77f0ab9b9c\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Defining a Message Handler for a Reflected Message\nOnce you have created a new MFC control class, you can define message handlers for it. Reflected message handlers allow your control class to handle its own messages before the message is received by the parent. You can use the MFC [CWnd::SendMessage](../../mfc/reference/cwnd-class.md#cwnd__sendmessage) function to send messages from your control to a parent window.  \n  \n With this functionality you could, for example, create a list box that will redraw itself rather than relying on the parent window to do so (owner drawn). For more information on reflected messages, see [Handling Reflected Messages](../../mfc/handling-reflected-messages.md).  \n  \n To create an [ActiveX control](../../mfc/activex-controls-on-the-internet.md) with the same functionality, you must create a project for the ActiveX control.  \n  \n> [!NOTE]\n>  You cannot add a reflected message (OCM_*Message*) for an ActiveX control using the Properties window, as described below. You must add these messages manually.  \n  \n### To define a message handler for a reflected message from the Properties window  \n  \n1.  Add a control, such as a list, a rebar control, a toolbar, or a tree control, to your MFC project.  \n  \n2.  In Class View, click the name of your control class.  \n  \n3.  In the [Properties window](/visualstudio/ide/reference/properties-window), the control class name appears in the **Class Name** list.  \n  \n4.  Click the **Messages** button to display the Windows messages available to add to the control.  \n  \n5.  Scroll down the list of messages in the Properties window until you see the heading **Reflected**. Alternately, click the **Categories** button and collapse the view to see the **Reflected** heading.  \n  \n6.  Select the reflected message for which you want to define a handler. Reflected messages are marked with an equal sign (=).  \n  \n7.  Click the cell in the right column in the Properties window to display the suggested name of the handler as \\<add>*HandlerName*. (For example, the **=WM_CTLCOLOR** message handler suggests \\<add>**CtlColor**).  \n  \n8.  Click the suggested name to accept. The handler is added to your project.  \n  \n     Message handler names that you have added appear in the right column of the reflected messages window.  \n  \n9. To edit or delete a message handler, repeat steps 4 through 7. Click the cell containing the handler name to edit or delete and click the appropriate task.  \n  \n## See Also  \n [Mapping Messages to Functions](../../mfc/reference/mapping-messages-to-functions.md)   \n [Adding Functionality with Code Wizards](../../ide/adding-functionality-with-code-wizards-cpp.md)   \n [Adding a Class](../../ide/adding-a-class-visual-cpp.md)   \n [Adding a Member Function](../../ide/adding-a-member-function-visual-cpp.md)   \n [Adding a Member Variable](../../ide/adding-a-member-variable-visual-cpp.md)   \n [Overriding a Virtual Function](../../ide/overriding-a-virtual-function-visual-cpp.md)   \n [MFC Message Handler](../../mfc/reference/adding-an-mfc-message-handler.md)   \n [Navigating the Class Structure](../../ide/navigating-the-class-structure-visual-cpp.md)\n"}