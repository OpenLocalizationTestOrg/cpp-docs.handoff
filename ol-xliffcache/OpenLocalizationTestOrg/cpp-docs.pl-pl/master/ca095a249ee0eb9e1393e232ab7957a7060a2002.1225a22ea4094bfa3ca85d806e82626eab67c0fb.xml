{"nodes":[{"pos":[12,60],"content":"IVirtualProcessorRoot Structure | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IVirtualProcessorRoot Structure | Microsoft Docs","pos":[0,48]}]},{"pos":[665,696],"content":"IVirtualProcessorRoot Structure","linkify":"IVirtualProcessorRoot Structure","nodes":[{"content":"IVirtualProcessorRoot Structure","pos":[0,31]}]},{"content":"An abstraction for a hardware thread on which a thread proxy can execute.","pos":[697,770]},{"pos":[779,785],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[865,872],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[882,896],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[903,907]},{"content":"Description","pos":[908,919]},{"pos":[957,1008],"content":"<bpt id=\"p1\">[</bpt>IVirtualProcessorRoot::Activate Method<ept id=\"p1\">](#activate)</ept>","source":"[IVirtualProcessorRoot::Activate Method](#activate)"},{"pos":[1009,1142],"content":"Causes the thread proxy associated with the execution context interface <ph id=\"ph1\">`pContext`</ph> to start executing on this virtual processor root.","source":"Causes the thread proxy associated with the execution context interface `pContext` to start executing on this virtual processor root."},{"pos":[1147,1202],"content":"<bpt id=\"p1\">[</bpt>IVirtualProcessorRoot::Deactivate Method<ept id=\"p1\">](#deactivate)</ept>","source":"[IVirtualProcessorRoot::Deactivate Method](#deactivate)"},{"content":"Causes the thread proxy currently executing on this virtual processor root to stop dispatching the execution context.","pos":[1203,1320]},{"content":"The thread proxy will resume executing on a call to the <ph id=\"ph1\">`Activate`</ph> method.","pos":[1321,1395],"source":" The thread proxy will resume executing on a call to the `Activate` method."},{"pos":[1400,1477],"content":"<bpt id=\"p1\">[</bpt>IVirtualProcessorRoot::EnsureAllTasksVisible Method<ept id=\"p1\">](#ensurealltasksvisible)</ept>","source":"[IVirtualProcessorRoot::EnsureAllTasksVisible Method](#ensurealltasksvisible)"},{"content":"Causes data stored in the memory hierarchy of individual processors to become visible to all processors on the system.","pos":[1478,1596]},{"content":"It ensures that a full memory fence has been executed on all processors before the method returns.","pos":[1597,1695]},{"pos":[1700,1745],"content":"<bpt id=\"p1\">[</bpt>IVirtualProcessorRoot::GetId Method<ept id=\"p1\">](#getid)</ept>","source":"[IVirtualProcessorRoot::GetId Method](#getid)"},{"content":"Returns a unique identifier for the virtual processor root.","pos":[1746,1805]},{"pos":[1815,1822],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Every virtual processor root has an associated execution resource.","pos":[1826,1892]},{"content":"The <ph id=\"ph1\">`IVirtualProcessorRoot`</ph> interface inherits from the <bpt id=\"p1\">[</bpt>IExecutionResource<ept id=\"p1\">](iexecutionresource-structure.md)</ept> interface.","pos":[1893,2013],"source":" The `IVirtualProcessorRoot` interface inherits from the [IExecutionResource](iexecutionresource-structure.md) interface."},{"content":"Multiple virtual processor roots may correspond to the same underlying hardware thread.","pos":[2014,2101]},{"content":"The Resource Manager grants virtual processor roots to schedulers in response to requests for resources.","pos":[2108,2212]},{"content":"A scheduler can use a virtual processor root to perform work by activating it with an execution context.","pos":[2213,2317]},{"pos":[2326,2347],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2351,2404],"content":"<bpt id=\"p1\">[</bpt>IExecutionResource<ept id=\"p1\">](iexecutionresource-structure.md)</ept>","source":"[IExecutionResource](iexecutionresource-structure.md)"},{"pos":[2443,2455],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2459,2481],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> concrtrm.h","source":"**Header:** concrtrm.h"},{"pos":[2488,2514],"content":"<bpt id=\"p1\">**</bpt>Namespace:<ept id=\"p1\">**</ept> concurrency","source":"**Namespace:** concurrency"},{"pos":[2524,2587],"content":"<bpt id=\"p1\">&lt;a name=\"activate\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IVirtualProcessorRoot::Activate Method","linkify":"<a name=\"activate\"></a>  IVirtualProcessorRoot::Activate Method","source":"<a name=\"activate\"></a>  IVirtualProcessorRoot::Activate Method"},{"pos":[2591,2724],"content":"Causes the thread proxy associated with the execution context interface <ph id=\"ph1\">`pContext`</ph> to start executing on this virtual processor root.","source":"Causes the thread proxy associated with the execution context interface `pContext` to start executing on this virtual processor root."},{"pos":[2811,2821],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"An interface to the execution context that will be dispatched on this virtual processor root.","pos":[2839,2932]},{"pos":[2942,2949],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2953,3073],"content":"The Resource Manager will supply a thread proxy if one is not associated with the execution context interface <ph id=\"ph1\">`pContext`</ph>","source":"The Resource Manager will supply a thread proxy if one is not associated with the execution context interface `pContext`"},{"content":"The <ph id=\"ph1\">`Activate`</ph> method can be used to start executing work on a new virtual processor root returned by the Resource Manager, or to resume the thread proxy on a virtual processor root that has deactivated or is about to deactivate.","pos":[3080,3309],"source":"The `Activate` method can be used to start executing work on a new virtual processor root returned by the Resource Manager, or to resume the thread proxy on a virtual processor root that has deactivated or is about to deactivate."},{"content":"See <bpt id=\"p1\">[</bpt>IVirtualProcessorRoot::Deactivate<ept id=\"p1\">](#deactivate)</ept> for more information on deactivation.","pos":[3310,3400],"source":" See [IVirtualProcessorRoot::Deactivate](#deactivate) for more information on deactivation."},{"content":"When you are resuming a deactivated virtual processor root, the parameter <ph id=\"ph1\">`pContext`</ph> must be the same as the parameter used to deactivate the virtual processor root.","pos":[3401,3566],"source":" When you are resuming a deactivated virtual processor root, the parameter `pContext` must be the same as the parameter used to deactivate the virtual processor root."},{"content":"Once a virtual processor root has been activated for the first time, subsequent pairs of calls to <ph id=\"ph1\">`Deactivate`</ph> and <ph id=\"ph2\">`Activate`</ph> may race with each other.","pos":[3573,3724],"source":"Once a virtual processor root has been activated for the first time, subsequent pairs of calls to `Deactivate` and `Activate` may race with each other."},{"content":"This means it is acceptable for the Resource Manager to receive a call to <ph id=\"ph1\">`Activate`</ph> before it receives the <ph id=\"ph2\">`Deactivate`</ph> call it was meant for.","pos":[3725,3868],"source":" This means it is acceptable for the Resource Manager to receive a call to `Activate` before it receives the `Deactivate` call it was meant for."},{"content":"When you activate a virtual processor root, you signal to the Resource Manager that this virtual processor root is currently busy with work.","pos":[3875,4015]},{"content":"If your scheduler cannot find any work to execute on this root, it is expected to invoke the <ph id=\"ph1\">`Deactivate`</ph> method informing the Resource Manager that the virtual processor root is idle.","pos":[4016,4200],"source":" If your scheduler cannot find any work to execute on this root, it is expected to invoke the `Deactivate` method informing the Resource Manager that the virtual processor root is idle."},{"content":"The Resource Manager uses this data to load balance the system.","pos":[4201,4264]},{"pos":[4271,4348],"content":"<ph id=\"ph1\">`invalid_argument`</ph> is thrown if the argument <ph id=\"ph2\">`pContext`</ph> has the value <ph id=\"ph3\">`NULL`</ph>.","source":"`invalid_argument` is thrown if the argument `pContext` has the value `NULL`."},{"pos":[4355,4518],"content":"<ph id=\"ph1\">`invalid_operation`</ph> is thrown if the argument <ph id=\"ph2\">`pContext`</ph> does not represent the execution context that was most recently dispatched by this virtual processor root.","source":"`invalid_operation` is thrown if the argument `pContext` does not represent the execution context that was most recently dispatched by this virtual processor root."},{"content":"The act of activating a virtual processor root increases the subscription level of the underlying hardware thread by one.","pos":[4525,4646]},{"content":"For more information on subscription levels, see <bpt id=\"p1\">[</bpt>IExecutionResource::CurrentSubscriptionLevel<ept id=\"p1\">](iexecutionresource-structure.md#currentsubscriptionlevel)</ept>.","pos":[4647,4801],"source":" For more information on subscription levels, see [IExecutionResource::CurrentSubscriptionLevel](iexecutionresource-structure.md#currentsubscriptionlevel)."},{"pos":[4811,4878],"content":"<bpt id=\"p1\">&lt;a name=\"deactivate\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IVirtualProcessorRoot::Deactivate Method","linkify":"<a name=\"deactivate\"></a>  IVirtualProcessorRoot::Deactivate Method","source":"<a name=\"deactivate\"></a>  IVirtualProcessorRoot::Deactivate Method"},{"content":"Causes the thread proxy currently executing on this virtual processor root to stop dispatching the execution context.","pos":[4882,4999]},{"content":"The thread proxy will resume executing on a call to the <ph id=\"ph1\">`Activate`</ph> method.","pos":[5000,5074],"source":" The thread proxy will resume executing on a call to the `Activate` method."},{"pos":[5163,5173],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The context which is currently being dispatched by this root.","pos":[5191,5252]},{"pos":[5262,5274],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A boolean value.","pos":[5278,5294]},{"content":"A value of <ph id=\"ph1\">`true`</ph> indicates that the thread proxy returned from the <ph id=\"ph2\">`Deactivate`</ph> method in response to a call to the <ph id=\"ph3\">`Activate`</ph> method.","pos":[5295,5430],"source":" A value of `true` indicates that the thread proxy returned from the `Deactivate` method in response to a call to the `Activate` method."},{"content":"A value of <ph id=\"ph1\">`false`</ph> indicates that the thread proxy returned from the method in response to a notification event in the Resource Manager.","pos":[5431,5567],"source":" A value of `false` indicates that the thread proxy returned from the method in response to a notification event in the Resource Manager."},{"content":"On a user-mode schedulable (UMS) thread scheduler, this indicates that items have appeared on the scheduler's completion list, and the scheduler is required to handle them.","pos":[5568,5740]},{"pos":[5750,5757],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Use this method to temporarily stop executing a virtual processor root when you cannot find any work in your scheduler.","pos":[5761,5880]},{"content":"A call to the <ph id=\"ph1\">`Deactivate`</ph> method must originate from within the <ph id=\"ph2\">`Dispatch`</ph> method of the execution context that the virtual processor root was last activated with.","pos":[5881,6045],"source":" A call to the `Deactivate` method must originate from within the `Dispatch` method of the execution context that the virtual processor root was last activated with."},{"content":"In other words, the thread proxy invoking the <ph id=\"ph1\">`Deactivate`</ph> method must be the one that is currently executing on the virtual processor root.","pos":[6046,6186],"source":" In other words, the thread proxy invoking the `Deactivate` method must be the one that is currently executing on the virtual processor root."},{"content":"Calling the method on a virtual processor root you are not executing on could result in undefined behavior.","pos":[6187,6294]},{"content":"A deactivated virtual processor root may be woken up with a call to the <ph id=\"ph1\">`Activate`</ph> method, with the same argument that was passed in to the <ph id=\"ph2\">`Deactivate`</ph> method.","pos":[6301,6461],"source":"A deactivated virtual processor root may be woken up with a call to the `Activate` method, with the same argument that was passed in to the `Deactivate` method."},{"content":"The scheduler is responsible for ensuring that calls to the <ph id=\"ph1\">`Activate`</ph> and <ph id=\"ph2\">`Deactivate`</ph> methods are paired, but they are not required to be received in a specific order.","pos":[6462,6631],"source":" The scheduler is responsible for ensuring that calls to the `Activate` and `Deactivate` methods are paired, but they are not required to be received in a specific order."},{"content":"The Resource Manager can handle receiving a call to the <ph id=\"ph1\">`Activate`</ph> method before it receives a call to the <ph id=\"ph2\">`Deactivate`</ph> method it was meant for.","pos":[6632,6776],"source":" The Resource Manager can handle receiving a call to the `Activate` method before it receives a call to the `Deactivate` method it was meant for."},{"content":"If a virtual processor root awakens and the return value from the <ph id=\"ph1\">`Deactivate`</ph> method is the value <ph id=\"ph2\">`false`</ph>, the scheduler should query the UMS completion list via the <ph id=\"ph3\">`IUMSCompletionList::GetUnblockNotifications`</ph> method, act on that information, and then subsequently call the <ph id=\"ph4\">`Deactivate`</ph> method again.","pos":[6783,7086],"source":"If a virtual processor root awakens and the return value from the `Deactivate` method is the value `false`, the scheduler should query the UMS completion list via the `IUMSCompletionList::GetUnblockNotifications` method, act on that information, and then subsequently call the `Deactivate` method again."},{"content":"This should be repeated until such time as the <ph id=\"ph1\">`Deactivate`</ph> method returns the value <ph id=\"ph2\">`true`</ph>.","pos":[7087,7179],"source":" This should be repeated until such time as the `Deactivate` method returns the value `true`."},{"pos":[7186,7263],"content":"<ph id=\"ph1\">`invalid_argument`</ph> is thrown if the argument <ph id=\"ph2\">`pContext`</ph> has the value <ph id=\"ph3\">`NULL`</ph>.","source":"`invalid_argument` is thrown if the argument `pContext` has the value `NULL`."},{"pos":[7270,7489],"content":"<ph id=\"ph1\">`invalid_operation`</ph> is thrown if the virtual processor root has never been activated, or the argument <ph id=\"ph2\">`pContext`</ph> does not represent the execution context that was most recently dispatched by this virtual processor root.","source":"`invalid_operation` is thrown if the virtual processor root has never been activated, or the argument `pContext` does not represent the execution context that was most recently dispatched by this virtual processor root."},{"content":"The act of deactivating a virtual processor root decreases the subscription level of the underlying hardware thread by one.","pos":[7496,7619]},{"content":"For more information on subscription levels, see <bpt id=\"p1\">[</bpt>IExecutionResource::CurrentSubscriptionLevel<ept id=\"p1\">](iexecutionresource-structure.md#currentsubscriptionlevel)</ept>.","pos":[7620,7774],"source":" For more information on subscription levels, see [IExecutionResource::CurrentSubscriptionLevel](iexecutionresource-structure.md#currentsubscriptionlevel)."},{"pos":[7784,7873],"content":"<bpt id=\"p1\">&lt;a name=\"ensurealltasksvisible\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IVirtualProcessorRoot::EnsureAllTasksVisible Method","linkify":"<a name=\"ensurealltasksvisible\"></a>  IVirtualProcessorRoot::EnsureAllTasksVisible Method","source":"<a name=\"ensurealltasksvisible\"></a>  IVirtualProcessorRoot::EnsureAllTasksVisible Method"},{"content":"Causes data stored in the memory hierarchy of individual processors to become visible to all processors on the system.","pos":[7877,7995]},{"content":"It ensures that a full memory fence has been executed on all processors before the method returns.","pos":[7996,8094]},{"pos":[8194,8204],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The context which is currently being dispatched by this virtual processor root.","pos":[8222,8301]},{"pos":[8311,8318],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You may find this method useful when you want to synchronize deactivation of a virtual processor root with the addition of new work into the scheduler.","pos":[8322,8473]},{"content":"For performance reasons, you may decide to add work items to your scheduler without executing a memory barrier, which means work items added by a thread executing on one processor are not immediately visible to all other processors.","pos":[8474,8706]},{"content":"By using this method in conjunction with the <ph id=\"ph1\">`Deactivate`</ph> method you can ensure that your scheduler does not deactivate all its virtual processor roots while work items exist in your scheduler's collections.","pos":[8707,8914],"source":" By using this method in conjunction with the `Deactivate` method you can ensure that your scheduler does not deactivate all its virtual processor roots while work items exist in your scheduler's collections."},{"content":"A call to the <ph id=\"ph1\">`EnsureAllTasksVisibleThe`</ph> method must originate from within the <ph id=\"ph2\">`Dispatch`</ph> method of the execution context that the virtual processor root was last activated with.","pos":[8921,9099],"source":"A call to the `EnsureAllTasksVisibleThe` method must originate from within the `Dispatch` method of the execution context that the virtual processor root was last activated with."},{"content":"In other words, the thread proxy invoking the <ph id=\"ph1\">`EnsureAllTasksVisible`</ph> method must be the one that is currently executing on the virtual processor root.","pos":[9100,9251],"source":" In other words, the thread proxy invoking the `EnsureAllTasksVisible` method must be the one that is currently executing on the virtual processor root."},{"content":"Calling the method on a virtual processor root you are not executing on could result in undefined behavior.","pos":[9252,9359]},{"pos":[9366,9443],"content":"<ph id=\"ph1\">`invalid_argument`</ph> is thrown if the argument <ph id=\"ph2\">`pContext`</ph> has the value <ph id=\"ph3\">`NULL`</ph>.","source":"`invalid_argument` is thrown if the argument `pContext` has the value `NULL`."},{"pos":[9450,9669],"content":"<ph id=\"ph1\">`invalid_operation`</ph> is thrown if the virtual processor root has never been activated, or the argument <ph id=\"ph2\">`pContext`</ph> does not represent the execution context that was most recently dispatched by this virtual processor root.","source":"`invalid_operation` is thrown if the virtual processor root has never been activated, or the argument `pContext` does not represent the execution context that was most recently dispatched by this virtual processor root."},{"pos":[9679,9736],"content":"<bpt id=\"p1\">&lt;a name=\"getid\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IVirtualProcessorRoot::GetId Method","linkify":"<a name=\"getid\"></a>  IVirtualProcessorRoot::GetId Method","source":"<a name=\"getid\"></a>  IVirtualProcessorRoot::GetId Method"},{"content":"Returns a unique identifier for the virtual processor root.","pos":[9740,9799]},{"pos":[9862,9874],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"An integer identifier.","pos":[9878,9900]},{"pos":[9909,9917],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[9921,9970],"content":"<bpt id=\"p1\">[</bpt>concurrency Namespace<ept id=\"p1\">](concurrency-namespace.md)</ept>","source":"[concurrency Namespace](concurrency-namespace.md)"}],"content":"---\ntitle: \"IVirtualProcessorRoot Structure | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"concrtrm/concurrency::IVirtualProcessorRoot\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IVirtualProcessorRoot structure\"\nms.assetid: 5ef371b8-9e4f-4fef-bb0d-49099693dd2b\ncaps.latest.revision: 18\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IVirtualProcessorRoot Structure\nAn abstraction for a hardware thread on which a thread proxy can execute.  \n  \n## Syntax  \n  \n```\nstruct IVirtualProcessorRoot : public IExecutionResource;\n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IVirtualProcessorRoot::Activate Method](#activate)|Causes the thread proxy associated with the execution context interface `pContext` to start executing on this virtual processor root.|  \n|[IVirtualProcessorRoot::Deactivate Method](#deactivate)|Causes the thread proxy currently executing on this virtual processor root to stop dispatching the execution context. The thread proxy will resume executing on a call to the `Activate` method.|  \n|[IVirtualProcessorRoot::EnsureAllTasksVisible Method](#ensurealltasksvisible)|Causes data stored in the memory hierarchy of individual processors to become visible to all processors on the system. It ensures that a full memory fence has been executed on all processors before the method returns.|  \n|[IVirtualProcessorRoot::GetId Method](#getid)|Returns a unique identifier for the virtual processor root.|  \n  \n## Remarks  \n Every virtual processor root has an associated execution resource. The `IVirtualProcessorRoot` interface inherits from the [IExecutionResource](iexecutionresource-structure.md) interface. Multiple virtual processor roots may correspond to the same underlying hardware thread.  \n  \n The Resource Manager grants virtual processor roots to schedulers in response to requests for resources. A scheduler can use a virtual processor root to perform work by activating it with an execution context.  \n  \n## Inheritance Hierarchy  \n [IExecutionResource](iexecutionresource-structure.md)  \n  \n `IVirtualProcessorRoot`  \n  \n## Requirements  \n **Header:** concrtrm.h  \n  \n **Namespace:** concurrency  \n  \n##  <a name=\"activate\"></a>  IVirtualProcessorRoot::Activate Method  \n Causes the thread proxy associated with the execution context interface `pContext` to start executing on this virtual processor root.  \n  \n```\nvirtual void Activate(_Inout_ IExecutionContext* pContext) = 0;\n```  \n  \n### Parameters  \n `pContext`  \n An interface to the execution context that will be dispatched on this virtual processor root.  \n  \n### Remarks  \n The Resource Manager will supply a thread proxy if one is not associated with the execution context interface `pContext`  \n  \n The `Activate` method can be used to start executing work on a new virtual processor root returned by the Resource Manager, or to resume the thread proxy on a virtual processor root that has deactivated or is about to deactivate. See [IVirtualProcessorRoot::Deactivate](#deactivate) for more information on deactivation. When you are resuming a deactivated virtual processor root, the parameter `pContext` must be the same as the parameter used to deactivate the virtual processor root.  \n  \n Once a virtual processor root has been activated for the first time, subsequent pairs of calls to `Deactivate` and `Activate` may race with each other. This means it is acceptable for the Resource Manager to receive a call to `Activate` before it receives the `Deactivate` call it was meant for.  \n  \n When you activate a virtual processor root, you signal to the Resource Manager that this virtual processor root is currently busy with work. If your scheduler cannot find any work to execute on this root, it is expected to invoke the `Deactivate` method informing the Resource Manager that the virtual processor root is idle. The Resource Manager uses this data to load balance the system.  \n  \n `invalid_argument` is thrown if the argument `pContext` has the value `NULL`.  \n  \n `invalid_operation` is thrown if the argument `pContext` does not represent the execution context that was most recently dispatched by this virtual processor root.  \n  \n The act of activating a virtual processor root increases the subscription level of the underlying hardware thread by one. For more information on subscription levels, see [IExecutionResource::CurrentSubscriptionLevel](iexecutionresource-structure.md#currentsubscriptionlevel).  \n  \n##  <a name=\"deactivate\"></a>  IVirtualProcessorRoot::Deactivate Method  \n Causes the thread proxy currently executing on this virtual processor root to stop dispatching the execution context. The thread proxy will resume executing on a call to the `Activate` method.  \n  \n```\nvirtual bool Deactivate(_Inout_ IExecutionContext* pContext) = 0;\n```  \n  \n### Parameters  \n `pContext`  \n The context which is currently being dispatched by this root.  \n  \n### Return Value  \n A boolean value. A value of `true` indicates that the thread proxy returned from the `Deactivate` method in response to a call to the `Activate` method. A value of `false` indicates that the thread proxy returned from the method in response to a notification event in the Resource Manager. On a user-mode schedulable (UMS) thread scheduler, this indicates that items have appeared on the scheduler's completion list, and the scheduler is required to handle them.  \n  \n### Remarks  \n Use this method to temporarily stop executing a virtual processor root when you cannot find any work in your scheduler. A call to the `Deactivate` method must originate from within the `Dispatch` method of the execution context that the virtual processor root was last activated with. In other words, the thread proxy invoking the `Deactivate` method must be the one that is currently executing on the virtual processor root. Calling the method on a virtual processor root you are not executing on could result in undefined behavior.  \n  \n A deactivated virtual processor root may be woken up with a call to the `Activate` method, with the same argument that was passed in to the `Deactivate` method. The scheduler is responsible for ensuring that calls to the `Activate` and `Deactivate` methods are paired, but they are not required to be received in a specific order. The Resource Manager can handle receiving a call to the `Activate` method before it receives a call to the `Deactivate` method it was meant for.  \n  \n If a virtual processor root awakens and the return value from the `Deactivate` method is the value `false`, the scheduler should query the UMS completion list via the `IUMSCompletionList::GetUnblockNotifications` method, act on that information, and then subsequently call the `Deactivate` method again. This should be repeated until such time as the `Deactivate` method returns the value `true`.  \n  \n `invalid_argument` is thrown if the argument `pContext` has the value `NULL`.  \n  \n `invalid_operation` is thrown if the virtual processor root has never been activated, or the argument `pContext` does not represent the execution context that was most recently dispatched by this virtual processor root.  \n  \n The act of deactivating a virtual processor root decreases the subscription level of the underlying hardware thread by one. For more information on subscription levels, see [IExecutionResource::CurrentSubscriptionLevel](iexecutionresource-structure.md#currentsubscriptionlevel).  \n  \n##  <a name=\"ensurealltasksvisible\"></a>  IVirtualProcessorRoot::EnsureAllTasksVisible Method  \n Causes data stored in the memory hierarchy of individual processors to become visible to all processors on the system. It ensures that a full memory fence has been executed on all processors before the method returns.  \n  \n```\nvirtual void EnsureAllTasksVisible(_Inout_ IExecutionContext* pContext) = 0;\n```  \n  \n### Parameters  \n `pContext`  \n The context which is currently being dispatched by this virtual processor root.  \n  \n### Remarks  \n You may find this method useful when you want to synchronize deactivation of a virtual processor root with the addition of new work into the scheduler. For performance reasons, you may decide to add work items to your scheduler without executing a memory barrier, which means work items added by a thread executing on one processor are not immediately visible to all other processors. By using this method in conjunction with the `Deactivate` method you can ensure that your scheduler does not deactivate all its virtual processor roots while work items exist in your scheduler's collections.  \n  \n A call to the `EnsureAllTasksVisibleThe` method must originate from within the `Dispatch` method of the execution context that the virtual processor root was last activated with. In other words, the thread proxy invoking the `EnsureAllTasksVisible` method must be the one that is currently executing on the virtual processor root. Calling the method on a virtual processor root you are not executing on could result in undefined behavior.  \n  \n `invalid_argument` is thrown if the argument `pContext` has the value `NULL`.  \n  \n `invalid_operation` is thrown if the virtual processor root has never been activated, or the argument `pContext` does not represent the execution context that was most recently dispatched by this virtual processor root.  \n  \n##  <a name=\"getid\"></a>  IVirtualProcessorRoot::GetId Method  \n Returns a unique identifier for the virtual processor root.  \n  \n```\nvirtual unsigned int GetId() const = 0;\n```  \n  \n### Return Value  \n An integer identifier.  \n  \n## See Also  \n [concurrency Namespace](concurrency-namespace.md)\n"}