{"nodes":[{"pos":[12,48],"content":"Application Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Application Control | Microsoft Docs","pos":[0,36]}]},{"content":"Application Control","pos":[611,630]},{"content":"OLE requires substantial control over applications and their objects.","pos":[631,700]},{"content":"The OLE system DLLs must be able to launch and release applications automatically, coordinate their production and modification of objects, and so on.","pos":[701,851]},{"content":"The functions in this topic meet those requirements.","pos":[852,904]},{"content":"In addition to being called by the OLE system DLLs, these functions must sometimes be called by applications as well.","pos":[905,1022]},{"content":"Application Control","pos":[1032,1051]},{"content":"AfxOleCanExitApp","pos":[1073,1089]},{"content":"Indicates whether the application can terminate.","pos":[1110,1158]},{"content":"AfxOleGetMessageFilter","pos":[1164,1186]},{"content":"Retrieves the application's current message filter.","pos":[1213,1264]},{"content":"AfxOleGetUserCtrl","pos":[1270,1287]},{"content":"Retrieves the current user-control flag.","pos":[1309,1349]},{"content":"AfxOleSetUserCtrl","pos":[1355,1372]},{"content":"Sets or clears the user-control flag.","pos":[1394,1431]},{"content":"AfxOleLockApp","pos":[1437,1450]},{"content":"Increments the framework's global count of the number of active objects in an application.","pos":[1468,1558]},{"content":"AfxOleUnlockApp","pos":[1564,1579]},{"content":"Decrements the framework's count of the number of active objects in an application.","pos":[1599,1682]},{"content":"AfxOleRegisterServerClass","pos":[1688,1713]},{"content":"Registers a server in the OLE system registry.","pos":[1743,1789]},{"content":"AfxOleSetEditMenu","pos":[1795,1812]},{"pos":[1834,1898],"content":"Implements the user interface for the <bpt id=\"p1\">*</bpt>typename<ept id=\"p1\">*</ept> Object command.","source":"Implements the user interface for the *typename* Object command."},{"pos":[1942,1958],"content":"AfxOleCanExitApp"},{"content":"Indicates whether the application can terminate.","pos":[1962,2010]},{"content":"Return Value","pos":[2069,2081]},{"content":"Nonzero if the application can exit; otherwise 0.","pos":[2085,2134]},{"content":"Remarks","pos":[2144,2151]},{"content":"An application should not terminate if there are outstanding references to its objects.","pos":[2155,2242]},{"content":"The global functions <ph id=\"ph1\">`AfxOleLockApp`</ph> and <ph id=\"ph2\">`AfxOleUnlockApp`</ph> increment and decrement, respectively, a counter of references to the application's objects.","pos":[2243,2394],"source":" The global functions `AfxOleLockApp` and `AfxOleUnlockApp` increment and decrement, respectively, a counter of references to the application's objects."},{"content":"The application should not terminate when this counter is nonzero.","pos":[2395,2461]},{"content":"If the counter is nonzero, the application's main window is hidden (not destroyed) when the user chooses Close from the system menu or Exit from the File menu.","pos":[2462,2621]},{"content":"The framework calls this function in <bpt id=\"p1\">**</bpt>CFrameWnd::OnClose<ept id=\"p1\">**</ept>.","pos":[2622,2682],"source":" The framework calls this function in **CFrameWnd::OnClose**."},{"content":"Example","pos":[2692,2699]},{"pos":[2714,2733],"content":"NVC_MFCAutomation#2"},{"pos":[2837,2859],"content":"AfxOleGetMessageFilter"},{"content":"Retrieves the application's current message filter.","pos":[2863,2914]},{"content":"Return Value","pos":[2994,3006]},{"content":"A pointer to the current message filter.","pos":[3010,3050]},{"content":"Remarks","pos":[3060,3067]},{"pos":[3071,3224],"content":"Call this function to access the current <ph id=\"ph1\">`COleMessageFilter`</ph>-derived object, just as you would call <ph id=\"ph2\">`AfxGetApp`</ph> to access the current application object.","source":"Call this function to access the current `COleMessageFilter`-derived object, just as you would call `AfxGetApp` to access the current application object."},{"content":"Example","pos":[3234,3241]},{"pos":[3256,3275],"content":"NVC_MFCAutomation#3"},{"pos":[3348,3367],"content":"NVC_MFCAutomation#4"},{"pos":[3466,3483],"content":"AfxOleGetUserCtrl"},{"content":"Retrieves the current user-control flag.","pos":[3487,3527]},{"content":"Return Value","pos":[3588,3600]},{"content":"Nonzero if the user is in control of the application; otherwise 0.","pos":[3604,3670]},{"content":"Remarks","pos":[3680,3687]},{"content":"The user is in control of the application when the user has explicitly opened or created a new document.","pos":[3691,3795]},{"content":"The user is also in control if the application was not launched by the OLE system DLLs — in other words, if the user launched the application with the system shell.","pos":[3796,3960]},{"pos":[4004,4021],"content":"AfxOleSetUserCtrl"},{"pos":[4025,4123],"content":"Sets or clears the user-control flag, which is explained in the reference for <ph id=\"ph1\">`AfxOleGetUserCtrl`</ph>.","source":"Sets or clears the user-control flag, which is explained in the reference for `AfxOleGetUserCtrl`."},{"content":"Parameters","pos":[4197,4207]},{"content":"bUserCtrl","pos":[4212,4221]},{"content":"Specifies whether the user-control flag is to be set or cleared.","pos":[4226,4290]},{"content":"Remarks","pos":[4300,4307]},{"content":"The framework calls this function when the user creates or loads a document, but not when a document is loaded or created through an indirect action such as loading an embedded object from a container application.","pos":[4311,4524]},{"content":"Call this function if other actions in your application should put the user in control of the application.","pos":[4531,4637]},{"pos":[4677,4690],"content":"AfxOleLockApp"},{"content":"Increments the framework's global count of the number of active objects in the application.","pos":[4694,4785]},{"content":"Remarks","pos":[4843,4850]},{"content":"The framework keeps a count of the number of objects active in an application.","pos":[4854,4932]},{"content":"The <ph id=\"ph1\">`AfxOleLockApp`</ph> and <ph id=\"ph2\">`AfxOleUnlockApp`</ph> functions, respectively, increment and decrement this count.","pos":[4933,5035],"source":" The `AfxOleLockApp` and `AfxOleUnlockApp` functions, respectively, increment and decrement this count."},{"content":"When the user attempts to close an application that has active objects — an application for which the count of active objects is nonzero — the framework hides the application from the user's view instead of completely shutting it down.","pos":[5042,5277]},{"content":"The <ph id=\"ph1\">`AfxOleCanExitApp`</ph> function indicates whether the application can terminate.","pos":[5278,5358],"source":" The `AfxOleCanExitApp` function indicates whether the application can terminate."},{"content":"Call <ph id=\"ph1\">`AfxOleLockApp`</ph> from any object that exposes OLE interfaces, if it would be undesirable for that object to be destroyed while still being used by a client application.","pos":[5365,5537],"source":"Call `AfxOleLockApp` from any object that exposes OLE interfaces, if it would be undesirable for that object to be destroyed while still being used by a client application."},{"content":"Also call <ph id=\"ph1\">`AfxOleUnlockApp`</ph> in the destructor of any object that calls <ph id=\"ph2\">`AfxOleLockApp`</ph> in the constructor.","pos":[5538,5644],"source":" Also call `AfxOleUnlockApp` in the destructor of any object that calls `AfxOleLockApp` in the constructor."},{"content":"By default, <ph id=\"ph1\">`COleDocument`</ph> (and derived classes) automatically lock and unlock the application.","pos":[5645,5740],"source":" By default, `COleDocument` (and derived classes) automatically lock and unlock the application."},{"content":"Example","pos":[5750,5757]},{"pos":[5772,5791],"content":"NVC_MFCAutomation#5"},{"pos":[5888,5903],"content":"AfxOleUnlockApp"},{"content":"Decrements the framework's count of active objects in the application.","pos":[5907,5977]},{"content":"Remarks","pos":[6035,6042]},{"pos":[6046,6090],"content":"See <ph id=\"ph1\">`AfxOleLockApp`</ph> for further information.","source":"See `AfxOleLockApp` for further information."},{"pos":[6097,6185],"content":"When the number of active objects reaches zero, <bpt id=\"p1\">**</bpt>AfxOleOnReleaseAllObjects<ept id=\"p1\">**</ept> is called.","source":"When the number of active objects reaches zero, **AfxOleOnReleaseAllObjects** is called."},{"content":"Example","pos":[6195,6202]},{"pos":[6206,6258],"content":"See the example for <bpt id=\"p1\">[</bpt>AfxOleLockApp<ept id=\"p1\">](#afxolelockapp)</ept>.","source":"See the example for [AfxOleLockApp](#afxolelockapp)."},{"pos":[6310,6335],"content":"AfxOleRegisterServerClass"},{"content":"This function allows you to register your server in the OLE system registry.","pos":[6339,6415]},{"content":"Parameters","pos":[6714,6724]},{"content":"Reference to the server's OLE class ID.","pos":[6739,6778]},{"content":"Pointer to a string containing the class name of the server's objects.","pos":[6804,6874]},{"content":"lpszShortTypeName","pos":[6882,6899]},{"content":"Pointer to a string containing the short name of the server's object type, such as \"Chart.\"","pos":[6904,6995]},{"content":"lpszLongTypeName","pos":[7003,7019]},{"content":"Pointer to a string containing the long name of the server's object type, such as \"Microsoft Excel 5.0 Chart.\"","pos":[7024,7134]},{"content":"A value, taken from the <bpt id=\"p1\">**</bpt>OLE_APPTYPE<ept id=\"p1\">**</ept> enumeration, specifying the type of OLE application.","pos":[7155,7247],"source":" A value, taken from the **OLE_APPTYPE** enumeration, specifying the type of OLE application."},{"content":"Possible values are the following:","pos":[7248,7282]},{"pos":[7311,7349],"content":"Server has full server user-interface."},{"pos":[7370,7401],"content":"Server supports only embedding."},{"pos":[7425,7464],"content":"Container supports links to embeddings."},{"pos":[7505,7521],"content":"-capable object."},{"pos":[7528,7694],"content":"`rglpszRegister`  \nArray of pointers to strings representing the keys and values to be added to the OLE system registry if no existing values for the keys are found.","leadings":[""," "],"nodes":[{"content":"Array of pointers to strings representing the keys and values to be added to the OLE system registry if no existing values for the keys are found.","pos":[19,165]}]},{"pos":[7701,7883],"content":"`rglpszOverwrite`  \nArray of pointers to strings representing the keys and values to be added to the OLE system registry if the registry contains existing values for the given keys.","leadings":[""," "],"nodes":[{"content":"Array of pointers to strings representing the keys and values to be added to the OLE system registry if the registry contains existing values for the given keys.","pos":[20,181]}]},{"content":"Return Value","pos":[7893,7905]},{"content":"Nonzero if the server class is successfully registered; otherwise 0.","pos":[7909,7977]},{"content":"Remarks","pos":[7987,7994]},{"content":"Most applications can use <bpt id=\"p1\">**</bpt>COleTemplateServer::Register<ept id=\"p1\">**</ept> to register the application's document types.","pos":[7998,8102],"source":"Most applications can use **COleTemplateServer::Register** to register the application's document types."},{"content":"If your application's system-registry format does not fit the typical pattern, you can use <ph id=\"ph1\">`AfxOleRegisterServerClass`</ph> for more control.","pos":[8103,8239],"source":" If your application's system-registry format does not fit the typical pattern, you can use `AfxOleRegisterServerClass` for more control."},{"content":"The registry consists of a set of keys and values.","pos":[8246,8296]},{"content":"The <ph id=\"ph1\">`rglpszRegister`</ph> and <ph id=\"ph2\">`rglpszOverwrite`</ph> arguments are arrays of pointers to strings, each consisting of a key and a value separated by a <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> character ( <ph id=\"ph3\">`'\\0'`</ph>).","pos":[8297,8466],"source":" The `rglpszRegister` and `rglpszOverwrite` arguments are arrays of pointers to strings, each consisting of a key and a value separated by a **NULL** character ( `'\\0'`)."},{"content":"Each of these strings can have replaceable parameters whose places are marked by the character sequences <ph id=\"ph1\">`%1`</ph> through <ph id=\"ph2\">`%5`</ph>.","pos":[8467,8590],"source":" Each of these strings can have replaceable parameters whose places are marked by the character sequences `%1` through `%5`."},{"content":"The symbols are filled in as follows:","pos":[8597,8634]},{"content":"Symbol","pos":[8641,8647]},{"content":"Value","pos":[8648,8653]},{"content":"%1","pos":[8687,8689]},{"content":"Class ID, formatted as a string","pos":[8690,8721]},{"content":"%2","pos":[8726,8728]},{"content":"Class name","pos":[8729,8739]},{"content":"%3","pos":[8744,8746]},{"content":"Path to executable file","pos":[8747,8770]},{"content":"%4","pos":[8775,8777]},{"content":"Short type name","pos":[8778,8793]},{"content":"%5","pos":[8798,8800]},{"content":"Long type name","pos":[8801,8815]},{"pos":[8860,8877],"content":"AfxOleSetEditMenu"},{"pos":[8881,8945],"content":"Implements the user interface for the <bpt id=\"p1\">*</bpt>typename<ept id=\"p1\">*</ept> Object command.","source":"Implements the user interface for the *typename* Object command."},{"content":"Parameters","pos":[9154,9164]},{"content":"A pointer to the client OLE item.","pos":[9181,9214]},{"content":"A pointer to the menu object to be updated.","pos":[9232,9275]},{"content":"iMenuItem","pos":[9283,9292]},{"content":"The index of the menu item to be updated.","pos":[9297,9338]},{"content":"The command ID that corresponds to the primary verb.","pos":[9361,9413]},{"content":"nIDVerbMax","pos":[9421,9431]},{"content":"The command ID that corresponds to the last verb.","pos":[9436,9485]},{"content":"nIDConvert","pos":[9493,9503]},{"content":"ID for the Convert menu item.","pos":[9508,9537]},{"content":"Remarks","pos":[9547,9554]},{"content":"If the server recognizes only a primary verb, the menu item becomes \"verb <bpt id=\"p1\">*</bpt>typename<ept id=\"p1\">*</ept> Object\" and the <ph id=\"ph1\">`nIDVerbMin`</ph> command is sent when the user chooses the command.","pos":[9558,9722],"source":"If the server recognizes only a primary verb, the menu item becomes \"verb *typename* Object\" and the `nIDVerbMin` command is sent when the user chooses the command."},{"content":"If the server recognizes several verbs, then the menu item becomes \" <bpt id=\"p1\">*</bpt>typename<ept id=\"p1\">*</ept> Object\" and a submenu listing all the verbs appears when the user chooses the command.","pos":[9723,9889],"source":" If the server recognizes several verbs, then the menu item becomes \" *typename* Object\" and a submenu listing all the verbs appears when the user chooses the command."},{"content":"When the user chooses a verb from the submenu, <ph id=\"ph1\">`nIDVerbMin`</ph> is sent if the first verb is chosen, <ph id=\"ph2\">`nIDVerbMin`</ph> + 1 is sent if the second verb is chosen, and so forth.","pos":[9890,10055],"source":" When the user chooses a verb from the submenu, `nIDVerbMin` is sent if the first verb is chosen, `nIDVerbMin` + 1 is sent if the second verb is chosen, and so forth."},{"content":"The default <ph id=\"ph1\">`COleDocument`</ph> implementation automatically handles this feature.","pos":[10056,10133],"source":" The default `COleDocument` implementation automatically handles this feature."},{"content":"You must have the following statement in your client's application resource script (.RC) file:","pos":[10140,10234]},{"content":"include <ph id=\"ph1\">\\&lt;</ph>afxolecl.rc&gt;","pos":[10244,10266],"source":"#include \\<afxolecl.rc>"},{"content":"See Also","pos":[10277,10285]},{"content":"Macros and Globals","pos":[10290,10308]}],"content":"---\ntitle: \"Application Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.mfc.macros\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"application control\"\nms.assetid: c1f69f15-e0fe-4515-9f36-d63d31869deb\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Application Control\nOLE requires substantial control over applications and their objects. The OLE system DLLs must be able to launch and release applications automatically, coordinate their production and modification of objects, and so on. The functions in this topic meet those requirements. In addition to being called by the OLE system DLLs, these functions must sometimes be called by applications as well.  \n  \n### Application Control  \n  \n|||  \n|-|-|  \n|[AfxOleCanExitApp](#afxolecanexitapp)|Indicates whether the application can terminate.|  \n|[AfxOleGetMessageFilter](#afxolegetmessagefilter)|Retrieves the application's current message filter.|  \n|[AfxOleGetUserCtrl](#afxolegetuserctrl)|Retrieves the current user-control flag.|  \n|[AfxOleSetUserCtrl](#afxolesetuserctrl)|Sets or clears the user-control flag.|  \n|[AfxOleLockApp](#afxolelockapp)|Increments the framework's global count of the number of active objects in an application.|  \n|[AfxOleUnlockApp](#afxoleunlockapp)|Decrements the framework's count of the number of active objects in an application.|  \n|[AfxOleRegisterServerClass](#afxoleregisterserverclass)|Registers a server in the OLE system registry.|  \n|[AfxOleSetEditMenu](#afxoleseteditmenu)|Implements the user interface for the *typename* Object command.|  \n  \n##  <a name=\"afxolecanexitapp\"></a>  AfxOleCanExitApp  \n Indicates whether the application can terminate.  \n  \n```   \nBOOL AFXAPI AfxOleCanExitApp(); \n```  \n  \n### Return Value  \n Nonzero if the application can exit; otherwise 0.  \n  \n### Remarks  \n An application should not terminate if there are outstanding references to its objects. The global functions `AfxOleLockApp` and `AfxOleUnlockApp` increment and decrement, respectively, a counter of references to the application's objects. The application should not terminate when this counter is nonzero. If the counter is nonzero, the application's main window is hidden (not destroyed) when the user chooses Close from the system menu or Exit from the File menu. The framework calls this function in **CFrameWnd::OnClose**.  \n  \n### Example  \n [!code-cpp[NVC_MFCAutomation#2](../../mfc/codesnippet/cpp/application-control_1.cpp)]  \n  \n##  <a name=\"afxolegetmessagefilter\"></a>  AfxOleGetMessageFilter  \n Retrieves the application's current message filter.  \n  \n```   \nCOleMessageFilter* AFXAPI  AfxOleGetMessageFilter(); \n```  \n  \n### Return Value  \n A pointer to the current message filter.  \n  \n### Remarks  \n Call this function to access the current `COleMessageFilter`-derived object, just as you would call `AfxGetApp` to access the current application object.  \n  \n### Example  \n [!code-cpp[NVC_MFCAutomation#3](../../mfc/codesnippet/cpp/application-control_2.cpp)]  \n  \n [!code-cpp[NVC_MFCAutomation#4](../../mfc/codesnippet/cpp/application-control_3.cpp)]  \n  \n##  <a name=\"afxolegetuserctrl\"></a>  AfxOleGetUserCtrl  \n Retrieves the current user-control flag.  \n  \n```   \nBOOL  AFXAPI AfxOleGetUserCtrl(); \n```  \n  \n### Return Value  \n Nonzero if the user is in control of the application; otherwise 0.  \n  \n### Remarks  \n The user is in control of the application when the user has explicitly opened or created a new document. The user is also in control if the application was not launched by the OLE system DLLs — in other words, if the user launched the application with the system shell.  \n  \n##  <a name=\"afxolesetuserctrl\"></a>  AfxOleSetUserCtrl  \n Sets or clears the user-control flag, which is explained in the reference for `AfxOleGetUserCtrl`.  \n  \n```  \nvoid  AFXAPI AfxOleSetUserCtrl(BOOL bUserCtrl); \n```  \n  \n### Parameters  \n *bUserCtrl*  \n Specifies whether the user-control flag is to be set or cleared.  \n  \n### Remarks  \n The framework calls this function when the user creates or loads a document, but not when a document is loaded or created through an indirect action such as loading an embedded object from a container application.  \n  \n Call this function if other actions in your application should put the user in control of the application.  \n  \n##  <a name=\"afxolelockapp\"></a>  AfxOleLockApp  \n Increments the framework's global count of the number of active objects in the application.  \n  \n```   \nvoid  AFXAPI  AfxOleLockApp(); \n```  \n  \n### Remarks  \n The framework keeps a count of the number of objects active in an application. The `AfxOleLockApp` and `AfxOleUnlockApp` functions, respectively, increment and decrement this count.  \n  \n When the user attempts to close an application that has active objects — an application for which the count of active objects is nonzero — the framework hides the application from the user's view instead of completely shutting it down. The `AfxOleCanExitApp` function indicates whether the application can terminate.  \n  \n Call `AfxOleLockApp` from any object that exposes OLE interfaces, if it would be undesirable for that object to be destroyed while still being used by a client application. Also call `AfxOleUnlockApp` in the destructor of any object that calls `AfxOleLockApp` in the constructor. By default, `COleDocument` (and derived classes) automatically lock and unlock the application.  \n  \n### Example  \n [!code-cpp[NVC_MFCAutomation#5](../../mfc/codesnippet/cpp/application-control_4.cpp)]  \n  \n##  <a name=\"afxoleunlockapp\"></a>  AfxOleUnlockApp  \n Decrements the framework's count of active objects in the application.  \n  \n```   \nvoid AFXAPI AfxOleUnlockApp(); \n```  \n  \n### Remarks  \n See `AfxOleLockApp` for further information.  \n  \n When the number of active objects reaches zero, **AfxOleOnReleaseAllObjects** is called.  \n  \n### Example  \n See the example for [AfxOleLockApp](#afxolelockapp).  \n  \n##  <a name=\"afxoleregisterserverclass\"></a>  AfxOleRegisterServerClass  \n This function allows you to register your server in the OLE system registry.  \n  \n```   \nBOOL AFXAPI AfxOleRegisterServerClass(\n    REFCLSID clsid,  \n    LPCTSTR lpszClassName,  \n    LPCTSTR lpszShortTypeName,  \n    LPCTSTR lpszLongTypeName,  \n    OLE_APPTYPE nAppType = OAT_SERVER,  \n    LPCTSTR* rglpszRegister = NULL,  \n    LPCTSTR* rglpszOverwrite = NULL); \n```  \n  \n### Parameters  \n `clsid`  \n Reference to the server's OLE class ID.  \n  \n `lpszClassName`  \n Pointer to a string containing the class name of the server's objects.  \n  \n *lpszShortTypeName*  \n Pointer to a string containing the short name of the server's object type, such as \"Chart.\"  \n  \n *lpszLongTypeName*  \n Pointer to a string containing the long name of the server's object type, such as \"Microsoft Excel 5.0 Chart.\"  \n  \n `nAppType`  \n A value, taken from the **OLE_APPTYPE** enumeration, specifying the type of OLE application. Possible values are the following:  \n  \n- `OAT_INPLACE_SERVER` Server has full server user-interface.  \n  \n- `OAT_SERVER` Server supports only embedding.  \n  \n- `OAT_CONTAINER` Container supports links to embeddings.  \n  \n- `OAT_DISPATCH_OBJECT` `IDispatch`-capable object.  \n  \n `rglpszRegister`  \n Array of pointers to strings representing the keys and values to be added to the OLE system registry if no existing values for the keys are found.  \n  \n `rglpszOverwrite`  \n Array of pointers to strings representing the keys and values to be added to the OLE system registry if the registry contains existing values for the given keys.  \n  \n### Return Value  \n Nonzero if the server class is successfully registered; otherwise 0.  \n  \n### Remarks  \n Most applications can use **COleTemplateServer::Register** to register the application's document types. If your application's system-registry format does not fit the typical pattern, you can use `AfxOleRegisterServerClass` for more control.  \n  \n The registry consists of a set of keys and values. The `rglpszRegister` and `rglpszOverwrite` arguments are arrays of pointers to strings, each consisting of a key and a value separated by a **NULL** character ( `'\\0'`). Each of these strings can have replaceable parameters whose places are marked by the character sequences `%1` through `%5`.  \n  \n The symbols are filled in as follows:  \n  \n|Symbol|Value|  \n|------------|-----------|  \n|%1|Class ID, formatted as a string|  \n|%2|Class name|  \n|%3|Path to executable file|  \n|%4|Short type name|  \n|%5|Long type name|  \n  \n##  <a name=\"afxoleseteditmenu\"></a>  AfxOleSetEditMenu  \n Implements the user interface for the *typename* Object command.  \n  \n```   \nvoid  AFXAPI  AfxOleSetEditMenu(\n    COleClientItem* pClient,  \n    CMenu* pMenu,  \n    UINT iMenuItem,  \n    UINT nIDVerbMin,  \n    UINT nIDVerbMax = 0,  \n    UINT nIDConvert = 0); \n```  \n  \n### Parameters  \n `pClient`  \n A pointer to the client OLE item.  \n  \n `pMenu`  \n A pointer to the menu object to be updated.  \n  \n *iMenuItem*  \n The index of the menu item to be updated.  \n  \n `nIDVerbMin`  \n The command ID that corresponds to the primary verb.  \n  \n *nIDVerbMax*  \n The command ID that corresponds to the last verb.  \n  \n *nIDConvert*  \n ID for the Convert menu item.  \n  \n### Remarks  \n If the server recognizes only a primary verb, the menu item becomes \"verb *typename* Object\" and the `nIDVerbMin` command is sent when the user chooses the command. If the server recognizes several verbs, then the menu item becomes \" *typename* Object\" and a submenu listing all the verbs appears when the user chooses the command. When the user chooses a verb from the submenu, `nIDVerbMin` is sent if the first verb is chosen, `nIDVerbMin` + 1 is sent if the second verb is chosen, and so forth. The default `COleDocument` implementation automatically handles this feature.  \n  \n You must have the following statement in your client's application resource script (.RC) file:  \n  \n **#include \\<afxolecl.rc>**  \n  \n## See Also  \n [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)\n"}