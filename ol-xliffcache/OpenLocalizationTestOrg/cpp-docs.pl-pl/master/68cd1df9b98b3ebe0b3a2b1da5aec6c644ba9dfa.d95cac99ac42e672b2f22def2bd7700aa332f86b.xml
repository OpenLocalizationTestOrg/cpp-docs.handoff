{"nodes":[{"pos":[12,44],"content":"CAtlArray Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CAtlArray Class | Microsoft Docs","pos":[0,32]}]},{"content":"CAtlArray Class","pos":[642,657]},{"content":"This class implements an array object.","pos":[658,696]},{"content":"Syntax","pos":[705,711]},{"content":"Parameters","pos":[809,819]},{"content":"E","pos":[824,825]},{"content":"The type of data to be stored in the array.","pos":[830,873]},{"content":"ETraits","pos":[881,888]},{"content":"The code used to copy or move elements.","pos":[893,932]},{"content":"Members","pos":[941,948]},{"content":"Methods","pos":[958,965]},{"content":"Add","pos":[987,990]},{"content":"Call this method to add an element to the array object.","pos":[1009,1064]},{"content":"Append","pos":[1070,1076]},{"content":"Call this method to add the contents of one array to the end of another.","pos":[1098,1170]},{"content":"AssertValid","pos":[1176,1187]},{"content":"Call this method to confirm that the array object is valid.","pos":[1214,1273]},{"content":"CAtlArray","pos":[1279,1288]},{"content":"The constructor.","pos":[1313,1329]},{"content":"~CAtlArray","pos":[1335,1345]},{"content":"The destructor.","pos":[1375,1390]},{"content":"Copy","pos":[1396,1400]},{"content":"Call this method to copy the elements of one array to another.","pos":[1420,1482]},{"content":"FreeExtra","pos":[1488,1497]},{"content":"Call this method to remove any empty elements from the array.","pos":[1522,1583]},{"content":"GetAt","pos":[1589,1594]},{"content":"Call this method to retrieve a single element from the array object.","pos":[1615,1683]},{"content":"GetCount","pos":[1689,1697]},{"content":"Call this method to return the number of elements stored in the array.","pos":[1721,1791]},{"content":"GetData","pos":[1797,1804]},{"content":"Call this method to return a pointer to the first element in the array.","pos":[1827,1898]},{"content":"InsertArrayAt","pos":[1904,1917]},{"content":"Call this method to insert one array into another.","pos":[1946,1996]},{"content":"InsertAt","pos":[2002,2010]},{"content":"Call this method to insert a new element (or multiple copies of an element) into the array object.","pos":[2034,2132]},{"content":"IsEmpty","pos":[2138,2145]},{"content":"Call this method to test if the array is empty.","pos":[2168,2215]},{"content":"RemoveAll","pos":[2221,2230]},{"content":"Call this method to remove all elements from the array object.","pos":[2255,2317]},{"content":"RemoveAt","pos":[2323,2331]},{"content":"Call this method to remove one or more elements from the array.","pos":[2355,2418]},{"content":"SetAt","pos":[2424,2429]},{"content":"Call this method to set the value of an element in the array object.","pos":[2450,2518]},{"content":"SetAtGrow","pos":[2524,2533]},{"content":"Call this method to set the value of an element in the array object, expanding the array as required.","pos":[2558,2659]},{"content":"SetCount","pos":[2665,2673]},{"content":"Call this method to set the size of the array object.","pos":[2697,2750]},{"content":"Operators","pos":[2761,2770]},{"content":"operator &amp;#91;&amp;#93;","pos":[2792,2811],"source":"operator &#91;&#93;"},{"content":"Call this operator to return a reference to an element in the array.","pos":[2838,2906]},{"content":"Typedefs","pos":[2918,2926]},{"content":"INARGTYPE","pos":[2948,2957]},{"content":"The data type to use for adding elements to the array.","pos":[2982,3036]},{"content":"OUTARGTYPE","pos":[3042,3052]},{"content":"The data type to use for retrieving elements from the array.","pos":[3078,3138]},{"content":"Remarks","pos":[3148,3155]},{"content":"<bpt id=\"p1\">**</bpt>CAtlArray<ept id=\"p1\">**</ept> provides methods for creating and managing an array of elements of a user-defined type.","pos":[3159,3260],"source":"**CAtlArray** provides methods for creating and managing an array of elements of a user-defined type."},{"content":"Although similar to standard C arrays, the <bpt id=\"p1\">**</bpt>CAtlArray<ept id=\"p1\">**</ept> object can dynamically shrink and grow as necessary.","pos":[3261,3370],"source":" Although similar to standard C arrays, the **CAtlArray** object can dynamically shrink and grow as necessary."},{"content":"The array index always starts at position 0, and the upper bound can be fixed, or allowed to expand as new elements are added.","pos":[3371,3497]},{"pos":[3504,3632],"content":"For arrays with a small number of elements, the ATL class <bpt id=\"p1\">[</bpt>CSimpleArray<ept id=\"p1\">](../../atl/reference/csimplearray-class.md)</ept> can be used.","source":"For arrays with a small number of elements, the ATL class [CSimpleArray](../../atl/reference/csimplearray-class.md) can be used."},{"pos":[3639,3768],"content":"<bpt id=\"p1\">**</bpt>CAtlArray<ept id=\"p1\">**</ept> is closely related to MFC's <bpt id=\"p2\">**</bpt>CArray<ept id=\"p2\">**</ept> class and will work in an MFC project, albeit without serialization support.","source":"**CAtlArray** is closely related to MFC's **CArray** class and will work in an MFC project, albeit without serialization support."},{"pos":[3775,3863],"content":"For more information, see <bpt id=\"p1\">[</bpt>ATL Collection Classes<ept id=\"p1\">](../../atl/atl-collection-classes.md)</ept>.","source":"For more information, see [ATL Collection Classes](../../atl/atl-collection-classes.md)."},{"content":"Requirements","pos":[3872,3884]},{"pos":[3888,3909],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcoll.h","source":"**Header:** atlcoll.h"},{"pos":[3950,3964],"content":"CAtlArray::Add"},{"content":"Call this method to add an element to the array object.","pos":[3968,4023]},{"content":"Parameters","pos":[4096,4106]},{"content":"The element to be added to the array.","pos":[4123,4160]},{"content":"Return Value","pos":[4170,4182]},{"content":"Returns the index of the added element.","pos":[4186,4225]},{"content":"Remarks","pos":[4235,4242]},{"content":"The new element is added to the end of the array.","pos":[4246,4295]},{"content":"If no element is provided, an empty element is added; that is, the array is increased in size as though a real element has been added.","pos":[4296,4430]},{"content":"If the operation fails, <bpt id=\"p1\">[</bpt>AtlThrow<ept id=\"p1\">](http://msdn.microsoft.com/library/2bd111da-8170-488d-914a-c9bf6b6765f7)</ept> is called with the argument E_OUTOFMEMORY.","pos":[4431,4580],"source":" If the operation fails, [AtlThrow](http://msdn.microsoft.com/library/2bd111da-8170-488d-914a-c9bf6b6765f7) is called with the argument E_OUTOFMEMORY."},{"content":"Example","pos":[4590,4597]},{"pos":[4612,4631],"content":"NVC_ATL_Utilities#1"},{"pos":[4726,4743],"content":"CAtlArray::Append"},{"content":"Call this method to add the contents of one array to the end of another.","pos":[4747,4819]},{"content":"Parameters","pos":[4892,4902]},{"content":"The array to append.","pos":[4916,4936]},{"content":"Return Value","pos":[4946,4958]},{"content":"Returns the index of the first appended element.","pos":[4962,5010]},{"content":"Remarks","pos":[5020,5027]},{"content":"The elements in the supplied array are added to the end of the existing array.","pos":[5031,5109]},{"content":"If necessary, memory will be allocated to accommodate the new elements.","pos":[5110,5181]},{"content":"The arrays must be of the same type, and it is not possible to append an array to itself.","pos":[5188,5277]},{"content":"In debug builds, an ATLASSERT will be raised if the <ph id=\"ph1\">`CAtlArray`</ph> argument is not a valid array or if <ph id=\"ph2\">`aSrc`</ph> refers to the same object.","pos":[5284,5417],"source":"In debug builds, an ATLASSERT will be raised if the `CAtlArray` argument is not a valid array or if `aSrc` refers to the same object."},{"content":"In release builds, invalid arguments may lead to unpredictable behavior.","pos":[5418,5490]},{"content":"Example","pos":[5500,5507]},{"pos":[5522,5541],"content":"NVC_ATL_Utilities#2"},{"pos":[5641,5663],"content":"CAtlArray::AssertValid"},{"content":"Call this method to confirm that the array object is valid.","pos":[5667,5726]},{"content":"Remarks","pos":[5775,5782]},{"content":"If the array object is not valid, <ph id=\"ph1\">`ATLASSERT`</ph> will throw an assertion.","pos":[5786,5856],"source":"If the array object is not valid, `ATLASSERT` will throw an assertion."},{"content":"This method is available only if _DEBUG is defined.","pos":[5857,5908]},{"content":"Example","pos":[5918,5925]},{"pos":[5940,5959],"content":"NVC_ATL_Utilities#3"},{"pos":[6057,6077],"content":"CAtlArray::CAtlArray"},{"content":"The constructor.","pos":[6081,6097]},{"content":"Remarks","pos":[6141,6148]},{"content":"Initializes the array object.","pos":[6152,6181]},{"content":"Example","pos":[6191,6198]},{"pos":[6213,6232],"content":"NVC_ATL_Utilities#4"},{"pos":[6335,6356],"content":"CAtlArray::~CAtlArray"},{"content":"The destructor.","pos":[6360,6375]},{"content":"Remarks","pos":[6420,6427]},{"content":"Frees up any resources used by the array object.","pos":[6431,6479]},{"pos":[6521,6536],"content":"CAtlArray::Copy"},{"content":"Call this method to copy the elements of one array to another.","pos":[6540,6602]},{"content":"Parameters","pos":[6671,6681]},{"content":"The source of the elements to copy to an array.","pos":[6695,6742]},{"content":"Remarks","pos":[6752,6759]},{"content":"Call this method to overwrite elements of one array with the elements of another array.","pos":[6763,6850]},{"content":"If necessary, memory will be allocated to accommodate the new elements.","pos":[6851,6922]},{"content":"It is not possible to copy elements of an array to itself.","pos":[6923,6981]},{"pos":[6988,7098],"content":"If the existing contents of the array are to be retained, use <bpt id=\"p1\">[</bpt>CAtlArray::Append<ept id=\"p1\">](#catlarray__append)</ept> instead.","source":"If the existing contents of the array are to be retained, use [CAtlArray::Append](#catlarray__append) instead."},{"content":"In debug builds, an ATLASSERT will be raised if the existing <ph id=\"ph1\">`CAtlArray`</ph> object is not valid, or if <ph id=\"ph2\">`aSrc`</ph> refers to the same object.","pos":[7105,7238],"source":"In debug builds, an ATLASSERT will be raised if the existing `CAtlArray` object is not valid, or if `aSrc` refers to the same object."},{"content":"In release builds, invalid arguments may lead to unpredictable behavior.","pos":[7239,7311]},{"pos":[7319,7467],"content":"[!NOTE]\n`CAtlArray::Copy` does not support arrays consisting of elements created with the [CAutoPtr](../../atl/reference/cautoptr-class.md) class.","leadings":["","> "],"nodes":[{"content":"does not support arrays consisting of elements created with the <bpt id=\"p1\">[</bpt>CAutoPtr<ept id=\"p1\">](../../atl/reference/cautoptr-class.md)</ept> class.","pos":[26,146],"source":" does not support arrays consisting of elements created with the [CAutoPtr](../../atl/reference/cautoptr-class.md) class."}]},{"content":"Example","pos":[7477,7484]},{"pos":[7499,7518],"content":"NVC_ATL_Utilities#5"},{"pos":[7616,7636],"content":"CAtlArray::FreeExtra"},{"content":"Call this method to remove any empty elements from the array.","pos":[7640,7701]},{"content":"Remarks","pos":[7750,7757]},{"content":"Any empty elements are removed, but the size and upper bound of the array remain unchanged.","pos":[7761,7852]},{"content":"In debug builds, an ATLASSERT will be raised if the CAtlArray object is not valid, or if the array would exceed its maximum size.","pos":[7859,7988]},{"pos":[8031,8047],"content":"CAtlArray::GetAt"},{"content":"Call this method to retrieves a single element from the array object.","pos":[8051,8120]},{"content":"Parameters","pos":[8225,8235]},{"content":"The index value of the array element to return.","pos":[8253,8300]},{"content":"Return Value","pos":[8310,8322]},{"content":"Returns a reference to the required array element.","pos":[8326,8376]},{"content":"Remarks","pos":[8386,8393]},{"content":"In debug builds, an ATLASSERT will be raised if <ph id=\"ph1\">`iElement`</ph> exceeds the number of elements in the array.","pos":[8397,8500],"source":"In debug builds, an ATLASSERT will be raised if `iElement` exceeds the number of elements in the array."},{"content":"In release builds, an invalid argument may lead to unpredictable behavior.","pos":[8501,8575]},{"content":"Example","pos":[8585,8592]},{"pos":[8607,8626],"content":"NVC_ATL_Utilities#6"},{"pos":[8723,8742],"content":"CAtlArray::GetCount"},{"content":"Call this method to return the number of elements stored in the array.","pos":[8746,8816]},{"content":"Return Value","pos":[8872,8884]},{"content":"Returns the number of elements stored in the array.","pos":[8888,8939]},{"content":"Remarks","pos":[8949,8956]},{"pos":[8960,9088],"content":"As the first element in the array is at position 0, the value returned by <ph id=\"ph1\">`GetCount`</ph> is always 1 greater than the largest index.","source":"As the first element in the array is at position 0, the value returned by `GetCount` is always 1 greater than the largest index."},{"content":"Example","pos":[9098,9105]},{"pos":[9109,9167],"content":"See the example for <bpt id=\"p1\">[</bpt>CAtlArray::GetAt<ept id=\"p1\">](#catlarray__getat)</ept>.","source":"See the example for [CAtlArray::GetAt](#catlarray__getat)."},{"pos":[9212,9230],"content":"CAtlArray::GetData"},{"content":"Call this method to return a pointer to the first element in the array.","pos":[9234,9305]},{"content":"Return Value","pos":[9385,9397]},{"content":"Returns a pointer to the memory location storing the first element in the array.","pos":[9401,9481]},{"content":"If no elements are available, NULL is returned.","pos":[9482,9529]},{"content":"Example","pos":[9539,9546]},{"pos":[9561,9580],"content":"NVC_ATL_Utilities#7"},{"pos":[9678,9698],"content":"CAtlArray::INARGTYPE"},{"content":"The data type to use for adding elements to the array.","pos":[9702,9756]},{"pos":[9858,9882],"content":"CAtlArray::InsertArrayAt"},{"content":"Call this method to insert one array into another.","pos":[9886,9936]},{"content":"Parameters","pos":[10038,10048]},{"content":"The index at which the array is to be inserted.","pos":[10064,10111]},{"content":"The array to be inserted.","pos":[10129,10154]},{"content":"Remarks","pos":[10164,10171]},{"content":"Elements from the array <ph id=\"ph1\">`paNew`</ph> are copied into the array object, beginning at element <ph id=\"ph2\">`iStart`</ph>.","pos":[10175,10271],"source":"Elements from the array `paNew` are copied into the array object, beginning at element `iStart`."},{"content":"The existing array elements are moved to avoid being overwritten.","pos":[10272,10337]},{"pos":[10344,10474],"content":"In debug builds, an ATLASSERT will be raised if the <ph id=\"ph1\">`CAtlArray`</ph> object is not valid, or if the <ph id=\"ph2\">`paNew`</ph> pointer is NULL or invalid.","source":"In debug builds, an ATLASSERT will be raised if the `CAtlArray` object is not valid, or if the `paNew` pointer is NULL or invalid."},{"pos":[10482,10639],"content":"[!NOTE]\n`CAtlArray::InsertArrayAt` does not support arrays consisting of elements created with the [CAutoPtr](../../atl/reference/cautoptr-class.md) class.","leadings":["","> "],"nodes":[{"content":"does not support arrays consisting of elements created with the <bpt id=\"p1\">[</bpt>CAutoPtr<ept id=\"p1\">](../../atl/reference/cautoptr-class.md)</ept> class.","pos":[35,155],"source":" does not support arrays consisting of elements created with the [CAutoPtr](../../atl/reference/cautoptr-class.md) class."}]},{"content":"Example","pos":[10649,10656]},{"pos":[10671,10690],"content":"NVC_ATL_Utilities#8"},{"pos":[10787,10806],"content":"CAtlArray::InsertAt"},{"content":"Call this method to insert a new element (or multiple copies of an element) into the array object.","pos":[10810,10908]},{"content":"Parameters","pos":[11009,11019]},{"content":"The index where the element or elements are to be inserted.","pos":[11037,11096]},{"content":"The value of the element or elements to be inserted.","pos":[11116,11168]},{"content":"The number of elements to add.","pos":[11187,11217]},{"content":"Remarks","pos":[11227,11234]},{"content":"Inserts one or more elements into the array, starting at index <ph id=\"ph1\">`iElement`</ph>.","pos":[11238,11312],"source":"Inserts one or more elements into the array, starting at index `iElement`."},{"content":"Existing elements are moved to avoid being overwritten.","pos":[11313,11368]},{"content":"In debug builds, an ATLASSERT will be raised if the <ph id=\"ph1\">`CAtlArray`</ph> object is invalid, the number of elements to be added is zero, or the combined number of elements is too large for the array to contain.","pos":[11375,11575],"source":"In debug builds, an ATLASSERT will be raised if the `CAtlArray` object is invalid, the number of elements to be added is zero, or the combined number of elements is too large for the array to contain."},{"content":"In retail builds, passing invalid parameters may cause unpredictable results.","pos":[11576,11653]},{"content":"Example","pos":[11663,11670]},{"pos":[11685,11704],"content":"NVC_ATL_Utilities#9"},{"pos":[11800,11818],"content":"CAtlArray::IsEmpty"},{"content":"Call this method to test if the array is empty.","pos":[11822,11869]},{"content":"Return Value","pos":[11922,11934]},{"content":"Returns true if the array is empty, false otherwise.","pos":[11938,11990]},{"content":"Remarks","pos":[12000,12007]},{"content":"The array is said to be empty if it contains no elements.","pos":[12011,12068]},{"content":"Therefore, even if the array contains empty elements, it is not empty.","pos":[12069,12139]},{"content":"Example","pos":[12149,12156]},{"pos":[12171,12191],"content":"NVC_ATL_Utilities#10"},{"pos":[12292,12314],"content":"CAtlArray::operator []"},{"content":"Call this operator to return a reference to an element in the array.","pos":[12318,12386]},{"content":"Parameters","pos":[12502,12512]},{"content":"The index value of the array element to return.","pos":[12530,12577]},{"content":"Return Value","pos":[12587,12599]},{"content":"Returns a reference to the required array element.","pos":[12603,12653]},{"content":"Remarks","pos":[12663,12670]},{"content":"Performs a similar function to <bpt id=\"p1\">[</bpt>CAtlArray::GetAt<ept id=\"p1\">](#catlarray__getat)</ept>.","pos":[12674,12743],"source":"Performs a similar function to [CAtlArray::GetAt](#catlarray__getat)."},{"content":"Unlike the MFC class <bpt id=\"p1\">[</bpt>CArray<ept id=\"p1\">](../../mfc/reference/carray-class.md)</ept>, this operator cannot be used as a substitute for <bpt id=\"p2\">[</bpt>CAtlArray::SetAt<ept id=\"p2\">](#catlarray__setat)</ept>.","pos":[12744,12899],"source":" Unlike the MFC class [CArray](../../mfc/reference/carray-class.md), this operator cannot be used as a substitute for [CAtlArray::SetAt](#catlarray__setat)."},{"content":"In debug builds, an ATLASSERT will be raised if <ph id=\"ph1\">`iElement`</ph> exceeds the total number of elements in the array.","pos":[12906,13015],"source":"In debug builds, an ATLASSERT will be raised if `iElement` exceeds the total number of elements in the array."},{"content":"In retail builds, an invalid parameter may cause unpredictable results.","pos":[13016,13087]},{"pos":[13135,13156],"content":"CAtlArray::OUTARGTYPE"},{"content":"The data type to use for retrieving elements from the array.","pos":[13160,13220]},{"pos":[13320,13340],"content":"CAtlArray::RemoveAll"},{"content":"Call this method to remove all elements from the array object.","pos":[13344,13406]},{"content":"Remarks","pos":[13455,13462]},{"content":"Removes all of the elements from the array object.","pos":[13466,13516]},{"pos":[13523,13649],"content":"This method calls <bpt id=\"p1\">[</bpt>CAtlArray::SetCount<ept id=\"p1\">](#catlarray__setcount)</ept> to resize the array and subsequently frees any allocated memory.","source":"This method calls [CAtlArray::SetCount](#catlarray__setcount) to resize the array and subsequently frees any allocated memory."},{"content":"Example","pos":[13659,13666]},{"pos":[13670,13732],"content":"See the example for <bpt id=\"p1\">[</bpt>CAtlArray::IsEmpty<ept id=\"p1\">](#catlarray__isempty)</ept>.","source":"See the example for [CAtlArray::IsEmpty](#catlarray__isempty)."},{"pos":[13778,13797],"content":"CAtlArray::RemoveAt"},{"content":"Call this method to remove one or more elements from the array.","pos":[13801,13864]},{"content":"Parameters","pos":[13939,13949]},{"content":"The index of the first element to remove.","pos":[13967,14008]},{"content":"The number of elements to remove.","pos":[14027,14060]},{"content":"Remarks","pos":[14070,14077]},{"content":"Removes one or more elements from the array.","pos":[14081,14125]},{"content":"Any remaining elements are shifted down.","pos":[14126,14166]},{"content":"The upper bound is decremented, but memory is not freed until a call to <bpt id=\"p1\">[</bpt>CAtlArray::FreeExtra<ept id=\"p1\">](#catlarray__freeextra)</ept> is made.","pos":[14167,14293],"source":" The upper bound is decremented, but memory is not freed until a call to [CAtlArray::FreeExtra](#catlarray__freeextra) is made."},{"content":"In debug builds, an ATLASSERT will be raised if the <ph id=\"ph1\">`CAtlArray`</ph> object is not valid, or if the combined total of <ph id=\"ph2\">`iElement`</ph> and <ph id=\"ph3\">`nCount`</ph> exceeds the total number of elements in the array.","pos":[14300,14487],"source":"In debug builds, an ATLASSERT will be raised if the `CAtlArray` object is not valid, or if the combined total of `iElement` and `nCount` exceeds the total number of elements in the array."},{"content":"In retail builds, invalid parameters may cause unpredictable results.","pos":[14488,14557]},{"content":"Example","pos":[14567,14574]},{"pos":[14589,14609],"content":"NVC_ATL_Utilities#11"},{"pos":[14704,14720],"content":"CAtlArray::SetAt"},{"content":"Call this method to set the value of an element in the array object.","pos":[14724,14792]},{"content":"Parameters","pos":[14864,14874]},{"content":"The index pointing to the array element to set.","pos":[14892,14939]},{"content":"The new value of the specified element.","pos":[14959,14998]},{"content":"Remarks","pos":[15008,15015]},{"content":"In debug builds, an ATLASSERT will be raised if <ph id=\"ph1\">`iElement`</ph> exceeds the number of elements in the array.","pos":[15019,15122],"source":"In debug builds, an ATLASSERT will be raised if `iElement` exceeds the number of elements in the array."},{"content":"In retail builds, an invalid parameter may result in unpredictable results.","pos":[15123,15198]},{"content":"Example","pos":[15208,15215]},{"pos":[15219,15277],"content":"See the example for <bpt id=\"p1\">[</bpt>CAtlArray::GetAt<ept id=\"p1\">](#catlarray__getat)</ept>.","source":"See the example for [CAtlArray::GetAt](#catlarray__getat)."},{"pos":[15323,15342],"content":"CAtlArray::SetCount"},{"content":"Call this method to set the size of the array object.","pos":[15346,15399]},{"content":"Parameters","pos":[15474,15484]},{"content":"The required size of the array.","pos":[15502,15533]},{"content":"A value used to determine how large to make the buffer.","pos":[15553,15608]},{"content":"A value of -1 causes an internally calculated value to be used.","pos":[15609,15672]},{"content":"Return Value","pos":[15682,15694]},{"content":"Returns true if the array is successfully resized, false otherwise.","pos":[15698,15765]},{"content":"Remarks","pos":[15775,15782]},{"content":"The array can be increased or decreased in size.","pos":[15786,15834]},{"content":"If increased, extra empty elements are added to the array.","pos":[15835,15893]},{"content":"If decreased, the elements with the largest indices will be deleted and memory freed.","pos":[15894,15979]},{"content":"Use this method to set the size of the array before using it.","pos":[15986,16047]},{"content":"If <ph id=\"ph1\">`SetCount`</ph> is not used, the process of adding elements — and the subsequent memory allocation performed — will reduce performance and fragment memory.","pos":[16048,16201],"source":" If `SetCount` is not used, the process of adding elements — and the subsequent memory allocation performed — will reduce performance and fragment memory."},{"content":"Example","pos":[16211,16218]},{"pos":[16222,16284],"content":"See the example for <bpt id=\"p1\">[</bpt>CAtlArray::GetData<ept id=\"p1\">](#catlarray__getdata)</ept>.","source":"See the example for [CAtlArray::GetData](#catlarray__getdata)."},{"pos":[16331,16351],"content":"CAtlArray::SetAtGrow"},{"content":"Call this method to set the value of an element in the array object, expanding the array as required.","pos":[16355,16456]},{"content":"Parameters","pos":[16532,16542]},{"content":"The index pointing to the array element to set.","pos":[16560,16607]},{"content":"The new value of the specified element.","pos":[16627,16666]},{"content":"Remarks","pos":[16676,16683]},{"content":"Replaces the value of the element pointed to by the index.","pos":[16687,16745]},{"content":"If <ph id=\"ph1\">`iElement`</ph> is larger than the current size of the array, the array is automatically increased using a call to <bpt id=\"p1\">[</bpt>CAtlArray::SetCount<ept id=\"p1\">](#catlarray__setcount)</ept>.","pos":[16746,16903],"source":" If `iElement` is larger than the current size of the array, the array is automatically increased using a call to [CAtlArray::SetCount](#catlarray__setcount)."},{"content":"In debug builds, an ATLASSERT will be raised if the <ph id=\"ph1\">`CAtlArray`</ph> object is not valid.","pos":[16904,16988],"source":" In debug builds, an ATLASSERT will be raised if the `CAtlArray` object is not valid."},{"content":"In retail builds, invalid parameters may cause unpredictable results.","pos":[16989,17058]},{"content":"Example","pos":[17068,17075]},{"pos":[17090,17110],"content":"NVC_ATL_Utilities#12"},{"content":"See Also","pos":[17171,17179]},{"content":"MMXSwarm Sample","pos":[17184,17199]},{"content":"DynamicConsumer Sample","pos":[17235,17257]},{"content":"UpdatePV Sample","pos":[17293,17308]},{"content":"Marquee Sample","pos":[17344,17358]},{"content":"CArray Class","pos":[17394,17406]},{"content":"Class Overview","pos":[17450,17464]}],"content":"---\ntitle: \"CAtlArray Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::CAtlArray\"\n  - \"ATL.CAtlArray\"\n  - \"CAtlArray\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CAtlArray class\"\nms.assetid: 0b503aa8-2357-40af-a326-6654bf1da098\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CAtlArray Class\nThis class implements an array object.  \n  \n## Syntax  \n  \n```\ntemplate<typename E,  class ETraits = CElementTraits<E>>  class CAtlArray\n```  \n  \n#### Parameters  \n *E*  \n The type of data to be stored in the array.  \n  \n *ETraits*  \n The code used to copy or move elements.  \n  \n## Members  \n  \n### Methods  \n  \n|||  \n|-|-|  \n|[Add](#catlarray__add)|Call this method to add an element to the array object.|  \n|[Append](#catlarray__append)|Call this method to add the contents of one array to the end of another.|  \n|[AssertValid](#catlarray__assertvalid)|Call this method to confirm that the array object is valid.|  \n|[CAtlArray](#catlarray__catlarray)|The constructor.|  \n|[~CAtlArray](#catlarray___dtorcatlarray)|The destructor.|  \n|[Copy](#catlarray__copy)|Call this method to copy the elements of one array to another.|  \n|[FreeExtra](#catlarray__freeextra)|Call this method to remove any empty elements from the array.|  \n|[GetAt](#catlarray__getat)|Call this method to retrieve a single element from the array object.|  \n|[GetCount](#catlarray__getcount)|Call this method to return the number of elements stored in the array.|  \n|[GetData](#catlarray__getdata)|Call this method to return a pointer to the first element in the array.|  \n|[InsertArrayAt](#catlarray__insertarrayat)|Call this method to insert one array into another.|  \n|[InsertAt](#catlarray__insertat)|Call this method to insert a new element (or multiple copies of an element) into the array object.|  \n|[IsEmpty](#catlarray__isempty)|Call this method to test if the array is empty.|  \n|[RemoveAll](#catlarray__removeall)|Call this method to remove all elements from the array object.|  \n|[RemoveAt](#catlarray__removeat)|Call this method to remove one or more elements from the array.|  \n|[SetAt](#catlarray__setat)|Call this method to set the value of an element in the array object.|  \n|[SetAtGrow](#catlarray__setatgrow)|Call this method to set the value of an element in the array object, expanding the array as required.|  \n|[SetCount](#catlarray__setcount)|Call this method to set the size of the array object.|  \n  \n### Operators  \n  \n|||  \n|-|-|  \n|[operator &#91;&#93;](#catlarray__operator_at)|Call this operator to return a reference to an element in the array.|  \n\n  \n### Typedefs  \n  \n|||  \n|-|-|  \n|[INARGTYPE](#catlarray__inargtype)|The data type to use for adding elements to the array.|  \n|[OUTARGTYPE](#catlarray__outargtype)|The data type to use for retrieving elements from the array.|  \n  \n## Remarks  \n **CAtlArray** provides methods for creating and managing an array of elements of a user-defined type. Although similar to standard C arrays, the **CAtlArray** object can dynamically shrink and grow as necessary. The array index always starts at position 0, and the upper bound can be fixed, or allowed to expand as new elements are added.  \n  \n For arrays with a small number of elements, the ATL class [CSimpleArray](../../atl/reference/csimplearray-class.md) can be used.  \n  \n **CAtlArray** is closely related to MFC's **CArray** class and will work in an MFC project, albeit without serialization support.  \n  \n For more information, see [ATL Collection Classes](../../atl/atl-collection-classes.md).  \n  \n## Requirements  \n **Header:** atlcoll.h  \n  \n##  <a name=\"catlarray__add\"></a>  CAtlArray::Add  \n Call this method to add an element to the array object.  \n  \n```\nsize_t Add(INARGTYPE element);\n\n    size_t Add();\n```  \n  \n### Parameters  \n `element`  \n The element to be added to the array.  \n  \n### Return Value  \n Returns the index of the added element.  \n  \n### Remarks  \n The new element is added to the end of the array. If no element is provided, an empty element is added; that is, the array is increased in size as though a real element has been added. If the operation fails, [AtlThrow](http://msdn.microsoft.com/library/2bd111da-8170-488d-914a-c9bf6b6765f7) is called with the argument E_OUTOFMEMORY.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#1](../../atl/codesnippet/cpp/catlarray-class_1.cpp)]  \n  \n##  <a name=\"catlarray__append\"></a>  CAtlArray::Append  \n Call this method to add the contents of one array to the end of another.  \n  \n```\nsize_t Append(const CAtlArray<E, ETraits>& aSrc);\n```  \n  \n### Parameters  \n `aSrc`  \n The array to append.  \n  \n### Return Value  \n Returns the index of the first appended element.  \n  \n### Remarks  \n The elements in the supplied array are added to the end of the existing array. If necessary, memory will be allocated to accommodate the new elements.  \n  \n The arrays must be of the same type, and it is not possible to append an array to itself.  \n  \n In debug builds, an ATLASSERT will be raised if the `CAtlArray` argument is not a valid array or if `aSrc` refers to the same object. In release builds, invalid arguments may lead to unpredictable behavior.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#2](../../atl/codesnippet/cpp/catlarray-class_2.cpp)]  \n  \n##  <a name=\"catlarray__assertvalid\"></a>  CAtlArray::AssertValid  \n Call this method to confirm that the array object is valid.  \n  \n```\nvoid AssertValid() const;\n```  \n  \n### Remarks  \n If the array object is not valid, `ATLASSERT` will throw an assertion. This method is available only if _DEBUG is defined.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#3](../../atl/codesnippet/cpp/catlarray-class_3.cpp)]  \n  \n##  <a name=\"catlarray__catlarray\"></a>  CAtlArray::CAtlArray  \n The constructor.  \n  \n```\nCAtlArray() throw();\n```  \n  \n### Remarks  \n Initializes the array object.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#4](../../atl/codesnippet/cpp/catlarray-class_4.cpp)]  \n  \n##  <a name=\"catlarray___dtorcatlarray\"></a>  CAtlArray::~CAtlArray  \n The destructor.  \n  \n```\n~CAtlArray() throw();\n```  \n  \n### Remarks  \n Frees up any resources used by the array object.  \n  \n##  <a name=\"catlarray__copy\"></a>  CAtlArray::Copy  \n Call this method to copy the elements of one array to another.  \n  \n```\nvoid Copy(const CAtlArray<E, ETraits>& aSrc);\n```  \n  \n### Parameters  \n `aSrc`  \n The source of the elements to copy to an array.  \n  \n### Remarks  \n Call this method to overwrite elements of one array with the elements of another array. If necessary, memory will be allocated to accommodate the new elements. It is not possible to copy elements of an array to itself.  \n  \n If the existing contents of the array are to be retained, use [CAtlArray::Append](#catlarray__append) instead.  \n  \n In debug builds, an ATLASSERT will be raised if the existing `CAtlArray` object is not valid, or if `aSrc` refers to the same object. In release builds, invalid arguments may lead to unpredictable behavior.  \n  \n> [!NOTE]\n> `CAtlArray::Copy` does not support arrays consisting of elements created with the [CAutoPtr](../../atl/reference/cautoptr-class.md) class.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#5](../../atl/codesnippet/cpp/catlarray-class_5.cpp)]  \n  \n##  <a name=\"catlarray__freeextra\"></a>  CAtlArray::FreeExtra  \n Call this method to remove any empty elements from the array.  \n  \n```\nvoid FreeExtra() throw();\n```  \n  \n### Remarks  \n Any empty elements are removed, but the size and upper bound of the array remain unchanged.  \n  \n In debug builds, an ATLASSERT will be raised if the CAtlArray object is not valid, or if the array would exceed its maximum size.  \n  \n##  <a name=\"catlarray__getat\"></a>  CAtlArray::GetAt  \n Call this method to retrieves a single element from the array object.  \n  \n```\nconst E& GetAt(size_t iElement) const throw();\nE& GetAt(size_t iElement) throw();\n```  \n  \n### Parameters  \n `iElement`  \n The index value of the array element to return.  \n  \n### Return Value  \n Returns a reference to the required array element.  \n  \n### Remarks  \n In debug builds, an ATLASSERT will be raised if `iElement` exceeds the number of elements in the array. In release builds, an invalid argument may lead to unpredictable behavior.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#6](../../atl/codesnippet/cpp/catlarray-class_6.cpp)]  \n  \n##  <a name=\"catlarray__getcount\"></a>  CAtlArray::GetCount  \n Call this method to return the number of elements stored in the array.  \n  \n```\nsize_t GetCount() const throw();\n```  \n  \n### Return Value  \n Returns the number of elements stored in the array.  \n  \n### Remarks  \n As the first element in the array is at position 0, the value returned by `GetCount` is always 1 greater than the largest index.  \n  \n### Example  \n See the example for [CAtlArray::GetAt](#catlarray__getat).  \n  \n##  <a name=\"catlarray__getdata\"></a>  CAtlArray::GetData  \n Call this method to return a pointer to the first element in the array.  \n  \n```\nE* GetData() throw();\n\nconst E* GetData() const throw();\n```  \n  \n### Return Value  \n Returns a pointer to the memory location storing the first element in the array. If no elements are available, NULL is returned.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#7](../../atl/codesnippet/cpp/catlarray-class_7.cpp)]  \n  \n##  <a name=\"catlarray__inargtype\"></a>  CAtlArray::INARGTYPE  \n The data type to use for adding elements to the array.  \n  \n```\ntypedef ETraits::INARGTYPE INARGTYPE;\n```  \n  \n##  <a name=\"catlarray__insertarrayat\"></a>  CAtlArray::InsertArrayAt  \n Call this method to insert one array into another.  \n  \n```\nvoid InsertArrayAt(size_t iStart,\n    const CAtlArray<E,\n    ETraits>* paNew);\n```  \n  \n### Parameters  \n `iStart`  \n The index at which the array is to be inserted.  \n  \n `paNew`  \n The array to be inserted.  \n  \n### Remarks  \n Elements from the array `paNew` are copied into the array object, beginning at element `iStart`. The existing array elements are moved to avoid being overwritten.  \n  \n In debug builds, an ATLASSERT will be raised if the `CAtlArray` object is not valid, or if the `paNew` pointer is NULL or invalid.  \n  \n> [!NOTE]\n> `CAtlArray::InsertArrayAt` does not support arrays consisting of elements created with the [CAutoPtr](../../atl/reference/cautoptr-class.md) class.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#8](../../atl/codesnippet/cpp/catlarray-class_8.cpp)]  \n  \n##  <a name=\"catlarray__insertat\"></a>  CAtlArray::InsertAt  \n Call this method to insert a new element (or multiple copies of an element) into the array object.  \n  \n```\nvoid InsertAt(size_t iElement,\n    INARGTYPE element,\n    size_t nCount = 1);\n```  \n  \n### Parameters  \n `iElement`  \n The index where the element or elements are to be inserted.  \n  \n `element`  \n The value of the element or elements to be inserted.  \n  \n `nCount`  \n The number of elements to add.  \n  \n### Remarks  \n Inserts one or more elements into the array, starting at index `iElement`. Existing elements are moved to avoid being overwritten.  \n  \n In debug builds, an ATLASSERT will be raised if the `CAtlArray` object is invalid, the number of elements to be added is zero, or the combined number of elements is too large for the array to contain. In retail builds, passing invalid parameters may cause unpredictable results.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#9](../../atl/codesnippet/cpp/catlarray-class_9.cpp)]  \n  \n##  <a name=\"catlarray__isempty\"></a>  CAtlArray::IsEmpty  \n Call this method to test if the array is empty.  \n  \n```\nbool IsEmpty() const throw();\n```  \n  \n### Return Value  \n Returns true if the array is empty, false otherwise.  \n  \n### Remarks  \n The array is said to be empty if it contains no elements. Therefore, even if the array contains empty elements, it is not empty.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#10](../../atl/codesnippet/cpp/catlarray-class_10.cpp)]  \n  \n##  <a name=\"catlarray__operator_at\"></a>  CAtlArray::operator []  \n Call this operator to return a reference to an element in the array.  \n  \n```\nE& operator[](size_t ielement) throw();\n\nconst E& operator[](size_t ielement) const throw();\n```  \n  \n### Parameters  \n `iElement`  \n The index value of the array element to return.  \n  \n### Return Value  \n Returns a reference to the required array element.  \n  \n### Remarks  \n Performs a similar function to [CAtlArray::GetAt](#catlarray__getat). Unlike the MFC class [CArray](../../mfc/reference/carray-class.md), this operator cannot be used as a substitute for [CAtlArray::SetAt](#catlarray__setat).  \n  \n In debug builds, an ATLASSERT will be raised if `iElement` exceeds the total number of elements in the array. In retail builds, an invalid parameter may cause unpredictable results.  \n  \n##  <a name=\"catlarray__outargtype\"></a>  CAtlArray::OUTARGTYPE  \n The data type to use for retrieving elements from the array.  \n  \n```\ntypedef ETraits::OUTARGTYPE OUTARGTYPE;\n```  \n  \n##  <a name=\"catlarray__removeall\"></a>  CAtlArray::RemoveAll  \n Call this method to remove all elements from the array object.  \n  \n```\nvoid RemoveAll() throw();\n```  \n  \n### Remarks  \n Removes all of the elements from the array object.  \n  \n This method calls [CAtlArray::SetCount](#catlarray__setcount) to resize the array and subsequently frees any allocated memory.  \n  \n### Example  \n See the example for [CAtlArray::IsEmpty](#catlarray__isempty).  \n  \n##  <a name=\"catlarray__removeat\"></a>  CAtlArray::RemoveAt  \n Call this method to remove one or more elements from the array.  \n  \n```\nvoid RemoveAt(size_t iElement,  size_t nCount = 1);\n```  \n  \n### Parameters  \n `iElement`  \n The index of the first element to remove.  \n  \n `nCount`  \n The number of elements to remove.  \n  \n### Remarks  \n Removes one or more elements from the array. Any remaining elements are shifted down. The upper bound is decremented, but memory is not freed until a call to [CAtlArray::FreeExtra](#catlarray__freeextra) is made.  \n  \n In debug builds, an ATLASSERT will be raised if the `CAtlArray` object is not valid, or if the combined total of `iElement` and `nCount` exceeds the total number of elements in the array. In retail builds, invalid parameters may cause unpredictable results.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#11](../../atl/codesnippet/cpp/catlarray-class_11.cpp)]  \n  \n##  <a name=\"catlarray__setat\"></a>  CAtlArray::SetAt  \n Call this method to set the value of an element in the array object.  \n  \n```\nvoid SetAt(size_t iElement,  INARGTYPE element);\n```  \n  \n### Parameters  \n `iElement`  \n The index pointing to the array element to set.  \n  \n `element`  \n The new value of the specified element.  \n  \n### Remarks  \n In debug builds, an ATLASSERT will be raised if `iElement` exceeds the number of elements in the array. In retail builds, an invalid parameter may result in unpredictable results.  \n  \n### Example  \n See the example for [CAtlArray::GetAt](#catlarray__getat).  \n  \n##  <a name=\"catlarray__setcount\"></a>  CAtlArray::SetCount  \n Call this method to set the size of the array object.  \n  \n```\nbool SetCount(size_t nNewSize,  int nGrowBy = - 1);\n```  \n  \n### Parameters  \n `nNewSize`  \n The required size of the array.  \n  \n `nGrowBy`  \n A value used to determine how large to make the buffer. A value of -1 causes an internally calculated value to be used.  \n  \n### Return Value  \n Returns true if the array is successfully resized, false otherwise.  \n  \n### Remarks  \n The array can be increased or decreased in size. If increased, extra empty elements are added to the array. If decreased, the elements with the largest indices will be deleted and memory freed.  \n  \n Use this method to set the size of the array before using it. If `SetCount` is not used, the process of adding elements — and the subsequent memory allocation performed — will reduce performance and fragment memory.  \n  \n### Example  \n See the example for [CAtlArray::GetData](#catlarray__getdata).  \n  \n##  <a name=\"catlarray__setatgrow\"></a>  CAtlArray::SetAtGrow  \n Call this method to set the value of an element in the array object, expanding the array as required.  \n  \n```\nvoid SetAtGrow(size_t iElement,  INARGTYPE element);\n```  \n  \n### Parameters  \n `iElement`  \n The index pointing to the array element to set.  \n  \n `element`  \n The new value of the specified element.  \n  \n### Remarks  \n Replaces the value of the element pointed to by the index. If `iElement` is larger than the current size of the array, the array is automatically increased using a call to [CAtlArray::SetCount](#catlarray__setcount). In debug builds, an ATLASSERT will be raised if the `CAtlArray` object is not valid. In retail builds, invalid parameters may cause unpredictable results.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#12](../../atl/codesnippet/cpp/catlarray-class_12.cpp)]  \n  \n## See Also  \n [MMXSwarm Sample](../../visual-cpp-samples.md)   \n [DynamicConsumer Sample](../../visual-cpp-samples.md)   \n [UpdatePV Sample](../../visual-cpp-samples.md)   \n [Marquee Sample](../../visual-cpp-samples.md)   \n [CArray Class](../../mfc/reference/carray-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}