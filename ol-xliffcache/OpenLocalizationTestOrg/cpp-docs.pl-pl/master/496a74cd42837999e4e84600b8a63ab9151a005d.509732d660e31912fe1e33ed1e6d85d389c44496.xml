{"nodes":[{"pos":[12,88],"content":"Walkthrough: Updating the MFC Scribble Application (Part 1) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Walkthrough: Updating the MFC Scribble Application (Part 1) | Microsoft Docs","pos":[0,76]}]},{"content":"Walkthrough: Updating the MFC Scribble Application (Part 1)","pos":[859,918]},{"content":"This walkthrough demonstrates how to modify an existing MFC application to use the Ribbon user interface.","pos":[919,1024]},{"content":"Visual Studio supports both the Office 2007 Ribbon and the Windows 7 Scenic Ribbon.","pos":[1025,1108]},{"content":"For more information about the Ribbon user interface, see <bpt id=\"p1\">[</bpt>Ribbons<ept id=\"p1\">](http://go.microsoft.com/fwlink/linkid=129233)</ept> on the MSDN Web site.","pos":[1109,1244],"source":" For more information about the Ribbon user interface, see [Ribbons](http://go.microsoft.com/fwlink/linkid=129233) on the MSDN Web site."},{"content":"This walkthrough modifies the classic Scribble 1.0 MFC sample that lets you use the mouse to create line drawings.","pos":[1251,1365]},{"content":"This part of the walkthrough shows how to modify the Scribble sample so that it displays a ribbon bar.","pos":[1366,1468]},{"content":"<bpt id=\"p1\">[</bpt>Part 2<ept id=\"p1\">](../mfc/walkthrough-updating-the-mfc-scribble-application-part-2.md)</ept> adds more buttons to the ribbon bar.","pos":[1469,1582],"source":"[Part 2](../mfc/walkthrough-updating-the-mfc-scribble-application-part-2.md) adds more buttons to the ribbon bar."},{"content":"Prerequisites","pos":[1591,1604]},{"content":"Visual C++ Samples","pos":[1609,1627]},{"content":"Visual C++ Samples","pos":[1662,1680]},{"pos":[1736,1744],"content":"Sections"},{"content":"This part of the walkthrough has the following sections:","pos":[1748,1804]},{"content":"Replacing the Base Classes","pos":[1813,1839]},{"content":"Adding Bitmaps to the Project","pos":[1864,1893]},{"content":"Adding a Ribbon Resource to the Project","pos":[1915,1954]},{"content":"Creating an Instance of the Ribbon Bar","pos":[1976,2014]},{"content":"Adding a Ribbon Category","pos":[2041,2065]},{"content":"Setting the Look of the Application","pos":[2089,2124]},{"pos":[2173,2199],"content":"Replacing the Base Classes"},{"content":"To convert an application that supports a menu to an application that supports a ribbon, you must derive the application, frame window, and toolbar classes from updated base classes.","pos":[2203,2385]},{"content":"(We suggest that you do not modify the original Scribble sample; instead, clean the Scribble project, copy it to another directory, and then modify the copy.)","pos":[2386,2544]},{"content":"To replace the base classes in the Scribble application","pos":[2555,2610]},{"pos":[2620,2761],"content":"In scribble.cpp, verify that <ph id=\"ph1\">`CScribbleApp::InitInstance`</ph> includes a call to <bpt id=\"p1\">[</bpt>AfxOleInit<ept id=\"p1\">](../mfc/reference/ole-initialization.md#afxoleinit)</ept>.","source":"In scribble.cpp, verify that `CScribbleApp::InitInstance` includes a call to [AfxOleInit](../mfc/reference/ole-initialization.md#afxoleinit)."},{"content":"Add the following code to the stdafx.h file.","pos":[2771,2815]},{"pos":[2876,3024],"content":"In scribble.h, modify the definition for the <ph id=\"ph1\">`CScribbleApp`</ph> class so that it is derived from <bpt id=\"p1\">[</bpt>CWinAppEx Class<ept id=\"p1\">](../mfc/reference/cwinappex-class.md)</ept>.","source":"In scribble.h, modify the definition for the `CScribbleApp` class so that it is derived from [CWinAppEx Class](../mfc/reference/cwinappex-class.md)."},{"content":"Scribble 1.0 was written when Windows applications used an initialization (.ini) file to save user preference data.","pos":[3094,3209]},{"content":"Instead of an initialization file, modify Scribble to store user preferences in the registry.","pos":[3210,3303]},{"content":"To set the registry key and base, type the following code in <ph id=\"ph1\">`CScribbleApp::InitInstance`</ph> after the <ph id=\"ph2\">`LoadStdProfileSettings()`</ph> statement.","pos":[3304,3441],"source":" To set the registry key and base, type the following code in `CScribbleApp::InitInstance` after the `LoadStdProfileSettings()` statement."},{"content":"The main frame for a multiple document interface (MDI) application is no longer derived from the <ph id=\"ph1\">`CMDIFrameWnd`</ph> class.","pos":[3559,3677],"source":"The main frame for a multiple document interface (MDI) application is no longer derived from the `CMDIFrameWnd` class."},{"content":"Instead, it is derived from the <bpt id=\"p1\">[</bpt>CMDIFrameWndEx<ept id=\"p1\">](../mfc/reference/cmdiframewndex-class.md)</ept> class.","pos":[3678,3775],"source":" Instead, it is derived from the [CMDIFrameWndEx](../mfc/reference/cmdiframewndex-class.md) class."},{"pos":[3786,3889],"content":"In the mainfrm.h and mainfrm.cpp files, replace all references to <ph id=\"ph1\">`CMDIFrameWnd`</ph> with <ph id=\"ph2\">`CMDIFrameWndEx`</ph>.","source":"In the mainfrm.h and mainfrm.cpp files, replace all references to `CMDIFrameWnd` with `CMDIFrameWndEx`."},{"pos":[3899,3986],"content":"In the childfrm.h and childfrm.cpp files, replace <ph id=\"ph1\">`CMDIChildWnd`</ph> with <ph id=\"ph2\">`CMDIChildWndEx`</ph>.","source":"In the childfrm.h and childfrm.cpp files, replace `CMDIChildWnd` with `CMDIChildWndEx`."},{"content":"In the childfrm.","pos":[3997,4013]},{"content":"h file, replace <ph id=\"ph1\">`CSplitterWnd`</ph> with <ph id=\"ph2\">`CSplitterWndEx`</ph>.","pos":[4014,4067],"source":" h file, replace `CSplitterWnd` with `CSplitterWndEx`."},{"content":"Modify toolbars and status bars to use the new MFC classes.","pos":[4077,4136]},{"content":"In the mainfrm.h file:","pos":[4147,4169]},{"pos":[4183,4221],"content":"Replace <ph id=\"ph1\">`CToolBar`</ph> with <ph id=\"ph2\">`CMFCToolBar`</ph>.","source":"Replace `CToolBar` with `CMFCToolBar`."},{"pos":[4235,4277],"content":"Replace <ph id=\"ph1\">`CStatusBar`</ph> with <ph id=\"ph2\">`CMFCStatusBar`</ph>.","source":"Replace `CStatusBar` with `CMFCStatusBar`."},{"content":"In the mainfrm.cpp file:","pos":[4287,4311]},{"pos":[4325,4364],"content":"Replace <ph id=\"ph1\">`m_wndToolBar.SetBarStyle`</ph> with","source":"Replace `m_wndToolBar.SetBarStyle` with "},{"pos":[4406,4445],"content":"Replace <ph id=\"ph1\">`m_wndToolBar.GetBarStyle`</ph> with","source":"Replace `m_wndToolBar.GetBarStyle` with "},{"pos":[4487,4531],"content":"Replace <ph id=\"ph1\">`DockControlBar(&amp;m_wndToolBar)`</ph> with","source":"Replace `DockControlBar(&m_wndToolBar)` with "},{"content":"In the ipframe.cpp file, comment out the following three lines of code.","pos":[4566,4637]},{"content":"If you intend to link your application statically, add the following code to the start of the project resource (.rc) file.","pos":[4798,4920]},{"content":"The afxribbon.rc file contains resources that are required at run time.","pos":[4978,5049]},{"content":"The <bpt id=\"p1\">[</bpt>MFC Application Wizard<ept id=\"p1\">](../mfc/reference/mfc-application-wizard.md)</ept> includes this file automatically when you create an application.","pos":[5050,5187],"source":" The [MFC Application Wizard](../mfc/reference/mfc-application-wizard.md) includes this file automatically when you create an application."},{"content":"Save the changes and then build and run the application.","pos":[5197,5253]},{"pos":[5260,5278],"content":"[<bpt id=\"p1\">[</bpt>Sections<ept id=\"p1\">](#top)</ept>]","source":"[[Sections](#top)]"},{"pos":[5313,5342],"content":"Adding Bitmaps to the Project"},{"content":"The next four steps of this walkthrough require bitmap resources.","pos":[5346,5411]},{"content":"You can obtain appropriate bitmaps in various ways:","pos":[5412,5463]},{"content":"Use the <bpt id=\"p1\">[</bpt>Resource Editors<ept id=\"p1\">](../mfc/resource-editors.md)</ept> to invent your own bitmaps.","pos":[5473,5555],"source":"Use the [Resource Editors](../mfc/resource-editors.md) to invent your own bitmaps."},{"content":"Or use the resource editors to assemble bitmaps from the portable network graphics (.png) images that are included with <ph id=\"ph1\">[!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)]</ph>.","pos":[5556,5736],"source":" Or use the resource editors to assemble bitmaps from the portable network graphics (.png) images that are included with [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)]."},{"content":"These images are in the <ph id=\"ph1\">`VS2008ImageLibrary`</ph> directory.","pos":[5737,5792],"source":" These images are in the `VS2008ImageLibrary` directory."},{"content":"However, the Ribbon user interface requires that certain bitmaps support transparent images.","pos":[5803,5895]},{"content":"Transparent bitmaps use 32-bit pixels, where 24 bits specify the red, green, and blue components of the color, and 8 bits define an <bpt id=\"p1\">*</bpt>alpha channel<ept id=\"p1\">*</ept> that specifies the transparency of the color.","pos":[5896,6089],"source":" Transparent bitmaps use 32-bit pixels, where 24 bits specify the red, green, and blue components of the color, and 8 bits define an *alpha channel* that specifies the transparency of the color."},{"content":"The current resource editors can view, but not modify bitmaps with 32-bit pixels.","pos":[6090,6171]},{"content":"Consequently, use an external image editor instead of the resource editors to manipulate transparent bitmaps.","pos":[6172,6281]},{"content":"Copy an appropriate resource file from another application to your project and then import bitmaps from that file.","pos":[6291,6405]},{"content":"This walkthrough copies resource files from an application in the Samples directory.","pos":[6412,6496]},{"content":"To add bitmaps to the Project","pos":[6507,6536]},{"pos":[6546,6662],"content":"Use File Explorer to copy the following .bmp files from the resources directory (<ph id=\"ph1\">`res`</ph>) of the RibbonGadgets sample:","source":"Use File Explorer to copy the following .bmp files from the resources directory (`res`) of the RibbonGadgets sample:"},{"content":"Copy main.bmp to your Scribble project.","pos":[6676,6715]},{"content":"Copy filesmall.bmp and filelarge.bmp to your Scribble project.","pos":[6729,6791]},{"content":"Make new copies of the filelarge.bmp and filesmall.bmp files, but save the copies in the RibbonGadgets sample.","pos":[6805,6915]},{"content":"Rename the copies homesmall.bmp and homelarge.bmp and then move the copies to your Scribble project.","pos":[6916,7016]},{"content":"Make a copy of the toolbar.bmp file, but save the copy in the RibbonGadgets sample.","pos":[7030,7113]},{"content":"Rename the copy panelicons.bmp and then move the copy to your Scribble project.","pos":[7114,7193]},{"content":"Import the bitmap for an MFC application.","pos":[7203,7244]},{"content":"In <bpt id=\"p1\">**</bpt>Resource View<ept id=\"p1\">**</ept>, double-click the <bpt id=\"p2\">**</bpt>scribble.rc<ept id=\"p2\">**</ept> node, double-click the <bpt id=\"p3\">**</bpt>Bitmap<ept id=\"p3\">**</ept> node, and then click <bpt id=\"p4\">**</bpt>Add resource<ept id=\"p4\">**</ept>.","pos":[7245,7372],"source":" In **Resource View**, double-click the **scribble.rc** node, double-click the **Bitmap** node, and then click **Add resource**."},{"content":"On the dialog box that appears, click <bpt id=\"p1\">**</bpt>Import<ept id=\"p1\">**</ept>.","pos":[7373,7422],"source":" On the dialog box that appears, click **Import**."},{"content":"Browse to the <ph id=\"ph1\">`res`</ph> directory, select the main.bmp file, and then click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>.","pos":[7423,7504],"source":" Browse to the `res` directory, select the main.bmp file, and then click **Open**."},{"content":"The main.bmp bitmap contains a 26x26 image.","pos":[7515,7558]},{"content":"Change the ID of the bitmap to IDB_RIBBON_MAIN.","pos":[7559,7606]},{"content":"Import the bitmaps for the file menu that is attached to the Application button.","pos":[7616,7696]},{"content":"Import the filesmall.bmp file, which contains ten 16x16 (16x160) images.","pos":[7710,7782]},{"content":"Because we need only eight 16x16 images (16x128),  use the <bpt id=\"p1\">**</bpt>Resource View<ept id=\"p1\">**</ept> to change the width of that bitmap from 160 to 128.","pos":[7783,7911],"source":" Because we need only eight 16x16 images (16x128),  use the **Resource View** to change the width of that bitmap from 160 to 128."},{"content":"Change the ID of the bitmap to IDB_RIBBON_FILESMALL.","pos":[7912,7964]},{"content":"Import the filelarge.bmp, which contains eight 32x32 (32x256) images.","pos":[7978,8047]},{"content":"Change the ID of the bitmap to IDB_RIBBON_FILELARGE.","pos":[8048,8100]},{"content":"Import the bitmaps for the ribbon categories and panels.","pos":[8110,8166]},{"content":"Each tab on the ribbon bar is a category, and consists of a text label and an optional image.","pos":[8167,8260]},{"content":"Import the homesmall.bmp bitmap, which contains eight 16x16 images for small button bitmaps.","pos":[8274,8366]},{"content":"Change the ID of the bitmap to IDB_RIBBON_HOMESMALL.","pos":[8367,8419]},{"content":"Import the homelarge.bmp bitmap, which contains eight 32x32 images for large button bitmaps.","pos":[8433,8525]},{"content":"Change the ID of the bitmap to IDB_RIBBON_HOMELARGE.","pos":[8526,8578]},{"content":"Import bitmaps for the resized ribbon panels.","pos":[8588,8633]},{"content":"These bitmaps, or panel icons, are used after a resize operation if the ribbon is too small to display the entire panel.","pos":[8634,8754]},{"content":"Import the panelicons.bmp bitmap, which contains eight 16x16 images.","pos":[8768,8836]},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window of the <bpt id=\"p2\">**</bpt>Bitmap Editor<ept id=\"p2\">**</ept>, adjust the width of the bitmap to 64 (16x64).","pos":[8837,8937],"source":" In the **Properties** window of the **Bitmap Editor**, adjust the width of the bitmap to 64 (16x64)."},{"content":"Change the ID of the bitmap to IDB_PANEL_ICONS.","pos":[8938,8985]},{"pos":[8992,9010],"content":"[<bpt id=\"p1\">[</bpt>Sections<ept id=\"p1\">](#top)</ept>]","source":"[[Sections](#top)]"},{"pos":[9045,9084],"content":"Adding a Ribbon Resource to the Project"},{"content":"When you convert an application that uses menus to an application that uses a ribbon, you do not have to remove or disable the existing menus.","pos":[9088,9230]},{"content":"Instead, you create a ribbon resource, add ribbon buttons, and then associate the new buttons with the existing menu items.","pos":[9231,9354]},{"content":"Although the menus are no longer visible, messages from the ribbon bar are routed through the menus.","pos":[9355,9455]},{"content":"In addition, menu shortcuts continue to work.","pos":[9456,9501]},{"content":"A ribbon consists of the Application button, which is the large button on the upper-left side of the ribbon, and one or more category tabs.","pos":[9508,9647]},{"content":"Each category tab contains one or more panels that act as containers for ribbon buttons and controls.","pos":[9648,9749]},{"content":"The following procedure shows how to create a ribbon resource and then customize the Application button.","pos":[9750,9854]},{"content":"To add a ribbon resource to the project","pos":[9865,9904]},{"pos":[9914,9962],"content":"On the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Add Resource<ept id=\"p2\">**</ept>.","source":"On the **Project** menu, click **Add Resource**."},{"pos":[9972,10049],"content":"In the <bpt id=\"p1\">**</bpt>Add Resource<ept id=\"p1\">**</ept> dialog box, select <bpt id=\"p2\">**</bpt>Ribbon<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>New<ept id=\"p3\">**</ept>.","source":"In the **Add Resource** dialog box, select **Ribbon** and then click **New**."},{"content":"Visual Studio creates a ribbon resource and opens it in the design view.","pos":[10060,10132]},{"content":"The ribbon resource ID is IDR_RIBBON1, which is displayed in <bpt id=\"p1\">**</bpt>Resource View<ept id=\"p1\">**</ept>.","pos":[10133,10212],"source":" The ribbon resource ID is IDR_RIBBON1, which is displayed in **Resource View**."},{"content":"The ribbon contains one category and one panel.","pos":[10213,10260]},{"content":"You can customize the Application button by modifying its properties.","pos":[10270,10339]},{"content":"The message IDs that are used in this code are already defined in the menu for Scribble 1.0.","pos":[10340,10432]},{"content":"In the design view, click the Application Button to display its properties.","pos":[10442,10517]},{"content":"Change property values as follows: <bpt id=\"p1\">**</bpt>Image<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`IDB_RIBBON_MAIN`</ph>, <bpt id=\"p2\">**</bpt>Prompt<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`File`</ph>, <bpt id=\"p3\">**</bpt>Keys<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`f`</ph>, <bpt id=\"p4\">**</bpt>Large Images<ept id=\"p4\">**</ept> to <ph id=\"ph4\">`IDB_RIBBON_FILELARGE`</ph>, and <bpt id=\"p5\">**</bpt>Small Images<ept id=\"p5\">**</ept> to <ph id=\"ph5\">`IDB_RIBBON_FILESMALL`</ph>.","pos":[10518,10715],"source":" Change property values as follows: **Image** to `IDB_RIBBON_MAIN`, **Prompt** to `File`, **Keys** to `f`, **Large Images** to `IDB_RIBBON_FILELARGE`, and **Small Images** to `IDB_RIBBON_FILESMALL`."},{"content":"The following modifications create the menu that appears when the user clicks the Application button.","pos":[10725,10826]},{"content":"Click the ellipsis (<bpt id=\"p1\">**</bpt>...<ept id=\"p1\">**</ept>) next to <bpt id=\"p2\">**</bpt>Main Items<ept id=\"p2\">**</ept> to open the <bpt id=\"p3\">**</bpt>Items Editor<ept id=\"p3\">**</ept>.","pos":[10827,10908],"source":" Click the ellipsis (**...**) next to **Main Items** to open the **Items Editor**."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> to add a button.","pos":[10922,10952],"source":"Click **Add** to add a button."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`&amp;New`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_FILE_NEW`</ph>, <bpt id=\"p3\">**</bpt>Image<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`0`</ph>, <bpt id=\"p4\">**</bpt>Image Large<ept id=\"p4\">**</ept> to <ph id=\"ph4\">`0`</ph>.","pos":[10953,11049],"source":" Change **Caption** to `&New`, **ID** to `ID_FILE_NEW`, **Image** to `0`, **Image Large** to `0`."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> to add a second button.","pos":[11063,11100],"source":"Click **Add** to add a second button."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`&amp;Save`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_FILE_SAVE`</ph>, <bpt id=\"p3\">**</bpt>Image<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`2`</ph>, and <bpt id=\"p4\">**</bpt>Image Large<ept id=\"p4\">**</ept> to <ph id=\"ph4\">`2`</ph>.","pos":[11101,11203],"source":" Change **Caption** to `&Save`, **ID** to `ID_FILE_SAVE`, **Image** to `2`, and **Image Large** to `2`."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> to add a third button.","pos":[11217,11253],"source":"Click **Add** to add a third button."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`Save &amp;As`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_FILE_SAVE_AS`</ph>, <bpt id=\"p3\">**</bpt>Image<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`3`</ph>, and <bpt id=\"p4\">**</bpt>Image Large<ept id=\"p4\">**</ept> to <ph id=\"ph4\">`3`</ph>.","pos":[11254,11362],"source":" Change **Caption** to `Save &As`, **ID** to `ID_FILE_SAVE_AS`, **Image** to `3`, and **Image Large** to `3`."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> to add a fourth  button.","pos":[11376,11414],"source":"Click **Add** to add a fourth  button."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`&amp;Print`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_FILE_PRINT`</ph>, <bpt id=\"p3\">**</bpt>Image<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`4`</ph>, and <bpt id=\"p4\">**</bpt>Image Large<ept id=\"p4\">**</ept> to <ph id=\"ph4\">`4`</ph>.","pos":[11415,11519],"source":" Change **Caption** to `&Print`, **ID** to `ID_FILE_PRINT`, **Image** to `4`, and **Image Large** to `4`."},{"pos":[11533,11598],"content":"Change the <bpt id=\"p1\">**</bpt>Item<ept id=\"p1\">**</ept> type to <bpt id=\"p2\">**</bpt>Separator<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>.","source":"Change the **Item** type to **Separator** and then click **Add**."},{"content":"Change the <bpt id=\"p1\">**</bpt>Item<ept id=\"p1\">**</ept> type to <bpt id=\"p2\">**</bpt>Button<ept id=\"p2\">**</ept>.","pos":[11612,11651],"source":"Change the **Item** type to **Button**."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> to add a fifth button.","pos":[11652,11688],"source":" Click **Add** to add a fifth button."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`&amp;Close`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_FILE_CLOSE`</ph>, <bpt id=\"p3\">**</bpt>Image<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`5`</ph>, and <bpt id=\"p4\">**</bpt>Image Large<ept id=\"p4\">**</ept> to <ph id=\"ph4\">`5`</ph>.","pos":[11689,11793],"source":" Change **Caption** to `&Close`, **ID** to `ID_FILE_CLOSE`, **Image** to `5`, and **Image Large** to `5`."},{"content":"The following modifications create a submenu under the Print button that you created in the previous step.","pos":[11803,11909]},{"content":"Click the <bpt id=\"p1\">**</bpt>Print<ept id=\"p1\">**</ept> button, change the <bpt id=\"p2\">**</bpt>Item<ept id=\"p2\">**</ept> type to <bpt id=\"p3\">**</bpt>Label<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>Insert<ept id=\"p4\">**</ept>.","pos":[11923,12016],"source":"Click the **Print** button, change the **Item** type to **Label**, and then click **Insert**."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`Preview and print the document`</ph>.","pos":[12017,12072],"source":" Change **Caption** to `Preview and print the document`."},{"content":"Click the <bpt id=\"p1\">**</bpt>Print<ept id=\"p1\">**</ept> button, change the <bpt id=\"p2\">**</bpt>Item<ept id=\"p2\">**</ept> type to <bpt id=\"p3\">**</bpt>Button<ept id=\"p3\">**</ept>, and click <bpt id=\"p4\">**</bpt>Insert<ept id=\"p4\">**</ept>.","pos":[12086,12175],"source":"Click the **Print** button, change the **Item** type to **Button**, and click **Insert**."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`&amp;Print`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_FILE_PRINT`</ph>, <bpt id=\"p3\">**</bpt>Image<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`4`</ph>, and <bpt id=\"p4\">**</bpt>Image Large<ept id=\"p4\">**</ept> to <ph id=\"ph4\">`4`</ph>.","pos":[12176,12280],"source":" Change **Caption** to `&Print`, **ID** to `ID_FILE_PRINT`, **Image** to `4`, and **Image Large** to `4`."},{"content":"Click the <bpt id=\"p1\">**</bpt>Print<ept id=\"p1\">**</ept> button and then click <bpt id=\"p2\">**</bpt>Insert<ept id=\"p2\">**</ept> to add a button.","pos":[12294,12363],"source":"Click the **Print** button and then click **Insert** to add a button."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`&amp;Quick Print`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_FILE_PRINT_DIRECT`</ph>, <bpt id=\"p3\">**</bpt>Image<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`7`</ph>, and <bpt id=\"p4\">**</bpt>Image Large<ept id=\"p4\">**</ept> to <ph id=\"ph4\">`7`</ph>.","pos":[12364,12481],"source":" Change **Caption** to `&Quick Print`, **ID** to `ID_FILE_PRINT_DIRECT`, **Image** to `7`, and **Image Large** to `7`."},{"content":"Click the <bpt id=\"p1\">**</bpt>Print<ept id=\"p1\">**</ept> button and then click <bpt id=\"p2\">**</bpt>Insert<ept id=\"p2\">**</ept> to add another button.","pos":[12495,12570],"source":"Click the **Print** button and then click **Insert** to add another button."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`Print Pre&amp;view`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_FILE_PRINT_PREVIEW`</ph>, <bpt id=\"p3\">**</bpt>Image<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`6`</ph>, and <bpt id=\"p4\">**</bpt>Image Large<ept id=\"p4\">**</ept> to<ph id=\"ph4\">`6`</ph>.","pos":[12571,12690],"source":" Change **Caption** to `Print Pre&view`, **ID** to `ID_FILE_PRINT_PREVIEW`, **Image** to `6`, and **Image Large** to`6`."},{"content":"You have now modified the <bpt id=\"p1\">**</bpt>Main Items<ept id=\"p1\">**</ept>.","pos":[12704,12745],"source":"You have now modified the **Main Items**."},{"content":"Click <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> to exit the <bpt id=\"p2\">**</bpt>Items Editor<ept id=\"p2\">**</ept>.","pos":[12746,12791],"source":" Click **Close** to exit the **Items Editor**."},{"content":"The following modification creates an exit button that appears at the bottom of the Application button menu.","pos":[12801,12909]},{"pos":[12923,13030],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, click the ellipsis (<bpt id=\"p2\">**</bpt>...<ept id=\"p2\">**</ept>) next to <bpt id=\"p3\">**</bpt>Button<ept id=\"p3\">**</ept> to open the <bpt id=\"p4\">**</bpt>Items Editor<ept id=\"p4\">**</ept>.","source":"In the **Properties** window, click the ellipsis (**...**) next to **Button** to open the **Items Editor**."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> to add a button.","pos":[13044,13074],"source":"Click **Add** to add a button."},{"content":"Change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`E&amp;xit`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_APP_EXIT`</ph>, <bpt id=\"p3\">**</bpt>Image<ept id=\"p3\">**</ept> to<ph id=\"ph3\">`8`</ph>.","pos":[13075,13147],"source":" Change **Caption** to `E&xit`, **ID** to `ID_APP_EXIT`, **Image** to`8`."},{"pos":[13154,13172],"content":"[<bpt id=\"p1\">[</bpt>Sections<ept id=\"p1\">](#top)</ept>]","source":"[[Sections](#top)]"},{"pos":[13212,13250],"content":"Creating an Instance of the Ribbon Bar"},{"content":"The following steps show how to create an instance of the ribbon bar when your application starts.","pos":[13254,13352]},{"content":"To add a ribbon bar to an application, declare the ribbon bar in the mainfrm.h file.","pos":[13353,13437]},{"content":"Then, in the mainfrm.cpp file, write code to load the ribbon resource.","pos":[13438,13508]},{"content":"To create an instance of the ribbon bar","pos":[13519,13558]},{"content":"In the mainfrm.h file, add a data member to the protected section of <ph id=\"ph1\">`CMainFrame`</ph>, the class definition for the main frame.","pos":[13568,13691],"source":"In the mainfrm.h file, add a data member to the protected section of `CMainFrame`, the class definition for the main frame."},{"content":"This member represents the ribbon bar.","pos":[13692,13730]},{"pos":[13737,13811],"content":"``` *// Ribbon bar for the application  \nCMFCRibbonBar m_wndRibbonBar;","leadings":["","    "],"nodes":[{"content":"``` *// Ribbon bar for the application","pos":[0,38]},{"content":"CMFCRibbonBar m_wndRibbonBar;","pos":[41,70]}]},{"pos":[14206,14224],"content":"[<bpt id=\"p1\">[</bpt>Sections<ept id=\"p1\">](#top)</ept>]","source":"[[Sections](#top)]"},{"pos":[14261,14292],"content":"Customizing the Ribbon Resource"},{"content":"Now that you have created the Application button, you can add elements to the ribbon.","pos":[14296,14381]},{"pos":[14389,14527],"content":"[!NOTE]\n This walkthrough uses the same panel icon for all panels. However, you can use other image list indexes to display other icons.","leadings":["","> "],"nodes":[{"content":" This walkthrough uses the same panel icon for all panels. However, you can use other image list indexes to display other icons.","pos":[8,136],"nodes":[{"content":"This walkthrough uses the same panel icon for all panels.","pos":[1,58]},{"content":"However, you can use other image list indexes to display other icons.","pos":[59,128]}]}]},{"content":"To add a Home category and Edit panel","pos":[14538,14575]},{"content":"The Scribble program requires only one category.","pos":[14585,14633]},{"content":"In the design view, click <bpt id=\"p1\">**</bpt>Category<ept id=\"p1\">**</ept> to display its properties.","pos":[14634,14699],"source":" In the design view, click **Category** to display its properties."},{"content":"Change property values as follows: <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`&amp;Home`</ph>, <bpt id=\"p2\">**</bpt>Large Images<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`IDB_RIBBON_HOMELARGE`</ph>, <bpt id=\"p3\">**</bpt>Small Images<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`IDB_RIBBON_HOMESMALL`</ph>.","pos":[14700,14846],"source":" Change property values as follows: **Caption** to `&Home`, **Large Images** to `IDB_RIBBON_HOMELARGE`, **Small Images** to `IDB_RIBBON_HOMESMALL`."},{"content":"Each ribbon category is organized into named panels.","pos":[14856,14908]},{"content":"Each panel contains a set of controls that perform related operations.","pos":[14909,14979]},{"content":"This category has one panel.","pos":[14980,15008]},{"content":"Click <bpt id=\"p1\">**</bpt>Panel<ept id=\"p1\">**</ept>, and then change <bpt id=\"p2\">**</bpt>Caption<ept id=\"p2\">**</ept> to <ph id=\"ph1\">`Edit`</ph> and <bpt id=\"p3\">**</bpt>Image Index<ept id=\"p3\">**</ept> to <ph id=\"ph2\">`0`</ph>.","pos":[15009,15091],"source":" Click **Panel**, and then change **Caption** to `Edit` and **Image Index** to `0`."},{"content":"To the <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept> panel, add a button that is responsible for clearing the contents of the document.","pos":[15101,15199],"source":"To the **Edit** panel, add a button that is responsible for clearing the contents of the document."},{"content":"The message ID for this button has already been defined in the IDR_SCRIBBTYPE menu resource.","pos":[15200,15292]},{"content":"Specify <ph id=\"ph1\">`Clear All`</ph> as the button text and the index of the bitmap that decorates the button.","pos":[15293,15386],"source":" Specify `Clear All` as the button text and the index of the bitmap that decorates the button."},{"content":"Open the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, and then drag a <bpt id=\"p2\">**</bpt>Button<ept id=\"p2\">**</ept> to the <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> panel.","pos":[15387,15458],"source":" Open the **Toolbox**, and then drag a **Button** to the **Edit** panel."},{"content":"Click the button  and then change <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`Clear All`</ph>, <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> to <ph id=\"ph2\">`ID_EDIT_CLEAR_ALL`</ph>, <bpt id=\"p3\">**</bpt>Image Index<ept id=\"p3\">**</ept> to <ph id=\"ph3\">`0`</ph>, <bpt id=\"p4\">**</bpt>Large Image Index<ept id=\"p4\">**</ept> to <ph id=\"ph4\">`0`</ph>.","pos":[15459,15605],"source":" Click the button  and then change **Caption** to `Clear All`, **ID** to `ID_EDIT_CLEAR_ALL`, **Image Index** to `0`, **Large Image Index** to `0`."},{"content":"Save the changes, and then build and run the application.","pos":[15615,15672]},{"content":"The Scribble application should be displayed, and it should have a ribbon bar at the top of the window instead of a menu bar.","pos":[15673,15798]},{"content":"The ribbon bar should have one category, <bpt id=\"p1\">**</bpt>Home<ept id=\"p1\">**</ept>, and <bpt id=\"p2\">**</bpt>Home<ept id=\"p2\">**</ept> should have one panel, <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept>.","pos":[15799,15895],"source":" The ribbon bar should have one category, **Home**, and **Home** should have one panel, **Edit**."},{"content":"The ribbon buttons that you added should be associated with the existing event handlers, and the <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Save<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Print<ept id=\"p4\">**</ept>, and <bpt id=\"p5\">**</bpt>Clear All<ept id=\"p5\">**</ept> buttons should work as expected.","pos":[15896,16085],"source":" The ribbon buttons that you added should be associated with the existing event handlers, and the **Open**, **Close**, **Save**, **Print**, and **Clear All** buttons should work as expected."},{"pos":[16092,16110],"content":"[<bpt id=\"p1\">[</bpt>Sections<ept id=\"p1\">](#top)</ept>]","source":"[[Sections](#top)]"},{"pos":[16143,16178],"content":"Setting the Look of the Application"},{"content":"A <bpt id=\"p1\">*</bpt>visual manager<ept id=\"p1\">*</ept> is a global object that controls all drawing for an application.","pos":[16182,16265],"source":"A *visual manager* is a global object that controls all drawing for an application."},{"content":"Because the original Scribble application uses the Office 2000 user interface (UI) style, the application may look old-fashioned.","pos":[16266,16395]},{"content":"You can reset the application to use the Office 2007 visual manager so that it resembles an Office 2007 application.","pos":[16396,16512]},{"content":"To set the look of the application","pos":[16523,16557]},{"pos":[16567,16678],"content":"In the <ph id=\"ph1\">`CMainFrame::OnCreate`</ph> function, type the following code to change the default visual manager and style.","source":"In the `CMainFrame::OnCreate` function, type the following code to change the default visual manager and style."},{"pos":[16685,16820],"content":"``` *// Set the default manager to Office 2007   \nCMFCVisualManager::SetDefaultManager(RUNTIME_CLASS(CMFCVisualManagerOffice2007));","leadings":["","    "],"nodes":[{"content":"``` *// Set the default manager to Office 2007","pos":[0,46]},{"content":"CMFCVisualManager::SetDefaultManager(RUNTIME_CLASS(CMFCVisualManagerOffice2007));","pos":[50,131]}]},{"content":"CMFCVisualManagerOffice2007::SetStyle(CMFCVisualManagerOffice2007::Office2007_LunaBlue);","pos":[16823,16911]}],"content":"---\ntitle: \"Walkthrough: Updating the MFC Scribble Application (Part 1) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"examples [C++], update existing application\"\n  - \"ribbon UI, porting to\"\n  - \"Office Fluent UI, porting to\"\n  - \"samples [C++], update existing application\"\n  - \"MFC Feature Pack, update existing application\"\n  - \"walkthroughs [C++], update existing application\"\nms.assetid: aa6330d3-6cfc-4c79-8fcb-0282263025f7\ncaps.latest.revision: 54\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Walkthrough: Updating the MFC Scribble Application (Part 1)\nThis walkthrough demonstrates how to modify an existing MFC application to use the Ribbon user interface. Visual Studio supports both the Office 2007 Ribbon and the Windows 7 Scenic Ribbon. For more information about the Ribbon user interface, see [Ribbons](http://go.microsoft.com/fwlink/linkid=129233) on the MSDN Web site.  \n  \n This walkthrough modifies the classic Scribble 1.0 MFC sample that lets you use the mouse to create line drawings. This part of the walkthrough shows how to modify the Scribble sample so that it displays a ribbon bar. [Part 2](../mfc/walkthrough-updating-the-mfc-scribble-application-part-2.md) adds more buttons to the ribbon bar.  \n  \n## Prerequisites  \n [Visual C++ Samples](../visual-cpp-samples.md)  \n  \n [Visual C++ Samples](../visual-cpp-samples.md)  \n  \n##  <a name=\"top\"></a> Sections  \n This part of the walkthrough has the following sections:  \n  \n- [Replacing the Base Classes](#replaceclass)  \n  \n- [Adding Bitmaps to the Project](#addbitmap)  \n  \n- [Adding a Ribbon Resource to the Project](#addribbon)  \n  \n- [Creating an Instance of the Ribbon Bar](#createinstance)  \n  \n- [Adding a Ribbon Category](#addcategory)  \n  \n- [Setting the Look of the Application](#setlook)  \n  \n##  <a name=\"replaceclass\"></a> Replacing the Base Classes  \n To convert an application that supports a menu to an application that supports a ribbon, you must derive the application, frame window, and toolbar classes from updated base classes. (We suggest that you do not modify the original Scribble sample; instead, clean the Scribble project, copy it to another directory, and then modify the copy.)  \n  \n#### To replace the base classes in the Scribble application  \n  \n1.  In scribble.cpp, verify that `CScribbleApp::InitInstance` includes a call to [AfxOleInit](../mfc/reference/ole-initialization.md#afxoleinit).  \n  \n2.  Add the following code to the stdafx.h file.  \n  \n ```  \n    #include <afxcontrolbars.h>  \n ```  \n  \n3.  In scribble.h, modify the definition for the `CScribbleApp` class so that it is derived from [CWinAppEx Class](../mfc/reference/cwinappex-class.md).  \n  \n ```  \n    class CScribbleApp: public CWinAppEx  \n ```  \n  \n4.  Scribble 1.0 was written when Windows applications used an initialization (.ini) file to save user preference data. Instead of an initialization file, modify Scribble to store user preferences in the registry. To set the registry key and base, type the following code in `CScribbleApp::InitInstance` after the `LoadStdProfileSettings()` statement.  \n  \n ```  \n    SetRegistryKey(_T(\"MFCNext\\\\Samples\\\\Scribble2\"));\n\n SetRegistryBase(_T(\"Settings\"));\n\n ```  \n  \n5.  The main frame for a multiple document interface (MDI) application is no longer derived from the `CMDIFrameWnd` class. Instead, it is derived from the [CMDIFrameWndEx](../mfc/reference/cmdiframewndex-class.md) class.  \n  \n     In the mainfrm.h and mainfrm.cpp files, replace all references to `CMDIFrameWnd` with `CMDIFrameWndEx`.  \n  \n6.  In the childfrm.h and childfrm.cpp files, replace `CMDIChildWnd` with `CMDIChildWndEx`.  \n  \n     In the childfrm. h file, replace `CSplitterWnd` with `CSplitterWndEx`.  \n  \n7.  Modify toolbars and status bars to use the new MFC classes.  \n  \n     In the mainfrm.h file:  \n  \n    1.  Replace `CToolBar` with `CMFCToolBar`.  \n  \n    2.  Replace `CStatusBar` with `CMFCStatusBar`.  \n  \n8.  In the mainfrm.cpp file:  \n  \n    1.  Replace `m_wndToolBar.SetBarStyle` with `m_wndToolBar.SetPaneStyle`  \n  \n    2.  Replace `m_wndToolBar.GetBarStyle` with `m_wndToolBar.GetPaneStyle`  \n  \n    3.  Replace `DockControlBar(&m_wndToolBar)` with `DockPane(&m_wndToolBar)`  \n  \n9. In the ipframe.cpp file, comment out the following three lines of code.  \n  \n ```  \n    m_wndToolBar.EnableDocking(CBRS_ALIGN_ANY);\n\n pWndFrame->EnableDocking(CBRS_ALIGN_ANY);\n\n    pWndFrame->DockPane(&m_wndToolBar);\n\n ```  \n  \n10. If you intend to link your application statically, add the following code to the start of the project resource (.rc) file.  \n  \n ```  \n    #include \"afxribbon.rc\"  \n ```  \n  \n     The afxribbon.rc file contains resources that are required at run time. The [MFC Application Wizard](../mfc/reference/mfc-application-wizard.md) includes this file automatically when you create an application.  \n  \n11. Save the changes and then build and run the application.  \n  \n [[Sections](#top)]  \n  \n##  <a name=\"addbitmap\"></a> Adding Bitmaps to the Project  \n The next four steps of this walkthrough require bitmap resources. You can obtain appropriate bitmaps in various ways:  \n  \n-   Use the [Resource Editors](../mfc/resource-editors.md) to invent your own bitmaps. Or use the resource editors to assemble bitmaps from the portable network graphics (.png) images that are included with [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)]. These images are in the `VS2008ImageLibrary` directory.  \n  \n     However, the Ribbon user interface requires that certain bitmaps support transparent images. Transparent bitmaps use 32-bit pixels, where 24 bits specify the red, green, and blue components of the color, and 8 bits define an *alpha channel* that specifies the transparency of the color. The current resource editors can view, but not modify bitmaps with 32-bit pixels. Consequently, use an external image editor instead of the resource editors to manipulate transparent bitmaps.  \n  \n-   Copy an appropriate resource file from another application to your project and then import bitmaps from that file.  \n  \n This walkthrough copies resource files from an application in the Samples directory.  \n  \n#### To add bitmaps to the Project  \n  \n1.  Use File Explorer to copy the following .bmp files from the resources directory (`res`) of the RibbonGadgets sample:  \n  \n    1.  Copy main.bmp to your Scribble project.  \n  \n    2.  Copy filesmall.bmp and filelarge.bmp to your Scribble project.  \n  \n    3.  Make new copies of the filelarge.bmp and filesmall.bmp files, but save the copies in the RibbonGadgets sample. Rename the copies homesmall.bmp and homelarge.bmp and then move the copies to your Scribble project.  \n  \n    4.  Make a copy of the toolbar.bmp file, but save the copy in the RibbonGadgets sample. Rename the copy panelicons.bmp and then move the copy to your Scribble project.  \n  \n2.  Import the bitmap for an MFC application. In **Resource View**, double-click the **scribble.rc** node, double-click the **Bitmap** node, and then click **Add resource**. On the dialog box that appears, click **Import**. Browse to the `res` directory, select the main.bmp file, and then click **Open**.  \n  \n     The main.bmp bitmap contains a 26x26 image. Change the ID of the bitmap to IDB_RIBBON_MAIN.  \n  \n3.  Import the bitmaps for the file menu that is attached to the Application button.  \n  \n    1.  Import the filesmall.bmp file, which contains ten 16x16 (16x160) images. Because we need only eight 16x16 images (16x128),  use the **Resource View** to change the width of that bitmap from 160 to 128. Change the ID of the bitmap to IDB_RIBBON_FILESMALL.  \n  \n    2.  Import the filelarge.bmp, which contains eight 32x32 (32x256) images. Change the ID of the bitmap to IDB_RIBBON_FILELARGE.  \n  \n4.  Import the bitmaps for the ribbon categories and panels. Each tab on the ribbon bar is a category, and consists of a text label and an optional image.  \n  \n    1.  Import the homesmall.bmp bitmap, which contains eight 16x16 images for small button bitmaps. Change the ID of the bitmap to IDB_RIBBON_HOMESMALL.  \n  \n    2.  Import the homelarge.bmp bitmap, which contains eight 32x32 images for large button bitmaps. Change the ID of the bitmap to IDB_RIBBON_HOMELARGE.  \n  \n5.  Import bitmaps for the resized ribbon panels. These bitmaps, or panel icons, are used after a resize operation if the ribbon is too small to display the entire panel.  \n  \n    1.  Import the panelicons.bmp bitmap, which contains eight 16x16 images. In the **Properties** window of the **Bitmap Editor**, adjust the width of the bitmap to 64 (16x64). Change the ID of the bitmap to IDB_PANEL_ICONS.  \n  \n [[Sections](#top)]  \n  \n##  <a name=\"addribbon\"></a> Adding a Ribbon Resource to the Project  \n When you convert an application that uses menus to an application that uses a ribbon, you do not have to remove or disable the existing menus. Instead, you create a ribbon resource, add ribbon buttons, and then associate the new buttons with the existing menu items. Although the menus are no longer visible, messages from the ribbon bar are routed through the menus. In addition, menu shortcuts continue to work.  \n  \n A ribbon consists of the Application button, which is the large button on the upper-left side of the ribbon, and one or more category tabs. Each category tab contains one or more panels that act as containers for ribbon buttons and controls. The following procedure shows how to create a ribbon resource and then customize the Application button.  \n  \n#### To add a ribbon resource to the project  \n  \n1.  On the **Project** menu, click **Add Resource**.  \n  \n2.  In the **Add Resource** dialog box, select **Ribbon** and then click **New**.  \n  \n     Visual Studio creates a ribbon resource and opens it in the design view. The ribbon resource ID is IDR_RIBBON1, which is displayed in **Resource View**. The ribbon contains one category and one panel.  \n  \n3.  You can customize the Application button by modifying its properties. The message IDs that are used in this code are already defined in the menu for Scribble 1.0.  \n  \n4.  In the design view, click the Application Button to display its properties. Change property values as follows: **Image** to `IDB_RIBBON_MAIN`, **Prompt** to `File`, **Keys** to `f`, **Large Images** to `IDB_RIBBON_FILELARGE`, and **Small Images** to `IDB_RIBBON_FILESMALL`.  \n  \n5.  The following modifications create the menu that appears when the user clicks the Application button. Click the ellipsis (**...**) next to **Main Items** to open the **Items Editor**.  \n  \n    1.  Click **Add** to add a button. Change **Caption** to `&New`, **ID** to `ID_FILE_NEW`, **Image** to `0`, **Image Large** to `0`.  \n  \n    2.  Click **Add** to add a second button. Change **Caption** to `&Save`, **ID** to `ID_FILE_SAVE`, **Image** to `2`, and **Image Large** to `2`.  \n  \n    3.  Click **Add** to add a third button. Change **Caption** to `Save &As`, **ID** to `ID_FILE_SAVE_AS`, **Image** to `3`, and **Image Large** to `3`.  \n  \n    4.  Click **Add** to add a fourth  button. Change **Caption** to `&Print`, **ID** to `ID_FILE_PRINT`, **Image** to `4`, and **Image Large** to `4`.  \n  \n    5.  Change the **Item** type to **Separator** and then click **Add**.  \n  \n    6.  Change the **Item** type to **Button**. Click **Add** to add a fifth button. Change **Caption** to `&Close`, **ID** to `ID_FILE_CLOSE`, **Image** to `5`, and **Image Large** to `5`.  \n  \n6.  The following modifications create a submenu under the Print button that you created in the previous step.  \n  \n    1.  Click the **Print** button, change the **Item** type to **Label**, and then click **Insert**. Change **Caption** to `Preview and print the document`.  \n  \n    2.  Click the **Print** button, change the **Item** type to **Button**, and click **Insert**. Change **Caption** to `&Print`, **ID** to `ID_FILE_PRINT`, **Image** to `4`, and **Image Large** to `4`.  \n  \n    3.  Click the **Print** button and then click **Insert** to add a button. Change **Caption** to `&Quick Print`, **ID** to `ID_FILE_PRINT_DIRECT`, **Image** to `7`, and **Image Large** to `7`.  \n  \n    4.  Click the **Print** button and then click **Insert** to add another button. Change **Caption** to `Print Pre&view`, **ID** to `ID_FILE_PRINT_PREVIEW`, **Image** to `6`, and **Image Large** to`6`.  \n  \n    5.  You have now modified the **Main Items**. Click **Close** to exit the **Items Editor**.  \n  \n7.  The following modification creates an exit button that appears at the bottom of the Application button menu.  \n  \n    1.  In the **Properties** window, click the ellipsis (**...**) next to **Button** to open the **Items Editor**.  \n  \n    2.  Click **Add** to add a button. Change **Caption** to `E&xit`, **ID** to `ID_APP_EXIT`, **Image** to`8`.  \n  \n [[Sections](#top)]  \n  \n##  <a name=\"createinstance\"></a> Creating an Instance of the Ribbon Bar  \n The following steps show how to create an instance of the ribbon bar when your application starts. To add a ribbon bar to an application, declare the ribbon bar in the mainfrm.h file. Then, in the mainfrm.cpp file, write code to load the ribbon resource.  \n  \n#### To create an instance of the ribbon bar  \n  \n1.  In the mainfrm.h file, add a data member to the protected section of `CMainFrame`, the class definition for the main frame. This member represents the ribbon bar.  \n  \n ``` *// Ribbon bar for the application  \n    CMFCRibbonBar m_wndRibbonBar;  \n ```  \n  \n2.  In the mainfrm.cpp file, add the following code before the final `return` statement at the end of the `CMainFrame::OnCreate` function. This creates an instance of the ribbon bar.  \n  \n ``` *// Create the ribbon bar  \n    if (!m_wndRibbonBar.Create(this))  \n {  \n    return -1;   //Failed to create ribbon bar  \n }  \n    m_wndRibbonBar.LoadFromResource(IDR_RIBBON1);\n\n ```  \n  \n [[Sections](#top)]  \n  \n##  <a name=\"addcategory\"></a> Customizing the Ribbon Resource  \n Now that you have created the Application button, you can add elements to the ribbon.  \n  \n> [!NOTE]\n>  This walkthrough uses the same panel icon for all panels. However, you can use other image list indexes to display other icons.  \n  \n#### To add a Home category and Edit panel  \n  \n1.  The Scribble program requires only one category. In the design view, click **Category** to display its properties. Change property values as follows: **Caption** to `&Home`, **Large Images** to `IDB_RIBBON_HOMELARGE`, **Small Images** to `IDB_RIBBON_HOMESMALL`.  \n  \n2.  Each ribbon category is organized into named panels. Each panel contains a set of controls that perform related operations. This category has one panel. Click **Panel**, and then change **Caption** to `Edit` and **Image Index** to `0`.  \n  \n3.  To the **Edit** panel, add a button that is responsible for clearing the contents of the document. The message ID for this button has already been defined in the IDR_SCRIBBTYPE menu resource. Specify `Clear All` as the button text and the index of the bitmap that decorates the button. Open the **Toolbox**, and then drag a **Button** to the **Edit** panel. Click the button  and then change **Caption** to `Clear All`, **ID** to `ID_EDIT_CLEAR_ALL`, **Image Index** to `0`, **Large Image Index** to `0`.  \n  \n4.  Save the changes, and then build and run the application. The Scribble application should be displayed, and it should have a ribbon bar at the top of the window instead of a menu bar. The ribbon bar should have one category, **Home**, and **Home** should have one panel, **Edit**. The ribbon buttons that you added should be associated with the existing event handlers, and the **Open**, **Close**, **Save**, **Print**, and **Clear All** buttons should work as expected.  \n  \n [[Sections](#top)]  \n  \n##  <a name=\"setlook\"></a> Setting the Look of the Application  \n A *visual manager* is a global object that controls all drawing for an application. Because the original Scribble application uses the Office 2000 user interface (UI) style, the application may look old-fashioned. You can reset the application to use the Office 2007 visual manager so that it resembles an Office 2007 application.  \n  \n#### To set the look of the application  \n  \n1.  In the `CMainFrame::OnCreate` function, type the following code to change the default visual manager and style.  \n  \n ``` *// Set the default manager to Office 2007   \n    CMFCVisualManager::SetDefaultManager(RUNTIME_CLASS(CMFCVisualManagerOffice2007));\n\n CMFCVisualManagerOffice2007::SetStyle(CMFCVisualManagerOffice2007::Office2007_LunaBlue);\n\n ```  \n  \n2.  Save the changes, and then build and run the application. The application UI should resemble the Office 2007 UI.  \n  \n [[Sections](#top)]  \n  \n## Next Steps  \n You have modified the classic Scribble 1.0 MFC sample to use the Ribbon Designer. Now go to [Part 2](../mfc/walkthrough-updating-the-mfc-scribble-application-part-2.md).  \n  \n## See Also  \n [Walkthroughs](../mfc/walkthroughs-mfc.md)   \n [Walkthrough: Updating the MFC Scribble Application (Part 2)](../mfc/walkthrough-updating-the-mfc-scribble-application-part-2.md)\n\n"}