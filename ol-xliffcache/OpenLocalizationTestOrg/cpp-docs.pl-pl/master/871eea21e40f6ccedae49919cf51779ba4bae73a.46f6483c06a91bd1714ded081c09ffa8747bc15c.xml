{"nodes":[{"pos":[12,45],"content":"Extract Function | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Extract Function | Microsoft Docs","pos":[0,33]}]},{"content":"Extract Function","pos":[508,524]},{"pos":[525,590],"content":"<bpt id=\"p1\">**</bpt>What:<ept id=\"p1\">**</ept> Lets you turn a fragment of code into its own function.","source":"**What:** Lets you turn a fragment of code into its own function."},{"pos":[592,702],"content":"<bpt id=\"p1\">**</bpt>When:<ept id=\"p1\">**</ept> You have a fragment of existing code in some function that needs to be called from another function.","source":"**When:** You have a fragment of existing code in some function that needs to be called from another function."},{"content":"<bpt id=\"p1\">**</bpt>Why:<ept id=\"p1\">**</ept> You could copy/paste that code, but that would lead to duplication.","pos":[706,782],"source":"**Why:** You could copy/paste that code, but that would lead to duplication."},{"content":"A better solution is to refactor that fragment into its own function which can be called freely by any other function.","pos":[784,902]},{"content":"How:","pos":[906,910]},{"content":"Highlight the code to be extracted:","pos":[917,952]},{"content":"Highlighted code","pos":[959,975]},{"content":"Next, do one of the following:","pos":[1019,1049]},{"content":"Keyboard","pos":[1057,1065]},{"content":"Press <bpt id=\"p1\">**</bpt>Ctrl+R<ept id=\"p1\">**</ept>, then <bpt id=\"p2\">**</bpt>Ctrl+M<ept id=\"p2\">**</ept>.","pos":[1075,1109],"source":"Press **Ctrl+R**, then **Ctrl+M**."},{"content":"(Note that your keyboard shortcut may be different based on which profile you've selected.)","pos":[1111,1202]},{"content":"Press <bpt id=\"p1\">**</bpt>Ctrl+.<ept id=\"p1\">**</ept>","pos":[1210,1226],"source":"Press **Ctrl+.**"},{"content":"to trigger the <bpt id=\"p1\">**</bpt>Quick Actions and Refactorings<ept id=\"p1\">**</ept> menu and select <bpt id=\"p2\">**</bpt>Extract Function (Experimental)<ept id=\"p2\">**</ept> from the context menu.","pos":[1227,1351],"source":" to trigger the **Quick Actions and Refactorings** menu and select **Extract Function (Experimental)** from the context menu."},{"content":"Mouse","pos":[1359,1364]},{"pos":[1374,1435],"content":"Select <bpt id=\"p1\">**</bpt>Edit &gt; Refactor &gt; Extract Function (Experimental)<ept id=\"p1\">**</ept>.","source":"Select **Edit > Refactor > Extract Function (Experimental)**."},{"pos":[1443,1585],"content":"Right-click the code, select the <bpt id=\"p1\">**</bpt>Quick Actions and Refactorings<ept id=\"p1\">**</ept> menu and select <bpt id=\"p2\">**</bpt>Extract Function (Experimental)<ept id=\"p2\">**</ept> from the context menu.","source":"Right-click the code, select the **Quick Actions and Refactorings** menu and select **Extract Function (Experimental)** from the context menu."},{"pos":[1593,1740],"content":"Click the <ph id=\"ph1\">![</ph>Lightbulb<ph id=\"ph2\">](images/bulb.png)</ph> icon which appears in the left margin and select <bpt id=\"p1\">**</bpt>Extract Function (Experimental)<ept id=\"p1\">**</ept> from the context menu.","source":"Click the ![Lightbulb](images/bulb.png) icon which appears in the left margin and select **Extract Function (Experimental)** from the context menu."},{"pos":[1745,1905],"content":"In the <bpt id=\"p1\">**</bpt>Extract Function/Method (Experimental)<ept id=\"p1\">**</ept> window, enter the new function name, select where you want the code to be placed, and click the <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept> button.","source":"In the **Extract Function/Method (Experimental)** window, enter the new function name, select where you want the code to be placed, and click the **OK** button."},{"content":"Extract function function","pos":[1914,1939]},{"content":"The new function will be created where you specified, a function prototype in the corresponding header file, and the original code will be changed to call that function.","pos":[1980,2149]},{"content":"Extract function result","pos":[2156,2179]}],"content":"---\ntitle: \"Extract Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/16/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n    - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nms.assetid: e31d1249-9705-4511-acbd-9f6fe73bdf2d\nauthor: \"BrianPeek\"\nms.author: \"brpeek\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n    - \"cs-cz\"\n    - \"de-de\"\n    - \"es-es\"\n    - \"fr-fr\"\n    - \"it-it\"\n    - \"ja-jp\"\n    - \"ko-kr\"\n    - \"pl-pl\"\n    - \"pt-br\"\n    - \"ru-ru\"\n    - \"tr-tr\"\n    - \"zh-cn\"\n    - \"zh-tw\"\n---\n\n# Extract Function\n**What:** Lets you turn a fragment of code into its own function.\n\n**When:** You have a fragment of existing code in some function that needs to be called from another function.  \n\n**Why:** You could copy/paste that code, but that would lead to duplication.  A better solution is to refactor that fragment into its own function which can be called freely by any other function.\n\n**How:**\n\n1. Highlight the code to be extracted:\n\n   ![Highlighted code](images/extractfunction_highlight.png)\n\n1. Next, do one of the following:\n   * **Keyboard**\n     * Press **Ctrl+R**, then **Ctrl+M**.  (Note that your keyboard shortcut may be different based on which profile you've selected.)\n     * Press **Ctrl+.** to trigger the **Quick Actions and Refactorings** menu and select **Extract Function (Experimental)** from the context menu.\n   * **Mouse**\n     * Select **Edit > Refactor > Extract Function (Experimental)**.\n     * Right-click the code, select the **Quick Actions and Refactorings** menu and select **Extract Function (Experimental)** from the context menu.\n     * Click the ![Lightbulb](images/bulb.png) icon which appears in the left margin and select **Extract Function (Experimental)** from the context menu.\n\n1. In the **Extract Function/Method (Experimental)** window, enter the new function name, select where you want the code to be placed, and click the **OK** button.  \n\n   ![Extract function function](images/extractfunction_dialog.png)\n\n1. The new function will be created where you specified, a function prototype in the corresponding header file, and the original code will be changed to call that function.\n\n   ![Extract function result](images/extractfunction_result.png)"}