{"nodes":[{"pos":[12,58],"content":"Class Factories and Licensing | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Class Factories and Licensing | Microsoft Docs","pos":[0,46]}]},{"pos":[640,669],"content":"Class Factories and Licensing","linkify":"Class Factories and Licensing","nodes":[{"content":"Class Factories and Licensing","pos":[0,29]}]},{"content":"To create an instance of your OLE control, a container application calls a member function of the control's class factory.","pos":[670,792]},{"content":"Because your control is an actual OLE object, the class factory is responsible for creating instances of your control.","pos":[793,911]},{"content":"Every OLE control class must have a class factory.","pos":[912,962]},{"content":"Another important feature of OLE controls is their ability to enforce a license.","pos":[969,1049]},{"content":"ControlWizard allows you to incorporate licensing during the creation of your control project.","pos":[1050,1144]},{"content":"For more information on control licensing, see the article <bpt id=\"p1\">[</bpt>ActiveX Controls: Licensing An ActiveX Control<ept id=\"p1\">](../../mfc/mfc-activex-controls-licensing-an-activex-control.md)</ept>.","pos":[1145,1317],"source":" For more information on control licensing, see the article [ActiveX Controls: Licensing An ActiveX Control](../../mfc/mfc-activex-controls-licensing-an-activex-control.md)."},{"content":"The following table lists several macros and functions used to declare and implement your control's class factory and to license of your control.","pos":[1324,1469]},{"pos":[1479,1508],"content":"Class Factories and Licensing","linkify":"Class Factories and Licensing","nodes":[{"content":"Class Factories and Licensing","pos":[0,29]}]},{"pos":[1529,1574],"content":"<bpt id=\"p1\">[</bpt>DECLARE_OLECREATE_EX<ept id=\"p1\">](#declare_olecreate_ex)</ept>","source":"[DECLARE_OLECREATE_EX](#declare_olecreate_ex)"},{"content":"Declares the class factory for an OLE control or property page.","pos":[1575,1638]},{"pos":[1643,1692],"content":"<bpt id=\"p1\">[</bpt>IMPLEMENT_OLECREATE_EX<ept id=\"p1\">](#implement_olecreate_ex)</ept>","source":"[IMPLEMENT_OLECREATE_EX](#implement_olecreate_ex)"},{"pos":[1693,1786],"content":"Implements the control's <ph id=\"ph1\">`GetClassID`</ph> function and declares an instance of the class factory.","source":"Implements the control's `GetClassID` function and declares an instance of the class factory."},{"pos":[1791,1828],"content":"<bpt id=\"p1\">[</bpt>BEGIN_OLEFACTORY<ept id=\"p1\">](#begin_olefactory)</ept>","source":"[BEGIN_OLEFACTORY](#begin_olefactory)"},{"content":"Begins the declaration of any licensing functions.","pos":[1829,1879]},{"pos":[1884,1917],"content":"<bpt id=\"p1\">[</bpt>END_OLEFACTORY<ept id=\"p1\">](#end_olefactory)</ept>","source":"[END_OLEFACTORY](#end_olefactory)"},{"content":"Ends the declaration of any licensing functions.","pos":[1918,1966]},{"pos":[1971,2008],"content":"<bpt id=\"p1\">[</bpt>AfxVerifyLicFile<ept id=\"p1\">](#afxverifylicfile)</ept>","source":"[AfxVerifyLicFile](#afxverifylicfile)"},{"content":"Verifies whether a control is licensed for use on a particular computer.","pos":[2009,2081]},{"pos":[2092,2149],"content":"<bpt id=\"p1\">&lt;a name=\"declare_olecreate_ex\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  DECLARE_OLECREATE_EX","linkify":"<a name=\"declare_olecreate_ex\"></a>  DECLARE_OLECREATE_EX","source":"<a name=\"declare_olecreate_ex\"></a>  DECLARE_OLECREATE_EX"},{"pos":[2153,2237],"content":"Declares a class factory and the <ph id=\"ph1\">`GetClassID`</ph> member function of your control class.","source":"Declares a class factory and the `GetClassID` member function of your control class."},{"pos":[2299,2309],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>class_name<ept id=\"p1\">*</ept>","pos":[2313,2325],"source":"*class_name*"},{"content":"The name of the control class.","pos":[2329,2359]},{"pos":[2369,2376],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Use this macro in the control class header file for a control that does not support licensing.","pos":[2380,2474]},{"content":"Note that this macro serves the same purpose as the following code sample:","pos":[2481,2555]},{"pos":[2562,2661],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#14<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/class-factories-and-licensing_1.h)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#14](../../mfc/reference/codesnippet/cpp/class-factories-and-licensing_1.h)]"},{"pos":[2671,2732],"content":"<bpt id=\"p1\">&lt;a name=\"implement_olecreate_ex\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IMPLEMENT_OLECREATE_EX","linkify":"<a name=\"implement_olecreate_ex\"></a>  IMPLEMENT_OLECREATE_EX","source":"<a name=\"implement_olecreate_ex\"></a>  IMPLEMENT_OLECREATE_EX"},{"pos":[2736,2901],"content":"Implements your control's class factory and the <bpt id=\"p1\">[</bpt>GetClassID<ept id=\"p1\">](../../mfc/reference/colecontrol-class.md#colecontrol__getclassid)</ept> member function of your control class.","source":"Implements your control's class factory and the [GetClassID](../../mfc/reference/colecontrol-class.md#colecontrol__getclassid) member function of your control class."},{"pos":[3109,3119],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>class_name<ept id=\"p1\">*</ept>","pos":[3123,3135],"source":"*class_name*"},{"content":"The name of the control property page class.","pos":[3139,3183]},{"content":"<bpt id=\"p1\">*</bpt>external_name<ept id=\"p1\">*</ept>","pos":[3190,3205],"source":"*external_name*"},{"content":"The object name exposed to applications.","pos":[3209,3249]},{"content":"<bpt id=\"p1\">*</bpt>l, w1, w2, b1, b2, b3, b4, b5, b6, b7, b8<ept id=\"p1\">*</ept>","pos":[3256,3299],"source":"*l, w1, w2, b1, b2, b3, b4, b5, b6, b7, b8*"},{"content":"Components of the class's <bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept>.","pos":[3303,3339],"source":" Components of the class's **CLSID**."},{"content":"For more information on these parameters, see the Remarks for <bpt id=\"p1\">[</bpt>IMPLEMENT_OLECREATE<ept id=\"p1\">](run-time-object-model-services.md#implement_olecreate)</ept>.","pos":[3340,3479],"source":" For more information on these parameters, see the Remarks for [IMPLEMENT_OLECREATE](run-time-object-model-services.md#implement_olecreate)."},{"pos":[3489,3496],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This macro must appear in the implementation file for any control class that uses the <ph id=\"ph1\">`DECLARE_OLECREATE_EX`</ph> macro or the <ph id=\"ph2\">`BEGIN_OLEFACTORY`</ph> and <ph id=\"ph3\">`END_OLEFACTORY`</ph> macros.","pos":[3500,3669],"source":"This macro must appear in the implementation file for any control class that uses the `DECLARE_OLECREATE_EX` macro or the `BEGIN_OLEFACTORY` and `END_OLEFACTORY` macros."},{"content":"The external name is the identifier of the OLE control that is exposed to other applications.","pos":[3670,3763]},{"content":"Containers use this name to request an object of this control class.","pos":[3764,3832]},{"pos":[3842,3891],"content":"<bpt id=\"p1\">&lt;a name=\"begin_olefactory\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  BEGIN_OLEFACTORY","linkify":"<a name=\"begin_olefactory\"></a>  BEGIN_OLEFACTORY","source":"<a name=\"begin_olefactory\"></a>  BEGIN_OLEFACTORY"},{"content":"Begins the declaration of your class factory in the header file of your control class.","pos":[3895,3981]},{"pos":[4036,4046],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>class_name<ept id=\"p1\">*</ept>","pos":[4050,4062],"source":"*class_name*"},{"content":"Specifies the name of the control class whose class factory this is.","pos":[4066,4134]},{"pos":[4144,4151],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4155,4255],"content":"Declarations of class factory licensing functions should begin immediately after <ph id=\"ph1\">`BEGIN_OLEFACTORY`</ph>.","source":"Declarations of class factory licensing functions should begin immediately after `BEGIN_OLEFACTORY`."},{"pos":[4265,4310],"content":"<bpt id=\"p1\">&lt;a name=\"end_olefactory\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  END_OLEFACTORY","linkify":"<a name=\"end_olefactory\"></a>  END_OLEFACTORY","source":"<a name=\"end_olefactory\"></a>  END_OLEFACTORY"},{"content":"Ends the declaration of your control's class factory.","pos":[4314,4367]},{"pos":[4422,4432],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>class_name<ept id=\"p1\">*</ept>","pos":[4436,4448],"source":"*class_name*"},{"content":"The name of the control class whose class factory this is.","pos":[4452,4510]},{"pos":[4520,4569],"content":"<bpt id=\"p1\">&lt;a name=\"afxverifylicfile\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AfxVerifyLicFile","linkify":"<a name=\"afxverifylicfile\"></a>  AfxVerifyLicFile","source":"<a name=\"afxverifylicfile\"></a>  AfxVerifyLicFile"},{"pos":[4573,4679],"content":"Call this function to verify that the license file named by <ph id=\"ph1\">`pszLicFileName`</ph> is valid for the OLE control.","source":"Call this function to verify that the license file named by `pszLicFileName` is valid for the OLE control."},{"pos":[4851,4861],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The instance handle of the DLL associated with the licensed control.","pos":[4880,4948]},{"content":"Points to a null-terminated character string containing the license filename.","pos":[4975,5052]},{"content":"Points to a byte sequence that must match the sequence found at the beginning of the license file.","pos":[5083,5181]},{"content":"Number of characters in <ph id=\"ph1\">`pszLicFileContents`</ph>.","pos":[5197,5242],"source":" Number of characters in `pszLicFileContents`."},{"pos":[5252,5264],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[5268,5379],"content":"Nonzero if the license file exists and begins with the character sequence in <ph id=\"ph1\">`pszLicFileContents`</ph>; otherwise 0.","source":"Nonzero if the license file exists and begins with the character sequence in `pszLicFileContents`; otherwise 0."},{"pos":[5389,5396],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5400,5438],"content":"If <ph id=\"ph1\">`cch`</ph> is â€“ 1, this function uses:","source":"If `cch` is â€“ 1, this function uses:"},{"pos":[5445,5541],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFC_Utilities#36<ept id=\"p2\">](../../mfc/codesnippet/cpp/class-factories-and-licensing_2.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFC_Utilities#36](../../mfc/codesnippet/cpp/class-factories-and-licensing_2.cpp)]"},{"pos":[5550,5558],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[5562,5629],"content":"<bpt id=\"p1\">[</bpt>Macros and Globals<ept id=\"p1\">](../../mfc/reference/mfc-macros-and-globals.md)</ept>","source":"[Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)"}],"content":"---\ntitle: \"Class Factories and Licensing | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.mfc.macros.classes\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"class factories, and licensing\"\nms.assetid: 53c4856a-4062-46db-9f69-dd4339f746b3\ncaps.latest.revision: 13\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Class Factories and Licensing\nTo create an instance of your OLE control, a container application calls a member function of the control's class factory. Because your control is an actual OLE object, the class factory is responsible for creating instances of your control. Every OLE control class must have a class factory.  \n  \n Another important feature of OLE controls is their ability to enforce a license. ControlWizard allows you to incorporate licensing during the creation of your control project. For more information on control licensing, see the article [ActiveX Controls: Licensing An ActiveX Control](../../mfc/mfc-activex-controls-licensing-an-activex-control.md).  \n  \n The following table lists several macros and functions used to declare and implement your control's class factory and to license of your control.  \n  \n### Class Factories and Licensing  \n  \n|||  \n|-|-|  \n|[DECLARE_OLECREATE_EX](#declare_olecreate_ex)|Declares the class factory for an OLE control or property page.|  \n|[IMPLEMENT_OLECREATE_EX](#implement_olecreate_ex)|Implements the control's `GetClassID` function and declares an instance of the class factory.|  \n|[BEGIN_OLEFACTORY](#begin_olefactory)|Begins the declaration of any licensing functions.|  \n|[END_OLEFACTORY](#end_olefactory)|Ends the declaration of any licensing functions.|  \n|[AfxVerifyLicFile](#afxverifylicfile)|Verifies whether a control is licensed for use on a particular computer.|  \n  \n##  <a name=\"declare_olecreate_ex\"></a>  DECLARE_OLECREATE_EX  \n Declares a class factory and the `GetClassID` member function of your control class.  \n  \n```   \nDECLARE_OLECREATE_EX(class_name)   \n```  \n  \n### Parameters  \n *class_name*  \n The name of the control class.  \n  \n### Remarks  \n Use this macro in the control class header file for a control that does not support licensing.  \n  \n Note that this macro serves the same purpose as the following code sample:  \n  \n [!code-cpp[NVC_MFCAxCtl#14](../../mfc/reference/codesnippet/cpp/class-factories-and-licensing_1.h)]  \n  \n##  <a name=\"implement_olecreate_ex\"></a>  IMPLEMENT_OLECREATE_EX  \n Implements your control's class factory and the [GetClassID](../../mfc/reference/colecontrol-class.md#colecontrol__getclassid) member function of your control class.  \n  \n```   \nIMPLEMENT_OLECREATE_EX(\n   class_name,   \n    external_name,    \n    l,   \n    w1,   \n    w2,   \n    b1,   \n    b2,   \n    b3,   \n    b4,   \n    b5,   \n    b6,   \n    b7,\n    b8)   \n```  \n  \n### Parameters  \n *class_name*  \n The name of the control property page class.  \n  \n *external_name*  \n The object name exposed to applications.  \n  \n *l, w1, w2, b1, b2, b3, b4, b5, b6, b7, b8*  \n Components of the class's **CLSID**. For more information on these parameters, see the Remarks for [IMPLEMENT_OLECREATE](run-time-object-model-services.md#implement_olecreate).  \n  \n### Remarks  \n This macro must appear in the implementation file for any control class that uses the `DECLARE_OLECREATE_EX` macro or the `BEGIN_OLEFACTORY` and `END_OLEFACTORY` macros. The external name is the identifier of the OLE control that is exposed to other applications. Containers use this name to request an object of this control class.  \n  \n##  <a name=\"begin_olefactory\"></a>  BEGIN_OLEFACTORY  \n Begins the declaration of your class factory in the header file of your control class.  \n  \n``` \nBEGIN_OLEFACTORY(class_name)  \n```  \n  \n### Parameters  \n *class_name*  \n Specifies the name of the control class whose class factory this is.  \n  \n### Remarks  \n Declarations of class factory licensing functions should begin immediately after `BEGIN_OLEFACTORY`.  \n  \n##  <a name=\"end_olefactory\"></a>  END_OLEFACTORY  \n Ends the declaration of your control's class factory.  \n  \n```  \nEND_OLEFACTORY(class_name)   \n```  \n  \n### Parameters  \n *class_name*  \n The name of the control class whose class factory this is.  \n  \n##  <a name=\"afxverifylicfile\"></a>  AfxVerifyLicFile  \n Call this function to verify that the license file named by `pszLicFileName` is valid for the OLE control.  \n  \n```   \nBOOL AFXAPI AfxVerifyLicFile(\n    HINSTANCE  hInstance,  \n    LPCTSTR  pszLicFileName,  \n    LPOLESTR  pszLicFileContents,  \n    UINT cch = -1); \n```  \n  \n### Parameters  \n `hInstance`  \n The instance handle of the DLL associated with the licensed control.  \n  \n `pszLicFileName`  \n Points to a null-terminated character string containing the license filename.  \n  \n `pszLicFileContents`  \n Points to a byte sequence that must match the sequence found at the beginning of the license file.  \n  \n `cch`  \n Number of characters in `pszLicFileContents`.  \n  \n### Return Value  \n Nonzero if the license file exists and begins with the character sequence in `pszLicFileContents`; otherwise 0.  \n  \n### Remarks  \n If `cch` is â€“ 1, this function uses:  \n  \n [!code-cpp[NVC_MFC_Utilities#36](../../mfc/codesnippet/cpp/class-factories-and-licensing_2.cpp)]  \n  \n## See Also  \n [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)\n"}