{"nodes":[{"pos":[12,52],"content":"Importing and Exporting | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Importing and Exporting | Microsoft Docs","pos":[0,40]}]},{"content":"Importing and Exporting","pos":[711,734]},{"content":"You can import public symbols into an application or export functions from a DLL using two methods:","pos":[735,834]},{"content":"Use a module definition (.def) file when building the DLL","pos":[844,901]},{"pos":[911,1031],"content":"Use the keywords <bpt id=\"p1\">**</bpt>__declspec(dllimport)<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>__declspec(dllexport)<ept id=\"p2\">**</ept> in a function definition in the main application","source":"Use the keywords **__declspec(dllimport)** or **__declspec(dllexport)** in a function definition in the main application"},{"content":"Using a .def file","pos":[1040,1057]},{"content":"A module-definition (.def) file is a text file containing one or more module statements that describe various attributes of a DLL.","pos":[1061,1191]},{"content":"If you do not use <bpt id=\"p1\">**</bpt>__declspec(dllimport)<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>__declspec(dllexport)<ept id=\"p2\">**</ept> to export a DLL's functions, the DLL requires a .def file.","pos":[1192,1323],"source":" If you do not use **__declspec(dllimport)** or **__declspec(dllexport)** to export a DLL's functions, the DLL requires a .def file."},{"pos":[1330,1500],"content":"You can use .def files to <bpt id=\"p1\">[</bpt>import into an application<ept id=\"p1\">](../build/importing-using-def-files.md)</ept> or to <bpt id=\"p2\">[</bpt>export from a DLL<ept id=\"p2\">](../build/exporting-from-a-dll-using-def-files.md)</ept>.","source":"You can use .def files to [import into an application](../build/importing-using-def-files.md) or to [export from a DLL](../build/exporting-from-a-dll-using-def-files.md)."},{"content":"Using __declspec","pos":[1509,1525]},{"pos":[1529,1686],"content":"Visual C++ uses <bpt id=\"p1\">**</bpt>__declspec(dllimport)<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>__declspec(dllexport)<ept id=\"p2\">**</ept> to replace the <bpt id=\"p3\">**</bpt>__export<ept id=\"p3\">**</ept> keyword previously used in 16-bit versions of Visual C++.","source":"Visual C++ uses **__declspec(dllimport)** and **__declspec(dllexport)** to replace the **__export** keyword previously used in 16-bit versions of Visual C++."},{"content":"You do not need to use <bpt id=\"p1\">**</bpt>__declspec(dllimport)<ept id=\"p1\">**</ept> for your code to compile correctly, but doing so allows the compiler to generate better code.","pos":[1693,1835],"source":"You do not need to use **__declspec(dllimport)** for your code to compile correctly, but doing so allows the compiler to generate better code."},{"content":"The compiler is able to generate better code because it can determine whether a function exists in a DLL or not, which allows the compiler to produce code that skips a level of indirection that would normally be present in a function call that crossed a DLL boundary.","pos":[1836,2103]},{"content":"However, you must use <bpt id=\"p1\">**</bpt>__declspec(dllimport)<ept id=\"p1\">**</ept> to import variables used in a DLL.","pos":[2104,2186],"source":" However, you must use **__declspec(dllimport)** to import variables used in a DLL."},{"content":"With the proper .def file EXPORTS section, <bpt id=\"p1\">**</bpt>__declspec(dllexport)<ept id=\"p1\">**</ept> is not required.","pos":[2193,2278],"source":"With the proper .def file EXPORTS section, **__declspec(dllexport)** is not required."},{"content":"<bpt id=\"p1\">**</bpt>__declspec(dllexport)<ept id=\"p1\">**</ept> was added to provide an easy way to export functions from an .exe or .dll file without using a .def file.","pos":[2279,2410],"source":"**__declspec(dllexport)** was added to provide an easy way to export functions from an .exe or .dll file without using a .def file."},{"content":"The Win32 Portable Executable format is designed to minimize the number of pages that must be touched to fix imports.","pos":[2417,2534]},{"content":"To do this, it places all the import addresses for any program in one place called the Import Address Table.","pos":[2535,2643]},{"content":"This allows the loader to modify only one or two pages when accessing these imports.","pos":[2644,2728]},{"content":"What do you want to do?","pos":[2737,2760]},{"content":"Import into an Application","pos":[2771,2797]},{"content":"Export from a DLL","pos":[2877,2894]},{"content":"See Also","pos":[2938,2946]},{"content":"DLLs in Visual C++","pos":[2951,2969]}],"content":"---\ntitle: \"Importing and Exporting | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DLLs [C++], importing\"\n  - \"exporting DLLs [C++]\"\n  - \"importing DLLs [C++]\"\n  - \"DLLs [C++], exporting from\"\n  - \"__declspec(dllimport) keyword [C++]\"\nms.assetid: 7c44c2aa-2117-4cec-9615-a65bfd3f8f7b\ncaps.latest.revision: 8\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Importing and Exporting\nYou can import public symbols into an application or export functions from a DLL using two methods:  \n  \n-   Use a module definition (.def) file when building the DLL  \n  \n-   Use the keywords **__declspec(dllimport)** or **__declspec(dllexport)** in a function definition in the main application  \n  \n## Using a .def file  \n A module-definition (.def) file is a text file containing one or more module statements that describe various attributes of a DLL. If you do not use **__declspec(dllimport)** or **__declspec(dllexport)** to export a DLL's functions, the DLL requires a .def file.  \n  \n You can use .def files to [import into an application](../build/importing-using-def-files.md) or to [export from a DLL](../build/exporting-from-a-dll-using-def-files.md).  \n  \n## Using __declspec  \n Visual C++ uses **__declspec(dllimport)** and **__declspec(dllexport)** to replace the **__export** keyword previously used in 16-bit versions of Visual C++.  \n  \n You do not need to use **__declspec(dllimport)** for your code to compile correctly, but doing so allows the compiler to generate better code. The compiler is able to generate better code because it can determine whether a function exists in a DLL or not, which allows the compiler to produce code that skips a level of indirection that would normally be present in a function call that crossed a DLL boundary. However, you must use **__declspec(dllimport)** to import variables used in a DLL.  \n  \n With the proper .def file EXPORTS section, **__declspec(dllexport)** is not required. **__declspec(dllexport)** was added to provide an easy way to export functions from an .exe or .dll file without using a .def file.  \n  \n The Win32 Portable Executable format is designed to minimize the number of pages that must be touched to fix imports. To do this, it places all the import addresses for any program in one place called the Import Address Table. This allows the loader to modify only one or two pages when accessing these imports.  \n  \n## What do you want to do?  \n  \n-   [Import into an Application](../build/importing-into-an-application-using-declspec-dllimport.md)  \n  \n-   [Export from a DLL](../build/exporting-from-a-dll.md)  \n  \n## See Also  \n [DLLs in Visual C++](../build/dlls-in-visual-cpp.md)"}