{"nodes":[{"pos":[12,55],"content":"Linker Tools Error LNK2022 | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Linker Tools Error LNK2022 | Microsoft Docs","pos":[0,43]}]},{"content":"Linker Tools Error LNK2022","pos":[608,634]},{"content":"metadata operation failed (HRESULT) : error_message","pos":[635,686]},{"content":"The linker detected an error while merging metadata.","pos":[693,745]},{"content":"The metadata errors must be resolved to link successfully.","pos":[746,804]},{"content":"One way to diagnose this problem is to run <bpt id=\"p1\">**</bpt>ildasm –tokens<ept id=\"p1\">**</ept> on the object files to find which types have the tokens listed in <ph id=\"ph1\">`error_message`</ph>, and look for differences.","pos":[811,981],"source":"One way to diagnose this problem is to run **ildasm –tokens** on the object files to find which types have the tokens listed in `error_message`, and look for differences."},{"content":"In metadata, two different types with the same name is not valid, even if the just LayoutType attribute is different.","pos":[983,1100]},{"content":"One reason for LNK2022 is when a type (such as a struct) exists in multiple compilands with the same name, but with conflicting definitions, and when you compile with <bpt id=\"p1\">[</bpt>/clr<ept id=\"p1\">](../../build/reference/clr-common-language-runtime-compilation.md)</ept>.","pos":[1107,1347],"source":"One reason for LNK2022 is when a type (such as a struct) exists in multiple compilands with the same name, but with conflicting definitions, and when you compile with [/clr](../../build/reference/clr-common-language-runtime-compilation.md)."},{"content":"In this case, make sure that the type has an identical definition in all compilands.","pos":[1349,1433]},{"content":"The type name is listed in <ph id=\"ph1\">`error_message`</ph>.","pos":[1435,1478],"source":"  The type name is listed in `error_message`."},{"content":"Another possible cause for LNK2022 is when the linker finds a metadata file in a different location than was specified to the compiler (with <bpt id=\"p1\">[</bpt>#using<ept id=\"p1\">](../../preprocessor/hash-using-directive-cpp.md)</ept> ).","pos":[1485,1685],"source":"Another possible cause for LNK2022 is when the linker finds a metadata file in a different location than was specified to the compiler (with [#using](../../preprocessor/hash-using-directive-cpp.md) )."},{"content":"Make sure that the metadata file (.dll or .netmodule) is in the same location when passed to the linker, as it was when it was passed to the compiler.","pos":[1686,1836]},{"pos":[1843,2034],"content":"When building an ATL application, the use of <bpt id=\"p1\">[</bpt>_ATL_MIXED<ept id=\"p1\">](http://msdn.microsoft.com/Library/11b59a83-7098-43e2-9f7b-408299930966)</ept> is required in all compilands, if it is used in at least one.","source":"When building an ATL application, the use of [_ATL_MIXED](http://msdn.microsoft.com/Library/11b59a83-7098-43e2-9f7b-408299930966) is required in all compilands, if it is used in at least one."},{"content":"Example","pos":[2043,2050]},{"content":"The following sample defines an empty type.","pos":[2054,2097]},{"content":"Example","pos":[2195,2202]},{"content":"This sample shows that you cannot link two source code files that contain types of the same name but different definitions.","pos":[2206,2329]},{"content":"The following sample generates LNK2022.","pos":[2336,2375]}],"content":"---\ntitle: \"Linker Tools Error LNK2022 | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"error-reference\"\nf1_keywords: \n  - \"LNK2022\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"LNK2022\"\nms.assetid: d2128c73-dde3-4b8e-a9b2-0a153acefb3b\ncaps.latest.revision: 15\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Linker Tools Error LNK2022\nmetadata operation failed (HRESULT) : error_message  \n  \n The linker detected an error while merging metadata. The metadata errors must be resolved to link successfully.  \n  \n One way to diagnose this problem is to run **ildasm –tokens** on the object files to find which types have the tokens listed in `error_message`, and look for differences.  In metadata, two different types with the same name is not valid, even if the just LayoutType attribute is different.  \n  \n One reason for LNK2022 is when a type (such as a struct) exists in multiple compilands with the same name, but with conflicting definitions, and when you compile with [/clr](../../build/reference/clr-common-language-runtime-compilation.md).  In this case, make sure that the type has an identical definition in all compilands.  The type name is listed in `error_message`.  \n  \n Another possible cause for LNK2022 is when the linker finds a metadata file in a different location than was specified to the compiler (with [#using](../../preprocessor/hash-using-directive-cpp.md) ). Make sure that the metadata file (.dll or .netmodule) is in the same location when passed to the linker, as it was when it was passed to the compiler.  \n  \n When building an ATL application, the use of [_ATL_MIXED](http://msdn.microsoft.com/Library/11b59a83-7098-43e2-9f7b-408299930966) is required in all compilands, if it is used in at least one.  \n  \n## Example  \n The following sample defines an empty type.  \n  \n```  \n// LNK2022_a.cpp  \n// compile with: /clr /c  \npublic ref class Test {};  \n```  \n  \n## Example  \n This sample shows that you cannot link two source code files that contain types of the same name but different definitions.  \n  \n The following sample generates LNK2022.  \n  \n```  \n// LNK2022_b.cpp  \n// compile with: LNK2022_a.cpp /clr /LD   \n// LNK2022 expected  \npublic ref class Test {  \n   void func() {}  \n   int var;  \n};  \n```"}