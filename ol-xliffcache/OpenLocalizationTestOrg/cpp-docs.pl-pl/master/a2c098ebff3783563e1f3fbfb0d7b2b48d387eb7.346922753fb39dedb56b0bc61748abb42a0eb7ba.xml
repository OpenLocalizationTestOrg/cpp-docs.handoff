{"nodes":[{"pos":[12,54],"content":"IPersistStorageImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IPersistStorageImpl Class | Microsoft Docs","pos":[0,42]}]},{"pos":[778,803],"content":"IPersistStorageImpl Class","linkify":"IPersistStorageImpl Class","nodes":[{"content":"IPersistStorageImpl Class","pos":[0,25]}]},{"pos":[804,918],"content":"This class implements the <bpt id=\"p1\">[</bpt>IPersistStorage<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679731)</ept> interface.","source":"This class implements the [IPersistStorage](http://msdn.microsoft.com/library/windows/desktop/ms679731) interface."},{"pos":[926,1076],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,148],"source":" This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"pos":[1085,1091],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1201,1211],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Your class, derived from <ph id=\"ph1\">`IPersistStorageImpl`</ph>.","pos":[1222,1269],"source":" Your class, derived from `IPersistStorageImpl`."},{"pos":[1278,1285],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1295,1309],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1316,1320]},{"content":"Description","pos":[1321,1332]},{"pos":[1370,1437],"content":"<bpt id=\"p1\">[</bpt>IPersistStorageImpl::GetClassID<ept id=\"p1\">](#ipersiststorageimpl__getclassid)</ept>","source":"[IPersistStorageImpl::GetClassID](#ipersiststorageimpl__getclassid)"},{"content":"Retrieves the object's CLSID.","pos":[1438,1467]},{"pos":[1472,1549],"content":"<bpt id=\"p1\">[</bpt>IPersistStorageImpl::HandsOffStorage<ept id=\"p1\">](#ipersiststorageimpl__handsoffstorage)</ept>","source":"[IPersistStorageImpl::HandsOffStorage](#ipersiststorageimpl__handsoffstorage)"},{"content":"Instructs the object to release all storage objects and enter HandsOff mode.","pos":[1550,1626]},{"content":"The ATL implementation returns <ph id=\"ph1\">`S_OK`</ph>.","pos":[1627,1665],"source":" The ATL implementation returns `S_OK`."},{"pos":[1670,1731],"content":"<bpt id=\"p1\">[</bpt>IPersistStorageImpl::InitNew<ept id=\"p1\">](#ipersiststorageimpl__initnew)</ept>","source":"[IPersistStorageImpl::InitNew](#ipersiststorageimpl__initnew)"},{"content":"Initializes a new storage.","pos":[1732,1758]},{"pos":[1763,1824],"content":"<bpt id=\"p1\">[</bpt>IPersistStorageImpl::IsDirty<ept id=\"p1\">](#ipersiststorageimpl__isdirty)</ept>","source":"[IPersistStorageImpl::IsDirty](#ipersiststorageimpl__isdirty)"},{"content":"Checks whether the object's data has changed since it was last saved.","pos":[1825,1894]},{"pos":[1899,1954],"content":"<bpt id=\"p1\">[</bpt>IPersistStorageImpl::Load<ept id=\"p1\">](#ipersiststorageimpl__load)</ept>","source":"[IPersistStorageImpl::Load](#ipersiststorageimpl__load)"},{"content":"Loads the object's properties from the specified storage.","pos":[1955,2012]},{"pos":[2017,2072],"content":"<bpt id=\"p1\">[</bpt>IPersistStorageImpl::Save<ept id=\"p1\">](#ipersiststorageimpl__save)</ept>","source":"[IPersistStorageImpl::Save](#ipersiststorageimpl__save)"},{"content":"Saves the object's properties to the specified storage.","pos":[2073,2128]},{"pos":[2133,2206],"content":"<bpt id=\"p1\">[</bpt>IPersistStorageImpl::SaveCompleted<ept id=\"p1\">](#ipersiststorageimpl__savecompleted)</ept>","source":"[IPersistStorageImpl::SaveCompleted](#ipersiststorageimpl__savecompleted)"},{"content":"Notifies an object that it can return to Normal mode to write to its storage object.","pos":[2207,2291]},{"content":"The ATL implementation returns <ph id=\"ph1\">`S_OK`</ph>.","pos":[2292,2330],"source":" The ATL implementation returns `S_OK`."},{"pos":[2340,2347],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2351,2577],"content":"<ph id=\"ph1\">`IPersistStorageImpl`</ph> implements the <bpt id=\"p1\">[</bpt>IPersistStorage<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679731)</ept> interface, which allows a client to request that your object load and save its persistent data using a storage.","source":"`IPersistStorageImpl` implements the [IPersistStorage](http://msdn.microsoft.com/library/windows/desktop/ms679731) interface, which allows a client to request that your object load and save its persistent data using a storage."},{"content":"The implementation of this class requires class <ph id=\"ph1\">`T`</ph> to make an implementation of the <ph id=\"ph2\">`IPersistStreamInit`</ph> interface available via <ph id=\"ph3\">`QueryInterface`</ph>.","pos":[2584,2731],"source":"The implementation of this class requires class `T` to make an implementation of the `IPersistStreamInit` interface available via `QueryInterface`."},{"content":"Typically this means that class <ph id=\"ph1\">`T`</ph> should derive from <bpt id=\"p1\">[</bpt>IPersistStreamInitImpl<ept id=\"p1\">](../../atl/reference/ipersiststreaminitimpl-class.md)</ept>, provide an entry for <ph id=\"ph2\">`IPersistStreamInit`</ph> in the <bpt id=\"p2\">[</bpt>COM map<ept id=\"p2\">](http://msdn.microsoft.com/library/ead2a1e3-334d-44ad-bb1f-b94bb14c2333)</ept>, and use a <bpt id=\"p3\">[</bpt>property map<ept id=\"p3\">](http://msdn.microsoft.com/library/bfe30be6-62c3-4dc2-bd49-21ef96f15427)</ept> to describe the class's persistent data.","pos":[2732,3135],"source":" Typically this means that class `T` should derive from [IPersistStreamInitImpl](../../atl/reference/ipersiststreaminitimpl-class.md), provide an entry for `IPersistStreamInit` in the [COM map](http://msdn.microsoft.com/library/ead2a1e3-334d-44ad-bb1f-b94bb14c2333), and use a [property map](http://msdn.microsoft.com/library/bfe30be6-62c3-4dc2-bd49-21ef96f15427) to describe the class's persistent data."},{"pos":[3142,3303],"content":"<bpt id=\"p1\">**</bpt>Related Articles<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>ATL Tutorial<ept id=\"p2\">](../../atl/active-template-library-atl-tutorial.md)</ept>, <bpt id=\"p3\">[</bpt>Creating an ATL Project<ept id=\"p3\">](../../atl/reference/creating-an-atl-project.md)</ept>","source":"**Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)"},{"pos":[3312,3333],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3391,3403],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3407,3427],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[3437,3516],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststorageimpl__getclassid\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStorageImpl::GetClassID","linkify":"<a name=\"ipersiststorageimpl__getclassid\"></a>  IPersistStorageImpl::GetClassID","source":"<a name=\"ipersiststorageimpl__getclassid\"></a>  IPersistStorageImpl::GetClassID"},{"content":"Retrieves the object's CLSID.","pos":[3520,3549]},{"pos":[3612,3619],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3623,3769],"content":"See <bpt id=\"p1\">[</bpt>IPersist::GetClassID<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms688664)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3779,3868],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststorageimpl__handsoffstorage\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStorageImpl::HandsOffStorage","linkify":"<a name=\"ipersiststorageimpl__handsoffstorage\"></a>  IPersistStorageImpl::HandsOffStorage","source":"<a name=\"ipersiststorageimpl__handsoffstorage\"></a>  IPersistStorageImpl::HandsOffStorage"},{"content":"Instructs the object to release all storage objects and enter HandsOff mode.","pos":[3872,3948]},{"pos":[4005,4017],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[4021,4036],"content":"Returns <ph id=\"ph1\">`S_OK`</ph>.","source":"Returns `S_OK`."},{"pos":[4046,4053],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4057,4215],"content":"See <bpt id=\"p1\">[</bpt>IPersistStorage::HandsOffStorage<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679742)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStorage::HandsOffStorage](http://msdn.microsoft.com/library/windows/desktop/ms679742) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4225,4298],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststorageimpl__initnew\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStorageImpl::InitNew","linkify":"<a name=\"ipersiststorageimpl__initnew\"></a>  IPersistStorageImpl::InitNew","source":"<a name=\"ipersiststorageimpl__initnew\"></a>  IPersistStorageImpl::InitNew"},{"content":"Initializes a new storage.","pos":[4302,4328]},{"pos":[4382,4389],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4393,4524],"content":"The ATL implementation delegates to the <bpt id=\"p1\">[</bpt>IPersistStreamInit<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682273)</ept> interface.","source":"The ATL implementation delegates to the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface."},{"pos":[4531,4680],"content":"See <bpt id=\"p1\">[</bpt>IPersistStorage:InitNew<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms687194)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStorage:InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4690,4763],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststorageimpl__isdirty\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStorageImpl::IsDirty","linkify":"<a name=\"ipersiststorageimpl__isdirty\"></a>  IPersistStorageImpl::IsDirty","source":"<a name=\"ipersiststorageimpl__isdirty\"></a>  IPersistStorageImpl::IsDirty"},{"content":"Checks whether the object's data has changed since it was last saved.","pos":[4767,4836]},{"pos":[4885,4892],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4896,5027],"content":"The ATL implementation delegates to the <bpt id=\"p1\">[</bpt>IPersistStreamInit<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682273)</ept> interface.","source":"The ATL implementation delegates to the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface."},{"pos":[5034,5183],"content":"See <bpt id=\"p1\">[</bpt>IPersistStorage:IsDirty<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683910)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStorage:IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms683910) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[5193,5260],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststorageimpl__load\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStorageImpl::Load","linkify":"<a name=\"ipersiststorageimpl__load\"></a>  IPersistStorageImpl::Load","source":"<a name=\"ipersiststorageimpl__load\"></a>  IPersistStorageImpl::Load"},{"content":"Loads the object's properties from the specified storage.","pos":[5264,5321]},{"pos":[5381,5388],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The ATL implementation delegates to the <bpt id=\"p1\">[</bpt>IPersistStreamInit<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682273)</ept> interface.","pos":[5392,5523],"source":"The ATL implementation delegates to the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface."},{"content":"<bpt id=\"p1\">**</bpt>Load<ept id=\"p1\">**</ept> uses a stream named \"Contents\" to retrieve the object's data.","pos":[5524,5594],"source":"**Load** uses a stream named \"Contents\" to retrieve the object's data."},{"content":"The <bpt id=\"p1\">[</bpt>Save<ept id=\"p1\">](#ipersiststorageimpl__save)</ept> method originally creates this stream.","pos":[5595,5672],"source":" The [Save](#ipersiststorageimpl__save) method originally creates this stream."},{"pos":[5679,5825],"content":"See <bpt id=\"p1\">[</bpt>IPersistStorage:Load<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680557)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStorage:Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[5835,5902],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststorageimpl__save\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStorageImpl::Save","linkify":"<a name=\"ipersiststorageimpl__save\"></a>  IPersistStorageImpl::Save","source":"<a name=\"ipersiststorageimpl__save\"></a>  IPersistStorageImpl::Save"},{"content":"Saves the object's properties to the specified storage.","pos":[5906,5961]},{"pos":[6045,6052],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The ATL implementation delegates to the <bpt id=\"p1\">[</bpt>IPersistStreamInit<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682273)</ept> interface.","pos":[6056,6187],"source":"The ATL implementation delegates to the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface."},{"content":"When <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> is first called, it creates a stream named \"Contents\" on the specified storage.","pos":[6188,6281],"source":" When **Save** is first called, it creates a stream named \"Contents\" on the specified storage."},{"content":"This stream is then used in later calls to <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> and in calls to <bpt id=\"p2\">[</bpt>Load<ept id=\"p2\">](#ipersiststorageimpl__load)</ept>.","pos":[6282,6385],"source":" This stream is then used in later calls to **Save** and in calls to [Load](#ipersiststorageimpl__load)."},{"pos":[6392,6538],"content":"See <bpt id=\"p1\">[</bpt>IPersistStorage:Save<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680680)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStorage:Save](http://msdn.microsoft.com/library/windows/desktop/ms680680) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6548,6633],"content":"<bpt id=\"p1\">&lt;a name=\"ipersiststorageimpl__savecompleted\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IPersistStorageImpl::SaveCompleted","linkify":"<a name=\"ipersiststorageimpl__savecompleted\"></a>  IPersistStorageImpl::SaveCompleted","source":"<a name=\"ipersiststorageimpl__savecompleted\"></a>  IPersistStorageImpl::SaveCompleted"},{"content":"Notifies an object that it can return to Normal mode to write to its storage object.","pos":[6637,6721]},{"pos":[6781,6793],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[6797,6812],"content":"Returns <ph id=\"ph1\">`S_OK`</ph>.","source":"Returns `S_OK`."},{"pos":[6822,6829],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6833,6988],"content":"See <bpt id=\"p1\">[</bpt>IPersistStorage:SaveCompleted<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679713)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStorage:SaveCompleted](http://msdn.microsoft.com/library/windows/desktop/ms679713) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6997,7005],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Storages and Streams<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380352)</ept><ph id=\"ph1\"> </ph>","pos":[7009,7092],"source":"[Storages and Streams](http://msdn.microsoft.com/library/windows/desktop/aa380352) "},{"content":"<bpt id=\"p1\"> [</bpt>IPersistStreamInitImpl Class<ept id=\"p1\">](../../atl/reference/ipersiststreaminitimpl-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[7095,7180],"source":" [IPersistStreamInitImpl Class](../../atl/reference/ipersiststreaminitimpl-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IPersistPropertyBagImpl Class<ept id=\"p1\">](../../atl/reference/ipersistpropertybagimpl-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[7183,7270],"source":" [IPersistPropertyBagImpl Class](../../atl/reference/ipersistpropertybagimpl-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","pos":[7273,7323],"source":" [Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"IPersistStorageImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::IPersistStorageImpl\"\n  - \"ATL::IPersistStorageImpl<T>\"\n  - \"ATL.IPersistStorageImpl<T>\"\n  - \"IPersistStorageImpl\"\n  - \"ATL.IPersistStorageImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"storage, ATL\"\n  - \"IPersistStorageImpl class\"\nms.assetid: d652f02c-239c-47c7-9a50-3e9fc3014fff\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IPersistStorageImpl Class\nThis class implements the [IPersistStorage](http://msdn.microsoft.com/library/windows/desktop/ms679731) interface.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n## Syntax  \n  \n```\ntemplate <class T>  class ATL_NO_VTABLE IPersistStorageImpl :  public IPersistStorage\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `IPersistStorageImpl`.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IPersistStorageImpl::GetClassID](#ipersiststorageimpl__getclassid)|Retrieves the object's CLSID.|  \n|[IPersistStorageImpl::HandsOffStorage](#ipersiststorageimpl__handsoffstorage)|Instructs the object to release all storage objects and enter HandsOff mode. The ATL implementation returns `S_OK`.|  \n|[IPersistStorageImpl::InitNew](#ipersiststorageimpl__initnew)|Initializes a new storage.|  \n|[IPersistStorageImpl::IsDirty](#ipersiststorageimpl__isdirty)|Checks whether the object's data has changed since it was last saved.|  \n|[IPersistStorageImpl::Load](#ipersiststorageimpl__load)|Loads the object's properties from the specified storage.|  \n|[IPersistStorageImpl::Save](#ipersiststorageimpl__save)|Saves the object's properties to the specified storage.|  \n|[IPersistStorageImpl::SaveCompleted](#ipersiststorageimpl__savecompleted)|Notifies an object that it can return to Normal mode to write to its storage object. The ATL implementation returns `S_OK`.|  \n  \n## Remarks  \n `IPersistStorageImpl` implements the [IPersistStorage](http://msdn.microsoft.com/library/windows/desktop/ms679731) interface, which allows a client to request that your object load and save its persistent data using a storage.  \n  \n The implementation of this class requires class `T` to make an implementation of the `IPersistStreamInit` interface available via `QueryInterface`. Typically this means that class `T` should derive from [IPersistStreamInitImpl](../../atl/reference/ipersiststreaminitimpl-class.md), provide an entry for `IPersistStreamInit` in the [COM map](http://msdn.microsoft.com/library/ead2a1e3-334d-44ad-bb1f-b94bb14c2333), and use a [property map](http://msdn.microsoft.com/library/bfe30be6-62c3-4dc2-bd49-21ef96f15427) to describe the class's persistent data.  \n  \n **Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)  \n  \n## Inheritance Hierarchy  \n `IPersistStorage`  \n  \n `IPersistStorageImpl`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ipersiststorageimpl__getclassid\"></a>  IPersistStorageImpl::GetClassID  \n Retrieves the object's CLSID.  \n  \n```\nSTDMETHOD(GetClassID)(CLSID* pClassID);\n```  \n  \n### Remarks  \n See [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststorageimpl__handsoffstorage\"></a>  IPersistStorageImpl::HandsOffStorage  \n Instructs the object to release all storage objects and enter HandsOff mode.  \n  \n```\nSTDMETHOD(HandsOffStorage)(void);\n```  \n  \n### Return Value  \n Returns `S_OK`.  \n  \n### Remarks  \n See [IPersistStorage::HandsOffStorage](http://msdn.microsoft.com/library/windows/desktop/ms679742) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststorageimpl__initnew\"></a>  IPersistStorageImpl::InitNew  \n Initializes a new storage.  \n  \n```\nSTDMETHOD(InitNew)(IStorage*);\n```  \n  \n### Remarks  \n The ATL implementation delegates to the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface.  \n  \n See [IPersistStorage:InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststorageimpl__isdirty\"></a>  IPersistStorageImpl::IsDirty  \n Checks whether the object's data has changed since it was last saved.  \n  \n```\nSTDMETHOD(IsDirty)(void);\n```  \n  \n### Remarks  \n The ATL implementation delegates to the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface.  \n  \n See [IPersistStorage:IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms683910) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststorageimpl__load\"></a>  IPersistStorageImpl::Load  \n Loads the object's properties from the specified storage.  \n  \n```\nSTDMETHOD(Load)(IStorage* pStorage);\n```  \n  \n### Remarks  \n The ATL implementation delegates to the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface. **Load** uses a stream named \"Contents\" to retrieve the object's data. The [Save](#ipersiststorageimpl__save) method originally creates this stream.  \n  \n See [IPersistStorage:Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststorageimpl__save\"></a>  IPersistStorageImpl::Save  \n Saves the object's properties to the specified storage.  \n  \n```\nSTDMETHOD(Save)(\n    IStorage* pStorage,  BOOL fSameAsLoad);\n```  \n  \n### Remarks  \n The ATL implementation delegates to the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface. When **Save** is first called, it creates a stream named \"Contents\" on the specified storage. This stream is then used in later calls to **Save** and in calls to [Load](#ipersiststorageimpl__load).  \n  \n See [IPersistStorage:Save](http://msdn.microsoft.com/library/windows/desktop/ms680680) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststorageimpl__savecompleted\"></a>  IPersistStorageImpl::SaveCompleted  \n Notifies an object that it can return to Normal mode to write to its storage object.  \n  \n```\nSTDMETHOD(SaveCompleted)(IStorage*);\n```  \n  \n### Return Value  \n Returns `S_OK`.  \n  \n### Remarks  \n See [IPersistStorage:SaveCompleted](http://msdn.microsoft.com/library/windows/desktop/ms679713) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [Storages and Streams](http://msdn.microsoft.com/library/windows/desktop/aa380352)   \n [IPersistStreamInitImpl Class](../../atl/reference/ipersiststreaminitimpl-class.md)   \n [IPersistPropertyBagImpl Class](../../atl/reference/ipersistpropertybagimpl-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}