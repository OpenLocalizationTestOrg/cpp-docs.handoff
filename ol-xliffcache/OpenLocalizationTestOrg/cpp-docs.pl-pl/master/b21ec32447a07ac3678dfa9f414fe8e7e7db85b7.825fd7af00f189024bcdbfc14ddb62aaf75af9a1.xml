{"nodes":[{"pos":[12,42],"content":"CRBTree Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CRBTree Class | Microsoft Docs","pos":[0,30]}]},{"content":"CRBTree Class","pos":[632,645]},{"content":"This class provides methods for creating and utilizing a Red-Black tree.","pos":[646,718]},{"content":"Syntax","pos":[727,733]},{"content":"Parameters","pos":[881,891]},{"content":"The key element type.","pos":[902,923]},{"content":"V","pos":[931,932]},{"content":"The value element type.","pos":[937,960]},{"content":"The code used to copy or move key elements.","pos":[980,1023]},{"content":"See <bpt id=\"p1\">[</bpt>CElementTraits Class<ept id=\"p1\">](../../atl/reference/celementtraits-class.md)</ept> for more details.","pos":[1024,1113],"source":" See [CElementTraits Class](../../atl/reference/celementtraits-class.md) for more details."},{"content":"The code used to copy or move value elements.","pos":[1133,1178]},{"content":"Members","pos":[1187,1194]},{"content":"Public Typedefs","pos":[1204,1219]},{"content":"Name","pos":[1226,1230]},{"content":"Description","pos":[1231,1242]},{"content":"CRBTree::KINARGTYPE","pos":[1281,1300]},{"content":"Type used when a key is passed as an input argument.","pos":[1324,1376]},{"content":"CRBTree::KOUTARGTYPE","pos":[1382,1402]},{"content":"Type used when a key is returned as an output argument.","pos":[1427,1482]},{"content":"CRBTree::VINARGTYPE","pos":[1488,1507]},{"content":"Type used when a value is passed as an input argument.","pos":[1531,1585]},{"content":"CRBTree::VOUTARGTYPE","pos":[1591,1611]},{"content":"Type used when a value is passed as an output argument.","pos":[1636,1691]},{"content":"Public Classes","pos":[1702,1716]},{"content":"Name","pos":[1723,1727]},{"content":"Description","pos":[1728,1739]},{"content":"CRBTree::CPair Class","pos":[1778,1798]},{"content":"A class containing the key and value elements.","pos":[1823,1869]},{"content":"Public Constructors","pos":[1880,1899]},{"content":"Name","pos":[1906,1910]},{"content":"Description","pos":[1911,1922]},{"content":"CRBTree::~CRBTree","pos":[1961,1978]},{"content":"The destructor.","pos":[2004,2019]},{"content":"Public Methods","pos":[2030,2044]},{"content":"Name","pos":[2051,2055]},{"content":"Description","pos":[2056,2067]},{"content":"CRBTree::FindFirstKeyAfter","pos":[2106,2132]},{"content":"Call this method to find the position of the element that uses the next available key.","pos":[2163,2249]},{"content":"CRBTree::GetAt","pos":[2255,2269]},{"content":"Call this method to get the element at a given position in the tree.","pos":[2288,2356]},{"content":"CRBTree::GetCount","pos":[2362,2379]},{"content":"Call this method to get the number of elements in the tree.","pos":[2401,2460]},{"content":"CRBTree::GetHeadPosition","pos":[2466,2490]},{"content":"Call this method to get the position value for the element at the head of the tree.","pos":[2519,2602]},{"content":"CRBTree::GetKeyAt","pos":[2608,2625]},{"content":"Call this method to get the key from a given position in the tree.","pos":[2647,2713]},{"content":"CRBTree::GetNext","pos":[2719,2735]},{"pos":[2756,2884],"content":"Call this method to obtain a pointer to an element stored in the <ph id=\"ph1\">`CRBTree`</ph> object, and advance the position to the next element.","source":"Call this method to obtain a pointer to an element stored in the `CRBTree` object, and advance the position to the next element."},{"content":"CRBTree::GetNextAssoc","pos":[2890,2911]},{"content":"Call this method to get the key and value of an element stored in the map and advance the position to the next element.","pos":[2937,3056]},{"content":"CRBTree::GetNextKey","pos":[3062,3081]},{"content":"Call this method to get the key of an element stored in the tree and advance the position to the next element.","pos":[3105,3215]},{"content":"CRBTree::GetNextValue","pos":[3221,3242]},{"content":"Call this method to get the value of an element stored in the tree and advance the position to the next element.","pos":[3268,3380]},{"content":"CRBTree::GetPrev","pos":[3386,3402]},{"pos":[3423,3559],"content":"Call this method to obtain a pointer to an element stored in the <ph id=\"ph1\">`CRBTree`</ph> object, and then update the position to the previous element.","source":"Call this method to obtain a pointer to an element stored in the `CRBTree` object, and then update the position to the previous element."},{"content":"CRBTree::GetTailPosition","pos":[3565,3589]},{"content":"Call this method to get the position value for the element at the tail of the tree.","pos":[3618,3701]},{"content":"CRBTree::GetValueAt","pos":[3707,3726]},{"pos":[3750,3840],"content":"Call this method to retrieve the value stored at a given position in the <ph id=\"ph1\">`CRBTree`</ph> object.","source":"Call this method to retrieve the value stored at a given position in the `CRBTree` object."},{"content":"CRBTree::IsEmpty","pos":[3846,3862]},{"content":"Call this method to test for an empty tree object.","pos":[3883,3933]},{"content":"CRBTree::RemoveAll","pos":[3939,3957]},{"pos":[3980,4048],"content":"Call this method to remove all elements from the <bpt id=\"p1\">**</bpt>CRBTree<ept id=\"p1\">**</ept> object.","source":"Call this method to remove all elements from the **CRBTree** object."},{"content":"CRBTree::RemoveAt","pos":[4054,4071]},{"pos":[4093,4180],"content":"Call this method to remove the element at the given position in the <bpt id=\"p1\">**</bpt>CRBTree<ept id=\"p1\">**</ept> object.","source":"Call this method to remove the element at the given position in the **CRBTree** object."},{"content":"CRBTree::SetValueAt","pos":[4186,4205]},{"pos":[4229,4317],"content":"Call this method to change the value stored at a given position in the <ph id=\"ph1\">`CRBTree`</ph> object.","source":"Call this method to change the value stored at a given position in the `CRBTree` object."},{"content":"Remarks","pos":[4327,4334]},{"content":"A Red-Black tree is a binary search tree that uses an extra bit of information per node to ensure that it remains \"balanced,\" that is, the tree height doesn't grow disproportionately large and affect performance.","pos":[4338,4550]},{"content":"This template class is designed to be used by <bpt id=\"p1\">[</bpt>CRBMap<ept id=\"p1\">](../../atl/reference/crbmap-class.md)</ept> and <bpt id=\"p2\">[</bpt>CRBMultiMap<ept id=\"p2\">](../../atl/reference/crbmultimap-class.md)</ept>.","pos":[4557,4709],"source":"This template class is designed to be used by [CRBMap](../../atl/reference/crbmap-class.md) and [CRBMultiMap](../../atl/reference/crbmultimap-class.md)."},{"content":"The bulk of the methods that make up these derived classes are provided by <ph id=\"ph1\">`CRBTree`</ph>.","pos":[4710,4795],"source":" The bulk of the methods that make up these derived classes are provided by `CRBTree`."},{"pos":[4802,4985],"content":"For a more complete discussion of the various collection classes and their features and performance characteristics, see <bpt id=\"p1\">[</bpt>ATL Collection Classes<ept id=\"p1\">](../../atl/atl-collection-classes.md)</ept>.","source":"For a more complete discussion of the various collection classes and their features and performance characteristics, see [ATL Collection Classes](../../atl/atl-collection-classes.md)."},{"content":"Requirements","pos":[4994,5006]},{"pos":[5010,5031],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcoll.h","source":"**Header:** atlcoll.h"},{"pos":[5078,5098],"content":"CRBTree::CPair Class"},{"content":"A class containing the key and value elements.","pos":[5102,5148]},{"content":"Remarks","pos":[5203,5210]},{"pos":[5214,5430],"content":"This class is used by the methods <bpt id=\"p1\">[</bpt>CRBTree::GetAt<ept id=\"p1\">](#crbtree__getat)</ept>, <bpt id=\"p2\">[</bpt>CRBTree::GetNext<ept id=\"p2\">](#crbtree__getnext)</ept>, and <bpt id=\"p3\">[</bpt>CRBTree::GetPrev<ept id=\"p3\">](#crbtree__getprev)</ept> to access the key and value elements stored in the tree structure.","source":"This class is used by the methods [CRBTree::GetAt](#crbtree__getat), [CRBTree::GetNext](#crbtree__getnext), and [CRBTree::GetPrev](#crbtree__getprev) to access the key and value elements stored in the tree structure."},{"content":"The members are as follows:","pos":[5437,5464]},{"content":"The data member storing the key element.","pos":[5493,5533]},{"content":"The data member storing the value element.","pos":[5548,5590]},{"pos":[5639,5656],"content":"CRBTree::~CRBTree"},{"content":"The destructor.","pos":[5660,5675]},{"content":"Remarks","pos":[5718,5725]},{"content":"Frees any allocated resources.","pos":[5729,5759]},{"content":"Calls <bpt id=\"p1\">[</bpt>CRBTree::RemoveAll<ept id=\"p1\">](#crbtree__removeall)</ept> to delete all elements.","pos":[5760,5831],"source":" Calls [CRBTree::RemoveAll](#crbtree__removeall) to delete all elements."},{"pos":[5884,5910],"content":"CRBTree::FindFirstKeyAfter"},{"content":"Call this method to find the position of the element that uses the next available key.","pos":[5914,6000]},{"content":"Parameters","pos":[6083,6093]},{"content":"A key value.","pos":[6106,6118]},{"content":"Return Value","pos":[6128,6140]},{"content":"Returns the position value of the element that uses the next available key.","pos":[6144,6219]},{"content":"If there are no more elements, NULL is returned.","pos":[6220,6268]},{"content":"Remarks","pos":[6278,6285]},{"content":"This method makes it easy to traverse the tree without having to calculate position values beforehand.","pos":[6289,6391]},{"pos":[6432,6446],"content":"CRBTree::GetAt"},{"content":"Call this method to get the element at a given position in the tree.","pos":[6450,6518]},{"content":"Parameters","pos":[6717,6727]},{"content":"The position value.","pos":[6740,6759]},{"content":"The variable that receives the key.","pos":[6775,6810]},{"content":"value","pos":[6818,6823]},{"content":"The variable that receives the value.","pos":[6828,6865]},{"content":"Return Value","pos":[6875,6887]},{"content":"The first two forms return a pointer to a <bpt id=\"p1\">[</bpt>CPair<ept id=\"p1\">](#crbtree__cpair_class)</ept>.","pos":[6891,6964],"source":"The first two forms return a pointer to a [CPair](#crbtree__cpair_class)."},{"content":"The third form obtains a key and a value for the given position.","pos":[6965,7029]},{"content":"Remarks","pos":[7039,7046]},{"pos":[7050,7241],"content":"The position value can be previously determined with a call to a method such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](#crbtree__getheadposition)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::GetTailPosition<ept id=\"p2\">](#crbtree__gettailposition)</ept>.","source":"The position value can be previously determined with a call to a method such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::GetTailPosition](#crbtree__gettailposition)."},{"pos":[7248,7323],"content":"In debug builds, an assertion failure will occur if <ph id=\"ph1\">`pos`</ph> is equal to NULL.","source":"In debug builds, an assertion failure will occur if `pos` is equal to NULL."},{"pos":[7367,7384],"content":"CRBTree::GetCount"},{"content":"Call this method to get the number of elements in the tree.","pos":[7388,7447]},{"content":"Return Value","pos":[7503,7515]},{"content":"Returns the number of elements (each key/value pair is one element) stored in the tree.","pos":[7519,7606]},{"pos":[7657,7681],"content":"CRBTree::GetHeadPosition"},{"content":"Call this method to get the position value for the element at the head of the tree.","pos":[7685,7768]},{"content":"Return Value","pos":[7833,7845]},{"content":"Returns the position value for the element at the head of the tree.","pos":[7849,7916]},{"content":"Remarks","pos":[7926,7933]},{"pos":[7937,8132],"content":"The value returned by <ph id=\"ph1\">`GetHeadPosition`</ph> can be used with methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetKeyAt<ept id=\"p1\">](#crbtree__getkeyat)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::GetNext<ept id=\"p2\">](#crbtree__getnext)</ept> to traverse the tree and retrieve values.","source":"The value returned by `GetHeadPosition` can be used with methods such as [CRBTree::GetKeyAt](#crbtree__getkeyat) or [CRBTree::GetNext](#crbtree__getnext) to traverse the tree and retrieve values."},{"pos":[8176,8193],"content":"CRBTree::GetKeyAt"},{"content":"Call this method to get the key from a given position in the tree.","pos":[8197,8263]},{"content":"Parameters","pos":[8335,8345]},{"content":"The position value.","pos":[8358,8377]},{"content":"Return Value","pos":[8387,8399]},{"pos":[8403,8456],"content":"Returns the key stored at position <ph id=\"ph1\">`pos`</ph> in the tree.","source":"Returns the key stored at position `pos` in the tree."},{"content":"Remarks","pos":[8466,8473]},{"content":"If <ph id=\"ph1\">`pos`</ph> is not a valid position value, results are unpredictable.","pos":[8477,8543],"source":"If `pos` is not a valid position value, results are unpredictable."},{"content":"In debug builds, an assertion failure will occur if <ph id=\"ph1\">`pos`</ph> is equal to NULL.","pos":[8544,8619],"source":" In debug builds, an assertion failure will occur if `pos` is equal to NULL."},{"pos":[8662,8678],"content":"CRBTree::GetNext"},{"pos":[8682,8810],"content":"Call this method to obtain a pointer to an element stored in the <ph id=\"ph1\">`CRBTree`</ph> object, and advance the position to the next element.","source":"Call this method to obtain a pointer to an element stored in the `CRBTree` object, and advance the position to the next element."},{"content":"Parameters","pos":[8923,8933]},{"content":"The position counter, returned by a previous call to methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](#crbtree__getheadposition)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::FindFirstKeyAfter<ept id=\"p2\">](#crbtree__findfirstkeyafter)</ept>.","pos":[8946,9130],"source":" The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter)."},{"content":"Return Value","pos":[9140,9152]},{"pos":[9156,9235],"content":"Returns a pointer to the next <bpt id=\"p1\">[</bpt>CPair<ept id=\"p1\">](#crbtree__cpair_class)</ept> value in the tree.","source":"Returns a pointer to the next [CPair](#crbtree__cpair_class) value in the tree."},{"content":"Remarks","pos":[9245,9252]},{"content":"The <ph id=\"ph1\">`pos`</ph> position counter is updated after each call.","pos":[9256,9310],"source":"The `pos` position counter is updated after each call."},{"content":"If the retrieved element is the last in the tree, <ph id=\"ph1\">`pos`</ph> is set to NULL.","pos":[9311,9382],"source":" If the retrieved element is the last in the tree, `pos` is set to NULL."},{"pos":[9430,9451],"content":"CRBTree::GetNextAssoc"},{"content":"Call this method to get the key and value of an element stored in the map and advance the position to the next element.","pos":[9455,9574]},{"content":"Parameters","pos":[9686,9696]},{"content":"The position counter, returned by a previous call to methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](#crbtree__getheadposition)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::FindFirstKeyAfter<ept id=\"p2\">](#crbtree__findfirstkeyafter)</ept>.","pos":[9709,9893],"source":" The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter)."},{"content":"Template parameter specifying the type of the tree's key.","pos":[9909,9966]},{"content":"value","pos":[9974,9979]},{"content":"Template parameter specifying the type of the tree's value.","pos":[9984,10043]},{"content":"Remarks","pos":[10053,10060]},{"content":"The <ph id=\"ph1\">`pos`</ph> position counter is updated after each call.","pos":[10064,10118],"source":"The `pos` position counter is updated after each call."},{"content":"If the retrieved element is the last in the tree, <ph id=\"ph1\">`pos`</ph> is set to NULL.","pos":[10119,10190],"source":" If the retrieved element is the last in the tree, `pos` is set to NULL."},{"pos":[10236,10255],"content":"CRBTree::GetNextKey"},{"content":"Call this method to get the key of an element stored in the tree and advance the position to the next element.","pos":[10259,10369]},{"content":"Parameters","pos":[10442,10452]},{"content":"The position counter, returned by a previous call to methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](#crbtree__getheadposition)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::FindFirstKeyAfter<ept id=\"p2\">](#crbtree__findfirstkeyafter)</ept>.","pos":[10465,10649],"source":" The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter)."},{"content":"Return Value","pos":[10659,10671]},{"content":"Returns a reference to the next key in the tree.","pos":[10675,10723]},{"content":"Remarks","pos":[10733,10740]},{"content":"Updates the current position counter, <ph id=\"ph1\">`pos`</ph>.","pos":[10744,10788],"source":"Updates the current position counter, `pos`."},{"content":"If there are no more entries in the tree, the position counter is set to NULL.","pos":[10789,10867]},{"pos":[10915,10936],"content":"CRBTree::GetNextValue"},{"content":"Call this method to get the value of an element stored in the tree and advance the position to the next element.","pos":[10940,11052]},{"content":"Parameters","pos":[11167,11177]},{"content":"The position counter, returned by a previous call to methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](#crbtree__getheadposition)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::FindFirstKeyAfter<ept id=\"p2\">](#crbtree__findfirstkeyafter)</ept>.","pos":[11190,11374],"source":" The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter)."},{"content":"Return Value","pos":[11384,11396]},{"content":"Returns a reference to the next value in the tree.","pos":[11400,11450]},{"content":"Remarks","pos":[11460,11467]},{"content":"Updates the current position counter, <ph id=\"ph1\">`pos`</ph>.","pos":[11471,11515],"source":"Updates the current position counter, `pos`."},{"content":"If there are no more entries in the tree, the position counter is set to NULL.","pos":[11516,11594]},{"pos":[11637,11653],"content":"CRBTree::GetPrev"},{"pos":[11657,11793],"content":"Call this method to obtain a pointer to an element stored in the <ph id=\"ph1\">`CRBTree`</ph> object, and then update the position to the previous element.","source":"Call this method to obtain a pointer to an element stored in the `CRBTree` object, and then update the position to the previous element."},{"content":"Parameters","pos":[11906,11916]},{"content":"The position counter, returned by a previous call to methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](#crbtree__getheadposition)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::FindFirstKeyAfter<ept id=\"p2\">](#crbtree__findfirstkeyafter)</ept>.","pos":[11929,12113],"source":" The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter)."},{"content":"Return Value","pos":[12123,12135]},{"pos":[12139,12229],"content":"Returns a pointer to the previous <bpt id=\"p1\">[</bpt>CPair<ept id=\"p1\">](#crbtree__cpair_class)</ept> value stored in the tree.","source":"Returns a pointer to the previous [CPair](#crbtree__cpair_class) value stored in the tree."},{"content":"Remarks","pos":[12239,12246]},{"content":"Updates the current position counter, <ph id=\"ph1\">`pos`</ph>.","pos":[12250,12294],"source":"Updates the current position counter, `pos`."},{"content":"If there are no more entries in the tree, the position counter is set to NULL.","pos":[12295,12373]},{"pos":[12424,12448],"content":"CRBTree::GetTailPosition"},{"content":"Call this method to get the position value for the element at the tail of the tree.","pos":[12452,12535]},{"content":"Return Value","pos":[12600,12612]},{"content":"Returns the position value for the element at the tail of the tree.","pos":[12616,12683]},{"content":"Remarks","pos":[12693,12700]},{"pos":[12704,12899],"content":"The value returned by <ph id=\"ph1\">`GetTailPosition`</ph> can be used with methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetKeyAt<ept id=\"p1\">](#crbtree__getkeyat)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::GetPrev<ept id=\"p2\">](#crbtree__getprev)</ept> to traverse the tree and retrieve values.","source":"The value returned by `GetTailPosition` can be used with methods such as [CRBTree::GetKeyAt](#crbtree__getkeyat) or [CRBTree::GetPrev](#crbtree__getprev) to traverse the tree and retrieve values."},{"pos":[12945,12964],"content":"CRBTree::GetValueAt"},{"pos":[12968,13058],"content":"Call this method to retrieve the value stored at a given position in the <ph id=\"ph1\">`CRBTree`</ph> object.","source":"Call this method to retrieve the value stored at a given position in the `CRBTree` object."},{"content":"Parameters","pos":[13171,13181]},{"content":"The position counter, returned by a previous call to methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](#crbtree__getheadposition)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::FindFirstKeyAfter<ept id=\"p2\">](#crbtree__findfirstkeyafter)</ept>.","pos":[13194,13378],"source":" The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter)."},{"content":"Return Value","pos":[13388,13400]},{"pos":[13404,13490],"content":"Returns a reference to the value stored at the given position in the <ph id=\"ph1\">`CRBTree`</ph> object.","source":"Returns a reference to the value stored at the given position in the `CRBTree` object."},{"pos":[13533,13549],"content":"CRBTree::IsEmpty"},{"content":"Call this method to test for an empty tree object.","pos":[13553,13603]},{"content":"Return Value","pos":[13656,13668]},{"pos":[13672,13731],"content":"Returns <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> if the tree is empty, <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept> otherwise.","source":"Returns **true** if the tree is empty, **false** otherwise."},{"pos":[13777,13796],"content":"CRBTree::KINARGTYPE"},{"content":"Type used when a key is passed as an input argument.","pos":[13800,13852]},{"pos":[13951,13971],"content":"CRBTree::KOUTARGTYPE"},{"content":"Type used when a key is returned as an output argument.","pos":[13975,14030]},{"pos":[14129,14147],"content":"CRBTree::RemoveAll"},{"pos":[14151,14217],"content":"Call this method to remove all elements from the <ph id=\"ph1\">`CRBTree`</ph> object.","source":"Call this method to remove all elements from the `CRBTree` object."},{"content":"Remarks","pos":[14266,14273]},{"pos":[14277,14356],"content":"Clears out the <ph id=\"ph1\">`CRBTree`</ph> object, freeing the memory used to store the elements.","source":"Clears out the `CRBTree` object, freeing the memory used to store the elements."},{"pos":[14400,14417],"content":"CRBTree::RemoveAt"},{"pos":[14421,14508],"content":"Call this method to remove the element at the given position in the <bpt id=\"p1\">**</bpt>CRBTree<ept id=\"p1\">**</ept> object.","source":"Call this method to remove the element at the given position in the **CRBTree** object."},{"content":"Parameters","pos":[14570,14580]},{"content":"The position counter, returned by a previous call to methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](#crbtree__getheadposition)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::FindFirstKeyAfter<ept id=\"p2\">](#crbtree__findfirstkeyafter)</ept>.","pos":[14593,14777],"source":" The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter)."},{"content":"Remarks","pos":[14787,14794]},{"content":"Removes the key/value pair stored at the specified position.","pos":[14798,14858]},{"content":"The memory used to store the element is freed.","pos":[14859,14905]},{"content":"The POSITION referenced by <ph id=\"ph1\">`pos`</ph> becomes invalid, and while the POSITION of any other elements in the tree remains valid, they do not necessarily retain the same order.","pos":[14906,15074],"source":" The POSITION referenced by `pos` becomes invalid, and while the POSITION of any other elements in the tree remains valid, they do not necessarily retain the same order."},{"pos":[15120,15139],"content":"CRBTree::SetValueAt"},{"pos":[15143,15231],"content":"Call this method to change the value stored at a given position in the <ph id=\"ph1\">`CRBTree`</ph> object.","source":"Call this method to change the value stored at a given position in the `CRBTree` object."},{"content":"Parameters","pos":[15312,15322]},{"content":"The position counter, returned by a previous call to methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](#crbtree__getheadposition)</ept> or <bpt id=\"p2\">[</bpt>CRBTree::FindFirstKeyAfter<ept id=\"p2\">](#crbtree__findfirstkeyafter)</ept>.","pos":[15335,15519],"source":" The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter)."},{"content":"value","pos":[15527,15532]},{"content":"The value to add to the <ph id=\"ph1\">`CRBTree`</ph> object.","pos":[15537,15578],"source":" The value to add to the `CRBTree` object."},{"content":"Remarks","pos":[15588,15595]},{"pos":[15599,15678],"content":"Changes the value element stored at the given position in the <ph id=\"ph1\">`CRBTree`</ph> object.","source":"Changes the value element stored at the given position in the `CRBTree` object."},{"pos":[15724,15743],"content":"CRBTree::VINARGTYPE"},{"content":"Type used when a value is passed as an input argument.","pos":[15747,15801]},{"pos":[15900,15920],"content":"CRBTree::VOUTARGTYPE"},{"content":"Type used when a value is passed as an output argument.","pos":[15924,15979]},{"content":"See Also","pos":[16042,16050]},{"content":"Class Overview","pos":[16055,16069]}],"content":"---\ntitle: \"CRBTree Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL.CRBTree\"\n  - \"CRBTree\"\n  - \"ATL::CRBTree\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CRBTree class\"\nms.assetid: a1b1cb63-38e4-4fc2-bb28-f774d1721760\ncaps.latest.revision: 18\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CRBTree Class\nThis class provides methods for creating and utilizing a Red-Black tree.  \n  \n## Syntax  \n  \n```\ntemplate <typename   K,\n    typename V, class KTraits = CElementTraits<K>, class VTraits = CElementTraits<V>> class CRBTree\n```  \n  \n#### Parameters  \n `K`  \n The key element type.  \n  \n *V*  \n The value element type.  \n  \n `KTraits`  \n The code used to copy or move key elements. See [CElementTraits Class](../../atl/reference/celementtraits-class.md) for more details.  \n  \n `VTraits`  \n The code used to copy or move value elements.  \n  \n## Members  \n  \n### Public Typedefs  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRBTree::KINARGTYPE](#crbtree__kinargtype)|Type used when a key is passed as an input argument.|  \n|[CRBTree::KOUTARGTYPE](#crbtree__koutargtype)|Type used when a key is returned as an output argument.|  \n|[CRBTree::VINARGTYPE](#crbtree__vinargtype)|Type used when a value is passed as an input argument.|  \n|[CRBTree::VOUTARGTYPE](#crbtree__voutargtype)|Type used when a value is passed as an output argument.|  \n  \n### Public Classes  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRBTree::CPair Class](#crbtree__cpair_class)|A class containing the key and value elements.|  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRBTree::~CRBTree](#crbtree___dtorcrbtree)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter)|Call this method to find the position of the element that uses the next available key.|  \n|[CRBTree::GetAt](#crbtree__getat)|Call this method to get the element at a given position in the tree.|  \n|[CRBTree::GetCount](#crbtree__getcount)|Call this method to get the number of elements in the tree.|  \n|[CRBTree::GetHeadPosition](#crbtree__getheadposition)|Call this method to get the position value for the element at the head of the tree.|  \n|[CRBTree::GetKeyAt](#crbtree__getkeyat)|Call this method to get the key from a given position in the tree.|  \n|[CRBTree::GetNext](#crbtree__getnext)|Call this method to obtain a pointer to an element stored in the `CRBTree` object, and advance the position to the next element.|  \n|[CRBTree::GetNextAssoc](#crbtree__getnextassoc)|Call this method to get the key and value of an element stored in the map and advance the position to the next element.|  \n|[CRBTree::GetNextKey](#crbtree__getnextkey)|Call this method to get the key of an element stored in the tree and advance the position to the next element.|  \n|[CRBTree::GetNextValue](#crbtree__getnextvalue)|Call this method to get the value of an element stored in the tree and advance the position to the next element.|  \n|[CRBTree::GetPrev](#crbtree__getprev)|Call this method to obtain a pointer to an element stored in the `CRBTree` object, and then update the position to the previous element.|  \n|[CRBTree::GetTailPosition](#crbtree__gettailposition)|Call this method to get the position value for the element at the tail of the tree.|  \n|[CRBTree::GetValueAt](#crbtree__getvalueat)|Call this method to retrieve the value stored at a given position in the `CRBTree` object.|  \n|[CRBTree::IsEmpty](#crbtree__isempty)|Call this method to test for an empty tree object.|  \n|[CRBTree::RemoveAll](#crbtree__removeall)|Call this method to remove all elements from the **CRBTree** object.|  \n|[CRBTree::RemoveAt](#crbtree__removeat)|Call this method to remove the element at the given position in the **CRBTree** object.|  \n|[CRBTree::SetValueAt](#crbtree__setvalueat)|Call this method to change the value stored at a given position in the `CRBTree` object.|  \n  \n## Remarks  \n A Red-Black tree is a binary search tree that uses an extra bit of information per node to ensure that it remains \"balanced,\" that is, the tree height doesn't grow disproportionately large and affect performance.  \n  \n This template class is designed to be used by [CRBMap](../../atl/reference/crbmap-class.md) and [CRBMultiMap](../../atl/reference/crbmultimap-class.md). The bulk of the methods that make up these derived classes are provided by `CRBTree`.  \n  \n For a more complete discussion of the various collection classes and their features and performance characteristics, see [ATL Collection Classes](../../atl/atl-collection-classes.md).  \n  \n## Requirements  \n **Header:** atlcoll.h  \n  \n##  <a name=\"crbtree__cpair_class\"></a>  CRBTree::CPair Class  \n A class containing the key and value elements.  \n  \n```\nclass CPair : public __POSITION\n```  \n  \n### Remarks  \n This class is used by the methods [CRBTree::GetAt](#crbtree__getat), [CRBTree::GetNext](#crbtree__getnext), and [CRBTree::GetPrev](#crbtree__getprev) to access the key and value elements stored in the tree structure.  \n  \n The members are as follows:  \n  \n|||  \n|-|-|  \n|`m_key`|The data member storing the key element.|  \n|`m_value`|The data member storing the value element.|  \n  \n##  <a name=\"crbtree___dtorcrbtree\"></a>  CRBTree::~CRBTree  \n The destructor.  \n  \n```\n~CRBTree() throw();\n```  \n  \n### Remarks  \n Frees any allocated resources. Calls [CRBTree::RemoveAll](#crbtree__removeall) to delete all elements.  \n  \n##  <a name=\"crbtree__findfirstkeyafter\"></a>  CRBTree::FindFirstKeyAfter  \n Call this method to find the position of the element that uses the next available key.  \n  \n```\nPOSITION FindFirstKeyAfter(KINARGTYPE   key) const throw();\n```  \n  \n### Parameters  \n `key`  \n A key value.  \n  \n### Return Value  \n Returns the position value of the element that uses the next available key. If there are no more elements, NULL is returned.  \n  \n### Remarks  \n This method makes it easy to traverse the tree without having to calculate position values beforehand.  \n  \n##  <a name=\"crbtree__getat\"></a>  CRBTree::GetAt  \n Call this method to get the element at a given position in the tree.  \n  \n```\nCPair* GetAt(\n    POSITION pos) throw();\n\nconst CPair* GetAt(\n    POSITION pos) const throw();\nvoid GetAt(\n    POSITION pos,\n    KOUTARGTYPE key,\n    VOUTARGTYPE value) const;\n```  \n  \n### Parameters  \n `pos`  \n The position value.  \n  \n `key`  \n The variable that receives the key.  \n  \n *value*  \n The variable that receives the value.  \n  \n### Return Value  \n The first two forms return a pointer to a [CPair](#crbtree__cpair_class). The third form obtains a key and a value for the given position.  \n  \n### Remarks  \n The position value can be previously determined with a call to a method such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::GetTailPosition](#crbtree__gettailposition).  \n  \n In debug builds, an assertion failure will occur if `pos` is equal to NULL.  \n  \n##  <a name=\"crbtree__getcount\"></a>  CRBTree::GetCount  \n Call this method to get the number of elements in the tree.  \n  \n```\nsize_t GetCount() const throw();\n```  \n  \n### Return Value  \n Returns the number of elements (each key/value pair is one element) stored in the tree.  \n  \n##  <a name=\"crbtree__getheadposition\"></a>  CRBTree::GetHeadPosition  \n Call this method to get the position value for the element at the head of the tree.  \n  \n```\nPOSITION GetHeadPosition() const throw();\n```  \n  \n### Return Value  \n Returns the position value for the element at the head of the tree.  \n  \n### Remarks  \n The value returned by `GetHeadPosition` can be used with methods such as [CRBTree::GetKeyAt](#crbtree__getkeyat) or [CRBTree::GetNext](#crbtree__getnext) to traverse the tree and retrieve values.  \n  \n##  <a name=\"crbtree__getkeyat\"></a>  CRBTree::GetKeyAt  \n Call this method to get the key from a given position in the tree.  \n  \n```\nconst K& GetKeyAt(POSITION   pos) const throw();\n```  \n  \n### Parameters  \n `pos`  \n The position value.  \n  \n### Return Value  \n Returns the key stored at position `pos` in the tree.  \n  \n### Remarks  \n If `pos` is not a valid position value, results are unpredictable. In debug builds, an assertion failure will occur if `pos` is equal to NULL.  \n  \n##  <a name=\"crbtree__getnext\"></a>  CRBTree::GetNext  \n Call this method to obtain a pointer to an element stored in the `CRBTree` object, and advance the position to the next element.  \n  \n```\nconst CPair* GetNext(POSITION& pos) const throw();\nCPair* GetNext(POSITION& pos) throw();\n```  \n  \n### Parameters  \n `pos`  \n The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter).  \n  \n### Return Value  \n Returns a pointer to the next [CPair](#crbtree__cpair_class) value in the tree.  \n  \n### Remarks  \n The `pos` position counter is updated after each call. If the retrieved element is the last in the tree, `pos` is set to NULL.  \n  \n##  <a name=\"crbtree__getnextassoc\"></a>  CRBTree::GetNextAssoc  \n Call this method to get the key and value of an element stored in the map and advance the position to the next element.  \n  \n```\nvoid GetNextAssoc(\n    POSITION& pos,\n    KOUTARGTYPE key,\n    VOUTARGTYPE value) const;\n```  \n  \n### Parameters  \n `pos`  \n The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter).  \n  \n `key`  \n Template parameter specifying the type of the tree's key.  \n  \n *value*  \n Template parameter specifying the type of the tree's value.  \n  \n### Remarks  \n The `pos` position counter is updated after each call. If the retrieved element is the last in the tree, `pos` is set to NULL.  \n  \n##  <a name=\"crbtree__getnextkey\"></a>  CRBTree::GetNextKey  \n Call this method to get the key of an element stored in the tree and advance the position to the next element.  \n  \n```\nconst K& GetNextKey(POSITION& pos) const throw();\n```  \n  \n### Parameters  \n `pos`  \n The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter).  \n  \n### Return Value  \n Returns a reference to the next key in the tree.  \n  \n### Remarks  \n Updates the current position counter, `pos`. If there are no more entries in the tree, the position counter is set to NULL.  \n  \n##  <a name=\"crbtree__getnextvalue\"></a>  CRBTree::GetNextValue  \n Call this method to get the value of an element stored in the tree and advance the position to the next element.  \n  \n```\nconst V& GetNextValue(POSITION& pos) const throw();\nV& GetNextValue(POSITION& pos) throw();\n```  \n  \n### Parameters  \n `pos`  \n The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter).  \n  \n### Return Value  \n Returns a reference to the next value in the tree.  \n  \n### Remarks  \n Updates the current position counter, `pos`. If there are no more entries in the tree, the position counter is set to NULL.  \n  \n##  <a name=\"crbtree__getprev\"></a>  CRBTree::GetPrev  \n Call this method to obtain a pointer to an element stored in the `CRBTree` object, and then update the position to the previous element.  \n  \n```\nconst CPair* GetPrev(POSITION& pos) const throw();\nCPair* GetPrev(POSITION& pos) throw();\n```  \n  \n### Parameters  \n `pos`  \n The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter).  \n  \n### Return Value  \n Returns a pointer to the previous [CPair](#crbtree__cpair_class) value stored in the tree.  \n  \n### Remarks  \n Updates the current position counter, `pos`. If there are no more entries in the tree, the position counter is set to NULL.  \n  \n##  <a name=\"crbtree__gettailposition\"></a>  CRBTree::GetTailPosition  \n Call this method to get the position value for the element at the tail of the tree.  \n  \n```\nPOSITION GetTailPosition() const throw();\n```  \n  \n### Return Value  \n Returns the position value for the element at the tail of the tree.  \n  \n### Remarks  \n The value returned by `GetTailPosition` can be used with methods such as [CRBTree::GetKeyAt](#crbtree__getkeyat) or [CRBTree::GetPrev](#crbtree__getprev) to traverse the tree and retrieve values.  \n  \n##  <a name=\"crbtree__getvalueat\"></a>  CRBTree::GetValueAt  \n Call this method to retrieve the value stored at a given position in the `CRBTree` object.  \n  \n```\nconst V& GetValueAt(POSITION   pos) const throw();\nV& GetValueAt(POSITION   pos) throw();\n```  \n  \n### Parameters  \n `pos`  \n The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter).  \n  \n### Return Value  \n Returns a reference to the value stored at the given position in the `CRBTree` object.  \n  \n##  <a name=\"crbtree__isempty\"></a>  CRBTree::IsEmpty  \n Call this method to test for an empty tree object.  \n  \n```\nbool IsEmpty() const throw();\n```  \n  \n### Return Value  \n Returns **true** if the tree is empty, **false** otherwise.  \n  \n##  <a name=\"crbtree__kinargtype\"></a>  CRBTree::KINARGTYPE  \n Type used when a key is passed as an input argument.  \n  \n```\ntypedef KTraits::INARGTYPE KINARGTYPE;\n```  \n  \n##  <a name=\"crbtree__koutargtype\"></a>  CRBTree::KOUTARGTYPE  \n Type used when a key is returned as an output argument.  \n  \n```\ntypedef KTraits::OUTARGTYPE KOUTARGTYPE;\n```  \n  \n##  <a name=\"crbtree__removeall\"></a>  CRBTree::RemoveAll  \n Call this method to remove all elements from the `CRBTree` object.  \n  \n```\nvoid RemoveAll() throw();\n```  \n  \n### Remarks  \n Clears out the `CRBTree` object, freeing the memory used to store the elements.  \n  \n##  <a name=\"crbtree__removeat\"></a>  CRBTree::RemoveAt  \n Call this method to remove the element at the given position in the **CRBTree** object.  \n  \n```\nvoid RemoveAt(POSITION   pos) throw();\n```  \n  \n### Parameters  \n `pos`  \n The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter).  \n  \n### Remarks  \n Removes the key/value pair stored at the specified position. The memory used to store the element is freed. The POSITION referenced by `pos` becomes invalid, and while the POSITION of any other elements in the tree remains valid, they do not necessarily retain the same order.  \n  \n##  <a name=\"crbtree__setvalueat\"></a>  CRBTree::SetValueAt  \n Call this method to change the value stored at a given position in the `CRBTree` object.  \n  \n```\nvoid SetValueAt(\n    POSITION pos,\n    VINARGTYPE value);\n```  \n  \n### Parameters  \n `pos`  \n The position counter, returned by a previous call to methods such as [CRBTree::GetHeadPosition](#crbtree__getheadposition) or [CRBTree::FindFirstKeyAfter](#crbtree__findfirstkeyafter).  \n  \n *value*  \n The value to add to the `CRBTree` object.  \n  \n### Remarks  \n Changes the value element stored at the given position in the `CRBTree` object.  \n  \n##  <a name=\"crbtree__vinargtype\"></a>  CRBTree::VINARGTYPE  \n Type used when a value is passed as an input argument.  \n  \n```\ntypedef VTraits::INARGTYPE VINARGTYPE;\n```  \n  \n##  <a name=\"crbtree__voutargtype\"></a>  CRBTree::VOUTARGTYPE  \n Type used when a value is passed as an output argument.  \n  \n```\ntypedef VTraits::OUTARGTYPE VOUTARGTYPE;\n```  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}