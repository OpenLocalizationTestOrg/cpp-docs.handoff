{"nodes":[{"pos":[12,75],"content":"Record Field Exchange: Using the RFX Functions | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Record Field Exchange: Using the RFX Functions | Microsoft Docs","pos":[0,63]}]},{"content":"Record Field Exchange: Using the RFX Functions","pos":[853,899]},{"pos":[900,1011],"content":"This topic explains how to use the RFX function calls that make up the body of your <ph id=\"ph1\">`DoFieldExchange`</ph> override.","source":"This topic explains how to use the RFX function calls that make up the body of your `DoFieldExchange` override."},{"pos":[1019,1438],"content":"[!NOTE]\n This topic applies to classes derived from [CRecordset](../../mfc/reference/crecordset-class.md) in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","leadings":["","> "],"nodes":[{"content":" This topic applies to classes derived from [CRecordset](../../mfc/reference/crecordset-class.md) in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","pos":[8,417],"nodes":[{"content":"This topic applies to classes derived from <bpt id=\"p1\">[</bpt>CRecordset<ept id=\"p1\">](../../mfc/reference/crecordset-class.md)</ept> in which bulk row fetching has not been implemented.","pos":[1,150],"source":" This topic applies to classes derived from [CRecordset](../../mfc/reference/crecordset-class.md) in which bulk row fetching has not been implemented."},{"content":"If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented.","pos":[151,240]},{"content":"Bulk RFX is similar to RFX.","pos":[241,268]},{"content":"To understand the differences, see <bpt id=\"p1\">[</bpt>Recordset: Fetching Records in Bulk (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)</ept>.","pos":[269,409],"source":" To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)."}]}]},{"content":"The RFX global functions exchange data between columns on the data source and field data members in your recordset.","pos":[1445,1560]},{"content":"You write the RFX function calls in your recordset's <bpt id=\"p1\">[</bpt>DoFieldExchange<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange)</ept> member function.","pos":[1561,1717],"source":" You write the RFX function calls in your recordset's [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) member function."},{"content":"This topic describes the functions briefly and shows the data types for which RFX functions are available.","pos":[1718,1824]},{"content":"<bpt id=\"p1\">[</bpt>Technical Note 43<ept id=\"p1\">](../../mfc/tn043-rfx-routines.md)</ept> describes how to write your own RFX functions for additional data types.","pos":[1825,1950],"source":"[Technical Note 43](../../mfc/tn043-rfx-routines.md) describes how to write your own RFX functions for additional data types."},{"pos":[2001,2020],"content":"RFX Function Syntax"},{"content":"Each RFX function takes three parameters (and some take an optional fourth or fifth parameter):","pos":[2024,2119]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CFieldExchange<ept id=\"p1\">](../../mfc/reference/cfieldexchange-class.md)</ept> object.","pos":[2129,2213],"source":"A pointer to a [CFieldExchange](../../mfc/reference/cfieldexchange-class.md) object."},{"content":"You simply pass along the <ph id=\"ph1\">`pFX`</ph> pointer passed to <ph id=\"ph2\">`DoFieldExchange`</ph>.","pos":[2214,2282],"source":" You simply pass along the `pFX` pointer passed to `DoFieldExchange`."},{"content":"The name of the column as it appears on the data source.","pos":[2292,2348]},{"content":"The name of the corresponding field data member or parameter data member in the recordset class.","pos":[2358,2454]},{"content":"(Optional) In some of the functions, the maximum length of the string or array being transferred.","pos":[2464,2561]},{"content":"This defaults to 255 bytes, but you might want to change it.","pos":[2562,2622]},{"content":"The maximum size is based on the maximum size of a <ph id=\"ph1\">`CString`</ph> object — <bpt id=\"p1\">**</bpt>INT_MAX<ept id=\"p1\">**</ept> (2,147,483,647) bytes — but you will probably encounter driver limits before that size.","pos":[2623,2792],"source":" The maximum size is based on the maximum size of a `CString` object — **INT_MAX** (2,147,483,647) bytes — but you will probably encounter driver limits before that size."},{"pos":[2802,2914],"content":"(Optional) In the <ph id=\"ph1\">`RFX_Text`</ph> function, you sometimes use a fifth parameter to specify the data type of a column.","source":"(Optional) In the `RFX_Text` function, you sometimes use a fifth parameter to specify the data type of a column."},{"content":"For more information, see the RFX functions under <bpt id=\"p1\">[</bpt>Macros and Globals<ept id=\"p1\">](../../mfc/reference/mfc-macros-and-globals.md)</ept> in the <bpt id=\"p2\">*</bpt>Class Library Reference<ept id=\"p2\">*</ept>.","pos":[2921,3072],"source":"For more information, see the RFX functions under [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md) in the *Class Library Reference*."},{"content":"For an example of when you might make special use of the parameters, see <bpt id=\"p1\">[</bpt>Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-obtaining-sums-and-other-aggregate-results-odbc.md)</ept>.","pos":[3073,3287],"source":" For an example of when you might make special use of the parameters, see [Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)](../../data/odbc/recordset-obtaining-sums-and-other-aggregate-results-odbc.md)."},{"pos":[3333,3347],"content":"RFX Data Types"},{"content":"The class library supplies RFX functions for transferring many different data types between the data source and your recordsets.","pos":[3351,3479]},{"content":"The following list summarizes the RFX functions by data type.","pos":[3480,3541]},{"content":"In cases where you must write your own RFX function calls, select from these functions by data type.","pos":[3542,3642]},{"content":"Function","pos":[3649,3657]},{"content":"Data type","pos":[3658,3667]},{"content":"BOOL","pos":[3720,3724]},{"content":"BYTE","pos":[3744,3748]},{"content":"double","pos":[3800,3806]},{"content":"float","pos":[3828,3833]},{"content":"long","pos":[3873,3877]},{"content":"For more information, see the RFX function documentation under <bpt id=\"p1\">[</bpt>Macros and Globals<ept id=\"p1\">](../../mfc/reference/mfc-macros-and-globals.md)</ept> in the <bpt id=\"p2\">*</bpt>Class Library Reference<ept id=\"p2\">*</ept>.","pos":[3971,4135],"source":"For more information, see the RFX function documentation under [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md) in the *Class Library Reference*."},{"content":"For information about how C++ data types map to SQL data types, see the table ANSI SQL Data Types Mapped to C++ Data Types in <bpt id=\"p1\">[</bpt>SQL: SQL and C++ Data Types (ODBC)<ept id=\"p1\">](../../data/odbc/sql-sql-and-cpp-data-types-odbc.md)</ept>.","pos":[4136,4351],"source":" For information about how C++ data types map to SQL data types, see the table ANSI SQL Data Types Mapped to C++ Data Types in [SQL: SQL and C++ Data Types (ODBC)](../../data/odbc/sql-sql-and-cpp-data-types-odbc.md)."},{"content":"See Also","pos":[4360,4368]},{"content":"Record Field Exchange (RFX)","pos":[4373,4400]},{"content":"Record Field Exchange: How RFX Works","pos":[4453,4489]},{"content":"Recordset: Parameterizing a Recordset (ODBC)","pos":[4552,4596]},{"content":"Recordset: Dynamically Binding Data Columns (ODBC)","pos":[4665,4715]},{"content":"CRecordset Class","pos":[4790,4806]},{"content":"CFieldExchange Class","pos":[4854,4874]}],"content":"---\ntitle: \"Record Field Exchange: Using the RFX Functions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ODBC [C++], data types\"\n  - \"data types [C++], ODBC record field exchange\"\n  - \"RFX (ODBC) [C++], function syntax and parameters\"\n  - \"DoFieldExchange method, and RFX functions\"\n  - \"ODBC [C++], RFX\"\n  - \"RFX (ODBC) [C++], data types\"\n  - \"function calls, RFX functions\"\nms.assetid: c594300b-5a29-4119-a68b-e7ca32def696\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Record Field Exchange: Using the RFX Functions\nThis topic explains how to use the RFX function calls that make up the body of your `DoFieldExchange` override.  \n  \n> [!NOTE]\n>  This topic applies to classes derived from [CRecordset](../../mfc/reference/crecordset-class.md) in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).  \n  \n The RFX global functions exchange data between columns on the data source and field data members in your recordset. You write the RFX function calls in your recordset's [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) member function. This topic describes the functions briefly and shows the data types for which RFX functions are available. [Technical Note 43](../../mfc/tn043-rfx-routines.md) describes how to write your own RFX functions for additional data types.  \n  \n##  <a name=\"_core_rfx_function_syntax\"></a> RFX Function Syntax  \n Each RFX function takes three parameters (and some take an optional fourth or fifth parameter):  \n  \n-   A pointer to a [CFieldExchange](../../mfc/reference/cfieldexchange-class.md) object. You simply pass along the `pFX` pointer passed to `DoFieldExchange`.  \n  \n-   The name of the column as it appears on the data source.  \n  \n-   The name of the corresponding field data member or parameter data member in the recordset class.  \n  \n-   (Optional) In some of the functions, the maximum length of the string or array being transferred. This defaults to 255 bytes, but you might want to change it. The maximum size is based on the maximum size of a `CString` object — **INT_MAX** (2,147,483,647) bytes — but you will probably encounter driver limits before that size.  \n  \n-   (Optional) In the `RFX_Text` function, you sometimes use a fifth parameter to specify the data type of a column.  \n  \n For more information, see the RFX functions under [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md) in the *Class Library Reference*. For an example of when you might make special use of the parameters, see [Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)](../../data/odbc/recordset-obtaining-sums-and-other-aggregate-results-odbc.md).  \n  \n##  <a name=\"_core_rfx_data_types\"></a> RFX Data Types  \n The class library supplies RFX functions for transferring many different data types between the data source and your recordsets. The following list summarizes the RFX functions by data type. In cases where you must write your own RFX function calls, select from these functions by data type.  \n  \n|Function|Data type|  \n|--------------|---------------|  \n|`RFX_Bool`|**BOOL**|  \n|`RFX_Byte`|**BYTE**|  \n|`RFX_Binary`|`CByteArray`|  \n|`RFX_Double`|**double**|  \n|`RFX_Single`|**float**|  \n|`RFX_Int`|`int`|  \n|`RFX_Long`|**long**|  \n|`RFX_LongBinary`|`CLongBinary`|  \n|`RFX_Text`|`CString`|  \n|`RFX_Date`|`CTime`|  \n  \n\n For more information, see the RFX function documentation under [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md) in the *Class Library Reference*. For information about how C++ data types map to SQL data types, see the table ANSI SQL Data Types Mapped to C++ Data Types in [SQL: SQL and C++ Data Types (ODBC)](../../data/odbc/sql-sql-and-cpp-data-types-odbc.md).  \n  \n## See Also  \n [Record Field Exchange (RFX)](../../data/odbc/record-field-exchange-rfx.md)   \n [Record Field Exchange: How RFX Works](../../data/odbc/record-field-exchange-how-rfx-works.md)   \n [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)   \n [Recordset: Dynamically Binding Data Columns (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)   \n [CRecordset Class](../../mfc/reference/crecordset-class.md)   \n [CFieldExchange Class](../../mfc/reference/cfieldexchange-class.md)"}