{"nodes":[{"pos":[12,42],"content":"CRowset Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CRowset Class | Microsoft Docs","pos":[0,30]}]},{"content":"CRowset Class","pos":[689,702]},{"content":"Encapsulates an OLE DB rowset object and several related interfaces and provides manipulation methods for rowset data.","pos":[703,821]},{"content":"Syntax","pos":[830,836]},{"content":"Parameters","pos":[923,933]},{"content":"An accessor class.","pos":[952,970]},{"content":"The default is <ph id=\"ph1\">`CAccessorBase`</ph>.","pos":[971,1002],"source":" The default is `CAccessorBase`."},{"content":"Members","pos":[1011,1018]},{"content":"Methods","pos":[1028,1035]},{"content":"AddRefRows","pos":[1057,1067]},{"content":"Increments the reference count associated with the current row.","pos":[1109,1172]},{"content":"Close","pos":[1178,1183]},{"pos":[1220,1270],"content":"Releases rows and the current <ph id=\"ph1\">`IRowset`</ph> interface.","source":"Releases rows and the current `IRowset` interface."},{"content":"Compare","pos":[1276,1283]},{"pos":[1322,1432],"content":"Compares two bookmarks using <bpt id=\"p1\">[</bpt>IRowsetLocate::Compare<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms709539.aspx)</ept>.","source":"Compares two bookmarks using [IRowsetLocate::Compare](https://msdn.microsoft.com/en-us/library/ms709539.aspx)."},{"content":"CRowset","pos":[1438,1445]},{"pos":[1484,1600],"content":"Creates a new <ph id=\"ph1\">`CRowset`</ph> object and (optionally) associates it with an <bpt id=\"p1\">**</bpt>IRowset<ept id=\"p1\">**</ept> interface supplied as a parameter.","source":"Creates a new `CRowset` object and (optionally) associates it with an **IRowset** interface supplied as a parameter."},{"content":"Delete","pos":[1606,1612]},{"pos":[1650,1768],"content":"Deletes rows from the rowset using <bpt id=\"p1\">[</bpt>IRowsetChange:DeleteRows<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms724362.aspx)</ept>.","source":"Deletes rows from the rowset using [IRowsetChange:DeleteRows](https://msdn.microsoft.com/en-us/library/ms724362.aspx)."},{"content":"FindNextRow","pos":[1774,1785]},{"content":"Finds the next matching row after the specified bookmark.","pos":[1828,1885]},{"content":"GetApproximatePosition","pos":[1891,1913]},{"content":"Returns the approximate position of a row corresponding to a bookmark.","pos":[1967,2037]},{"content":"GetData","pos":[2043,2050]},{"content":"Retrieves data from the rowset's copy of the row.","pos":[2089,2138]},{"content":"GetDataHere","pos":[2144,2155]},{"content":"Retrieves data from the specified buffer.","pos":[2198,2239]},{"content":"GetOriginalData","pos":[2245,2260]},{"content":"Retrieves the data most recently fetched from or transmitted to the data source, ignoring pending changes.","pos":[2307,2413]},{"content":"GetRowStatus","pos":[2419,2431]},{"content":"Returns the status of all rows.","pos":[2475,2506]},{"content":"Insert","pos":[2512,2518]},{"pos":[2556,2674],"content":"Creates and inserts a new row using <bpt id=\"p1\">[</bpt>IRowsetChange:InsertRow<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms716921.aspx)</ept>.","source":"Creates and inserts a new row using [IRowsetChange:InsertRow](https://msdn.microsoft.com/en-us/library/ms716921.aspx)."},{"content":"IsSameRow","pos":[2680,2689]},{"content":"Compares the specified row with the current row.","pos":[2730,2778]},{"content":"MoveFirst","pos":[2784,2793]},{"content":"Repositions the next-fetch location to the initial position.","pos":[2834,2894]},{"content":"MoveLast","pos":[2900,2908]},{"content":"Moves to the last record.","pos":[2948,2973]},{"content":"MoveNext","pos":[2979,2987]},{"content":"Fetches data from the next sequential row or a specified number of positions beyond the next row.","pos":[3027,3124]},{"content":"MovePrev","pos":[3130,3138]},{"content":"Moves to the previous record.","pos":[3178,3207]},{"content":"MoveToBookmark","pos":[3213,3227]},{"content":"Fetches the row marked by a bookmark or the row at a specified offset from that bookmark.","pos":[3273,3362]},{"content":"MoveToRatio","pos":[3368,3379]},{"content":"Fetches rows starting from a fractional position in the rowset.","pos":[3422,3485]},{"content":"ReleaseRows","pos":[3491,3502]},{"pos":[3545,3664],"content":"Calls <bpt id=\"p1\">[</bpt>IRowset::ReleaseRows<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms719771.aspx)</ept> to release the current row handle.","source":"Calls [IRowset::ReleaseRows](https://msdn.microsoft.com/en-us/library/ms719771.aspx) to release the current row handle."},{"content":"SetData","pos":[3670,3677]},{"pos":[3716,3851],"content":"Sets data values in one or more columns of a row using <bpt id=\"p1\">[</bpt>IRowsetChange:SetData<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms721232.aspx)</ept>.","source":"Sets data values in one or more columns of a row using [IRowsetChange:SetData](https://msdn.microsoft.com/en-us/library/ms721232.aspx)."},{"content":"Undo","pos":[3857,3861]},{"pos":[3897,3999],"content":"Undoes any changes made to a row since the last fetch or <bpt id=\"p1\">[</bpt>Update<ept id=\"p1\">](../../data/oledb/crowset-update.md)</ept>.","source":"Undoes any changes made to a row since the last fetch or [Update](../../data/oledb/crowset-update.md)."},{"content":"Update","pos":[4005,4011]},{"content":"Transmits any pending changes made to the current row since the last fetch or update.","pos":[4049,4134]},{"content":"UpdateAll","pos":[4140,4149]},{"content":"Transmits any pending changes made to all rows since the last fetch or update.","pos":[4190,4268]},{"content":"Remarks","pos":[4278,4285]},{"content":"In OLE DB, a rowset is the object through which a program sets and retrieves data.","pos":[4289,4371]},{"pos":[4378,4516],"content":"This class is not meant to be instantiated but rather passed as a template parameter to <ph id=\"ph1\">`CTable`</ph> or <ph id=\"ph2\">`CCommand`</ph> (<ph id=\"ph3\">`CRowset`</ph> is the default).","source":"This class is not meant to be instantiated but rather passed as a template parameter to `CTable` or `CCommand` (`CRowset` is the default)."},{"content":"Requirements","pos":[4525,4537]},{"pos":[4541,4563],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldbcli.h","source":"**Header:** atldbcli.h"},{"content":"See Also","pos":[4572,4580]},{"content":"DBViewer Sample","pos":[4585,4600]},{"content":"MultiRead Sample","pos":[4636,4652]},{"content":"MultiRead Attributes Sample","pos":[4688,4715]},{"content":"OLE DB Consumer Templates","pos":[4751,4776]},{"content":"OLE DB Consumer Templates Reference","pos":[4834,4869]}],"content":"---\ntitle: \"CRowset Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"ATL.CRowset<TAccessor>\"\n  - \"CRowset\"\n  - \"ATL::CRowset\"\n  - \"ATL::CRowset<TAccessor>\"\n  - \"ATL.CRowset\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CRowset class\"\nms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4\ncaps.latest.revision: 15\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CRowset Class\nEncapsulates an OLE DB rowset object and several related interfaces and provides manipulation methods for rowset data.  \n  \n## Syntax  \n  \n```  \ntemplate <class TAccessor = CAccessorBase>  \nclass CRowset  \n```  \n  \n#### Parameters  \n `TAccessor`  \n An accessor class. The default is `CAccessorBase`.  \n  \n## Members  \n  \n### Methods  \n  \n|||  \n|-|-|  \n|[AddRefRows](../../data/oledb/crowset-addrefrows.md)|Increments the reference count associated with the current row.|  \n|[Close](../../data/oledb/crowset-close.md)|Releases rows and the current `IRowset` interface.|  \n|[Compare](../../data/oledb/crowset-compare.md)|Compares two bookmarks using [IRowsetLocate::Compare](https://msdn.microsoft.com/en-us/library/ms709539.aspx).|  \n|[CRowset](../../data/oledb/crowset-crowset.md)|Creates a new `CRowset` object and (optionally) associates it with an **IRowset** interface supplied as a parameter.|  \n|[Delete](../../data/oledb/crowset-delete.md)|Deletes rows from the rowset using [IRowsetChange:DeleteRows](https://msdn.microsoft.com/en-us/library/ms724362.aspx).|  \n|[FindNextRow](../../data/oledb/crowset-findnextrow.md)|Finds the next matching row after the specified bookmark.|  \n|[GetApproximatePosition](../../data/oledb/crowset-getapproximateposition.md)|Returns the approximate position of a row corresponding to a bookmark.|  \n|[GetData](../../data/oledb/crowset-getdata.md)|Retrieves data from the rowset's copy of the row.|  \n|[GetDataHere](../../data/oledb/crowset-getdatahere.md)|Retrieves data from the specified buffer.|  \n|[GetOriginalData](../../data/oledb/crowset-getoriginaldata.md)|Retrieves the data most recently fetched from or transmitted to the data source, ignoring pending changes.|  \n|[GetRowStatus](../../data/oledb/crowset-getrowstatus.md)|Returns the status of all rows.|  \n|[Insert](../../data/oledb/crowset-insert.md)|Creates and inserts a new row using [IRowsetChange:InsertRow](https://msdn.microsoft.com/en-us/library/ms716921.aspx).|  \n|[IsSameRow](../../data/oledb/crowset-issamerow.md)|Compares the specified row with the current row.|  \n|[MoveFirst](../../data/oledb/crowset-movefirst.md)|Repositions the next-fetch location to the initial position.|  \n|[MoveLast](../../data/oledb/crowset-movelast.md)|Moves to the last record.|  \n|[MoveNext](../../data/oledb/crowset-movenext.md)|Fetches data from the next sequential row or a specified number of positions beyond the next row.|  \n|[MovePrev](../../data/oledb/crowset-moveprev.md)|Moves to the previous record.|  \n|[MoveToBookmark](../../data/oledb/crowset-movetobookmark.md)|Fetches the row marked by a bookmark or the row at a specified offset from that bookmark.|  \n|[MoveToRatio](../../data/oledb/crowset-movetoratio.md)|Fetches rows starting from a fractional position in the rowset.|  \n|[ReleaseRows](../../data/oledb/crowset-releaserows.md)|Calls [IRowset::ReleaseRows](https://msdn.microsoft.com/en-us/library/ms719771.aspx) to release the current row handle.|  \n|[SetData](../../data/oledb/crowset-setdata.md)|Sets data values in one or more columns of a row using [IRowsetChange:SetData](https://msdn.microsoft.com/en-us/library/ms721232.aspx).|  \n|[Undo](../../data/oledb/crowset-undo.md)|Undoes any changes made to a row since the last fetch or [Update](../../data/oledb/crowset-update.md).|  \n|[Update](../../data/oledb/crowset-update.md)|Transmits any pending changes made to the current row since the last fetch or update.|  \n|[UpdateAll](../../data/oledb/crowset-updateall.md)|Transmits any pending changes made to all rows since the last fetch or update.|  \n  \n## Remarks  \n In OLE DB, a rowset is the object through which a program sets and retrieves data.  \n  \n This class is not meant to be instantiated but rather passed as a template parameter to `CTable` or `CCommand` (`CRowset` is the default).  \n  \n## Requirements  \n **Header:** atldbcli.h  \n  \n## See Also  \n [DBViewer Sample](../../visual-cpp-samples.md)   \n [MultiRead Sample](../../visual-cpp-samples.md)   \n [MultiRead Attributes Sample](../../visual-cpp-samples.md)   \n [OLE DB Consumer Templates](../../data/oledb/ole-db-consumer-templates-cpp.md)   \n [OLE DB Consumer Templates Reference](../../data/oledb/ole-db-consumer-templates-reference.md)"}