{"nodes":[{"pos":[12,65],"content":"IDBSchemaRowsetImpl::SetRestrictions | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IDBSchemaRowsetImpl::SetRestrictions | Microsoft Docs","pos":[0,53]}]},{"content":"IDBSchemaRowsetImpl::SetRestrictions","pos":[744,780]},{"content":"Specifies which restrictions you support on a particular schema rowset.","pos":[781,852]},{"content":"Syntax","pos":[861,867]},{"content":"Parameters","pos":[1015,1025]},{"content":"[in] The number of restrictions in the <ph id=\"ph1\">`rgRestrictions`</ph> array and the number of GUIDs in the <ph id=\"ph2\">`rguidSchema`</ph> array.","pos":[1048,1161],"source":" [in] The number of restrictions in the `rgRestrictions` array and the number of GUIDs in the `rguidSchema` array."},{"content":"[in] An array of the GUIDs of the schema rowsets for which to fetch restrictions.","pos":[1185,1266]},{"content":"Each array element contains the GUID of one schema rowset (for example, <ph id=\"ph1\">`DBSCHEMA_TABLES`</ph>).","pos":[1267,1358],"source":" Each array element contains the GUID of one schema rowset (for example, `DBSCHEMA_TABLES`)."},{"content":"[in] An array of length <ph id=\"ph1\">`cRestrictions`</ph> of restriction values to be set.","pos":[1385,1457],"source":" [in] An array of length `cRestrictions` of restriction values to be set."},{"content":"Each element corresponds to the restrictions on the schema rowset identified by the GUID.","pos":[1458,1547]},{"content":"If a schema rowset is not supported by the provider, the element is set to zero.","pos":[1548,1628]},{"content":"Otherwise, the <bpt id=\"p1\">**</bpt>ULONG<ept id=\"p1\">**</ept> value contains a bit mask that represents the restrictions supported on that schema rowset.","pos":[1629,1745],"source":" Otherwise, the **ULONG** value contains a bit mask that represents the restrictions supported on that schema rowset."},{"content":"For more information on which restrictions correspond to a particular schema rowset, consult the table of schema rowset GUIDs in <bpt id=\"p1\">[</bpt>IDBSchemaRowset<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms713686.aspx)</ept> in the <bpt id=\"p2\">*</bpt>OLE DB Programmer's Reference<ept id=\"p2\">*</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[1746,2047],"source":" For more information on which restrictions correspond to a particular schema rowset, consult the table of schema rowset GUIDs in [IDBSchemaRowset](https://msdn.microsoft.com/en-us/library/ms713686.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Remarks","pos":[2056,2063]},{"content":"The <bpt id=\"p1\">**</bpt>IDBSchemaRowset<ept id=\"p1\">**</ept> object calls <ph id=\"ph1\">`SetRestrictions`</ph> to determine which restrictions you support on a particular schema rowset (it is called by <bpt id=\"p2\">[</bpt>GetSchemas<ept id=\"p2\">](../../data/oledb/idbschemarowsetimpl-getschemas.md)</ept> through an upcasted pointer).","pos":[2067,2307],"source":"The **IDBSchemaRowset** object calls `SetRestrictions` to determine which restrictions you support on a particular schema rowset (it is called by [GetSchemas](../../data/oledb/idbschemarowsetimpl-getschemas.md) through an upcasted pointer)."},{"content":"Restrictions allow consumers to fetch only matching rows (for example, find all the columns in the table \"MyTable\").","pos":[2308,2424]},{"content":"Restrictions are optional, and in the case in which none are supported (the default), all data is always returned.","pos":[2425,2539]},{"content":"The default implementation of this method sets the <ph id=\"ph1\">`rgRestrictions`</ph> array elements to 0.","pos":[2546,2634],"source":"The default implementation of this method sets the `rgRestrictions` array elements to 0."},{"content":"Override the default in your session class to set restrictions other than the default.","pos":[2635,2721]},{"pos":[2728,2862],"content":"For information on implementing schema rowset support, see <bpt id=\"p1\">[</bpt>Supporting Schema Rowsets<ept id=\"p1\">](../../data/oledb/supporting-schema-rowsets.md)</ept>.","source":"For information on implementing schema rowset support, see [Supporting Schema Rowsets](../../data/oledb/supporting-schema-rowsets.md)."},{"pos":[2869,2984],"content":"For an example of an provider that supports schema rowsets, see the <bpt id=\"p1\">[</bpt>UpdatePV<ept id=\"p1\">](../../visual-cpp-samples.md)</ept> sample.","source":"For an example of an provider that supports schema rowsets, see the [UpdatePV](../../visual-cpp-samples.md) sample."},{"pos":[2991,3207],"content":"For more information on schema rowsets, see <bpt id=\"p1\">[</bpt>IDBSchemaRowset<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms713686.aspx)</ept> in the <bpt id=\"p2\">*</bpt>OLE DB Programmer's Reference<ept id=\"p2\">*</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on schema rowsets, see [IDBSchemaRowset](https://msdn.microsoft.com/en-us/library/ms713686.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Requirements","pos":[3216,3228]},{"pos":[3232,3251],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldb.h","source":"**Header:** atldb.h"},{"content":"See Also","pos":[3260,3268]},{"content":"IDBSchemaRowsetImpl Class","pos":[3273,3298]},{"content":"IDBSchemaRowsetImpl Class Members","pos":[3352,3385]},{"content":"Schema Rowset Classes and Typedef Classes","pos":[3462,3503]},{"content":"Supporting Schema Rowsets","pos":[3573,3598]},{"content":"UpdatePV","pos":[3652,3660]}],"content":"---\ntitle: \"IDBSchemaRowsetImpl::SetRestrictions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"IDBSchemaRowsetImpl::SetRestrictions\"\n  - \"SetRestrictions\"\n  - \"IDBSchemaRowsetImpl.SetRestrictions\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"SetRestrictions method\"\nms.assetid: 707d5065-b853-4d38-9b67-3066b4d3b279\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# IDBSchemaRowsetImpl::SetRestrictions\nSpecifies which restrictions you support on a particular schema rowset.  \n  \n## Syntax  \n  \n```  \n  \n      void SetRestrictions(  \n   ULONG cRestrictions,  \n   GUID* /* rguidSchema */,  \n   ULONG* rgRestrictions   \n);  \n```  \n  \n#### Parameters  \n `cRestrictions`  \n [in] The number of restrictions in the `rgRestrictions` array and the number of GUIDs in the `rguidSchema` array.  \n  \n `rguidSchema`  \n [in] An array of the GUIDs of the schema rowsets for which to fetch restrictions. Each array element contains the GUID of one schema rowset (for example, `DBSCHEMA_TABLES`).  \n  \n `rgRestrictions`  \n [in] An array of length `cRestrictions` of restriction values to be set. Each element corresponds to the restrictions on the schema rowset identified by the GUID. If a schema rowset is not supported by the provider, the element is set to zero. Otherwise, the **ULONG** value contains a bit mask that represents the restrictions supported on that schema rowset. For more information on which restrictions correspond to a particular schema rowset, consult the table of schema rowset GUIDs in [IDBSchemaRowset](https://msdn.microsoft.com/en-us/library/ms713686.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## Remarks  \n The **IDBSchemaRowset** object calls `SetRestrictions` to determine which restrictions you support on a particular schema rowset (it is called by [GetSchemas](../../data/oledb/idbschemarowsetimpl-getschemas.md) through an upcasted pointer). Restrictions allow consumers to fetch only matching rows (for example, find all the columns in the table \"MyTable\"). Restrictions are optional, and in the case in which none are supported (the default), all data is always returned.  \n  \n The default implementation of this method sets the `rgRestrictions` array elements to 0. Override the default in your session class to set restrictions other than the default.  \n  \n For information on implementing schema rowset support, see [Supporting Schema Rowsets](../../data/oledb/supporting-schema-rowsets.md).  \n  \n For an example of an provider that supports schema rowsets, see the [UpdatePV](../../visual-cpp-samples.md) sample.  \n  \n For more information on schema rowsets, see [IDBSchemaRowset](https://msdn.microsoft.com/en-us/library/ms713686.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## Requirements  \n **Header:** atldb.h  \n  \n## See Also  \n [IDBSchemaRowsetImpl Class](../../data/oledb/idbschemarowsetimpl-class.md)   \n [IDBSchemaRowsetImpl Class Members](http://msdn.microsoft.com/en-us/e74f6f82-541c-42e7-b4c6-e2d4656a0649)   \n [Schema Rowset Classes and Typedef Classes](../../data/oledb/schema-rowset-classes-and-typedef-classes.md)   \n [Supporting Schema Rowsets](../../data/oledb/supporting-schema-rowsets.md)   \n [UpdatePV](../../visual-cpp-samples.md)"}