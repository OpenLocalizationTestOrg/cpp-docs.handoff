{"nodes":[{"pos":[12,52],"content":"CMultiDocTemplate Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMultiDocTemplate Class | Microsoft Docs","pos":[0,40]}]},{"pos":[645,668],"content":"CMultiDocTemplate Class","linkify":"CMultiDocTemplate Class","nodes":[{"content":"CMultiDocTemplate Class","pos":[0,23]}]},{"content":"Defines a document template that implements the multiple document interface (MDI).","pos":[669,751]},{"pos":[760,766],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[838,845],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[855,874],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[881,885]},{"content":"Description","pos":[886,897]},{"pos":[935,1012],"content":"<bpt id=\"p1\">[</bpt>CMultiDocTemplate::CMultiDocTemplate<ept id=\"p1\">](#cmultidoctemplate__cmultidoctemplate)</ept>","source":"[CMultiDocTemplate::CMultiDocTemplate](#cmultidoctemplate__cmultidoctemplate)"},{"pos":[1013,1053],"content":"Constructs a <ph id=\"ph1\">`CMultiDocTemplate`</ph> object.","source":"Constructs a `CMultiDocTemplate` object."},{"pos":[1063,1070],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"An MDI application uses the main frame window as a workspace in which the user can open zero or more document frame windows, each of which displays a document.","pos":[1074,1233]},{"content":"For a more detailed description of the MDI, see <bpt id=\"p1\">*</bpt>Windows Interface Guidelines for Software Design<ept id=\"p1\">*</ept>.","pos":[1234,1333],"source":" For a more detailed description of the MDI, see *Windows Interface Guidelines for Software Design*."},{"content":"A document template defines the relationships among three types of classes:","pos":[1340,1415]},{"pos":[1425,1517],"content":"A document class, which you derive from <bpt id=\"p1\">[</bpt>CDocument<ept id=\"p1\">](../../mfc/reference/cdocument-class.md)</ept>.","source":"A document class, which you derive from [CDocument](../../mfc/reference/cdocument-class.md)."},{"content":"A view class, which displays data from the document class listed above.","pos":[1527,1598]},{"content":"You can derive this class from <bpt id=\"p1\">[</bpt>CView<ept id=\"p1\">](../../mfc/reference/cview-class.md)</ept>, <ph id=\"ph1\">`CScrollView`</ph>, <ph id=\"ph2\">`CFormView`</ph>, or <ph id=\"ph3\">`CEditView`</ph>.","pos":[1599,1718],"source":" You can derive this class from [CView](../../mfc/reference/cview-class.md), `CScrollView`, `CFormView`, or `CEditView`."},{"content":"(You can also use <ph id=\"ph1\">`CEditView`</ph> directly.)","pos":[1719,1759],"source":" (You can also use `CEditView` directly.)"},{"content":"A frame window class, which contains the view.","pos":[1769,1815]},{"content":"For an MDI document template, you can derive this class from <ph id=\"ph1\">`CMDIChildWnd`</ph>, or, if you don't need to customize the behavior of the document frame windows, you can use <bpt id=\"p1\">[</bpt>CMDIChildWnd<ept id=\"p1\">](../../mfc/reference/cmdichildwnd-class.md)</ept> directly without deriving your own class.","pos":[1816,2083],"source":" For an MDI document template, you can derive this class from `CMDIChildWnd`, or, if you don't need to customize the behavior of the document frame windows, you can use [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) directly without deriving your own class."},{"content":"An MDI application can support more than one type of document, and documents of different types can be open at the same time.","pos":[2090,2215]},{"content":"Your application has one document template for each document type that it supports.","pos":[2216,2299]},{"content":"For example, if your MDI application supports both spreadsheets and text documents, the application has two <ph id=\"ph1\">`CMultiDocTemplate`</ph> objects.","pos":[2300,2436],"source":" For example, if your MDI application supports both spreadsheets and text documents, the application has two `CMultiDocTemplate` objects."},{"content":"The application uses the document template(s) when the user creates a new document.","pos":[2443,2526]},{"content":"If the application supports more than one type of document, then the framework gets the names of the supported document types from the document templates and displays them in a list in the File New dialog box.","pos":[2527,2736]},{"content":"Once the user has selected a document type, the application creates a document class object, a frame window object, and a view object and attaches them to each other.","pos":[2737,2903]},{"content":"You do not need to call any member functions of <ph id=\"ph1\">`CMultiDocTemplate`</ph> except the constructor.","pos":[2910,3001],"source":"You do not need to call any member functions of `CMultiDocTemplate` except the constructor."},{"content":"The framework handles <ph id=\"ph1\">`CMultiDocTemplate`</ph> objects internally.","pos":[3002,3063],"source":" The framework handles `CMultiDocTemplate` objects internally."},{"pos":[3070,3251],"content":"For more information on <ph id=\"ph1\">`CMultiDocTemplate`</ph>, see <bpt id=\"p1\">[</bpt>Document Templates and the Document/View Creation Process<ept id=\"p1\">](../../mfc/document-templates-and-the-document-view-creation-process.md)</ept>.","source":"For more information on `CMultiDocTemplate`, see [Document Templates and the Document/View Creation Process](../../mfc/document-templates-and-the-document-view-creation-process.md)."},{"pos":[3260,3281],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3285,3332],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[3339,3392],"content":"<bpt id=\"p1\">[</bpt>CCmdTarget<ept id=\"p1\">](../../mfc/reference/ccmdtarget-class.md)</ept>","source":"[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)"},{"pos":[3399,3456],"content":"<bpt id=\"p1\">[</bpt>CDocTemplate<ept id=\"p1\">](../../mfc/reference/cdoctemplate-class.md)</ept>","source":"[CDocTemplate](../../mfc/reference/cdoctemplate-class.md)"},{"pos":[3491,3503],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3507,3527],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxwin.h","source":"**Header:** afxwin.h"},{"pos":[3537,3626],"content":"<bpt id=\"p1\">&lt;a name=\"cmultidoctemplate__cmultidoctemplate\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CMultiDocTemplate::CMultiDocTemplate","linkify":"<a name=\"cmultidoctemplate__cmultidoctemplate\"></a>  CMultiDocTemplate::CMultiDocTemplate","source":"<a name=\"cmultidoctemplate__cmultidoctemplate\"></a>  CMultiDocTemplate::CMultiDocTemplate"},{"pos":[3630,3670],"content":"Constructs a <ph id=\"ph1\">`CMultiDocTemplate`</ph> object.","source":"Constructs a `CMultiDocTemplate` object."},{"pos":[3836,3846],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies the ID of the resources used with the document type.","pos":[3867,3929]},{"content":"This may include menu, icon, accelerator table, and string resources.","pos":[3930,3999]},{"content":"The string resource consists of up to seven substrings separated by the '\\n' character (the '\\n' character is needed as a place holder if a substring is not included; however, trailing '\\n' characters are not necessary); these substrings describe the document type.","pos":[4006,4271]},{"content":"For information on the substrings, see <bpt id=\"p1\">[</bpt>CDocTemplate::GetDocString<ept id=\"p1\">](../../mfc/reference/cdoctemplate-class.md#cdoctemplate__getdocstring)</ept>.","pos":[4272,4410],"source":" For information on the substrings, see [CDocTemplate::GetDocString](../../mfc/reference/cdoctemplate-class.md#cdoctemplate__getdocstring)."},{"content":"This string resource is found in the application's resource file.","pos":[4411,4476]},{"content":"For example:","pos":[4477,4489]},{"content":"Note that the string begins with a '\\n' character; this is because the first substring is not used for MDI applications and so is not included.","pos":[4684,4827]},{"content":"You can edit this string using the string editor; the entire string appears as a single entry in the String Editor, not as seven separate entries.","pos":[4828,4974]},{"pos":[4981,5084],"content":"For more information about these resource types, see <bpt id=\"p1\">[</bpt>Resource Editors<ept id=\"p1\">](../../mfc/resource-editors.md)</ept>.","source":"For more information about these resource types, see [Resource Editors](../../mfc/resource-editors.md)."},{"content":"Points to the <ph id=\"ph1\">`CRuntimeClass`</ph> object of the document class.","pos":[5106,5165],"source":" Points to the `CRuntimeClass` object of the document class."},{"content":"This class is a <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept>-derived class you define to represent your documents.","pos":[5166,5249],"source":" This class is a **CDocument**-derived class you define to represent your documents."},{"content":"Points to the <ph id=\"ph1\">`CRuntimeClass`</ph> object of the frame-window class.","pos":[5273,5336],"source":" Points to the `CRuntimeClass` object of the frame-window class."},{"content":"This class can be a <ph id=\"ph1\">`CMDIChildWnd`</ph>-derived class, or it can be <ph id=\"ph2\">`CMDIChildWnd`</ph> itself if you want default behavior for your document frame windows.","pos":[5337,5483],"source":" This class can be a `CMDIChildWnd`-derived class, or it can be `CMDIChildWnd` itself if you want default behavior for your document frame windows."},{"content":"Points to the <ph id=\"ph1\">`CRuntimeClass`</ph> object of the view class.","pos":[5506,5561],"source":" Points to the `CRuntimeClass` object of the view class."},{"content":"This class is a <ph id=\"ph1\">`CView`</ph>-derived class you define to display your documents.","pos":[5562,5637],"source":" This class is a `CView`-derived class you define to display your documents."},{"pos":[5647,5654],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5658,5877],"content":"Dynamically allocate one <ph id=\"ph1\">`CMultiDocTemplate`</ph> object for each document type that your application supports and pass each one to <ph id=\"ph2\">`CWinApp::AddDocTemplate`</ph> from the <ph id=\"ph3\">`InitInstance`</ph> member function of your application class.","source":"Dynamically allocate one `CMultiDocTemplate` object for each document type that your application supports and pass each one to `CWinApp::AddDocTemplate` from the `InitInstance` member function of your application class."},{"pos":[5887,5894],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5898,5985],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCDocView#92<ept id=\"p2\">](../../mfc/codesnippet/cpp/cmultidoctemplate-class_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCDocView#92](../../mfc/codesnippet/cpp/cmultidoctemplate-class_1.cpp)]"},{"content":"Here is a second example.","pos":[5992,6017]},{"pos":[6024,6111],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCDocView#93<ept id=\"p2\">](../../mfc/codesnippet/cpp/cmultidoctemplate-class_2.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCDocView#93](../../mfc/codesnippet/cpp/cmultidoctemplate-class_2.cpp)]"},{"pos":[6120,6128],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CDocTemplate Class<ept id=\"p1\">](../../mfc/reference/cdoctemplate-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[6132,6196],"source":"[CDocTemplate Class](../../mfc/reference/cdoctemplate-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[6199,6248],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDocTemplate Class<ept id=\"p1\">](../../mfc/reference/cdoctemplate-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[6251,6316],"source":" [CDocTemplate Class](../../mfc/reference/cdoctemplate-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CSingleDocTemplate Class<ept id=\"p1\">](../../mfc/reference/csingledoctemplate-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[6319,6396],"source":" [CSingleDocTemplate Class](../../mfc/reference/csingledoctemplate-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CWinApp Class<ept id=\"p1\">](../../mfc/reference/cwinapp-class.md)</ept>","pos":[6399,6453],"source":" [CWinApp Class](../../mfc/reference/cwinapp-class.md)"}],"content":"---\ntitle: \"CMultiDocTemplate Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMultiDocTemplate\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MDI, template\"\n  - \"CMultiDocTemplate class\"\nms.assetid: 5b8aa328-e461-41d0-b388-00594535e119\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMultiDocTemplate Class\nDefines a document template that implements the multiple document interface (MDI).  \n  \n## Syntax  \n  \n```  \nclass CMultiDocTemplate : public CDocTemplate  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMultiDocTemplate::CMultiDocTemplate](#cmultidoctemplate__cmultidoctemplate)|Constructs a `CMultiDocTemplate` object.|  \n  \n## Remarks  \n An MDI application uses the main frame window as a workspace in which the user can open zero or more document frame windows, each of which displays a document. For a more detailed description of the MDI, see *Windows Interface Guidelines for Software Design*.  \n  \n A document template defines the relationships among three types of classes:  \n  \n-   A document class, which you derive from [CDocument](../../mfc/reference/cdocument-class.md).  \n  \n-   A view class, which displays data from the document class listed above. You can derive this class from [CView](../../mfc/reference/cview-class.md), `CScrollView`, `CFormView`, or `CEditView`. (You can also use `CEditView` directly.)  \n  \n-   A frame window class, which contains the view. For an MDI document template, you can derive this class from `CMDIChildWnd`, or, if you don't need to customize the behavior of the document frame windows, you can use [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) directly without deriving your own class.  \n  \n An MDI application can support more than one type of document, and documents of different types can be open at the same time. Your application has one document template for each document type that it supports. For example, if your MDI application supports both spreadsheets and text documents, the application has two `CMultiDocTemplate` objects.  \n  \n The application uses the document template(s) when the user creates a new document. If the application supports more than one type of document, then the framework gets the names of the supported document types from the document templates and displays them in a list in the File New dialog box. Once the user has selected a document type, the application creates a document class object, a frame window object, and a view object and attaches them to each other.  \n  \n You do not need to call any member functions of `CMultiDocTemplate` except the constructor. The framework handles `CMultiDocTemplate` objects internally.  \n  \n For more information on `CMultiDocTemplate`, see [Document Templates and the Document/View Creation Process](../../mfc/document-templates-and-the-document-view-creation-process.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CDocTemplate](../../mfc/reference/cdoctemplate-class.md)  \n  \n `CMultiDocTemplate`  \n  \n## Requirements  \n **Header:** afxwin.h  \n  \n##  <a name=\"cmultidoctemplate__cmultidoctemplate\"></a>  CMultiDocTemplate::CMultiDocTemplate  \n Constructs a `CMultiDocTemplate` object.  \n  \n```  \nCMultiDocTemplate(\n    UINT nIDResource,  \n    CRuntimeClass* pDocClass,  \n    CRuntimeClass* pFrameClass,  \n    CRuntimeClass* pViewClass);\n```  \n  \n### Parameters  \n `nIDResource`  \n Specifies the ID of the resources used with the document type. This may include menu, icon, accelerator table, and string resources.  \n  \n The string resource consists of up to seven substrings separated by the '\\n' character (the '\\n' character is needed as a place holder if a substring is not included; however, trailing '\\n' characters are not necessary); these substrings describe the document type. For information on the substrings, see [CDocTemplate::GetDocString](../../mfc/reference/cdoctemplate-class.md#cdoctemplate__getdocstring). This string resource is found in the application's resource file. For example:  \n  \n `// MYCALC.RC`  \n  \n `STRINGTABLE PRELOAD DISCARDABLE`  \n  \n `BEGIN`  \n  \n `IDR_SHEETTYPE \"\\nSheet\\nWorksheet\\nWorksheets (*.myc)\\n.myc\\n MyCalcSheet\\nMyCalc Worksheet\"`  \n  \n `END`  \n  \n Note that the string begins with a '\\n' character; this is because the first substring is not used for MDI applications and so is not included. You can edit this string using the string editor; the entire string appears as a single entry in the String Editor, not as seven separate entries.  \n  \n For more information about these resource types, see [Resource Editors](../../mfc/resource-editors.md).  \n  \n `pDocClass`  \n Points to the `CRuntimeClass` object of the document class. This class is a **CDocument**-derived class you define to represent your documents.  \n  \n `pFrameClass`  \n Points to the `CRuntimeClass` object of the frame-window class. This class can be a `CMDIChildWnd`-derived class, or it can be `CMDIChildWnd` itself if you want default behavior for your document frame windows.  \n  \n `pViewClass`  \n Points to the `CRuntimeClass` object of the view class. This class is a `CView`-derived class you define to display your documents.  \n  \n### Remarks  \n Dynamically allocate one `CMultiDocTemplate` object for each document type that your application supports and pass each one to `CWinApp::AddDocTemplate` from the `InitInstance` member function of your application class.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#92](../../mfc/codesnippet/cpp/cmultidoctemplate-class_1.cpp)]  \n  \n Here is a second example.  \n  \n [!code-cpp[NVC_MFCDocView#93](../../mfc/codesnippet/cpp/cmultidoctemplate-class_2.cpp)]  \n  \n## See Also  \n [CDocTemplate Class](../../mfc/reference/cdoctemplate-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CDocTemplate Class](../../mfc/reference/cdoctemplate-class.md)   \n [CSingleDocTemplate Class](../../mfc/reference/csingledoctemplate-class.md)   \n [CWinApp Class](../../mfc/reference/cwinapp-class.md)\n"}