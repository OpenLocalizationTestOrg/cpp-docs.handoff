{"nodes":[{"pos":[12,63],"content":"OLE Background: MFC Implementation | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"OLE Background: MFC Implementation | Microsoft Docs","pos":[0,51]}]},{"content":"OLE Background: MFC Implementation","pos":[837,871]},{"content":"Because of the size and complexity of the raw OLE API, calling it directly to write OLE applications can be very time consuming.","pos":[872,1000]},{"content":"The goal of the Microsoft Foundation Class Library implementation of OLE is to reduce the amount of work you have to do to write full-featured, OLE-capable applications.","pos":[1001,1170]},{"content":"This article explains the parts of the OLE API that have not been implemented inside MFC.","pos":[1177,1266]},{"content":"The discussion also explains how what is implemented maps to the OLE section of the <ph id=\"ph1\">[!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]</ph>.","pos":[1267,1400],"source":" The discussion also explains how what is implemented maps to the OLE section of the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]."},{"pos":[1484,1536],"content":"Portions of OLE Not Implemented by the Class Library"},{"content":"A few interfaces and features of OLE are not directly provided by MFC.","pos":[1540,1610]},{"content":"If you want to use these features, you can call the OLE API directly.","pos":[1611,1680]},{"content":"IMoniker Interface","pos":[1687,1705]},{"content":"The <ph id=\"ph1\">`IMoniker`</ph> interface is implemented by the class library (for example, the <ph id=\"ph2\">`COleServerItem`</ph> class) but has not previously been exposed to the programmer.","pos":[1709,1866],"source":" The `IMoniker` interface is implemented by the class library (for example, the `COleServerItem` class) but has not previously been exposed to the programmer."},{"content":"For more information about this interface, see OLE Moniker Implementations in the OLE section of the <ph id=\"ph1\">[!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]</ph>.","pos":[1867,2017],"source":" For more information about this interface, see OLE Moniker Implementations in the OLE section of the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]."},{"content":"However, see also class <bpt id=\"p1\">[</bpt>CMonikerFile<ept id=\"p1\">](../mfc/reference/cmonikerfile-class.md)</ept> and <bpt id=\"p2\">[</bpt>CAsyncMonikerFile<ept id=\"p2\">](../mfc/reference/casyncmonikerfile-class.md)</ept>.","pos":[2018,2166],"source":" However, see also class [CMonikerFile](../mfc/reference/cmonikerfile-class.md) and [CAsyncMonikerFile](../mfc/reference/casyncmonikerfile-class.md)."},{"content":"IUnknown and IMarshal Interfaces","pos":[2173,2205]},{"content":"The <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface is implemented by the class library but is not exposed to the programmer.","pos":[2209,2309],"source":" The **IUnknown** interface is implemented by the class library but is not exposed to the programmer."},{"content":"The <bpt id=\"p1\">**</bpt>IMarshal<ept id=\"p1\">**</ept> interface is not implemented by the class library but is used internally.","pos":[2310,2400],"source":" The **IMarshal** interface is not implemented by the class library but is used internally."},{"content":"Automation servers built using the class library already have marshaling capabilities built in.","pos":[2401,2496]},{"content":"Docfiles (Compound Files)","pos":[2503,2528]},{"content":"Compound files are partially supported by the class library.","pos":[2532,2592]},{"content":"None of the functions that directly manipulate compound files beyond creation are supported.","pos":[2593,2685]},{"content":"MFC uses class <bpt id=\"p1\">**</bpt>COleFileStream<ept id=\"p1\">**</ept> to support manipulation of streams with standard file functions.","pos":[2686,2784],"source":" MFC uses class **COleFileStream** to support manipulation of streams with standard file functions."},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Containers: Compound Files<ept id=\"p1\">](../mfc/containers-compound-files.md)</ept>.","pos":[2785,2889],"source":" For more information, see the article [Containers: Compound Files](../mfc/containers-compound-files.md)."},{"content":"In-Process Servers and Object Handlers","pos":[2896,2934]},{"content":"In-process servers and object handlers allow implementation of visual editing data or full Component Object Model (COM) objects in a dynamic-link library (DLL).","pos":[2938,3098]},{"content":"To do this, you can implement your DLL by calling the OLE API directly.","pos":[3099,3170]},{"content":"However, if you are writing an Automation server and your server has no user interface, you can use AppWizard to make your server an in-process server and put it completely into a DLL.","pos":[3171,3355]},{"content":"For more information about these topics, see <bpt id=\"p1\">[</bpt>Automation Servers<ept id=\"p1\">](../mfc/automation-servers.md)</ept>.","pos":[3356,3452],"source":" For more information about these topics, see [Automation Servers](../mfc/automation-servers.md)."},{"pos":[3460,3572],"content":"[!TIP]\n The easiest way to implement an Automation server is to place it in a DLL. MFC supports this approach.","leadings":["","> "],"nodes":[{"content":" The easiest way to implement an Automation server is to place it in a DLL. MFC supports this approach.","pos":[7,110],"nodes":[{"content":"The easiest way to implement an Automation server is to place it in a DLL.","pos":[1,75]},{"content":"MFC supports this approach.","pos":[76,103]}]}]},{"pos":[3579,3870],"content":"For more information on how the Microsoft Foundation OLE classes implement OLE interfaces, see MFC Technical Notes <bpt id=\"p1\">[</bpt>38<ept id=\"p1\">](../mfc/tn038-mfc-ole-iunknown-implementation.md)</ept>, <bpt id=\"p2\">[</bpt>39<ept id=\"p2\">](../mfc/tn039-mfc-ole-automation-implementation.md)</ept>, and <bpt id=\"p3\">[</bpt>40<ept id=\"p3\">](../mfc/tn040-mfc-ole-in-place-resizing-and-zooming.md)</ept>.","source":"For more information on how the Microsoft Foundation OLE classes implement OLE interfaces, see MFC Technical Notes [38](../mfc/tn038-mfc-ole-iunknown-implementation.md), [39](../mfc/tn039-mfc-ole-automation-implementation.md), and [40](../mfc/tn040-mfc-ole-in-place-resizing-and-zooming.md)."},{"content":"See Also","pos":[3879,3887]},{"content":"OLE Background","pos":[3892,3906]},{"content":"OLE Background: Implementation Strategies","pos":[3939,3980]}],"content":"---\ntitle: \"OLE Background: MFC Implementation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"IMarshall\"\n  - \"IMoniker\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC libraries, implementing\"\n  - \"OLE MFC library implementation\"\n  - \"OLE IMarshal interface\"\n  - \"IMoniker interface, MFC\"\n  - \"IMarshall class\"\n  - \"OLE, compound files\"\n  - \"OLE IMoniker interface\"\n  - \"OLE IUnknown\"\nms.assetid: 2b67016a-d78e-4d60-925f-c28ec8fb6180\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# OLE Background: MFC Implementation\nBecause of the size and complexity of the raw OLE API, calling it directly to write OLE applications can be very time consuming. The goal of the Microsoft Foundation Class Library implementation of OLE is to reduce the amount of work you have to do to write full-featured, OLE-capable applications.  \n  \n This article explains the parts of the OLE API that have not been implemented inside MFC. The discussion also explains how what is implemented maps to the OLE section of the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"_core_portions_of_ole_not_implemented_by_the_class_library\"></a> Portions of OLE Not Implemented by the Class Library  \n A few interfaces and features of OLE are not directly provided by MFC. If you want to use these features, you can call the OLE API directly.  \n  \n IMoniker Interface  \n The `IMoniker` interface is implemented by the class library (for example, the `COleServerItem` class) but has not previously been exposed to the programmer. For more information about this interface, see OLE Moniker Implementations in the OLE section of the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]. However, see also class [CMonikerFile](../mfc/reference/cmonikerfile-class.md) and [CAsyncMonikerFile](../mfc/reference/casyncmonikerfile-class.md).  \n  \n IUnknown and IMarshal Interfaces  \n The **IUnknown** interface is implemented by the class library but is not exposed to the programmer. The **IMarshal** interface is not implemented by the class library but is used internally. Automation servers built using the class library already have marshaling capabilities built in.  \n  \n Docfiles (Compound Files)  \n Compound files are partially supported by the class library. None of the functions that directly manipulate compound files beyond creation are supported. MFC uses class **COleFileStream** to support manipulation of streams with standard file functions. For more information, see the article [Containers: Compound Files](../mfc/containers-compound-files.md).  \n  \n In-Process Servers and Object Handlers  \n In-process servers and object handlers allow implementation of visual editing data or full Component Object Model (COM) objects in a dynamic-link library (DLL). To do this, you can implement your DLL by calling the OLE API directly. However, if you are writing an Automation server and your server has no user interface, you can use AppWizard to make your server an in-process server and put it completely into a DLL. For more information about these topics, see [Automation Servers](../mfc/automation-servers.md).  \n  \n> [!TIP]\n>  The easiest way to implement an Automation server is to place it in a DLL. MFC supports this approach.  \n  \n For more information on how the Microsoft Foundation OLE classes implement OLE interfaces, see MFC Technical Notes [38](../mfc/tn038-mfc-ole-iunknown-implementation.md), [39](../mfc/tn039-mfc-ole-automation-implementation.md), and [40](../mfc/tn040-mfc-ole-in-place-resizing-and-zooming.md).  \n  \n## See Also  \n [OLE Background](../mfc/ole-background.md)   \n [OLE Background: Implementation Strategies](../mfc/ole-background-implementation-strategies.md)\n\n"}