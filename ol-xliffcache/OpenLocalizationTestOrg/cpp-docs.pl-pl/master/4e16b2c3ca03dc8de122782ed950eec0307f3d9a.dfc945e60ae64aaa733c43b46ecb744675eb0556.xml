{"nodes":[{"pos":[12,74],"content":"Accessing the Embedded Month Calendar Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Accessing the Embedded Month Calendar Control | Microsoft Docs","pos":[0,62]}]},{"content":"Accessing the Embedded Month Calendar Control","pos":[881,926]},{"pos":[927,1143],"content":"The embedded month calendar control object can be accessed from the <ph id=\"ph1\">`CDateTimeCtrl`</ph> object with a call to the <bpt id=\"p1\">[</bpt>GetMonthCalCtrl<ept id=\"p1\">](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__getmonthcalctrl)</ept> member function.","source":"The embedded month calendar control object can be accessed from the `CDateTimeCtrl` object with a call to the [GetMonthCalCtrl](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__getmonthcalctrl) member function."},{"pos":[1151,1292],"content":"[!NOTE]\n The embedded month calendar control is used only when the date and time picker control does not have the **DTS_UPDOWN** style set.","leadings":["","> "],"nodes":[{"content":"The embedded month calendar control is used only when the date and time picker control does not have the <bpt id=\"p1\">**</bpt>DTS_UPDOWN<ept id=\"p1\">**</ept> style set.","pos":[9,139],"source":" The embedded month calendar control is used only when the date and time picker control does not have the **DTS_UPDOWN** style set."}]},{"content":"This is useful if you want to modify certain attributes before the embedded control is displayed.","pos":[1299,1396]},{"content":"To accomplish this, handle the <bpt id=\"p1\">**</bpt>DTN_DROPDOWN<ept id=\"p1\">**</ept> notification, retrieve the month calendar control (using <bpt id=\"p2\">[</bpt>CDateTimeCtrl::GetMonthCalCtrl<ept id=\"p2\">](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__getmonthcalctrl)</ept>), and make your modifications.","pos":[1397,1637],"source":" To accomplish this, handle the **DTN_DROPDOWN** notification, retrieve the month calendar control (using [CDateTimeCtrl::GetMonthCalCtrl](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__getmonthcalctrl)), and make your modifications."},{"content":"Unfortunately, the month calendar control is not persistent.","pos":[1638,1698]},{"content":"In other words, when the user requests the display of the month calendar control, a new month calendar control is created (before the <bpt id=\"p1\">**</bpt>DTN_DROPDOWN<ept id=\"p1\">**</ept> notification).","pos":[1705,1870],"source":"In other words, when the user requests the display of the month calendar control, a new month calendar control is created (before the **DTN_DROPDOWN** notification)."},{"content":"The control is destroyed (after the <bpt id=\"p1\">**</bpt>DTN_CLOSEUP<ept id=\"p1\">**</ept> notification) when dismissed by the user.","pos":[1871,1964],"source":" The control is destroyed (after the **DTN_CLOSEUP** notification) when dismissed by the user."},{"content":"This means that any attributes you modify, before the embedded control is displayed, are lost when the embedded control is dismissed.","pos":[1965,2098]},{"content":"The following example demonstrates this procedure, using a handler for the <bpt id=\"p1\">**</bpt>DTN_DROPDOWN<ept id=\"p1\">**</ept> notification.","pos":[2105,2210],"source":"The following example demonstrates this procedure, using a handler for the **DTN_DROPDOWN** notification."},{"content":"The code changes the background color of the month calendar control, with a call to <bpt id=\"p1\">[</bpt>SetMonthCalColor<ept id=\"p1\">](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__setmonthcalcolor)</ept>, to gray.","pos":[2211,2396],"source":" The code changes the background color of the month calendar control, with a call to [SetMonthCalColor](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__setmonthcalcolor), to gray."},{"content":"The code is as follows:","pos":[2397,2420]},{"pos":[2438,2465],"content":"NVC_MFCControlLadenDialog#5"},{"content":"As stated previously, all modifications to properties of the month calendar control are lost, with two exceptions, when the embedded control is dismissed.","pos":[2550,2704]},{"content":"The first exception, the colors of the month calendar control, has already been discussed.","pos":[2705,2795]},{"content":"The second exception is the font used by the month calendar control.","pos":[2796,2864]},{"content":"You can modify the default font by making a call to <bpt id=\"p1\">[</bpt>CDateTimeCtrl::SetMonthCalFont<ept id=\"p1\">](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__setmonthcalfont)</ept>, passing the handle of an existing font.","pos":[2865,3062],"source":" You can modify the default font by making a call to [CDateTimeCtrl::SetMonthCalFont](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__setmonthcalfont), passing the handle of an existing font."},{"content":"The following example (where <ph id=\"ph1\">`m_dtPicker`</ph> is the date and time control object) demonstrates one possible method:","pos":[3063,3175],"source":" The following example (where `m_dtPicker` is the date and time control object) demonstrates one possible method:"},{"pos":[3193,3220],"content":"NVC_MFCControlLadenDialog#6"},{"pos":[3305,3468],"content":"Once the font has been changed, with a call to <ph id=\"ph1\">`CDateTimeCtrl::SetMonthCalFont`</ph>, the new font is stored and used the next time a month calendar is to be displayed.","source":"Once the font has been changed, with a call to `CDateTimeCtrl::SetMonthCalFont`, the new font is stored and used the next time a month calendar is to be displayed."},{"content":"See Also","pos":[3477,3485]},{"content":"Using CDateTimeCtrl","pos":[3490,3509]},{"content":"Controls","pos":[3547,3555]}],"content":"---\ntitle: \"Accessing the Embedded Month Calendar Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DateTimePicker control [MFC], accessing month calendar\"\n  - \"CDateTimeCtrl class, accessing embedded control\"\n  - \"month calendar controls, embedded in date/time picker\"\n  - \"CMonthCalCtrl class, changing the font\"\n  - \"month calendar controls, changing the font\"\n  - \"DateTimePicker control [MFC]\"\nms.assetid: 355e97ed-cf81-4df3-a2f8-9ddbbde93227\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Accessing the Embedded Month Calendar Control\nThe embedded month calendar control object can be accessed from the `CDateTimeCtrl` object with a call to the [GetMonthCalCtrl](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__getmonthcalctrl) member function.  \n  \n> [!NOTE]\n>  The embedded month calendar control is used only when the date and time picker control does not have the **DTS_UPDOWN** style set.  \n  \n This is useful if you want to modify certain attributes before the embedded control is displayed. To accomplish this, handle the **DTN_DROPDOWN** notification, retrieve the month calendar control (using [CDateTimeCtrl::GetMonthCalCtrl](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__getmonthcalctrl)), and make your modifications. Unfortunately, the month calendar control is not persistent.  \n  \n In other words, when the user requests the display of the month calendar control, a new month calendar control is created (before the **DTN_DROPDOWN** notification). The control is destroyed (after the **DTN_CLOSEUP** notification) when dismissed by the user. This means that any attributes you modify, before the embedded control is displayed, are lost when the embedded control is dismissed.  \n  \n The following example demonstrates this procedure, using a handler for the **DTN_DROPDOWN** notification. The code changes the background color of the month calendar control, with a call to [SetMonthCalColor](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__setmonthcalcolor), to gray. The code is as follows:  \n  \n [!code-cpp[NVC_MFCControlLadenDialog#5](../mfc/codesnippet/cpp/accessing-the-embedded-month-calendar-control_1.cpp)]  \n  \n As stated previously, all modifications to properties of the month calendar control are lost, with two exceptions, when the embedded control is dismissed. The first exception, the colors of the month calendar control, has already been discussed. The second exception is the font used by the month calendar control. You can modify the default font by making a call to [CDateTimeCtrl::SetMonthCalFont](../mfc/reference/cdatetimectrl-class.md#cdatetimectrl__setmonthcalfont), passing the handle of an existing font. The following example (where `m_dtPicker` is the date and time control object) demonstrates one possible method:  \n  \n [!code-cpp[NVC_MFCControlLadenDialog#6](../mfc/codesnippet/cpp/accessing-the-embedded-month-calendar-control_2.cpp)]  \n  \n Once the font has been changed, with a call to `CDateTimeCtrl::SetMonthCalFont`, the new font is stored and used the next time a month calendar is to be displayed.  \n  \n## See Also  \n [Using CDateTimeCtrl](../mfc/using-cdatetimectrl.md)   \n [Controls](../mfc/controls-mfc.md)\n\n"}