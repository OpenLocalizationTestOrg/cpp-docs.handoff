{"nodes":[{"pos":[12,55],"content":".Lib Files as Linker Input | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":".Lib Files as Linker Input | Microsoft Docs","pos":[0,43]}]},{"content":".Lib Files as Linker Input","pos":[926,952]},{"content":"LINK accepts COFF standard libraries and COFF import libraries, both of which usually have the extension .lib.","pos":[953,1063]},{"content":"Standard libraries contain objects and are created by the LIB tool.","pos":[1064,1131]},{"content":"Import libraries contain information about exports in other programs and are created either by LINK when it builds a program that contains exports or by the LIB tool.","pos":[1132,1298]},{"content":"For information on using LIB to create standard or import libraries, see <bpt id=\"p1\">[</bpt>LIB Reference<ept id=\"p1\">](../../build/reference/lib-reference.md)</ept>.","pos":[1299,1428],"source":" For information on using LIB to create standard or import libraries, see [LIB Reference](../../build/reference/lib-reference.md)."},{"content":"For details on using LINK to create an import library, see the <bpt id=\"p1\">[</bpt>/DLL<ept id=\"p1\">](../../build/reference/dll-build-a-dll.md)</ept> option.","pos":[1429,1548],"source":" For details on using LINK to create an import library, see the [/DLL](../../build/reference/dll-build-a-dll.md) option."},{"content":"A library is specified to LINK as either a file name argument or a default library.","pos":[1554,1637]},{"content":"LINK resolves external references by searching first in libraries specified on the command line, then in default libraries specified with the <bpt id=\"p1\">[</bpt>/DEFAULTLIB<ept id=\"p1\">](../../build/reference/defaultlib-specify-default-library.md)</ept> option, and then in default libraries named in .obj files.","pos":[1638,1913],"source":" LINK resolves external references by searching first in libraries specified on the command line, then in default libraries specified with the [/DEFAULTLIB](../../build/reference/defaultlib-specify-default-library.md) option, and then in default libraries named in .obj files."},{"content":"If a path is specified with the library name, LINK looks for the library in that directory.","pos":[1914,2005]},{"content":"If no path is specified, LINK looks first in the directory that LINK is running from, and then in any directories specified in the LIB environment variable.","pos":[2006,2162]},{"content":"To add .lib files as linker input in the development environment","pos":[2171,2235]},{"content":"Open the project's <bpt id=\"p1\">**</bpt>Property Pages<ept id=\"p1\">**</ept> dialog box.","pos":[2245,2294],"source":"Open the project's **Property Pages** dialog box."},{"content":"For details, see <bpt id=\"p1\">[</bpt>Working with Project Properties<ept id=\"p1\">](../../ide/working-with-project-properties.md)</ept>.","pos":[2295,2392],"source":" For details, see [Working with Project Properties](../../ide/working-with-project-properties.md)."},{"pos":[2402,2462],"content":"Choose the <bpt id=\"p1\">**</bpt>Input<ept id=\"p1\">**</ept> property page in the <bpt id=\"p2\">**</bpt>Linker<ept id=\"p2\">**</ept> folder.","source":"Choose the **Input** property page in the **Linker** folder."},{"pos":[2472,2542],"content":"Modify the <bpt id=\"p1\">**</bpt>Additional Dependencies<ept id=\"p1\">**</ept> property to add the .lib files.","source":"Modify the **Additional Dependencies** property to add the .lib files."},{"content":"To programmatically add .lib files as linker input","pos":[2551,2601]},{"pos":[2611,2756],"content":"See <bpt id=\"p1\">[</bpt>AdditionalDependencies<ept id=\"p1\">](https://msdn.microsoft.com/library/microsoft.visualstudio.vcprojectengine.vclinkertool.additionaldependencies.aspx)</ept>.","source":"See [AdditionalDependencies](https://msdn.microsoft.com/library/microsoft.visualstudio.vcprojectengine.vclinkertool.additionaldependencies.aspx)."},{"content":"Example","pos":[2765,2772]},{"content":"The following sample shows how to build and use a .lib file.","pos":[2775,2835]},{"content":"First, build a .lib file:","pos":[2836,2861]},{"content":"And then, compile this sample by using the .lib file you just created:","pos":[3020,3090]},{"content":"See Also","pos":[3361,3369]},{"content":"LINK Input Files","pos":[3374,3390]},{"content":"Linker Options","pos":[3440,3454]}],"content":"---\ntitle: \".Lib Files as Linker Input | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"VC.Project.VCLinkerTool.AdditionalDependencies\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OMF libraries\"\n  - \"linking [C++], OMF libraries\"\n  - \"import libraries, linker files\"\n  - \"libraries [C++], .lib files as linker input\"\n  - \"COFF files, import libraries\"\n  - \"default libraries [C++], linker output\"\n  - \"default libraries [C++]\"\n  - \"defaults [C++], libraries\"\n  - \".lib files\"\nms.assetid: dc5d2b1c-2487-41fa-aa71-ad1e0647958b\ncaps.latest.revision: 15\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# .Lib Files as Linker Input\nLINK accepts COFF standard libraries and COFF import libraries, both of which usually have the extension .lib. Standard libraries contain objects and are created by the LIB tool. Import libraries contain information about exports in other programs and are created either by LINK when it builds a program that contains exports or by the LIB tool. For information on using LIB to create standard or import libraries, see [LIB Reference](../../build/reference/lib-reference.md). For details on using LINK to create an import library, see the [/DLL](../../build/reference/dll-build-a-dll.md) option.  \n  \nA library is specified to LINK as either a file name argument or a default library. LINK resolves external references by searching first in libraries specified on the command line, then in default libraries specified with the [/DEFAULTLIB](../../build/reference/defaultlib-specify-default-library.md) option, and then in default libraries named in .obj files. If a path is specified with the library name, LINK looks for the library in that directory. If no path is specified, LINK looks first in the directory that LINK is running from, and then in any directories specified in the LIB environment variable.  \n  \n## To add .lib files as linker input in the development environment  \n  \n1.  Open the project's **Property Pages** dialog box. For details, see [Working with Project Properties](../../ide/working-with-project-properties.md).  \n  \n2.  Choose the **Input** property page in the **Linker** folder.  \n  \n3.  Modify the **Additional Dependencies** property to add the .lib files.  \n  \n## To programmatically add .lib files as linker input  \n  \n-   See [AdditionalDependencies](https://msdn.microsoft.com/library/microsoft.visualstudio.vcprojectengine.vclinkertool.additionaldependencies.aspx).  \n  \n## Example  \nThe following sample shows how to build and use a .lib file. First, build a .lib file:  \n  \n```cpp  \n// lib_link_input_1.cpp  \n// compile by using: cl /LD lib_link_input_1.cpp  \n__declspec(dllexport) int Test() {  \n   return 213;  \n}  \n```  \n  \nAnd then, compile this sample by using the .lib file you just created:  \n  \n```cpp  \n// lib_link_input_2.cpp  \n// compile by using: cl /EHsc lib_link_input_1.lib lib_link_input_2.cpp   \n__declspec(dllimport) int Test();  \n#include <iostream>  \nint main() {  \n   std::cout << Test() << std::endl;  \n}  \n```  \n  \n```Output  \n213  \n```  \n  \n## See Also  \n [LINK Input Files](../../build/reference/link-input-files.md)   \n [Linker Options](../../build/reference/linker-options.md)"}