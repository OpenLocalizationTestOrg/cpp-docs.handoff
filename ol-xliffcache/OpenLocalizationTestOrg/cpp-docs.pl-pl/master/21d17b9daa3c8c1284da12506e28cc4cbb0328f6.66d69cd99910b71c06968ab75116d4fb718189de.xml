{"nodes":[{"pos":[12,39],"content":"aggregates | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"aggregates | Microsoft Docs","pos":[0,27]}]},{"content":"aggregates","pos":[743,753]},{"content":"Indicates that the object aggregates the object specified by the CLSID.","pos":[754,825]},{"content":"Syntax","pos":[834,840]},{"content":"Parameters","pos":[928,938]},{"content":"Specifies the CLSID of the aggregatable object.","pos":[953,1000]},{"content":"The name of the variable that is to be inserted.","pos":[1026,1074]},{"content":"This variable contains the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> of the object being aggregated.","pos":[1075,1146],"source":" This variable contains the **IUnknown** of the object being aggregated."},{"content":"Remarks","pos":[1155,1162]},{"pos":[1166,1309],"content":"When applied to an object, the <bpt id=\"p1\">**</bpt>aggregates<ept id=\"p1\">**</ept> C++ attribute implements an outer wrapper for the object being aggregated (specified by <ph id=\"ph1\">`clsid`</ph>).","source":"When applied to an object, the **aggregates** C++ attribute implements an outer wrapper for the object being aggregated (specified by `clsid`)."},{"content":"This attribute requires that the <bpt id=\"p1\">[</bpt>coclass<ept id=\"p1\">](../windows/coclass.md)</ept>, <bpt id=\"p2\">[</bpt>progid<ept id=\"p2\">](../windows/progid.md)</ept>, or <bpt id=\"p3\">[</bpt>vi_progid<ept id=\"p3\">](../windows/vi-progid.md)</ept> attribute (or another attribute that implies one of these) also be applied to the same element.","pos":[1316,1550],"source":"This attribute requires that the [coclass](../windows/coclass.md), [progid](../windows/progid.md), or [vi_progid](../windows/vi-progid.md) attribute (or another attribute that implies one of these) also be applied to the same element."},{"content":"If any single attribute is used, the other two are automatically applied.","pos":[1551,1624]},{"content":"For example, if <bpt id=\"p1\">**</bpt>progid<ept id=\"p1\">**</ept> is applied, <bpt id=\"p2\">**</bpt>vi_progid<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>coclass<ept id=\"p3\">**</ept> are also applied.","pos":[1625,1711],"source":" For example, if **progid** is applied, **vi_progid** and **coclass** are also applied."},{"content":"ATL Projects","pos":[1720,1732]},{"content":"If this attribute is used within a project that uses ATL, the behavior of the attribute changes.","pos":[1741,1837]},{"content":"First, the following entry is added to the COM map of the target object:","pos":[1838,1910]},{"pos":[1995,2133],"content":"Second, the <bpt id=\"p1\">[</bpt>DECLARE_GET_CONTROLLING_UNKNOWN<ept id=\"p1\">](http://msdn.microsoft.com/Library/82b0199a-a9d5-4f95-a711-fa1ae18e1f77)</ept> macro is also added.","source":"Second, the [DECLARE_GET_CONTROLLING_UNKNOWN](http://msdn.microsoft.com/Library/82b0199a-a9d5-4f95-a711-fa1ae18e1f77) macro is also added."},{"content":"Example","pos":[2142,2149]},{"content":"Requirements","pos":[2737,2749]},{"content":"Attribute Context","pos":[2759,2776]},{"content":"Applies to","pos":[2799,2809]},{"pos":[2812,2822],"content":"<bpt id=\"p1\">**</bpt>class<ept id=\"p1\">**</ept>,","source":"**class**, "},{"content":"Repeatable","pos":[2838,2848]},{"content":"Yes","pos":[2851,2854]},{"content":"Required attributes","pos":[2861,2880]},{"pos":[2883,2955],"content":"One or more of the following: <bpt id=\"p1\">**</bpt>coclass<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>progid<ept id=\"p2\">**</ept>, or <bpt id=\"p3\">**</bpt>vi_progid<ept id=\"p3\">**</ept>.","source":"One or more of the following: **coclass**, **progid**, or **vi_progid**."},{"content":"Invalid attributes","pos":[2962,2980]},{"content":"None","pos":[2983,2987]},{"pos":[2995,3105],"content":"For more information about the attribute contexts, see <bpt id=\"p1\">[</bpt>Attribute Contexts<ept id=\"p1\">](../windows/attribute-contexts.md)</ept>.","source":"For more information about the attribute contexts, see [Attribute Contexts](../windows/attribute-contexts.md)."},{"content":"See Also","pos":[3114,3122]},{"content":"COM Attributes","pos":[3127,3141]},{"content":"Class Attributes","pos":[3178,3194]},{"content":"Typedef, Enum, Union, and Struct Attributes","pos":[3233,3276]},{"content":"Aggregation","pos":[3339,3350]},{"content":"Aggregatable","pos":[3417,3429]},{"content":"COM_INTERFACE_ENTRY_AUTOAGGREGATE_BLIND","pos":[3496,3535]},{"content":"Attributes Samples","pos":[3614,3632]}],"content":"---\ntitle: \"aggregates | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\nf1_keywords: \n  - \"vc-attr.aggregates\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"aggregates attribute\"\n  - \"aggregation [C++]\"\n  - \"aggregate objects [C++], aggregates attribute\"\n  - \"aggregates [C++]\"\nms.assetid: 67a084c9-941f-474b-a029-9c93b38ebe9a\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# aggregates\nIndicates that the object aggregates the object specified by the CLSID.  \n  \n## Syntax  \n  \n```  \n  \n      [ aggregates(  \n   clsid,  \n   variable_name  \n) ]  \n```  \n  \n#### Parameters  \n `clsid`  \n Specifies the CLSID of the aggregatable object.  \n  \n `variable_name`  \n The name of the variable that is to be inserted. This variable contains the **IUnknown** of the object being aggregated.  \n  \n## Remarks  \n When applied to an object, the **aggregates** C++ attribute implements an outer wrapper for the object being aggregated (specified by `clsid`).  \n  \n This attribute requires that the [coclass](../windows/coclass.md), [progid](../windows/progid.md), or [vi_progid](../windows/vi-progid.md) attribute (or another attribute that implies one of these) also be applied to the same element. If any single attribute is used, the other two are automatically applied. For example, if **progid** is applied, **vi_progid** and **coclass** are also applied.  \n  \n **ATL Projects**  \n  \n If this attribute is used within a project that uses ATL, the behavior of the attribute changes. First, the following entry is added to the COM map of the target object:  \n  \n```  \nCOM_INTERFACE_ENTRY_AUTOAGGREGATE_BLIND(_m_spAttrXXX, clsid)  \n```  \n  \n Second, the [DECLARE_GET_CONTROLLING_UNKNOWN](http://msdn.microsoft.com/Library/82b0199a-a9d5-4f95-a711-fa1ae18e1f77) macro is also added.  \n  \n## Example  \n  \n```  \n// cpp_attr_ref_aggregates.cpp  \n// compile with: /LD  \n#define _ATL_ATTRIBUTES  \n#include \"atlbase.h\"  \n#include \"atlcom.h\"  \n  \n// requires 'aggregatable.dll'  \n// see aggregatable attribute to create 'aggregatable.dll'  \nclass DECLSPEC_UUID(\"1a8369cc-1c91-42c4-befa-5a5d8c9d2529\") CMyClass;  \n  \n[module (name=\"MYObject\")];  \n[object, uuid(\"ab006d85-e754-47c5-9ef4-2744ff32a20c\")]  \n__interface IObject  \n{  \n};  \n  \n[ coclass, aggregates(__uuidof(CMyClass)),   \n  uuid(\"91cb2c06-8931-432a-baac-206e55c4edfb\")]  \nstruct CObject : IObject  \n{  \n   int i;  \n};  \n```  \n  \n## Requirements  \n  \n### Attribute Context  \n  \n|||  \n|-|-|  \n|**Applies to**|**class**, `struct`|  \n|**Repeatable**|Yes|  \n|**Required attributes**|One or more of the following: **coclass**, **progid**, or **vi_progid**.|  \n|**Invalid attributes**|None|  \n  \n For more information about the attribute contexts, see [Attribute Contexts](../windows/attribute-contexts.md).  \n  \n## See Also  \n [COM Attributes](../windows/com-attributes.md)   \n [Class Attributes](../windows/class-attributes.md)   \n [Typedef, Enum, Union, and Struct Attributes](../windows/typedef-enum-union-and-struct-attributes.md)   \n [Aggregation](http://msdn.microsoft.com/library/windows/desktop/ms686558)   \n [Aggregatable](http://msdn.microsoft.com/library/windows/desktop/aa366721)   \n [COM_INTERFACE_ENTRY_AUTOAGGREGATE_BLIND](http://msdn.microsoft.com/Library/4e867f24-0a4f-465e-ad17-06939fcf9c1c)   \n [Attributes Samples](http://msdn.microsoft.com/en-us/558ebdb2-082f-44dc-b442-d8d33bf7bdb8)"}