{"nodes":[{"pos":[12,49],"content":"CFtpConnection Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CFtpConnection Class | Microsoft Docs","pos":[0,37]}]},{"content":"CFtpConnection Class","pos":[738,758]},{"content":"Manages your FTP connection to an Internet server and allows direct manipulation of directories and files on that server.","pos":[759,880]},{"content":"Syntax","pos":[889,895]},{"content":"Members","pos":[971,978]},{"content":"Public Constructors","pos":[988,1007]},{"content":"Name","pos":[1014,1018]},{"content":"Description","pos":[1019,1030]},{"content":"CFtpConnection::CFtpConnection","pos":[1069,1099]},{"pos":[1134,1171],"content":"Constructs a <ph id=\"ph1\">`CFtpConnection`</ph> object.","source":"Constructs a `CFtpConnection` object."},{"content":"Public Methods","pos":[1182,1196]},{"content":"Name","pos":[1203,1207]},{"content":"Description","pos":[1208,1219]},{"content":"CFtpConnection::Command","pos":[1258,1281]},{"content":"Sends a command directly to an FTP server.","pos":[1309,1351]},{"content":"CFtpConnection::CreateDirectory","pos":[1357,1388]},{"content":"Creates a directory on the server.","pos":[1424,1458]},{"content":"CFtpConnection::GetCurrentDirectory","pos":[1464,1499]},{"content":"Gets the current directory for this connection.","pos":[1539,1586]},{"content":"CFtpConnection::GetCurrentDirectoryAsURL","pos":[1592,1632]},{"content":"Gets the current directory for this connection as a URL.","pos":[1677,1733]},{"content":"CFtpConnection::GetFile","pos":[1739,1762]},{"content":"Gets a file from the connected server","pos":[1790,1827]},{"content":"CFtpConnection::OpenFile","pos":[1833,1857]},{"content":"Opens a file on the connected server.","pos":[1886,1923]},{"content":"CFtpConnection::PutFile","pos":[1929,1952]},{"content":"Places a file on the server.","pos":[1980,2008]},{"content":"CFtpConnection::Remove","pos":[2014,2036]},{"content":"Removes a file from the server.","pos":[2063,2094]},{"content":"CFtpConnection::RemoveDirectory","pos":[2100,2131]},{"content":"Removes the specified directory from the server.","pos":[2167,2215]},{"content":"CFtpConnection::Rename","pos":[2221,2243]},{"content":"Renames a file on the server.","pos":[2270,2299]},{"content":"CFtpConnection::SetCurrentDirectory","pos":[2305,2340]},{"content":"Sets the current FTP directory.","pos":[2380,2411]},{"content":"Remarks","pos":[2421,2428]},{"content":"FTP is one of the three Internet services recognized by the MFC WinInet classes.","pos":[2432,2512]},{"content":"To communicate with an FTP Internet server, you must first create an instance of <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept>, and then create a <ph id=\"ph1\">`CFtpConnection`</ph> object.","pos":[2519,2709],"source":"To communicate with an FTP Internet server, you must first create an instance of [CInternetSession](../../mfc/reference/cinternetsession-class.md), and then create a `CFtpConnection` object."},{"content":"You never create a <ph id=\"ph1\">`CFtpConnection`</ph> object directly; rather, call <bpt id=\"p1\">[</bpt>CInternetSession::GetFtpConnection<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__getftpconnection)</ept>, which creates the <ph id=\"ph2\">`CFtpConnection`</ph> object and returns a pointer to it.","pos":[2710,2966],"source":" You never create a `CFtpConnection` object directly; rather, call [CInternetSession::GetFtpConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getftpconnection), which creates the `CFtpConnection` object and returns a pointer to it."},{"content":"To learn more about how <ph id=\"ph1\">`CFtpConnection`</ph> works with the other MFC Internet classes, see the article <bpt id=\"p1\">[</bpt>Internet Programming with WinInet<ept id=\"p1\">](../../mfc/win32-internet-extensions-wininet.md)</ept>.","pos":[2973,3157],"source":"To learn more about how `CFtpConnection` works with the other MFC Internet classes, see the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md)."},{"content":"For more information about communicating with the other two supported services, HTTP and gopher, see the classes <bpt id=\"p1\">[</bpt>CHttpConnection<ept id=\"p1\">](../../mfc/reference/chttpconnection-class.md)</ept> and <bpt id=\"p2\">[</bpt>CGopherConnection<ept id=\"p2\">](../../mfc/reference/cgopherconnection-class.md)</ept>.","pos":[3158,3407],"source":" For more information about communicating with the other two supported services, HTTP and gopher, see the classes [CHttpConnection](../../mfc/reference/chttpconnection-class.md) and [CGopherConnection](../../mfc/reference/cgopherconnection-class.md)."},{"content":"Example","pos":[3416,3423]},{"pos":[3428,3524],"content":"See the example in the <bpt id=\"p1\">[</bpt>CFtpFileFind<ept id=\"p1\">](../../mfc/reference/cftpfilefind-class.md)</ept> class overview.","source":"See the example in the [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md) class overview."},{"content":"Inheritance Hierarchy","pos":[3533,3554]},{"content":"CObject","pos":[3559,3566]},{"content":"CInternetConnection","pos":[3613,3632]},{"content":"Requirements","pos":[3715,3727]},{"pos":[3731,3752],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxinet.h","source":"**Header:** afxinet.h"},{"pos":[3809,3839],"content":"CFtpConnection::CFtpConnection"},{"pos":[3843,3913],"content":"This member function is called to construct a <ph id=\"ph1\">`CFtpConnection`</ph> object.","source":"This member function is called to construct a `CFtpConnection` object."},{"content":"Parameters","pos":[4334,4344]},{"content":"A pointer to the related <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object.","pos":[4362,4460],"source":" A pointer to the related [CInternetSession](../../mfc/reference/cinternetsession-class.md) object."},{"content":"The Windows handle of the current Internet session.","pos":[4483,4534]},{"content":"A pointer to a string containing the FTP server name.","pos":[4557,4610]},{"content":"The context identifier for the operation.","pos":[4632,4673]},{"content":"identifies the operation's status information returned by <bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)</ept>.","pos":[4686,4863],"source":" identifies the operation's status information returned by [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)."},{"content":"The default is set to 1; however, you can explicitly assign a specific context ID for the operation.","pos":[4864,4964]},{"content":"The object and any work it does will be associated with that context ID.","pos":[4965,5037]},{"content":"Pointer to a null-terminated string that specifies the name of the user to log in.","pos":[5062,5144]},{"content":"If <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default is anonymous.","pos":[5145,5183],"source":" If **NULL**, the default is anonymous."},{"content":"A pointer to a null-terminated string that specifies the password to use to log in.","pos":[5208,5291]},{"content":"If both <ph id=\"ph1\">`pstrPassword`</ph> and <ph id=\"ph2\">`pstrUserName`</ph> are <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default anonymous password is the user's email name.","pos":[5292,5404],"source":" If both `pstrPassword` and `pstrUserName` are **NULL**, the default anonymous password is the user's email name."},{"content":"If <ph id=\"ph1\">`pstrPassword`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> (or an empty string) but <ph id=\"ph2\">`pstrUserName`</ph> is not <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>, a blank password is used.","pos":[5405,5517],"source":" If `pstrPassword` is **NULL** (or an empty string) but `pstrUserName` is not **NULL**, a blank password is used."},{"content":"The following table describes the behavior for the four possible settings of <ph id=\"ph1\">`pstrUserName`</ph> and <ph id=\"ph2\">`pstrPassword`</ph>:","pos":[5518,5629],"source":" The following table describes the behavior for the four possible settings of `pstrUserName` and `pstrPassword`:"},{"content":"Username sent to FTP server","pos":[5666,5693]},{"content":"Password sent to FTP server","pos":[5694,5721]},{"pos":[5840,5855],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or \" \"","source":"**NULL** or \" \""},{"pos":[5856,5871],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or \" \"","source":"**NULL** or \" \""},{"content":"\"anonymous\"","pos":[5872,5883]},{"content":"User's email name","pos":[5884,5901]},{"pos":[5906,5926],"content":"Non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> String","source":"Non- **NULL** String"},{"pos":[5927,5942],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or \" \"","source":"**NULL** or \" \""},{"content":"\" \"","pos":[5958,5961]},{"pos":[5966,5995],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> Non- <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> String","source":"**NULL** Non- **NULL** String"},{"content":"ERROR","pos":[5998,6003]},{"content":"ERROR","pos":[6008,6013]},{"pos":[6021,6041],"content":"Non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> String","source":"Non- **NULL** String"},{"pos":[6042,6062],"content":"Non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> String","source":"Non- **NULL** String"},{"content":"A number that identifies the TCP/IP port to use on the server.","pos":[6111,6173]},{"content":"Specifies passive or active mode for this FTP session.","pos":[6194,6248]},{"content":"If set to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, it sets the Win32 API <ph id=\"ph1\">`dwFlag`</ph> to <bpt id=\"p2\">**</bpt>INTERNET_FLAG_PASSIVE<ept id=\"p2\">**</ept>.","pos":[6249,6329],"source":" If set to **TRUE**, it sets the Win32 API `dwFlag` to **INTERNET_FLAG_PASSIVE**."},{"content":"Remarks","pos":[6339,6346]},{"content":"You never create a <ph id=\"ph1\">`CFtpConnection`</ph> object directly.","pos":[6350,6402],"source":"You never create a `CFtpConnection` object directly."},{"content":"Instead, call <bpt id=\"p1\">[</bpt>CInternetSession::GetFtpConnection<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__getftpconnection)</ept>, which creates the <bpt id=\"p2\">**</bpt>CFptConnection<ept id=\"p2\">**</ept> object.","pos":[6403,6581],"source":" Instead, call [CInternetSession::GetFtpConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getftpconnection), which creates the **CFptConnection** object."},{"pos":[6631,6654],"content":"CFtpConnection::Command"},{"content":"Sends a command directly to an FTP server.","pos":[6658,6700]},{"content":"Parameters","pos":[6900,6910]},{"content":"A pointer to a string containing the command to be sent.","pos":[6930,6986]},{"content":"eResponse","pos":[6994,7003]},{"content":"Determines whether a response is expected from the FTP server.","pos":[7008,7070]},{"content":"Can be one of the following values:","pos":[7071,7106]},{"pos":[7114,7154],"content":"<bpt id=\"p1\">**</bpt>CmdRespNone<ept id=\"p1\">**</ept> No response is expected.","source":"**CmdRespNone** No response is expected."},{"pos":[7162,7201],"content":"<bpt id=\"p1\">**</bpt>CmdRespRead<ept id=\"p1\">**</ept> A response is expected.","source":"**CmdRespRead** A response is expected."},{"pos":[7208,7376],"content":"`dwFlags`  \nA value containing the flags that control this function. For a complete list, see [FTPCommand](http://msdn.microsoft.com/library/windows/desktop/aa384133).","leadings":[""," "],"nodes":[{"content":"A value containing the flags that control this function. For a complete list, see [FTPCommand](http://msdn.microsoft.com/library/windows/desktop/aa384133).","pos":[12,167],"nodes":[{"content":"A value containing the flags that control this function.","pos":[0,56]},{"content":"For a complete list, see <bpt id=\"p1\">[</bpt>FTPCommand<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa384133)</ept>.","pos":[57,155],"source":" For a complete list, see [FTPCommand](http://msdn.microsoft.com/library/windows/desktop/aa384133)."}]}]},{"pos":[7383,7513],"content":"`dwContext`  \nA pointer to a value containing an application-defined value used to identify the application context in callbacks.","leadings":[""," "],"nodes":[{"content":"A pointer to a value containing an application-defined value used to identify the application context in callbacks.","pos":[14,129]}]},{"content":"Return Value","pos":[7523,7535]},{"content":"Nonzero if successful; otherwise 0.","pos":[7539,7574]},{"content":"Remarks","pos":[7584,7591]},{"pos":[7595,7805],"content":"This member function emulates the functionality of the <bpt id=\"p1\">[</bpt>FTPCommand<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa384133)</ept> function, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This member function emulates the functionality of the [FTPCommand](http://msdn.microsoft.com/library/windows/desktop/aa384133) function, as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[7812,7934],"content":"If an error occurs, MFC throws an exception of type <bpt id=\"p1\">[</bpt>CInternetException<ept id=\"p1\">](../../mfc/reference/cinternetexception-class.md)</ept>.","source":"If an error occurs, MFC throws an exception of type [CInternetException](../../mfc/reference/cinternetexception-class.md)."},{"pos":[7992,8023],"content":"CFtpConnection::CreateDirectory"},{"content":"Call this member function to create a directory on the connected server.","pos":[8027,8099]},{"content":"Parameters","pos":[8167,8177]},{"content":"A pointer to a string containing the name of the directory to create.","pos":[8198,8267]},{"content":"Return Value","pos":[8277,8289]},{"content":"Nonzero if successful; otherwise 0.","pos":[8293,8328]},{"content":"If the call fails, the Windows function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[8329,8494],"source":" If the call fails, the Windows function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"content":"Remarks","pos":[8504,8511]},{"content":"Use <ph id=\"ph1\">`GetCurrentDirectory`</ph> to determine the current working directory for this connection to the server.","pos":[8515,8618],"source":"Use `GetCurrentDirectory` to determine the current working directory for this connection to the server."},{"content":"Do not assume that the remote system has connected you to the root directory.","pos":[8619,8696]},{"content":"The <ph id=\"ph1\">`pstrDirName`</ph> parameter can be either a partially or a fully qualified filename relative to the current directory.","pos":[8703,8821],"source":"The `pstrDirName` parameter can be either a partially or a fully qualified filename relative to the current directory."},{"content":"A backslash (<ph id=\"ph1\">\\\\</ph>) or forward slash (/) can be used as the directory separator for either name.","pos":[8822,8915],"source":" A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name."},{"content":"translates the directory name separators to the appropriate characters before they are used.","pos":[8934,9026]},{"pos":[9088,9123],"content":"CFtpConnection::GetCurrentDirectory"},{"content":"Call this member function to get the name of the current directory.","pos":[9127,9194]},{"content":"Parameters","pos":[9365,9375]},{"content":"A reference to a string that will receive the name of the directory.","pos":[9395,9463]},{"content":"A pointer to a string that will receive the name of the directory.","pos":[9487,9553]},{"content":"A pointer to a DWORD that contains the following information:","pos":[9573,9634]},{"content":"On entry","pos":[9655,9663]},{"pos":[9664,9715],"content":"The size of the buffer referenced by <ph id=\"ph1\">`pstrDirName`</ph>.","source":"The size of the buffer referenced by `pstrDirName`."},{"content":"On return","pos":[9720,9729]},{"content":"The number of characters stored to <ph id=\"ph1\">`pstrDirName`</ph>.","pos":[9730,9779],"source":"The number of characters stored to `pstrDirName`."},{"content":"If the member function fails and ERROR_INSUFFICIENT_BUFFER is returned, then <ph id=\"ph1\">`lpdwLen`</ph> contains the number of bytes that the application must allocate in order to receive the string.","pos":[9780,9962],"source":" If the member function fails and ERROR_INSUFFICIENT_BUFFER is returned, then `lpdwLen` contains the number of bytes that the application must allocate in order to receive the string."},{"content":"Return Value","pos":[9973,9985]},{"content":"Nonzero if successful; otherwise 0.","pos":[9989,10024]},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[10025,10188],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"content":"Remarks","pos":[10198,10205]},{"pos":[10209,10328],"content":"To get the directory name as a URL instead, call <bpt id=\"p1\">[</bpt>GetCurrentDirectoryAsURL<ept id=\"p1\">](#cftpconnection__getcurrentdirectoryasurl)</ept>.","source":"To get the directory name as a URL instead, call [GetCurrentDirectoryAsURL](#cftpconnection__getcurrentdirectoryasurl)."},{"content":"The parameters <ph id=\"ph1\">`pstrDirName`</ph> or <ph id=\"ph2\">`strDirName`</ph> can be either partially qualified filenames relative to the current directory or fully qualified.","pos":[10335,10477],"source":"The parameters `pstrDirName` or `strDirName` can be either partially qualified filenames relative to the current directory or fully qualified."},{"content":"A backslash (<ph id=\"ph1\">\\\\</ph>) or forward slash (/) can be used as the directory separator for either name.","pos":[10478,10571],"source":" A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name."},{"content":"translates the directory name separators to the appropriate characters before they are used.","pos":[10594,10686]},{"pos":[10753,10793],"content":"CFtpConnection::GetCurrentDirectoryAsURL"},{"content":"Call this member function to get the current directory's name as a URL.","pos":[10797,10868]},{"content":"Parameters","pos":[11046,11056]},{"content":"A reference to a string that will receive the name of the directory.","pos":[11076,11144]},{"content":"A pointer to a string that will receive the name of the directory.","pos":[11168,11234]},{"content":"A pointer to a DWORD that contains the following information:","pos":[11254,11315]},{"content":"On entry","pos":[11336,11344]},{"pos":[11345,11396],"content":"The size of the buffer referenced by <ph id=\"ph1\">`pstrDirName`</ph>.","source":"The size of the buffer referenced by `pstrDirName`."},{"content":"On return","pos":[11401,11410]},{"content":"The number of characters stored to <ph id=\"ph1\">`pstrDirName`</ph>.","pos":[11411,11460],"source":"The number of characters stored to `pstrDirName`."},{"content":"If the member function fails and ERROR_INSUFFICIENT_BUFFER is returned, then <ph id=\"ph1\">`lpdwLen`</ph> contains the number of bytes that the application must allocate in order to receive the string.","pos":[11461,11643],"source":" If the member function fails and ERROR_INSUFFICIENT_BUFFER is returned, then `lpdwLen` contains the number of bytes that the application must allocate in order to receive the string."},{"content":"Return Value","pos":[11654,11666]},{"content":"Nonzero if successful; otherwise 0.","pos":[11670,11705]},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[11706,11869],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"content":"Remarks","pos":[11879,11886]},{"pos":[11917,11996],"content":"behaves the same as <bpt id=\"p1\">[</bpt>GetCurrentDirectory<ept id=\"p1\">](#cftpconnection__getcurrentdirectory)</ept>","source":" behaves the same as [GetCurrentDirectory](#cftpconnection__getcurrentdirectory)"},{"content":"The parameter <ph id=\"ph1\">`strDirName`</ph> can be either partially qualified filenames relative to the current directory or fully qualified.","pos":[12003,12127],"source":"The parameter `strDirName` can be either partially qualified filenames relative to the current directory or fully qualified."},{"content":"A backslash (<ph id=\"ph1\">\\\\</ph>) or forward slash (/) can be used as the directory separator for either name.","pos":[12128,12221],"source":" A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name."},{"content":"translates the directory name separators to the appropriate characters before they are used.","pos":[12249,12341]},{"pos":[12391,12414],"content":"CFtpConnection::GetFile"},{"content":"Call this member function to get a file from an FTP server and store it on the local machine.","pos":[12418,12511]},{"content":"Parameters","pos":[12770,12780]},{"content":"A pointer to a null-terminated string containing the name of a file to retrieve from the FTP server.","pos":[12804,12904]},{"content":"A pointer to a null-terminated string containing the name of the file to create on the local system.","pos":[12930,13030]},{"content":"bFailIfExists","pos":[13038,13051]},{"content":"Indicates whether the file name may already be used by an existing file.","pos":[13056,13128]},{"content":"If the local file name already exists, and this parameter is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, <ph id=\"ph1\">`GetFile`</ph> fails.","pos":[13129,13216],"source":" If the local file name already exists, and this parameter is **TRUE**, `GetFile` fails."},{"content":"Otherwise, <ph id=\"ph1\">`GetFile`</ph> will erase the existing copy of the file.","pos":[13217,13279],"source":" Otherwise, `GetFile` will erase the existing copy of the file."},{"content":"Indicates the attributes of the file.","pos":[13304,13341]},{"content":"This can be any combination of the following FILE_ATTRIBUTE_* flags.","pos":[13342,13410]},{"content":"FILE_ATTRIBUTE_ARCHIVE   The file is an archive file.","pos":[13420,13473]},{"content":"Applications use this attribute to mark files for backup or removal.","pos":[13474,13542]},{"content":"FILE_ATTRIBUTE_COMPRESSED   The file or directory is compressed.","pos":[13552,13616]},{"content":"For a file, compression means that all of the data in the file is compressed.","pos":[13617,13694]},{"content":"For a directory, compression is the default for newly created files and subdirectories.","pos":[13695,13782]},{"content":"FILE_ATTRIBUTE_DIRECTORY   The file is a directory.","pos":[13792,13843]},{"content":"FILE_ATTRIBUTE_NORMAL   The file has no other attributes set.","pos":[13853,13914]},{"content":"This attribute is valid only if used alone.","pos":[13915,13958]},{"content":"All other file attributes override FILE_ATTRIBUTE_NORMAL:","pos":[13959,14016]},{"content":"FILE_ATTRIBUTE_HIDDEN   The file is hidden.","pos":[14026,14069]},{"content":"It is not to be included in an ordinary directory listing.","pos":[14070,14128]},{"content":"FILE_ATTRIBUTE_READONLY   The file is read only.","pos":[14138,14186]},{"content":"Applications can read the file but cannot write to it or delete it.","pos":[14187,14254]},{"content":"FILE_ATTRIBUTE_SYSTEM   The file is part of or is used exclusively by the operating system.","pos":[14264,14355]},{"content":"FILE_ATTRIBUTE_TEMPORARY   The file is being used for temporary storage.","pos":[14365,14437]},{"content":"Applications should write to the file only if absolutely necessary.","pos":[14438,14505]},{"content":"Most of the file's data remains in memory without being flushed to the media because the file will soon be deleted.","pos":[14506,14621]},{"pos":[14628,14894],"content":"`dwFlags`  \nSpecifies the conditions under which the transfer occurs. This parameter can be any of the `dwFlags` values described in [FtpGetFile](http://msdn.microsoft.com/library/windows/desktop/aa384157) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].","leadings":[""," "],"nodes":[{"content":"Specifies the conditions under which the transfer occurs. This parameter can be any of the `dwFlags` values described in [FtpGetFile](http://msdn.microsoft.com/library/windows/desktop/aa384157) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].","pos":[12,265],"nodes":[{"content":"Specifies the conditions under which the transfer occurs.","pos":[0,57]},{"content":"This parameter can be any of the <ph id=\"ph1\">`dwFlags`</ph> values described in <bpt id=\"p1\">[</bpt>FtpGetFile<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa384157)</ept> in the <ph id=\"ph2\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[58,253],"source":" This parameter can be any of the `dwFlags` values described in [FtpGetFile](http://msdn.microsoft.com/library/windows/desktop/aa384157) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."}]}]},{"pos":[14901,15018],"content":"`dwContext`  \nThe context identifier for the file retrieval. See **Remarks** for more information about `dwContext`.","leadings":[""," "],"nodes":[{"content":"The context identifier for the file retrieval. See **Remarks** for more information about `dwContext`.","pos":[14,116],"nodes":[{"content":"The context identifier for the file retrieval.","pos":[0,46]},{"content":"See <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> for more information about <ph id=\"ph1\">`dwContext`</ph>.","pos":[47,102],"source":" See **Remarks** for more information about `dwContext`."}]}]},{"content":"Return Value","pos":[15028,15040]},{"content":"Nonzero if successful; otherwise 0.","pos":[15044,15079]},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[15080,15243],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"content":"Remarks","pos":[15253,15260]},{"content":"is a high-level routine that handles all of the overhead associated with reading a file from an FTP server and storing it locally.","pos":[15274,15404]},{"content":"Applications that only retrieve file data, or that require close control over the file transfer, should use <ph id=\"ph1\">`OpenFile`</ph> and <bpt id=\"p1\">[</bpt>CInternetFile::Read<ept id=\"p1\">](../../mfc/reference/cinternetfile-class.md#cinternetfile__read)</ept> instead.","pos":[15405,15622],"source":" Applications that only retrieve file data, or that require close control over the file transfer, should use `OpenFile` and [CInternetFile::Read](../../mfc/reference/cinternetfile-class.md#cinternetfile__read) instead."},{"content":"If <ph id=\"ph1\">`dwFlags`</ph> is FILE_TRANSFER_TYPE_ASCII, translation of file data also converts control and formatting characters to Windows equivalents.","pos":[15629,15767],"source":"If `dwFlags` is FILE_TRANSFER_TYPE_ASCII, translation of file data also converts control and formatting characters to Windows equivalents."},{"content":"The default transfer is binary mode, where the file is downloaded in the same format as it is stored on the server.","pos":[15768,15883]},{"content":"Both <ph id=\"ph1\">`pstrRemoteFile`</ph> and <ph id=\"ph2\">`pstrLocalFile`</ph> can be either partially qualified filenames relative to the current directory or fully qualified.","pos":[15890,16029],"source":"Both `pstrRemoteFile` and `pstrLocalFile` can be either partially qualified filenames relative to the current directory or fully qualified."},{"content":"A backslash (<ph id=\"ph1\">\\\\</ph>) or forward slash (/) can be used as the directory separator for either name.","pos":[16030,16123],"source":" A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name."},{"content":"translates the directory name separators to the appropriate characters before they are used.","pos":[16134,16226]},{"content":"Override the <ph id=\"ph1\">`dwContext`</ph> default to set the context identifier to a value of your choosing.","pos":[16233,16324],"source":"Override the `dwContext` default to set the context identifier to a value of your choosing."},{"content":"The context identifier is associated with this specific operation of the <ph id=\"ph1\">`CFtpConnection`</ph> object created by its <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object.","pos":[16325,16510],"source":" The context identifier is associated with this specific operation of the `CFtpConnection` object created by its [CInternetSession](../../mfc/reference/cinternetsession-class.md) object."},{"content":"The value is returned to <bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)</ept> to provide status on the operation with which it is identified.","pos":[16511,16718],"source":" The value is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the operation with which it is identified."},{"content":"See the article <bpt id=\"p1\">[</bpt>Internet First Steps: WinInet<ept id=\"p1\">](../../mfc/wininet-basics.md)</ept> for more information about the context identifier.","pos":[16719,16846],"source":" See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier."},{"pos":[16897,16921],"content":"CFtpConnection::OpenFile"},{"content":"Call this member function to open a file located on an FTP server for reading or writing.","pos":[16925,17014]},{"content":"Parameters","pos":[17207,17217]},{"content":"A pointer to a string containing the name of the file to be opened.","pos":[17239,17306]},{"content":"dwAccess","pos":[17314,17322]},{"content":"Determines how the file will be accessed.","pos":[17327,17368]},{"content":"Can be either GENERIC_READ or GENERIC_WRITE, but not both.","pos":[17369,17427]},{"content":"Specifies the conditions under which subsequent transfers occur.","pos":[17447,17511]},{"content":"This can be any of the following FTP_TRANSFER_* constants:","pos":[17512,17570]},{"content":"FTP_TRANSFER_TYPE_ASCII   The file transfers using FTP ASCII (Type A) transfer method.","pos":[17580,17666]},{"content":"Converts control and formatting information to local equivalents.","pos":[17667,17732]},{"content":"FTP_TRANSFER_TYPE_BINARY   The file transfers data using FTP's Image (Type I) transfer method.","pos":[17742,17836]},{"content":"The file transfers data exactly as it exists, with no changes.","pos":[17837,17899]},{"content":"This is the default transfer method.","pos":[17900,17936]},{"pos":[17943,18058],"content":"`dwContext`  \nThe context identifier for opening the file. See **Remarks** for more information about `dwContext`.","leadings":[""," "],"nodes":[{"content":"The context identifier for opening the file. See **Remarks** for more information about `dwContext`.","pos":[14,114],"nodes":[{"content":"The context identifier for opening the file.","pos":[0,44]},{"content":"See <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> for more information about <ph id=\"ph1\">`dwContext`</ph>.","pos":[45,100],"source":" See **Remarks** for more information about `dwContext`."}]}]},{"content":"Return Value","pos":[18068,18080]},{"pos":[18084,18166],"content":"A pointer to a <bpt id=\"p1\">[</bpt>CInternetFile<ept id=\"p1\">](../../mfc/reference/cinternetfile-class.md)</ept> object.","source":"A pointer to a [CInternetFile](../../mfc/reference/cinternetfile-class.md) object."},{"content":"Remarks","pos":[18176,18183]},{"pos":[18198,18241],"content":"should be used in the following situations:"},{"content":"An application has data that needs to be sent and created as a file on the FTP server, but that data is not in a local file.","pos":[18251,18375]},{"content":"Once <ph id=\"ph1\">`OpenFile`</ph> opens a file, the application uses <bpt id=\"p1\">[</bpt>CInternetFile::Write<ept id=\"p1\">](../../mfc/reference/cinternetfile-class.md#cinternetfile__write)</ept> to send the FTP file data to the server.","pos":[18376,18555],"source":" Once `OpenFile` opens a file, the application uses [CInternetFile::Write](../../mfc/reference/cinternetfile-class.md#cinternetfile__write) to send the FTP file data to the server."},{"content":"An application must retrieve a file from the server and place it into application-controlled memory, instead of writing it to disk.","pos":[18565,18696]},{"content":"The application uses <bpt id=\"p1\">[</bpt>CInternetFile::Read<ept id=\"p1\">](../../mfc/reference/cinternetfile-class.md#cinternetfile__read)</ept> after using <ph id=\"ph1\">`OpenFile`</ph> to open the file.","pos":[18697,18844],"source":" The application uses [CInternetFile::Read](../../mfc/reference/cinternetfile-class.md#cinternetfile__read) after using `OpenFile` to open the file."},{"content":"An application needs a fine level of control over a file transfer.","pos":[18854,18920]},{"content":"For example, the application may want to display a progress control indicate the progress of the file transfer status while downloading a file.","pos":[18921,19064]},{"content":"After calling <ph id=\"ph1\">`OpenFile`</ph> and until calling <bpt id=\"p1\">**</bpt>CInternetConnection::Close<ept id=\"p1\">**</ept>, the application can only call <bpt id=\"p2\">[</bpt>CInternetFile::Read<ept id=\"p2\">](../../mfc/reference/cinternetfile-class.md#cinternetfile__read)</ept>, <bpt id=\"p3\">[</bpt>CInternetFile::Write<ept id=\"p3\">](../../mfc/reference/cinternetfile-class.md#cinternetfile__write)</ept>, <bpt id=\"p4\">**</bpt>CInternetConnection::Close<ept id=\"p4\">**</ept>, or <bpt id=\"p5\">[</bpt>CFtpFileFind::FindFile<ept id=\"p5\">](../../mfc/reference/cftpfilefind-class.md#cftpfilefind__findfile)</ept>.","pos":[19071,19478],"source":"After calling `OpenFile` and until calling **CInternetConnection::Close**, the application can only call [CInternetFile::Read](../../mfc/reference/cinternetfile-class.md#cinternetfile__read), [CInternetFile::Write](../../mfc/reference/cinternetfile-class.md#cinternetfile__write), **CInternetConnection::Close**, or [CFtpFileFind::FindFile](../../mfc/reference/cftpfilefind-class.md#cftpfilefind__findfile)."},{"content":"Calls to other FTP functions for the same FTP session will fail and set the error code to FTP_ETRANSFER_IN_PROGRESS.","pos":[19479,19595]},{"content":"The <ph id=\"ph1\">`pstrFileName`</ph> parameter can be either a partially qualified filename relative to the current directory or fully qualified.","pos":[19602,19729],"source":"The `pstrFileName` parameter can be either a partially qualified filename relative to the current directory or fully qualified."},{"content":"A backslash (<ph id=\"ph1\">\\\\</ph>) or forward slash (/) can be used as the directory separator for either name.","pos":[19730,19823],"source":" A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name."},{"content":"translates the directory name separators to the appropriate characters before using it.","pos":[19835,19922]},{"content":"Override the <ph id=\"ph1\">`dwContext`</ph> default to set the context identifier to a value of your choosing.","pos":[19929,20020],"source":"Override the `dwContext` default to set the context identifier to a value of your choosing."},{"content":"The context identifier is associated with this specific operation of the <ph id=\"ph1\">`CFtpConnection`</ph> object created by its <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object.","pos":[20021,20206],"source":" The context identifier is associated with this specific operation of the `CFtpConnection` object created by its [CInternetSession](../../mfc/reference/cinternetsession-class.md) object."},{"content":"The value is returned to <bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)</ept> to provide status on the operation with which it is identified.","pos":[20207,20414],"source":" The value is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the operation with which it is identified."},{"content":"See the article <bpt id=\"p1\">[</bpt>Internet First Steps: WinInet<ept id=\"p1\">](../../mfc/wininet-basics.md)</ept> for more information about the context identifier.","pos":[20415,20542],"source":" See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier."},{"pos":[20592,20615],"content":"CFtpConnection::PutFile"},{"content":"Call this member function to store a file on an FTP server.","pos":[20619,20678]},{"content":"Parameters","pos":[20854,20864]},{"content":"A pointer to a string containing the name of the file to send from the local system.","pos":[20887,20971]},{"content":"A pointer to a string containing the name of the file to create on the FTP server.","pos":[20998,21080]},{"content":"Specifies the conditions under which the transfer of the file occurs.","pos":[21100,21169]},{"content":"Can be any of the FTP_TRANSFER_* constants described in <bpt id=\"p1\">[</bpt>OpenFile<ept id=\"p1\">](#cftpconnection__openfile)</ept>.","pos":[21170,21264],"source":" Can be any of the FTP_TRANSFER_* constants described in [OpenFile](#cftpconnection__openfile)."},{"content":"The context identifier for placing the file.","pos":[21286,21330]},{"content":"See <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> for more information about <ph id=\"ph1\">`dwContext`</ph>.","pos":[21331,21386],"source":" See **Remarks** for more information about `dwContext`."},{"content":"Return Value","pos":[21396,21408]},{"content":"Nonzero if successful; otherwise 0.","pos":[21412,21447]},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[21448,21611],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"content":"Remarks","pos":[21621,21628]},{"content":"is a high-level routine that handles all of the operations associated with storing a file on an FTP server.","pos":[21642,21749]},{"content":"Applications that only send data, or that require closer control over the file transfer, should use <bpt id=\"p1\">[</bpt>OpenFile<ept id=\"p1\">](#cftpconnection__openfile)</ept> and <bpt id=\"p2\">[</bpt>CInternetFile::Write<ept id=\"p2\">](../../mfc/reference/cinternetfile-class.md#cinternetfile__write)</ept>.","pos":[21750,21980],"source":" Applications that only send data, or that require closer control over the file transfer, should use [OpenFile](#cftpconnection__openfile) and [CInternetFile::Write](../../mfc/reference/cinternetfile-class.md#cinternetfile__write)."},{"content":"Override the <ph id=\"ph1\">`dwContext`</ph> default to set the context identifier to a value of your choosing.","pos":[21987,22078],"source":"Override the `dwContext` default to set the context identifier to a value of your choosing."},{"content":"The context identifier is associated with this specific operation of the <ph id=\"ph1\">`CFtpConnection`</ph> object created by its <bpt id=\"p1\">[</bpt>CInternetSession<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md)</ept> object.","pos":[22079,22264],"source":" The context identifier is associated with this specific operation of the `CFtpConnection` object created by its [CInternetSession](../../mfc/reference/cinternetsession-class.md) object."},{"content":"The value is returned to <bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback)</ept> to provide status on the operation with which it is identified.","pos":[22265,22472],"source":" The value is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the operation with which it is identified."},{"content":"See the article <bpt id=\"p1\">[</bpt>Internet First Steps: WinInet<ept id=\"p1\">](../../mfc/wininet-basics.md)</ept> for more information about the context identifier.","pos":[22473,22600],"source":" See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier."},{"pos":[22649,22671],"content":"CFtpConnection::Remove"},{"content":"Call this member function to delete the specified file from the connected server.","pos":[22675,22756]},{"content":"Parameters","pos":[22816,22826]},{"content":"A pointer to a string containing the file name to remove.","pos":[22848,22905]},{"content":"Return Value","pos":[22915,22927]},{"content":"Nonzero if successful; otherwise 0.","pos":[22931,22966]},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[22967,23130],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"content":"Remarks","pos":[23140,23147]},{"content":"The <ph id=\"ph1\">`pstrFileName`</ph> parameter can be either a partially qualified filename relative to the current directory or fully qualified.","pos":[23151,23278],"source":"The `pstrFileName` parameter can be either a partially qualified filename relative to the current directory or fully qualified."},{"content":"A backslash (<ph id=\"ph1\">\\\\</ph>) or forward slash (/) can be used as the directory separator for either name.","pos":[23279,23372],"source":" A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name."},{"content":"The <bpt id=\"p1\">**</bpt>Remove<ept id=\"p1\">**</ept> function translates the directory name separators to the appropriate characters before they are used.","pos":[23373,23489],"source":" The **Remove** function translates the directory name separators to the appropriate characters before they are used."},{"pos":[23547,23578],"content":"CFtpConnection::RemoveDirectory"},{"content":"Call this member function to remove the specified directory from the connected server.","pos":[23582,23668]},{"content":"Parameters","pos":[23736,23746]},{"content":"A pointer to a string containing the directory to be removed.","pos":[23767,23828]},{"content":"Return Value","pos":[23838,23850]},{"content":"Nonzero if successful; otherwise 0.","pos":[23854,23889]},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[23890,24053],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"content":"Remarks","pos":[24063,24070]},{"content":"Use <bpt id=\"p1\">[</bpt>GetCurrentDirectory<ept id=\"p1\">](#cftpconnection__getcurrentdirectory)</ept> to determine the server's current working directory.","pos":[24074,24190],"source":"Use [GetCurrentDirectory](#cftpconnection__getcurrentdirectory) to determine the server's current working directory."},{"content":"Do not assume that the remote system has connected you to the root directory.","pos":[24191,24268]},{"content":"The <ph id=\"ph1\">`pstrDirName`</ph> parameter can be either a partially or fully qualified filename relative to the current directory.","pos":[24275,24391],"source":"The `pstrDirName` parameter can be either a partially or fully qualified filename relative to the current directory."},{"content":"A backslash (<ph id=\"ph1\">\\\\</ph>) or forward slash (/) can be used as the directory separator for either name.","pos":[24392,24485],"source":" A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name."},{"content":"translates the directory name separators to the appropriate characters before they are used.","pos":[24504,24596]},{"pos":[24645,24667],"content":"CFtpConnection::Rename"},{"content":"Call this member function to rename the specified file on the connected server.","pos":[24671,24750]},{"content":"Parameters","pos":[24838,24848]},{"content":"A pointer to a string containing the current name of the file to be renamed.","pos":[24870,24946]},{"content":"A pointer to a string containing the file's new name.","pos":[24966,25019]},{"content":"Return Value","pos":[25029,25041]},{"content":"Nonzero if successful; otherwise 0.","pos":[25045,25080]},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[25081,25244],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"content":"Remarks","pos":[25254,25261]},{"content":"The <ph id=\"ph1\">`pstrExisting`</ph> and <ph id=\"ph2\">`pstrNew`</ph> parameters can be either a partially qualified filename relative to the current directory or fully qualified.","pos":[25265,25407],"source":"The `pstrExisting` and `pstrNew` parameters can be either a partially qualified filename relative to the current directory or fully qualified."},{"content":"A backslash (<ph id=\"ph1\">\\\\</ph>) or forward slash (/) can be used as the directory separator for either name.","pos":[25408,25501],"source":" A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name."},{"content":"<bpt id=\"p1\">**</bpt>Rename<ept id=\"p1\">**</ept> translates the directory name separators to the appropriate characters before they are used.","pos":[25502,25605],"source":"**Rename** translates the directory name separators to the appropriate characters before they are used."},{"pos":[25667,25702],"content":"CFtpConnection::SetCurrentDirectory"},{"content":"Call this member function to change to a different directory on the FTP server.","pos":[25706,25785]},{"content":"Parameters","pos":[25857,25867]},{"content":"A pointer to a string containing the name of the directory.","pos":[25888,25947]},{"content":"Return Value","pos":[25957,25969]},{"content":"Nonzero if successful; otherwise 0.","pos":[25973,26008]},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[26009,26172],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"content":"Remarks","pos":[26182,26189]},{"content":"The <ph id=\"ph1\">`pstrDirName`</ph> parameter can be either a partially or fully qualified filename relative to the current directory.","pos":[26193,26309],"source":"The `pstrDirName` parameter can be either a partially or fully qualified filename relative to the current directory."},{"content":"A backslash (<ph id=\"ph1\">\\\\</ph>) or forward slash (/) can be used as the directory separator for either name.","pos":[26310,26403],"source":" A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name."},{"content":"translates the directory name separators to the appropriate characters before they are used.","pos":[26426,26518]},{"content":"Use <bpt id=\"p1\">[</bpt>GetCurrentDirectory<ept id=\"p1\">](#cftpconnection__getcurrentdirectory)</ept> to determine an FTP server's current working directory.","pos":[26525,26644],"source":"Use [GetCurrentDirectory](#cftpconnection__getcurrentdirectory) to determine an FTP server's current working directory."},{"content":"Do not assume that the remote system has connected you to the root directory.","pos":[26645,26722]},{"content":"See Also","pos":[26731,26739]},{"content":"CInternetConnection Class","pos":[26744,26769]},{"content":"Hierarchy Chart","pos":[26826,26841]},{"content":"CInternetConnection Class","pos":[26878,26903]},{"content":"CInternetSession Class","pos":[26960,26982]}],"content":"---\ntitle: \"CFtpConnection Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CFtpConnection\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CFtpConnection class\"\n  - \"FTP (File Transfer Protocol), establishing connections\"\n  - \"Internet connections, FTP\"\n  - \"Internet services, FTP\"\nms.assetid: 5e3a0501-8893-49cf-a3d5-0628d8d6b936\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CFtpConnection Class\nManages your FTP connection to an Internet server and allows direct manipulation of directories and files on that server.  \n  \n## Syntax  \n  \n```  \nclass CFtpConnection : public CInternetConnection  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CFtpConnection::CFtpConnection](#cftpconnection__cftpconnection)|Constructs a `CFtpConnection` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CFtpConnection::Command](#cftpconnection__command)|Sends a command directly to an FTP server.|  \n|[CFtpConnection::CreateDirectory](#cftpconnection__createdirectory)|Creates a directory on the server.|  \n|[CFtpConnection::GetCurrentDirectory](#cftpconnection__getcurrentdirectory)|Gets the current directory for this connection.|  \n|[CFtpConnection::GetCurrentDirectoryAsURL](#cftpconnection__getcurrentdirectoryasurl)|Gets the current directory for this connection as a URL.|  \n|[CFtpConnection::GetFile](#cftpconnection__getfile)|Gets a file from the connected server|  \n|[CFtpConnection::OpenFile](#cftpconnection__openfile)|Opens a file on the connected server.|  \n|[CFtpConnection::PutFile](#cftpconnection__putfile)|Places a file on the server.|  \n|[CFtpConnection::Remove](#cftpconnection__remove)|Removes a file from the server.|  \n|[CFtpConnection::RemoveDirectory](#cftpconnection__removedirectory)|Removes the specified directory from the server.|  \n|[CFtpConnection::Rename](#cftpconnection__rename)|Renames a file on the server.|  \n|[CFtpConnection::SetCurrentDirectory](#cftpconnection__setcurrentdirectory)|Sets the current FTP directory.|  \n  \n## Remarks  \n FTP is one of the three Internet services recognized by the MFC WinInet classes.  \n  \n To communicate with an FTP Internet server, you must first create an instance of [CInternetSession](../../mfc/reference/cinternetsession-class.md), and then create a `CFtpConnection` object. You never create a `CFtpConnection` object directly; rather, call [CInternetSession::GetFtpConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getftpconnection), which creates the `CFtpConnection` object and returns a pointer to it.  \n  \n To learn more about how `CFtpConnection` works with the other MFC Internet classes, see the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md). For more information about communicating with the other two supported services, HTTP and gopher, see the classes [CHttpConnection](../../mfc/reference/chttpconnection-class.md) and [CGopherConnection](../../mfc/reference/cgopherconnection-class.md).  \n  \n## Example  \n  See the example in the [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md) class overview.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CInternetConnection](../../mfc/reference/cinternetconnection-class.md)  \n  \n `CFtpConnection`  \n  \n## Requirements  \n **Header:** afxinet.h  \n  \n##  <a name=\"cftpconnection__cftpconnection\"></a>  CFtpConnection::CFtpConnection  \n This member function is called to construct a `CFtpConnection` object.  \n  \n```  \nCFtpConnection(\n    CInternetSession* pSession,  \n    HINTERNET hConnected,  \n    LPCTSTR pstrServer,  \n    DWORD_PTR dwContext);\n\n \nCFtpConnection(\n    CInternetSession* pSession,  \n    LPCTSTR pstrServer,  \n    LPCTSTR pstrUserName = NULL,  \n    LPCTSTR pstrPassword = NULL,  \n    DWORD_PTR dwContext = 0,  \n    INTERNET_PORT nPort = INTERNET_INVALID_PORT_NUMBER,  \n    BOOL bPassive = FALSE);\n```  \n  \n### Parameters  \n `pSession`  \n A pointer to the related [CInternetSession](../../mfc/reference/cinternetsession-class.md) object.  \n  \n `hConnected`  \n The Windows handle of the current Internet session.  \n  \n `pstrServer`  \n A pointer to a string containing the FTP server name.  \n  \n `dwContext`  \n The context identifier for the operation. `dwContext` identifies the operation's status information returned by [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback). The default is set to 1; however, you can explicitly assign a specific context ID for the operation. The object and any work it does will be associated with that context ID.  \n  \n `pstrUserName`  \n Pointer to a null-terminated string that specifies the name of the user to log in. If **NULL**, the default is anonymous.  \n  \n `pstrPassword`  \n A pointer to a null-terminated string that specifies the password to use to log in. If both `pstrPassword` and `pstrUserName` are **NULL**, the default anonymous password is the user's email name. If `pstrPassword` is **NULL** (or an empty string) but `pstrUserName` is not **NULL**, a blank password is used. The following table describes the behavior for the four possible settings of `pstrUserName` and `pstrPassword`:  \n  \n|`pstrUserName`|`pstrPassword`|Username sent to FTP server|Password sent to FTP server|  \n|--------------------|--------------------|---------------------------------|---------------------------------|  \n|**NULL** or \" \"|**NULL** or \" \"|\"anonymous\"|User's email name|  \n|Non- **NULL** String|**NULL** or \" \"|`pstrUserName`|\" \"|  \n|**NULL** Non- **NULL** String|**ERROR**|**ERROR**||  \n|Non- **NULL** String|Non- **NULL** String|`pstrUserName`|`pstrPassword`|  \n  \n `nPort`  \n A number that identifies the TCP/IP port to use on the server.  \n  \n `bPassive`  \n Specifies passive or active mode for this FTP session. If set to **TRUE**, it sets the Win32 API `dwFlag` to **INTERNET_FLAG_PASSIVE**.  \n  \n### Remarks  \n You never create a `CFtpConnection` object directly. Instead, call [CInternetSession::GetFtpConnection](../../mfc/reference/cinternetsession-class.md#cinternetsession__getftpconnection), which creates the **CFptConnection** object.  \n  \n##  <a name=\"cftpconnection__command\"></a>  CFtpConnection::Command  \n Sends a command directly to an FTP server.  \n  \n```  \nCInternetFile* Command(\n    LPCTSTR pszCommand,  \n    CmdResponseType eResponse = CmdRespNone,  \n    DWORD dwFlags = FTP_TRANSFER_TYPE_BINARY,  \n    DWORD_PTR dwContext = 1);\n```  \n  \n### Parameters  \n `pszCommand`  \n A pointer to a string containing the command to be sent.  \n  \n *eResponse*  \n Determines whether a response is expected from the FTP server. Can be one of the following values:  \n  \n- **CmdRespNone** No response is expected.  \n  \n- **CmdRespRead** A response is expected.  \n  \n `dwFlags`  \n A value containing the flags that control this function. For a complete list, see [FTPCommand](http://msdn.microsoft.com/library/windows/desktop/aa384133).  \n  \n `dwContext`  \n A pointer to a value containing an application-defined value used to identify the application context in callbacks.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n This member function emulates the functionality of the [FTPCommand](http://msdn.microsoft.com/library/windows/desktop/aa384133) function, as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n If an error occurs, MFC throws an exception of type [CInternetException](../../mfc/reference/cinternetexception-class.md).  \n  \n##  <a name=\"cftpconnection__createdirectory\"></a>  CFtpConnection::CreateDirectory  \n Call this member function to create a directory on the connected server.  \n  \n```  \nBOOL CreateDirectory(LPCTSTR pstrDirName);\n```  \n  \n### Parameters  \n `pstrDirName`  \n A pointer to a string containing the name of the directory to create.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Windows function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n### Remarks  \n Use `GetCurrentDirectory` to determine the current working directory for this connection to the server. Do not assume that the remote system has connected you to the root directory.  \n  \n The `pstrDirName` parameter can be either a partially or a fully qualified filename relative to the current directory. A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name. `CreateDirectory` translates the directory name separators to the appropriate characters before they are used.  \n  \n##  <a name=\"cftpconnection__getcurrentdirectory\"></a>  CFtpConnection::GetCurrentDirectory  \n Call this member function to get the name of the current directory.  \n  \n```  \nBOOL GetCurrentDirectory(\n    CString& strDirName) const;\n\n \n \nBOOL GetCurrentDirectory(\n    LPTSTR pstrDirName,  \n    LPDWORD lpdwLen) const;\n\n \n```  \n  \n### Parameters  \n `strDirName`  \n A reference to a string that will receive the name of the directory.  \n  \n `pstrDirName`  \n A pointer to a string that will receive the name of the directory.  \n  \n `lpdwLen`  \n A pointer to a DWORD that contains the following information:  \n  \n|||  \n|-|-|  \n|On entry|The size of the buffer referenced by `pstrDirName`.|  \n|On return|The number of characters stored to `pstrDirName`. If the member function fails and ERROR_INSUFFICIENT_BUFFER is returned, then `lpdwLen` contains the number of bytes that the application must allocate in order to receive the string.|  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n### Remarks  \n To get the directory name as a URL instead, call [GetCurrentDirectoryAsURL](#cftpconnection__getcurrentdirectoryasurl).  \n  \n The parameters `pstrDirName` or `strDirName` can be either partially qualified filenames relative to the current directory or fully qualified. A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name. `GetCurrentDirectory` translates the directory name separators to the appropriate characters before they are used.  \n  \n##  <a name=\"cftpconnection__getcurrentdirectoryasurl\"></a>  CFtpConnection::GetCurrentDirectoryAsURL  \n Call this member function to get the current directory's name as a URL.  \n  \n```  \nBOOL GetCurrentDirectoryAsURL(\n    CString& strDirName) const;\n\n \n \nBOOL GetCurrentDirectoryAsURL(\n    LPTSTR pstrName,  \n    LPDWORD lpdwLen) const;\n\n \n```  \n  \n### Parameters  \n `strDirName`  \n A reference to a string that will receive the name of the directory.  \n  \n `pstrDirName`  \n A pointer to a string that will receive the name of the directory.  \n  \n `lpdwLen`  \n A pointer to a DWORD that contains the following information:  \n  \n|||  \n|-|-|  \n|On entry|The size of the buffer referenced by `pstrDirName`.|  \n|On return|The number of characters stored to `pstrDirName`. If the member function fails and ERROR_INSUFFICIENT_BUFFER is returned, then `lpdwLen` contains the number of bytes that the application must allocate in order to receive the string.|  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n### Remarks  \n `GetCurrentDirectoryAsURL` behaves the same as [GetCurrentDirectory](#cftpconnection__getcurrentdirectory)  \n  \n The parameter `strDirName` can be either partially qualified filenames relative to the current directory or fully qualified. A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name. `GetCurrentDirectoryAsURL` translates the directory name separators to the appropriate characters before they are used.  \n  \n##  <a name=\"cftpconnection__getfile\"></a>  CFtpConnection::GetFile  \n Call this member function to get a file from an FTP server and store it on the local machine.  \n  \n```  \nBOOL GetFile(\n    LPCTSTR pstrRemoteFile,  \n    LPCTSTR pstrLocalFile,  \n    BOOL bFailIfExists = TRUE,  \n    DWORD dwAttributes = FILE_ATTRIBUTE_NORMAL,  \n    DWORD dwFlags = FTP_TRANSFER_TYPE_BINARY,  \n    DWORD_PTR dwContext = 1);\n```  \n  \n### Parameters  \n `pstrRemoteFile`  \n A pointer to a null-terminated string containing the name of a file to retrieve from the FTP server.  \n  \n `pstrLocalFile`  \n A pointer to a null-terminated string containing the name of the file to create on the local system.  \n  \n *bFailIfExists*  \n Indicates whether the file name may already be used by an existing file. If the local file name already exists, and this parameter is **TRUE**, `GetFile` fails. Otherwise, `GetFile` will erase the existing copy of the file.  \n  \n `dwAttributes`  \n Indicates the attributes of the file. This can be any combination of the following FILE_ATTRIBUTE_* flags.  \n  \n-   FILE_ATTRIBUTE_ARCHIVE   The file is an archive file. Applications use this attribute to mark files for backup or removal.  \n  \n-   FILE_ATTRIBUTE_COMPRESSED   The file or directory is compressed. For a file, compression means that all of the data in the file is compressed. For a directory, compression is the default for newly created files and subdirectories.  \n  \n-   FILE_ATTRIBUTE_DIRECTORY   The file is a directory.  \n  \n-   FILE_ATTRIBUTE_NORMAL   The file has no other attributes set. This attribute is valid only if used alone. All other file attributes override FILE_ATTRIBUTE_NORMAL:  \n  \n-   FILE_ATTRIBUTE_HIDDEN   The file is hidden. It is not to be included in an ordinary directory listing.  \n  \n-   FILE_ATTRIBUTE_READONLY   The file is read only. Applications can read the file but cannot write to it or delete it.  \n  \n-   FILE_ATTRIBUTE_SYSTEM   The file is part of or is used exclusively by the operating system.  \n  \n-   FILE_ATTRIBUTE_TEMPORARY   The file is being used for temporary storage. Applications should write to the file only if absolutely necessary. Most of the file's data remains in memory without being flushed to the media because the file will soon be deleted.  \n  \n `dwFlags`  \n Specifies the conditions under which the transfer occurs. This parameter can be any of the `dwFlags` values described in [FtpGetFile](http://msdn.microsoft.com/library/windows/desktop/aa384157) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n `dwContext`  \n The context identifier for the file retrieval. See **Remarks** for more information about `dwContext`.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n### Remarks  \n `GetFile` is a high-level routine that handles all of the overhead associated with reading a file from an FTP server and storing it locally. Applications that only retrieve file data, or that require close control over the file transfer, should use `OpenFile` and [CInternetFile::Read](../../mfc/reference/cinternetfile-class.md#cinternetfile__read) instead.  \n  \n If `dwFlags` is FILE_TRANSFER_TYPE_ASCII, translation of file data also converts control and formatting characters to Windows equivalents. The default transfer is binary mode, where the file is downloaded in the same format as it is stored on the server.  \n  \n Both `pstrRemoteFile` and `pstrLocalFile` can be either partially qualified filenames relative to the current directory or fully qualified. A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name. `GetFile` translates the directory name separators to the appropriate characters before they are used.  \n  \n Override the `dwContext` default to set the context identifier to a value of your choosing. The context identifier is associated with this specific operation of the `CFtpConnection` object created by its [CInternetSession](../../mfc/reference/cinternetsession-class.md) object. The value is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the operation with which it is identified. See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier.  \n  \n##  <a name=\"cftpconnection__openfile\"></a>  CFtpConnection::OpenFile  \n Call this member function to open a file located on an FTP server for reading or writing.  \n  \n```  \nCInternetFile* OpenFile(\n    LPCTSTR pstrFileName,  \n    DWORD dwAccess = GENERIC_READ,  \n    DWORD dwFlags = FTP_TRANSFER_TYPE_BINARY,  \n    DWORD_PTR dwContext = 1);\n```  \n  \n### Parameters  \n `pstrFileName`  \n A pointer to a string containing the name of the file to be opened.  \n  \n *dwAccess*  \n Determines how the file will be accessed. Can be either GENERIC_READ or GENERIC_WRITE, but not both.  \n  \n `dwFlags`  \n Specifies the conditions under which subsequent transfers occur. This can be any of the following FTP_TRANSFER_* constants:  \n  \n-   FTP_TRANSFER_TYPE_ASCII   The file transfers using FTP ASCII (Type A) transfer method. Converts control and formatting information to local equivalents.  \n  \n-   FTP_TRANSFER_TYPE_BINARY   The file transfers data using FTP's Image (Type I) transfer method. The file transfers data exactly as it exists, with no changes. This is the default transfer method.  \n  \n `dwContext`  \n The context identifier for opening the file. See **Remarks** for more information about `dwContext`.  \n  \n### Return Value  \n A pointer to a [CInternetFile](../../mfc/reference/cinternetfile-class.md) object.  \n  \n### Remarks  \n `OpenFile` should be used in the following situations:  \n  \n-   An application has data that needs to be sent and created as a file on the FTP server, but that data is not in a local file. Once `OpenFile` opens a file, the application uses [CInternetFile::Write](../../mfc/reference/cinternetfile-class.md#cinternetfile__write) to send the FTP file data to the server.  \n  \n-   An application must retrieve a file from the server and place it into application-controlled memory, instead of writing it to disk. The application uses [CInternetFile::Read](../../mfc/reference/cinternetfile-class.md#cinternetfile__read) after using `OpenFile` to open the file.  \n  \n-   An application needs a fine level of control over a file transfer. For example, the application may want to display a progress control indicate the progress of the file transfer status while downloading a file.  \n  \n After calling `OpenFile` and until calling **CInternetConnection::Close**, the application can only call [CInternetFile::Read](../../mfc/reference/cinternetfile-class.md#cinternetfile__read), [CInternetFile::Write](../../mfc/reference/cinternetfile-class.md#cinternetfile__write), **CInternetConnection::Close**, or [CFtpFileFind::FindFile](../../mfc/reference/cftpfilefind-class.md#cftpfilefind__findfile). Calls to other FTP functions for the same FTP session will fail and set the error code to FTP_ETRANSFER_IN_PROGRESS.  \n  \n The `pstrFileName` parameter can be either a partially qualified filename relative to the current directory or fully qualified. A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name. `OpenFile` translates the directory name separators to the appropriate characters before using it.  \n  \n Override the `dwContext` default to set the context identifier to a value of your choosing. The context identifier is associated with this specific operation of the `CFtpConnection` object created by its [CInternetSession](../../mfc/reference/cinternetsession-class.md) object. The value is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the operation with which it is identified. See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier.  \n  \n##  <a name=\"cftpconnection__putfile\"></a>  CFtpConnection::PutFile  \n Call this member function to store a file on an FTP server.  \n  \n```  \nBOOL PutFile(\n    LPCTSTR pstrLocalFile,  \n    LPCTSTR pstrRemoteFile,  \n    DWORD dwFlags = FTP_TRANSFER_TYPE_BINARY,  \n    DWORD_PTR dwContext = 1);\n```  \n  \n### Parameters  \n `pstrLocalFile`  \n A pointer to a string containing the name of the file to send from the local system.  \n  \n `pstrRemoteFile`  \n A pointer to a string containing the name of the file to create on the FTP server.  \n  \n `dwFlags`  \n Specifies the conditions under which the transfer of the file occurs. Can be any of the FTP_TRANSFER_* constants described in [OpenFile](#cftpconnection__openfile).  \n  \n `dwContext`  \n The context identifier for placing the file. See **Remarks** for more information about `dwContext`.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n### Remarks  \n `PutFile` is a high-level routine that handles all of the operations associated with storing a file on an FTP server. Applications that only send data, or that require closer control over the file transfer, should use [OpenFile](#cftpconnection__openfile) and [CInternetFile::Write](../../mfc/reference/cinternetfile-class.md#cinternetfile__write).  \n  \n Override the `dwContext` default to set the context identifier to a value of your choosing. The context identifier is associated with this specific operation of the `CFtpConnection` object created by its [CInternetSession](../../mfc/reference/cinternetsession-class.md) object. The value is returned to [CInternetSession::OnStatusCallback](../../mfc/reference/cinternetsession-class.md#cinternetsession__onstatuscallback) to provide status on the operation with which it is identified. See the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md) for more information about the context identifier.  \n  \n##  <a name=\"cftpconnection__remove\"></a>  CFtpConnection::Remove  \n Call this member function to delete the specified file from the connected server.  \n  \n```  \nBOOL Remove(LPCTSTR pstrFileName);\n```  \n  \n### Parameters  \n `pstrFileName`  \n A pointer to a string containing the file name to remove.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n### Remarks  \n The `pstrFileName` parameter can be either a partially qualified filename relative to the current directory or fully qualified. A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name. The **Remove** function translates the directory name separators to the appropriate characters before they are used.  \n  \n##  <a name=\"cftpconnection__removedirectory\"></a>  CFtpConnection::RemoveDirectory  \n Call this member function to remove the specified directory from the connected server.  \n  \n```  \nBOOL RemoveDirectory(LPCTSTR pstrDirName);\n```  \n  \n### Parameters  \n `pstrDirName`  \n A pointer to a string containing the directory to be removed.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n### Remarks  \n Use [GetCurrentDirectory](#cftpconnection__getcurrentdirectory) to determine the server's current working directory. Do not assume that the remote system has connected you to the root directory.  \n  \n The `pstrDirName` parameter can be either a partially or fully qualified filename relative to the current directory. A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name. `RemoveDirectory` translates the directory name separators to the appropriate characters before they are used.  \n  \n##  <a name=\"cftpconnection__rename\"></a>  CFtpConnection::Rename  \n Call this member function to rename the specified file on the connected server.  \n  \n```  \nBOOL Rename(\n    LPCTSTR pstrExisting,  \n    LPCTSTR pstrNew);\n```  \n  \n### Parameters  \n `pstrExisting`  \n A pointer to a string containing the current name of the file to be renamed.  \n  \n `pstrNew`  \n A pointer to a string containing the file's new name.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n### Remarks  \n The `pstrExisting` and `pstrNew` parameters can be either a partially qualified filename relative to the current directory or fully qualified. A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name. **Rename** translates the directory name separators to the appropriate characters before they are used.  \n  \n##  <a name=\"cftpconnection__setcurrentdirectory\"></a>  CFtpConnection::SetCurrentDirectory  \n Call this member function to change to a different directory on the FTP server.  \n  \n```  \nBOOL SetCurrentDirectory(LPCTSTR pstrDirName);\n```  \n  \n### Parameters  \n `pstrDirName`  \n A pointer to a string containing the name of the directory.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n### Remarks  \n The `pstrDirName` parameter can be either a partially or fully qualified filename relative to the current directory. A backslash (\\\\) or forward slash (/) can be used as the directory separator for either name. `SetCurrentDirectory` translates the directory name separators to the appropriate characters before they are used.  \n  \n Use [GetCurrentDirectory](#cftpconnection__getcurrentdirectory) to determine an FTP server's current working directory. Do not assume that the remote system has connected you to the root directory.  \n  \n## See Also  \n [CInternetConnection Class](../../mfc/reference/cinternetconnection-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CInternetConnection Class](../../mfc/reference/cinternetconnection-class.md)   \n [CInternetSession Class](../../mfc/reference/cinternetsession-class.md)\n"}