{"nodes":[{"pos":[12,49],"content":"CPictureHolder Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CPictureHolder Class | Microsoft Docs","pos":[0,37]}]},{"pos":[705,725],"content":"CPictureHolder Class","linkify":"CPictureHolder Class","nodes":[{"content":"CPictureHolder Class","pos":[0,20]}]},{"content":"Implements a Picture property, which allows the user to display a picture in your control.","pos":[726,816]},{"pos":[825,831],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[878,885],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[895,914],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[921,925]},{"content":"Description","pos":[926,937]},{"pos":[975,1040],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::CPictureHolder<ept id=\"p1\">](#cpictureholder__cpictureholder)</ept>","source":"[CPictureHolder::CPictureHolder](#cpictureholder__cpictureholder)"},{"pos":[1041,1078],"content":"Constructs a <ph id=\"ph1\">`CPictureHolder`</ph> object.","source":"Constructs a `CPictureHolder` object."},{"pos":[1089,1103],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1110,1114]},{"content":"Description","pos":[1115,1126]},{"pos":[1164,1223],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::CreateEmpty<ept id=\"p1\">](#cpictureholder__createempty)</ept>","source":"[CPictureHolder::CreateEmpty](#cpictureholder__createempty)"},{"pos":[1224,1265],"content":"Creates an empty <ph id=\"ph1\">`CPictureHolder`</ph> object.","source":"Creates an empty `CPictureHolder` object."},{"pos":[1270,1339],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::CreateFromBitmap<ept id=\"p1\">](#cpictureholder__createfrombitmap)</ept>","source":"[CPictureHolder::CreateFromBitmap](#cpictureholder__createfrombitmap)"},{"pos":[1340,1388],"content":"Creates a <ph id=\"ph1\">`CPictureHolder`</ph> object from a bitmap.","source":"Creates a `CPictureHolder` object from a bitmap."},{"pos":[1393,1458],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::CreateFromIcon<ept id=\"p1\">](#cpictureholder__createfromicon)</ept>","source":"[CPictureHolder::CreateFromIcon](#cpictureholder__createfromicon)"},{"pos":[1459,1506],"content":"Creates a <ph id=\"ph1\">`CPictureHolder`</ph> object from an icon.","source":"Creates a `CPictureHolder` object from an icon."},{"pos":[1511,1584],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::CreateFromMetafile<ept id=\"p1\">](#cpictureholder__createfrommetafile)</ept>","source":"[CPictureHolder::CreateFromMetafile](#cpictureholder__createfrommetafile)"},{"pos":[1585,1635],"content":"Creates a <ph id=\"ph1\">`CPictureHolder`</ph> object from a metafile.","source":"Creates a `CPictureHolder` object from a metafile."},{"pos":[1640,1709],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::GetDisplayString<ept id=\"p1\">](#cpictureholder__getdisplaystring)</ept>","source":"[CPictureHolder::GetDisplayString](#cpictureholder__getdisplaystring)"},{"content":"Retrieves the string displayed in a control container's property browser.","pos":[1710,1783]},{"pos":[1788,1861],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::GetPictureDispatch<ept id=\"p1\">](#cpictureholder__getpicturedispatch)</ept>","source":"[CPictureHolder::GetPictureDispatch](#cpictureholder__getpicturedispatch)"},{"pos":[1862,1922],"content":"Returns the <ph id=\"ph1\">`CPictureHolder`</ph> object's <ph id=\"ph2\">`IDispatch`</ph> interface.","source":"Returns the `CPictureHolder` object's `IDispatch` interface."},{"pos":[1927,1978],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::GetType<ept id=\"p1\">](#cpictureholder__gettype)</ept>","source":"[CPictureHolder::GetType](#cpictureholder__gettype)"},{"pos":[1979,2057],"content":"Tells whether the <ph id=\"ph1\">`CPictureHolder`</ph> object is a bitmap, a metafile, or an icon.","source":"Tells whether the `CPictureHolder` object is a bitmap, a metafile, or an icon."},{"pos":[2062,2111],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::Render<ept id=\"p1\">](#cpictureholder__render)</ept>","source":"[CPictureHolder::Render](#cpictureholder__render)"},{"content":"Renders the picture.","pos":[2112,2132]},{"pos":[2137,2210],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::SetPictureDispatch<ept id=\"p1\">](#cpictureholder__setpicturedispatch)</ept>","source":"[CPictureHolder::SetPictureDispatch](#cpictureholder__setpicturedispatch)"},{"pos":[2211,2268],"content":"Sets the <ph id=\"ph1\">`CPictureHolder`</ph> object's <ph id=\"ph2\">`IDispatch`</ph> interface.","source":"Sets the `CPictureHolder` object's `IDispatch` interface."},{"pos":[2279,2298],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[2305,2309]},{"content":"Description","pos":[2310,2321]},{"pos":[2359,2410],"content":"<bpt id=\"p1\">[</bpt>CPictureHolder::m_pPict<ept id=\"p1\">](#cpictureholder__m_ppict)</ept>","source":"[CPictureHolder::m_pPict](#cpictureholder__m_ppict)"},{"content":"A pointer to a picture object.","pos":[2411,2441]},{"pos":[2451,2458],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2462,2506],"content":"<ph id=\"ph1\">`CPictureHolder`</ph> does not have a base class.","source":"`CPictureHolder` does not have a base class."},{"content":"With the stock Picture property, the developer can specify a bitmap, icon, or metafile for display.","pos":[2513,2612]},{"pos":[2619,2823],"content":"For information on creating custom picture properties, see the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Using Pictures in an ActiveX Control<ept id=\"p1\">](../../mfc/mfc-activex-controls-using-pictures-in-an-activex-control.md)</ept>.","source":"For information on creating custom picture properties, see the article [MFC ActiveX Controls: Using Pictures in an ActiveX Control](../../mfc/mfc-activex-controls-using-pictures-in-an-activex-control.md)."},{"pos":[2832,2853],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2882,2894],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2898,2918],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxctl.h","source":"**Header:** afxctl.h"},{"pos":[2928,3005],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__cpictureholder\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::CPictureHolder","linkify":"<a name=\"cpictureholder__cpictureholder\"></a>  CPictureHolder::CPictureHolder","source":"<a name=\"cpictureholder__cpictureholder\"></a>  CPictureHolder::CPictureHolder"},{"pos":[3009,3046],"content":"Constructs a <ph id=\"ph1\">`CPictureHolder`</ph> object.","source":"Constructs a `CPictureHolder` object."},{"pos":[3089,3160],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__createempty\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::CreateEmpty","linkify":"<a name=\"cpictureholder__createempty\"></a>  CPictureHolder::CreateEmpty","source":"<a name=\"cpictureholder__createempty\"></a>  CPictureHolder::CreateEmpty"},{"pos":[3164,3248],"content":"Creates an empty <ph id=\"ph1\">`CPictureHolder`</ph> object and connects it to an <ph id=\"ph2\">`IPicture`</ph> interface.","source":"Creates an empty `CPictureHolder` object and connects it to an `IPicture` interface."},{"pos":[3293,3305],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the object is successfully created; otherwise 0.","pos":[3309,3368]},{"pos":[3378,3459],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__createfrombitmap\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::CreateFromBitmap","linkify":"<a name=\"cpictureholder__createfrombitmap\"></a>  CPictureHolder::CreateFromBitmap","source":"<a name=\"cpictureholder__createfrombitmap\"></a>  CPictureHolder::CreateFromBitmap"},{"pos":[3463,3532],"content":"Uses a bitmap to initialize the picture object in a <ph id=\"ph1\">`CPictureHolder`</ph>.","source":"Uses a bitmap to initialize the picture object in a `CPictureHolder`."},{"pos":[3829,3839],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Resource ID of a bitmap resource.","pos":[3859,3892]},{"content":"Pointer to a <bpt id=\"p1\">[</bpt>CBitmap<ept id=\"p1\">](../../mfc/reference/cbitmap-class.md)</ept> object.","pos":[3912,3980],"source":" Pointer to a [CBitmap](../../mfc/reference/cbitmap-class.md) object."},{"content":"<bpt id=\"p1\">*</bpt>pPal<ept id=\"p1\">*</ept>","pos":[3987,3993],"source":"*pPal*"},{"content":"Pointer to a <bpt id=\"p1\">[</bpt>CPalette<ept id=\"p1\">](../../mfc/reference/cpalette-class.md)</ept> object.","pos":[3997,4067],"source":" Pointer to a [CPalette](../../mfc/reference/cpalette-class.md) object."},{"content":"Indicates whether the picture object will take ownership of the bitmap and palette objects.","pos":[4098,4189]},{"content":"Handle to the bitmap from which the <ph id=\"ph1\">`CPictureHolder`</ph> object is created.","pos":[4205,4276],"source":" Handle to the bitmap from which the `CPictureHolder` object is created."},{"content":"Handle to the palette used for rendering the bitmap.","pos":[4293,4345]},{"pos":[4355,4367],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the object is successfully created; otherwise 0.","pos":[4371,4430]},{"pos":[4440,4447],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If <ph id=\"ph1\">`bTransferOwnership`</ph> is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the caller should not use the bitmap or palette object in any way after this call returns.","pos":[4451,4578],"source":"If `bTransferOwnership` is **TRUE**, the caller should not use the bitmap or palette object in any way after this call returns."},{"content":"If <ph id=\"ph1\">`bTransferOwnership`</ph> is <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, the caller is responsible for ensuring that the bitmap and palette objects remain valid for the lifetime of the picture object.","pos":[4579,4744],"source":" If `bTransferOwnership` is **FALSE**, the caller is responsible for ensuring that the bitmap and palette objects remain valid for the lifetime of the picture object."},{"pos":[4754,4831],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__createfromicon\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::CreateFromIcon","linkify":"<a name=\"cpictureholder__createfromicon\"></a>  CPictureHolder::CreateFromIcon","source":"<a name=\"cpictureholder__createfromicon\"></a>  CPictureHolder::CreateFromIcon"},{"pos":[4835,4903],"content":"Uses an icon to initialize the picture object in a <ph id=\"ph1\">`CPictureHolder`</ph>.","source":"Uses an icon to initialize the picture object in a `CPictureHolder`."},{"pos":[5052,5062],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Resource ID of a bitmap resource.","pos":[5082,5115]},{"content":"Handle to the icon from which the <ph id=\"ph1\">`CPictureHolder`</ph> object is created.","pos":[5133,5202],"source":" Handle to the icon from which the `CPictureHolder` object is created."},{"content":"Indicates whether the picture object will take ownership of the icon object.","pos":[5233,5309]},{"pos":[5319,5331],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the object is successfully created; otherwise 0.","pos":[5335,5394]},{"pos":[5404,5411],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If <ph id=\"ph1\">`bTransferOwnership`</ph> is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the caller should not use the icon object in any way after this call returns.","pos":[5415,5529],"source":"If `bTransferOwnership` is **TRUE**, the caller should not use the icon object in any way after this call returns."},{"content":"If <ph id=\"ph1\">`bTransferOwnership`</ph> is <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, the caller is responsible for ensuring that the icon object remains valid for the lifetime of the picture object.","pos":[5530,5681],"source":" If `bTransferOwnership` is **FALSE**, the caller is responsible for ensuring that the icon object remains valid for the lifetime of the picture object."},{"pos":[5691,5776],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__createfrommetafile\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::CreateFromMetafile","linkify":"<a name=\"cpictureholder__createfrommetafile\"></a>  CPictureHolder::CreateFromMetafile","source":"<a name=\"cpictureholder__createfrommetafile\"></a>  CPictureHolder::CreateFromMetafile"},{"pos":[5780,5851],"content":"Uses a metafile to initialize the picture object in a <ph id=\"ph1\">`CPictureHolder`</ph>.","source":"Uses a metafile to initialize the picture object in a `CPictureHolder`."},{"pos":[5992,6002],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Handle to the metafile used to create the <ph id=\"ph1\">`CPictureHolder`</ph> object.","pos":[6015,6081],"source":" Handle to the metafile used to create the `CPictureHolder` object."},{"content":"<bpt id=\"p1\">*</bpt>xExt<ept id=\"p1\">*</ept>","pos":[6088,6094],"source":"*xExt*"},{"content":"X extent of the picture.","pos":[6098,6122]},{"content":"<bpt id=\"p1\">*</bpt>yExt<ept id=\"p1\">*</ept>","pos":[6129,6135],"source":"*yExt*"},{"content":"Y extent of the picture.","pos":[6139,6163]},{"content":"Indicates whether the picture object will take ownership of the metafile object.","pos":[6194,6274]},{"pos":[6284,6296],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the object is successfully created; otherwise 0.","pos":[6300,6359]},{"pos":[6369,6376],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If <ph id=\"ph1\">`bTransferOwnership`</ph> is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the caller should not use the metafile object in any way after this call returns.","pos":[6380,6498],"source":"If `bTransferOwnership` is **TRUE**, the caller should not use the metafile object in any way after this call returns."},{"content":"If <ph id=\"ph1\">`bTransferOwnership`</ph> is <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, the caller is responsible for ensuring that the metafile object remains valid for the lifetime of the picture object.","pos":[6499,6654],"source":" If `bTransferOwnership` is **FALSE**, the caller is responsible for ensuring that the metafile object remains valid for the lifetime of the picture object."},{"pos":[6664,6745],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__getdisplaystring\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::GetDisplayString","linkify":"<a name=\"cpictureholder__getdisplaystring\"></a>  CPictureHolder::GetDisplayString","source":"<a name=\"cpictureholder__getdisplaystring\"></a>  CPictureHolder::GetDisplayString"},{"content":"Retrieves the string that is displayed in a container's property browser.","pos":[6749,6822]},{"pos":[6889,6899],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Reference to the <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> that is to hold the display string.","pos":[6917,7029],"source":" Reference to the [CString](../../atl-mfc-shared/reference/cstringt-class.md) that is to hold the display string."},{"pos":[7039,7051],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the string is successfully retrieved; otherwise 0.","pos":[7055,7116]},{"pos":[7126,7211],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__getpicturedispatch\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::GetPictureDispatch","linkify":"<a name=\"cpictureholder__getpicturedispatch\"></a>  CPictureHolder::GetPictureDispatch","source":"<a name=\"cpictureholder__getpicturedispatch\"></a>  CPictureHolder::GetPictureDispatch"},{"pos":[7215,7305],"content":"This function returns a pointer to the <ph id=\"ph1\">`CPictureHolder`</ph> object's <ph id=\"ph2\">`IPictureDisp`</ph> interface.","source":"This function returns a pointer to the `CPictureHolder` object's `IPictureDisp` interface."},{"pos":[7366,7378],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[7382,7450],"content":"A pointer to the <ph id=\"ph1\">`CPictureHolder`</ph> object's <ph id=\"ph2\">`IPictureDisp`</ph> interface.","source":"A pointer to the `CPictureHolder` object's `IPictureDisp` interface."},{"pos":[7460,7467],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7471,7542],"content":"The caller must call <bpt id=\"p1\">**</bpt>Release<ept id=\"p1\">**</ept> on this pointer when finished with it.","source":"The caller must call **Release** on this pointer when finished with it."},{"pos":[7552,7615],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__gettype\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::GetType","linkify":"<a name=\"cpictureholder__gettype\"></a>  CPictureHolder::GetType","source":"<a name=\"cpictureholder__gettype\"></a>  CPictureHolder::GetType"},{"content":"Indicates whether the picture is a bitmap, metafile, or icon.","pos":[7619,7680]},{"pos":[7722,7734],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A value indicating the type of the picture.","pos":[7738,7781]},{"content":"Possible values and their meanings are as follows:","pos":[7782,7832]},{"content":"Value","pos":[7839,7844]},{"content":"Meaning","pos":[7845,7852]},{"pos":[7887,7912],"content":"<bpt id=\"p1\">**</bpt>PICTYPE_UNINITIALIZED<ept id=\"p1\">**</ept>","source":"**PICTYPE_UNINITIALIZED**"},{"pos":[7913,7954],"content":"<ph id=\"ph1\">`CPictureHolder`</ph> object is unititialized.","source":"`CPictureHolder` object is unititialized."},{"pos":[7959,7975],"content":"<bpt id=\"p1\">**</bpt>PICTYPE_NONE<ept id=\"p1\">**</ept>","source":"**PICTYPE_NONE**"},{"pos":[7976,8009],"content":"<ph id=\"ph1\">`CPictureHolder`</ph> object is empty.","source":"`CPictureHolder` object is empty."},{"pos":[8014,8032],"content":"<bpt id=\"p1\">**</bpt>PICTYPE_BITMAP<ept id=\"p1\">**</ept>","source":"**PICTYPE_BITMAP**"},{"content":"Picture is a bitmap.","pos":[8033,8053]},{"pos":[8058,8078],"content":"<bpt id=\"p1\">**</bpt>PICTYPE_METAFILE<ept id=\"p1\">**</ept>","source":"**PICTYPE_METAFILE**"},{"content":"Picture is a metafile.","pos":[8079,8101]},{"pos":[8106,8122],"content":"<bpt id=\"p1\">**</bpt>PICTYPE_ICON<ept id=\"p1\">**</ept>","source":"**PICTYPE_ICON**"},{"content":"Picture is an icon.","pos":[8123,8142]},{"pos":[8153,8216],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__m_ppict\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::m_pPict","linkify":"<a name=\"cpictureholder__m_ppict\"></a>  CPictureHolder::m_pPict","source":"<a name=\"cpictureholder__m_ppict\"></a>  CPictureHolder::m_pPict"},{"pos":[8220,8284],"content":"A pointer to the <ph id=\"ph1\">`CPictureHolder`</ph> object's <ph id=\"ph2\">`IPicture`</ph> interface.","source":"A pointer to the `CPictureHolder` object's `IPicture` interface."},{"pos":[8330,8391],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__render\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::Render","linkify":"<a name=\"cpictureholder__render\"></a>  CPictureHolder::Render","source":"<a name=\"cpictureholder__render\"></a>  CPictureHolder::Render"},{"pos":[8395,8457],"content":"Renders the picture in the rectangle referenced by <ph id=\"ph1\">`rcRender`</ph>.","source":"Renders the picture in the rectangle referenced by `rcRender`."},{"pos":[8569,8579],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the display context in which the picture is to be rendered.","pos":[8592,8662]},{"content":"Rectangle in which the picture is to be rendered.","pos":[8683,8732]},{"content":"<bpt id=\"p1\">*</bpt>rcWBounds<ept id=\"p1\">*</ept>","pos":[8739,8750],"source":"*rcWBounds*"},{"content":"A rectangle representing the bounding rectangle of the object rendering the picture.","pos":[8754,8838]},{"content":"For a control, this rectangle is the <ph id=\"ph1\">`rcBounds`</ph> parameter passed to an override of <bpt id=\"p1\">[</bpt>COleControl::OnDraw<ept id=\"p1\">](../../mfc/reference/colecontrol-class.md#colecontrol__ondraw)</ept>.","pos":[8839,9006],"source":" For a control, this rectangle is the `rcBounds` parameter passed to an override of [COleControl::OnDraw](../../mfc/reference/colecontrol-class.md#colecontrol__ondraw)."},{"pos":[9016,9101],"content":"<bpt id=\"p1\">&lt;a name=\"cpictureholder__setpicturedispatch\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CPictureHolder::SetPictureDispatch","linkify":"<a name=\"cpictureholder__setpicturedispatch\"></a>  CPictureHolder::SetPictureDispatch","source":"<a name=\"cpictureholder__setpicturedispatch\"></a>  CPictureHolder::SetPictureDispatch"},{"pos":[9105,9172],"content":"Connects the <ph id=\"ph1\">`CPictureHolder`</ph> object to a <ph id=\"ph2\">`IPictureDisp`</ph> interface.","source":"Connects the `CPictureHolder` object to a `IPictureDisp` interface."},{"pos":[9243,9253],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the new <ph id=\"ph1\">`IPictureDisp`</ph> interface.","pos":[9268,9312],"source":" Pointer to the new `IPictureDisp` interface."},{"pos":[9321,9329],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[9333,9381],"source":"[Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CFontHolder Class<ept id=\"p1\">](../../mfc/reference/cfontholder-class.md)</ept>","pos":[9384,9446],"source":" [CFontHolder Class](../../mfc/reference/cfontholder-class.md)"}],"content":"---\ntitle: \"CPictureHolder Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"Picture\"\n  - \"CPictureHolder\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Picture property\"\n  - \"controls [MFC], OLE\"\n  - \"OLE controls, image\"\n  - \"CPictureHolder class\"\nms.assetid: a4f59775-704a-41dd-b5bd-2e531c95127a\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CPictureHolder Class\nImplements a Picture property, which allows the user to display a picture in your control.  \n  \n## Syntax  \n  \n```  \nclass CPictureHolder  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPictureHolder::CPictureHolder](#cpictureholder__cpictureholder)|Constructs a `CPictureHolder` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPictureHolder::CreateEmpty](#cpictureholder__createempty)|Creates an empty `CPictureHolder` object.|  \n|[CPictureHolder::CreateFromBitmap](#cpictureholder__createfrombitmap)|Creates a `CPictureHolder` object from a bitmap.|  \n|[CPictureHolder::CreateFromIcon](#cpictureholder__createfromicon)|Creates a `CPictureHolder` object from an icon.|  \n|[CPictureHolder::CreateFromMetafile](#cpictureholder__createfrommetafile)|Creates a `CPictureHolder` object from a metafile.|  \n|[CPictureHolder::GetDisplayString](#cpictureholder__getdisplaystring)|Retrieves the string displayed in a control container's property browser.|  \n|[CPictureHolder::GetPictureDispatch](#cpictureholder__getpicturedispatch)|Returns the `CPictureHolder` object's `IDispatch` interface.|  \n|[CPictureHolder::GetType](#cpictureholder__gettype)|Tells whether the `CPictureHolder` object is a bitmap, a metafile, or an icon.|  \n|[CPictureHolder::Render](#cpictureholder__render)|Renders the picture.|  \n|[CPictureHolder::SetPictureDispatch](#cpictureholder__setpicturedispatch)|Sets the `CPictureHolder` object's `IDispatch` interface.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPictureHolder::m_pPict](#cpictureholder__m_ppict)|A pointer to a picture object.|  \n  \n## Remarks  \n `CPictureHolder` does not have a base class.  \n  \n With the stock Picture property, the developer can specify a bitmap, icon, or metafile for display.  \n  \n For information on creating custom picture properties, see the article [MFC ActiveX Controls: Using Pictures in an ActiveX Control](../../mfc/mfc-activex-controls-using-pictures-in-an-activex-control.md).  \n  \n## Inheritance Hierarchy  \n `CPictureHolder`  \n  \n## Requirements  \n **Header:** afxctl.h  \n  \n##  <a name=\"cpictureholder__cpictureholder\"></a>  CPictureHolder::CPictureHolder  \n Constructs a `CPictureHolder` object.  \n  \n```  \nCPictureHolder();\n```  \n  \n##  <a name=\"cpictureholder__createempty\"></a>  CPictureHolder::CreateEmpty  \n Creates an empty `CPictureHolder` object and connects it to an `IPicture` interface.  \n  \n```  \nBOOL CreateEmpty();\n```  \n  \n### Return Value  \n Nonzero if the object is successfully created; otherwise 0.  \n  \n##  <a name=\"cpictureholder__createfrombitmap\"></a>  CPictureHolder::CreateFromBitmap  \n Uses a bitmap to initialize the picture object in a `CPictureHolder`.  \n  \n```  \nBOOL CreateFromBitmap(\n    UINT idResource);\n\n \nBOOL CreateFromBitmap(\n    CBitmap* pBitmap,  \n    CPalette* pPal = NULL,  \n    BOOL bTransferOwnership = TRUE);\n\n \nBOOL CreateFromBitmap(\n    HBITMAP hbm,  \n    HPALETTE hpal = NULL,  \n    BOOL bTransferOwnership = FALSE);\n```  \n  \n### Parameters  \n `idResource`  \n Resource ID of a bitmap resource.  \n  \n `pBitmap`  \n Pointer to a [CBitmap](../../mfc/reference/cbitmap-class.md) object.  \n  \n *pPal*  \n Pointer to a [CPalette](../../mfc/reference/cpalette-class.md) object.  \n  \n `bTransferOwnership`  \n Indicates whether the picture object will take ownership of the bitmap and palette objects.  \n  \n `hbm`  \n Handle to the bitmap from which the `CPictureHolder` object is created.  \n  \n `hpal`  \n Handle to the palette used for rendering the bitmap.  \n  \n### Return Value  \n Nonzero if the object is successfully created; otherwise 0.  \n  \n### Remarks  \n If `bTransferOwnership` is **TRUE**, the caller should not use the bitmap or palette object in any way after this call returns. If `bTransferOwnership` is **FALSE**, the caller is responsible for ensuring that the bitmap and palette objects remain valid for the lifetime of the picture object.  \n  \n##  <a name=\"cpictureholder__createfromicon\"></a>  CPictureHolder::CreateFromIcon  \n Uses an icon to initialize the picture object in a `CPictureHolder`.  \n  \n```  \nBOOL CreateFromIcon(\n    UINT idResource);\n\n \nBOOL CreateFromIcon(\n    HICON hIcon,  \n    BOOL bTransferOwnership = FALSE);\n```  \n  \n### Parameters  \n `idResource`  \n Resource ID of a bitmap resource.  \n  \n `hIcon`  \n Handle to the icon from which the `CPictureHolder` object is created.  \n  \n `bTransferOwnership`  \n Indicates whether the picture object will take ownership of the icon object.  \n  \n### Return Value  \n Nonzero if the object is successfully created; otherwise 0.  \n  \n### Remarks  \n If `bTransferOwnership` is **TRUE**, the caller should not use the icon object in any way after this call returns. If `bTransferOwnership` is **FALSE**, the caller is responsible for ensuring that the icon object remains valid for the lifetime of the picture object.  \n  \n##  <a name=\"cpictureholder__createfrommetafile\"></a>  CPictureHolder::CreateFromMetafile  \n Uses a metafile to initialize the picture object in a `CPictureHolder`.  \n  \n```  \nBOOL CreateFromMetafile(\n    HMETAFILE hmf,  \n    int xExt,  \n    int yExt,  \n    BOOL bTransferOwnership = FALSE);\n```  \n  \n### Parameters  \n `hmf`  \n Handle to the metafile used to create the `CPictureHolder` object.  \n  \n *xExt*  \n X extent of the picture.  \n  \n *yExt*  \n Y extent of the picture.  \n  \n `bTransferOwnership`  \n Indicates whether the picture object will take ownership of the metafile object.  \n  \n### Return Value  \n Nonzero if the object is successfully created; otherwise 0.  \n  \n### Remarks  \n If `bTransferOwnership` is **TRUE**, the caller should not use the metafile object in any way after this call returns. If `bTransferOwnership` is **FALSE**, the caller is responsible for ensuring that the metafile object remains valid for the lifetime of the picture object.  \n  \n##  <a name=\"cpictureholder__getdisplaystring\"></a>  CPictureHolder::GetDisplayString  \n Retrieves the string that is displayed in a container's property browser.  \n  \n```  \nBOOL GetDisplayString(CString& strValue);\n```  \n  \n### Parameters  \n `strValue`  \n Reference to the [CString](../../atl-mfc-shared/reference/cstringt-class.md) that is to hold the display string.  \n  \n### Return Value  \n Nonzero if the string is successfully retrieved; otherwise 0.  \n  \n##  <a name=\"cpictureholder__getpicturedispatch\"></a>  CPictureHolder::GetPictureDispatch  \n This function returns a pointer to the `CPictureHolder` object's `IPictureDisp` interface.  \n  \n```  \nLPPICTUREDISP GetPictureDispatch();\n```  \n  \n### Return Value  \n A pointer to the `CPictureHolder` object's `IPictureDisp` interface.  \n  \n### Remarks  \n The caller must call **Release** on this pointer when finished with it.  \n  \n##  <a name=\"cpictureholder__gettype\"></a>  CPictureHolder::GetType  \n Indicates whether the picture is a bitmap, metafile, or icon.  \n  \n```  \nshort GetType();\n```  \n  \n### Return Value  \n A value indicating the type of the picture. Possible values and their meanings are as follows:  \n  \n|Value|Meaning|  \n|-----------|-------------|  \n|**PICTYPE_UNINITIALIZED**|`CPictureHolder` object is unititialized.|  \n|**PICTYPE_NONE**|`CPictureHolder` object is empty.|  \n|**PICTYPE_BITMAP**|Picture is a bitmap.|  \n|**PICTYPE_METAFILE**|Picture is a metafile.|  \n|**PICTYPE_ICON**|Picture is an icon.|  \n  \n##  <a name=\"cpictureholder__m_ppict\"></a>  CPictureHolder::m_pPict  \n A pointer to the `CPictureHolder` object's `IPicture` interface.  \n  \n```  \nLPPICTURE m_pPict;  \n```  \n  \n##  <a name=\"cpictureholder__render\"></a>  CPictureHolder::Render  \n Renders the picture in the rectangle referenced by `rcRender`.  \n  \n```  \nvoid Render(\n    CDC* pDC,  \n    const CRect& rcRender,  \n    const CRect& rcWBounds);\n```  \n  \n### Parameters  \n `pDC`  \n Pointer to the display context in which the picture is to be rendered.  \n  \n `rcRender`  \n Rectangle in which the picture is to be rendered.  \n  \n *rcWBounds*  \n A rectangle representing the bounding rectangle of the object rendering the picture. For a control, this rectangle is the `rcBounds` parameter passed to an override of [COleControl::OnDraw](../../mfc/reference/colecontrol-class.md#colecontrol__ondraw).  \n  \n##  <a name=\"cpictureholder__setpicturedispatch\"></a>  CPictureHolder::SetPictureDispatch  \n Connects the `CPictureHolder` object to a `IPictureDisp` interface.  \n  \n```  \nvoid SetPictureDispatch(LPPICTUREDISP pDisp);\n```  \n  \n### Parameters  \n `pDisp`  \n Pointer to the new `IPictureDisp` interface.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CFontHolder Class](../../mfc/reference/cfontholder-class.md)\n"}