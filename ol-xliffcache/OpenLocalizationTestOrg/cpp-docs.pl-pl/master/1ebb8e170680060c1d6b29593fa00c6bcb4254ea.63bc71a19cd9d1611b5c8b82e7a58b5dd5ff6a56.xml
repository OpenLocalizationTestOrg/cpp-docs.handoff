{"nodes":[{"pos":[12,80],"content":"-TSAWARE (Create Terminal Server Aware Application) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"-TSAWARE (Create Terminal Server Aware Application) | Microsoft Docs","pos":[0,68]}]},{"content":"/TSAWARE (Create Terminal Server Aware Application)","pos":[827,878]},{"content":"Remarks","pos":[913,920]},{"content":"The /TSAWARE option sets a flag in the IMAGE_OPTIONAL_HEADER DllCharacteristics field in the program image's optional header.","pos":[924,1049]},{"content":"When this flag is set, Terminal Server will not make certain changes to the application.","pos":[1050,1138]},{"content":"When an application is not Terminal Server aware (also known as a legacy application), Terminal Server makes certain modifications to the legacy application to make it work properly in a multiuser environment.","pos":[1145,1354]},{"content":"For example, Terminal Server will create a virtual Windows folder, such that each user gets a Windows folder instead of getting the system's Windows directory.","pos":[1355,1514]},{"content":"This gives users access to their own INI files.","pos":[1515,1562]},{"content":"In addition, Terminal Server makes some adjustments to the registry for a legacy application.","pos":[1563,1656]},{"content":"These modifications slow the loading of the legacy application on Terminal Server.","pos":[1657,1739]},{"pos":[1746,1885],"content":"If an application is Terminal Server aware, it must neither rely on INI files nor write to the <bpt id=\"p1\">**</bpt>HKEY_CURRENT_USER<ept id=\"p1\">**</ept> registry during setup.","source":"If an application is Terminal Server aware, it must neither rely on INI files nor write to the **HKEY_CURRENT_USER** registry during setup."},{"content":"If you use /TSAWARE and your application still uses INI files, the files will be shared by all users of the system.","pos":[1892,2007]},{"content":"If that is acceptable, you can still link your application with /TSAWARE; otherwise you need to use /TSAWARE:NO.","pos":[2008,2120]},{"content":"The /TSAWARE option is enabled by default for Windows 2000 and later, for Windows and console applications.","pos":[2127,2234]},{"content":"See <bpt id=\"p1\">[</bpt>/SUBSYSTEM<ept id=\"p1\">](../../build/reference/subsystem-specify-subsystem.md)</ept> and <bpt id=\"p2\">[</bpt>/VERSION<ept id=\"p2\">](../../build/reference/version-version-information.md)</ept> for information.","pos":[2235,2391],"source":" See [/SUBSYSTEM](../../build/reference/subsystem-specify-subsystem.md) and [/VERSION](../../build/reference/version-version-information.md) for information."},{"content":"/TSAWARE is not valid for drivers, VxDs, or DLLs.","pos":[2398,2447]},{"pos":[2454,2591],"content":"If an application was linked with /TSAWARE, DUMPBIN <bpt id=\"p1\">[</bpt>/HEADERS<ept id=\"p1\">](../../build/reference/headers.md)</ept> will display information to that effect.","source":"If an application was linked with /TSAWARE, DUMPBIN [/HEADERS](../../build/reference/headers.md) will display information to that effect."},{"content":"To set this linker option in the Visual Studio development environment","pos":[2601,2671]},{"content":"Open the project's <bpt id=\"p1\">**</bpt>Property Pages<ept id=\"p1\">**</ept> dialog box.","pos":[2681,2730],"source":"Open the project's **Property Pages** dialog box."},{"content":"For details, see <bpt id=\"p1\">[</bpt>Setting Visual C++ Project Properties<ept id=\"p1\">](../../ide/working-with-project-properties.md)</ept>.","pos":[2731,2834],"source":" For details, see [Setting Visual C++ Project Properties](../../ide/working-with-project-properties.md)."},{"pos":[2844,2872],"content":"Click the <bpt id=\"p1\">**</bpt>Linker<ept id=\"p1\">**</ept> folder.","source":"Click the **Linker** folder."},{"pos":[2882,2917],"content":"Click the <bpt id=\"p1\">**</bpt>System<ept id=\"p1\">**</ept> property page.","source":"Click the **System** property page."},{"pos":[2927,2967],"content":"Modify the <bpt id=\"p1\">**</bpt>Terminal Server<ept id=\"p1\">**</ept> property.","source":"Modify the **Terminal Server** property."},{"content":"To set this linker option programmatically","pos":[2977,3019]},{"content":"See &lt;xref:Microsoft.VisualStudio.VCProjectEngine.VCLinkerTool.TerminalServerAware%2A&gt;.","pos":[3029,3115],"source":"See <xref:Microsoft.VisualStudio.VCProjectEngine.VCLinkerTool.TerminalServerAware%2A>."},{"content":"See Also","pos":[3124,3132]},{"content":"Setting Linker Options","pos":[3137,3159]},{"content":"Linker Options","pos":[3215,3229]},{"content":"Storing User-Specific Information","pos":[3277,3310]},{"content":"Legacy Applications in a Terminal Services Environment","pos":[3361,3415]}],"content":"---\ntitle: \"-TSAWARE (Create Terminal Server Aware Application) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"/tsaware\"\n  - \"VC.Project.VCLinkerTool.TerminalServerAware\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Terminal Server\"\n  - \"/TSAWARE linker option\"\n  - \"Terminal Server, Terminal Server-aware applications\"\n  - \"-TSAWARE linker option\"\n  - \"TSAWARE linker option\"\nms.assetid: fe1c1846-de5b-4839-b562-93fbfe36cd29\ncaps.latest.revision: 8\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# /TSAWARE (Create Terminal Server Aware Application)\n```  \n/TSAWARE[:NO]  \n```  \n  \n## Remarks  \n The /TSAWARE option sets a flag in the IMAGE_OPTIONAL_HEADER DllCharacteristics field in the program image's optional header. When this flag is set, Terminal Server will not make certain changes to the application.  \n  \n When an application is not Terminal Server aware (also known as a legacy application), Terminal Server makes certain modifications to the legacy application to make it work properly in a multiuser environment. For example, Terminal Server will create a virtual Windows folder, such that each user gets a Windows folder instead of getting the system's Windows directory. This gives users access to their own INI files. In addition, Terminal Server makes some adjustments to the registry for a legacy application. These modifications slow the loading of the legacy application on Terminal Server.  \n  \n If an application is Terminal Server aware, it must neither rely on INI files nor write to the **HKEY_CURRENT_USER** registry during setup.  \n  \n If you use /TSAWARE and your application still uses INI files, the files will be shared by all users of the system. If that is acceptable, you can still link your application with /TSAWARE; otherwise you need to use /TSAWARE:NO.  \n  \n The /TSAWARE option is enabled by default for Windows 2000 and later, for Windows and console applications. See [/SUBSYSTEM](../../build/reference/subsystem-specify-subsystem.md) and [/VERSION](../../build/reference/version-version-information.md) for information.  \n  \n /TSAWARE is not valid for drivers, VxDs, or DLLs.  \n  \n If an application was linked with /TSAWARE, DUMPBIN [/HEADERS](../../build/reference/headers.md) will display information to that effect.  \n  \n### To set this linker option in the Visual Studio development environment  \n  \n1.  Open the project's **Property Pages** dialog box. For details, see [Setting Visual C++ Project Properties](../../ide/working-with-project-properties.md).  \n  \n2.  Click the **Linker** folder.  \n  \n3.  Click the **System** property page.  \n  \n4.  Modify the **Terminal Server** property.  \n  \n### To set this linker option programmatically  \n  \n-   See <xref:Microsoft.VisualStudio.VCProjectEngine.VCLinkerTool.TerminalServerAware%2A>.  \n  \n## See Also  \n [Setting Linker Options](../../build/reference/setting-linker-options.md)   \n [Linker Options](../../build/reference/linker-options.md)   \n [Storing User-Specific Information](http://msdn.microsoft.com/library/aa383452)   \n [Legacy Applications in a Terminal Services Environment](https://msdn.microsoft.com/en-us/library/aa382957.aspx)"}