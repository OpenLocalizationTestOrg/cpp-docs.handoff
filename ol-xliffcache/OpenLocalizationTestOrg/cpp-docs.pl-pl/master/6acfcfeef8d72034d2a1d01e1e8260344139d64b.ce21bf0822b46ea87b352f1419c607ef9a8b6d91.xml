{"nodes":[{"pos":[12,47],"content":"CDaoQueryDef Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDaoQueryDef Class | Microsoft Docs","pos":[0,35]}]},{"pos":[673,691],"content":"CDaoQueryDef Class","linkify":"CDaoQueryDef Class","nodes":[{"content":"CDaoQueryDef Class","pos":[0,18]}]},{"content":"Represents a query definition, or \"querydef,\" usually one saved in a database.","pos":[692,770]},{"pos":[779,785],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[847,854],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[864,883],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[890,894]},{"content":"Description","pos":[895,906]},{"pos":[944,1001],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::CDaoQueryDef<ept id=\"p1\">](#cdaoquerydef__cdaoquerydef)</ept>","source":"[CDaoQueryDef::CDaoQueryDef](#cdaoquerydef__cdaoquerydef)"},{"content":"Constructs a <bpt id=\"p1\">**</bpt>CDaoQueryDef<ept id=\"p1\">**</ept> object.","pos":[1002,1039],"source":"Constructs a **CDaoQueryDef** object."},{"content":"Next call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept>, depending on your needs.","pos":[1040,1098],"source":" Next call **Open** or **Create**, depending on your needs."},{"pos":[1109,1123],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1130,1134]},{"content":"Description","pos":[1135,1146]},{"pos":[1184,1229],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::Append<ept id=\"p1\">](#cdaoquerydef__append)</ept>","source":"[CDaoQueryDef::Append](#cdaoquerydef__append)"},{"content":"Appends the querydef to the database's QueryDefs collection as a saved query.","pos":[1230,1307]},{"pos":[1312,1363],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::CanUpdate<ept id=\"p1\">](#cdaoquerydef__canupdate)</ept>","source":"[CDaoQueryDef::CanUpdate](#cdaoquerydef__canupdate)"},{"content":"Returns nonzero if the query can update the database.","pos":[1364,1417]},{"pos":[1422,1465],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::Close<ept id=\"p1\">](#cdaoquerydef__close)</ept>","source":"[CDaoQueryDef::Close](#cdaoquerydef__close)"},{"content":"Closes the querydef object.","pos":[1466,1493]},{"content":"Destroy the C++ object when you finish with it.","pos":[1494,1541]},{"pos":[1546,1591],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::Create<ept id=\"p1\">](#cdaoquerydef__create)</ept>","source":"[CDaoQueryDef::Create](#cdaoquerydef__create)"},{"content":"Creates the underlying DAO querydef object.","pos":[1592,1635]},{"content":"Use the querydef as a temporary query, or call <bpt id=\"p1\">**</bpt>Append<ept id=\"p1\">**</ept> to save it in the database.","pos":[1636,1721],"source":" Use the querydef as a temporary query, or call **Append** to save it in the database."},{"pos":[1726,1773],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::Execute<ept id=\"p1\">](#cdaoquerydef__execute)</ept>","source":"[CDaoQueryDef::Execute](#cdaoquerydef__execute)"},{"content":"Executes the query defined by the querydef object.","pos":[1774,1824]},{"pos":[1829,1882],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetConnect<ept id=\"p1\">](#cdaoquerydef__getconnect)</ept>","source":"[CDaoQueryDef::GetConnect](#cdaoquerydef__getconnect)"},{"content":"Returns the connection string associated with the querydef.","pos":[1883,1942]},{"content":"The connection string identifies the data source.","pos":[1943,1992]},{"content":"(For SQL pass-through queries only; otherwise an empty string.)","pos":[1993,2056]},{"pos":[2061,2122],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetDateCreated<ept id=\"p1\">](#cdaoquerydef__getdatecreated)</ept>","source":"[CDaoQueryDef::GetDateCreated](#cdaoquerydef__getdatecreated)"},{"content":"Returns the date the saved query was created.","pos":[2123,2168]},{"pos":[2173,2242],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetDateLastUpdated<ept id=\"p1\">](#cdaoquerydef__getdatelastupdated)</ept>","source":"[CDaoQueryDef::GetDateLastUpdated](#cdaoquerydef__getdatelastupdated)"},{"content":"Returns the date the saved query was last updated.","pos":[2243,2293]},{"pos":[2298,2357],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetFieldCount<ept id=\"p1\">](#cdaoquerydef__getfieldcount)</ept>","source":"[CDaoQueryDef::GetFieldCount](#cdaoquerydef__getfieldcount)"},{"content":"Returns the number of fields defined by the querydef.","pos":[2358,2411]},{"pos":[2416,2473],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetFieldInfo<ept id=\"p1\">](#cdaoquerydef__getfieldinfo)</ept>","source":"[CDaoQueryDef::GetFieldInfo](#cdaoquerydef__getfieldinfo)"},{"content":"Returns information about a specified field defined in the query.","pos":[2474,2539]},{"pos":[2544,2591],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetName<ept id=\"p1\">](#cdaoquerydef__getname)</ept>","source":"[CDaoQueryDef::GetName](#cdaoquerydef__getname)"},{"content":"Returns the name of the querydef.","pos":[2592,2625]},{"pos":[2630,2691],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetODBCTimeout<ept id=\"p1\">](#cdaoquerydef__getodbctimeout)</ept>","source":"[CDaoQueryDef::GetODBCTimeout](#cdaoquerydef__getodbctimeout)"},{"content":"Returns the timeout value used by ODBC (for an ODBC query) when the querydef is executed.","pos":[2692,2781]},{"content":"This determines how long to allow for the query's action to complete.","pos":[2782,2851]},{"pos":[2856,2923],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetParameterCount<ept id=\"p1\">](#cdaoquerydef__getparametercount)</ept>","source":"[CDaoQueryDef::GetParameterCount](#cdaoquerydef__getparametercount)"},{"content":"Returns the number of parameters defined for the query.","pos":[2924,2979]},{"pos":[2984,3049],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetParameterInfo<ept id=\"p1\">](#cdaoquerydef__getparameterinfo)</ept>","source":"[CDaoQueryDef::GetParameterInfo](#cdaoquerydef__getparameterinfo)"},{"content":"Returns information about a specified parameter to the query.","pos":[3050,3111]},{"pos":[3116,3175],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetParamValue<ept id=\"p1\">](#cdaoquerydef__getparamvalue)</ept>","source":"[CDaoQueryDef::GetParamValue](#cdaoquerydef__getparamvalue)"},{"content":"Returns the value of a specified parameter to the query.","pos":[3176,3232]},{"pos":[3237,3306],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetRecordsAffected<ept id=\"p1\">](#cdaoquerydef__getrecordsaffected)</ept>","source":"[CDaoQueryDef::GetRecordsAffected](#cdaoquerydef__getrecordsaffected)"},{"content":"Returns the number of records affected by an action query.","pos":[3307,3365]},{"pos":[3370,3437],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetReturnsRecords<ept id=\"p1\">](#cdaoquerydef__getreturnsrecords)</ept>","source":"[CDaoQueryDef::GetReturnsRecords](#cdaoquerydef__getreturnsrecords)"},{"content":"Returns nonzero if the query defined by the querydef returns records.","pos":[3438,3507]},{"pos":[3512,3557],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetSQL<ept id=\"p1\">](#cdaoquerydef__getsql)</ept>","source":"[CDaoQueryDef::GetSQL](#cdaoquerydef__getsql)"},{"content":"Returns the SQL string that specifies the query defined by the querydef.","pos":[3558,3630]},{"pos":[3635,3682],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::GetType<ept id=\"p1\">](#cdaoquerydef__gettype)</ept>","source":"[CDaoQueryDef::GetType](#cdaoquerydef__gettype)"},{"content":"Returns the query type: delete, update, append, make-table, and so on.","pos":[3683,3753]},{"pos":[3758,3803],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::IsOpen<ept id=\"p1\">](#cdaoquerydef__isopen)</ept>","source":"[CDaoQueryDef::IsOpen](#cdaoquerydef__isopen)"},{"content":"Returns nonzero if the querydef is open and can be executed.","pos":[3804,3864]},{"pos":[3869,3910],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::Open<ept id=\"p1\">](#cdaoquerydef__open)</ept>","source":"[CDaoQueryDef::Open](#cdaoquerydef__open)"},{"content":"Opens an existing querydef stored in the database's QueryDefs collection.","pos":[3911,3984]},{"pos":[3989,4042],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::SetConnect<ept id=\"p1\">](#cdaoquerydef__setconnect)</ept>","source":"[CDaoQueryDef::SetConnect](#cdaoquerydef__setconnect)"},{"content":"Sets the connection string for a SQL pass-through query on an ODBC data source.","pos":[4043,4122]},{"pos":[4127,4174],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::SetName<ept id=\"p1\">](#cdaoquerydef__setname)</ept>","source":"[CDaoQueryDef::SetName](#cdaoquerydef__setname)"},{"content":"Sets the name of the saved query, replacing the name in use when the querydef was created.","pos":[4175,4265]},{"pos":[4270,4331],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::SetODBCTimeout<ept id=\"p1\">](#cdaoquerydef__setodbctimeout)</ept>","source":"[CDaoQueryDef::SetODBCTimeout](#cdaoquerydef__setodbctimeout)"},{"content":"Sets the timeout value used by ODBC (for an ODBC query) when the querydef is executed.","pos":[4332,4418]},{"pos":[4423,4482],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::SetParamValue<ept id=\"p1\">](#cdaoquerydef__setparamvalue)</ept>","source":"[CDaoQueryDef::SetParamValue](#cdaoquerydef__setparamvalue)"},{"content":"Sets the value of a specified parameter to the query.","pos":[4483,4536]},{"pos":[4541,4608],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::SetReturnsRecords<ept id=\"p1\">](#cdaoquerydef__setreturnsrecords)</ept>","source":"[CDaoQueryDef::SetReturnsRecords](#cdaoquerydef__setreturnsrecords)"},{"content":"Specifies whether the querydef returns records.","pos":[4609,4656]},{"content":"Setting this attribute to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> is only valid for SQL pass-through queries.","pos":[4657,4735],"source":" Setting this attribute to **TRUE** is only valid for SQL pass-through queries."},{"pos":[4740,4785],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::SetSQL<ept id=\"p1\">](#cdaoquerydef__setsql)</ept>","source":"[CDaoQueryDef::SetSQL](#cdaoquerydef__setsql)"},{"content":"Sets the SQL string that specifies the query defined by the querydef.","pos":[4786,4855]},{"pos":[4866,4885],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[4892,4896]},{"content":"Description","pos":[4897,4908]},{"pos":[4946,5007],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::m_pDAOQueryDef<ept id=\"p1\">](#cdaoquerydef__m_pdaoquerydef)</ept>","source":"[CDaoQueryDef::m_pDAOQueryDef](#cdaoquerydef__m_pdaoquerydef)"},{"content":"A pointer to the OLE interface for the underlying DAO querydef object.","pos":[5008,5078]},{"pos":[5083,5138],"content":"<bpt id=\"p1\">[</bpt>CDaoQueryDef::m_pDatabase<ept id=\"p1\">](#cdaoquerydef__m_pdatabase)</ept>","source":"[CDaoQueryDef::m_pDatabase](#cdaoquerydef__m_pdatabase)"},{"content":"A pointer to the <ph id=\"ph1\">`CDaoDatabase`</ph> object with which the querydef is associated.","pos":[5139,5216],"source":"A pointer to the `CDaoDatabase` object with which the querydef is associated."},{"content":"The querydef might be saved in the database or not.","pos":[5217,5268]},{"pos":[5278,5285],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"A querydef is a data access object that contains the SQL statement that describes a query, and its properties, such as \"Date Created\" and \"ODBC Timeout.\"","pos":[5289,5442]},{"content":"You can also create temporary querydef objects without saving them, but it is convenient — and much more efficient — to save commonly reused queries in a database.","pos":[5443,5606]},{"content":"A <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object maintains a collection, called the QueryDefs collection, that contains its saved querydefs.","pos":[5607,5765],"source":" A [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object maintains a collection, called the QueryDefs collection, that contains its saved querydefs."},{"pos":[5773,6359],"content":"[!NOTE]\n The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC; the DAO-based classes can access data, including through ODBC drivers, via their own database engine. The DAO-based classes also support Data Definition Language (DDL) operations, such as adding tables via the classes, without having to call DAO directly.","leadings":["","> "],"nodes":[{"content":" The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC; the DAO-based classes can access data, including through ODBC drivers, via their own database engine. The DAO-based classes also support Data Definition Language (DDL) operations, such as adding tables via the classes, without having to call DAO directly.","pos":[8,584],"nodes":[{"content":"The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC).","pos":[1,112]},{"content":"All DAO database class names have the \"CDao\" prefix.","pos":[113,165]},{"content":"You can still access ODBC data sources with the DAO classes.","pos":[166,226]},{"content":"In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC; the DAO-based classes can access data, including through ODBC drivers, via their own database engine.","pos":[227,422]},{"content":"The DAO-based classes also support Data Definition Language (DDL) operations, such as adding tables via the classes, without having to call DAO directly.","pos":[423,576]}]}]},{"pos":[6368,6373],"content":"Usage","linkify":"Usage","nodes":[{"content":"Usage","pos":[0,5]}]},{"content":"Use querydef objects either to work with an existing saved query or to create a new saved query or temporary query:","pos":[6377,6492]},{"pos":[6502,6676],"content":"In all cases, first construct a <ph id=\"ph1\">`CDaoQueryDef`</ph> object, supplying a pointer to the <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object to which the query belongs.","source":"In all cases, first construct a `CDaoQueryDef` object, supplying a pointer to the [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object to which the query belongs."},{"content":"Then do the following, depending on what you want:","pos":[6686,6736]},{"pos":[6750,6892],"content":"To use an existing saved query, call the querydef object's <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaoquerydef__open)</ept> member function, supplying the name of the saved query.","source":"To use an existing saved query, call the querydef object's [Open](#cdaoquerydef__open) member function, supplying the name of the saved query."},{"content":"To create a new saved query, call the querydef object's <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoquerydef__create)</ept> member function, supplying the name of the query.","pos":[6906,7043],"source":"To create a new saved query, call the querydef object's [Create](#cdaoquerydef__create) member function, supplying the name of the query."},{"content":"Then call <bpt id=\"p1\">[</bpt>Append<ept id=\"p1\">](#cdaoquerydef__append)</ept> to save the query by appending it to the database's QueryDefs collection.","pos":[7044,7159],"source":" Then call [Append](#cdaoquerydef__append) to save the query by appending it to the database's QueryDefs collection."},{"content":"<bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> puts the querydef into an open state, so after calling <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept> you do not call <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept>.","pos":[7160,7262],"source":"**Create** puts the querydef into an open state, so after calling **Create** you do not call **Open**."},{"content":"To create a temporary querydef, call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>.","pos":[7276,7324],"source":"To create a temporary querydef, call **Create**."},{"content":"Pass an empty string for the query name.","pos":[7325,7365]},{"content":"Do not call <bpt id=\"p1\">**</bpt>Append<ept id=\"p1\">**</ept>.","pos":[7366,7389],"source":" Do not call **Append**."},{"pos":[7396,7526],"content":"When you finish using a querydef object, call its <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](#cdaoquerydef__close)</ept> member function; then destroy the querydef object.","source":"When you finish using a querydef object, call its [Close](#cdaoquerydef__close) member function; then destroy the querydef object."},{"pos":[7534,7706],"content":"[!TIP]\n The easiest way to create saved queries is to create them and store them in your database using Microsoft Access. Then you can open and use them in your MFC code.","leadings":["","> "],"nodes":[{"content":" The easiest way to create saved queries is to create them and store them in your database using Microsoft Access. Then you can open and use them in your MFC code.","pos":[7,170],"nodes":[{"content":"The easiest way to create saved queries is to create them and store them in your database using Microsoft Access.","pos":[1,114]},{"content":"Then you can open and use them in your MFC code.","pos":[115,163]}]}]},{"pos":[7715,7723],"content":"Purposes","linkify":"Purposes","nodes":[{"content":"Purposes","pos":[0,8]}]},{"content":"You can use a querydef object for any of the following purposes:","pos":[7727,7791]},{"pos":[7801,7835],"content":"To create a <ph id=\"ph1\">`CDaoRecordset`</ph> object","source":"To create a `CDaoRecordset` object"},{"pos":[7845,7957],"content":"To call the object's <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> member function to directly execute an action query or a SQL pass-through query","source":"To call the object's **Execute** member function to directly execute an action query or a SQL pass-through query"},{"content":"You can use a querydef object for any type of query, including select, action, crosstab, delete, update, append, make-table, data definition, SQL pass-through, union, and bulk queries.","pos":[7964,8148]},{"content":"The query's type is determined by the content of the SQL statement that you supply.","pos":[8149,8232]},{"content":"For information about query types, see the <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> and <bpt id=\"p2\">[</bpt>GetType<ept id=\"p2\">](#cdaoquerydef__gettype)</ept> member functions.","pos":[8233,8343],"source":" For information about query types, see the **Execute** and [GetType](#cdaoquerydef__gettype) member functions."},{"content":"Recordsets are commonly used for row-returning queries, usually those using the <bpt id=\"p1\">**</bpt>SELECT ... FROM<ept id=\"p1\">**</ept> keywords.","pos":[8344,8453],"source":" Recordsets are commonly used for row-returning queries, usually those using the **SELECT ... FROM** keywords."},{"content":"<bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> is most commonly used for bulk operations.","pos":[8454,8508],"source":"**Execute** is most commonly used for bulk operations."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Execute<ept id=\"p1\">](#cdaoquerydef__execute)</ept> and <bpt id=\"p2\">[</bpt>CDaoRecordset<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md)</ept>.","pos":[8509,8633],"source":" For more information, see [Execute](#cdaoquerydef__execute) and [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)."},{"pos":[8642,8666],"content":"Querydefs and Recordsets","linkify":"Querydefs and Recordsets","nodes":[{"content":"Querydefs and Recordsets","pos":[0,24]}]},{"content":"To use a querydef object to create a <ph id=\"ph1\">`CDaoRecordset`</ph> object, you typically create or open a querydef as described above.","pos":[8670,8790],"source":"To use a querydef object to create a `CDaoRecordset` object, you typically create or open a querydef as described above."},{"content":"Then construct a recordset object, passing a pointer to your querydef object when you call <bpt id=\"p1\">[</bpt>CDaoRecordset::Open<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__open)</ept>.","pos":[8791,8968],"source":" Then construct a recordset object, passing a pointer to your querydef object when you call [CDaoRecordset::Open](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__open)."},{"content":"The querydef you pass must be in an open state.","pos":[8969,9016]},{"content":"For more information, see class <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept>.","pos":[9017,9109],"source":" For more information, see class [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)."},{"content":"You cannot use a querydef to create a recordset (the most common use for a querydef) unless it is in an open state.","pos":[9116,9231]},{"content":"Put the querydef into an open state by calling either <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept>.","pos":[9232,9309],"source":" Put the querydef into an open state by calling either **Open** or **Create**."},{"pos":[9318,9336],"content":"External Databases","linkify":"External Databases","nodes":[{"content":"External Databases","pos":[0,18]}]},{"content":"Querydef objects are the preferred way to use the native SQL dialect of an external database engine.","pos":[9340,9440]},{"content":"For example, you can create a Transact SQL query (as used on Microsoft SQL Server) and store it in a querydef object.","pos":[9441,9558]},{"content":"When you need to use a SQL query not based on the Microsoft Jet database engine, you must provide a connection string that points to the external data source.","pos":[9559,9717]},{"content":"Queries with valid connection strings bypass the database engine and pass the query directly to the external database server for processing.","pos":[9718,9858]},{"pos":[9866,9972],"content":"[!TIP]\n The preferred way to work with ODBC tables is to attach them to a Microsoft Jet (.MDB) database.","leadings":["","> "],"nodes":[{"content":"The preferred way to work with ODBC tables is to attach them to a Microsoft Jet (.MDB) database.","pos":[8,104]}]},{"content":"For related information, see the topics \"QueryDef Object\", \"QueryDefs Collection\", and \"CdbDatabase Object\" in the DAO SDK.","pos":[9979,10102]},{"pos":[10111,10132],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[10136,10183],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[10213,10225],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[10229,10249],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdao.h","source":"**Header:** afxdao.h"},{"pos":[10259,10316],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__append\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::Append","linkify":"<a name=\"cdaoquerydef__append\"></a>  CDaoQueryDef::Append","source":"<a name=\"cdaoquerydef__append\"></a>  CDaoQueryDef::Append"},{"pos":[10320,10425],"content":"Call this member function after you call <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoquerydef__create)</ept> to create a new querydef object.","source":"Call this member function after you call [Create](#cdaoquerydef__create) to create a new querydef object."},{"pos":[10473,10480],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<bpt id=\"p1\">**</bpt>Append<ept id=\"p1\">**</ept> saves the querydef in the database by appending the object to the database's QueryDefs collection.","pos":[10484,10593],"source":"**Append** saves the querydef in the database by appending the object to the database's QueryDefs collection."},{"content":"You can use the querydef as a temporary object without appending it, but if you want it to persist, you must call <bpt id=\"p1\">**</bpt>Append<ept id=\"p1\">**</ept>.","pos":[10594,10719],"source":" You can use the querydef as a temporary object without appending it, but if you want it to persist, you must call **Append**."},{"pos":[10726,10872],"content":"If you attempt to append a temporary querydef object, MFC throws an exception of type <bpt id=\"p1\">[</bpt>CDaoException<ept id=\"p1\">](../../mfc/reference/cdaoexception-class.md)</ept>.","source":"If you attempt to append a temporary querydef object, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md)."},{"pos":[10882,10945],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__canupdate\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::CanUpdate","linkify":"<a name=\"cdaoquerydef__canupdate\"></a>  CDaoQueryDef::CanUpdate","source":"<a name=\"cdaoquerydef__canupdate\"></a>  CDaoQueryDef::CanUpdate"},{"content":"Call this member function to determine whether you can modify the querydef — such as changing its name or SQL string.","pos":[10949,11066]},{"pos":[11109,11121],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if you are permitted to modify the querydef; otherwise 0.","pos":[11125,11190]},{"pos":[11200,11207],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can modify the querydef if:","pos":[11211,11242]},{"content":"It is not based on a database that is open read-only.","pos":[11252,11305]},{"content":"You have update permissions for the database.","pos":[11315,11360]},{"content":"This depends on whether you have implemented security features.","pos":[11371,11434]},{"content":"MFC does not provide support for security; you must implement it yourself by calling DAO directly or by using Microsoft Access.","pos":[11435,11562]},{"content":"See the topic \"Permissions Property\" in DAO Help.","pos":[11563,11612]},{"pos":[11622,11691],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__cdaoquerydef\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::CDaoQueryDef","linkify":"<a name=\"cdaoquerydef__cdaoquerydef\"></a>  CDaoQueryDef::CDaoQueryDef","source":"<a name=\"cdaoquerydef__cdaoquerydef\"></a>  CDaoQueryDef::CDaoQueryDef"},{"pos":[11695,11732],"content":"Constructs a <bpt id=\"p1\">**</bpt>CDaoQueryDef<ept id=\"p1\">**</ept> object.","source":"Constructs a **CDaoQueryDef** object."},{"pos":[11796,11806],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to an open <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object.","pos":[11825,11911],"source":" A pointer to an open [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object."},{"pos":[11921,11928],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The object can represent an existing querydef stored in the database's QueryDefs collection, a new query to be stored in the collection, or a temporary query, not to be stored.","pos":[11932,12108]},{"content":"Your next step depends on the type of querydef:","pos":[12109,12156]},{"pos":[12166,12292],"content":"If the object represents an existing querydef, call the object's <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaoquerydef__open)</ept> member function to initialize it.","source":"If the object represents an existing querydef, call the object's [Open](#cdaoquerydef__open) member function to initialize it."},{"content":"If the object represents a new querydef to be saved, call the object's <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoquerydef__create)</ept> member function.","pos":[12302,12421],"source":"If the object represents a new querydef to be saved, call the object's [Create](#cdaoquerydef__create) member function."},{"content":"This adds the object to the database's QueryDefs collection.","pos":[12422,12482]},{"content":"Then call <ph id=\"ph1\">`CDaoQueryDef`</ph> member functions to set the object's attributes.","pos":[12483,12556],"source":" Then call `CDaoQueryDef` member functions to set the object's attributes."},{"content":"Finally, call <bpt id=\"p1\">[</bpt>Append<ept id=\"p1\">](#cdaoquerydef__append)</ept>.","pos":[12557,12603],"source":" Finally, call [Append](#cdaoquerydef__append)."},{"content":"If the object represents a temporary querydef (not to be saved in the database), call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>, passing an empty string for the query's name.","pos":[12613,12756],"source":"If the object represents a temporary querydef (not to be saved in the database), call **Create**, passing an empty string for the query's name."},{"content":"After calling <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>, initialize the querydef by directly setting its attributes.","pos":[12757,12842],"source":" After calling **Create**, initialize the querydef by directly setting its attributes."},{"content":"Do not call <bpt id=\"p1\">**</bpt>Append<ept id=\"p1\">**</ept>.","pos":[12843,12866],"source":" Do not call **Append**."},{"pos":[12873,13161],"content":"To set the attributes of the querydef, you can use the <bpt id=\"p1\">[</bpt>SetName<ept id=\"p1\">](#cdaoquerydef__setname)</ept>, <bpt id=\"p2\">[</bpt>SetSQL<ept id=\"p2\">](#cdaoquerydef__setsql)</ept>, <bpt id=\"p3\">[</bpt>SetConnect<ept id=\"p3\">](#cdaoquerydef__setconnect)</ept>, <bpt id=\"p4\">[</bpt>SetODBCTimeout<ept id=\"p4\">](#cdaoquerydef__setodbctimeout)</ept>, and <bpt id=\"p5\">[</bpt>SetReturnsRecords<ept id=\"p5\">](#cdaoquerydef__setreturnsrecords)</ept> member functions.","source":"To set the attributes of the querydef, you can use the [SetName](#cdaoquerydef__setname), [SetSQL](#cdaoquerydef__setsql), [SetConnect](#cdaoquerydef__setconnect), [SetODBCTimeout](#cdaoquerydef__setodbctimeout), and [SetReturnsRecords](#cdaoquerydef__setreturnsrecords) member functions."},{"content":"When you finish with the querydef object, call its <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](#cdaoquerydef__close)</ept> member function.","pos":[13168,13265],"source":"When you finish with the querydef object, call its [Close](#cdaoquerydef__close) member function."},{"content":"If you have a pointer to the querydef, use the <bpt id=\"p1\">**</bpt>delete<ept id=\"p1\">**</ept> operator to destroy the C++ object.","pos":[13266,13359],"source":" If you have a pointer to the querydef, use the **delete** operator to destroy the C++ object."},{"pos":[13369,13424],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__close\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::Close","linkify":"<a name=\"cdaoquerydef__close\"></a>  CDaoQueryDef::Close","source":"<a name=\"cdaoquerydef__close\"></a>  CDaoQueryDef::Close"},{"content":"Call this member function when you finish using the querydef object.","pos":[13428,13496]},{"pos":[13543,13550],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Closing the querydef releases the underlying DAO object but does not destroy the saved DAO querydef object or the C++ <ph id=\"ph1\">`CDaoQueryDef`</ph> object.","pos":[13554,13694],"source":"Closing the querydef releases the underlying DAO object but does not destroy the saved DAO querydef object or the C++ `CDaoQueryDef` object."},{"content":"This is not the same as <bpt id=\"p1\">[</bpt>CDaoDatabase::DeleteQueryDef<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__deletequerydef)</ept>, which deletes the querydef from the database's QueryDefs collection in DAO (if not a temporary querydef).","pos":[13695,13928],"source":" This is not the same as [CDaoDatabase::DeleteQueryDef](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__deletequerydef), which deletes the querydef from the database's QueryDefs collection in DAO (if not a temporary querydef)."},{"pos":[13938,13995],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__create\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::Create","linkify":"<a name=\"cdaoquerydef__create\"></a>  CDaoQueryDef::Create","source":"<a name=\"cdaoquerydef__create\"></a>  CDaoQueryDef::Create"},{"content":"Call this member function to create a new saved query or a new temporary query.","pos":[13999,14078]},{"pos":[14184,14194],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The unique name of the query saved in the database.","pos":[14212,14263]},{"content":"For details about the string, see the topic \"CreateQueryDef Method\" in DAO Help.","pos":[14264,14344]},{"content":"If you accept the default value, an empty string, a temporary querydef is created.","pos":[14345,14427]},{"content":"Such a query is not saved in the QueryDefs collection.","pos":[14428,14482]},{"content":"The SQL string that defines the query.","pos":[14502,14540]},{"content":"If you accept the default value of <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, you must later call <bpt id=\"p2\">[</bpt>SetSQL<ept id=\"p2\">](#cdaoquerydef__setsql)</ept> to set the string.","pos":[14541,14656],"source":" If you accept the default value of **NULL**, you must later call [SetSQL](#cdaoquerydef__setsql) to set the string."},{"content":"Until then, the query is undefined.","pos":[14657,14692]},{"content":"You can, however, use the undefined query to open a recordset; see Remarks for details.","pos":[14693,14780]},{"content":"The SQL statement must be defined before you can append the querydef to the QueryDefs collection.","pos":[14781,14878]},{"pos":[14888,14895],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If you pass a name in <ph id=\"ph1\">`lpszName`</ph>, you can then call <bpt id=\"p1\">[</bpt>Append<ept id=\"p1\">](#cdaoquerydef__append)</ept> to save the querydef in the database's QueryDefs collection.","pos":[14899,15043],"source":"If you pass a name in `lpszName`, you can then call [Append](#cdaoquerydef__append) to save the querydef in the database's QueryDefs collection."},{"content":"Otherwise, the object is a temporary querydef and is not saved.","pos":[15044,15107]},{"content":"In either case, the querydef is in an open state, and you can either use it to create a <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept> object or call the querydef's <bpt id=\"p2\">[</bpt>Execute<ept id=\"p2\">](#cdaoquerydef__execute)</ept> member function.","pos":[15108,15336],"source":" In either case, the querydef is in an open state, and you can either use it to create a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object or call the querydef's [Execute](#cdaoquerydef__execute) member function."},{"content":"If you do not supply a SQL statement in <ph id=\"ph1\">`lpszSQL`</ph>, you cannot run the query with <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> but you can use it to create a recordset.","pos":[15343,15477],"source":"If you do not supply a SQL statement in `lpszSQL`, you cannot run the query with **Execute** but you can use it to create a recordset."},{"content":"In that case, MFC uses the recordset's default SQL statement.","pos":[15478,15539]},{"pos":[15549,15608],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__execute\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::Execute","linkify":"<a name=\"cdaoquerydef__execute\"></a>  CDaoQueryDef::Execute","source":"<a name=\"cdaoquerydef__execute\"></a>  CDaoQueryDef::Execute"},{"content":"Call this member function to run the query defined by the querydef object.","pos":[15612,15686]},{"pos":[15763,15773],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"An integer that determines the characteristics of the query.","pos":[15791,15851]},{"content":"For related information, see the topic \"Execute Method\" in DAO Help.","pos":[15852,15920]},{"content":"You can use the bitwise-OR operator ( <bpt id=\"p1\">**</bpt>&amp;#124;<ept id=\"p1\">**</ept>) to combine the following constants for this argument:","pos":[15921,16024],"source":" You can use the bitwise-OR operator ( **&#124;**) to combine the following constants for this argument:"},{"pos":[16032,16085],"content":"<bpt id=\"p1\">**</bpt>dbDenyWrite<ept id=\"p1\">**</ept> Deny write permission to other users.","source":"**dbDenyWrite** Deny write permission to other users."},{"pos":[16093,16133],"content":"<bpt id=\"p1\">**</bpt>dbInconsistent<ept id=\"p1\">**</ept> Inconsistent updates.","source":"**dbInconsistent** Inconsistent updates."},{"pos":[16141,16177],"content":"<bpt id=\"p1\">**</bpt>dbConsistent<ept id=\"p1\">**</ept> Consistent updates.","source":"**dbConsistent** Consistent updates."},{"content":"<bpt id=\"p1\">**</bpt>dbSQLPassThrough<ept id=\"p1\">**</ept> SQL pass-through.","pos":[16185,16223],"source":"**dbSQLPassThrough** SQL pass-through."},{"content":"Causes the SQL statement to be passed to an ODBC database for processing.","pos":[16224,16297]},{"content":"<bpt id=\"p1\">**</bpt>dbFailOnError<ept id=\"p1\">**</ept> Default value.","pos":[16305,16337],"source":"**dbFailOnError** Default value."},{"content":"Roll back updates if an error occurs and report the error to the user.","pos":[16338,16408]},{"pos":[16416,16508],"content":"<bpt id=\"p1\">**</bpt>dbSeeChanges<ept id=\"p1\">**</ept> Generate a run-time error if another user is changing data you are editing.","source":"**dbSeeChanges** Generate a run-time error if another user is changing data you are editing."},{"pos":[16516,16635],"content":"[!NOTE]\n For an explanation of the terms \"inconsistent\" and \"consistent,\" see the topic \"Execute Method\" in DAO Help.","leadings":["","> "],"nodes":[{"content":"For an explanation of the terms \"inconsistent\" and \"consistent,\" see the topic \"Execute Method\" in DAO Help.","pos":[9,117]}]},{"pos":[16645,16652],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Querydef objects used for execution in this manner can only represent one of the following query types:","pos":[16656,16759]},{"content":"Action queries","pos":[16769,16783]},{"content":"SQL pass-through queries","pos":[16793,16817]},{"content":"<bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> does not work for queries that return records, such as select queries.","pos":[16824,16906],"source":"**Execute** does not work for queries that return records, such as select queries."},{"content":"<bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> is commonly used for bulk operation queries, such as <bpt id=\"p2\">**</bpt>UPDATE<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>INSERT<ept id=\"p3\">**</ept>, or <bpt id=\"p4\">**</bpt>SELECT INTO<ept id=\"p4\">**</ept>, or for data definition language (DDL) operations.","pos":[16907,17065],"source":"**Execute** is commonly used for bulk operation queries, such as **UPDATE**, **INSERT**, or **SELECT INTO**, or for data definition language (DDL) operations."},{"pos":[17073,17276],"content":"[!TIP]\n The preferred way to work with ODBC data sources is to attach tables to a Microsoft Jet (.MDB) database. For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.","leadings":["","> "],"nodes":[{"content":" The preferred way to work with ODBC data sources is to attach tables to a Microsoft Jet (.MDB) database. For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.","pos":[7,201],"nodes":[{"content":"The preferred way to work with ODBC data sources is to attach tables to a Microsoft Jet (.MDB) database.","pos":[1,105]},{"content":"For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.","pos":[106,194]}]}]},{"content":"Call the <bpt id=\"p1\">[</bpt>GetRecordsAffected<ept id=\"p1\">](#cdaoquerydef__getrecordsaffected)</ept> member function of the querydef object to determine the number of records affected by the most recent <bpt id=\"p2\">**</bpt>Execute<ept id=\"p2\">**</ept> call.","pos":[17283,17467],"source":"Call the [GetRecordsAffected](#cdaoquerydef__getrecordsaffected) member function of the querydef object to determine the number of records affected by the most recent **Execute** call."},{"content":"For example, <ph id=\"ph1\">`GetRecordsAffected`</ph> returns information about the number of records deleted, updated, or inserted when executing an action query.","pos":[17468,17611],"source":" For example, `GetRecordsAffected` returns information about the number of records deleted, updated, or inserted when executing an action query."},{"content":"The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.","pos":[17612,17720]},{"pos":[17727,17860],"content":"If you include both <bpt id=\"p1\">**</bpt>dbInconsistent<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>dbConsistent<ept id=\"p2\">**</ept> or if you include neither, the result is the default, <bpt id=\"p3\">**</bpt>dbInconsistent<ept id=\"p3\">**</ept>.","source":"If you include both **dbInconsistent** and **dbConsistent** or if you include neither, the result is the default, **dbInconsistent**."},{"content":"<bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> does not return a recordset.","pos":[17867,17907],"source":"**Execute** does not return a recordset."},{"content":"Using <bpt id=\"p1\">**</bpt>Execute<ept id=\"p1\">**</ept> on a query that selects records causes MFC to throw an exception of type <bpt id=\"p2\">[</bpt>CDaoException<ept id=\"p2\">](../../mfc/reference/cdaoexception-class.md)</ept>.","pos":[17908,18059],"source":" Using **Execute** on a query that selects records causes MFC to throw an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md)."},{"pos":[18069,18134],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getconnect\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetConnect","linkify":"<a name=\"cdaoquerydef__getconnect\"></a>  CDaoQueryDef::GetConnect","source":"<a name=\"cdaoquerydef__getconnect\"></a>  CDaoQueryDef::GetConnect"},{"content":"Call this member function to get the connection string associated with the querydef's data source.","pos":[18138,18236]},{"pos":[18283,18295],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[18299,18411],"content":"A <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> containing the connection string for the querydef.","source":"A [CString](../../atl-mfc-shared/reference/cstringt-class.md) containing the connection string for the querydef."},{"pos":[18421,18428],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function is used only with ODBC data sources and certain ISAM drivers.","pos":[18432,18507]},{"content":"It is not used with Microsoft Jet (.MDB) databases; in this case, <ph id=\"ph1\">`GetConnect`</ph> returns an empty string.","pos":[18508,18611],"source":" It is not used with Microsoft Jet (.MDB) databases; in this case, `GetConnect` returns an empty string."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>SetConnect<ept id=\"p1\">](#cdaoquerydef__setconnect)</ept>.","pos":[18612,18678],"source":" For more information, see [SetConnect](#cdaoquerydef__setconnect)."},{"pos":[18686,18866],"content":"[!TIP]\n The preferred way to work with ODBC tables is to attach them to an .MDB database. For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.","leadings":["","> "],"nodes":[{"content":" The preferred way to work with ODBC tables is to attach them to an .MDB database. For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.","pos":[7,178],"nodes":[{"content":"The preferred way to work with ODBC tables is to attach them to an .MDB database.","pos":[1,82]},{"content":"For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.","pos":[83,171]}]}]},{"content":"For information about connection strings, see the topic \"Connect Property\" in DAO Help.","pos":[18873,18960]},{"pos":[18970,19043],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getdatecreated\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetDateCreated","linkify":"<a name=\"cdaoquerydef__getdatecreated\"></a>  CDaoQueryDef::GetDateCreated","source":"<a name=\"cdaoquerydef__getdatecreated\"></a>  CDaoQueryDef::GetDateCreated"},{"content":"Call this member function to get the date the querydef object was created.","pos":[19047,19121]},{"pos":[19177,19189],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[19193,19325],"content":"A <bpt id=\"p1\">[</bpt>COleDateTime<ept id=\"p1\">](../../atl-mfc-shared/reference/coledatetime-class.md)</ept> object containing the date and time the querydef was created.","source":"A [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object containing the date and time the querydef was created."},{"pos":[19335,19342],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"For related information, see the topic \"DateCreated, LastUpdated Properties\" in DAO Help.","pos":[19346,19435]},{"pos":[19445,19526],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getdatelastupdated\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetDateLastUpdated","linkify":"<a name=\"cdaoquerydef__getdatelastupdated\"></a>  CDaoQueryDef::GetDateLastUpdated","source":"<a name=\"cdaoquerydef__getdatelastupdated\"></a>  CDaoQueryDef::GetDateLastUpdated"},{"content":"Call this member function to get the date the querydef object was last updated — when any of its properties were changed, such as its name, its SQL string, or its connection string.","pos":[19530,19711]},{"pos":[19771,19783],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[19787,19924],"content":"A <bpt id=\"p1\">[</bpt>COleDateTime<ept id=\"p1\">](../../atl-mfc-shared/reference/coledatetime-class.md)</ept> object containing the date and time the querydef was last updated.","source":"A [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object containing the date and time the querydef was last updated."},{"pos":[19934,19941],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"For related information, see the topic \"DateCreated, LastUpdated Properties\" in DAO Help.","pos":[19945,20034]},{"pos":[20044,20115],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getfieldcount\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetFieldCount","linkify":"<a name=\"cdaoquerydef__getfieldcount\"></a>  CDaoQueryDef::GetFieldCount","source":"<a name=\"cdaoquerydef__getfieldcount\"></a>  CDaoQueryDef::GetFieldCount"},{"content":"Call this member function to retrieve the number of fields in the query.","pos":[20119,20191]},{"pos":[20239,20251],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The number of fields defined in the query.","pos":[20255,20297]},{"pos":[20307,20314],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`GetFieldCount`</ph> is useful for looping through all fields in the querydef.","pos":[20318,20391],"source":"`GetFieldCount` is useful for looping through all fields in the querydef."},{"content":"For that purpose, use <ph id=\"ph1\">`GetFieldCount`</ph> in conjunction with <bpt id=\"p1\">[</bpt>GetFieldInfo<ept id=\"p1\">](#cdaoquerydef__getfieldinfo)</ept>.","pos":[20392,20494],"source":" For that purpose, use `GetFieldCount` in conjunction with [GetFieldInfo](#cdaoquerydef__getfieldinfo)."},{"pos":[20504,20573],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getfieldinfo\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetFieldInfo","linkify":"<a name=\"cdaoquerydef__getfieldinfo\"></a>  CDaoQueryDef::GetFieldInfo","source":"<a name=\"cdaoquerydef__getfieldinfo\"></a>  CDaoQueryDef::GetFieldInfo"},{"content":"Call this member function to obtain various kinds of information about a field defined in the querydef.","pos":[20577,20680]},{"pos":[20950,20960],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The zero-based index of the desired field in the querydef's Fields collection, for lookup by index.","pos":[20976,21075]},{"content":"A reference to a <ph id=\"ph1\">`CDaoFieldInfo`</ph> object that returns the information requested.","pos":[21097,21176],"source":" A reference to a `CDaoFieldInfo` object that returns the information requested."},{"content":"Options that specify which information about the field to retrieve.","pos":[21202,21269]},{"content":"The available options are listed here along with what they cause the function to return:","pos":[21270,21358]},{"pos":[21366,21427],"content":"<ph id=\"ph1\">`AFX_DAO_PRIMARY_INFO`</ph> (Default) Name, Type, Size, Attributes","source":"`AFX_DAO_PRIMARY_INFO` (Default) Name, Type, Size, Attributes"},{"pos":[21435,21590],"content":"<ph id=\"ph1\">`AFX_DAO_SECONDARY_INFO`</ph> Primary information plus: Ordinal Position, Required, Allow Zero Length, Source Field, Foreign Name, Source Table, Collating Order","source":"`AFX_DAO_SECONDARY_INFO` Primary information plus: Ordinal Position, Required, Allow Zero Length, Source Field, Foreign Name, Source Table, Collating Order"},{"pos":[21598,21704],"content":"<ph id=\"ph1\">`AFX_DAO_ALL_INFO`</ph> Primary and secondary information plus: Default Value, Validation Text, Validation Rule","source":"`AFX_DAO_ALL_INFO` Primary and secondary information plus: Default Value, Validation Text, Validation Rule"},{"pos":[21711,21870],"content":"`lpszName`  \nA string containing the name of the desired field, for lookup by name. You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md).","leadings":[""," "],"nodes":[{"content":"A string containing the name of the desired field, for lookup by name. You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md).","pos":[13,158],"nodes":[{"content":"A string containing the name of the desired field, for lookup by name.","pos":[0,70]},{"content":"You can use a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept>.","pos":[71,145],"source":" You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md)."}]}]},{"pos":[21880,21887],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"For a description of the information returned in <ph id=\"ph1\">`fieldinfo`</ph>, see the <bpt id=\"p1\">[</bpt>CDaoFieldInfo<ept id=\"p1\">](../../mfc/reference/cdaofieldinfo-structure.md)</ept> structure.","pos":[21891,22035],"source":"For a description of the information returned in `fieldinfo`, see the [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) structure."},{"content":"This structure has members that correspond to the descriptive information under <ph id=\"ph1\">`dwInfoOptions`</ph> above.","pos":[22036,22138],"source":" This structure has members that correspond to the descriptive information under `dwInfoOptions` above."},{"content":"If you request one level of information, you get any prior levels of information as well.","pos":[22139,22228]},{"pos":[22238,22297],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getname\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetName","linkify":"<a name=\"cdaoquerydef__getname\"></a>  CDaoQueryDef::GetName","source":"<a name=\"cdaoquerydef__getname\"></a>  CDaoQueryDef::GetName"},{"content":"Call this member function to retrieve the name of the query represented by the querydef.","pos":[22301,22389]},{"pos":[22433,22445],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The name of the query.","pos":[22449,22471]},{"pos":[22481,22488],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Querydef names are unique user-defined names.","pos":[22492,22537]},{"content":"For more information about querydef names, see the topic \"Name Property\" in DAO Help.","pos":[22538,22623]},{"pos":[22633,22706],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getodbctimeout\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetODBCTimeout","linkify":"<a name=\"cdaoquerydef__getodbctimeout\"></a>  CDaoQueryDef::GetODBCTimeout","source":"<a name=\"cdaoquerydef__getodbctimeout\"></a>  CDaoQueryDef::GetODBCTimeout"},{"content":"Call this member function to retrieve the current time limit before a query to an ODBC data source times out.","pos":[22710,22819]},{"pos":[22868,22880],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The number of seconds before a query times out.","pos":[22884,22931]},{"pos":[22941,22948],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"For information about this time limit, see the topic \"ODBCTimeout Property\" in DAO Help.","pos":[22952,23040]},{"pos":[23048,23243],"content":"[!TIP]\n The preferred way to work with ODBC tables is to attach them to a Microsoft Jet (.MDB) database. For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.","leadings":["","> "],"nodes":[{"content":" The preferred way to work with ODBC tables is to attach them to a Microsoft Jet (.MDB) database. For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.","pos":[7,193],"nodes":[{"content":"The preferred way to work with ODBC tables is to attach them to a Microsoft Jet (.MDB) database.","pos":[1,97]},{"content":"For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.","pos":[98,186]}]}]},{"pos":[23253,23332],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getparametercount\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetParameterCount","linkify":"<a name=\"cdaoquerydef__getparametercount\"></a>  CDaoQueryDef::GetParameterCount","source":"<a name=\"cdaoquerydef__getparametercount\"></a>  CDaoQueryDef::GetParameterCount"},{"content":"Call this member function to retrieve the number of parameters in the saved query.","pos":[23336,23418]},{"pos":[23470,23482],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The number of parameters defined in the query.","pos":[23486,23532]},{"pos":[23542,23549],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`GetParameterCount`</ph> is useful for looping through all parameters in the querydef.","pos":[23553,23634],"source":"`GetParameterCount` is useful for looping through all parameters in the querydef."},{"content":"For that purpose, use <ph id=\"ph1\">`GetParameterCount`</ph> in conjunction with <bpt id=\"p1\">[</bpt>GetParameterInfo<ept id=\"p1\">](#cdaoquerydef__getparameterinfo)</ept>.","pos":[23635,23749],"source":" For that purpose, use `GetParameterCount` in conjunction with [GetParameterInfo](#cdaoquerydef__getparameterinfo)."},{"content":"For related information, see the topics \"Parameter Object\", \"Parameters Collection\", and \"PARAMETERS Declaration (SQL)\" in DAO Help.","pos":[23756,23888]},{"pos":[23898,23975],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getparameterinfo\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetParameterInfo","linkify":"<a name=\"cdaoquerydef__getparameterinfo\"></a>  CDaoQueryDef::GetParameterInfo","source":"<a name=\"cdaoquerydef__getparameterinfo\"></a>  CDaoQueryDef::GetParameterInfo"},{"content":"Call this member function to obtain information about a parameter defined in the querydef.","pos":[23979,24069]},{"pos":[24355,24365],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The zero-based index of the desired parameter in the querydef's Parameters collection, for lookup by index.","pos":[24381,24488]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoParameterInfo<ept id=\"p1\">](../../mfc/reference/cdaoparameterinfo-structure.md)</ept> object that returns the information requested.","pos":[24510,24645],"source":" A reference to a [CDaoParameterInfo](../../mfc/reference/cdaoparameterinfo-structure.md) object that returns the information requested."},{"content":"Options that specify which information about the parameter to retrieve.","pos":[24671,24742]},{"content":"The available option is listed here along with what it causes the function to return:","pos":[24743,24828]},{"pos":[24836,24879],"content":"<ph id=\"ph1\">`AFX_DAO_PRIMARY_INFO`</ph> (Default) Name, Type","source":"`AFX_DAO_PRIMARY_INFO` (Default) Name, Type"},{"pos":[24886,25049],"content":"`lpszName`  \nA string containing the name of the desired parameter, for lookup by name. You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md).","leadings":[""," "],"nodes":[{"content":"A string containing the name of the desired parameter, for lookup by name. You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md).","pos":[13,162],"nodes":[{"content":"A string containing the name of the desired parameter, for lookup by name.","pos":[0,74]},{"content":"You can use a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept>.","pos":[75,149],"source":" You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md)."}]}]},{"pos":[25059,25066],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"For a description of the information returned in <ph id=\"ph1\">`paraminfo`</ph>, see the <bpt id=\"p1\">[</bpt>CDaoParameterInfo<ept id=\"p1\">](../../mfc/reference/cdaoparameterinfo-structure.md)</ept> structure.","pos":[25070,25222],"source":"For a description of the information returned in `paraminfo`, see the [CDaoParameterInfo](../../mfc/reference/cdaoparameterinfo-structure.md) structure."},{"content":"This structure has members that correspond to the descriptive information under <ph id=\"ph1\">`dwInfoOptions`</ph> above.","pos":[25223,25325],"source":" This structure has members that correspond to the descriptive information under `dwInfoOptions` above."},{"content":"For related information, see the topic \"PARAMETERS Declaration (SQL)\" in DAO Help.","pos":[25332,25414]},{"pos":[25424,25495],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getparamvalue\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetParamValue","linkify":"<a name=\"cdaoquerydef__getparamvalue\"></a>  CDaoQueryDef::GetParamValue","source":"<a name=\"cdaoquerydef__getparamvalue\"></a>  CDaoQueryDef::GetParamValue"},{"content":"Call this member function to retrieve the current value of the specified parameter stored in the querydef's Parameters collection.","pos":[25499,25629]},{"pos":[25757,25767],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The name of the parameter whose value you want, for lookup by name.","pos":[25785,25852]},{"content":"The zero-based index of the parameter in the querydef's Parameters collection, for lookup by index.","pos":[25871,25970]},{"content":"You can obtain this value with calls to <bpt id=\"p1\">[</bpt>GetParameterCount<ept id=\"p1\">](#cdaoquerydef__getparametercount)</ept> and <bpt id=\"p2\">[</bpt>GetParameterInfo<ept id=\"p2\">](#cdaoquerydef__getparameterinfo)</ept>.","pos":[25971,26121],"source":" You can obtain this value with calls to [GetParameterCount](#cdaoquerydef__getparametercount) and [GetParameterInfo](#cdaoquerydef__getparameterinfo)."},{"pos":[26131,26143],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[26147,26258],"content":"An object of class <bpt id=\"p1\">[</bpt>COleVariant<ept id=\"p1\">](../../mfc/reference/colevariant-class.md)</ept> that contains the parameter's value.","source":"An object of class [COleVariant](../../mfc/reference/colevariant-class.md) that contains the parameter's value."},{"pos":[26268,26275],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You can access the parameter either by name or by its ordinal position in the collection.","pos":[26279,26368]},{"content":"For related information, see the topic \"PARAMETERS Declaration (SQL)\" in DAO Help.","pos":[26375,26457]},{"pos":[26467,26548],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getrecordsaffected\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetRecordsAffected","linkify":"<a name=\"cdaoquerydef__getrecordsaffected\"></a>  CDaoQueryDef::GetRecordsAffected","source":"<a name=\"cdaoquerydef__getrecordsaffected\"></a>  CDaoQueryDef::GetRecordsAffected"},{"pos":[26552,26676],"content":"Call this member function to determine how many records were affected by the last call of <bpt id=\"p1\">[</bpt>Execute<ept id=\"p1\">](#cdaoquerydef__execute)</ept>.","source":"Call this member function to determine how many records were affected by the last call of [Execute](#cdaoquerydef__execute)."},{"pos":[26728,26740],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The number of records affected.","pos":[26744,26775]},{"pos":[26785,26792],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.","pos":[26796,26904]},{"content":"For related information see the topic \"RecordsAffected Property\" in DAO Help.","pos":[26911,26988]},{"pos":[26998,27077],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getreturnsrecords\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetReturnsRecords","linkify":"<a name=\"cdaoquerydef__getreturnsrecords\"></a>  CDaoQueryDef::GetReturnsRecords","source":"<a name=\"cdaoquerydef__getreturnsrecords\"></a>  CDaoQueryDef::GetReturnsRecords"},{"content":"Call this member function to determine whether the querydef is based on a query that returns records.","pos":[27081,27182]},{"pos":[27233,27245],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the querydef is based on a query that returns records; otherwise 0.","pos":[27249,27327]},{"pos":[27337,27344],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This member function is only used for SQL pass-through queries.","pos":[27348,27411]},{"content":"For more information about SQL queries, see the <bpt id=\"p1\">[</bpt>Execute<ept id=\"p1\">](#cdaoquerydef__execute)</ept> member function.","pos":[27412,27510],"source":" For more information about SQL queries, see the [Execute](#cdaoquerydef__execute) member function."},{"content":"For more information about working with SQL pass-through queries, see the <bpt id=\"p1\">[</bpt>SetReturnsRecords<ept id=\"p1\">](#cdaoquerydef__setreturnsrecords)</ept> member function.","pos":[27511,27655],"source":" For more information about working with SQL pass-through queries, see the [SetReturnsRecords](#cdaoquerydef__setreturnsrecords) member function."},{"content":"For related information, see the topic \"ReturnsRecords Property\" in DAO Help.","pos":[27662,27739]},{"pos":[27749,27806],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__getsql\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetSQL","linkify":"<a name=\"cdaoquerydef__getsql\"></a>  CDaoQueryDef::GetSQL","source":"<a name=\"cdaoquerydef__getsql\"></a>  CDaoQueryDef::GetSQL"},{"content":"Call this member function to retrieve the SQL statement that defines the query on which the querydef is based.","pos":[27810,27920]},{"pos":[27963,27975],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The SQL statement that defines the query on which the querydef is based.","pos":[27979,28051]},{"pos":[28061,28068],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"You will then probably parse the string for keywords, table names, and so on.","pos":[28072,28149]},{"content":"For related information, see the topics \"SQL Property\", \"Comparison of Microsoft Jet Database Engine SQL and ANSI SQL\", and \"Querying a Database with SQL in Code\" in DAO Help.","pos":[28156,28331]},{"pos":[28341,28400],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__gettype\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::GetType","linkify":"<a name=\"cdaoquerydef__gettype\"></a>  CDaoQueryDef::GetType","source":"<a name=\"cdaoquerydef__gettype\"></a>  CDaoQueryDef::GetType"},{"content":"Call this member function to determine the query type of the querydef.","pos":[28404,28474]},{"pos":[28516,28528],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The type of the query defined by the querydef.","pos":[28532,28578]},{"content":"For values, see Remarks.","pos":[28579,28603]},{"pos":[28613,28620],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The query type is set by what you specify in the querydef's SQL string when you create the querydef or call an existing querydef's <bpt id=\"p1\">[</bpt>SetSQL<ept id=\"p1\">](#cdaoquerydef__setsql)</ept> member function.","pos":[28624,28803],"source":"The query type is set by what you specify in the querydef's SQL string when you create the querydef or call an existing querydef's [SetSQL](#cdaoquerydef__setsql) member function."},{"content":"The query type returned by this function can be one of the following values:","pos":[28804,28880]},{"pos":[28888,28908],"content":"<bpt id=\"p1\">**</bpt>dbQSelect<ept id=\"p1\">**</ept> Select","source":"**dbQSelect** Select"},{"pos":[28916,28936],"content":"<bpt id=\"p1\">**</bpt>dbQAction<ept id=\"p1\">**</ept> Action","source":"**dbQAction** Action"},{"pos":[28944,28968],"content":"<bpt id=\"p1\">**</bpt>dbQCrosstab<ept id=\"p1\">**</ept> Crosstab","source":"**dbQCrosstab** Crosstab"},{"pos":[28976,28996],"content":"<bpt id=\"p1\">**</bpt>dbQDelete<ept id=\"p1\">**</ept> Delete","source":"**dbQDelete** Delete"},{"pos":[29004,29024],"content":"<bpt id=\"p1\">**</bpt>dbQUpdate<ept id=\"p1\">**</ept> Update","source":"**dbQUpdate** Update"},{"pos":[29032,29052],"content":"<bpt id=\"p1\">**</bpt>dbQAppend<ept id=\"p1\">**</ept> Append","source":"**dbQAppend** Append"},{"pos":[29060,29087],"content":"<bpt id=\"p1\">**</bpt>dbQMakeTable<ept id=\"p1\">**</ept> Make-table","source":"**dbQMakeTable** Make-table"},{"pos":[29095,29121],"content":"<bpt id=\"p1\">**</bpt>dbQDDL<ept id=\"p1\">**</ept> Data-definition","source":"**dbQDDL** Data-definition"},{"pos":[29129,29163],"content":"<bpt id=\"p1\">**</bpt>dbQSQLPassThrough<ept id=\"p1\">**</ept> Pass-through","source":"**dbQSQLPassThrough** Pass-through"},{"pos":[29171,29196],"content":"<bpt id=\"p1\">**</bpt>dbQSetOperation<ept id=\"p1\">**</ept> Union","source":"**dbQSetOperation** Union"},{"pos":[29204,29299],"content":"<bpt id=\"p1\">**</bpt>dbQSPTBulk<ept id=\"p1\">**</ept> Used with <bpt id=\"p2\">**</bpt>dbQSQLPassThrough<ept id=\"p2\">**</ept> to specify a query that does not return records.","source":"**dbQSPTBulk** Used with **dbQSQLPassThrough** to specify a query that does not return records."},{"pos":[29307,29526],"content":"[!NOTE]\n To create a SQL pass-through query, don't set the **dbSQLPassThrough** constant. This is set automatically by the Microsoft Jet database engine when you create a querydef object and set the connection string.","leadings":["","> "],"nodes":[{"content":" To create a SQL pass-through query, don't set the **dbSQLPassThrough** constant. This is set automatically by the Microsoft Jet database engine when you create a querydef object and set the connection string.","pos":[8,217],"nodes":[{"content":"To create a SQL pass-through query, don't set the <bpt id=\"p1\">**</bpt>dbSQLPassThrough<ept id=\"p1\">**</ept> constant.","pos":[1,81],"source":" To create a SQL pass-through query, don't set the **dbSQLPassThrough** constant."},{"content":"This is set automatically by the Microsoft Jet database engine when you create a querydef object and set the connection string.","pos":[82,209]}]}]},{"content":"For information about SQL strings, see <bpt id=\"p1\">[</bpt>GetSQL<ept id=\"p1\">](#cdaoquerydef__getsql)</ept>.","pos":[29533,29604],"source":"For information about SQL strings, see [GetSQL](#cdaoquerydef__getsql)."},{"content":"For information about query types, see <bpt id=\"p1\">[</bpt>Execute<ept id=\"p1\">](#cdaoquerydef__execute)</ept>.","pos":[29605,29678],"source":" For information about query types, see [Execute](#cdaoquerydef__execute)."},{"pos":[29688,29745],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__isopen\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::IsOpen","linkify":"<a name=\"cdaoquerydef__isopen\"></a>  CDaoQueryDef::IsOpen","source":"<a name=\"cdaoquerydef__isopen\"></a>  CDaoQueryDef::IsOpen"},{"pos":[29749,29840],"content":"Call this member function to determine whether the <ph id=\"ph1\">`CDaoQueryDef`</ph> object is currently open.","source":"Call this member function to determine whether the `CDaoQueryDef` object is currently open."},{"pos":[29889,29901],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[29905,29973],"content":"Nonzero if the <ph id=\"ph1\">`CDaoQueryDef`</ph> object is currently open; otherwise 0.","source":"Nonzero if the `CDaoQueryDef` object is currently open; otherwise 0."},{"pos":[29983,29990],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"A querydef must be in an open state before you use it to call <bpt id=\"p1\">[</bpt>Execute<ept id=\"p1\">](#cdaoquerydef__execute)</ept> or to create a <bpt id=\"p2\">[</bpt>CDaoRecordset<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md)</ept> object.","pos":[29994,30172],"source":"A querydef must be in an open state before you use it to call [Execute](#cdaoquerydef__execute) or to create a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object."},{"content":"To put a querydef into an open state call either <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaoquerydef__create)</ept> (for a new querydef) or <bpt id=\"p2\">[</bpt>Open<ept id=\"p2\">](#cdaoquerydef__open)</ept> (for an existing querydef).","pos":[30173,30333],"source":" To put a querydef into an open state call either [Create](#cdaoquerydef__create) (for a new querydef) or [Open](#cdaoquerydef__open) (for an existing querydef)."},{"pos":[30343,30410],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__m_pdatabase\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::m_pDatabase","linkify":"<a name=\"cdaoquerydef__m_pdatabase\"></a>  CDaoQueryDef::m_pDatabase","source":"<a name=\"cdaoquerydef__m_pdatabase\"></a>  CDaoQueryDef::m_pDatabase"},{"pos":[30414,30541],"content":"Contains a pointer to the <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object associated with the querydef object.","source":"Contains a pointer to the [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object associated with the querydef object."},{"pos":[30551,30558],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Use this pointer if you need to access the database directly — for example, to obtain pointers to other querydef or recordset objects in the database's collections.","pos":[30562,30726]},{"pos":[30736,30809],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__m_pdaoquerydef\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::m_pDAOQueryDef","linkify":"<a name=\"cdaoquerydef__m_pdaoquerydef\"></a>  CDaoQueryDef::m_pDAOQueryDef","source":"<a name=\"cdaoquerydef__m_pdaoquerydef\"></a>  CDaoQueryDef::m_pDAOQueryDef"},{"content":"Contains a pointer to the OLE interface for the underlying DAO querydef object.","pos":[30813,30892]},{"pos":[30902,30909],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This pointer is provided for completeness and consistency with the other classes.","pos":[30913,30994]},{"content":"However, because MFC rather fully encapsulates DAO querydefs, you are unlikely to need it.","pos":[30995,31085]},{"content":"If you do use it, do so cautiously — in particular, do not change the value of the pointer unless you know what you are doing.","pos":[31086,31212]},{"pos":[31222,31275],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__open\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::Open","linkify":"<a name=\"cdaoquerydef__open\"></a>  CDaoQueryDef::Open","source":"<a name=\"cdaoquerydef__open\"></a>  CDaoQueryDef::Open"},{"content":"Call this member function to open a querydef previously saved in the database's QueryDefs collection.","pos":[31279,31380]},{"pos":[31449,31459],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A string that contains the name of the saved querydef to open.","pos":[31477,31539]},{"content":"You can use a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept>.","pos":[31540,31614],"source":" You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md)."},{"pos":[31624,31631],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[31635,31828],"content":"Once the querydef is open, you can call its <bpt id=\"p1\">[</bpt>Execute<ept id=\"p1\">](#cdaoquerydef__execute)</ept> member function or use the querydef to create a <bpt id=\"p2\">[</bpt>CDaoRecordset<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md)</ept> object.","source":"Once the querydef is open, you can call its [Execute](#cdaoquerydef__execute) member function or use the querydef to create a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object."},{"pos":[31838,31903],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__setconnect\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::SetConnect","linkify":"<a name=\"cdaoquerydef__setconnect\"></a>  CDaoQueryDef::SetConnect","source":"<a name=\"cdaoquerydef__setconnect\"></a>  CDaoQueryDef::SetConnect"},{"content":"Call this member function to set the querydef object's connection string.","pos":[31907,31980]},{"pos":[32043,32053],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A string that contains a connection string for the associated <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object.","pos":[32074,32201],"source":" A string that contains a connection string for the associated [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object."},{"pos":[32211,32218],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The connection string is used to pass additional information to ODBC and certain ISAM drivers as needed.","pos":[32222,32326]},{"content":"It is not used for Microsoft Jet (.MDB) databases.","pos":[32327,32377]},{"pos":[32385,32476],"content":"[!TIP]\n The preferred way to work with ODBC tables is to attach them to an .MDB database.","leadings":["","> "],"nodes":[{"content":"The preferred way to work with ODBC tables is to attach them to an .MDB database.","pos":[8,89]}]},{"pos":[32483,32728],"content":"Before executing a querydef that represents a SQL pass-through query to an ODBC data source, set the connection string with <ph id=\"ph1\">`SetConnect`</ph> and call <bpt id=\"p1\">[</bpt>SetReturnsRecords<ept id=\"p1\">](#cdaoquerydef__setreturnsrecords)</ept> to specify whether the query returns records.","source":"Before executing a querydef that represents a SQL pass-through query to an ODBC data source, set the connection string with `SetConnect` and call [SetReturnsRecords](#cdaoquerydef__setreturnsrecords) to specify whether the query returns records."},{"content":"For more information about the connection string's structure and examples of connection string components, see the topic \"Connect Property\" in DAO Help.","pos":[32735,32887]},{"pos":[32897,32956],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__setname\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::SetName","linkify":"<a name=\"cdaoquerydef__setname\"></a>  CDaoQueryDef::SetName","source":"<a name=\"cdaoquerydef__setname\"></a>  CDaoQueryDef::SetName"},{"content":"Call this member function if you want to change the name of a querydef that is not temporary.","pos":[32960,33053]},{"pos":[33110,33120],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A string that contains the new name for a nontemporary query in the associated <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object.","pos":[33138,33282],"source":" A string that contains the new name for a nontemporary query in the associated [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object."},{"pos":[33292,33299],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Querydef names are unique, user-defined names.","pos":[33303,33349]},{"content":"You can call <ph id=\"ph1\">`SetName`</ph> before the querydef object is appended to the QueryDefs collection.","pos":[33350,33440],"source":" You can call `SetName` before the querydef object is appended to the QueryDefs collection."},{"pos":[33450,33523],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__setodbctimeout\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::SetODBCTimeout","linkify":"<a name=\"cdaoquerydef__setodbctimeout\"></a>  CDaoQueryDef::SetODBCTimeout","source":"<a name=\"cdaoquerydef__setodbctimeout\"></a>  CDaoQueryDef::SetODBCTimeout"},{"content":"Call this member function to set the time limit before a query to an ODBC data source times out.","pos":[33527,33623]},{"pos":[33689,33699],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>nODBCTimeout<ept id=\"p1\">*</ept>","pos":[33703,33717],"source":"*nODBCTimeout*"},{"content":"The number of seconds before a query times out.","pos":[33721,33768]},{"pos":[33778,33785],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This member function lets you override the default number of seconds before subsequent operations on the connected data source \"time out.\"","pos":[33789,33927]},{"content":"An operation might time out due to network access problems, excessive query processing time, and so on.","pos":[33928,34031]},{"content":"Call <ph id=\"ph1\">`SetODBCTimeout`</ph> prior to executing a query with this querydef if you want to change the query timeout value.","pos":[34032,34146],"source":" Call `SetODBCTimeout` prior to executing a query with this querydef if you want to change the query timeout value."},{"content":"(As ODBC reuses connections, the timeout value is the same for all clients on the same connection.)","pos":[34147,34246]},{"content":"The default value for query timeouts is 60 seconds.","pos":[34253,34304]},{"pos":[34314,34385],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__setparamvalue\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::SetParamValue","linkify":"<a name=\"cdaoquerydef__setparamvalue\"></a>  CDaoQueryDef::SetParamValue","source":"<a name=\"cdaoquerydef__setparamvalue\"></a>  CDaoQueryDef::SetParamValue"},{"content":"Call this member function to set the value of a parameter in the querydef at run time.","pos":[34389,34475]},{"pos":[34669,34679],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The name of the parameter whose value you want to set.","pos":[34697,34751]},{"content":"The value to set; see Remarks.","pos":[34772,34802]},{"content":"The ordinal position of the parameter in the querydef's Parameters collection.","pos":[34821,34899]},{"content":"You can obtain this value with calls to <bpt id=\"p1\">[</bpt>GetParameterCount<ept id=\"p1\">](#cdaoquerydef__getparametercount)</ept> and <bpt id=\"p2\">[</bpt>GetParameterInfo<ept id=\"p2\">](#cdaoquerydef__getparameterinfo)</ept>.","pos":[34900,35050],"source":" You can obtain this value with calls to [GetParameterCount](#cdaoquerydef__getparametercount) and [GetParameterInfo](#cdaoquerydef__getparameterinfo)."},{"pos":[35060,35067],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The parameter must already have been established as part of the querydef's SQL string.","pos":[35071,35157]},{"content":"You can access the parameter either by name or by its ordinal position in the collection.","pos":[35158,35247]},{"content":"Specify the value to set as a <ph id=\"ph1\">`COleVariant`</ph> object.","pos":[35254,35305],"source":"Specify the value to set as a `COleVariant` object."},{"content":"For information about setting the desired value and type in your <ph id=\"ph1\">`COleVariant`</ph> object, see class <bpt id=\"p1\">[</bpt>COleVariant<ept id=\"p1\">](../../mfc/reference/colevariant-class.md)</ept>.","pos":[35306,35459],"source":" For information about setting the desired value and type in your `COleVariant` object, see class [COleVariant](../../mfc/reference/colevariant-class.md)."},{"pos":[35469,35548],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__setreturnsrecords\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::SetReturnsRecords","linkify":"<a name=\"cdaoquerydef__setreturnsrecords\"></a>  CDaoQueryDef::SetReturnsRecords","source":"<a name=\"cdaoquerydef__setreturnsrecords\"></a>  CDaoQueryDef::SetReturnsRecords"},{"content":"Call this member function as part of the process of setting up a SQL pass-through query to an external database.","pos":[35552,35664]},{"pos":[35735,35745],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>bReturnsRecords<ept id=\"p1\">*</ept>","pos":[35749,35766],"source":"*bReturnsRecords*"},{"content":"Pass <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if the query on an external database returns records; otherwise, <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","pos":[35770,35859],"source":" Pass **TRUE** if the query on an external database returns records; otherwise, **FALSE**."},{"pos":[35869,35876],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"In such a case, you must create the querydef and set its properties using other <ph id=\"ph1\">`CDaoQueryDef`</ph> member functions.","pos":[35880,35992],"source":"In such a case, you must create the querydef and set its properties using other `CDaoQueryDef` member functions."},{"content":"For a description of external databases, see <bpt id=\"p1\">[</bpt>SetConnect<ept id=\"p1\">](#cdaoquerydef__setconnect)</ept>.","pos":[35993,36078],"source":" For a description of external databases, see [SetConnect](#cdaoquerydef__setconnect)."},{"pos":[36088,36145],"content":"<bpt id=\"p1\">&lt;a name=\"cdaoquerydef__setsql\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CDaoQueryDef::SetSQL","linkify":"<a name=\"cdaoquerydef__setsql\"></a>  CDaoQueryDef::SetSQL","source":"<a name=\"cdaoquerydef__setsql\"></a>  CDaoQueryDef::SetSQL"},{"content":"Call this member function to set the SQL statement that the querydef executes.","pos":[36149,36227]},{"pos":[36282,36292],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A string containing a complete SQL statement, suitable for execution.","pos":[36309,36378]},{"content":"The syntax of this string depends on the DBMS that your query targets.","pos":[36379,36449]},{"content":"For a discussion of syntax used in the Microsoft Jet database engine, see the topic \"Building SQL Statements in Code\" in DAO Help.","pos":[36450,36580]},{"pos":[36590,36597],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"A typical use of <ph id=\"ph1\">`SetSQL`</ph> is setting up a querydef object for use in a SQL pass-through query.","pos":[36601,36695],"source":"A typical use of `SetSQL` is setting up a querydef object for use in a SQL pass-through query."},{"content":"(For the syntax of SQL pass-through queries on your target DBMS, see the documentation for your DBMS.)","pos":[36696,36798]},{"pos":[36807,36815],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CObject Class<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[36819,36873],"source":"[CObject Class](../../mfc/reference/cobject-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[36876,36925],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDaoRecordset Class<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[36928,36995],"source":" [CDaoRecordset Class](../../mfc/reference/cdaorecordset-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDaoDatabase Class<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[36998,37063],"source":" [CDaoDatabase Class](../../mfc/reference/cdaodatabase-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDaoTableDef Class<ept id=\"p1\">](../../mfc/reference/cdaotabledef-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[37066,37131],"source":" [CDaoTableDef Class](../../mfc/reference/cdaotabledef-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CDaoException Class<ept id=\"p1\">](../../mfc/reference/cdaoexception-class.md)</ept>","pos":[37134,37200],"source":" [CDaoException Class](../../mfc/reference/cdaoexception-class.md)"}],"content":"---\ntitle: \"CDaoQueryDef Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDaoQueryDef\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"QueryDef objects\"\n  - \"CDaoQueryDef class\"\n  - \"queries [Visual Studio], defining\"\nms.assetid: 9676a4a3-c712-44d4-8c5d-d1cc78288d3a\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDaoQueryDef Class\nRepresents a query definition, or \"querydef,\" usually one saved in a database.  \n  \n## Syntax  \n  \n```  \nclass CDaoQueryDef : public CObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoQueryDef::CDaoQueryDef](#cdaoquerydef__cdaoquerydef)|Constructs a **CDaoQueryDef** object. Next call **Open** or **Create**, depending on your needs.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoQueryDef::Append](#cdaoquerydef__append)|Appends the querydef to the database's QueryDefs collection as a saved query.|  \n|[CDaoQueryDef::CanUpdate](#cdaoquerydef__canupdate)|Returns nonzero if the query can update the database.|  \n|[CDaoQueryDef::Close](#cdaoquerydef__close)|Closes the querydef object. Destroy the C++ object when you finish with it.|  \n|[CDaoQueryDef::Create](#cdaoquerydef__create)|Creates the underlying DAO querydef object. Use the querydef as a temporary query, or call **Append** to save it in the database.|  \n|[CDaoQueryDef::Execute](#cdaoquerydef__execute)|Executes the query defined by the querydef object.|  \n|[CDaoQueryDef::GetConnect](#cdaoquerydef__getconnect)|Returns the connection string associated with the querydef. The connection string identifies the data source. (For SQL pass-through queries only; otherwise an empty string.)|  \n|[CDaoQueryDef::GetDateCreated](#cdaoquerydef__getdatecreated)|Returns the date the saved query was created.|  \n|[CDaoQueryDef::GetDateLastUpdated](#cdaoquerydef__getdatelastupdated)|Returns the date the saved query was last updated.|  \n|[CDaoQueryDef::GetFieldCount](#cdaoquerydef__getfieldcount)|Returns the number of fields defined by the querydef.|  \n|[CDaoQueryDef::GetFieldInfo](#cdaoquerydef__getfieldinfo)|Returns information about a specified field defined in the query.|  \n|[CDaoQueryDef::GetName](#cdaoquerydef__getname)|Returns the name of the querydef.|  \n|[CDaoQueryDef::GetODBCTimeout](#cdaoquerydef__getodbctimeout)|Returns the timeout value used by ODBC (for an ODBC query) when the querydef is executed. This determines how long to allow for the query's action to complete.|  \n|[CDaoQueryDef::GetParameterCount](#cdaoquerydef__getparametercount)|Returns the number of parameters defined for the query.|  \n|[CDaoQueryDef::GetParameterInfo](#cdaoquerydef__getparameterinfo)|Returns information about a specified parameter to the query.|  \n|[CDaoQueryDef::GetParamValue](#cdaoquerydef__getparamvalue)|Returns the value of a specified parameter to the query.|  \n|[CDaoQueryDef::GetRecordsAffected](#cdaoquerydef__getrecordsaffected)|Returns the number of records affected by an action query.|  \n|[CDaoQueryDef::GetReturnsRecords](#cdaoquerydef__getreturnsrecords)|Returns nonzero if the query defined by the querydef returns records.|  \n|[CDaoQueryDef::GetSQL](#cdaoquerydef__getsql)|Returns the SQL string that specifies the query defined by the querydef.|  \n|[CDaoQueryDef::GetType](#cdaoquerydef__gettype)|Returns the query type: delete, update, append, make-table, and so on.|  \n|[CDaoQueryDef::IsOpen](#cdaoquerydef__isopen)|Returns nonzero if the querydef is open and can be executed.|  \n|[CDaoQueryDef::Open](#cdaoquerydef__open)|Opens an existing querydef stored in the database's QueryDefs collection.|  \n|[CDaoQueryDef::SetConnect](#cdaoquerydef__setconnect)|Sets the connection string for a SQL pass-through query on an ODBC data source.|  \n|[CDaoQueryDef::SetName](#cdaoquerydef__setname)|Sets the name of the saved query, replacing the name in use when the querydef was created.|  \n|[CDaoQueryDef::SetODBCTimeout](#cdaoquerydef__setodbctimeout)|Sets the timeout value used by ODBC (for an ODBC query) when the querydef is executed.|  \n|[CDaoQueryDef::SetParamValue](#cdaoquerydef__setparamvalue)|Sets the value of a specified parameter to the query.|  \n|[CDaoQueryDef::SetReturnsRecords](#cdaoquerydef__setreturnsrecords)|Specifies whether the querydef returns records. Setting this attribute to **TRUE** is only valid for SQL pass-through queries.|  \n|[CDaoQueryDef::SetSQL](#cdaoquerydef__setsql)|Sets the SQL string that specifies the query defined by the querydef.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoQueryDef::m_pDAOQueryDef](#cdaoquerydef__m_pdaoquerydef)|A pointer to the OLE interface for the underlying DAO querydef object.|  \n|[CDaoQueryDef::m_pDatabase](#cdaoquerydef__m_pdatabase)|A pointer to the `CDaoDatabase` object with which the querydef is associated. The querydef might be saved in the database or not.|  \n  \n## Remarks  \n A querydef is a data access object that contains the SQL statement that describes a query, and its properties, such as \"Date Created\" and \"ODBC Timeout.\" You can also create temporary querydef objects without saving them, but it is convenient — and much more efficient — to save commonly reused queries in a database. A [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object maintains a collection, called the QueryDefs collection, that contains its saved querydefs.  \n  \n> [!NOTE]\n>  The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC; the DAO-based classes can access data, including through ODBC drivers, via their own database engine. The DAO-based classes also support Data Definition Language (DDL) operations, such as adding tables via the classes, without having to call DAO directly.  \n  \n## Usage  \n Use querydef objects either to work with an existing saved query or to create a new saved query or temporary query:  \n  \n1.  In all cases, first construct a `CDaoQueryDef` object, supplying a pointer to the [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object to which the query belongs.  \n  \n2.  Then do the following, depending on what you want:  \n  \n    -   To use an existing saved query, call the querydef object's [Open](#cdaoquerydef__open) member function, supplying the name of the saved query.  \n  \n    -   To create a new saved query, call the querydef object's [Create](#cdaoquerydef__create) member function, supplying the name of the query. Then call [Append](#cdaoquerydef__append) to save the query by appending it to the database's QueryDefs collection. **Create** puts the querydef into an open state, so after calling **Create** you do not call **Open**.  \n  \n    -   To create a temporary querydef, call **Create**. Pass an empty string for the query name. Do not call **Append**.  \n  \n When you finish using a querydef object, call its [Close](#cdaoquerydef__close) member function; then destroy the querydef object.  \n  \n> [!TIP]\n>  The easiest way to create saved queries is to create them and store them in your database using Microsoft Access. Then you can open and use them in your MFC code.  \n  \n## Purposes  \n You can use a querydef object for any of the following purposes:  \n  \n-   To create a `CDaoRecordset` object  \n  \n-   To call the object's **Execute** member function to directly execute an action query or a SQL pass-through query  \n  \n You can use a querydef object for any type of query, including select, action, crosstab, delete, update, append, make-table, data definition, SQL pass-through, union, and bulk queries. The query's type is determined by the content of the SQL statement that you supply. For information about query types, see the **Execute** and [GetType](#cdaoquerydef__gettype) member functions. Recordsets are commonly used for row-returning queries, usually those using the **SELECT ... FROM** keywords. **Execute** is most commonly used for bulk operations. For more information, see [Execute](#cdaoquerydef__execute) and [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md).  \n  \n## Querydefs and Recordsets  \n To use a querydef object to create a `CDaoRecordset` object, you typically create or open a querydef as described above. Then construct a recordset object, passing a pointer to your querydef object when you call [CDaoRecordset::Open](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__open). The querydef you pass must be in an open state. For more information, see class [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md).  \n  \n You cannot use a querydef to create a recordset (the most common use for a querydef) unless it is in an open state. Put the querydef into an open state by calling either **Open** or **Create**.  \n  \n## External Databases  \n Querydef objects are the preferred way to use the native SQL dialect of an external database engine. For example, you can create a Transact SQL query (as used on Microsoft SQL Server) and store it in a querydef object. When you need to use a SQL query not based on the Microsoft Jet database engine, you must provide a connection string that points to the external data source. Queries with valid connection strings bypass the database engine and pass the query directly to the external database server for processing.  \n  \n> [!TIP]\n>  The preferred way to work with ODBC tables is to attach them to a Microsoft Jet (.MDB) database.  \n  \n For related information, see the topics \"QueryDef Object\", \"QueryDefs Collection\", and \"CdbDatabase Object\" in the DAO SDK.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n `CDaoQueryDef`  \n  \n## Requirements  \n **Header:** afxdao.h  \n  \n##  <a name=\"cdaoquerydef__append\"></a>  CDaoQueryDef::Append  \n Call this member function after you call [Create](#cdaoquerydef__create) to create a new querydef object.  \n  \n```  \nvirtual void Append();\n```  \n  \n### Remarks  \n **Append** saves the querydef in the database by appending the object to the database's QueryDefs collection. You can use the querydef as a temporary object without appending it, but if you want it to persist, you must call **Append**.  \n  \n If you attempt to append a temporary querydef object, MFC throws an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md).  \n  \n##  <a name=\"cdaoquerydef__canupdate\"></a>  CDaoQueryDef::CanUpdate  \n Call this member function to determine whether you can modify the querydef — such as changing its name or SQL string.  \n  \n```  \nBOOL CanUpdate();\n```  \n  \n### Return Value  \n Nonzero if you are permitted to modify the querydef; otherwise 0.  \n  \n### Remarks  \n You can modify the querydef if:  \n  \n-   It is not based on a database that is open read-only.  \n  \n-   You have update permissions for the database.  \n  \n     This depends on whether you have implemented security features. MFC does not provide support for security; you must implement it yourself by calling DAO directly or by using Microsoft Access. See the topic \"Permissions Property\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__cdaoquerydef\"></a>  CDaoQueryDef::CDaoQueryDef  \n Constructs a **CDaoQueryDef** object.  \n  \n```  \nCDaoQueryDef(CDaoDatabase* pDatabase);\n```  \n  \n### Parameters  \n `pDatabase`  \n A pointer to an open [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object.  \n  \n### Remarks  \n The object can represent an existing querydef stored in the database's QueryDefs collection, a new query to be stored in the collection, or a temporary query, not to be stored. Your next step depends on the type of querydef:  \n  \n-   If the object represents an existing querydef, call the object's [Open](#cdaoquerydef__open) member function to initialize it.  \n  \n-   If the object represents a new querydef to be saved, call the object's [Create](#cdaoquerydef__create) member function. This adds the object to the database's QueryDefs collection. Then call `CDaoQueryDef` member functions to set the object's attributes. Finally, call [Append](#cdaoquerydef__append).  \n  \n-   If the object represents a temporary querydef (not to be saved in the database), call **Create**, passing an empty string for the query's name. After calling **Create**, initialize the querydef by directly setting its attributes. Do not call **Append**.  \n  \n To set the attributes of the querydef, you can use the [SetName](#cdaoquerydef__setname), [SetSQL](#cdaoquerydef__setsql), [SetConnect](#cdaoquerydef__setconnect), [SetODBCTimeout](#cdaoquerydef__setodbctimeout), and [SetReturnsRecords](#cdaoquerydef__setreturnsrecords) member functions.  \n  \n When you finish with the querydef object, call its [Close](#cdaoquerydef__close) member function. If you have a pointer to the querydef, use the **delete** operator to destroy the C++ object.  \n  \n##  <a name=\"cdaoquerydef__close\"></a>  CDaoQueryDef::Close  \n Call this member function when you finish using the querydef object.  \n  \n```  \nvirtual void Close();\n```  \n  \n### Remarks  \n Closing the querydef releases the underlying DAO object but does not destroy the saved DAO querydef object or the C++ `CDaoQueryDef` object. This is not the same as [CDaoDatabase::DeleteQueryDef](../../mfc/reference/cdaodatabase-class.md#cdaodatabase__deletequerydef), which deletes the querydef from the database's QueryDefs collection in DAO (if not a temporary querydef).  \n  \n##  <a name=\"cdaoquerydef__create\"></a>  CDaoQueryDef::Create  \n Call this member function to create a new saved query or a new temporary query.  \n  \n```  \nvirtual void Create(\n    LPCTSTR lpszName = NULL,  \n    LPCTSTR lpszSQL = NULL);\n```  \n  \n### Parameters  \n `lpszName`  \n The unique name of the query saved in the database. For details about the string, see the topic \"CreateQueryDef Method\" in DAO Help. If you accept the default value, an empty string, a temporary querydef is created. Such a query is not saved in the QueryDefs collection.  \n  \n `lpszSQL`  \n The SQL string that defines the query. If you accept the default value of **NULL**, you must later call [SetSQL](#cdaoquerydef__setsql) to set the string. Until then, the query is undefined. You can, however, use the undefined query to open a recordset; see Remarks for details. The SQL statement must be defined before you can append the querydef to the QueryDefs collection.  \n  \n### Remarks  \n If you pass a name in `lpszName`, you can then call [Append](#cdaoquerydef__append) to save the querydef in the database's QueryDefs collection. Otherwise, the object is a temporary querydef and is not saved. In either case, the querydef is in an open state, and you can either use it to create a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object or call the querydef's [Execute](#cdaoquerydef__execute) member function.  \n  \n If you do not supply a SQL statement in `lpszSQL`, you cannot run the query with **Execute** but you can use it to create a recordset. In that case, MFC uses the recordset's default SQL statement.  \n  \n##  <a name=\"cdaoquerydef__execute\"></a>  CDaoQueryDef::Execute  \n Call this member function to run the query defined by the querydef object.  \n  \n```  \nvirtual void Execute(int nOptions = dbFailOnError);\n```  \n  \n### Parameters  \n `nOptions`  \n An integer that determines the characteristics of the query. For related information, see the topic \"Execute Method\" in DAO Help. You can use the bitwise-OR operator ( **&#124;**) to combine the following constants for this argument:  \n  \n- **dbDenyWrite** Deny write permission to other users.  \n  \n- **dbInconsistent** Inconsistent updates.  \n  \n- **dbConsistent** Consistent updates.  \n  \n- **dbSQLPassThrough** SQL pass-through. Causes the SQL statement to be passed to an ODBC database for processing.  \n  \n- **dbFailOnError** Default value. Roll back updates if an error occurs and report the error to the user.  \n  \n- **dbSeeChanges** Generate a run-time error if another user is changing data you are editing.  \n  \n> [!NOTE]\n>  For an explanation of the terms \"inconsistent\" and \"consistent,\" see the topic \"Execute Method\" in DAO Help.  \n  \n### Remarks  \n Querydef objects used for execution in this manner can only represent one of the following query types:  \n  \n-   Action queries  \n  \n-   SQL pass-through queries  \n  \n **Execute** does not work for queries that return records, such as select queries. **Execute** is commonly used for bulk operation queries, such as **UPDATE**, **INSERT**, or **SELECT INTO**, or for data definition language (DDL) operations.  \n  \n> [!TIP]\n>  The preferred way to work with ODBC data sources is to attach tables to a Microsoft Jet (.MDB) database. For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.  \n  \n Call the [GetRecordsAffected](#cdaoquerydef__getrecordsaffected) member function of the querydef object to determine the number of records affected by the most recent **Execute** call. For example, `GetRecordsAffected` returns information about the number of records deleted, updated, or inserted when executing an action query. The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.  \n  \n If you include both **dbInconsistent** and **dbConsistent** or if you include neither, the result is the default, **dbInconsistent**.  \n  \n **Execute** does not return a recordset. Using **Execute** on a query that selects records causes MFC to throw an exception of type [CDaoException](../../mfc/reference/cdaoexception-class.md).  \n  \n##  <a name=\"cdaoquerydef__getconnect\"></a>  CDaoQueryDef::GetConnect  \n Call this member function to get the connection string associated with the querydef's data source.  \n  \n```  \nCString GetConnect();\n```  \n  \n### Return Value  \n A [CString](../../atl-mfc-shared/reference/cstringt-class.md) containing the connection string for the querydef.  \n  \n### Remarks  \n This function is used only with ODBC data sources and certain ISAM drivers. It is not used with Microsoft Jet (.MDB) databases; in this case, `GetConnect` returns an empty string. For more information, see [SetConnect](#cdaoquerydef__setconnect).  \n  \n> [!TIP]\n>  The preferred way to work with ODBC tables is to attach them to an .MDB database. For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.  \n  \n For information about connection strings, see the topic \"Connect Property\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getdatecreated\"></a>  CDaoQueryDef::GetDateCreated  \n Call this member function to get the date the querydef object was created.  \n  \n```  \nCOleDateTime GetDateCreated();\n```  \n  \n### Return Value  \n A [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object containing the date and time the querydef was created.  \n  \n### Remarks  \n For related information, see the topic \"DateCreated, LastUpdated Properties\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getdatelastupdated\"></a>  CDaoQueryDef::GetDateLastUpdated  \n Call this member function to get the date the querydef object was last updated — when any of its properties were changed, such as its name, its SQL string, or its connection string.  \n  \n```  \nCOleDateTime GetDateLastUpdated();\n```  \n  \n### Return Value  \n A [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object containing the date and time the querydef was last updated.  \n  \n### Remarks  \n For related information, see the topic \"DateCreated, LastUpdated Properties\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getfieldcount\"></a>  CDaoQueryDef::GetFieldCount  \n Call this member function to retrieve the number of fields in the query.  \n  \n```  \nshort GetFieldCount();\n```  \n  \n### Return Value  \n The number of fields defined in the query.  \n  \n### Remarks  \n `GetFieldCount` is useful for looping through all fields in the querydef. For that purpose, use `GetFieldCount` in conjunction with [GetFieldInfo](#cdaoquerydef__getfieldinfo).  \n  \n##  <a name=\"cdaoquerydef__getfieldinfo\"></a>  CDaoQueryDef::GetFieldInfo  \n Call this member function to obtain various kinds of information about a field defined in the querydef.  \n  \n```  \nvoid GetFieldInfo(\n    int nIndex,  \n    CDaoFieldInfo& fieldinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n\n \nvoid GetFieldInfo(\n    LPCTSTR lpszName,  \n    CDaoFieldInfo& fieldinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n```  \n  \n### Parameters  \n `nIndex`  \n The zero-based index of the desired field in the querydef's Fields collection, for lookup by index.  \n  \n `fieldinfo`  \n A reference to a `CDaoFieldInfo` object that returns the information requested.  \n  \n `dwInfoOptions`  \n Options that specify which information about the field to retrieve. The available options are listed here along with what they cause the function to return:  \n  \n- `AFX_DAO_PRIMARY_INFO` (Default) Name, Type, Size, Attributes  \n  \n- `AFX_DAO_SECONDARY_INFO` Primary information plus: Ordinal Position, Required, Allow Zero Length, Source Field, Foreign Name, Source Table, Collating Order  \n  \n- `AFX_DAO_ALL_INFO` Primary and secondary information plus: Default Value, Validation Text, Validation Rule  \n  \n `lpszName`  \n A string containing the name of the desired field, for lookup by name. You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md).  \n  \n### Remarks  \n For a description of the information returned in `fieldinfo`, see the [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) structure. This structure has members that correspond to the descriptive information under `dwInfoOptions` above. If you request one level of information, you get any prior levels of information as well.  \n  \n##  <a name=\"cdaoquerydef__getname\"></a>  CDaoQueryDef::GetName  \n Call this member function to retrieve the name of the query represented by the querydef.  \n  \n```  \nCString GetName();\n```  \n  \n### Return Value  \n The name of the query.  \n  \n### Remarks  \n Querydef names are unique user-defined names. For more information about querydef names, see the topic \"Name Property\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getodbctimeout\"></a>  CDaoQueryDef::GetODBCTimeout  \n Call this member function to retrieve the current time limit before a query to an ODBC data source times out.  \n  \n```  \nshort GetODBCTimeout();\n```  \n  \n### Return Value  \n The number of seconds before a query times out.  \n  \n### Remarks  \n For information about this time limit, see the topic \"ODBCTimeout Property\" in DAO Help.  \n  \n> [!TIP]\n>  The preferred way to work with ODBC tables is to attach them to a Microsoft Jet (.MDB) database. For more information, see the topic \"Accessing External Databases with DAO\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getparametercount\"></a>  CDaoQueryDef::GetParameterCount  \n Call this member function to retrieve the number of parameters in the saved query.  \n  \n```  \nshort GetParameterCount();\n```  \n  \n### Return Value  \n The number of parameters defined in the query.  \n  \n### Remarks  \n `GetParameterCount` is useful for looping through all parameters in the querydef. For that purpose, use `GetParameterCount` in conjunction with [GetParameterInfo](#cdaoquerydef__getparameterinfo).  \n  \n For related information, see the topics \"Parameter Object\", \"Parameters Collection\", and \"PARAMETERS Declaration (SQL)\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getparameterinfo\"></a>  CDaoQueryDef::GetParameterInfo  \n Call this member function to obtain information about a parameter defined in the querydef.  \n  \n```  \nvoid GetParameterInfo(\n    int nIndex,  \n    CDaoParameterInfo& paraminfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n\n \nvoid GetParameterInfo(\n    LPCTSTR lpszName,  \n    CDaoParameterInfo& paraminfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n```  \n  \n### Parameters  \n `nIndex`  \n The zero-based index of the desired parameter in the querydef's Parameters collection, for lookup by index.  \n  \n `paraminfo`  \n A reference to a [CDaoParameterInfo](../../mfc/reference/cdaoparameterinfo-structure.md) object that returns the information requested.  \n  \n `dwInfoOptions`  \n Options that specify which information about the parameter to retrieve. The available option is listed here along with what it causes the function to return:  \n  \n- `AFX_DAO_PRIMARY_INFO` (Default) Name, Type  \n  \n `lpszName`  \n A string containing the name of the desired parameter, for lookup by name. You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md).  \n  \n### Remarks  \n For a description of the information returned in `paraminfo`, see the [CDaoParameterInfo](../../mfc/reference/cdaoparameterinfo-structure.md) structure. This structure has members that correspond to the descriptive information under `dwInfoOptions` above.  \n  \n For related information, see the topic \"PARAMETERS Declaration (SQL)\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getparamvalue\"></a>  CDaoQueryDef::GetParamValue  \n Call this member function to retrieve the current value of the specified parameter stored in the querydef's Parameters collection.  \n  \n```  \nvirtual COleVariant GetParamValue(LPCTSTR lpszName);\n\n \nvirtual COleVariant GetParamValue(int nIndex);\n```  \n  \n### Parameters  \n `lpszName`  \n The name of the parameter whose value you want, for lookup by name.  \n  \n `nIndex`  \n The zero-based index of the parameter in the querydef's Parameters collection, for lookup by index. You can obtain this value with calls to [GetParameterCount](#cdaoquerydef__getparametercount) and [GetParameterInfo](#cdaoquerydef__getparameterinfo).  \n  \n### Return Value  \n An object of class [COleVariant](../../mfc/reference/colevariant-class.md) that contains the parameter's value.  \n  \n### Remarks  \n You can access the parameter either by name or by its ordinal position in the collection.  \n  \n For related information, see the topic \"PARAMETERS Declaration (SQL)\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getrecordsaffected\"></a>  CDaoQueryDef::GetRecordsAffected  \n Call this member function to determine how many records were affected by the last call of [Execute](#cdaoquerydef__execute).  \n  \n```  \nlong GetRecordsAffected();\n```  \n  \n### Return Value  \n The number of records affected.  \n  \n### Remarks  \n The count returned will not reflect changes in related tables when cascade updates or deletes are in effect.  \n  \n For related information see the topic \"RecordsAffected Property\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getreturnsrecords\"></a>  CDaoQueryDef::GetReturnsRecords  \n Call this member function to determine whether the querydef is based on a query that returns records.  \n  \n```  \nBOOL GetReturnsRecords();\n```  \n  \n### Return Value  \n Nonzero if the querydef is based on a query that returns records; otherwise 0.  \n  \n### Remarks  \n This member function is only used for SQL pass-through queries. For more information about SQL queries, see the [Execute](#cdaoquerydef__execute) member function. For more information about working with SQL pass-through queries, see the [SetReturnsRecords](#cdaoquerydef__setreturnsrecords) member function.  \n  \n For related information, see the topic \"ReturnsRecords Property\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__getsql\"></a>  CDaoQueryDef::GetSQL  \n Call this member function to retrieve the SQL statement that defines the query on which the querydef is based.  \n  \n```  \nCString GetSQL();\n```  \n  \n### Return Value  \n The SQL statement that defines the query on which the querydef is based.  \n  \n### Remarks  \n You will then probably parse the string for keywords, table names, and so on.  \n  \n For related information, see the topics \"SQL Property\", \"Comparison of Microsoft Jet Database Engine SQL and ANSI SQL\", and \"Querying a Database with SQL in Code\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__gettype\"></a>  CDaoQueryDef::GetType  \n Call this member function to determine the query type of the querydef.  \n  \n```  \nshort GetType();\n```  \n  \n### Return Value  \n The type of the query defined by the querydef. For values, see Remarks.  \n  \n### Remarks  \n The query type is set by what you specify in the querydef's SQL string when you create the querydef or call an existing querydef's [SetSQL](#cdaoquerydef__setsql) member function. The query type returned by this function can be one of the following values:  \n  \n- **dbQSelect** Select  \n  \n- **dbQAction** Action  \n  \n- **dbQCrosstab** Crosstab  \n  \n- **dbQDelete** Delete  \n  \n- **dbQUpdate** Update  \n  \n- **dbQAppend** Append  \n  \n- **dbQMakeTable** Make-table  \n  \n- **dbQDDL** Data-definition  \n  \n- **dbQSQLPassThrough** Pass-through  \n  \n- **dbQSetOperation** Union  \n  \n- **dbQSPTBulk** Used with **dbQSQLPassThrough** to specify a query that does not return records.  \n  \n> [!NOTE]\n>  To create a SQL pass-through query, don't set the **dbSQLPassThrough** constant. This is set automatically by the Microsoft Jet database engine when you create a querydef object and set the connection string.  \n  \n For information about SQL strings, see [GetSQL](#cdaoquerydef__getsql). For information about query types, see [Execute](#cdaoquerydef__execute).  \n  \n##  <a name=\"cdaoquerydef__isopen\"></a>  CDaoQueryDef::IsOpen  \n Call this member function to determine whether the `CDaoQueryDef` object is currently open.  \n  \n```  \nBOOL IsOpen() const;\n\n \n```  \n  \n### Return Value  \n Nonzero if the `CDaoQueryDef` object is currently open; otherwise 0.  \n  \n### Remarks  \n A querydef must be in an open state before you use it to call [Execute](#cdaoquerydef__execute) or to create a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object. To put a querydef into an open state call either [Create](#cdaoquerydef__create) (for a new querydef) or [Open](#cdaoquerydef__open) (for an existing querydef).  \n  \n##  <a name=\"cdaoquerydef__m_pdatabase\"></a>  CDaoQueryDef::m_pDatabase  \n Contains a pointer to the [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object associated with the querydef object.  \n  \n### Remarks  \n Use this pointer if you need to access the database directly — for example, to obtain pointers to other querydef or recordset objects in the database's collections.  \n  \n##  <a name=\"cdaoquerydef__m_pdaoquerydef\"></a>  CDaoQueryDef::m_pDAOQueryDef  \n Contains a pointer to the OLE interface for the underlying DAO querydef object.  \n  \n### Remarks  \n This pointer is provided for completeness and consistency with the other classes. However, because MFC rather fully encapsulates DAO querydefs, you are unlikely to need it. If you do use it, do so cautiously — in particular, do not change the value of the pointer unless you know what you are doing.  \n  \n##  <a name=\"cdaoquerydef__open\"></a>  CDaoQueryDef::Open  \n Call this member function to open a querydef previously saved in the database's QueryDefs collection.  \n  \n```  \nvirtual void Open(LPCTSTR lpszName = NULL);\n```  \n  \n### Parameters  \n `lpszName`  \n A string that contains the name of the saved querydef to open. You can use a [CString](../../atl-mfc-shared/reference/cstringt-class.md).  \n  \n### Remarks  \n Once the querydef is open, you can call its [Execute](#cdaoquerydef__execute) member function or use the querydef to create a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object.  \n  \n##  <a name=\"cdaoquerydef__setconnect\"></a>  CDaoQueryDef::SetConnect  \n Call this member function to set the querydef object's connection string.  \n  \n```  \nvoid SetConnect(LPCTSTR lpszConnect);\n```  \n  \n### Parameters  \n `lpszConnect`  \n A string that contains a connection string for the associated [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object.  \n  \n### Remarks  \n The connection string is used to pass additional information to ODBC and certain ISAM drivers as needed. It is not used for Microsoft Jet (.MDB) databases.  \n  \n> [!TIP]\n>  The preferred way to work with ODBC tables is to attach them to an .MDB database.  \n  \n Before executing a querydef that represents a SQL pass-through query to an ODBC data source, set the connection string with `SetConnect` and call [SetReturnsRecords](#cdaoquerydef__setreturnsrecords) to specify whether the query returns records.  \n  \n For more information about the connection string's structure and examples of connection string components, see the topic \"Connect Property\" in DAO Help.  \n  \n##  <a name=\"cdaoquerydef__setname\"></a>  CDaoQueryDef::SetName  \n Call this member function if you want to change the name of a querydef that is not temporary.  \n  \n```  \nvoid SetName(LPCTSTR lpszName);\n```  \n  \n### Parameters  \n `lpszName`  \n A string that contains the new name for a nontemporary query in the associated [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object.  \n  \n### Remarks  \n Querydef names are unique, user-defined names. You can call `SetName` before the querydef object is appended to the QueryDefs collection.  \n  \n##  <a name=\"cdaoquerydef__setodbctimeout\"></a>  CDaoQueryDef::SetODBCTimeout  \n Call this member function to set the time limit before a query to an ODBC data source times out.  \n  \n```  \nvoid SetODBCTimeout(short nODBCTimeout);\n```  \n  \n### Parameters  \n *nODBCTimeout*  \n The number of seconds before a query times out.  \n  \n### Remarks  \n This member function lets you override the default number of seconds before subsequent operations on the connected data source \"time out.\" An operation might time out due to network access problems, excessive query processing time, and so on. Call `SetODBCTimeout` prior to executing a query with this querydef if you want to change the query timeout value. (As ODBC reuses connections, the timeout value is the same for all clients on the same connection.)  \n  \n The default value for query timeouts is 60 seconds.  \n  \n##  <a name=\"cdaoquerydef__setparamvalue\"></a>  CDaoQueryDef::SetParamValue  \n Call this member function to set the value of a parameter in the querydef at run time.  \n  \n```  \nvirtual void SetParamValue(\n    LPCTSTR lpszName,  \n    const COleVariant& varValue);\n\n \nvirtual void SetParamValue(\n    int nIndex,  \n    const COleVariant& varValue);\n```  \n  \n### Parameters  \n `lpszName`  \n The name of the parameter whose value you want to set.  \n  \n `varValue`  \n The value to set; see Remarks.  \n  \n `nIndex`  \n The ordinal position of the parameter in the querydef's Parameters collection. You can obtain this value with calls to [GetParameterCount](#cdaoquerydef__getparametercount) and [GetParameterInfo](#cdaoquerydef__getparameterinfo).  \n  \n### Remarks  \n The parameter must already have been established as part of the querydef's SQL string. You can access the parameter either by name or by its ordinal position in the collection.  \n  \n Specify the value to set as a `COleVariant` object. For information about setting the desired value and type in your `COleVariant` object, see class [COleVariant](../../mfc/reference/colevariant-class.md).  \n  \n##  <a name=\"cdaoquerydef__setreturnsrecords\"></a>  CDaoQueryDef::SetReturnsRecords  \n Call this member function as part of the process of setting up a SQL pass-through query to an external database.  \n  \n```  \nvoid SetReturnsRecords(BOOL bReturnsRecords);\n```  \n  \n### Parameters  \n *bReturnsRecords*  \n Pass **TRUE** if the query on an external database returns records; otherwise, **FALSE**.  \n  \n### Remarks  \n In such a case, you must create the querydef and set its properties using other `CDaoQueryDef` member functions. For a description of external databases, see [SetConnect](#cdaoquerydef__setconnect).  \n  \n##  <a name=\"cdaoquerydef__setsql\"></a>  CDaoQueryDef::SetSQL  \n Call this member function to set the SQL statement that the querydef executes.  \n  \n```  \nvoid SetSQL(LPCTSTR lpszSQL);\n```  \n  \n### Parameters  \n `lpszSQL`  \n A string containing a complete SQL statement, suitable for execution. The syntax of this string depends on the DBMS that your query targets. For a discussion of syntax used in the Microsoft Jet database engine, see the topic \"Building SQL Statements in Code\" in DAO Help.  \n  \n### Remarks  \n A typical use of `SetSQL` is setting up a querydef object for use in a SQL pass-through query. (For the syntax of SQL pass-through queries on your target DBMS, see the documentation for your DBMS.)  \n  \n## See Also  \n [CObject Class](../../mfc/reference/cobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CDaoRecordset Class](../../mfc/reference/cdaorecordset-class.md)   \n [CDaoDatabase Class](../../mfc/reference/cdaodatabase-class.md)   \n [CDaoTableDef Class](../../mfc/reference/cdaotabledef-class.md)   \n [CDaoException Class](../../mfc/reference/cdaoexception-class.md)\n"}