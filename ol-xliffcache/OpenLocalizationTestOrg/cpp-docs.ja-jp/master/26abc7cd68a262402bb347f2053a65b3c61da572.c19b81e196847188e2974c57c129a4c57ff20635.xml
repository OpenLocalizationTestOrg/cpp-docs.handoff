{"nodes":[{"pos":[12,66],"content":"TN057: Localization of MFC Components | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"TN057: Localization of MFC Components | Microsoft Docs","pos":[0,54]}]},{"content":"TN057: Localization of MFC Components","pos":[899,936]},{"pos":[939,1254],"content":"[!NOTE]\n The following technical note has not been updated since it was first included in the online documentation. As a result, some procedures and topics might be out of date or incorrect. For the latest information, it is recommended that you search for the topic of interest in the online documentation index.","leadings":["","> "],"nodes":[{"content":" The following technical note has not been updated since it was first included in the online documentation. As a result, some procedures and topics might be out of date or incorrect. For the latest information, it is recommended that you search for the topic of interest in the online documentation index.","pos":[8,313],"nodes":[{"content":"The following technical note has not been updated since it was first included in the online documentation.","pos":[1,107]},{"content":"As a result, some procedures and topics might be out of date or incorrect.","pos":[108,182]},{"content":"For the latest information, it is recommended that you search for the topic of interest in the online documentation index.","pos":[183,305]}]}]},{"content":"This note describes some of the designs and procedures you can use to localize your component, if it an application or an OLE control or a DLL that uses MFC.","pos":[1261,1418]},{"content":"Overview","pos":[1427,1435]},{"content":"There are really two issues to resolve when localizing a component that uses MFC.","pos":[1439,1520]},{"content":"First, you must localize your own resources — strings, dialogs, and other resources that are specific to your component.","pos":[1521,1641]},{"content":"Most components built using MFC also include and use a number of resources that are defined by MFC.","pos":[1642,1741]},{"content":"You must provide localized MFC resources as well.","pos":[1742,1791]},{"content":"Fortunately, several languages are already provided by MFC itself.","pos":[1792,1858]},{"content":"In addition, your component should be prepared to run in its target environment (European or DBCS-enabled environment).","pos":[1865,1984]},{"content":"For the most part, this depends on your application treating characters with the high bit set correctly and handling strings with double byte characters.","pos":[1985,2138]},{"content":"MFC is enabled, by default, for both of these environments, such that it is possible to have a single worldwide binary that is used on all platforms with just different resources plugged in at setup time.","pos":[2139,2343]},{"content":"Localizing your Component's Resources","pos":[2352,2389]},{"content":"Localizing your application or DLL should involve simply replacing the resources with resources that match the target language.","pos":[2393,2520]},{"content":"For your own resources, this is relatively simple: edit the resources in the resource editor and build your application.","pos":[2521,2641]},{"content":"If your code is written properly there will be no strings or text that you wish to localize hard-coded into your C++ source code – all localization can be done by simply modifying resources.","pos":[2642,2832]},{"content":"In fact, you can implement your component such that all providing a localized version does not even involve a build of the original code.","pos":[2833,2970]},{"content":"This is more complex, but is well worth it and is the mechanism chosen for MFC itself.","pos":[2971,3057]},{"content":"It is also possible to localize an application by loading the EXE or DLL file into the resource editor and editing the resources directly.","pos":[3058,3196]},{"content":"While possible, it requires reapplication of those changes each time you build a new version of your application.","pos":[3197,3310]},{"content":"One way to avoid that is to locate all resources in a separate DLL, sometimes called a satellite DLL.","pos":[3317,3418]},{"content":"This DLL is then loaded dynamically at runtime and the resources are loaded from that DLL instead of from the main module with all your code.","pos":[3419,3560]},{"content":"MFC directly supports this approach.","pos":[3561,3597]},{"content":"Consider an application called MYAPP.EXE; it could have all of its resources located in a DLL called MYRES.DLL.","pos":[3598,3709]},{"content":"In the application's <ph id=\"ph1\">`InitInstance`</ph> it would perform the following to load that DLL and cause MFC to load resources from that location:","pos":[3710,3845],"source":" In the application's `InitInstance` it would perform the following to load that DLL and cause MFC to load resources from that location:"},{"content":"From then on, MFC will load resources from that DLL instead of from myapp.exe.","pos":[4114,4192]},{"content":"All resources, however, must be present in that DLL; MFC will not search the application's instance in search of a given resource.","pos":[4193,4323]},{"content":"This technique applies equally well to regular DLLs as well as OLE Controls.","pos":[4324,4400]},{"content":"Your setup program would copy the appropriate version of MYRES.DLL depending upon which resource locale the user would like.","pos":[4401,4525]},{"content":"It is relatively easy to create a resource only DLL.","pos":[4532,4584]},{"content":"You create a DLL project, add your .RC file to it, and add the necessary resources.","pos":[4585,4668]},{"content":"If you have an existing project that does not use this technique, you can copy the resources from that project.","pos":[4669,4780]},{"content":"After adding the resource file to the project, you are almost ready to build the project.","pos":[4781,4870]},{"content":"The only thing you must do is set the linker options to include <bpt id=\"p1\">**</bpt>/NOENTRY<ept id=\"p1\">**</ept>.","pos":[4871,4948],"source":" The only thing you must do is set the linker options to include **/NOENTRY**."},{"content":"This tells the linker that the DLL has no entry point – since it has no code, it has no entry point.","pos":[4949,5049]},{"pos":[5057,5341],"content":"[!NOTE]\n The resource editor in Visual C++ 4.0 and later supports multiple languages per .RC file. This can make it very easy to manage your localization in a single project. The resources for each language are controlled by preprocessor directives generated by the resource editor.","leadings":["","> "],"nodes":[{"content":" The resource editor in Visual C++ 4.0 and later supports multiple languages per .RC file. This can make it very easy to manage your localization in a single project. The resources for each language are controlled by preprocessor directives generated by the resource editor.","pos":[8,282],"nodes":[{"content":"The resource editor in Visual C++ 4.0 and later supports multiple languages per .RC file.","pos":[1,90]},{"content":"This can make it very easy to manage your localization in a single project.","pos":[91,166]},{"content":"The resources for each language are controlled by preprocessor directives generated by the resource editor.","pos":[167,274]}]}]},{"content":"Using the Provided MFC Localized Resources","pos":[5350,5392]},{"content":"Any MFC application that you build reuses two things from MFC: code and resources.","pos":[5396,5478]},{"content":"That is, MFC has various error messages, built-in dialogs, and other resources that are used by the MFC classes.","pos":[5479,5591]},{"content":"In order to completely localize your application, you need to localize not only your application's resources, but also the resources that come directly from MFC.","pos":[5592,5753]},{"content":"MFC provides a number of different language resource files automatically, so that if the language you are targeting is one of the languages MFC already supports, you just need to make sure you use those localized resources.","pos":[5754,5977]},{"content":"As of this writing, MFC supports Chinese, German, Spanish, French, Italian, Japanese, and Korean.","pos":[5984,6081]},{"content":"The files which contain these localized versions are in the MFC\\INCLUDE\\L.* (the 'L' stands for localized) directories.","pos":[6082,6201]},{"content":"The German files are in MFC\\INCLUDE\\L.DEU, for example.","pos":[6202,6257]},{"content":"To cause your application to use these RC files instead of the files located in MFC\\INCLUDE, add a <ph id=\"ph1\">`/IC:\\PROGRAM FILES\\MICROSOFT VISUAL STUDIO .NET 2003\\VC7\\MFC\\INCLUDE\\L.DEU`</ph> to your RC command line (this is just an example; you would need to substitute your locale of choice as well as the directory into which you installed Visual C++).","pos":[6258,6597],"source":" To cause your application to use these RC files instead of the files located in MFC\\INCLUDE, add a `/IC:\\PROGRAM FILES\\MICROSOFT VISUAL STUDIO .NET 2003\\VC7\\MFC\\INCLUDE\\L.DEU` to your RC command line (this is just an example; you would need to substitute your locale of choice as well as the directory into which you installed Visual C++)."},{"content":"The above instructions will work if your application links statically with MFC.","pos":[6604,6683]},{"content":"Most applications link dynamically (because that is the AppWizard default).","pos":[6684,6759]},{"content":"In this scenario, not only the code is dynamically linked – so are the resources.","pos":[6760,6841]},{"content":"As a result, you can localize your resources in your application, but the MFC implementation resources will still be loaded from the MFC7x.DLL (or a later version) or from MFC7xLOC.DLL if it exists.","pos":[6842,7040]},{"content":"You can approach this from two different angles.","pos":[7041,7089]},{"content":"The more complex approach is to ship one of the localized MFC7xLOC.DLLs (such as MFC7xDEU, for German, MFC7xESP.DLL for Spanish, etc.), or a later version, and install the appropriate MFC7xLOC.DLL into the system directory when the user installs your application.","pos":[7096,7359]},{"content":"This can be very complex for both the developer and the end user and as such is not recommended.","pos":[7360,7456]},{"content":"See <bpt id=\"p1\">[</bpt>Technical Note 56<ept id=\"p1\">](../mfc/tn056-installation-of-localized-mfc-components.md)</ept> for more information on this technique and its caveats.","pos":[7457,7594],"source":" See [Technical Note 56](../mfc/tn056-installation-of-localized-mfc-components.md) for more information on this technique and its caveats."},{"content":"The simplest and safest approach is to include the localized MFC resources in your application or DLL itself (or its satellite DLL if you are using one).","pos":[7601,7754]},{"content":"This avoids the problems of installing MFC7xLOC.DLL properly.","pos":[7755,7816]},{"content":"To do so, you follow the same instructions for the static case given above (setting the RC command line properly to point to the localized resources), except that you must also remove the <ph id=\"ph1\">`/D_AFXDLL`</ph> define that was added by AppWizard.","pos":[7817,8052],"source":" To do so, you follow the same instructions for the static case given above (setting the RC command line properly to point to the localized resources), except that you must also remove the `/D_AFXDLL` define that was added by AppWizard."},{"content":"When <ph id=\"ph1\">`/D_AFXDLL`</ph> is defined, AFXRES.H (and the other MFC RC files) do not actually define any resources (because they will be pulled from the MFC DLLs instead).","pos":[8053,8213],"source":" When `/D_AFXDLL` is defined, AFXRES.H (and the other MFC RC files) do not actually define any resources (because they will be pulled from the MFC DLLs instead)."},{"content":"See Also","pos":[8222,8230]},{"content":"Technical Notes by Number","pos":[8235,8260]},{"content":"Technical Notes by Category","pos":[8304,8331]}],"content":"---\ntitle: \"TN057: Localization of MFC Components | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.mfc.components\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"components [MFC], localizing\"\n  - \"TN057\"\n  - \"resources [MFC], localization\"\n  - \"localization [C++], MFC resources\"\n  - \"localization [C++], MFC components\"\n  - \"MFC DLLs [C++], localizing\"\n  - \"DLLs [C++], localizing MFC\"\n  - \"localization [C++], resources\"\nms.assetid: 5376d329-bd45-41bd-97f5-3d895a9a0af5\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# TN057: Localization of MFC Components\n> [!NOTE]\n>  The following technical note has not been updated since it was first included in the online documentation. As a result, some procedures and topics might be out of date or incorrect. For the latest information, it is recommended that you search for the topic of interest in the online documentation index.  \n  \n This note describes some of the designs and procedures you can use to localize your component, if it an application or an OLE control or a DLL that uses MFC.  \n  \n## Overview  \n There are really two issues to resolve when localizing a component that uses MFC. First, you must localize your own resources — strings, dialogs, and other resources that are specific to your component. Most components built using MFC also include and use a number of resources that are defined by MFC. You must provide localized MFC resources as well. Fortunately, several languages are already provided by MFC itself.  \n  \n In addition, your component should be prepared to run in its target environment (European or DBCS-enabled environment). For the most part, this depends on your application treating characters with the high bit set correctly and handling strings with double byte characters. MFC is enabled, by default, for both of these environments, such that it is possible to have a single worldwide binary that is used on all platforms with just different resources plugged in at setup time.  \n  \n## Localizing your Component's Resources  \n Localizing your application or DLL should involve simply replacing the resources with resources that match the target language. For your own resources, this is relatively simple: edit the resources in the resource editor and build your application. If your code is written properly there will be no strings or text that you wish to localize hard-coded into your C++ source code – all localization can be done by simply modifying resources. In fact, you can implement your component such that all providing a localized version does not even involve a build of the original code. This is more complex, but is well worth it and is the mechanism chosen for MFC itself. It is also possible to localize an application by loading the EXE or DLL file into the resource editor and editing the resources directly. While possible, it requires reapplication of those changes each time you build a new version of your application.  \n  \n One way to avoid that is to locate all resources in a separate DLL, sometimes called a satellite DLL. This DLL is then loaded dynamically at runtime and the resources are loaded from that DLL instead of from the main module with all your code. MFC directly supports this approach. Consider an application called MYAPP.EXE; it could have all of its resources located in a DLL called MYRES.DLL. In the application's `InitInstance` it would perform the following to load that DLL and cause MFC to load resources from that location:  \n  \n```  \nCMyApp::InitInstance()  \n{ *// one of the first things in the init code  \n    HINSTANCE hInst = LoadLibrary(\"myres.dll\");\n\n    if (hInst != NULL)  \n    AfxSetResourceHandle(hInst);\n\n *// other initialization code would follow  \n .  \n .  \n .  \n}  \n```  \n  \n From then on, MFC will load resources from that DLL instead of from myapp.exe. All resources, however, must be present in that DLL; MFC will not search the application's instance in search of a given resource. This technique applies equally well to regular DLLs as well as OLE Controls. Your setup program would copy the appropriate version of MYRES.DLL depending upon which resource locale the user would like.  \n  \n It is relatively easy to create a resource only DLL. You create a DLL project, add your .RC file to it, and add the necessary resources. If you have an existing project that does not use this technique, you can copy the resources from that project. After adding the resource file to the project, you are almost ready to build the project. The only thing you must do is set the linker options to include **/NOENTRY**. This tells the linker that the DLL has no entry point – since it has no code, it has no entry point.  \n  \n> [!NOTE]\n>  The resource editor in Visual C++ 4.0 and later supports multiple languages per .RC file. This can make it very easy to manage your localization in a single project. The resources for each language are controlled by preprocessor directives generated by the resource editor.  \n  \n## Using the Provided MFC Localized Resources  \n Any MFC application that you build reuses two things from MFC: code and resources. That is, MFC has various error messages, built-in dialogs, and other resources that are used by the MFC classes. In order to completely localize your application, you need to localize not only your application's resources, but also the resources that come directly from MFC. MFC provides a number of different language resource files automatically, so that if the language you are targeting is one of the languages MFC already supports, you just need to make sure you use those localized resources.  \n  \n As of this writing, MFC supports Chinese, German, Spanish, French, Italian, Japanese, and Korean. The files which contain these localized versions are in the MFC\\INCLUDE\\L.* (the 'L' stands for localized) directories. The German files are in MFC\\INCLUDE\\L.DEU, for example. To cause your application to use these RC files instead of the files located in MFC\\INCLUDE, add a `/IC:\\PROGRAM FILES\\MICROSOFT VISUAL STUDIO .NET 2003\\VC7\\MFC\\INCLUDE\\L.DEU` to your RC command line (this is just an example; you would need to substitute your locale of choice as well as the directory into which you installed Visual C++).  \n  \n The above instructions will work if your application links statically with MFC. Most applications link dynamically (because that is the AppWizard default). In this scenario, not only the code is dynamically linked – so are the resources. As a result, you can localize your resources in your application, but the MFC implementation resources will still be loaded from the MFC7x.DLL (or a later version) or from MFC7xLOC.DLL if it exists. You can approach this from two different angles.  \n  \n The more complex approach is to ship one of the localized MFC7xLOC.DLLs (such as MFC7xDEU, for German, MFC7xESP.DLL for Spanish, etc.), or a later version, and install the appropriate MFC7xLOC.DLL into the system directory when the user installs your application. This can be very complex for both the developer and the end user and as such is not recommended. See [Technical Note 56](../mfc/tn056-installation-of-localized-mfc-components.md) for more information on this technique and its caveats.  \n  \n The simplest and safest approach is to include the localized MFC resources in your application or DLL itself (or its satellite DLL if you are using one). This avoids the problems of installing MFC7xLOC.DLL properly. To do so, you follow the same instructions for the static case given above (setting the RC command line properly to point to the localized resources), except that you must also remove the `/D_AFXDLL` define that was added by AppWizard. When `/D_AFXDLL` is defined, AFXRES.H (and the other MFC RC files) do not actually define any resources (because they will be pulled from the MFC DLLs instead).  \n  \n## See Also  \n [Technical Notes by Number](../mfc/technical-notes-by-number.md)   \n [Technical Notes by Category](../mfc/technical-notes-by-category.md)\n\n"}