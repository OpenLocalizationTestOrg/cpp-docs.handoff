{"nodes":[{"pos":[12,55],"content":"IDispEventSimpleImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IDispEventSimpleImpl Class | Microsoft Docs","pos":[0,43]}]},{"pos":[697,723],"content":"IDispEventSimpleImpl Class","linkify":"IDispEventSimpleImpl Class","nodes":[{"content":"IDispEventSimpleImpl Class","pos":[0,26]}]},{"pos":[724,841],"content":"This class provides implementations of the <ph id=\"ph1\">`IDispatch`</ph> methods, without getting type information from a type library.","source":"This class provides implementations of the `IDispatch` methods, without getting type information from a type library."},{"pos":[849,999],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,148],"source":" This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"pos":[1008,1014],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1178,1188],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A unique identifier for the source object.","pos":[1201,1243]},{"content":"When <ph id=\"ph1\">`IDispEventSimpleImpl`</ph> is the base class for a composite control, use the resource ID of the desired contained control for this parameter.","pos":[1244,1387],"source":" When `IDispEventSimpleImpl` is the base class for a composite control, use the resource ID of the desired contained control for this parameter."},{"content":"In other cases, use an arbitrary positive integer.","pos":[1388,1438]},{"content":"The user's class, which is derived from <ph id=\"ph1\">`IDispEventSimpleImpl`</ph>.","pos":[1452,1515],"source":" The user's class, which is derived from `IDispEventSimpleImpl`."},{"content":"The pointer to the IID of the event dispinterface implemented by this class.","pos":[1533,1609]},{"pos":[1618,1625],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1635,1649],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1656,1660]},{"content":"Description","pos":[1661,1672]},{"pos":[1710,1771],"content":"<bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::Advise<ept id=\"p1\">](#idispeventsimpleimpl__advise)</ept>","source":"[IDispEventSimpleImpl::Advise](#idispeventsimpleimpl__advise)"},{"content":"Establishes a connection with the default event source.","pos":[1772,1827]},{"pos":[1832,1911],"content":"<bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::DispEventAdvise<ept id=\"p1\">](#idispeventsimpleimpl__dispeventadvise)</ept>","source":"[IDispEventSimpleImpl::DispEventAdvise](#idispeventsimpleimpl__dispeventadvise)"},{"content":"Establishes a connection with the event source.","pos":[1912,1959]},{"pos":[1964,2047],"content":"<bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::DispEventUnadvise<ept id=\"p1\">](#idispeventsimpleimpl__dispeventunadvise)</ept>","source":"[IDispEventSimpleImpl::DispEventUnadvise](#idispeventsimpleimpl__dispeventunadvise)"},{"content":"Breaks the connection with the event source.","pos":[2048,2092]},{"pos":[2097,2172],"content":"<bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::GetIDsOfNames<ept id=\"p1\">](#idispeventsimpleimpl__getidsofnames)</ept>","source":"[IDispEventSimpleImpl::GetIDsOfNames](#idispeventsimpleimpl__getidsofnames)"},{"pos":[2173,2195],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[2200,2271],"content":"<bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::GetTypeInfo<ept id=\"p1\">](#idispeventsimpleimpl__gettypeinfo)</ept>","source":"[IDispEventSimpleImpl::GetTypeInfo](#idispeventsimpleimpl__gettypeinfo)"},{"pos":[2272,2294],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[2299,2380],"content":"<bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::GetTypeInfoCount<ept id=\"p1\">](#idispeventsimpleimpl__gettypeinfocount)</ept>","source":"[IDispEventSimpleImpl::GetTypeInfoCount](#idispeventsimpleimpl__gettypeinfocount)"},{"pos":[2381,2403],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[2408,2469],"content":"<bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::Invoke<ept id=\"p1\">](#idispeventsimpleimpl__invoke)</ept>","source":"[IDispEventSimpleImpl::Invoke](#idispeventsimpleimpl__invoke)"},{"content":"Calls the event handlers listed in the event sink map.","pos":[2470,2524]},{"pos":[2529,2594],"content":"<bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::Unadvise<ept id=\"p1\">](#idispeventsimpleimpl__unadvise)</ept>","source":"[IDispEventSimpleImpl::Unadvise](#idispeventsimpleimpl__unadvise)"},{"content":"Breaks the connection with the default event source.","pos":[2595,2647]},{"pos":[2657,2664],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`IDispEventSimpleImpl`</ph> provides a way of implementing an event dispinterface without requiring you to supply implementation code for every method/event on that interface.","pos":[2668,2838],"source":"`IDispEventSimpleImpl` provides a way of implementing an event dispinterface without requiring you to supply implementation code for every method/event on that interface."},{"content":"<ph id=\"ph1\">`IDispEventSimpleImpl`</ph> provides implementations of the <ph id=\"ph2\">`IDispatch`</ph> methods.","pos":[2839,2914],"source":"`IDispEventSimpleImpl` provides implementations of the `IDispatch` methods."},{"content":"You only need to supply implementations for the events that you are interested in handling.","pos":[2915,3006]},{"content":"<ph id=\"ph1\">`IDispEventSimpleImpl`</ph> works in conjunction with the <bpt id=\"p1\">[</bpt>event sink map<ept id=\"p1\">](http://msdn.microsoft.com/library/32542b3d-ac43-4139-8ac4-41c48481744f)</ept> in your class to route events to the appropriate handler function.","pos":[3013,3221],"source":"`IDispEventSimpleImpl` works in conjunction with the [event sink map](http://msdn.microsoft.com/library/32542b3d-ac43-4139-8ac4-41c48481744f) in your class to route events to the appropriate handler function."},{"content":"To use this class:","pos":[3222,3240]},{"pos":[3250,3428],"content":"Add a <bpt id=\"p1\">[</bpt>SINK_ENTRY_INFO<ept id=\"p1\">](http://msdn.microsoft.com/library/1a0ae260-2c82-4926-a537-db01e5f206a7)</ept> macro to the event sink map for each event on each object that you want to handle.","source":"Add a [SINK_ENTRY_INFO](http://msdn.microsoft.com/library/1a0ae260-2c82-4926-a537-db01e5f206a7) macro to the event sink map for each event on each object that you want to handle."},{"content":"Supply type information for each event by passing a pointer to an <bpt id=\"p1\">[</bpt>_ATL_FUNC_INFO<ept id=\"p1\">](../../atl/reference/atl-func-info-structure.md)</ept> structure as a parameter to each entry.","pos":[3438,3608],"source":"Supply type information for each event by passing a pointer to an [_ATL_FUNC_INFO](../../atl/reference/atl-func-info-structure.md) structure as a parameter to each entry."},{"content":"On the x86 platform, the <ph id=\"ph1\">`_ATL_FUNC_INFO.cc`</ph> value must be CC_CDECL with the callback function calling method of __stdcall.","pos":[3609,3732],"source":" On the x86 platform, the `_ATL_FUNC_INFO.cc` value must be CC_CDECL with the callback function calling method of __stdcall."},{"pos":[3742,3878],"content":"Call <bpt id=\"p1\">[</bpt>DispEventAdvise<ept id=\"p1\">](#idispeventsimpleimpl__dispeventadvise)</ept> to establish the connection between the source object and the base class.","source":"Call [DispEventAdvise](#idispeventsimpleimpl__dispeventadvise) to establish the connection between the source object and the base class."},{"pos":[3888,3979],"content":"Call <bpt id=\"p1\">[</bpt>DispEventUnadvise<ept id=\"p1\">](#idispeventsimpleimpl__dispeventunadvise)</ept> to break the connection.","source":"Call [DispEventUnadvise](#idispeventsimpleimpl__dispeventunadvise) to break the connection."},{"content":"You must derive from <ph id=\"ph1\">`IDispEventSimpleImpl`</ph> (using a unique value for <ph id=\"ph2\">`nID`</ph>) for each object for which you need to handle events.","pos":[3986,4115],"source":"You must derive from `IDispEventSimpleImpl` (using a unique value for `nID`) for each object for which you need to handle events."},{"content":"You can reuse the base class by unadvising against one source object then advising against a different source object, but the maximum number of source objects that can be handled by a single object at one time is limited by the number of <ph id=\"ph1\">`IDispEventSimpleImpl`</ph> base classes.","pos":[4116,4390],"source":" You can reuse the base class by unadvising against one source object then advising against a different source object, but the maximum number of source objects that can be handled by a single object at one time is limited by the number of `IDispEventSimpleImpl` base classes."},{"content":"<bpt id=\"p1\">**</bpt>IDispEventSimplImpl<ept id=\"p1\">**</ept> provides the same functionality as <bpt id=\"p2\">[</bpt>IDispEventImpl<ept id=\"p2\">](../../atl/reference/idispeventimpl-class.md)</ept>, except it does not get type information about the interface from a type library.","pos":[4397,4599],"source":"**IDispEventSimplImpl** provides the same functionality as [IDispEventImpl](../../atl/reference/idispeventimpl-class.md), except it does not get type information about the interface from a type library."},{"content":"The wizards generate code based only on <ph id=\"ph1\">`IDispEventImpl`</ph>, but you can use <ph id=\"ph2\">`IDispEventSimpleImpl`</ph> by adding the code by hand.","pos":[4600,4724],"source":" The wizards generate code based only on `IDispEventImpl`, but you can use `IDispEventSimpleImpl` by adding the code by hand."},{"content":"Use <ph id=\"ph1\">`IDispEventSimpleImpl`</ph> when you don't have a type library describing the event interface or want to avoid the overhead associated with using the type library.","pos":[4725,4887],"source":" Use `IDispEventSimpleImpl` when you don't have a type library describing the event interface or want to avoid the overhead associated with using the type library."},{"pos":[4895,5192],"content":"[!NOTE]\n`IDispEventImpl` and `IDispEventSimpleImpl` provide their own implementation of **IUnknown::QueryInterface** enabling each `IDispEventImpl` or `IDispEventSimpleImpl` base class to act as a separate COM identity while still allowing direct access to class members in your main COM object.","leadings":["","> "],"nodes":[{"content":"<ph id=\"ph1\">`IDispEventImpl`</ph> and <ph id=\"ph2\">`IDispEventSimpleImpl`</ph> provide their own implementation of <bpt id=\"p1\">**</bpt>IUnknown::QueryInterface<ept id=\"p1\">**</ept> enabling each <ph id=\"ph3\">`IDispEventImpl`</ph> or <ph id=\"ph4\">`IDispEventSimpleImpl`</ph> base class to act as a separate COM identity while still allowing direct access to class members in your main COM object.","pos":[8,295],"source":"`IDispEventImpl` and `IDispEventSimpleImpl` provide their own implementation of **IUnknown::QueryInterface** enabling each `IDispEventImpl` or `IDispEventSimpleImpl` base class to act as a separate COM identity while still allowing direct access to class members in your main COM object."}]},{"content":"CE ATL implementation of ActiveX event sinks only supports return values of type HRESULT or void from your event handler methods; any other return value is unsupported and its behavior is undefined.","pos":[5199,5397]},{"pos":[5404,5498],"content":"For more information, see <bpt id=\"p1\">[</bpt>Supporting IDispEventImpl<ept id=\"p1\">](../../atl/supporting-idispeventimpl.md)</ept>.","source":"For more information, see [Supporting IDispEventImpl](../../atl/supporting-idispeventimpl.md)."},{"pos":[5507,5528],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[5610,5622],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[5626,5646],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[5656,5729],"content":"<bpt id=\"p1\">&lt;a name=\"idispeventsimpleimpl__advise\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDispEventSimpleImpl::Advise","linkify":"<a name=\"idispeventsimpleimpl__advise\"></a>  IDispEventSimpleImpl::Advise","source":"<a name=\"idispeventsimpleimpl__advise\"></a>  IDispEventSimpleImpl::Advise"},{"pos":[5733,5820],"content":"Call this method to establish a connection with the event source represented by <bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept>.","source":"Call this method to establish a connection with the event source represented by *pUnk*."},{"pos":[5875,5885],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept>","pos":[5889,5895],"source":"*pUnk*"},{"content":"[in] A pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface of the event source object.","pos":[5899,5971],"source":" [in] A pointer to the **IUnknown** interface of the event source object."},{"pos":[5981,5993],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[5997,6035],"content":"<ph id=\"ph1\">`S_OK`</ph> or any failure <ph id=\"ph2\">`HRESULT`</ph> value.","source":"`S_OK` or any failure `HRESULT` value."},{"pos":[6045,6052],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6056,6187],"content":"Once the connection is established, events fired from <bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept> will be routed to handlers in your class by way of the event sink map.","source":"Once the connection is established, events fired from *pUnk* will be routed to handlers in your class by way of the event sink map."},{"pos":[6195,6398],"content":"[!NOTE]\n If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.","leadings":["","> "],"nodes":[{"content":"If your class derives from multiple <ph id=\"ph1\">`IDispEventSimpleImpl`</ph> classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.","pos":[9,201],"source":" If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in."}]},{"pos":[6405,6647],"content":"<ph id=\"ph1\">`Advise`</ph> establishes a connection with the default event source, it gets the IID of the default event source of the object as determined by <bpt id=\"p1\">[</bpt>AtlGetObjectSourceInterface<ept id=\"p1\">](http://msdn.microsoft.com/library/a8528f45-fbfb-4e24-ad1a-1d69b2897155)</ept>.","source":"`Advise` establishes a connection with the default event source, it gets the IID of the default event source of the object as determined by [AtlGetObjectSourceInterface](http://msdn.microsoft.com/library/a8528f45-fbfb-4e24-ad1a-1d69b2897155)."},{"pos":[6657,6748],"content":"<bpt id=\"p1\">&lt;a name=\"idispeventsimpleimpl__dispeventadvise\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDispEventSimpleImpl::DispEventAdvise","linkify":"<a name=\"idispeventsimpleimpl__dispeventadvise\"></a>  IDispEventSimpleImpl::DispEventAdvise","source":"<a name=\"idispeventsimpleimpl__dispeventadvise\"></a>  IDispEventSimpleImpl::DispEventAdvise"},{"pos":[6752,6839],"content":"Call this method to establish a connection with the event source represented by <bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept>.","source":"Call this method to establish a connection with the event source represented by *pUnk*."},{"pos":[6920,6930],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept>","pos":[6934,6940],"source":"*pUnk*"},{"content":"[in] A pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface of the event source object.","pos":[6944,7016],"source":" [in] A pointer to the **IUnknown** interface of the event source object."},{"content":"A pointer to the IID of the event source object.","pos":[7033,7081]},{"pos":[7091,7103],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[7107,7145],"content":"<ph id=\"ph1\">`S_OK`</ph> or any failure <ph id=\"ph2\">`HRESULT`</ph> value.","source":"`S_OK` or any failure `HRESULT` value."},{"pos":[7155,7162],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7166,7275],"content":"Subsequently, events fired from <bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept> will be routed to handlers in your class by way of the event sink map.","source":"Subsequently, events fired from *pUnk* will be routed to handlers in your class by way of the event sink map."},{"pos":[7283,7486],"content":"[!NOTE]\n If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.","leadings":["","> "],"nodes":[{"content":"If your class derives from multiple <ph id=\"ph1\">`IDispEventSimpleImpl`</ph> classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.","pos":[9,201],"source":" If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in."}]},{"pos":[7493,7579],"content":"<ph id=\"ph1\">`DispEventAdvise`</ph> establishes a connection with the event source specified in <ph id=\"ph2\">`pdiid`</ph>.","source":"`DispEventAdvise` establishes a connection with the event source specified in `pdiid`."},{"pos":[7589,7684],"content":"<bpt id=\"p1\">&lt;a name=\"idispeventsimpleimpl__dispeventunadvise\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDispEventSimpleImpl::DispEventUnadvise","linkify":"<a name=\"idispeventsimpleimpl__dispeventunadvise\"></a>  IDispEventSimpleImpl::DispEventUnadvise","source":"<a name=\"idispeventsimpleimpl__dispeventunadvise\"></a>  IDispEventSimpleImpl::DispEventUnadvise"},{"pos":[7688,7754],"content":"Breaks the connection with the event source represented by <bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept>.","source":"Breaks the connection with the event source represented by *pUnk*."},{"pos":[7837,7847],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept>","pos":[7851,7857],"source":"*pUnk*"},{"content":"[in] A pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface of the event source object.","pos":[7861,7933],"source":" [in] A pointer to the **IUnknown** interface of the event source object."},{"content":"A pointer to the IID of the event source object.","pos":[7950,7998]},{"pos":[8008,8020],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[8024,8062],"content":"<ph id=\"ph1\">`S_OK`</ph> or any failure <ph id=\"ph2\">`HRESULT`</ph> value.","source":"`S_OK` or any failure `HRESULT` value."},{"pos":[8072,8079],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Once the connection is broken, events will no longer be routed to the handler functions listed in the event sink map.","pos":[8083,8200]},{"pos":[8208,8411],"content":"[!NOTE]\n If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.","leadings":["","> "],"nodes":[{"content":"If your class derives from multiple <ph id=\"ph1\">`IDispEventSimpleImpl`</ph> classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.","pos":[9,201],"source":" If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in."}]},{"pos":[8418,8520],"content":"<ph id=\"ph1\">`DispEventAdvise`</ph> breaks a connection that was established with the event source specified in <ph id=\"ph2\">`pdiid`</ph>.","source":"`DispEventAdvise` breaks a connection that was established with the event source specified in `pdiid`."},{"pos":[8530,8617],"content":"<bpt id=\"p1\">&lt;a name=\"idispeventsimpleimpl__getidsofnames\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDispEventSimpleImpl::GetIDsOfNames","linkify":"<a name=\"idispeventsimpleimpl__getidsofnames\"></a>  IDispEventSimpleImpl::GetIDsOfNames","source":"<a name=\"idispeventsimpleimpl__getidsofnames\"></a>  IDispEventSimpleImpl::GetIDsOfNames"},{"pos":[8621,8695],"content":"This implementation of <bpt id=\"p1\">**</bpt>IDispatch::GetIDsOfNames<ept id=\"p1\">**</ept> returns <bpt id=\"p2\">**</bpt>E_NOTIMPL<ept id=\"p2\">**</ept>.","source":"This implementation of **IDispatch::GetIDsOfNames** returns **E_NOTIMPL**."},{"pos":[8866,8873],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[8877,9037],"content":"See <bpt id=\"p1\">[</bpt>IDispatch::GetIDsOfNames<ept id=\"p1\">](http://msdn.microsoft.com/en-us/6f6cf233-3481-436e-8d6a-51f93bf91619)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDispatch::GetIDsOfNames](http://msdn.microsoft.com/en-us/6f6cf233-3481-436e-8d6a-51f93bf91619) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[9047,9130],"content":"<bpt id=\"p1\">&lt;a name=\"idispeventsimpleimpl__gettypeinfo\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDispEventSimpleImpl::GetTypeInfo","linkify":"<a name=\"idispeventsimpleimpl__gettypeinfo\"></a>  IDispEventSimpleImpl::GetTypeInfo","source":"<a name=\"idispeventsimpleimpl__gettypeinfo\"></a>  IDispEventSimpleImpl::GetTypeInfo"},{"pos":[9134,9206],"content":"This implementation of <bpt id=\"p1\">**</bpt>IDispatch::GetTypeInfo<ept id=\"p1\">**</ept> returns <bpt id=\"p2\">**</bpt>E_NOTIMPL<ept id=\"p2\">**</ept>.","source":"This implementation of **IDispatch::GetTypeInfo** returns **E_NOTIMPL**."},{"pos":[9324,9331],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[9335,9493],"content":"See <bpt id=\"p1\">[</bpt>IDispatch::GetTypeInfo<ept id=\"p1\">](http://msdn.microsoft.com/en-us/cc1ec9aa-6c40-4e70-819c-a7c6dd6b8c99)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDispatch::GetTypeInfo](http://msdn.microsoft.com/en-us/cc1ec9aa-6c40-4e70-819c-a7c6dd6b8c99) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[9503,9596],"content":"<bpt id=\"p1\">&lt;a name=\"idispeventsimpleimpl__gettypeinfocount\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDispEventSimpleImpl::GetTypeInfoCount","linkify":"<a name=\"idispeventsimpleimpl__gettypeinfocount\"></a>  IDispEventSimpleImpl::GetTypeInfoCount","source":"<a name=\"idispeventsimpleimpl__gettypeinfocount\"></a>  IDispEventSimpleImpl::GetTypeInfoCount"},{"pos":[9600,9677],"content":"This implementation of <bpt id=\"p1\">**</bpt>IDispatch::GetTypeInfoCount<ept id=\"p1\">**</ept> returns <bpt id=\"p2\">**</bpt>E_NOTIMPL<ept id=\"p2\">**</ept>.","source":"This implementation of **IDispatch::GetTypeInfoCount** returns **E_NOTIMPL**."},{"pos":[9750,9757],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[9761,9924],"content":"See <bpt id=\"p1\">[</bpt>IDispatch::GetTypeInfoCount<ept id=\"p1\">](http://msdn.microsoft.com/en-us/da876d53-cb8a-465c-a43e-c0eb272e2a12)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDispatch::GetTypeInfoCount](http://msdn.microsoft.com/en-us/da876d53-cb8a-465c-a43e-c0eb272e2a12) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[9934,10007],"content":"<bpt id=\"p1\">&lt;a name=\"idispeventsimpleimpl__invoke\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDispEventSimpleImpl::Invoke","linkify":"<a name=\"idispeventsimpleimpl__invoke\"></a>  IDispEventSimpleImpl::Invoke","source":"<a name=\"idispeventsimpleimpl__invoke\"></a>  IDispEventSimpleImpl::Invoke"},{"pos":[10011,10110],"content":"This implementation of <bpt id=\"p1\">**</bpt>IDispatch::Invoke<ept id=\"p1\">**</ept> calls the event handlers listed in the event sink map.","source":"This implementation of **IDispatch::Invoke** calls the event handlers listed in the event sink map."},{"pos":[10346,10353],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[10357,10451],"content":"See <bpt id=\"p1\">[</bpt>IDispatch::Invoke<ept id=\"p1\">](http://msdn.microsoft.com/en-us/964ade8e-9d8a-4d32-bd47-aa678912a54d)</ept>.","source":"See [IDispatch::Invoke](http://msdn.microsoft.com/en-us/964ade8e-9d8a-4d32-bd47-aa678912a54d)."},{"pos":[10461,10538],"content":"<bpt id=\"p1\">&lt;a name=\"idispeventsimpleimpl__unadvise\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDispEventSimpleImpl::Unadvise","linkify":"<a name=\"idispeventsimpleimpl__unadvise\"></a>  IDispEventSimpleImpl::Unadvise","source":"<a name=\"idispeventsimpleimpl__unadvise\"></a>  IDispEventSimpleImpl::Unadvise"},{"pos":[10542,10608],"content":"Breaks the connection with the event source represented by <bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept>.","source":"Breaks the connection with the event source represented by *pUnk*."},{"pos":[10665,10675],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept>","pos":[10679,10685],"source":"*pUnk*"},{"content":"[in] A pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface of the event source object.","pos":[10689,10761],"source":" [in] A pointer to the **IUnknown** interface of the event source object."},{"pos":[10771,10783],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[10787,10825],"content":"<ph id=\"ph1\">`S_OK`</ph> or any failure <ph id=\"ph2\">`HRESULT`</ph> value.","source":"`S_OK` or any failure `HRESULT` value."},{"pos":[10835,10842],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Once the connection is broken, events will no longer be routed to the handler functions listed in the event sink map.","pos":[10846,10963]},{"pos":[10971,11174],"content":"[!NOTE]\n If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.","leadings":["","> "],"nodes":[{"content":"If your class derives from multiple <ph id=\"ph1\">`IDispEventSimpleImpl`</ph> classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.","pos":[9,201],"source":" If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in."}]},{"pos":[11181,11284],"content":"<ph id=\"ph1\">`Unadvise`</ph> breaks a connection that was established with the default event source specified in <ph id=\"ph2\">`pdiid`</ph>.","source":"`Unadvise` breaks a connection that was established with the default event source specified in `pdiid`."},{"pos":[11291,11531],"content":"<bpt id=\"p1\">**</bpt>Unavise<ept id=\"p1\">**</ept> breaks a connection with the default event source, it gets the IID of the default event source of the object as determined by <bpt id=\"p2\">[</bpt>AtlGetObjectSourceInterface<ept id=\"p2\">](http://msdn.microsoft.com/library/a8528f45-fbfb-4e24-ad1a-1d69b2897155)</ept>.","source":"**Unavise** breaks a connection with the default event source, it gets the IID of the default event source of the object as determined by [AtlGetObjectSourceInterface](http://msdn.microsoft.com/library/a8528f45-fbfb-4e24-ad1a-1d69b2897155)."},{"pos":[11540,11548],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>_ATL_FUNC_INFO Structure<ept id=\"p1\">](../../atl/reference/atl-func-info-structure.md)</ept><ph id=\"ph1\"> </ph>","pos":[11552,11627],"source":"[_ATL_FUNC_INFO Structure](../../atl/reference/atl-func-info-structure.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IDispatchImpl Class<ept id=\"p1\">](../../atl/reference/idispatchimpl-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[11630,11697],"source":" [IDispatchImpl Class](../../atl/reference/idispatchimpl-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>IDispEventImpl Class<ept id=\"p1\">](../../atl/reference/idispeventimpl-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[11700,11769],"source":" [IDispEventImpl Class](../../atl/reference/idispeventimpl-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>SINK_ENTRY_INFO<ept id=\"p1\">](http://msdn.microsoft.com/library/1a0ae260-2c82-4926-a537-db01e5f206a7)</ept><ph id=\"ph1\"> </ph>","pos":[11772,11863],"source":" [SINK_ENTRY_INFO](http://msdn.microsoft.com/library/1a0ae260-2c82-4926-a537-db01e5f206a7) "},{"content":"<bpt id=\"p1\"> [</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","pos":[11866,11916],"source":" [Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"IDispEventSimpleImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"IDispEventSimpleImpl\"\n  - \"ATL::IDispEventSimpleImpl\"\n  - \"ATL.IDispEventSimpleImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IDispEventSimpleImpl class\"\nms.assetid: 971d82b7-a921-47fa-a4d8-909bed377ab0\ncaps.latest.revision: 27\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IDispEventSimpleImpl Class\nThis class provides implementations of the `IDispatch` methods, without getting type information from a type library.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n## Syntax  \n  \n```\ntemplate <UINT nID, class T,\n    const IID* pdiid>  class ATL_NO_VTABLE IDispEventSimpleImpl :  public _IDispEventLocator<nID,\n    pdiid>\n```    \n  \n#### Parameters  \n `nID`  \n A unique identifier for the source object. When `IDispEventSimpleImpl` is the base class for a composite control, use the resource ID of the desired contained control for this parameter. In other cases, use an arbitrary positive integer.  \n  \n `T`  \n The user's class, which is derived from `IDispEventSimpleImpl`.  \n  \n `pdiid`  \n The pointer to the IID of the event dispinterface implemented by this class.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IDispEventSimpleImpl::Advise](#idispeventsimpleimpl__advise)|Establishes a connection with the default event source.|  \n|[IDispEventSimpleImpl::DispEventAdvise](#idispeventsimpleimpl__dispeventadvise)|Establishes a connection with the event source.|  \n|[IDispEventSimpleImpl::DispEventUnadvise](#idispeventsimpleimpl__dispeventunadvise)|Breaks the connection with the event source.|  \n|[IDispEventSimpleImpl::GetIDsOfNames](#idispeventsimpleimpl__getidsofnames)|Returns **E_NOTIMPL**.|  \n|[IDispEventSimpleImpl::GetTypeInfo](#idispeventsimpleimpl__gettypeinfo)|Returns **E_NOTIMPL**.|  \n|[IDispEventSimpleImpl::GetTypeInfoCount](#idispeventsimpleimpl__gettypeinfocount)|Returns **E_NOTIMPL**.|  \n|[IDispEventSimpleImpl::Invoke](#idispeventsimpleimpl__invoke)|Calls the event handlers listed in the event sink map.|  \n|[IDispEventSimpleImpl::Unadvise](#idispeventsimpleimpl__unadvise)|Breaks the connection with the default event source.|  \n  \n## Remarks  \n `IDispEventSimpleImpl` provides a way of implementing an event dispinterface without requiring you to supply implementation code for every method/event on that interface. `IDispEventSimpleImpl` provides implementations of the `IDispatch` methods. You only need to supply implementations for the events that you are interested in handling.  \n  \n `IDispEventSimpleImpl` works in conjunction with the [event sink map](http://msdn.microsoft.com/library/32542b3d-ac43-4139-8ac4-41c48481744f) in your class to route events to the appropriate handler function. To use this class:  \n  \n-   Add a [SINK_ENTRY_INFO](http://msdn.microsoft.com/library/1a0ae260-2c82-4926-a537-db01e5f206a7) macro to the event sink map for each event on each object that you want to handle.  \n  \n-   Supply type information for each event by passing a pointer to an [_ATL_FUNC_INFO](../../atl/reference/atl-func-info-structure.md) structure as a parameter to each entry. On the x86 platform, the `_ATL_FUNC_INFO.cc` value must be CC_CDECL with the callback function calling method of __stdcall.  \n  \n-   Call [DispEventAdvise](#idispeventsimpleimpl__dispeventadvise) to establish the connection between the source object and the base class.  \n  \n-   Call [DispEventUnadvise](#idispeventsimpleimpl__dispeventunadvise) to break the connection.  \n  \n You must derive from `IDispEventSimpleImpl` (using a unique value for `nID`) for each object for which you need to handle events. You can reuse the base class by unadvising against one source object then advising against a different source object, but the maximum number of source objects that can be handled by a single object at one time is limited by the number of `IDispEventSimpleImpl` base classes.  \n  \n **IDispEventSimplImpl** provides the same functionality as [IDispEventImpl](../../atl/reference/idispeventimpl-class.md), except it does not get type information about the interface from a type library. The wizards generate code based only on `IDispEventImpl`, but you can use `IDispEventSimpleImpl` by adding the code by hand. Use `IDispEventSimpleImpl` when you don't have a type library describing the event interface or want to avoid the overhead associated with using the type library.  \n  \n> [!NOTE]\n> `IDispEventImpl` and `IDispEventSimpleImpl` provide their own implementation of **IUnknown::QueryInterface** enabling each `IDispEventImpl` or `IDispEventSimpleImpl` base class to act as a separate COM identity while still allowing direct access to class members in your main COM object.  \n  \n CE ATL implementation of ActiveX event sinks only supports return values of type HRESULT or void from your event handler methods; any other return value is unsupported and its behavior is undefined.  \n  \n For more information, see [Supporting IDispEventImpl](../../atl/supporting-idispeventimpl.md).  \n  \n## Inheritance Hierarchy  \n `_IDispEvent`  \n  \n `_IDispEventLocator`  \n  \n `IDispEventSimpleImpl`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"idispeventsimpleimpl__advise\"></a>  IDispEventSimpleImpl::Advise  \n Call this method to establish a connection with the event source represented by *pUnk*.  \n  \n```\nHRESULT Advise(IUnknown* pUnk);\n```  \n  \n### Parameters  \n *pUnk*  \n [in] A pointer to the **IUnknown** interface of the event source object.  \n  \n### Return Value  \n `S_OK` or any failure `HRESULT` value.  \n  \n### Remarks  \n Once the connection is established, events fired from *pUnk* will be routed to handlers in your class by way of the event sink map.  \n  \n> [!NOTE]\n>  If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.  \n  \n `Advise` establishes a connection with the default event source, it gets the IID of the default event source of the object as determined by [AtlGetObjectSourceInterface](http://msdn.microsoft.com/library/a8528f45-fbfb-4e24-ad1a-1d69b2897155).  \n  \n##  <a name=\"idispeventsimpleimpl__dispeventadvise\"></a>  IDispEventSimpleImpl::DispEventAdvise  \n Call this method to establish a connection with the event source represented by *pUnk*.  \n  \n```\nHRESULT DispEventAdvise(IUnknown* pUnk  const IID* piid);\n```  \n  \n### Parameters  \n *pUnk*  \n [in] A pointer to the **IUnknown** interface of the event source object.  \n  \n `piid`  \n A pointer to the IID of the event source object.  \n  \n### Return Value  \n `S_OK` or any failure `HRESULT` value.  \n  \n### Remarks  \n Subsequently, events fired from *pUnk* will be routed to handlers in your class by way of the event sink map.  \n  \n> [!NOTE]\n>  If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.  \n  \n `DispEventAdvise` establishes a connection with the event source specified in `pdiid`.  \n  \n##  <a name=\"idispeventsimpleimpl__dispeventunadvise\"></a>  IDispEventSimpleImpl::DispEventUnadvise  \n Breaks the connection with the event source represented by *pUnk*.  \n  \n```\nHRESULT DispEventUnadvise(IUnknown* pUnk  const IID* piid);\n```  \n  \n### Parameters  \n *pUnk*  \n [in] A pointer to the **IUnknown** interface of the event source object.  \n  \n `piid`  \n A pointer to the IID of the event source object.  \n  \n### Return Value  \n `S_OK` or any failure `HRESULT` value.  \n  \n### Remarks  \n Once the connection is broken, events will no longer be routed to the handler functions listed in the event sink map.  \n  \n> [!NOTE]\n>  If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.  \n  \n `DispEventAdvise` breaks a connection that was established with the event source specified in `pdiid`.  \n  \n##  <a name=\"idispeventsimpleimpl__getidsofnames\"></a>  IDispEventSimpleImpl::GetIDsOfNames  \n This implementation of **IDispatch::GetIDsOfNames** returns **E_NOTIMPL**.  \n  \n```\nSTDMETHOD(GetIDsOfNames)(REFIID /* riid */,\n    LPOLESTR* /* rgszNames */,\n    UINT /* cNames */,\n    LCID /* lcid */,\n    DISPID* /* rgdispid */);\n```  \n  \n### Remarks  \n See [IDispatch::GetIDsOfNames](http://msdn.microsoft.com/en-us/6f6cf233-3481-436e-8d6a-51f93bf91619) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idispeventsimpleimpl__gettypeinfo\"></a>  IDispEventSimpleImpl::GetTypeInfo  \n This implementation of **IDispatch::GetTypeInfo** returns **E_NOTIMPL**.  \n  \n```\nSTDMETHOD(GetTypeInfo)(UINT /* itinfo */,\n    LCID /* lcid */,\n    ITypeInfo** /* pptinfo */);\n```  \n  \n### Remarks  \n See [IDispatch::GetTypeInfo](http://msdn.microsoft.com/en-us/cc1ec9aa-6c40-4e70-819c-a7c6dd6b8c99) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idispeventsimpleimpl__gettypeinfocount\"></a>  IDispEventSimpleImpl::GetTypeInfoCount  \n This implementation of **IDispatch::GetTypeInfoCount** returns **E_NOTIMPL**.  \n  \n```\nSTDMETHOD(GetTypeInfoCount)(UINT* /* pctinfo */);\n```  \n  \n### Remarks  \n See [IDispatch::GetTypeInfoCount](http://msdn.microsoft.com/en-us/da876d53-cb8a-465c-a43e-c0eb272e2a12) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idispeventsimpleimpl__invoke\"></a>  IDispEventSimpleImpl::Invoke  \n This implementation of **IDispatch::Invoke** calls the event handlers listed in the event sink map.  \n  \n```\nSTDMETHOD(Invoke)(DISPID dispidMember,\n    REFIID /* riid */,\n    LCID lcid,\n    WORD /* wFlags */,\n    DISPPARMS* pdispparams,\n    VARIANT* pvarResult,\n    EXCEPINFO* /* pexcepinfo */,\n    UINT* /* puArgErr */);\n```  \n  \n### Remarks  \n See [IDispatch::Invoke](http://msdn.microsoft.com/en-us/964ade8e-9d8a-4d32-bd47-aa678912a54d).  \n  \n##  <a name=\"idispeventsimpleimpl__unadvise\"></a>  IDispEventSimpleImpl::Unadvise  \n Breaks the connection with the event source represented by *pUnk*.  \n  \n```\nHRESULT Unadvise(IUnknown* pUnk);\n```  \n  \n### Parameters  \n *pUnk*  \n [in] A pointer to the **IUnknown** interface of the event source object.  \n  \n### Return Value  \n `S_OK` or any failure `HRESULT` value.  \n  \n### Remarks  \n Once the connection is broken, events will no longer be routed to the handler functions listed in the event sink map.  \n  \n> [!NOTE]\n>  If your class derives from multiple `IDispEventSimpleImpl` classes, you will need to disambiguate calls to this method by scoping the call with the particular base class you are interested in.  \n  \n `Unadvise` breaks a connection that was established with the default event source specified in `pdiid`.  \n  \n **Unavise** breaks a connection with the default event source, it gets the IID of the default event source of the object as determined by [AtlGetObjectSourceInterface](http://msdn.microsoft.com/library/a8528f45-fbfb-4e24-ad1a-1d69b2897155).  \n  \n## See Also  \n [_ATL_FUNC_INFO Structure](../../atl/reference/atl-func-info-structure.md)   \n [IDispatchImpl Class](../../atl/reference/idispatchimpl-class.md)   \n [IDispEventImpl Class](../../atl/reference/idispeventimpl-class.md)   \n [SINK_ENTRY_INFO](http://msdn.microsoft.com/library/1a0ae260-2c82-4926-a537-db01e5f206a7)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}