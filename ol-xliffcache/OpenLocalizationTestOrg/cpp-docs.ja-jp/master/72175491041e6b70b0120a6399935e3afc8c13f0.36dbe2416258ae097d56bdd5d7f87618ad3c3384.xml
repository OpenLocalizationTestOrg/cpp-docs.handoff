{"nodes":[{"pos":[12,81],"content":"Calling DLL Functions from Visual Basic Applications | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Calling DLL Functions from Visual Basic Applications | Microsoft Docs","pos":[0,69]}]},{"content":"Calling DLL Functions from Visual Basic Applications","pos":[860,912]},{"content":"For Visual Basic applications (or applications in other languages such as Pascal or Fortran) to call functions in a C/C++ DLL, the functions must be exported using the correct calling convention without any name decoration done by the compiler.","pos":[913,1157]},{"content":"creates the correct calling convention for the function (the called function cleans up the stack and parameters are passed from right to left) but decorates the function name differently.","pos":[1176,1363]},{"content":"So, when <bpt id=\"p1\">**</bpt>__declspec(dllexport)<ept id=\"p1\">**</ept> is used on an exported function in a DLL, the decorated name is exported.","pos":[1364,1472],"source":" So, when **__declspec(dllexport)** is used on an exported function in a DLL, the decorated name is exported."},{"content":"The <ph id=\"ph1\">`__stdcall`</ph> name decoration prefixes the symbol name with an underscore (_) and appends the symbol with an at sign (@) character followed by the number of bytes in the argument list (the required stack space).","pos":[1479,1692],"source":"The `__stdcall` name decoration prefixes the symbol name with an underscore (_) and appends the symbol with an at sign (@) character followed by the number of bytes in the argument list (the required stack space)."},{"content":"As a result, the function when declared as:","pos":[1693,1736]},{"content":"is decorated as:","pos":[1797,1813]},{"pos":[1846,1913],"content":"The C calling convention (<ph id=\"ph1\">`__cdecl`</ph>) decorates the name as <ph id=\"ph2\">`_func`</ph>.","source":"The C calling convention (`__cdecl`) decorates the name as `_func`."},{"content":"To get the decorated name, use <bpt id=\"p1\">[</bpt>/MAP<ept id=\"p1\">](../build/reference/map-generate-mapfile.md)</ept>.","pos":[1920,2002],"source":"To get the decorated name, use [/MAP](../build/reference/map-generate-mapfile.md)."},{"content":"Use of <bpt id=\"p1\">**</bpt>__declspec(dllexport)<ept id=\"p1\">**</ept> does the following:","pos":[2003,2055],"source":" Use of **__declspec(dllexport)** does the following:"},{"pos":[2065,2200],"content":"If the function is exported with the C calling convention (<bpt id=\"p1\">**</bpt>_cdecl<ept id=\"p1\">**</ept>), it strips the leading underscore (_) when the name is exported.","source":"If the function is exported with the C calling convention (**_cdecl**), it strips the leading underscore (_) when the name is exported."},{"pos":[2210,2337],"content":"If the function being exported does not use the C calling convention (for example, <ph id=\"ph1\">`__stdcall`</ph>), it exports the decorated name.","source":"If the function being exported does not use the C calling convention (for example, `__stdcall`), it exports the decorated name."},{"content":"Because there is no way to override where the stack cleanup occurs, you must use <ph id=\"ph1\">`__stdcall`</ph>.","pos":[2344,2437],"source":"Because there is no way to override where the stack cleanup occurs, you must use `__stdcall`."},{"content":"To undecorate names with <ph id=\"ph1\">`__stdcall`</ph>, you must specify them by using aliases in the EXPORTS section of the .def file.","pos":[2438,2555],"source":" To undecorate names with `__stdcall`, you must specify them by using aliases in the EXPORTS section of the .def file."},{"content":"This is shown as follows for the following function declaration:","pos":[2556,2620]},{"content":"In the .DEF file:","pos":[2719,2736]},{"content":"For DLLs to be called by programs written in Visual Basic, the alias technique shown in this topic is needed in the .def file.","pos":[2817,2943]},{"content":"If the alias is done in the Visual Basic program, use of aliasing in the .def file is not necessary.","pos":[2944,3044]},{"content":"It can be done in the Visual Basic program by adding an alias clause to the <bpt id=\"p1\">[</bpt>Declare<ept id=\"p1\">](/dotnet/articles/visual-basic/language-reference/statements/declare-statement)</ept> statement.","pos":[3045,3220],"source":" It can be done in the Visual Basic program by adding an alias clause to the [Declare](/dotnet/articles/visual-basic/language-reference/statements/declare-statement) statement."},{"content":"What do you want to know more about?","pos":[3229,3265]},{"content":"Exporting from a DLL","pos":[3276,3296]},{"content":"Exporting from a DLL using .DEF files","pos":[3342,3379]},{"content":"Exporting from a DLL using __declspec(dllexport)","pos":[3441,3489]},{"content":"Exporting C++ functions for use in C-language executables","pos":[3560,3617]},{"content":"Determining which exporting method to use","pos":[3700,3741]},{"content":"Decorated names","pos":[3808,3823]},{"content":"See Also","pos":[3872,3880]},{"content":"DLLs in Visual C++","pos":[3885,3903]}],"content":"---\ntitle: \"Calling DLL Functions from Visual Basic Applications | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"functions [C++], calling DLL functions from Visual Basic\"\n  - \"DLL functions [C++]\"\n  - \"function calls [C++], DLL functions\"\n  - \"DLLs [C++], calling\"\n  - \"calling DLL functions from VB applications [C++]\"\n  - \"__stdcall keyword [C++]\"\n  - \"DLL functions [C++], calling\"\nms.assetid: 282f7fbf-a0f2-4b9f-b277-1982710be56c\ncaps.latest.revision: 7\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Calling DLL Functions from Visual Basic Applications\nFor Visual Basic applications (or applications in other languages such as Pascal or Fortran) to call functions in a C/C++ DLL, the functions must be exported using the correct calling convention without any name decoration done by the compiler.  \n  \n `__stdcall` creates the correct calling convention for the function (the called function cleans up the stack and parameters are passed from right to left) but decorates the function name differently. So, when **__declspec(dllexport)** is used on an exported function in a DLL, the decorated name is exported.  \n  \n The `__stdcall` name decoration prefixes the symbol name with an underscore (_) and appends the symbol with an at sign (@) character followed by the number of bytes in the argument list (the required stack space). As a result, the function when declared as:  \n  \n```  \nint __stdcall func (int a, double b)  \n```  \n  \n is decorated as:  \n  \n```  \n_func@12  \n```  \n  \n The C calling convention (`__cdecl`) decorates the name as `_func`.  \n  \n To get the decorated name, use [/MAP](../build/reference/map-generate-mapfile.md). Use of **__declspec(dllexport)** does the following:  \n  \n-   If the function is exported with the C calling convention (**_cdecl**), it strips the leading underscore (_) when the name is exported.  \n  \n-   If the function being exported does not use the C calling convention (for example, `__stdcall`), it exports the decorated name.  \n  \n Because there is no way to override where the stack cleanup occurs, you must use `__stdcall`. To undecorate names with `__stdcall`, you must specify them by using aliases in the EXPORTS section of the .def file. This is shown as follows for the following function declaration:  \n  \n```  \nint  __stdcall MyFunc (int a, double b);  \nvoid __stdcall InitCode (void);  \n```  \n  \n In the .DEF file:  \n  \n```  \nEXPORTS  \n   MYFUNC=_MyFunc@12  \n   INITCODE=_InitCode@0  \n```  \n  \n For DLLs to be called by programs written in Visual Basic, the alias technique shown in this topic is needed in the .def file. If the alias is done in the Visual Basic program, use of aliasing in the .def file is not necessary. It can be done in the Visual Basic program by adding an alias clause to the [Declare](/dotnet/articles/visual-basic/language-reference/statements/declare-statement) statement.  \n  \n## What do you want to know more about?  \n  \n-   [Exporting from a DLL](../build/exporting-from-a-dll.md)  \n  \n-   [Exporting from a DLL using .DEF files](../build/exporting-from-a-dll-using-def-files.md)  \n  \n-   [Exporting from a DLL using __declspec(dllexport)](../build/exporting-from-a-dll-using-declspec-dllexport.md)  \n  \n-   [Exporting C++ functions for use in C-language executables](../build/exporting-cpp-functions-for-use-in-c-language-executables.md)  \n  \n-   [Determining which exporting method to use](../build/determining-which-exporting-method-to-use.md)  \n  \n-   [Decorated names](../build/reference/decorated-names.md)  \n  \n## See Also  \n [DLLs in Visual C++](../build/dlls-in-visual-cpp.md)"}