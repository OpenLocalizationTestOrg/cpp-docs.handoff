{"nodes":[{"pos":[12,49],"content":"COleDataObject Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleDataObject Class | Microsoft Docs","pos":[0,37]}]},{"pos":[1012,1032],"content":"COleDataObject Class","linkify":"COleDataObject Class","nodes":[{"content":"COleDataObject Class","pos":[0,20]}]},{"content":"Used in data transfers for retrieving data in various formats from the Clipboard, through drag and drop, or from an embedded OLE item.","pos":[1033,1167]},{"pos":[1176,1182],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1229,1236],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1246,1265],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1272,1276]},{"content":"Description","pos":[1277,1288]},{"pos":[1326,1391],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::COleDataObject<ept id=\"p1\">](#coledataobject__coledataobject)</ept>","source":"[COleDataObject::COleDataObject](#coledataobject__coledataobject)"},{"pos":[1392,1429],"content":"Constructs a <ph id=\"ph1\">`COleDataObject`</ph> object.","source":"Constructs a `COleDataObject` object."},{"pos":[1440,1454],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1461,1465]},{"content":"Description","pos":[1466,1477]},{"pos":[1515,1564],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::Attach<ept id=\"p1\">](#coledataobject__attach)</ept>","source":"[COleDataObject::Attach](#coledataobject__attach)"},{"pos":[1565,1628],"content":"Attaches the specified OLE data object to the <ph id=\"ph1\">`COleDataObject`</ph>.","source":"Attaches the specified OLE data object to the `COleDataObject`."},{"pos":[1633,1700],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::AttachClipboard<ept id=\"p1\">](#coledataobject__attachclipboard)</ept>","source":"[COleDataObject::AttachClipboard](#coledataobject__attachclipboard)"},{"content":"Attaches the data object that is on the Clipboard.","pos":[1701,1751]},{"pos":[1756,1825],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::BeginEnumFormats<ept id=\"p1\">](#coledataobject__beginenumformats)</ept>","source":"[COleDataObject::BeginEnumFormats](#coledataobject__beginenumformats)"},{"pos":[1826,1884],"content":"Prepares for one or more subsequent <ph id=\"ph1\">`GetNextFormat`</ph> calls.","source":"Prepares for one or more subsequent `GetNextFormat` calls."},{"pos":[1889,1938],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::Detach<ept id=\"p1\">](#coledataobject__detach)</ept>","source":"[COleDataObject::Detach](#coledataobject__detach)"},{"pos":[1939,1984],"content":"Detaches the associated <ph id=\"ph1\">`IDataObject`</ph> object.","source":"Detaches the associated `IDataObject` object."},{"pos":[1989,2040],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::GetData<ept id=\"p1\">](#coledataobject__getdata)</ept>","source":"[COleDataObject::GetData](#coledataobject__getdata)"},{"content":"Copies data from the attached OLE data object in a specified format.","pos":[2041,2109]},{"pos":[2114,2173],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::GetFileData<ept id=\"p1\">](#coledataobject__getfiledata)</ept>","source":"[COleDataObject::GetFileData](#coledataobject__getfiledata)"},{"pos":[2174,2267],"content":"Copies data from the attached OLE data object into a <ph id=\"ph1\">`CFile`</ph> pointer in the specified format.","source":"Copies data from the attached OLE data object into a `CFile` pointer in the specified format."},{"pos":[2272,2335],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::GetGlobalData<ept id=\"p1\">](#coledataobject__getglobaldata)</ept>","source":"[COleDataObject::GetGlobalData](#coledataobject__getglobaldata)"},{"pos":[2336,2424],"content":"Copies data from the attached OLE data object into an <ph id=\"ph1\">`HGLOBAL`</ph> in the specified format.","source":"Copies data from the attached OLE data object into an `HGLOBAL` in the specified format."},{"pos":[2429,2492],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::GetNextFormat<ept id=\"p1\">](#coledataobject__getnextformat)</ept>","source":"[COleDataObject::GetNextFormat](#coledataobject__getnextformat)"},{"content":"Returns the next data format available.","pos":[2493,2532]},{"pos":[2537,2604],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::IsDataAvailable<ept id=\"p1\">](#coledataobject__isdataavailable)</ept>","source":"[COleDataObject::IsDataAvailable](#coledataobject__isdataavailable)"},{"content":"Checks whether data is available in a specified format.","pos":[2605,2660]},{"pos":[2665,2716],"content":"<bpt id=\"p1\">[</bpt>COleDataObject::Release<ept id=\"p1\">](#coledataobject__release)</ept>","source":"[COleDataObject::Release](#coledataobject__release)"},{"pos":[2717,2775],"content":"Detaches and releases the associated <ph id=\"ph1\">`IDataObject`</ph> object.","source":"Detaches and releases the associated `IDataObject` object."},{"pos":[2785,2792],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2796,2840],"content":"<ph id=\"ph1\">`COleDataObject`</ph> does not have a base class.","source":"`COleDataObject` does not have a base class."},{"content":"These kinds of data transfers include a source and a destination.","pos":[2847,2912]},{"content":"The data source is implemented as an object of the <bpt id=\"p1\">[</bpt>COleDataSource<ept id=\"p1\">](../../mfc/reference/coledatasource-class.md)</ept> class.","pos":[2913,3032],"source":" The data source is implemented as an object of the [COleDataSource](../../mfc/reference/coledatasource-class.md) class."},{"content":"Whenever a destination application has data dropped in it or is asked to perform a paste operation from the Clipboard, an object of the <ph id=\"ph1\">`COleDataObject`</ph> class must be created.","pos":[3033,3208],"source":" Whenever a destination application has data dropped in it or is asked to perform a paste operation from the Clipboard, an object of the `COleDataObject` class must be created."},{"content":"This class enables you to determine whether the data exists in a specified format.","pos":[3215,3297]},{"content":"You can also enumerate the available data formats or check whether a given format is available and then retrieve the data in the preferred format.","pos":[3298,3444]},{"content":"Object retrieval can be accomplished in several different ways, including the use of a <bpt id=\"p1\">[</bpt>CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md)</ept>, an <ph id=\"ph1\">`HGLOBAL`</ph>, or an <bpt id=\"p2\">**</bpt>STGMEDIUM<ept id=\"p2\">**</ept> structure.","pos":[3445,3621],"source":" Object retrieval can be accomplished in several different ways, including the use of a [CFile](../../mfc/reference/cfile-class.md), an `HGLOBAL`, or an **STGMEDIUM** structure."},{"pos":[3628,3799],"content":"For more information, see the <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3806,3975],"content":"For more information about using data objects in your application, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources (OLE)<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-ole.md)</ept>.","source":"For more information about using data objects in your application, see the article [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md)."},{"pos":[3984,4005],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[4034,4046],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4050,4070],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxole.h","source":"**Header:** afxole.h"},{"pos":[4080,4141],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__attach\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::Attach","linkify":"<a name=\"coledataobject__attach\"></a>  COleDataObject::Attach","source":"<a name=\"coledataobject__attach\"></a>  COleDataObject::Attach"},{"pos":[4145,4229],"content":"Call this function to associate the <ph id=\"ph1\">`COleDataObject`</ph> object with an OLE data object.","source":"Call this function to associate the `COleDataObject` object with an OLE data object."},{"pos":[4331,4341],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>lpDataObject<ept id=\"p1\">*</ept>","pos":[4345,4359],"source":"*lpDataObject*"},{"content":"Points to an OLE data object.","pos":[4363,4392]},{"content":"<bpt id=\"p1\"> **</bpt>TRUE<ept id=\"p1\">**</ept> if the OLE data object should be released when the <ph id=\"ph1\">`COleDataObject`</ph> object is destroyed; otherwise <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","pos":[4416,4535],"source":" **TRUE** if the OLE data object should be released when the `COleDataObject` object is destroyed; otherwise **FALSE**."},{"pos":[4545,4552],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4556,4715],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDataObject<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms688421)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4725,4804],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__attachclipboard\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::AttachClipboard","linkify":"<a name=\"coledataobject__attachclipboard\"></a>  COleDataObject::AttachClipboard","source":"<a name=\"coledataobject__attachclipboard\"></a>  COleDataObject::AttachClipboard"},{"pos":[4808,4919],"content":"Call this function to attach the data object that is currently on the Clipboard to the <ph id=\"ph1\">`COleDataObject`</ph> object.","source":"Call this function to attach the data object that is currently on the Clipboard to the `COleDataObject` object."},{"pos":[4968,4980],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[4984,5019]},{"pos":[5029,5036],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5044,5413],"content":"[!NOTE]\n Calling this function locks the Clipboard until this data object is released. The data object is released in the destructor for the `COleDataObject`. For more information, see [OpenClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649048) and [CloseClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649035) in the Win32 documention.","leadings":["","> "],"nodes":[{"content":" Calling this function locks the Clipboard until this data object is released. The data object is released in the destructor for the `COleDataObject`. For more information, see [OpenClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649048) and [CloseClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649035) in the Win32 documention.","pos":[8,367],"nodes":[{"content":"Calling this function locks the Clipboard until this data object is released.","pos":[1,78]},{"content":"The data object is released in the destructor for the <ph id=\"ph1\">`COleDataObject`</ph>.","pos":[79,150],"source":" The data object is released in the destructor for the `COleDataObject`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>OpenClipboard<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649048)</ept> and <bpt id=\"p2\">[</bpt>CloseClipboard<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms649035)</ept> in the Win32 documention.","pos":[151,359],"source":" For more information, see [OpenClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649048) and [CloseClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649035) in the Win32 documention."}]}]},{"pos":[5423,5504],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__beginenumformats\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::BeginEnumFormats","linkify":"<a name=\"coledataobject__beginenumformats\"></a>  COleDataObject::BeginEnumFormats","source":"<a name=\"coledataobject__beginenumformats\"></a>  COleDataObject::BeginEnumFormats"},{"pos":[5508,5630],"content":"Call this function to prepare for subsequent calls to <ph id=\"ph1\">`GetNextFormat`</ph> for retrieving a list of data formats from the item.","source":"Call this function to prepare for subsequent calls to `GetNextFormat` for retrieving a list of data formats from the item."},{"pos":[5680,5687],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"After a call to <ph id=\"ph1\">`BeginEnumFormats`</ph>, the position of the first format supported by this data object is stored.","pos":[5691,5800],"source":"After a call to `BeginEnumFormats`, the position of the first format supported by this data object is stored."},{"content":"Successive calls to <ph id=\"ph1\">`GetNextFormat`</ph> will enumerate the list of available formats in the data object.","pos":[5801,5901],"source":" Successive calls to `GetNextFormat` will enumerate the list of available formats in the data object."},{"pos":[5908,6036],"content":"To check on the availability of data in a given format, use <bpt id=\"p1\">[</bpt>COleDataObject::IsDataAvailable<ept id=\"p1\">](#coledataobject__isdataavailable)</ept>.","source":"To check on the availability of data in a given format, use [COleDataObject::IsDataAvailable](#coledataobject__isdataavailable)."},{"pos":[6043,6217],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDataObject::EnumFormatEtc<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683979)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDataObject::EnumFormatEtc](http://msdn.microsoft.com/library/windows/desktop/ms683979) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6227,6304],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__coledataobject\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::COleDataObject","linkify":"<a name=\"coledataobject__coledataobject\"></a>  COleDataObject::COleDataObject","source":"<a name=\"coledataobject__coledataobject\"></a>  COleDataObject::COleDataObject"},{"pos":[6308,6345],"content":"Constructs a <ph id=\"ph1\">`COleDataObject`</ph> object.","source":"Constructs a `COleDataObject` object."},{"pos":[6388,6395],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6399,6591],"content":"A call to <bpt id=\"p1\">[</bpt>COleDataObject::Attach<ept id=\"p1\">](#coledataobject__attach)</ept> or <bpt id=\"p2\">[</bpt>COleDataObject::AttachClipboard<ept id=\"p2\">](#coledataobject__attachclipboard)</ept> must be made before calling other <ph id=\"ph1\">`COleDataObject`</ph> functions.","source":"A call to [COleDataObject::Attach](#coledataobject__attach) or [COleDataObject::AttachClipboard](#coledataobject__attachclipboard) must be made before calling other `COleDataObject` functions."},{"pos":[6599,6771],"content":"[!NOTE]\n Since one of the parameters to the drag-and-drop handlers is a pointer to a `COleDataObject`, there is no need to call this constructor to support drag and drop.","leadings":["","> "],"nodes":[{"content":"Since one of the parameters to the drag-and-drop handlers is a pointer to a <ph id=\"ph1\">`COleDataObject`</ph>, there is no need to call this constructor to support drag and drop.","pos":[9,170],"source":" Since one of the parameters to the drag-and-drop handlers is a pointer to a `COleDataObject`, there is no need to call this constructor to support drag and drop."}]},{"pos":[6781,6842],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__detach\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::Detach","linkify":"<a name=\"coledataobject__detach\"></a>  COleDataObject::Detach","source":"<a name=\"coledataobject__detach\"></a>  COleDataObject::Detach"},{"pos":[6846,6973],"content":"Call this function to detach the <ph id=\"ph1\">`COleDataObject`</ph> object from its associated OLE data object without releasing the data object.","source":"Call this function to detach the `COleDataObject` object from its associated OLE data object without releasing the data object."},{"pos":[7021,7033],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to the OLE data object that was detached.","pos":[7037,7088]},{"pos":[7098,7105],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7115,7178],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__getdata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::GetData","linkify":"<a name=\"coledataobject__getdata\"></a>  COleDataObject::GetData","source":"<a name=\"coledataobject__getdata\"></a>  COleDataObject::GetData"},{"content":"Call this function to retrieve data from the item in the specified format.","pos":[7182,7256]},{"pos":[7390,7400],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The format in which data is to be returned.","pos":[7418,7461]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[7462,7663],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>STGMEDIUM<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> structure that will receive data.","pos":[7687,7804],"source":" Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure that will receive data."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which data is to be returned.","pos":[7828,7976],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[7977,8117],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[8118,8217],"source":" If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure."},{"pos":[8227,8239],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[8243,8278]},{"pos":[8288,8295],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[8299,8617],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDataObject::GetData<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms678431)</ept>, <bpt id=\"p2\">[</bpt>STGMEDIUM<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept>, and <bpt id=\"p3\">[</bpt>FORMATETC<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431), [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812), and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8624,8795],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8805,8876],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__getfiledata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::GetFileData","linkify":"<a name=\"coledataobject__getfiledata\"></a>  COleDataObject::GetFileData","source":"<a name=\"coledataobject__getfiledata\"></a>  COleDataObject::GetFileData"},{"pos":[8880,9013],"content":"Call this function to create a <ph id=\"ph1\">`CFile`</ph> or <ph id=\"ph2\">`CFile`</ph>-derived object and to retrieve data in the specified format into a <ph id=\"ph3\">`CFile`</ph> pointer.","source":"Call this function to create a `CFile` or `CFile`-derived object and to retrieve data in the specified format into a `CFile` pointer."},{"pos":[9122,9132],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The format in which data is to be returned.","pos":[9150,9193]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[9194,9395],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which data is to be returned.","pos":[9419,9567],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[9568,9708],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[9709,9808],"source":" If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure."},{"pos":[9818,9830],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[9834,9941],"content":"Pointer to the new <ph id=\"ph1\">`CFile`</ph> or <ph id=\"ph2\">`CFile`</ph>-derived object containing the data if successful; otherwise <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"Pointer to the new `CFile` or `CFile`-derived object containing the data if successful; otherwise **NULL**."},{"pos":[9951,9958],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[9962,10107],"content":"Depending on the medium the data is stored in, the actual type pointed to by the return value may be <ph id=\"ph1\">`CFile`</ph>, <ph id=\"ph2\">`CSharedFile`</ph>, or <ph id=\"ph3\">`COleStreamFile`</ph>.","source":"Depending on the medium the data is stored in, the actual type pointed to by the return value may be `CFile`, `CSharedFile`, or `COleStreamFile`."},{"pos":[10115,10313],"content":"[!NOTE]\n The `CFile` object accessed by the return value of this function is owned by the caller. It is the responsibility of the caller to **delete** the `CFile` object, thereby closing the file.","leadings":["","> "],"nodes":[{"content":" The `CFile` object accessed by the return value of this function is owned by the caller. It is the responsibility of the caller to **delete** the `CFile` object, thereby closing the file.","pos":[8,196],"nodes":[{"content":"The <ph id=\"ph1\">`CFile`</ph> object accessed by the return value of this function is owned by the caller.","pos":[1,89],"source":" The `CFile` object accessed by the return value of this function is owned by the caller."},{"content":"It is the responsibility of the caller to <bpt id=\"p1\">**</bpt>delete<ept id=\"p1\">**</ept> the <ph id=\"ph1\">`CFile`</ph> object, thereby closing the file.","pos":[90,188],"source":" It is the responsibility of the caller to **delete** the `CFile` object, thereby closing the file."}]}]},{"pos":[10320,10477],"content":"For more information, see <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[10484,10655],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[10665,10740],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__getglobaldata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::GetGlobalData","linkify":"<a name=\"coledataobject__getglobaldata\"></a>  COleDataObject::GetGlobalData","source":"<a name=\"coledataobject__getglobaldata\"></a>  COleDataObject::GetGlobalData"},{"pos":[10744,10860],"content":"Call this function to allocate a global memory block and to retrieve data in the specified format into an <ph id=\"ph1\">`HGLOBAL`</ph>.","source":"Call this function to allocate a global memory block and to retrieve data in the specified format into an `HGLOBAL`."},{"pos":[10972,10982],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The format in which data is to be returned.","pos":[11000,11043]},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[11044,11245],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format in which data is to be returned.","pos":[11269,11417],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned."},{"content":"Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[11418,11558],"source":" Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[11559,11658],"source":" If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure."},{"pos":[11668,11680],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[11684,11776],"content":"The handle of the global memory block containing the data if successful; otherwise <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"The handle of the global memory block containing the data if successful; otherwise **NULL**."},{"pos":[11786,11793],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[11797,11954],"content":"For more information, see <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[11961,12132],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[12142,12217],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__getnextformat\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::GetNextFormat","linkify":"<a name=\"coledataobject__getnextformat\"></a>  COleDataObject::GetNextFormat","source":"<a name=\"coledataobject__getnextformat\"></a>  COleDataObject::GetNextFormat"},{"content":"Call this function repeatedly to obtain all the formats available for retrieving data from the item.","pos":[12221,12321]},{"pos":[12391,12401],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure that receives the format information when the function call returns.","pos":[12422,12586],"source":" Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure that receives the format information when the function call returns."},{"pos":[12596,12608],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if another format is available; otherwise 0.","pos":[12612,12664]},{"pos":[12674,12681],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"After a call to <bpt id=\"p1\">[</bpt>COleDataObject::BeginEnumFormats<ept id=\"p1\">](#coledataobject__beginenumformats)</ept>, the position of the first format supported by this data object is stored.","pos":[12685,12845],"source":"After a call to [COleDataObject::BeginEnumFormats](#coledataobject__beginenumformats), the position of the first format supported by this data object is stored."},{"content":"Successive calls to <ph id=\"ph1\">`GetNextFormat`</ph> will enumerate the list of available formats in the data object.","pos":[12846,12946],"source":" Successive calls to `GetNextFormat` will enumerate the list of available formats in the data object."},{"content":"Use these functions to list the available formats.","pos":[12947,12997]},{"pos":[13004,13126],"content":"To check for the availability of a given format, call <bpt id=\"p1\">[</bpt>COleDataObject::IsDataAvailable<ept id=\"p1\">](#coledataobject__isdataavailable)</ept>.","source":"To check for the availability of a given format, call [COleDataObject::IsDataAvailable](#coledataobject__isdataavailable)."},{"pos":[13133,13286],"content":"For more information, see <bpt id=\"p1\">[</bpt>IEnumXXXX::Next<ept id=\"p1\">](https://msdn.microsoft.com/library/ms695273.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IEnumXXXX::Next](https://msdn.microsoft.com/library/ms695273.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[13296,13375],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__isdataavailable\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::IsDataAvailable","linkify":"<a name=\"coledataobject__isdataavailable\"></a>  COleDataObject::IsDataAvailable","source":"<a name=\"coledataobject__isdataavailable\"></a>  COleDataObject::IsDataAvailable"},{"content":"Call this function to determine if a particular format is available for retrieving data from the OLE item.","pos":[13379,13485]},{"pos":[13596,13606],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The Clipboard data format to be used in the structure pointed to by <ph id=\"ph1\">`lpFormatEtc`</ph>.","pos":[13624,13706],"source":" The Clipboard data format to be used in the structure pointed to by `lpFormatEtc`."},{"content":"This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> function.","pos":[13707,13908],"source":" This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function."},{"content":"Points to a <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure describing the format desired.","pos":[13932,14056],"source":" Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format desired."},{"content":"Provide a value for this parameter only if you want to specify additional format information beyond the Clipboard format specified by <ph id=\"ph1\">`cfFormat`</ph>.","pos":[14057,14202],"source":" Provide a value for this parameter only if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default values are used for the other fields in the <bpt id=\"p2\">**</bpt>FORMATETC<ept id=\"p2\">**</ept> structure.","pos":[14203,14302],"source":" If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure."},{"pos":[14312,14324],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if data is available in the specified format; otherwise 0.","pos":[14328,14394]},{"pos":[14404,14411],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[14415,14499],"content":"This function is useful before calling <ph id=\"ph1\">`GetData`</ph>, <ph id=\"ph2\">`GetFileData`</ph>, or <ph id=\"ph3\">`GetGlobalData`</ph>.","source":"This function is useful before calling `GetData`, `GetFileData`, or `GetGlobalData`."},{"pos":[14506,14755],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDataObject::QueryGetData<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680637)</ept> and <bpt id=\"p2\">[</bpt>FORMATETC<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDataObject::QueryGetData](http://msdn.microsoft.com/library/windows/desktop/ms680637) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[14762,14933],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterClipboardFormat<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms649049)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[14943,14950],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[14955,15083],"content":"See the example for <bpt id=\"p1\">[</bpt>CRichEditView::QueryAcceptData<ept id=\"p1\">](../../mfc/reference/cricheditview-class.md#cricheditview__queryacceptdata)</ept>.","source":"See the example for [CRichEditView::QueryAcceptData](../../mfc/reference/cricheditview-class.md#cricheditview__queryacceptdata)."},{"pos":[15093,15156],"content":"<bpt id=\"p1\">&lt;a name=\"coledataobject__release\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDataObject::Release","linkify":"<a name=\"coledataobject__release\"></a>  COleDataObject::Release","source":"<a name=\"coledataobject__release\"></a>  COleDataObject::Release"},{"pos":[15160,15352],"content":"Call this function to release ownership of the <bpt id=\"p1\">[</bpt>IDataObject<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms688421)</ept> object that was previously associated with the <ph id=\"ph1\">`COleDataObject`</ph> object.","source":"Call this function to release ownership of the [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) object that was previously associated with the `COleDataObject` object."},{"pos":[15393,15400],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`IDataObject`</ph> was associated with the <ph id=\"ph2\">`COleDataObject`</ph> by calling <bpt id=\"p1\">**</bpt>Attach<ept id=\"p1\">**</ept> or <ph id=\"ph3\">`AttachClipboard`</ph> explicitly or by the framework.","pos":[15404,15537],"source":"The `IDataObject` was associated with the `COleDataObject` by calling **Attach** or `AttachClipboard` explicitly or by the framework."},{"content":"If the <ph id=\"ph1\">`bAutoRelease`</ph> parameter of <bpt id=\"p1\">**</bpt>Attach<ept id=\"p1\">**</ept> is <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>, the <ph id=\"ph2\">`IDataObject`</ph> object will not be released.","pos":[15538,15644],"source":" If the `bAutoRelease` parameter of **Attach** is **FALSE**, the `IDataObject` object will not be released."},{"content":"In this case, the caller is responsible for releasing the <ph id=\"ph1\">`IDataObject`</ph> by calling <bpt id=\"p1\">[</bpt>IUnknown::Release<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682317)</ept>.","pos":[15645,15808],"source":" In this case, the caller is responsible for releasing the `IDataObject` by calling [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317)."},{"pos":[15817,15825],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>MFC Sample HIERSVR<ept id=\"p1\">](../../visual-cpp-samples.md)</ept><ph id=\"ph1\"> </ph>","pos":[15829,15879],"source":"[MFC Sample HIERSVR](../../visual-cpp-samples.md) "},{"content":"<bpt id=\"p1\"> [</bpt>MFC Sample OCLIENT<ept id=\"p1\">](../../visual-cpp-samples.md)</ept><ph id=\"ph1\"> </ph>","pos":[15882,15933],"source":" [MFC Sample OCLIENT](../../visual-cpp-samples.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[15936,15985],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>COleDataSource Class<ept id=\"p1\">](../../mfc/reference/coledatasource-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[15988,16057],"source":" [COleDataSource Class](../../mfc/reference/coledatasource-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>COleClientItem Class<ept id=\"p1\">](../../mfc/reference/coleclientitem-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[16060,16129],"source":" [COleClientItem Class](../../mfc/reference/coleclientitem-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>COleServerItem Class<ept id=\"p1\">](../../mfc/reference/coleserveritem-class.md)</ept>","pos":[16132,16200],"source":" [COleServerItem Class](../../mfc/reference/coleserveritem-class.md)"}],"content":"---\ntitle: \"COleDataObject Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"IDataObject\"\n  - \"COleDataObject\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"drag and drop [C++], MFC support\"\n  - \"Clipboard [C++], OLE support\"\n  - \"uniform data transfer\"\n  - \"OLE [C++], uniform data transfer\"\n  - \"Clipboard [C++], MFC support\"\n  - \"OLE Clipboard [C++], support\"\n  - \"IDataObject interface, MFC encapsulation\"\n  - \"data transfer [C++]\"\n  - \"data transfer [C++], OLE\"\n  - \"OLE data transfer [C++]\"\n  - \"COleDataObject class\"\n  - \"uniform data transfer, OLE\"\nms.assetid: d1cc84be-2e1c-4bb3-a8a0-565eb08aaa34\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleDataObject Class\nUsed in data transfers for retrieving data in various formats from the Clipboard, through drag and drop, or from an embedded OLE item.  \n  \n## Syntax  \n  \n```  \nclass COleDataObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDataObject::COleDataObject](#coledataobject__coledataobject)|Constructs a `COleDataObject` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDataObject::Attach](#coledataobject__attach)|Attaches the specified OLE data object to the `COleDataObject`.|  \n|[COleDataObject::AttachClipboard](#coledataobject__attachclipboard)|Attaches the data object that is on the Clipboard.|  \n|[COleDataObject::BeginEnumFormats](#coledataobject__beginenumformats)|Prepares for one or more subsequent `GetNextFormat` calls.|  \n|[COleDataObject::Detach](#coledataobject__detach)|Detaches the associated `IDataObject` object.|  \n|[COleDataObject::GetData](#coledataobject__getdata)|Copies data from the attached OLE data object in a specified format.|  \n|[COleDataObject::GetFileData](#coledataobject__getfiledata)|Copies data from the attached OLE data object into a `CFile` pointer in the specified format.|  \n|[COleDataObject::GetGlobalData](#coledataobject__getglobaldata)|Copies data from the attached OLE data object into an `HGLOBAL` in the specified format.|  \n|[COleDataObject::GetNextFormat](#coledataobject__getnextformat)|Returns the next data format available.|  \n|[COleDataObject::IsDataAvailable](#coledataobject__isdataavailable)|Checks whether data is available in a specified format.|  \n|[COleDataObject::Release](#coledataobject__release)|Detaches and releases the associated `IDataObject` object.|  \n  \n## Remarks  \n `COleDataObject` does not have a base class.  \n  \n These kinds of data transfers include a source and a destination. The data source is implemented as an object of the [COleDataSource](../../mfc/reference/coledatasource-class.md) class. Whenever a destination application has data dropped in it or is asked to perform a paste operation from the Clipboard, an object of the `COleDataObject` class must be created.  \n  \n This class enables you to determine whether the data exists in a specified format. You can also enumerate the available data formats or check whether a given format is available and then retrieve the data in the preferred format. Object retrieval can be accomplished in several different ways, including the use of a [CFile](../../mfc/reference/cfile-class.md), an `HGLOBAL`, or an **STGMEDIUM** structure.  \n  \n For more information, see the [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information about using data objects in your application, see the article [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md).  \n  \n## Inheritance Hierarchy  \n `COleDataObject`  \n  \n## Requirements  \n **Header:** afxole.h  \n  \n##  <a name=\"coledataobject__attach\"></a>  COleDataObject::Attach  \n Call this function to associate the `COleDataObject` object with an OLE data object.  \n  \n```  \nvoid Attach(\n    LPDATAOBJECT lpDataObject,  \n    BOOL bAutoRelease = TRUE);\n```  \n  \n### Parameters  \n *lpDataObject*  \n Points to an OLE data object.  \n  \n `bAutoRelease`  \n **TRUE** if the OLE data object should be released when the `COleDataObject` object is destroyed; otherwise **FALSE**.  \n  \n### Remarks  \n For more information, see [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__attachclipboard\"></a>  COleDataObject::AttachClipboard  \n Call this function to attach the data object that is currently on the Clipboard to the `COleDataObject` object.  \n  \n```  \nBOOL AttachClipboard();\n```  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n  \n> [!NOTE]\n>  Calling this function locks the Clipboard until this data object is released. The data object is released in the destructor for the `COleDataObject`. For more information, see [OpenClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649048) and [CloseClipboard](http://msdn.microsoft.com/library/windows/desktop/ms649035) in the Win32 documention.  \n  \n##  <a name=\"coledataobject__beginenumformats\"></a>  COleDataObject::BeginEnumFormats  \n Call this function to prepare for subsequent calls to `GetNextFormat` for retrieving a list of data formats from the item.  \n  \n```  \nvoid BeginEnumFormats();\n```  \n  \n### Remarks  \n After a call to `BeginEnumFormats`, the position of the first format supported by this data object is stored. Successive calls to `GetNextFormat` will enumerate the list of available formats in the data object.  \n  \n To check on the availability of data in a given format, use [COleDataObject::IsDataAvailable](#coledataobject__isdataavailable).  \n  \n For more information, see [IDataObject::EnumFormatEtc](http://msdn.microsoft.com/library/windows/desktop/ms683979) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__coledataobject\"></a>  COleDataObject::COleDataObject  \n Constructs a `COleDataObject` object.  \n  \n```  \nCOleDataObject();\n```  \n  \n### Remarks  \n A call to [COleDataObject::Attach](#coledataobject__attach) or [COleDataObject::AttachClipboard](#coledataobject__attachclipboard) must be made before calling other `COleDataObject` functions.  \n  \n> [!NOTE]\n>  Since one of the parameters to the drag-and-drop handlers is a pointer to a `COleDataObject`, there is no need to call this constructor to support drag and drop.  \n  \n##  <a name=\"coledataobject__detach\"></a>  COleDataObject::Detach  \n Call this function to detach the `COleDataObject` object from its associated OLE data object without releasing the data object.  \n  \n```  \nLPDATAOBJECT Detach();\n```  \n  \n### Return Value  \n A pointer to the OLE data object that was detached.  \n  \n### Remarks  \n  \n##  <a name=\"coledataobject__getdata\"></a>  COleDataObject::GetData  \n Call this function to retrieve data from the item in the specified format.  \n  \n```  \nBOOL GetData(\n    CLIPFORMAT cfFormat,  \n    LPSTGMEDIUM lpStgMedium,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The format in which data is to be returned. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpStgMedium`  \n Points to a [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure that will receive data.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n For more information, see [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431), [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812), and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__getfiledata\"></a>  COleDataObject::GetFileData  \n Call this function to create a `CFile` or `CFile`-derived object and to retrieve data in the specified format into a `CFile` pointer.  \n  \n```  \nCFile* GetFileData(\n    CLIPFORMAT cfFormat,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The format in which data is to be returned. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Return Value  \n Pointer to the new `CFile` or `CFile`-derived object containing the data if successful; otherwise **NULL**.  \n  \n### Remarks  \n Depending on the medium the data is stored in, the actual type pointed to by the return value may be `CFile`, `CSharedFile`, or `COleStreamFile`.  \n  \n> [!NOTE]\n>  The `CFile` object accessed by the return value of this function is owned by the caller. It is the responsibility of the caller to **delete** the `CFile` object, thereby closing the file.  \n  \n For more information, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__getglobaldata\"></a>  COleDataObject::GetGlobalData  \n Call this function to allocate a global memory block and to retrieve data in the specified format into an `HGLOBAL`.  \n  \n```  \nHGLOBAL GetGlobalData(\n    CLIPFORMAT cfFormat,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The format in which data is to be returned. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format in which data is to be returned. Provide a value for this parameter if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Return Value  \n The handle of the global memory block containing the data if successful; otherwise **NULL**.  \n  \n### Remarks  \n For more information, see [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__getnextformat\"></a>  COleDataObject::GetNextFormat  \n Call this function repeatedly to obtain all the formats available for retrieving data from the item.  \n  \n```  \nBOOL GetNextFormat(LPFORMATETC lpFormatEtc);\n```  \n  \n### Parameters  \n `lpFormatEtc`  \n Points to the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure that receives the format information when the function call returns.  \n  \n### Return Value  \n Nonzero if another format is available; otherwise 0.  \n  \n### Remarks  \n After a call to [COleDataObject::BeginEnumFormats](#coledataobject__beginenumformats), the position of the first format supported by this data object is stored. Successive calls to `GetNextFormat` will enumerate the list of available formats in the data object. Use these functions to list the available formats.  \n  \n To check for the availability of a given format, call [COleDataObject::IsDataAvailable](#coledataobject__isdataavailable).  \n  \n For more information, see [IEnumXXXX::Next](https://msdn.microsoft.com/library/ms695273.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledataobject__isdataavailable\"></a>  COleDataObject::IsDataAvailable  \n Call this function to determine if a particular format is available for retrieving data from the OLE item.  \n  \n```  \nBOOL IsDataAvailable(\n    CLIPFORMAT cfFormat,  \n    LPFORMATETC lpFormatEtc = NULL);\n```  \n  \n### Parameters  \n `cfFormat`  \n The Clipboard data format to be used in the structure pointed to by `lpFormatEtc`. This parameter can be one of the predefined Clipboard formats or the value returned by the native Windows [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) function.  \n  \n `lpFormatEtc`  \n Points to a [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure describing the format desired. Provide a value for this parameter only if you want to specify additional format information beyond the Clipboard format specified by `cfFormat`. If it is **NULL**, the default values are used for the other fields in the **FORMATETC** structure.  \n  \n### Return Value  \n Nonzero if data is available in the specified format; otherwise 0.  \n  \n### Remarks  \n This function is useful before calling `GetData`, `GetFileData`, or `GetGlobalData`.  \n  \n For more information, see [IDataObject::QueryGetData](http://msdn.microsoft.com/library/windows/desktop/ms680637) and [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see [RegisterClipboardFormat](http://msdn.microsoft.com/library/windows/desktop/ms649049) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n  See the example for [CRichEditView::QueryAcceptData](../../mfc/reference/cricheditview-class.md#cricheditview__queryacceptdata).  \n  \n##  <a name=\"coledataobject__release\"></a>  COleDataObject::Release  \n Call this function to release ownership of the [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) object that was previously associated with the `COleDataObject` object.  \n  \n```  \nvoid Release();\n```  \n  \n### Remarks  \n The `IDataObject` was associated with the `COleDataObject` by calling **Attach** or `AttachClipboard` explicitly or by the framework. If the `bAutoRelease` parameter of **Attach** is **FALSE**, the `IDataObject` object will not be released. In this case, the caller is responsible for releasing the `IDataObject` by calling [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317).  \n  \n## See Also  \n [MFC Sample HIERSVR](../../visual-cpp-samples.md)   \n [MFC Sample OCLIENT](../../visual-cpp-samples.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [COleDataSource Class](../../mfc/reference/coledatasource-class.md)   \n [COleClientItem Class](../../mfc/reference/coleclientitem-class.md)   \n [COleServerItem Class](../../mfc/reference/coleserveritem-class.md)\n"}