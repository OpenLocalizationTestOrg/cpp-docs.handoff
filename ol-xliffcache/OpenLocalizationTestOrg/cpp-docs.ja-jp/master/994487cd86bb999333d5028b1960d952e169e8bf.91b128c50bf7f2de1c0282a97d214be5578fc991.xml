{"nodes":[{"pos":[12,58],"content":"MFC ActiveX Controls: Methods | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Methods | Microsoft Docs","pos":[0,46]}]},{"content":"MFC ActiveX Controls: Methods","pos":[597,626]},{"content":"An ActiveX control fires events to communicate between itself and its control container.","pos":[627,715]},{"content":"A container can also communicate with a control by means of methods and properties.","pos":[716,799]},{"content":"Methods are also called functions.","pos":[800,834]},{"content":"Methods and properties provide an exported interface for use by other applications, such as Automation clients and ActiveX control containers.","pos":[841,983]},{"content":"For more information on ActiveX control properties, see the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Properties<ept id=\"p1\">](../mfc/mfc-activex-controls-properties.md)</ept>.","pos":[984,1130],"source":" For more information on ActiveX control properties, see the article [MFC ActiveX Controls: Properties](../mfc/mfc-activex-controls-properties.md)."},{"content":"Methods are similar in use and purpose to the member functions of a C++ class.","pos":[1137,1215]},{"content":"There are two types of methods your control can implement: stock and custom.","pos":[1216,1292]},{"content":"Similar to stock events, stock methods are those methods for which <bpt id=\"p1\">[</bpt>COleControl<ept id=\"p1\">](../mfc/reference/colecontrol-class.md)</ept> provides an implementation.","pos":[1293,1440],"source":" Similar to stock events, stock methods are those methods for which [COleControl](../mfc/reference/colecontrol-class.md) provides an implementation."},{"content":"For more information on stock methods, see the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Adding Stock Methods<ept id=\"p1\">](../mfc/mfc-activex-controls-adding-stock-methods.md)</ept>.","pos":[1441,1594],"source":" For more information on stock methods, see the article [MFC ActiveX Controls: Adding Stock Methods](../mfc/mfc-activex-controls-adding-stock-methods.md)."},{"content":"Custom methods, defined by the developer, allow additional customization of the control.","pos":[1595,1683]},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Adding Custom Methods<ept id=\"p1\">](../mfc/mfc-activex-controls-adding-custom-methods.md)</ept>.","pos":[1684,1822],"source":" For more information, see the article [MFC ActiveX Controls: Adding Custom Methods](../mfc/mfc-activex-controls-adding-custom-methods.md)."},{"content":"The Microsoft Foundation Class Library (MFC) implements a mechanism that allows your control to support stock and custom methods.","pos":[1829,1958]},{"content":"The first part is class <ph id=\"ph1\">`COleControl`</ph>.","pos":[1959,1997],"source":" The first part is class `COleControl`."},{"content":"Derived from <ph id=\"ph1\">`CWnd`</ph>, <ph id=\"ph2\">`COleControl`</ph> member functions support stock methods that are common to all ActiveX controls.","pos":[1998,2112],"source":" Derived from `CWnd`, `COleControl` member functions support stock methods that are common to all ActiveX controls."},{"content":"The second part of this mechanism is the dispatch map.","pos":[2113,2167]},{"content":"A dispatch map is similar to a message map; however, instead of mapping a function to a Windows message ID, a dispatch map maps virtual member functions to IDispatch IDS.","pos":[2168,2338]},{"content":"For a control to support various methods properly, its class must declare a dispatch map.","pos":[2345,2434]},{"content":"This is accomplished by the following line of code located in control class header (.H) file:","pos":[2435,2528]},{"pos":[2546,2561],"content":"NVC_MFC_AxUI#13"},{"content":"The main purpose of the dispatch map is to establish the relationship between the method names used by an external caller (such as the container) and the member functions of the control's class that implement the methods.","pos":[2627,2848]},{"content":"After the dispatch map has been declared, it needs to be defined in the control's implementation (.CPP) file.","pos":[2849,2958]},{"content":"The following lines of code define the dispatch map:","pos":[2959,3011]},{"content":"NVC_MFC_AxUI#14","pos":[3029,3044]},{"content":"NVC_MFC_AxUI#15","pos":[3119,3134]},{"content":"If you used the <bpt id=\"p1\">[</bpt>MFC ActiveX Control Wizard<ept id=\"p1\">](../mfc/reference/mfc-activex-control-wizard.md)</ept> to create the project, these lines were added automatically.","pos":[3202,3355],"source":"If you used the [MFC ActiveX Control Wizard](../mfc/reference/mfc-activex-control-wizard.md) to create the project, these lines were added automatically."},{"content":"If the MFC ActiveX Control Wizard was not used, you must add these lines manually.","pos":[3356,3438]},{"content":"The following articles discuss methods in detail:","pos":[3445,3494]},{"content":"MFC ActiveX Controls: Adding Stock Methods","pos":[3505,3547]},{"content":"MFC ActiveX Controls: Adding Custom Methods","pos":[3612,3655]},{"content":"MFC ActiveX Controls: Returning Error Codes From a Method","pos":[3721,3778]},{"content":"See Also","pos":[3856,3864]},{"content":"MFC ActiveX Controls","pos":[3869,3889]}],"content":"---\ntitle: \"MFC ActiveX Controls: Methods | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, methods\"\nms.assetid: e20271de-6ffa-4ba0-848b-bafe6c9e510c\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Methods\nAn ActiveX control fires events to communicate between itself and its control container. A container can also communicate with a control by means of methods and properties. Methods are also called functions.  \n  \n Methods and properties provide an exported interface for use by other applications, such as Automation clients and ActiveX control containers. For more information on ActiveX control properties, see the article [MFC ActiveX Controls: Properties](../mfc/mfc-activex-controls-properties.md).  \n  \n Methods are similar in use and purpose to the member functions of a C++ class. There are two types of methods your control can implement: stock and custom. Similar to stock events, stock methods are those methods for which [COleControl](../mfc/reference/colecontrol-class.md) provides an implementation. For more information on stock methods, see the article [MFC ActiveX Controls: Adding Stock Methods](../mfc/mfc-activex-controls-adding-stock-methods.md). Custom methods, defined by the developer, allow additional customization of the control. For more information, see the article [MFC ActiveX Controls: Adding Custom Methods](../mfc/mfc-activex-controls-adding-custom-methods.md).  \n  \n The Microsoft Foundation Class Library (MFC) implements a mechanism that allows your control to support stock and custom methods. The first part is class `COleControl`. Derived from `CWnd`, `COleControl` member functions support stock methods that are common to all ActiveX controls. The second part of this mechanism is the dispatch map. A dispatch map is similar to a message map; however, instead of mapping a function to a Windows message ID, a dispatch map maps virtual member functions to IDispatch IDS.  \n  \n For a control to support various methods properly, its class must declare a dispatch map. This is accomplished by the following line of code located in control class header (.H) file:  \n  \n [!code-cpp[NVC_MFC_AxUI#13](../mfc/codesnippet/cpp/mfc-activex-controls-methods_1.h)]  \n  \n The main purpose of the dispatch map is to establish the relationship between the method names used by an external caller (such as the container) and the member functions of the control's class that implement the methods. After the dispatch map has been declared, it needs to be defined in the control's implementation (.CPP) file. The following lines of code define the dispatch map:  \n  \n [!code-cpp[NVC_MFC_AxUI#14](../mfc/codesnippet/cpp/mfc-activex-controls-methods_2.cpp)]  \n[!code-cpp[NVC_MFC_AxUI#15](../mfc/codesnippet/cpp/mfc-activex-controls-methods_3.cpp)]  \n  \n If you used the [MFC ActiveX Control Wizard](../mfc/reference/mfc-activex-control-wizard.md) to create the project, these lines were added automatically. If the MFC ActiveX Control Wizard was not used, you must add these lines manually.  \n  \n The following articles discuss methods in detail:  \n  \n-   [MFC ActiveX Controls: Adding Stock Methods](../mfc/mfc-activex-controls-adding-stock-methods.md)  \n  \n-   [MFC ActiveX Controls: Adding Custom Methods](../mfc/mfc-activex-controls-adding-custom-methods.md)  \n  \n-   [MFC ActiveX Controls: Returning Error Codes From a Method](../mfc/mfc-activex-controls-returning-error-codes-from-a-method.md)  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)\n\n"}