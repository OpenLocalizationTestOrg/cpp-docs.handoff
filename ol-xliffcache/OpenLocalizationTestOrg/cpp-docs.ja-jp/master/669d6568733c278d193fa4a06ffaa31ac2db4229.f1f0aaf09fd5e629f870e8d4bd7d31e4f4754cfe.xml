{"nodes":[{"pos":[12,51],"content":"Using Manual Accessors | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using Manual Accessors | Microsoft Docs","pos":[0,39]}]},{"content":"Using Manual Accessors","pos":[647,669]},{"content":"There are four things to do when handling an unknown command:","pos":[670,731]},{"content":"Determine the parameters","pos":[741,765]},{"content":"Execute the command","pos":[775,794]},{"content":"Determine the output columns","pos":[804,832]},{"content":"See if there are multiple return rowsets","pos":[842,882]},{"pos":[889,991],"content":"To do this with the OLE DB Consumer Templates, use the <ph id=\"ph1\">`CManualAccessor`</ph> class and follow these steps:","source":"To do this with the OLE DB Consumer Templates, use the `CManualAccessor` class and follow these steps:"},{"pos":[1001,1073],"content":"Open a <ph id=\"ph1\">`CCommand`</ph> object with <ph id=\"ph2\">`CManualAccessor`</ph> as a template parameter.","source":"Open a `CCommand` object with `CManualAccessor` as a template parameter."},{"content":"Query the session for the <bpt id=\"p1\">**</bpt>IDBSchemaRowset<ept id=\"p1\">**</ept> interface and use the procedure parameters rowset.","pos":[1169,1265],"source":"Query the session for the **IDBSchemaRowset** interface and use the procedure parameters rowset."},{"content":"If the <bpt id=\"p1\">**</bpt>IDBSchemaRowset<ept id=\"p1\">**</ept> interface is not available, query for the <ph id=\"ph1\">`ICommandWithParameters`</ph> interface.","pos":[1266,1370],"source":" If the **IDBSchemaRowset** interface is not available, query for the `ICommandWithParameters` interface."},{"content":"Call <ph id=\"ph1\">`GetParameterInfo`</ph> for information.","pos":[1371,1411],"source":" Call `GetParameterInfo` for information."},{"content":"If neither interface is available, you can assume there are no parameters.","pos":[1412,1486]},{"pos":[1496,1576],"content":"For each parameter, call <ph id=\"ph1\">`AddParameterEntry`</ph> to add the parameters and set them.","source":"For each parameter, call `AddParameterEntry` to add the parameters and set them."},{"pos":[1586,1642],"content":"Open the rowset but set the bind parameter to <bpt id=\"p1\">**</bpt>false<ept id=\"p1\">**</ept>.","source":"Open the rowset but set the bind parameter to **false**."},{"content":"Call <ph id=\"ph1\">`GetColumnInfo`</ph> to retrieve the output columns.","pos":[1652,1704],"source":"Call `GetColumnInfo` to retrieve the output columns."},{"content":"Use <ph id=\"ph1\">`AddBindEntry`</ph> to add the output column to the binding.","pos":[1705,1764],"source":" Use `AddBindEntry` to add the output column to the binding."},{"content":"Call <ph id=\"ph1\">`GetNextResult`</ph> to determine if more rowsets are available.","pos":[1774,1838],"source":"Call `GetNextResult` to determine if more rowsets are available."},{"content":"Repeat steps 2 through 5.","pos":[1839,1864]},{"pos":[1871,2038],"content":"For an example of a manual accessor, see <bpt id=\"p1\">**</bpt>CDBListView::CallProcedure<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">[</bpt>DBVIEWER<ept id=\"p2\">](http://msdn.microsoft.com/en-us/07620f99-c347-4d09-9ebc-2459e8049832)</ept> sample.","source":"For an example of a manual accessor, see **CDBListView::CallProcedure** in the [DBVIEWER](http://msdn.microsoft.com/en-us/07620f99-c347-4d09-9ebc-2459e8049832) sample."},{"content":"See Also","pos":[2047,2055]},{"content":"Using Accessors","pos":[2060,2075]}],"content":"---\ntitle: \"Using Manual Accessors | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"command handling, OLE DB Templates\"\n  - \"manual accessors\"\n  - \"accessors [C++], manual\"\nms.assetid: 29f00a89-0240-482b-8413-4120b9644672\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Using Manual Accessors\nThere are four things to do when handling an unknown command:  \n  \n-   Determine the parameters  \n  \n-   Execute the command  \n  \n-   Determine the output columns  \n  \n-   See if there are multiple return rowsets  \n  \n To do this with the OLE DB Consumer Templates, use the `CManualAccessor` class and follow these steps:  \n  \n1.  Open a `CCommand` object with `CManualAccessor` as a template parameter.  \n  \n    ```  \n    CCommand<CManualAccessor, CRowset, CMultipleResults> rs;  \n    ```  \n  \n2.  Query the session for the **IDBSchemaRowset** interface and use the procedure parameters rowset. If the **IDBSchemaRowset** interface is not available, query for the `ICommandWithParameters` interface. Call `GetParameterInfo` for information. If neither interface is available, you can assume there are no parameters.  \n  \n3.  For each parameter, call `AddParameterEntry` to add the parameters and set them.  \n  \n4.  Open the rowset but set the bind parameter to **false**.  \n  \n5.  Call `GetColumnInfo` to retrieve the output columns. Use `AddBindEntry` to add the output column to the binding.  \n  \n6.  Call `GetNextResult` to determine if more rowsets are available. Repeat steps 2 through 5.  \n  \n For an example of a manual accessor, see **CDBListView::CallProcedure** in the [DBVIEWER](http://msdn.microsoft.com/en-us/07620f99-c347-4d09-9ebc-2459e8049832) sample.  \n  \n## See Also  \n [Using Accessors](../../data/oledb/using-accessors.md)"}