{"nodes":[{"pos":[12,44],"content":"Category Macros | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Category Macros | Microsoft Docs","pos":[0,32]}]},{"content":"Category Macros","pos":[527,542]},{"content":"These macros define category maps.","pos":[543,577]},{"content":"BEGIN_CATEGORY_MAP","pos":[599,617]},{"content":"Marks the beginning of the category map.","pos":[640,680]},{"content":"END_CATEGORY_MAP","pos":[686,702]},{"content":"Marks the end of the category map.","pos":[723,757]},{"content":"IMPLEMENTED_CATEGORY","pos":[763,783]},{"content":"Indicates categories that are implemented by the COM object.","pos":[808,868]},{"content":"REQUIRED_CATEGORY","pos":[874,891]},{"content":"Indicates categories that are required of the container by the COM object.","pos":[913,987]},{"pos":[1033,1051],"content":"BEGIN_CATEGORY_MAP"},{"content":"Marks the beginning of the category map.","pos":[1055,1095]},{"content":"Parameters","pos":[1147,1157]},{"content":"[in] The name of the class containing the category map.","pos":[1175,1230]},{"content":"Remarks","pos":[1240,1247]},{"content":"The category map is used to specify which component categories the COM class will implement and which categories it requires from its container.","pos":[1251,1395]},{"content":"Add an <bpt id=\"p1\">[</bpt>IMPLEMENTED_CATEGORY<ept id=\"p1\">](#implemented_category)</ept> entry to the map for each category implemented by the COM class.","pos":[1402,1519],"source":"Add an [IMPLEMENTED_CATEGORY](#implemented_category) entry to the map for each category implemented by the COM class."},{"content":"Add a <bpt id=\"p1\">[</bpt>REQUIRED_CATEGORY<ept id=\"p1\">](#required_category)</ept> entry to the map for each category that the class requires its clients to implement.","pos":[1520,1650],"source":" Add a [REQUIRED_CATEGORY](#required_category) entry to the map for each category that the class requires its clients to implement."},{"content":"Mark the end of the map with the <bpt id=\"p1\">[</bpt>END_CATEGORY_MAP<ept id=\"p1\">](#end_category_map)</ept> macro.","pos":[1651,1728],"source":" Mark the end of the map with the [END_CATEGORY_MAP](#end_category_map) macro."},{"pos":[1735,2071],"content":"The component categories listed in the map will be registered automatically when the module is registered if the class has an associated <bpt id=\"p1\">[</bpt>OBJECT_ENTRY_AUTO<ept id=\"p1\">](../../atl/reference/object-map-macros.md#object_entry_auto)</ept> or <bpt id=\"p2\">[</bpt>OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO<ept id=\"p2\">](../../atl/reference/object-map-macros.md#object_entry_non_createable_ex_auto)</ept>.","source":"The component categories listed in the map will be registered automatically when the module is registered if the class has an associated [OBJECT_ENTRY_AUTO](../../atl/reference/object-map-macros.md#object_entry_auto) or [OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO](../../atl/reference/object-map-macros.md#object_entry_non_createable_ex_auto)."},{"pos":[2079,2340],"content":"[!NOTE]\n ATL uses the standard component categories manager to register component categories. If the manager is not present on the system when the module is registered, registration succeeds, but the component categories will not be registered for that class.","leadings":["","> "],"nodes":[{"content":" ATL uses the standard component categories manager to register component categories. If the manager is not present on the system when the module is registered, registration succeeds, but the component categories will not be registered for that class.","pos":[8,259],"nodes":[{"content":"ATL uses the standard component categories manager to register component categories.","pos":[1,85]},{"content":"If the manager is not present on the system when the module is registered, registration succeeds, but the component categories will not be registered for that class.","pos":[86,251]}]}]},{"pos":[2347,2572],"content":"For more information about component categories, see <bpt id=\"p1\">[</bpt>What are Component Categories and how do they work<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694322)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information about component categories, see [What are Component Categories and how do they work](http://msdn.microsoft.com/library/windows/desktop/ms694322) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[2582,2589]},{"pos":[2604,2625],"content":"NVC_ATL_Windowing#100"},{"pos":[2717,2733],"content":"END_CATEGORY_MAP"},{"content":"Marks the end of the category map.","pos":[2737,2771]},{"content":"Example","pos":[2813,2820]},{"pos":[2824,2886],"content":"See the example for <bpt id=\"p1\">[</bpt>BEGIN_CATEGORY_MAP<ept id=\"p1\">](#begin_category_map)</ept>.","source":"See the example for [BEGIN_CATEGORY_MAP](#begin_category_map)."},{"pos":[2933,2953],"content":"IMPLEMENTED_CATEGORY"},{"pos":[2957,3154],"content":"Add an <ph id=\"ph1\">`IMPLEMENTED_CATEGORY`</ph> macro to your component's <bpt id=\"p1\">[</bpt>category map<ept id=\"p1\">](#begin_category_map)</ept> to specify that it should be registered as implementing the category identified by the <ph id=\"ph2\">`catID`</ph> parameter.","source":"Add an `IMPLEMENTED_CATEGORY` macro to your component's [category map](#begin_category_map) to specify that it should be registered as implementing the category identified by the `catID` parameter."},{"content":"Parameters","pos":[3205,3215]},{"content":"[in] A <bpt id=\"p1\">**</bpt>CATID<ept id=\"p1\">**</ept> constant or variable holding the globally unique identifier (GUID) for the implemented category.","pos":[3230,3343],"source":" [in] A **CATID** constant or variable holding the globally unique identifier (GUID) for the implemented category."},{"content":"The address of <ph id=\"ph1\">`catID`</ph> will be taken and added to the map.","pos":[3344,3402],"source":" The address of `catID` will be taken and added to the map."},{"content":"See the table below for a selection of stock categories.","pos":[3403,3459]},{"content":"Remarks","pos":[3469,3476]},{"pos":[3480,3822],"content":"The component categories listed in the map will be registered automatically when the module is registered if the class has an associated <bpt id=\"p1\">[</bpt>OBJECT_ENTRY_AUTO<ept id=\"p1\">](../../atl/reference/object-map-macros.md#object_entry_auto)</ept> or <bpt id=\"p2\">[</bpt>OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO<ept id=\"p2\">](../../atl/reference/object-map-macros.md#object_entry_non_createable_ex_auto)</ept> macro.","source":"The component categories listed in the map will be registered automatically when the module is registered if the class has an associated [OBJECT_ENTRY_AUTO](../../atl/reference/object-map-macros.md#object_entry_auto) or [OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO](../../atl/reference/object-map-macros.md#object_entry_non_createable_ex_auto) macro."},{"content":"Clients can use the category information registered for the class to determine its capabilities and requirements without having to create an instance of it.","pos":[3829,3985]},{"pos":[3992,4217],"content":"For more information about component categories, see <bpt id=\"p1\">[</bpt>What are Component Categories and how do they work<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694322)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information about component categories, see [What are Component Categories and how do they work](http://msdn.microsoft.com/library/windows/desktop/ms694322) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"A Selection of Stock Categories","pos":[4227,4258]},{"content":"Description","pos":[4265,4276]},{"content":"Symbol","pos":[4277,4283]},{"content":"Registry GUID","pos":[4284,4297]},{"content":"Safe For Scripting","pos":[4357,4375]},{"content":"CATID_SafeForScripting","pos":[4376,4398]},{"content":"{7DD95801-9882-11CF-9FA9-00AA006C42C4}","pos":[4399,4437]},{"content":"Safe For Initialization","pos":[4442,4465]},{"content":"CATID_SafeForInitializing","pos":[4466,4491]},{"content":"{7DD95802-9882-11CF-9FA9-00AA006C42C4}","pos":[4492,4530]},{"content":"Simple Frame Site Containment","pos":[4535,4564]},{"content":"CATID_SimpleFrameControl","pos":[4565,4589]},{"content":"{157083E0-2368-11cf-87B9-00AA006C8166}","pos":[4590,4628]},{"content":"Simple Data Binding","pos":[4633,4652]},{"content":"CATID_PropertyNotifyControl","pos":[4653,4680]},{"content":"{157083E1-2368-11cf-87B9-00AA006C8166}","pos":[4681,4719]},{"content":"Advanced Data Binding","pos":[4724,4745]},{"content":"CATID_VBDataBound","pos":[4746,4763]},{"content":"{157083E2-2368-11cf-87B9-00AA006C8166}","pos":[4764,4802]},{"content":"Windowless Controls","pos":[4807,4826]},{"content":"CATID_WindowlessObject","pos":[4827,4849]},{"content":"{1D06B600-3AE3-11cf-87B9-00AA006C8166}","pos":[4850,4888]},{"content":"Internet-Aware Objects","pos":[4893,4915]},{"pos":[4916,5082],"content":"See <bpt id=\"p1\">[</bpt>Internet Aware Objects<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690561)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for a sample list.","source":"See [Internet Aware Objects](http://msdn.microsoft.com/library/windows/desktop/ms690561) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a sample list."},{"content":"Example","pos":[5094,5101]},{"pos":[5116,5137],"content":"NVC_ATL_Windowing#100"},{"pos":[5230,5247],"content":"REQUIRED_CATEGORY"},{"pos":[5251,5441],"content":"Add a <ph id=\"ph1\">`REQUIRED_CATEGORY`</ph> macro to your component's <bpt id=\"p1\">[</bpt>category map<ept id=\"p1\">](#begin_category_map)</ept> to specify that it should be registered as requiring the category identified by the <ph id=\"ph2\">`catID`</ph> parameter.","source":"Add a `REQUIRED_CATEGORY` macro to your component's [category map](#begin_category_map) to specify that it should be registered as requiring the category identified by the `catID` parameter."},{"content":"Parameters","pos":[5491,5501]},{"content":"[in] A <bpt id=\"p1\">**</bpt>CATID<ept id=\"p1\">**</ept> constant or variable holding the globally unique identifier (GUID) for the required category.","pos":[5516,5626],"source":" [in] A **CATID** constant or variable holding the globally unique identifier (GUID) for the required category."},{"content":"The address of <ph id=\"ph1\">`catID`</ph> will be taken and added to the map.","pos":[5627,5685],"source":" The address of `catID` will be taken and added to the map."},{"content":"See the table below for a selection of stock categories.","pos":[5686,5742]},{"content":"Remarks","pos":[5752,5759]},{"pos":[5763,6105],"content":"The component categories listed in the map will be registered automatically when the module is registered if the class has an associated <bpt id=\"p1\">[</bpt>OBJECT_ENTRY_AUTO<ept id=\"p1\">](../../atl/reference/object-map-macros.md#object_entry_auto)</ept> or <bpt id=\"p2\">[</bpt>OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO<ept id=\"p2\">](../../atl/reference/object-map-macros.md#object_entry_non_createable_ex_auto)</ept> macro.","source":"The component categories listed in the map will be registered automatically when the module is registered if the class has an associated [OBJECT_ENTRY_AUTO](../../atl/reference/object-map-macros.md#object_entry_auto) or [OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO](../../atl/reference/object-map-macros.md#object_entry_non_createable_ex_auto) macro."},{"content":"Clients can use the category information registered for the class to determine its capabilities and requirements without having to create an instance of it.","pos":[6112,6268]},{"content":"For example, a control may require that a container support data binding.","pos":[6269,6342]},{"content":"The container can find out if it has the capabilities necessary to host the control by querying the category manager for the categories required by that control.","pos":[6343,6504]},{"content":"If the container does not support a required feature, it can refuse to host the COM object.","pos":[6505,6596]},{"pos":[6603,6853],"content":"For more information about component categories, including a sample list, see <bpt id=\"p1\">[</bpt>What are Component Categories and how do they work<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694322)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information about component categories, including a sample list, see [What are Component Categories and how do they work](http://msdn.microsoft.com/library/windows/desktop/ms694322) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"A Selection of Stock Categories","pos":[6863,6894]},{"content":"Description","pos":[6901,6912]},{"content":"Symbol","pos":[6913,6919]},{"content":"Registry GUID","pos":[6920,6933]},{"content":"Safe For Scripting","pos":[6993,7011]},{"content":"CATID_SafeForScripting","pos":[7012,7034]},{"content":"{7DD95801-9882-11CF-9FA9-00AA006C42C4}","pos":[7035,7073]},{"content":"Safe For Initialization","pos":[7078,7101]},{"content":"CATID_SafeForInitializing","pos":[7102,7127]},{"content":"{7DD95802-9882-11CF-9FA9-00AA006C42C4}","pos":[7128,7166]},{"content":"Simple Frame Site Containment","pos":[7171,7200]},{"content":"CATID_SimpleFrameControl","pos":[7201,7225]},{"content":"{157083E0-2368-11cf-87B9-00AA006C8166}","pos":[7226,7264]},{"content":"Simple Data Binding","pos":[7269,7288]},{"content":"CATID_PropertyNotifyControl","pos":[7289,7316]},{"content":"{157083E1-2368-11cf-87B9-00AA006C8166}","pos":[7317,7355]},{"content":"Advanced Data Binding","pos":[7360,7381]},{"content":"CATID_VBDataBound","pos":[7382,7399]},{"content":"{157083E2-2368-11cf-87B9-00AA006C8166}","pos":[7400,7438]},{"content":"Windowless Controls","pos":[7443,7462]},{"content":"CATID_WindowlessObject","pos":[7463,7485]},{"content":"{1D06B600-3AE3-11cf-87B9-00AA006C8166}","pos":[7486,7524]},{"content":"Internet-Aware Objects","pos":[7529,7551]},{"pos":[7552,7718],"content":"See <bpt id=\"p1\">[</bpt>Internet Aware Objects<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690561)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for a sample list.","source":"See [Internet Aware Objects](http://msdn.microsoft.com/library/windows/desktop/ms690561) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a sample list."},{"content":"Example","pos":[7730,7737]},{"pos":[7752,7773],"content":"NVC_ATL_Windowing#135"},{"content":"See Also","pos":[7831,7839]},{"content":"Macros","pos":[7844,7850]}],"content":"---\ntitle: \"Category Macros | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nms.assetid: 223578cb-6180-4787-a8d8-ba3787a5d3ee\ncaps.latest.revision: 17\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Category Macros\nThese macros define category maps.  \n  \n|||  \n|-|-|  \n|[BEGIN_CATEGORY_MAP](#begin_category_map)|Marks the beginning of the category map.|  \n|[END_CATEGORY_MAP](#end_category_map)|Marks the end of the category map.|  \n|[IMPLEMENTED_CATEGORY](#implemented_category)|Indicates categories that are implemented by the COM object.|  \n|[REQUIRED_CATEGORY](#required_category)|Indicates categories that are required of the container by the COM object.|  \n  \n##  <a name=\"begin_category_map\"></a>  BEGIN_CATEGORY_MAP  \n Marks the beginning of the category map.  \n  \n```\nBEGIN_CATEGORY_MAP(theClass)\n```  \n  \n### Parameters  \n `theClass`  \n [in] The name of the class containing the category map.  \n  \n### Remarks  \n The category map is used to specify which component categories the COM class will implement and which categories it requires from its container.  \n  \n Add an [IMPLEMENTED_CATEGORY](#implemented_category) entry to the map for each category implemented by the COM class. Add a [REQUIRED_CATEGORY](#required_category) entry to the map for each category that the class requires its clients to implement. Mark the end of the map with the [END_CATEGORY_MAP](#end_category_map) macro.  \n  \n The component categories listed in the map will be registered automatically when the module is registered if the class has an associated [OBJECT_ENTRY_AUTO](../../atl/reference/object-map-macros.md#object_entry_auto) or [OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO](../../atl/reference/object-map-macros.md#object_entry_non_createable_ex_auto).  \n  \n> [!NOTE]\n>  ATL uses the standard component categories manager to register component categories. If the manager is not present on the system when the module is registered, registration succeeds, but the component categories will not be registered for that class.  \n  \n For more information about component categories, see [What are Component Categories and how do they work](http://msdn.microsoft.com/library/windows/desktop/ms694322) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#100](../../atl/codesnippet/cpp/category-macros_1.h)]  \n  \n##  <a name=\"end_category_map\"></a>  END_CATEGORY_MAP  \n Marks the end of the category map.  \n  \n```\nEND_CATEGORY_MAP()\n```  \n  \n### Example  \n See the example for [BEGIN_CATEGORY_MAP](#begin_category_map).  \n  \n##  <a name=\"implemented_category\"></a>  IMPLEMENTED_CATEGORY  \n Add an `IMPLEMENTED_CATEGORY` macro to your component's [category map](#begin_category_map) to specify that it should be registered as implementing the category identified by the `catID` parameter.  \n  \n```\nIMPLEMENTED_CATEGORY(catID)\n```  \n  \n### Parameters  \n `catID`  \n [in] A **CATID** constant or variable holding the globally unique identifier (GUID) for the implemented category. The address of `catID` will be taken and added to the map. See the table below for a selection of stock categories.  \n  \n### Remarks  \n The component categories listed in the map will be registered automatically when the module is registered if the class has an associated [OBJECT_ENTRY_AUTO](../../atl/reference/object-map-macros.md#object_entry_auto) or [OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO](../../atl/reference/object-map-macros.md#object_entry_non_createable_ex_auto) macro.  \n  \n Clients can use the category information registered for the class to determine its capabilities and requirements without having to create an instance of it.  \n  \n For more information about component categories, see [What are Component Categories and how do they work](http://msdn.microsoft.com/library/windows/desktop/ms694322) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### A Selection of Stock Categories  \n  \n|Description|Symbol|Registry GUID|  \n|-----------------|------------|-------------------|  \n|Safe For Scripting|CATID_SafeForScripting|{7DD95801-9882-11CF-9FA9-00AA006C42C4}|  \n|Safe For Initialization|CATID_SafeForInitializing|{7DD95802-9882-11CF-9FA9-00AA006C42C4}|  \n|Simple Frame Site Containment|CATID_SimpleFrameControl|{157083E0-2368-11cf-87B9-00AA006C8166}|  \n|Simple Data Binding|CATID_PropertyNotifyControl|{157083E1-2368-11cf-87B9-00AA006C8166}|  \n|Advanced Data Binding|CATID_VBDataBound|{157083E2-2368-11cf-87B9-00AA006C8166}|  \n|Windowless Controls|CATID_WindowlessObject|{1D06B600-3AE3-11cf-87B9-00AA006C8166}|  \n|Internet-Aware Objects|See [Internet Aware Objects](http://msdn.microsoft.com/library/windows/desktop/ms690561) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a sample list.||  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#100](../../atl/codesnippet/cpp/category-macros_1.h)]  \n  \n##  <a name=\"required_category\"></a>  REQUIRED_CATEGORY  \n Add a `REQUIRED_CATEGORY` macro to your component's [category map](#begin_category_map) to specify that it should be registered as requiring the category identified by the `catID` parameter.  \n  \n```\nREQUIRED_CATEGORY( catID )\n```  \n  \n### Parameters  \n `catID`  \n [in] A **CATID** constant or variable holding the globally unique identifier (GUID) for the required category. The address of `catID` will be taken and added to the map. See the table below for a selection of stock categories.  \n  \n### Remarks  \n The component categories listed in the map will be registered automatically when the module is registered if the class has an associated [OBJECT_ENTRY_AUTO](../../atl/reference/object-map-macros.md#object_entry_auto) or [OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO](../../atl/reference/object-map-macros.md#object_entry_non_createable_ex_auto) macro.  \n  \n Clients can use the category information registered for the class to determine its capabilities and requirements without having to create an instance of it. For example, a control may require that a container support data binding. The container can find out if it has the capabilities necessary to host the control by querying the category manager for the categories required by that control. If the container does not support a required feature, it can refuse to host the COM object.  \n  \n For more information about component categories, including a sample list, see [What are Component Categories and how do they work](http://msdn.microsoft.com/library/windows/desktop/ms694322) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### A Selection of Stock Categories  \n  \n|Description|Symbol|Registry GUID|  \n|-----------------|------------|-------------------|  \n|Safe For Scripting|CATID_SafeForScripting|{7DD95801-9882-11CF-9FA9-00AA006C42C4}|  \n|Safe For Initialization|CATID_SafeForInitializing|{7DD95802-9882-11CF-9FA9-00AA006C42C4}|  \n|Simple Frame Site Containment|CATID_SimpleFrameControl|{157083E0-2368-11cf-87B9-00AA006C8166}|  \n|Simple Data Binding|CATID_PropertyNotifyControl|{157083E1-2368-11cf-87B9-00AA006C8166}|  \n|Advanced Data Binding|CATID_VBDataBound|{157083E2-2368-11cf-87B9-00AA006C8166}|  \n|Windowless Controls|CATID_WindowlessObject|{1D06B600-3AE3-11cf-87B9-00AA006C8166}|  \n|Internet-Aware Objects|See [Internet Aware Objects](http://msdn.microsoft.com/library/windows/desktop/ms690561) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a sample list.||  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#135](../../atl/codesnippet/cpp/category-macros_2.h)]  \n  \n## See Also  \n [Macros](../../atl/reference/atl-macros.md)\n"}