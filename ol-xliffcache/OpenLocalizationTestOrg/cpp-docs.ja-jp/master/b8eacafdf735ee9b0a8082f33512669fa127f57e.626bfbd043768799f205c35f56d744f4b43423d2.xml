{"nodes":[{"pos":[12,48],"content":"Property Map Macros | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Property Map Macros | Microsoft Docs","pos":[0,36]}]},{"content":"Property Map Macros","pos":[573,592]},{"content":"These macros define property maps and entries.","pos":[593,639]},{"content":"BEGIN_PROP_MAP","pos":[661,675]},{"content":"Marks the beginning of the ATL property map.","pos":[694,738]},{"content":"PROP_DATA_ENTRY","pos":[744,759]},{"content":"Indicates the extent, or dimensions, of an ActiveX control.","pos":[779,838]},{"content":"PROP_ENTRY_TYPE","pos":[844,859]},{"content":"Enters a property description, property DISPID, and property page CLSID into the property map.","pos":[879,973]},{"content":"PROP_ENTRY_TYPE_EX","pos":[979,997]},{"pos":[1020,1131],"content":"Enters a property description, property DISPID, property page CLSID, and <ph id=\"ph1\">`IDispatch`</ph> IID into the property map.","source":"Enters a property description, property DISPID, property page CLSID, and `IDispatch` IID into the property map."},{"content":"PROP_PAGE","pos":[1137,1146]},{"content":"Enters a property page CLSID into the property map.","pos":[1160,1211]},{"content":"END_PROP_MAP","pos":[1217,1229]},{"content":"Marks the end of the ATL property map.","pos":[1246,1284]},{"pos":[1326,1340],"content":"BEGIN_PROP_MAP"},{"content":"Marks the beginning of the object's property map.","pos":[1344,1393]},{"content":"Parameters","pos":[1441,1451]},{"content":"[in] Specifies the class containing the property map.","pos":[1469,1522]},{"content":"Remarks","pos":[1532,1539]},{"content":"The property map stores property descriptions, property DISPIDs, property page CLSIDs, and <ph id=\"ph1\">`IDispatch`</ph> IIDs.","pos":[1543,1651],"source":"The property map stores property descriptions, property DISPIDs, property page CLSIDs, and `IDispatch` IIDs."},{"content":"Classes <bpt id=\"p1\">[</bpt>IPerPropertyBrowsingImpl<ept id=\"p1\">](../../atl/reference/iperpropertybrowsingimpl-class.md)</ept>, <bpt id=\"p2\">[</bpt>IPersistPropertyBagImpl<ept id=\"p2\">](../../atl/reference/ipersistpropertybagimpl-class.md)</ept>, <bpt id=\"p3\">[</bpt>IPersistStreamInitImpl<ept id=\"p3\">](../../atl/reference/ipersiststreaminitimpl-class.md)</ept>, and <bpt id=\"p4\">[</bpt>ISpecifyPropertyPagesImpl<ept id=\"p4\">](../../atl/reference/ispecifypropertypagesimpl-class.md)</ept> use the property map to retrieve and set this information.","pos":[1652,2049],"source":" Classes [IPerPropertyBrowsingImpl](../../atl/reference/iperpropertybrowsingimpl-class.md), [IPersistPropertyBagImpl](../../atl/reference/ipersistpropertybagimpl-class.md), [IPersistStreamInitImpl](../../atl/reference/ipersiststreaminitimpl-class.md), and [ISpecifyPropertyPagesImpl](../../atl/reference/ispecifypropertypagesimpl-class.md) use the property map to retrieve and set this information."},{"pos":[2056,2229],"content":"When you create an object with the ATL Project Wizard, the wizard will create an empty property map by specifying <ph id=\"ph1\">`BEGIN_PROP_MAP`</ph> followed by <bpt id=\"p1\">[</bpt>END_PROP_MAP<ept id=\"p1\">](#end_prop_map)</ept>.","source":"When you create an object with the ATL Project Wizard, the wizard will create an empty property map by specifying `BEGIN_PROP_MAP` followed by [END_PROP_MAP](#end_prop_map)."},{"content":"does not save out the extent (that is, the dimensions) of a property map, because an object using a property map may not have a user interface, so it would have no extent.","pos":[2253,2424]},{"content":"If the object is an ActiveX control with a user interface, it has an extent.","pos":[2425,2501]},{"content":"In this case, you must specify <bpt id=\"p1\">[</bpt>PROP_DATA_ENTRY<ept id=\"p1\">](#prop_data_entry)</ept> in your property map to supply the extent.","pos":[2502,2611],"source":" In this case, you must specify [PROP_DATA_ENTRY](#prop_data_entry) in your property map to supply the extent."},{"content":"Example","pos":[2621,2628]},{"pos":[2643,2664],"content":"NVC_ATL_Windowing#103"},{"pos":[2759,2774],"content":"PROP_DATA_ENTRY"},{"content":"Indicates the extent, or dimensions, of an ActiveX control.","pos":[2778,2837]},{"content":"Parameters","pos":[2899,2909]},{"content":"[in] The property description.","pos":[2925,2955]},{"content":"[in] The data member containing the extent; for example, <ph id=\"ph1\">`m_sizeExtent`</ph>.","pos":[2974,3046],"source":" [in] The data member containing the extent; for example, `m_sizeExtent`."},{"content":"vt","pos":[3054,3056]},{"content":"[in] Specifies the VARIANT type of the property.","pos":[3061,3109]},{"content":"Remarks","pos":[3119,3126]},{"content":"This macro causes the specified data member to be persisted.","pos":[3130,3190]},{"pos":[3197,3390],"content":"When you create an ActiveX control, the wizard inserts this macro after the property map macro <bpt id=\"p1\">[</bpt>BEGIN_PROP_MAP<ept id=\"p1\">](#begin_prop_map)</ept> and before the property map macro <bpt id=\"p2\">[</bpt>END_PROP_MAP<ept id=\"p2\">](#end_prop_map)</ept>.","source":"When you create an ActiveX control, the wizard inserts this macro after the property map macro [BEGIN_PROP_MAP](#begin_prop_map) and before the property map macro [END_PROP_MAP](#end_prop_map)."},{"content":"Example","pos":[3400,3407]},{"pos":[3411,3499],"content":"In the following example, the extent of the object ( <ph id=\"ph1\">`m_sizeExtent`</ph>) is being persisted.","source":"In the following example, the extent of the object ( `m_sizeExtent`) is being persisted."},{"pos":[3517,3538],"content":"NVC_ATL_Windowing#131"},{"pos":[3609,3630],"content":"NVC_ATL_Windowing#132"},{"pos":[3725,3740],"content":"PROP_ENTRY_TYPE"},{"content":"Use this macro to enter a property description, property DISPID, and property page CLSID into the object's property map.","pos":[3744,3864]},{"content":"Parameters","pos":[3931,3941]},{"content":"[in] The property description.","pos":[3957,3987]},{"content":"[in] The property's DISPID.","pos":[4006,4033]},{"content":"[in] The CLSID of the associated property page.","pos":[4051,4098]},{"content":"Use the special value <ph id=\"ph1\">`CLSID_NULL`</ph> for a property that does not have an associated property page.","pos":[4099,4196],"source":" Use the special value `CLSID_NULL` for a property that does not have an associated property page."},{"content":"[in] The property's type.","pos":[4211,4236]},{"content":"Remarks","pos":[4246,4253]},{"content":"The <ph id=\"ph1\">`PROP_ENTRY`</ph> macro was insecure and deprecated.","pos":[4257,4308],"source":"The `PROP_ENTRY` macro was insecure and deprecated."},{"content":"It has been replaced with <ph id=\"ph1\">`PROP_ENTRY_TYPE`</ph>.","pos":[4309,4353],"source":" It has been replaced with `PROP_ENTRY_TYPE`."},{"pos":[4360,4499],"content":"The <bpt id=\"p1\">[</bpt>BEGIN_PROP_MAP<ept id=\"p1\">](#begin_prop_map)</ept> macro marks the beginning of the property map; the <bpt id=\"p2\">[</bpt>END_PROP_MAP<ept id=\"p2\">](#end_prop_map)</ept> macro marks the end.","source":"The [BEGIN_PROP_MAP](#begin_prop_map) macro marks the beginning of the property map; the [END_PROP_MAP](#end_prop_map) macro marks the end."},{"content":"Example","pos":[4509,4516]},{"pos":[4520,4574],"content":"See the example for <bpt id=\"p1\">[</bpt>BEGIN_PROP_MAP<ept id=\"p1\">](#begin_prop_map)</ept>.","source":"See the example for [BEGIN_PROP_MAP](#begin_prop_map)."},{"pos":[4619,4637],"content":"PROP_ENTRY_TYPE_EX"},{"pos":[4641,4778],"content":"Similar to <bpt id=\"p1\">[</bpt>PROP_ENTRY_TYPE<ept id=\"p1\">](#prop_entry_type)</ept>, but allows you specify a particular IID if your object supports multiple dual interfaces.","source":"Similar to [PROP_ENTRY_TYPE](#prop_entry_type), but allows you specify a particular IID if your object supports multiple dual interfaces."},{"content":"Parameters","pos":[4863,4873]},{"content":"[in] The property description.","pos":[4889,4919]},{"content":"[in] The property's DISPID.","pos":[4938,4965]},{"content":"[in] The CLSID of the associated property page.","pos":[4983,5030]},{"content":"Use the special value <ph id=\"ph1\">`CLSID_NULL`</ph> for a property that does not have an associated property page.","pos":[5031,5128],"source":" Use the special value `CLSID_NULL` for a property that does not have an associated property page."},{"content":"[in] The IID of the dual interface defining the property.","pos":[5152,5209]},{"content":"[in] The property's type.","pos":[5224,5249]},{"content":"Remarks","pos":[5259,5266]},{"content":"The <ph id=\"ph1\">`PROP_ENTRY_EX`</ph> macro was insecure and deprecated.","pos":[5270,5324],"source":"The `PROP_ENTRY_EX` macro was insecure and deprecated."},{"content":"It has been replaced with <ph id=\"ph1\">`PROP_ENTRY_TYPE_EX`</ph>.","pos":[5325,5372],"source":" It has been replaced with `PROP_ENTRY_TYPE_EX`."},{"pos":[5379,5518],"content":"The <bpt id=\"p1\">[</bpt>BEGIN_PROP_MAP<ept id=\"p1\">](#begin_prop_map)</ept> macro marks the beginning of the property map; the <bpt id=\"p2\">[</bpt>END_PROP_MAP<ept id=\"p2\">](#end_prop_map)</ept> macro marks the end.","source":"The [BEGIN_PROP_MAP](#begin_prop_map) macro marks the beginning of the property map; the [END_PROP_MAP](#end_prop_map) macro marks the end."},{"content":"Example","pos":[5528,5535]},{"content":"The following example groups entries for <ph id=\"ph1\">`IMyDual1`</ph> followed by an entry for <ph id=\"ph2\">`IMyDual2`</ph>.","pos":[5539,5627],"source":"The following example groups entries for `IMyDual1` followed by an entry for `IMyDual2`."},{"content":"Grouping by dual interface will improve performance.","pos":[5628,5680]},{"pos":[5698,5719],"content":"NVC_ATL_Windowing#133"},{"pos":[5808,5817],"content":"PROP_PAGE"},{"content":"Use this macro to enter a property page CLSID into the object's property map.","pos":[5821,5898]},{"content":"Parameters","pos":[5938,5948]},{"content":"[in] The CLSID of a property page.","pos":[5963,5997]},{"content":"Remarks","pos":[6007,6014]},{"pos":[6030,6135],"content":"is similar to <bpt id=\"p1\">[</bpt>PROP_ENTRY_TYPE<ept id=\"p1\">](#prop_entry_type)</ept>, but does not require a property description or DISPID.","source":" is similar to [PROP_ENTRY_TYPE](#prop_entry_type), but does not require a property description or DISPID."},{"pos":[6143,6320],"content":"[!NOTE]\n If you have already entered a CLSID with `PROP_ENTRY_TYPE` or [PROP_ENTRY_TYPE_EX](#prop_entry_type_ex), you do not need to make an additional entry with `PROP_PAGE`.","leadings":["","> "],"nodes":[{"content":"If you have already entered a CLSID with <ph id=\"ph1\">`PROP_ENTRY_TYPE`</ph> or <bpt id=\"p1\">[</bpt>PROP_ENTRY_TYPE_EX<ept id=\"p1\">](#prop_entry_type_ex)</ept>, you do not need to make an additional entry with <ph id=\"ph2\">`PROP_PAGE`</ph>.","pos":[9,175],"source":" If you have already entered a CLSID with `PROP_ENTRY_TYPE` or [PROP_ENTRY_TYPE_EX](#prop_entry_type_ex), you do not need to make an additional entry with `PROP_PAGE`."}]},{"pos":[6327,6466],"content":"The <bpt id=\"p1\">[</bpt>BEGIN_PROP_MAP<ept id=\"p1\">](#begin_prop_map)</ept> macro marks the beginning of the property map; the <bpt id=\"p2\">[</bpt>END_PROP_MAP<ept id=\"p2\">](#end_prop_map)</ept> macro marks the end.","source":"The [BEGIN_PROP_MAP](#begin_prop_map) macro marks the beginning of the property map; the [END_PROP_MAP](#end_prop_map) macro marks the end."},{"content":"Example","pos":[6476,6483]},{"pos":[6498,6519],"content":"NVC_ATL_Windowing#134"},{"pos":[6611,6623],"content":"END_PROP_MAP"},{"content":"Marks the end of the object's property map.","pos":[6627,6670]},{"content":"Remarks","pos":[6708,6715]},{"pos":[6719,6894],"content":"When you create an object with the ATL Project Wizard, the wizard will create an empty property map by specifying <bpt id=\"p1\">[</bpt>BEGIN_PROP_MAP<ept id=\"p1\">](#begin_prop_map)</ept> followed by <ph id=\"ph1\">`END_PROP_MAP`</ph>.","source":"When you create an object with the ATL Project Wizard, the wizard will create an empty property map by specifying [BEGIN_PROP_MAP](#begin_prop_map) followed by `END_PROP_MAP`."},{"content":"Example","pos":[6904,6911]},{"pos":[6915,6969],"content":"See the example for <bpt id=\"p1\">[</bpt>BEGIN_PROP_MAP<ept id=\"p1\">](#begin_prop_map)</ept>.","source":"See the example for [BEGIN_PROP_MAP](#begin_prop_map)."},{"content":"See Also","pos":[6978,6986]},{"content":"Macros","pos":[6991,6997]}],"content":"---\ntitle: \"Property Map Macros | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"property maps\"\nms.assetid: 128bc742-2b98-4b97-a243-684dbb83db77\ncaps.latest.revision: 17\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Property Map Macros\nThese macros define property maps and entries.  \n  \n|||  \n|-|-|  \n|[BEGIN_PROP_MAP](#begin_prop_map)|Marks the beginning of the ATL property map.|  \n|[PROP_DATA_ENTRY](#prop_data_entry)|Indicates the extent, or dimensions, of an ActiveX control.|  \n|[PROP_ENTRY_TYPE](#prop_entry_type)|Enters a property description, property DISPID, and property page CLSID into the property map.|  \n|[PROP_ENTRY_TYPE_EX](#prop_entry_type_ex)|Enters a property description, property DISPID, property page CLSID, and `IDispatch` IID into the property map.|  \n|[PROP_PAGE](#prop_page)|Enters a property page CLSID into the property map.|  \n|[END_PROP_MAP](#end_prop_map)|Marks the end of the ATL property map.|  \n  \n##  <a name=\"begin_prop_map\"></a>  BEGIN_PROP_MAP  \n Marks the beginning of the object's property map.  \n  \n```\nBEGIN_PROP_MAP(theClass)\n```  \n  \n### Parameters  \n `theClass`  \n [in] Specifies the class containing the property map.  \n  \n### Remarks  \n The property map stores property descriptions, property DISPIDs, property page CLSIDs, and `IDispatch` IIDs. Classes [IPerPropertyBrowsingImpl](../../atl/reference/iperpropertybrowsingimpl-class.md), [IPersistPropertyBagImpl](../../atl/reference/ipersistpropertybagimpl-class.md), [IPersistStreamInitImpl](../../atl/reference/ipersiststreaminitimpl-class.md), and [ISpecifyPropertyPagesImpl](../../atl/reference/ispecifypropertypagesimpl-class.md) use the property map to retrieve and set this information.  \n  \n When you create an object with the ATL Project Wizard, the wizard will create an empty property map by specifying `BEGIN_PROP_MAP` followed by [END_PROP_MAP](#end_prop_map).  \n  \n `BEGIN_PROP_MAP` does not save out the extent (that is, the dimensions) of a property map, because an object using a property map may not have a user interface, so it would have no extent. If the object is an ActiveX control with a user interface, it has an extent. In this case, you must specify [PROP_DATA_ENTRY](#prop_data_entry) in your property map to supply the extent.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#103](../../atl/codesnippet/cpp/property-map-macros_1.h)]  \n  \n##  <a name=\"prop_data_entry\"></a>  PROP_DATA_ENTRY  \n Indicates the extent, or dimensions, of an ActiveX control.  \n  \n```\nPROP_DATA_ENTRY( szDesc, member, vt)\n```    \n  \n### Parameters  \n `szDesc`  \n [in] The property description.  \n  \n `member`  \n [in] The data member containing the extent; for example, `m_sizeExtent`.  \n  \n *vt*  \n [in] Specifies the VARIANT type of the property.  \n  \n### Remarks  \n This macro causes the specified data member to be persisted.  \n  \n When you create an ActiveX control, the wizard inserts this macro after the property map macro [BEGIN_PROP_MAP](#begin_prop_map) and before the property map macro [END_PROP_MAP](#end_prop_map).  \n  \n### Example  \n In the following example, the extent of the object ( `m_sizeExtent`) is being persisted.  \n  \n [!code-cpp[NVC_ATL_Windowing#131](../../atl/codesnippet/cpp/property-map-macros_2.h)]  \n  \n [!code-cpp[NVC_ATL_Windowing#132](../../atl/codesnippet/cpp/property-map-macros_3.h)]  \n  \n##  <a name=\"prop_entry_type\"></a>  PROP_ENTRY_TYPE  \n Use this macro to enter a property description, property DISPID, and property page CLSID into the object's property map.  \n  \n```\nPROP_ENTRY_TYPE( szDesc, dispid, clsid, vt)\n```  \n  \n### Parameters  \n `szDesc`  \n [in] The property description.  \n  \n `dispid`  \n [in] The property's DISPID.  \n  \n `clsid`  \n [in] The CLSID of the associated property page. Use the special value `CLSID_NULL` for a property that does not have an associated property page.  \n  \n `vt`  \n [in] The property's type.  \n  \n### Remarks  \n The `PROP_ENTRY` macro was insecure and deprecated. It has been replaced with `PROP_ENTRY_TYPE`.  \n  \n The [BEGIN_PROP_MAP](#begin_prop_map) macro marks the beginning of the property map; the [END_PROP_MAP](#end_prop_map) macro marks the end.  \n  \n### Example  \n See the example for [BEGIN_PROP_MAP](#begin_prop_map).  \n  \n##  <a name=\"prop_entry_type_ex\"></a>  PROP_ENTRY_TYPE_EX  \n Similar to [PROP_ENTRY_TYPE](#prop_entry_type), but allows you specify a particular IID if your object supports multiple dual interfaces.  \n  \n```\nPROP_ENTRY_TYPE_EX( szDesc, dispid, clsid, iidDispatch, vt)\n```    \n  \n### Parameters  \n `szDesc`  \n [in] The property description.  \n  \n `dispid`  \n [in] The property's DISPID.  \n  \n `clsid`  \n [in] The CLSID of the associated property page. Use the special value `CLSID_NULL` for a property that does not have an associated property page.  \n  \n `iidDispatch`  \n [in] The IID of the dual interface defining the property.  \n  \n `vt`  \n [in] The property's type.  \n  \n### Remarks  \n The `PROP_ENTRY_EX` macro was insecure and deprecated. It has been replaced with `PROP_ENTRY_TYPE_EX`.  \n  \n The [BEGIN_PROP_MAP](#begin_prop_map) macro marks the beginning of the property map; the [END_PROP_MAP](#end_prop_map) macro marks the end.  \n  \n### Example  \n The following example groups entries for `IMyDual1` followed by an entry for `IMyDual2`. Grouping by dual interface will improve performance.  \n  \n [!code-cpp[NVC_ATL_Windowing#133](../../atl/codesnippet/cpp/property-map-macros_4.h)]  \n  \n##  <a name=\"prop_page\"></a>  PROP_PAGE  \n Use this macro to enter a property page CLSID into the object's property map.  \n  \n```\nPROP_PAGE(clsid)\n```  \n  \n### Parameters  \n `clsid`  \n [in] The CLSID of a property page.  \n  \n### Remarks  \n `PROP_PAGE` is similar to [PROP_ENTRY_TYPE](#prop_entry_type), but does not require a property description or DISPID.  \n  \n> [!NOTE]\n>  If you have already entered a CLSID with `PROP_ENTRY_TYPE` or [PROP_ENTRY_TYPE_EX](#prop_entry_type_ex), you do not need to make an additional entry with `PROP_PAGE`.  \n  \n The [BEGIN_PROP_MAP](#begin_prop_map) macro marks the beginning of the property map; the [END_PROP_MAP](#end_prop_map) macro marks the end.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Windowing#134](../../atl/codesnippet/cpp/property-map-macros_5.h)]  \n  \n##  <a name=\"end_prop_map\"></a>  END_PROP_MAP  \n Marks the end of the object's property map.  \n  \n```\nEND_PROP_MAP()\n```  \n  \n### Remarks  \n When you create an object with the ATL Project Wizard, the wizard will create an empty property map by specifying [BEGIN_PROP_MAP](#begin_prop_map) followed by `END_PROP_MAP`.  \n  \n### Example  \n See the example for [BEGIN_PROP_MAP](#begin_prop_map).  \n  \n## See Also  \n [Macros](../../atl/reference/atl-macros.md)\n"}