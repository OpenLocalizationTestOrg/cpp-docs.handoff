{"nodes":[{"pos":[12,82],"content":"Identifying the Elements of the DHTML Control Project | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Identifying the Elements of the DHTML Control Project | Microsoft Docs","pos":[0,70]}]},{"content":"Identifying the Elements of the DHTML Control Project","pos":[678,731]},{"content":"Most DHTML control code is exactly like that created for any ATL control.","pos":[732,805]},{"content":"For a basic understanding of the generic code, work through the <bpt id=\"p1\">[</bpt>ATL tutorial<ept id=\"p1\">](../atl/active-template-library-atl-tutorial.md)</ept>, and read the sections <bpt id=\"p2\">[</bpt>Creating an ATL Project<ept id=\"p2\">](../atl/reference/creating-an-atl-project.md)</ept> and <bpt id=\"p3\">[</bpt>Fundamentals of ATL COM Objects<ept id=\"p3\">](../atl/fundamentals-of-atl-com-objects.md)</ept>.","pos":[806,1108],"source":" For a basic understanding of the generic code, work through the [ATL tutorial](../atl/active-template-library-atl-tutorial.md), and read the sections [Creating an ATL Project](../atl/reference/creating-an-atl-project.md) and [Fundamentals of ATL COM Objects](../atl/fundamentals-of-atl-com-objects.md)."},{"content":"A DHTML control is similar to any ATL control, except:","pos":[1115,1169]},{"content":"In addition to the regular interfaces a control implements, it implements an additional interface that is used to communicate between the C++ code and the HTML user interface (UI).","pos":[1179,1359]},{"content":"The HTML UI calls into C++ code using this interface.","pos":[1360,1413]},{"content":"It creates an HTML resource for the control UI.","pos":[1423,1470]},{"content":"It allows access to the DHTML object model through the member variable <ph id=\"ph1\">`m_spBrowser`</ph>, which is a smart pointer of type <bpt id=\"p1\">[</bpt>IWebBrowser2<ept id=\"p1\">](https://msdn.microsoft.com/library/aa752127.aspx)</ept>.","pos":[1480,1664],"source":"It allows access to the DHTML object model through the member variable `m_spBrowser`, which is a smart pointer of type [IWebBrowser2](https://msdn.microsoft.com/library/aa752127.aspx)."},{"content":"Use this pointer to access any part of the DHTML object model.","pos":[1665,1727]},{"content":"The following graphic illustrates the relationship between your DLL, the DHTML control, the Web browser, and the HTML resource.","pos":[1734,1861]},{"content":"Elements of a DHTML control project","pos":[1870,1905]},{"pos":[1950,2145],"content":"[!NOTE]\n The names on this graphic are placeholders. The names of your HTML resource and the interfaces exposed on your control are based on the names you assign them in the ATL Control Wizard.","leadings":["","> "],"nodes":[{"content":" The names on this graphic are placeholders. The names of your HTML resource and the interfaces exposed on your control are based on the names you assign them in the ATL Control Wizard.","pos":[8,193],"nodes":[{"content":"The names on this graphic are placeholders.","pos":[1,44]},{"content":"The names of your HTML resource and the interfaces exposed on your control are based on the names you assign them in the ATL Control Wizard.","pos":[45,185]}]}]},{"content":"In this graphic, the elements are:","pos":[2152,2186]},{"pos":[2196,2252],"content":"<bpt id=\"p1\">**</bpt>My DLL<ept id=\"p1\">**</ept> The DLL created using the ATL Project Wizard.","source":"**My DLL** The DLL created using the ATL Project Wizard."},{"content":"<bpt id=\"p1\">**</bpt>DHTML Control<ept id=\"p1\">**</ept> (<ph id=\"ph1\">`m_spBrowser`</ph>)   The DHTML control, created using the ATL Object Wizard.","pos":[2262,2353],"source":"**DHTML Control** (`m_spBrowser`)   The DHTML control, created using the ATL Object Wizard."},{"content":"This control accesses the Web browser object and its methods through the Web browser object's interface, <bpt id=\"p1\">**</bpt>IWebBrowser2<ept id=\"p1\">**</ept>.","pos":[2354,2476],"source":" This control accesses the Web browser object and its methods through the Web browser object's interface, **IWebBrowser2**."},{"content":"The control itself exposes the following two interfaces, in addition to the other standard interfaces required for a control.","pos":[2477,2602]},{"pos":[2616,2695],"content":"<bpt id=\"p1\">**</bpt>IDHCTL1<ept id=\"p1\">**</ept> The interface exposed by the control for use only by the container.","source":"**IDHCTL1** The interface exposed by the control for use only by the container."},{"content":"<bpt id=\"p1\">**</bpt>IDHCTLUI1<ept id=\"p1\">**</ept> The dispatch interface for communicating between the C++ code and the HTML user interface.","pos":[2709,2813],"source":"**IDHCTLUI1** The dispatch interface for communicating between the C++ code and the HTML user interface."},{"content":"The Web browser uses the control's dispatch interface to display the control.","pos":[2814,2891]},{"content":"You can call various methods of this dispatch interface from the control's user interface by invoking <ph id=\"ph1\">`window.external`</ph>, followed by the method name on this dispatch interface that you want to invoke.","pos":[2892,3092],"source":" You can call various methods of this dispatch interface from the control's user interface by invoking `window.external`, followed by the method name on this dispatch interface that you want to invoke."},{"content":"You would access <ph id=\"ph1\">`window.external`</ph> from a SCRIPT tag within the HTML that makes up the UI for this control.","pos":[3093,3200],"source":" You would access `window.external` from a SCRIPT tag within the HTML that makes up the UI for this control."},{"content":"For more information about invoking external methods in the resource file, see <bpt id=\"p1\">[</bpt>Calling C++ Code from DHTML<ept id=\"p1\">](../atl/calling-cpp-code-from-dhtml.md)</ept>.","pos":[3201,3349],"source":" For more information about invoking external methods in the resource file, see [Calling C++ Code from DHTML](../atl/calling-cpp-code-from-dhtml.md)."},{"content":"<bpt id=\"p1\">**</bpt>IDR_CTL1<ept id=\"p1\">**</ept> The resource ID of the HTML resource.","pos":[3359,3409],"source":"**IDR_CTL1** The resource ID of the HTML resource."},{"content":"Its file name, in this case, is DHCTL1UI.htm.","pos":[3410,3455]},{"content":"The DHTML control uses an HTML resource that contains standard HTML tags and external window dispatch commands that you can edit using the Text editor.","pos":[3456,3607]},{"content":"<bpt id=\"p1\">**</bpt>Web Browser<ept id=\"p1\">**</ept> The Web browser displays the control's UI, based on the HTML in the HTML resource.","pos":[3617,3715],"source":"**Web Browser** The Web browser displays the control's UI, based on the HTML in the HTML resource."},{"content":"A pointer to the Web browser's <bpt id=\"p1\">**</bpt>IWebBrowser2<ept id=\"p1\">**</ept> interface is available in the DHTML control to allow access to the DHTML object model.","pos":[3716,3850],"source":" A pointer to the Web browser's **IWebBrowser2** interface is available in the DHTML control to allow access to the DHTML object model."},{"content":"The ATL Control Wizard generates a control with default code in both the HTML resource and the .cpp file.","pos":[3857,3962]},{"content":"You can compile and run the control as generated by the wizard, and then view the control in either the Web browser or the ActiveX Control Test Container.","pos":[3963,4117]},{"content":"The picture below shows the default ATL DHTML control with three buttons displayed in Test Container:","pos":[4118,4219]},{"content":"ATL DHTML control","pos":[4228,4245]},{"content":"See <bpt id=\"p1\">[</bpt>Creating an ATL DHTML Control<ept id=\"p1\">](../atl/creating-an-atl-dhtml-control.md)</ept> to get started building a DHTML control.","pos":[4289,4406],"source":"See [Creating an ATL DHTML Control](../atl/creating-an-atl-dhtml-control.md) to get started building a DHTML control."},{"content":"See <bpt id=\"p1\">[</bpt>Testing Properties and Events with Test Container<ept id=\"p1\">](../mfc/testing-properties-and-events-with-test-container.md)</ept> for information on how to access Test Container.","pos":[4407,4572],"source":" See [Testing Properties and Events with Test Container](../mfc/testing-properties-and-events-with-test-container.md) for information on how to access Test Container."},{"content":"See Also","pos":[4581,4589]},{"content":"Support for DHTML Control","pos":[4594,4619]}],"content":"---\ntitle: \"Identifying the Elements of the DHTML Control Project | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"HTML controls, ATL support\"\n  - \"DHTML controls, ATL support\"\nms.assetid: b627547a-3768-4346-9900-4b7a21fb8e27\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Identifying the Elements of the DHTML Control Project\nMost DHTML control code is exactly like that created for any ATL control. For a basic understanding of the generic code, work through the [ATL tutorial](../atl/active-template-library-atl-tutorial.md), and read the sections [Creating an ATL Project](../atl/reference/creating-an-atl-project.md) and [Fundamentals of ATL COM Objects](../atl/fundamentals-of-atl-com-objects.md).  \n  \n A DHTML control is similar to any ATL control, except:  \n  \n-   In addition to the regular interfaces a control implements, it implements an additional interface that is used to communicate between the C++ code and the HTML user interface (UI). The HTML UI calls into C++ code using this interface.  \n  \n-   It creates an HTML resource for the control UI.  \n  \n-   It allows access to the DHTML object model through the member variable `m_spBrowser`, which is a smart pointer of type [IWebBrowser2](https://msdn.microsoft.com/library/aa752127.aspx). Use this pointer to access any part of the DHTML object model.  \n  \n The following graphic illustrates the relationship between your DLL, the DHTML control, the Web browser, and the HTML resource.  \n  \n ![Elements of a DHTML control project](../atl/media/vc52en1.gif \"vc52en1\")  \n  \n> [!NOTE]\n>  The names on this graphic are placeholders. The names of your HTML resource and the interfaces exposed on your control are based on the names you assign them in the ATL Control Wizard.  \n  \n In this graphic, the elements are:  \n  \n-   **My DLL** The DLL created using the ATL Project Wizard.  \n  \n-   **DHTML Control** (`m_spBrowser`)   The DHTML control, created using the ATL Object Wizard. This control accesses the Web browser object and its methods through the Web browser object's interface, **IWebBrowser2**. The control itself exposes the following two interfaces, in addition to the other standard interfaces required for a control.  \n  \n    -   **IDHCTL1** The interface exposed by the control for use only by the container.  \n  \n    -   **IDHCTLUI1** The dispatch interface for communicating between the C++ code and the HTML user interface. The Web browser uses the control's dispatch interface to display the control. You can call various methods of this dispatch interface from the control's user interface by invoking `window.external`, followed by the method name on this dispatch interface that you want to invoke. You would access `window.external` from a SCRIPT tag within the HTML that makes up the UI for this control. For more information about invoking external methods in the resource file, see [Calling C++ Code from DHTML](../atl/calling-cpp-code-from-dhtml.md).  \n  \n-   **IDR_CTL1** The resource ID of the HTML resource. Its file name, in this case, is DHCTL1UI.htm. The DHTML control uses an HTML resource that contains standard HTML tags and external window dispatch commands that you can edit using the Text editor.  \n  \n-   **Web Browser** The Web browser displays the control's UI, based on the HTML in the HTML resource. A pointer to the Web browser's **IWebBrowser2** interface is available in the DHTML control to allow access to the DHTML object model.  \n  \n The ATL Control Wizard generates a control with default code in both the HTML resource and the .cpp file. You can compile and run the control as generated by the wizard, and then view the control in either the Web browser or the ActiveX Control Test Container. The picture below shows the default ATL DHTML control with three buttons displayed in Test Container:  \n  \n ![ATL DHTML control](../atl/media/vc52en2.gif \"vc52en2\")  \n  \n See [Creating an ATL DHTML Control](../atl/creating-an-atl-dhtml-control.md) to get started building a DHTML control. See [Testing Properties and Events with Test Container](../mfc/testing-properties-and-events-with-test-container.md) for information on how to access Test Container.  \n  \n## See Also  \n [Support for DHTML Control](../atl/atl-support-for-dhtml-controls.md)\n\n"}