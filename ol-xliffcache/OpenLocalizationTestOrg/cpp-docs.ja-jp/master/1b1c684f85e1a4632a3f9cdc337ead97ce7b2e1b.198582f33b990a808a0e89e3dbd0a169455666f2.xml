{"nodes":[{"pos":[12,49],"content":"COleStreamFile Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleStreamFile Class | Microsoft Docs","pos":[0,37]}]},{"pos":[796,816],"content":"COleStreamFile Class","linkify":"COleStreamFile Class","nodes":[{"content":"COleStreamFile Class","pos":[0,20]}]},{"pos":[817,911],"content":"Represents a stream of data ( <ph id=\"ph1\">`IStream`</ph>) in a compound file as part of OLE Structured Storage.","source":"Represents a stream of data ( `IStream`) in a compound file as part of OLE Structured Storage."},{"pos":[920,926],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[988,995],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1005,1024],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1031,1035]},{"content":"Description","pos":[1036,1047]},{"pos":[1085,1150],"content":"<bpt id=\"p1\">[</bpt>COleStreamFile::COleStreamFile<ept id=\"p1\">](#colestreamfile__colestreamfile)</ept>","source":"[COleStreamFile::COleStreamFile](#colestreamfile__colestreamfile)"},{"pos":[1151,1188],"content":"Constructs a <ph id=\"ph1\">`COleStreamFile`</ph> object.","source":"Constructs a `COleStreamFile` object."},{"pos":[1199,1213],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1220,1224]},{"content":"Description","pos":[1225,1236]},{"pos":[1274,1323],"content":"<bpt id=\"p1\">[</bpt>COleStreamFile::Attach<ept id=\"p1\">](#colestreamfile__attach)</ept>","source":"[COleStreamFile::Attach](#colestreamfile__attach)"},{"content":"Associates a stream with the object.","pos":[1324,1360]},{"pos":[1365,1438],"content":"<bpt id=\"p1\">[</bpt>COleStreamFile::CreateMemoryStream<ept id=\"p1\">](#colestreamfile__creatememorystream)</ept>","source":"[COleStreamFile::CreateMemoryStream](#colestreamfile__creatememorystream)"},{"content":"Creates a stream from global memory and associates it with the object.","pos":[1439,1509]},{"pos":[1514,1575],"content":"<bpt id=\"p1\">[</bpt>COleStreamFile::CreateStream<ept id=\"p1\">](#colestreamfile__createstream)</ept>","source":"[COleStreamFile::CreateStream](#colestreamfile__createstream)"},{"content":"Creates a stream and associates it with the object.","pos":[1576,1627]},{"pos":[1632,1681],"content":"<bpt id=\"p1\">[</bpt>COleStreamFile::Detach<ept id=\"p1\">](#colestreamfile__detach)</ept>","source":"[COleStreamFile::Detach](#colestreamfile__detach)"},{"content":"Disassociates the stream from the object.","pos":[1682,1723]},{"pos":[1728,1783],"content":"<bpt id=\"p1\">[</bpt>COleStreamFile::GetStream<ept id=\"p1\">](#colestreamfile__getstream)</ept>","source":"[COleStreamFile::GetStream](#colestreamfile__getstream)"},{"content":"Returns the current stream.","pos":[1784,1811]},{"pos":[1816,1873],"content":"<bpt id=\"p1\">[</bpt>COleStreamFile::OpenStream<ept id=\"p1\">](#colestreamfile__openstream)</ept>","source":"[COleStreamFile::OpenStream](#colestreamfile__openstream)"},{"content":"Safely opens a stream and associates it with the object.","pos":[1874,1930]},{"pos":[1940,1947],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1951,2055],"content":"An <ph id=\"ph1\">`IStorage`</ph> object must exist before the stream can be opened or created unless it is a memory stream.","source":"An `IStorage` object must exist before the stream can be opened or created unless it is a memory stream."},{"pos":[2062,2168],"content":"<ph id=\"ph1\">`COleStreamFile`</ph> objects are manipulated exactly like <bpt id=\"p1\">[</bpt>CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md)</ept> objects.","source":"`COleStreamFile` objects are manipulated exactly like [CFile](../../mfc/reference/cfile-class.md) objects."},{"pos":[2175,2323],"content":"For more information about manipulating streams and storages, see the article <bpt id=\"p1\">[</bpt>Containers: Compound Files<ept id=\"p1\">](../../mfc/containers-compound-files.md)</ept>..","source":"For more information about manipulating streams and storages, see the article [Containers: Compound Files](../../mfc/containers-compound-files.md).."},{"pos":[2330,2560],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> and <bpt id=\"p2\">[</bpt>IStorage<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/aa380015)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) and [IStorage](http://msdn.microsoft.com/library/windows/desktop/aa380015) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[2569,2590],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2594,2641],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[2648,2691],"content":"<bpt id=\"p1\">[</bpt>CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md)</ept>","source":"[CFile](../../mfc/reference/cfile-class.md)"},{"pos":[2723,2735],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2739,2759],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxole.h","source":"**Header:** afxole.h"},{"pos":[2769,2830],"content":"<bpt id=\"p1\">&lt;a name=\"colestreamfile__attach\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleStreamFile::Attach","linkify":"<a name=\"colestreamfile__attach\"></a>  COleStreamFile::Attach","source":"<a name=\"colestreamfile__attach\"></a>  COleStreamFile::Attach"},{"pos":[2834,2902],"content":"Associates the supplied OLE stream with the <ph id=\"ph1\">`COleStreamFile`</ph> object.","source":"Associates the supplied OLE stream with the `COleStreamFile` object."},{"pos":[2959,2969],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to the OLE stream ( <ph id=\"ph1\">`IStream`</ph>) to be associated with the object.","pos":[2987,3058],"source":" Points to the OLE stream ( `IStream`) to be associated with the object."},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[3059,3078],"source":" Cannot be **NULL**."},{"pos":[3088,3095],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The object must not already be associated with an OLE stream.","pos":[3099,3160]},{"pos":[3167,3322],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3332,3409],"content":"<bpt id=\"p1\">&lt;a name=\"colestreamfile__colestreamfile\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleStreamFile::COleStreamFile","linkify":"<a name=\"colestreamfile__colestreamfile\"></a>  COleStreamFile::COleStreamFile","source":"<a name=\"colestreamfile__colestreamfile\"></a>  COleStreamFile::COleStreamFile"},{"pos":[3413,3447],"content":"Creates a <ph id=\"ph1\">`COleStreamFile`</ph> object.","source":"Creates a `COleStreamFile` object."},{"pos":[3514,3524],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to the OLE stream to be associated with the object.","pos":[3542,3601]},{"pos":[3611,3618],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3622,3763],"content":"If <ph id=\"ph1\">`lpStream`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the object is not associated with an OLE stream, otherwise, the object is associated with the supplied OLE stream.","source":"If `lpStream` is **NULL**, the object is not associated with an OLE stream, otherwise, the object is associated with the supplied OLE stream."},{"pos":[3770,3925],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3935,4020],"content":"<bpt id=\"p1\">&lt;a name=\"colestreamfile__creatememorystream\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleStreamFile::CreateMemoryStream","linkify":"<a name=\"colestreamfile__creatememorystream\"></a>  COleStreamFile::CreateMemoryStream","source":"<a name=\"colestreamfile__creatememorystream\"></a>  COleStreamFile::CreateMemoryStream"},{"content":"Safely creates a new stream out of global, shared memory where a failure is a normal, expected condition.","pos":[4024,4129]},{"pos":[4210,4220],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to a <bpt id=\"p1\">[</bpt>CFileException<ept id=\"p1\">](../../mfc/reference/cfileexception-class.md)</ept> object or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> that indicates the completion status of the create operation.","pos":[4236,4390],"source":" Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL** that indicates the completion status of the create operation."},{"content":"Supply this parameter if you want to monitor possible exceptions generated by attempting to create the stream.","pos":[4391,4501]},{"pos":[4511,4523],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the stream is created successfully; otherwise 0.","pos":[4527,4586]},{"pos":[4596,4603],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The memory is allocated by the OLE subsystem.","pos":[4607,4652]},{"pos":[4659,4828],"content":"For more information, see <bpt id=\"p1\">[</bpt>CreateStreamOnHGlobal<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa378980)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [CreateStreamOnHGlobal](http://msdn.microsoft.com/library/windows/desktop/aa378980) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4838,4911],"content":"<bpt id=\"p1\">&lt;a name=\"colestreamfile__createstream\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleStreamFile::CreateStream","linkify":"<a name=\"colestreamfile__createstream\"></a>  COleStreamFile::CreateStream","source":"<a name=\"colestreamfile__createstream\"></a>  COleStreamFile::CreateStream"},{"content":"Safely creates a new stream in the supplied storage object where a failure is a normal, expected condition.","pos":[4915,5022]},{"pos":[5225,5235],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to the OLE storage object that contains the stream to be created.","pos":[5254,5326]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[5327,5346],"source":" Cannot be **NULL**."},{"content":"Name of the stream to be created.","pos":[5373,5406]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[5407,5426],"source":" Cannot be **NULL**."},{"content":"Access mode to use when opening the stream.","pos":[5449,5492]},{"content":"Exclusive, read/write, and create modes are used by default.","pos":[5493,5553]},{"content":"For a complete list of the available modes, see <bpt id=\"p1\">[</bpt>CFile::CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md#cfile__cfile)</ept>.","pos":[5554,5666],"source":" For a complete list of the available modes, see [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile)."},{"content":"Points to a <bpt id=\"p1\">[</bpt>CFileException<ept id=\"p1\">](../../mfc/reference/cfileexception-class.md)</ept> object or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","pos":[5685,5778],"source":" Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL**."},{"content":"Supply this parameter if you want to monitor possible exceptions generated by attempting to create the stream.","pos":[5779,5889]},{"pos":[5899,5911],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the stream is created successfully; otherwise 0.","pos":[5915,5974]},{"pos":[5984,5991],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5995,6074],"content":"A file exception will be thrown if the open fails and <ph id=\"ph1\">`pError`</ph> is not <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"A file exception will be thrown if the open fails and `pError` is not **NULL**."},{"pos":[6081,6251],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStorage::CreateStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380020)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStorage::CreateStream](http://msdn.microsoft.com/library/windows/desktop/aa380020) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6261,6322],"content":"<bpt id=\"p1\">&lt;a name=\"colestreamfile__detach\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleStreamFile::Detach","linkify":"<a name=\"colestreamfile__detach\"></a>  COleStreamFile::Detach","source":"<a name=\"colestreamfile__detach\"></a>  COleStreamFile::Detach"},{"content":"Disassociates the stream from the object without closing the stream.","pos":[6326,6394]},{"pos":[6438,6450],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[6454,6527],"content":"A pointer to the stream ( <ph id=\"ph1\">`IStream`</ph>) that was associated with the object.","source":"A pointer to the stream ( `IStream`) that was associated with the object."},{"pos":[6537,6544],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The stream must be closed in some other fashion before the program terminates.","pos":[6548,6626]},{"pos":[6633,6788],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6798,6865],"content":"<bpt id=\"p1\">&lt;a name=\"colestreamfile__getstream\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleStreamFile::GetStream","linkify":"<a name=\"colestreamfile__getstream\"></a>  COleStreamFile::GetStream","source":"<a name=\"colestreamfile__getstream\"></a>  COleStreamFile::GetStream"},{"content":"Call this function to return a pointer to current stream.","pos":[6869,6926]},{"pos":[6982,6994],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[6998,7113],"content":"A pointer to the current stream interface ( <bpt id=\"p1\">[</bpt>IStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380034)</ept>).","source":"A pointer to the current stream interface ( [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034))."},{"pos":[7123,7192],"content":"<bpt id=\"p1\">&lt;a name=\"colestreamfile__openstream\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleStreamFile::OpenStream","linkify":"<a name=\"colestreamfile__openstream\"></a>  COleStreamFile::OpenStream","source":"<a name=\"colestreamfile__openstream\"></a>  COleStreamFile::OpenStream"},{"content":"Opens an existing stream.","pos":[7196,7221]},{"pos":[7411,7421],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Points to the OLE storage object that contains the stream to be opened.","pos":[7440,7511]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[7512,7531],"source":" Cannot be **NULL**."},{"content":"Name of the stream to be opened.","pos":[7558,7590]},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[7591,7610],"source":" Cannot be **NULL**."},{"content":"Access mode to use when opening the stream.","pos":[7633,7676]},{"content":"Exclusive and read/write modes are used by default.","pos":[7677,7728]},{"content":"For the complete list of the available modes, see <bpt id=\"p1\">[</bpt>CFile::CFile<ept id=\"p1\">](../../mfc/reference/cfile-class.md#cfile__cfile)</ept>.","pos":[7729,7843],"source":" For the complete list of the available modes, see [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile)."},{"content":"Points to a <bpt id=\"p1\">[</bpt>CFileException<ept id=\"p1\">](../../mfc/reference/cfileexception-class.md)</ept> object or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","pos":[7862,7955],"source":" Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL**."},{"content":"Supply this parameter if you want to monitor possible exceptions generated by attempting to open the stream.","pos":[7956,8064]},{"pos":[8074,8086],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the stream is opened successfully; otherwise 0.","pos":[8090,8148]},{"pos":[8158,8165],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[8169,8248],"content":"A file exception will be thrown if the open fails and <ph id=\"ph1\">`pError`</ph> is not <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"A file exception will be thrown if the open fails and `pError` is not **NULL**."},{"pos":[8255,8423],"content":"For more information, see <bpt id=\"p1\">[</bpt>IStorage::OpenStream<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa380025)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IStorage::OpenStream](http://msdn.microsoft.com/library/windows/desktop/aa380025) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8432,8440],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CFile Class<ept id=\"p1\">](../../mfc/reference/cfile-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[8444,8494],"source":"[CFile Class](../../mfc/reference/cfile-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept>","pos":[8497,8545],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md)"}],"content":"---\ntitle: \"COleStreamFile Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleStreamFile\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"data streams [C++]\"\n  - \"streams [C++], OLE\"\n  - \"data streams [C++], OLE\"\n  - \"structured storage in OLE\"\n  - \"OLE structured storage [C++]\"\n  - \"OLE [C++], streams of data\"\n  - \"COleStreamFile class\"\nms.assetid: e4f93698-e17c-4a18-a7c0-4b4df8eb4d93\ncaps.latest.revision: 22\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleStreamFile Class\nRepresents a stream of data ( `IStream`) in a compound file as part of OLE Structured Storage.  \n  \n## Syntax  \n  \n```  \nclass COleStreamFile : public CFile  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleStreamFile::COleStreamFile](#colestreamfile__colestreamfile)|Constructs a `COleStreamFile` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleStreamFile::Attach](#colestreamfile__attach)|Associates a stream with the object.|  \n|[COleStreamFile::CreateMemoryStream](#colestreamfile__creatememorystream)|Creates a stream from global memory and associates it with the object.|  \n|[COleStreamFile::CreateStream](#colestreamfile__createstream)|Creates a stream and associates it with the object.|  \n|[COleStreamFile::Detach](#colestreamfile__detach)|Disassociates the stream from the object.|  \n|[COleStreamFile::GetStream](#colestreamfile__getstream)|Returns the current stream.|  \n|[COleStreamFile::OpenStream](#colestreamfile__openstream)|Safely opens a stream and associates it with the object.|  \n  \n## Remarks  \n An `IStorage` object must exist before the stream can be opened or created unless it is a memory stream.  \n  \n `COleStreamFile` objects are manipulated exactly like [CFile](../../mfc/reference/cfile-class.md) objects.  \n  \n For more information about manipulating streams and storages, see the article [Containers: Compound Files](../../mfc/containers-compound-files.md)..  \n  \n For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) and [IStorage](http://msdn.microsoft.com/library/windows/desktop/aa380015) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CFile](../../mfc/reference/cfile-class.md)  \n  \n `COleStreamFile`  \n  \n## Requirements  \n **Header:** afxole.h  \n  \n##  <a name=\"colestreamfile__attach\"></a>  COleStreamFile::Attach  \n Associates the supplied OLE stream with the `COleStreamFile` object.  \n  \n```  \nvoid Attach(LPSTREAM lpStream);\n```  \n  \n### Parameters  \n `lpStream`  \n Points to the OLE stream ( `IStream`) to be associated with the object. Cannot be **NULL**.  \n  \n### Remarks  \n The object must not already be associated with an OLE stream.  \n  \n For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__colestreamfile\"></a>  COleStreamFile::COleStreamFile  \n Creates a `COleStreamFile` object.  \n  \n```  \nCOleStreamFile(LPSTREAM lpStream = NULL);\n```  \n  \n### Parameters  \n `lpStream`  \n Pointer to the OLE stream to be associated with the object.  \n  \n### Remarks  \n If `lpStream` is **NULL**, the object is not associated with an OLE stream, otherwise, the object is associated with the supplied OLE stream.  \n  \n For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__creatememorystream\"></a>  COleStreamFile::CreateMemoryStream  \n Safely creates a new stream out of global, shared memory where a failure is a normal, expected condition.  \n  \n```  \nBOOL CreateMemoryStream(CFileException* pError = NULL);\n```  \n  \n### Parameters  \n `pError`  \n Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL** that indicates the completion status of the create operation. Supply this parameter if you want to monitor possible exceptions generated by attempting to create the stream.  \n  \n### Return Value  \n Nonzero if the stream is created successfully; otherwise 0.  \n  \n### Remarks  \n The memory is allocated by the OLE subsystem.  \n  \n For more information, see [CreateStreamOnHGlobal](http://msdn.microsoft.com/library/windows/desktop/aa378980) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__createstream\"></a>  COleStreamFile::CreateStream  \n Safely creates a new stream in the supplied storage object where a failure is a normal, expected condition.  \n  \n```  \nBOOL CreateStream(\n    LPSTORAGE lpStorage,  \n    LPCTSTR lpszStreamName,  \n    DWORD nOpenFlags = modeReadWrite|shareExclusive|modeCreate,  \n    CFileException* pError = NULL);\n```  \n  \n### Parameters  \n `lpStorage`  \n Points to the OLE storage object that contains the stream to be created. Cannot be **NULL**.  \n  \n `lpszStreamName`  \n Name of the stream to be created. Cannot be **NULL**.  \n  \n `nOpenFlags`  \n Access mode to use when opening the stream. Exclusive, read/write, and create modes are used by default. For a complete list of the available modes, see [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile).  \n  \n `pError`  \n Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL**. Supply this parameter if you want to monitor possible exceptions generated by attempting to create the stream.  \n  \n### Return Value  \n Nonzero if the stream is created successfully; otherwise 0.  \n  \n### Remarks  \n A file exception will be thrown if the open fails and `pError` is not **NULL**.  \n  \n For more information, see [IStorage::CreateStream](http://msdn.microsoft.com/library/windows/desktop/aa380020) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__detach\"></a>  COleStreamFile::Detach  \n Disassociates the stream from the object without closing the stream.  \n  \n```  \nLPSTREAM Detach();\n```  \n  \n### Return Value  \n A pointer to the stream ( `IStream`) that was associated with the object.  \n  \n### Remarks  \n The stream must be closed in some other fashion before the program terminates.  \n  \n For more information, see [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colestreamfile__getstream\"></a>  COleStreamFile::GetStream  \n Call this function to return a pointer to current stream.  \n  \n```  \nIStream* GetStream() const;\n\n \n```  \n  \n### Return Value  \n A pointer to the current stream interface ( [IStream](http://msdn.microsoft.com/library/windows/desktop/aa380034)).  \n  \n##  <a name=\"colestreamfile__openstream\"></a>  COleStreamFile::OpenStream  \n Opens an existing stream.  \n  \n```  \nBOOL OpenStream(\n    LPSTORAGE lpStorage,  \n    LPCTSTR lpszStreamName,  \n    DWORD nOpenFlags = modeReadWrite|shareExclusive,  \n    CFileException* pError = NULL);\n```  \n  \n### Parameters  \n `lpStorage`  \n Points to the OLE storage object that contains the stream to be opened. Cannot be **NULL**.  \n  \n `lpszStreamName`  \n Name of the stream to be opened. Cannot be **NULL**.  \n  \n `nOpenFlags`  \n Access mode to use when opening the stream. Exclusive and read/write modes are used by default. For the complete list of the available modes, see [CFile::CFile](../../mfc/reference/cfile-class.md#cfile__cfile).  \n  \n `pError`  \n Points to a [CFileException](../../mfc/reference/cfileexception-class.md) object or **NULL**. Supply this parameter if you want to monitor possible exceptions generated by attempting to open the stream.  \n  \n### Return Value  \n Nonzero if the stream is opened successfully; otherwise 0.  \n  \n### Remarks  \n A file exception will be thrown if the open fails and `pError` is not **NULL**.  \n  \n For more information, see [IStorage::OpenStream](http://msdn.microsoft.com/library/windows/desktop/aa380025) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [CFile Class](../../mfc/reference/cfile-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n\n\n"}