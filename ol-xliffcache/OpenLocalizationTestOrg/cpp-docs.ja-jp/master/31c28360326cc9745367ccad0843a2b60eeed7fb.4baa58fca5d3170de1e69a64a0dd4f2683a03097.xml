{"nodes":[{"pos":[12,92],"content":"Version Issues for Value Types Nested in Native Types (C++-CLI) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Version Issues for Value Types Nested in Native Types (C++-CLI) | Microsoft Docs","pos":[0,80]}]},{"content":"Version Issues for Value Types Nested in Native Types (C++/CLI)","pos":[669,732]},{"content":"Consider a signed (strong name) assembly component used to build a client assembly.","pos":[733,816]},{"content":"The component contains a value type that is used in the client as the type for a member of a native union, a class, or an array.","pos":[817,945]},{"content":"If a future version of the component changes the size or layout of the value type, the client must be recompiled.","pos":[946,1059]},{"pos":[1066,1189],"content":"Create a keyfile with <bpt id=\"p1\">[</bpt>sn.exe<ept id=\"p1\">](http://msdn.microsoft.com/Library/c1d2b532-1b8e-4c7a-8ac5-53b801135ec6)</ept> (<ph id=\"ph1\">`sn -k mykey.snk`</ph>).","source":"Create a keyfile with [sn.exe](http://msdn.microsoft.com/Library/c1d2b532-1b8e-4c7a-8ac5-53b801135ec6) (`sn -k mykey.snk`)."},{"content":"Example","pos":[1198,1205]},{"content":"The following sample is the component.","pos":[1209,1247]},{"content":"Example","pos":[1572,1579]},{"content":"This sample is the client:","pos":[1583,1609]},{"content":"Output","pos":[1999,2005]},{"content":"Comments","pos":[2072,2080]},{"pos":[2084,2354],"content":"However, if you add another member to <ph id=\"ph1\">`struct S`</ph> in nested_value_types.cpp, (for example, <ph id=\"ph2\">`double d;`</ph>) and recompile the component without recompiling the client, the result is an unhandled exception (of type &lt;xref:System.IO.FileLoadException?displayProperty=fullName&gt;).","source":"However, if you add another member to `struct S` in nested_value_types.cpp, (for example, `double d;`) and recompile the component without recompiling the client, the result is an unhandled exception (of type <xref:System.IO.FileLoadException?displayProperty=fullName>)."},{"content":"See Also","pos":[2363,2371]},{"content":"Managed Types (C++/CLI)","pos":[2376,2399]}],"content":"---\ntitle: \"Version Issues for Value Types Nested in Native Types (C++-CLI) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"__nogc type declarations\"\n  - \"__value keyword, issues when nesting\"\nms.assetid: 0a3b1a43-39c6-4b52-be2f-1074690188aa\ncaps.latest.revision: 13\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Version Issues for Value Types Nested in Native Types (C++/CLI)\nConsider a signed (strong name) assembly component used to build a client assembly. The component contains a value type that is used in the client as the type for a member of a native union, a class, or an array. If a future version of the component changes the size or layout of the value type, the client must be recompiled.  \n  \n Create a keyfile with [sn.exe](http://msdn.microsoft.com/Library/c1d2b532-1b8e-4c7a-8ac5-53b801135ec6) (`sn -k mykey.snk`).  \n  \n## Example  \n The following sample is the component.  \n  \n```  \n// nested_value_types.cpp  \n// compile with: /clr /LD  \nusing namespace System::Reflection;  \n[assembly:AssemblyVersion(\"1.0.0.*\"),   \nassembly:AssemblyKeyFile(\"mykey.snk\")];  \n  \npublic value struct S {  \n   int i;  \n   void Test() {  \n      System::Console::WriteLine(\"S.i = {0}\", i);  \n   }  \n};  \n```  \n  \n## Example  \n This sample is the client:  \n  \n```  \n// nested_value_types_2.cpp  \n// compile with: /clr  \n#using <nested_value_types.dll>  \n  \nstruct S2 {  \n   S MyS1, MyS2;  \n};  \n  \nint main() {  \n   S2 MyS2a, MyS2b;  \n   MyS2a.MyS1.i = 5;  \n   MyS2a.MyS2.i = 6;  \n   MyS2b.MyS1.i = 10;  \n   MyS2b.MyS2.i = 11;  \n  \n   MyS2a.MyS1.Test();  \n   MyS2a.MyS2.Test();  \n   MyS2b.MyS1.Test();  \n   MyS2b.MyS2.Test();  \n}  \n```  \n  \n## Output  \n  \n```  \nS.i = 5  \nS.i = 6  \nS.i = 10  \nS.i = 11  \n```  \n  \n### Comments  \n However, if you add another member to `struct S` in nested_value_types.cpp, (for example, `double d;`) and recompile the component without recompiling the client, the result is an unhandled exception (of type <xref:System.IO.FileLoadException?displayProperty=fullName>).  \n  \n## See Also  \n [Managed Types (C++/CLI)](../dotnet/managed-types-cpp-cli.md)"}