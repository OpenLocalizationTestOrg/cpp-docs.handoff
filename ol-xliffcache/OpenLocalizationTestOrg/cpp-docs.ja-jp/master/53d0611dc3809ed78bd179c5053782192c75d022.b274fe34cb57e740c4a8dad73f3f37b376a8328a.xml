{"nodes":[{"pos":[12,47],"content":"Initializing a DLL | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Initializing a DLL | Microsoft Docs","pos":[0,35]}]},{"content":"Initializing a DLL","pos":[633,651]},{"content":"Typically, your DLL has initialization code (such as allocating memory) that must execute when your DLL loads.","pos":[652,762]},{"content":"When using Visual C++, where you add code to initialize your DLL depends on the type of DLL you are building.","pos":[763,872]},{"content":"If you do not need to add initialization or termination code, there is nothing special you have to do when building your DLL.","pos":[873,998]},{"content":"If you need to initialize your DLL, the following table describes where to add your code.","pos":[999,1088]},{"content":"DLL type","pos":[1095,1103]},{"content":"Where to add initialization and termination code","pos":[1104,1152]},{"content":"Regular DLL","pos":[1231,1242]},{"pos":[1243,1309],"content":"In the DLL's <ph id=\"ph1\">`CWinApp`</ph> object's <ph id=\"ph2\">`InitInstance`</ph> and <ph id=\"ph3\">`ExitInstance`</ph>.","source":"In the DLL's `CWinApp` object's `InitInstance` and `ExitInstance`."},{"content":"Extension DLL","pos":[1314,1327]},{"pos":[1328,1386],"content":"In the <ph id=\"ph1\">`DllMain`</ph> function generated by the MFC DLL Wizard.","source":"In the `DllMain` function generated by the MFC DLL Wizard."},{"content":"Non-MFC DLL","pos":[1391,1402]},{"pos":[1403,1451],"content":"In a function called <ph id=\"ph1\">`DllMain`</ph> that you provide.","source":"In a function called `DllMain` that you provide."},{"content":"In Win32, all DLLs might contain an optional entry-point function (usually called <ph id=\"ph1\">`DllMain`</ph>) that is called for both initialization and termination.","pos":[1459,1607],"source":"In Win32, all DLLs might contain an optional entry-point function (usually called `DllMain`) that is called for both initialization and termination."},{"content":"This gives you an opportunity to allocate or release additional resources as needed.","pos":[1608,1692]},{"content":"Windows calls the entry-point function in four situations: process attach, process detach, thread attach, and thread detach.","pos":[1693,1817]},{"content":"The C run-time library provides an entry-point function called <bpt id=\"p1\">**</bpt>_DllMainCRTStartup<ept id=\"p1\">**</ept>, and it calls <ph id=\"ph1\">`DllMain`</ph>.","pos":[1824,1934],"source":"The C run-time library provides an entry-point function called **_DllMainCRTStartup**, and it calls `DllMain`."},{"content":"Depending on the type of DLL, you should have a function called <ph id=\"ph1\">`DllMain`</ph> in your source code or you should use the <ph id=\"ph2\">`DllMain`</ph> provided in the MFC library.","pos":[1935,2089],"source":" Depending on the type of DLL, you should have a function called `DllMain` in your source code or you should use the `DllMain` provided in the MFC library."},{"content":"What do you want to do?","pos":[2098,2121]},{"content":"Initialize regular DLLs","pos":[2132,2155]},{"content":"Initialize extension DLLs","pos":[2206,2231]},{"content":"Initialize non-MFC DLLs","pos":[2284,2307]},{"content":"What do you want to know more about?","pos":[2356,2392]},{"content":"The C run-time library behavior and _DllMainCRTStartup","pos":[2403,2457]},{"content":"The function specification for DllMain (Windows SDK)","pos":[2508,2560]},{"content":"Dynamic-link library entry-point function (Windows SDK)","pos":[2632,2687]},{"content":"See Also","pos":[2757,2765]},{"content":"DLLs in Visual C++","pos":[2770,2788]}],"content":"---\ntitle: \"Initializing a DLL | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"termination code [C++]\"\n  - \"DLLs [C++], initializing\"\n  - \"initializing DLLs\"\nms.assetid: f655c5ff-ab5b-493a-a1da-4d1074e60c5b\ncaps.latest.revision: 8\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Initializing a DLL\nTypically, your DLL has initialization code (such as allocating memory) that must execute when your DLL loads. When using Visual C++, where you add code to initialize your DLL depends on the type of DLL you are building. If you do not need to add initialization or termination code, there is nothing special you have to do when building your DLL. If you need to initialize your DLL, the following table describes where to add your code.  \n  \n|DLL type|Where to add initialization and termination code|  \n|--------------|------------------------------------------------------|  \n|Regular DLL|In the DLL's `CWinApp` object's `InitInstance` and `ExitInstance`.|  \n|Extension DLL|In the `DllMain` function generated by the MFC DLL Wizard.|  \n|Non-MFC DLL|In a function called `DllMain` that you provide.|  \n  \n In Win32, all DLLs might contain an optional entry-point function (usually called `DllMain`) that is called for both initialization and termination. This gives you an opportunity to allocate or release additional resources as needed. Windows calls the entry-point function in four situations: process attach, process detach, thread attach, and thread detach.  \n  \n The C run-time library provides an entry-point function called **_DllMainCRTStartup**, and it calls `DllMain`. Depending on the type of DLL, you should have a function called `DllMain` in your source code or you should use the `DllMain` provided in the MFC library.  \n  \n## What do you want to do?  \n  \n-   [Initialize regular DLLs](../build/initializing-regular-dlls.md)  \n  \n-   [Initialize extension DLLs](../build/initializing-extension-dlls.md)  \n  \n-   [Initialize non-MFC DLLs](../build/initializing-non-mfc-dlls.md)  \n  \n## What do you want to know more about?  \n  \n-   [The C run-time library behavior and _DllMainCRTStartup](../build/run-time-library-behavior.md)  \n  \n-   [The function specification for DllMain (Windows SDK)](http://msdn.microsoft.com/library/windows/desktop/ms682583)  \n  \n-   [Dynamic-link library entry-point function (Windows SDK)](http://msdn.microsoft.com/library/windows/desktop/ms682596)  \n  \n## See Also  \n [DLLs in Visual C++](../build/dlls-in-visual-cpp.md)"}