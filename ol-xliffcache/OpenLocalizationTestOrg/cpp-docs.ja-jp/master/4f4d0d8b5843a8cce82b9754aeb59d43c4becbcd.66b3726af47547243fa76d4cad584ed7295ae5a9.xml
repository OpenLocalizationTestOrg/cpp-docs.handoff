{"nodes":[{"pos":[12,43],"content":"CToolBar Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CToolBar Class | Microsoft Docs","pos":[0,31]}]},{"content":"CToolBar Class","pos":[843,857]},{"content":"Control bars that have a row of bitmapped buttons and optional separators.","pos":[858,932]},{"content":"Syntax","pos":[941,947]},{"content":"Members","pos":[1009,1016]},{"content":"Public Constructors","pos":[1026,1045]},{"content":"Name","pos":[1052,1056]},{"content":"Description","pos":[1057,1068]},{"content":"CToolBar::CToolBar","pos":[1107,1125]},{"pos":[1148,1179],"content":"Constructs a <ph id=\"ph1\">`CToolBar`</ph> object.","source":"Constructs a `CToolBar` object."},{"content":"Public Methods","pos":[1190,1204]},{"content":"Name","pos":[1211,1215]},{"content":"Description","pos":[1216,1227]},{"content":"CToolBar::CommandToIndex","pos":[1266,1290]},{"content":"Returns the index of a button with the given command ID.","pos":[1319,1375]},{"content":"CToolBar::Create","pos":[1381,1397]},{"pos":[1418,1487],"content":"Creates the Windows toolbar and attaches it to the <ph id=\"ph1\">`CToolBar`</ph> object.","source":"Creates the Windows toolbar and attaches it to the `CToolBar` object."},{"content":"CToolBar::CreateEx","pos":[1493,1511]},{"pos":[1534,1624],"content":"Creates a <ph id=\"ph1\">`CToolBar`</ph> object with additional styles for the embedded <ph id=\"ph2\">`CToolBarCtrl`</ph> object.","source":"Creates a `CToolBar` object with additional styles for the embedded `CToolBarCtrl` object."},{"content":"CToolBar::GetButtonInfo","pos":[1630,1653]},{"content":"Retrieves the ID, style, and image number of a button.","pos":[1681,1735]},{"content":"CToolBar::GetButtonStyle","pos":[1741,1765]},{"content":"Retrieves the style for a button.","pos":[1794,1827]},{"content":"CToolBar::GetButtonText","pos":[1833,1856]},{"content":"Retrieves the text that will appear on a button.","pos":[1884,1932]},{"content":"CToolBar::GetItemID","pos":[1938,1957]},{"content":"Returns the command ID of a button or separator at the given index.","pos":[1981,2048]},{"content":"CToolBar::GetItemRect","pos":[2054,2075]},{"content":"Retrieves the display rectangle for the item at the given index.","pos":[2101,2165]},{"content":"CToolBar::GetToolBarCtrl","pos":[2171,2195]},{"content":"Allows direct access to the underlying common control.","pos":[2224,2278]},{"content":"CToolBar::LoadBitmap","pos":[2284,2304]},{"content":"Loads the bitmap containing bitmap-button images.","pos":[2329,2378]},{"content":"CToolBar::LoadToolBar","pos":[2384,2405]},{"content":"Loads a toolbar resource created with the resource editor.","pos":[2431,2489]},{"content":"CToolBar::SetBitmap","pos":[2495,2514]},{"content":"Sets a bitmapped image.","pos":[2538,2561]},{"content":"CToolBar::SetButtonInfo","pos":[2567,2590]},{"content":"Sets the ID, style, and image number of a button.","pos":[2618,2667]},{"content":"CToolBar::SetButtons","pos":[2673,2693]},{"content":"Sets button styles and an index of button images within the bitmap.","pos":[2718,2785]},{"content":"CToolBar::SetButtonStyle","pos":[2791,2815]},{"content":"Sets the style for a button.","pos":[2844,2872]},{"content":"CToolBar::SetButtonText","pos":[2878,2901]},{"content":"Sets the text that will appear on a button.","pos":[2929,2972]},{"content":"CToolBar::SetHeight","pos":[2978,2997]},{"content":"Sets the height of the toolbar.","pos":[3021,3052]},{"content":"CToolBar::SetSizes","pos":[3058,3076]},{"content":"Sets the sizes of buttons and their bitmaps.","pos":[3099,3143]},{"content":"Remarks","pos":[3153,3160]},{"content":"The buttons can act like pushbuttons, check-box buttons, or radio buttons.","pos":[3164,3238]},{"content":"objects are usually embedded members of frame-window objects derived from the class <bpt id=\"p1\">[</bpt>CFrameWnd<ept id=\"p1\">](../../mfc/reference/cframewnd-class.md)</ept> or <bpt id=\"p2\">[</bpt>CMDIFrameWnd<ept id=\"p2\">](../../mfc/reference/cmdiframewnd-class.md)</ept>.","pos":[3250,3447],"source":" objects are usually embedded members of frame-window objects derived from the class [CFrameWnd](../../mfc/reference/cframewnd-class.md) or [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)."},{"content":"<bpt id=\"p1\">[</bpt>CToolBar::GetToolBarCtrl<ept id=\"p1\">](#ctoolbar__gettoolbarctrl)</ept>, a member function new to MFC 4.0, allows you to take advantage of the Windows common control's support for toolbar customization and additional functionality.","pos":[3454,3667],"source":"[CToolBar::GetToolBarCtrl](#ctoolbar__gettoolbarctrl), a member function new to MFC 4.0, allows you to take advantage of the Windows common control's support for toolbar customization and additional functionality."},{"content":"member functions give you most of the functionality of the Windows common controls; however, when you call <ph id=\"ph1\">`GetToolBarCtrl`</ph>, you can give your toolbars even more of the characteristics of Windows 95/98 toolbars.","pos":[3679,3890],"source":" member functions give you most of the functionality of the Windows common controls; however, when you call `GetToolBarCtrl`, you can give your toolbars even more of the characteristics of Windows 95/98 toolbars."},{"content":"When you call <ph id=\"ph1\">`GetToolBarCtrl`</ph>, it will return a reference to a <ph id=\"ph2\">`CToolBarCtrl`</ph> object.","pos":[3891,3977],"source":" When you call `GetToolBarCtrl`, it will return a reference to a `CToolBarCtrl` object."},{"content":"See <bpt id=\"p1\">[</bpt>CToolBarCtrl<ept id=\"p1\">](../../mfc/reference/ctoolbarctrl-class.md)</ept> for more information about designing toolbars using Windows common controls.","pos":[3978,4116],"source":" See [CToolBarCtrl](../../mfc/reference/ctoolbarctrl-class.md) for more information about designing toolbars using Windows common controls."},{"content":"For more general information about common controls, see <bpt id=\"p1\">[</bpt>Common Controls<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb775493)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[4117,4310],"source":" For more general information about common controls, see [Common Controls](http://msdn.microsoft.com/library/windows/desktop/bb775493) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Visual C++ provides you with two methods to create a toolbar.","pos":[4317,4378]},{"content":"To create a toolbar resource using the Resource Editor, follow these steps:","pos":[4379,4454]},{"content":"Create a toolbar resource.","pos":[4464,4490]},{"pos":[4500,4532],"content":"Construct the <ph id=\"ph1\">`CToolBar`</ph> object.","source":"Construct the `CToolBar` object."},{"pos":[4542,4694],"content":"Call the <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#ctoolbar__create)</ept> (or <bpt id=\"p2\">[</bpt>CreateEx<ept id=\"p2\">](#ctoolbar__createex)</ept>) function to create the Windows toolbar and attach it to the <ph id=\"ph1\">`CToolBar`</ph> object.","source":"Call the [Create](#ctoolbar__create) (or [CreateEx](#ctoolbar__createex)) function to create the Windows toolbar and attach it to the `CToolBar` object."},{"pos":[4704,4776],"content":"Call <bpt id=\"p1\">[</bpt>LoadToolBar<ept id=\"p1\">](#ctoolbar__loadtoolbar)</ept> to load the toolbar resource.","source":"Call [LoadToolBar](#ctoolbar__loadtoolbar) to load the toolbar resource."},{"content":"Otherwise, follow these steps:","pos":[4783,4813]},{"pos":[4823,4855],"content":"Construct the <ph id=\"ph1\">`CToolBar`</ph> object.","source":"Construct the `CToolBar` object."},{"pos":[4865,5017],"content":"Call the <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#ctoolbar__create)</ept> (or <bpt id=\"p2\">[</bpt>CreateEx<ept id=\"p2\">](#ctoolbar__createex)</ept>) function to create the Windows toolbar and attach it to the <ph id=\"ph1\">`CToolBar`</ph> object.","source":"Call the [Create](#ctoolbar__create) (or [CreateEx](#ctoolbar__createex)) function to create the Windows toolbar and attach it to the `CToolBar` object."},{"pos":[5027,5127],"content":"Call <bpt id=\"p1\">[</bpt>LoadBitmap<ept id=\"p1\">](#ctoolbar__loadbitmap)</ept> to load the bitmap that contains the toolbar button images.","source":"Call [LoadBitmap](#ctoolbar__loadbitmap) to load the bitmap that contains the toolbar button images."},{"pos":[5137,5256],"content":"Call <bpt id=\"p1\">[</bpt>SetButtons<ept id=\"p1\">](#ctoolbar__setbuttons)</ept> to set the button style and associate each button with an image in the bitmap.","source":"Call [SetButtons](#ctoolbar__setbuttons) to set the button style and associate each button with an image in the bitmap."},{"content":"All the button images in the toolbar are taken from one bitmap, which must contain one image for each button.","pos":[5263,5372]},{"content":"All images must be the same size; the default is 16 pixels wide and 15 pixels high.","pos":[5373,5456]},{"content":"Images must be side by side in the bitmap.","pos":[5457,5499]},{"content":"The <ph id=\"ph1\">`SetButtons`</ph> function takes a pointer to an array of control IDs and an integer that specifies the number of elements in the array.","pos":[5506,5641],"source":"The `SetButtons` function takes a pointer to an array of control IDs and an integer that specifies the number of elements in the array."},{"content":"The function sets each button's ID to the value of the corresponding element of the array and assigns each button an image index, which specifies the position of the button's image in the bitmap.","pos":[5642,5837]},{"content":"If an array element has the value <bpt id=\"p1\">**</bpt>ID_SEPARATOR<ept id=\"p1\">**</ept>, no image index is assigned.","pos":[5838,5917],"source":" If an array element has the value **ID_SEPARATOR**, no image index is assigned."},{"pos":[5924,6160],"content":"The order of the images in the bitmap is typically the order in which they are drawn on the screen, but you can use the <bpt id=\"p1\">[</bpt>SetButtonInfo<ept id=\"p1\">](#ctoolbar__setbuttoninfo)</ept> function to change the relationship between image order and drawing order.","source":"The order of the images in the bitmap is typically the order in which they are drawn on the screen, but you can use the [SetButtonInfo](#ctoolbar__setbuttoninfo) function to change the relationship between image order and drawing order."},{"content":"All buttons in a toolbar are the same size.","pos":[6167,6210]},{"content":"The default is 24 x 22 pixels, in accordance with <bpt id=\"p1\">*</bpt>Windows Interface Guidelines for Software Design<ept id=\"p1\">*</ept>.","pos":[6211,6312],"source":" The default is 24 x 22 pixels, in accordance with *Windows Interface Guidelines for Software Design*."},{"content":"Any additional space between the image and button dimensions is used to form a border around the image.","pos":[6313,6416]},{"content":"Each button has one image.","pos":[6423,6449]},{"content":"The various button states and styles (pressed, up, down, disabled, disabled down, and indeterminate) are generated from that one image.","pos":[6450,6585]},{"content":"Although bitmaps can be any color, you can achieve the best results with images in black and shades of gray.","pos":[6586,6694]},{"pos":[6702,7093],"content":"[!WARNING]\n`CToolBar` supports bitmaps with a maximum of 16 colors. When you load an image into a toolbar editor, Visual Studio automatically converts the image to a 16-color bitmap, if necessary, and displays a warning message if the image was converted. If you use an image with more than 16 colors (using an external editor to edit the image), the application might behave unexpectedly.","leadings":["","> "],"nodes":[{"content":" supports bitmaps with a maximum of 16 colors. When you load an image into a toolbar editor, Visual Studio automatically converts the image to a 16-color bitmap, if necessary, and displays a warning message if the image was converted. If you use an image with more than 16 colors (using an external editor to edit the image), the application might behave unexpectedly.","pos":[21,389],"nodes":[{"content":"supports bitmaps with a maximum of 16 colors.","pos":[1,46]},{"content":"When you load an image into a toolbar editor, Visual Studio automatically converts the image to a 16-color bitmap, if necessary, and displays a warning message if the image was converted.","pos":[47,234]},{"content":"If you use an image with more than 16 colors (using an external editor to edit the image), the application might behave unexpectedly.","pos":[235,368]}]}]},{"content":"Toolbar buttons imitate pushbuttons by default.","pos":[7100,7147]},{"content":"However, toolbar buttons can also imitate check-box buttons or radio buttons.","pos":[7148,7225]},{"content":"Check-box buttons have three states: checked, cleared, and indeterminate.","pos":[7226,7299]},{"content":"Radio buttons have only two states: checked and cleared.","pos":[7300,7356]},{"content":"To set an individual button or separator style without pointing to an array, call <bpt id=\"p1\">[</bpt>GetButtonStyle<ept id=\"p1\">](#ctoolbar__getbuttonstyle)</ept> to retrieve the style, and then call <bpt id=\"p2\">[</bpt>SetButtonStyle<ept id=\"p2\">](#ctoolbar__setbuttonstyle)</ept> instead of <ph id=\"ph1\">`SetButtons`</ph>.","pos":[7363,7594],"source":"To set an individual button or separator style without pointing to an array, call [GetButtonStyle](#ctoolbar__getbuttonstyle) to retrieve the style, and then call [SetButtonStyle](#ctoolbar__setbuttonstyle) instead of `SetButtons`."},{"content":"is most useful when you want to change a button's style at run time.","pos":[7612,7680]},{"pos":[7687,7890],"content":"To assign text to appear on a button, call <bpt id=\"p1\">[</bpt>GetButtonText<ept id=\"p1\">](#ctoolbar__getbuttontext)</ept> to retrieve the text to appear on the button, and then call <bpt id=\"p2\">[</bpt>SetButtonText<ept id=\"p2\">](#ctoolbar__setbuttontext)</ept> to set the text.","source":"To assign text to appear on a button, call [GetButtonText](#ctoolbar__getbuttontext) to retrieve the text to appear on the button, and then call [SetButtonText](#ctoolbar__setbuttontext) to set the text."},{"content":"To create a check-box button, assign it the style <bpt id=\"p1\">**</bpt>TBBS_CHECKBOX<ept id=\"p1\">**</ept> or use a <ph id=\"ph1\">`CCmdUI`</ph> object's <ph id=\"ph2\">`SetCheck`</ph> member function in an <ph id=\"ph3\">`ON_UPDATE_COMMAND_UI`</ph> handler.","pos":[7897,8056],"source":"To create a check-box button, assign it the style **TBBS_CHECKBOX** or use a `CCmdUI` object's `SetCheck` member function in an `ON_UPDATE_COMMAND_UI` handler."},{"content":"Calling <ph id=\"ph1\">`SetCheck`</ph> turns a pushbutton into a check-box button.","pos":[8057,8119],"source":" Calling `SetCheck` turns a pushbutton into a check-box button."},{"content":"Pass <ph id=\"ph1\">`SetCheck`</ph> an argument of 0 for unchecked, 1 for checked, or 2 for indeterminate.","pos":[8120,8206],"source":" Pass `SetCheck` an argument of 0 for unchecked, 1 for checked, or 2 for indeterminate."},{"content":"To create a radio button, call a <bpt id=\"p1\">[</bpt>CCmdUI<ept id=\"p1\">](../../mfc/reference/ccmdui-class.md)</ept> object's <bpt id=\"p2\">[</bpt>SetRadio<ept id=\"p2\">](../../mfc/reference/ccmdui-class.md#ccmdui__setradio)</ept> member function from an <ph id=\"ph1\">`ON_UPDATE_COMMAND_UI`</ph> handler.","pos":[8213,8421],"source":"To create a radio button, call a [CCmdUI](../../mfc/reference/ccmdui-class.md) object's [SetRadio](../../mfc/reference/ccmdui-class.md#ccmdui__setradio) member function from an `ON_UPDATE_COMMAND_UI` handler."},{"content":"Pass <ph id=\"ph1\">`SetRadio`</ph> an argument of 0 for unchecked or nonzero for checked.","pos":[8422,8492],"source":" Pass `SetRadio` an argument of 0 for unchecked or nonzero for checked."},{"content":"In order to provide a radio group's mutually exclusive behavior, you must have <ph id=\"ph1\">`ON_UPDATE_COMMAND_UI`</ph> handlers for all of the buttons in the group.","pos":[8493,8640],"source":" In order to provide a radio group's mutually exclusive behavior, you must have `ON_UPDATE_COMMAND_UI` handlers for all of the buttons in the group."},{"pos":[8647,8846],"content":"For more information on using <ph id=\"ph1\">`CToolBar`</ph>, see the article <bpt id=\"p1\">[</bpt>MFC Toolbar Implementation<ept id=\"p1\">](../../mfc/mfc-toolbar-implementation.md)</ept> and <bpt id=\"p2\">[</bpt>Technical Note 31: Control Bars<ept id=\"p2\">](../../mfc/tn031-control-bars.md)</ept>.","source":"For more information on using `CToolBar`, see the article [MFC Toolbar Implementation](../../mfc/mfc-toolbar-implementation.md) and [Technical Note 31: Control Bars](../../mfc/tn031-control-bars.md)."},{"content":"Inheritance Hierarchy","pos":[8855,8876]},{"content":"CObject","pos":[8881,8888]},{"content":"CCmdTarget","pos":[8935,8945]},{"content":"CWnd","pos":[8995,8999]},{"content":"CControlBar","pos":[9043,9054]},{"content":"Requirements","pos":[9123,9135]},{"pos":[9139,9159],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxext.h","source":"**Header:** afxext.h"},{"pos":[9210,9234],"content":"CToolBar::CommandToIndex"},{"pos":[9238,9365],"content":"This member function returns the index of the first toolbar button, starting at position 0, whose command ID matches <ph id=\"ph1\">`nIDFind`</ph>.","source":"This member function returns the index of the first toolbar button, starting at position 0, whose command ID matches `nIDFind`."},{"content":"Parameters","pos":[9433,9443]},{"content":"Command ID of a toolbar button.","pos":[9460,9491]},{"content":"Return Value","pos":[9501,9513]},{"content":"The index of the button, or –1 if no button has the given command ID.","pos":[9517,9586]},{"pos":[9629,9645],"content":"CToolBar::Create"},{"pos":[9649,9758],"content":"This member function creates a Windows toolbar (a child window) and associates it with the <ph id=\"ph1\">`CToolBar`</ph> object.","source":"This member function creates a Windows toolbar (a child window) and associates it with the `CToolBar` object."},{"content":"Parameters","pos":[9917,9927]},{"content":"Pointer to the window that is the toolbar's parent.","pos":[9947,9998]},{"content":"The toolbar style.","pos":[10018,10036]},{"content":"Additional toolbar styles supported are:","pos":[10037,10077]},{"pos":[10096,10138],"content":"Control bar is at top of the frame window."},{"pos":[10160,10205],"content":"Control bar is at bottom of the frame window."},{"pos":[10228,10287],"content":"Control bar is not repositioned when the parent is resized."},{"pos":[10311,10342],"content":"Control bar displays tool tips."},{"pos":[10350,10395],"content":"<bpt id=\"p1\">**</bpt>CBRS_SIZE_DYNAMIC<ept id=\"p1\">**</ept> Control bar is dynamic.","source":"**CBRS_SIZE_DYNAMIC** Control bar is dynamic."},{"pos":[10403,10444],"content":"<bpt id=\"p1\">**</bpt>CBRS_SIZE_FIXED<ept id=\"p1\">**</ept> Control bar is fixed.","source":"**CBRS_SIZE_FIXED** Control bar is fixed."},{"pos":[10452,10494],"content":"<bpt id=\"p1\">**</bpt>CBRS_FLOATING<ept id=\"p1\">**</ept> Control bar is floating.","source":"**CBRS_FLOATING** Control bar is floating."},{"pos":[10515,10564],"content":"Status bar displays information about the button."},{"pos":[10572,10635],"content":"<bpt id=\"p1\">**</bpt>CBRS_HIDE_INPLACE<ept id=\"p1\">**</ept> Control bar is not displayed to the user.","source":"**CBRS_HIDE_INPLACE** Control bar is not displayed to the user."},{"pos":[10642,10681],"content":"`nID`  \nThe toolbar's child-window ID.","leadings":[""," "],"nodes":[{"content":"The toolbar's child-window ID.","pos":[8,38]}]},{"content":"Return Value","pos":[10691,10703]},{"content":"Nonzero if successful; otherwise 0.","pos":[10707,10742]},{"content":"Remarks","pos":[10752,10759]},{"content":"It also sets the toolbar height to a default value.","pos":[10763,10814]},{"content":"Example","pos":[10824,10831]},{"pos":[10846,10864],"content":"NVC_MFCDocView#179"},{"pos":[10959,10977],"content":"CToolBar::CreateEx"},{"pos":[10981,11089],"content":"Call this function to create a Windows toolbar (a child window) and associate it with the <ph id=\"ph1\">`CToolBar`</ph> object.","source":"Call this function to create a Windows toolbar (a child window) and associate it with the `CToolBar` object."},{"content":"Parameters","pos":[11358,11368]},{"content":"Pointer to the window that is the toolbar's parent.","pos":[11388,11439]},{"content":"Additional styles for the creation of the embedded <bpt id=\"p1\">[</bpt>CToolBarCtrl<ept id=\"p1\">](../../mfc/reference/ctoolbarctrl-class.md)</ept> object.","pos":[11463,11579],"source":" Additional styles for the creation of the embedded [CToolBarCtrl](../../mfc/reference/ctoolbarctrl-class.md) object."},{"content":"By default, this value is set to <bpt id=\"p1\">**</bpt>TBSTYLE_FLAT<ept id=\"p1\">**</ept>.","pos":[11580,11630],"source":" By default, this value is set to **TBSTYLE_FLAT**."},{"content":"For a complete list of toolbar styles, see <ph id=\"ph1\">`dwStyle`</ph>.","pos":[11631,11684],"source":" For a complete list of toolbar styles, see `dwStyle`."},{"content":"The toolbar style.","pos":[11704,11722]},{"content":"See <bpt id=\"p1\">[</bpt>Toolbar Control and Button Styles<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb760439)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for a list of appropriate styles.","pos":[11723,11915],"source":" See [Toolbar Control and Button Styles](http://msdn.microsoft.com/library/windows/desktop/bb760439) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a list of appropriate styles."},{"content":"rcBorders","pos":[11923,11932]},{"content":"A <bpt id=\"p1\">[</bpt>CRect<ept id=\"p1\">](../../atl-mfc-shared/reference/crect-class.md)</ept> object that defines the widths of the toolbar window borders.","pos":[11937,12055],"source":" A [CRect](../../atl-mfc-shared/reference/crect-class.md) object that defines the widths of the toolbar window borders."},{"content":"These borders are set to 0,0,0,0 by default, thereby resulting in a toolbar window with no borders.","pos":[12056,12155]},{"content":"The toolbar's child-window ID.","pos":[12171,12201]},{"content":"Return Value","pos":[12211,12223]},{"content":"Nonzero if successful; otherwise 0.","pos":[12227,12262]},{"content":"Remarks","pos":[12272,12279]},{"content":"It also sets the toolbar height to a default value.","pos":[12283,12334]},{"content":"Use <ph id=\"ph1\">`CreateEx`</ph>, instead of <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#ctoolbar__create)</ept>, when certain styles need to be present during the creation of the embedded tool bar control.","pos":[12341,12489],"source":"Use `CreateEx`, instead of [Create](#ctoolbar__create), when certain styles need to be present during the creation of the embedded tool bar control."},{"content":"For example, set <ph id=\"ph1\">`dwCtrlStyle`</ph> to <bpt id=\"p1\">**</bpt>TBSTYLE_FLAT &amp;#124; TBSTYLE_TRANSPARENT<ept id=\"p1\">**</ept> to create a toolbar that resembles the Internet Explorer 4 toolbars.","pos":[12490,12636],"source":" For example, set `dwCtrlStyle` to **TBSTYLE_FLAT &#124; TBSTYLE_TRANSPARENT** to create a toolbar that resembles the Internet Explorer 4 toolbars."},{"content":"Example","pos":[12646,12653]},{"pos":[12668,12686],"content":"NVC_MFCDocView#180"},{"pos":[12781,12799],"content":"CToolBar::CToolBar"},{"pos":[12803,12882],"content":"This member function constructs a <ph id=\"ph1\">`CToolBar`</ph> object and sets the default sizes.","source":"This member function constructs a `CToolBar` object and sets the default sizes."},{"content":"Remarks","pos":[12919,12926]},{"pos":[12930,13012],"content":"Call the <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#ctoolbar__create)</ept> member function to create the toolbar window.","source":"Call the [Create](#ctoolbar__create) member function to create the toolbar window."},{"pos":[13062,13085],"content":"CToolBar::GetButtonInfo"},{"pos":[13089,13232],"content":"This member function retrieves the control ID, style, and image index of the toolbar button or separator at the location specified by <bpt id=\"p1\">*</bpt>nIndex.<ept id=\"p1\">*</ept>","source":"This member function retrieves the control ID, style, and image index of the toolbar button or separator at the location specified by *nIndex.*"},{"content":"Parameters","pos":[13359,13369]},{"content":"Index of the toolbar button or separator whose information is to be retrieved.","pos":[13385,13463]},{"content":"Reference to a <bpt id=\"p1\">**</bpt>UINT<ept id=\"p1\">**</ept> that is set to the command ID of the button.","pos":[13479,13547],"source":" Reference to a **UINT** that is set to the command ID of the button."},{"content":"Reference to a <bpt id=\"p1\">**</bpt>UINT<ept id=\"p1\">**</ept> that is set to the style of the button.","pos":[13566,13629],"source":" Reference to a **UINT** that is set to the style of the button."},{"content":"Reference to an integer that is set to the index of the button's image within the bitmap.","pos":[13648,13737]},{"content":"Remarks","pos":[13747,13754]},{"content":"Those values are assigned to the variables referenced by <ph id=\"ph1\">`nID`</ph>, <ph id=\"ph2\">`nStyle`</ph>, and <ph id=\"ph3\">`iImage`</ph>.","pos":[13758,13845],"source":"Those values are assigned to the variables referenced by `nID`, `nStyle`, and `iImage`."},{"content":"The image index is the position of the image within the bitmap that contains images for all the toolbar buttons.","pos":[13846,13958]},{"content":"The first image is at position 0.","pos":[13959,13992]},{"pos":[13999,14083],"content":"If <ph id=\"ph1\">`nIndex`</ph> specifies a separator, <ph id=\"ph2\">`iImage`</ph> is set to the separator width in pixels.","source":"If `nIndex` specifies a separator, `iImage` is set to the separator width in pixels."},{"pos":[14134,14158],"content":"CToolBar::GetButtonStyle"},{"content":"Call this member function to retrieve the style of a button or separator on the toolbar.","pos":[14162,14250]},{"content":"Parameters","pos":[14317,14327]},{"content":"The index of the toolbar button or separator style to be retrieved.","pos":[14343,14410]},{"content":"Return Value","pos":[14420,14432]},{"pos":[14436,14495],"content":"The style of the button or separator specified by <ph id=\"ph1\">`nIndex`</ph>.","source":"The style of the button or separator specified by `nIndex`."},{"content":"Remarks","pos":[14505,14512]},{"content":"A button's style determines how the button appears and how it responds to user input.","pos":[14516,14601]},{"content":"See <bpt id=\"p1\">[</bpt>SetButtonStyle<ept id=\"p1\">](#ctoolbar__setbuttonstyle)</ept> for examples of button styles.","pos":[14602,14680],"source":" See [SetButtonStyle](#ctoolbar__setbuttonstyle) for examples of button styles."},{"pos":[14730,14753],"content":"CToolBar::GetButtonText"},{"content":"Call this member function to retrieve the text that appears on a button.","pos":[14757,14829]},{"content":"Parameters","pos":[14975,14985]},{"content":"Index of the text to be retrieved.","pos":[15001,15035]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> object that will contain the text to be retrieved.","pos":[15055,15182],"source":" A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object that will contain the text to be retrieved."},{"content":"Return Value","pos":[15192,15204]},{"pos":[15208,15254],"content":"A <ph id=\"ph1\">`CString`</ph> object containing the button text.","source":"A `CString` object containing the button text."},{"content":"Remarks","pos":[15264,15271]},{"pos":[15275,15361],"content":"The second form of this member function fills a <ph id=\"ph1\">`CString`</ph> object with the string text.","source":"The second form of this member function fills a `CString` object with the string text."},{"pos":[15407,15426],"content":"CToolBar::GetItemID"},{"pos":[15430,15523],"content":"This member function returns the command ID of the button or separator specified by <ph id=\"ph1\">`nIndex`</ph>.","source":"This member function returns the command ID of the button or separator specified by `nIndex`."},{"content":"Parameters","pos":[15585,15595]},{"content":"Index of the item whose ID is to be retrieved.","pos":[15611,15657]},{"content":"Return Value","pos":[15667,15679]},{"pos":[15683,15747],"content":"The command ID of the button or separator specified by <ph id=\"ph1\">`nIndex`</ph>.","source":"The command ID of the button or separator specified by `nIndex`."},{"content":"Remarks","pos":[15757,15764]},{"pos":[15768,15803],"content":"Separators return <bpt id=\"p1\">**</bpt>ID_SEPARATOR<ept id=\"p1\">**</ept>.","source":"Separators return **ID_SEPARATOR**."},{"pos":[15851,15872],"content":"CToolBar::GetItemRect"},{"pos":[15876,16033],"content":"This member function fills the <ph id=\"ph1\">`RECT`</ph> structure whose address is contained in <ph id=\"ph2\">`lpRect`</ph> with the coordinates of the button or separator specified by <ph id=\"ph3\">`nIndex`</ph>.","source":"This member function fills the `RECT` structure whose address is contained in `lpRect` with the coordinates of the button or separator specified by `nIndex`."},{"content":"Parameters","pos":[16131,16141]},{"content":"Index of the item (button or separator) whose rectangle coordinates are to be retrieved.","pos":[16157,16245]},{"content":"Address of the <bpt id=\"p1\">[</bpt>RECT<ept id=\"p1\">](../../mfc/reference/rect-structure1.md)</ept> structure that will contain the item's coordinates.","pos":[16264,16377],"source":" Address of the [RECT](../../mfc/reference/rect-structure1.md) structure that will contain the item's coordinates."},{"content":"Remarks","pos":[16387,16394]},{"content":"Coordinates are in pixels relative to the upper-left corner of the toolbar.","pos":[16398,16473]},{"pos":[16480,16590],"content":"Use <ph id=\"ph1\">`GetItemRect`</ph> to get the coordinates of a separator you want to replace with a combo box or other control.","source":"Use `GetItemRect` to get the coordinates of a separator you want to replace with a combo box or other control."},{"content":"Example","pos":[16600,16607]},{"pos":[16612,16674],"content":"See the example for <bpt id=\"p1\">[</bpt>CToolBar::SetSizes<ept id=\"p1\">](#ctoolbar__setsizes)</ept>.","source":"See the example for [CToolBar::SetSizes](#ctoolbar__setsizes)."},{"pos":[16725,16749],"content":"CToolBar::GetToolBarCtrl"},{"content":"This member function allows direct access to the underlying common control.","pos":[16753,16828]},{"content":"Return Value","pos":[16894,16906]},{"pos":[16910,16949],"content":"A reference to a <ph id=\"ph1\">`CToolBarCtrl`</ph> object.","source":"A reference to a `CToolBarCtrl` object."},{"content":"Remarks","pos":[16959,16966]},{"pos":[16970,17199],"content":"Use <ph id=\"ph1\">`GetToolBarCtrl`</ph> to take advantage of the functionality of the Windows toolbar common control, and to take advantage of the support <bpt id=\"p1\">[</bpt>CToolBarCtrl<ept id=\"p1\">](../../mfc/reference/ctoolbarctrl-class.md)</ept> provides for toolbar customization.","source":"Use `GetToolBarCtrl` to take advantage of the functionality of the Windows toolbar common control, and to take advantage of the support [CToolBarCtrl](../../mfc/reference/ctoolbarctrl-class.md) provides for toolbar customization."},{"pos":[17206,17451],"content":"For more information about using common controls, see the article <bpt id=\"p1\">[</bpt>Controls<ept id=\"p1\">](../../mfc/controls-mfc.md)</ept> and <bpt id=\"p2\">[</bpt>Common Controls<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/bb775493)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information about using common controls, see the article [Controls](../../mfc/controls-mfc.md) and [Common Controls](http://msdn.microsoft.com/library/windows/desktop/bb775493) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[17461,17468]},{"pos":[17483,17503],"content":"NVC_MFCDocViewSDI#15"},{"pos":[17600,17620],"content":"CToolBar::LoadBitmap"},{"pos":[17624,17718],"content":"Call this member function to load the bitmap specified by <ph id=\"ph1\">`lpszResourceName`</ph> or <ph id=\"ph2\">`nIDResource`</ph>.","source":"Call this member function to load the bitmap specified by `lpszResourceName` or `nIDResource`."},{"content":"Parameters","pos":[17824,17834]},{"content":"Pointer to the resource name of the bitmap to be loaded.","pos":[17860,17916]},{"content":"Resource ID of the bitmap to be loaded.","pos":[17940,17979]},{"content":"Return Value","pos":[17989,18001]},{"content":"Nonzero if successful; otherwise 0.","pos":[18005,18040]},{"content":"Remarks","pos":[18050,18057]},{"content":"The bitmap should contain one image for each toolbar button.","pos":[18061,18121]},{"content":"If the images are not of the standard size (16 pixels wide and 15 pixels high), call <bpt id=\"p1\">[</bpt>SetSizes<ept id=\"p1\">](#ctoolbar__setsizes)</ept> to set the button sizes and their images.","pos":[18122,18280],"source":" If the images are not of the standard size (16 pixels wide and 15 pixels high), call [SetSizes](#ctoolbar__setsizes) to set the button sizes and their images."},{"pos":[18288,18679],"content":"[!WARNING]\n`CToolBar` supports bitmaps with a maximum of 16 colors. When you load an image into a toolbar editor, Visual Studio automatically converts the image to a 16-color bitmap, if necessary, and displays a warning message if the image was converted. If you use an image with more than 16 colors (using an external editor to edit the image), the application might behave unexpectedly.","leadings":["","> "],"nodes":[{"content":" supports bitmaps with a maximum of 16 colors. When you load an image into a toolbar editor, Visual Studio automatically converts the image to a 16-color bitmap, if necessary, and displays a warning message if the image was converted. If you use an image with more than 16 colors (using an external editor to edit the image), the application might behave unexpectedly.","pos":[21,389],"nodes":[{"content":"supports bitmaps with a maximum of 16 colors.","pos":[1,46]},{"content":"When you load an image into a toolbar editor, Visual Studio automatically converts the image to a 16-color bitmap, if necessary, and displays a warning message if the image was converted.","pos":[47,234]},{"content":"If you use an image with more than 16 colors (using an external editor to edit the image), the application might behave unexpectedly.","pos":[235,368]}]}]},{"pos":[18727,18748],"content":"CToolBar::LoadToolBar"},{"pos":[18752,18847],"content":"Call this member function to load the toolbar specified by <ph id=\"ph1\">`lpszResourceName`</ph> or <ph id=\"ph2\">`nIDResource`</ph>.","source":"Call this member function to load the toolbar specified by `lpszResourceName` or `nIDResource`."},{"content":"Parameters","pos":[18955,18965]},{"content":"Pointer to the resource name of the toolbar to be loaded.","pos":[18991,19048]},{"content":"Resource ID of the toolbar to be loaded.","pos":[19072,19112]},{"content":"Return Value","pos":[19122,19134]},{"content":"Nonzero if successful; otherwise 0.","pos":[19138,19173]},{"content":"Remarks","pos":[19183,19190]},{"pos":[19194,19302],"content":"See <bpt id=\"p1\">[</bpt>toolbar editor<ept id=\"p1\">](../../mfc/toolbar-editor.md)</ept> in for more information about creating a toolbar resource.","source":"See [toolbar editor](../../mfc/toolbar-editor.md) in for more information about creating a toolbar resource."},{"content":"Example","pos":[19312,19319]},{"pos":[19324,19386],"content":"See the example for <bpt id=\"p1\">[</bpt>CToolBar::CreateEx<ept id=\"p1\">](#ctoolbar__createex)</ept>.","source":"See the example for [CToolBar::CreateEx](#ctoolbar__createex)."},{"pos":[19432,19451],"content":"CToolBar::SetBitmap"},{"content":"Call this member function to set the bitmap image for the toolbar.","pos":[19455,19521]},{"content":"Parameters","pos":[19584,19594]},{"content":"hbmImageWell","pos":[19599,19611]},{"content":"Handle of a bitmap image that is associated with a toolbar.","pos":[19616,19675]},{"content":"Return Value","pos":[19685,19697]},{"content":"Nonzero if successful; otherwise 0.","pos":[19701,19736]},{"content":"Remarks","pos":[19746,19753]},{"pos":[19757,19898],"content":"For example, call <ph id=\"ph1\">`SetBitmap`</ph> to change the bitmapped image after the user takes an action on a document that changes the action of a button.","source":"For example, call `SetBitmap` to change the bitmapped image after the user takes an action on a document that changes the action of a button."},{"pos":[19948,19971],"content":"CToolBar::SetButtonInfo"},{"content":"Call this member function to set the button's command ID, style, and image number.","pos":[19975,20057]},{"content":"Parameters","pos":[20172,20182]},{"content":"Zero-based index of the button or separator for which information is to be set.","pos":[20198,20277]},{"content":"The value to which the button's command ID is set.","pos":[20293,20343]},{"content":"The new button style.","pos":[20362,20383]},{"content":"The following button styles are supported:","pos":[20384,20426]},{"pos":[20434,20479],"content":"<bpt id=\"p1\">**</bpt>TBBS_BUTTON<ept id=\"p1\">**</ept> Standard pushbutton (default)","source":"**TBBS_BUTTON** Standard pushbutton (default)"},{"pos":[20487,20515],"content":"<bpt id=\"p1\">**</bpt>TBBS_SEPARATOR<ept id=\"p1\">**</ept> Separator","source":"**TBBS_SEPARATOR** Separator"},{"pos":[20523,20562],"content":"<bpt id=\"p1\">**</bpt>TBBS_CHECKBOX<ept id=\"p1\">**</ept> Auto check-box button","source":"**TBBS_CHECKBOX** Auto check-box button"},{"pos":[20570,20622],"content":"<bpt id=\"p1\">**</bpt>TBBS_GROUP<ept id=\"p1\">**</ept> Marks the start of a group of buttons","source":"**TBBS_GROUP** Marks the start of a group of buttons"},{"pos":[20630,20697],"content":"<bpt id=\"p1\">**</bpt>TBBS_CHECKGROUP<ept id=\"p1\">**</ept> Marks the start of a group of check-box buttons","source":"**TBBS_CHECKGROUP** Marks the start of a group of check-box buttons"},{"pos":[20705,20755],"content":"<bpt id=\"p1\">**</bpt>TBBS_DROPDOWN<ept id=\"p1\">**</ept> Creates a drop-down list button.","source":"**TBBS_DROPDOWN** Creates a drop-down list button."},{"pos":[20763,20881],"content":"<bpt id=\"p1\">**</bpt>TBBS_AUTOSIZE<ept id=\"p1\">**</ept> The button's width will be calculated based on the text of the button, not on the size of the image.","source":"**TBBS_AUTOSIZE** The button's width will be calculated based on the text of the button, not on the size of the image."},{"pos":[20889,20978],"content":"<bpt id=\"p1\">**</bpt>TBBS_NOPREFIX<ept id=\"p1\">**</ept> The button text will not have an accelerator prefix associated with it.","source":"**TBBS_NOPREFIX** The button text will not have an accelerator prefix associated with it."},{"pos":[20985,21048],"content":"`iImage`  \nNew index for the button's image within the bitmap.","leadings":[""," "],"nodes":[{"content":"New index for the button's image within the bitmap.","pos":[11,62]}]},{"content":"Remarks","pos":[21058,21065]},{"pos":[21069,21209],"content":"For separators, which have the style <bpt id=\"p1\">**</bpt>TBBS_SEPARATOR<ept id=\"p1\">**</ept>, this function sets the separator's width in pixels to the value stored in <ph id=\"ph1\">`iImage`</ph>.","source":"For separators, which have the style **TBBS_SEPARATOR**, this function sets the separator's width in pixels to the value stored in `iImage`."},{"pos":[21217,21706],"content":"[!NOTE]\n You can also set button states using the `nStyle` parameter; however, because button states are controlled by the [ON_UPDATE_COMMAND_UI](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4) handler, any state you set using `SetButtonInfo` will be lost during the next idle processing. See [How to Update User-Interface Objects](../../mfc/how-to-update-user-interface-objects.md) and [TN031: Control Bars](../../mfc/tn031-control-bars.md) for more information.","leadings":["","> "],"nodes":[{"content":" You can also set button states using the `nStyle` parameter; however, because button states are controlled by the [ON_UPDATE_COMMAND_UI](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4) handler, any state you set using `SetButtonInfo` will be lost during the next idle processing. See [How to Update User-Interface Objects](../../mfc/how-to-update-user-interface-objects.md) and [TN031: Control Bars](../../mfc/tn031-control-bars.md) for more information.","pos":[8,487],"nodes":[{"content":"You can also set button states using the <ph id=\"ph1\">`nStyle`</ph> parameter; however, because button states are controlled by the <bpt id=\"p1\">[</bpt>ON_UPDATE_COMMAND_UI<ept id=\"p1\">](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4)</ept> handler, any state you set using <ph id=\"ph2\">`SetButtonInfo`</ph> will be lost during the next idle processing.","pos":[1,304],"source":" You can also set button states using the `nStyle` parameter; however, because button states are controlled by the [ON_UPDATE_COMMAND_UI](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4) handler, any state you set using `SetButtonInfo` will be lost during the next idle processing."},{"content":"See <bpt id=\"p1\">[</bpt>How to Update User-Interface Objects<ept id=\"p1\">](../../mfc/how-to-update-user-interface-objects.md)</ept> and <bpt id=\"p2\">[</bpt>TN031: Control Bars<ept id=\"p2\">](../../mfc/tn031-control-bars.md)</ept> for more information.","pos":[305,479],"source":" See [How to Update User-Interface Objects](../../mfc/how-to-update-user-interface-objects.md) and [TN031: Control Bars](../../mfc/tn031-control-bars.md) for more information."}]}]},{"pos":[21713,21876],"content":"For information on bitmap images and buttons, see the <bpt id=\"p1\">[</bpt>CToolBar<ept id=\"p1\">](../../mfc/reference/ctoolbar-class.md)</ept> Overview and <bpt id=\"p2\">[</bpt>CToolBar::LoadBitmap<ept id=\"p2\">](#ctoolbar__loadbitmap)</ept>.","source":"For information on bitmap images and buttons, see the [CToolBar](../../mfc/reference/ctoolbar-class.md) Overview and [CToolBar::LoadBitmap](#ctoolbar__loadbitmap)."},{"pos":[21923,21943],"content":"CToolBar::SetButtons"},{"pos":[21947,22083],"content":"This member function sets each toolbar button's command ID to the value specified by the corresponding element of the array <ph id=\"ph1\">`lpIDArray`</ph>.","source":"This member function sets each toolbar button's command ID to the value specified by the corresponding element of the array `lpIDArray`."},{"content":"Parameters","pos":[22173,22183]},{"content":"Pointer to an array of command Ids.","pos":[22202,22237]},{"content":"It can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> to allocate empty buttons.","pos":[22238,22283],"source":" It can be **NULL** to allocate empty buttons."},{"content":"Number of elements in the array pointed to by <ph id=\"ph1\">`lpIDArray`</ph>.","pos":[22304,22362],"source":" Number of elements in the array pointed to by `lpIDArray`."},{"content":"Return Value","pos":[22372,22384]},{"content":"Nonzero if successful; otherwise 0.","pos":[22388,22423]},{"content":"Remarks","pos":[22433,22440]},{"content":"If an element of the array has the value <bpt id=\"p1\">**</bpt>ID_SEPARATOR<ept id=\"p1\">**</ept>, a separator is created in the corresponding position of the toolbar.","pos":[22444,22571],"source":"If an element of the array has the value **ID_SEPARATOR**, a separator is created in the corresponding position of the toolbar."},{"content":"This function also sets each button's style to <bpt id=\"p1\">**</bpt>TBBS_BUTTON<ept id=\"p1\">**</ept> and each separator's style to <bpt id=\"p2\">**</bpt>TBBS_SEPARATOR<ept id=\"p2\">**</ept>, and assigns an image index to each button.","pos":[22572,22727],"source":" This function also sets each button's style to **TBBS_BUTTON** and each separator's style to **TBBS_SEPARATOR**, and assigns an image index to each button."},{"content":"The image index specifies the position of the button's image within the bitmap.","pos":[22728,22807]},{"content":"You do not need to account for separators in the bitmap because this function does not assign image indexes for separators.","pos":[22814,22937]},{"content":"If your toolbar has buttons at positions 0, 1, and 3 and a separator at position 2, the images at positions 0, 1, and 2 in your bitmap are assigned to the buttons at positions 0, 1, and 3, respectively.","pos":[22938,23140]},{"content":"If <ph id=\"ph1\">`lpIDArray`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, this function allocates space for the number of items specified by <ph id=\"ph2\">`nIDCount`</ph>.","pos":[23147,23253],"source":"If `lpIDArray` is **NULL**, this function allocates space for the number of items specified by `nIDCount`."},{"content":"Use <bpt id=\"p1\">[</bpt>SetButtonInfo<ept id=\"p1\">](#ctoolbar__setbuttoninfo)</ept> to set each item's attributes.","pos":[23254,23330],"source":" Use [SetButtonInfo](#ctoolbar__setbuttoninfo) to set each item's attributes."},{"pos":[23381,23405],"content":"CToolBar::SetButtonStyle"},{"content":"Call this member function to set the style of a button or separator, or to group buttons.","pos":[23409,23498]},{"content":"Parameters","pos":[23580,23590]},{"content":"Index of the button or separator whose information is to be set.","pos":[23606,23670]},{"content":"The button style.","pos":[23689,23706]},{"content":"The following button styles are supported:","pos":[23707,23749]},{"pos":[23757,23802],"content":"<bpt id=\"p1\">**</bpt>TBBS_BUTTON<ept id=\"p1\">**</ept> Standard pushbutton (default)","source":"**TBBS_BUTTON** Standard pushbutton (default)"},{"pos":[23810,23838],"content":"<bpt id=\"p1\">**</bpt>TBBS_SEPARATOR<ept id=\"p1\">**</ept> Separator","source":"**TBBS_SEPARATOR** Separator"},{"pos":[23846,23885],"content":"<bpt id=\"p1\">**</bpt>TBBS_CHECKBOX<ept id=\"p1\">**</ept> Auto check-box button","source":"**TBBS_CHECKBOX** Auto check-box button"},{"pos":[23893,23945],"content":"<bpt id=\"p1\">**</bpt>TBBS_GROUP<ept id=\"p1\">**</ept> Marks the start of a group of buttons","source":"**TBBS_GROUP** Marks the start of a group of buttons"},{"pos":[23953,24020],"content":"<bpt id=\"p1\">**</bpt>TBBS_CHECKGROUP<ept id=\"p1\">**</ept> Marks the start of a group of check-box buttons","source":"**TBBS_CHECKGROUP** Marks the start of a group of check-box buttons"},{"pos":[24028,24077],"content":"<bpt id=\"p1\">**</bpt>TBBS_DROPDOWN<ept id=\"p1\">**</ept> Creates a drop-down list button","source":"**TBBS_DROPDOWN** Creates a drop-down list button"},{"pos":[24085,24202],"content":"<bpt id=\"p1\">**</bpt>TBBS_AUTOSIZE<ept id=\"p1\">**</ept> The button's width will be calculated based on the text of the button, not on the size of the image","source":"**TBBS_AUTOSIZE** The button's width will be calculated based on the text of the button, not on the size of the image"},{"pos":[24210,24298],"content":"<bpt id=\"p1\">**</bpt>TBBS_NOPREFIX<ept id=\"p1\">**</ept> The button text will not have an accelerator prefix associated with it","source":"**TBBS_NOPREFIX** The button text will not have an accelerator prefix associated with it"},{"content":"Remarks","pos":[24308,24315]},{"content":"A button's style determines how the button appears and how it responds to user input.","pos":[24319,24404]},{"pos":[24411,24555],"content":"Before calling <ph id=\"ph1\">`SetButtonStyle`</ph>, call the <bpt id=\"p1\">[</bpt>GetButtonStyle<ept id=\"p1\">](#ctoolbar__getbuttonstyle)</ept> member function to retrieve the button or separator style.","source":"Before calling `SetButtonStyle`, call the [GetButtonStyle](#ctoolbar__getbuttonstyle) member function to retrieve the button or separator style."},{"pos":[24563,25053],"content":"[!NOTE]\n You can also set button states using the `nStyle` parameter; however, because button states are controlled by the [ON_UPDATE_COMMAND_UI](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4) handler, any state you set using `SetButtonStyle` will be lost during the next idle processing. See [How to Update User-Interface Objects](../../mfc/how-to-update-user-interface-objects.md) and [TN031: Control Bars](../../mfc/tn031-control-bars.md) for more information.","leadings":["","> "],"nodes":[{"content":" You can also set button states using the `nStyle` parameter; however, because button states are controlled by the [ON_UPDATE_COMMAND_UI](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4) handler, any state you set using `SetButtonStyle` will be lost during the next idle processing. See [How to Update User-Interface Objects](../../mfc/how-to-update-user-interface-objects.md) and [TN031: Control Bars](../../mfc/tn031-control-bars.md) for more information.","pos":[8,488],"nodes":[{"content":"You can also set button states using the <ph id=\"ph1\">`nStyle`</ph> parameter; however, because button states are controlled by the <bpt id=\"p1\">[</bpt>ON_UPDATE_COMMAND_UI<ept id=\"p1\">](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4)</ept> handler, any state you set using <ph id=\"ph2\">`SetButtonStyle`</ph> will be lost during the next idle processing.","pos":[1,305],"source":" You can also set button states using the `nStyle` parameter; however, because button states are controlled by the [ON_UPDATE_COMMAND_UI](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4) handler, any state you set using `SetButtonStyle` will be lost during the next idle processing."},{"content":"See <bpt id=\"p1\">[</bpt>How to Update User-Interface Objects<ept id=\"p1\">](../../mfc/how-to-update-user-interface-objects.md)</ept> and <bpt id=\"p2\">[</bpt>TN031: Control Bars<ept id=\"p2\">](../../mfc/tn031-control-bars.md)</ept> for more information.","pos":[306,480],"source":" See [How to Update User-Interface Objects](../../mfc/how-to-update-user-interface-objects.md) and [TN031: Control Bars](../../mfc/tn031-control-bars.md) for more information."}]}]},{"pos":[25103,25126],"content":"CToolBar::SetButtonText"},{"content":"Call this function to set the text on a button.","pos":[25130,25177]},{"content":"Parameters","pos":[25263,25273]},{"content":"Index of the button whose text is to be set.","pos":[25289,25333]},{"content":"Points to the text to be set on a button.","pos":[25354,25395]},{"content":"Return Value","pos":[25405,25417]},{"content":"Nonzero if successful; otherwise 0.","pos":[25421,25456]},{"content":"Example","pos":[25466,25473]},{"pos":[25478,25552],"content":"See the example for <bpt id=\"p1\">[</bpt>CToolBar::GetToolBarCtrl<ept id=\"p1\">](#ctoolbar__gettoolbarctrl)</ept>.","source":"See the example for [CToolBar::GetToolBarCtrl](#ctoolbar__gettoolbarctrl)."},{"pos":[25598,25617],"content":"CToolBar::SetHeight"},{"pos":[25621,25717],"content":"This member function sets the toolbar's height to the value, in pixels, specified in <ph id=\"ph1\">`cyHeight`</ph>.","source":"This member function sets the toolbar's height to the value, in pixels, specified in `cyHeight`."},{"content":"Parameters","pos":[25772,25782]},{"content":"The height in pixels of the toolbar.","pos":[25800,25836]},{"content":"Remarks","pos":[25846,25853]},{"content":"After calling <bpt id=\"p1\">[</bpt>SetSizes<ept id=\"p1\">](#ctoolbar__setsizes)</ept>, use this member function to override the standard toolbar height.","pos":[25857,25969],"source":"After calling [SetSizes](#ctoolbar__setsizes), use this member function to override the standard toolbar height."},{"content":"If the height is too small, the buttons will be clipped at the bottom.","pos":[25970,26040]},{"content":"If this function is not called, the framework uses the size of the button to determine the toolbar height.","pos":[26047,26153]},{"pos":[26198,26216],"content":"CToolBar::SetSizes"},{"pos":[26220,26325],"content":"Call this member function to set the toolbar's buttons to the size, in pixels, specified in <bpt id=\"p1\">*</bpt>sizeButton<ept id=\"p1\">*</ept>.","source":"Call this member function to set the toolbar's buttons to the size, in pixels, specified in *sizeButton*."},{"content":"Parameters","pos":[26409,26419]},{"content":"sizeButton","pos":[26424,26434]},{"content":"The size in pixels of each button.","pos":[26439,26473]},{"content":"The size in pixels of each image.","pos":[26495,26528]},{"content":"Remarks","pos":[26538,26545]},{"content":"The <ph id=\"ph1\">`sizeImage`</ph> parameter must contain the size, in pixels, of the images in the toolbar's bitmap.","pos":[26549,26647],"source":"The `sizeImage` parameter must contain the size, in pixels, of the images in the toolbar's bitmap."},{"content":"The dimensions in <bpt id=\"p1\">*</bpt>sizeButton<ept id=\"p1\">*</ept> must be sufficient to hold the image plus 7 pixels extra in width and 6 pixels extra in height.","pos":[26648,26774],"source":" The dimensions in *sizeButton* must be sufficient to hold the image plus 7 pixels extra in width and 6 pixels extra in height."},{"content":"This function also sets the toolbar height to fit the buttons.","pos":[26775,26837]},{"pos":[26844,27001],"content":"Call this member function only for toolbars that do not follow <bpt id=\"p1\">*</bpt>Windows Interface Guidelines for Software Design<ept id=\"p1\">*</ept> recommendations for button and image sizes.","source":"Call this member function only for toolbars that do not follow *Windows Interface Guidelines for Software Design* recommendations for button and image sizes."},{"content":"Example","pos":[27011,27018]},{"pos":[27033,27050],"content":"NVC_MFCListView#8"},{"content":"See Also","pos":[27119,27127]},{"content":"MFC Sample CTRLBARS","pos":[27132,27151]},{"content":"MFC Sample DLGCBR32","pos":[27187,27206]},{"content":"MFC Sample DOCKTOOL","pos":[27242,27261]},{"content":"CControlBar Class","pos":[27297,27314]},{"content":"Hierarchy Chart","pos":[27363,27378]},{"content":"CToolBarCtrl Class","pos":[27415,27433]},{"content":"CControlBar Class","pos":[27483,27500]}],"content":"---\ntitle: \"CToolBar Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CToolBar\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Windows toolbar common controls [C++]\"\n  - \"control bars [C++], CToolBar class\"\n  - \"toolbars [C++], CToolBar class\"\n  - \"buttons [C++], MFC toolbars\"\n  - \"bitmaps [C++], button controls\"\n  - \"CToolBar class\"\n  - \"Windows common controls [C++], CToolBar class\"\nms.assetid: e868da26-5e07-4607-9651-e2f863ad9059\ncaps.latest.revision: 26\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CToolBar Class\nControl bars that have a row of bitmapped buttons and optional separators.  \n  \n## Syntax  \n  \n```  \nclass CToolBar : public CControlBar  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CToolBar::CToolBar](#ctoolbar__ctoolbar)|Constructs a `CToolBar` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CToolBar::CommandToIndex](#ctoolbar__commandtoindex)|Returns the index of a button with the given command ID.|  \n|[CToolBar::Create](#ctoolbar__create)|Creates the Windows toolbar and attaches it to the `CToolBar` object.|  \n|[CToolBar::CreateEx](#ctoolbar__createex)|Creates a `CToolBar` object with additional styles for the embedded `CToolBarCtrl` object.|  \n|[CToolBar::GetButtonInfo](#ctoolbar__getbuttoninfo)|Retrieves the ID, style, and image number of a button.|  \n|[CToolBar::GetButtonStyle](#ctoolbar__getbuttonstyle)|Retrieves the style for a button.|  \n|[CToolBar::GetButtonText](#ctoolbar__getbuttontext)|Retrieves the text that will appear on a button.|  \n|[CToolBar::GetItemID](#ctoolbar__getitemid)|Returns the command ID of a button or separator at the given index.|  \n|[CToolBar::GetItemRect](#ctoolbar__getitemrect)|Retrieves the display rectangle for the item at the given index.|  \n|[CToolBar::GetToolBarCtrl](#ctoolbar__gettoolbarctrl)|Allows direct access to the underlying common control.|  \n|[CToolBar::LoadBitmap](#ctoolbar__loadbitmap)|Loads the bitmap containing bitmap-button images.|  \n|[CToolBar::LoadToolBar](#ctoolbar__loadtoolbar)|Loads a toolbar resource created with the resource editor.|  \n|[CToolBar::SetBitmap](#ctoolbar__setbitmap)|Sets a bitmapped image.|  \n|[CToolBar::SetButtonInfo](#ctoolbar__setbuttoninfo)|Sets the ID, style, and image number of a button.|  \n|[CToolBar::SetButtons](#ctoolbar__setbuttons)|Sets button styles and an index of button images within the bitmap.|  \n|[CToolBar::SetButtonStyle](#ctoolbar__setbuttonstyle)|Sets the style for a button.|  \n|[CToolBar::SetButtonText](#ctoolbar__setbuttontext)|Sets the text that will appear on a button.|  \n|[CToolBar::SetHeight](#ctoolbar__setheight)|Sets the height of the toolbar.|  \n|[CToolBar::SetSizes](#ctoolbar__setsizes)|Sets the sizes of buttons and their bitmaps.|  \n  \n## Remarks  \n The buttons can act like pushbuttons, check-box buttons, or radio buttons. `CToolBar` objects are usually embedded members of frame-window objects derived from the class [CFrameWnd](../../mfc/reference/cframewnd-class.md) or [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md).  \n  \n [CToolBar::GetToolBarCtrl](#ctoolbar__gettoolbarctrl), a member function new to MFC 4.0, allows you to take advantage of the Windows common control's support for toolbar customization and additional functionality. `CToolBar` member functions give you most of the functionality of the Windows common controls; however, when you call `GetToolBarCtrl`, you can give your toolbars even more of the characteristics of Windows 95/98 toolbars. When you call `GetToolBarCtrl`, it will return a reference to a `CToolBarCtrl` object. See [CToolBarCtrl](../../mfc/reference/ctoolbarctrl-class.md) for more information about designing toolbars using Windows common controls. For more general information about common controls, see [Common Controls](http://msdn.microsoft.com/library/windows/desktop/bb775493) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n Visual C++ provides you with two methods to create a toolbar. To create a toolbar resource using the Resource Editor, follow these steps:  \n  \n1.  Create a toolbar resource.  \n  \n2.  Construct the `CToolBar` object.  \n  \n3.  Call the [Create](#ctoolbar__create) (or [CreateEx](#ctoolbar__createex)) function to create the Windows toolbar and attach it to the `CToolBar` object.  \n  \n4.  Call [LoadToolBar](#ctoolbar__loadtoolbar) to load the toolbar resource.  \n  \n Otherwise, follow these steps:  \n  \n1.  Construct the `CToolBar` object.  \n  \n2.  Call the [Create](#ctoolbar__create) (or [CreateEx](#ctoolbar__createex)) function to create the Windows toolbar and attach it to the `CToolBar` object.  \n  \n3.  Call [LoadBitmap](#ctoolbar__loadbitmap) to load the bitmap that contains the toolbar button images.  \n  \n4.  Call [SetButtons](#ctoolbar__setbuttons) to set the button style and associate each button with an image in the bitmap.  \n  \n All the button images in the toolbar are taken from one bitmap, which must contain one image for each button. All images must be the same size; the default is 16 pixels wide and 15 pixels high. Images must be side by side in the bitmap.  \n  \n The `SetButtons` function takes a pointer to an array of control IDs and an integer that specifies the number of elements in the array. The function sets each button's ID to the value of the corresponding element of the array and assigns each button an image index, which specifies the position of the button's image in the bitmap. If an array element has the value **ID_SEPARATOR**, no image index is assigned.  \n  \n The order of the images in the bitmap is typically the order in which they are drawn on the screen, but you can use the [SetButtonInfo](#ctoolbar__setbuttoninfo) function to change the relationship between image order and drawing order.  \n  \n All buttons in a toolbar are the same size. The default is 24 x 22 pixels, in accordance with *Windows Interface Guidelines for Software Design*. Any additional space between the image and button dimensions is used to form a border around the image.  \n  \n Each button has one image. The various button states and styles (pressed, up, down, disabled, disabled down, and indeterminate) are generated from that one image. Although bitmaps can be any color, you can achieve the best results with images in black and shades of gray.  \n  \n> [!WARNING]\n> `CToolBar` supports bitmaps with a maximum of 16 colors. When you load an image into a toolbar editor, Visual Studio automatically converts the image to a 16-color bitmap, if necessary, and displays a warning message if the image was converted. If you use an image with more than 16 colors (using an external editor to edit the image), the application might behave unexpectedly.  \n  \n Toolbar buttons imitate pushbuttons by default. However, toolbar buttons can also imitate check-box buttons or radio buttons. Check-box buttons have three states: checked, cleared, and indeterminate. Radio buttons have only two states: checked and cleared.  \n  \n To set an individual button or separator style without pointing to an array, call [GetButtonStyle](#ctoolbar__getbuttonstyle) to retrieve the style, and then call [SetButtonStyle](#ctoolbar__setbuttonstyle) instead of `SetButtons`. `SetButtonStyle` is most useful when you want to change a button's style at run time.  \n  \n To assign text to appear on a button, call [GetButtonText](#ctoolbar__getbuttontext) to retrieve the text to appear on the button, and then call [SetButtonText](#ctoolbar__setbuttontext) to set the text.  \n  \n To create a check-box button, assign it the style **TBBS_CHECKBOX** or use a `CCmdUI` object's `SetCheck` member function in an `ON_UPDATE_COMMAND_UI` handler. Calling `SetCheck` turns a pushbutton into a check-box button. Pass `SetCheck` an argument of 0 for unchecked, 1 for checked, or 2 for indeterminate.  \n  \n To create a radio button, call a [CCmdUI](../../mfc/reference/ccmdui-class.md) object's [SetRadio](../../mfc/reference/ccmdui-class.md#ccmdui__setradio) member function from an `ON_UPDATE_COMMAND_UI` handler. Pass `SetRadio` an argument of 0 for unchecked or nonzero for checked. In order to provide a radio group's mutually exclusive behavior, you must have `ON_UPDATE_COMMAND_UI` handlers for all of the buttons in the group.  \n  \n For more information on using `CToolBar`, see the article [MFC Toolbar Implementation](../../mfc/mfc-toolbar-implementation.md) and [Technical Note 31: Control Bars](../../mfc/tn031-control-bars.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CControlBar](../../mfc/reference/ccontrolbar-class.md)  \n  \n `CToolBar`  \n  \n## Requirements  \n **Header:** afxext.h  \n  \n##  <a name=\"ctoolbar__commandtoindex\"></a>  CToolBar::CommandToIndex  \n This member function returns the index of the first toolbar button, starting at position 0, whose command ID matches `nIDFind`.  \n  \n```  \nint CommandToIndex(UINT nIDFind) const;\n\n \n```  \n  \n### Parameters  \n `nIDFind`  \n Command ID of a toolbar button.  \n  \n### Return Value  \n The index of the button, or –1 if no button has the given command ID.  \n  \n##  <a name=\"ctoolbar__create\"></a>  CToolBar::Create  \n This member function creates a Windows toolbar (a child window) and associates it with the `CToolBar` object.  \n  \n```  \nvirtual BOOL Create(\n    CWnd* pParentWnd,  \n    DWORD dwStyle = WS_CHILD | WS_VISIBLE | CBRS_TOP,  \n    UINT nID = AFX_IDW_TOOLBAR);\n```  \n  \n### Parameters  \n `pParentWnd`  \n Pointer to the window that is the toolbar's parent.  \n  \n `dwStyle`  \n The toolbar style. Additional toolbar styles supported are:  \n  \n- `CBRS_TOP` Control bar is at top of the frame window.  \n  \n- `CBRS_BOTTOM` Control bar is at bottom of the frame window.  \n  \n- `CBRS_NOALIGN` Control bar is not repositioned when the parent is resized.  \n  \n- `CBRS_TOOLTIPS` Control bar displays tool tips.  \n  \n- **CBRS_SIZE_DYNAMIC** Control bar is dynamic.  \n  \n- **CBRS_SIZE_FIXED** Control bar is fixed.  \n  \n- **CBRS_FLOATING** Control bar is floating.  \n  \n- `CBRS_FLYBY` Status bar displays information about the button.  \n  \n- **CBRS_HIDE_INPLACE** Control bar is not displayed to the user.  \n  \n `nID`  \n The toolbar's child-window ID.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n It also sets the toolbar height to a default value.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#179](../../mfc/codesnippet/cpp/ctoolbar-class_1.cpp)]  \n  \n##  <a name=\"ctoolbar__createex\"></a>  CToolBar::CreateEx  \n Call this function to create a Windows toolbar (a child window) and associate it with the `CToolBar` object.  \n  \n```  \nvirtual BOOL CreateEx(\n    CWnd* pParentWnd,  \n    DWORD dwCtrlStyle = TBSTYLE_FLAT,  \n    DWORD dwStyle = WS_CHILD | WS_VISIBLE | CBRS_ALIGN_TOP,  \n    CRect rcBorders = CRect(\n    0, \n    0, \n    0, \n    0), \n    UINT nID = AFX_IDW_TOOLBAR);\n```  \n  \n### Parameters  \n `pParentWnd`  \n Pointer to the window that is the toolbar's parent.  \n  \n `dwCtrlStyle`  \n Additional styles for the creation of the embedded [CToolBarCtrl](../../mfc/reference/ctoolbarctrl-class.md) object. By default, this value is set to **TBSTYLE_FLAT**. For a complete list of toolbar styles, see `dwStyle`.  \n  \n `dwStyle`  \n The toolbar style. See [Toolbar Control and Button Styles](http://msdn.microsoft.com/library/windows/desktop/bb760439) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a list of appropriate styles.  \n  \n *rcBorders*  \n A [CRect](../../atl-mfc-shared/reference/crect-class.md) object that defines the widths of the toolbar window borders. These borders are set to 0,0,0,0 by default, thereby resulting in a toolbar window with no borders.  \n  \n `nID`  \n The toolbar's child-window ID.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n It also sets the toolbar height to a default value.  \n  \n Use `CreateEx`, instead of [Create](#ctoolbar__create), when certain styles need to be present during the creation of the embedded tool bar control. For example, set `dwCtrlStyle` to **TBSTYLE_FLAT &#124; TBSTYLE_TRANSPARENT** to create a toolbar that resembles the Internet Explorer 4 toolbars.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#180](../../mfc/codesnippet/cpp/ctoolbar-class_2.cpp)]  \n  \n##  <a name=\"ctoolbar__ctoolbar\"></a>  CToolBar::CToolBar  \n This member function constructs a `CToolBar` object and sets the default sizes.  \n  \n```  \nCToolBar();\n```  \n  \n### Remarks  \n Call the [Create](#ctoolbar__create) member function to create the toolbar window.  \n  \n##  <a name=\"ctoolbar__getbuttoninfo\"></a>  CToolBar::GetButtonInfo  \n This member function retrieves the control ID, style, and image index of the toolbar button or separator at the location specified by *nIndex.*  \n  \n```  \nvoid GetButtonInfo(\n    int nIndex,  \n    UINT& nID,  \n    UINT& nStyle,  \n    int& iImage) const;\n\n \n```  \n  \n### Parameters  \n `nIndex`  \n Index of the toolbar button or separator whose information is to be retrieved.  \n  \n `nID`  \n Reference to a **UINT** that is set to the command ID of the button.  \n  \n `nStyle`  \n Reference to a **UINT** that is set to the style of the button.  \n  \n `iImage`  \n Reference to an integer that is set to the index of the button's image within the bitmap.  \n  \n### Remarks  \n Those values are assigned to the variables referenced by `nID`, `nStyle`, and `iImage`. The image index is the position of the image within the bitmap that contains images for all the toolbar buttons. The first image is at position 0.  \n  \n If `nIndex` specifies a separator, `iImage` is set to the separator width in pixels.  \n  \n##  <a name=\"ctoolbar__getbuttonstyle\"></a>  CToolBar::GetButtonStyle  \n Call this member function to retrieve the style of a button or separator on the toolbar.  \n  \n```  \nUINT GetButtonStyle(int nIndex) const;\n\n \n```  \n  \n### Parameters  \n `nIndex`  \n The index of the toolbar button or separator style to be retrieved.  \n  \n### Return Value  \n The style of the button or separator specified by `nIndex`.  \n  \n### Remarks  \n A button's style determines how the button appears and how it responds to user input. See [SetButtonStyle](#ctoolbar__setbuttonstyle) for examples of button styles.  \n  \n##  <a name=\"ctoolbar__getbuttontext\"></a>  CToolBar::GetButtonText  \n Call this member function to retrieve the text that appears on a button.  \n  \n```  \nCString GetButtonText(\n    int nIndex) const;\n\n \n \nvoid GetButtonText(\n    int nIndex,  \n    CString& rString) const;\n\n \n```  \n  \n### Parameters  \n `nIndex`  \n Index of the text to be retrieved.  \n  \n `rString`  \n A reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object that will contain the text to be retrieved.  \n  \n### Return Value  \n A `CString` object containing the button text.  \n  \n### Remarks  \n The second form of this member function fills a `CString` object with the string text.  \n  \n##  <a name=\"ctoolbar__getitemid\"></a>  CToolBar::GetItemID  \n This member function returns the command ID of the button or separator specified by `nIndex`.  \n  \n```  \nUINT GetItemID(int nIndex) const;\n\n \n```  \n  \n### Parameters  \n `nIndex`  \n Index of the item whose ID is to be retrieved.  \n  \n### Return Value  \n The command ID of the button or separator specified by `nIndex`.  \n  \n### Remarks  \n Separators return **ID_SEPARATOR**.  \n  \n##  <a name=\"ctoolbar__getitemrect\"></a>  CToolBar::GetItemRect  \n This member function fills the `RECT` structure whose address is contained in `lpRect` with the coordinates of the button or separator specified by `nIndex`.  \n  \n```  \nvirtual void GetItemRect(\n    int nIndex,  \n    LPRECT lpRect) const;\n\n \n```  \n  \n### Parameters  \n `nIndex`  \n Index of the item (button or separator) whose rectangle coordinates are to be retrieved.  \n  \n `lpRect`  \n Address of the [RECT](../../mfc/reference/rect-structure1.md) structure that will contain the item's coordinates.  \n  \n### Remarks  \n Coordinates are in pixels relative to the upper-left corner of the toolbar.  \n  \n Use `GetItemRect` to get the coordinates of a separator you want to replace with a combo box or other control.  \n  \n### Example  \n  See the example for [CToolBar::SetSizes](#ctoolbar__setsizes).  \n  \n##  <a name=\"ctoolbar__gettoolbarctrl\"></a>  CToolBar::GetToolBarCtrl  \n This member function allows direct access to the underlying common control.  \n  \n```  \nCToolBarCtrl& GetToolBarCtrl() const;\n\n \n```  \n  \n### Return Value  \n A reference to a `CToolBarCtrl` object.  \n  \n### Remarks  \n Use `GetToolBarCtrl` to take advantage of the functionality of the Windows toolbar common control, and to take advantage of the support [CToolBarCtrl](../../mfc/reference/ctoolbarctrl-class.md) provides for toolbar customization.  \n  \n For more information about using common controls, see the article [Controls](../../mfc/controls-mfc.md) and [Common Controls](http://msdn.microsoft.com/library/windows/desktop/bb775493) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n [!code-cpp[NVC_MFCDocViewSDI#15](../../mfc/codesnippet/cpp/ctoolbar-class_3.cpp)]  \n  \n##  <a name=\"ctoolbar__loadbitmap\"></a>  CToolBar::LoadBitmap  \n Call this member function to load the bitmap specified by `lpszResourceName` or `nIDResource`.  \n  \n```  \nBOOL LoadBitmap(LPCTSTR lpszResourceName);\n\n \nBOOL LoadBitmap(UINT nIDResource);\n```  \n  \n### Parameters  \n `lpszResourceName`  \n Pointer to the resource name of the bitmap to be loaded.  \n  \n `nIDResource`  \n Resource ID of the bitmap to be loaded.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n The bitmap should contain one image for each toolbar button. If the images are not of the standard size (16 pixels wide and 15 pixels high), call [SetSizes](#ctoolbar__setsizes) to set the button sizes and their images.  \n  \n> [!WARNING]\n> `CToolBar` supports bitmaps with a maximum of 16 colors. When you load an image into a toolbar editor, Visual Studio automatically converts the image to a 16-color bitmap, if necessary, and displays a warning message if the image was converted. If you use an image with more than 16 colors (using an external editor to edit the image), the application might behave unexpectedly.  \n  \n##  <a name=\"ctoolbar__loadtoolbar\"></a>  CToolBar::LoadToolBar  \n Call this member function to load the toolbar specified by `lpszResourceName` or `nIDResource`.  \n  \n```  \nBOOL LoadToolBar(LPCTSTR lpszResourceName);\n\n \nBOOL LoadToolBar(UINT nIDResource);\n```  \n  \n### Parameters  \n `lpszResourceName`  \n Pointer to the resource name of the toolbar to be loaded.  \n  \n `nIDResource`  \n Resource ID of the toolbar to be loaded.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n See [toolbar editor](../../mfc/toolbar-editor.md) in for more information about creating a toolbar resource.  \n  \n### Example  \n  See the example for [CToolBar::CreateEx](#ctoolbar__createex).  \n  \n##  <a name=\"ctoolbar__setbitmap\"></a>  CToolBar::SetBitmap  \n Call this member function to set the bitmap image for the toolbar.  \n  \n```  \nBOOL SetBitmap(HBITMAP hbmImageWell);\n```  \n  \n### Parameters  \n *hbmImageWell*  \n Handle of a bitmap image that is associated with a toolbar.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n For example, call `SetBitmap` to change the bitmapped image after the user takes an action on a document that changes the action of a button.  \n  \n##  <a name=\"ctoolbar__setbuttoninfo\"></a>  CToolBar::SetButtonInfo  \n Call this member function to set the button's command ID, style, and image number.  \n  \n```  \nvoid SetButtonInfo(\n    int nIndex,  \n    UINT nID,  \n    UINT nStyle,  \n    int iImage);\n```  \n  \n### Parameters  \n `nIndex`  \n Zero-based index of the button or separator for which information is to be set.  \n  \n `nID`  \n The value to which the button's command ID is set.  \n  \n `nStyle`  \n The new button style. The following button styles are supported:  \n  \n- **TBBS_BUTTON** Standard pushbutton (default)  \n  \n- **TBBS_SEPARATOR** Separator  \n  \n- **TBBS_CHECKBOX** Auto check-box button  \n  \n- **TBBS_GROUP** Marks the start of a group of buttons  \n  \n- **TBBS_CHECKGROUP** Marks the start of a group of check-box buttons  \n  \n- **TBBS_DROPDOWN** Creates a drop-down list button.  \n  \n- **TBBS_AUTOSIZE** The button's width will be calculated based on the text of the button, not on the size of the image.  \n  \n- **TBBS_NOPREFIX** The button text will not have an accelerator prefix associated with it.  \n  \n `iImage`  \n New index for the button's image within the bitmap.  \n  \n### Remarks  \n For separators, which have the style **TBBS_SEPARATOR**, this function sets the separator's width in pixels to the value stored in `iImage`.  \n  \n> [!NOTE]\n>  You can also set button states using the `nStyle` parameter; however, because button states are controlled by the [ON_UPDATE_COMMAND_UI](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4) handler, any state you set using `SetButtonInfo` will be lost during the next idle processing. See [How to Update User-Interface Objects](../../mfc/how-to-update-user-interface-objects.md) and [TN031: Control Bars](../../mfc/tn031-control-bars.md) for more information.  \n  \n For information on bitmap images and buttons, see the [CToolBar](../../mfc/reference/ctoolbar-class.md) Overview and [CToolBar::LoadBitmap](#ctoolbar__loadbitmap).  \n  \n##  <a name=\"ctoolbar__setbuttons\"></a>  CToolBar::SetButtons  \n This member function sets each toolbar button's command ID to the value specified by the corresponding element of the array `lpIDArray`.  \n  \n```  \nBOOL SetButtons(\n    const UINT* lpIDArray,  \n    int nIDCount);\n```  \n  \n### Parameters  \n `lpIDArray`  \n Pointer to an array of command Ids. It can be **NULL** to allocate empty buttons.  \n  \n `nIDCount`  \n Number of elements in the array pointed to by `lpIDArray`.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n If an element of the array has the value **ID_SEPARATOR**, a separator is created in the corresponding position of the toolbar. This function also sets each button's style to **TBBS_BUTTON** and each separator's style to **TBBS_SEPARATOR**, and assigns an image index to each button. The image index specifies the position of the button's image within the bitmap.  \n  \n You do not need to account for separators in the bitmap because this function does not assign image indexes for separators. If your toolbar has buttons at positions 0, 1, and 3 and a separator at position 2, the images at positions 0, 1, and 2 in your bitmap are assigned to the buttons at positions 0, 1, and 3, respectively.  \n  \n If `lpIDArray` is **NULL**, this function allocates space for the number of items specified by `nIDCount`. Use [SetButtonInfo](#ctoolbar__setbuttoninfo) to set each item's attributes.  \n  \n##  <a name=\"ctoolbar__setbuttonstyle\"></a>  CToolBar::SetButtonStyle  \n Call this member function to set the style of a button or separator, or to group buttons.  \n  \n```  \nvoid SetButtonStyle(\n    int nIndex,  \n    UINT nStyle);\n```  \n  \n### Parameters  \n `nIndex`  \n Index of the button or separator whose information is to be set.  \n  \n `nStyle`  \n The button style. The following button styles are supported:  \n  \n- **TBBS_BUTTON** Standard pushbutton (default)  \n  \n- **TBBS_SEPARATOR** Separator  \n  \n- **TBBS_CHECKBOX** Auto check-box button  \n  \n- **TBBS_GROUP** Marks the start of a group of buttons  \n  \n- **TBBS_CHECKGROUP** Marks the start of a group of check-box buttons  \n  \n- **TBBS_DROPDOWN** Creates a drop-down list button  \n  \n- **TBBS_AUTOSIZE** The button's width will be calculated based on the text of the button, not on the size of the image  \n  \n- **TBBS_NOPREFIX** The button text will not have an accelerator prefix associated with it  \n  \n### Remarks  \n A button's style determines how the button appears and how it responds to user input.  \n  \n Before calling `SetButtonStyle`, call the [GetButtonStyle](#ctoolbar__getbuttonstyle) member function to retrieve the button or separator style.  \n  \n> [!NOTE]\n>  You can also set button states using the `nStyle` parameter; however, because button states are controlled by the [ON_UPDATE_COMMAND_UI](http://msdn.microsoft.com/library/c4de3c21-2d2e-4b89-a4ce-d0c0e2d9edc4) handler, any state you set using `SetButtonStyle` will be lost during the next idle processing. See [How to Update User-Interface Objects](../../mfc/how-to-update-user-interface-objects.md) and [TN031: Control Bars](../../mfc/tn031-control-bars.md) for more information.  \n  \n##  <a name=\"ctoolbar__setbuttontext\"></a>  CToolBar::SetButtonText  \n Call this function to set the text on a button.  \n  \n```  \nBOOL SetButtonText(\n    int nIndex,  \n    LPCTSTR lpszText);\n```  \n  \n### Parameters  \n `nIndex`  \n Index of the button whose text is to be set.  \n  \n `lpszText`  \n Points to the text to be set on a button.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Example  \n  See the example for [CToolBar::GetToolBarCtrl](#ctoolbar__gettoolbarctrl).  \n  \n##  <a name=\"ctoolbar__setheight\"></a>  CToolBar::SetHeight  \n This member function sets the toolbar's height to the value, in pixels, specified in `cyHeight`.  \n  \n```  \nvoid SetHeight(int cyHeight);\n```  \n  \n### Parameters  \n `cyHeight`  \n The height in pixels of the toolbar.  \n  \n### Remarks  \n After calling [SetSizes](#ctoolbar__setsizes), use this member function to override the standard toolbar height. If the height is too small, the buttons will be clipped at the bottom.  \n  \n If this function is not called, the framework uses the size of the button to determine the toolbar height.  \n  \n##  <a name=\"ctoolbar__setsizes\"></a>  CToolBar::SetSizes  \n Call this member function to set the toolbar's buttons to the size, in pixels, specified in *sizeButton*.  \n  \n```  \nvoid SetSizes(\n    SIZE sizeButton,  \n    SIZE sizeImage);\n```  \n  \n### Parameters  \n *sizeButton*  \n The size in pixels of each button.  \n  \n `sizeImage`  \n The size in pixels of each image.  \n  \n### Remarks  \n The `sizeImage` parameter must contain the size, in pixels, of the images in the toolbar's bitmap. The dimensions in *sizeButton* must be sufficient to hold the image plus 7 pixels extra in width and 6 pixels extra in height. This function also sets the toolbar height to fit the buttons.  \n  \n Call this member function only for toolbars that do not follow *Windows Interface Guidelines for Software Design* recommendations for button and image sizes.  \n  \n### Example  \n [!code-cpp[NVC_MFCListView#8](../../atl/reference/codesnippet/cpp/ctoolbar-class_4.cpp)]  \n  \n## See Also  \n [MFC Sample CTRLBARS](../../visual-cpp-samples.md)   \n [MFC Sample DLGCBR32](../../visual-cpp-samples.md)   \n [MFC Sample DOCKTOOL](../../visual-cpp-samples.md)   \n [CControlBar Class](../../mfc/reference/ccontrolbar-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CToolBarCtrl Class](../../mfc/reference/ctoolbarctrl-class.md)   \n [CControlBar Class](../../mfc/reference/ccontrolbar-class.md)\n"}