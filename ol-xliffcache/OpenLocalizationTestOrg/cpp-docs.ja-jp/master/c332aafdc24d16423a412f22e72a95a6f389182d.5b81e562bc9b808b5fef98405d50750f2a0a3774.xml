{"nodes":[{"pos":[12,50],"content":"IDataObjectImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IDataObjectImpl Class | Microsoft Docs","pos":[0,38]}]},{"pos":[732,753],"content":"IDataObjectImpl Class","linkify":"IDataObjectImpl Class","nodes":[{"content":"IDataObjectImpl Class","pos":[0,21]}]},{"content":"This class provides methods for supporting Uniform Data Transfer and managing connections.","pos":[754,844]},{"pos":[852,1002],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,148],"source":" This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"pos":[1011,1017],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1082,1092],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Your class, derived from <ph id=\"ph1\">`IDataObjectImpl`</ph>.","pos":[1103,1146],"source":" Your class, derived from `IDataObjectImpl`."},{"pos":[1155,1162],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1172,1186],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1193,1197]},{"content":"Description","pos":[1198,1209]},{"pos":[1247,1300],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::DAdvise<ept id=\"p1\">](#idataobjectimpl__dadvise)</ept>","source":"[IDataObjectImpl::DAdvise](#idataobjectimpl__dadvise)"},{"content":"Establishes a connection between the data object and an advise sink.","pos":[1301,1369]},{"content":"This enables the advise sink to receive notifications of changes in the object.","pos":[1370,1449]},{"pos":[1454,1511],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::DUnadvise<ept id=\"p1\">](#idataobjectimpl__dunadvise)</ept>","source":"[IDataObjectImpl::DUnadvise](#idataobjectimpl__dunadvise)"},{"pos":[1512,1577],"content":"Terminates a connection previously established through <ph id=\"ph1\">`DAdvise`</ph>.","source":"Terminates a connection previously established through `DAdvise`."},{"pos":[1582,1643],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::EnumDAdvise<ept id=\"p1\">](#idataobjectimpl__enumdadvise)</ept>","source":"[IDataObjectImpl::EnumDAdvise](#idataobjectimpl__enumdadvise)"},{"content":"Creates an enumerator to iterate through the current advisory connections.","pos":[1644,1718]},{"pos":[1723,1788],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::EnumFormatEtc<ept id=\"p1\">](#idataobjectimpl__enumformatetc)</ept>","source":"[IDataObjectImpl::EnumFormatEtc](#idataobjectimpl__enumformatetc)"},{"content":"Creates an enumerator to iterate through the <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> structures supported by the data object.","pos":[1789,1888],"source":"Creates an enumerator to iterate through the **FORMATETC** structures supported by the data object."},{"content":"The ATL implementation returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","pos":[1889,1934],"source":" The ATL implementation returns **E_NOTIMPL**."},{"pos":[1939,2006],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::FireDataChange<ept id=\"p1\">](#idataobjectimpl__firedatachange)</ept>","source":"[IDataObjectImpl::FireDataChange](#idataobjectimpl__firedatachange)"},{"content":"Sends a change notification back to each advise sink.","pos":[2007,2060]},{"pos":[2065,2146],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::GetCanonicalFormatEtc<ept id=\"p1\">](#idataobjectimpl__getcanonicalformatetc)</ept>","source":"[IDataObjectImpl::GetCanonicalFormatEtc](#idataobjectimpl__getcanonicalformatetc)"},{"content":"Retrieves a logically equivalent <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> structure to one that is more complex.","pos":[2147,2232],"source":"Retrieves a logically equivalent **FORMATETC** structure to one that is more complex."},{"content":"The ATL implementation returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","pos":[2233,2278],"source":" The ATL implementation returns **E_NOTIMPL**."},{"pos":[2283,2336],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::GetData<ept id=\"p1\">](#idataobjectimpl__getdata)</ept>","source":"[IDataObjectImpl::GetData](#idataobjectimpl__getdata)"},{"content":"Transfers data from the data object to the client.","pos":[2337,2387]},{"content":"The data is described in a <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> structure and is transferred through a <bpt id=\"p2\">**</bpt>STGMEDIUM<ept id=\"p2\">**</ept> structure.","pos":[2388,2492],"source":" The data is described in a **FORMATETC** structure and is transferred through a **STGMEDIUM** structure."},{"pos":[2497,2558],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::GetDataHere<ept id=\"p1\">](#idataobjectimpl__getdatahere)</ept>","source":"[IDataObjectImpl::GetDataHere](#idataobjectimpl__getdatahere)"},{"content":"Similar to <ph id=\"ph1\">`GetData`</ph>, except the client must allocate the <bpt id=\"p1\">**</bpt>STGMEDIUM<ept id=\"p1\">**</ept> structure.","pos":[2559,2641],"source":"Similar to `GetData`, except the client must allocate the **STGMEDIUM** structure."},{"content":"The ATL implementation returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","pos":[2642,2687],"source":" The ATL implementation returns **E_NOTIMPL**."},{"pos":[2692,2755],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::QueryGetData<ept id=\"p1\">](#idataobjectimpl__querygetdata)</ept>","source":"[IDataObjectImpl::QueryGetData](#idataobjectimpl__querygetdata)"},{"content":"Determines whether the data object supports a particular <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> structure for transferring data.","pos":[2756,2859],"source":"Determines whether the data object supports a particular **FORMATETC** structure for transferring data."},{"content":"The ATL implementation returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","pos":[2860,2905],"source":" The ATL implementation returns **E_NOTIMPL**."},{"pos":[2910,2963],"content":"<bpt id=\"p1\">[</bpt>IDataObjectImpl::SetData<ept id=\"p1\">](#idataobjectimpl__setdata)</ept>","source":"[IDataObjectImpl::SetData](#idataobjectimpl__setdata)"},{"content":"Transfers data from the client to the data object.","pos":[2964,3014]},{"content":"The ATL implementation returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","pos":[3015,3060],"source":" The ATL implementation returns **E_NOTIMPL**."},{"pos":[3070,3077],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <bpt id=\"p1\">[</bpt>IDataObject<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms688421)</ept> interface provides methods to support Uniform Data Transfer.","pos":[3081,3219],"source":"The [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) interface provides methods to support Uniform Data Transfer."},{"content":"<ph id=\"ph1\">`IDataObject`</ph> uses the standard format structures <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> and <bpt id=\"p2\">[</bpt>STGMEDIUM<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms683812)</ept> to retrieve and store data.","pos":[3220,3445],"source":"`IDataObject` uses the standard format structures [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) and [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) to retrieve and store data."},{"content":"<ph id=\"ph1\">`IDataObject`</ph> also manages connections to advise sinks to handle data change notifications.","pos":[3452,3543],"source":"`IDataObject` also manages connections to advise sinks to handle data change notifications."},{"content":"In order for the client to receive data change notifications from the data object, the client must implement the <bpt id=\"p1\">[</bpt>IAdviseSink<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms692513)</ept> interface on an object called an advise sink.","pos":[3544,3776],"source":" In order for the client to receive data change notifications from the data object, the client must implement the [IAdviseSink](http://msdn.microsoft.com/library/windows/desktop/ms692513) interface on an object called an advise sink."},{"content":"When the client then calls <bpt id=\"p1\">**</bpt>IDataObject::DAdvise<ept id=\"p1\">**</ept>, a connection is established between the data object and the advise sink.","pos":[3777,3902],"source":" When the client then calls **IDataObject::DAdvise**, a connection is established between the data object and the advise sink."},{"pos":[3909,4070],"content":"Class <ph id=\"ph1\">`IDataObjectImpl`</ph> provides a default implementation of <ph id=\"ph2\">`IDataObject`</ph> and implements <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> by sending information to the dump device in debug builds.","source":"Class `IDataObjectImpl` provides a default implementation of `IDataObject` and implements **IUnknown** by sending information to the dump device in debug builds."},{"pos":[4077,4238],"content":"<bpt id=\"p1\">**</bpt>Related Articles<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>ATL Tutorial<ept id=\"p2\">](../../atl/active-template-library-atl-tutorial.md)</ept>, <bpt id=\"p3\">[</bpt>Creating an ATL Project<ept id=\"p3\">](../../atl/reference/creating-an-atl-project.md)</ept>","source":"**Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)"},{"pos":[4247,4268],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[4318,4330],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[4334,4354],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlctl.h","source":"**Header:** atlctl.h"},{"pos":[4364,4429],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__dadvise\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::DAdvise","linkify":"<a name=\"idataobjectimpl__dadvise\"></a>  IDataObjectImpl::DAdvise","source":"<a name=\"idataobjectimpl__dadvise\"></a>  IDataObjectImpl::DAdvise"},{"content":"Establishes a connection between the data object and an advise sink.","pos":[4433,4501]},{"pos":[4638,4645],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This enables the advise sink to receive notifications of changes in the object.","pos":[4649,4728]},{"pos":[4735,4810],"content":"To terminate the connection, call <bpt id=\"p1\">[</bpt>DUnadvise<ept id=\"p1\">](#idataobjectimpl__dunadvise)</ept>.","source":"To terminate the connection, call [DUnadvise](#idataobjectimpl__dunadvise)."},{"pos":[4817,4963],"content":"See <bpt id=\"p1\">[</bpt>IDataObject::DAdvise<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms692579)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDataObject::DAdvise](http://msdn.microsoft.com/library/windows/desktop/ms692579) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4973,5042],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__dunadvise\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::DUnadvise","linkify":"<a name=\"idataobjectimpl__dunadvise\"></a>  IDataObjectImpl::DUnadvise","source":"<a name=\"idataobjectimpl__dunadvise\"></a>  IDataObjectImpl::DUnadvise"},{"pos":[5046,5138],"content":"Terminates a connection previously established through <bpt id=\"p1\">[</bpt>DAdvise<ept id=\"p1\">](#idataobjectimpl__dadvise)</ept>.","source":"Terminates a connection previously established through [DAdvise](#idataobjectimpl__dadvise)."},{"pos":[5200,5207],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5211,5359],"content":"See <bpt id=\"p1\">[</bpt>IDataObject::DUnadvise<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms692448)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDataObject::DUnadvise](http://msdn.microsoft.com/library/windows/desktop/ms692448) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[5369,5442],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__enumdadvise\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::EnumDAdvise","linkify":"<a name=\"idataobjectimpl__enumdadvise\"></a>  IDataObjectImpl::EnumDAdvise","source":"<a name=\"idataobjectimpl__enumdadvise\"></a>  IDataObjectImpl::EnumDAdvise"},{"content":"Creates an enumerator to iterate through the current advisory connections.","pos":[5446,5520]},{"pos":[5657,5664],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5668,5818],"content":"See <bpt id=\"p1\">[</bpt>IDataObject::EnumDAdvise<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680127)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDataObject::EnumDAdvise](http://msdn.microsoft.com/library/windows/desktop/ms680127) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[5828,5905],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__enumformatetc\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::EnumFormatEtc","linkify":"<a name=\"idataobjectimpl__enumformatetc\"></a>  IDataObjectImpl::EnumFormatEtc","source":"<a name=\"idataobjectimpl__enumformatetc\"></a>  IDataObjectImpl::EnumFormatEtc"},{"pos":[5909,6008],"content":"Creates an enumerator to iterate through the <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> structures supported by the data object.","source":"Creates an enumerator to iterate through the **FORMATETC** structures supported by the data object."},{"pos":[6111,6118],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6122,6274],"content":"See <bpt id=\"p1\">[</bpt>IDataObject::EnumFormatEtc<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683979)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDataObject::EnumFormatEtc](http://msdn.microsoft.com/library/windows/desktop/ms683979) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6284,6296],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[6300,6322],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[6332,6411],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__firedatachange\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::FireDataChange","linkify":"<a name=\"idataobjectimpl__firedatachange\"></a>  IDataObjectImpl::FireDataChange","source":"<a name=\"idataobjectimpl__firedatachange\"></a>  IDataObjectImpl::FireDataChange"},{"content":"Sends a change notification back to each advise sink that is currently being managed.","pos":[6415,6500]},{"pos":[6549,6561],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[6565,6592],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"pos":[6602,6695],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__getcanonicalformatetc\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::GetCanonicalFormatEtc","linkify":"<a name=\"idataobjectimpl__getcanonicalformatetc\"></a>  IDataObjectImpl::GetCanonicalFormatEtc","source":"<a name=\"idataobjectimpl__getcanonicalformatetc\"></a>  IDataObjectImpl::GetCanonicalFormatEtc"},{"pos":[6699,6784],"content":"Retrieves a logically equivalent <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> structure to one that is more complex.","source":"Retrieves a logically equivalent **FORMATETC** structure to one that is more complex."},{"pos":[6898,6910],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[6914,6936],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[6946,6953],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6957,7117],"content":"See <bpt id=\"p1\">[</bpt>IDataObject::GetCanonicalFormatEtc<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680685)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDataObject::GetCanonicalFormatEtc](http://msdn.microsoft.com/library/windows/desktop/ms680685) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[7127,7192],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__getdata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::GetData","linkify":"<a name=\"idataobjectimpl__getdata\"></a>  IDataObjectImpl::GetData","source":"<a name=\"idataobjectimpl__getdata\"></a>  IDataObjectImpl::GetData"},{"content":"Transfers data from the data object to the client.","pos":[7196,7246]},{"pos":[7340,7347],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7351,7435],"content":"The <bpt id=\"p1\">*</bpt>pformatetcIn<ept id=\"p1\">*</ept> parameter must specify a storage medium type of <bpt id=\"p2\">**</bpt>TYMED_MFPICT<ept id=\"p2\">**</ept>.","source":"The *pformatetcIn* parameter must specify a storage medium type of **TYMED_MFPICT**."},{"pos":[7442,7588],"content":"See <bpt id=\"p1\">[</bpt>IDataObject::GetData<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms678431)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[7598,7671],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__getdatahere\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::GetDataHere","linkify":"<a name=\"idataobjectimpl__getdatahere\"></a>  IDataObjectImpl::GetDataHere","source":"<a name=\"idataobjectimpl__getdatahere\"></a>  IDataObjectImpl::GetDataHere"},{"pos":[7675,7757],"content":"Similar to <ph id=\"ph1\">`GetData`</ph>, except the client must allocate the <bpt id=\"p1\">**</bpt>STGMEDIUM<ept id=\"p1\">**</ept> structure.","source":"Similar to `GetData`, except the client must allocate the **STGMEDIUM** structure."},{"pos":[7853,7865],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[7869,7891],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[7901,7908],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7912,8062],"content":"See <bpt id=\"p1\">[</bpt>IDataObject::GetDataHere<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms687266)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDataObject::GetDataHere](http://msdn.microsoft.com/library/windows/desktop/ms687266) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8072,8147],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__querygetdata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::QueryGetData","linkify":"<a name=\"idataobjectimpl__querygetdata\"></a>  IDataObjectImpl::QueryGetData","source":"<a name=\"idataobjectimpl__querygetdata\"></a>  IDataObjectImpl::QueryGetData"},{"pos":[8151,8254],"content":"Determines whether the data object supports a particular <bpt id=\"p1\">**</bpt>FORMATETC<ept id=\"p1\">**</ept> structure for transferring data.","source":"Determines whether the data object supports a particular **FORMATETC** structure for transferring data."},{"pos":[8322,8334],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[8338,8360],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[8370,8377],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[8381,8532],"content":"See <bpt id=\"p1\">[</bpt>IDataObject::QueryGetData<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680637)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDataObject::QueryGetData](http://msdn.microsoft.com/library/windows/desktop/ms680637) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8542,8607],"content":"<bpt id=\"p1\">&lt;a name=\"idataobjectimpl__setdata\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IDataObjectImpl::SetData","linkify":"<a name=\"idataobjectimpl__setdata\"></a>  IDataObjectImpl::SetData","source":"<a name=\"idataobjectimpl__setdata\"></a>  IDataObjectImpl::SetData"},{"content":"Transfers data from the client to the data object.","pos":[8611,8661]},{"pos":[8772,8784],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[8788,8810],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"pos":[8820,8827],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[8831,8977],"content":"See <bpt id=\"p1\">[</bpt>IDataObject::SetData<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms686626)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IDataObject::SetData](http://msdn.microsoft.com/library/windows/desktop/ms686626) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8986,8994],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[8998,9047],"content":"<bpt id=\"p1\">[</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","source":"[Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"IDataObjectImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"IDataObjectImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"data transfer [C++]\"\n  - \"data transfer [C++], Uniform Data Transfer\"\n  - \"IDataObjectImpl class\"\n  - \"IDataObject, ATL implementation\"\nms.assetid: b680f0f7-7795-40a1-a0f6-f48768201c89\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IDataObjectImpl Class\nThis class provides methods for supporting Uniform Data Transfer and managing connections.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n## Syntax  \n  \n```\ntemplate<class T>  class IDataObjectImpl\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `IDataObjectImpl`.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IDataObjectImpl::DAdvise](#idataobjectimpl__dadvise)|Establishes a connection between the data object and an advise sink. This enables the advise sink to receive notifications of changes in the object.|  \n|[IDataObjectImpl::DUnadvise](#idataobjectimpl__dunadvise)|Terminates a connection previously established through `DAdvise`.|  \n|[IDataObjectImpl::EnumDAdvise](#idataobjectimpl__enumdadvise)|Creates an enumerator to iterate through the current advisory connections.|  \n|[IDataObjectImpl::EnumFormatEtc](#idataobjectimpl__enumformatetc)|Creates an enumerator to iterate through the **FORMATETC** structures supported by the data object. The ATL implementation returns **E_NOTIMPL**.|  \n|[IDataObjectImpl::FireDataChange](#idataobjectimpl__firedatachange)|Sends a change notification back to each advise sink.|  \n|[IDataObjectImpl::GetCanonicalFormatEtc](#idataobjectimpl__getcanonicalformatetc)|Retrieves a logically equivalent **FORMATETC** structure to one that is more complex. The ATL implementation returns **E_NOTIMPL**.|  \n|[IDataObjectImpl::GetData](#idataobjectimpl__getdata)|Transfers data from the data object to the client. The data is described in a **FORMATETC** structure and is transferred through a **STGMEDIUM** structure.|  \n|[IDataObjectImpl::GetDataHere](#idataobjectimpl__getdatahere)|Similar to `GetData`, except the client must allocate the **STGMEDIUM** structure. The ATL implementation returns **E_NOTIMPL**.|  \n|[IDataObjectImpl::QueryGetData](#idataobjectimpl__querygetdata)|Determines whether the data object supports a particular **FORMATETC** structure for transferring data. The ATL implementation returns **E_NOTIMPL**.|  \n|[IDataObjectImpl::SetData](#idataobjectimpl__setdata)|Transfers data from the client to the data object. The ATL implementation returns **E_NOTIMPL**.|  \n  \n## Remarks  \n The [IDataObject](http://msdn.microsoft.com/library/windows/desktop/ms688421) interface provides methods to support Uniform Data Transfer. `IDataObject` uses the standard format structures [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) and [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) to retrieve and store data.  \n  \n `IDataObject` also manages connections to advise sinks to handle data change notifications. In order for the client to receive data change notifications from the data object, the client must implement the [IAdviseSink](http://msdn.microsoft.com/library/windows/desktop/ms692513) interface on an object called an advise sink. When the client then calls **IDataObject::DAdvise**, a connection is established between the data object and the advise sink.  \n  \n Class `IDataObjectImpl` provides a default implementation of `IDataObject` and implements **IUnknown** by sending information to the dump device in debug builds.  \n  \n **Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)  \n  \n## Inheritance Hierarchy  \n `IDataObject`  \n  \n `IDataObjectImpl`  \n  \n## Requirements  \n **Header:** atlctl.h  \n  \n##  <a name=\"idataobjectimpl__dadvise\"></a>  IDataObjectImpl::DAdvise  \n Establishes a connection between the data object and an advise sink.  \n  \n```\nHRESULT DAdvise(\n    FORMATETC* pformatetc,\n    DWORD advf,\n    IAdviseSink* pAdvSink,\n    DWORD* pdwConnection);\n```  \n  \n### Remarks  \n This enables the advise sink to receive notifications of changes in the object.  \n  \n To terminate the connection, call [DUnadvise](#idataobjectimpl__dunadvise).  \n  \n See [IDataObject::DAdvise](http://msdn.microsoft.com/library/windows/desktop/ms692579) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idataobjectimpl__dunadvise\"></a>  IDataObjectImpl::DUnadvise  \n Terminates a connection previously established through [DAdvise](#idataobjectimpl__dadvise).  \n  \n```\nHRESULT DUnadvise(DWORD dwConnection);\n```  \n  \n### Remarks  \n See [IDataObject::DUnadvise](http://msdn.microsoft.com/library/windows/desktop/ms692448) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idataobjectimpl__enumdadvise\"></a>  IDataObjectImpl::EnumDAdvise  \n Creates an enumerator to iterate through the current advisory connections.  \n  \n```\nHRESULT DAdvise(\n    FORMATETC* pformatetc,\n    DWORD advf,\n    IAdviseSink* pAdvSink,\n    DWORD* pdwConnection);\n```  \n  \n### Remarks  \n See [IDataObject::EnumDAdvise](http://msdn.microsoft.com/library/windows/desktop/ms680127) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idataobjectimpl__enumformatetc\"></a>  IDataObjectImpl::EnumFormatEtc  \n Creates an enumerator to iterate through the **FORMATETC** structures supported by the data object.  \n  \n```\nHRESULT EnumFormatEtc(DWORD dwDirection,\n    IEnumFORMATETC** ppenumFormatEtc);\n```  \n  \n### Remarks  \n See [IDataObject::EnumFormatEtc](http://msdn.microsoft.com/library/windows/desktop/ms683979) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Return Value  \n Returns **E_NOTIMPL**.  \n  \n##  <a name=\"idataobjectimpl__firedatachange\"></a>  IDataObjectImpl::FireDataChange  \n Sends a change notification back to each advise sink that is currently being managed.  \n  \n```\nHRESULT FireDataChange();\n```  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n##  <a name=\"idataobjectimpl__getcanonicalformatetc\"></a>  IDataObjectImpl::GetCanonicalFormatEtc  \n Retrieves a logically equivalent **FORMATETC** structure to one that is more complex.  \n  \n```\nHRESULT GetCanonicalFormatEtc(\n    FORMATETC* pformatetcIn,\n    FORMATETC* pformatetcOut);\n```  \n  \n### Return Value  \n Returns **E_NOTIMPL**.  \n  \n### Remarks  \n See [IDataObject::GetCanonicalFormatEtc](http://msdn.microsoft.com/library/windows/desktop/ms680685) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idataobjectimpl__getdata\"></a>  IDataObjectImpl::GetData  \n Transfers data from the data object to the client.  \n  \n```\nHRESULT GetData(\n    FORMATETC* pformatetcIn,\n    STGMEDIUM* pmedium);\n```  \n  \n### Remarks  \n The *pformatetcIn* parameter must specify a storage medium type of **TYMED_MFPICT**.  \n  \n See [IDataObject::GetData](http://msdn.microsoft.com/library/windows/desktop/ms678431) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idataobjectimpl__getdatahere\"></a>  IDataObjectImpl::GetDataHere  \n Similar to `GetData`, except the client must allocate the **STGMEDIUM** structure.  \n  \n```\nHRESULT GetDataHere(\n    FORMATETC* pformatetc,\n    STGMEDIUM* pmedium);\n```  \n  \n### Return Value  \n Returns **E_NOTIMPL**.  \n  \n### Remarks  \n See [IDataObject::GetDataHere](http://msdn.microsoft.com/library/windows/desktop/ms687266) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idataobjectimpl__querygetdata\"></a>  IDataObjectImpl::QueryGetData  \n Determines whether the data object supports a particular **FORMATETC** structure for transferring data.  \n  \n```\nHRESULT QueryGetData(FORMATETC* pformatetc);\n```  \n  \n### Return Value  \n Returns **E_NOTIMPL**.  \n  \n### Remarks  \n See [IDataObject::QueryGetData](http://msdn.microsoft.com/library/windows/desktop/ms680637) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"idataobjectimpl__setdata\"></a>  IDataObjectImpl::SetData  \n Transfers data from the client to the data object.  \n  \n```\nHRESULT SetData(\n    FORMATETC* pformatetc,\n    STGMEDIUM* pmedium,\n    BOOL fRelease);\n```  \n  \n### Return Value  \n Returns **E_NOTIMPL**.  \n  \n### Remarks  \n See [IDataObject::SetData](http://msdn.microsoft.com/library/windows/desktop/ms686626) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}