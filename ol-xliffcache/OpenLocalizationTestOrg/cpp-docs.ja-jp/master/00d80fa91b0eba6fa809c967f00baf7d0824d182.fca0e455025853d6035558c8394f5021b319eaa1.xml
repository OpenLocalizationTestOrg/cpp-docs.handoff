{"nodes":[{"pos":[12,70],"content":"ODBC: Calling ODBC API Functions Directly | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ODBC: Calling ODBC API Functions Directly | Microsoft Docs","pos":[0,58]}]},{"content":"ODBC: Calling ODBC API Functions Directly","pos":[901,942]},{"content":"The database classes provide a simpler interface to a <bpt id=\"p1\">[</bpt>data source<ept id=\"p1\">](../../data/odbc/data-source-odbc.md)</ept> than does ODBC.","pos":[943,1063],"source":"The database classes provide a simpler interface to a [data source](../../data/odbc/data-source-odbc.md) than does ODBC."},{"content":"As a result, the classes do not encapsulate all the ODBC API.","pos":[1064,1125]},{"content":"For any functionality that falls outside the abilities of the classes, you must call ODBC API functions directly.","pos":[1126,1239]},{"content":"For example, you must call the ODBC catalog functions (<bpt id=\"p1\">**</bpt>::SQLColumns<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>::SQLProcedures<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>::SQLTables<ept id=\"p3\">**</ept>, and others) directly.","pos":[1240,1372],"source":" For example, you must call the ODBC catalog functions (**::SQLColumns**, **::SQLProcedures**, **::SQLTables**, and others) directly."},{"pos":[1380,1534],"content":"[!NOTE]\n ODBC data sources are accessible through the MFC ODBC classes, as described in this topic, or through the MFC Data Access Object (DAO) classes.","leadings":["","> "],"nodes":[{"content":"ODBC data sources are accessible through the MFC ODBC classes, as described in this topic, or through the MFC Data Access Object (DAO) classes.","pos":[9,152]}]},{"content":"To call an ODBC API function directly, you must take the same steps you would take if you were making the calls without the framework.","pos":[1541,1675]},{"content":"They steps are:","pos":[1676,1691]},{"content":"Allocate storage for any results the call returns.","pos":[1701,1751]},{"content":"Pass an ODBC <bpt id=\"p1\">**</bpt>HDBC<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>HSTMT<ept id=\"p2\">**</ept> handle, depending on the parameter signature of the function.","pos":[1761,1857],"source":"Pass an ODBC **HDBC** or **HSTMT** handle, depending on the parameter signature of the function."},{"content":"Use the <bpt id=\"p1\">[</bpt>AFXGetHENV<ept id=\"p1\">](http://msdn.microsoft.com/library/d8be2a8e-b93a-460f-affb-cf65b2f3dc10)</ept> macro to retrieve the ODBC handle.","pos":[1858,1985],"source":" Use the [AFXGetHENV](http://msdn.microsoft.com/library/d8be2a8e-b93a-460f-affb-cf65b2f3dc10) macro to retrieve the ODBC handle."},{"pos":[1996,2143],"content":"Member variables <bpt id=\"p1\">**</bpt>CDatabase::m_hdbc<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>CRecordset::m_hstmt<ept id=\"p2\">**</ept> are available so that you do not need to allocate and initialize these yourself.","source":"Member variables **CDatabase::m_hdbc** and **CRecordset::m_hstmt** are available so that you do not need to allocate and initialize these yourself."},{"content":"Perhaps call additional ODBC functions to prepare for or follow up the main call.","pos":[2153,2234]},{"content":"Deallocate storage when you finish.","pos":[2244,2279]},{"pos":[2286,2456],"content":"For more information about these steps, see the <bpt id=\"p1\">[</bpt>Open Database Connectivity (ODBC)<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms710252.aspx)</ept> SDK in the MSDN documentation.","source":"For more information about these steps, see the [Open Database Connectivity (ODBC)](https://msdn.microsoft.com/en-us/library/ms710252.aspx) SDK in the MSDN documentation."},{"content":"In addition to these steps, you need to take extra steps to check function return values, ensure that your program is not waiting for an asynchronous call to finish, and so on.","pos":[2463,2639]},{"content":"You can simplify these last steps by using the <ph id=\"ph1\">`AFX_SQL_ASYNC`</ph> and <ph id=\"ph2\">`AFX_SQL_SYNC`</ph> macros.","pos":[2640,2729],"source":" You can simplify these last steps by using the `AFX_SQL_ASYNC` and `AFX_SQL_SYNC` macros."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Macros and Globals<ept id=\"p1\">](../../mfc/reference/mfc-macros-and-globals.md)</ept> in the <bpt id=\"p2\">*</bpt>MFC Reference<ept id=\"p2\">*</ept>.","pos":[2730,2847],"source":" For more information, see [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md) in the *MFC Reference*."},{"content":"See Also","pos":[2857,2865]},{"content":"ODBC Basics","pos":[2870,2881]}],"content":"---\ntitle: \"ODBC: Calling ODBC API Functions Directly | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ODBC API functions [C++], calling\"\n  - \"ODBC [C++], catalog functions\"\n  - \"ODBC API functions [C++]\"\n  - \"APIs [C++], calling\"\n  - \"ODBC classes [C++], vs. ODBC API\"\n  - \"direct ODBC API calls\"\n  - \"catalog functions (ODBC)\"\n  - \"catalog functions (ODBC), calling\"\n  - \"ODBC [C++], API functions\"\nms.assetid: 4295f1d9-4528-4d2e-bd6a-c7569953c7fa\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# ODBC: Calling ODBC API Functions Directly\nThe database classes provide a simpler interface to a [data source](../../data/odbc/data-source-odbc.md) than does ODBC. As a result, the classes do not encapsulate all the ODBC API. For any functionality that falls outside the abilities of the classes, you must call ODBC API functions directly. For example, you must call the ODBC catalog functions (**::SQLColumns**, **::SQLProcedures**, **::SQLTables**, and others) directly.  \n  \n> [!NOTE]\n>  ODBC data sources are accessible through the MFC ODBC classes, as described in this topic, or through the MFC Data Access Object (DAO) classes.  \n  \n To call an ODBC API function directly, you must take the same steps you would take if you were making the calls without the framework. They steps are:  \n  \n-   Allocate storage for any results the call returns.  \n  \n-   Pass an ODBC **HDBC** or **HSTMT** handle, depending on the parameter signature of the function. Use the [AFXGetHENV](http://msdn.microsoft.com/library/d8be2a8e-b93a-460f-affb-cf65b2f3dc10) macro to retrieve the ODBC handle.  \n  \n     Member variables **CDatabase::m_hdbc** and **CRecordset::m_hstmt** are available so that you do not need to allocate and initialize these yourself.  \n  \n-   Perhaps call additional ODBC functions to prepare for or follow up the main call.  \n  \n-   Deallocate storage when you finish.  \n  \n For more information about these steps, see the [Open Database Connectivity (ODBC)](https://msdn.microsoft.com/en-us/library/ms710252.aspx) SDK in the MSDN documentation.  \n  \n In addition to these steps, you need to take extra steps to check function return values, ensure that your program is not waiting for an asynchronous call to finish, and so on. You can simplify these last steps by using the `AFX_SQL_ASYNC` and `AFX_SQL_SYNC` macros. For more information, see [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md) in the *MFC Reference*.  \n\n  \n## See Also  \n [ODBC Basics](../../data/odbc/odbc-basics.md)"}