{"nodes":[{"pos":[12,43],"content":"CSession Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CSession Class | Microsoft Docs","pos":[0,31]}]},{"content":"CSession Class","pos":[635,649]},{"content":"Represents a single database access session.","pos":[650,694]},{"content":"Syntax","pos":[703,709]},{"content":"Members","pos":[750,757]},{"content":"Methods","pos":[767,774]},{"content":"Abort","pos":[796,801]},{"content":"Cancels (terminates) the transaction.","pos":[839,876]},{"content":"Close","pos":[882,887]},{"content":"Closes the session.","pos":[925,944]},{"content":"Commit","pos":[950,956]},{"content":"Commits the transaction.","pos":[995,1019]},{"content":"GetTransactionInfo","pos":[1025,1043]},{"content":"Returns information regarding a transaction.","pos":[1094,1138]},{"content":"Open","pos":[1144,1148]},{"content":"Opens a new session for the data source object.","pos":[1185,1232]},{"content":"StartTransaction","pos":[1238,1254]},{"content":"Begins a new transaction for this session.","pos":[1303,1345]},{"content":"Remarks","pos":[1355,1362]},{"content":"One or more sessions can be associated with each provider connection (data source), which is represented by a <bpt id=\"p1\">[</bpt>CDataSource<ept id=\"p1\">](../../data/oledb/cdatasource-class.md)</ept> object.","pos":[1366,1536],"source":"One or more sessions can be associated with each provider connection (data source), which is represented by a [CDataSource](../../data/oledb/cdatasource-class.md) object."},{"content":"To create a new <ph id=\"ph1\">`CSession`</ph> for a <ph id=\"ph2\">`CDataSource`</ph>, call <bpt id=\"p1\">[</bpt>CSession::Open<ept id=\"p1\">](../../data/oledb/csession-open.md)</ept>.","pos":[1537,1642],"source":" To create a new `CSession` for a `CDataSource`, call [CSession::Open](../../data/oledb/csession-open.md)."},{"content":"To begin a database transaction, <ph id=\"ph1\">`CSession`</ph> provides the <ph id=\"ph2\">`StartTransaction`</ph> method.","pos":[1643,1726],"source":" To begin a database transaction, `CSession` provides the `StartTransaction` method."},{"content":"Once a transaction is started, you can commit to it using the <bpt id=\"p1\">**</bpt>Commit<ept id=\"p1\">**</ept> method, or cancel it using the <bpt id=\"p2\">**</bpt>Abort<ept id=\"p2\">**</ept> method.","pos":[1727,1848],"source":" Once a transaction is started, you can commit to it using the **Commit** method, or cancel it using the **Abort** method."},{"content":"Requirements","pos":[1857,1869]},{"pos":[1873,1895],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldbcli.h","source":"**Header:** atldbcli.h"},{"content":"See Also","pos":[1904,1912]},{"content":"CatDB","pos":[1917,1922]},{"content":"OLE DB Consumer Templates","pos":[1958,1983]},{"content":"OLE DB Consumer Templates Reference","pos":[2041,2076]}],"content":"---\ntitle: \"CSession Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"CSession\"\n  - \"ATL::CSession\"\n  - \"ATL.CSession\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CSession class\"\nms.assetid: 83cd798f-b45d-4f11-a23c-29183390450c\ncaps.latest.revision: 13\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CSession Class\nRepresents a single database access session.  \n  \n## Syntax  \n  \n```  \nclass CSession  \n```  \n  \n## Members  \n  \n### Methods  \n  \n|||  \n|-|-|  \n|[Abort](../../data/oledb/csession-abort.md)|Cancels (terminates) the transaction.|  \n|[Close](../../data/oledb/csession-close.md)|Closes the session.|  \n|[Commit](../../data/oledb/csession-commit.md)|Commits the transaction.|  \n|[GetTransactionInfo](../../data/oledb/csession-gettransactioninfo.md)|Returns information regarding a transaction.|  \n|[Open](../../data/oledb/csession-open.md)|Opens a new session for the data source object.|  \n|[StartTransaction](../../data/oledb/csession-starttransaction.md)|Begins a new transaction for this session.|  \n  \n## Remarks  \n One or more sessions can be associated with each provider connection (data source), which is represented by a [CDataSource](../../data/oledb/cdatasource-class.md) object. To create a new `CSession` for a `CDataSource`, call [CSession::Open](../../data/oledb/csession-open.md). To begin a database transaction, `CSession` provides the `StartTransaction` method. Once a transaction is started, you can commit to it using the **Commit** method, or cancel it using the **Abort** method.  \n  \n## Requirements  \n **Header:** atldbcli.h  \n  \n## See Also  \n [CatDB](../../visual-cpp-samples.md)   \n [OLE DB Consumer Templates](../../data/oledb/ole-db-consumer-templates-cpp.md)   \n [OLE DB Consumer Templates Reference](../../data/oledb/ole-db-consumer-templates-reference.md)"}