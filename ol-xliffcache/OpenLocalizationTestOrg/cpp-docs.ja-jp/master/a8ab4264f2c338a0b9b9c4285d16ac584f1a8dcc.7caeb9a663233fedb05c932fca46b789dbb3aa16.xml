{"nodes":[{"pos":[12,97],"content":"ActiveX Control Containers: Using Controls in a Non-Dialog Container | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ActiveX Control Containers: Using Controls in a Non-Dialog Container | Microsoft Docs","pos":[0,85]}]},{"content":"ActiveX Control Containers: Using Controls in a Non-Dialog Container","pos":[831,899]},{"content":"In some applications, such as an SDI or MDI application, you will want to embed a control in a window of the application.","pos":[900,1021]},{"content":"The <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> member function of the wrapper class, inserted by Visual C++, can create an instance of the control dynamically, without the need for a dialog box.","pos":[1022,1184],"source":" The **Create** member function of the wrapper class, inserted by Visual C++, can create an instance of the control dynamically, without the need for a dialog box."},{"pos":[1191,1251],"content":"The <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> member function has the following parameters:","source":"The **Create** member function has the following parameters:"},{"content":"A pointer to the text to be displayed in the control's Text or Caption property (if any).","pos":[1278,1367]},{"content":"Windows styles.","pos":[1387,1402]},{"content":"For a complete list, see <bpt id=\"p1\">[</bpt>CWnd::CreateControl<ept id=\"p1\">](../mfc/reference/cwnd-class.md#cwnd__createcontrol)</ept>.","pos":[1403,1502],"source":" For a complete list, see [CWnd::CreateControl](../mfc/reference/cwnd-class.md#cwnd__createcontrol)."},{"content":"Specifies the control's size and position.","pos":[1519,1561]},{"content":"Specifies the control's parent window, usually a <ph id=\"ph1\">`CDialog`</ph>.","pos":[1584,1643],"source":" Specifies the control's parent window, usually a `CDialog`."},{"content":"It must not be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[1644,1668],"source":" It must not be **NULL**."},{"content":"Specifies the control ID and can be used by the container to refer to the control.","pos":[1684,1766]},{"content":"One example of using this function to dynamically create an ActiveX control would be in a form view of an SDI application.","pos":[1773,1895]},{"content":"You could then create an instance of the control in the <ph id=\"ph1\">`WM_CREATE`</ph> handler of the application.","pos":[1896,1991],"source":" You could then create an instance of the control in the `WM_CREATE` handler of the application."},{"pos":[1998,2136],"content":"For this example, <ph id=\"ph1\">`CMyView`</ph> is the main view class, <ph id=\"ph2\">`CCirc`</ph> is the wrapper class, and CIRC.H is the header (.H) file of the wrapper class.","source":"For this example, `CMyView` is the main view class, `CCirc` is the wrapper class, and CIRC.H is the header (.H) file of the wrapper class."},{"content":"Implementing this feature is a four-step process.","pos":[2143,2192]},{"content":"To dynamically create an ActiveX control in a non-dialog window","pos":[2202,2265]},{"pos":[2275,2346],"content":"Insert CIRC.H in CMYVIEW.H, just before the <ph id=\"ph1\">`CMyView`</ph> class definition:","source":"Insert CIRC.H in CMYVIEW.H, just before the `CMyView` class definition:"},{"pos":[2368,2385],"content":"NVC_MFC_AxCont#12"},{"pos":[2493,2613],"content":"Add a member variable (of type <ph id=\"ph1\">`CCirc`</ph>) to the protected section of the <ph id=\"ph2\">`CMyView`</ph> class definition located in CMYVIEW.H:","source":"Add a member variable (of type `CCirc`) to the protected section of the `CMyView` class definition located in CMYVIEW.H:"},{"pos":[2624,2883],"content":"[!code-cpp[NVC_MFC_AxCont#13](../mfc/codesnippet/cpp/activex-control-containers-using-controls-in-a-non-dialog-container_2.h)]  \n[!code-cpp[NVC_MFC_AxCont#14](../mfc/codesnippet/cpp/activex-control-containers-using-controls-in-a-non-dialog-container_3.h)]","leadings":["","    "],"nodes":[{"content":"NVC_MFC_AxCont#13","pos":[11,28]},{"content":"NVC_MFC_AxCont#14","pos":[140,157]}]},{"pos":[2893,2946],"content":"Add a <ph id=\"ph1\">`WM_CREATE`</ph> message handler to class <ph id=\"ph2\">`CMyView`</ph>.","source":"Add a `WM_CREATE` message handler to class `CMyView`."},{"pos":[2956,3097],"content":"In the handler function, <ph id=\"ph1\">`CMyView::OnCreate`</ph>, make a call to the control's <ph id=\"ph2\">`Create`</ph> function using the <bpt id=\"p1\">**</bpt>this<ept id=\"p1\">**</ept> pointer as the parent window:","source":"In the handler function, `CMyView::OnCreate`, make a call to the control's `Create` function using the **this** pointer as the parent window:"},{"pos":[3119,3136],"content":"NVC_MFC_AxCont#15"},{"content":"Rebuild the project.","pos":[3246,3266]},{"content":"A Circ control will be created dynamically whenever the application's view is created.","pos":[3267,3353]},{"content":"See Also","pos":[3362,3370]},{"content":"ActiveX Control Containers","pos":[3375,3401]}],"content":"---\ntitle: \"ActiveX Control Containers: Using Controls in a Non-Dialog Container | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Create method [C++], ActiveX controls\"\n  - \"CreateControl method\"\n  - \"ActiveX controls [C++], creating\"\n  - \"ActiveX control containers [C++], non-dialog containers\"\n  - \"ActiveX control containers [C++], inserting controls\"\nms.assetid: 46f195b0-b8ca-4409-8cca-fbfaf2c9ab9f\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# ActiveX Control Containers: Using Controls in a Non-Dialog Container\nIn some applications, such as an SDI or MDI application, you will want to embed a control in a window of the application. The **Create** member function of the wrapper class, inserted by Visual C++, can create an instance of the control dynamically, without the need for a dialog box.  \n  \n The **Create** member function has the following parameters:  \n  \n `lpszWindowName`  \n A pointer to the text to be displayed in the control's Text or Caption property (if any).  \n  \n `dwStyle`  \n Windows styles. For a complete list, see [CWnd::CreateControl](../mfc/reference/cwnd-class.md#cwnd__createcontrol).  \n  \n `rect`  \n Specifies the control's size and position.  \n  \n `pParentWnd`  \n Specifies the control's parent window, usually a `CDialog`. It must not be **NULL**.  \n  \n `nID`  \n Specifies the control ID and can be used by the container to refer to the control.  \n  \n One example of using this function to dynamically create an ActiveX control would be in a form view of an SDI application. You could then create an instance of the control in the `WM_CREATE` handler of the application.  \n  \n For this example, `CMyView` is the main view class, `CCirc` is the wrapper class, and CIRC.H is the header (.H) file of the wrapper class.  \n  \n Implementing this feature is a four-step process.  \n  \n### To dynamically create an ActiveX control in a non-dialog window  \n  \n1.  Insert CIRC.H in CMYVIEW.H, just before the `CMyView` class definition:  \n  \n     [!code-cpp[NVC_MFC_AxCont#12](../mfc/codesnippet/cpp/activex-control-containers-using-controls-in-a-non-dialog-container_1.h)]  \n  \n2.  Add a member variable (of type `CCirc`) to the protected section of the `CMyView` class definition located in CMYVIEW.H:  \n  \n     [!code-cpp[NVC_MFC_AxCont#13](../mfc/codesnippet/cpp/activex-control-containers-using-controls-in-a-non-dialog-container_2.h)]  \n    [!code-cpp[NVC_MFC_AxCont#14](../mfc/codesnippet/cpp/activex-control-containers-using-controls-in-a-non-dialog-container_3.h)]  \n  \n3.  Add a `WM_CREATE` message handler to class `CMyView`.  \n  \n4.  In the handler function, `CMyView::OnCreate`, make a call to the control's `Create` function using the **this** pointer as the parent window:  \n  \n     [!code-cpp[NVC_MFC_AxCont#15](../mfc/codesnippet/cpp/activex-control-containers-using-controls-in-a-non-dialog-container_4.cpp)]  \n  \n5.  Rebuild the project. A Circ control will be created dynamically whenever the application's view is created.  \n  \n## See Also  \n [ActiveX Control Containers](../mfc/activex-control-containers.md)\n\n"}