{"nodes":[{"pos":[12,56],"content":"Calling C++ Code from DHTML | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Calling C++ Code from DHTML | Microsoft Docs","pos":[0,44]}]},{"content":"Calling C++ Code from DHTML","pos":[594,621]},{"content":"A DHTML control can be hosted in a container, such as Test Container or Internet Explorer.","pos":[622,712]},{"content":"See <bpt id=\"p1\">[</bpt>Testing Properties and Events with Test Container<ept id=\"p1\">](../mfc/testing-properties-and-events-with-test-container.md)</ept> for information on how to access Test Container.","pos":[713,878],"source":" See [Testing Properties and Events with Test Container](../mfc/testing-properties-and-events-with-test-container.md) for information on how to access Test Container."},{"content":"The container hosting the control communicates with the control using the normal control interfaces.","pos":[885,985]},{"content":"DHTML uses the dispatch interface that ends with \"UI\" to communicate with your C++ code and your HTML resource.","pos":[986,1097]},{"content":"In <bpt id=\"p1\">[</bpt>Modifying the ATL DHTML Control<ept id=\"p1\">](../atl/modifying-the-atl-dhtml-control.md)</ept>, you can practice adding the methods to be called by these different interfaces.","pos":[1098,1258],"source":" In [Modifying the ATL DHTML Control](../atl/modifying-the-atl-dhtml-control.md), you can practice adding the methods to be called by these different interfaces."},{"pos":[1265,1471],"content":"To see an example of calling C++ code from DHTML, <bpt id=\"p1\">[</bpt>create a DHTML control<ept id=\"p1\">](../atl/creating-an-atl-dhtml-control.md)</ept> using the ATL Control Wizard and examine the code in the header file and in the HTML file.","source":"To see an example of calling C++ code from DHTML, [create a DHTML control](../atl/creating-an-atl-dhtml-control.md) using the ATL Control Wizard and examine the code in the header file and in the HTML file."},{"content":"Declaring WebBrowser Methods in the Header File","pos":[1480,1527]},{"content":"To invoke C++ methods from the DHTML UI, you must add methods to your control's UI interface.","pos":[1531,1624]},{"content":"For example, the header file created by the ATL Control Wizard contains the C++ method <ph id=\"ph1\">`OnClick`</ph>, which is a member of the UI interface of the wizard-generated control.","pos":[1625,1793],"source":" For example, the header file created by the ATL Control Wizard contains the C++ method `OnClick`, which is a member of the UI interface of the wizard-generated control."},{"pos":[1800,1843],"content":"Examine <ph id=\"ph1\">`OnClick`</ph> in the control's .h file:","source":"Examine `OnClick` in the control's .h file:"},{"pos":[1861,1874],"content":"NVC_ATL_COM#4"},{"content":"The first parameter, <ph id=\"ph1\">`pdispBody`</ph>, is a pointer to the body object's dispatch interface.","pos":[1939,2026],"source":"The first parameter, `pdispBody`, is a pointer to the body object's dispatch interface."},{"content":"The second parameter, <ph id=\"ph1\">`varColor`</ph>, identifies the color to apply to the control.","pos":[2027,2106],"source":" The second parameter, `varColor`, identifies the color to apply to the control."},{"content":"Calling C++ Code in the HTML File","pos":[2115,2148]},{"content":"Once you have declared the WebBrowser methods in the header file, you can invoke the methods from the HTML file.","pos":[2152,2264]},{"content":"Notice in the HTML file that the ATL Control Wizard inserts three Windows dispatch methods: three <ph id=\"ph1\">`OnClick`</ph> methods that dispatch messages to change the background color of the control.","pos":[2265,2450],"source":" Notice in the HTML file that the ATL Control Wizard inserts three Windows dispatch methods: three `OnClick` methods that dispatch messages to change the background color of the control."},{"content":"Examine one of the methods in the HTML file:","pos":[2457,2501]},{"content":"In the HTML code above, the window external method, <ph id=\"ph1\">`OnClick`</ph>, is called as part of the button tag.","pos":[2588,2687],"source":"In the HTML code above, the window external method, `OnClick`, is called as part of the button tag."},{"content":"The method has two parameters: <ph id=\"ph1\">`theBody`</ph>, which references the body of the HTML document, and <ph id=\"ph2\">`\"red\"`</ph>, which indicates that the control's background color will be changed to red when the button is clicked.","pos":[2688,2893],"source":" The method has two parameters: `theBody`, which references the body of the HTML document, and `\"red\"`, which indicates that the control's background color will be changed to red when the button is clicked."},{"content":"The <ph id=\"ph1\">`Red`</ph> following the tag is the button's label.","pos":[2894,2944],"source":" The `Red` following the tag is the button's label."},{"content":"See <bpt id=\"p1\">[</bpt>Modifying the ATL DHTML Control<ept id=\"p1\">](../atl/modifying-the-atl-dhtml-control.md)</ept> for more information about providing your own methods.","pos":[2951,3086],"source":"See [Modifying the ATL DHTML Control](../atl/modifying-the-atl-dhtml-control.md) for more information about providing your own methods."},{"content":"See <bpt id=\"p1\">[</bpt>Identifying the Elements of the DHTML Control Project<ept id=\"p1\">](../atl/identifying-the-elements-of-the-dhtml-control-project.md)</ept> for more information about the HTML file.","pos":[3087,3253],"source":" See [Identifying the Elements of the DHTML Control Project](../atl/identifying-the-elements-of-the-dhtml-control-project.md) for more information about the HTML file."},{"content":"See Also","pos":[3262,3270]},{"content":"Support for DHTML Control","pos":[3275,3300]}],"content":"---\ntitle: \"Calling C++ Code from DHTML | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DHTML, calling C++ code from\"\nms.assetid: 37329acd-4c22-40ca-a85a-b7480748f75f\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Calling C++ Code from DHTML\nA DHTML control can be hosted in a container, such as Test Container or Internet Explorer. See [Testing Properties and Events with Test Container](../mfc/testing-properties-and-events-with-test-container.md) for information on how to access Test Container.  \n  \n The container hosting the control communicates with the control using the normal control interfaces. DHTML uses the dispatch interface that ends with \"UI\" to communicate with your C++ code and your HTML resource. In [Modifying the ATL DHTML Control](../atl/modifying-the-atl-dhtml-control.md), you can practice adding the methods to be called by these different interfaces.  \n  \n To see an example of calling C++ code from DHTML, [create a DHTML control](../atl/creating-an-atl-dhtml-control.md) using the ATL Control Wizard and examine the code in the header file and in the HTML file.  \n  \n## Declaring WebBrowser Methods in the Header File  \n To invoke C++ methods from the DHTML UI, you must add methods to your control's UI interface. For example, the header file created by the ATL Control Wizard contains the C++ method `OnClick`, which is a member of the UI interface of the wizard-generated control.  \n  \n Examine `OnClick` in the control's .h file:  \n  \n [!code-cpp[NVC_ATL_COM#4](../atl/codesnippet/cpp/calling-cpp-code-from-dhtml_1.h)]  \n  \n The first parameter, `pdispBody`, is a pointer to the body object's dispatch interface. The second parameter, `varColor`, identifies the color to apply to the control.  \n  \n## Calling C++ Code in the HTML File  \n Once you have declared the WebBrowser methods in the header file, you can invoke the methods from the HTML file. Notice in the HTML file that the ATL Control Wizard inserts three Windows dispatch methods: three `OnClick` methods that dispatch messages to change the background color of the control.  \n  \n Examine one of the methods in the HTML file:  \n  \n `<BUTTON onclick='window.external.OnClick(theBody, \"red\");'>Red</BUTTON>`  \n  \n In the HTML code above, the window external method, `OnClick`, is called as part of the button tag. The method has two parameters: `theBody`, which references the body of the HTML document, and `\"red\"`, which indicates that the control's background color will be changed to red when the button is clicked. The `Red` following the tag is the button's label.  \n  \n See [Modifying the ATL DHTML Control](../atl/modifying-the-atl-dhtml-control.md) for more information about providing your own methods. See [Identifying the Elements of the DHTML Control Project](../atl/identifying-the-elements-of-the-dhtml-control-project.md) for more information about the HTML file.  \n  \n## See Also  \n [Support for DHTML Control](../atl/atl-support-for-dhtml-controls.md)\n\n"}