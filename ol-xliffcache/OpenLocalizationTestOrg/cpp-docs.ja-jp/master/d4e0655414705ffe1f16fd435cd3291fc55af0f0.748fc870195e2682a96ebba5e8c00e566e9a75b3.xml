{"nodes":[{"pos":[12,84],"content":"Exceptions: Throwing Exceptions from Your Own Functions | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Exceptions: Throwing Exceptions from Your Own Functions | Microsoft Docs","pos":[0,72]}]},{"content":"Exceptions: Throwing Exceptions from Your Own Functions","pos":[699,754]},{"content":"It is possible to use the MFC exception-handling paradigm solely to catch exceptions thrown by functions in MFC or other libraries.","pos":[755,886]},{"content":"In addition to catching exceptions thrown by library code, you can throw exceptions from your own code if you are writing functions that can encounter exceptional conditions.","pos":[887,1061]},{"content":"When an exception is thrown, execution of the current function is stopped and jumps directly to the <bpt id=\"p1\">**</bpt>catch<ept id=\"p1\">**</ept> block of the innermost exception frame.","pos":[1068,1217],"source":"When an exception is thrown, execution of the current function is stopped and jumps directly to the **catch** block of the innermost exception frame."},{"content":"The exception mechanism bypasses the normal exit path from a function.","pos":[1218,1288]},{"content":"Therefore, you must be sure to delete those memory blocks that would be deleted in a normal exit.","pos":[1289,1386]},{"content":"To throw an exception","pos":[1397,1418]},{"content":"Use one of the MFC helper functions, such as <ph id=\"ph1\">`AfxThrowMemoryException`</ph>.","pos":[1428,1499],"source":"Use one of the MFC helper functions, such as `AfxThrowMemoryException`."},{"content":"These functions throw a preallocated exception object of the appropriate type.","pos":[1500,1578]},{"content":"In the following example, a function tries to allocate two memory blocks and throws an exception if either allocation fails:","pos":[1589,1713]},{"pos":[1735,1755],"content":"NVC_MFCExceptions#17"},{"content":"If the first allocation fails, you can simply throw the memory exception.","pos":[1853,1926]},{"content":"If the first allocation is successful but the second one fails, you must free the first allocation block before throwing the exception.","pos":[1927,2062]},{"content":"If both allocations succeed, you can proceed normally and free the blocks when exiting the function.","pos":[2063,2163]},{"content":"– or –","pos":[2174,2180]},{"content":"Use a user-defined exception to indicate a problem condition.","pos":[2190,2251]},{"content":"You can throw an item of any type, even an entire class, as your exception.","pos":[2252,2327]},{"content":"The following example attempts to play a sound through a wave device and throws an exception if there is a failure.","pos":[2338,2453]},{"pos":[2475,2495],"content":"NVC_MFCExceptions#18"},{"pos":[2590,2787],"content":"[!NOTE]\n MFC's default handling of exceptions applies only to pointers to `CException` objects (and objects of `CException`-derived classes). The example above bypasses MFC's exception mechanism.","leadings":["","> "],"nodes":[{"content":" MFC's default handling of exceptions applies only to pointers to `CException` objects (and objects of `CException`-derived classes). The example above bypasses MFC's exception mechanism.","pos":[8,195],"nodes":[{"content":"MFC's default handling of exceptions applies only to pointers to <ph id=\"ph1\">`CException`</ph> objects (and objects of <ph id=\"ph2\">`CException`</ph>-derived classes).","pos":[1,133],"source":" MFC's default handling of exceptions applies only to pointers to `CException` objects (and objects of `CException`-derived classes)."},{"content":"The example above bypasses MFC's exception mechanism.","pos":[134,187]}]}]},{"content":"See Also","pos":[2796,2804]},{"content":"Exception Handling","pos":[2809,2827]}],"content":"---\ntitle: \"Exceptions: Throwing Exceptions from Your Own Functions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"throwing exceptions, from functions\"\n  - \"functions [C++], throwing exceptions\"\n  - \"exceptions, throwing\"\nms.assetid: 492976e8-8804-4234-8e8f-30dffd0501be\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Exceptions: Throwing Exceptions from Your Own Functions\nIt is possible to use the MFC exception-handling paradigm solely to catch exceptions thrown by functions in MFC or other libraries. In addition to catching exceptions thrown by library code, you can throw exceptions from your own code if you are writing functions that can encounter exceptional conditions.  \n  \n When an exception is thrown, execution of the current function is stopped and jumps directly to the **catch** block of the innermost exception frame. The exception mechanism bypasses the normal exit path from a function. Therefore, you must be sure to delete those memory blocks that would be deleted in a normal exit.  \n  \n#### To throw an exception  \n  \n1.  Use one of the MFC helper functions, such as `AfxThrowMemoryException`. These functions throw a preallocated exception object of the appropriate type.  \n  \n     In the following example, a function tries to allocate two memory blocks and throws an exception if either allocation fails:  \n  \n     [!code-cpp[NVC_MFCExceptions#17](../mfc/codesnippet/cpp/exceptions-throwing-exceptions-from-your-own-functions_1.cpp)]  \n  \n     If the first allocation fails, you can simply throw the memory exception. If the first allocation is successful but the second one fails, you must free the first allocation block before throwing the exception. If both allocations succeed, you can proceed normally and free the blocks when exiting the function.  \n  \n     – or –  \n  \n2.  Use a user-defined exception to indicate a problem condition. You can throw an item of any type, even an entire class, as your exception.  \n  \n     The following example attempts to play a sound through a wave device and throws an exception if there is a failure.  \n  \n     [!code-cpp[NVC_MFCExceptions#18](../mfc/codesnippet/cpp/exceptions-throwing-exceptions-from-your-own-functions_2.cpp)]  \n  \n> [!NOTE]\n>  MFC's default handling of exceptions applies only to pointers to `CException` objects (and objects of `CException`-derived classes). The example above bypasses MFC's exception mechanism.  \n  \n## See Also  \n [Exception Handling](../mfc/exception-handling-in-mfc.md)\n\n"}