{"nodes":[{"pos":[12,67],"content":"Error Handling in Wizard JScript Files | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Error Handling in Wizard JScript Files | Microsoft Docs","pos":[0,55]}]},{"content":"Error Handling in Wizard JScript Files","pos":[666,704]},{"content":"When you create a wizard, your project includes the Default.js and Common.js files.","pos":[705,788]},{"content":"Use these files to customize your project.","pos":[789,831]},{"content":"See <bpt id=\"p1\">[</bpt>The JScript File<ept id=\"p1\">](../ide/jscript-file.md)</ept> for more information.","pos":[832,900],"source":" See [The JScript File](../ide/jscript-file.md) for more information."},{"content":"Your project should include error handling.","pos":[907,950]},{"content":"The following code provides you with an example of such code.","pos":[951,1012]},{"content":"To handle errors in JScript","pos":[1022,1049]},{"pos":[1059,1133],"content":"To catch errors when the user clicks <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>, enter the following code:","source":"To catch errors when the user clicks **Finish**, enter the following code:"},{"pos":[1440,1504],"content":"Throw <ph id=\"ph1\">`e`</ph> from any helper script functions called in the script:","source":"Throw `e` from any helper script functions called in the script:"},{"content":"If the parameter <bpt id=\"p1\">**</bpt>PREPROCESS_FUNCTION<ept id=\"p1\">**</ept> is in <bpt id=\"p2\">[</bpt>the .vsz file<ept id=\"p2\">](../ide/dot-vsz-file-project-control.md)</ept>, the wizard calls <bpt id=\"p3\">[</bpt>CanAddATLClass<ept id=\"p3\">](../ide/jscript-functions-for-cpp-wizards.md)</ept>.","pos":[1715,1898],"source":"If the parameter **PREPROCESS_FUNCTION** is in [the .vsz file](../ide/dot-vsz-file-project-control.md), the wizard calls [CanAddATLClass](../ide/jscript-functions-for-cpp-wizards.md)."},{"content":"Use <bpt id=\"p1\">[</bpt>SetErrorInfo<ept id=\"p1\">](../ide/seterrorinfo.md)</ept> in case of failure and return <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept>:","pos":[1899,1982],"source":" Use [SetErrorInfo](../ide/seterrorinfo.md) in case of failure and return **false**:"},{"pos":[2766,2876],"content":"If you must go back to the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Add New Item<ept id=\"p2\">**</ept> dialog box, return <bpt id=\"p3\">**</bpt>VS_E_WIZBACKBUTTONPRESS<ept id=\"p3\">**</ept>:","source":"If you must go back to the **New Project** or **Add New Item** dialog box, return **VS_E_WIZBACKBUTTONPRESS**:"},{"content":"See Also","pos":[3089,3097]},{"content":"Files Created for Your Wizard","pos":[3102,3131]},{"content":"Customizing Your Wizard","pos":[3179,3202]}],"content":"---\ntitle: \"Error Handling in Wizard JScript Files | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"JScript, handling errors\"\n  - \"Wizard JScript error handling\"\n  - \"error handling, JScript\"\nms.assetid: 6df3ba46-7ab6-484c-ac45-b08f4b6a5900\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Error Handling in Wizard JScript Files\nWhen you create a wizard, your project includes the Default.js and Common.js files. Use these files to customize your project. See [The JScript File](../ide/jscript-file.md) for more information.  \n  \n Your project should include error handling. The following code provides you with an example of such code.  \n  \n### To handle errors in JScript  \n  \n1.  To catch errors when the user clicks **Finish**, enter the following code:  \n  \n    ```  \n    function OnFinish(selProj, Class)  \n    {  \n       try  \n       {  \n          .....  \n       }  \n       catch(e)  \n       {  \n          if (e.description.length != 0)  \n             SetErrorInfo(e.description, e.number);  \n          return e.number  \n       }  \n    }  \n    ```  \n  \n2.  Throw `e` from any helper script functions called in the script:  \n  \n    ```  \n    function ExtenderFromType(strVariableType)  \n    {  \n       try  \n       {  \n          ....  \n       }  \n       catch(e)  \n       {  \n          throw e;  \n       }  \n    }  \n    ```  \n  \n3.  If the parameter **PREPROCESS_FUNCTION** is in [the .vsz file](../ide/dot-vsz-file-project-control.md), the wizard calls [CanAddATLClass](../ide/jscript-functions-for-cpp-wizards.md). Use [SetErrorInfo](../ide/seterrorinfo.md) in case of failure and return **false**:  \n  \n    ```  \n    function CanAddATLClass(oProj, oObject)  \n    {  \n       try  \n       {  \n          if (!IsATLProject(oProj))  \n          {  \n             if (!IsMFCProject(oProj, true))  \n             {     \n                var L_CanAddATLClass_Text = \"ATL classes can only be added  \n     to ATL, MFC EXE and MFC regular DLL projects.\";  \n                wizard.ReportError(L_CanAddATLClass_Text);  \n                return false;  \n             }  \n             else  \n             {  \n                .....  \n                var bRet = AddATLSupportToProject(oProj);  \n                .....  \n                return bRet;  \n             }  \n          }  \n          return true;  \n       }  \n       catch(e)  \n       {  \n          throw e;  \n       }  \n    }  \n    ```  \n  \n4.  If you must go back to the **New Project** or **Add New Item** dialog box, return **VS_E_WIZBACKBUTTONPRESS**:  \n  \n    ```  \n    function OnFinish(selProj, Class)  \n    {  \n       ....  \n       if (!CheckAddtoProject(selProj))  \n       {  \n          return VS_E_WIZARDBACKBUTTONPRESS;  \n       }  \n    }  \n    ```  \n  \n## See Also  \n [Files Created for Your Wizard](../ide/files-created-for-your-wizard.md)   \n [Customizing Your Wizard](../ide/customizing-your-wizard.md)"}