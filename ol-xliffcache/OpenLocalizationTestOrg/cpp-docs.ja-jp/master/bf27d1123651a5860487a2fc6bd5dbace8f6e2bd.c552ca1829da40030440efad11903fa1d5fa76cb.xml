{"nodes":[{"pos":[12,66],"content":"Creating a COM Interface (Visual C++) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Creating a COM Interface (Visual C++) | Microsoft Docs","pos":[0,54]}]},{"content":"Creating a COM Interface (Visual C++)","pos":[654,691]},{"content":"Visual C++ provides wizards and templates to create projects that use COM defining interfaces and dispinterfaces for your COM objects and automation classes.","pos":[692,849]},{"content":"You can use these wizards to perform the following three common tasks:","pos":[856,926]},{"content":"Adding ATL Support to Your MFC Project","pos":[937,975]},{"content":"Add ATL support to an MFC application after you create an MFC project using the <bpt id=\"p1\">[</bpt>MFC Application Wizard<ept id=\"p1\">](../mfc/reference/mfc-application-wizard.md)</ept> and then running the <bpt id=\"p2\">**</bpt>Add ATL Support to MFC<ept id=\"p2\">**</ept> code wizard.","pos":[1047,1256],"source":"Add ATL support to an MFC application after you create an MFC project using the [MFC Application Wizard](../mfc/reference/mfc-application-wizard.md) and then running the **Add ATL Support to MFC** code wizard."},{"content":"This support applies only to simple COM objects added to an MFC executable or DLL project.","pos":[1257,1347]},{"content":"These ATL objects may have multiple interfaces.","pos":[1348,1395]},{"content":"Creating an MFC ActiveX Control","pos":[1406,1437]},{"pos":[1502,1716],"content":"Open the <bpt id=\"p1\">[</bpt>MFC ActiveX Control Wizard<ept id=\"p1\">](../mfc/reference/mfc-activex-control-wizard.md)</ept> to create an ActiveX control with a dispinterface and an event map defined in the .idl file and the control class, respectively.","source":"Open the [MFC ActiveX Control Wizard](../mfc/reference/mfc-activex-control-wizard.md) to create an ActiveX control with a dispinterface and an event map defined in the .idl file and the control class, respectively."},{"content":"Adding an ATL Control","pos":[1727,1748]},{"pos":[1803,1991],"content":"Use a combination of the <bpt id=\"p1\">[</bpt>ATL Project Wizard<ept id=\"p1\">](../atl/reference/atl-project-wizard.md)</ept> and the <bpt id=\"p2\">[</bpt>ATL Control Wizard<ept id=\"p2\">](../atl/reference/atl-control-wizard.md)</ept> to create an ATL ActiveX control.","source":"Use a combination of the [ATL Project Wizard](../atl/reference/atl-project-wizard.md) and the [ATL Control Wizard](../atl/reference/atl-control-wizard.md) to create an ATL ActiveX control."},{"content":"You can also add an ATL control to an MFC project to which you have added ATL support, as described above.","pos":[2002,2108]},{"content":"Additionally, if you select <bpt id=\"p1\">**</bpt>ATL Control<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Add Class<ept id=\"p2\">**</ept> dialog box, and you have not yet added ATL support to your MFC project, Visual Studio displays a dialog box confirming adding ATL support to your MFC project.","pos":[2109,2332],"source":" Additionally, if you select **ATL Control** in the **Add Class** dialog box, and you have not yet added ATL support to your MFC project, Visual Studio displays a dialog box confirming adding ATL support to your MFC project."},{"content":"This wizard generates IDL source and a COM map in the project classes.","pos":[2343,2413]},{"content":"Once you have an ATL project open, the <bpt id=\"p1\">[</bpt>Add Class<ept id=\"p1\">](../ide/add-class-dialog-box.md)</ept> dialog box gives you the choice of additional wizards and templates to add COM interfaces to your project.","pos":[2420,2609],"source":"Once you have an ATL project open, the [Add Class](../ide/add-class-dialog-box.md) dialog box gives you the choice of additional wizards and templates to add COM interfaces to your project."},{"content":"The following wizards allow you to establish one or more interfaces for the object:","pos":[2610,2693]},{"content":"ATL COM+ 1.0 Component Wizard","pos":[2704,2733]},{"content":"ATL Simple Object Wizard","pos":[2800,2824]},{"content":"ATL Active Server Page Component Wizard","pos":[2882,2921]},{"content":"ATL Control Wizard","pos":[2994,3012]},{"pos":[3060,3259],"content":"Additionally, you can implement new interfaces on your COM control by right-clicking the object's control class in Class View and clicking <bpt id=\"p1\">[</bpt>Implement Interface<ept id=\"p1\">](../ide/implement-interface-wizard.md)</ept>.","source":"Additionally, you can implement new interfaces on your COM control by right-clicking the object's control class in Class View and clicking [Implement Interface](../ide/implement-interface-wizard.md)."},{"pos":[3267,3692],"content":"[!NOTE]\n Visual Studio does not provide a wizard to add an interface to a project. You can add an interface to an ATL project or to an [Adding ATL Support to Your MFC Project](../mfc/reference/adding-atl-support-to-your-mfc-project.md) by adding a simple object using the [ATL Simple Object Wizard](../atl/reference/atl-simple-object-wizard.md). Alternately, open the project's .idl file and create the interface by typing:","leadings":["","> "],"nodes":[{"content":" Visual Studio does not provide a wizard to add an interface to a project. You can add an interface to an ATL project or to an [Adding ATL Support to Your MFC Project](../mfc/reference/adding-atl-support-to-your-mfc-project.md) by adding a simple object using the [ATL Simple Object Wizard](../atl/reference/atl-simple-object-wizard.md). Alternately, open the project's .idl file and create the interface by typing:","pos":[8,423],"nodes":[{"content":"Visual Studio does not provide a wizard to add an interface to a project.","pos":[1,74]},{"content":"You can add an interface to an ATL project or to an <bpt id=\"p1\">[</bpt>Adding ATL Support to Your MFC Project<ept id=\"p1\">](../mfc/reference/adding-atl-support-to-your-mfc-project.md)</ept> by adding a simple object using the <bpt id=\"p2\">[</bpt>ATL Simple Object Wizard<ept id=\"p2\">](../atl/reference/atl-simple-object-wizard.md)</ept>.","pos":[75,337],"source":" You can add an interface to an ATL project or to an [Adding ATL Support to Your MFC Project](../mfc/reference/adding-atl-support-to-your-mfc-project.md) by adding a simple object using the [ATL Simple Object Wizard](../atl/reference/atl-simple-object-wizard.md)."},{"content":"Alternately, open the project's .idl file and create the interface by typing:","pos":[338,415]}]}]},{"pos":[3749,3969],"content":"See <bpt id=\"p1\">[</bpt>Implementing an Interface<ept id=\"p1\">](../ide/implementing-an-interface-visual-cpp.md)</ept> and <bpt id=\"p2\">[</bpt>Adding Objects and Controls to an ATL Project<ept id=\"p2\">](../atl/reference/adding-objects-and-controls-to-an-atl-project.md)</ept> for more information.","source":"See [Implementing an Interface](../ide/implementing-an-interface-visual-cpp.md) and [Adding Objects and Controls to an ATL Project](../atl/reference/adding-objects-and-controls-to-an-atl-project.md) for more information."},{"content":"Visual C++ provides several ways to view and <bpt id=\"p1\">[</bpt>edit the COM interfaces<ept id=\"p1\">](../ide/editing-a-com-interface.md)</ept> defined for your projects.","pos":[3976,4108],"source":"Visual C++ provides several ways to view and [edit the COM interfaces](../ide/editing-a-com-interface.md) defined for your projects."},{"content":"<bpt id=\"p1\">[</bpt>Class View<ept id=\"p1\">](http://msdn.microsoft.com/en-us/8d7430a9-3e33-454c-a9e1-a85e3d2db925)</ept> displays icons for any interface or dispinterface defined in an .idl file in your C++ project.","pos":[4109,4286],"source":"[Class View](http://msdn.microsoft.com/en-us/8d7430a9-3e33-454c-a9e1-a85e3d2db925) displays icons for any interface or dispinterface defined in an .idl file in your C++ project."},{"content":"For ATL-based COM object classes, Class View reads the COM map in the ATL class to display the relationship between the ATL class and any interfaces it implements.","pos":[4293,4456]},{"content":"In Class View and its shortcut menus, you can work with interfaces as follows:","pos":[4463,4541]},{"content":"Add ATL objects to an MFC-based application.","pos":[4551,4595]},{"content":"Add methods, properties, and events.","pos":[4605,4641]},{"content":"Jump directly to an item's interface code by double-clicking the item.","pos":[4651,4721]},{"content":"See Also","pos":[4730,4738]},{"content":"Creating Desktop Projects By Using Application Wizards","pos":[4743,4797]},{"content":"Adding Functionality with Code Wizards","pos":[4870,4908]}],"content":"---\ntitle: \"Creating a COM Interface (Visual C++) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.codewiz.com.creating.interfaces\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"COM interfaces, creating\"\nms.assetid: 1be84d3c-6886-4d1e-8493-56c4d38a96d4\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Creating a COM Interface (Visual C++)\nVisual C++ provides wizards and templates to create projects that use COM defining interfaces and dispinterfaces for your COM objects and automation classes.  \n  \n You can use these wizards to perform the following three common tasks:  \n  \n-   [Adding ATL Support to Your MFC Project](../mfc/reference/adding-atl-support-to-your-mfc-project.md)  \n  \n     Add ATL support to an MFC application after you create an MFC project using the [MFC Application Wizard](../mfc/reference/mfc-application-wizard.md) and then running the **Add ATL Support to MFC** code wizard. This support applies only to simple COM objects added to an MFC executable or DLL project. These ATL objects may have multiple interfaces.  \n  \n-   [Creating an MFC ActiveX Control](../mfc/reference/creating-an-mfc-activex-control.md)  \n  \n     Open the [MFC ActiveX Control Wizard](../mfc/reference/mfc-activex-control-wizard.md) to create an ActiveX control with a dispinterface and an event map defined in the .idl file and the control class, respectively.  \n  \n-   [Adding an ATL Control](../atl/reference/adding-an-atl-control.md)  \n  \n     Use a combination of the [ATL Project Wizard](../atl/reference/atl-project-wizard.md) and the [ATL Control Wizard](../atl/reference/atl-control-wizard.md) to create an ATL ActiveX control.  \n  \n     You can also add an ATL control to an MFC project to which you have added ATL support, as described above. Additionally, if you select **ATL Control** in the **Add Class** dialog box, and you have not yet added ATL support to your MFC project, Visual Studio displays a dialog box confirming adding ATL support to your MFC project.  \n  \n     This wizard generates IDL source and a COM map in the project classes.  \n  \n Once you have an ATL project open, the [Add Class](../ide/add-class-dialog-box.md) dialog box gives you the choice of additional wizards and templates to add COM interfaces to your project. The following wizards allow you to establish one or more interfaces for the object:  \n  \n-   [ATL COM+ 1.0 Component Wizard](../atl/reference/atl-com-plus-1-0-component-wizard.md)  \n  \n-   [ATL Simple Object Wizard](../atl/reference/atl-simple-object-wizard.md)  \n  \n-   [ATL Active Server Page Component Wizard](../atl/reference/atl-active-server-page-component-wizard.md)  \n  \n-   [ATL Control Wizard](../atl/reference/atl-control-wizard.md)  \n  \n Additionally, you can implement new interfaces on your COM control by right-clicking the object's control class in Class View and clicking [Implement Interface](../ide/implement-interface-wizard.md).  \n  \n> [!NOTE]\n>  Visual Studio does not provide a wizard to add an interface to a project. You can add an interface to an ATL project or to an [Adding ATL Support to Your MFC Project](../mfc/reference/adding-atl-support-to-your-mfc-project.md) by adding a simple object using the [ATL Simple Object Wizard](../atl/reference/atl-simple-object-wizard.md). Alternately, open the project's .idl file and create the interface by typing:  \n  \n```  \ninterface IMyInterface {  \n};  \n  \n```  \n  \n See [Implementing an Interface](../ide/implementing-an-interface-visual-cpp.md) and [Adding Objects and Controls to an ATL Project](../atl/reference/adding-objects-and-controls-to-an-atl-project.md) for more information.  \n  \n Visual C++ provides several ways to view and [edit the COM interfaces](../ide/editing-a-com-interface.md) defined for your projects. [Class View](http://msdn.microsoft.com/en-us/8d7430a9-3e33-454c-a9e1-a85e3d2db925) displays icons for any interface or dispinterface defined in an .idl file in your C++ project.  \n  \n For ATL-based COM object classes, Class View reads the COM map in the ATL class to display the relationship between the ATL class and any interfaces it implements.  \n  \n In Class View and its shortcut menus, you can work with interfaces as follows:  \n  \n-   Add ATL objects to an MFC-based application.  \n  \n-   Add methods, properties, and events.  \n  \n-   Jump directly to an item's interface code by double-clicking the item.  \n  \n## See Also  \n [Creating Desktop Projects By Using Application Wizards](../ide/creating-desktop-projects-by-using-application-wizards.md)   \n [Adding Functionality with Code Wizards](../ide/adding-functionality-with-code-wizards-cpp.md)"}