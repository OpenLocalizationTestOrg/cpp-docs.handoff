{"nodes":[{"pos":[12,52],"content":"CAtlTemporaryFile Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CAtlTemporaryFile Class | Microsoft Docs","pos":[0,40]}]},{"content":"CAtlTemporaryFile Class","pos":[682,705]},{"content":"This class provides methods for the creation and use of a temporary file.","pos":[706,779]},{"pos":[787,897],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"content":"Syntax","pos":[906,912]},{"content":"Members","pos":[958,965]},{"content":"Public Constructors","pos":[975,994]},{"content":"Name","pos":[1001,1005]},{"content":"Description","pos":[1006,1017]},{"content":"CAtlTemporaryFile::CAtlTemporaryFile","pos":[1056,1092]},{"content":"The constructor.","pos":[1133,1149]},{"content":"CAtlTemporaryFile::~CAtlTemporaryFile","pos":[1155,1192]},{"content":"The destructor.","pos":[1238,1253]},{"content":"Public Methods","pos":[1264,1278]},{"content":"Name","pos":[1285,1289]},{"content":"Description","pos":[1290,1301]},{"content":"CAtlTemporaryFile::Close","pos":[1340,1364]},{"content":"Call this method to close a temporary file and either delete its contents or store them under the specified file name.","pos":[1393,1511]},{"content":"CAtlTemporaryFile::Create","pos":[1517,1542]},{"content":"Call this method to create a temporary file.","pos":[1572,1616]},{"content":"CAtlTemporaryFile::Flush","pos":[1622,1646]},{"content":"Call this method to force any data remaining in the file buffer to be written to the temporary file.","pos":[1675,1775]},{"content":"CAtlTemporaryFile::GetPosition","pos":[1781,1811]},{"content":"Call this method to get the current file pointer position.","pos":[1846,1904]},{"content":"CAtlTemporaryFile::GetSize","pos":[1910,1936]},{"content":"Call this method to get the size in bytes of the temporary file.","pos":[1967,2031]},{"content":"CAtlTemporaryFile::HandsOff","pos":[2037,2064]},{"pos":[2096,2174],"content":"Call this method to disassociate the file from the <ph id=\"ph1\">`CAtlTemporaryFile`</ph> object.","source":"Call this method to disassociate the file from the `CAtlTemporaryFile` object."},{"content":"CAtlTemporaryFile::HandsOn","pos":[2180,2206]},{"content":"Call this method to open an existing temporary file and position the pointer at the end of the file.","pos":[2237,2337]},{"content":"CAtlTemporaryFile::LockRange","pos":[2343,2371]},{"content":"Call this method to lock a region in the file to prevent other processes from accessing it.","pos":[2404,2495]},{"content":"CAtlTemporaryFile::Read","pos":[2501,2524]},{"content":"Call this method to read data from the temporary file starting at the position indicated by the file pointer.","pos":[2552,2661]},{"content":"CAtlTemporaryFile::Seek","pos":[2667,2690]},{"content":"Call this method to move the file pointer of the temporary file.","pos":[2718,2782]},{"content":"CAtlTemporaryFile::SetSize","pos":[2788,2814]},{"content":"Call this method to set the size of the temporary file.","pos":[2845,2900]},{"content":"CAtlTemporaryFile::TempFileName","pos":[2906,2937]},{"content":"Call this method to return the name of the temporary file.","pos":[2973,3031]},{"content":"CAtlTemporaryFile::UnlockRange","pos":[3037,3067]},{"content":"Call this method to unlock a region of the temporary file.","pos":[3102,3160]},{"content":"CAtlTemporaryFile::Write","pos":[3166,3190]},{"content":"Call this method to write data to the temporary file starting at the position indicated by the file pointer.","pos":[3219,3327]},{"content":"Public Operators","pos":[3338,3354]},{"content":"Name","pos":[3361,3365]},{"content":"Description","pos":[3366,3377]},{"content":"CAtlTemporaryFile::operator HANDLE","pos":[3416,3450]},{"content":"Returns a handle to the temporary file.","pos":[3489,3528]},{"content":"Remarks","pos":[3538,3545]},{"content":"makes it easy to create and use a temporary file.","pos":[3569,3618]},{"content":"The file is automatically named, opened, closed, and deleted.","pos":[3619,3680]},{"content":"If the file contents are required after the file is closed, they can be saved to a new file with a specified name.","pos":[3681,3795]},{"content":"Requirements","pos":[3804,3816]},{"pos":[3820,3841],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlfile.h","source":"**Header:** atlfile.h"},{"content":"Example","pos":[3850,3857]},{"pos":[3861,3959],"content":"See the example for <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::CAtlTemporaryFile<ept id=\"p1\">](#catltemporaryfile__catltemporaryfile)</ept>.","source":"See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile)."},{"pos":[4022,4058],"content":"CAtlTemporaryFile::CAtlTemporaryFile"},{"content":"The constructor.","pos":[4062,4078]},{"content":"Remarks","pos":[4130,4137]},{"pos":[4141,4251],"content":"A file is not actually opened until a call is made to <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::Create<ept id=\"p1\">](#catltemporaryfile__create)</ept>.","source":"A file is not actually opened until a call is made to [CAtlTemporaryFile::Create](#catltemporaryfile__create)."},{"content":"Example","pos":[4261,4268]},{"pos":[4283,4303],"content":"NVC_ATL_Utilities#73"},{"pos":[4430,4467],"content":"CAtlTemporaryFile::~CAtlTemporaryFile"},{"content":"The destructor.","pos":[4471,4486]},{"content":"Remarks","pos":[4539,4546]},{"pos":[4550,4625],"content":"The destructor calls <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::Close<ept id=\"p1\">](#catltemporaryfile__close)</ept>.","source":"The destructor calls [CAtlTemporaryFile::Close](#catltemporaryfile__close)."},{"pos":[4676,4700],"content":"CAtlTemporaryFile::Close"},{"content":"Call this method to close a temporary file and either delete its contents or store them under the specified file name.","pos":[4704,4822]},{"content":"Parameters","pos":[4894,4904]},{"content":"szNewName","pos":[4909,4918]},{"content":"The name for the new file to store the contents of the temporary file in.","pos":[4923,4996]},{"content":"If this argument is NULL, the contents of the temporary file are deleted.","pos":[4997,5070]},{"content":"Return Value","pos":[5080,5092]},{"pos":[5096,5156],"content":"Returns <ph id=\"ph1\">`S_OK`</ph> on success, or an error <ph id=\"ph2\">`HRESULT`</ph> on failure.","source":"Returns `S_OK` on success, or an error `HRESULT` on failure."},{"content":"Example","pos":[5166,5173]},{"pos":[5177,5275],"content":"See the example for <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::CAtlTemporaryFile<ept id=\"p1\">](#catltemporaryfile__catltemporaryfile)</ept>.","source":"See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile)."},{"pos":[5327,5352],"content":"CAtlTemporaryFile::Create"},{"content":"Call this method to create a temporary file.","pos":[5356,5400]},{"content":"Parameters","pos":[5510,5520]},{"content":"The path for the temporary file.","pos":[5536,5568]},{"content":"If this is NULL, <bpt id=\"p1\">[</bpt>GetTempPath<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa364992)</ept> will be called to assign a path.","pos":[5569,5692],"source":" If this is NULL, [GetTempPath](http://msdn.microsoft.com/library/windows/desktop/aa364992) will be called to assign a path."},{"content":"The desired access.","pos":[5720,5739]},{"content":"See <ph id=\"ph1\">`dwDesiredAccess`</ph> in <bpt id=\"p1\">[</bpt>CreateFile<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa363858)</ept> in the <ph id=\"ph2\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[5740,5897],"source":" See `dwDesiredAccess` in [CreateFile](http://msdn.microsoft.com/library/windows/desktop/aa363858) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Return Value","pos":[5907,5919]},{"pos":[5923,5983],"content":"Returns <ph id=\"ph1\">`S_OK`</ph> on success, or an error <ph id=\"ph2\">`HRESULT`</ph> on failure.","source":"Returns `S_OK` on success, or an error `HRESULT` on failure."},{"content":"Example","pos":[5993,6000]},{"pos":[6004,6102],"content":"See the example for <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::CAtlTemporaryFile<ept id=\"p1\">](#catltemporaryfile__catltemporaryfile)</ept>.","source":"See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile)."},{"pos":[6153,6177],"content":"CAtlTemporaryFile::Flush"},{"content":"Call this method to force any data remaining in the file buffer to be written to the temporary file.","pos":[6181,6281]},{"content":"Return Value","pos":[6329,6341]},{"pos":[6345,6405],"content":"Returns <ph id=\"ph1\">`S_OK`</ph> on success, or an error <ph id=\"ph2\">`HRESULT`</ph> on failure.","source":"Returns `S_OK` on success, or an error `HRESULT` on failure."},{"content":"Remarks","pos":[6415,6422]},{"pos":[6426,6533],"content":"Similar to <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::HandsOff<ept id=\"p1\">](#catltemporaryfile__handsoff)</ept>, except that the file is not closed.","source":"Similar to [CAtlTemporaryFile::HandsOff](#catltemporaryfile__handsoff), except that the file is not closed."},{"content":"Example","pos":[6543,6550]},{"pos":[6554,6652],"content":"See the example for <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::CAtlTemporaryFile<ept id=\"p1\">](#catltemporaryfile__catltemporaryfile)</ept>.","source":"See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile)."},{"pos":[6709,6739],"content":"CAtlTemporaryFile::GetPosition"},{"content":"Call this method to get the current file pointer position.","pos":[6743,6801]},{"content":"Parameters","pos":[6876,6886]},{"content":"The position in bytes.","pos":[6900,6922]},{"content":"Return Value","pos":[6932,6944]},{"pos":[6948,7008],"content":"Returns <ph id=\"ph1\">`S_OK`</ph> on success, or an error <ph id=\"ph2\">`HRESULT`</ph> on failure.","source":"Returns `S_OK` on success, or an error `HRESULT` on failure."},{"content":"Remarks","pos":[7018,7025]},{"pos":[7029,7122],"content":"To change the file pointer position, use <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::Seek<ept id=\"p1\">](#catltemporaryfile__seek)</ept>.","source":"To change the file pointer position, use [CAtlTemporaryFile::Seek](#catltemporaryfile__seek)."},{"pos":[7175,7201],"content":"CAtlTemporaryFile::GetSize"},{"content":"Call this method to get the size in bytes of the temporary file.","pos":[7205,7269]},{"content":"Parameters","pos":[7340,7350]},{"content":"The number of bytes in the file.","pos":[7364,7396]},{"content":"Return Value","pos":[7406,7418]},{"pos":[7422,7482],"content":"Returns <ph id=\"ph1\">`S_OK`</ph> on success, or an error <ph id=\"ph2\">`HRESULT`</ph> on failure.","source":"Returns `S_OK` on success, or an error `HRESULT` on failure."},{"pos":[7536,7563],"content":"CAtlTemporaryFile::HandsOff"},{"pos":[7567,7645],"content":"Call this method to disassociate the file from the <ph id=\"ph1\">`CAtlTemporaryFile`</ph> object.","source":"Call this method to disassociate the file from the `CAtlTemporaryFile` object."},{"content":"Return Value","pos":[7696,7708]},{"pos":[7712,7772],"content":"Returns <ph id=\"ph1\">`S_OK`</ph> on success, or an error <ph id=\"ph2\">`HRESULT`</ph> on failure.","source":"Returns `S_OK` on success, or an error `HRESULT` on failure."},{"content":"Remarks","pos":[7782,7789]},{"content":"and <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::HandsOn<ept id=\"p1\">](#catltemporaryfile__handson)</ept> are used to disassociate the file from the object, and reattach it if needed.","pos":[7804,7943],"source":" and [CAtlTemporaryFile::HandsOn](#catltemporaryfile__handson) are used to disassociate the file from the object, and reattach it if needed."},{"content":"will force any data remaining in the file buffer to be written to the temporary file, and then close the file.","pos":[7955,8065]},{"content":"If you want to close and delete the file permanently, or if you want to close and retain the contents of the file with a given name, use <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::Close<ept id=\"p1\">](#catltemporaryfile__close)</ept>.","pos":[8066,8257],"source":" If you want to close and delete the file permanently, or if you want to close and retain the contents of the file with a given name, use [CAtlTemporaryFile::Close](#catltemporaryfile__close)."},{"pos":[8310,8336],"content":"CAtlTemporaryFile::HandsOn"},{"content":"Call this method to open an existing temporary file and position the pointer at the end of the file.","pos":[8340,8440]},{"content":"Return Value","pos":[8490,8502]},{"pos":[8506,8566],"content":"Returns <ph id=\"ph1\">`S_OK`</ph> on success, or an error <ph id=\"ph2\">`HRESULT`</ph> on failure.","source":"Returns `S_OK` on success, or an error `HRESULT` on failure."},{"content":"Remarks","pos":[8576,8583]},{"pos":[8587,8738],"content":"<bpt id=\"p1\">[</bpt>CAtlTemporaryFile::HandsOff<ept id=\"p1\">](#catltemporaryfile__handsoff)</ept> and <ph id=\"ph1\">`HandsOn`</ph> are used to disassociate the file from the object, and reattach it if needed.","source":"[CAtlTemporaryFile::HandsOff](#catltemporaryfile__handsoff) and `HandsOn` are used to disassociate the file from the object, and reattach it if needed."},{"pos":[8793,8821],"content":"CAtlTemporaryFile::LockRange"},{"content":"Call this method to lock a region in the temporary file to prevent other processes from accessing it.","pos":[8825,8926]},{"content":"Parameters","pos":[9011,9021]},{"content":"The position in the file where the lock should begin.","pos":[9035,9088]},{"content":"The length of the byte range to be locked.","pos":[9107,9149]},{"content":"Return Value","pos":[9159,9171]},{"pos":[9175,9235],"content":"Returns <ph id=\"ph1\">`S_OK`</ph> on success, or an error <ph id=\"ph2\">`HRESULT`</ph> on failure.","source":"Returns `S_OK` on success, or an error `HRESULT` on failure."},{"content":"Remarks","pos":[9245,9252]},{"content":"Locking bytes in a file prevents access to those bytes by other processes.","pos":[9256,9330]},{"content":"You can lock more than one region of a file, but no overlapping regions are allowed.","pos":[9331,9415]},{"content":"To successfully unlock a region, use <bpt id=\"p1\">[</bpt>CAtlTemporaryFile::UnlockRange<ept id=\"p1\">](#catltemporaryfile__unlockrange)</ept>, ensuring the byte range corresponds exactly to the region that was previously locked.","pos":[9416,9605],"source":" To successfully unlock a region, use [CAtlTemporaryFile::UnlockRange](#catltemporaryfile__unlockrange), ensuring the byte range corresponds exactly to the region that was previously locked."},{"content":"does not merge adjacent regions; if two locked regions are adjacent, you must unlock each separately.","pos":[9618,9719]},{"pos":[9780,9814],"content":"CAtlTemporaryFile::operator HANDLE"},{"content":"Returns a handle to the temporary file.","pos":[9818,9857]},{"content":"```operator HANDLE() throw();","pos":[9863,9892]},{"pos":[10092,10172],"content":"HRESULT Read(LPVOID pBuffer, DWORD nBufSize, DWORD&amp; nBytesRead) throw();","source":"HRESULT Read(LPVOID pBuffer,\n    DWORD nBufSize,\n    DWORD& nBytesRead) throw();"},{"content":"HRESULT Seek(LONGLONG nOffset,  DWORD dwFrom = FILE_CURRENT) throw();","pos":[10931,11000]},{"content":"HRESULT SetSize(ULONGLONG nNewLen) throw();","pos":[11751,11794]},{"content":"LPCTSTR TempFileName() throw();","pos":[12284,12315]},{"content":"HRESULT UnlockRange(ULONGLONG nPos,  ULONGLONG nCount) throw();","pos":[12898,12961]},{"pos":[13512,13605],"content":"HRESULT Write(LPCVOID pBuffer, DWORD nBufSize, DWORD* pnBytesWritten = NULL) throw();","source":"HRESULT Write(LPCVOID pBuffer,\n    DWORD nBufSize,\n    DWORD* pnBytesWritten = NULL) throw();"}],"content":"---\ntitle: \"CAtlTemporaryFile Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CAtlTemporaryFile\"\n  - \"ATL.CAtlTemporaryFile\"\n  - \"ATL::CAtlTemporaryFile\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CAtlTemporaryFile class\"\nms.assetid: 05f0f2a5-94f6-4594-8dae-b114292ff5f9\ncaps.latest.revision: 18\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CAtlTemporaryFile Class\nThis class provides methods for the creation and use of a temporary file.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\nclass CAtlTemporaryFile\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile)|The constructor.|  \n|[CAtlTemporaryFile::~CAtlTemporaryFile](#catltemporaryfile___dtorcatltemporaryfile)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlTemporaryFile::Close](#catltemporaryfile__close)|Call this method to close a temporary file and either delete its contents or store them under the specified file name.|  \n|[CAtlTemporaryFile::Create](#catltemporaryfile__create)|Call this method to create a temporary file.|  \n|[CAtlTemporaryFile::Flush](#catltemporaryfile__flush)|Call this method to force any data remaining in the file buffer to be written to the temporary file.|  \n|[CAtlTemporaryFile::GetPosition](#catltemporaryfile__getposition)|Call this method to get the current file pointer position.|  \n|[CAtlTemporaryFile::GetSize](#catltemporaryfile__getsize)|Call this method to get the size in bytes of the temporary file.|  \n|[CAtlTemporaryFile::HandsOff](#catltemporaryfile__handsoff)|Call this method to disassociate the file from the `CAtlTemporaryFile` object.|  \n|[CAtlTemporaryFile::HandsOn](#catltemporaryfile__handson)|Call this method to open an existing temporary file and position the pointer at the end of the file.|  \n|[CAtlTemporaryFile::LockRange](#catltemporaryfile__lockrange)|Call this method to lock a region in the file to prevent other processes from accessing it.|  \n|[CAtlTemporaryFile::Read](#catltemporaryfile__read)|Call this method to read data from the temporary file starting at the position indicated by the file pointer.|  \n|[CAtlTemporaryFile::Seek](#catltemporaryfile__seek)|Call this method to move the file pointer of the temporary file.|  \n|[CAtlTemporaryFile::SetSize](#catltemporaryfile__setsize)|Call this method to set the size of the temporary file.|  \n|[CAtlTemporaryFile::TempFileName](#catltemporaryfile__tempfilename)|Call this method to return the name of the temporary file.|  \n|[CAtlTemporaryFile::UnlockRange](#catltemporaryfile__unlockrange)|Call this method to unlock a region of the temporary file.|  \n|[CAtlTemporaryFile::Write](#catltemporaryfile__write)|Call this method to write data to the temporary file starting at the position indicated by the file pointer.|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlTemporaryFile::operator HANDLE](#catltemporaryfile__operator_handle)|Returns a handle to the temporary file.|  \n  \n## Remarks  \n `CAtlTemporaryFile` makes it easy to create and use a temporary file. The file is automatically named, opened, closed, and deleted. If the file contents are required after the file is closed, they can be saved to a new file with a specified name.  \n  \n## Requirements  \n **Header:** atlfile.h  \n  \n## Example  \n See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile).  \n  \n##  <a name=\"catltemporaryfile__catltemporaryfile\"></a>  CAtlTemporaryFile::CAtlTemporaryFile  \n The constructor.  \n  \n```\nCAtlTemporaryFile() throw();\n```  \n  \n### Remarks  \n A file is not actually opened until a call is made to [CAtlTemporaryFile::Create](#catltemporaryfile__create).  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#73](../../atl/codesnippet/cpp/catltemporaryfile-class_1.cpp)]  \n  \n##  <a name=\"catltemporaryfile___dtorcatltemporaryfile\"></a>  CAtlTemporaryFile::~CAtlTemporaryFile  \n The destructor.  \n  \n```\n~CAtlTemporaryFile() throw();\n```  \n  \n### Remarks  \n The destructor calls [CAtlTemporaryFile::Close](#catltemporaryfile__close).  \n  \n##  <a name=\"catltemporaryfile__close\"></a>  CAtlTemporaryFile::Close  \n Call this method to close a temporary file and either delete its contents or store them under the specified file name.  \n  \n```\nHRESULT Close(LPCTSTR szNewName = NULL) throw();\n```  \n  \n### Parameters  \n *szNewName*  \n The name for the new file to store the contents of the temporary file in. If this argument is NULL, the contents of the temporary file are deleted.  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Example  \n See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile).  \n  \n##  <a name=\"catltemporaryfile__create\"></a>  CAtlTemporaryFile::Create  \n Call this method to create a temporary file.  \n  \n```\nHRESULT Create(LPCTSTR pszDir = NULL,  DWORD dwDesiredAccess = GENERIC_WRITE) throw();\n```  \n  \n### Parameters  \n `pszDir`  \n The path for the temporary file. If this is NULL, [GetTempPath](http://msdn.microsoft.com/library/windows/desktop/aa364992) will be called to assign a path.  \n  \n `dwDesiredAccess`  \n The desired access. See `dwDesiredAccess` in [CreateFile](http://msdn.microsoft.com/library/windows/desktop/aa363858) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Example  \n See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile).  \n  \n##  <a name=\"catltemporaryfile__flush\"></a>  CAtlTemporaryFile::Flush  \n Call this method to force any data remaining in the file buffer to be written to the temporary file.  \n  \n```\nHRESULT Flush() throw();\n```  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n Similar to [CAtlTemporaryFile::HandsOff](#catltemporaryfile__handsoff), except that the file is not closed.  \n  \n### Example  \n See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile).  \n  \n##  <a name=\"catltemporaryfile__getposition\"></a>  CAtlTemporaryFile::GetPosition  \n Call this method to get the current file pointer position.  \n  \n```\nHRESULT GetPosition(ULONGLONG& nPos) const throw();\n```  \n  \n### Parameters  \n `nPos`  \n The position in bytes.  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n To change the file pointer position, use [CAtlTemporaryFile::Seek](#catltemporaryfile__seek).  \n  \n##  <a name=\"catltemporaryfile__getsize\"></a>  CAtlTemporaryFile::GetSize  \n Call this method to get the size in bytes of the temporary file.  \n  \n```\nHRESULT GetSize(ULONGLONG& nLen) const throw();\n```  \n  \n### Parameters  \n `nLen`  \n The number of bytes in the file.  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n##  <a name=\"catltemporaryfile__handsoff\"></a>  CAtlTemporaryFile::HandsOff  \n Call this method to disassociate the file from the `CAtlTemporaryFile` object.  \n  \n```\nHRESULT HandsOff() throw();\n```  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n `HandsOff` and [CAtlTemporaryFile::HandsOn](#catltemporaryfile__handson) are used to disassociate the file from the object, and reattach it if needed. `HandsOff` will force any data remaining in the file buffer to be written to the temporary file, and then close the file. If you want to close and delete the file permanently, or if you want to close and retain the contents of the file with a given name, use [CAtlTemporaryFile::Close](#catltemporaryfile__close).  \n  \n##  <a name=\"catltemporaryfile__handson\"></a>  CAtlTemporaryFile::HandsOn  \n Call this method to open an existing temporary file and position the pointer at the end of the file.  \n  \n```\nHRESULT HandsOn() throw();\n```  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n [CAtlTemporaryFile::HandsOff](#catltemporaryfile__handsoff) and `HandsOn` are used to disassociate the file from the object, and reattach it if needed.  \n  \n##  <a name=\"catltemporaryfile__lockrange\"></a>  CAtlTemporaryFile::LockRange  \n Call this method to lock a region in the temporary file to prevent other processes from accessing it.  \n  \n```\nHRESULT LockRange(ULONGLONG nPos,  ULONGLONG nCount) throw();\n```  \n  \n### Parameters  \n `nPos`  \n The position in the file where the lock should begin.  \n  \n `nCount`  \n The length of the byte range to be locked.  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n Locking bytes in a file prevents access to those bytes by other processes. You can lock more than one region of a file, but no overlapping regions are allowed. To successfully unlock a region, use [CAtlTemporaryFile::UnlockRange](#catltemporaryfile__unlockrange), ensuring the byte range corresponds exactly to the region that was previously locked. `LockRange` does not merge adjacent regions; if two locked regions are adjacent, you must unlock each separately.  \n  \n##  <a name=\"catltemporaryfile__operator_handle\"></a>  CAtlTemporaryFile::operator HANDLE  \n Returns a handle to the temporary file.  \n  \n```operator HANDLE() throw();\n```  \n  \n##  <a name=\"catltemporaryfile__read\"></a>  CAtlTemporaryFile::Read  \n Call this method to read data from the temporary file starting at the position indicated by the file pointer.  \n  \n```\nHRESULT Read(LPVOID pBuffer,\n    DWORD nBufSize,\n    DWORD& nBytesRead) throw();\n```  \n  \n### Parameters  \n `pBuffer`  \n Pointer to the buffer that will receive the data read from the file.  \n  \n `nBufSize`  \n The buffer size in bytes.  \n  \n `nBytesRead`  \n The number of bytes read.  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n Calls [CAtlFile::Read](../../atl/reference/catlfile-class.md#catlfile__read). To change the position of the file pointer, call [CAtlTemporaryFile::Seek](#catltemporaryfile__seek).  \n  \n### Example  \n See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile).  \n  \n##  <a name=\"catltemporaryfile__seek\"></a>  CAtlTemporaryFile::Seek  \n Call this method to move the file pointer of the temporary file.  \n  \n```\nHRESULT Seek(LONGLONG nOffset,  DWORD dwFrom = FILE_CURRENT) throw();\n```  \n  \n### Parameters  \n `nOffset`  \n The offset, in bytes, from the starting point given by *dwFrom.*  \n  \n `dwFrom`  \n The starting point (FILE_BEGIN, FILE_CURRENT, or FILE_END).  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n Calls [CAtlFile::Seek](../../atl/reference/catlfile-class.md#catlfile__seek). To obtain the current file pointer position, call [CAtlTemporaryFile::GetPosition](#catltemporaryfile__getposition).  \n  \n### Example  \n See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile).  \n  \n##  <a name=\"catltemporaryfile__setsize\"></a>  CAtlTemporaryFile::SetSize  \n Call this method to set the size of the temporary file.  \n  \n```\nHRESULT SetSize(ULONGLONG nNewLen) throw();\n```  \n  \n### Parameters  \n `nNewLen`  \n The new length of the file in bytes.  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n Calls [CAtlFile::SetSize](../../atl/reference/catlfile-class.md#catlfile__setsize). On return, the file pointer is positioned at the end of the file.  \n  \n##  <a name=\"catltemporaryfile__tempfilename\"></a>  CAtlTemporaryFile::TempFileName  \n Call this method to return the name of temporary file.  \n  \n```\nLPCTSTR TempFileName() throw();\n```  \n  \n### Return Value  \n Returns the `LPCTSTR` pointing to the file name.  \n  \n### Remarks  \n The file name is generated in [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile) with a call to the [GetTempFile](http://msdn.microsoft.com/library/windows/desktop/aa364991)[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] function. The file extension will always be \"TFR\" for the temporary file.  \n  \n##  <a name=\"catltemporaryfile__unlockrange\"></a>  CAtlTemporaryFile::UnlockRange  \n Call this method to unlock a region of the temporary file.  \n  \n```\nHRESULT UnlockRange(ULONGLONG nPos,  ULONGLONG nCount) throw();\n```  \n  \n### Parameters  \n `nPos`  \n The position in the file where the unlock should begin.  \n  \n `nCount`  \n The length of the byte range to be unlocked.  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n Calls [CAtlFile::UnlockRange](../../atl/reference/catlfile-class.md#catlfile__unlockrange).  \n  \n##  <a name=\"catltemporaryfile__write\"></a>  CAtlTemporaryFile::Write  \n Call this method to write data to the temporary file starting at the position indicated by the file pointer.  \n  \n```\nHRESULT Write(LPCVOID pBuffer,\n    DWORD nBufSize,\n    DWORD* pnBytesWritten = NULL) throw();\n```  \n  \n### Parameters  \n `pBuffer`  \n The buffer containing the data to be written to the file.  \n  \n `nBufSize`  \n The number of bytes to be transferred from the buffer.  \n  \n `pnBytesWritten`  \n The number of bytes written.  \n  \n### Return Value  \n Returns `S_OK` on success, or an error `HRESULT` on failure.  \n  \n### Remarks  \n Calls [CAtlFile::Write](../../atl/reference/catlfile-class.md#catlfile__write).  \n  \n### Example  \n See the example for [CAtlTemporaryFile::CAtlTemporaryFile](#catltemporaryfile__catltemporaryfile).  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)   \n [CAtlFile Class](../../atl/reference/catlfile-class.md)\n"}