{"nodes":[{"pos":[12,58],"content":"CSnapInPropertyPageImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CSnapInPropertyPageImpl Class | Microsoft Docs","pos":[0,46]}]},{"content":"CSnapInPropertyPageImpl Class","pos":[715,744]},{"content":"This class provides methods for implementing a snap-in property page object.","pos":[745,821]},{"pos":[829,939],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"content":"Syntax","pos":[948,954]},{"content":"Members","pos":[1025,1032]},{"content":"Public Constructors","pos":[1042,1061]},{"content":"Name","pos":[1068,1072]},{"content":"Description","pos":[1073,1084]},{"content":"CSnapInPropertyPageImpl::CSnapInPropertyPageImpl","pos":[1123,1171]},{"content":"Constructor.","pos":[1224,1236]},{"content":"Public Methods","pos":[1247,1261]},{"content":"Name","pos":[1268,1272]},{"content":"Description","pos":[1273,1284]},{"content":"CSnapInPropertyPageImpl::CancelToClose","pos":[1323,1361]},{"pos":[1404,1460],"content":"Changes the status of the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Cancel<ept id=\"p2\">**</ept> buttons.","source":"Changes the status of the **OK** and **Cancel** buttons."},{"content":"CSnapInPropertyPageImpl::Create","pos":[1466,1497]},{"pos":[1533,1594],"content":"Initializes a newly created <ph id=\"ph1\">`CSnapInPropertyPageImpl`</ph> object.","source":"Initializes a newly created `CSnapInPropertyPageImpl` object."},{"content":"CSnapInPropertyPageImpl::OnApply","pos":[1600,1632]},{"pos":[1669,1780],"content":"Called by the framework when the user clicks the <bpt id=\"p1\">**</bpt>Apply Now<ept id=\"p1\">**</ept> button while using a wizard-type property sheet.","source":"Called by the framework when the user clicks the **Apply Now** button while using a wizard-type property sheet."},{"content":"CSnapInPropertyPageImpl::OnHelp","pos":[1786,1817]},{"pos":[1853,1959],"content":"Called by the framework when the user clicks the <bpt id=\"p1\">**</bpt>Help<ept id=\"p1\">**</ept> button while using a wizard-type property sheet.","source":"Called by the framework when the user clicks the **Help** button while using a wizard-type property sheet."},{"content":"CSnapInPropertyPageImpl::OnKillActive","pos":[1965,2002]},{"content":"Called by the framework when the current page is no longer active.","pos":[2044,2110]},{"content":"CSnapInPropertyPageImpl::OnQueryCancel","pos":[2116,2154]},{"pos":[2197,2302],"content":"Called by the framework when the user clicks the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button and before the cancel has taken place.","source":"Called by the framework when the user clicks the **Cancel** button and before the cancel has taken place."},{"content":"CSnapInPropertyPageImpl::OnReset","pos":[2308,2340]},{"pos":[2377,2484],"content":"Called by the framework when the user clicks the <bpt id=\"p1\">**</bpt>Reset<ept id=\"p1\">**</ept> button while using a wizard-type property sheet.","source":"Called by the framework when the user clicks the **Reset** button while using a wizard-type property sheet."},{"content":"CSnapInPropertyPageImpl::OnSetActive","pos":[2490,2526]},{"content":"Called by the framework when the current page becomes active.","pos":[2567,2628]},{"content":"CSnapInPropertyPageImpl::OnWizardBack","pos":[2634,2671]},{"pos":[2713,2819],"content":"Called by the framework when the user clicks the <bpt id=\"p1\">**</bpt>Back<ept id=\"p1\">**</ept> button while using a wizard-type property sheet.","source":"Called by the framework when the user clicks the **Back** button while using a wizard-type property sheet."},{"content":"CSnapInPropertyPageImpl::OnWizardFinish","pos":[2825,2864]},{"pos":[2908,3016],"content":"Called by the framework when the user clicks the <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> button while using a wizard-type property sheet.","source":"Called by the framework when the user clicks the **Finish** button while using a wizard-type property sheet."},{"content":"CSnapInPropertyPageImpl::OnWizardNext","pos":[3022,3059]},{"pos":[3101,3205],"content":"Called by the framework when the user clicks the <ph id=\"ph1\">`Next`</ph> button while using a wizard-type property sheet.","source":"Called by the framework when the user clicks the `Next` button while using a wizard-type property sheet."},{"content":"CSnapInPropertyPageImpl::QuerySiblings","pos":[3211,3249]},{"content":"Forwards the current message to all pages of the property sheet.","pos":[3292,3356]},{"content":"CSnapInPropertyPageImpl::SetModified","pos":[3362,3398]},{"pos":[3439,3495],"content":"Call to activate or deactivate the <bpt id=\"p1\">**</bpt>Apply Now<ept id=\"p1\">**</ept> button.","source":"Call to activate or deactivate the **Apply Now** button."},{"content":"Public Data Members","pos":[3506,3525]},{"content":"Name","pos":[3532,3536]},{"content":"Description","pos":[3537,3548]},{"content":"CSnapInPropertyPageImpl::m_psp","pos":[3587,3617]},{"pos":[3652,3737],"content":"The Windows <bpt id=\"p1\">**</bpt>PROPSHEETPAGE<ept id=\"p1\">**</ept> structure used by the <ph id=\"ph1\">`CSnapInPropertyPageImpl`</ph> object.","source":"The Windows **PROPSHEETPAGE** structure used by the `CSnapInPropertyPageImpl` object."},{"content":"Remarks","pos":[3747,3754]},{"content":"provides a basic implementation for a snap-in property page object.","pos":[3784,3851]},{"content":"The basic features of a snap-in property page are implemented using several different interfaces and map types.","pos":[3852,3963]},{"content":"Inheritance Hierarchy","pos":[3972,3993]},{"content":"Requirements","pos":[4055,4067]},{"pos":[4071,4092],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlsnap.h","source":"**Header:** atlsnap.h"},{"pos":[4157,4195],"content":"CSnapInPropertyPageImpl::CancelToClose"},{"content":"Call this function after an unrecoverable change has been made to the data in a page of a modal property sheet.","pos":[4199,4310]},{"content":"Remarks","pos":[4355,4362]},{"content":"This function will change the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button to <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept> and disable the <bpt id=\"p3\">**</bpt>Cancel<ept id=\"p3\">**</ept> button.","pos":[4366,4457],"source":"This function will change the **OK** button to **Close** and disable the **Cancel** button."},{"content":"This change alerts the user that a change is permanent and the modifications cannot be cancelled.","pos":[4458,4555]},{"pos":[4562,4720],"content":"The <ph id=\"ph1\">`CancelToClose`</ph> member function does nothing in a modeless property sheet, because a modeless property sheet does not have a <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button by default.","source":"The `CancelToClose` member function does nothing in a modeless property sheet, because a modeless property sheet does not have a **Cancel** button by default."},{"pos":[4795,4843],"content":"CSnapInPropertyPageImpl::CSnapInPropertyPageImpl"},{"pos":[4847,4893],"content":"Constructs a <ph id=\"ph1\">`CSnapInPropertyPageImpl`</ph> object.","source":"Constructs a `CSnapInPropertyPageImpl` object."},{"content":"Parameters","pos":[4967,4977]},{"content":"[in] The title of the property page.","pos":[4996,5032]},{"content":"Remarks","pos":[5042,5049]},{"pos":[5053,5166],"content":"To initialize the underlying structure, call <bpt id=\"p1\">[</bpt>CSnapInPropertyPageImpl::Create<ept id=\"p1\">](#csnapinpropertypageimpl__create)</ept>.","source":"To initialize the underlying structure, call [CSnapInPropertyPageImpl::Create](#csnapinpropertypageimpl__create)."},{"pos":[5224,5255],"content":"CSnapInPropertyPageImpl::Create"},{"content":"Call this function to initialize the underlying structure of the property page.","pos":[5259,5338]},{"content":"Return Value","pos":[5386,5398]},{"pos":[5402,5506],"content":"A handle to a <bpt id=\"p1\">**</bpt>PROPSHEETPAGE<ept id=\"p1\">**</ept> structure containing the attributes of the newly created property sheet.","source":"A handle to a **PROPSHEETPAGE** structure containing the attributes of the newly created property sheet."},{"content":"Remarks","pos":[5516,5523]},{"pos":[5527,5680],"content":"You should first call <bpt id=\"p1\">[</bpt>CSnapInPropertyPageImpl::CSnapInPropertyPageImpl<ept id=\"p1\">](#csnapinpropertypageimpl__csnapinpropertypageimpl)</ept> before calling this function.","source":"You should first call [CSnapInPropertyPageImpl::CSnapInPropertyPageImpl](#csnapinpropertypageimpl__csnapinpropertypageimpl) before calling this function."},{"pos":[5737,5767],"content":"CSnapInPropertyPageImpl::m_psp"},{"pos":[5779,5855],"content":"is a structure whose members store the characteristics of <bpt id=\"p1\">**</bpt>PROPSHEETPAGE<ept id=\"p1\">**</ept>.","source":" is a structure whose members store the characteristics of **PROPSHEETPAGE**."},{"content":"Remarks","pos":[5899,5906]},{"content":"Use this structure to initialize the appearance of a property page after it is constructed.","pos":[5910,6001]},{"pos":[6008,6207],"content":"For more information on this structure, including a listing of its members, see <bpt id=\"p1\">[</bpt>PROPSHEETPAGE<ept id=\"p1\">](http://msdn.microsoft.com/library/aa815151)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on this structure, including a listing of its members, see [PROPSHEETPAGE](http://msdn.microsoft.com/library/aa815151) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6266,6298],"content":"CSnapInPropertyPageImpl::OnApply"},{"pos":[6302,6393],"content":"This member function is called when the user clicks the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> or the <bpt id=\"p2\">**</bpt>Apply Now<ept id=\"p2\">**</ept> button.","source":"This member function is called when the user clicks the **OK** or the **Apply Now** button."},{"content":"Return Value","pos":[6432,6444]},{"content":"Nonzero if the changes are accepted; otherwise 0.","pos":[6448,6497]},{"content":"Remarks","pos":[6507,6514]},{"content":"Before <ph id=\"ph1\">`OnApply`</ph> can be called by the framework, you must have called <ph id=\"ph2\">`SetModified`</ph> and set its parameter to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>.","pos":[6518,6636],"source":"Before `OnApply` can be called by the framework, you must have called `SetModified` and set its parameter to **TRUE**."},{"content":"This will activate the <bpt id=\"p1\">**</bpt>Apply Now<ept id=\"p1\">**</ept> button as soon as the user makes a change on the property page.","pos":[6637,6737],"source":" This will activate the **Apply Now** button as soon as the user makes a change on the property page."},{"content":"Override this member function to specify what action your program takes when the user clicks the <bpt id=\"p1\">**</bpt>Apply Now<ept id=\"p1\">**</ept> button.","pos":[6744,6862],"source":"Override this member function to specify what action your program takes when the user clicks the **Apply Now** button."},{"content":"When overriding, the function should return <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> to accept changes and <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> to prevent changes from taking effect.","pos":[6863,6986],"source":" When overriding, the function should return **TRUE** to accept changes and **FALSE** to prevent changes from taking effect."},{"pos":[6993,7050],"content":"The default implementation of <ph id=\"ph1\">`OnApply`</ph> returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>.","source":"The default implementation of `OnApply` returns **TRUE**."},{"pos":[7108,7139],"content":"CSnapInPropertyPageImpl::OnHelp"},{"pos":[7143,7237],"content":"This member function is called when the user clicks the <bpt id=\"p1\">**</bpt>Help<ept id=\"p1\">**</ept> button for the property page.","source":"This member function is called when the user clicks the **Help** button for the property page."},{"content":"Remarks","pos":[7275,7282]},{"content":"Override this member function to display help for the property page.","pos":[7286,7354]},{"pos":[7418,7455],"content":"CSnapInPropertyPageImpl::OnKillActive"},{"content":"This member function is called when the page is no longer the active page.","pos":[7459,7533]},{"content":"Return Value","pos":[7577,7589]},{"content":"Nonzero if data was updated successfully; otherwise 0.","pos":[7593,7647]},{"content":"Remarks","pos":[7657,7664]},{"content":"Override this member function to perform special data validation tasks.","pos":[7668,7739]},{"pos":[7804,7842],"content":"CSnapInPropertyPageImpl::OnQueryCancel"},{"pos":[7846,7965],"content":"This member function is called when the user clicks the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button and before the cancel action has taken place.","source":"This member function is called when the user clicks the **Cancel** button and before the cancel action has taken place."},{"content":"Return Value","pos":[8010,8022]},{"content":"Nonzero to allow the cancel operation; otherwise 0.","pos":[8026,8077]},{"content":"Remarks","pos":[8087,8094]},{"pos":[8098,8210],"content":"Override this member function to specify an action the program takes when the user clicks the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button.","source":"Override this member function to specify an action the program takes when the user clicks the **Cancel** button."},{"pos":[8217,8280],"content":"The default implementation of <ph id=\"ph1\">`OnQueryCancel`</ph> returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>.","source":"The default implementation of `OnQueryCancel` returns **TRUE**."},{"pos":[8339,8371],"content":"CSnapInPropertyPageImpl::OnReset"},{"pos":[8375,8449],"content":"This member function is called when the user clicks the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button.","source":"This member function is called when the user clicks the **Cancel** button."},{"content":"Remarks","pos":[8488,8495]},{"pos":[8499,8683],"content":"When this function is called, changes to all property pages that were made by the user previously clicking the <bpt id=\"p1\">**</bpt>Apply Now<ept id=\"p1\">**</ept> button are discarded, and the property sheet retains focus.","source":"When this function is called, changes to all property pages that were made by the user previously clicking the **Apply Now** button are discarded, and the property sheet retains focus."},{"pos":[8690,8804],"content":"Override this member function to specify what action the program takes when the user clicks the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> button.","source":"Override this member function to specify what action the program takes when the user clicks the **Cancel** button."},{"pos":[8867,8903],"content":"CSnapInPropertyPageImpl::OnSetActive"},{"content":"This member function is called when the page is chosen by the user and becomes the active page.","pos":[8907,9002]},{"content":"Return Value","pos":[9045,9057]},{"content":"Nonzero if the page was successfully set active; otherwise 0.","pos":[9061,9122]},{"content":"Remarks","pos":[9132,9139]},{"content":"Override this member function to perform tasks when a page is activated.","pos":[9143,9215]},{"content":"Your override of this member function should call the default version before any other processing is done.","pos":[9216,9322]},{"pos":[9329,9373],"content":"The default implementation returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>.","source":"The default implementation returns **TRUE**."},{"pos":[9437,9474],"content":"CSnapInPropertyPageImpl::OnWizardBack"},{"pos":[9478,9562],"content":"This member function is called when the user clicks the <bpt id=\"p1\">**</bpt>Back<ept id=\"p1\">**</ept> button in a wizard.","source":"This member function is called when the user clicks the **Back** button in a wizard."},{"content":"Return Value","pos":[9606,9618]},{"content":"0 to automatically advance to the previous page.","pos":[9628,9676]},{"content":"–1 to prevent the page from changing.","pos":[9686,9723]},{"content":"To jump to a page other than the next one, return the identifier of the dialog box to be displayed.","pos":[9730,9829]},{"content":"Remarks","pos":[9839,9846]},{"pos":[9850,9958],"content":"Override this member function to specify some action the user must take when the <bpt id=\"p1\">**</bpt>Back<ept id=\"p1\">**</ept> button is clicked.","source":"Override this member function to specify some action the user must take when the **Back** button is clicked."},{"pos":[10024,10063],"content":"CSnapInPropertyPageImpl::OnWizardFinish"},{"pos":[10067,10153],"content":"This member function is called when the user clicks the <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> button in a wizard.","source":"This member function is called when the user clicks the **Finish** button in a wizard."},{"content":"Return Value","pos":[10199,10211]},{"content":"Nonzero if the property sheet is destroyed when the wizard finishes; otherwise zero.","pos":[10215,10299]},{"content":"Remarks","pos":[10309,10316]},{"pos":[10320,10430],"content":"Override this member function to specify some action the user must take when the <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> button is clicked.","source":"Override this member function to specify some action the user must take when the **Finish** button is clicked."},{"pos":[10494,10531],"content":"CSnapInPropertyPageImpl::OnWizardNext"},{"pos":[10535,10617],"content":"This member function is called when the user clicks the <ph id=\"ph1\">`Next`</ph> button in a wizard.","source":"This member function is called when the user clicks the `Next` button in a wizard."},{"content":"Return Value","pos":[10661,10673]},{"content":"0 to automatically advance to the next page.","pos":[10683,10727]},{"content":"–1 to prevent the page from changing.","pos":[10737,10774]},{"content":"To jump to a page other than the next one, return the identifier of the dialog box to be displayed.","pos":[10781,10880]},{"content":"Remarks","pos":[10890,10897]},{"pos":[10901,11007],"content":"Override this member function to specify some action the user must take when the <ph id=\"ph1\">`Next`</ph> button is clicked.","source":"Override this member function to specify some action the user must take when the `Next` button is clicked."},{"pos":[11072,11110],"content":"CSnapInPropertyPageImpl::QuerySiblings"},{"content":"Call this member function to forward a message to each page in the property sheet.","pos":[11114,11196]},{"content":"Parameters","pos":[11273,11283]},{"content":"[in] Specifies additional message-dependent information.","pos":[11299,11355]},{"content":"[in] Specifies additional message-dependent information.","pos":[11374,11430]},{"content":"Return Value","pos":[11440,11452]},{"content":"Nonzero if the message should not be forwarded to the next property page; otherwise zero.","pos":[11456,11545]},{"content":"Remarks","pos":[11555,11562]},{"content":"If a page returns a nonzero value, the property sheet does not send the message to subsequent pages.","pos":[11566,11666]},{"pos":[11729,11765],"content":"CSnapInPropertyPageImpl::SetModified"},{"pos":[11769,11946],"content":"Call this member function to enable or disable the <bpt id=\"p1\">**</bpt>Apply Now<ept id=\"p1\">**</ept> button, based on whether the settings in the property page should be applied to the appropriate external object.","source":"Call this member function to enable or disable the **Apply Now** button, based on whether the settings in the property page should be applied to the appropriate external object."},{"content":"Parameters","pos":[12009,12019]},{"content":"[in] <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> to indicate that the property page settings have been modified since the last time they were applied; <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> to indicate that the property page settings have been applied, or should be ignored.","pos":[12037,12247],"source":" [in] **TRUE** to indicate that the property page settings have been modified since the last time they were applied; **FALSE** to indicate that the property page settings have been applied, or should be ignored."},{"content":"Remarks","pos":[12257,12264]},{"content":"The property sheet keeps track of which pages are \"dirty,\" that is, property pages for which you have called <bpt id=\"p1\">**</bpt>SetModified( TRUE )<ept id=\"p1\">**</ept>.","pos":[12268,12401],"source":"The property sheet keeps track of which pages are \"dirty,\" that is, property pages for which you have called **SetModified( TRUE )**."},{"content":"The <bpt id=\"p1\">**</bpt>Apply Now<ept id=\"p1\">**</ept> button will always be enabled if you call <bpt id=\"p2\">**</bpt>SetModified( TRUE )<ept id=\"p2\">**</ept> for one of the pages.","pos":[12402,12507],"source":" The **Apply Now** button will always be enabled if you call **SetModified( TRUE )** for one of the pages."},{"content":"The <bpt id=\"p1\">**</bpt>Apply Now<ept id=\"p1\">**</ept> button will be disabled when you call <bpt id=\"p2\">**</bpt>SetModified( FALSE )<ept id=\"p2\">**</ept> for one of the pages, but only if none of the other pages is \"dirty.\"","pos":[12508,12658],"source":" The **Apply Now** button will be disabled when you call **SetModified( FALSE )** for one of the pages, but only if none of the other pages is \"dirty.\""},{"content":"See Also","pos":[12667,12675]},{"content":"Class Overview","pos":[12680,12694]}],"content":"---\ntitle: \"CSnapInPropertyPageImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CSnapInPropertyPageImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"snap-ins, property pages\"\n  - \"snap-ins\"\n  - \"property pages, ATL\"\n  - \"CSnapInPropertyPageImpl class\"\nms.assetid: 75bdce5a-985e-4166-bd44-493132e023c4\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CSnapInPropertyPageImpl Class\nThis class provides methods for implementing a snap-in property page object.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\nCSnapInPropertyPageImpl : public CDialogImplBase\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CSnapInPropertyPageImpl::CSnapInPropertyPageImpl](#csnapinpropertypageimpl__csnapinpropertypageimpl)|Constructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CSnapInPropertyPageImpl::CancelToClose](#csnapinpropertypageimpl__canceltoclose)|Changes the status of the **OK** and **Cancel** buttons.|  \n|[CSnapInPropertyPageImpl::Create](#csnapinpropertypageimpl__create)|Initializes a newly created `CSnapInPropertyPageImpl` object.|  \n|[CSnapInPropertyPageImpl::OnApply](#csnapinpropertypageimpl__onapply)|Called by the framework when the user clicks the **Apply Now** button while using a wizard-type property sheet.|  \n|[CSnapInPropertyPageImpl::OnHelp](#csnapinpropertypageimpl__onhelp)|Called by the framework when the user clicks the **Help** button while using a wizard-type property sheet.|  \n|[CSnapInPropertyPageImpl::OnKillActive](#csnapinpropertypageimpl__onkillactive)|Called by the framework when the current page is no longer active.|  \n|[CSnapInPropertyPageImpl::OnQueryCancel](#csnapinpropertypageimpl__onquerycancel)|Called by the framework when the user clicks the **Cancel** button and before the cancel has taken place.|  \n|[CSnapInPropertyPageImpl::OnReset](#csnapinpropertypageimpl__onreset)|Called by the framework when the user clicks the **Reset** button while using a wizard-type property sheet.|  \n|[CSnapInPropertyPageImpl::OnSetActive](#csnapinpropertypageimpl__onsetactive)|Called by the framework when the current page becomes active.|  \n|[CSnapInPropertyPageImpl::OnWizardBack](#csnapinpropertypageimpl__onwizardback)|Called by the framework when the user clicks the **Back** button while using a wizard-type property sheet.|  \n|[CSnapInPropertyPageImpl::OnWizardFinish](#csnapinpropertypageimpl__onwizardfinish)|Called by the framework when the user clicks the **Finish** button while using a wizard-type property sheet.|  \n|[CSnapInPropertyPageImpl::OnWizardNext](#csnapinpropertypageimpl__onwizardnext)|Called by the framework when the user clicks the `Next` button while using a wizard-type property sheet.|  \n|[CSnapInPropertyPageImpl::QuerySiblings](#csnapinpropertypageimpl__querysiblings)|Forwards the current message to all pages of the property sheet.|  \n|[CSnapInPropertyPageImpl::SetModified](#csnapinpropertypageimpl__setmodified)|Call to activate or deactivate the **Apply Now** button.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CSnapInPropertyPageImpl::m_psp](#csnapinpropertypageimpl__m_psp)|The Windows **PROPSHEETPAGE** structure used by the `CSnapInPropertyPageImpl` object.|  \n  \n## Remarks  \n `CSnapInPropertyPageImpl` provides a basic implementation for a snap-in property page object. The basic features of a snap-in property page are implemented using several different interfaces and map types.  \n  \n## Inheritance Hierarchy  \n `CDialogImplBase`  \n  \n `CSnapInPropertyPageImpl`  \n  \n## Requirements  \n **Header:** atlsnap.h  \n  \n##  <a name=\"csnapinpropertypageimpl__canceltoclose\"></a>  CSnapInPropertyPageImpl::CancelToClose  \n Call this function after an unrecoverable change has been made to the data in a page of a modal property sheet.  \n  \n```\nvoid CancelToClose();\n```  \n  \n### Remarks  \n This function will change the **OK** button to **Close** and disable the **Cancel** button. This change alerts the user that a change is permanent and the modifications cannot be cancelled.  \n  \n The `CancelToClose` member function does nothing in a modeless property sheet, because a modeless property sheet does not have a **Cancel** button by default.  \n  \n##  <a name=\"csnapinpropertypageimpl__csnapinpropertypageimpl\"></a>  CSnapInPropertyPageImpl::CSnapInPropertyPageImpl  \n Constructs a `CSnapInPropertyPageImpl` object.  \n  \n```\nCSnapInPropertyPageImpl(LPCTSTR lpszTitle = NULL);\n```  \n  \n### Parameters  \n `lpszTitle`  \n [in] The title of the property page.  \n  \n### Remarks  \n To initialize the underlying structure, call [CSnapInPropertyPageImpl::Create](#csnapinpropertypageimpl__create).  \n  \n##  <a name=\"csnapinpropertypageimpl__create\"></a>  CSnapInPropertyPageImpl::Create  \n Call this function to initialize the underlying structure of the property page.  \n  \n```\nHPROPSHEETPAGE Create();\n```  \n  \n### Return Value  \n A handle to a **PROPSHEETPAGE** structure containing the attributes of the newly created property sheet.  \n  \n### Remarks  \n You should first call [CSnapInPropertyPageImpl::CSnapInPropertyPageImpl](#csnapinpropertypageimpl__csnapinpropertypageimpl) before calling this function.  \n  \n##  <a name=\"csnapinpropertypageimpl__m_psp\"></a>  CSnapInPropertyPageImpl::m_psp  \n `m_psp` is a structure whose members store the characteristics of **PROPSHEETPAGE**.  \n  \n```\nPROPSHEETPAGE m_psp;\n```  \n  \n### Remarks  \n Use this structure to initialize the appearance of a property page after it is constructed.  \n  \n For more information on this structure, including a listing of its members, see [PROPSHEETPAGE](http://msdn.microsoft.com/library/aa815151) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"csnapinpropertypageimpl__onapply\"></a>  CSnapInPropertyPageImpl::OnApply  \n This member function is called when the user clicks the **OK** or the **Apply Now** button.  \n  \n```\nBOOL OnApply();\n```  \n  \n### Return Value  \n Nonzero if the changes are accepted; otherwise 0.  \n  \n### Remarks  \n Before `OnApply` can be called by the framework, you must have called `SetModified` and set its parameter to **TRUE**. This will activate the **Apply Now** button as soon as the user makes a change on the property page.  \n  \n Override this member function to specify what action your program takes when the user clicks the **Apply Now** button. When overriding, the function should return **TRUE** to accept changes and **FALSE** to prevent changes from taking effect.  \n  \n The default implementation of `OnApply` returns **TRUE**.  \n  \n##  <a name=\"csnapinpropertypageimpl__onhelp\"></a>  CSnapInPropertyPageImpl::OnHelp  \n This member function is called when the user clicks the **Help** button for the property page.  \n  \n```\nvoid OnHelp();\n```  \n  \n### Remarks  \n Override this member function to display help for the property page.  \n  \n##  <a name=\"csnapinpropertypageimpl__onkillactive\"></a>  CSnapInPropertyPageImpl::OnKillActive  \n This member function is called when the page is no longer the active page.  \n  \n```\nBOOL OnKillActive();\n```  \n  \n### Return Value  \n Nonzero if data was updated successfully; otherwise 0.  \n  \n### Remarks  \n Override this member function to perform special data validation tasks.  \n  \n##  <a name=\"csnapinpropertypageimpl__onquerycancel\"></a>  CSnapInPropertyPageImpl::OnQueryCancel  \n This member function is called when the user clicks the **Cancel** button and before the cancel action has taken place.  \n  \n```\nBOOL OnQueryCancel();\n```  \n  \n### Return Value  \n Nonzero to allow the cancel operation; otherwise 0.  \n  \n### Remarks  \n Override this member function to specify an action the program takes when the user clicks the **Cancel** button.  \n  \n The default implementation of `OnQueryCancel` returns **TRUE**.  \n  \n##  <a name=\"csnapinpropertypageimpl__onreset\"></a>  CSnapInPropertyPageImpl::OnReset  \n This member function is called when the user clicks the **Cancel** button.  \n  \n```\nvoid OnReset();\n```  \n  \n### Remarks  \n When this function is called, changes to all property pages that were made by the user previously clicking the **Apply Now** button are discarded, and the property sheet retains focus.  \n  \n Override this member function to specify what action the program takes when the user clicks the **Cancel** button.  \n  \n##  <a name=\"csnapinpropertypageimpl__onsetactive\"></a>  CSnapInPropertyPageImpl::OnSetActive  \n This member function is called when the page is chosen by the user and becomes the active page.  \n  \n```\nBOOL OnSetActive();\n```  \n  \n### Return Value  \n Nonzero if the page was successfully set active; otherwise 0.  \n  \n### Remarks  \n Override this member function to perform tasks when a page is activated. Your override of this member function should call the default version before any other processing is done.  \n  \n The default implementation returns **TRUE**.  \n  \n##  <a name=\"csnapinpropertypageimpl__onwizardback\"></a>  CSnapInPropertyPageImpl::OnWizardBack  \n This member function is called when the user clicks the **Back** button in a wizard.  \n  \n```\nBOOL OnWizardBack();\n```  \n  \n### Return Value  \n  \n-   0 to automatically advance to the previous page.  \n  \n-   –1 to prevent the page from changing.  \n  \n To jump to a page other than the next one, return the identifier of the dialog box to be displayed.  \n  \n### Remarks  \n Override this member function to specify some action the user must take when the **Back** button is clicked.  \n  \n##  <a name=\"csnapinpropertypageimpl__onwizardfinish\"></a>  CSnapInPropertyPageImpl::OnWizardFinish  \n This member function is called when the user clicks the **Finish** button in a wizard.  \n  \n```\nBOOL OnWizardFinish();\n```  \n  \n### Return Value  \n Nonzero if the property sheet is destroyed when the wizard finishes; otherwise zero.  \n  \n### Remarks  \n Override this member function to specify some action the user must take when the **Finish** button is clicked.  \n  \n##  <a name=\"csnapinpropertypageimpl__onwizardnext\"></a>  CSnapInPropertyPageImpl::OnWizardNext  \n This member function is called when the user clicks the `Next` button in a wizard.  \n  \n```\nBOOL OnWizardNext();\n```  \n  \n### Return Value  \n  \n-   0 to automatically advance to the next page.  \n  \n-   –1 to prevent the page from changing.  \n  \n To jump to a page other than the next one, return the identifier of the dialog box to be displayed.  \n  \n### Remarks  \n Override this member function to specify some action the user must take when the `Next` button is clicked.  \n  \n##  <a name=\"csnapinpropertypageimpl__querysiblings\"></a>  CSnapInPropertyPageImpl::QuerySiblings  \n Call this member function to forward a message to each page in the property sheet.  \n  \n```\nLRESULT QuerySiblings(WPARAM wParam,  LPARAM lParam);\n```  \n  \n### Parameters  \n `wParam`  \n [in] Specifies additional message-dependent information.  \n  \n `lParam`  \n [in] Specifies additional message-dependent information.  \n  \n### Return Value  \n Nonzero if the message should not be forwarded to the next property page; otherwise zero.  \n  \n### Remarks  \n If a page returns a nonzero value, the property sheet does not send the message to subsequent pages.  \n  \n##  <a name=\"csnapinpropertypageimpl__setmodified\"></a>  CSnapInPropertyPageImpl::SetModified  \n Call this member function to enable or disable the **Apply Now** button, based on whether the settings in the property page should be applied to the appropriate external object.  \n  \n```\nvoid SetModified(BOOL bChanged = TRUE);\n```  \n  \n### Parameters  \n `bChanged`  \n [in] **TRUE** to indicate that the property page settings have been modified since the last time they were applied; **FALSE** to indicate that the property page settings have been applied, or should be ignored.  \n  \n### Remarks  \n The property sheet keeps track of which pages are \"dirty,\" that is, property pages for which you have called **SetModified( TRUE )**. The **Apply Now** button will always be enabled if you call **SetModified( TRUE )** for one of the pages. The **Apply Now** button will be disabled when you call **SetModified( FALSE )** for one of the pages, but only if none of the other pages is \"dirty.\"  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}