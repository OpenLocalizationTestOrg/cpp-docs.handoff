{"nodes":[{"pos":[12,47],"content":"CDragListBox Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDragListBox Class | Microsoft Docs","pos":[0,35]}]},{"content":"CDragListBox Class","pos":[711,729]},{"pos":[730,900],"content":"In addition to providing the functionality of a Windows list box, the <ph id=\"ph1\">`CDragListBox`</ph> class allows the user to move list box items, such as filenames, within the list box.","source":"In addition to providing the functionality of a Windows list box, the `CDragListBox` class allows the user to move list box items, such as filenames, within the list box."},{"content":"Syntax","pos":[909,915]},{"content":"Members","pos":[978,985]},{"content":"Public Constructors","pos":[995,1014]},{"content":"Name","pos":[1021,1025]},{"content":"Description","pos":[1026,1037]},{"content":"CDragListBox::CDragListBox","pos":[1076,1102]},{"pos":[1133,1168],"content":"Constructs a <ph id=\"ph1\">`CDragListBox`</ph> object.","source":"Constructs a `CDragListBox` object."},{"content":"Public Methods","pos":[1179,1193]},{"content":"Name","pos":[1200,1204]},{"content":"Description","pos":[1205,1216]},{"content":"CDragListBox::BeginDrag","pos":[1255,1278]},{"content":"Called by the framework when a drag operation starts.","pos":[1306,1359]},{"content":"CDragListBox::CancelDrag","pos":[1365,1389]},{"content":"Called by the framework when a drag operation has been canceled.","pos":[1418,1482]},{"content":"CDragListBox::Dragging","pos":[1488,1510]},{"content":"Called by the framework during a drag operation.","pos":[1537,1585]},{"content":"CDragListBox::DrawInsert","pos":[1591,1615]},{"content":"Draws the insertion guide of the drag list box.","pos":[1644,1691]},{"content":"CDragListBox::Dropped","pos":[1697,1718]},{"content":"Called by the framework after the item has been dropped.","pos":[1744,1800]},{"content":"CDragListBox::ItemFromPt","pos":[1806,1830]},{"content":"Returns the coordinates of the item being dragged.","pos":[1859,1909]},{"content":"Remarks","pos":[1919,1926]},{"content":"List boxes with this capability allow users to order the items in a list in whatever manner is most useful to them.","pos":[1930,2045]},{"content":"By default, the list box will move the item to the new location in the list.","pos":[2046,2122]},{"content":"However, <ph id=\"ph1\">`CDragListBox`</ph> objects can be customized to copy items instead of moving them.","pos":[2123,2210],"source":" However, `CDragListBox` objects can be customized to copy items instead of moving them."},{"content":"The list box control associated with the <ph id=\"ph1\">`CDragListBox`</ph> class must not have the <bpt id=\"p1\">**</bpt>LBS_SORT<ept id=\"p1\">**</ept> or the <bpt id=\"p2\">**</bpt>LBS_MULTIPLESELECT<ept id=\"p2\">**</ept> style.","pos":[2217,2346],"source":"The list box control associated with the `CDragListBox` class must not have the **LBS_SORT** or the **LBS_MULTIPLESELECT** style."},{"content":"For a description of list box styles, see <bpt id=\"p1\">[</bpt>List-Box Styles<ept id=\"p1\">](../../mfc/reference/list-box-styles.md)</ept>.","pos":[2347,2447],"source":" For a description of list box styles, see [List-Box Styles](../../mfc/reference/list-box-styles.md)."},{"pos":[2454,2748],"content":"To use a drag list box in an existing dialog box of your application, add a list box control to your dialog template using the dialog editor and then assign a member variable (of Category <ph id=\"ph1\">`Control`</ph> and Variable Type <ph id=\"ph2\">`CDragListBox`</ph>) corresponding to the list box control in your dialog template.","source":"To use a drag list box in an existing dialog box of your application, add a list box control to your dialog template using the dialog editor and then assign a member variable (of Category `Control` and Variable Type `CDragListBox`) corresponding to the list box control in your dialog template."},{"pos":[2755,2944],"content":"For more information on assigning controls to member variables, see <bpt id=\"p1\">[</bpt>Shortcut for Defining Member Variables for Dialog Controls<ept id=\"p1\">](../../mfc/defining-member-variables-for-dialog-controls.md)</ept>.","source":"For more information on assigning controls to member variables, see [Shortcut for Defining Member Variables for Dialog Controls](../../mfc/defining-member-variables-for-dialog-controls.md)."},{"content":"Inheritance Hierarchy","pos":[2953,2974]},{"content":"CObject","pos":[2979,2986]},{"content":"CCmdTarget","pos":[3033,3043]},{"content":"CWnd","pos":[3093,3097]},{"content":"CListBox","pos":[3141,3149]},{"content":"Requirements","pos":[3219,3231]},{"pos":[3235,3255],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxcmn.h","source":"**Header:** afxcmn.h"},{"pos":[3305,3328],"content":"CDragListBox::BeginDrag"},{"content":"Called by the framework when an event occurs that could begin a drag operation, such as pressing the left mouse button.","pos":[3332,3451]},{"content":"Parameters","pos":[3511,3521]},{"content":"A <bpt id=\"p1\">[</bpt>CPoint<ept id=\"p1\">](../../atl-mfc-shared/reference/cpoint-class.md)</ept> object that contains the coordinates of the item being dragged.","pos":[3533,3655],"source":" A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object that contains the coordinates of the item being dragged."},{"content":"Return Value","pos":[3665,3677]},{"content":"Nonzero if dragging is allowed, otherwise 0.","pos":[3681,3725]},{"content":"Remarks","pos":[3735,3742]},{"content":"Override this function if you want to control what happens when a drag operation begins.","pos":[3746,3834]},{"content":"The default implementation captures the mouse and stays in drag mode until the user clicks the left or right mouse button or presses ESC, at which time the drag operation is canceled.","pos":[3835,4018]},{"pos":[4069,4093],"content":"CDragListBox::CancelDrag"},{"content":"Called by the framework when a drag operation has been canceled.","pos":[4097,4161]},{"content":"Parameters","pos":[4222,4232]},{"content":"A <bpt id=\"p1\">[</bpt>CPoint<ept id=\"p1\">](../../atl-mfc-shared/reference/cpoint-class.md)</ept> object that contains the coordinates of the item being dragged.","pos":[4244,4366],"source":" A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object that contains the coordinates of the item being dragged."},{"content":"Remarks","pos":[4376,4383]},{"content":"Override this function to handle any special processing for your list box control.","pos":[4387,4469]},{"pos":[4522,4548],"content":"CDragListBox::CDragListBox"},{"pos":[4552,4587],"content":"Constructs a <ph id=\"ph1\">`CDragListBox`</ph> object.","source":"Constructs a `CDragListBox` object."},{"pos":[4667,4689],"content":"CDragListBox::Dragging"},{"pos":[4693,4788],"content":"Called by the framework when a list box item is being dragged within the <ph id=\"ph1\">`CDragListBox`</ph> object.","source":"Called by the framework when a list box item is being dragged within the `CDragListBox` object."},{"content":"Parameters","pos":[4847,4857]},{"content":"A <bpt id=\"p1\">[</bpt>CPoint<ept id=\"p1\">](../../atl-mfc-shared/reference/cpoint-class.md)</ept> object that contains the x and y screen coordinates of the cursor.","pos":[4869,4994],"source":" A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object that contains the x and y screen coordinates of the cursor."},{"content":"Return Value","pos":[5004,5016]},{"content":"The resource ID of the cursor to be displayed.","pos":[5020,5066]},{"content":"The following values are possible:","pos":[5067,5101]},{"pos":[5125,5164],"content":"Indicates that the item will be copied."},{"pos":[5188,5226],"content":"Indicates that the item will be moved."},{"pos":[5250,5307],"content":"Indicates that the current drop target is not acceptable."},{"content":"Remarks","pos":[5317,5324]},{"content":"The default behavior returns <ph id=\"ph1\">`DL_MOVECURSOR`</ph>.","pos":[5328,5373],"source":"The default behavior returns `DL_MOVECURSOR`."},{"content":"Override this function if you want to provide additional functionality.","pos":[5374,5445]},{"pos":[5496,5520],"content":"CDragListBox::DrawInsert"},{"content":"Called by the framework to draw the insertion guide before the item with the indicated index.","pos":[5524,5617]},{"content":"Parameters","pos":[5678,5688]},{"content":"Zero-based index of the insertion point.","pos":[5703,5743]},{"content":"Remarks","pos":[5753,5760]},{"content":"A value of - 1 clears the insertion guide.","pos":[5764,5806]},{"content":"Override this function to modify the appearance or behavior of the insertion guide.","pos":[5807,5890]},{"pos":[5938,5959],"content":"CDragListBox::Dropped"},{"pos":[5963,6042],"content":"Called by the framework when an item is dropped within a <ph id=\"ph1\">`CDragListBox`</ph> object.","source":"Called by the framework when an item is dropped within a `CDragListBox` object."},{"content":"Parameters","pos":[6126,6136]},{"content":"nSrcIndex","pos":[6141,6150]},{"content":"Specifies the zero-based index of the dropped string.","pos":[6155,6208]},{"content":"A <bpt id=\"p1\">[</bpt>CPoint<ept id=\"p1\">](../../atl-mfc-shared/reference/cpoint-class.md)</ept> object that contains the coordinates of the drop site.","pos":[6223,6336],"source":" A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object that contains the coordinates of the drop site."},{"content":"Remarks","pos":[6346,6353]},{"content":"The default behavior copies the list box item and its data to the new location and then deletes the original item.","pos":[6357,6471]},{"content":"Override this function to customize the default behavior, such as enabling copies of list box items to be dragged to other locations within the list.","pos":[6472,6621]},{"pos":[6672,6696],"content":"CDragListBox::ItemFromPt"},{"pos":[6700,6789],"content":"Call this function to retrieve the zero-based index of the list box item located at <ph id=\"ph1\">`pt`</ph>.","source":"Call this function to retrieve the zero-based index of the list box item located at `pt`."},{"content":"Parameters","pos":[6886,6896]},{"content":"A <bpt id=\"p1\">[</bpt>CPoint<ept id=\"p1\">](../../atl-mfc-shared/reference/cpoint-class.md)</ept> object containing the coordinates of a point within the list box.","pos":[6908,7032],"source":" A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object containing the coordinates of a point within the list box."},{"content":"bAutoScroll","pos":[7040,7051]},{"content":"Nonzero if scrolling is allowed, otherwise 0.","pos":[7056,7101]},{"content":"Return Value","pos":[7111,7123]},{"content":"Zero-based index of the drag list box item.","pos":[7127,7170]},{"content":"See Also","pos":[7179,7187]},{"content":"MFC Sample TSTCON","pos":[7192,7209]},{"content":"CListBox Class","pos":[7245,7259]},{"content":"Hierarchy Chart","pos":[7305,7320]},{"content":"CListBox Class","pos":[7357,7371]}],"content":"---\ntitle: \"CDragListBox Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDragListBox\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"drag list box [C++]\"\n  - \"dragging list items\"\n  - \"CDragListBox class\"\n  - \"Windows [C++], list boxes\"\n  - \"list boxes\"\nms.assetid: fee20b42-60ae-4aa9-83f9-5a3d9b96e33b\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDragListBox Class\nIn addition to providing the functionality of a Windows list box, the `CDragListBox` class allows the user to move list box items, such as filenames, within the list box.  \n  \n## Syntax  \n  \n```  \nclass CDragListBox : public CListBox  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDragListBox::CDragListBox](#cdraglistbox__cdraglistbox)|Constructs a `CDragListBox` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDragListBox::BeginDrag](#cdraglistbox__begindrag)|Called by the framework when a drag operation starts.|  \n|[CDragListBox::CancelDrag](#cdraglistbox__canceldrag)|Called by the framework when a drag operation has been canceled.|  \n|[CDragListBox::Dragging](#cdraglistbox__dragging)|Called by the framework during a drag operation.|  \n|[CDragListBox::DrawInsert](#cdraglistbox__drawinsert)|Draws the insertion guide of the drag list box.|  \n|[CDragListBox::Dropped](#cdraglistbox__dropped)|Called by the framework after the item has been dropped.|  \n|[CDragListBox::ItemFromPt](#cdraglistbox__itemfrompt)|Returns the coordinates of the item being dragged.|  \n  \n## Remarks  \n List boxes with this capability allow users to order the items in a list in whatever manner is most useful to them. By default, the list box will move the item to the new location in the list. However, `CDragListBox` objects can be customized to copy items instead of moving them.  \n  \n The list box control associated with the `CDragListBox` class must not have the **LBS_SORT** or the **LBS_MULTIPLESELECT** style. For a description of list box styles, see [List-Box Styles](../../mfc/reference/list-box-styles.md).  \n  \n To use a drag list box in an existing dialog box of your application, add a list box control to your dialog template using the dialog editor and then assign a member variable (of Category `Control` and Variable Type `CDragListBox`) corresponding to the list box control in your dialog template.  \n  \n For more information on assigning controls to member variables, see [Shortcut for Defining Member Variables for Dialog Controls](../../mfc/defining-member-variables-for-dialog-controls.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CListBox](../../mfc/reference/clistbox-class.md)  \n  \n `CDragListBox`  \n  \n## Requirements  \n **Header:** afxcmn.h  \n  \n##  <a name=\"cdraglistbox__begindrag\"></a>  CDragListBox::BeginDrag  \n Called by the framework when an event occurs that could begin a drag operation, such as pressing the left mouse button.  \n  \n```  \nvirtual BOOL BeginDrag(CPoint pt);\n```  \n  \n### Parameters  \n `pt`  \n A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object that contains the coordinates of the item being dragged.  \n  \n### Return Value  \n Nonzero if dragging is allowed, otherwise 0.  \n  \n### Remarks  \n Override this function if you want to control what happens when a drag operation begins. The default implementation captures the mouse and stays in drag mode until the user clicks the left or right mouse button or presses ESC, at which time the drag operation is canceled.  \n  \n##  <a name=\"cdraglistbox__canceldrag\"></a>  CDragListBox::CancelDrag  \n Called by the framework when a drag operation has been canceled.  \n  \n```  \nvirtual void CancelDrag(CPoint pt);\n```  \n  \n### Parameters  \n `pt`  \n A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object that contains the coordinates of the item being dragged.  \n  \n### Remarks  \n Override this function to handle any special processing for your list box control.  \n  \n##  <a name=\"cdraglistbox__cdraglistbox\"></a>  CDragListBox::CDragListBox  \n Constructs a `CDragListBox` object.  \n  \n```  \nCDragListBox();\n```  \n  \n##  <a name=\"cdraglistbox__dragging\"></a>  CDragListBox::Dragging  \n Called by the framework when a list box item is being dragged within the `CDragListBox` object.  \n  \n```  \nvirtual UINT Dragging(CPoint pt);\n```  \n  \n### Parameters  \n `pt`  \n A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object that contains the x and y screen coordinates of the cursor.  \n  \n### Return Value  \n The resource ID of the cursor to be displayed. The following values are possible:  \n  \n- `DL_COPYCURSOR` Indicates that the item will be copied.  \n  \n- `DL_MOVECURSOR` Indicates that the item will be moved.  \n  \n- `DL_STOPCURSOR` Indicates that the current drop target is not acceptable.  \n  \n### Remarks  \n The default behavior returns `DL_MOVECURSOR`. Override this function if you want to provide additional functionality.  \n  \n##  <a name=\"cdraglistbox__drawinsert\"></a>  CDragListBox::DrawInsert  \n Called by the framework to draw the insertion guide before the item with the indicated index.  \n  \n```  \nvirtual void DrawInsert(int nItem);\n```  \n  \n### Parameters  \n `nItem`  \n Zero-based index of the insertion point.  \n  \n### Remarks  \n A value of - 1 clears the insertion guide. Override this function to modify the appearance or behavior of the insertion guide.  \n  \n##  <a name=\"cdraglistbox__dropped\"></a>  CDragListBox::Dropped  \n Called by the framework when an item is dropped within a `CDragListBox` object.  \n  \n```  \nvirtual void Dropped(\n    int nSrcIndex,  \n    CPoint pt);\n```  \n  \n### Parameters  \n *nSrcIndex*  \n Specifies the zero-based index of the dropped string.  \n  \n `pt`  \n A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object that contains the coordinates of the drop site.  \n  \n### Remarks  \n The default behavior copies the list box item and its data to the new location and then deletes the original item. Override this function to customize the default behavior, such as enabling copies of list box items to be dragged to other locations within the list.  \n  \n##  <a name=\"cdraglistbox__itemfrompt\"></a>  CDragListBox::ItemFromPt  \n Call this function to retrieve the zero-based index of the list box item located at `pt`.  \n  \n```  \nint ItemFromPt(\n    CPoint pt,  \n    BOOL bAutoScroll = TRUE) const;\n\n \n```  \n  \n### Parameters  \n `pt`  \n A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) object containing the coordinates of a point within the list box.  \n  \n *bAutoScroll*  \n Nonzero if scrolling is allowed, otherwise 0.  \n  \n### Return Value  \n Zero-based index of the drag list box item.  \n  \n## See Also  \n [MFC Sample TSTCON](../../visual-cpp-samples.md)   \n [CListBox Class](../../mfc/reference/clistbox-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CListBox Class](../../mfc/reference/clistbox-class.md)\n"}