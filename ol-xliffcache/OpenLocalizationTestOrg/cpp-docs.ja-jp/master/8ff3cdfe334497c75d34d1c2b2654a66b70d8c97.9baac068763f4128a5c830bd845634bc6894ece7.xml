{"nodes":[{"pos":[12,66],"content":"Registry and TypeLib Global Functions | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Registry and TypeLib Global Functions | Microsoft Docs","pos":[0,54]}]},{"pos":[625,662],"content":"Registry and TypeLib Global Functions","linkify":"Registry and TypeLib Global Functions","nodes":[{"content":"Registry and TypeLib Global Functions","pos":[0,37]}]},{"content":"These functions provide support for loading and registering a type library.","pos":[663,738]},{"pos":[746,914],"content":"[!IMPORTANT]\n The functions listed in the following tables cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"The functions listed in the following tables cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,166],"source":" The functions listed in the following tables cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"pos":[935,976],"content":"<bpt id=\"p1\">[</bpt>AtlRegisterTypeLib<ept id=\"p1\">](#atlregistertypelib)</ept>","source":"[AtlRegisterTypeLib](#atlregistertypelib)"},{"content":"This function is called to register a type library.","pos":[977,1028]},{"pos":[1033,1078],"content":"<bpt id=\"p1\">[</bpt>AtlUnRegisterTypeLib<ept id=\"p1\">](#atlunregistertypelib)</ept>","source":"[AtlUnRegisterTypeLib](#atlunregistertypelib)"},{"content":"This function is called to unregister a type library","pos":[1079,1131]},{"pos":[1136,1169],"content":"<bpt id=\"p1\">[</bpt>AtlLoadTypeLib<ept id=\"p1\">](#atlloadtypelib)</ept>","source":"[AtlLoadTypeLib](#atlloadtypelib)"},{"content":"This function is called to load a type library.","pos":[1170,1217]},{"pos":[1222,1287],"content":"<bpt id=\"p1\">[</bpt>AtlUpdateRegistryFromResourceD<ept id=\"p1\">](#atlupdateregistryfromresourced)</ept>","source":"[AtlUpdateRegistryFromResourceD](#atlupdateregistryfromresourced)"},{"content":"This function is called to update the registry from the supplied resource.","pos":[1288,1362]},{"pos":[1367,1412],"content":"<bpt id=\"p1\">[</bpt>RegistryDataExchange<ept id=\"p1\">](#registrydataexchange)</ept>","source":"[RegistryDataExchange](#registrydataexchange)"},{"content":"This function is called to read from, or write to, the system registry.","pos":[1413,1484]},{"content":"Called by the <bpt id=\"p1\">[</bpt>Registry Data Exchange Macros<ept id=\"p1\">](../../atl/reference/registry-data-exchange-macros.md)</ept>.","pos":[1485,1585],"source":" Called by the [Registry Data Exchange Macros](../../atl/reference/registry-data-exchange-macros.md)."},{"content":"These functions control which node in the registry the program uses to store information.","pos":[1593,1682]},{"pos":[1703,1758],"content":"<bpt id=\"p1\">[</bpt>AtlGetPerUserRegistration<ept id=\"p1\">](#atlgetperuserregistration)</ept>","source":"[AtlGetPerUserRegistration](#atlgetperuserregistration)"},{"pos":[1759,1865],"content":"Retrieves whether the application redirects registry access to the <bpt id=\"p1\">**</bpt>HKEY_CURRENT_USER<ept id=\"p1\">**</ept> ( <bpt id=\"p2\">**</bpt>HKCU<ept id=\"p2\">**</ept>) node.","source":"Retrieves whether the application redirects registry access to the **HKEY_CURRENT_USER** ( **HKCU**) node."},{"pos":[1870,1925],"content":"<bpt id=\"p1\">[</bpt>AtlSetPerUserRegistration<ept id=\"p1\">](#atlsetperuserregistration)</ept>","source":"[AtlSetPerUserRegistration](#atlsetperuserregistration)"},{"pos":[1926,2027],"content":"Sets whether the application redirects registry access to the <bpt id=\"p1\">**</bpt>HKEY_CURRENT_USER<ept id=\"p1\">**</ept> ( <bpt id=\"p2\">**</bpt>HKCU<ept id=\"p2\">**</ept>) node.","source":"Sets whether the application redirects registry access to the **HKEY_CURRENT_USER** ( **HKCU**) node."},{"pos":[2036,2102],"content":"<bpt id=\"p1\">&lt;a name=\"atlgetperuserregistration\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> AtlGetPerUserRegistration","linkify":"<a name=\"atlgetperuserregistration\"></a> AtlGetPerUserRegistration","source":"<a name=\"atlgetperuserregistration\"></a> AtlGetPerUserRegistration"},{"pos":[2103,2229],"content":"Use this function to determine whether the application redirects registry access to the <bpt id=\"p1\">**</bpt>HKEY_CURRENT_USER<ept id=\"p1\">**</ept> (<bpt id=\"p2\">**</bpt>HKCU<ept id=\"p2\">**</ept>) node.","source":"Use this function to determine whether the application redirects registry access to the **HKEY_CURRENT_USER** (**HKCU**) node."},{"pos":[2238,2244],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[2340,2350],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[out] <ph id=\"ph1\">`pEnabled`</ph>","pos":[2354,2370],"source":"[out] `pEnabled`"},{"content":"<ph id=\"ph1\"> `TRUE`</ph> indicates that the registry information is directed to the <bpt id=\"p1\">**</bpt>HKCU<ept id=\"p1\">**</ept> node; <ph id=\"ph2\">`FALSE`</ph> indicates that the application writes registry information to the default node.","pos":[2373,2542],"source":" `TRUE` indicates that the registry information is directed to the **HKCU** node; `FALSE` indicates that the application writes registry information to the default node."},{"content":"The default node is <bpt id=\"p1\">**</bpt>HKEY_CLASSES_ROOT<ept id=\"p1\">**</ept> (<bpt id=\"p2\">**</bpt>HKCR<ept id=\"p2\">**</ept>).","pos":[2543,2596],"source":" The default node is **HKEY_CLASSES_ROOT** (**HKCR**)."},{"pos":[2606,2618],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[2622,2712],"content":"<ph id=\"ph1\">`S_OK`</ph> if the method is successful, otherwise the <ph id=\"ph2\">`HRESULT`</ph> error code if an error occurs.","source":"`S_OK` if the method is successful, otherwise the `HRESULT` error code if an error occurs."},{"pos":[2722,2729],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Registry redirection is not enabled by default.","pos":[2733,2780]},{"content":"If you enable this option, registry access is redirected to <bpt id=\"p1\">**</bpt>HKEY_CURRENT_USER\\Software\\Classes<ept id=\"p1\">**</ept>.","pos":[2781,2880],"source":" If you enable this option, registry access is redirected to **HKEY_CURRENT_USER\\Software\\Classes**."},{"content":"The redirection is not global.","pos":[2887,2917]},{"content":"Only the MFC and ATL frameworks are affected by this registry redirection.","pos":[2918,2992]},{"pos":[3004,3057],"content":"<bpt id=\"p1\">&lt;a name=\"atlregistertypelib\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AtlRegisterTypeLib","linkify":"<a name=\"atlregistertypelib\"></a>  AtlRegisterTypeLib","source":"<a name=\"atlregistertypelib\"></a>  AtlRegisterTypeLib"},{"content":"This function is called to register a type library.","pos":[3061,3112]},{"pos":[3210,3220],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The handle to the module instance.","pos":[3242,3276]},{"content":"String in the format \"<ph id=\"ph1\">\\\\</ph>\\N\", where N is the integer index of the type library resource.","pos":[3298,3385],"source":" String in the format \"\\\\\\N\", where N is the integer index of the type library resource."},{"content":"Can be NULL if no index is required.","pos":[3386,3422]},{"pos":[3432,3444],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[3448,3504]},{"pos":[3514,3521],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3525,3774],"content":"This helper function is utilized by <bpt id=\"p1\">[</bpt>AtlComModuleUnregisterServer<ept id=\"p1\">](server-registration-global-functions.md#atlcommoduleunregisterserver)</ept> and <bpt id=\"p2\">[</bpt>CAtlComModule::RegisterTypeLib<ept id=\"p2\">](../../atl/reference/catlcommodule-class.md#catlcommodule__registertypelib)</ept>.","source":"This helper function is utilized by [AtlComModuleUnregisterServer](server-registration-global-functions.md#atlcommoduleunregisterserver) and [CAtlComModule::RegisterTypeLib](../../atl/reference/catlcommodule-class.md#catlcommodule__registertypelib)."},{"pos":[3783,3849],"content":"<bpt id=\"p1\">&lt;a name=\"atlsetperuserregistration\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept> AtlSetPerUserRegistration","linkify":"<a name=\"atlsetperuserregistration\"></a> AtlSetPerUserRegistration","source":"<a name=\"atlsetperuserregistration\"></a> AtlSetPerUserRegistration"},{"pos":[3850,3950],"content":"Sets whether the application redirects registry access to the <bpt id=\"p1\">**</bpt>HKEY_CURRENT_USER<ept id=\"p1\">**</ept> (<bpt id=\"p2\">**</bpt>HKCU<ept id=\"p2\">**</ept>) node.","source":"Sets whether the application redirects registry access to the **HKEY_CURRENT_USER** (**HKCU**) node."},{"pos":[3959,3965],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[4059,4069],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] <ph id=\"ph1\">`bEnable`</ph>","pos":[4073,4087],"source":"[in] `bEnable`"},{"content":"<ph id=\"ph1\"> `TRUE`</ph> indicates that the registry information is directed to the <bpt id=\"p1\">**</bpt>HKCU<ept id=\"p1\">**</ept> node; <ph id=\"ph2\">`FALSE`</ph> indicates that the application writes registry information to the default node.","pos":[4090,4259],"source":" `TRUE` indicates that the registry information is directed to the **HKCU** node; `FALSE` indicates that the application writes registry information to the default node."},{"content":"The default node is <bpt id=\"p1\">**</bpt>HKEY_CLASSES_ROOT<ept id=\"p1\">**</ept> (<bpt id=\"p2\">**</bpt>HKCR<ept id=\"p2\">**</ept>).","pos":[4260,4313],"source":" The default node is **HKEY_CLASSES_ROOT** (**HKCR**)."},{"pos":[4323,4335],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[4339,4429],"content":"<ph id=\"ph1\">`S_OK`</ph> if the method is successful, otherwise the <ph id=\"ph2\">`HRESULT`</ph> error code if an error occurs.","source":"`S_OK` if the method is successful, otherwise the `HRESULT` error code if an error occurs."},{"pos":[4439,4446],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Registry redirection is not enabled by default.","pos":[4450,4497]},{"content":"If you enable this option, registry access is redirected to <bpt id=\"p1\">**</bpt>HKEY_CURRENT_USER\\Software\\Classes<ept id=\"p1\">**</ept>.","pos":[4498,4597],"source":" If you enable this option, registry access is redirected to **HKEY_CURRENT_USER\\Software\\Classes**."},{"content":"The redirection is not global.","pos":[4604,4634]},{"content":"Only the MFC and ATL frameworks are affected by this registry redirection.","pos":[4635,4709]},{"pos":[4720,4777],"content":"<bpt id=\"p1\">&lt;a name=\"atlunregistertypelib\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AtlUnRegisterTypeLib","linkify":"<a name=\"atlunregistertypelib\"></a>  AtlUnRegisterTypeLib","source":"<a name=\"atlunregistertypelib\"></a>  AtlUnRegisterTypeLib"},{"content":"This function is called to unregister a type library.","pos":[4781,4834]},{"pos":[4938,4948],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The handle to the module instance.","pos":[4970,5004]},{"content":"String in the format \"<ph id=\"ph1\">\\\\</ph>\\N\", where N is the integer index of the type library resource.","pos":[5026,5113],"source":" String in the format \"\\\\\\N\", where N is the integer index of the type library resource."},{"content":"Can be NULL if no index is required.","pos":[5114,5150]},{"pos":[5160,5172],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[5176,5232]},{"pos":[5242,5249],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5253,5467],"content":"This helper function is utilized by <bpt id=\"p1\">[</bpt>CAtlComModule::UnRegisterTypeLib<ept id=\"p1\">](../../atl/reference/catlcommodule-class.md#catlcommodule__unregistertypelib)</ept> and <bpt id=\"p2\">[</bpt>AtlComModuleUnregisterServer<ept id=\"p2\">](#atlcommoduleunregisterserver)</ept>.","source":"This helper function is utilized by [CAtlComModule::UnRegisterTypeLib](../../atl/reference/catlcommodule-class.md#catlcommodule__unregistertypelib) and [AtlComModuleUnregisterServer](#atlcommoduleunregisterserver)."},{"pos":[5477,5522],"content":"<bpt id=\"p1\">&lt;a name=\"atlloadtypelib\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AtlLoadTypeLib","linkify":"<a name=\"atlloadtypelib\"></a>  AtlLoadTypeLib","source":"<a name=\"atlloadtypelib\"></a>  AtlLoadTypeLib"},{"content":"This function is called to load a type library.","pos":[5526,5573]},{"pos":[5731,5741],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Handle to the module associated with the type library.","pos":[5763,5817]},{"content":"String in the format \"<ph id=\"ph1\">\\\\</ph>\\N\", where N is the integer index of the type library resource.","pos":[5839,5926],"source":" String in the format \"\\\\\\N\", where N is the integer index of the type library resource."},{"content":"Can be NULL if no index is required.","pos":[5927,5963]},{"content":"<bpt id=\"p1\">*</bpt>pbstrPath<ept id=\"p1\">*</ept>","pos":[5970,5981],"source":"*pbstrPath*"},{"content":"On successful return, contains the full path of the module associated with the type library.","pos":[5985,6077]},{"content":"On successful return, contains a pointer to a pointer to the loaded type library.","pos":[6099,6180]},{"pos":[6190,6202],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[6206,6262]},{"pos":[6272,6279],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6283,6411],"content":"This helper function is utilized by <bpt id=\"p1\">[</bpt>AtlRegisterTypeLib<ept id=\"p1\">](#atlregistertypelib)</ept> and <bpt id=\"p2\">[</bpt>AtlUnRegisterTypeLib<ept id=\"p2\">](#atlunregistertypelib)</ept>.","source":"This helper function is utilized by [AtlRegisterTypeLib](#atlregistertypelib) and [AtlUnRegisterTypeLib](#atlunregistertypelib)."},{"pos":[6421,6498],"content":"<bpt id=\"p1\">&lt;a name=\"atlupdateregistryfromresourced\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AtlUpdateRegistryFromResourceD","linkify":"<a name=\"atlupdateregistryfromresourced\"></a>  AtlUpdateRegistryFromResourceD","source":"<a name=\"atlupdateregistryfromresourced\"></a>  AtlUpdateRegistryFromResourceD"},{"content":"This function was deprecated in Visual Studio 2013 and is removed in Visual Studio 2015.","pos":[6502,6590]},{"pos":[6623,6633],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"pos":[6643,6655],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[6665,6672],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6682,6739],"content":"<bpt id=\"p1\">&lt;a name=\"registrydataexchange\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  RegistryDataExchange","linkify":"<a name=\"registrydataexchange\"></a>  RegistryDataExchange","source":"<a name=\"registrydataexchange\"></a>  RegistryDataExchange"},{"content":"This function is called to read from, or write to, the system registry.","pos":[6743,6814]},{"pos":[6932,6942],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pT<ept id=\"p1\">*</ept>","pos":[6946,6950],"source":"*pT*"},{"content":"A pointer to the current object.","pos":[6954,6986]},{"content":"<bpt id=\"p1\">*</bpt>rdxOp<ept id=\"p1\">*</ept>","pos":[6993,7000],"source":"*rdxOp*"},{"content":"An enum value that indicates which operation the function should perform.","pos":[7004,7077]},{"content":"See the table in the Remarks section for the allowed values.","pos":[7078,7138]},{"content":"Pointer to the data that is to be read from, or written to, the registry.","pos":[7156,7229]},{"content":"The data can also represent a key to be deleted from the registry.","pos":[7230,7296]},{"content":"The default value is NULL.","pos":[7297,7323]},{"pos":[7333,7345],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[7349,7405]},{"pos":[7415,7422],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7426,7670],"content":"The macros <bpt id=\"p1\">[</bpt>BEGIN_RDX_MAP<ept id=\"p1\">](http://msdn.microsoft.com/library/95bbba6a-d550-4e36-8e6e-1c619d9e660d)</ept> and <bpt id=\"p2\">[</bpt>END_RDX_MAP<ept id=\"p2\">](http://msdn.microsoft.com/library/77efa3bd-ded7-430c-b5b4-2131a2d7e71d)</ept> expand to a function that calls <ph id=\"ph1\">`RegistryDataExchange`</ph>.","source":"The macros [BEGIN_RDX_MAP](http://msdn.microsoft.com/library/95bbba6a-d550-4e36-8e6e-1c619d9e660d) and [END_RDX_MAP](http://msdn.microsoft.com/library/77efa3bd-ded7-430c-b5b4-2131a2d7e71d) expand to a function that calls `RegistryDataExchange`."},{"content":"The possible enum values that indicate the operation the function should perform are shown in the following table:","pos":[7677,7791]},{"content":"Enum value","pos":[7798,7808]},{"content":"Operation","pos":[7809,7818]},{"content":"eReadFromReg","pos":[7860,7872]},{"content":"Read data from the registry.","pos":[7873,7901]},{"content":"eWriteToReg","pos":[7906,7917]},{"content":"Write data to the registry.","pos":[7918,7945]},{"content":"eDeleteFromReg","pos":[7950,7964]},{"content":"Delete the key from the registry.","pos":[7965,7998]},{"pos":[8009,8084],"content":"<bpt id=\"p1\">&lt;a name=\"registry_data_exchange_macros\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  Registry Data Exchange Macros","linkify":"<a name=\"registry_data_exchange_macros\"></a>  Registry Data Exchange Macros","source":"<a name=\"registry_data_exchange_macros\"></a>  Registry Data Exchange Macros"},{"content":"These macros perform Registry Data Exchange operations.","pos":[8088,8143]},{"pos":[8164,8251],"content":"<bpt id=\"p1\">[</bpt>BEGIN_RDX_MAP<ept id=\"p1\">](http://msdn.microsoft.com/library/95bbba6a-d550-4e36-8e6e-1c619d9e660d)</ept>","source":"[BEGIN_RDX_MAP](http://msdn.microsoft.com/library/95bbba6a-d550-4e36-8e6e-1c619d9e660d)"},{"content":"Marks the beginning of the Registry Data Exchange map.","pos":[8252,8306]},{"pos":[8311,8396],"content":"<bpt id=\"p1\">[</bpt>END_RDX_MAP<ept id=\"p1\">](http://msdn.microsoft.com/library/77efa3bd-ded7-430c-b5b4-2131a2d7e71d)</ept>","source":"[END_RDX_MAP](http://msdn.microsoft.com/library/77efa3bd-ded7-430c-b5b4-2131a2d7e71d)"},{"content":"Marks the end of the Registry Data Exchange map.","pos":[8397,8445]},{"pos":[8450,8534],"content":"<bpt id=\"p1\">[</bpt>RDX_BINARY<ept id=\"p1\">](http://msdn.microsoft.com/library/cc872cdb-fe5a-45cd-8ed8-00be54911f2a)</ept>","source":"[RDX_BINARY](http://msdn.microsoft.com/library/cc872cdb-fe5a-45cd-8ed8-00be54911f2a)"},{"content":"Associates the specified registry entry with a specified member variable of type BYTE.","pos":[8535,8621]},{"pos":[8626,8716],"content":"<bpt id=\"p1\">[</bpt>RDX_CSTRING_TEXT<ept id=\"p1\">](http://msdn.microsoft.com/library/897ac6dc-2700-4818-8327-3a779aa7bc6c)</ept>","source":"[RDX_CSTRING_TEXT](http://msdn.microsoft.com/library/897ac6dc-2700-4818-8327-3a779aa7bc6c)"},{"content":"Associates the specified registry entry with a specified member variable of type CString.","pos":[8717,8806]},{"pos":[8811,8894],"content":"<bpt id=\"p1\">[</bpt>RDX_DWORD<ept id=\"p1\">](http://msdn.microsoft.com/library/1e7d4888-284f-4fe7-99de-5f193af19c4d)</ept>","source":"[RDX_DWORD](http://msdn.microsoft.com/library/1e7d4888-284f-4fe7-99de-5f193af19c4d)"},{"content":"Associates the specified registry entry with a specified member variable of type DWORD.","pos":[8895,8982]},{"pos":[8987,9069],"content":"<bpt id=\"p1\">[</bpt>RDX_TEXT<ept id=\"p1\">](http://msdn.microsoft.com/library/47566a2e-f293-4b67-8e1c-fa83a0a0c558)</ept>","source":"[RDX_TEXT](http://msdn.microsoft.com/library/47566a2e-f293-4b67-8e1c-fa83a0a0c558)"},{"content":"Associates the specified registry entry with a specified member variable of type TCHAR.","pos":[9070,9157]},{"pos":[9167,9175],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[9179,9228],"content":"<bpt id=\"p1\">[</bpt>Functions<ept id=\"p1\">](../../atl/reference/atl-functions.md)</ept>","source":"[Functions](../../atl/reference/atl-functions.md)"}],"content":"---\ntitle: \"Registry and TypeLib Global Functions | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"RegistryDataExchange function, global functions\"\nms.assetid: d58b8a4e-975c-4417-8b34-d3c847f679b3\ncaps.latest.revision: 22\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Registry and TypeLib Global Functions\nThese functions provide support for loading and registering a type library.  \n  \n> [!IMPORTANT]\n>  The functions listed in the following tables cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n|||  \n|-|-|  \n|[AtlRegisterTypeLib](#atlregistertypelib)|This function is called to register a type library.|  \n|[AtlUnRegisterTypeLib](#atlunregistertypelib)|This function is called to unregister a type library|  \n|[AtlLoadTypeLib](#atlloadtypelib)|This function is called to load a type library.|  \n|[AtlUpdateRegistryFromResourceD](#atlupdateregistryfromresourced)|This function is called to update the registry from the supplied resource.|  \n|[RegistryDataExchange](#registrydataexchange)|This function is called to read from, or write to, the system registry. Called by the [Registry Data Exchange Macros](../../atl/reference/registry-data-exchange-macros.md).|  \n  \n These functions control which node in the registry the program uses to store information.  \n  \n|||  \n|-|-|  \n|[AtlGetPerUserRegistration](#atlgetperuserregistration)|Retrieves whether the application redirects registry access to the **HKEY_CURRENT_USER** ( **HKCU**) node.|  \n|[AtlSetPerUserRegistration](#atlsetperuserregistration)|Sets whether the application redirects registry access to the **HKEY_CURRENT_USER** ( **HKCU**) node.|  \n\n\n## <a name=\"atlgetperuserregistration\"></a> AtlGetPerUserRegistration\nUse this function to determine whether the application redirects registry access to the **HKEY_CURRENT_USER** (**HKCU**) node.  \n  \n## Syntax  \n  \n```  \nATLINLINE ATLAPI AtlGetPerUserRegistration(  \n   bool* pEnabled  \n);  \n```  \n  \n### Parameters  \n [out] `pEnabled`  \n `TRUE` indicates that the registry information is directed to the **HKCU** node; `FALSE` indicates that the application writes registry information to the default node. The default node is **HKEY_CLASSES_ROOT** (**HKCR**).  \n  \n### Return Value  \n `S_OK` if the method is successful, otherwise the `HRESULT` error code if an error occurs.  \n  \n### Remarks  \n Registry redirection is not enabled by default. If you enable this option, registry access is redirected to **HKEY_CURRENT_USER\\Software\\Classes**.  \n  \n The redirection is not global. Only the MFC and ATL frameworks are affected by this registry redirection.  \n  \n\n\n##  <a name=\"atlregistertypelib\"></a>  AtlRegisterTypeLib  \n This function is called to register a type library.  \n  \n  \n```\nATLAPI AtlRegisterTypeLib(HINSTANCE hInstTypeLib, LPCOLESTR lpszIndex);\n```  \n  \n### Parameters  \n `hInstTypeLib`  \n The handle to the module instance.  \n  \n `lpszIndex`  \n String in the format \"\\\\\\N\", where N is the integer index of the type library resource. Can be NULL if no index is required.  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n### Remarks  \n This helper function is utilized by [AtlComModuleUnregisterServer](server-registration-global-functions.md#atlcommoduleunregisterserver) and [CAtlComModule::RegisterTypeLib](../../atl/reference/catlcommodule-class.md#catlcommodule__registertypelib).  \n  \n## <a name=\"atlsetperuserregistration\"></a> AtlSetPerUserRegistration\nSets whether the application redirects registry access to the **HKEY_CURRENT_USER** (**HKCU**) node.  \n  \n## Syntax  \n  \n```  \nATLINLINE ATLAPI AtlSetPerUserRegistration(  \n   bool bEnable  \n);  \n```  \n  \n### Parameters  \n [in] `bEnable`  \n `TRUE` indicates that the registry information is directed to the **HKCU** node; `FALSE` indicates that the application writes registry information to the default node. The default node is **HKEY_CLASSES_ROOT** (**HKCR**).  \n  \n### Return Value  \n `S_OK` if the method is successful, otherwise the `HRESULT` error code if an error occurs.  \n  \n### Remarks  \n Registry redirection is not enabled by default. If you enable this option, registry access is redirected to **HKEY_CURRENT_USER\\Software\\Classes**.  \n  \n The redirection is not global. Only the MFC and ATL frameworks are affected by this registry redirection.  \n  \n\n##  <a name=\"atlunregistertypelib\"></a>  AtlUnRegisterTypeLib  \n This function is called to unregister a type library.  \n  \n\n```\nATLAPI AtlUnRegisterTypeLib(\n    HINSTANCE hInstTypeLib,  LPCOLESTR lpszIndex);\n```  \n  \n### Parameters  \n `hInstTypeLib`  \n The handle to the module instance.  \n  \n `lpszIndex`  \n String in the format \"\\\\\\N\", where N is the integer index of the type library resource. Can be NULL if no index is required.  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n### Remarks  \n This helper function is utilized by [CAtlComModule::UnRegisterTypeLib](../../atl/reference/catlcommodule-class.md#catlcommodule__unregistertypelib) and [AtlComModuleUnregisterServer](#atlcommoduleunregisterserver).  \n  \n##  <a name=\"atlloadtypelib\"></a>  AtlLoadTypeLib  \n This function is called to load a type library.  \n  \n\n```\nATLINLINE ATLAPI AtlLoadTypeLib(\n    HINSTANCE hInstTypeLib,\n    LPCOLESTR lpszIndex,\n    BSTR* pbstrPath,\n    ITypeLib** ppTypeLib);\n```  \n  \n### Parameters  \n `hInstTypeLib`  \n Handle to the module associated with the type library.  \n  \n `lpszIndex`  \n String in the format \"\\\\\\N\", where N is the integer index of the type library resource. Can be NULL if no index is required.  \n  \n *pbstrPath*  \n On successful return, contains the full path of the module associated with the type library.  \n  \n `ppTypeLib`  \n On successful return, contains a pointer to a pointer to the loaded type library.  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n### Remarks  \n This helper function is utilized by [AtlRegisterTypeLib](#atlregistertypelib) and [AtlUnRegisterTypeLib](#atlunregistertypelib).  \n  \n##  <a name=\"atlupdateregistryfromresourced\"></a>  AtlUpdateRegistryFromResourceD  \n This function was deprecated in Visual Studio 2013 and is removed in Visual Studio 2015.  \n  \n```\n<removed>\n```  \n  \n### Parameters  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"registrydataexchange\"></a>  RegistryDataExchange  \n This function is called to read from, or write to, the system registry.  \n \n```\nHRESULT RegistryDataExchange(\n    T* pT,\n    enum RDXOperations rdxOp,\n    void* pItem = NULL);\n```  \n  \n### Parameters  \n *pT*  \n A pointer to the current object.  \n  \n *rdxOp*  \n An enum value that indicates which operation the function should perform. See the table in the Remarks section for the allowed values.  \n  \n `pItem`  \n Pointer to the data that is to be read from, or written to, the registry. The data can also represent a key to be deleted from the registry. The default value is NULL.  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n### Remarks  \n The macros [BEGIN_RDX_MAP](http://msdn.microsoft.com/library/95bbba6a-d550-4e36-8e6e-1c619d9e660d) and [END_RDX_MAP](http://msdn.microsoft.com/library/77efa3bd-ded7-430c-b5b4-2131a2d7e71d) expand to a function that calls `RegistryDataExchange`.  \n  \n The possible enum values that indicate the operation the function should perform are shown in the following table:  \n  \n|Enum value|Operation|  \n|----------------|---------------|  \n|eReadFromReg|Read data from the registry.|  \n|eWriteToReg|Write data to the registry.|  \n|eDeleteFromReg|Delete the key from the registry.|  \n  \n##  <a name=\"registry_data_exchange_macros\"></a>  Registry Data Exchange Macros  \n These macros perform Registry Data Exchange operations.  \n  \n|||  \n|-|-|  \n|[BEGIN_RDX_MAP](http://msdn.microsoft.com/library/95bbba6a-d550-4e36-8e6e-1c619d9e660d)|Marks the beginning of the Registry Data Exchange map.|  \n|[END_RDX_MAP](http://msdn.microsoft.com/library/77efa3bd-ded7-430c-b5b4-2131a2d7e71d)|Marks the end of the Registry Data Exchange map.|  \n|[RDX_BINARY](http://msdn.microsoft.com/library/cc872cdb-fe5a-45cd-8ed8-00be54911f2a)|Associates the specified registry entry with a specified member variable of type BYTE.|  \n|[RDX_CSTRING_TEXT](http://msdn.microsoft.com/library/897ac6dc-2700-4818-8327-3a779aa7bc6c)|Associates the specified registry entry with a specified member variable of type CString.|  \n|[RDX_DWORD](http://msdn.microsoft.com/library/1e7d4888-284f-4fe7-99de-5f193af19c4d)|Associates the specified registry entry with a specified member variable of type DWORD.|  \n|[RDX_TEXT](http://msdn.microsoft.com/library/47566a2e-f293-4b67-8e1c-fa83a0a0c558)|Associates the specified registry entry with a specified member variable of type TCHAR.|  \n  \n## See Also  \n [Functions](../../atl/reference/atl-functions.md)\n\n\n\n\n\n"}