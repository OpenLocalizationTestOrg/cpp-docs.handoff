{"nodes":[{"pos":[12,57],"content":"Choosing a Deployment Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Choosing a Deployment Method | Microsoft Docs","pos":[0,45]}]},{"content":"Choosing a Deployment Method","pos":[873,901]},{"content":"Unless your <ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph> application is self-contained and can be deployed by using a copy command, we recommend that you use Windows Installer for deployment.","pos":[902,1099],"source":"Unless your [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] application is self-contained and can be deployed by using a copy command, we recommend that you use Windows Installer for deployment."},{"content":"Windows Installer supports installation, repair, and uninstallation, and also supports atomic updating of application files, dependencies, and registry entries.","pos":[1100,1260]},{"pos":[1268,1638],"content":"[!NOTE]\n Although [ClickOnce](/visualstudio/deployment/clickonce-security-and-deployment) deployment for [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] native applications is possible in Visual Studio, it requires extra steps. For more information, see [ClickOnce Deployment for Visual C++ Applications](../ide/clickonce-deployment-for-visual-cpp-applications.md).","leadings":["","> "],"nodes":[{"content":" Although [ClickOnce](/visualstudio/deployment/clickonce-security-and-deployment) deployment for [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] native applications is possible in Visual Studio, it requires extra steps. For more information, see [ClickOnce Deployment for Visual C++ Applications](../ide/clickonce-deployment-for-visual-cpp-applications.md).","pos":[8,368],"nodes":[{"content":"Although <bpt id=\"p1\">[</bpt>ClickOnce<ept id=\"p1\">](/visualstudio/deployment/clickonce-security-and-deployment)</ept> deployment for <ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph> native applications is possible in Visual Studio, it requires extra steps.","pos":[1,222],"source":" Although [ClickOnce](/visualstudio/deployment/clickonce-security-and-deployment) deployment for [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] native applications is possible in Visual Studio, it requires extra steps."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ClickOnce Deployment for Visual C++ Applications<ept id=\"p1\">](../ide/clickonce-deployment-for-visual-cpp-applications.md)</ept>.","pos":[223,360],"source":" For more information, see [ClickOnce Deployment for Visual C++ Applications](../ide/clickonce-deployment-for-visual-cpp-applications.md)."}]}]},{"content":"Visual C++ Libraries are Shared DLLs","pos":[1647,1683]},{"content":"Because Visual C++ libraries are installed in the %windir%\\system32\\ directory by the Visual Studio installer, when you develop a Visual C++ application that depends on them, it will run as expected.","pos":[1687,1886]},{"content":"However, to deploy the application to computers that may not have Visual Studio, we recommend that you ensure that the libraries are installed on those computers together with the application.","pos":[1887,2079]},{"content":"Redistributing Visual C++ Libraries","pos":[2088,2123]},{"content":"In your deployments, you can redistribute any version of a Visual C++ library that's licensed for redistribution.","pos":[2127,2240]},{"content":"Here are three ways to deploy them:","pos":[2241,2276]},{"content":"Central deployment by using redistributable packages, which installs Visual C++ libraries as shared DLLs in %windir%\\system32<ph id=\"ph1\">\\\\</ph>.","pos":[2286,2414],"source":"Central deployment by using redistributable packages, which installs Visual C++ libraries as shared DLLs in %windir%\\system32\\\\."},{"content":"(Installation in this folder requires administrator rights.) You can create a script or setup program that runs the redistributable package before installing your application on the target computer.","pos":[2415,2613]},{"content":"Redistributable packages are available for the x86, x64, and ARM platforms (VCRedist_x86.exe, VCRedist_x64.exe, or VCRedist_arm.exe).","pos":[2614,2747]},{"content":"Visual Studio includes these packages in %ProgramFiles(x86)%\\Microsoft Visual Studio <ph id=\"ph1\">`version`</ph>\\VC\\Redist<ph id=\"ph2\">\\\\`locale ID`\\\\</ph>.","pos":[2748,2868],"source":" Visual Studio includes these packages in %ProgramFiles(x86)%\\Microsoft Visual Studio `version`\\VC\\Redist\\\\`locale ID`\\\\."},{"content":"You can also download them from the <bpt id=\"p1\">[</bpt>Microsoft Download Center<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=132793)</ept>.","pos":[2869,2980],"source":" You can also download them from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=132793)."},{"content":"(On the Download Center, search for the \"<ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph> Redistributable Package <bpt id=\"p1\">*</bpt>Visual Studio version and update<ept id=\"p1\">*</ept>\" that matches your application.","pos":[2981,3163],"source":" (On the Download Center, search for the \"[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] Redistributable Package *Visual Studio version and update*\" that matches your application."},{"content":"For example, if you used Visual Studio 2012 update 4 to build your application, then search for \"Visual C++ Redistributable Package 2012 update 4\".) For information about how to use a redistributable package, see <bpt id=\"p1\">[</bpt>Walkthrough: Deploying a Visual C++ Application By Using the Visual C++ Redistributable Package<ept id=\"p1\">](../ide/deploying-visual-cpp-application-by-using-the-vcpp-redistributable-package.md)</ept>.","pos":[3164,3561],"source":" For example, if you used Visual Studio 2012 update 4 to build your application, then search for \"Visual C++ Redistributable Package 2012 update 4\".) For information about how to use a redistributable package, see [Walkthrough: Deploying a Visual C++ Application By Using the Visual C++ Redistributable Package](../ide/deploying-visual-cpp-application-by-using-the-vcpp-redistributable-package.md)."},{"content":"Central deployment by using merge modules, each of which installs a particular Visual C++ library as a shared DLL in %windir%\\system32<ph id=\"ph1\">\\\\</ph>.","pos":[3571,3708],"source":"Central deployment by using merge modules, each of which installs a particular Visual C++ library as a shared DLL in %windir%\\system32\\\\."},{"content":"(Installation to this folder requires administrator rights.) Merge modules become part of the .msi installer file for your application.","pos":[3709,3844]},{"content":"Visual C++ redistributable merge modules are included in Visual Studio, in \\Program Files (x86)\\Common Files\\Merge Modules<ph id=\"ph1\">\\\\</ph>.","pos":[3845,3970],"source":" Visual C++ redistributable merge modules are included in Visual Studio, in \\Program Files (x86)\\Common Files\\Merge Modules\\\\."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Redistributing By Using Merge Modules<ept id=\"p1\">](../ide/redistributing-components-by-using-merge-modules.md)</ept>.","pos":[3971,4097],"source":" For more information, see [Redistributing By Using Merge Modules](../ide/redistributing-components-by-using-merge-modules.md)."},{"content":"Local deployment, in which you copy particular Visual C++ DLLs from your Visual Studio installation—typically in \\Program Files (x86)\\Microsoft Visual Studio <ph id=\"ph1\">`version`</ph>\\VC\\Redist<ph id=\"ph2\">\\\\`platform`\\\\`library`</ph>\\—and install them on target computers in the same folder as the application executable.","pos":[4107,4395],"source":"Local deployment, in which you copy particular Visual C++ DLLs from your Visual Studio installation—typically in \\Program Files (x86)\\Microsoft Visual Studio `version`\\VC\\Redist\\\\`platform`\\\\`library`\\—and install them on target computers in the same folder as the application executable."},{"content":"You can use this deployment method to enable installation by users who don't have administrator rights, or for applications that can be run from a network share.","pos":[4396,4557]},{"content":"If a deployment uses redistributable merge modules and an installation is run by a user who does not have administrative rights, the <ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph> DLLs are not installed and the application will not run.","pos":[4564,4804],"source":"If a deployment uses redistributable merge modules and an installation is run by a user who does not have administrative rights, the [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] DLLs are not installed and the application will not run."},{"content":"Also, application installers built with merge modules that allow installation on a per-user basis install the libraries in a shared location that impacts all users of the system.","pos":[4805,4983]},{"content":"You can use local deployment to install the required <ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph> DLLs in the directory of a particular user's application without affecting other users or requiring administrator rights.","pos":[4984,5209],"source":" You can use local deployment to install the required [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] DLLs in the directory of a particular user's application without affecting other users or requiring administrator rights."},{"content":"Because this can create serviceability issues, we do not recommend local deployment of <ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph> redistributable DLLs.","pos":[5210,5369],"source":" Because this can create serviceability issues, we do not recommend local deployment of [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] redistributable DLLs."},{"content":"Incorrect deployment of Visual C++ libraries may cause run-time errors during execution of an application that depends on them.","pos":[5376,5503]},{"content":"When the operating system loads the application, it uses the search order described in <bpt id=\"p1\">[</bpt>LoadLibraryEx<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=132792)</ept>","pos":[5504,5653],"source":" When the operating system loads the application, it uses the search order described in [LoadLibraryEx](http://go.microsoft.com/fwlink/?LinkId=132792)"},{"content":"Dynamic Linking Is Better than Static Linking","pos":[5662,5707]},{"content":"We recommend that you avoid static linking when you redistribute <ph id=\"ph1\">[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)]</ph> libraries.","pos":[5711,5837],"source":"We recommend that you avoid static linking when you redistribute [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] libraries."},{"content":"Although static linking almost never significantly improves application performance, it almost always makes servicing more expensive.","pos":[5838,5971]},{"content":"For example, consider an application that's statically linked to a library that's been updated with security enhancements—the application cannot benefit unless it is recompiled and redeployed.","pos":[5972,6164]},{"content":"Instead, we recommend that you dynamically link your applications to the libraries they depend on so that the libraries can be updated wherever they're deployed.","pos":[6165,6326]},{"content":"See Also","pos":[6335,6343]},{"content":"Deploying Desktop Applications","pos":[6348,6378]},{"content":"Not in Build: Choosing a Deployment Strategy","pos":[6445,6489]},{"content":"Windows Installer Deployment Overview","pos":[6566,6603]},{"content":"ClickOnce Security and Deployment","pos":[6680,6713]},{"content":"Deployment Examples","pos":[6780,6799]}],"content":"---\ntitle: \"Choosing a Deployment Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"redistributing DLLs\"\n  - \"manifests [C++]\"\n  - \"DLLs [C++], redistributing\"\n  - \"side-by-side assemblies [C++]\"\n  - \"dynamic linking [C++]\"\n  - \"application deployment [C++], methods\"\n  - \"deploying applications [C++], methods\"\n  - \"static linking [C++]\"\n  - \"libraries [C++], application deployment issues\"\nms.assetid: fd8eb956-f4a0-4ffb-b401-328c73e66986\ncaps.latest.revision: 35\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Choosing a Deployment Method\nUnless your [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] application is self-contained and can be deployed by using a copy command, we recommend that you use Windows Installer for deployment. Windows Installer supports installation, repair, and uninstallation, and also supports atomic updating of application files, dependencies, and registry entries.  \n  \n> [!NOTE]\n>  Although [ClickOnce](/visualstudio/deployment/clickonce-security-and-deployment) deployment for [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] native applications is possible in Visual Studio, it requires extra steps. For more information, see [ClickOnce Deployment for Visual C++ Applications](../ide/clickonce-deployment-for-visual-cpp-applications.md).  \n  \n## Visual C++ Libraries are Shared DLLs  \n Because Visual C++ libraries are installed in the %windir%\\system32\\ directory by the Visual Studio installer, when you develop a Visual C++ application that depends on them, it will run as expected. However, to deploy the application to computers that may not have Visual Studio, we recommend that you ensure that the libraries are installed on those computers together with the application.  \n  \n## Redistributing Visual C++ Libraries  \n In your deployments, you can redistribute any version of a Visual C++ library that's licensed for redistribution. Here are three ways to deploy them:  \n  \n-   Central deployment by using redistributable packages, which installs Visual C++ libraries as shared DLLs in %windir%\\system32\\\\. (Installation in this folder requires administrator rights.) You can create a script or setup program that runs the redistributable package before installing your application on the target computer. Redistributable packages are available for the x86, x64, and ARM platforms (VCRedist_x86.exe, VCRedist_x64.exe, or VCRedist_arm.exe). Visual Studio includes these packages in %ProgramFiles(x86)%\\Microsoft Visual Studio `version`\\VC\\Redist\\\\`locale ID`\\\\. You can also download them from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=132793). (On the Download Center, search for the \"[!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] Redistributable Package *Visual Studio version and update*\" that matches your application. For example, if you used Visual Studio 2012 update 4 to build your application, then search for \"Visual C++ Redistributable Package 2012 update 4\".) For information about how to use a redistributable package, see [Walkthrough: Deploying a Visual C++ Application By Using the Visual C++ Redistributable Package](../ide/deploying-visual-cpp-application-by-using-the-vcpp-redistributable-package.md).  \n  \n-   Central deployment by using merge modules, each of which installs a particular Visual C++ library as a shared DLL in %windir%\\system32\\\\. (Installation to this folder requires administrator rights.) Merge modules become part of the .msi installer file for your application. Visual C++ redistributable merge modules are included in Visual Studio, in \\Program Files (x86)\\Common Files\\Merge Modules\\\\. For more information, see [Redistributing By Using Merge Modules](../ide/redistributing-components-by-using-merge-modules.md).  \n  \n-   Local deployment, in which you copy particular Visual C++ DLLs from your Visual Studio installation—typically in \\Program Files (x86)\\Microsoft Visual Studio `version`\\VC\\Redist\\\\`platform`\\\\`library`\\—and install them on target computers in the same folder as the application executable. You can use this deployment method to enable installation by users who don't have administrator rights, or for applications that can be run from a network share.  \n  \n If a deployment uses redistributable merge modules and an installation is run by a user who does not have administrative rights, the [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] DLLs are not installed and the application will not run. Also, application installers built with merge modules that allow installation on a per-user basis install the libraries in a shared location that impacts all users of the system. You can use local deployment to install the required [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] DLLs in the directory of a particular user's application without affecting other users or requiring administrator rights. Because this can create serviceability issues, we do not recommend local deployment of [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] redistributable DLLs.  \n  \n Incorrect deployment of Visual C++ libraries may cause run-time errors during execution of an application that depends on them. When the operating system loads the application, it uses the search order described in [LoadLibraryEx](http://go.microsoft.com/fwlink/?LinkId=132792)  \n  \n## Dynamic Linking Is Better than Static Linking  \n We recommend that you avoid static linking when you redistribute [!INCLUDE[vcprvc](../build/includes/vcprvc_md.md)] libraries. Although static linking almost never significantly improves application performance, it almost always makes servicing more expensive. For example, consider an application that's statically linked to a library that's been updated with security enhancements—the application cannot benefit unless it is recompiled and redeployed. Instead, we recommend that you dynamically link your applications to the libraries they depend on so that the libraries can be updated wherever they're deployed.  \n  \n## See Also  \n [Deploying Desktop Applications](../ide/deploying-native-desktop-applications-visual-cpp.md)   \n [Not in Build: Choosing a Deployment Strategy](http://msdn.microsoft.com/en-us/ecd632d8-063c-4028-b785-81bba045107b)   \n [Windows Installer Deployment Overview](http://msdn.microsoft.com/en-us/3ce4610a-b54f-404e-b650-42f4a55dfc3b)   \n [ClickOnce Security and Deployment](/visualstudio/deployment/clickonce-security-and-deployment)   \n [Deployment Examples](../ide/deployment-examples.md)"}