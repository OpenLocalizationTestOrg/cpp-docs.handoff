{"nodes":[{"pos":[12,56],"content":"Creating an OLE DB Provider | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Creating an OLE DB Provider | Microsoft Docs","pos":[0,44]}]},{"content":"Creating an OLE DB Provider","pos":[643,670]},{"content":"The recommended way to create an OLE DB provider is to use the wizards to create an ATL COM project and a provider and then modify the files using the OLE DB templates.","pos":[671,839]},{"content":"As you customize your provider, you can comment out unwanted properties and add optional interfaces.","pos":[840,940]},{"content":"The basic steps are as follows:","pos":[947,978]},{"pos":[988,1184],"content":"Use the ATL Project Wizard to create the basic project files and the ATL OLE DB Provider Wizard to create the provider (select <bpt id=\"p1\">**</bpt>ATL OLE DB Provider<ept id=\"p1\">**</ept> from the Visual C++ folder in <bpt id=\"p2\">**</bpt>Add Class<ept id=\"p2\">**</ept>).","source":"Use the ATL Project Wizard to create the basic project files and the ATL OLE DB Provider Wizard to create the provider (select **ATL OLE DB Provider** from the Visual C++ folder in **Add Class**)."},{"content":"Modify the code in the <ph id=\"ph1\">`Execute`</ph> method in CMyProviderRS.h.","pos":[1194,1253],"source":"Modify the code in the `Execute` method in CMyProviderRS.h."},{"content":"For an example, see <bpt id=\"p1\">[</bpt>Reading Strings Into an OLE DB Provider<ept id=\"p1\">](../../data/oledb/reading-strings-into-the-ole-db-provider.md)</ept>.","pos":[1254,1378],"source":" For an example, see [Reading Strings Into an OLE DB Provider](../../data/oledb/reading-strings-into-the-ole-db-provider.md)."},{"content":"Edit the property maps in MyProviderDS.h, MyProviderSess.h, and MyProviderRS.h.","pos":[1388,1467]},{"content":"The wizard creates property maps that contain all properties that a provider might implement.","pos":[1468,1561]},{"content":"Go through the property maps and remove or comment out properties that your provider does not need to support.","pos":[1562,1672]},{"content":"Update the PROVIDER_COLUMN_MAP, which can be found in MyProviderRS.h.","pos":[1682,1751]},{"content":"For an example, see <bpt id=\"p1\">[</bpt>Storing Strings In the OLE DB Provider<ept id=\"p1\">](../../data/oledb/storing-strings-in-the-ole-db-provider.md)</ept>.","pos":[1752,1873],"source":" For an example, see [Storing Strings In the OLE DB Provider](../../data/oledb/storing-strings-in-the-ole-db-provider.md)."},{"content":"When you are ready to test your provider, you can test it by trying to find the provider in a provider enumeration.","pos":[1883,1998]},{"content":"For examples of test code that finds a provider in an enumeration, see the <bpt id=\"p1\">[</bpt>CATDB<ept id=\"p1\">](http://msdn.microsoft.com/en-us/003d516b-2bf6-444e-8be5-4ebaa0b66046)</ept> and <bpt id=\"p2\">[</bpt>DBVIEWER<ept id=\"p2\">](http://msdn.microsoft.com/en-us/07620f99-c347-4d09-9ebc-2459e8049832)</ept> samples or the example in <bpt id=\"p3\">[</bpt>Implementing A Simple Consumer<ept id=\"p3\">](../../data/oledb/implementing-a-simple-consumer.md)</ept>.","pos":[1999,2348],"source":" For examples of test code that finds a provider in an enumeration, see the [CATDB](http://msdn.microsoft.com/en-us/003d516b-2bf6-444e-8be5-4ebaa0b66046) and [DBVIEWER](http://msdn.microsoft.com/en-us/07620f99-c347-4d09-9ebc-2459e8049832) samples or the example in [Implementing A Simple Consumer](../../data/oledb/implementing-a-simple-consumer.md)."},{"content":"Add any additional interfaces you want.","pos":[2358,2397]},{"content":"For an example, see <bpt id=\"p1\">[</bpt>Enhancing the Simple Read-Only Provider<ept id=\"p1\">](../../data/oledb/enhancing-the-simple-read-only-provider.md)</ept>.","pos":[2398,2521],"source":" For an example, see [Enhancing the Simple Read-Only Provider](../../data/oledb/enhancing-the-simple-read-only-provider.md)."},{"pos":[2533,2746],"content":"[!NOTE]\n By default, the wizards generate code that is OLE DB level 0 compliant. To ensure that your application remains level 0 compliant, do not remove any of the wizard-generated interfaces from the code.","leadings":["","    > "],"nodes":[{"content":" By default, the wizards generate code that is OLE DB level 0 compliant. To ensure that your application remains level 0 compliant, do not remove any of the wizard-generated interfaces from the code.","pos":[8,207],"nodes":[{"content":"By default, the wizards generate code that is OLE DB level 0 compliant.","pos":[1,72]},{"content":"To ensure that your application remains level 0 compliant, do not remove any of the wizard-generated interfaces from the code.","pos":[73,199]}]}]},{"content":"See Also","pos":[2755,2763]},{"content":"CATDB","pos":[2768,2773]},{"content":"DBVIEWER","pos":[2850,2858]}],"content":"---\ntitle: \"Creating an OLE DB Provider | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE DB providers, creating\"\n  - \"OLE DB provider templates, creating providers\"\nms.assetid: f73017c3-c89f-41a6-a306-ea992cf6092c\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Creating an OLE DB Provider\nThe recommended way to create an OLE DB provider is to use the wizards to create an ATL COM project and a provider and then modify the files using the OLE DB templates. As you customize your provider, you can comment out unwanted properties and add optional interfaces.  \n  \n The basic steps are as follows:  \n  \n1.  Use the ATL Project Wizard to create the basic project files and the ATL OLE DB Provider Wizard to create the provider (select **ATL OLE DB Provider** from the Visual C++ folder in **Add Class**).  \n  \n2.  Modify the code in the `Execute` method in CMyProviderRS.h. For an example, see [Reading Strings Into an OLE DB Provider](../../data/oledb/reading-strings-into-the-ole-db-provider.md).  \n  \n3.  Edit the property maps in MyProviderDS.h, MyProviderSess.h, and MyProviderRS.h. The wizard creates property maps that contain all properties that a provider might implement. Go through the property maps and remove or comment out properties that your provider does not need to support.  \n  \n4.  Update the PROVIDER_COLUMN_MAP, which can be found in MyProviderRS.h. For an example, see [Storing Strings In the OLE DB Provider](../../data/oledb/storing-strings-in-the-ole-db-provider.md).  \n  \n5.  When you are ready to test your provider, you can test it by trying to find the provider in a provider enumeration. For examples of test code that finds a provider in an enumeration, see the [CATDB](http://msdn.microsoft.com/en-us/003d516b-2bf6-444e-8be5-4ebaa0b66046) and [DBVIEWER](http://msdn.microsoft.com/en-us/07620f99-c347-4d09-9ebc-2459e8049832) samples or the example in [Implementing A Simple Consumer](../../data/oledb/implementing-a-simple-consumer.md).  \n  \n6.  Add any additional interfaces you want. For an example, see [Enhancing the Simple Read-Only Provider](../../data/oledb/enhancing-the-simple-read-only-provider.md).  \n  \n    > [!NOTE]\n    >  By default, the wizards generate code that is OLE DB level 0 compliant. To ensure that your application remains level 0 compliant, do not remove any of the wizard-generated interfaces from the code.  \n  \n## See Also  \n [CATDB](http://msdn.microsoft.com/en-us/003d516b-2bf6-444e-8be5-4ebaa0b66046)   \n [DBVIEWER](http://msdn.microsoft.com/en-us/07620f99-c347-4d09-9ebc-2459e8049832)"}