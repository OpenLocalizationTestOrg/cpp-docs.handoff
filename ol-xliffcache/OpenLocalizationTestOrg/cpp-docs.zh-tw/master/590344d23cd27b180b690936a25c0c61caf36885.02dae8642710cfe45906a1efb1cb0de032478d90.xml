{"nodes":[{"pos":[12,46],"content":"CRBMultiMap Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CRBMultiMap Class | Microsoft Docs","pos":[0,34]}]},{"content":"CRBMultiMap Class","pos":[652,669]},{"content":"This class represents a mapping structure that allows each key can be associated with more than one value, using a Red-Black binary tree.","pos":[670,807]},{"content":"Syntax","pos":[816,822]},{"content":"Parameters","pos":[1023,1033]},{"content":"The key element type.","pos":[1044,1065]},{"content":"V","pos":[1073,1074]},{"content":"The value element type.","pos":[1079,1102]},{"content":"The code used to copy or move key elements.","pos":[1122,1165]},{"content":"See <bpt id=\"p1\">[</bpt>CElementTraits Class<ept id=\"p1\">](../../atl/reference/celementtraits-class.md)</ept> for more details.","pos":[1166,1255],"source":" See [CElementTraits Class](../../atl/reference/celementtraits-class.md) for more details."},{"content":"The code used to copy or move value elements.","pos":[1275,1320]},{"content":"Members","pos":[1329,1336]},{"content":"Public Constructors","pos":[1346,1365]},{"content":"Name","pos":[1372,1376]},{"content":"Description","pos":[1377,1388]},{"content":"CRBMultiMap::CRBMultiMap","pos":[1427,1451]},{"content":"The constructor.","pos":[1480,1496]},{"content":"CRBMultiMap::~CRBMultiMap","pos":[1502,1527]},{"content":"The destructor.","pos":[1561,1576]},{"content":"Public Methods","pos":[1587,1601]},{"content":"Name","pos":[1608,1612]},{"content":"Description","pos":[1613,1624]},{"content":"CRBMultiMap::FindFirstWithKey","pos":[1663,1692]},{"content":"Call this method to find the position of the first element with a given key.","pos":[1726,1802]},{"content":"CRBMultiMap::GetNextValueWithKey","pos":[1808,1840]},{"content":"Call this method to get the value associated with a given key, and update the position value.","pos":[1877,1970]},{"content":"CRBMultiMap::GetNextWithKey","pos":[1976,2003]},{"content":"Call this method to get the element associated with a given key, and update the position value.","pos":[2035,2130]},{"content":"CRBMultiMap::Insert","pos":[2136,2155]},{"content":"Call this method to insert an element pair into the map.","pos":[2179,2235]},{"content":"CRBMultiMap::RemoveKey","pos":[2241,2263]},{"content":"Call this method to remove all of the key/value elements for a given key.","pos":[2290,2363]},{"content":"Remarks","pos":[2373,2380]},{"content":"provides support for a mapping array of any given type, managing an ordered array of key elements and values.","pos":[2398,2507]},{"content":"Unlike the <bpt id=\"p1\">[</bpt>CRBMap<ept id=\"p1\">](../../atl/reference/crbmap-class.md)</ept> class, each key can be associated with more than one value.","pos":[2508,2624],"source":" Unlike the [CRBMap](../../atl/reference/crbmap-class.md) class, each key can be associated with more than one value."},{"content":"Elements (consisting of a key and a value) are stored in a binary tree structure, using the <bpt id=\"p1\">[</bpt>CRBMultiMap::Insert<ept id=\"p1\">](#crbmultimap__insert)</ept> method.","pos":[2631,2774],"source":"Elements (consisting of a key and a value) are stored in a binary tree structure, using the [CRBMultiMap::Insert](#crbmultimap__insert) method."},{"content":"Elements can be removed using the <bpt id=\"p1\">[</bpt>CRBMultiMap::RemoveKey<ept id=\"p1\">](#crbmultimap__removekey)</ept> method, which deletes all elements which match the given key.","pos":[2775,2920],"source":" Elements can be removed using the [CRBMultiMap::RemoveKey](#crbmultimap__removekey) method, which deletes all elements which match the given key."},{"content":"Traversing the tree is made possible with methods such as <bpt id=\"p1\">[</bpt>CRBTree::GetHeadPosition<ept id=\"p1\">](../../atl/reference/crbtree-class.md#crbtree__getheadposition)</ept>, <bpt id=\"p2\">[</bpt>CRBTree::GetNext<ept id=\"p2\">](../../atl/reference/crbtree-class.md#crbtree__getnext)</ept>, and <bpt id=\"p3\">[</bpt>CRBTree::GetNextValue<ept id=\"p3\">](../../atl/reference/crbtree-class.md#crbtree__getnextvalue)</ept>.","pos":[2927,3239],"source":"Traversing the tree is made possible with methods such as [CRBTree::GetHeadPosition](../../atl/reference/crbtree-class.md#crbtree__getheadposition), [CRBTree::GetNext](../../atl/reference/crbtree-class.md#crbtree__getnext), and [CRBTree::GetNextValue](../../atl/reference/crbtree-class.md#crbtree__getnextvalue)."},{"content":"Accessing the potentially multiple values per key is possible using the <bpt id=\"p1\">[</bpt>CRBMultiMap::FindFirstWithKey<ept id=\"p1\">](#crbmultimap__findfirstwithkey)</ept>, <bpt id=\"p2\">[</bpt>CRBMultiMap::GetNextValueWithKey<ept id=\"p2\">](#crbmultimap__getnextvaluewithkey)</ept>, and <bpt id=\"p3\">[</bpt>CRBMultiMap::GetNextWithKey<ept id=\"p3\">](#crbmultimap__getnextwithkey)</ept> methods.","pos":[3240,3520],"source":" Accessing the potentially multiple values per key is possible using the [CRBMultiMap::FindFirstWithKey](#crbmultimap__findfirstwithkey), [CRBMultiMap::GetNextValueWithKey](#crbmultimap__getnextvaluewithkey), and [CRBMultiMap::GetNextWithKey](#crbmultimap__getnextwithkey) methods."},{"content":"See the example for <bpt id=\"p1\">[</bpt>CRBMultiMap::CRBMultiMap<ept id=\"p1\">](#crbmultimap__crbmultimap)</ept> for an illustration of this in practice.","pos":[3521,3635],"source":" See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap) for an illustration of this in practice."},{"pos":[3642,3767],"content":"The <ph id=\"ph1\">`KTraits`</ph> and <ph id=\"ph2\">`VTraits`</ph> parameters are traits classes that contain any supplemental code needed to copy or move elements.","source":"The `KTraits` and `VTraits` parameters are traits classes that contain any supplemental code needed to copy or move elements."},{"content":"is derived from <bpt id=\"p1\">[</bpt>CRBTree<ept id=\"p1\">](../../atl/reference/crbtree-class.md)</ept>, which implements a binary tree using the Red-Black algorithm.","pos":[3788,3914],"source":" is derived from [CRBTree](../../atl/reference/crbtree-class.md), which implements a binary tree using the Red-Black algorithm."},{"content":"An alternative to <ph id=\"ph1\">`CRBMultiMap`</ph> and <ph id=\"ph2\">`CRBMap`</ph> is offered by the <bpt id=\"p1\">[</bpt>CAtlMap<ept id=\"p1\">](../../atl/reference/catlmap-class.md)</ept> class.","pos":[3915,4032],"source":" An alternative to `CRBMultiMap` and `CRBMap` is offered by the [CAtlMap](../../atl/reference/catlmap-class.md) class."},{"content":"When only a small number of elements needs to be stored, consider using the <bpt id=\"p1\">[</bpt>CSimpleMap<ept id=\"p1\">](../../atl/reference/csimplemap-class.md)</ept> class instead.","pos":[4033,4177],"source":" When only a small number of elements needs to be stored, consider using the [CSimpleMap](../../atl/reference/csimplemap-class.md) class instead."},{"pos":[4184,4367],"content":"For a more complete discussion of the various collection classes and their features and performance characteristics, see <bpt id=\"p1\">[</bpt>ATL Collection Classes<ept id=\"p1\">](../../atl/atl-collection-classes.md)</ept>.","source":"For a more complete discussion of the various collection classes and their features and performance characteristics, see [ATL Collection Classes](../../atl/atl-collection-classes.md)."},{"content":"Inheritance Hierarchy","pos":[4376,4397]},{"content":"CRBTree","pos":[4402,4409]},{"content":"Requirements","pos":[4477,4489]},{"pos":[4493,4514],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcoll.h","source":"**Header:** atlcoll.h"},{"pos":[4565,4589],"content":"CRBMultiMap::CRBMultiMap"},{"content":"The constructor.","pos":[4593,4609]},{"content":"Parameters","pos":[4686,4696]},{"content":"The block size.","pos":[4716,4731]},{"content":"Remarks","pos":[4741,4748]},{"content":"The <ph id=\"ph1\">`nBlockSize`</ph> parameter is a measure of the amount of memory allocated when a new element is required.","pos":[4752,4857],"source":"The `nBlockSize` parameter is a measure of the amount of memory allocated when a new element is required."},{"content":"Larger block sizes reduce calls to memory allocation routines, but use more resources.","pos":[4858,4944]},{"content":"The default will allocate space for 10 elements at a time.","pos":[4945,5003]},{"pos":[5010,5146],"content":"See the documentation for the base class <bpt id=\"p1\">[</bpt>CRBTree<ept id=\"p1\">](../../atl/reference/crbtree-class.md)</ept> for information on the other methods available.","source":"See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available."},{"content":"Example","pos":[5156,5163]},{"pos":[5178,5198],"content":"NVC_ATL_Utilities#85"},{"pos":[5307,5332],"content":"CRBMultiMap::~CRBMultiMap"},{"content":"The destructor.","pos":[5336,5351]},{"content":"Remarks","pos":[5398,5405]},{"content":"Frees any allocated resources.","pos":[5409,5439]},{"pos":[5446,5582],"content":"See the documentation for the base class <bpt id=\"p1\">[</bpt>CRBTree<ept id=\"p1\">](../../atl/reference/crbtree-class.md)</ept> for information on the other methods available.","source":"See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available."},{"pos":[5638,5667],"content":"CRBMultiMap::FindFirstWithKey"},{"content":"Call this method to find the position of the first element with a given key.","pos":[5671,5747]},{"content":"Parameters","pos":[5827,5837]},{"content":"Specifies the key that identifies the element to be found.","pos":[5850,5908]},{"content":"Return Value","pos":[5918,5930]},{"content":"Returns the POSITION of the first key/value element if the key is found, NULL otherwise.","pos":[5934,6022]},{"content":"Remarks","pos":[6032,6039]},{"content":"A key in the <ph id=\"ph1\">`CRBMultiMap`</ph> can have one or more associated values.","pos":[6043,6109],"source":"A key in the `CRBMultiMap` can have one or more associated values."},{"content":"This method will provide the position value of the first value (which may, in fact, be the only value) associated with that particular key.","pos":[6110,6249]},{"content":"The position value returned can then be used with <bpt id=\"p1\">[</bpt>CRBMultiMap::GetNextValueWithKey<ept id=\"p1\">](#crbmultimap__getnextvaluewithkey)</ept> or <bpt id=\"p2\">[</bpt>CRBMultiMap::GetNextWithKey<ept id=\"p2\">](#crbmultimap__getnextwithkey)</ept> to obtain the value and update the position.","pos":[6250,6477],"source":" The position value returned can then be used with [CRBMultiMap::GetNextValueWithKey](#crbmultimap__getnextvaluewithkey) or [CRBMultiMap::GetNextWithKey](#crbmultimap__getnextwithkey) to obtain the value and update the position."},{"pos":[6484,6620],"content":"See the documentation for the base class <bpt id=\"p1\">[</bpt>CRBTree<ept id=\"p1\">](../../atl/reference/crbtree-class.md)</ept> for information on the other methods available.","source":"See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available."},{"content":"Example","pos":[6630,6637]},{"pos":[6641,6715],"content":"See the example for <bpt id=\"p1\">[</bpt>CRBMultiMap::CRBMultiMap<ept id=\"p1\">](#crbmultimap__crbmultimap)</ept>.","source":"See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap)."},{"pos":[6774,6806],"content":"CRBMultiMap::GetNextValueWithKey"},{"content":"Call this method to get the value associated with a given key and update the position value.","pos":[6810,6902]},{"content":"Parameters","pos":[7081,7091]},{"content":"The position value, obtained with either a call to <bpt id=\"p1\">[</bpt>CRBMultiMap::FindFirstWithKey<ept id=\"p1\">](#crbmultimap__findfirstwithkey)</ept> or <bpt id=\"p2\">[</bpt>CRBMultiMap::GetNextWithKey<ept id=\"p2\">](#crbmultimap__getnextwithkey)</ept>, or a previous call to <ph id=\"ph1\">`GetNextValueWithKey`</ph>.","pos":[7104,7327],"source":" The position value, obtained with either a call to [CRBMultiMap::FindFirstWithKey](#crbmultimap__findfirstwithkey) or [CRBMultiMap::GetNextWithKey](#crbmultimap__getnextwithkey), or a previous call to `GetNextValueWithKey`."},{"content":"Specifies the key that identifies the element to be found.","pos":[7343,7401]},{"content":"Return Value","pos":[7411,7423]},{"content":"Returns the element pair associated with the given key.","pos":[7427,7482]},{"content":"Remarks","pos":[7492,7499]},{"content":"The position value is updated to point to the next value associated with the key.","pos":[7503,7584]},{"content":"If no more values exist, the position value is set to NULL.","pos":[7585,7644]},{"pos":[7651,7787],"content":"See the documentation for the base class <bpt id=\"p1\">[</bpt>CRBTree<ept id=\"p1\">](../../atl/reference/crbtree-class.md)</ept> for information on the other methods available.","source":"See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available."},{"content":"Example","pos":[7797,7804]},{"pos":[7808,7882],"content":"See the example for <bpt id=\"p1\">[</bpt>CRBMultiMap::CRBMultiMap<ept id=\"p1\">](#crbmultimap__crbmultimap)</ept>.","source":"See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap)."},{"pos":[7936,7963],"content":"CRBMultiMap::GetNextWithKey"},{"content":"Call this method to get the element associated with a given key and update the position value.","pos":[7967,8061]},{"content":"Parameters","pos":[8238,8248]},{"content":"The position value, obtained with either a call to <bpt id=\"p1\">[</bpt>CRBMultiMap::FindFirstWithKey<ept id=\"p1\">](#crbmultimap__findfirstwithkey)</ept> or <bpt id=\"p2\">[</bpt>CRBMultiMap::GetNextValueWithKey<ept id=\"p2\">](#crbmultimap__getnextvaluewithkey)</ept>, or a previous call to <ph id=\"ph1\">`GetNextWithKey`</ph>.","pos":[8261,8489],"source":" The position value, obtained with either a call to [CRBMultiMap::FindFirstWithKey](#crbmultimap__findfirstwithkey) or [CRBMultiMap::GetNextValueWithKey](#crbmultimap__getnextvaluewithkey), or a previous call to `GetNextWithKey`."},{"content":"Specifies the key that identifies the element to be found.","pos":[8505,8563]},{"content":"Return Value","pos":[8573,8585]},{"pos":[8589,8706],"content":"Returns the next <bpt id=\"p1\">[</bpt>CRBTree::CPair Class<ept id=\"p1\">](crbtree-class.md#crbtree__cpair_class)</ept> element associated with the given key.","source":"Returns the next [CRBTree::CPair Class](crbtree-class.md#crbtree__cpair_class) element associated with the given key."},{"content":"Remarks","pos":[8716,8723]},{"content":"The position value is updated to point to the next value associated with the key.","pos":[8727,8808]},{"content":"If no more values exist, the position value is set to NULL.","pos":[8809,8868]},{"pos":[8875,9011],"content":"See the documentation for the base class <bpt id=\"p1\">[</bpt>CRBTree<ept id=\"p1\">](../../atl/reference/crbtree-class.md)</ept> for information on the other methods available.","source":"See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available."},{"pos":[9057,9076],"content":"CRBMultiMap::Insert"},{"content":"Call this method to insert an element pair into the map.","pos":[9080,9136]},{"content":"Parameters","pos":[9222,9232]},{"content":"The key value to add to the <ph id=\"ph1\">`CRBMultiMap`</ph> object.","pos":[9245,9294],"source":" The key value to add to the `CRBMultiMap` object."},{"content":"value","pos":[9302,9307]},{"content":"The value to add to the <ph id=\"ph1\">`CRBMultiMap`</ph> object, associated with <ph id=\"ph2\">`key`</ph>.","pos":[9312,9380],"source":" The value to add to the `CRBMultiMap` object, associated with `key`."},{"content":"Return Value","pos":[9390,9402]},{"pos":[9406,9485],"content":"Returns the position of the key/value element pair in the <ph id=\"ph1\">`CRBMultiMap`</ph> object.","source":"Returns the position of the key/value element pair in the `CRBMultiMap` object."},{"content":"Remarks","pos":[9495,9502]},{"pos":[9506,9642],"content":"See the documentation for the base class <bpt id=\"p1\">[</bpt>CRBTree<ept id=\"p1\">](../../atl/reference/crbtree-class.md)</ept> for information on the other methods available.","source":"See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available."},{"content":"Example","pos":[9652,9659]},{"pos":[9663,9737],"content":"See the example for <bpt id=\"p1\">[</bpt>CRBMultiMap::CRBMultiMap<ept id=\"p1\">](#crbmultimap__crbmultimap)</ept>.","source":"See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap)."},{"pos":[9786,9808],"content":"CRBMultiMap::RemoveKey"},{"content":"Call this method to remove all of the key/value elements for a given key.","pos":[9812,9885]},{"content":"Parameters","pos":[9950,9960]},{"content":"Specifies the key that identifies the element(s) to be deleted.","pos":[9973,10036]},{"content":"Return Value","pos":[10046,10058]},{"content":"Returns the number of values associated with the given key.","pos":[10062,10121]},{"content":"Remarks","pos":[10131,10138]},{"pos":[10154,10227],"content":"deletes all of the key/value elements that have a key that matches <ph id=\"ph1\">`key`</ph>.","source":" deletes all of the key/value elements that have a key that matches `key`."},{"pos":[10234,10370],"content":"See the documentation for the base class <bpt id=\"p1\">[</bpt>CRBTree<ept id=\"p1\">](../../atl/reference/crbtree-class.md)</ept> for information on the other methods available.","source":"See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available."},{"content":"Example","pos":[10380,10387]},{"pos":[10391,10465],"content":"See the example for <bpt id=\"p1\">[</bpt>CRBMultiMap::CRBMultiMap<ept id=\"p1\">](#crbmultimap__crbmultimap)</ept>.","source":"See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap)."},{"content":"See Also","pos":[10474,10482]},{"content":"CRBTree Class","pos":[10487,10500]},{"content":"CAtlMap Class","pos":[10545,10558]},{"content":"CRBMap Class","pos":[10603,10615]},{"content":"Class Overview","pos":[10659,10673]}],"content":"---\ntitle: \"CRBMultiMap Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CRBMultiMap\"\n  - \"ATL.CRBMultiMap\"\n  - \"ATL::CRBMultiMap\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CRBMultiMap class\"\nms.assetid: 94d3ec0c-3e30-4ab7-a101-d8da4fb8add3\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CRBMultiMap Class\nThis class represents a mapping structure that allows each key can be associated with more than one value, using a Red-Black binary tree.  \n  \n## Syntax  \n  \n```\ntemplate<typename K,\n    typename V, class KTraits = CElementTraits<K>, class VTraits = CElementTraits<V>> class CRBMultiMap : public CRBTree<K,\n    V,\n KTraits,\n    VTraits>\n```    \n  \n#### Parameters  \n `K`  \n The key element type.  \n  \n *V*  \n The value element type.  \n  \n `KTraits`  \n The code used to copy or move key elements. See [CElementTraits Class](../../atl/reference/celementtraits-class.md) for more details.  \n  \n `VTraits`  \n The code used to copy or move value elements.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap)|The constructor.|  \n|[CRBMultiMap::~CRBMultiMap](#crbmultimap___dtorcrbmultimap)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRBMultiMap::FindFirstWithKey](#crbmultimap__findfirstwithkey)|Call this method to find the position of the first element with a given key.|  \n|[CRBMultiMap::GetNextValueWithKey](#crbmultimap__getnextvaluewithkey)|Call this method to get the value associated with a given key, and update the position value.|  \n|[CRBMultiMap::GetNextWithKey](#crbmultimap__getnextwithkey)|Call this method to get the element associated with a given key, and update the position value.|  \n|[CRBMultiMap::Insert](#crbmultimap__insert)|Call this method to insert an element pair into the map.|  \n|[CRBMultiMap::RemoveKey](#crbmultimap__removekey)|Call this method to remove all of the key/value elements for a given key.|  \n  \n## Remarks  \n `CRBMultiMap` provides support for a mapping array of any given type, managing an ordered array of key elements and values. Unlike the [CRBMap](../../atl/reference/crbmap-class.md) class, each key can be associated with more than one value.  \n  \n Elements (consisting of a key and a value) are stored in a binary tree structure, using the [CRBMultiMap::Insert](#crbmultimap__insert) method. Elements can be removed using the [CRBMultiMap::RemoveKey](#crbmultimap__removekey) method, which deletes all elements which match the given key.  \n  \n Traversing the tree is made possible with methods such as [CRBTree::GetHeadPosition](../../atl/reference/crbtree-class.md#crbtree__getheadposition), [CRBTree::GetNext](../../atl/reference/crbtree-class.md#crbtree__getnext), and [CRBTree::GetNextValue](../../atl/reference/crbtree-class.md#crbtree__getnextvalue). Accessing the potentially multiple values per key is possible using the [CRBMultiMap::FindFirstWithKey](#crbmultimap__findfirstwithkey), [CRBMultiMap::GetNextValueWithKey](#crbmultimap__getnextvaluewithkey), and [CRBMultiMap::GetNextWithKey](#crbmultimap__getnextwithkey) methods. See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap) for an illustration of this in practice.  \n  \n The `KTraits` and `VTraits` parameters are traits classes that contain any supplemental code needed to copy or move elements.  \n  \n `CRBMultiMap` is derived from [CRBTree](../../atl/reference/crbtree-class.md), which implements a binary tree using the Red-Black algorithm. An alternative to `CRBMultiMap` and `CRBMap` is offered by the [CAtlMap](../../atl/reference/catlmap-class.md) class. When only a small number of elements needs to be stored, consider using the [CSimpleMap](../../atl/reference/csimplemap-class.md) class instead.  \n  \n For a more complete discussion of the various collection classes and their features and performance characteristics, see [ATL Collection Classes](../../atl/atl-collection-classes.md).  \n  \n## Inheritance Hierarchy  \n [CRBTree](../../atl/reference/crbtree-class.md)  \n  \n `CRBMultiMap`  \n  \n## Requirements  \n **Header:** atlcoll.h  \n  \n##  <a name=\"crbmultimap__crbmultimap\"></a>  CRBMultiMap::CRBMultiMap  \n The constructor.  \n  \n```\nexplicit CRBMultiMap(size_t nBlockSize = 10) throw();\n```  \n  \n### Parameters  \n `nBlockSize`  \n The block size.  \n  \n### Remarks  \n The `nBlockSize` parameter is a measure of the amount of memory allocated when a new element is required. Larger block sizes reduce calls to memory allocation routines, but use more resources. The default will allocate space for 10 elements at a time.  \n  \n See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available.  \n  \n### Example  \n [!code-cpp[NVC_ATL_Utilities#85](../../atl/codesnippet/cpp/crbmultimap-class_1.cpp)]  \n  \n##  <a name=\"crbmultimap___dtorcrbmultimap\"></a>  CRBMultiMap::~CRBMultiMap  \n The destructor.  \n  \n```\n~CRBMultiMap() throw();\n```  \n  \n### Remarks  \n Frees any allocated resources.  \n  \n See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available.  \n  \n##  <a name=\"crbmultimap__findfirstwithkey\"></a>  CRBMultiMap::FindFirstWithKey  \n Call this method to find the position of the first element with a given key.  \n  \n```\nPOSITION FindFirstWithKey(KINARGTYPE key) const throw();\n```  \n  \n### Parameters  \n `key`  \n Specifies the key that identifies the element to be found.  \n  \n### Return Value  \n Returns the POSITION of the first key/value element if the key is found, NULL otherwise.  \n  \n### Remarks  \n A key in the `CRBMultiMap` can have one or more associated values. This method will provide the position value of the first value (which may, in fact, be the only value) associated with that particular key. The position value returned can then be used with [CRBMultiMap::GetNextValueWithKey](#crbmultimap__getnextvaluewithkey) or [CRBMultiMap::GetNextWithKey](#crbmultimap__getnextwithkey) to obtain the value and update the position.  \n  \n See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available.  \n  \n### Example  \n See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap).  \n  \n##  <a name=\"crbmultimap__getnextvaluewithkey\"></a>  CRBMultiMap::GetNextValueWithKey  \n Call this method to get the value associated with a given key and update the position value.  \n  \n```\nconst V& GetNextValueWithKey(\n    POSITION& pos,\n    KINARGTYPE key) const throw();\nV& GetNextValueWithKey(\n    POSITION& pos,\n    KINARGTYPE key) throw();\n```  \n  \n### Parameters  \n `pos`  \n The position value, obtained with either a call to [CRBMultiMap::FindFirstWithKey](#crbmultimap__findfirstwithkey) or [CRBMultiMap::GetNextWithKey](#crbmultimap__getnextwithkey), or a previous call to `GetNextValueWithKey`.  \n  \n `key`  \n Specifies the key that identifies the element to be found.  \n  \n### Return Value  \n Returns the element pair associated with the given key.  \n  \n### Remarks  \n The position value is updated to point to the next value associated with the key. If no more values exist, the position value is set to NULL.  \n  \n See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available.  \n  \n### Example  \n See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap).  \n  \n##  <a name=\"crbmultimap__getnextwithkey\"></a>  CRBMultiMap::GetNextWithKey  \n Call this method to get the element associated with a given key and update the position value.  \n  \n```\nconst CPair* GetNextWithKey(\n    POSITION& pos,\n    KINARGTYPE key) const throw();\nCPair* GetNextWithKey(\n    POSITION& pos,\n    KINARGTYPE key) throw();\n```  \n  \n### Parameters  \n `pos`  \n The position value, obtained with either a call to [CRBMultiMap::FindFirstWithKey](#crbmultimap__findfirstwithkey) or [CRBMultiMap::GetNextValueWithKey](#crbmultimap__getnextvaluewithkey), or a previous call to `GetNextWithKey`.  \n  \n `key`  \n Specifies the key that identifies the element to be found.  \n  \n### Return Value  \n Returns the next [CRBTree::CPair Class](crbtree-class.md#crbtree__cpair_class) element associated with the given key.  \n  \n### Remarks  \n The position value is updated to point to the next value associated with the key. If no more values exist, the position value is set to NULL.  \n  \n See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available.  \n  \n##  <a name=\"crbmultimap__insert\"></a>  CRBMultiMap::Insert  \n Call this method to insert an element pair into the map.  \n  \n```\nPOSITION Insert(KINARGTYPE key,  VINARGTYPE value) throw(...);\n```  \n  \n### Parameters  \n `key`  \n The key value to add to the `CRBMultiMap` object.  \n  \n *value*  \n The value to add to the `CRBMultiMap` object, associated with `key`.  \n  \n### Return Value  \n Returns the position of the key/value element pair in the `CRBMultiMap` object.  \n  \n### Remarks  \n See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available.  \n  \n### Example  \n See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap).  \n  \n##  <a name=\"crbmultimap__removekey\"></a>  CRBMultiMap::RemoveKey  \n Call this method to remove all of the key/value elements for a given key.  \n  \n```\nsize_t RemoveKey(KINARGTYPE key) throw();\n```  \n  \n### Parameters  \n `key`  \n Specifies the key that identifies the element(s) to be deleted.  \n  \n### Return Value  \n Returns the number of values associated with the given key.  \n  \n### Remarks  \n `RemoveKey` deletes all of the key/value elements that have a key that matches `key`.  \n  \n See the documentation for the base class [CRBTree](../../atl/reference/crbtree-class.md) for information on the other methods available.  \n  \n### Example  \n See the example for [CRBMultiMap::CRBMultiMap](#crbmultimap__crbmultimap).  \n  \n## See Also  \n [CRBTree Class](../../atl/reference/crbtree-class.md)   \n [CAtlMap Class](../../atl/reference/catlmap-class.md)   \n [CRBMap Class](../../atl/reference/crbmap-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}