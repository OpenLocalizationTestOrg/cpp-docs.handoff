{"nodes":[{"pos":[12,52],"content":"CDaoFieldExchange Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDaoFieldExchange Class | Microsoft Docs","pos":[0,40]}]},{"content":"CDaoFieldExchange Class","pos":[991,1014]},{"content":"Supports the DAO record field exchange (DFX) routines used by the DAO database classes.","pos":[1015,1102]},{"content":"Syntax","pos":[1111,1117]},{"content":"Members","pos":[1167,1174]},{"content":"Public Methods","pos":[1184,1198]},{"content":"Name","pos":[1205,1209]},{"content":"Description","pos":[1210,1221]},{"content":"CDaoFieldExchange::IsValidOperation","pos":[1260,1295]},{"content":"Returns nonzero if the current operation is appropriate for the type of field being updated.","pos":[1335,1427]},{"content":"CDaoFieldExchange::SetFieldType","pos":[1433,1464]},{"pos":[1500,1659],"content":"Specifies the type of recordset data member — column or parameter — represented by all subsequent calls to DFX functions until the next call to <ph id=\"ph1\">`SetFieldType`</ph>.","source":"Specifies the type of recordset data member — column or parameter — represented by all subsequent calls to DFX functions until the next call to `SetFieldType`."},{"content":"Public Data Members","pos":[1670,1689]},{"content":"Name","pos":[1696,1700]},{"content":"Description","pos":[1701,1712]},{"content":"CDaoFieldExchange::m_nOperation","pos":[1751,1782]},{"pos":[1818,1925],"content":"The DFX operation being performed by the current call to the recordset's <ph id=\"ph1\">`DoFieldExchange`</ph> member function.","source":"The DFX operation being performed by the current call to the recordset's `DoFieldExchange` member function."},{"content":"CDaoFieldExchange::m_prs","pos":[1931,1955]},{"content":"A pointer to the recordset on which DFX operations are being performed.","pos":[1984,2055]},{"content":"Remarks","pos":[2065,2072]},{"pos":[2096,2123],"content":"does not have a base class."},{"content":"Use this class if you are writing data exchange routines for custom data types; otherwise, you will not directly use this class.","pos":[2130,2258]},{"content":"DFX exchanges data between the field data members of your <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept> object and the corresponding fields of the current record on the data source.","pos":[2259,2454],"source":" DFX exchanges data between the field data members of your [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object and the corresponding fields of the current record on the data source."},{"content":"DFX manages the exchange in both directions, from the data source and to the data source.","pos":[2455,2544]},{"content":"See <bpt id=\"p1\">[</bpt>Technical Note 53<ept id=\"p1\">](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md)</ept> for information about writing custom DFX routines.","pos":[2545,2684],"source":" See [Technical Note 53](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md) for information about writing custom DFX routines."},{"pos":[2692,3263],"content":"[!NOTE]\n The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC. The DAO-based classes can access data, including through ODBC drivers, via their own database engine. They also support Data Definition Language (DDL) operations, such as adding tables via the classes instead of having to call DAO yourself.","leadings":["","> "],"nodes":[{"content":" The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC. The DAO-based classes can access data, including through ODBC drivers, via their own database engine. They also support Data Definition Language (DDL) operations, such as adding tables via the classes instead of having to call DAO yourself.","pos":[8,569],"nodes":[{"content":"The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC).","pos":[1,112]},{"content":"All DAO database class names have the \"CDao\" prefix.","pos":[113,165]},{"content":"You can still access ODBC data sources with the DAO classes.","pos":[166,226]},{"content":"In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC.","pos":[227,320]},{"content":"The DAO-based classes can access data, including through ODBC drivers, via their own database engine.","pos":[321,422]},{"content":"They also support Data Definition Language (DDL) operations, such as adding tables via the classes instead of having to call DAO yourself.","pos":[423,561]}]}]},{"pos":[3271,3486],"content":"[!NOTE]\n DAO record field exchange (DFX) is very similar to record field exchange (RFX) in the ODBC-based MFC database classes ( `CDatabase`, `CRecordset`). If you understand RFX, you will find it easy to use DFX.","leadings":["","> "],"nodes":[{"content":" DAO record field exchange (DFX) is very similar to record field exchange (RFX) in the ODBC-based MFC database classes ( `CDatabase`, `CRecordset`). If you understand RFX, you will find it easy to use DFX.","pos":[8,213],"nodes":[{"content":"DAO record field exchange (DFX) is very similar to record field exchange (RFX) in the ODBC-based MFC database classes ( <ph id=\"ph1\">`CDatabase`</ph>, <ph id=\"ph2\">`CRecordset`</ph>).","pos":[1,148],"source":" DAO record field exchange (DFX) is very similar to record field exchange (RFX) in the ODBC-based MFC database classes ( `CDatabase`, `CRecordset`)."},{"content":"If you understand RFX, you will find it easy to use DFX.","pos":[149,205]}]}]},{"content":"A <ph id=\"ph1\">`CDaoFieldExchange`</ph> object provides the context information needed for DAO record field exchange to take place.","pos":[3493,3606],"source":"A `CDaoFieldExchange` object provides the context information needed for DAO record field exchange to take place."},{"content":"objects support a number of operations, including binding parameters and field data members and setting various flags on the fields of the current record.","pos":[3627,3781]},{"content":"DFX operations are performed on recordset-class data members of types defined by the <ph id=\"ph1\">`enum`</ph><bpt id=\"p1\">**</bpt>FieldType<ept id=\"p1\">**</ept> in <ph id=\"ph2\">`CDaoFieldExchange`</ph>.","pos":[3782,3910],"source":" DFX operations are performed on recordset-class data members of types defined by the `enum`**FieldType** in `CDaoFieldExchange`."},{"content":"Possible <bpt id=\"p1\">**</bpt>FieldType<ept id=\"p1\">**</ept> values are:","pos":[3911,3945],"source":" Possible **FieldType** values are:"},{"pos":[3953,4012],"content":"<bpt id=\"p1\">**</bpt>CDaoFieldExchange::outputColumn<ept id=\"p1\">**</ept> for field data members.","source":"**CDaoFieldExchange::outputColumn** for field data members."},{"pos":[4020,4076],"content":"<bpt id=\"p1\">**</bpt>CDaoFieldExchange::param<ept id=\"p1\">**</ept> for parameter data members.","source":"**CDaoFieldExchange::param** for parameter data members."},{"content":"The <bpt id=\"p1\">[</bpt>IsValidOperation<ept id=\"p1\">](#cdaofieldexchange__isvalidoperation)</ept> member function is provided for writing your own custom DFX routines.","pos":[4083,4213],"source":"The [IsValidOperation](#cdaofieldexchange__isvalidoperation) member function is provided for writing your own custom DFX routines."},{"content":"You will use <bpt id=\"p1\">[</bpt>SetFieldType<ept id=\"p1\">](#cdaofieldexchange__setfieldtype)</ept> frequently in your <bpt id=\"p2\">[</bpt>CDaoRecordset::DoFieldExchange<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__dofieldexchange)</ept> functions.","pos":[4214,4413],"source":" You will use [SetFieldType](#cdaofieldexchange__setfieldtype) frequently in your [CDaoRecordset::DoFieldExchange](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__dofieldexchange) functions."},{"content":"For details about the DFX global functions, see <bpt id=\"p1\">[</bpt>Record Field Exchange Functions<ept id=\"p1\">](../../mfc/reference/record-field-exchange-functions.md)</ept>.","pos":[4414,4552],"source":" For details about the DFX global functions, see [Record Field Exchange Functions](../../mfc/reference/record-field-exchange-functions.md)."},{"content":"For information about writing custom DFX routines for your own data types, see <bpt id=\"p1\">[</bpt>Technical Note 53<ept id=\"p1\">](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md)</ept>.","pos":[4553,4717],"source":" For information about writing custom DFX routines for your own data types, see [Technical Note 53](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md)."},{"content":"Inheritance Hierarchy","pos":[4726,4747]},{"content":"Requirements","pos":[4779,4791]},{"pos":[4795,4815],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdao.h","source":"**Header:** afxdao.h"},{"pos":[4877,4912],"content":"CDaoFieldExchange::IsValidOperation"},{"pos":[4916,5183],"content":"If you write your own DFX function, call <ph id=\"ph1\">`IsValidOperation`</ph> at the beginning of your function to determine whether the current operation can be performed on a particular field data member type (a <bpt id=\"p1\">**</bpt>CDaoFieldExchange::outputColumn<ept id=\"p1\">**</ept> or a <bpt id=\"p2\">**</bpt>CDaoFieldExchange::param<ept id=\"p2\">**</ept>).","source":"If you write your own DFX function, call `IsValidOperation` at the beginning of your function to determine whether the current operation can be performed on a particular field data member type (a **CDaoFieldExchange::outputColumn** or a **CDaoFieldExchange::param**)."},{"content":"Return Value","pos":[5233,5245]},{"content":"Nonzero if the current operation is appropriate for the type of field being updated.","pos":[5249,5333]},{"content":"Remarks","pos":[5343,5350]},{"content":"Some of the operations performed by the DFX mechanism apply only to one of the possible field types.","pos":[5354,5454]},{"content":"Follow the model of the existing DFX functions.","pos":[5455,5502]},{"pos":[5509,5657],"content":"For additional information on writing custom DFX routines, see <bpt id=\"p1\">[</bpt>Technical Note 53<ept id=\"p1\">](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md)</ept>.","source":"For additional information on writing custom DFX routines, see [Technical Note 53](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md)."},{"pos":[5715,5746],"content":"CDaoFieldExchange::m_nOperation"},{"pos":[5750,5907],"content":"Identifies the operation to be performed on the <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept> object associated with the field exchange object.","source":"Identifies the operation to be performed on the [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object associated with the field exchange object."},{"content":"Remarks","pos":[5917,5924]},{"pos":[5928,6038],"content":"The <ph id=\"ph1\">`CDaoFieldExchange`</ph> object supplies the context for a number of different DFX operations on the recordset.","source":"The `CDaoFieldExchange` object supplies the context for a number of different DFX operations on the recordset."},{"pos":[6046,6482],"content":"[!NOTE]\n The **PSEUDONULL** value described under the MarkForAddNew and SetFieldNull operations below is a value used to mark fields Null. The DAO record field exchange mechanism (DFX) uses this value to determine which fields have been explicitly marked Null. **PSEUDONULL** is not required for [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) and [COleCurrency](../../mfc/reference/colecurrency-class.md) fields.","leadings":["","> "],"nodes":[{"content":" The **PSEUDONULL** value described under the MarkForAddNew and SetFieldNull operations below is a value used to mark fields Null. The DAO record field exchange mechanism (DFX) uses this value to determine which fields have been explicitly marked Null. **PSEUDONULL** is not required for [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) and [COleCurrency](../../mfc/reference/colecurrency-class.md) fields.","pos":[8,434],"nodes":[{"content":"The <bpt id=\"p1\">**</bpt>PSEUDONULL<ept id=\"p1\">**</ept> value described under the MarkForAddNew and SetFieldNull operations below is a value used to mark fields Null.","pos":[1,130],"source":" The **PSEUDONULL** value described under the MarkForAddNew and SetFieldNull operations below is a value used to mark fields Null."},{"content":"The DAO record field exchange mechanism (DFX) uses this value to determine which fields have been explicitly marked Null.","pos":[131,252]},{"content":"<bpt id=\"p1\">**</bpt>PSEUDONULL<ept id=\"p1\">**</ept> is not required for <bpt id=\"p2\">[</bpt>COleDateTime<ept id=\"p2\">](../../atl-mfc-shared/reference/coledatetime-class.md)</ept> and <bpt id=\"p3\">[</bpt>COleCurrency<ept id=\"p3\">](../../mfc/reference/colecurrency-class.md)</ept> fields.","pos":[253,426],"source":"**PSEUDONULL** is not required for [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) and [COleCurrency](../../mfc/reference/colecurrency-class.md) fields."}]}]},{"pos":[6489,6529],"content":"Possible values of <bpt id=\"p1\">**</bpt>m_nOperation<ept id=\"p1\">**</ept> are:","source":"Possible values of **m_nOperation** are:"},{"content":"Operation","pos":[6536,6545]},{"content":"Description","pos":[6546,6557]},{"content":"AddToParameterList","pos":[6602,6620]},{"pos":[6623,6677],"content":"Builds the <bpt id=\"p1\">**</bpt>PARAMETERS<ept id=\"p1\">**</ept> clause of the SQL statement.","source":"Builds the **PARAMETERS** clause of the SQL statement."},{"content":"AddToSelectList","pos":[6684,6699]},{"pos":[6702,6752],"content":"Builds the <bpt id=\"p1\">**</bpt>SELECT<ept id=\"p1\">**</ept> clause of the SQL statement.","source":"Builds the **SELECT** clause of the SQL statement."},{"content":"BindField","pos":[6759,6768]},{"content":"Binds a field in the database to a memory location in your application.","pos":[6771,6842]},{"content":"BindParam","pos":[6849,6858]},{"content":"Sets parameter values for the recordset's query.","pos":[6861,6909]},{"content":"Fixup","pos":[6916,6921]},{"content":"Sets the Null status for a field.","pos":[6924,6957]},{"content":"AllocCache","pos":[6964,6974]},{"content":"Allocates the cache used to check for \"dirty\" fields in the recordset.","pos":[6977,7047]},{"content":"StoreField","pos":[7054,7064]},{"content":"Saves the current record to the cache.","pos":[7067,7105]},{"content":"LoadField","pos":[7112,7121]},{"content":"Restores the cached data member variables in the recordset.","pos":[7124,7183]},{"content":"FreeCache","pos":[7190,7199]},{"content":"Frees the cache used to check for \"dirty\" fields in the recordset.","pos":[7202,7268]},{"pos":[7288,7346],"content":"Sets a field's status to Null and value to <bpt id=\"p1\">**</bpt>PSEUDONULL<ept id=\"p1\">**</ept>.","source":"Sets a field's status to Null and value to **PSEUDONULL**."},{"content":"MarkForAddNew","pos":[7353,7366]},{"pos":[7369,7412],"content":"Marks fields \"dirty\" if not <bpt id=\"p1\">**</bpt>PSEUDONULL<ept id=\"p1\">**</ept>.","source":"Marks fields \"dirty\" if not **PSEUDONULL**."},{"content":"MarkForEdit","pos":[7419,7430]},{"content":"Marks fields \"dirty\" if they do not match the cache.","pos":[7433,7485]},{"content":"SetDirtyField","pos":[7492,7505]},{"content":"Sets field values marked as \"dirty.\"","pos":[7508,7544]},{"content":"DumpField","pos":[7551,7560]},{"content":"Dumps a field's contents (debug only).","pos":[7563,7601]},{"content":"MaxDFXOperation","pos":[7608,7623]},{"content":"Used for input checking.","pos":[7626,7650]},{"pos":[7702,7726],"content":"CDaoFieldExchange::m_prs"},{"pos":[7730,7870],"content":"Contains a pointer to the <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept> object associated with the <ph id=\"ph1\">`CDaoFieldExchange`</ph> object.","source":"Contains a pointer to the [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object associated with the `CDaoFieldExchange` object."},{"content":"Remarks","pos":[7880,7887]},{"pos":[7945,7976],"content":"CDaoFieldExchange::SetFieldType"},{"pos":[7980,8059],"content":"Call <ph id=\"ph1\">`SetFieldType`</ph> in your <ph id=\"ph2\">`CDaoRecordset`</ph> class's <ph id=\"ph3\">`DoFieldExchange`</ph> override.","source":"Call `SetFieldType` in your `CDaoRecordset` class's `DoFieldExchange` override."},{"content":"Parameters","pos":[8120,8130]},{"content":"A value of the <bpt id=\"p1\">**</bpt>enum FieldType<ept id=\"p1\">**</ept>, declared in <ph id=\"ph1\">`CDaoFieldExchange`</ph>, which can be either of the following:","pos":[8150,8255],"source":" A value of the **enum FieldType**, declared in `CDaoFieldExchange`, which can be either of the following:"},{"content":"CDaoFieldExchange::outputColumn","pos":[8265,8296]},{"content":"CDaoFieldExchange::param","pos":[8308,8332]},{"content":"Remarks","pos":[8344,8351]},{"content":"Normally, ClassWizard writes this call for you.","pos":[8355,8402]},{"content":"If you write your own function and are using the wizard to write your <ph id=\"ph1\">`DoFieldExchange`</ph> function, add calls to your own function outside the field map.","pos":[8403,8554],"source":" If you write your own function and are using the wizard to write your `DoFieldExchange` function, add calls to your own function outside the field map."},{"content":"If you do not use the wizard, there will not be a field map.","pos":[8555,8615]},{"content":"The call precedes calls to DFX functions, one for each field data member of your class, and identifies the field type as <bpt id=\"p1\">**</bpt>CDaoFieldExchange::outputColumn<ept id=\"p1\">**</ept>.","pos":[8616,8773],"source":" The call precedes calls to DFX functions, one for each field data member of your class, and identifies the field type as **CDaoFieldExchange::outputColumn**."},{"content":"If you parameterize your recordset class, you should add DFX calls for all parameter data members (outside the field map) and precede these calls with a call to <ph id=\"ph1\">`SetFieldType`</ph>.","pos":[8780,8956],"source":"If you parameterize your recordset class, you should add DFX calls for all parameter data members (outside the field map) and precede these calls with a call to `SetFieldType`."},{"content":"Pass the value <bpt id=\"p1\">**</bpt>CDaoFieldExchange::param<ept id=\"p1\">**</ept>.","pos":[8957,9001],"source":" Pass the value **CDaoFieldExchange::param**."},{"content":"(You can, instead, use a <bpt id=\"p1\">[</bpt>CDaoQueryDef<ept id=\"p1\">](../../mfc/reference/cdaoquerydef-class.md)</ept> and set its parameter values.)","pos":[9002,9115],"source":" (You can, instead, use a [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md) and set its parameter values.)"},{"content":"In general, each group of DFX function calls associated with field data members or parameter data members must be preceded by a call to <ph id=\"ph1\">`SetFieldType`</ph>.","pos":[9122,9273],"source":"In general, each group of DFX function calls associated with field data members or parameter data members must be preceded by a call to `SetFieldType`."},{"content":"The <ph id=\"ph1\">`nFieldType`</ph> parameter of each <ph id=\"ph2\">`SetFieldType`</ph> call identifies the type of the data members represented by the DFX function calls that follow the <ph id=\"ph3\">`SetFieldType`</ph> call.","pos":[9274,9443],"source":" The `nFieldType` parameter of each `SetFieldType` call identifies the type of the data members represented by the DFX function calls that follow the `SetFieldType` call."},{"content":"See Also","pos":[9452,9460]},{"content":"Hierarchy Chart","pos":[9465,9480]},{"content":"CDaoRecordset Class","pos":[9517,9536]}],"content":"---\ntitle: \"CDaoFieldExchange Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDaoFieldExchange\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DAO (Data Access Objects), record field exchange (DFX)\"\n  - \"field exchange\"\n  - \"DFX (DAO record field exchange)\"\n  - \"RFX (record field exchange), DAO classes\"\n  - \"field exchange, record for DAO classes\"\n  - \"exchanging data between databases and recordsets\"\n  - \"DFX (DAO record field exchange), DAO Record Field Exchange\"\n  - \"RFX (record field exchange)\"\n  - \"CDaoFieldExchange class\"\nms.assetid: 350a663e-92ff-44ab-ad53-d94efa2e5823\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDaoFieldExchange Class\nSupports the DAO record field exchange (DFX) routines used by the DAO database classes.  \n  \n## Syntax  \n  \n```  \nclass CDaoFieldExchange  \n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoFieldExchange::IsValidOperation](#cdaofieldexchange__isvalidoperation)|Returns nonzero if the current operation is appropriate for the type of field being updated.|  \n|[CDaoFieldExchange::SetFieldType](#cdaofieldexchange__setfieldtype)|Specifies the type of recordset data member — column or parameter — represented by all subsequent calls to DFX functions until the next call to `SetFieldType`.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoFieldExchange::m_nOperation](#cdaofieldexchange__m_noperation)|The DFX operation being performed by the current call to the recordset's `DoFieldExchange` member function.|  \n|[CDaoFieldExchange::m_prs](#cdaofieldexchange__m_prs)|A pointer to the recordset on which DFX operations are being performed.|  \n  \n## Remarks  \n `CDaoFieldExchange` does not have a base class.  \n  \n Use this class if you are writing data exchange routines for custom data types; otherwise, you will not directly use this class. DFX exchanges data between the field data members of your [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object and the corresponding fields of the current record on the data source. DFX manages the exchange in both directions, from the data source and to the data source. See [Technical Note 53](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md) for information about writing custom DFX routines.  \n  \n> [!NOTE]\n>  The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes. In general, the MFC classes based on DAO are more capable than the MFC classes based on ODBC. The DAO-based classes can access data, including through ODBC drivers, via their own database engine. They also support Data Definition Language (DDL) operations, such as adding tables via the classes instead of having to call DAO yourself.  \n  \n> [!NOTE]\n>  DAO record field exchange (DFX) is very similar to record field exchange (RFX) in the ODBC-based MFC database classes ( `CDatabase`, `CRecordset`). If you understand RFX, you will find it easy to use DFX.  \n  \n A `CDaoFieldExchange` object provides the context information needed for DAO record field exchange to take place. `CDaoFieldExchange` objects support a number of operations, including binding parameters and field data members and setting various flags on the fields of the current record. DFX operations are performed on recordset-class data members of types defined by the `enum`**FieldType** in `CDaoFieldExchange`. Possible **FieldType** values are:  \n  \n- **CDaoFieldExchange::outputColumn** for field data members.  \n  \n- **CDaoFieldExchange::param** for parameter data members.  \n  \n The [IsValidOperation](#cdaofieldexchange__isvalidoperation) member function is provided for writing your own custom DFX routines. You will use [SetFieldType](#cdaofieldexchange__setfieldtype) frequently in your [CDaoRecordset::DoFieldExchange](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__dofieldexchange) functions. For details about the DFX global functions, see [Record Field Exchange Functions](../../mfc/reference/record-field-exchange-functions.md). For information about writing custom DFX routines for your own data types, see [Technical Note 53](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md).  \n  \n## Inheritance Hierarchy  \n `CDaoFieldExchange`  \n  \n## Requirements  \n **Header:** afxdao.h  \n  \n##  <a name=\"cdaofieldexchange__isvalidoperation\"></a>  CDaoFieldExchange::IsValidOperation  \n If you write your own DFX function, call `IsValidOperation` at the beginning of your function to determine whether the current operation can be performed on a particular field data member type (a **CDaoFieldExchange::outputColumn** or a **CDaoFieldExchange::param**).  \n  \n```  \nBOOL IsValidOperation();\n```  \n  \n### Return Value  \n Nonzero if the current operation is appropriate for the type of field being updated.  \n  \n### Remarks  \n Some of the operations performed by the DFX mechanism apply only to one of the possible field types. Follow the model of the existing DFX functions.  \n  \n For additional information on writing custom DFX routines, see [Technical Note 53](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md).  \n  \n##  <a name=\"cdaofieldexchange__m_noperation\"></a>  CDaoFieldExchange::m_nOperation  \n Identifies the operation to be performed on the [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object associated with the field exchange object.  \n  \n### Remarks  \n The `CDaoFieldExchange` object supplies the context for a number of different DFX operations on the recordset.  \n  \n> [!NOTE]\n>  The **PSEUDONULL** value described under the MarkForAddNew and SetFieldNull operations below is a value used to mark fields Null. The DAO record field exchange mechanism (DFX) uses this value to determine which fields have been explicitly marked Null. **PSEUDONULL** is not required for [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) and [COleCurrency](../../mfc/reference/colecurrency-class.md) fields.  \n  \n Possible values of **m_nOperation** are:  \n  \n|Operation|Description|  \n|---------------|-----------------|  \n|**AddToParameterList**|Builds the **PARAMETERS** clause of the SQL statement.|  \n|**AddToSelectList**|Builds the **SELECT** clause of the SQL statement.|  \n|**BindField**|Binds a field in the database to a memory location in your application.|  \n|**BindParam**|Sets parameter values for the recordset's query.|  \n|**Fixup**|Sets the Null status for a field.|  \n|**AllocCache**|Allocates the cache used to check for \"dirty\" fields in the recordset.|  \n|**StoreField**|Saves the current record to the cache.|  \n|**LoadField**|Restores the cached data member variables in the recordset.|  \n|**FreeCache**|Frees the cache used to check for \"dirty\" fields in the recordset.|  \n|`SetFieldNull`|Sets a field's status to Null and value to **PSEUDONULL**.|  \n|**MarkForAddNew**|Marks fields \"dirty\" if not **PSEUDONULL**.|  \n|**MarkForEdit**|Marks fields \"dirty\" if they do not match the cache.|  \n|**SetDirtyField**|Sets field values marked as \"dirty.\"|  \n|**DumpField**|Dumps a field's contents (debug only).|  \n|**MaxDFXOperation**|Used for input checking.|  \n  \n##  <a name=\"cdaofieldexchange__m_prs\"></a>  CDaoFieldExchange::m_prs  \n Contains a pointer to the [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object associated with the `CDaoFieldExchange` object.  \n  \n### Remarks  \n  \n##  <a name=\"cdaofieldexchange__setfieldtype\"></a>  CDaoFieldExchange::SetFieldType  \n Call `SetFieldType` in your `CDaoRecordset` class's `DoFieldExchange` override.  \n  \n```  \nvoid SetFieldType(UINT nFieldType);\n```  \n  \n### Parameters  \n `nFieldType`  \n A value of the **enum FieldType**, declared in `CDaoFieldExchange`, which can be either of the following:  \n  \n- **CDaoFieldExchange::outputColumn**  \n  \n- **CDaoFieldExchange::param**  \n  \n### Remarks  \n Normally, ClassWizard writes this call for you. If you write your own function and are using the wizard to write your `DoFieldExchange` function, add calls to your own function outside the field map. If you do not use the wizard, there will not be a field map. The call precedes calls to DFX functions, one for each field data member of your class, and identifies the field type as **CDaoFieldExchange::outputColumn**.  \n  \n If you parameterize your recordset class, you should add DFX calls for all parameter data members (outside the field map) and precede these calls with a call to `SetFieldType`. Pass the value **CDaoFieldExchange::param**. (You can, instead, use a [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md) and set its parameter values.)  \n  \n In general, each group of DFX function calls associated with field data members or parameter data members must be preceded by a call to `SetFieldType`. The `nFieldType` parameter of each `SetFieldType` call identifies the type of the data members represented by the DFX function calls that follow the `SetFieldType` call.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CDaoRecordset Class](../../mfc/reference/cdaorecordset-class.md)\n"}