{"nodes":[{"pos":[12,55],"content":"Using IDispEventSimpleImpl | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using IDispEventSimpleImpl | Microsoft Docs","pos":[0,43]}]},{"content":"Using IDispEventSimpleImpl","pos":[639,665]},{"pos":[666,735],"content":"When using <ph id=\"ph1\">`IDispEventSimpleImpl`</ph> to handle events, you will need to:","source":"When using `IDispEventSimpleImpl` to handle events, you will need to:"},{"pos":[745,839],"content":"Derive your class from <bpt id=\"p1\">[</bpt>IDispEventSimpleImpl<ept id=\"p1\">](../atl/reference/idispeventsimpleimpl-class.md)</ept>.","source":"Derive your class from [IDispEventSimpleImpl](../atl/reference/idispeventsimpleimpl-class.md)."},{"pos":[849,959],"content":"Add an <bpt id=\"p1\">[</bpt>event sink map<ept id=\"p1\">](http://msdn.microsoft.com/library/32542b3d-ac43-4139-8ac4-41c48481744f)</ept> to your class.","source":"Add an [event sink map](http://msdn.microsoft.com/library/32542b3d-ac43-4139-8ac4-41c48481744f) to your class."},{"pos":[969,1071],"content":"Define <bpt id=\"p1\">[</bpt>_ATL_FUNC_INFO<ept id=\"p1\">](../atl/reference/atl-func-info-structure.md)</ept> structures describing the events.","source":"Define [_ATL_FUNC_INFO](../atl/reference/atl-func-info-structure.md) structures describing the events."},{"pos":[1081,1221],"content":"Add entries to the event sink map using the <bpt id=\"p1\">[</bpt>SINK_ENTRY_INFO<ept id=\"p1\">](http://msdn.microsoft.com/library/1a0ae260-2c82-4926-a537-db01e5f206a7)</ept> macro.","source":"Add entries to the event sink map using the [SINK_ENTRY_INFO](http://msdn.microsoft.com/library/1a0ae260-2c82-4926-a537-db01e5f206a7) macro."},{"content":"Implement the methods that you're interested in handling.","pos":[1231,1288]},{"content":"Advise and unadvise the event source.","pos":[1298,1335]},{"content":"Example","pos":[1344,1351]},{"content":"The example below shows you how to handle the <bpt id=\"p1\">**</bpt>DocumentChange<ept id=\"p1\">**</ept> event fired by Word's <bpt id=\"p2\">**</bpt>Application<ept id=\"p2\">**</ept> object.","pos":[1355,1465],"source":"The example below shows you how to handle the **DocumentChange** event fired by Word's **Application** object."},{"content":"This event is defined as a method on the <bpt id=\"p1\">**</bpt>ApplicationEvents<ept id=\"p1\">**</ept> dispinterface.","pos":[1466,1543],"source":" This event is defined as a method on the **ApplicationEvents** dispinterface."},{"pos":[1550,1626],"content":"The example is from the <bpt id=\"p1\">[</bpt>ATLEventHandling sample<ept id=\"p1\">](../visual-cpp-samples.md)</ept>.","source":"The example is from the [ATLEventHandling sample](../visual-cpp-samples.md)."},{"content":"The example uses <ph id=\"ph1\">`#import`</ph> to generate the required header files from Word's type library.","pos":[1981,2071],"source":"The example uses `#import` to generate the required header files from Word's type library."},{"content":"If you want to use this example with other versions of Word, you must specify the correct mso dll file.","pos":[2072,2175]},{"content":"For example, Office 2000 provides mso9.dll and OfficeXP provides mso.dll.","pos":[2176,2249]},{"content":"This code is simplified from stdafx.h:","pos":[2250,2288]},{"pos":[2306,2335],"content":"NVC_ATL_EventHandlingSample#1"},{"content":"The only information from the type library actually used in this example is the CLSID of the Word <bpt id=\"p1\">**</bpt>Application<ept id=\"p1\">**</ept> object and the IID of the <bpt id=\"p2\">**</bpt>ApplicationEvents<ept id=\"p2\">**</ept> interface.","pos":[2399,2571],"source":"The only information from the type library actually used in this example is the CLSID of the Word **Application** object and the IID of the **ApplicationEvents** interface."},{"content":"This information is only used at compile time.","pos":[2572,2618]},{"content":"The following code appears in Simple.h.","pos":[2625,2664]},{"content":"The relevant code is noted by comments:","pos":[2665,2704]},{"pos":[2722,2751],"content":"NVC_ATL_EventHandlingSample#3"},{"content":"The following code is from Simple.cpp:","pos":[2815,2853]},{"pos":[2871,2900],"content":"NVC_ATL_EventHandlingSample#4"},{"content":"See Also","pos":[2968,2976]},{"content":"Event Handling","pos":[2981,2995]},{"content":"ATLEventHandling Sample","pos":[3036,3059]}],"content":"---\ntitle: \"Using IDispEventSimpleImpl | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"IDispEventSimpleImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IDispEventSimpleImpl class, using\"\nms.assetid: 8640ad1a-4bd0-40a5-b5e4-7322685d7aab\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Using IDispEventSimpleImpl\nWhen using `IDispEventSimpleImpl` to handle events, you will need to:  \n  \n-   Derive your class from [IDispEventSimpleImpl](../atl/reference/idispeventsimpleimpl-class.md).  \n  \n-   Add an [event sink map](http://msdn.microsoft.com/library/32542b3d-ac43-4139-8ac4-41c48481744f) to your class.  \n  \n-   Define [_ATL_FUNC_INFO](../atl/reference/atl-func-info-structure.md) structures describing the events.  \n  \n-   Add entries to the event sink map using the [SINK_ENTRY_INFO](http://msdn.microsoft.com/library/1a0ae260-2c82-4926-a537-db01e5f206a7) macro.  \n  \n-   Implement the methods that you're interested in handling.  \n  \n-   Advise and unadvise the event source.  \n  \n## Example  \n The example below shows you how to handle the **DocumentChange** event fired by Word's **Application** object. This event is defined as a method on the **ApplicationEvents** dispinterface.  \n  \n The example is from the [ATLEventHandling sample](../visual-cpp-samples.md).  \n  \n `[`  \n  \n `uuid(000209F7-0000-0000-C000-000000000046),`  \n  \n `hidden`  \n  \n `]`  \n  \n `dispinterface ApplicationEvents {`  \n  \n `properties:`  \n  \n `methods:`  \n  \n `[id(0x00000001), restricted, hidden]`  \n  \n `void Startup();`  \n  \n `[id(0x00000002)]`  \n  \n `void Quit();`  \n  \n `[id(0x00000003)]`  \n  \n `void DocumentChange();`  \n  \n `};`  \n  \n The example uses `#import` to generate the required header files from Word's type library. If you want to use this example with other versions of Word, you must specify the correct mso dll file. For example, Office 2000 provides mso9.dll and OfficeXP provides mso.dll. This code is simplified from stdafx.h:  \n  \n [!code-cpp[NVC_ATL_EventHandlingSample#1](../atl/codesnippet/cpp/using-idispeventsimpleimpl_1.h)]  \n  \n The only information from the type library actually used in this example is the CLSID of the Word **Application** object and the IID of the **ApplicationEvents** interface. This information is only used at compile time.  \n  \n The following code appears in Simple.h. The relevant code is noted by comments:  \n  \n [!code-cpp[NVC_ATL_EventHandlingSample#3](../atl/codesnippet/cpp/using-idispeventsimpleimpl_2.h)]  \n  \n The following code is from Simple.cpp:  \n  \n [!code-cpp[NVC_ATL_EventHandlingSample#4](../atl/codesnippet/cpp/using-idispeventsimpleimpl_3.cpp)]  \n  \n## See Also  \n [Event Handling](../atl/event-handling-and-atl.md)   \n [ATLEventHandling Sample](../visual-cpp-samples.md)\n\n"}