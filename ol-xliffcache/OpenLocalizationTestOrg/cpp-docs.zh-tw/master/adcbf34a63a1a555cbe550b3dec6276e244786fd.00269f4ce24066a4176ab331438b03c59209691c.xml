{"nodes":[{"pos":[12,75],"content":"Threading Models and Critical Sections Classes | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Threading Models and Critical Sections Classes | Microsoft Docs","pos":[0,63]}]},{"content":"Threading Models and Critical Sections Classes","pos":[729,775]},{"content":"The following classes define a threading model and critical section:","pos":[776,844]},{"pos":[854,980],"content":"<bpt id=\"p1\">[</bpt>CAtlAutoThreadModule<ept id=\"p1\">](../atl/reference/catlautothreadmodule-class.md)</ept> Implements a thread-pooled, apartment-model COM server.","source":"[CAtlAutoThreadModule](../atl/reference/catlautothreadmodule-class.md) Implements a thread-pooled, apartment-model COM server."},{"pos":[990,1141],"content":"<bpt id=\"p1\">[</bpt>CAtlAutoThreadModuleT<ept id=\"p1\">](../atl/reference/catlautothreadmodulet-class.md)</ept> Provides methods for implementing a thread-pooled, apartment-model COM server.","source":"[CAtlAutoThreadModuleT](../atl/reference/catlautothreadmodulet-class.md) Provides methods for implementing a thread-pooled, apartment-model COM server."},{"content":"<bpt id=\"p1\">[</bpt>CComMultiThreadModel<ept id=\"p1\">](../atl/reference/ccommultithreadmodel-class.md)</ept> Provides thread-safe methods for incrementing and decrementing a variable.","pos":[1151,1296],"source":"[CComMultiThreadModel](../atl/reference/ccommultithreadmodel-class.md) Provides thread-safe methods for incrementing and decrementing a variable."},{"content":"Provides a critical section.","pos":[1297,1325]},{"content":"<bpt id=\"p1\">[</bpt>CComMultiThreadModelNoCS<ept id=\"p1\">](../atl/reference/ccommultithreadmodelnocs-class.md)</ept> Provides thread-safe methods for incrementing and decrementing a variable.","pos":[1335,1488],"source":"[CComMultiThreadModelNoCS](../atl/reference/ccommultithreadmodelnocs-class.md) Provides thread-safe methods for incrementing and decrementing a variable."},{"content":"Does not provide a critical section.","pos":[1489,1525]},{"content":"<bpt id=\"p1\">[</bpt>CComSingleThreadModel<ept id=\"p1\">](../atl/reference/ccomsinglethreadmodel-class.md)</ept> Provides methods for incrementing and decrementing a variable.","pos":[1535,1670],"source":"[CComSingleThreadModel](../atl/reference/ccomsinglethreadmodel-class.md) Provides methods for incrementing and decrementing a variable."},{"content":"Does not provide a critical section.","pos":[1671,1707]},{"pos":[1717,1872],"content":"<bpt id=\"p1\">[</bpt>CComObjectThreadModel<ept id=\"p1\">](../atl/reference/atl-typedefs.md#ccomobjectthreadmodel)</ept> Determines the appropriate threading-model class for a single object class.","source":"[CComObjectThreadModel](../atl/reference/atl-typedefs.md#ccomobjectthreadmodel) Determines the appropriate threading-model class for a single object class."},{"pos":[1882,2054],"content":"<bpt id=\"p1\">[</bpt>CComGlobalsThreadModel<ept id=\"p1\">](../atl/reference/atl-typedefs.md#ccomglobalsthreadmodel)</ept> Determines the appropriate threading-model class for an object that is globally available.","source":"[CComGlobalsThreadModel](../atl/reference/atl-typedefs.md#ccomglobalsthreadmodel) Determines the appropriate threading-model class for an object that is globally available."},{"content":"<bpt id=\"p1\">[</bpt>CComAutoCriticalSection<ept id=\"p1\">](../atl/reference/ccomautocriticalsection-class.md)</ept> Contains methods for obtaining and releasing a critical section.","pos":[2064,2205],"source":"[CComAutoCriticalSection](../atl/reference/ccomautocriticalsection-class.md) Contains methods for obtaining and releasing a critical section."},{"content":"The critical section is automatically initialized.","pos":[2206,2256]},{"content":"<bpt id=\"p1\">[</bpt>CComCriticalSection<ept id=\"p1\">](../atl/reference/ccomcriticalsection-class.md)</ept> Contains methods for obtaining and releasing a critical section.","pos":[2266,2399],"source":"[CComCriticalSection](../atl/reference/ccomcriticalsection-class.md) Contains methods for obtaining and releasing a critical section."},{"content":"The critical section must be explicitly initialized.","pos":[2400,2452]},{"content":"<bpt id=\"p1\">[</bpt>CComFakeCriticalSection<ept id=\"p1\">](../atl/reference/ccomfakecriticalsection-class.md)</ept> Mirrors the methods in <ph id=\"ph1\">`CComCriticalSection`</ph> without providing a critical section.","pos":[2462,2621],"source":"[CComFakeCriticalSection](../atl/reference/ccomfakecriticalsection-class.md) Mirrors the methods in `CComCriticalSection` without providing a critical section."},{"content":"The methods in <ph id=\"ph1\">`CComFakeCriticalSection`</ph> do nothing.","pos":[2622,2674],"source":" The methods in `CComFakeCriticalSection` do nothing."},{"content":"<bpt id=\"p1\">[</bpt>CRTThreadTraits<ept id=\"p1\">](../atl/reference/crtthreadtraits-class.md)</ept> Provides the creation function for a CRT thread.","pos":[2684,2793],"source":"[CRTThreadTraits](../atl/reference/crtthreadtraits-class.md) Provides the creation function for a CRT thread."},{"content":"Use this class if the thread will use CRT functions.","pos":[2794,2846]},{"content":"<bpt id=\"p1\">[</bpt>Win32ThreadTraits<ept id=\"p1\">](../atl/reference/win32threadtraits-class.md)</ept> Provides the creation function for a Windows thread.","pos":[2856,2973],"source":"[Win32ThreadTraits](../atl/reference/win32threadtraits-class.md) Provides the creation function for a Windows thread."},{"content":"Use this class if the thread will not use CRT functions.","pos":[2974,3030]},{"content":"See Also","pos":[3039,3047]},{"content":"Class Overview","pos":[3052,3066]}],"content":"---\ntitle: \"Threading Models and Critical Sections Classes | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.atl.threads.models\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ATL, critical sections\"\n  - \"ATL, multithreading\"\n  - \"threading [ATL], models\"\n  - \"critical sections\"\nms.assetid: 759f05ef-6285-4be6-a2cc-78572dd75146\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Threading Models and Critical Sections Classes\nThe following classes define a threading model and critical section:  \n  \n-   [CAtlAutoThreadModule](../atl/reference/catlautothreadmodule-class.md) Implements a thread-pooled, apartment-model COM server.  \n  \n-   [CAtlAutoThreadModuleT](../atl/reference/catlautothreadmodulet-class.md) Provides methods for implementing a thread-pooled, apartment-model COM server.  \n  \n-   [CComMultiThreadModel](../atl/reference/ccommultithreadmodel-class.md) Provides thread-safe methods for incrementing and decrementing a variable. Provides a critical section.  \n  \n-   [CComMultiThreadModelNoCS](../atl/reference/ccommultithreadmodelnocs-class.md) Provides thread-safe methods for incrementing and decrementing a variable. Does not provide a critical section.  \n  \n-   [CComSingleThreadModel](../atl/reference/ccomsinglethreadmodel-class.md) Provides methods for incrementing and decrementing a variable. Does not provide a critical section.  \n  \n-   [CComObjectThreadModel](../atl/reference/atl-typedefs.md#ccomobjectthreadmodel) Determines the appropriate threading-model class for a single object class.  \n  \n-   [CComGlobalsThreadModel](../atl/reference/atl-typedefs.md#ccomglobalsthreadmodel) Determines the appropriate threading-model class for an object that is globally available.  \n  \n-   [CComAutoCriticalSection](../atl/reference/ccomautocriticalsection-class.md) Contains methods for obtaining and releasing a critical section. The critical section is automatically initialized.  \n  \n-   [CComCriticalSection](../atl/reference/ccomcriticalsection-class.md) Contains methods for obtaining and releasing a critical section. The critical section must be explicitly initialized.  \n  \n-   [CComFakeCriticalSection](../atl/reference/ccomfakecriticalsection-class.md) Mirrors the methods in `CComCriticalSection` without providing a critical section. The methods in `CComFakeCriticalSection` do nothing.  \n  \n-   [CRTThreadTraits](../atl/reference/crtthreadtraits-class.md) Provides the creation function for a CRT thread. Use this class if the thread will use CRT functions.  \n  \n-   [Win32ThreadTraits](../atl/reference/win32threadtraits-class.md) Provides the creation function for a Windows thread. Use this class if the thread will not use CRT functions.  \n  \n## See Also  \n [Class Overview](../atl/atl-class-overview.md)\n\n"}