{"nodes":[{"pos":[12,61],"content":"TN001: Window Class Registration | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"TN001: Window Class Registration | Microsoft Docs","pos":[0,49]}]},{"content":"TN001: Window Class Registration","pos":[659,691]},{"content":"This note describes the MFC routines that register the special <bpt id=\"p1\">[</bpt>WNDCLASS<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms633576)</ept>es needed by Microsoft Windows.","pos":[692,856],"source":"This note describes the MFC routines that register the special [WNDCLASS](http://msdn.microsoft.com/library/windows/desktop/ms633576)es needed by Microsoft Windows."},{"content":"Specific <ph id=\"ph1\">`WNDCLASS`</ph> attributes used by MFC and Windows are discussed.","pos":[857,926],"source":" Specific `WNDCLASS` attributes used by MFC and Windows are discussed."},{"content":"The Problem","pos":[935,946]},{"content":"The attributes of a <bpt id=\"p1\">[</bpt>CWnd<ept id=\"p1\">](../mfc/reference/cwnd-class.md)</ept> object, like an <ph id=\"ph1\">`HWND`</ph> handle in Windows, are stored in two places: the window object and the <ph id=\"ph2\">`WNDCLASS`</ph>.","pos":[950,1114],"source":"The attributes of a [CWnd](../mfc/reference/cwnd-class.md) object, like an `HWND` handle in Windows, are stored in two places: the window object and the `WNDCLASS`."},{"content":"The name of the <ph id=\"ph1\">`WNDCLASS`</ph> is passed to general window creation functions such as <bpt id=\"p1\">[</bpt>CWnd::Create<ept id=\"p1\">](../mfc/reference/cwnd-class.md#cwnd__create)</ept> and <bpt id=\"p2\">[</bpt>CFrameWnd::Create<ept id=\"p2\">](../mfc/reference/cframewnd-class.md#cframewnd__create)</ept> in the <ph id=\"ph2\">`lpszClassName`</ph> parameter.","pos":[1115,1369],"source":" The name of the `WNDCLASS` is passed to general window creation functions such as [CWnd::Create](../mfc/reference/cwnd-class.md#cwnd__create) and [CFrameWnd::Create](../mfc/reference/cframewnd-class.md#cframewnd__create) in the `lpszClassName` parameter."},{"pos":[1376,1437],"content":"This <ph id=\"ph1\">`WNDCLASS`</ph> must be registered through one of four means:","source":"This `WNDCLASS` must be registered through one of four means:"},{"pos":[1447,1493],"content":"Implicitly by using a MFC provided <ph id=\"ph1\">`WNDCLASS`</ph>.","source":"Implicitly by using a MFC provided `WNDCLASS`."},{"content":"Implicitly by subclassing a Windows control (or some other control).","pos":[1503,1571]},{"pos":[1581,1812],"content":"Explicitly by calling the MFC <bpt id=\"p1\">[</bpt>AfxRegisterWndClass<ept id=\"p1\">](../mfc/reference/application-information-and-management.md#afxregisterwndclass)</ept> or <bpt id=\"p2\">[</bpt>AfxRegisterClass<ept id=\"p2\">](../mfc/reference/application-information-and-management.md#afxregisterclass)</ept>.","source":"Explicitly by calling the MFC [AfxRegisterWndClass](../mfc/reference/application-information-and-management.md#afxregisterwndclass) or [AfxRegisterClass](../mfc/reference/application-information-and-management.md#afxregisterclass)."},{"pos":[1822,1940],"content":"Explicitly by calling the Windows routine <bpt id=\"p1\">[</bpt>RegisterClass<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms633586)</ept>.","source":"Explicitly by calling the Windows routine [RegisterClass](http://msdn.microsoft.com/library/windows/desktop/ms633586)."},{"content":"WNDCLASS Fields","pos":[1949,1964]},{"content":"The <ph id=\"ph1\">`WNDCLASS`</ph> structure consists of various fields that describe a window class.","pos":[1968,2049],"source":"The `WNDCLASS` structure consists of various fields that describe a window class."},{"content":"The following table shows the fields and specifies how they are used in an MFC application:","pos":[2050,2141]},{"content":"Field","pos":[2148,2153]},{"content":"Description","pos":[2154,2165]},{"pos":[2218,2241],"content":"window proc, must be an"},{"content":"not used (should be zero)","pos":[2272,2297]},{"content":"not used (should be zero)","pos":[2315,2340]},{"pos":[2357,2486],"content":"automatically filled with <bpt id=\"p1\">[</bpt>AfxGetInstanceHandle<ept id=\"p1\">](../mfc/reference/application-information-and-management.md#afxgetinstancehandle)</ept>","source":"automatically filled with [AfxGetInstanceHandle](../mfc/reference/application-information-and-management.md#afxgetinstancehandle)"},{"content":"icon for frame windows, see below","pos":[2499,2532]},{"content":"cursor for when mouse is over window, see below","pos":[2547,2594]},{"content":"background color, see below","pos":[2615,2642]},{"content":"not used (should be NULL)","pos":[2662,2687]},{"content":"class name, see below","pos":[2708,2729]},{"content":"Provided WNDCLASSes","pos":[2739,2758]},{"content":"Earlier versions of MFC (before MFC 4.0), provided several predefined Window classes.","pos":[2762,2847]},{"content":"These Window classes are no longer provided by default.","pos":[2848,2903]},{"content":"Applications should use <ph id=\"ph1\">`AfxRegisterWndClass`</ph> with the appropriate parameters.","pos":[2904,2982],"source":" Applications should use `AfxRegisterWndClass` with the appropriate parameters."},{"content":"If the application provides a resource with the specified resource ID (for example, AFX_IDI_STD_FRAME), MFC will use that resource.","pos":[2989,3120]},{"content":"Otherwise it will use the default resource.","pos":[3121,3164]},{"content":"For the icon, the standard application icon is used, and for the cursor, the standard arrow cursor is used.","pos":[3165,3272]},{"content":"Two icons support MDI applications with single document types: one icon for the main application, the other icon for iconic document/MDIChild windows.","pos":[3279,3429]},{"content":"For multiple document types with different icons, you must register additional <ph id=\"ph1\">`WNDCLASS`</ph>es or use the <bpt id=\"p1\">[</bpt>CFrameWnd::LoadFrame<ept id=\"p1\">](../mfc/reference/cframewnd-class.md#cframewnd__loadframe)</ept> function.","pos":[3430,3623],"source":" For multiple document types with different icons, you must register additional `WNDCLASS`es or use the [CFrameWnd::LoadFrame](../mfc/reference/cframewnd-class.md#cframewnd__loadframe) function."},{"pos":[3653,3771],"content":"will register a <ph id=\"ph1\">`WNDCLASS`</ph> using the icon ID you specify as the first parameter and the following standard attributes:","source":" will register a `WNDCLASS` using the icon ID you specify as the first parameter and the following standard attributes:"},{"content":"class style : CS_DBLCLKS &amp;#124; CS_HREDRAW &amp;#124; CS_VREDRAW;","pos":[3781,3842],"source":"class style : CS_DBLCLKS &#124; CS_HREDRAW &#124; CS_VREDRAW;"},{"content":"icon AFX_IDI_STD_FRAME","pos":[3852,3874]},{"content":"arrow cursor","pos":[3884,3896]},{"content":"COLOR_WINDOW background color","pos":[3906,3935]},{"content":"The values for background color and cursor for the <bpt id=\"p1\">[</bpt>CMDIFrameWnd<ept id=\"p1\">](../mfc/reference/cmdiframewnd-class.md)</ept> are not used since the client area of the <ph id=\"ph1\">`CMDIFrameWnd`</ph> is completely covered by the <bpt id=\"p2\">**</bpt>MDICLIENT<ept id=\"p2\">**</ept> window.","pos":[3942,4155],"source":"The values for background color and cursor for the [CMDIFrameWnd](../mfc/reference/cmdiframewnd-class.md) are not used since the client area of the `CMDIFrameWnd` is completely covered by the **MDICLIENT** window."},{"content":"Microsoft does not encourage subclassing the <bpt id=\"p1\">**</bpt>MDICLIENT<ept id=\"p1\">**</ept> window so use the standard colors and cursor types when possible.","pos":[4156,4280],"source":" Microsoft does not encourage subclassing the **MDICLIENT** window so use the standard colors and cursor types when possible."},{"content":"Subclassing and Superclassing Controls","pos":[4289,4327]},{"pos":[4331,4555],"content":"If you subclass or superclass a Windows control (for example, <bpt id=\"p1\">[</bpt>CButton<ept id=\"p1\">](../mfc/reference/cbutton-class.md)</ept>) then your class automatically gets the <ph id=\"ph1\">`WNDCLASS`</ph> attributes provided in the Windows implementation of that control.","source":"If you subclass or superclass a Windows control (for example, [CButton](../mfc/reference/cbutton-class.md)) then your class automatically gets the `WNDCLASS` attributes provided in the Windows implementation of that control."},{"content":"The AfxRegisterWndClass Function","pos":[4564,4596]},{"content":"MFC provides a helper function for registering a window class.","pos":[4600,4662]},{"content":"Given a set of attributes (window class style, cursor, background brush, and icon), a synthetic name is generated, and the resulting window class is registered.","pos":[4663,4823]},{"content":"For example,","pos":[4824,4836]},{"content":"This function returns a temporary string of the generated registered window class name.","pos":[4973,5060]},{"content":"For more information about this function, see <bpt id=\"p1\">[</bpt>AfxRegisterWndClass<ept id=\"p1\">](../mfc/reference/application-information-and-management.md#afxregisterwndclass)</ept>.","pos":[5061,5209],"source":" For more information about this function, see [AfxRegisterWndClass](../mfc/reference/application-information-and-management.md#afxregisterwndclass)."},{"content":"The returned string is a temporary pointer to a static string buffer.","pos":[5216,5285]},{"content":"It is valid until the next call to <ph id=\"ph1\">`AfxRegisterWndClass`</ph>.","pos":[5286,5343],"source":" It is valid until the next call to `AfxRegisterWndClass`."},{"content":"If you want to keep this string around, store it in a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../atl-mfc-shared/using-cstring.md)</ept> variable, as in this example:","pos":[5344,5473],"source":" If you want to keep this string around, store it in a [CString](../atl-mfc-shared/using-cstring.md) variable, as in this example:"},{"pos":[5647,5827],"content":"will throw a <bpt id=\"p1\">[</bpt>CResourceException<ept id=\"p1\">](../mfc/reference/cresourceexception-class.md)</ept> if the window class failed to register (either because of bad parameters, or out of Windows memory).","source":" will throw a [CResourceException](../mfc/reference/cresourceexception-class.md) if the window class failed to register (either because of bad parameters, or out of Windows memory)."},{"content":"The RegisterClass and AfxRegisterClass Functions","pos":[5836,5884]},{"content":"If you want to do anything more sophisticated than what <ph id=\"ph1\">`AfxRegisterWndClass`</ph> provides, you can call the Windows API <ph id=\"ph2\">`RegisterClass`</ph> or the MFC function <ph id=\"ph3\">`AfxRegisterClass`</ph>.","pos":[5888,6060],"source":"If you want to do anything more sophisticated than what `AfxRegisterWndClass` provides, you can call the Windows API `RegisterClass` or the MFC function `AfxRegisterClass`."},{"content":"The <ph id=\"ph1\">`CWnd`</ph>, <bpt id=\"p1\">[</bpt>CFrameWnd<ept id=\"p1\">](../mfc/reference/cframewnd-class.md)</ept> and <bpt id=\"p2\">[</bpt>CMDIChildWnd<ept id=\"p2\">](../mfc/reference/cmdichildwnd-class.md)</ept> <ph id=\"ph2\">`Create`</ph> functions take a <ph id=\"ph3\">`lpszClassName`</ph> string name for the window class as the first parameter.","pos":[6061,6279],"source":" The `CWnd`, [CFrameWnd](../mfc/reference/cframewnd-class.md) and [CMDIChildWnd](../mfc/reference/cmdichildwnd-class.md) `Create` functions take a `lpszClassName` string name for the window class as the first parameter."},{"content":"You can use any registered window class name, regardless of the method you used to register it.","pos":[6280,6375]},{"content":"It is important to use <ph id=\"ph1\">`AfxRegisterClass`</ph> (or <ph id=\"ph2\">`AfxRegisterWndClass`</ph>) in a DLL on Win32.","pos":[6382,6469],"source":"It is important to use `AfxRegisterClass` (or `AfxRegisterWndClass`) in a DLL on Win32."},{"content":"Win32 does not automatically unregister classes registered by a DLL, so you must explicitly unregister classes when the DLL is terminated.","pos":[6470,6608]},{"content":"By using <ph id=\"ph1\">`AfxRegisterClass`</ph> instead of <ph id=\"ph2\">`RegisterClass`</ph> this is handled automatically for you.","pos":[6609,6702],"source":" By using `AfxRegisterClass` instead of `RegisterClass` this is handled automatically for you."},{"content":"maintains a list of unique classes registered by your DLL and will automatically unregister them when the DLL terminates.","pos":[6722,6843]},{"content":"When you use <ph id=\"ph1\">`RegisterClass`</ph> in a DLL, you must ensure that all classes are unregistered when the DLL is terminated (in your <bpt id=\"p1\">[</bpt>DllMain<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682583)</ept> function).","pos":[6844,7049],"source":" When you use `RegisterClass` in a DLL, you must ensure that all classes are unregistered when the DLL is terminated (in your [DllMain](http://msdn.microsoft.com/library/windows/desktop/ms682583) function)."},{"content":"Failure to do so might cause <ph id=\"ph1\">`RegisterClass`</ph> to fail unexpectedly when another client application tries to use your DLL.","pos":[7050,7170],"source":" Failure to do so might cause `RegisterClass` to fail unexpectedly when another client application tries to use your DLL."},{"content":"See Also","pos":[7179,7187]},{"content":"Technical Notes by Number","pos":[7192,7217]},{"content":"Technical Notes by Category","pos":[7261,7288]}],"content":"---\ntitle: \"TN001: Window Class Registration | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.registration\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"TN001\"\n  - \"WNDCLASS\"\n  - \"AfxRegisterClass function\"\nms.assetid: 1abf678e-f220-4606-85e0-03df32f64c54\ncaps.latest.revision: 16\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# TN001: Window Class Registration\nThis note describes the MFC routines that register the special [WNDCLASS](http://msdn.microsoft.com/library/windows/desktop/ms633576)es needed by Microsoft Windows. Specific `WNDCLASS` attributes used by MFC and Windows are discussed.  \n  \n## The Problem  \n The attributes of a [CWnd](../mfc/reference/cwnd-class.md) object, like an `HWND` handle in Windows, are stored in two places: the window object and the `WNDCLASS`. The name of the `WNDCLASS` is passed to general window creation functions such as [CWnd::Create](../mfc/reference/cwnd-class.md#cwnd__create) and [CFrameWnd::Create](../mfc/reference/cframewnd-class.md#cframewnd__create) in the `lpszClassName` parameter.  \n  \n This `WNDCLASS` must be registered through one of four means:  \n  \n-   Implicitly by using a MFC provided `WNDCLASS`.  \n  \n-   Implicitly by subclassing a Windows control (or some other control).  \n  \n-   Explicitly by calling the MFC [AfxRegisterWndClass](../mfc/reference/application-information-and-management.md#afxregisterwndclass) or [AfxRegisterClass](../mfc/reference/application-information-and-management.md#afxregisterclass).  \n  \n-   Explicitly by calling the Windows routine [RegisterClass](http://msdn.microsoft.com/library/windows/desktop/ms633586).  \n  \n## WNDCLASS Fields  \n The `WNDCLASS` structure consists of various fields that describe a window class. The following table shows the fields and specifies how they are used in an MFC application:  \n  \n|Field|Description|  \n|-----------|-----------------|  \n|`lpfnWndProc`|window proc, must be an `AfxWndProc`|  \n|`cbClsExtra`|not used (should be zero)|  \n|`cbWndExtra`|not used (should be zero)|  \n|`hInstance`|automatically filled with [AfxGetInstanceHandle](../mfc/reference/application-information-and-management.md#afxgetinstancehandle)|  \n|`hIcon`|icon for frame windows, see below|  \n|`hCursor`|cursor for when mouse is over window, see below|  \n|`hbrBackground`|background color, see below|  \n|`lpszMenuName`|not used (should be NULL)|  \n|`lpszClassName`|class name, see below|  \n  \n## Provided WNDCLASSes  \n Earlier versions of MFC (before MFC 4.0), provided several predefined Window classes. These Window classes are no longer provided by default. Applications should use `AfxRegisterWndClass` with the appropriate parameters.  \n  \n If the application provides a resource with the specified resource ID (for example, AFX_IDI_STD_FRAME), MFC will use that resource. Otherwise it will use the default resource. For the icon, the standard application icon is used, and for the cursor, the standard arrow cursor is used.  \n  \n Two icons support MDI applications with single document types: one icon for the main application, the other icon for iconic document/MDIChild windows. For multiple document types with different icons, you must register additional `WNDCLASS`es or use the [CFrameWnd::LoadFrame](../mfc/reference/cframewnd-class.md#cframewnd__loadframe) function.  \n  \n `CFrameWnd::LoadFrame` will register a `WNDCLASS` using the icon ID you specify as the first parameter and the following standard attributes:  \n  \n-   class style : CS_DBLCLKS &#124; CS_HREDRAW &#124; CS_VREDRAW;  \n  \n-   icon AFX_IDI_STD_FRAME  \n  \n-   arrow cursor  \n  \n-   COLOR_WINDOW background color  \n  \n The values for background color and cursor for the [CMDIFrameWnd](../mfc/reference/cmdiframewnd-class.md) are not used since the client area of the `CMDIFrameWnd` is completely covered by the **MDICLIENT** window. Microsoft does not encourage subclassing the **MDICLIENT** window so use the standard colors and cursor types when possible.  \n  \n## Subclassing and Superclassing Controls  \n If you subclass or superclass a Windows control (for example, [CButton](../mfc/reference/cbutton-class.md)) then your class automatically gets the `WNDCLASS` attributes provided in the Windows implementation of that control.  \n  \n## The AfxRegisterWndClass Function  \n MFC provides a helper function for registering a window class. Given a set of attributes (window class style, cursor, background brush, and icon), a synthetic name is generated, and the resulting window class is registered. For example,  \n  \n```  \nconst char* AfxRegisterWndClass(UINT nClassStyle,\n    HCURSOR hCursor,\n    HBRUSH hbrBackground,\n    HICON hIcon);\n```  \n  \n This function returns a temporary string of the generated registered window class name. For more information about this function, see [AfxRegisterWndClass](../mfc/reference/application-information-and-management.md#afxregisterwndclass).  \n  \n The returned string is a temporary pointer to a static string buffer. It is valid until the next call to `AfxRegisterWndClass`. If you want to keep this string around, store it in a [CString](../atl-mfc-shared/using-cstring.md) variable, as in this example:  \n  \n```  \nCString strWndClass = AfxRegisterWndClass(CS_DBLCLK, ...);\n\n...  \nCWnd* pWnd = new CWnd;  \npWnd->Create(strWndClass, ...);\n\n...  \n```  \n  \n `AfxRegisterWndClass` will throw a [CResourceException](../mfc/reference/cresourceexception-class.md) if the window class failed to register (either because of bad parameters, or out of Windows memory).  \n  \n## The RegisterClass and AfxRegisterClass Functions  \n If you want to do anything more sophisticated than what `AfxRegisterWndClass` provides, you can call the Windows API `RegisterClass` or the MFC function `AfxRegisterClass`. The `CWnd`, [CFrameWnd](../mfc/reference/cframewnd-class.md) and [CMDIChildWnd](../mfc/reference/cmdichildwnd-class.md) `Create` functions take a `lpszClassName` string name for the window class as the first parameter. You can use any registered window class name, regardless of the method you used to register it.  \n  \n It is important to use `AfxRegisterClass` (or `AfxRegisterWndClass`) in a DLL on Win32. Win32 does not automatically unregister classes registered by a DLL, so you must explicitly unregister classes when the DLL is terminated. By using `AfxRegisterClass` instead of `RegisterClass` this is handled automatically for you. `AfxRegisterClass` maintains a list of unique classes registered by your DLL and will automatically unregister them when the DLL terminates. When you use `RegisterClass` in a DLL, you must ensure that all classes are unregistered when the DLL is terminated (in your [DllMain](http://msdn.microsoft.com/library/windows/desktop/ms682583) function). Failure to do so might cause `RegisterClass` to fail unexpectedly when another client application tries to use your DLL.  \n  \n## See Also  \n [Technical Notes by Number](../mfc/technical-notes-by-number.md)   \n [Technical Notes by Category](../mfc/technical-notes-by-category.md)\n\n"}