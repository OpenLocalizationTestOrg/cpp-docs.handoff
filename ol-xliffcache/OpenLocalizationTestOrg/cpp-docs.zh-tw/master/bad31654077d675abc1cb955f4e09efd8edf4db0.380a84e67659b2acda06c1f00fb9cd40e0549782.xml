{"nodes":[{"pos":[12,56],"content":"GetCodeForDllRegisterServer | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"GetCodeForDllRegisterServer | Microsoft Docs","pos":[0,44]}]},{"content":"GetCodeForDllRegisterServer","pos":[647,674]},{"content":"Gets the appropriate code for registering a server.","pos":[675,726]},{"content":"Syntax","pos":[735,741]},{"content":"Parameters","pos":[856,866]},{"content":"The zero-based line number for the start of the function.","pos":[886,943]},{"content":"The zero-based line number for the end of the function.","pos":[964,1019]},{"content":"Return Value","pos":[1028,1040]},{"content":"A string containing the code for registering the server","pos":[1044,1099]},{"content":"Remarks","pos":[1108,1115]},{"content":"Call this member function to retrieve the appropriate code for registering a server:","pos":[1119,1203]},{"content":"Line number","pos":[1210,1221]},{"content":"Code","pos":[1222,1226]},{"content":"0","pos":[1264,1265]},{"content":"AFX_MANAGE_STATE(AfxGetStaticModuleState());","pos":[1266,1310]},{"content":"1","pos":[1315,1316]},{"content":"_AtlModule.UpdateRegistryAppId(TRUE);","pos":[1317,1354]},{"content":"2","pos":[1359,1360]},{"content":"HRESULT hRes = _AtlModule.RegisterServer(TRUE);","pos":[1361,1408]},{"content":"3","pos":[1413,1414]},{"content":"if (hRes != S_OK)","pos":[1415,1432]},{"content":"4","pos":[1437,1438]},{"content":"\\treturn hRes;","pos":[1439,1453]},{"content":"5","pos":[1458,1459]},{"content":"if (!COleObjectFactory::UpdateRegistryAll(TRUE))","pos":[1460,1508]},{"content":"6","pos":[1513,1514]},{"content":"\\treturn ResultFromScode(SELFREG_E_CLASS);","pos":[1515,1557]},{"content":"7","pos":[1562,1563]},{"content":"return S_OK;","pos":[1564,1576]},{"pos":[1584,1748],"content":"For each of the lines returned, <ph id=\"ph1\">`GetCodeForDllRegisterServer`</ph> adds a leading tab (<ph id=\"ph2\">`\\t`</ph>) and a trailing \"CR-LF\" (carriage return - linefeed) character pair (<ph id=\"ph3\">`\\r\\n`</ph>).","source":"For each of the lines returned, `GetCodeForDllRegisterServer` adds a leading tab (`\\t`) and a trailing \"CR-LF\" (carriage return - linefeed) character pair (`\\r\\n`)."},{"content":"Example","pos":[1757,1764]},{"content":"See Also","pos":[1990,1998]},{"content":"Customizing C++ Wizards with Common JScript Functions","pos":[2003,2056]},{"content":"JScript Functions for C++ Wizards","pos":[2128,2161]},{"content":"Creating a Custom Wizard","pos":[2213,2237]},{"content":"Designing a Wizard","pos":[2280,2298]},{"content":"GetCodeForDllUnregisterServer","pos":[2335,2364]}],"content":"---\ntitle: \"GetCodeForDllRegisterServer | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"GetCodeForDllRegisterServer\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetCodeForDllRegisterServer method\"\nms.assetid: 2fe733ad-3f1e-4020-9ce3-68956da7d41d\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# GetCodeForDllRegisterServer\nGets the appropriate code for registering a server.  \n  \n## Syntax  \n  \n```  \n  \n      function GetCodeForDllRegisterServer(   \n   nLineStart,   \n   nLineEnd    \n);  \n```  \n  \n#### Parameters  \n `nLineStart`  \n The zero-based line number for the start of the function.  \n  \n `nLineEnd`  \n The zero-based line number for the end of the function.  \n  \n## Return Value  \n A string containing the code for registering the server  \n  \n## Remarks  \n Call this member function to retrieve the appropriate code for registering a server:  \n  \n|Line number|Code|  \n|-----------------|----------|  \n|0|AFX_MANAGE_STATE(AfxGetStaticModuleState());|  \n|1|_AtlModule.UpdateRegistryAppId(TRUE);|  \n|2|HRESULT hRes = _AtlModule.RegisterServer(TRUE);|  \n|3|if (hRes != S_OK)|  \n|4|\\treturn hRes;|  \n|5|if (!COleObjectFactory::UpdateRegistryAll(TRUE))|  \n|6|\\treturn ResultFromScode(SELFREG_E_CLASS);|  \n|7|return S_OK;|  \n  \n For each of the lines returned, `GetCodeForDllRegisterServer` adds a leading tab (`\\t`) and a trailing \"CR-LF\" (carriage return - linefeed) character pair (`\\r\\n`).  \n  \n## Example  \n  \n```  \n// Get the lines numbered 2 and 3 above  \nGetCodeForDllRegisterServer(2, 3)  \n  \n// returns the following string  \n// \"\\tHRESULT hRes = _AtlModule.RegisterServer(TRUE);\\r\\n\\tif (hRes != S_OK)\\r\\n\"  \n  \n```  \n  \n## See Also  \n [Customizing C++ Wizards with Common JScript Functions](../ide/customizing-cpp-wizards-with-common-jscript-functions.md)   \n [JScript Functions for C++ Wizards](../ide/jscript-functions-for-cpp-wizards.md)   \n [Creating a Custom Wizard](../ide/creating-a-custom-wizard.md)   \n [Designing a Wizard](../ide/designing-a-wizard.md)   \n [GetCodeForDllUnregisterServer](../ide/getcodefordllunregisterserver.md)"}