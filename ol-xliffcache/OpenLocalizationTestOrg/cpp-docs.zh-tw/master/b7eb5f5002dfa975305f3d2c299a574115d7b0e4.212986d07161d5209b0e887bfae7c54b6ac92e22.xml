{"nodes":[{"pos":[12,49],"content":"WeakReference Class1 | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"WeakReference Class1 | Microsoft Docs","pos":[0,37]}]},{"content":"WeakReference Class1","pos":[675,695]},{"content":"Supports the WRL infrastructure and is not intended to be used directly from your code.","pos":[696,783]},{"content":"Syntax","pos":[792,798]},{"content":"Remarks","pos":[845,852]},{"content":"Represents a <bpt id=\"p1\">*</bpt>weak reference<ept id=\"p1\">*</ept> that can be used with the Windows Runtime or classic COM.","pos":[856,943],"source":"Represents a *weak reference* that can be used with the Windows Runtime or classic COM."},{"content":"A weak reference represents an object that might or might not be accessible.","pos":[944,1020]},{"content":"A <ph id=\"ph1\">`WeakReference`</ph> object maintains a <bpt id=\"p1\">*</bpt>strong reference<ept id=\"p1\">*</ept>, which is a pointer to an object, and a <bpt id=\"p2\">*</bpt>strong reference count<ept id=\"p2\">*</ept>, which is the number of copies of the strong reference that have been distributed by the Resolve() method.","pos":[1027,1254],"source":"A `WeakReference` object maintains a *strong reference*, which is a pointer to an object, and a *strong reference count*, which is the number of copies of the strong reference that have been distributed by the Resolve() method."},{"content":"While the strong reference count is nonzero, the strong reference is valid and the object is accessible.","pos":[1255,1359]},{"content":"When the strong reference count becomes zero, the strong reference is invalid and the object is inaccessible.","pos":[1360,1469]},{"content":"A WeakReference object is typically used to represent an object whose existence is controlled by an external thread or application.","pos":[1476,1607]},{"content":"For example, construct a WeakReference object from a reference to a file object.","pos":[1608,1688]},{"content":"While the file is open, the strong reference is valid.","pos":[1689,1743]},{"content":"But if the file is closed, the strong reference becomes invalid.","pos":[1744,1808]},{"content":"The WeakReference methods are thread safe.","pos":[1815,1857]},{"content":"Members","pos":[1866,1873]},{"content":"Public Constructors","pos":[1883,1902]},{"content":"Name","pos":[1909,1913]},{"content":"Description","pos":[1914,1925]},{"content":"WeakReference::WeakReference Constructor","pos":[1964,2004]},{"content":"Initializes a new instance of the WeakReference class.","pos":[2061,2115]},{"content":"WeakReference::~WeakReference Destructor","pos":[2121,2161]},{"content":"Deinitializes (destroys) the current instance of the WeakReference class.","pos":[2223,2296]},{"content":"Public Methods","pos":[2307,2321]},{"content":"Name","pos":[2328,2332]},{"content":"Description","pos":[2333,2344]},{"content":"WeakReference::DecrementStrongReference Method","pos":[2383,2429]},{"content":"Decrements the strong reference count of the current WeakReference object.","pos":[2492,2566]},{"content":"WeakReference::IncrementStrongReference Method","pos":[2572,2618]},{"content":"Increments the strong reference count of the current WeakReference object.","pos":[2681,2755]},{"content":"WeakReference::Resolve Method","pos":[2761,2790]},{"content":"Sets the specified pointer to the current strong reference value if the strong reference count is nonzero.","pos":[2836,2942]},{"content":"WeakReference::SetUnknown Method","pos":[2948,2980]},{"content":"Sets the strong reference of the current WeakReference object to the specified interface pointer.","pos":[3029,3126]},{"content":"Inheritance Hierarchy","pos":[3136,3157]},{"content":"Requirements","pos":[3185,3197]},{"pos":[3201,3225],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> implements.h","source":"**Header:** implements.h"},{"pos":[3232,3270],"content":"<bpt id=\"p1\">**</bpt>Namespace:<ept id=\"p1\">**</ept> Microsoft::WRL::Details","source":"**Namespace:** Microsoft::WRL::Details"},{"content":"See Also","pos":[3279,3287]},{"content":"Microsoft::WRL::Details Namespace","pos":[3292,3325]}],"content":"---\ntitle: \"WeakReference Class1 | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"implements/Microsoft::WRL::Details::WeakReference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"WeakReference class\"\nms.assetid: 3f4c956b-dbbd-49b1-8cfa-9509a9956c97\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# WeakReference Class1\nSupports the WRL infrastructure and is not intended to be used directly from your code.  \n  \n## Syntax  \n  \n```  \nclass WeakReference;  \n```  \n  \n## Remarks  \n Represents a *weak reference* that can be used with the Windows Runtime or classic COM. A weak reference represents an object that might or might not be accessible.  \n  \n A `WeakReference` object maintains a *strong reference*, which is a pointer to an object, and a *strong reference count*, which is the number of copies of the strong reference that have been distributed by the Resolve() method. While the strong reference count is nonzero, the strong reference is valid and the object is accessible. When the strong reference count becomes zero, the strong reference is invalid and the object is inaccessible.  \n  \n A WeakReference object is typically used to represent an object whose existence is controlled by an external thread or application. For example, construct a WeakReference object from a reference to a file object. While the file is open, the strong reference is valid. But if the file is closed, the strong reference becomes invalid.  \n  \n The WeakReference methods are thread safe.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[WeakReference::WeakReference Constructor](../windows/weakreference-weakreference-constructor.md)|Initializes a new instance of the WeakReference class.|  \n|[WeakReference::~WeakReference Destructor](../windows/weakreference-tilde-weakreference-destructor.md)|Deinitializes (destroys) the current instance of the WeakReference class.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[WeakReference::DecrementStrongReference Method](../windows/weakreference-decrementstrongreference-method.md)|Decrements the strong reference count of the current WeakReference object.|  \n|[WeakReference::IncrementStrongReference Method](../windows/weakreference-incrementstrongreference-method.md)|Increments the strong reference count of the current WeakReference object.|  \n|[WeakReference::Resolve Method](../windows/weakreference-resolve-method.md)|Sets the specified pointer to the current strong reference value if the strong reference count is nonzero.|  \n|[WeakReference::SetUnknown Method](../windows/weakreference-setunknown-method.md)|Sets the strong reference of the current WeakReference object to the specified interface pointer.|  \n  \n## Inheritance Hierarchy  \n `WeakReference`  \n  \n## Requirements  \n **Header:** implements.h  \n  \n **Namespace:** Microsoft::WRL::Details  \n  \n## See Also  \n [Microsoft::WRL::Details Namespace](../windows/microsoft-wrl-details-namespace.md)"}