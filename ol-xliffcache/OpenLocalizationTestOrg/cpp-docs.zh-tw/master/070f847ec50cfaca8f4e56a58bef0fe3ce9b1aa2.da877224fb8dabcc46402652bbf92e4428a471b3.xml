{"nodes":[{"pos":[12,48],"content":"CAtlComModule Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CAtlComModule Class | Microsoft Docs","pos":[0,36]}]},{"content":"CAtlComModule Class","pos":[662,681]},{"content":"This class implements a COM server module.","pos":[682,724]},{"content":"Syntax","pos":[733,739]},{"content":"Members","pos":[807,814]},{"content":"Public Constructors","pos":[824,843]},{"content":"Name","pos":[850,854]},{"content":"Description","pos":[855,866]},{"content":"CAtlComModule::CAtlComModule","pos":[905,933]},{"content":"The constructor.","pos":[966,982]},{"content":"CAtlComModule::~CAtlComModule","pos":[988,1017]},{"content":"The destructor.","pos":[1055,1070]},{"content":"Public Methods","pos":[1081,1095]},{"content":"Name","pos":[1102,1106]},{"content":"Description","pos":[1107,1118]},{"content":"CAtlComModule::RegisterServer","pos":[1157,1186]},{"content":"Call this method to update the system registry for each object in the object map.","pos":[1220,1301]},{"content":"CAtlComModule::RegisterTypeLib","pos":[1307,1337]},{"content":"Call this method to register a type library.","pos":[1372,1416]},{"content":"CAtlComModule::UnregisterServer","pos":[1422,1453]},{"content":"Call this method to unregister each object in the object map.","pos":[1489,1550]},{"content":"CAtlComModule::UnRegisterTypeLib","pos":[1556,1588]},{"content":"Call this method to unregister a type library.","pos":[1625,1671]},{"content":"Remarks","pos":[1681,1688]},{"pos":[1708,1792],"content":"implements a COM server module, allowing a client to access the module's components."},{"content":"This class replaces the obsolete <bpt id=\"p1\">[</bpt>CComModule<ept id=\"p1\">](../../atl/reference/ccommodule-class.md)</ept> class used in earlier versions of ATL.","pos":[1799,1924],"source":"This class replaces the obsolete [CComModule](../../atl/reference/ccommodule-class.md) class used in earlier versions of ATL."},{"content":"See <bpt id=\"p1\">[</bpt>ATL Module Classes<ept id=\"p1\">](../../atl/atl-module-classes.md)</ept> for more details.","pos":[1925,2000],"source":" See [ATL Module Classes](../../atl/atl-module-classes.md) for more details."},{"content":"Inheritance Hierarchy","pos":[2009,2030]},{"content":"_ATL_COM_MODULE","pos":[2035,2050]},{"content":"Requirements","pos":[2115,2127]},{"pos":[2131,2152],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlbase.h","source":"**Header:** atlbase.h"},{"pos":[2207,2235],"content":"CAtlComModule::CAtlComModule"},{"content":"The constructor.","pos":[2239,2255]},{"content":"Remarks","pos":[2303,2310]},{"content":"Initializes the module.","pos":[2314,2337]},{"pos":[2397,2426],"content":"CAtlComModule::~CAtlComModule"},{"content":"The destructor.","pos":[2430,2445]},{"content":"Remarks","pos":[2486,2493]},{"content":"Frees all class factories.","pos":[2497,2523]},{"pos":[2579,2608],"content":"CAtlComModule::RegisterServer"},{"content":"Call this method to update the system registry for each object in the object map.","pos":[2612,2693]},{"content":"Parameters","pos":[2795,2805]},{"content":"TRUE if the type library is to be registered.","pos":[2826,2871]},{"content":"The default value is FALSE.","pos":[2872,2899]},{"content":"Points to the CLSID of the object to be registered.","pos":[2918,2969]},{"content":"If NULL (the default value), all objects in the object map will be registered.","pos":[2970,3048]},{"content":"Return Value","pos":[3058,3070]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[3074,3130]},{"content":"Remarks","pos":[3140,3147]},{"pos":[3151,3278],"content":"Calls the global function <bpt id=\"p1\">[</bpt>AtlComModuleRegisterServer<ept id=\"p1\">](http://msdn.microsoft.com/library/d11a0c91-0c56-4b1b-a5f5-1287970f798b)</ept>.","source":"Calls the global function [AtlComModuleRegisterServer](http://msdn.microsoft.com/library/d11a0c91-0c56-4b1b-a5f5-1287970f798b)."},{"pos":[3335,3365],"content":"CAtlComModule::RegisterTypeLib"},{"content":"Call this method to register a type library.","pos":[3369,3413]},{"content":"Parameters","pos":[3512,3522]},{"content":"String in the format \"<ph id=\"ph1\">\\\\</ph>\\N\", where N is the integer index of the TYPELIB resource.","pos":[3541,3623],"source":" String in the format \"\\\\\\N\", where N is the integer index of the TYPELIB resource."},{"content":"Return Value","pos":[3633,3645]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[3649,3705]},{"content":"Remarks","pos":[3715,3722]},{"content":"Adds information about a type library to the system registry.","pos":[3726,3787]},{"content":"If the module instance contains multiple type libraries, use the first version of this method to specify which type library should be used.","pos":[3788,3927]},{"pos":[3985,4016],"content":"CAtlComModule::UnregisterServer"},{"content":"Call this method to unregister each object in the object map.","pos":[4020,4081]},{"content":"Parameters","pos":[4185,4195]},{"content":"TRUE if the type library is to be unregistered.","pos":[4216,4263]},{"content":"The default value is FALSE.","pos":[4264,4291]},{"content":"Points to the CLSID of the object to be unregistered.","pos":[4310,4363]},{"content":"If NULL (the default value), all objects in the object map will be unregistered.","pos":[4364,4444]},{"content":"Return Value","pos":[4454,4466]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[4470,4526]},{"content":"Remarks","pos":[4536,4543]},{"pos":[4547,4676],"content":"Calls the global function <bpt id=\"p1\">[</bpt>AtlComModuleUnregisterServer<ept id=\"p1\">](http://msdn.microsoft.com/library/c4ef3da4-def7-4aaf-b005-573a02e389d5)</ept>.","source":"Calls the global function [AtlComModuleUnregisterServer](http://msdn.microsoft.com/library/c4ef3da4-def7-4aaf-b005-573a02e389d5)."},{"pos":[4735,4767],"content":"CAtlComModule::UnRegisterTypeLib"},{"content":"Call this method to unregister a type library.","pos":[4771,4817]},{"content":"Parameters","pos":[4920,4930]},{"content":"String in the format \"<ph id=\"ph1\">\\\\</ph>\\N\", where N is the integer index of the TYPELIB resource.","pos":[4949,5031],"source":" String in the format \"\\\\\\N\", where N is the integer index of the TYPELIB resource."},{"content":"Remarks","pos":[5041,5048]},{"content":"Removes information about a type library from the system registry.","pos":[5052,5118]},{"content":"If the module instance contains multiple type libraries, use the first version of this method to specify which type library should be used.","pos":[5119,5258]},{"content":"Return Value","pos":[5268,5280]},{"content":"Returns S_OK on success, or an error HRESULT on failure.","pos":[5284,5340]},{"content":"See Also","pos":[5349,5357]},{"content":"_ATL_COM_MODULE","pos":[5362,5377]},{"content":"Class Overview","pos":[5417,5431]}],"content":"---\ntitle: \"CAtlComModule Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL.CAtlComModule\"\n  - \"CAtlComModule\"\n  - \"ATL::CAtlComModule\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CAtlComModule class\"\nms.assetid: af5dd71a-a0d1-4a2e-9a24-154a03381c75\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CAtlComModule Class\nThis class implements a COM server module.  \n  \n## Syntax  \n  \n```\nclass CAtlComModule :  public _ATL_COM_MODULE\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlComModule::CAtlComModule](#catlcommodule__catlcommodule)|The constructor.|  \n|[CAtlComModule::~CAtlComModule](#catlcommodule___dtorcatlcommodule)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlComModule::RegisterServer](#catlcommodule__registerserver)|Call this method to update the system registry for each object in the object map.|  \n|[CAtlComModule::RegisterTypeLib](#catlcommodule__registertypelib)|Call this method to register a type library.|  \n|[CAtlComModule::UnregisterServer](#catlcommodule__unregisterserver)|Call this method to unregister each object in the object map.|  \n|[CAtlComModule::UnRegisterTypeLib](#catlcommodule__unregistertypelib)|Call this method to unregister a type library.|  \n  \n## Remarks  \n `CAtlComModule` implements a COM server module, allowing a client to access the module's components.  \n  \n This class replaces the obsolete [CComModule](../../atl/reference/ccommodule-class.md) class used in earlier versions of ATL. See [ATL Module Classes](../../atl/atl-module-classes.md) for more details.  \n  \n## Inheritance Hierarchy  \n [_ATL_COM_MODULE](atl-typedefs.md#_atl_com_module)  \n  \n `CAtlComModule`  \n  \n## Requirements  \n **Header:** atlbase.h  \n  \n##  <a name=\"catlcommodule__catlcommodule\"></a>  CAtlComModule::CAtlComModule  \n The constructor.  \n  \n```\nCAtlComModule() throw();\n```  \n  \n### Remarks  \n Initializes the module.  \n  \n##  <a name=\"catlcommodule___dtorcatlcommodule\"></a>  CAtlComModule::~CAtlComModule  \n The destructor.  \n  \n```\n~CAtlComModule();\n```  \n  \n### Remarks  \n Frees all class factories.  \n  \n##  <a name=\"catlcommodule__registerserver\"></a>  CAtlComModule::RegisterServer  \n Call this method to update the system registry for each object in the object map.  \n  \n```\nHRESULT RegisterServer(BOOL bRegTypeLib = FALSE,  const CLSID* pCLSID = NULL);\n```  \n  \n### Parameters  \n `bRegTypeLib`  \n TRUE if the type library is to be registered. The default value is FALSE.  \n  \n `pCLSID`  \n Points to the CLSID of the object to be registered. If NULL (the default value), all objects in the object map will be registered.  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n### Remarks  \n Calls the global function [AtlComModuleRegisterServer](http://msdn.microsoft.com/library/d11a0c91-0c56-4b1b-a5f5-1287970f798b).  \n  \n##  <a name=\"catlcommodule__registertypelib\"></a>  CAtlComModule::RegisterTypeLib  \n Call this method to register a type library.  \n  \n```\nHRESULT RegisterTypeLib(LPCTSTR lpszIndex);\n\n    HRESULT RegisterTypeLib();\n```  \n  \n### Parameters  \n `lpszIndex`  \n String in the format \"\\\\\\N\", where N is the integer index of the TYPELIB resource.  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n### Remarks  \n Adds information about a type library to the system registry. If the module instance contains multiple type libraries, use the first version of this method to specify which type library should be used.  \n  \n##  <a name=\"catlcommodule__unregisterserver\"></a>  CAtlComModule::UnregisterServer  \n Call this method to unregister each object in the object map.  \n  \n```\nHRESULT UnregisterServer(BOOL bRegTypeLib = FALSE,  const CLSID* pCLSID = NULL);\n```  \n  \n### Parameters  \n `bRegTypeLib`  \n TRUE if the type library is to be unregistered. The default value is FALSE.  \n  \n `pCLSID`  \n Points to the CLSID of the object to be unregistered. If NULL (the default value), all objects in the object map will be unregistered.  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n### Remarks  \n Calls the global function [AtlComModuleUnregisterServer](http://msdn.microsoft.com/library/c4ef3da4-def7-4aaf-b005-573a02e389d5).  \n  \n##  <a name=\"catlcommodule__unregistertypelib\"></a>  CAtlComModule::UnRegisterTypeLib  \n Call this method to unregister a type library.  \n  \n```\nHRESULT UnRegisterTypeLib(LPCTSTR lpszIndex);\n\n    HRESULT UnRegisterTypeLib();\n```  \n  \n### Parameters  \n `lpszIndex`  \n String in the format \"\\\\\\N\", where N is the integer index of the TYPELIB resource.  \n  \n### Remarks  \n Removes information about a type library from the system registry. If the module instance contains multiple type libraries, use the first version of this method to specify which type library should be used.  \n  \n### Return Value  \n Returns S_OK on success, or an error HRESULT on failure.  \n  \n## See Also  \n [_ATL_COM_MODULE](atl-typedefs.md#_atl_com_module)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}