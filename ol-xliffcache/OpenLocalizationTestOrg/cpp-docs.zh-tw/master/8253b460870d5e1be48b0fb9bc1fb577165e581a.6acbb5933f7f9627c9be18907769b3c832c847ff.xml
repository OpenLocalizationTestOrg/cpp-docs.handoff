{"nodes":[{"pos":[12,49],"content":"MFC ActiveX Controls | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls | Microsoft Docs","pos":[0,37]}]},{"content":"MFC ActiveX Controls","pos":[1035,1055]},{"content":"An ActiveX control is a reusable software component based on the Component Object Model (COM) that supports a wide variety of OLE functionality and can be customized to fit many software needs.","pos":[1056,1249]},{"content":"ActiveX controls are designed for use both in ordinary ActiveX control containers and on the Internet, in World Wide Web pages.","pos":[1250,1377]},{"content":"You can create ActiveX controls either with MFC, described here, or with the <bpt id=\"p1\">[</bpt>Active Template Library (ATL)<ept id=\"p1\">](../atl/active-template-library-atl-concepts.md)</ept>.","pos":[1378,1535],"source":" You can create ActiveX controls either with MFC, described here, or with the [Active Template Library (ATL)](../atl/active-template-library-atl-concepts.md)."},{"content":"An ActiveX control can draw itself in its own window, respond to events (such as mouse clicks), and be managed through an interface that includes properties and methods similar to those in Automation objects.","pos":[1542,1750]},{"content":"These controls can be developed for many uses, such as database access, data monitoring, or graphing.","pos":[1757,1858]},{"content":"Besides their portability, ActiveX controls support features previously not available to ActiveX controls, such as compatibility with existing OLE containers and the ability to integrate their menus with the OLE container menus.","pos":[1859,2087]},{"content":"In addition, an ActiveX control fully supports Automation, which allows the control to expose read\\write properties and a set of methods that can be called by the control user.","pos":[2088,2264]},{"content":"You can create windowless ActiveX controls and controls that only create a window when they become active.","pos":[2271,2377]},{"content":"Windowless controls speed up the display of your application and make it possible to have transparent and nonrectangular controls.","pos":[2378,2508]},{"content":"You can also load ActiveX control properties asynchronously.","pos":[2509,2569]},{"content":"An ActiveX control is implemented as an in-process server (typically a small object) that can be used in any OLE container.","pos":[2576,2699]},{"content":"Note that the full functionality of an ActiveX control is available only when used within an OLE container designed to be aware of ActiveX controls.","pos":[2700,2848]},{"content":"See <bpt id=\"p1\">[</bpt>Port ActiveX Controls to Other Applications<ept id=\"p1\">](../mfc/containers-for-activex-controls.md)</ept> for a list of containers that support ActiveX controls.","pos":[2849,2997],"source":" See [Port ActiveX Controls to Other Applications](../mfc/containers-for-activex-controls.md) for a list of containers that support ActiveX controls."},{"content":"This container type, hereafter called a \"control container,\" can operate an ActiveX control by using the control's properties and methods, and receives notifications from the ActiveX control in the form of events.","pos":[2998,3211]},{"content":"The following figure demonstrates this interaction.","pos":[3212,3263]},{"content":"Interplay of ActiveX control container and control","pos":[3272,3322]},{"content":"Interaction Between an ActiveX Control Container and a Windowed ActiveX Control","pos":[3362,3441]},{"pos":[3448,3599],"content":"For some recent information on optimizing your ActiveX controls, see <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Optimization<ept id=\"p1\">](../mfc/mfc-activex-controls-optimization.md)</ept>.","source":"For some recent information on optimizing your ActiveX controls, see [MFC ActiveX Controls: Optimization](../mfc/mfc-activex-controls-optimization.md)."},{"pos":[3606,3728],"content":"To create an MFC ActiveX control, see <bpt id=\"p1\">[</bpt>Create an ActiveX control project<ept id=\"p1\">](../mfc/reference/mfc-activex-control-wizard.md)</ept>.","source":"To create an MFC ActiveX control, see [Create an ActiveX control project](../mfc/reference/mfc-activex-control-wizard.md)."},{"content":"For more information, see:","pos":[3735,3761]},{"content":"ActiveX Control Containers","pos":[3772,3798]},{"content":"Active Documents","pos":[3848,3864]},{"content":"Using ActiveX Controls","pos":[3904,3926]},{"content":"Understanding ActiveX Controls","pos":[3981,4011]},{"content":"Upgrading an Existing ActiveX Control to be Used on the Internet","pos":[4083,4147]},{"pos":[4267,4305],"content":"Basic Components of an ActiveX Control"},{"content":"An ActiveX control uses several programmatic elements to interact efficiently with a control container and with the user.","pos":[4309,4430]},{"content":"These are class <bpt id=\"p1\">[</bpt>COleControl<ept id=\"p1\">](../mfc/reference/colecontrol-class.md)</ept>, a set of event-firing functions, and a dispatch map.","pos":[4431,4553],"source":" These are class [COleControl](../mfc/reference/colecontrol-class.md), a set of event-firing functions, and a dispatch map."},{"content":"Every ActiveX control object you develop inherits a powerful set of features from its MFC base class, <ph id=\"ph1\">`COleControl`</ph>.","pos":[4560,4676],"source":"Every ActiveX control object you develop inherits a powerful set of features from its MFC base class, `COleControl`."},{"content":"These features include in-place activation, and Automation logic.","pos":[4677,4742]},{"content":"can provide the control object with the same functionality as an MFC window object, plus the ability to fire events.","pos":[4757,4873]},{"content":"can also provide <bpt id=\"p1\">[</bpt>windowless controls<ept id=\"p1\">](../mfc/providing-windowless-activation.md)</ept>, which rely on their container for help with some of the functionality a window provides (mouse capture, keyboard focus, scrolling), but offer much faster display.","pos":[4888,5133],"source":" can also provide [windowless controls](../mfc/providing-windowless-activation.md), which rely on their container for help with some of the functionality a window provides (mouse capture, keyboard focus, scrolling), but offer much faster display."},{"content":"Because the control class derives from <ph id=\"ph1\">`COleControl`</ph>, it inherits the capability to send, or \"fire,\" messages, called events, to the control container when certain conditions are met.","pos":[5140,5323],"source":"Because the control class derives from `COleControl`, it inherits the capability to send, or \"fire,\" messages, called events, to the control container when certain conditions are met."},{"content":"These events are used to notify the control container when something important happens in the control.","pos":[5324,5426]},{"content":"You can send additional information about an event to the control container by attaching parameters to the event.","pos":[5427,5540]},{"content":"For more information about ActiveX control events, see the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Events<ept id=\"p1\">](../mfc/mfc-activex-controls-events.md)</ept>.","pos":[5541,5678],"source":" For more information about ActiveX control events, see the article [MFC ActiveX Controls: Events](../mfc/mfc-activex-controls-events.md)."},{"content":"The final element is a dispatch map, which is used to expose a set of functions (called methods) and attributes (called properties) to the control user.","pos":[5685,5837]},{"content":"Properties allow the control container or the control user to manipulate the control in various ways.","pos":[5838,5939]},{"content":"The user can change the appearance of the control, change certain values of the control, or make requests of the control, such as accessing a specific piece of data that the control maintains.","pos":[5940,6132]},{"content":"This interface is determined by the control developer and is defined using <bpt id=\"p1\">**</bpt>Class View<ept id=\"p1\">**</ept>.","pos":[6133,6223],"source":" This interface is determined by the control developer and is defined using **Class View**."},{"content":"For more information on ActiveX control methods and properties, see the articles <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Methods<ept id=\"p1\">](../mfc/mfc-activex-controls-methods.md)</ept> and <bpt id=\"p2\">[</bpt>Properties<ept id=\"p2\">](../mfc/mfc-activex-controls-properties.md)</ept>.","pos":[6224,6437],"source":" For more information on ActiveX control methods and properties, see the articles [MFC ActiveX Controls: Methods](../mfc/mfc-activex-controls-methods.md) and [Properties](../mfc/mfc-activex-controls-properties.md)."},{"pos":[6541,6613],"content":"Interaction Between Controls with Windows and ActiveX Control Containers"},{"content":"When a control is used within a control container, it uses two mechanisms to communicate: it exposes properties and methods, and it fires events.","pos":[6617,6762]},{"content":"The following figure demonstrates how these two mechanisms are implemented.","pos":[6763,6838]},{"content":"ActiveX control communicates with its container","pos":[6847,6894]},{"content":"Communication Between an ActiveX Control Container and an ActiveX Control","pos":[6934,7007]},{"content":"The previous figure also illustrates how other OLE interfaces (besides automation and events) are handled by controls.","pos":[7014,7132]},{"content":"All of a control's communication with the container is performed by <ph id=\"ph1\">`COleControl`</ph>.","pos":[7139,7221],"source":"All of a control's communication with the container is performed by `COleControl`."},{"content":"To handle some of the container's requests, <bpt id=\"p1\">**</bpt>COleControl<ept id=\"p1\">**</ept> will call member functions that are implemented in the control class.","pos":[7222,7351],"source":" To handle some of the container's requests, **COleControl** will call member functions that are implemented in the control class."},{"content":"All methods and some properties are handled in this way.","pos":[7352,7408]},{"content":"Your control's class can also initiate communication with the container by calling member functions of <ph id=\"ph1\">`COleControl`</ph>.","pos":[7409,7526],"source":" Your control's class can also initiate communication with the container by calling member functions of `COleControl`."},{"content":"Events are fired in this manner.","pos":[7527,7559]},{"pos":[7639,7687],"content":"Active and Inactive States of an ActiveX Control"},{"content":"A control has two basic states: active and inactive.","pos":[7691,7743]},{"content":"Traditionally, these states were distinguished by whether the control had a window.","pos":[7744,7827]},{"content":"An active control had a window; an inactive control did not.","pos":[7828,7888]},{"content":"With the introduction of windowless activation, this distinction is no longer universal, but still applies to many controls.","pos":[7889,8013]},{"content":"When a <bpt id=\"p1\">[</bpt>windowless control<ept id=\"p1\">](../mfc/providing-windowless-activation.md)</ept> goes active, it invokes mouse capture, keyboard focus, scrolling, and other window services from its container.","pos":[8020,8202],"source":"When a [windowless control](../mfc/providing-windowless-activation.md) goes active, it invokes mouse capture, keyboard focus, scrolling, and other window services from its container."},{"content":"You can also <bpt id=\"p1\">[</bpt>provide mouse interaction to inactive controls<ept id=\"p1\">](../mfc/providing-mouse-interaction-while-inactive.md)</ept>, as well as create controls that <bpt id=\"p2\">[</bpt>wait until activated to create a window<ept id=\"p2\">](../mfc/turning-off-the-activate-when-visible-option.md)</ept>.","pos":[8203,8450],"source":" You can also [provide mouse interaction to inactive controls](../mfc/providing-mouse-interaction-while-inactive.md), as well as create controls that [wait until activated to create a window](../mfc/turning-off-the-activate-when-visible-option.md)."},{"content":"When a control with a window becomes active, it is able to interact fully with the control container, the user, and Windows.","pos":[8457,8581]},{"content":"The figure below demonstrates the paths of communication between the ActiveX control, the control container, and the operating system.","pos":[8582,8716]},{"content":"Msg processing in active windowed ActiveX control","pos":[8725,8774]},{"content":"Windows Message Processing in a Windowed ActiveX Control (When Active)","pos":[8814,8884]},{"pos":[8944,8957],"content":"Serialization"},{"content":"The ability to serialize data, sometimes referred to as persistence, allows the control to write the value of its properties to persistent storage.","pos":[8961,9108]},{"content":"Controls can then be recreated by reading the object's state from the storage.","pos":[9109,9187]},{"content":"Note that a control is not responsible for obtaining access to the storage medium.","pos":[9194,9276]},{"content":"Instead, the control's container is responsible for providing the control with a storage medium to use at the appropriate times.","pos":[9277,9405]},{"content":"For more information on serialization, see the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Serializing<ept id=\"p1\">](../mfc/mfc-activex-controls-serializing.md)</ept>.","pos":[9406,9541],"source":" For more information on serialization, see the article [MFC ActiveX Controls: Serializing](../mfc/mfc-activex-controls-serializing.md)."},{"content":"For information on optimizing serialization, see <bpt id=\"p1\">[</bpt>Optimizing Persistence and Initialization<ept id=\"p1\">](../mfc/optimizing-persistence-and-initialization.md)</ept> in ActiveX Controls: Optimization.","pos":[9542,9722],"source":" For information on optimizing serialization, see [Optimizing Persistence and Initialization](../mfc/optimizing-persistence-and-initialization.md) in ActiveX Controls: Optimization."},{"pos":[9798,9842],"content":"Installing ActiveX Control Classes and Tools"},{"content":"When you install Visual C++, the MFC ActiveX control classes and retail and debug ActiveX control run-time DLLs are automatically installed if ActiveX controls are selected in Setup (they are selected by default).","pos":[9846,10059]},{"content":"By default, the ActiveX control classes and tools are installed in the following subdirectories under \\Program Files\\Microsoft Visual Studio .NET:","pos":[10066,10212]},{"content":"\\Common7\\Tools","pos":[10224,10238]},{"content":"Contains the Test Container files (TstCon32.exe, as well as its Help files).","pos":[10251,10327]},{"content":"\\Vc7\\atlmfc\\include","pos":[10339,10358]},{"content":"Contains the include files needed to develop ActiveX controls with MFC","pos":[10371,10441]},{"content":"\\Vc7\\atlmfc\\src\\mfc","pos":[10453,10472]},{"content":"Contains the source code for specific ActiveX control classes in MFC","pos":[10485,10553]},{"content":"\\Vc7\\atlmfc\\lib","pos":[10565,10580]},{"content":"Contains the libraries required to develop ActiveX controls with MFC","pos":[10593,10661]},{"content":"There are also samples for MFC ActiveX controls.","pos":[10668,10716]},{"content":"For more information about these samples, see <bpt id=\"p1\">[</bpt>Controls Samples: MFC-Based ActiveX Controls<ept id=\"p1\">](../visual-cpp-samples.md)</ept>","pos":[10717,10835],"source":" For more information about these samples, see [Controls Samples: MFC-Based ActiveX Controls](../visual-cpp-samples.md)"},{"content":"See Also","pos":[10844,10852]},{"content":"User Interface Elements","pos":[10857,10880]}],"content":"---\ntitle: \"MFC ActiveX Controls | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"MFC ActiveX Controls (MFC)\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"COleControl class, MFC ActiveX controls\"\n  - \"ActiveX controls [C++], MFC\"\n  - \"containers [C++], MFC ActiveX controls\"\n  - \"MFC ActiveX controls [C++], serializing\"\n  - \"MFC ActiveX controls [C++], containers\"\n  - \"serialization [C++], MFC ActiveX controls\"\n  - \"dispatch maps, for MFC ActiveX controls\"\n  - \"MFC ActiveX controls [C++], active/inactive state\"\n  - \"events [C++], ActiveX controls\"\n  - \"MFC ActiveX controls [C++]\"\nms.assetid: c911fb74-3afc-4bf3-a0f5-7922b14d9a1b\ncaps.latest.revision: 14\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls\nAn ActiveX control is a reusable software component based on the Component Object Model (COM) that supports a wide variety of OLE functionality and can be customized to fit many software needs. ActiveX controls are designed for use both in ordinary ActiveX control containers and on the Internet, in World Wide Web pages. You can create ActiveX controls either with MFC, described here, or with the [Active Template Library (ATL)](../atl/active-template-library-atl-concepts.md).  \n  \n An ActiveX control can draw itself in its own window, respond to events (such as mouse clicks), and be managed through an interface that includes properties and methods similar to those in Automation objects.  \n  \n These controls can be developed for many uses, such as database access, data monitoring, or graphing. Besides their portability, ActiveX controls support features previously not available to ActiveX controls, such as compatibility with existing OLE containers and the ability to integrate their menus with the OLE container menus. In addition, an ActiveX control fully supports Automation, which allows the control to expose read\\write properties and a set of methods that can be called by the control user.  \n  \n You can create windowless ActiveX controls and controls that only create a window when they become active. Windowless controls speed up the display of your application and make it possible to have transparent and nonrectangular controls. You can also load ActiveX control properties asynchronously.  \n  \n An ActiveX control is implemented as an in-process server (typically a small object) that can be used in any OLE container. Note that the full functionality of an ActiveX control is available only when used within an OLE container designed to be aware of ActiveX controls. See [Port ActiveX Controls to Other Applications](../mfc/containers-for-activex-controls.md) for a list of containers that support ActiveX controls. This container type, hereafter called a \"control container,\" can operate an ActiveX control by using the control's properties and methods, and receives notifications from the ActiveX control in the form of events. The following figure demonstrates this interaction.  \n  \n ![Interplay of ActiveX control container and control](../mfc/media/vc37221.gif \"vc37221\")  \nInteraction Between an ActiveX Control Container and a Windowed ActiveX Control  \n  \n For some recent information on optimizing your ActiveX controls, see [MFC ActiveX Controls: Optimization](../mfc/mfc-activex-controls-optimization.md).  \n  \n To create an MFC ActiveX control, see [Create an ActiveX control project](../mfc/reference/mfc-activex-control-wizard.md).  \n  \n For more information, see:  \n  \n-   [ActiveX Control Containers](../mfc/activex-control-containers.md)  \n  \n-   [Active Documents](../mfc/active-documents.md)  \n  \n-   [Using ActiveX Controls](../data/ado-rdo/using-activex-controls.md)  \n  \n-   [Understanding ActiveX Controls](http://msdn.microsoft.com/library/windows/desktop/ms693753)  \n  \n-   [Upgrading an Existing ActiveX Control to be Used on the Internet](../mfc/upgrading-an-existing-activex-control.md)  \n  \n##  <a name=\"_core_basic_components_of_an_activex_control\"></a> Basic Components of an ActiveX Control  \n An ActiveX control uses several programmatic elements to interact efficiently with a control container and with the user. These are class [COleControl](../mfc/reference/colecontrol-class.md), a set of event-firing functions, and a dispatch map.  \n  \n Every ActiveX control object you develop inherits a powerful set of features from its MFC base class, `COleControl`. These features include in-place activation, and Automation logic. `COleControl` can provide the control object with the same functionality as an MFC window object, plus the ability to fire events. `COleControl` can also provide [windowless controls](../mfc/providing-windowless-activation.md), which rely on their container for help with some of the functionality a window provides (mouse capture, keyboard focus, scrolling), but offer much faster display.  \n  \n Because the control class derives from `COleControl`, it inherits the capability to send, or \"fire,\" messages, called events, to the control container when certain conditions are met. These events are used to notify the control container when something important happens in the control. You can send additional information about an event to the control container by attaching parameters to the event. For more information about ActiveX control events, see the article [MFC ActiveX Controls: Events](../mfc/mfc-activex-controls-events.md).  \n  \n The final element is a dispatch map, which is used to expose a set of functions (called methods) and attributes (called properties) to the control user. Properties allow the control container or the control user to manipulate the control in various ways. The user can change the appearance of the control, change certain values of the control, or make requests of the control, such as accessing a specific piece of data that the control maintains. This interface is determined by the control developer and is defined using **Class View**. For more information on ActiveX control methods and properties, see the articles [MFC ActiveX Controls: Methods](../mfc/mfc-activex-controls-methods.md) and [Properties](../mfc/mfc-activex-controls-properties.md).  \n  \n##  <a name=\"_core_interaction_between_controls_with_windows_and_activex_control_containers\"></a> Interaction Between Controls with Windows and ActiveX Control Containers  \n When a control is used within a control container, it uses two mechanisms to communicate: it exposes properties and methods, and it fires events. The following figure demonstrates how these two mechanisms are implemented.  \n  \n ![ActiveX control communicates with its container](../mfc/media/vc37222.gif \"vc37222\")  \nCommunication Between an ActiveX Control Container and an ActiveX Control  \n  \n The previous figure also illustrates how other OLE interfaces (besides automation and events) are handled by controls.  \n  \n All of a control's communication with the container is performed by `COleControl`. To handle some of the container's requests, **COleControl** will call member functions that are implemented in the control class. All methods and some properties are handled in this way. Your control's class can also initiate communication with the container by calling member functions of `COleControl`. Events are fired in this manner.  \n  \n##  <a name=\"_core_active_and_inactive_states_of_an_activex_control\"></a> Active and Inactive States of an ActiveX Control  \n A control has two basic states: active and inactive. Traditionally, these states were distinguished by whether the control had a window. An active control had a window; an inactive control did not. With the introduction of windowless activation, this distinction is no longer universal, but still applies to many controls.  \n  \n When a [windowless control](../mfc/providing-windowless-activation.md) goes active, it invokes mouse capture, keyboard focus, scrolling, and other window services from its container. You can also [provide mouse interaction to inactive controls](../mfc/providing-mouse-interaction-while-inactive.md), as well as create controls that [wait until activated to create a window](../mfc/turning-off-the-activate-when-visible-option.md).  \n  \n When a control with a window becomes active, it is able to interact fully with the control container, the user, and Windows. The figure below demonstrates the paths of communication between the ActiveX control, the control container, and the operating system.  \n  \n ![Msg processing in active windowed ActiveX control](../mfc/media/vc37223.gif \"vc37223\")  \nWindows Message Processing in a Windowed ActiveX Control (When Active)  \n  \n##  <a name=\"_core_serializing_activex_elements\"></a> Serialization  \n The ability to serialize data, sometimes referred to as persistence, allows the control to write the value of its properties to persistent storage. Controls can then be recreated by reading the object's state from the storage.  \n  \n Note that a control is not responsible for obtaining access to the storage medium. Instead, the control's container is responsible for providing the control with a storage medium to use at the appropriate times. For more information on serialization, see the article [MFC ActiveX Controls: Serializing](../mfc/mfc-activex-controls-serializing.md). For information on optimizing serialization, see [Optimizing Persistence and Initialization](../mfc/optimizing-persistence-and-initialization.md) in ActiveX Controls: Optimization.  \n  \n##  <a name=\"_core_installing_activex_control_classes_and_tools\"></a> Installing ActiveX Control Classes and Tools  \n When you install Visual C++, the MFC ActiveX control classes and retail and debug ActiveX control run-time DLLs are automatically installed if ActiveX controls are selected in Setup (they are selected by default).  \n  \n By default, the ActiveX control classes and tools are installed in the following subdirectories under \\Program Files\\Microsoft Visual Studio .NET:  \n  \n-   **\\Common7\\Tools**  \n  \n     Contains the Test Container files (TstCon32.exe, as well as its Help files).  \n  \n-   **\\Vc7\\atlmfc\\include**  \n  \n     Contains the include files needed to develop ActiveX controls with MFC  \n  \n-   **\\Vc7\\atlmfc\\src\\mfc**  \n  \n     Contains the source code for specific ActiveX control classes in MFC  \n  \n-   **\\Vc7\\atlmfc\\lib**  \n  \n     Contains the libraries required to develop ActiveX controls with MFC  \n  \n There are also samples for MFC ActiveX controls. For more information about these samples, see [Controls Samples: MFC-Based ActiveX Controls](../visual-cpp-samples.md)  \n  \n## See Also  \n [User Interface Elements](../mfc/user-interface-elements-mfc.md)\n"}