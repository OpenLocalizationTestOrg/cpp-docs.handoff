{"nodes":[{"pos":[12,48],"content":"CDateTimeCtrl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDateTimeCtrl Class | Microsoft Docs","pos":[0,36]}]},{"content":"CDateTimeCtrl Class","pos":[737,756]},{"content":"Encapsulates the functionality of a date and time picker control.","pos":[757,822]},{"content":"Syntax","pos":[831,837]},{"content":"Members","pos":[897,904]},{"content":"Public Constructors","pos":[914,933]},{"content":"Name","pos":[940,944]},{"content":"Description","pos":[945,956]},{"content":"CDateTimeCtrl::CDateTimeCtrl","pos":[995,1023]},{"pos":[1056,1092],"content":"Constructs a <ph id=\"ph1\">`CDateTimeCtrl`</ph> object.","source":"Constructs a `CDateTimeCtrl` object."},{"content":"Public Methods","pos":[1103,1117]},{"content":"Name","pos":[1124,1128]},{"content":"Description","pos":[1129,1140]},{"content":"CDateTimeCtrl::CloseMonthCal","pos":[1179,1207]},{"content":"Closes the current date and time picker control.","pos":[1240,1288]},{"content":"CDateTimeCtrl::Create","pos":[1294,1315]},{"pos":[1341,1428],"content":"Creates the date and time picker control and attaches it to the <ph id=\"ph1\">`CDateTimeCtrl`</ph> object.","source":"Creates the date and time picker control and attaches it to the `CDateTimeCtrl` object."},{"content":"CDateTimeCtrl::GetDateTimePickerInfo","pos":[1434,1470]},{"content":"Retrieves information about the current date and time picker control.","pos":[1511,1580]},{"content":"CDateTimeCtrl::GetIdealSize","pos":[1586,1613]},{"content":"Returns the ideal size of the date and time picker control that is required to display the current date or time.","pos":[1645,1757]},{"content":"CDateTimeCtrl::GetMonthCalColor","pos":[1763,1794]},{"content":"Retrieves the color for a given portion of the month calendar within the date and time picker control.","pos":[1830,1932]},{"content":"CDateTimeCtrl::GetMonthCalCtrl","pos":[1938,1968]},{"pos":[2003,2089],"content":"Retrieves the <ph id=\"ph1\">`CMonthCalCtrl`</ph> object associated with the date and time picker control.","source":"Retrieves the `CMonthCalCtrl` object associated with the date and time picker control."},{"content":"CDateTimeCtrl::GetMonthCalFont","pos":[2095,2125]},{"content":"Retrieves the font currently used by the date and time picker control's child month calendar control.","pos":[2160,2261]},{"content":"CDateTimeCtrl::GetMonthCalStyle","pos":[2267,2298]},{"content":"Gets the style of the current date and time picker control.","pos":[2334,2393]},{"content":"CDateTimeCtrl::GetRange","pos":[2399,2422]},{"content":"Retrieves the current minimum and maximum allowed system times for a date and time picker control.","pos":[2450,2548]},{"content":"CDateTimeCtrl::GetTime","pos":[2554,2576]},{"pos":[2603,2727],"content":"Retrieves the currently selected time from a date and time picker control and puts it in a specified <ph id=\"ph1\">`SYSTEMTIME`</ph> structure.","source":"Retrieves the currently selected time from a date and time picker control and puts it in a specified `SYSTEMTIME` structure."},{"content":"CDateTimeCtrl::SetFormat","pos":[2733,2757]},{"content":"Sets the display of a date and time picker control in accordance with a given format string.","pos":[2786,2878]},{"content":"CDateTimeCtrl::SetMonthCalColor","pos":[2884,2915]},{"content":"Sets the color for a given portion of the month calendar within a date and time picker control.","pos":[2951,3046]},{"content":"CDateTimeCtrl::SetMonthCalFont","pos":[3052,3082]},{"content":"Sets the font that the date and time picker control's child month calendar control will use.","pos":[3117,3209]},{"content":"CDateTimeCtrl::SetMonthCalStyle","pos":[3215,3246]},{"content":"Sets the style of the current date and time picker control.","pos":[3282,3341]},{"content":"CDateTimeCtrl::SetRange","pos":[3347,3370]},{"content":"Sets the minimum and maximum allowed system times for a date and time picker control.","pos":[3398,3483]},{"content":"CDateTimeCtrl::SetTime","pos":[3489,3511]},{"content":"Sets the time in a date and time picker control.","pos":[3538,3586]},{"content":"Remarks","pos":[3596,3603]},{"content":"The date and time picker control (DTP control) provides a simple interface to exchange date and time information with a user.","pos":[3607,3732]},{"content":"This interface contains fields, each of which displays a part of the date and time information stored in the control.","pos":[3733,3850]},{"content":"The user can change the information stored in the control by changing the content of the string in a given field.","pos":[3851,3964]},{"content":"The user can move from field to field using the mouse or the keyboard.","pos":[3965,4035]},{"content":"You can customize the date and time picker control by applying a variety of styles to the object when you create it.","pos":[4042,4158]},{"content":"See <bpt id=\"p1\">[</bpt>Date and Time Picker Control Styles<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761728)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for more information about styles specific to the date and time picker control.","pos":[4159,4399],"source":" See [Date and Time Picker Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb761728) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about styles specific to the date and time picker control."},{"content":"You can set the display format of the DTP control using format styles.","pos":[4400,4470]},{"content":"These format styles are described under \"Format Styles\" in the <ph id=\"ph1\">[!INCLUDE[winsdkshort](../../atl-mfc-shared/reference/includes/winsdkshort_md.md)]</ph> topic <bpt id=\"p1\">[</bpt>Date and Time Picker Control Styles<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761728)</ept>.","pos":[4471,4721],"source":" These format styles are described under \"Format Styles\" in the [!INCLUDE[winsdkshort](../../atl-mfc-shared/reference/includes/winsdkshort_md.md)] topic [Date and Time Picker Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb761728)."},{"pos":[4728,4879],"content":"The date and time picker control also uses notifications and callbacks, which are described in <bpt id=\"p1\">[</bpt>Using CDateTimeCtrl<ept id=\"p1\">](../../mfc/using-cdatetimectrl.md)</ept>.","source":"The date and time picker control also uses notifications and callbacks, which are described in [Using CDateTimeCtrl](../../mfc/using-cdatetimectrl.md)."},{"content":"Inheritance Hierarchy","pos":[4888,4909]},{"content":"CObject","pos":[4914,4921]},{"content":"CCmdTarget","pos":[4968,4978]},{"content":"CWnd","pos":[5028,5032]},{"content":"Requirements","pos":[5099,5111]},{"pos":[5115,5137],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdtctl.h","source":"**Header:** afxdtctl.h"},{"pos":[5192,5220],"content":"CDateTimeCtrl::CDateTimeCtrl"},{"pos":[5224,5260],"content":"Constructs a <ph id=\"ph1\">`CDateTimeCtrl`</ph> object.","source":"Constructs a `CDateTimeCtrl` object."},{"pos":[5347,5375],"content":"CDateTimeCtrl::CloseMonthCal"},{"content":"Closes the current date and time picker control.","pos":[5379,5427]},{"content":"Remarks","pos":[5483,5490]},{"pos":[5494,5683],"content":"This method sends the <bpt id=\"p1\">[</bpt>DTM_CLOSEMONTHCAL<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761753)</ept> message, which is described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This method sends the [DTM_CLOSEMONTHCAL](http://msdn.microsoft.com/library/windows/desktop/bb761753) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[5693,5700]},{"content":"The following code example defines the variable, <ph id=\"ph1\">`m_dateTimeCtrl`</ph>, that is used to programmatically access the date and time picker control.","pos":[5704,5844],"source":"The following code example defines the variable, `m_dateTimeCtrl`, that is used to programmatically access the date and time picker control."},{"content":"This variable is used in the next example.","pos":[5845,5887]},{"pos":[5905,5931],"content":"NVC_MFC_CDateTimeCtrl_s1#1"},{"content":"Example","pos":[6004,6011]},{"content":"The following code example closes the drop-down calendar for the current date and time picker control.","pos":[6015,6117]},{"pos":[6135,6161],"content":"NVC_MFC_CDateTimeCtrl_s1#5"},{"pos":[6274,6295],"content":"CDateTimeCtrl::Create"},{"pos":[6299,6386],"content":"Creates the date and time picker control and attaches it to the <ph id=\"ph1\">`CDateTimeCtrl`</ph> object.","source":"Creates the date and time picker control and attaches it to the `CDateTimeCtrl` object."},{"content":"Parameters","pos":[6516,6526]},{"content":"Specifies the combination of date time control styles.","pos":[6543,6597]},{"content":"See <bpt id=\"p1\">[</bpt>Date and Time Picker Control Styles<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761728)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for more information about date and time picker styles.","pos":[6598,6814],"source":" See [Date and Time Picker Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb761728) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about date and time picker styles."},{"content":"A reference to a <bpt id=\"p1\">[</bpt>RECT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd162897)</ept> structure, which is the position and size of the date and time picker control.","pos":[6831,6993],"source":" A reference to a [RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897) structure, which is the position and size of the date and time picker control."},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CWnd<ept id=\"p1\">](../../mfc/reference/cwnd-class.md)</ept> object that is the parent window of the date and time picker control.","pos":[7016,7142],"source":" A pointer to a [CWnd](../../mfc/reference/cwnd-class.md) object that is the parent window of the date and time picker control."},{"content":"It must not be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[7143,7167],"source":" It must not be **NULL**."},{"content":"Specifies the date and time picker control's control ID.","pos":[7183,7239]},{"content":"Return Value","pos":[7249,7261]},{"content":"Nonzero if creation was successful; otherwise 0.","pos":[7265,7313]},{"content":"Remarks","pos":[7323,7330]},{"content":"To create a date and time picker control","pos":[7342,7382]},{"pos":[7392,7482],"content":"Call <bpt id=\"p1\">[</bpt>CDateTimeCtrl<ept id=\"p1\">](#cdatetimectrl__cdatetimectrl)</ept> to construct a <ph id=\"ph1\">`CDateTimeCtrl`</ph> object.","source":"Call [CDateTimeCtrl](#cdatetimectrl__cdatetimectrl) to construct a `CDateTimeCtrl` object."},{"pos":[7492,7620],"content":"Call this member function, which creates the Windows date and time picker control and attaches it to the <ph id=\"ph1\">`CDateTimeCtrl`</ph> object.","source":"Call this member function, which creates the Windows date and time picker control and attaches it to the `CDateTimeCtrl` object."},{"pos":[7627,7689],"content":"When you call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>, the common controls are initialized.","source":"When you call **Create**, the common controls are initialized."},{"content":"Example","pos":[7699,7706]},{"pos":[7721,7744],"content":"NVC_MFC_CDateTimeCtrl#1"},{"pos":[7872,7908],"content":"CDateTimeCtrl::GetDateTimePickerInfo"},{"content":"Retrieves information about the current date and time picker control.","pos":[7912,7981]},{"content":"Parameters","pos":[8088,8098]},{"content":"Parameter","pos":[8105,8114]},{"content":"Description","pos":[8115,8126]},{"pos":[8169,8174],"content":"[out]"},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>DATETIMEPICKERINFO<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761729)</ept> structure that receives a description of the current date and time picker control.","pos":[8197,8375],"source":"A pointer to a [DATETIMEPICKERINFO](http://msdn.microsoft.com/library/windows/desktop/bb761729) structure that receives a description of the current date and time picker control."},{"content":"The caller is responsible for allocating this structure.","pos":[8388,8444]},{"content":"However, this method initializes the <ph id=\"ph1\">`cbSize`</ph> member of the structure.","pos":[8445,8515],"source":" However, this method initializes the `cbSize` member of the structure."},{"content":"Return Value","pos":[8526,8538]},{"pos":[8549,8598],"content":"if this method is successful; otherwise, <ph id=\"ph1\">`false`</ph>.","source":" if this method is successful; otherwise, `false`."},{"content":"Remarks","pos":[8608,8615]},{"pos":[8619,8816],"content":"This method sends the <bpt id=\"p1\">[</bpt>DTM_GETDATETIMEPICKERINFO<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761755)</ept> message, which is described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This method sends the [DTM_GETDATETIMEPICKERINFO](http://msdn.microsoft.com/library/windows/desktop/bb761755) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[8826,8833]},{"content":"The following code example defines the variable, <ph id=\"ph1\">`m_dateTimeCtrl`</ph>, that is used to programmatically access the date and time picker control.","pos":[8837,8977],"source":"The following code example defines the variable, `m_dateTimeCtrl`, that is used to programmatically access the date and time picker control."},{"content":"This variable is used in the next example.","pos":[8978,9020]},{"pos":[9038,9064],"content":"NVC_MFC_CDateTimeCtrl_s1#1"},{"content":"Example","pos":[9137,9144]},{"content":"The following code example indicates whether it successfully retrieves information about the current date and time picker control.","pos":[9148,9278]},{"pos":[9296,9322],"content":"NVC_MFC_CDateTimeCtrl_s1#4"},{"pos":[9445,9476],"content":"CDateTimeCtrl::GetMonthCalColor"},{"content":"Retrieves the color for a given portion of the month calendar within the date and time picker control.","pos":[9480,9582]},{"content":"Parameters","pos":[9655,9665]},{"content":"An <ph id=\"ph1\">`int`</ph> value specifying which color area of the month calendar to retrieve.","pos":[9681,9758],"source":" An `int` value specifying which color area of the month calendar to retrieve."},{"content":"For a list of values, see the <ph id=\"ph1\">`iColor`</ph> parameter for <bpt id=\"p1\">[</bpt>SetMonthCalColor<ept id=\"p1\">](#cdatetimectrl__setmonthcalcolor)</ept>.","pos":[9759,9865],"source":" For a list of values, see the `iColor` parameter for [SetMonthCalColor](#cdatetimectrl__setmonthcalcolor)."},{"content":"Return Value","pos":[9875,9887]},{"content":"A <bpt id=\"p1\">**</bpt>COLORREF<ept id=\"p1\">**</ept> value that represents the color setting for the specified portion of the month calendar control if successful.","pos":[9891,10016],"source":"A **COLORREF** value that represents the color setting for the specified portion of the month calendar control if successful."},{"content":"The function returns -1 if unsuccessful.","pos":[10017,10057]},{"content":"Remarks","pos":[10067,10074]},{"pos":[10078,10294],"content":"This member function implements the behavior of the Win32 message <bpt id=\"p1\">[</bpt>DTM_GETMCCOLOR<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761759)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This member function implements the behavior of the Win32 message [DTM_GETMCCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb761759), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[10304,10311]},{"pos":[10326,10349],"content":"NVC_MFC_CDateTimeCtrl#2"},{"pos":[10471,10501],"content":"CDateTimeCtrl::GetMonthCalCtrl"},{"pos":[10505,10591],"content":"Retrieves the <ph id=\"ph1\">`CMonthCalCtrl`</ph> object associated with the date and time picker control.","source":"Retrieves the `CMonthCalCtrl` object associated with the date and time picker control."},{"content":"Return Value","pos":[10659,10671]},{"pos":[10675,10818],"content":"A pointer to a <bpt id=\"p1\">[</bpt>CMonthCalCtrl<ept id=\"p1\">](../../mfc/reference/cmonthcalctrl-class.md)</ept> object, or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> if unsuccessful or if the window is not visible.","source":"A pointer to a [CMonthCalCtrl](../../mfc/reference/cmonthcalctrl-class.md) object, or **NULL** if unsuccessful or if the window is not visible."},{"content":"Remarks","pos":[10828,10835]},{"content":"Date and time picker controls create a child month calendar control when the user clicks the drop-down arrow.","pos":[10839,10948]},{"content":"When the <ph id=\"ph1\">`CMonthCalCtrl`</ph> object is no longer needed, it is destroyed, so your application must not rely on storing the object representing the date time picker control's child month calendar.","pos":[10949,11140],"source":" When the `CMonthCalCtrl` object is no longer needed, it is destroyed, so your application must not rely on storing the object representing the date time picker control's child month calendar."},{"content":"Example","pos":[11150,11157]},{"pos":[11172,11195],"content":"NVC_MFC_CDateTimeCtrl#3"},{"pos":[11317,11347],"content":"CDateTimeCtrl::GetMonthCalFont"},{"content":"Gets the font currently used by the date and time picker control's month calendar control.","pos":[11351,11441]},{"content":"Return Value","pos":[11501,11513]},{"pos":[11517,11612],"content":"A pointer to a <bpt id=\"p1\">[</bpt>CFont<ept id=\"p1\">](../../mfc/reference/cfont-class.md)</ept> object, or <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> if unsuccessful.","source":"A pointer to a [CFont](../../mfc/reference/cfont-class.md) object, or **NULL** if unsuccessful."},{"content":"Remarks","pos":[11622,11629]},{"pos":[11633,11759],"content":"The <ph id=\"ph1\">`CFont`</ph> object pointed to by the return value is a temporary object and is destroyed during the next idle processing time.","source":"The `CFont` object pointed to by the return value is a temporary object and is destroyed during the next idle processing time."},{"pos":[11817,11848],"content":"CDateTimeCtrl::GetMonthCalStyle"},{"content":"Gets the style of the drop-down month calendar control that is associated with the current date and time picker control.","pos":[11852,11972]},{"content":"Return Value","pos":[12032,12044]},{"content":"The style of the drop-down month calendar control, which is a bitwise combination (OR) of date and time picker control styles.","pos":[12048,12174]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Month Calendar Control Styles<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb760919)</ept>.","pos":[12175,12293],"source":" For more information, see [Month Calendar Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb760919)."},{"content":"Remarks","pos":[12303,12310]},{"pos":[12314,12500],"content":"This method sends the <bpt id=\"p1\">[</bpt>DTM_GETMCSTYLE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761763)</ept> message, which is described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This method sends the [DTM_GETMCSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb761763) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[12550,12573],"content":"CDateTimeCtrl::GetRange"},{"content":"Retrieves the current minimum and maximum allowed system times for a date and time picker control.","pos":[12577,12675]},{"content":"Parameters","pos":[12860,12870]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>COleDateTime<ept id=\"p1\">](../../atl-mfc-shared/reference/coledatetime-class.md)</ept> object or a <bpt id=\"p2\">[</bpt>CTime<ept id=\"p2\">](../../atl-mfc-shared/reference/ctime-class.md)</ept> object containing the earliest time allowed in the <ph id=\"ph1\">`CDateTimeCtrl`</ph> object.","pos":[12889,13114],"source":" A pointer to a [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object or a [CTime](../../atl-mfc-shared/reference/ctime-class.md) object containing the earliest time allowed in the `CDateTimeCtrl` object."},{"content":"A pointer to a <ph id=\"ph1\">`COleDateTime`</ph> object or a <ph id=\"ph2\">`CTime`</ph> object containing the latest time allowed in the <ph id=\"ph3\">`CDateTimeCtrl`</ph> object.","pos":[13136,13258],"source":" A pointer to a `COleDateTime` object or a `CTime` object containing the latest time allowed in the `CDateTimeCtrl` object."},{"content":"Return Value","pos":[13268,13280]},{"content":"A <ph id=\"ph1\">`DWORD`</ph> value containing flags that indicate which ranges are set.","pos":[13284,13352],"source":"A `DWORD` value containing flags that indicate which ranges are set."},{"content":"If","pos":[13353,13355]},{"pos":[13388,13392],"content":"== 0"},{"content":"then the second parameter is valid.","pos":[13399,13434]},{"content":"Similarly, if","pos":[13435,13448]},{"pos":[13481,13485],"content":"== 0"},{"content":"then the first parameter is valid.","pos":[13492,13526]},{"content":"Remarks","pos":[13536,13543]},{"content":"This member function implements the behavior of the Win32 message <bpt id=\"p1\">[</bpt>DTM_GETRANGE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761767)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[13547,13761],"source":"This member function implements the behavior of the Win32 message [DTM_GETRANGE](http://msdn.microsoft.com/library/windows/desktop/bb761767), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"In MFC's implementation, you can specify either <ph id=\"ph1\">`COleDateTime`</ph> or <ph id=\"ph2\">`CTime`</ph> usages.","pos":[13762,13843],"source":" In MFC's implementation, you can specify either `COleDateTime` or `CTime` usages."},{"content":"Example","pos":[13853,13860]},{"pos":[13875,13898],"content":"NVC_MFC_CDateTimeCtrl#4"},{"pos":[14012,14034],"content":"CDateTimeCtrl::GetTime"},{"pos":[14038,14162],"content":"Retrieves the currently selected time from a date and time picker control and puts it in a specified <ph id=\"ph1\">`SYSTEMTIME`</ph> structure.","source":"Retrieves the currently selected time from a date and time picker control and puts it in a specified `SYSTEMTIME` structure."},{"content":"Parameters","pos":[14327,14337]},{"content":"timeDest","pos":[14342,14350]},{"content":"In the first version, a reference to a <bpt id=\"p1\">[</bpt>COleDateTime<ept id=\"p1\">](../../atl-mfc-shared/reference/coledatetime-class.md)</ept> object that will receive the system time information.","pos":[14355,14516],"source":" In the first version, a reference to a [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object that will receive the system time information."},{"content":"In the second version, a reference to a <bpt id=\"p1\">[</bpt>CTime<ept id=\"p1\">](../../atl-mfc-shared/reference/ctime-class.md)</ept> object that will receive the system time information.","pos":[14517,14665],"source":" In the second version, a reference to a [CTime](../../atl-mfc-shared/reference/ctime-class.md) object that will receive the system time information."},{"content":"pTimeDest","pos":[14673,14682]},{"content":"A pointer to the <bpt id=\"p1\">[</bpt>SYSTEMTIME<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724950)</ept> structure to receive the system time information.","pos":[14687,14826],"source":" A pointer to the [SYSTEMTIME](http://msdn.microsoft.com/library/windows/desktop/ms724950) structure to receive the system time information."},{"content":"Must not be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[14827,14848],"source":" Must not be **NULL**."},{"content":"Return Value","pos":[14858,14870]},{"content":"In the first version, nonzero if the time is successfully written to the <ph id=\"ph1\">`COleDateTime`</ph> object; otherwise 0.","pos":[14874,14982],"source":"In the first version, nonzero if the time is successfully written to the `COleDateTime` object; otherwise 0."},{"content":"In the second and third versions, a <ph id=\"ph1\">`DWORD`</ph> value equal to the <bpt id=\"p1\">**</bpt>dwFlag<ept id=\"p1\">**</ept> member set in the <bpt id=\"p2\">[</bpt>NMDATETIMECHANGE<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/bb761730)</ept> structure.","pos":[14983,15164],"source":" In the second and third versions, a `DWORD` value equal to the **dwFlag** member set in the [NMDATETIMECHANGE](http://msdn.microsoft.com/library/windows/desktop/bb761730) structure."},{"content":"See the <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> section below for more information.","pos":[15165,15220],"source":" See the **Remarks** section below for more information."},{"content":"Remarks","pos":[15230,15237]},{"content":"This member function implements the behavior of the Win32 message <bpt id=\"p1\">[</bpt>DTM_GETSYSTEMTIME<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761769)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[15241,15460],"source":"This member function implements the behavior of the Win32 message [DTM_GETSYSTEMTIME](http://msdn.microsoft.com/library/windows/desktop/bb761769), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"In the MFC implementation of <bpt id=\"p1\">**</bpt>GetTime<ept id=\"p1\">**</ept>, you can use <ph id=\"ph1\">`COleDateTime`</ph> or <ph id=\"ph2\">`CTime`</ph> classes, or you can use a <ph id=\"ph3\">`SYSTEMTIME`</ph> structure, to store the time information.","pos":[15461,15621],"source":" In the MFC implementation of **GetTime**, you can use `COleDateTime` or `CTime` classes, or you can use a `SYSTEMTIME` structure, to store the time information."},{"content":"The return value <ph id=\"ph1\">`DWORD`</ph> in the second and third versions, above, indicates whether or not the date and time picker control is set to the \"no date\" status, as indicated in the <bpt id=\"p1\">[</bpt>NMDATETIMECHANGE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761730)</ept> structure member <ph id=\"ph2\">`dwFlags`</ph>.","pos":[15628,15910],"source":"The return value `DWORD` in the second and third versions, above, indicates whether or not the date and time picker control is set to the \"no date\" status, as indicated in the [NMDATETIMECHANGE](http://msdn.microsoft.com/library/windows/desktop/bb761730) structure member `dwFlags`."},{"content":"If the value returned equals <bpt id=\"p1\">**</bpt>GDT_NONE<ept id=\"p1\">**</ept>, the control is set to \"no date\" status, and uses the <bpt id=\"p2\">**</bpt>DTS_SHOWNONE<ept id=\"p2\">**</ept> style.","pos":[15911,16030],"source":" If the value returned equals **GDT_NONE**, the control is set to \"no date\" status, and uses the **DTS_SHOWNONE** style."},{"content":"If the value returned equals <bpt id=\"p1\">**</bpt>GDT_VALID<ept id=\"p1\">**</ept>, the system time is successfully stored in the destination location.","pos":[16031,16142],"source":" If the value returned equals **GDT_VALID**, the system time is successfully stored in the destination location."},{"content":"Example","pos":[16152,16159]},{"pos":[16174,16197],"content":"NVC_MFC_CDateTimeCtrl#5"},{"pos":[16316,16343],"content":"CDateTimeCtrl::GetIdealSize"},{"content":"Returns the ideal size of the date and time picker control that is required to display the current date or time.","pos":[16347,16459]},{"content":"Parameters","pos":[16529,16539]},{"content":"Parameter","pos":[16546,16555]},{"content":"Description","pos":[16556,16567]},{"pos":[16610,16615],"content":"[out]"},{"pos":[16624,16759],"content":"Pointer to a <bpt id=\"p1\">[</bpt>SIZE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd145106)</ept> structure that contains the ideal size for the control.","source":"Pointer to a [SIZE](http://msdn.microsoft.com/library/windows/desktop/dd145106) structure that contains the ideal size for the control."},{"content":"Return Value","pos":[16770,16782]},{"pos":[16786,16820],"content":"The return value is always <ph id=\"ph1\">`true`</ph>.","source":"The return value is always `true`."},{"content":"Remarks","pos":[16830,16837]},{"pos":[16841,17029],"content":"This method sends the <bpt id=\"p1\">[</bpt>DTM_GETIDEALSIZE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761757)</ept> message, which is described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This method sends the [DTM_GETIDEALSIZE](http://msdn.microsoft.com/library/windows/desktop/bb761757) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[17039,17046]},{"content":"The following code example defines the variable, <ph id=\"ph1\">`m_dateTimeCtrl`</ph>, that is used to programmatically access the date and time picker control.","pos":[17050,17190],"source":"The following code example defines the variable, `m_dateTimeCtrl`, that is used to programmatically access the date and time picker control."},{"content":"This variable is used in the next example.","pos":[17191,17233]},{"pos":[17251,17277],"content":"NVC_MFC_CDateTimeCtrl_s1#1"},{"content":"Example","pos":[17350,17357]},{"content":"The following code example retrieves the ideal size to display the date and time picker control.","pos":[17361,17457]},{"pos":[17475,17501],"content":"NVC_MFC_CDateTimeCtrl_s1#2"},{"pos":[17617,17641],"content":"CDateTimeCtrl::SetFormat"},{"content":"Sets the display of a date and time picker control in accordance with a given format string.","pos":[17645,17737]},{"content":"Parameters","pos":[17798,17808]},{"content":"pstrFormat","pos":[17813,17823]},{"content":"A pointer to a zero-terminated format string that defines the desired display.","pos":[17828,17906]},{"content":"Setting this parameter to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> will reset the control to the default format string for the current style.","pos":[17907,18016],"source":" Setting this parameter to **NULL** will reset the control to the default format string for the current style."},{"content":"Return Value","pos":[18026,18038]},{"content":"Nonzero if successful; otherwise 0.","pos":[18042,18077]},{"pos":[18085,18159],"content":"[!NOTE]\n User input does not determine success or failure for this call.","leadings":["","> "],"nodes":[{"content":"User input does not determine success or failure for this call.","pos":[9,72]}]},{"content":"Remarks","pos":[18169,18176]},{"pos":[18180,18395],"content":"This member function implements the behavior of the Win32 message <bpt id=\"p1\">[</bpt>DTM_SETFORMAT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761771)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This member function implements the behavior of the Win32 message [DTM_SETFORMAT](http://msdn.microsoft.com/library/windows/desktop/bb761771), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[18405,18412]},{"pos":[18427,18450],"content":"NVC_MFC_CDateTimeCtrl#6"},{"pos":[18574,18605],"content":"CDateTimeCtrl::SetMonthCalColor"},{"content":"Sets the color for a given portion of the month calendar within a date and time picker control.","pos":[18609,18704]},{"content":"Parameters","pos":[18793,18803]},{"content":"value specifying which area of the month calendar control to set.","pos":[18825,18890]},{"content":"This value can be one of the following.","pos":[18891,18930]},{"content":"Value","pos":[18937,18942]},{"content":"Meaning","pos":[18943,18950]},{"content":"MCSC_BACKGROUND","pos":[18985,19000]},{"content":"Set the background color displayed between months.","pos":[19001,19051]},{"content":"MCSC_MONTHBK","pos":[19056,19068]},{"content":"Set the background color displayed within a month.","pos":[19069,19119]},{"content":"MCSC_TEXT","pos":[19124,19133]},{"content":"Set the color used to display text within a month.","pos":[19134,19184]},{"content":"MCSC_TITLEBK","pos":[19189,19201]},{"content":"Set the background color displayed in the calendar's title.","pos":[19202,19261]},{"content":"MCSC_TITLETEXT","pos":[19266,19280]},{"content":"Set the color used to display text within the calendar's title.","pos":[19281,19344]},{"content":"MCSC_TRAILINGTEXT","pos":[19349,19366]},{"content":"Set the color used to display header and trailing-day text.","pos":[19367,19426]},{"content":"Header and trailing days are the days from the previous and following months that appear on the current calendar.","pos":[19427,19540]},{"content":"A <bpt id=\"p1\">**</bpt>COLORREF<ept id=\"p1\">**</ept> value representing the color that will be set for the specified area of the month calendar.","pos":[19557,19663],"source":" A **COLORREF** value representing the color that will be set for the specified area of the month calendar."},{"content":"Return Value","pos":[19673,19685]},{"content":"A <bpt id=\"p1\">**</bpt>COLORREF<ept id=\"p1\">**</ept> value that represents the previous color setting for the specified portion of the month calendar control if successful.","pos":[19689,19823],"source":"A **COLORREF** value that represents the previous color setting for the specified portion of the month calendar control if successful."},{"content":"Otherwise, the message returns -1.","pos":[19824,19858]},{"content":"Remarks","pos":[19868,19875]},{"pos":[19879,20095],"content":"This member function implements the behavior of the Win32 message <bpt id=\"p1\">[</bpt>DTM_SETMCCOLOR<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761773)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This member function implements the behavior of the Win32 message [DTM_SETMCCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb761773), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[20105,20112]},{"pos":[20117,20205],"content":"See the example for <bpt id=\"p1\">[</bpt>CDateTimeCtrl::GetMonthCalColor<ept id=\"p1\">](#cdatetimectrl__getmonthcalcolor)</ept>.","source":"See the example for [CDateTimeCtrl::GetMonthCalColor](#cdatetimectrl__getmonthcalcolor)."},{"pos":[20262,20292],"content":"CDateTimeCtrl::SetMonthCalFont"},{"content":"Sets the font that the date and time picker control's child month calendar control will use.","pos":[20296,20388]},{"content":"Parameters","pos":[20480,20490]},{"content":"Handle to the font that will be set.","pos":[20505,20541]},{"content":"Specifies whether the control should be redrawn immediately upon setting the font.","pos":[20561,20643]},{"content":"Setting this parameter to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> causes the control to redraw itself.","pos":[20644,20715],"source":" Setting this parameter to **TRUE** causes the control to redraw itself."},{"content":"Remarks","pos":[20725,20732]},{"pos":[20736,20951],"content":"This member function implements the behavior of the Win32 message <bpt id=\"p1\">[</bpt>DTM_SETMCFONT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761775)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This member function implements the behavior of the Win32 message [DTM_SETMCFONT](http://msdn.microsoft.com/library/windows/desktop/bb761775), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[20961,20968]},{"pos":[20983,21006],"content":"NVC_MFC_CDateTimeCtrl#7"},{"pos":[21080,21213],"content":"[!NOTE]\n If you use this code, you'll want to make a member of your `CDialog`-derived class called `m_MonthFont` of type **CFont**.","leadings":["","> "],"nodes":[{"content":"If you use this code, you'll want to make a member of your <ph id=\"ph1\">`CDialog`</ph>-derived class called <ph id=\"ph2\">`m_MonthFont`</ph> of type <bpt id=\"p1\">**</bpt>CFont<ept id=\"p1\">**</ept>.","pos":[9,131],"source":" If you use this code, you'll want to make a member of your `CDialog`-derived class called `m_MonthFont` of type **CFont**."}]},{"pos":[21271,21302],"content":"CDateTimeCtrl::SetMonthCalStyle"},{"content":"Sets the style of the drop-down month calendar control that is associated with the current date and time picker control.","pos":[21306,21426]},{"content":"Parameters","pos":[21493,21503]},{"content":"Parameter","pos":[21510,21519]},{"content":"Description","pos":[21520,21531]},{"pos":[21574,21578],"content":"[in]"},{"content":"A new month calendar control style, which is a bitwise combination (OR) of month calendar control styles.","pos":[21589,21694]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Month Calendar Control Styles<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb760919)</ept>.","pos":[21695,21813],"source":" For more information, see [Month Calendar Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb760919)."},{"content":"Return Value","pos":[21824,21836]},{"content":"The previous style of the drop-down month calendar control.","pos":[21840,21899]},{"content":"Remarks","pos":[21909,21916]},{"pos":[21920,22106],"content":"This method sends the <bpt id=\"p1\">[</bpt>DTM_SETMCSTYLE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761778)</ept> message, which is described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This method sends the [DTM_SETMCSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb761778) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[22116,22123]},{"content":"The following code example defines the variable, <ph id=\"ph1\">`m_dateTimeCtrl`</ph>, that is used to programmatically access the date and time picker control.","pos":[22127,22267],"source":"The following code example defines the variable, `m_dateTimeCtrl`, that is used to programmatically access the date and time picker control."},{"content":"This variable is used in the next example.","pos":[22268,22310]},{"pos":[22328,22354],"content":"NVC_MFC_CDateTimeCtrl_s1#1"},{"content":"Example","pos":[22427,22434]},{"content":"The following code example sets the date and time picker control to display week numbers, abbreviated names of days of the week, and no today indicator.","pos":[22438,22590]},{"pos":[22608,22634],"content":"NVC_MFC_CDateTimeCtrl_s1#3"},{"pos":[22750,22773],"content":"CDateTimeCtrl::SetRange"},{"content":"Sets the minimum and maximum allowed system times for a date and time picker control.","pos":[22777,22862]},{"content":"Parameters","pos":[23052,23062]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>COleDateTime<ept id=\"p1\">](../../atl-mfc-shared/reference/coledatetime-class.md)</ept> object or a <bpt id=\"p2\">[</bpt>CTime<ept id=\"p2\">](../../atl-mfc-shared/reference/ctime-class.md)</ept> object containing the earliest time allowed in the <ph id=\"ph1\">`CDateTimeCtrl`</ph> object.","pos":[23081,23306],"source":" A pointer to a [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object or a [CTime](../../atl-mfc-shared/reference/ctime-class.md) object containing the earliest time allowed in the `CDateTimeCtrl` object."},{"content":"A pointer to a <ph id=\"ph1\">`COleDateTime`</ph> object or a <ph id=\"ph2\">`CTime`</ph> object containing the latest time allowed in the <ph id=\"ph3\">`CDateTimeCtrl`</ph> object.","pos":[23328,23450],"source":" A pointer to a `COleDateTime` object or a `CTime` object containing the latest time allowed in the `CDateTimeCtrl` object."},{"content":"Return Value","pos":[23460,23472]},{"content":"Nonzero if successful; otherwise 0.","pos":[23476,23511]},{"content":"Remarks","pos":[23521,23528]},{"content":"This member function implements the behavior of the Win32 message <bpt id=\"p1\">[</bpt>DTM_SETRANGE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761780)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[23532,23746],"source":"This member function implements the behavior of the Win32 message [DTM_SETRANGE](http://msdn.microsoft.com/library/windows/desktop/bb761780), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"In MFC's implementation, you can specify either <ph id=\"ph1\">`COleDateTime`</ph> or <ph id=\"ph2\">`CTime`</ph> usages.","pos":[23747,23828],"source":" In MFC's implementation, you can specify either `COleDateTime` or `CTime` usages."},{"content":"If the <ph id=\"ph1\">`COleDateTime`</ph> object has a <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> status, the range will be removed.","pos":[23829,23907],"source":" If the `COleDateTime` object has a **NULL** status, the range will be removed."},{"content":"If the <ph id=\"ph1\">`CTime`</ph> pointer or the <ph id=\"ph2\">`COleDateTime`</ph> pointer is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the range will be removed.","pos":[23908,24000],"source":" If the `CTime` pointer or the `COleDateTime` pointer is **NULL**, the range will be removed."},{"content":"Example","pos":[24010,24017]},{"pos":[24022,24094],"content":"See the example for <bpt id=\"p1\">[</bpt>CDateTimeCtrl::GetRange<ept id=\"p1\">](#cdatetimectrl__getrange)</ept>.","source":"See the example for [CDateTimeCtrl::GetRange](#cdatetimectrl__getrange)."},{"pos":[24143,24165],"content":"CDateTimeCtrl::SetTime"},{"content":"Sets the time in a date and time picker control.","pos":[24169,24217]},{"content":"Parameters","pos":[24372,24382]},{"content":"timeNew","pos":[24387,24394]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>COleDateTime<ept id=\"p1\">](../../atl-mfc-shared/reference/coledatetime-class.md)</ept> object containing the to which the control will be set.","pos":[24399,24540],"source":" A reference to a [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object containing the to which the control will be set."},{"content":"pTimeNew","pos":[24548,24556]},{"content":"In the second version above, a pointer to a <bpt id=\"p1\">[</bpt>CTime<ept id=\"p1\">](../../atl-mfc-shared/reference/ctime-class.md)</ept> object containing the time to which the control will be set.","pos":[24561,24720],"source":" In the second version above, a pointer to a [CTime](../../atl-mfc-shared/reference/ctime-class.md) object containing the time to which the control will be set."},{"content":"In the third version above, a pointer to a <bpt id=\"p1\">[</bpt>SYSTEMTIME<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724950)</ept> structure containing the time to which the control will be set.","pos":[24721,24900],"source":" In the third version above, a pointer to a [SYSTEMTIME](http://msdn.microsoft.com/library/windows/desktop/ms724950) structure containing the time to which the control will be set."},{"content":"Return Value","pos":[24910,24922]},{"content":"Nonzero if successful; otherwise 0.","pos":[24926,24961]},{"content":"Remarks","pos":[24971,24978]},{"content":"This member function implements the behavior of the Win32 message <bpt id=\"p1\">[</bpt>DTM_SETSYSTEMTIME<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb761782)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[24982,25201],"source":"This member function implements the behavior of the Win32 message [DTM_SETSYSTEMTIME](http://msdn.microsoft.com/library/windows/desktop/bb761782), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"In the MFC implementation of <bpt id=\"p1\">**</bpt>SetTime<ept id=\"p1\">**</ept>, you can use the <ph id=\"ph1\">`COleDateTime`</ph> or <ph id=\"ph2\">`CTime`</ph> classes, or you can use a <ph id=\"ph3\">`SYSTEMTIME`</ph> structure, to set the time information.","pos":[25202,25364],"source":" In the MFC implementation of **SetTime**, you can use the `COleDateTime` or `CTime` classes, or you can use a `SYSTEMTIME` structure, to set the time information."},{"content":"Example","pos":[25374,25381]},{"pos":[25396,25419],"content":"NVC_MFC_CDateTimeCtrl#8"},{"content":"See Also","pos":[25494,25502]},{"content":"MFC Sample CMNCTRL1","pos":[25507,25526]},{"content":"CWnd Class","pos":[25562,25572]},{"content":"Hierarchy Chart","pos":[25614,25629]},{"content":"CMonthCalCtrl Class","pos":[25666,25685]}],"content":"---\ntitle: \"CDateTimeCtrl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDateTimeCtrl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DateTimePicker control [MFC], CDateTimeCtrl class\"\n  - \"date-picking functionality\"\n  - \"CDateTimeCtrl class\"\n  - \"DateTimePicker control [MFC]\"\nms.assetid: 7113993b-5d37-4148-939f-500a190c5bdc\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDateTimeCtrl Class\nEncapsulates the functionality of a date and time picker control.  \n  \n## Syntax  \n  \n```  \nclass CDateTimeCtrl : public CWnd  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDateTimeCtrl::CDateTimeCtrl](#cdatetimectrl__cdatetimectrl)|Constructs a `CDateTimeCtrl` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDateTimeCtrl::CloseMonthCal](#cdatetimectrl__closemonthcal)|Closes the current date and time picker control.|  \n|[CDateTimeCtrl::Create](#cdatetimectrl__create)|Creates the date and time picker control and attaches it to the `CDateTimeCtrl` object.|  \n|[CDateTimeCtrl::GetDateTimePickerInfo](#cdatetimectrl__getdatetimepickerinfo)|Retrieves information about the current date and time picker control.|  \n|[CDateTimeCtrl::GetIdealSize](#cdatetimectrl__getidealsize)|Returns the ideal size of the date and time picker control that is required to display the current date or time.|  \n|[CDateTimeCtrl::GetMonthCalColor](#cdatetimectrl__getmonthcalcolor)|Retrieves the color for a given portion of the month calendar within the date and time picker control.|  \n|[CDateTimeCtrl::GetMonthCalCtrl](#cdatetimectrl__getmonthcalctrl)|Retrieves the `CMonthCalCtrl` object associated with the date and time picker control.|  \n|[CDateTimeCtrl::GetMonthCalFont](#cdatetimectrl__getmonthcalfont)|Retrieves the font currently used by the date and time picker control's child month calendar control.|  \n|[CDateTimeCtrl::GetMonthCalStyle](#cdatetimectrl__getmonthcalstyle)|Gets the style of the current date and time picker control.|  \n|[CDateTimeCtrl::GetRange](#cdatetimectrl__getrange)|Retrieves the current minimum and maximum allowed system times for a date and time picker control.|  \n|[CDateTimeCtrl::GetTime](#cdatetimectrl__gettime)|Retrieves the currently selected time from a date and time picker control and puts it in a specified `SYSTEMTIME` structure.|  \n|[CDateTimeCtrl::SetFormat](#cdatetimectrl__setformat)|Sets the display of a date and time picker control in accordance with a given format string.|  \n|[CDateTimeCtrl::SetMonthCalColor](#cdatetimectrl__setmonthcalcolor)|Sets the color for a given portion of the month calendar within a date and time picker control.|  \n|[CDateTimeCtrl::SetMonthCalFont](#cdatetimectrl__setmonthcalfont)|Sets the font that the date and time picker control's child month calendar control will use.|  \n|[CDateTimeCtrl::SetMonthCalStyle](#cdatetimectrl__setmonthcalstyle)|Sets the style of the current date and time picker control.|  \n|[CDateTimeCtrl::SetRange](#cdatetimectrl__setrange)|Sets the minimum and maximum allowed system times for a date and time picker control.|  \n|[CDateTimeCtrl::SetTime](#cdatetimectrl__settime)|Sets the time in a date and time picker control.|  \n  \n## Remarks  \n The date and time picker control (DTP control) provides a simple interface to exchange date and time information with a user. This interface contains fields, each of which displays a part of the date and time information stored in the control. The user can change the information stored in the control by changing the content of the string in a given field. The user can move from field to field using the mouse or the keyboard.  \n  \n You can customize the date and time picker control by applying a variety of styles to the object when you create it. See [Date and Time Picker Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb761728) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about styles specific to the date and time picker control. You can set the display format of the DTP control using format styles. These format styles are described under \"Format Styles\" in the [!INCLUDE[winsdkshort](../../atl-mfc-shared/reference/includes/winsdkshort_md.md)] topic [Date and Time Picker Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb761728).  \n  \n The date and time picker control also uses notifications and callbacks, which are described in [Using CDateTimeCtrl](../../mfc/using-cdatetimectrl.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n `CDateTimeCtrl`  \n  \n## Requirements  \n **Header:** afxdtctl.h  \n  \n##  <a name=\"cdatetimectrl__cdatetimectrl\"></a>  CDateTimeCtrl::CDateTimeCtrl  \n Constructs a `CDateTimeCtrl` object.  \n  \n```  \nCDateTimeCtrl();\n```  \n  \n##  <a name=\"cdatetimectrl__closemonthcal\"></a>  CDateTimeCtrl::CloseMonthCal  \n Closes the current date and time picker control.  \n  \n```  \nvoid CloseMonthCal() const;\n\n \n```  \n  \n### Remarks  \n This method sends the [DTM_CLOSEMONTHCAL](http://msdn.microsoft.com/library/windows/desktop/bb761753) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n The following code example defines the variable, `m_dateTimeCtrl`, that is used to programmatically access the date and time picker control. This variable is used in the next example.  \n  \n [!code-cpp[NVC_MFC_CDateTimeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_1.h)]  \n  \n### Example  \n The following code example closes the drop-down calendar for the current date and time picker control.  \n  \n [!code-cpp[NVC_MFC_CDateTimeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_2.cpp)]  \n  \n##  <a name=\"cdatetimectrl__create\"></a>  CDateTimeCtrl::Create  \n Creates the date and time picker control and attaches it to the `CDateTimeCtrl` object.  \n  \n```  \nvirtual BOOL Create(\n    DWORD dwStyle,  \n    const RECT& rect,  \n    CWnd* pParentWnd,  \n    UINT nID);\n```  \n  \n### Parameters  \n `dwStyle`  \n Specifies the combination of date time control styles. See [Date and Time Picker Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb761728) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information about date and time picker styles.  \n  \n `rect`  \n A reference to a [RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897) structure, which is the position and size of the date and time picker control.  \n  \n `pParentWnd`  \n A pointer to a [CWnd](../../mfc/reference/cwnd-class.md) object that is the parent window of the date and time picker control. It must not be **NULL**.  \n  \n `nID`  \n Specifies the date and time picker control's control ID.  \n  \n### Return Value  \n Nonzero if creation was successful; otherwise 0.  \n  \n### Remarks  \n  \n##### To create a date and time picker control  \n  \n1.  Call [CDateTimeCtrl](#cdatetimectrl__cdatetimectrl) to construct a `CDateTimeCtrl` object.  \n  \n2.  Call this member function, which creates the Windows date and time picker control and attaches it to the `CDateTimeCtrl` object.  \n  \n When you call **Create**, the common controls are initialized.  \n  \n### Example  \n [!code-cpp[NVC_MFC_CDateTimeCtrl#1](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_3.cpp)]  \n  \n##  <a name=\"cdatetimectrl__getdatetimepickerinfo\"></a>  CDateTimeCtrl::GetDateTimePickerInfo  \n Retrieves information about the current date and time picker control.  \n  \n```  \n \nBOOL GetDateTimePickerInfo(\nLPDATETIMEPICKERINFO pDateTimePickerInfo) const;\n\n \n```  \n  \n### Parameters  \n  \n|Parameter|Description|  \n|---------------|-----------------|  \n|[out] `pDateTimePickerInfo`|A pointer to a [DATETIMEPICKERINFO](http://msdn.microsoft.com/library/windows/desktop/bb761729) structure that receives a description of the current date and time picker control.<br /><br /> The caller is responsible for allocating this structure. However, this method initializes the `cbSize` member of the structure.|  \n  \n### Return Value  \n `true` if this method is successful; otherwise, `false`.  \n  \n### Remarks  \n This method sends the [DTM_GETDATETIMEPICKERINFO](http://msdn.microsoft.com/library/windows/desktop/bb761755) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n The following code example defines the variable, `m_dateTimeCtrl`, that is used to programmatically access the date and time picker control. This variable is used in the next example.  \n  \n [!code-cpp[NVC_MFC_CDateTimeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_1.h)]  \n  \n### Example  \n The following code example indicates whether it successfully retrieves information about the current date and time picker control.  \n  \n [!code-cpp[NVC_MFC_CDateTimeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_4.cpp)]  \n  \n##  <a name=\"cdatetimectrl__getmonthcalcolor\"></a>  CDateTimeCtrl::GetMonthCalColor  \n Retrieves the color for a given portion of the month calendar within the date and time picker control.  \n  \n```  \nCOLORREF GetMonthCalColor(int iColor) const;\n\n \n```  \n  \n### Parameters  \n `iColor`  \n An `int` value specifying which color area of the month calendar to retrieve. For a list of values, see the `iColor` parameter for [SetMonthCalColor](#cdatetimectrl__setmonthcalcolor).  \n  \n### Return Value  \n A **COLORREF** value that represents the color setting for the specified portion of the month calendar control if successful. The function returns -1 if unsuccessful.  \n  \n### Remarks  \n This member function implements the behavior of the Win32 message [DTM_GETMCCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb761759), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n [!code-cpp[NVC_MFC_CDateTimeCtrl#2](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_5.cpp)]  \n  \n##  <a name=\"cdatetimectrl__getmonthcalctrl\"></a>  CDateTimeCtrl::GetMonthCalCtrl  \n Retrieves the `CMonthCalCtrl` object associated with the date and time picker control.  \n  \n```  \nCMonthCalCtrl* GetMonthCalCtrl() const;\n\n \n```  \n  \n### Return Value  \n A pointer to a [CMonthCalCtrl](../../mfc/reference/cmonthcalctrl-class.md) object, or **NULL** if unsuccessful or if the window is not visible.  \n  \n### Remarks  \n Date and time picker controls create a child month calendar control when the user clicks the drop-down arrow. When the `CMonthCalCtrl` object is no longer needed, it is destroyed, so your application must not rely on storing the object representing the date time picker control's child month calendar.  \n  \n### Example  \n [!code-cpp[NVC_MFC_CDateTimeCtrl#3](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_6.cpp)]  \n  \n##  <a name=\"cdatetimectrl__getmonthcalfont\"></a>  CDateTimeCtrl::GetMonthCalFont  \n Gets the font currently used by the date and time picker control's month calendar control.  \n  \n```  \nCFont* GetMonthCalFont() const;\n\n \n```  \n  \n### Return Value  \n A pointer to a [CFont](../../mfc/reference/cfont-class.md) object, or **NULL** if unsuccessful.  \n  \n### Remarks  \n The `CFont` object pointed to by the return value is a temporary object and is destroyed during the next idle processing time.  \n  \n##  <a name=\"cdatetimectrl__getmonthcalstyle\"></a>  CDateTimeCtrl::GetMonthCalStyle  \n Gets the style of the drop-down month calendar control that is associated with the current date and time picker control.  \n  \n```  \nDWORD GetMonthCalStyle() const;\n\n \n```  \n  \n### Return Value  \n The style of the drop-down month calendar control, which is a bitwise combination (OR) of date and time picker control styles. For more information, see [Month Calendar Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb760919).  \n  \n### Remarks  \n This method sends the [DTM_GETMCSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb761763) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"cdatetimectrl__getrange\"></a>  CDateTimeCtrl::GetRange  \n Retrieves the current minimum and maximum allowed system times for a date and time picker control.  \n  \n```  \nDWORD GetRange(\n    COleDateTime* pMinRange,  \n    COleDateTime* pMaxRange) const;\n\n \n \nDWORD GetRange(\n    CTime* pMinRange,  \n    CTime* pMaxRange) const;\n\n \n```  \n  \n### Parameters  \n `pMinRange`  \n A pointer to a [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object or a [CTime](../../atl-mfc-shared/reference/ctime-class.md) object containing the earliest time allowed in the `CDateTimeCtrl` object.  \n  \n `pMaxRange`  \n A pointer to a `COleDateTime` object or a `CTime` object containing the latest time allowed in the `CDateTimeCtrl` object.  \n  \n### Return Value  \n A `DWORD` value containing flags that indicate which ranges are set. If  \n  \n `return value & GDTR_MAX` == 0  \n  \n then the second parameter is valid. Similarly, if  \n  \n `return value & GDTR_MIN` == 0  \n  \n then the first parameter is valid.  \n  \n### Remarks  \n This member function implements the behavior of the Win32 message [DTM_GETRANGE](http://msdn.microsoft.com/library/windows/desktop/bb761767), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]. In MFC's implementation, you can specify either `COleDateTime` or `CTime` usages.  \n  \n### Example  \n [!code-cpp[NVC_MFC_CDateTimeCtrl#4](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_7.cpp)]  \n  \n##  <a name=\"cdatetimectrl__gettime\"></a>  CDateTimeCtrl::GetTime  \n Retrieves the currently selected time from a date and time picker control and puts it in a specified `SYSTEMTIME` structure.  \n  \n```  \nBOOL GetTime(COleDateTime& timeDest) const;\n\n \n \nDWORD GetTime(CTime& timeDest) const;\n\n \n \nDWORD GetTime(LPSYSTEMTIME pTimeDest) const;\n\n \n```  \n  \n### Parameters  \n *timeDest*  \n In the first version, a reference to a [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object that will receive the system time information. In the second version, a reference to a [CTime](../../atl-mfc-shared/reference/ctime-class.md) object that will receive the system time information.  \n  \n *pTimeDest*  \n A pointer to the [SYSTEMTIME](http://msdn.microsoft.com/library/windows/desktop/ms724950) structure to receive the system time information. Must not be **NULL**.  \n  \n### Return Value  \n In the first version, nonzero if the time is successfully written to the `COleDateTime` object; otherwise 0. In the second and third versions, a `DWORD` value equal to the **dwFlag** member set in the [NMDATETIMECHANGE](http://msdn.microsoft.com/library/windows/desktop/bb761730) structure. See the **Remarks** section below for more information.  \n  \n### Remarks  \n This member function implements the behavior of the Win32 message [DTM_GETSYSTEMTIME](http://msdn.microsoft.com/library/windows/desktop/bb761769), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]. In the MFC implementation of **GetTime**, you can use `COleDateTime` or `CTime` classes, or you can use a `SYSTEMTIME` structure, to store the time information.  \n  \n The return value `DWORD` in the second and third versions, above, indicates whether or not the date and time picker control is set to the \"no date\" status, as indicated in the [NMDATETIMECHANGE](http://msdn.microsoft.com/library/windows/desktop/bb761730) structure member `dwFlags`. If the value returned equals **GDT_NONE**, the control is set to \"no date\" status, and uses the **DTS_SHOWNONE** style. If the value returned equals **GDT_VALID**, the system time is successfully stored in the destination location.  \n  \n### Example  \n [!code-cpp[NVC_MFC_CDateTimeCtrl#5](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_8.cpp)]  \n  \n##  <a name=\"cdatetimectrl__getidealsize\"></a>  CDateTimeCtrl::GetIdealSize  \n Returns the ideal size of the date and time picker control that is required to display the current date or time.  \n  \n```  \n \nBOOL GetIdealSize(\nLPSIZE psize) const;\n\n \n```  \n  \n### Parameters  \n  \n|Parameter|Description|  \n|---------------|-----------------|  \n|[out] `psize`|Pointer to a [SIZE](http://msdn.microsoft.com/library/windows/desktop/dd145106) structure that contains the ideal size for the control.|  \n  \n### Return Value  \n The return value is always `true`.  \n  \n### Remarks  \n This method sends the [DTM_GETIDEALSIZE](http://msdn.microsoft.com/library/windows/desktop/bb761757) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n The following code example defines the variable, `m_dateTimeCtrl`, that is used to programmatically access the date and time picker control. This variable is used in the next example.  \n  \n [!code-cpp[NVC_MFC_CDateTimeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_1.h)]  \n  \n### Example  \n The following code example retrieves the ideal size to display the date and time picker control.  \n  \n [!code-cpp[NVC_MFC_CDateTimeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_9.cpp)]  \n  \n##  <a name=\"cdatetimectrl__setformat\"></a>  CDateTimeCtrl::SetFormat  \n Sets the display of a date and time picker control in accordance with a given format string.  \n  \n```  \nBOOL SetFormat(LPCTSTR pstrFormat);\n```  \n  \n### Parameters  \n *pstrFormat*  \n A pointer to a zero-terminated format string that defines the desired display. Setting this parameter to **NULL** will reset the control to the default format string for the current style.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n> [!NOTE]\n>  User input does not determine success or failure for this call.  \n  \n### Remarks  \n This member function implements the behavior of the Win32 message [DTM_SETFORMAT](http://msdn.microsoft.com/library/windows/desktop/bb761771), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n [!code-cpp[NVC_MFC_CDateTimeCtrl#6](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_10.cpp)]  \n  \n##  <a name=\"cdatetimectrl__setmonthcalcolor\"></a>  CDateTimeCtrl::SetMonthCalColor  \n Sets the color for a given portion of the month calendar within a date and time picker control.  \n  \n```  \nCOLORREF SetMonthCalColor(\n    int iColor,  \n    COLORREF ref);\n```  \n  \n### Parameters  \n `iColor`  \n `int` value specifying which area of the month calendar control to set. This value can be one of the following.  \n  \n|Value|Meaning|  \n|-----------|-------------|  \n|MCSC_BACKGROUND|Set the background color displayed between months.|  \n|MCSC_MONTHBK|Set the background color displayed within a month.|  \n|MCSC_TEXT|Set the color used to display text within a month.|  \n|MCSC_TITLEBK|Set the background color displayed in the calendar's title.|  \n|MCSC_TITLETEXT|Set the color used to display text within the calendar's title.|  \n|MCSC_TRAILINGTEXT|Set the color used to display header and trailing-day text. Header and trailing days are the days from the previous and following months that appear on the current calendar.|  \n  \n `ref`  \n A **COLORREF** value representing the color that will be set for the specified area of the month calendar.  \n  \n### Return Value  \n A **COLORREF** value that represents the previous color setting for the specified portion of the month calendar control if successful. Otherwise, the message returns -1.  \n  \n### Remarks  \n This member function implements the behavior of the Win32 message [DTM_SETMCCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb761773), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n  See the example for [CDateTimeCtrl::GetMonthCalColor](#cdatetimectrl__getmonthcalcolor).  \n  \n##  <a name=\"cdatetimectrl__setmonthcalfont\"></a>  CDateTimeCtrl::SetMonthCalFont  \n Sets the font that the date and time picker control's child month calendar control will use.  \n  \n```  \nvoid SetMonthCalFont(\n    HFONT hFont,  \n    BOOL bRedraw = TRUE);\n```  \n  \n### Parameters  \n `hFont`  \n Handle to the font that will be set.  \n  \n `bRedraw`  \n Specifies whether the control should be redrawn immediately upon setting the font. Setting this parameter to **TRUE** causes the control to redraw itself.  \n  \n### Remarks  \n This member function implements the behavior of the Win32 message [DTM_SETMCFONT](http://msdn.microsoft.com/library/windows/desktop/bb761775), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n [!code-cpp[NVC_MFC_CDateTimeCtrl#7](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_11.cpp)]  \n  \n> [!NOTE]\n>  If you use this code, you'll want to make a member of your `CDialog`-derived class called `m_MonthFont` of type **CFont**.  \n  \n##  <a name=\"cdatetimectrl__setmonthcalstyle\"></a>  CDateTimeCtrl::SetMonthCalStyle  \n Sets the style of the drop-down month calendar control that is associated with the current date and time picker control.  \n  \n```  \n \nDWORD SetMonthCalStyle(\nDWORD dwStyle);\n```  \n  \n### Parameters  \n  \n|Parameter|Description|  \n|---------------|-----------------|  \n|[in] `dwStyle`|A new month calendar control style, which is a bitwise combination (OR) of month calendar control styles. For more information, see [Month Calendar Control Styles](http://msdn.microsoft.com/library/windows/desktop/bb760919).|  \n  \n### Return Value  \n The previous style of the drop-down month calendar control.  \n  \n### Remarks  \n This method sends the [DTM_SETMCSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb761778) message, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n The following code example defines the variable, `m_dateTimeCtrl`, that is used to programmatically access the date and time picker control. This variable is used in the next example.  \n  \n [!code-cpp[NVC_MFC_CDateTimeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_1.h)]  \n  \n### Example  \n The following code example sets the date and time picker control to display week numbers, abbreviated names of days of the week, and no today indicator.  \n  \n [!code-cpp[NVC_MFC_CDateTimeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_12.cpp)]  \n  \n##  <a name=\"cdatetimectrl__setrange\"></a>  CDateTimeCtrl::SetRange  \n Sets the minimum and maximum allowed system times for a date and time picker control.  \n  \n```  \nBOOL SetRange(\n    const COleDateTime* pMinRange,  \n    const COleDateTime* pMaxRange);\n\n \nBOOL SetRange(\n    const CTime* pMinRange,  \n    const CTime* pMaxRange);\n```  \n  \n### Parameters  \n `pMinRange`  \n A pointer to a [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object or a [CTime](../../atl-mfc-shared/reference/ctime-class.md) object containing the earliest time allowed in the `CDateTimeCtrl` object.  \n  \n `pMaxRange`  \n A pointer to a `COleDateTime` object or a `CTime` object containing the latest time allowed in the `CDateTimeCtrl` object.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n This member function implements the behavior of the Win32 message [DTM_SETRANGE](http://msdn.microsoft.com/library/windows/desktop/bb761780), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]. In MFC's implementation, you can specify either `COleDateTime` or `CTime` usages. If the `COleDateTime` object has a **NULL** status, the range will be removed. If the `CTime` pointer or the `COleDateTime` pointer is **NULL**, the range will be removed.  \n  \n### Example  \n  See the example for [CDateTimeCtrl::GetRange](#cdatetimectrl__getrange).  \n  \n##  <a name=\"cdatetimectrl__settime\"></a>  CDateTimeCtrl::SetTime  \n Sets the time in a date and time picker control.  \n  \n```  \nBOOL SetTime(const COleDateTime& timeNew);\n\n \nBOOL SetTime(const CTime* pTimeNew);\n\n \nBOOL SetTime(LPSYSTEMTIME pTimeNew = NULL);\n```  \n  \n### Parameters  \n *timeNew*  \n A reference to a [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) object containing the to which the control will be set.  \n  \n *pTimeNew*  \n In the second version above, a pointer to a [CTime](../../atl-mfc-shared/reference/ctime-class.md) object containing the time to which the control will be set. In the third version above, a pointer to a [SYSTEMTIME](http://msdn.microsoft.com/library/windows/desktop/ms724950) structure containing the time to which the control will be set.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0.  \n  \n### Remarks  \n This member function implements the behavior of the Win32 message [DTM_SETSYSTEMTIME](http://msdn.microsoft.com/library/windows/desktop/bb761782), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]. In the MFC implementation of **SetTime**, you can use the `COleDateTime` or `CTime` classes, or you can use a `SYSTEMTIME` structure, to set the time information.  \n  \n### Example  \n [!code-cpp[NVC_MFC_CDateTimeCtrl#8](../../mfc/reference/codesnippet/cpp/cdatetimectrl-class_13.cpp)]  \n  \n## See Also  \n [MFC Sample CMNCTRL1](../../visual-cpp-samples.md)   \n [CWnd Class](../../mfc/reference/cwnd-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CMonthCalCtrl Class](../../mfc/reference/cmonthcalctrl-class.md)\n"}