{"nodes":[{"pos":[12,101],"content":"TN055: Migrating MFC ODBC Database Class Applications to MFC DAO Classes | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"TN055: Migrating MFC ODBC Database Class Applications to MFC DAO Classes | Microsoft Docs","pos":[0,89]}]},{"content":"TN055: Migrating MFC ODBC Database Class Applications to MFC DAO Classes","pos":[957,1029]},{"pos":[1032,1410],"content":"[!NOTE]\n As of Visual C++ .NET, the Visual C++ environment and wizards no longer support DAO (although the DAO classes are included and you can still use them). Microsoft recommends that you use [OLE DB Templates](../data/oledb/ole-db-templates.md) or [ODBC and MFC](../data/odbc/odbc-and-mfc.md) for new projects. You should only use DAO in maintaining existing applications.","leadings":["","> "],"nodes":[{"content":" As of Visual C++ .NET, the Visual C++ environment and wizards no longer support DAO (although the DAO classes are included and you can still use them). Microsoft recommends that you use [OLE DB Templates](../data/oledb/ole-db-templates.md) or [ODBC and MFC](../data/odbc/odbc-and-mfc.md) for new projects. You should only use DAO in maintaining existing applications.","pos":[8,376],"nodes":[{"content":"As of Visual C++ .NET, the Visual C++ environment and wizards no longer support DAO (although the DAO classes are included and you can still use them).","pos":[1,152]},{"content":"Microsoft recommends that you use <bpt id=\"p1\">[</bpt>OLE DB Templates<ept id=\"p1\">](../data/oledb/ole-db-templates.md)</ept> or <bpt id=\"p2\">[</bpt>ODBC and MFC<ept id=\"p2\">](../data/odbc/odbc-and-mfc.md)</ept> for new projects.","pos":[153,306],"source":" Microsoft recommends that you use [OLE DB Templates](../data/oledb/ole-db-templates.md) or [ODBC and MFC](../data/odbc/odbc-and-mfc.md) for new projects."},{"content":"You should only use DAO in maintaining existing applications.","pos":[307,368]}]}]},{"content":"Overview","pos":[1419,1427]},{"content":"In many situations it may be desirable to migrate applications that use MFC's ODBC database classes to MFC's DAO database classes.","pos":[1436,1566]},{"content":"This technical note will detail most of the differences between the MFC ODBC and DAO classes.","pos":[1567,1660]},{"content":"With the differences in mind, it should not be overly difficult to migrate applications from the ODBC classes to the MFC classes if desired.","pos":[1661,1801]},{"content":"Why Migrate from ODBC to DAO","pos":[1810,1838]},{"content":"There are a number of reasons why you might want to migrate applications from the ODBC Database Classes to the DAO Database Classes, but the decision is not necessarily simple or obvious.","pos":[1847,2034]},{"content":"One thing to keep in mind is that the Microsoft Jet database engine that is used by DAO can read any ODBC data source for which you have an ODBC driver.","pos":[2035,2187]},{"content":"It may be more efficient to use the ODBC Database Classes or call ODBC directly yourself, but the Microsoft Jet database engine can read ODBC data.","pos":[2188,2335]},{"content":"Some simple cases that make the ODBC/DAO decision easy.","pos":[2342,2397]},{"content":"For instance, when you only need access to data in a format that the Microsoft Jet engine can read directly (Access format, Excel format, and so on) the obvious choice is to use the DAO Database Classes.","pos":[2398,2601]},{"content":"More complex cases arise when your data exists on a server or on a variety of different servers.","pos":[2608,2704]},{"content":"In this case, the decision to use the ODBC Database classes or the DAO Database classes is a difficult one.","pos":[2705,2812]},{"content":"If you want to do things like heterogeneous joins (join data from servers in multiple formats like SQL Server and Oracle), then the Microsoft Jet database engine will perform the join for you rather than forcing you to do the work necessary if you used the ODBC Database Classes or called ODBC directly.","pos":[2813,3116]},{"content":"If you are using an ODBC driver that supports driver cursors, your best choice might be the ODBC Database classes.","pos":[3117,3231]},{"content":"The choice can be complicated, so you might want to write some sample code to test the performance of various methods given your special needs.","pos":[3238,3381]},{"content":"This technical note assumes that you have made the decision to migrate from the ODBC Database Classes to the DAO Database classes.","pos":[3382,3512]},{"content":"Similarities Between ODBC Database Classes and MFC DAO Database Classes","pos":[3521,3592]},{"content":"The original design of the MFC ODBC classes was based on the DAO object model that has been in use in Microsoft Access and Microsoft Visual Basic.","pos":[3601,3747]},{"content":"This means that there are many common features of the ODBC and DAO MFC classes, which will not all be listed in this section.","pos":[3748,3873]},{"content":"In general, the programming models are the same.","pos":[3874,3922]},{"content":"To highlight a few similarities:","pos":[3929,3961]},{"content":"Both the ODBC and DAO classes have database objects that manage using the underlying database management system (DBMS).","pos":[3971,4090]},{"content":"Both have recordset objects representing a set of results returned from that DBMS.","pos":[4100,4182]},{"content":"The DAO database and recordset objects have members nearly identical to the ODBC classes.","pos":[4192,4281]},{"content":"With both sets of classes, the code to retrieve data is identical except for some object and member name changes.","pos":[4291,4404]},{"content":"Changes will be required, but usually the process is a straightforward name change when switching from the ODBC classes to DAO classes.","pos":[4405,4540]},{"content":"For example, in both models the procedure to retrieve data is to create and open a database object, create and open a recordset object, and navigate (move) though the data performing some operation.","pos":[4547,4745]},{"content":"Differences Between ODBC and DAO MFC Classes","pos":[4754,4798]},{"content":"The DAO classes include more objects and a richer set of methods, but this section will only detail the differences in similar classes and functionality.","pos":[4807,4960]},{"content":"Probably the most obvious differences between the classes are the name changes for similar classes and global functions.","pos":[4967,5087]},{"content":"The following list shows the name changes of the objects, methods and global functions associated with the database classes:","pos":[5088,5212]},{"content":"Class or function","pos":[5219,5236]},{"content":"Equivalent in MFC DAO classes","pos":[5237,5266]},{"content":"RFX_Date","pos":[5748,5756]},{"pos":[5762,5797],"content":"<bpt id=\"p1\">**</bpt>DFX_Date<ept id=\"p1\">**</ept> (<ph id=\"ph1\">`COleDateTime`</ph>-based)","source":"**DFX_Date** (`COleDateTime`-based)"},{"pos":[5905,5974],"content":"The <ph id=\"ph1\">`RFX_Date`</ph> function is based on <ph id=\"ph2\">`CTime`</ph> and <bpt id=\"p1\">**</bpt>TIMESTAMP_STRUCT<ept id=\"p1\">**</ept>.","source":"    The `RFX_Date` function is based on `CTime` and **TIMESTAMP_STRUCT**."},{"content":"The major changes to functionality which may affect your application and require more than simple name changes are listed below.","pos":[5981,6109]},{"content":"The constants and macros used to specify things like recordset open type and recordset open options have been changed.","pos":[6119,6237]},{"content":"With the ODBC classes MFC needed to define these options via macros or enumerated types.","pos":[6248,6336]},{"content":"With the DAO classes, DAO provides the definition of these options in a header file (DBDAOINT.H).","pos":[6347,6444]},{"content":"Thus the recordset type is an enumerated member of <ph id=\"ph1\">`CRecordset`</ph>, but with DAO it is a constant instead.","pos":[6445,6548],"source":" Thus the recordset type is an enumerated member of `CRecordset`, but with DAO it is a constant instead."},{"content":"For example you would use <bpt id=\"p1\">**</bpt>snapshot<ept id=\"p1\">**</ept> when specifying the type of <ph id=\"ph1\">`CRecordset`</ph> in ODBC but <bpt id=\"p2\">**</bpt>DB_OPEN_SNAPSHOT<ept id=\"p2\">**</ept> when specifying the type of <ph id=\"ph2\">`CDaoRecordset`</ph>.","pos":[6549,6706],"source":" For example you would use **snapshot** when specifying the type of `CRecordset` in ODBC but **DB_OPEN_SNAPSHOT** when specifying the type of `CDaoRecordset`."},{"pos":[6716,6916],"content":"The default recordset type for <ph id=\"ph1\">`CRecordset`</ph> is <bpt id=\"p1\">**</bpt>snapshot<ept id=\"p1\">**</ept> while the default recordset type for <ph id=\"ph2\">`CDaoRecordset`</ph> is <bpt id=\"p2\">**</bpt>dynaset<ept id=\"p2\">**</ept> (see the Note below for an additional issue about ODBC class snapshots).","source":"The default recordset type for `CRecordset` is **snapshot** while the default recordset type for `CDaoRecordset` is **dynaset** (see the Note below for an additional issue about ODBC class snapshots)."},{"content":"The ODBC <ph id=\"ph1\">`CRecordset`</ph> class has an option to create a forward-only recordset type.","pos":[6926,7008],"source":"The ODBC `CRecordset` class has an option to create a forward-only recordset type."},{"content":"In the <ph id=\"ph1\">`CDaoRecordset`</ph> class, forward-only is not a recordset type, but rather a property (or option) of certain types of recordsets.","pos":[7009,7142],"source":" In the `CDaoRecordset` class, forward-only is not a recordset type, but rather a property (or option) of certain types of recordsets."},{"content":"An append-only recordset when opening a <ph id=\"ph1\">`CRecordset`</ph> object meant that the recordset's data could be read and appended.","pos":[7152,7271],"source":"An append-only recordset when opening a `CRecordset` object meant that the recordset's data could be read and appended."},{"content":"With <ph id=\"ph1\">`CDaoRecordset`</ph> object, the append-only option means literally that the recordset's data can only be appended (and not read).","pos":[7272,7402],"source":" With `CDaoRecordset` object, the append-only option means literally that the recordset's data can only be appended (and not read)."},{"content":"The ODBC classes' transaction member functions are members of <ph id=\"ph1\">`CDatabase`</ph> and act at the database level.","pos":[7412,7516],"source":"The ODBC classes' transaction member functions are members of `CDatabase` and act at the database level."},{"content":"In the DAO classes, the transaction member functions are members of a higher level class (<ph id=\"ph1\">`CDaoWorkspace`</ph>) and thus may impact multiple <ph id=\"ph2\">`CDaoDatabase`</ph> objects sharing the same workspace (transaction space).","pos":[7517,7723],"source":" In the DAO classes, the transaction member functions are members of a higher level class (`CDaoWorkspace`) and thus may impact multiple `CDaoDatabase` objects sharing the same workspace (transaction space)."},{"content":"The exception class has been changed.","pos":[7733,7770]},{"content":"<bpt id=\"p1\">**</bpt>CDBExceptions<ept id=\"p1\">**</ept> are thrown in the ODBC classes and <bpt id=\"p2\">**</bpt>CDaoExceptions<ept id=\"p2\">**</ept> in the DAO classes.","pos":[7771,7862],"source":"**CDBExceptions** are thrown in the ODBC classes and **CDaoExceptions** in the DAO classes."},{"content":"uses <ph id=\"ph1\">`CTime`</ph> and <bpt id=\"p1\">**</bpt>TIMESTAMP_STRUCT<ept id=\"p1\">**</ept> objects while <bpt id=\"p2\">**</bpt>DFX_Date<ept id=\"p2\">**</ept> uses <ph id=\"ph2\">`COleDateTime`</ph>.","pos":[7883,7968],"source":" uses `CTime` and **TIMESTAMP_STRUCT** objects while **DFX_Date** uses `COleDateTime`."},{"content":"The <ph id=\"ph1\">`COleDateTime`</ph> is nearly identical to <ph id=\"ph2\">`CTime`</ph>, but is based on a 8-byte OLE <bpt id=\"p1\">**</bpt>DATE<ept id=\"p1\">**</ept> rather than a 4-byte <ph id=\"ph3\">`time_t`</ph> so it can hold a much bigger range of data.","pos":[7969,8131],"source":" The `COleDateTime` is nearly identical to `CTime`, but is based on a 8-byte OLE **DATE** rather than a 4-byte `time_t` so it can hold a much bigger range of data."},{"pos":[8143,8665],"content":"[!NOTE]\n DAO (`CDaoRecordset`) snapshots are read-only while ODBC (`CRecordset`) snapshots may be updateable depending on the driver and use of the ODBC cursor library. If you are using the cursor library, `CRecordset` snapshots are updateable. If you are using any of the Microsoft drivers from Desktop Driver Pack 3.0 without the ODBC cursor library, the `CRecordset` snapshots are read-only. If you are using another driver, check the driver's documentation to see if snapshots (**STATIC_CURSORS**) are read-only.","leadings":["","    > "],"nodes":[{"content":" DAO (`CDaoRecordset`) snapshots are read-only while ODBC (`CRecordset`) snapshots may be updateable depending on the driver and use of the ODBC cursor library. If you are using the cursor library, `CRecordset` snapshots are updateable. If you are using any of the Microsoft drivers from Desktop Driver Pack 3.0 without the ODBC cursor library, the `CRecordset` snapshots are read-only. If you are using another driver, check the driver's documentation to see if snapshots (**STATIC_CURSORS**) are read-only.","pos":[8,516],"nodes":[{"content":"DAO (<ph id=\"ph1\">`CDaoRecordset`</ph>) snapshots are read-only while ODBC (<ph id=\"ph2\">`CRecordset`</ph>) snapshots may be updateable depending on the driver and use of the ODBC cursor library.","pos":[1,160],"source":" DAO (`CDaoRecordset`) snapshots are read-only while ODBC (`CRecordset`) snapshots may be updateable depending on the driver and use of the ODBC cursor library."},{"content":"If you are using the cursor library, <ph id=\"ph1\">`CRecordset`</ph> snapshots are updateable.","pos":[161,236],"source":" If you are using the cursor library, `CRecordset` snapshots are updateable."},{"content":"If you are using any of the Microsoft drivers from Desktop Driver Pack 3.0 without the ODBC cursor library, the <ph id=\"ph1\">`CRecordset`</ph> snapshots are read-only.","pos":[237,386],"source":" If you are using any of the Microsoft drivers from Desktop Driver Pack 3.0 without the ODBC cursor library, the `CRecordset` snapshots are read-only."},{"content":"If you are using another driver, check the driver's documentation to see if snapshots (<bpt id=\"p1\">**</bpt>STATIC_CURSORS<ept id=\"p1\">**</ept>) are read-only.","pos":[387,508],"source":" If you are using another driver, check the driver's documentation to see if snapshots (**STATIC_CURSORS**) are read-only."}]}]},{"content":"See Also","pos":[8674,8682]},{"content":"Technical Notes by Number","pos":[8687,8712]},{"content":"Technical Notes by Category","pos":[8756,8783]}],"content":"---\ntitle: \"TN055: Migrating MFC ODBC Database Class Applications to MFC DAO Classes | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.mfc.odbc\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DAO [C++], migration\"\n  - \"TN055\"\n  - \"migration [C++], ODBC database applications\"\n  - \"ODBC classes [C++], DAO classes\"\n  - \"migrating ODBC database applications\"\n  - \"porting database applications to DAO\"\n  - \"ODBC [C++], DAO\"\n  - \"porting ODBC database applications to DAO\"\n  - \"migrating database applications\"\nms.assetid: 0f858bd1-e168-4e2e-bcd1-8debd82856e4\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# TN055: Migrating MFC ODBC Database Class Applications to MFC DAO Classes\n> [!NOTE]\n>  As of Visual C++ .NET, the Visual C++ environment and wizards no longer support DAO (although the DAO classes are included and you can still use them). Microsoft recommends that you use [OLE DB Templates](../data/oledb/ole-db-templates.md) or [ODBC and MFC](../data/odbc/odbc-and-mfc.md) for new projects. You should only use DAO in maintaining existing applications.  \n  \n **Overview**  \n  \n In many situations it may be desirable to migrate applications that use MFC's ODBC database classes to MFC's DAO database classes. This technical note will detail most of the differences between the MFC ODBC and DAO classes. With the differences in mind, it should not be overly difficult to migrate applications from the ODBC classes to the MFC classes if desired.  \n  \n **Why Migrate from ODBC to DAO**  \n  \n There are a number of reasons why you might want to migrate applications from the ODBC Database Classes to the DAO Database Classes, but the decision is not necessarily simple or obvious. One thing to keep in mind is that the Microsoft Jet database engine that is used by DAO can read any ODBC data source for which you have an ODBC driver. It may be more efficient to use the ODBC Database Classes or call ODBC directly yourself, but the Microsoft Jet database engine can read ODBC data.  \n  \n Some simple cases that make the ODBC/DAO decision easy. For instance, when you only need access to data in a format that the Microsoft Jet engine can read directly (Access format, Excel format, and so on) the obvious choice is to use the DAO Database Classes.  \n  \n More complex cases arise when your data exists on a server or on a variety of different servers. In this case, the decision to use the ODBC Database classes or the DAO Database classes is a difficult one. If you want to do things like heterogeneous joins (join data from servers in multiple formats like SQL Server and Oracle), then the Microsoft Jet database engine will perform the join for you rather than forcing you to do the work necessary if you used the ODBC Database Classes or called ODBC directly. If you are using an ODBC driver that supports driver cursors, your best choice might be the ODBC Database classes.  \n  \n The choice can be complicated, so you might want to write some sample code to test the performance of various methods given your special needs. This technical note assumes that you have made the decision to migrate from the ODBC Database Classes to the DAO Database classes.  \n  \n **Similarities Between ODBC Database Classes and MFC DAO Database Classes**  \n  \n The original design of the MFC ODBC classes was based on the DAO object model that has been in use in Microsoft Access and Microsoft Visual Basic. This means that there are many common features of the ODBC and DAO MFC classes, which will not all be listed in this section. In general, the programming models are the same.  \n  \n To highlight a few similarities:  \n  \n-   Both the ODBC and DAO classes have database objects that manage using the underlying database management system (DBMS).  \n  \n-   Both have recordset objects representing a set of results returned from that DBMS.  \n  \n-   The DAO database and recordset objects have members nearly identical to the ODBC classes.  \n  \n-   With both sets of classes, the code to retrieve data is identical except for some object and member name changes. Changes will be required, but usually the process is a straightforward name change when switching from the ODBC classes to DAO classes.  \n  \n For example, in both models the procedure to retrieve data is to create and open a database object, create and open a recordset object, and navigate (move) though the data performing some operation.  \n  \n **Differences Between ODBC and DAO MFC Classes**  \n  \n The DAO classes include more objects and a richer set of methods, but this section will only detail the differences in similar classes and functionality.  \n  \n Probably the most obvious differences between the classes are the name changes for similar classes and global functions. The following list shows the name changes of the objects, methods and global functions associated with the database classes:  \n  \n|Class or function|Equivalent in MFC DAO classes|  \n|-----------------------|-----------------------------------|  \n|`CDatabase`|`CDaoDatabase`|  \n|`CDatabase::ExecuteSQL`|`CDaoDatabase::Execute`|  \n|`CRecordset`|`CDaoRecordset`|  \n|`CRecordset::GetDefaultConnect`|`CDaoRecordset::GetDefaultDBName`|  \n|`CFieldExchange`|`CDaoFieldExchange`|  \n|`RFX_Bool`|`DFX_Bool`|  \n|`RFX_Byte`|`DFX_Byte`|  \n|`RFX_Int`|`DFX_Short`|  \n|`RFX_Long`|`DFX_Long`|  \n||`DFX_Currency`|  \n|`RFX_Single`|`DFX_Single`|  \n|`RFX_Double`|`DFX_Double`|  \n|**RFX_Date \\***|**DFX_Date** (`COleDateTime`-based)|  \n|`RFX_Text`|`DFX_Text`|  \n|`RFX_Binary`|`DFX_Binary`|  \n|`RFX_LongBinary`|`DFX_LongBinary`|  \n  \n \\*    The `RFX_Date` function is based on `CTime` and **TIMESTAMP_STRUCT**.  \n  \n The major changes to functionality which may affect your application and require more than simple name changes are listed below.  \n  \n-   The constants and macros used to specify things like recordset open type and recordset open options have been changed.  \n  \n     With the ODBC classes MFC needed to define these options via macros or enumerated types.  \n  \n     With the DAO classes, DAO provides the definition of these options in a header file (DBDAOINT.H). Thus the recordset type is an enumerated member of `CRecordset`, but with DAO it is a constant instead. For example you would use **snapshot** when specifying the type of `CRecordset` in ODBC but **DB_OPEN_SNAPSHOT** when specifying the type of `CDaoRecordset`.  \n  \n-   The default recordset type for `CRecordset` is **snapshot** while the default recordset type for `CDaoRecordset` is **dynaset** (see the Note below for an additional issue about ODBC class snapshots).  \n  \n-   The ODBC `CRecordset` class has an option to create a forward-only recordset type. In the `CDaoRecordset` class, forward-only is not a recordset type, but rather a property (or option) of certain types of recordsets.  \n  \n-   An append-only recordset when opening a `CRecordset` object meant that the recordset's data could be read and appended. With `CDaoRecordset` object, the append-only option means literally that the recordset's data can only be appended (and not read).  \n  \n-   The ODBC classes' transaction member functions are members of `CDatabase` and act at the database level. In the DAO classes, the transaction member functions are members of a higher level class (`CDaoWorkspace`) and thus may impact multiple `CDaoDatabase` objects sharing the same workspace (transaction space).  \n  \n-   The exception class has been changed. **CDBExceptions** are thrown in the ODBC classes and **CDaoExceptions** in the DAO classes.  \n  \n-   `RFX_Date` uses `CTime` and **TIMESTAMP_STRUCT** objects while **DFX_Date** uses `COleDateTime`. The `COleDateTime` is nearly identical to `CTime`, but is based on a 8-byte OLE **DATE** rather than a 4-byte `time_t` so it can hold a much bigger range of data.  \n  \n    > [!NOTE]\n    >  DAO (`CDaoRecordset`) snapshots are read-only while ODBC (`CRecordset`) snapshots may be updateable depending on the driver and use of the ODBC cursor library. If you are using the cursor library, `CRecordset` snapshots are updateable. If you are using any of the Microsoft drivers from Desktop Driver Pack 3.0 without the ODBC cursor library, the `CRecordset` snapshots are read-only. If you are using another driver, check the driver's documentation to see if snapshots (**STATIC_CURSORS**) are read-only.  \n  \n## See Also  \n [Technical Notes by Number](../mfc/technical-notes-by-number.md)   \n [Technical Notes by Category](../mfc/technical-notes-by-category.md)\n\n"}