{"nodes":[{"pos":[12,76],"content":"Recordset: How Recordsets Select Records (ODBC) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Recordset: How Recordsets Select Records (ODBC) | Microsoft Docs","pos":[0,64]}]},{"content":"Recordset: How Recordsets Select Records (ODBC)","pos":[798,845]},{"content":"This topic applies to the MFC ODBC classes.","pos":[846,889]},{"content":"This topic explains:","pos":[896,916]},{"pos":[926,1018],"content":"<bpt id=\"p1\">[</bpt>Your role and your options in selecting records<ept id=\"p1\">](#_core_your_options_in_selecting_records)</ept>.","source":"[Your role and your options in selecting records](#_core_your_options_in_selecting_records)."},{"pos":[1028,1148],"content":"<bpt id=\"p1\">[</bpt>How a recordset constructs its SQL statement and selects records<ept id=\"p1\">](#_core_how_a_recordset_constructs_its_sql_statement)</ept>.","source":"[How a recordset constructs its SQL statement and selects records](#_core_how_a_recordset_constructs_its_sql_statement)."},{"pos":[1158,1237],"content":"<bpt id=\"p1\">[</bpt>What you can do to customize the selection<ept id=\"p1\">](#_core_customizing_the_selection)</ept>.","source":"[What you can do to customize the selection](#_core_customizing_the_selection)."},{"content":"Recordsets select records from a data source through an ODBC driver by sending SQL statements to the driver.","pos":[1244,1352]},{"content":"The SQL sent depends on how you design and open your recordset class.","pos":[1353,1422]},{"pos":[1487,1520],"content":"Your Options in Selecting Records"},{"content":"The following table shows your options in selecting records.","pos":[1524,1584]},{"content":"How and When You Can Affect a Recordset","pos":[1594,1633]},{"content":"When you","pos":[1640,1648]},{"content":"You can","pos":[1649,1656]},{"pos":[1694,1752],"content":"Declare your recordset class with the <bpt id=\"p1\">**</bpt>Add Class<ept id=\"p1\">**</ept> wizard","source":"Declare your recordset class with the **Add Class** wizard"},{"content":"Specify which table to select from.","pos":[1753,1788]},{"content":"Specify which columns to include.","pos":[1801,1834]},{"content":"See <bpt id=\"p1\">[</bpt>Adding an MFC ODBC Consumer<ept id=\"p1\">](../../mfc/reference/adding-an-mfc-odbc-consumer.md)</ept>.","pos":[1847,1933],"source":" See [Adding an MFC ODBC Consumer](../../mfc/reference/adding-an-mfc-odbc-consumer.md)."},{"content":"Complete your recordset class implementation","pos":[1938,1982]},{"content":"Override member functions such as <ph id=\"ph1\">`OnSetOptions`</ph> (advanced) to set application-specific options or to change defaults.","pos":[1983,2101],"source":"Override member functions such as `OnSetOptions` (advanced) to set application-specific options or to change defaults."},{"content":"Specify parameter data members if you want a parameterized recordset.","pos":[2102,2171]},{"pos":[2176,2231],"content":"Construct a recordset object (before you call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>)","source":"Construct a recordset object (before you call **Open**)"},{"content":"Specify a search condition (possibly compound) for use in a <bpt id=\"p1\">**</bpt>WHERE<ept id=\"p1\">**</ept> clause that filters the records.","pos":[2232,2334],"source":"Specify a search condition (possibly compound) for use in a **WHERE** clause that filters the records."},{"content":"See <bpt id=\"p1\">[</bpt>Recordset: Filtering Records (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-filtering-records-odbc.md)</ept>.","pos":[2335,2430],"source":" See [Recordset: Filtering Records (ODBC)](../../data/odbc/recordset-filtering-records-odbc.md)."},{"content":"Specify a sort order for use in an <bpt id=\"p1\">**</bpt>ORDER BY<ept id=\"p1\">**</ept> clause that sorts the records.","pos":[2443,2521],"source":" Specify a sort order for use in an **ORDER BY** clause that sorts the records."},{"content":"See <bpt id=\"p1\">[</bpt>Recordset: Sorting Records (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-sorting-records-odbc.md)</ept>.","pos":[2522,2613],"source":" See [Recordset: Sorting Records (ODBC)](../../data/odbc/recordset-sorting-records-odbc.md)."},{"content":"Specify parameter values for any parameters you added to the class.","pos":[2626,2693]},{"content":"See <bpt id=\"p1\">[</bpt>Recordset: Parameterizing a Recordset (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)</ept>.","pos":[2694,2807],"source":" See [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)."},{"content":"|Run the recordset's query by calling <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>|Specify a custom SQL string to replace the default SQL string set up by the wizard.","pos":[2812,2942],"source":"|Run the recordset's query by calling **Open**|Specify a custom SQL string to replace the default SQL string set up by the wizard."},{"content":"See <bpt id=\"p1\">[</bpt>CRecordset::Open<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__open)</ept> in the <bpt id=\"p2\">*</bpt>Class Library Reference<ept id=\"p2\">*</ept> and <bpt id=\"p3\">[</bpt>SQL: Customizing Your Recordset's SQL Statement (ODBC)<ept id=\"p3\">](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)</ept>.|","pos":[2943,3190],"source":" See [CRecordset::Open](../../mfc/reference/crecordset-class.md#crecordset__open) in the *Class Library Reference* and [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).|"},{"content":"|Call <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> to requery the recordset with the latest values on the data source|Specify new parameters, filter, or sort.","pos":[3194,3319],"source":"|Call **Requery** to requery the recordset with the latest values on the data source|Specify new parameters, filter, or sort."},{"content":"See <bpt id=\"p1\">[</bpt>Recordset: Requerying a Recordset (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-requerying-a-recordset-odbc.md)</ept>.|","pos":[3320,3426],"source":" See [Recordset: Requerying a Recordset (ODBC)](../../data/odbc/recordset-requerying-a-recordset-odbc.md).|"},{"pos":[3502,3546],"content":"How a Recordset Constructs Its SQL Statement"},{"pos":[3550,3750],"content":"When you call a recordset object's <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__open)</ept> member function, <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> constructs a SQL statement using some or all of the following ingredients:","source":"When you call a recordset object's [Open](../../mfc/reference/crecordset-class.md#crecordset__open) member function, **Open** constructs a SQL statement using some or all of the following ingredients:"},{"content":"The <bpt id=\"p1\">**</bpt>lpszSQL<ept id=\"p1\">**</ept> parameter passed to <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","pos":[3760,3805],"source":"The **lpszSQL** parameter passed to **Open**."},{"content":"If not <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, this parameter specifies a custom SQL string or part of one.","pos":[3806,3883],"source":" If not **NULL**, this parameter specifies a custom SQL string or part of one."},{"content":"The framework parses the string.","pos":[3884,3916]},{"content":"If the string is a SQL <bpt id=\"p1\">**</bpt>SELECT<ept id=\"p1\">**</ept> statement or an ODBC <bpt id=\"p2\">**</bpt>CALL<ept id=\"p2\">**</ept> statement, the framework uses the string as the recordset's SQL statement.","pos":[3917,4055],"source":" If the string is a SQL **SELECT** statement or an ODBC **CALL** statement, the framework uses the string as the recordset's SQL statement."},{"content":"If the string does not begin with \"SELECT\" or \"{CALL\", the framework uses what is supplied to construct a SQL <bpt id=\"p1\">**</bpt>FROM<ept id=\"p1\">**</ept> clause.","pos":[4056,4182],"source":" If the string does not begin with \"SELECT\" or \"{CALL\", the framework uses what is supplied to construct a SQL **FROM** clause."},{"content":"The string returned by <bpt id=\"p1\">[</bpt>GetDefaultSQL<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__getdefaultsql)</ept>.","pos":[4192,4298],"source":"The string returned by [GetDefaultSQL](../../mfc/reference/crecordset-class.md#crecordset__getdefaultsql)."},{"content":"By default, this is the name of the table you specified for the recordset in the wizard, but you can change what the function returns.","pos":[4299,4433]},{"content":"The framework calls <ph id=\"ph1\">`GetDefaultSQL`</ph> — if the string does not begin with \"SELECT\" or \"{CALL\", it is assumed to be a table name, which is used to construct a SQL string.","pos":[4434,4601],"source":" The framework calls `GetDefaultSQL` — if the string does not begin with \"SELECT\" or \"{CALL\", it is assumed to be a table name, which is used to construct a SQL string."},{"content":"The field data members of the recordset, which are to be bound to specific columns of the table.","pos":[4612,4708]},{"content":"The framework binds record columns to the addresses of these members, using them as buffers.","pos":[4709,4801]},{"content":"The framework determines the correlation of field data members to table columns from the <bpt id=\"p1\">[</bpt>RFX<ept id=\"p1\">](../../data/odbc/record-field-exchange-using-rfx.md)</ept> or Bulk RFX function calls in the recordset's <bpt id=\"p2\">[</bpt>DoFieldExchange<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange)</ept> or <bpt id=\"p3\">[</bpt>DoBulkFieldExchange<ept id=\"p3\">](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange)</ept> member function.","pos":[4802,5192],"source":" The framework determines the correlation of field data members to table columns from the [RFX](../../data/odbc/record-field-exchange-using-rfx.md) or Bulk RFX function calls in the recordset's [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) or [DoBulkFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) member function."},{"content":"The <bpt id=\"p1\">[</bpt>filter<ept id=\"p1\">](../../data/odbc/recordset-filtering-records-odbc.md)</ept> for the recordset, if any, contained in the <bpt id=\"p2\">[</bpt>m_strFilter<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__m_strfilter)</ept> data member.","pos":[5202,5403],"source":"The [filter](../../data/odbc/recordset-filtering-records-odbc.md) for the recordset, if any, contained in the [m_strFilter](../../mfc/reference/crecordset-class.md#crecordset__m_strfilter) data member."},{"content":"The framework uses this string to construct a SQL <bpt id=\"p1\">**</bpt>WHERE<ept id=\"p1\">**</ept> clause.","pos":[5404,5471],"source":" The framework uses this string to construct a SQL **WHERE** clause."},{"content":"The <bpt id=\"p1\">[</bpt>sort<ept id=\"p1\">](../../data/odbc/recordset-sorting-records-odbc.md)</ept> order for the recordset, if any, contained in the <bpt id=\"p2\">[</bpt>m_strSort<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__m_strsort)</ept> data member.","pos":[5481,5680],"source":"The [sort](../../data/odbc/recordset-sorting-records-odbc.md) order for the recordset, if any, contained in the [m_strSort](../../mfc/reference/crecordset-class.md#crecordset__m_strsort) data member."},{"content":"The framework uses this string to construct a SQL <bpt id=\"p1\">**</bpt>ORDER BY<ept id=\"p1\">**</ept> clause.","pos":[5681,5751],"source":" The framework uses this string to construct a SQL **ORDER BY** clause."},{"pos":[5764,5903],"content":"[!TIP]\n To use the SQL **GROUP BY** clause (and possibly the **HAVING** clause), append the clauses to the end of your filter string.","leadings":["","    > "],"nodes":[{"content":"To use the SQL <bpt id=\"p1\">**</bpt>GROUP BY<ept id=\"p1\">**</ept> clause (and possibly the <bpt id=\"p2\">**</bpt>HAVING<ept id=\"p2\">**</ept> clause), append the clauses to the end of your filter string.","pos":[8,133],"source":" To use the SQL **GROUP BY** clause (and possibly the **HAVING** clause), append the clauses to the end of your filter string."}]},{"content":"The values of any <bpt id=\"p1\">[</bpt>parameter data members<ept id=\"p1\">](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)</ept> you specify for the class.","pos":[5913,6044],"source":"The values of any [parameter data members](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) you specify for the class."},{"content":"You set parameter values just before you call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Requery<ept id=\"p2\">**</ept>.","pos":[6045,6115],"source":" You set parameter values just before you call **Open** or **Requery**."},{"content":"The framework binds the parameter values to \"?\" placeholders in the SQL string.","pos":[6116,6195]},{"content":"At compile time, you specify the string with placeholders.","pos":[6196,6254]},{"content":"At run time, the framework fills in the details based on the parameter values you pass.","pos":[6255,6342]},{"content":"<bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> constructs a SQL <bpt id=\"p2\">**</bpt>SELECT<ept id=\"p2\">**</ept> statement from these ingredients.","pos":[6349,6419],"source":"**Open** constructs a SQL **SELECT** statement from these ingredients."},{"content":"See <bpt id=\"p1\">[</bpt>Customizing the Selection<ept id=\"p1\">](#_core_customizing_the_selection)</ept> for details about how the framework uses the ingredients.","pos":[6420,6543],"source":" See [Customizing the Selection](#_core_customizing_the_selection) for details about how the framework uses the ingredients."},{"content":"After constructing the statement, <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> sends the SQL to the ODBC Driver Manager (and the ODBC Cursor Library if it is in memory), which sends it on to the ODBC driver for the specific DBMS.","pos":[6550,6743],"source":"After constructing the statement, **Open** sends the SQL to the ODBC Driver Manager (and the ODBC Cursor Library if it is in memory), which sends it on to the ODBC driver for the specific DBMS."},{"content":"The driver communicates with the DBMS to carry out the selection on the data source and fetches the first record.","pos":[6744,6857]},{"content":"The framework loads the record into the field data members of the recordset.","pos":[6858,6934]},{"content":"You can use a combination of these techniques to open <bpt id=\"p1\">[</bpt>tables<ept id=\"p1\">](../../data/odbc/recordset-declaring-a-class-for-a-table-odbc.md)</ept> and to construct a query based on a <bpt id=\"p2\">[</bpt>join<ept id=\"p2\">](../../data/odbc/recordset-performing-a-join-odbc.md)</ept> of multiple tables.","pos":[6941,7184],"source":"You can use a combination of these techniques to open [tables](../../data/odbc/recordset-declaring-a-class-for-a-table-odbc.md) and to construct a query based on a [join](../../data/odbc/recordset-performing-a-join-odbc.md) of multiple tables."},{"content":"With additional customization, you can call <bpt id=\"p1\">[</bpt>predefined queries<ept id=\"p1\">](../../data/odbc/recordset-declaring-a-class-for-a-predefined-query-odbc.md)</ept> (stored procedures), select table columns not known at design time and <bpt id=\"p2\">[</bpt>bind<ept id=\"p2\">](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)</ept> them to recordset fields or you can perform most other data-access tasks.","pos":[7185,7545],"source":" With additional customization, you can call [predefined queries](../../data/odbc/recordset-declaring-a-class-for-a-predefined-query-odbc.md) (stored procedures), select table columns not known at design time and [bind](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md) them to recordset fields or you can perform most other data-access tasks."},{"content":"Tasks you cannot accomplish by customizing recordsets can still be accomplished by <bpt id=\"p1\">[</bpt>calling ODBC API functions<ept id=\"p1\">](../../data/odbc/odbc-calling-odbc-api-functions-directly.md)</ept> or directly executing SQL statements with <bpt id=\"p2\">[</bpt>CDatabase::ExecuteSQL<ept id=\"p2\">](../../mfc/reference/cdatabase-class.md#cdatabase__executesql)</ept>.","pos":[7546,7847],"source":" Tasks you cannot accomplish by customizing recordsets can still be accomplished by [calling ODBC API functions](../../data/odbc/odbc-calling-odbc-api-functions-directly.md) or directly executing SQL statements with [CDatabase::ExecuteSQL](../../mfc/reference/cdatabase-class.md#cdatabase__executesql)."},{"pos":[7904,7929],"content":"Customizing the Selection"},{"content":"Besides supplying a filter, a sort order, or parameters, you can take the following actions to customize your recordset's selection:","pos":[7933,8065]},{"content":"Pass a custom SQL string in <bpt id=\"p1\">**</bpt>lpszSQL<ept id=\"p1\">**</ept> when you call <bpt id=\"p2\">[</bpt>Open<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__open)</ept> for the recordset.","pos":[8075,8212],"source":"Pass a custom SQL string in **lpszSQL** when you call [Open](../../mfc/reference/crecordset-class.md#crecordset__open) for the recordset."},{"content":"Anything you pass in <bpt id=\"p1\">**</bpt>lpsqSQL<ept id=\"p1\">**</ept> takes precedence over what the <bpt id=\"p2\">[</bpt>GetDefaultSQL<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__getdefaultsql)</ept> member function returns.","pos":[8213,8384],"source":" Anything you pass in **lpsqSQL** takes precedence over what the [GetDefaultSQL](../../mfc/reference/crecordset-class.md#crecordset__getdefaultsql) member function returns."},{"pos":[8395,8681],"content":"For more information, see <bpt id=\"p1\">[</bpt>SQL: Customizing Your Recordset's SQL Statement (ODBC)<ept id=\"p1\">](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)</ept>, which describes the types of SQL statements (or partial statements) you can pass to <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> and what the framework does with them.","source":"For more information, see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md), which describes the types of SQL statements (or partial statements) you can pass to **Open** and what the framework does with them."},{"pos":[8693,8861],"content":"[!NOTE]\n If the custom string you pass does not begin with \"SELECT\" or \"{CALL\", MFC assumes it contains a table name. This also applies to the next bulleted item.","leadings":["","    > "],"nodes":[{"content":" If the custom string you pass does not begin with \"SELECT\" or \"{CALL\", MFC assumes it contains a table name. This also applies to the next bulleted item.","pos":[8,162],"nodes":[{"content":"If the custom string you pass does not begin with \"SELECT\" or \"{CALL\", MFC assumes it contains a table name.","pos":[1,109]},{"content":"This also applies to the next bulleted item.","pos":[110,154]}]}]},{"content":"Alter the string that the wizard writes in your recordset's <ph id=\"ph1\">`GetDefaultSQL`</ph> member function.","pos":[8871,8963],"source":"Alter the string that the wizard writes in your recordset's `GetDefaultSQL` member function."},{"content":"Edit the function's code to change what it returns.","pos":[8964,9015]},{"content":"By default, the wizard writes a <ph id=\"ph1\">`GetDefaultSQL`</ph> function that returns a single table name.","pos":[9016,9106],"source":" By default, the wizard writes a `GetDefaultSQL` function that returns a single table name."},{"content":"You can have <ph id=\"ph1\">`GetDefaultSQL`</ph> return any of the items that you can pass in the <bpt id=\"p1\">**</bpt>lpszSQL<ept id=\"p1\">**</ept> parameter to <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","pos":[9117,9229],"source":"You can have `GetDefaultSQL` return any of the items that you can pass in the **lpszSQL** parameter to **Open**."},{"content":"If you do not pass a custom SQL string in <bpt id=\"p1\">**</bpt>lpszSQL<ept id=\"p1\">**</ept>, the framework uses the string that <ph id=\"ph1\">`GetDefaultSQL`</ph> returns.","pos":[9230,9344],"source":" If you do not pass a custom SQL string in **lpszSQL**, the framework uses the string that `GetDefaultSQL` returns."},{"content":"At a minimum, <ph id=\"ph1\">`GetDefaultSQL`</ph> must return a single table name.","pos":[9345,9407],"source":" At a minimum, `GetDefaultSQL` must return a single table name."},{"content":"But you can have it return multiple table names, a full <bpt id=\"p1\">**</bpt>SELECT<ept id=\"p1\">**</ept> statement, an ODBC <bpt id=\"p2\">**</bpt>CALL<ept id=\"p2\">**</ept> statement, and so on.","pos":[9408,9524],"source":" But you can have it return multiple table names, a full **SELECT** statement, an ODBC **CALL** statement, and so on."},{"content":"For a list of what you can pass to <bpt id=\"p1\">**</bpt>lpszSQL<ept id=\"p1\">**</ept> — or have <ph id=\"ph1\">`GetDefaultSQL`</ph> return — see <bpt id=\"p2\">[</bpt>SQL: Customizing Your Recordset's SQL Statement (ODBC)<ept id=\"p2\">](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)</ept>.","pos":[9525,9739],"source":" For a list of what you can pass to **lpszSQL** — or have `GetDefaultSQL` return — see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)."},{"content":"If you are performing a join of two or more tables, rewrite <ph id=\"ph1\">`GetDefaultSQL`</ph> to customize the table list used in the SQL <bpt id=\"p1\">**</bpt>FROM<ept id=\"p1\">**</ept> clause.","pos":[9750,9886],"source":"If you are performing a join of two or more tables, rewrite `GetDefaultSQL` to customize the table list used in the SQL **FROM** clause."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Recordset: Performing a Join (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-performing-a-join-odbc.md)</ept>.","pos":[9887,10004],"source":" For more information, see [Recordset: Performing a Join (ODBC)](../../data/odbc/recordset-performing-a-join-odbc.md)."},{"content":"Manually bind additional field data members, perhaps based on information you obtain about the schema of your data source at run time.","pos":[10015,10149]},{"content":"You add field data members to the recordset class, <bpt id=\"p1\">[</bpt>RFX<ept id=\"p1\">](../../data/odbc/record-field-exchange-using-rfx.md)</ept> or Bulk RFX function calls for them to the <bpt id=\"p2\">[</bpt>DoFieldExchange<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange)</ept> or <bpt id=\"p3\">[</bpt>DoBulkFieldExchange<ept id=\"p3\">](../../mfc/reference/crecordset-class.md#crecordset__dobulkfieldexchange)</ept> member function, and initializations of the data members in the class constructor.","pos":[10150,10569],"source":" You add field data members to the recordset class, [RFX](../../data/odbc/record-field-exchange-using-rfx.md) or Bulk RFX function calls for them to the [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) or [DoBulkFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dobulkfieldexchange) member function, and initializations of the data members in the class constructor."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Recordset: Dynamically Binding Data Columns (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)</ept>.","pos":[10570,10717],"source":" For more information, see [Recordset: Dynamically Binding Data Columns (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)."},{"pos":[10727,10848],"content":"Override recordset member functions, such as <ph id=\"ph1\">`OnSetOptions`</ph>, to set application-specific options or to override defaults.","source":"Override recordset member functions, such as `OnSetOptions`, to set application-specific options or to override defaults."},{"content":"If you want to base the recordset on a complex SQL statement, you need to use some combination of these customization techniques.","pos":[10855,10984]},{"content":"For example, perhaps you want to use SQL clauses and keywords not directly supported by recordsets or perhaps you are joining multiple tables.","pos":[10985,11127]},{"content":"See Also","pos":[11136,11144]},{"content":"Recordset (ODBC)","pos":[11149,11165]},{"content":"Recordset: How Recordsets Update Records (ODBC)","pos":[11207,11254]},{"content":"ODBC Basics","pos":[11326,11337]},{"content":"SQL","pos":[11376,11379]},{"content":"Recordset: Locking Records (ODBC)","pos":[11410,11443]}],"content":"---\ntitle: \"Recordset: How Recordsets Select Records (ODBC) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"recordsets, selecting records\"\n  - \"record selection, ODBC recordsets\"\n  - \"SQL statements, recordset\"\n  - \"records, selecting\"\n  - \"recordsets, constructing SQL statements\"\n  - \"ODBC recordsets, selecting records\"\nms.assetid: 343a6a91-aa4c-4ef7-b21f-2f2bfd0d3787\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Recordset: How Recordsets Select Records (ODBC)\nThis topic applies to the MFC ODBC classes.  \n  \n This topic explains:  \n  \n-   [Your role and your options in selecting records](#_core_your_options_in_selecting_records).  \n  \n-   [How a recordset constructs its SQL statement and selects records](#_core_how_a_recordset_constructs_its_sql_statement).  \n  \n-   [What you can do to customize the selection](#_core_customizing_the_selection).  \n  \n Recordsets select records from a data source through an ODBC driver by sending SQL statements to the driver. The SQL sent depends on how you design and open your recordset class.  \n  \n##  <a name=\"_core_your_options_in_selecting_records\"></a> Your Options in Selecting Records  \n The following table shows your options in selecting records.  \n  \n### How and When You Can Affect a Recordset  \n  \n|When you|You can|  \n|--------------|-------------|  \n|Declare your recordset class with the **Add Class** wizard|Specify which table to select from.<br /><br /> Specify which columns to include.<br /><br /> See [Adding an MFC ODBC Consumer](../../mfc/reference/adding-an-mfc-odbc-consumer.md).|  \n|Complete your recordset class implementation|Override member functions such as `OnSetOptions` (advanced) to set application-specific options or to change defaults. Specify parameter data members if you want a parameterized recordset.|  \n|Construct a recordset object (before you call **Open**)|Specify a search condition (possibly compound) for use in a **WHERE** clause that filters the records. See [Recordset: Filtering Records (ODBC)](../../data/odbc/recordset-filtering-records-odbc.md).<br /><br /> Specify a sort order for use in an **ORDER BY** clause that sorts the records. See [Recordset: Sorting Records (ODBC)](../../data/odbc/recordset-sorting-records-odbc.md).<br /><br /> Specify parameter values for any parameters you added to the class. See [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).|  \n\n|Run the recordset's query by calling **Open**|Specify a custom SQL string to replace the default SQL string set up by the wizard. See [CRecordset::Open](../../mfc/reference/crecordset-class.md#crecordset__open) in the *Class Library Reference* and [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).|  \n\n|Call **Requery** to requery the recordset with the latest values on the data source|Specify new parameters, filter, or sort. See [Recordset: Requerying a Recordset (ODBC)](../../data/odbc/recordset-requerying-a-recordset-odbc.md).|  \n  \n##  <a name=\"_core_how_a_recordset_constructs_its_sql_statement\"></a> How a Recordset Constructs Its SQL Statement  \n When you call a recordset object's [Open](../../mfc/reference/crecordset-class.md#crecordset__open) member function, **Open** constructs a SQL statement using some or all of the following ingredients:  \n  \n-   The **lpszSQL** parameter passed to **Open**. If not **NULL**, this parameter specifies a custom SQL string or part of one. The framework parses the string. If the string is a SQL **SELECT** statement or an ODBC **CALL** statement, the framework uses the string as the recordset's SQL statement. If the string does not begin with \"SELECT\" or \"{CALL\", the framework uses what is supplied to construct a SQL **FROM** clause.  \n  \n-   The string returned by [GetDefaultSQL](../../mfc/reference/crecordset-class.md#crecordset__getdefaultsql). By default, this is the name of the table you specified for the recordset in the wizard, but you can change what the function returns. The framework calls `GetDefaultSQL` — if the string does not begin with \"SELECT\" or \"{CALL\", it is assumed to be a table name, which is used to construct a SQL string.  \n  \n\n-   The field data members of the recordset, which are to be bound to specific columns of the table. The framework binds record columns to the addresses of these members, using them as buffers. The framework determines the correlation of field data members to table columns from the [RFX](../../data/odbc/record-field-exchange-using-rfx.md) or Bulk RFX function calls in the recordset's [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) or [DoBulkFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) member function.  \n  \n-   The [filter](../../data/odbc/recordset-filtering-records-odbc.md) for the recordset, if any, contained in the [m_strFilter](../../mfc/reference/crecordset-class.md#crecordset__m_strfilter) data member. The framework uses this string to construct a SQL **WHERE** clause.  \n  \n-   The [sort](../../data/odbc/recordset-sorting-records-odbc.md) order for the recordset, if any, contained in the [m_strSort](../../mfc/reference/crecordset-class.md#crecordset__m_strsort) data member. The framework uses this string to construct a SQL **ORDER BY** clause.  \n\n  \n    > [!TIP]\n    >  To use the SQL **GROUP BY** clause (and possibly the **HAVING** clause), append the clauses to the end of your filter string.  \n  \n-   The values of any [parameter data members](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) you specify for the class. You set parameter values just before you call **Open** or **Requery**. The framework binds the parameter values to \"?\" placeholders in the SQL string. At compile time, you specify the string with placeholders. At run time, the framework fills in the details based on the parameter values you pass.  \n  \n **Open** constructs a SQL **SELECT** statement from these ingredients. See [Customizing the Selection](#_core_customizing_the_selection) for details about how the framework uses the ingredients.  \n  \n After constructing the statement, **Open** sends the SQL to the ODBC Driver Manager (and the ODBC Cursor Library if it is in memory), which sends it on to the ODBC driver for the specific DBMS. The driver communicates with the DBMS to carry out the selection on the data source and fetches the first record. The framework loads the record into the field data members of the recordset.  \n  \n You can use a combination of these techniques to open [tables](../../data/odbc/recordset-declaring-a-class-for-a-table-odbc.md) and to construct a query based on a [join](../../data/odbc/recordset-performing-a-join-odbc.md) of multiple tables. With additional customization, you can call [predefined queries](../../data/odbc/recordset-declaring-a-class-for-a-predefined-query-odbc.md) (stored procedures), select table columns not known at design time and [bind](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md) them to recordset fields or you can perform most other data-access tasks. Tasks you cannot accomplish by customizing recordsets can still be accomplished by [calling ODBC API functions](../../data/odbc/odbc-calling-odbc-api-functions-directly.md) or directly executing SQL statements with [CDatabase::ExecuteSQL](../../mfc/reference/cdatabase-class.md#cdatabase__executesql).  \n  \n##  <a name=\"_core_customizing_the_selection\"></a> Customizing the Selection  \n Besides supplying a filter, a sort order, or parameters, you can take the following actions to customize your recordset's selection:  \n  \n-   Pass a custom SQL string in **lpszSQL** when you call [Open](../../mfc/reference/crecordset-class.md#crecordset__open) for the recordset. Anything you pass in **lpsqSQL** takes precedence over what the [GetDefaultSQL](../../mfc/reference/crecordset-class.md#crecordset__getdefaultsql) member function returns.  \n  \n     For more information, see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md), which describes the types of SQL statements (or partial statements) you can pass to **Open** and what the framework does with them.  \n  \n    > [!NOTE]\n    >  If the custom string you pass does not begin with \"SELECT\" or \"{CALL\", MFC assumes it contains a table name. This also applies to the next bulleted item.  \n  \n-   Alter the string that the wizard writes in your recordset's `GetDefaultSQL` member function. Edit the function's code to change what it returns. By default, the wizard writes a `GetDefaultSQL` function that returns a single table name.  \n  \n     You can have `GetDefaultSQL` return any of the items that you can pass in the **lpszSQL** parameter to **Open**. If you do not pass a custom SQL string in **lpszSQL**, the framework uses the string that `GetDefaultSQL` returns. At a minimum, `GetDefaultSQL` must return a single table name. But you can have it return multiple table names, a full **SELECT** statement, an ODBC **CALL** statement, and so on. For a list of what you can pass to **lpszSQL** — or have `GetDefaultSQL` return — see [SQL: Customizing Your Recordset's SQL Statement (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).  \n  \n     If you are performing a join of two or more tables, rewrite `GetDefaultSQL` to customize the table list used in the SQL **FROM** clause. For more information, see [Recordset: Performing a Join (ODBC)](../../data/odbc/recordset-performing-a-join-odbc.md).  \n  \n\n-   Manually bind additional field data members, perhaps based on information you obtain about the schema of your data source at run time. You add field data members to the recordset class, [RFX](../../data/odbc/record-field-exchange-using-rfx.md) or Bulk RFX function calls for them to the [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) or [DoBulkFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dobulkfieldexchange) member function, and initializations of the data members in the class constructor. For more information, see [Recordset: Dynamically Binding Data Columns (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md).  \n  \n-   Override recordset member functions, such as `OnSetOptions`, to set application-specific options or to override defaults.  \n  \n If you want to base the recordset on a complex SQL statement, you need to use some combination of these customization techniques. For example, perhaps you want to use SQL clauses and keywords not directly supported by recordsets or perhaps you are joining multiple tables.  \n  \n## See Also  \n [Recordset (ODBC)](../../data/odbc/recordset-odbc.md)   \n [Recordset: How Recordsets Update Records (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)   \n [ODBC Basics](../../data/odbc/odbc-basics.md)   \n [SQL](../../data/odbc/sql.md)   \n [Recordset: Locking Records (ODBC)](../../data/odbc/recordset-locking-records-odbc.md)"}