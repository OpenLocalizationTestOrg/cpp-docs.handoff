{"nodes":[{"pos":[12,52],"content":"CMFCRibbonGallery Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCRibbonGallery Class | Microsoft Docs","pos":[0,40]}]},{"content":"CMFCRibbonGallery Class","pos":[625,648]},{"content":"Implements Office 2007-style ribbon galleries.","pos":[649,695]},{"content":"Syntax","pos":[704,710]},{"content":"Members","pos":[786,793]},{"content":"Public Constructors","pos":[803,822]},{"content":"Name","pos":[829,833]},{"content":"Description","pos":[834,845]},{"content":"CMFCRibbonGallery::CMFCRibbonGallery","pos":[884,920]},{"pos":[961,1017],"content":"Constructs and initializes a <ph id=\"ph1\">`CMFCRibbonGallery`</ph> object.","source":"Constructs and initializes a `CMFCRibbonGallery` object."},{"content":"Public Methods","pos":[1028,1042]},{"content":"Name","pos":[1049,1053]},{"content":"Description","pos":[1054,1065]},{"content":"CMFCRibbonGallery::AddGroup","pos":[1104,1131]},{"content":"Adds a new group to the gallery.","pos":[1163,1195]},{"content":"CMFCRibbonGallery::AddSubItem","pos":[1201,1230]},{"content":"Adds a new menu item to the drop-down menu.","pos":[1264,1307]},{"content":"CMFCRibbonGallery::Clear","pos":[1313,1337]},{"content":"Clears the content of the gallery.","pos":[1366,1400]},{"content":"CMFCRibbonGallery::EnableMenuResize","pos":[1406,1441]},{"content":"Enables or disables resizing of the menu panel.","pos":[1481,1528]},{"content":"CMFCRibbonGallery::EnableMenuSideBar","pos":[1534,1570]},{"content":"Enables or disables the side bar to the left of the popup menu.","pos":[1611,1674]},{"content":"CMFCRibbonGallery::GetCompactSize","pos":[1680,1713]},{"pos":[1751,1878],"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCRibbonButton::GetCompactSize<ept id=\"p1\">](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__getcompactsize)</ept>.)","source":"(Overrides [CMFCRibbonButton::GetCompactSize](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__getcompactsize).)"},{"content":"CMFCRibbonGallery::GetDroppedDown","pos":[1884,1917]},{"pos":[1955,2097],"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCRibbonBaseElement::GetDroppedDown<ept id=\"p1\">](../../mfc/reference/cmfcribbonbaseelement-class.md#cmfcribbonbaseelement__getdroppeddown)</ept>.)","source":"(Overrides [CMFCRibbonBaseElement::GetDroppedDown](../../mfc/reference/cmfcribbonbaseelement-class.md#cmfcribbonbaseelement__getdroppeddown).)"},{"content":"CMFCRibbonGallery::GetGroupName","pos":[2103,2134]},{"content":"Returns the name of the group that is located at the specified index.","pos":[2170,2239]},{"content":"CMFCRibbonGallery::GetGroupOffset","pos":[2245,2278]},{"content":"CMFCRibbonGallery::GetIconsInRow","pos":[2322,2354]},{"content":"Returns the number of items in a row of the ribbon gallery.","pos":[2391,2450]},{"content":"CMFCRibbonGallery::GetItemToolTip","pos":[2456,2489]},{"content":"Returns the tooltip text that is associated with an item in the gallery.","pos":[2527,2599]},{"content":"CMFCRibbonGallery::GetLastSelectedItem","pos":[2605,2643]},{"content":"Returns the index of the last item in the gallery that the user selected.","pos":[2686,2759]},{"content":"CMFCRibbonGallery::GetPaletteID","pos":[2765,2796]},{"content":"Returns the command ID of the current gallery.","pos":[2832,2878]},{"content":"CMFCRibbonGallery::GetRegularSize","pos":[2884,2917]},{"pos":[2955,3082],"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCRibbonButton::GetRegularSize<ept id=\"p1\">](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__getregularsize)</ept>.)","source":"(Overrides [CMFCRibbonButton::GetRegularSize](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__getregularsize).)"},{"content":"CMFCRibbonGallery::GetSelectedItem","pos":[3088,3122]},{"content":"CMFCRibbonGallery::HasMenu","pos":[3167,3193]},{"pos":[3224,3337],"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCRibbonButton::HasMenu<ept id=\"p1\">](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__hasmenu)</ept>.)","source":"(Overrides [CMFCRibbonButton::HasMenu](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__hasmenu).)"},{"content":"CMFCRibbonGallery::IsButtonMode","pos":[3343,3374]},{"content":"Specifies whether the gallery is contained in a gallery button.","pos":[3410,3473]},{"content":"CMFCRibbonGallery::IsMenuResizeEnabled","pos":[3479,3517]},{"content":"Specifies whether menu resizing is enabled or disabled.","pos":[3560,3615]},{"content":"CMFCRibbonGallery::IsMenuResizeVertical","pos":[3621,3660]},{"content":"CMFCRibbonGallery::IsMenuSideBar","pos":[3710,3742]},{"content":"Specifies whether the side bar is enabled or disabled.","pos":[3779,3833]},{"content":"CMFCRibbonGallery::OnAfterChangeRect","pos":[3839,3875]},{"pos":[3916,3966],"content":"(Overrides <ph id=\"ph1\">`CMFCRibbonButton::OnAfterChangeRect`</ph>.)","source":"(Overrides `CMFCRibbonButton::OnAfterChangeRect`.)"},{"content":"CMFCRibbonGallery::OnDraw","pos":[3972,3997]},{"pos":[4027,4138],"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCRibbonButton::OnDraw<ept id=\"p1\">](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__ondraw)</ept>.)","source":"(Overrides [CMFCRibbonButton::OnDraw](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__ondraw).)"},{"content":"CMFCRibbonGallery::OnEnable","pos":[4144,4171]},{"pos":[4203,4249],"content":"(Overrides <ph id=\"ph1\">`CMFCRibbonBaseElement::OnEnable`</ph>.)","source":"(Overrides `CMFCRibbonBaseElement::OnEnable`.)"},{"content":"CMFCRibbonGallery::OnRTLChanged","pos":[4255,4286]},{"pos":[4322,4460],"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCRibbonBaseElement::OnRTLChanged<ept id=\"p1\">](../../mfc/reference/cmfcribbonbaseelement-class.md#cmfcribbonbaseelement__onrtlchanged)</ept>.)","source":"(Overrides [CMFCRibbonBaseElement::OnRTLChanged](../../mfc/reference/cmfcribbonbaseelement-class.md#cmfcribbonbaseelement__onrtlchanged).)"},{"content":"CMFCRibbonGallery::RedrawIcons","pos":[4466,4496]},{"content":"Redraws the gallery.","pos":[4531,4551]},{"content":"CMFCRibbonGallery::RemoveItemToolTips","pos":[4557,4594]},{"content":"Removes the tooltips from all items in the gallery.","pos":[4636,4687]},{"content":"CMFCRibbonGallery::SelectItem","pos":[4693,4722]},{"content":"CMFCRibbonGallery::SetACCData","pos":[4762,4791]},{"pos":[4825,4944],"content":"(Overrides <bpt id=\"p1\">[</bpt>CMFCRibbonButton::SetACCData<ept id=\"p1\">](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__setaccdata)</ept>.)","source":"(Overrides [CMFCRibbonButton::SetACCData](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__setaccdata).)"},{"content":"CMFCRibbonGallery::SetButtonMode","pos":[4950,4982]},{"content":"Specifies whether to display the ribbon gallery as a drop-down button or as a palette directly on the ribbon.","pos":[5019,5128]},{"content":"CMFCRibbonGallery::SetGroupName","pos":[5134,5165]},{"content":"Sets the name of a group.","pos":[5201,5226]},{"content":"CMFCRibbonGallery::SetIconsInRow","pos":[5232,5264]},{"content":"Defines the number of items per row in the gallery.","pos":[5301,5352]},{"content":"CMFCRibbonGallery::SetItemToolTip","pos":[5358,5391]},{"content":"Sets the tooltip text for an item in the gallery.","pos":[5429,5478]},{"content":"CMFCRibbonGallery::SetPalette","pos":[5484,5513]},{"content":"Attaches a palette to a ribbon gallery.","pos":[5547,5586]},{"content":"CMFCRibbonGallery::SetPaletteID","pos":[5592,5623]},{"pos":[5659,5761],"content":"Defines the command ID that is sent in the <ph id=\"ph1\">`WM_COMMAND`</ph> message when a gallery item has been selected.","source":"Defines the command ID that is sent in the `WM_COMMAND` message when a gallery item has been selected."},{"content":"Protected Methods","pos":[5772,5789]},{"content":"Name","pos":[5796,5800]},{"content":"Description","pos":[5801,5812]},{"content":"CMFCRibbonGallery::OnDrawPaletteIcon","pos":[5851,5887]},{"content":"Called by the framework when a gallery icon is drawn.","pos":[5928,5981]},{"content":"Remarks","pos":[5991,5998]},{"content":"A gallery button behaves just like a regular menu button except that it displays a gallery when a user opens it.","pos":[6002,6114]},{"content":"When you select an item in a gallery, the framework sends the <ph id=\"ph1\">`WM_COMMAND`</ph> message together with command ID of the button.","pos":[6115,6237],"source":" When you select an item in a gallery, the framework sends the `WM_COMMAND` message together with command ID of the button."},{"content":"When you handle the message, you should call <bpt id=\"p1\">[</bpt>CMFCRibbonGallery::GetLastSelectedItem<ept id=\"p1\">](#cmfcribbongallery__getlastselecteditem)</ept> to determine which item was selected from the gallery.","pos":[6238,6419],"source":" When you handle the message, you should call [CMFCRibbonGallery::GetLastSelectedItem](#cmfcribbongallery__getlastselecteditem) to determine which item was selected from the gallery."},{"content":"Example","pos":[6428,6435]},{"content":"The following example demonstrates how to use various methods in the <ph id=\"ph1\">`CMFCRibbonGallery`</ph> class to configure a <ph id=\"ph2\">`CMFCRibbonGallery`</ph> object.","pos":[6439,6576],"source":"The following example demonstrates how to use various methods in the `CMFCRibbonGallery` class to configure a `CMFCRibbonGallery` object."},{"content":"The example illustrates how to specify the number of items per row in the gallery, enable resizing of the menu panel, enable the side bar to the left of the pop-up menu, and display the ribbon gallery as a palette directly on the ribbon bar.","pos":[6577,6818]},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>Draw Client sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[6819,6902],"source":" This code snippet is part of the [Draw Client sample](../../visual-cpp-samples.md)."},{"pos":[6920,6940],"content":"NVC_MFC_DrawClient#6"},{"content":"Inheritance Hierarchy","pos":[7018,7039]},{"pos":[7043,7232],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept> <bpt id=\"p2\">[</bpt>CMFCRibbonBaseElement<ept id=\"p2\">](../../mfc/reference/cmfcribbonbaseelement-class.md)</ept> <bpt id=\"p3\">[</bpt>CMFCRibbonButton<ept id=\"p3\">](../../mfc/reference/cmfcribbonbutton-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md) [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md) [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)"},{"content":"CMFCRibbonGallery","pos":[7240,7257]},{"content":"Requirements","pos":[7315,7327]},{"pos":[7331,7368],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxRibbonPaletteGallery.h","source":"**Header:** afxRibbonPaletteGallery.h"},{"pos":[7422,7449],"content":"CMFCRibbonGallery::AddGroup"},{"content":"Adds a new group to the gallery.","pos":[7453,7485]},{"content":"Parameters","pos":[7763,7773]},{"content":"[in]","pos":[7777,7781]},{"content":"Specifies the name of the group.","pos":[7801,7833]},{"content":"[in]","pos":[7840,7844]},{"content":"Specifies the resource ID of the image list that contains the images for the group.","pos":[7871,7954]},{"content":"[in]","pos":[7961,7965]},{"content":"Specifies the width in pixels of an image.","pos":[7986,8028]},{"content":"[in]","pos":[8035,8039]},{"content":"A reference to image list that contains group images.","pos":[8057,8110]},{"content":"[in]","pos":[8117,8121]},{"content":"Specifies the number of icons in the group.","pos":[8137,8180]},{"content":"This parameter should be specified only for custom (owner drawn) groups.","pos":[8181,8253]},{"content":"Remarks","pos":[8263,8270]},{"content":"You can divide the items on a ribbon gallery into multiple groups by calling this method.","pos":[8274,8363]},{"content":"Each group can have a caption.","pos":[8364,8394]},{"pos":[8450,8479],"content":"CMFCRibbonGallery::AddSubItem"},{"content":"Adds a new menu item to the drop-down menu.","pos":[8483,8526]},{"content":"Parameters","pos":[8652,8662]},{"content":"[in]","pos":[8666,8670]},{"content":"A pointer to the item to add to the menu.","pos":[8685,8726]},{"content":"[in]","pos":[8733,8737]},{"content":"Specifies the zero-based index of a location where to insert the item.","pos":[8750,8820]},{"content":"[in]","pos":[8827,8831]},{"content":"to specify that the item should be inserted before the ribbon gallery; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","pos":[8851,8941],"source":" to specify that the item should be inserted before the ribbon gallery; otherwise, `FALSE`."},{"content":"Remarks","pos":[8951,8958]},{"content":"You can combine popup galleries with popup menu items by calling this method.","pos":[8962,9039]},{"content":"Menu items can be placed before or after the gallery.","pos":[9040,9093]},{"content":"To insert the item before the gallery, set <ph id=\"ph1\">`bOnTop`</ph> to <ph id=\"ph2\">`TRUE`</ph>.","pos":[9100,9162],"source":"To insert the item before the gallery, set `bOnTop` to `TRUE`."},{"content":"Set <ph id=\"ph1\">`bOnTop`</ph> to <ph id=\"ph2\">`FALSE`</ph> to insert the item below the gallery.","pos":[9163,9224],"source":" Set `bOnTop` to `FALSE` to insert the item below the gallery."},{"pos":[9232,9594],"content":"[!NOTE]\n The parameter `nIndex` specifies the insertion index both at the top of the gallery and at the bottom of the gallery. For example, if you need to insert an item one position before the gallery, set `nIndex` to 1 and `bOnTop` to `TRUE`. Similarly, if you need to insert an item one position below the gallery, set `nIndex` to 1 and `bOnTop` to `FALSE`.","leadings":["","> "],"nodes":[{"content":" The parameter `nIndex` specifies the insertion index both at the top of the gallery and at the bottom of the gallery. For example, if you need to insert an item one position before the gallery, set `nIndex` to 1 and `bOnTop` to `TRUE`. Similarly, if you need to insert an item one position below the gallery, set `nIndex` to 1 and `bOnTop` to `FALSE`.","pos":[8,360],"nodes":[{"content":"The parameter <ph id=\"ph1\">`nIndex`</ph> specifies the insertion index both at the top of the gallery and at the bottom of the gallery.","pos":[1,118],"source":" The parameter `nIndex` specifies the insertion index both at the top of the gallery and at the bottom of the gallery."},{"content":"For example, if you need to insert an item one position before the gallery, set <ph id=\"ph1\">`nIndex`</ph> to 1 and <ph id=\"ph2\">`bOnTop`</ph> to <ph id=\"ph3\">`TRUE`</ph>.","pos":[119,236],"source":" For example, if you need to insert an item one position before the gallery, set `nIndex` to 1 and `bOnTop` to `TRUE`."},{"content":"Similarly, if you need to insert an item one position below the gallery, set <ph id=\"ph1\">`nIndex`</ph> to 1 and <ph id=\"ph2\">`bOnTop`</ph> to <ph id=\"ph3\">`FALSE`</ph>.","pos":[237,352],"source":" Similarly, if you need to insert an item one position below the gallery, set `nIndex` to 1 and `bOnTop` to `FALSE`."}]}]},{"pos":[9645,9669],"content":"CMFCRibbonGallery::Clear"},{"content":"Clears the content of the gallery.","pos":[9673,9707]},{"content":"Remarks","pos":[9754,9761]},{"content":"Call this method to remove all content from the ribbon gallery.","pos":[9765,9828]},{"content":"This must be done before you attach a new ribbon gallery or set of groups to the ribbon gallery.","pos":[9829,9925]},{"pos":[9988,10024],"content":"CMFCRibbonGallery::CMFCRibbonGallery"},{"pos":[10028,10132],"content":"Constructs and initializes a <bpt id=\"p1\">[</bpt>CMFCRibbonGallery<ept id=\"p1\">](../../mfc/reference/cmfcribbongallery-class.md)</ept> object.","source":"Constructs and initializes a [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md) object."},{"content":"Parameters","pos":[10691,10701]},{"content":"Specifies the command ID of the command to execute when a user clicks the button.","pos":[10714,10795]},{"content":"Specifies the text to appear on the button.","pos":[10816,10859]},{"content":"The zero-based index of the small image to appear on the button.","pos":[10888,10952]},{"content":"The zero-based index of the large image to appear on the button.","pos":[10981,11045]},{"content":"A reference to the <bpt id=\"p1\">[</bpt>CMFCToolBarImages<ept id=\"p1\">](../../mfc/reference/cmfctoolbarimages-class.md)</ept> object that contains the images to appear on the gallery.","pos":[11071,11215],"source":" A reference to the [CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md) object that contains the images to appear on the gallery."},{"content":"The resource ID of the list of images to display on the gallery.","pos":[11248,11312]},{"content":"Specifies the width, in pixels, of the image on the gallery.","pos":[11339,11399]},{"content":"Specifies the size, in pixels, of the gallery image.","pos":[11420,11472]},{"content":"Specifies the number of icons in the gallery.","pos":[11494,11539]},{"content":"Specifies whether to use the default or the owner-drawn button style.","pos":[11571,11640]},{"content":"Remarks","pos":[11650,11657]},{"pos":[11719,11754],"content":"CMFCRibbonGallery::EnableMenuResize"},{"content":"Enables or disables resizing of the menu panel.","pos":[11758,11805]},{"content":"Parameters","pos":[11912,11922]},{"content":"[in]","pos":[11926,11930]},{"content":"to enable resizing the menu; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","pos":[11951,11999],"source":" to enable resizing the menu; otherwise, `FALSE`."},{"content":"[in]","pos":[12006,12010]},{"content":"to specify that the gallery can be resized only vertically; <ph id=\"ph1\">`FALSE`</ph> to specify that the gallery can be resized both vertically and horizontally.","pos":[12036,12180],"source":" to specify that the gallery can be resized only vertically; `FALSE` to specify that the gallery can be resized both vertically and horizontally."},{"content":"Remarks","pos":[12190,12197]},{"content":"Use this method to enable or disable resizing the ribbon gallery.","pos":[12201,12266]},{"content":"When resizing is enabled, the ribbon gallery displays a gripper that a user can use to resize it.","pos":[12267,12364]},{"pos":[12427,12463],"content":"CMFCRibbonGallery::EnableMenuSideBar"},{"content":"Enables or disables the side bar to the left of the popup menu.","pos":[12467,12530]},{"content":"Parameters","pos":[12597,12607]},{"content":"[in]","pos":[12611,12615]},{"content":"to specify that the side bar is enabled; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","pos":[12636,12696],"source":" to specify that the side bar is enabled; otherwise, `FALSE`."},{"content":"Remarks","pos":[12706,12713]},{"content":"Call this method to enable or disable the Office XP-style side bar at the left side of the menu.","pos":[12717,12813]},{"pos":[12873,12906],"content":"CMFCRibbonGallery::GetCompactSize"},{"content":"Parameters","pos":[13074,13084]},{"pos":[13088,13092],"content":"[in]"},{"content":"Return Value","pos":[13108,13120]},{"content":"Remarks","pos":[13130,13137]},{"pos":[13197,13230],"content":"CMFCRibbonGallery::GetDroppedDown"},{"content":"Return Value","pos":[13407,13419]},{"content":"Remarks","pos":[13429,13436]},{"pos":[13494,13525],"content":"CMFCRibbonGallery::GetGroupName"},{"content":"Returns the name of the group that is located at the specified index.","pos":[13529,13598]},{"content":"Parameters","pos":[13671,13681]},{"content":"[in]","pos":[13685,13689]},{"content":"Specifies the zero-based index for the group whose name you want to retrieve.","pos":[13707,13784]},{"content":"Return Value","pos":[13794,13806]},{"content":"The name of the group located at the specified index.","pos":[13810,13863]},{"content":"Passing an invalid index will result in a failed assertion.","pos":[13864,13923]},{"content":"Remarks","pos":[13933,13940]},{"pos":[14000,14033],"content":"CMFCRibbonGallery::GetGroupOffset"},{"content":"Return Value","pos":[14200,14212]},{"content":"Remarks","pos":[14222,14229]},{"pos":[14288,14320],"content":"CMFCRibbonGallery::GetIconsInRow"},{"content":"Returns the number of items in a row of the ribbon gallery.","pos":[14324,14383]},{"content":"Return Value","pos":[14438,14450]},{"content":"The number of items in a row.","pos":[14454,14483]},{"content":"Remarks","pos":[14493,14500]},{"pos":[14560,14593],"content":"CMFCRibbonGallery::GetItemToolTip"},{"content":"Returns the tooltip text that is associated with an item in the gallery.","pos":[14597,14669]},{"content":"Parameters","pos":[14743,14753]},{"content":"[in]","pos":[14757,14761]},{"content":"Specifies the zero-based index of the item for which to retrieve the tooltip text.","pos":[14778,14860]},{"content":"Return Value","pos":[14870,14882]},{"content":"A pointer to the tooltip string assigned to an item in the ribbon gallery.","pos":[14886,14960]},{"content":"It can be <ph id=\"ph1\">`NULL`</ph> if no tooltip is assigned to that item.","pos":[14961,15017],"source":" It can be `NULL` if no tooltip is assigned to that item."},{"content":"Remarks","pos":[15027,15034]},{"pos":[15099,15137],"content":"CMFCRibbonGallery::GetLastSelectedItem"},{"content":"Returns the index of the last item in the ribbon gallery that the user selected.","pos":[15141,15221]},{"content":"Parameters","pos":[15292,15302]},{"content":"[in]","pos":[15306,15310]},{"content":"Specifies the command ID of the menu item that opened the ribbon gallery.","pos":[15324,15397]},{"content":"Return Value","pos":[15407,15419]},{"pos":[15423,15592],"content":"When the user selects any item in the ribbon gallery, the library sends the <ph id=\"ph1\">`WM_COMMAND`</ph> message along with Command ID of the menu button that opened the ribbon gallery.","source":"When the user selects any item in the ribbon gallery, the library sends the `WM_COMMAND` message along with Command ID of the menu button that opened the ribbon gallery."},{"content":"Remarks","pos":[15602,15609]},{"pos":[15667,15698],"content":"CMFCRibbonGallery::GetPaletteID"},{"content":"Returns the command ID of the current palette.","pos":[15702,15748]},{"content":"Return Value","pos":[15802,15814]},{"content":"The command ID of the currently selected palette.","pos":[15818,15867]},{"content":"Remarks","pos":[15877,15884]},{"pos":[15944,15977],"content":"CMFCRibbonGallery::GetRegularSize"},{"content":"Parameters","pos":[16145,16155]},{"pos":[16159,16163],"content":"[in]"},{"content":"Return Value","pos":[16179,16191]},{"content":"Remarks","pos":[16201,16208]},{"pos":[16269,16303],"content":"CMFCRibbonGallery::GetSelectedItem"},{"content":"Return Value","pos":[16463,16475]},{"content":"Remarks","pos":[16485,16492]},{"pos":[16545,16571],"content":"CMFCRibbonGallery::HasMenu"},{"content":"Return Value","pos":[16732,16744]},{"content":"Remarks","pos":[16754,16761]},{"pos":[16819,16850],"content":"CMFCRibbonGallery::IsButtonMode"},{"content":"Specifies whether the palette is contained in a gallery button.","pos":[16854,16917]},{"content":"Return Value","pos":[16972,16984]},{"pos":[16995,17110],"content":"if the palette is displayed as a drop-down menu button; <ph id=\"ph1\">`FALSE`</ph> if the palette is displayed directly on the ribbon.","source":" if the palette is displayed as a drop-down menu button; `FALSE` if the palette is displayed directly on the ribbon."},{"content":"Remarks","pos":[17120,17127]},{"pos":[17192,17230],"content":"CMFCRibbonGallery::IsMenuResizeEnabled"},{"content":"Specifies whether menu resizing is enabled.","pos":[17234,17277]},{"content":"Return Value","pos":[17339,17351]},{"pos":[17362,17416],"content":"if menu resizing has been enabled; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","source":" if menu resizing has been enabled; otherwise, `FALSE`."},{"content":"Remarks","pos":[17426,17433]},{"pos":[17499,17538],"content":"CMFCRibbonGallery::IsMenuResizeVertical"},{"content":"Return Value","pos":[17704,17716]},{"content":"Remarks","pos":[17726,17733]},{"pos":[17792,17824],"content":"CMFCRibbonGallery::IsMenuSideBar"},{"content":"Specifies whether the side bar is enabled or disabled.","pos":[17828,17882]},{"content":"Return Value","pos":[17938,17950]},{"pos":[17961,18057],"content":"if the Office XP-style side bar is drawn at the left side of the popup menu; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","source":" if the Office XP-style side bar is drawn at the left side of the popup menu; otherwise, `FALSE`."},{"content":"Remarks","pos":[18067,18074]},{"pos":[18137,18173],"content":"CMFCRibbonGallery::OnAfterChangeRect"},{"content":"Parameters","pos":[18343,18353]},{"pos":[18357,18361],"content":"[in]"},{"content":"Remarks","pos":[18377,18384]},{"pos":[18436,18461],"content":"CMFCRibbonGallery::OnDraw"},{"content":"Parameters","pos":[18620,18630]},{"pos":[18634,18638],"content":"[in]"},{"content":"Remarks","pos":[18654,18661]},{"pos":[18724,18760],"content":"CMFCRibbonGallery::OnDrawPaletteIcon"},{"content":"Called by the framework when a gallery icon is drawn.","pos":[18764,18817]},{"content":"Parameters","pos":[18993,19003]},{"content":"[in]","pos":[19007,19011]},{"content":"A pointer to the device context that is used for drawing.","pos":[19021,19078]},{"content":"[in]","pos":[19085,19089]},{"content":"Specifies the bounding rectangle of the icon to draw.","pos":[19104,19157]},{"content":"[in]","pos":[19164,19168]},{"content":"Specifies the zero-based index in the image list of gallery icons of the icon to draw.","pos":[19185,19271]},{"content":"[in]","pos":[19278,19282]},{"content":"A pointer to the icon being drawn.","pos":[19294,19328]},{"content":"[in]","pos":[19335,19339]},{"content":"Specifies the color for the text of the item to draw.","pos":[19353,19406]},{"content":"Remarks","pos":[19416,19423]},{"content":"You can override this method in a derived class to customize the appearance of a ribbon gallery.","pos":[19427,19523]},{"pos":[19577,19604],"content":"CMFCRibbonGallery::OnEnable"},{"content":"Parameters","pos":[19769,19779]},{"pos":[19783,19787],"content":"[in]"},{"content":"Remarks","pos":[19807,19814]},{"pos":[19872,19903],"content":"CMFCRibbonGallery::OnRTLChanged"},{"content":"Parameters","pos":[20071,20081]},{"pos":[20085,20089],"content":"[in]"},{"content":"Remarks","pos":[20108,20115]},{"pos":[20172,20202],"content":"CMFCRibbonGallery::RedrawIcons"},{"content":"Redraws the gallery.","pos":[20206,20226]},{"content":"Remarks","pos":[20271,20278]},{"content":"Call this function to redraw the gallery.","pos":[20282,20323]},{"content":"You must call this method if you have changed the contents of the gallery at runtime.","pos":[20324,20409]},{"pos":[20473,20510],"content":"CMFCRibbonGallery::RemoveItemToolTips"},{"content":"Removes the tooltips from all items in the gallery.","pos":[20514,20565]},{"content":"Remarks","pos":[20617,20624]},{"pos":[20680,20709],"content":"CMFCRibbonGallery::SelectItem"},{"content":"Parameters","pos":[20870,20880]},{"pos":[20884,20888],"content":"[in]"},{"content":"Remarks","pos":[20911,20918]},{"pos":[20974,21003],"content":"CMFCRibbonGallery::SetACCData"},{"pos":[21007,21111],"content":"Populates the specified <ph id=\"ph1\">`CAccessibilityData`</ph> object by using accessibility data from the ribbon gallery.","source":"Populates the specified `CAccessibilityData` object by using accessibility data from the ribbon gallery."},{"content":"Parameters","pos":[21214,21224]},{"content":"[in]","pos":[21228,21232]},{"content":"The parent window of the ribbon gallery window.","pos":[21246,21293]},{"content":"[out]","pos":[21300,21305]},{"content":"A <ph id=\"ph1\">`CAccessibilityData`</ph> object that receives the accessibility data from the ribbon gallery.","pos":[21316,21407],"source":" A `CAccessibilityData` object that receives the accessibility data from the ribbon gallery."},{"content":"Return Value","pos":[21417,21429]},{"content":"Remarks","pos":[21439,21446]},{"pos":[21457,21505],"content":"if the method is successful; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","source":" if the method is successful; otherwise, `FALSE`."},{"pos":[21564,21596],"content":"CMFCRibbonGallery::SetButtonMode"},{"content":"Determines whether to display the ribbon gallery as a drop-down button or as a palette directly on the ribbon.","pos":[21600,21710]},{"content":"Parameters","pos":[21771,21781]},{"content":"[in]","pos":[21785,21789]},{"content":"to display the ribbon gallery as a drop-down menu button; <ph id=\"ph1\">`FALSE`</ph> to display the contents of the ribbon gallery directly on the ribbon.","pos":[21807,21942],"source":" to display the ribbon gallery as a drop-down menu button; `FALSE` to display the contents of the ribbon gallery directly on the ribbon."},{"content":"Remarks","pos":[21952,21959]},{"pos":[22017,22048],"content":"CMFCRibbonGallery::SetGroupName"},{"content":"Sets the name of a group.","pos":[22052,22077]},{"content":"Parameters","pos":[22172,22182]},{"content":"[in]","pos":[22186,22190]},{"content":"Specifies the zero-based index for the group for which the name is being changed.","pos":[22208,22289]},{"content":"[in]","pos":[22296,22300]},{"content":"Specifies the new name for the group.","pos":[22320,22357]},{"content":"Remarks","pos":[22367,22374]},{"pos":[22378,22514],"content":"The group whose name is being changed must have been added using the <bpt id=\"p1\">[</bpt>CMFCRibbonGallery::AddGroup<ept id=\"p1\">](#cmfcribbongallery__addgroup)</ept> method.","source":"The group whose name is being changed must have been added using the [CMFCRibbonGallery::AddGroup](#cmfcribbongallery__addgroup) method."},{"pos":[22573,22605],"content":"CMFCRibbonGallery::SetIconsInRow"},{"content":"Specifies the number of items per row in the gallery.","pos":[22609,22662]},{"content":"Parameters","pos":[22724,22734]},{"content":"[in]","pos":[22738,22742]},{"content":"Specifies the number of items to appear in each row of the gallery.","pos":[22760,22827]},{"content":"Remarks","pos":[22837,22844]},{"content":"Use this method to specify the width of the ribbon gallery.","pos":[22848,22907]},{"pos":[22967,23000],"content":"CMFCRibbonGallery::SetItemToolTip"},{"content":"Sets the tooltip text for an item in the gallery.","pos":[23004,23053]},{"content":"Parameters","pos":[23147,23157]},{"content":"[in]","pos":[23161,23165]},{"content":"The zero-based index of the palette item with which to associate the tooltip.","pos":[23182,23259]},{"content":"[in]","pos":[23266,23270]},{"content":"The text to appear on the tooltip.","pos":[23288,23322]},{"content":"Remarks","pos":[23332,23339]},{"pos":[23395,23424],"content":"CMFCRibbonGallery::SetPalette"},{"content":"Attaches a palette to a ribbon gallery.","pos":[23428,23467]},{"content":"Parameters","pos":[23626,23636]},{"content":"[in]","pos":[23640,23644]},{"content":"Specifies the image list that contains the icons to appear on the gallery.","pos":[23664,23738]},{"content":"[in]","pos":[23745,23749]},{"content":"Specifies the resource ID of the image list that contains the icons to appear on the gallery.","pos":[23776,23869]},{"content":"[in]","pos":[23876,23880]},{"content":"Specifies the width, in pixels, of an image on the gallery.","pos":[23901,23960]},{"content":"Remarks","pos":[23970,23977]},{"pos":[24035,24066],"content":"CMFCRibbonGallery::SetPaletteID"},{"pos":[24070,24171],"content":"Defines the command ID that is sent in the <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> message when a user selects a gallery item.","source":"Defines the command ID that is sent in the **WM_COMMAND** message when a user selects a gallery item."},{"content":"Parameters","pos":[24225,24235]},{"content":"[in]","pos":[24239,24243]},{"content":"Specifies the command ID that is sent in the <bpt id=\"p1\">**</bpt>WM_COMMAND<ept id=\"p1\">**</ept> message when a user selects a gallery item.","pos":[24253,24356],"source":" Specifies the command ID that is sent in the **WM_COMMAND** message when a user selects a gallery item."},{"content":"Remarks","pos":[24366,24373]},{"pos":[24377,24552],"content":"To determine the specific item that a user selected from the gallery, call the <bpt id=\"p1\">[</bpt>CMFCRibbonGallery::GetLastSelectedItem<ept id=\"p1\">](#cmfcribbongallery__getlastselecteditem)</ept> static method.","source":"To determine the specific item that a user selected from the gallery, call the [CMFCRibbonGallery::GetLastSelectedItem](#cmfcribbongallery__getlastselecteditem) static method."},{"content":"See Also","pos":[24561,24569]},{"content":"Hierarchy Chart","pos":[24574,24589]},{"content":"Classes","pos":[24626,24633]},{"content":"CMFCRibbonButton Class","pos":[24676,24698]},{"content":"CMFCRibbonGalleryMenuButton Class","pos":[24752,24785]}],"content":"---\ntitle: \"CMFCRibbonGallery Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCRibbonGallery\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCRibbonGallery class\"\nms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4\ncaps.latest.revision: 28\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCRibbonGallery Class\nImplements Office 2007-style ribbon galleries.  \n  \n## Syntax  \n  \n```  \nclass CMFCRibbonGallery : public CMFCRibbonButton  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCRibbonGallery::CMFCRibbonGallery](#cmfcribbongallery__cmfcribbongallery)|Constructs and initializes a `CMFCRibbonGallery` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCRibbonGallery::AddGroup](#cmfcribbongallery__addgroup)|Adds a new group to the gallery.|  \n|[CMFCRibbonGallery::AddSubItem](#cmfcribbongallery__addsubitem)|Adds a new menu item to the drop-down menu.|  \n|[CMFCRibbonGallery::Clear](#cmfcribbongallery__clear)|Clears the content of the gallery.|  \n|[CMFCRibbonGallery::EnableMenuResize](#cmfcribbongallery__enablemenuresize)|Enables or disables resizing of the menu panel.|  \n|[CMFCRibbonGallery::EnableMenuSideBar](#cmfcribbongallery__enablemenusidebar)|Enables or disables the side bar to the left of the popup menu.|  \n|[CMFCRibbonGallery::GetCompactSize](#cmfcribbongallery__getcompactsize)|(Overrides [CMFCRibbonButton::GetCompactSize](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__getcompactsize).)|  \n|[CMFCRibbonGallery::GetDroppedDown](#cmfcribbongallery__getdroppeddown)|(Overrides [CMFCRibbonBaseElement::GetDroppedDown](../../mfc/reference/cmfcribbonbaseelement-class.md#cmfcribbonbaseelement__getdroppeddown).)|  \n|[CMFCRibbonGallery::GetGroupName](#cmfcribbongallery__getgroupname)|Returns the name of the group that is located at the specified index.|  \n|[CMFCRibbonGallery::GetGroupOffset](#cmfcribbongallery__getgroupoffset)||  \n|[CMFCRibbonGallery::GetIconsInRow](#cmfcribbongallery__geticonsinrow)|Returns the number of items in a row of the ribbon gallery.|  \n|[CMFCRibbonGallery::GetItemToolTip](#cmfcribbongallery__getitemtooltip)|Returns the tooltip text that is associated with an item in the gallery.|  \n|[CMFCRibbonGallery::GetLastSelectedItem](#cmfcribbongallery__getlastselecteditem)|Returns the index of the last item in the gallery that the user selected.|  \n|[CMFCRibbonGallery::GetPaletteID](#cmfcribbongallery__getpaletteid)|Returns the command ID of the current gallery.|  \n|[CMFCRibbonGallery::GetRegularSize](#cmfcribbongallery__getregularsize)|(Overrides [CMFCRibbonButton::GetRegularSize](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__getregularsize).)|  \n|[CMFCRibbonGallery::GetSelectedItem](#cmfcribbongallery__getselecteditem)||  \n|[CMFCRibbonGallery::HasMenu](#cmfcribbongallery__hasmenu)|(Overrides [CMFCRibbonButton::HasMenu](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__hasmenu).)|  \n|[CMFCRibbonGallery::IsButtonMode](#cmfcribbongallery__isbuttonmode)|Specifies whether the gallery is contained in a gallery button.|  \n|[CMFCRibbonGallery::IsMenuResizeEnabled](#cmfcribbongallery__ismenuresizeenabled)|Specifies whether menu resizing is enabled or disabled.|  \n|[CMFCRibbonGallery::IsMenuResizeVertical](#cmfcribbongallery__ismenuresizevertical)||  \n|[CMFCRibbonGallery::IsMenuSideBar](#cmfcribbongallery__ismenusidebar)|Specifies whether the side bar is enabled or disabled.|  \n|[CMFCRibbonGallery::OnAfterChangeRect](#cmfcribbongallery__onafterchangerect)|(Overrides `CMFCRibbonButton::OnAfterChangeRect`.)|  \n|[CMFCRibbonGallery::OnDraw](#cmfcribbongallery__ondraw)|(Overrides [CMFCRibbonButton::OnDraw](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__ondraw).)|  \n|[CMFCRibbonGallery::OnEnable](#cmfcribbongallery__onenable)|(Overrides `CMFCRibbonBaseElement::OnEnable`.)|  \n|[CMFCRibbonGallery::OnRTLChanged](#cmfcribbongallery__onrtlchanged)|(Overrides [CMFCRibbonBaseElement::OnRTLChanged](../../mfc/reference/cmfcribbonbaseelement-class.md#cmfcribbonbaseelement__onrtlchanged).)|  \n|[CMFCRibbonGallery::RedrawIcons](#cmfcribbongallery__redrawicons)|Redraws the gallery.|  \n|[CMFCRibbonGallery::RemoveItemToolTips](#cmfcribbongallery__removeitemtooltips)|Removes the tooltips from all items in the gallery.|  \n|[CMFCRibbonGallery::SelectItem](#cmfcribbongallery__selectitem)||  \n|[CMFCRibbonGallery::SetACCData](#cmfcribbongallery__setaccdata)|(Overrides [CMFCRibbonButton::SetACCData](../../mfc/reference/cmfcribbonbutton-class.md#cmfcribbonbutton__setaccdata).)|  \n|[CMFCRibbonGallery::SetButtonMode](#cmfcribbongallery__setbuttonmode)|Specifies whether to display the ribbon gallery as a drop-down button or as a palette directly on the ribbon.|  \n|[CMFCRibbonGallery::SetGroupName](#cmfcribbongallery__setgroupname)|Sets the name of a group.|  \n|[CMFCRibbonGallery::SetIconsInRow](#cmfcribbongallery__seticonsinrow)|Defines the number of items per row in the gallery.|  \n|[CMFCRibbonGallery::SetItemToolTip](#cmfcribbongallery__setitemtooltip)|Sets the tooltip text for an item in the gallery.|  \n|[CMFCRibbonGallery::SetPalette](#cmfcribbongallery__setpalette)|Attaches a palette to a ribbon gallery.|  \n|[CMFCRibbonGallery::SetPaletteID](#cmfcribbongallery__setpaletteid)|Defines the command ID that is sent in the `WM_COMMAND` message when a gallery item has been selected.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCRibbonGallery::OnDrawPaletteIcon](#cmfcribbongallery__ondrawpaletteicon)|Called by the framework when a gallery icon is drawn.|  \n  \n## Remarks  \n A gallery button behaves just like a regular menu button except that it displays a gallery when a user opens it. When you select an item in a gallery, the framework sends the `WM_COMMAND` message together with command ID of the button. When you handle the message, you should call [CMFCRibbonGallery::GetLastSelectedItem](#cmfcribbongallery__getlastselecteditem) to determine which item was selected from the gallery.  \n  \n## Example  \n The following example demonstrates how to use various methods in the `CMFCRibbonGallery` class to configure a `CMFCRibbonGallery` object. The example illustrates how to specify the number of items per row in the gallery, enable resizing of the menu panel, enable the side bar to the left of the pop-up menu, and display the ribbon gallery as a palette directly on the ribbon bar. This code snippet is part of the [Draw Client sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md) [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md) [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)  \n  \n [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)  \n  \n## Requirements  \n **Header:** afxRibbonPaletteGallery.h  \n  \n##  <a name=\"cmfcribbongallery__addgroup\"></a>  CMFCRibbonGallery::AddGroup  \n Adds a new group to the gallery.  \n  \n```  \nvoid AddGroup(\n    LPCTSTR lpszGroupName,  \n    UINT uiImagesPaletteResID,  \n    int cxPaletteImage);\n\n \nvoid AddGroup(\n    LPCTSTR lpszGroupName,  \n    CMFCToolBarImages& imagesGroup);\n\n \nvoid AddGroup(\n    LPCTSTR lpszGroupName,  \n    int nIconsNum);\n```  \n  \n### Parameters  \n [in] `lpszGroupName`  \n Specifies the name of the group.  \n  \n [in] `uiImagesPaletteResID`  \n Specifies the resource ID of the image list that contains the images for the group.  \n  \n [in] `cxPaletteImage`  \n Specifies the width in pixels of an image.  \n  \n [in] `imagesGroup`  \n A reference to image list that contains group images.  \n  \n [in] `nIconsNum`  \n Specifies the number of icons in the group. This parameter should be specified only for custom (owner drawn) groups.  \n  \n### Remarks  \n You can divide the items on a ribbon gallery into multiple groups by calling this method. Each group can have a caption.  \n  \n##  <a name=\"cmfcribbongallery__addsubitem\"></a>  CMFCRibbonGallery::AddSubItem  \n Adds a new menu item to the drop-down menu.  \n  \n```  \nvoid AddSubItem(\n    CMFCRibbonBaseElement* pSubItem,  \n    int nIndex=-1,  \n    BOOL bOnTop=FALSE);\n```  \n  \n### Parameters  \n [in] `pSubItem`  \n A pointer to the item to add to the menu.  \n  \n [in] `nIndex`  \n Specifies the zero-based index of a location where to insert the item.  \n  \n [in] `bOnTop`  \n `TRUE` to specify that the item should be inserted before the ribbon gallery; otherwise, `FALSE`.  \n  \n### Remarks  \n You can combine popup galleries with popup menu items by calling this method. Menu items can be placed before or after the gallery.  \n  \n To insert the item before the gallery, set `bOnTop` to `TRUE`. Set `bOnTop` to `FALSE` to insert the item below the gallery.  \n  \n> [!NOTE]\n>  The parameter `nIndex` specifies the insertion index both at the top of the gallery and at the bottom of the gallery. For example, if you need to insert an item one position before the gallery, set `nIndex` to 1 and `bOnTop` to `TRUE`. Similarly, if you need to insert an item one position below the gallery, set `nIndex` to 1 and `bOnTop` to `FALSE`.  \n  \n##  <a name=\"cmfcribbongallery__clear\"></a>  CMFCRibbonGallery::Clear  \n Clears the content of the gallery.  \n  \n```  \nvirtual void Clear();\n```  \n  \n### Remarks  \n Call this method to remove all content from the ribbon gallery. This must be done before you attach a new ribbon gallery or set of groups to the ribbon gallery.  \n  \n##  <a name=\"cmfcribbongallery__cmfcribbongallery\"></a>  CMFCRibbonGallery::CMFCRibbonGallery  \n Constructs and initializes a [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md) object.  \n  \n```  \nCMFCRibbonGallery (\n    UINT nID,  \n    LPCTSTR lpszText,  \n    int nSmallImageIndex,  \n    int nLargeImageIndex,  \n    CMFCToolBarImages& imagesPalette);\n\n \nCMFCRibbonGallery (\n    UINT nID,  \n    LPCTSTR lpszText,  \n    int nSmallImageIndex,  \n    int nLargeImageIndex,  \n    UINT uiImagesPaletteResID=0,  \n    int cxPaletteImage=0);\n\n \nCMFCRibbonGallery (\n    UINT nID,  \n    LPCTSTR lpszText,  \n    int nSmallImageIndex,  \n    int nLargeImageIndex,  \n    CSize sizeIcon,  \n    int nIconsNum,  \n    BOOL bDefaultButtonStyle=TRUE);\n```  \n  \n### Parameters  \n `nID`  \n Specifies the command ID of the command to execute when a user clicks the button.  \n  \n `lpszText`  \n Specifies the text to appear on the button.  \n  \n `nSmallImageIndex`  \n The zero-based index of the small image to appear on the button.  \n  \n `nLargeImageIndex`  \n The zero-based index of the large image to appear on the button.  \n  \n `imagesPalette`  \n A reference to the [CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md) object that contains the images to appear on the gallery.  \n  \n `uiImagesPaletteResID`  \n The resource ID of the list of images to display on the gallery.  \n  \n `cxPaletteImage`  \n Specifies the width, in pixels, of the image on the gallery.  \n  \n `sizeIcon`  \n Specifies the size, in pixels, of the gallery image.  \n  \n `nIconsNum`  \n Specifies the number of icons in the gallery.  \n  \n `bDefaultButtonStyle`  \n Specifies whether to use the default or the owner-drawn button style.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__enablemenuresize\"></a>  CMFCRibbonGallery::EnableMenuResize  \n Enables or disables resizing of the menu panel.  \n  \n```  \nvoid EnableMenuResize(\n    BOOL bEnable = TRUE,  \n    BOOL bVertcalOnly = FALSE);\n```  \n  \n### Parameters  \n [in] `bEnable`  \n `TRUE` to enable resizing the menu; otherwise, `FALSE`.  \n  \n [in] `bVertcalOnly`  \n `TRUE` to specify that the gallery can be resized only vertically; `FALSE` to specify that the gallery can be resized both vertically and horizontally.  \n  \n### Remarks  \n Use this method to enable or disable resizing the ribbon gallery. When resizing is enabled, the ribbon gallery displays a gripper that a user can use to resize it.  \n  \n##  <a name=\"cmfcribbongallery__enablemenusidebar\"></a>  CMFCRibbonGallery::EnableMenuSideBar  \n Enables or disables the side bar to the left of the popup menu.  \n  \n```  \nvoid EnablMenuSideBar(BOOL bEnable=TRUE);\n```  \n  \n### Parameters  \n [in] `bEnable`  \n `TRUE` to specify that the side bar is enabled; otherwise, `FALSE`.  \n  \n### Remarks  \n Call this method to enable or disable the Office XP-style side bar at the left side of the menu.  \n  \n##  <a name=\"cmfcribbongallery__getcompactsize\"></a>  CMFCRibbonGallery::GetCompactSize  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual CSize GetCompactSize(CDC* pDC);\n```  \n  \n### Parameters  \n [in] `pDC`  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__getdroppeddown\"></a>  CMFCRibbonGallery::GetDroppedDown  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual CMFCRibbonBaseElement* GetDroppedDown();\n```  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__getgroupname\"></a>  CMFCRibbonGallery::GetGroupName  \n Returns the name of the group that is located at the specified index.  \n  \n```  \nLPCTSTR GetGroupName(int nGroupIndex) const;\n\n \n```  \n  \n### Parameters  \n [in] `nGroupIndex`  \n Specifies the zero-based index for the group whose name you want to retrieve.  \n  \n### Return Value  \n The name of the group located at the specified index. Passing an invalid index will result in a failed assertion.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__getgroupoffset\"></a>  CMFCRibbonGallery::GetGroupOffset  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual int GetGroupOffset() const;\n\n \n```  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__geticonsinrow\"></a>  CMFCRibbonGallery::GetIconsInRow  \n Returns the number of items in a row of the ribbon gallery.  \n  \n```  \nint GetIconsInRow() const;\n\n \n```  \n  \n### Return Value  \n The number of items in a row.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__getitemtooltip\"></a>  CMFCRibbonGallery::GetItemToolTip  \n Returns the tooltip text that is associated with an item in the gallery.  \n  \n```  \nLPCTSTR GetItemToolTip(int nItemIndex) const;\n\n \n```  \n  \n### Parameters  \n [in] `nItemIndex`  \n Specifies the zero-based index of the item for which to retrieve the tooltip text.  \n  \n### Return Value  \n A pointer to the tooltip string assigned to an item in the ribbon gallery. It can be `NULL` if no tooltip is assigned to that item.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__getlastselecteditem\"></a>  CMFCRibbonGallery::GetLastSelectedItem  \n Returns the index of the last item in the ribbon gallery that the user selected.  \n  \n```  \nstatic int GetLastSelectedItem(UINT uiCmdID);\n```  \n  \n### Parameters  \n [in] `uiCmdID`  \n Specifies the command ID of the menu item that opened the ribbon gallery.  \n  \n### Return Value  \n When the user selects any item in the ribbon gallery, the library sends the `WM_COMMAND` message along with Command ID of the menu button that opened the ribbon gallery.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__getpaletteid\"></a>  CMFCRibbonGallery::GetPaletteID  \n Returns the command ID of the current palette.  \n  \n```  \nint GetPaletteID() const;\n\n \n```  \n  \n### Return Value  \n The command ID of the currently selected palette.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__getregularsize\"></a>  CMFCRibbonGallery::GetRegularSize  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual CSize GetRegularSize(CDC* pDC);\n```  \n  \n### Parameters  \n [in] `pDC`  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__getselecteditem\"></a>  CMFCRibbonGallery::GetSelectedItem  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nint GetSelectedItem() const;\n\n \n```  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__hasmenu\"></a>  CMFCRibbonGallery::HasMenu  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual BOOL HasMenu() const;\n\n \n```  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__isbuttonmode\"></a>  CMFCRibbonGallery::IsButtonMode  \n Specifies whether the palette is contained in a gallery button.  \n  \n```  \nBOOL IsButtonMode() const;\n\n \n```  \n  \n### Return Value  \n `TRUE` if the palette is displayed as a drop-down menu button; `FALSE` if the palette is displayed directly on the ribbon.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__ismenuresizeenabled\"></a>  CMFCRibbonGallery::IsMenuResizeEnabled  \n Specifies whether menu resizing is enabled.  \n  \n```  \nBOOL IsMenuResizeEnabled() const;\n\n \n```  \n  \n### Return Value  \n `TRUE` if menu resizing has been enabled; otherwise, `FALSE`.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__ismenuresizevertical\"></a>  CMFCRibbonGallery::IsMenuResizeVertical  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nBOOL IsMenuResizeVertical() const;\n\n \n```  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__ismenusidebar\"></a>  CMFCRibbonGallery::IsMenuSideBar  \n Specifies whether the side bar is enabled or disabled.  \n  \n```  \nBOOL IsMenuSideBar() const;\n\n \n```  \n  \n### Return Value  \n `TRUE` if the Office XP-style side bar is drawn at the left side of the popup menu; otherwise, `FALSE`.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__onafterchangerect\"></a>  CMFCRibbonGallery::OnAfterChangeRect  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual void OnAfterChangeRect(CDC* pDC);\n```  \n  \n### Parameters  \n [in] `pDC`  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__ondraw\"></a>  CMFCRibbonGallery::OnDraw  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual void OnDraw(CDC* pDC);\n```  \n  \n### Parameters  \n [in] `pDC`  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__ondrawpaletteicon\"></a>  CMFCRibbonGallery::OnDrawPaletteIcon  \n Called by the framework when a gallery icon is drawn.  \n  \n```  \nvirtual void OnDrawPaletteIcon(\n    CDC* pDC,  \n    CRect rectIcon,  \n    int nIconIndex,  \n    CMFCRibbonGalleryIcon* pIcon,  \n    COLORREF clrText);\n```  \n  \n### Parameters  \n [in] `pDC`  \n A pointer to the device context that is used for drawing.  \n  \n [in] `rectIcon`  \n Specifies the bounding rectangle of the icon to draw.  \n  \n [in] `nIconIndex`  \n Specifies the zero-based index in the image list of gallery icons of the icon to draw.  \n  \n [in] `pIcon`  \n A pointer to the icon being drawn.  \n  \n [in] `clrText`  \n Specifies the color for the text of the item to draw.  \n  \n### Remarks  \n You can override this method in a derived class to customize the appearance of a ribbon gallery.  \n  \n##  <a name=\"cmfcribbongallery__onenable\"></a>  CMFCRibbonGallery::OnEnable  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual void OnEnable(BOOL bEnable);\n```  \n  \n### Parameters  \n [in] `bEnable`  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__onrtlchanged\"></a>  CMFCRibbonGallery::OnRTLChanged  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual void OnRTLChanged(BOOL bIsRTL);\n```  \n  \n### Parameters  \n [in] `bIsRTL`  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__redrawicons\"></a>  CMFCRibbonGallery::RedrawIcons  \n Redraws the gallery.  \n  \n```  \nvoid RedrawIcons();\n```  \n  \n### Remarks  \n Call this function to redraw the gallery. You must call this method if you have changed the contents of the gallery at runtime.  \n  \n##  <a name=\"cmfcribbongallery__removeitemtooltips\"></a>  CMFCRibbonGallery::RemoveItemToolTips  \n Removes the tooltips from all items in the gallery.  \n  \n```  \nvoid RemoveItemToolTips();\n```  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__selectitem\"></a>  CMFCRibbonGallery::SelectItem  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvoid SelectItem(int nItemIndex);\n```  \n  \n### Parameters  \n [in] `nItemIndex`  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__setaccdata\"></a>  CMFCRibbonGallery::SetACCData  \n Populates the specified `CAccessibilityData` object by using accessibility data from the ribbon gallery.  \n  \n```  \nvirtual BOOL SetACCData(\n    CWnd* pParent,   \n    CAccessibilityData& data);\n```  \n  \n### Parameters  \n [in] `pParent`  \n The parent window of the ribbon gallery window.  \n  \n [out] `data`  \n A `CAccessibilityData` object that receives the accessibility data from the ribbon gallery.  \n  \n### Return Value  \n  \n### Remarks  \n `TRUE` if the method is successful; otherwise, `FALSE`.  \n  \n##  <a name=\"cmfcribbongallery__setbuttonmode\"></a>  CMFCRibbonGallery::SetButtonMode  \n Determines whether to display the ribbon gallery as a drop-down button or as a palette directly on the ribbon.  \n  \n```  \nvoid SetButtonMode(BOOL bSet=TRUE);\n```  \n  \n### Parameters  \n [in] `bSet`  \n `TRUE` to display the ribbon gallery as a drop-down menu button; `FALSE` to display the contents of the ribbon gallery directly on the ribbon.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__setgroupname\"></a>  CMFCRibbonGallery::SetGroupName  \n Sets the name of a group.  \n  \n```  \nvoid SetGroupName(\n    int nGroupIndex,  \n    LPCTSTR lpszGroupName);\n```  \n  \n### Parameters  \n [in] `nGroupIndex`  \n Specifies the zero-based index for the group for which the name is being changed.  \n  \n [in] `lpszGroupName`  \n Specifies the new name for the group.  \n  \n### Remarks  \n The group whose name is being changed must have been added using the [CMFCRibbonGallery::AddGroup](#cmfcribbongallery__addgroup) method.  \n  \n##  <a name=\"cmfcribbongallery__seticonsinrow\"></a>  CMFCRibbonGallery::SetIconsInRow  \n Specifies the number of items per row in the gallery.  \n  \n```  \nvoid SetIconsInRow(int nIconsInRow);\n```  \n  \n### Parameters  \n [in] `nIconsInRow`  \n Specifies the number of items to appear in each row of the gallery.  \n  \n### Remarks  \n Use this method to specify the width of the ribbon gallery.  \n  \n##  <a name=\"cmfcribbongallery__setitemtooltip\"></a>  CMFCRibbonGallery::SetItemToolTip  \n Sets the tooltip text for an item in the gallery.  \n  \n```  \nvoid SetItemToolTip(\n    int nItemIndex,  \n    LPCTSTR lpszToolTip);\n```  \n  \n### Parameters  \n [in] `nItemIndex`  \n The zero-based index of the palette item with which to associate the tooltip.  \n  \n [in] `lpszToolTip`  \n The text to appear on the tooltip.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__setpalette\"></a>  CMFCRibbonGallery::SetPalette  \n Attaches a palette to a ribbon gallery.  \n  \n```  \nvoid SetPalette(\n    CMFCToolBarImages& imagesPalette);\n\n \nvoid SetPalette(\n    UINT uiImagesPaletteResID,  \n    int cxPaletteImage);\n```  \n  \n### Parameters  \n [in] `imagesPalette`  \n Specifies the image list that contains the icons to appear on the gallery.  \n  \n [in] `uiImagesPaletteResID`  \n Specifies the resource ID of the image list that contains the icons to appear on the gallery.  \n  \n [in] `cxPaletteImage`  \n Specifies the width, in pixels, of an image on the gallery.  \n  \n### Remarks  \n  \n##  <a name=\"cmfcribbongallery__setpaletteid\"></a>  CMFCRibbonGallery::SetPaletteID  \n Defines the command ID that is sent in the **WM_COMMAND** message when a user selects a gallery item.  \n  \n```  \nvoid SetPaletteID(UINT nID);\n```  \n  \n### Parameters  \n [in] `nID`  \n Specifies the command ID that is sent in the **WM_COMMAND** message when a user selects a gallery item.  \n  \n### Remarks  \n To determine the specific item that a user selected from the gallery, call the [CMFCRibbonGallery::GetLastSelectedItem](#cmfcribbongallery__getlastselecteditem) static method.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CMFCRibbonButton Class](../../mfc/reference/cmfcribbonbutton-class.md)   \n [CMFCRibbonGalleryMenuButton Class](../../mfc/reference/cmfcribbongallerymenubutton-class.md)\n"}