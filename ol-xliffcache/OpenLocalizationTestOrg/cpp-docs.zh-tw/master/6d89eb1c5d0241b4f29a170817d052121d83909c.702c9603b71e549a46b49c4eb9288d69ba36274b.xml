{"nodes":[{"pos":[12,57],"content":"IPersistStreamInitImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IPersistStreamInitImpl Class | Microsoft Docs","pos":[0,45]}]},{"content":"IPersistStreamInitImpl Class","pos":[843,871]},{"pos":[872,1043],"content":"This class implements <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> and provides a default implementation of the <bpt id=\"p2\">[</bpt>IPersistStreamInit<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682273)</ept> interface.","source":"This class implements **IUnknown** and provides a default implementation of the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface."},{"pos":[1051,1201],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,148],"source":" This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"content":"Syntax","pos":[1210,1216]},{"content":"Parameters","pos":[1331,1341]},{"content":"Your class, derived from <ph id=\"ph1\">`IPersistStreamInitImpl`</ph>.","pos":[1352,1402],"source":" Your class, derived from `IPersistStreamInitImpl`."},{"content":"Members","pos":[1411,1418]},{"content":"Public Methods","pos":[1428,1442]},{"content":"Name","pos":[1449,1453]},{"content":"Description","pos":[1454,1465]},{"content":"IPersistStreamInitImpl::GetClassID","pos":[1504,1538]},{"content":"Retrieves the object's CLSID.","pos":[1577,1606]},{"content":"IPersistStreamInitImpl::GetSizeMax","pos":[1612,1646]},{"content":"Retrieves the size of the stream needed to save the object's data.","pos":[1685,1751]},{"content":"The ATL implementation returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","pos":[1752,1797],"source":" The ATL implementation returns **E_NOTIMPL**."},{"content":"IPersistStreamInitImpl::InitNew","pos":[1803,1834]},{"content":"Initializes a newly created object.","pos":[1870,1905]},{"content":"IPersistStreamInitImpl::IsDirty","pos":[1911,1942]},{"content":"Checks whether the object's data has changed since it was last saved.","pos":[1978,2047]},{"content":"IPersistStreamInitImpl::Load","pos":[2053,2081]},{"content":"Loads the object's properties from the specified stream.","pos":[2114,2170]},{"content":"IPersistStreamInitImpl::Save","pos":[2176,2204]},{"content":"Saves the object's properties to the specified stream.","pos":[2237,2291]},{"content":"Remarks","pos":[2301,2308]},{"content":"The <bpt id=\"p1\">[</bpt>IPersistStreamInit<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682273)</ept> interface allows a client to request that your object loads and saves its persistent data to a single stream.","pos":[2312,2506],"source":"The [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface allows a client to request that your object loads and saves its persistent data to a single stream."},{"content":"Class <ph id=\"ph1\">`IPersistStreamInitImpl`</ph> provides a default implementation of this interface and implements <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> by sending information to the dump device in debug builds.","pos":[2507,2676],"source":" Class `IPersistStreamInitImpl` provides a default implementation of this interface and implements **IUnknown** by sending information to the dump device in debug builds."},{"pos":[2683,2844],"content":"<bpt id=\"p1\">**</bpt>Related Articles<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>ATL Tutorial<ept id=\"p2\">](../../atl/active-template-library-atl-tutorial.md)</ept>, <bpt id=\"p3\">[</bpt>Creating an ATL Project<ept id=\"p3\">](../../atl/reference/creating-an-atl-project.md)</ept>","source":"**Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)"},{"content":"Inheritance Hierarchy","pos":[2853,2874]},{"content":"Requirements","pos":[2938,2950]},{"pos":[2954,2974],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[3035,3069],"content":"IPersistStreamInitImpl::GetClassID"},{"content":"Retrieves the object's CLSID.","pos":[3073,3102]},{"content":"Remarks","pos":[3165,3172]},{"pos":[3176,3322],"content":"See <bpt id=\"p1\">[</bpt>IPersist::GetClassID<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms688664)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3383,3417],"content":"IPersistStreamInitImpl::GetSizeMax"},{"content":"Retrieves the size of the stream needed to save the object's data.","pos":[3421,3487]},{"content":"Return Value","pos":[3562,3574]},{"pos":[3578,3600],"content":"Returns <bpt id=\"p1\">**</bpt>E_NOTIMPL<ept id=\"p1\">**</ept>.","source":"Returns **E_NOTIMPL**."},{"content":"Remarks","pos":[3610,3617]},{"pos":[3621,3777],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::GetSizeMax<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms687287)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::GetSizeMax](http://msdn.microsoft.com/library/windows/desktop/ms687287) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3835,3866],"content":"IPersistStreamInitImpl::InitNew"},{"content":"Initializes a newly created object.","pos":[3870,3905]},{"content":"Remarks","pos":[3950,3957]},{"pos":[3961,4114],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::InitNew<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690234)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4172,4203],"content":"IPersistStreamInitImpl::IsDirty"},{"content":"Checks whether the object's data has changed since it was last saved.","pos":[4207,4276]},{"content":"Remarks","pos":[4321,4328]},{"pos":[4332,4485],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::IsDirty<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680092)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms680092) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4540,4568],"content":"IPersistStreamInitImpl::Load"},{"content":"Loads the object's properties from the specified stream.","pos":[4572,4628]},{"content":"Remarks","pos":[4683,4690]},{"content":"ATL uses the object's property map to retrieve this information.","pos":[4694,4758]},{"pos":[4765,4915],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::Load<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680730)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4970,4998],"content":"IPersistStreamInitImpl::Save"},{"content":"Saves the object's properties to the specified stream.","pos":[5002,5056]},{"content":"Remarks","pos":[5130,5137]},{"content":"ATL uses the object's property map to store this information.","pos":[5141,5202]},{"pos":[5209,5359],"content":"See <bpt id=\"p1\">[</bpt>IPersistStreamInit::Save<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694439)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistStreamInit::Save](http://msdn.microsoft.com/library/windows/desktop/ms694439) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"See Also","pos":[5368,5376]},{"content":"Storages and Streams","pos":[5381,5401]},{"content":"Class Overview","pos":[5468,5482]}],"content":"---\ntitle: \"IPersistStreamInitImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::IPersistStreamInitImpl\"\n  - \"ATL::IPersistStreamInitImpl<T>\"\n  - \"ATL.IPersistStreamInitImpl<T>\"\n  - \"IPersistStreamInitImpl\"\n  - \"ATL.IPersistStreamInitImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IPersistStreamInit ATL implementation\"\n  - \"IPersistStreamInitImpl class\"\n  - \"streams, ATL\"\nms.assetid: ef217c3c-020f-4cf8-871e-ef68e57865b8\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IPersistStreamInitImpl Class\nThis class implements **IUnknown** and provides a default implementation of the [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n## Syntax  \n  \n```\ntemplate<class T>  class ATL_NO_VTABLE IPersistStreamInitImpl :  public IPersistStreamInit\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `IPersistStreamInitImpl`.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IPersistStreamInitImpl::GetClassID](#ipersiststreaminitimpl__getclassid)|Retrieves the object's CLSID.|  \n|[IPersistStreamInitImpl::GetSizeMax](#ipersiststreaminitimpl__getsizemax)|Retrieves the size of the stream needed to save the object's data. The ATL implementation returns **E_NOTIMPL**.|  \n|[IPersistStreamInitImpl::InitNew](#ipersiststreaminitimpl__initnew)|Initializes a newly created object.|  \n|[IPersistStreamInitImpl::IsDirty](#ipersiststreaminitimpl__isdirty)|Checks whether the object's data has changed since it was last saved.|  \n|[IPersistStreamInitImpl::Load](#ipersiststreaminitimpl__load)|Loads the object's properties from the specified stream.|  \n|[IPersistStreamInitImpl::Save](#ipersiststreaminitimpl__save)|Saves the object's properties to the specified stream.|  \n  \n## Remarks  \n The [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms682273) interface allows a client to request that your object loads and saves its persistent data to a single stream. Class `IPersistStreamInitImpl` provides a default implementation of this interface and implements **IUnknown** by sending information to the dump device in debug builds.  \n  \n **Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)  \n  \n## Inheritance Hierarchy  \n `IPersistStreamInit`  \n  \n `IPersistStreamInitImpl`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ipersiststreaminitimpl__getclassid\"></a>  IPersistStreamInitImpl::GetClassID  \n Retrieves the object's CLSID.  \n  \n```\nSTDMETHOD(GetClassID)(CLSID* pClassID);\n```  \n  \n### Remarks  \n See [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__getsizemax\"></a>  IPersistStreamInitImpl::GetSizeMax  \n Retrieves the size of the stream needed to save the object's data.  \n  \n```\nSTDMETHOD(GetSizeMax)(ULARGE_INTEGER FAR* pcbSize);\n```  \n  \n### Return Value  \n Returns **E_NOTIMPL**.  \n  \n### Remarks  \n See [IPersistStreamInit::GetSizeMax](http://msdn.microsoft.com/library/windows/desktop/ms687287) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__initnew\"></a>  IPersistStreamInitImpl::InitNew  \n Initializes a newly created object.  \n  \n```\nSTDMETHOD(InitNew)();\n```  \n  \n### Remarks  \n See [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__isdirty\"></a>  IPersistStreamInitImpl::IsDirty  \n Checks whether the object's data has changed since it was last saved.  \n  \n```\nSTDMETHOD(IsDirty)();\n```  \n  \n### Remarks  \n See [IPersistStreamInit::IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms680092) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__load\"></a>  IPersistStreamInitImpl::Load  \n Loads the object's properties from the specified stream.  \n  \n```\nSTDMETHOD(Load)(LPSTREAM pStm);\n```  \n  \n### Remarks  \n ATL uses the object's property map to retrieve this information.  \n  \n See [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersiststreaminitimpl__save\"></a>  IPersistStreamInitImpl::Save  \n Saves the object's properties to the specified stream.  \n  \n```\nSTDMETHOD(Save)(LPSTREAM pStm,  BOOL fClearDirty);\n```  \n  \n### Remarks  \n ATL uses the object's property map to store this information.  \n  \n See [IPersistStreamInit::Save](http://msdn.microsoft.com/library/windows/desktop/ms694439) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [Storages and Streams](http://msdn.microsoft.com/library/windows/desktop/aa380352)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}