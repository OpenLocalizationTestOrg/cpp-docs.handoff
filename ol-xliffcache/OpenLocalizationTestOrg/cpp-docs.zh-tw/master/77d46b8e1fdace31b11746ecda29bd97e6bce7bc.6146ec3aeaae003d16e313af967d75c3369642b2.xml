{"nodes":[{"pos":[12,117],"content":"ActiveX Control Containers: Programming ActiveX Controls in an ActiveX Control Container | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ActiveX Control Containers: Programming ActiveX Controls in an ActiveX Control Container | Microsoft Docs","pos":[0,105]}]},{"content":"ActiveX Control Containers: Programming ActiveX Controls in an ActiveX Control Container","pos":[1060,1148]},{"content":"This article describes the process for accessing the exposed <bpt id=\"p1\">[</bpt>methods<ept id=\"p1\">](../mfc/mfc-activex-controls-methods.md)</ept> and <bpt id=\"p2\">[</bpt>properties<ept id=\"p2\">](../mfc/mfc-activex-controls-properties.md)</ept> of embedded ActiveX controls.","pos":[1149,1349],"source":"This article describes the process for accessing the exposed [methods](../mfc/mfc-activex-controls-methods.md) and [properties](../mfc/mfc-activex-controls-properties.md) of embedded ActiveX controls."},{"content":"Basically, you will follow these steps:","pos":[1350,1389]},{"pos":[1399,1544],"content":"<bpt id=\"p1\">[</bpt>Insert an ActiveX control into the ActiveX container project<ept id=\"p1\">](../mfc/inserting-a-control-into-a-control-container-application.md)</ept> using Gallery.","source":"[Insert an ActiveX control into the ActiveX container project](../mfc/inserting-a-control-into-a-control-container-application.md) using Gallery."},{"pos":[1554,1750],"content":"<bpt id=\"p1\">[</bpt>Define a member variable<ept id=\"p1\">](../mfc/activex-control-containers-connecting-an-activex-control-to-a-member-variable.md)</ept> (or other form of access) of the same type as the ActiveX control wrapper class.","source":"[Define a member variable](../mfc/activex-control-containers-connecting-an-activex-control-to-a-member-variable.md) (or other form of access) of the same type as the ActiveX control wrapper class."},{"pos":[1760,1885],"content":"<bpt id=\"p1\">[</bpt>Program the ActiveX control<ept id=\"p1\">](#_core_programming_the_activex_control)</ept> using predefined member functions of the wrapper class.","source":"[Program the ActiveX control](#_core_programming_the_activex_control) using predefined member functions of the wrapper class."},{"content":"For this discussion, assume you've created a dialog-based project (named Container) with ActiveX control support.","pos":[1892,2005]},{"content":"The Circ sample control, Circ, will be added to the resulting project.","pos":[2006,2076]},{"content":"Once the Circ control is inserted into the project (step 1), insert an instance of the Circ control into the application's main dialog box.","pos":[2083,2222]},{"content":"Procedures","pos":[2231,2241]},{"content":"To add the Circ control to the dialog template","pos":[2252,2298]},{"content":"Load the ActiveX control container project.","pos":[2308,2351]},{"content":"For this example, use the <ph id=\"ph1\">`Container`</ph> project.","pos":[2352,2398],"source":" For this example, use the `Container` project."},{"content":"Click the Resource View tab.","pos":[2408,2436]},{"pos":[2446,2473],"content":"Open the <bpt id=\"p1\">**</bpt>Dialog<ept id=\"p1\">**</ept> folder.","source":"Open the **Dialog** folder."},{"content":"Double-click the main dialog box template.","pos":[2483,2525]},{"content":"For this example, use <bpt id=\"p1\">**</bpt>IDD_CONTAINER_DIALOG<ept id=\"p1\">**</ept>.","pos":[2526,2573],"source":" For this example, use **IDD_CONTAINER_DIALOG**."},{"content":"Click the Circ control icon on the Toolbox.","pos":[2583,2626]},{"content":"Click a spot within the dialog box to insert the Circ control.","pos":[2636,2698]},{"pos":[2708,2805],"content":"From the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>Save All<ept id=\"p2\">**</ept> to save all modifications to the dialog box template.","source":"From the **File** menu, choose **Save All** to save all modifications to the dialog box template."},{"content":"Modifications to the Project","pos":[2814,2842]},{"pos":[2846,3089],"content":"To enable the Container application to access the Circ control, Visual C++ automatically adds the wrapper class (<ph id=\"ph1\">`CCirc`</ph>) implementation file (.CPP) to the Container project and the wrapper class header (.H) file to the dialog box header file:","source":"To enable the Container application to access the Circ control, Visual C++ automatically adds the wrapper class (`CCirc`) implementation file (.CPP) to the Container project and the wrapper class header (.H) file to the dialog box header file:"},{"pos":[3107,3123],"content":"NVC_MFC_AxCont#1"},{"pos":[3280,3314],"content":"The Wrapper Class Header (.H) File"},{"content":"To get and set properties (and invoke methods) for the Circ control, the <ph id=\"ph1\">`CCirc`</ph> wrapper class provides a declaration of all exposed methods and properties.","pos":[3318,3474],"source":"To get and set properties (and invoke methods) for the Circ control, the `CCirc` wrapper class provides a declaration of all exposed methods and properties."},{"content":"In the example, these declarations are found in CIRC.H.","pos":[3475,3530]},{"content":"The following sample is the portion of class <ph id=\"ph1\">`CCirc`</ph> that defines the exposed interfaces of the ActiveX control:","pos":[3531,3643],"source":" The following sample is the portion of class `CCirc` that defines the exposed interfaces of the ActiveX control:"},{"content":"NVC_MFC_AxCont#2","pos":[3661,3677]},{"content":"NVC_MFC_AxCont#3","pos":[3781,3797]},{"content":"These functions can then be called from other of the application's procedures using normal C++ syntax.","pos":[3894,3996]},{"content":"For more information on using this member function set to access the control's methods and properties, see the section <bpt id=\"p1\">[</bpt>Programming the ActiveX control<ept id=\"p1\">](#_core_programming_the_activex_control)</ept>.","pos":[3997,4190],"source":" For more information on using this member function set to access the control's methods and properties, see the section [Programming the ActiveX control](#_core_programming_the_activex_control)."},{"pos":[4266,4310],"content":"Member Variable Modifications to the Project"},{"content":"Once the ActiveX control has been added to the project and embedded in a dialog box container, it can be accessed by other parts of the project.","pos":[4314,4458]},{"content":"The easiest way to access the control is to <bpt id=\"p1\">[</bpt>create a member variable<ept id=\"p1\">](../mfc/activex-control-containers-connecting-an-activex-control-to-a-member-variable.md)</ept> of the dialog class, <ph id=\"ph1\">`CContainerDlg`</ph> (step 2), that is of the same type as the wrapper class added to the project by Visual C++.","pos":[4459,4747],"source":" The easiest way to access the control is to [create a member variable](../mfc/activex-control-containers-connecting-an-activex-control-to-a-member-variable.md) of the dialog class, `CContainerDlg` (step 2), that is of the same type as the wrapper class added to the project by Visual C++."},{"content":"You can then use the member variable to access the embedded control at any time.","pos":[4748,4828]},{"pos":[4835,5018],"content":"When the <bpt id=\"p1\">**</bpt>Add Member Variable<ept id=\"p1\">**</ept> dialog box adds the <ph id=\"ph1\">`m_circctl`</ph> member variable to the project, it also adds the following lines to the header file (.H) of the <ph id=\"ph2\">`CContainerDlg`</ph> class:","source":"When the **Add Member Variable** dialog box adds the `m_circctl` member variable to the project, it also adds the following lines to the header file (.H) of the `CContainerDlg` class:"},{"content":"NVC_MFC_AxCont#4","pos":[5036,5052]},{"content":"NVC_MFC_AxCont#5","pos":[5156,5172]},{"pos":[5269,5391],"content":"In addition, a call to <bpt id=\"p1\">**</bpt>DDX_Control<ept id=\"p1\">**</ept> is automatically added to the <ph id=\"ph1\">`CContainerDlg`</ph>'s implementation of <ph id=\"ph2\">`DoDataExchange`</ph>:","source":"In addition, a call to **DDX_Control** is automatically added to the `CContainerDlg`'s implementation of `DoDataExchange`:"},{"pos":[5409,5425],"content":"NVC_MFC_AxCont#6"},{"pos":[5580,5611],"content":"Programming the ActiveX Control"},{"content":"At this point, you have inserted the ActiveX control into your dialog template and created a member variable for it.","pos":[5615,5731]},{"content":"You can now use common C++ syntax to access the properties and methods of the embedded control.","pos":[5732,5827]},{"content":"As noted (in <bpt id=\"p1\">[</bpt>The Wrapper Class Header (.H) File<ept id=\"p1\">](#_core_the_wrapper_class_header_28h29_file)</ept>), the header file (.H) for the <ph id=\"ph1\">`CCirc`</ph> wrapper class, in this case CIRC.H, contains a list of member functions that you can use to get and set any exposed property value.","pos":[5834,6098],"source":"As noted (in [The Wrapper Class Header (.H) File](#_core_the_wrapper_class_header_28h29_file)), the header file (.H) for the `CCirc` wrapper class, in this case CIRC.H, contains a list of member functions that you can use to get and set any exposed property value."},{"content":"Member functions for exposed methods are also available.","pos":[6099,6155]},{"content":"A common place to modify the control's properties is in the <ph id=\"ph1\">`OnInitDialog`</ph> member function of the main dialog class.","pos":[6162,6278],"source":"A common place to modify the control's properties is in the `OnInitDialog` member function of the main dialog class."},{"content":"This function is called just before the dialog box appears and is used to initialize its contents, including any of its controls.","pos":[6279,6408]},{"pos":[6415,6557],"content":"The following code example uses the <ph id=\"ph1\">`m_circctl`</ph> member variable to modify the Caption and CircleShape properties of the embedded Circ control:","source":"The following code example uses the `m_circctl` member variable to modify the Caption and CircleShape properties of the embedded Circ control:"},{"pos":[6575,6591],"content":"NVC_MFC_AxCont#7"},{"content":"See Also","pos":[6692,6700]},{"content":"ActiveX Control Containers","pos":[6705,6731]}],"content":"---\ntitle: \"ActiveX Control Containers: Programming ActiveX Controls in an ActiveX Control Container | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ActiveX control containers [C++], accessing ActiveX controls\"\n  - \"Confirm Classes dialog box\"\n  - \"wrapper classes [C++], ActiveX controls\"\n  - \"ActiveX control containers [C++], wrapper classes\"\n  - \"ActiveX controls [C++], accessing\"\n  - \"MFC ActiveX controls [C++], accessing in containers\"\n  - \"header files [C++], for ActiveX control wrapper class\"\n  - \"wrapper classes [C++], using\"\n  - \"ActiveX controls [C++], wrapper classes\"\nms.assetid: ef9b2480-92d6-4191-b16e-8055c4fd7b73\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# ActiveX Control Containers: Programming ActiveX Controls in an ActiveX Control Container\nThis article describes the process for accessing the exposed [methods](../mfc/mfc-activex-controls-methods.md) and [properties](../mfc/mfc-activex-controls-properties.md) of embedded ActiveX controls. Basically, you will follow these steps:  \n  \n1.  [Insert an ActiveX control into the ActiveX container project](../mfc/inserting-a-control-into-a-control-container-application.md) using Gallery.  \n  \n2.  [Define a member variable](../mfc/activex-control-containers-connecting-an-activex-control-to-a-member-variable.md) (or other form of access) of the same type as the ActiveX control wrapper class.  \n  \n3.  [Program the ActiveX control](#_core_programming_the_activex_control) using predefined member functions of the wrapper class.  \n  \n For this discussion, assume you've created a dialog-based project (named Container) with ActiveX control support. The Circ sample control, Circ, will be added to the resulting project.  \n  \n Once the Circ control is inserted into the project (step 1), insert an instance of the Circ control into the application's main dialog box.  \n  \n## Procedures  \n  \n#### To add the Circ control to the dialog template  \n  \n1.  Load the ActiveX control container project. For this example, use the `Container` project.  \n  \n2.  Click the Resource View tab.  \n  \n3.  Open the **Dialog** folder.  \n  \n4.  Double-click the main dialog box template. For this example, use **IDD_CONTAINER_DIALOG**.  \n  \n5.  Click the Circ control icon on the Toolbox.  \n  \n6.  Click a spot within the dialog box to insert the Circ control.  \n  \n7.  From the **File** menu, choose **Save All** to save all modifications to the dialog box template.  \n  \n## Modifications to the Project  \n To enable the Container application to access the Circ control, Visual C++ automatically adds the wrapper class (`CCirc`) implementation file (.CPP) to the Container project and the wrapper class header (.H) file to the dialog box header file:  \n  \n [!code-cpp[NVC_MFC_AxCont#1](../mfc/codesnippet/cpp/programming-activex-controls-in-a-activex-control-container_1.h)]  \n  \n##  <a name=\"_core_the_wrapper_class_header_28h29_file\"></a> The Wrapper Class Header (.H) File  \n To get and set properties (and invoke methods) for the Circ control, the `CCirc` wrapper class provides a declaration of all exposed methods and properties. In the example, these declarations are found in CIRC.H. The following sample is the portion of class `CCirc` that defines the exposed interfaces of the ActiveX control:  \n  \n [!code-cpp[NVC_MFC_AxCont#2](../mfc/codesnippet/cpp/programming-activex-controls-in-a-activex-control-container_2.h)]  \n[!code-cpp[NVC_MFC_AxCont#3](../mfc/codesnippet/cpp/programming-activex-controls-in-a-activex-control-container_3.h)]  \n  \n These functions can then be called from other of the application's procedures using normal C++ syntax. For more information on using this member function set to access the control's methods and properties, see the section [Programming the ActiveX control](#_core_programming_the_activex_control).  \n  \n##  <a name=\"_core_member_variable_modifications_to_the_project\"></a> Member Variable Modifications to the Project  \n Once the ActiveX control has been added to the project and embedded in a dialog box container, it can be accessed by other parts of the project. The easiest way to access the control is to [create a member variable](../mfc/activex-control-containers-connecting-an-activex-control-to-a-member-variable.md) of the dialog class, `CContainerDlg` (step 2), that is of the same type as the wrapper class added to the project by Visual C++. You can then use the member variable to access the embedded control at any time.  \n  \n When the **Add Member Variable** dialog box adds the `m_circctl` member variable to the project, it also adds the following lines to the header file (.H) of the `CContainerDlg` class:  \n  \n [!code-cpp[NVC_MFC_AxCont#4](../mfc/codesnippet/cpp/programming-activex-controls-in-a-activex-control-container_4.h)]  \n[!code-cpp[NVC_MFC_AxCont#5](../mfc/codesnippet/cpp/programming-activex-controls-in-a-activex-control-container_5.h)]  \n  \n In addition, a call to **DDX_Control** is automatically added to the `CContainerDlg`'s implementation of `DoDataExchange`:  \n  \n [!code-cpp[NVC_MFC_AxCont#6](../mfc/codesnippet/cpp/programming-activex-controls-in-a-activex-control-container_6.cpp)]  \n  \n##  <a name=\"_core_programming_the_activex_control\"></a> Programming the ActiveX Control  \n At this point, you have inserted the ActiveX control into your dialog template and created a member variable for it. You can now use common C++ syntax to access the properties and methods of the embedded control.  \n  \n As noted (in [The Wrapper Class Header (.H) File](#_core_the_wrapper_class_header_28h29_file)), the header file (.H) for the `CCirc` wrapper class, in this case CIRC.H, contains a list of member functions that you can use to get and set any exposed property value. Member functions for exposed methods are also available.  \n  \n A common place to modify the control's properties is in the `OnInitDialog` member function of the main dialog class. This function is called just before the dialog box appears and is used to initialize its contents, including any of its controls.  \n  \n The following code example uses the `m_circctl` member variable to modify the Caption and CircleShape properties of the embedded Circ control:  \n  \n [!code-cpp[NVC_MFC_AxCont#7](../mfc/codesnippet/cpp/programming-activex-controls-in-a-activex-control-container_7.cpp)]  \n  \n## See Also  \n [ActiveX Control Containers](../mfc/activex-control-containers.md)\n\n"}