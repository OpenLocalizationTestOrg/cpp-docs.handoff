{"nodes":[{"pos":[12,62],"content":"Menus and Resources: Menu Merging | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Menus and Resources: Menu Merging | Microsoft Docs","pos":[0,50]}]},{"content":"Menus and Resources: Menu Merging","pos":[867,900]},{"content":"This article details the steps necessary for OLE document applications to handle visual editing and in-place activation properly.","pos":[901,1030]},{"content":"In-place activation poses a challenge for both container and server (component) applications.","pos":[1031,1124]},{"content":"The user remains in the same frame window (within the context of the container document) but is actually running another application (the server).","pos":[1125,1271]},{"content":"This requires coordination between the resources of the container and server applications.","pos":[1272,1362]},{"content":"Topics covered in this article include:","pos":[1369,1408]},{"content":"Menu Layouts","pos":[1417,1429]},{"content":"Toolbars and Status Bars","pos":[1460,1484]},{"pos":[1562,1574],"content":"Menu Layouts"},{"content":"The first step is to coordinate menu layouts.","pos":[1578,1623]},{"content":"For more information, see the <bpt id=\"p1\">**</bpt>Menu Creation<ept id=\"p1\">**</ept> section in <bpt id=\"p2\">[</bpt>Menu Programming Considerations<ept id=\"p2\">](https://msdn.microsoft.com/library/ms647557.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]</ph>.","pos":[1624,1823],"source":" For more information, see the **Menu Creation** section in [Menu Programming Considerations](https://msdn.microsoft.com/library/ms647557.aspx) in the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]."},{"content":"Container applications should create a new menu to be used only when embedded items are activated in place.","pos":[1830,1937]},{"content":"At the minimum, this menu should consist of the following, in the order listed:","pos":[1938,2017]},{"content":"File menu identical to the one used when files are open.","pos":[2027,2083]},{"content":"(Usually no other menu items are placed before the next item.)","pos":[2084,2146]},{"content":"Two consecutive separators.","pos":[2156,2183]},{"content":"Window menu identical to the one used when files are open (only if the container application in an MDI application).","pos":[2193,2309]},{"content":"Some applications may have other menus, such as an Options menu, that belong in this group, which remains on the menu when an embedded item is activated in place.","pos":[2310,2472]},{"pos":[2484,2664],"content":"[!NOTE]\n There may be other menus that affect the view of the container document, such as Zoom. These container menus appear between the two separators in this menu resource.","leadings":["","    > "],"nodes":[{"content":" There may be other menus that affect the view of the container document, such as Zoom. These container menus appear between the two separators in this menu resource.","pos":[8,174],"nodes":[{"content":"There may be other menus that affect the view of the container document, such as Zoom.","pos":[1,87]},{"content":"These container menus appear between the two separators in this menu resource.","pos":[88,166]}]}]},{"content":"Server (component) applications should also create a new menu specifically for in-place activation.","pos":[2671,2770]},{"content":"It should be like the menu used when files are open, but without menu items, such as File and Window that manipulate the server document instead of the data.","pos":[2771,2928]},{"content":"Typically, this menu consists of the following:","pos":[2929,2976]},{"content":"Edit menu identical to the one used when files are open.","pos":[2986,3042]},{"content":"Separator.","pos":[3052,3062]},{"content":"Object editing menus, such as the Pen menu in the Scribble sample application.","pos":[3072,3150]},{"content":"Separator.","pos":[3160,3170]},{"content":"Help menu.","pos":[3180,3190]},{"content":"For an example, look at the layout of some sample in-place menus for a container and a server.","pos":[3197,3291]},{"content":"The details of each menu item have been removed to make the example clearer.","pos":[3292,3368]},{"content":"The container's in-place menu has the following entries:","pos":[3369,3425]},{"content":"The consecutive separators indicate where the first part of the server's menu should go.","pos":[3662,3750]},{"content":"Now look at the server's in-place menu:","pos":[3751,3790]},{"content":"The separators here indicate where the second group of container menu items should go.","pos":[3998,4084]},{"content":"The resulting menu structure when an object from this server is activated in place inside this container looks like this:","pos":[4085,4206]},{"content":"As you can see, the separators have been replaced with the different groups of each application's menu.","pos":[4409,4512]},{"content":"Accelerator tables associated with the in-place menu should also be supplied by the server application.","pos":[4519,4622]},{"content":"The container will incorporate them into its own accelerator tables.","pos":[4623,4691]},{"content":"When an embedded item is activated in place, the framework loads the in-place menu.","pos":[4698,4781]},{"content":"It then asks the server application for its menu for in-place activation and inserts it where the separators are.","pos":[4782,4895]},{"content":"This is how the menus combine.","pos":[4896,4926]},{"content":"You get menus from the container for operating on the file and window placement, and you get menus from the server for operating on the item.","pos":[4927,5068]},{"pos":[5124,5148],"content":"Toolbars and Status Bars"},{"content":"Server applications should create a new toolbar and store its bitmap in a separate file.","pos":[5152,5240]},{"content":"The application wizardâ€“generated applications store this bitmap in a file called ITOOLBAR.BMP.","pos":[5241,5335]},{"content":"The new toolbar replaces the container application's toolbar when your server's item is activated in place, and should contain the same items as your normal toolbar, but remove icons representing items on the File and Window menus.","pos":[5336,5567]},{"content":"This toolbar is loaded in your <ph id=\"ph1\">`COleIPFrameWnd`</ph>-derived class, created for you by the application wizard.","pos":[5574,5679],"source":"This toolbar is loaded in your `COleIPFrameWnd`-derived class, created for you by the application wizard."},{"content":"The status bar is handled by the container application.","pos":[5680,5735]},{"content":"For more information on the implementation of in-place frame windows, see <bpt id=\"p1\">[</bpt>Servers: Implementing a Server<ept id=\"p1\">](../mfc/servers-implementing-a-server.md)</ept>.","pos":[5736,5884],"source":" For more information on the implementation of in-place frame windows, see [Servers: Implementing a Server](../mfc/servers-implementing-a-server.md)."},{"content":"See Also","pos":[5893,5901]},{"content":"Menus and Resources (OLE)","pos":[5906,5931]},{"content":"Activation","pos":[5973,5983]},{"content":"Servers","pos":[6016,6023]},{"content":"Containers","pos":[6049,6059]}],"content":"---\ntitle: \"Menus and Resources: Menu Merging | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"status bars, OLE document applications\"\n  - \"visual editing, application menus and resources\"\n  - \"coordinating menu layouts\"\n  - \"OLE containers, menus and resources\"\n  - \"toolbars [C++], OLE document applications\"\n  - \"merging toolbar and status bar\"\n  - \"menus [C++], OLE document applications\"\nms.assetid: 80b6bb17-d830-4122-83f0-651fc112d4d1\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Menus and Resources: Menu Merging\nThis article details the steps necessary for OLE document applications to handle visual editing and in-place activation properly. In-place activation poses a challenge for both container and server (component) applications. The user remains in the same frame window (within the context of the container document) but is actually running another application (the server). This requires coordination between the resources of the container and server applications.  \n  \n Topics covered in this article include:  \n  \n- [Menu Layouts](#_core_menu_layouts)  \n  \n- [Toolbars and Status Bars](#_core_toolbars_and_status_bars)  \n  \n##  <a name=\"_core_menu_layouts\"></a> Menu Layouts  \n The first step is to coordinate menu layouts. For more information, see the **Menu Creation** section in [Menu Programming Considerations](https://msdn.microsoft.com/library/ms647557.aspx) in the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)].  \n  \n Container applications should create a new menu to be used only when embedded items are activated in place. At the minimum, this menu should consist of the following, in the order listed:  \n  \n1.  File menu identical to the one used when files are open. (Usually no other menu items are placed before the next item.)  \n  \n2.  Two consecutive separators.  \n  \n3.  Window menu identical to the one used when files are open (only if the container application in an MDI application). Some applications may have other menus, such as an Options menu, that belong in this group, which remains on the menu when an embedded item is activated in place.  \n  \n    > [!NOTE]\n    >  There may be other menus that affect the view of the container document, such as Zoom. These container menus appear between the two separators in this menu resource.  \n  \n Server (component) applications should also create a new menu specifically for in-place activation. It should be like the menu used when files are open, but without menu items, such as File and Window that manipulate the server document instead of the data. Typically, this menu consists of the following:  \n  \n1.  Edit menu identical to the one used when files are open.  \n  \n2.  Separator.  \n  \n3.  Object editing menus, such as the Pen menu in the Scribble sample application.  \n  \n4.  Separator.  \n  \n5.  Help menu.  \n  \n For an example, look at the layout of some sample in-place menus for a container and a server. The details of each menu item have been removed to make the example clearer. The container's in-place menu has the following entries:  \n  \n```  \nIDR_CONTAINERTYPE_CNTR_IP MENU PRELOAD DISCARDABLE   \nBEGIN  \n    POPUP \"&File C1\"  \n    MENUITEM SEPARATOR  \n    POPUP \"&Zoom C2\"  \n    MENUITEM SEPARATOR  \n    POPUP \"&Options C3\"  \n    POPUP \"&Window C3\"  \nEND  \n```  \n  \n The consecutive separators indicate where the first part of the server's menu should go. Now look at the server's in-place menu:  \n  \n```  \nIDR_SERVERTYPE_SRVR_IP MENU PRELOAD DISCARDABLE   \nBEGIN  \n    POPUP \"&Edit S1\"  \n    MENUITEM SEPARATOR  \n    POPUP \"&Format S2\"  \n    MENUITEM SEPARATOR  \n    POPUP \"&Help S3\"  \nEND  \n```  \n  \n The separators here indicate where the second group of container menu items should go. The resulting menu structure when an object from this server is activated in place inside this container looks like this:  \n  \n```  \nBEGIN  \n    POPUP \"&File C1\"  \n    POPUP \"&Edit S1\"  \n    POPUP \"&Zoom C2\"  \n    POPUP \"&Format S2\"  \n    POPUP \"&Options C3  \n    POPUP \"&Window C3\"  \n    POPUP \"&Help S3\"  \nEND  \n```  \n  \n As you can see, the separators have been replaced with the different groups of each application's menu.  \n  \n Accelerator tables associated with the in-place menu should also be supplied by the server application. The container will incorporate them into its own accelerator tables.  \n  \n When an embedded item is activated in place, the framework loads the in-place menu. It then asks the server application for its menu for in-place activation and inserts it where the separators are. This is how the menus combine. You get menus from the container for operating on the file and window placement, and you get menus from the server for operating on the item.  \n  \n##  <a name=\"_core_toolbars_and_status_bars\"></a> Toolbars and Status Bars  \n Server applications should create a new toolbar and store its bitmap in a separate file. The application wizardâ€“generated applications store this bitmap in a file called ITOOLBAR.BMP. The new toolbar replaces the container application's toolbar when your server's item is activated in place, and should contain the same items as your normal toolbar, but remove icons representing items on the File and Window menus.  \n  \n This toolbar is loaded in your `COleIPFrameWnd`-derived class, created for you by the application wizard. The status bar is handled by the container application. For more information on the implementation of in-place frame windows, see [Servers: Implementing a Server](../mfc/servers-implementing-a-server.md).  \n  \n## See Also  \n [Menus and Resources (OLE)](../mfc/menus-and-resources-ole.md)   \n [Activation](../mfc/activation-cpp.md)   \n [Servers](../mfc/servers.md)   \n [Containers](../mfc/containers.md)\n\n"}