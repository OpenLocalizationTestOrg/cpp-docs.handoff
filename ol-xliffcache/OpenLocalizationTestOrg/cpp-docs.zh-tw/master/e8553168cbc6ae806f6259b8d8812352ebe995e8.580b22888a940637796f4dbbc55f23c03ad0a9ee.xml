{"nodes":[{"pos":[12,46],"content":"CMetaFileDC Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMetaFileDC Class | Microsoft Docs","pos":[0,34]}]},{"content":"CMetaFileDC Class","pos":[667,684]},{"content":"Implements a Windows metafile, which contains a sequence of graphics device interface (GDI) commands that you can replay to create a desired image or text.","pos":[685,840]},{"content":"Syntax","pos":[849,855]},{"content":"Members","pos":[912,919]},{"content":"Public Constructors","pos":[929,948]},{"content":"Name","pos":[955,959]},{"content":"Description","pos":[960,971]},{"content":"CMetaFileDC::CMetaFileDC","pos":[1010,1034]},{"pos":[1063,1097],"content":"Constructs a <ph id=\"ph1\">`CMetaFileDC`</ph> object.","source":"Constructs a `CMetaFileDC` object."},{"content":"Public Methods","pos":[1108,1122]},{"content":"Name","pos":[1129,1133]},{"content":"Description","pos":[1134,1145]},{"content":"CMetaFileDC::Close","pos":[1184,1202]},{"content":"Closes the device context and creates a metafile handle.","pos":[1225,1281]},{"content":"CMetaFileDC::CloseEnhanced","pos":[1287,1313]},{"content":"Closes an enhanced-metafile device context and creates an enhanced-metafile handle.","pos":[1344,1427]},{"content":"CMetaFileDC::Create","pos":[1433,1452]},{"pos":[1476,1564],"content":"Creates the Windows metafile device context and attaches it to the <ph id=\"ph1\">`CMetaFileDC`</ph> object.","source":"Creates the Windows metafile device context and attaches it to the `CMetaFileDC` object."},{"content":"CMetaFileDC::CreateEnhanced","pos":[1570,1597]},{"content":"Creates a metafile device context for an enhanced-format metafile.","pos":[1629,1695]},{"content":"Remarks","pos":[1705,1712]},{"content":"To implement a Windows metafile, first create a <ph id=\"ph1\">`CMetaFileDC`</ph> object.","pos":[1716,1785],"source":"To implement a Windows metafile, first create a `CMetaFileDC` object."},{"content":"Invoke the <ph id=\"ph1\">`CMetaFileDC`</ph> constructor, then call the <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cmetafiledc__create)</ept> member function, which creates a Windows metafile device context and attaches it to the <ph id=\"ph2\">`CMetaFileDC`</ph> object.","pos":[1786,1978],"source":" Invoke the `CMetaFileDC` constructor, then call the [Create](#cmetafiledc__create) member function, which creates a Windows metafile device context and attaches it to the `CMetaFileDC` object."},{"content":"Next send the <ph id=\"ph1\">`CMetaFileDC`</ph> object the sequence of <ph id=\"ph2\">`CDC`</ph> GDI commands that you intend for it to replay.","pos":[1985,2088],"source":"Next send the `CMetaFileDC` object the sequence of `CDC` GDI commands that you intend for it to replay."},{"content":"Only those GDI commands that create output, such as <ph id=\"ph1\">`MoveTo`</ph> and <ph id=\"ph2\">`LineTo`</ph>, can be used.","pos":[2089,2176],"source":" Only those GDI commands that create output, such as `MoveTo` and `LineTo`, can be used."},{"content":"After you have sent the desired commands to the metafile, call the <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> member function, which closes the metafile device contexts and returns a metafile handle.","pos":[2183,2349],"source":"After you have sent the desired commands to the metafile, call the **Close** member function, which closes the metafile device contexts and returns a metafile handle."},{"content":"Then dispose of the <ph id=\"ph1\">`CMetaFileDC`</ph> object.","pos":[2350,2391],"source":" Then dispose of the `CMetaFileDC` object."},{"content":"<bpt id=\"p1\">[</bpt>CDC::PlayMetaFile<ept id=\"p1\">](../../mfc/reference/cdc-class.md#cdc__playmetafile)</ept> can then use the metafile handle to play the metafile repeatedly.","pos":[2398,2535],"source":"[CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#cdc__playmetafile) can then use the metafile handle to play the metafile repeatedly."},{"content":"The metafile can also be manipulated by Windows functions such as <bpt id=\"p1\">[</bpt>CopyMetaFile<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183480)</ept>, which copies a metafile to disk.","pos":[2536,2710],"source":" The metafile can also be manipulated by Windows functions such as [CopyMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183480), which copies a metafile to disk."},{"pos":[2717,2881],"content":"When the metafile is no longer needed, delete it from memory with the <bpt id=\"p1\">[</bpt>DeleteMetaFile<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183537)</ept> Windows function.","source":"When the metafile is no longer needed, delete it from memory with the [DeleteMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183537) Windows function."},{"content":"You can also implement the <ph id=\"ph1\">`CMetaFileDC`</ph> object so that it can handle both output calls and attribute GDI calls such as <ph id=\"ph2\">`GetTextExtent`</ph>.","pos":[2888,3024],"source":"You can also implement the `CMetaFileDC` object so that it can handle both output calls and attribute GDI calls such as `GetTextExtent`."},{"content":"Such a metafile is more flexible and can more easily reuse general GDI code, which often consists of a mix of output and attribute calls.","pos":[3025,3162]},{"content":"The <ph id=\"ph1\">`CMetaFileDC`</ph> class inherits two device contexts, <ph id=\"ph2\">`m_hDC`</ph> and <ph id=\"ph3\">`m_hAttribDC`</ph>, from <ph id=\"ph4\">`CDC`</ph>.","pos":[3163,3255],"source":" The `CMetaFileDC` class inherits two device contexts, `m_hDC` and `m_hAttribDC`, from `CDC`."},{"content":"The <ph id=\"ph1\">`m_hDC`</ph> device context handles all <bpt id=\"p1\">[</bpt>CDC<ept id=\"p1\">](../../mfc/reference/cdc-class.md)</ept> GDI output calls and the <ph id=\"ph2\">`m_hAttribDC`</ph> device context handles all <ph id=\"ph3\">`CDC`</ph> GDI attribute calls.","pos":[3256,3427],"source":" The `m_hDC` device context handles all [CDC](../../mfc/reference/cdc-class.md) GDI output calls and the `m_hAttribDC` device context handles all `CDC` GDI attribute calls."},{"content":"Normally, these two device contexts refer to the same device.","pos":[3428,3489]},{"content":"In the case of <ph id=\"ph1\">`CMetaFileDC`</ph>, the attribute DC is set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> by default.","pos":[3490,3567],"source":" In the case of `CMetaFileDC`, the attribute DC is set to **NULL** by default."},{"content":"Create a second device context that points to the screen, a printer, or device other than a metafile, then call the <ph id=\"ph1\">`SetAttribDC`</ph> member function to associate the new device context with <ph id=\"ph2\">`m_hAttribDC`</ph>.","pos":[3574,3775],"source":"Create a second device context that points to the screen, a printer, or device other than a metafile, then call the `SetAttribDC` member function to associate the new device context with `m_hAttribDC`."},{"content":"GDI calls for information will now be directed to the new <ph id=\"ph1\">`m_hAttribDC`</ph>.","pos":[3776,3848],"source":" GDI calls for information will now be directed to the new `m_hAttribDC`."},{"content":"Output GDI calls will go to <ph id=\"ph1\">`m_hDC`</ph>, which represents the metafile.","pos":[3849,3916],"source":" Output GDI calls will go to `m_hDC`, which represents the metafile."},{"pos":[3923,4014],"content":"For more information on <ph id=\"ph1\">`CMetaFileDC`</ph>, see <bpt id=\"p1\">[</bpt>Device Contexts<ept id=\"p1\">](../../mfc/device-contexts.md)</ept>.","source":"For more information on `CMetaFileDC`, see [Device Contexts](../../mfc/device-contexts.md)."},{"content":"Inheritance Hierarchy","pos":[4023,4044]},{"content":"CObject","pos":[4049,4056]},{"content":"CDC","pos":[4103,4106]},{"content":"Requirements","pos":[4170,4182]},{"pos":[4186,4206],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxext.h","source":"**Header:** afxext.h"},{"pos":[4251,4269],"content":"CMetaFileDC::Close"},{"pos":[4273,4485],"content":"Closes the metafile device context and creates a Windows metafile handle that can be used to play the metafile by using the <bpt id=\"p1\">[</bpt>CDC::PlayMetaFile<ept id=\"p1\">](../../mfc/reference/cdc-class.md#cdc__playmetafile)</ept> member function.","source":"Closes the metafile device context and creates a Windows metafile handle that can be used to play the metafile by using the [CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#cdc__playmetafile) member function."},{"content":"Return Value","pos":[4529,4541]},{"pos":[4545,4617],"content":"A valid <bpt id=\"p1\">**</bpt>HMETAFILE<ept id=\"p1\">**</ept> if the function is successful; otherwise <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","source":"A valid **HMETAFILE** if the function is successful; otherwise **NULL**."},{"content":"Remarks","pos":[4627,4634]},{"pos":[4638,4816],"content":"The Windows metafile handle can also be used to manipulate the metafile with Windows functions such as <bpt id=\"p1\">[</bpt>CopyMetaFile<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183480)</ept>.","source":"The Windows metafile handle can also be used to manipulate the metafile with Windows functions such as [CopyMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183480)."},{"pos":[4823,4962],"content":"Delete the metafile after use by calling the Windows <bpt id=\"p1\">[</bpt>DeleteMetaFile<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183537)</ept> function.","source":"Delete the metafile after use by calling the Windows [DeleteMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183537) function."},{"pos":[5015,5041],"content":"CMetaFileDC::CloseEnhanced"},{"content":"Closes an enhanced-metafile device context and returns a handle that identifies an enhanced-format metafile.","pos":[5045,5153]},{"content":"Return Value","pos":[5208,5220]},{"pos":[5224,5292],"content":"A handle of an enhanced metafile, if successful; otherwise <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"A handle of an enhanced metafile, if successful; otherwise **NULL**."},{"content":"Remarks","pos":[5302,5309]},{"content":"An application can use the enhanced-metafile handle returned by this function to perform the following tasks:","pos":[5313,5422]},{"content":"Display a picture stored in an enhanced metafile","pos":[5432,5480]},{"content":"Create copies of the enhanced metafile","pos":[5490,5528]},{"content":"Enumerate, edit, or copy individual records in the enhanced metafile","pos":[5538,5606]},{"content":"Retrieve an optional description of the metafile contents from the enhanced-metafile header","pos":[5616,5707]},{"content":"Retrieve a copy of the enhanced-metafile header","pos":[5717,5764]},{"content":"Retrieve a binary copy of the enhanced metafile","pos":[5774,5821]},{"content":"Enumerate the colors in the optional palette","pos":[5831,5875]},{"content":"Convert an enhanced-format metafile into a Windows-format metafile","pos":[5885,5951]},{"pos":[5958,6106],"content":"When the application no longer needs the enhanced metafile handle, it should release the handle by calling the Win32 <bpt id=\"p1\">**</bpt>DeleteEnhMetaFile<ept id=\"p1\">**</ept> function.","source":"When the application no longer needs the enhanced metafile handle, it should release the handle by calling the Win32 **DeleteEnhMetaFile** function."},{"pos":[6157,6181],"content":"CMetaFileDC::CMetaFileDC"},{"pos":[6185,6231],"content":"Construct a <ph id=\"ph1\">`CMetaFileDC`</ph> object in two steps.","source":"Construct a `CMetaFileDC` object in two steps."},{"content":"Remarks","pos":[6271,6278]},{"pos":[6282,6425],"content":"First, call <ph id=\"ph1\">`CMetaFileDC`</ph>, then call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>, which creates the Windows metafile device context and attaches it to the <ph id=\"ph2\">`CMetaFileDC`</ph> object.","source":"First, call `CMetaFileDC`, then call **Create**, which creates the Windows metafile device context and attaches it to the `CMetaFileDC` object."},{"pos":[6471,6490],"content":"CMetaFileDC::Create"},{"pos":[6494,6540],"content":"Construct a <ph id=\"ph1\">`CMetaFileDC`</ph> object in two steps.","source":"Construct a `CMetaFileDC` object in two steps."},{"content":"Parameters","pos":[6607,6617]},{"content":"lpszFilename","pos":[6622,6634]},{"content":"Points to a null-terminated character string.","pos":[6639,6684]},{"content":"Specifies the filename of the metafile to create.","pos":[6685,6734]},{"content":"If <bpt id=\"p1\">*</bpt>lpszFilename<ept id=\"p1\">*</ept> is <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>, a new in-memory metafile is created.","pos":[6735,6802],"source":" If *lpszFilename* is **NULL**, a new in-memory metafile is created."},{"content":"Return Value","pos":[6812,6824]},{"content":"Nonzero if the function is successful; otherwise 0.","pos":[6828,6879]},{"content":"Remarks","pos":[6889,6896]},{"pos":[6900,7059],"content":"First, call the constructor <ph id=\"ph1\">`CMetaFileDC`</ph>, then call <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>, which creates the Windows metafile device context and attaches it to the <ph id=\"ph2\">`CMetaFileDC`</ph> object.","source":"First, call the constructor `CMetaFileDC`, then call **Create**, which creates the Windows metafile device context and attaches it to the `CMetaFileDC` object."},{"pos":[7113,7140],"content":"CMetaFileDC::CreateEnhanced"},{"content":"Creates a device context for an enhanced-format metafile.","pos":[7144,7201]},{"content":"Parameters","pos":[7348,7358]},{"content":"Identifies a reference device for the enhanced metafile.","pos":[7374,7430]},{"content":"Points to a null-terminated character string.","pos":[7455,7500]},{"content":"Specifies the filename for the enhanced metafile to be created.","pos":[7501,7564]},{"content":"If this parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the enhanced metafile is memory based and its contents lost when the object is destroyed or when the Win32 <bpt id=\"p2\">**</bpt>DeleteEnhMetaFile<ept id=\"p2\">**</ept> function is called.","pos":[7565,7744],"source":" If this parameter is **NULL**, the enhanced metafile is memory based and its contents lost when the object is destroyed or when the Win32 **DeleteEnhMetaFile** function is called."},{"content":"Points to a <bpt id=\"p1\">[</bpt>RECT<ept id=\"p1\">](../../mfc/reference/rect-structure1.md)</ept> data structure or a <bpt id=\"p2\">[</bpt>CRect<ept id=\"p2\">](../../atl-mfc-shared/reference/crect-class.md)</ept> object that specifies the dimensions in <bpt id=\"p3\">**</bpt>HIMETRIC<ept id=\"p3\">**</ept> units (in .01-millimeter increments) of the picture to be stored in the enhanced metafile.","pos":[7765,8042],"source":" Points to a [RECT](../../mfc/reference/rect-structure1.md) data structure or a [CRect](../../atl-mfc-shared/reference/crect-class.md) object that specifies the dimensions in **HIMETRIC** units (in .01-millimeter increments) of the picture to be stored in the enhanced metafile."},{"content":"Points to a zero-terminated string that specifies the name of the application that created the picture, as well as the picture's title.","pos":[8070,8205]},{"content":"Return Value","pos":[8215,8227]},{"pos":[8231,8323],"content":"A handle of the device context for the enhanced metafile, if successful; otherwise <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","source":"A handle of the device context for the enhanced metafile, if successful; otherwise **NULL**."},{"content":"Remarks","pos":[8333,8340]},{"content":"This DC can be used to store a device-independent picture.","pos":[8344,8402]},{"content":"Windows uses the reference device identified by the <ph id=\"ph1\">`pDCRef`</ph> parameter to record the resolution and units of the device on which a picture originally appeared.","pos":[8409,8568],"source":"Windows uses the reference device identified by the `pDCRef` parameter to record the resolution and units of the device on which a picture originally appeared."},{"content":"If the <ph id=\"ph1\">`pDCRef`</ph> parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, it uses the current display device for reference.","pos":[8569,8657],"source":" If the `pDCRef` parameter is **NULL**, it uses the current display device for reference."},{"content":"The left and top members of the <ph id=\"ph1\">`RECT`</ph> data structure pointed to by the <ph id=\"ph2\">`lpBounds`</ph> parameter must be smaller than the right and bottom members, respectively.","pos":[8664,8821],"source":"The left and top members of the `RECT` data structure pointed to by the `lpBounds` parameter must be smaller than the right and bottom members, respectively."},{"content":"Points along the edges of the rectangle are included in the picture.","pos":[8822,8890]},{"content":"If <ph id=\"ph1\">`lpBounds`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the graphics device interface (GDI) computes the dimensions of the smallest rectangle that can enclose the picture drawn by the application.","pos":[8891,9058],"source":" If `lpBounds` is **NULL**, the graphics device interface (GDI) computes the dimensions of the smallest rectangle that can enclose the picture drawn by the application."},{"content":"The <ph id=\"ph1\">`lpBounds`</ph> parameter should be supplied where possible.","pos":[9059,9118],"source":" The `lpBounds` parameter should be supplied where possible."},{"content":"The string pointed to by the <ph id=\"ph1\">`lpszDescription`</ph> parameter must contain a null character between the application name and the picture name and must terminate with two null characters —for example, \"XYZ Graphics Editor\\0Bald Eagle\\0\\0,\" where \\0 represents the null character.","pos":[9125,9398],"source":"The string pointed to by the `lpszDescription` parameter must contain a null character between the application name and the picture name and must terminate with two null characters —for example, \"XYZ Graphics Editor\\0Bald Eagle\\0\\0,\" where \\0 represents the null character."},{"content":"If <ph id=\"ph1\">`lpszDescription`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, there is no corresponding entry in the enhanced-metafile header.","pos":[9399,9497],"source":" If `lpszDescription` is **NULL**, there is no corresponding entry in the enhanced-metafile header."},{"content":"Applications use the DC created by this function to store a graphics picture in an enhanced metafile.","pos":[9504,9605]},{"content":"The handle identifying this DC can be passed to any GDI function.","pos":[9606,9671]},{"content":"After an application stores a picture in an enhanced metafile, it can display the picture on any output device by calling the <ph id=\"ph1\">`CDC::PlayMetaFile`</ph> function.","pos":[9678,9833],"source":"After an application stores a picture in an enhanced metafile, it can display the picture on any output device by calling the `CDC::PlayMetaFile` function."},{"content":"When displaying the picture, Windows uses the rectangle pointed to by the <ph id=\"ph1\">`lpBounds`</ph> parameter and the resolution data from the reference device to position and scale the picture.","pos":[9834,10013],"source":" When displaying the picture, Windows uses the rectangle pointed to by the `lpBounds` parameter and the resolution data from the reference device to position and scale the picture."},{"content":"The device context returned by this function contains the same default attributes associated with any new DC.","pos":[10014,10123]},{"pos":[10130,10263],"content":"Applications must use the Win32 <bpt id=\"p1\">**</bpt>GetWinMetaFileBits<ept id=\"p1\">**</ept> function to convert an enhanced metafile to the older Windows metafile format.","source":"Applications must use the Win32 **GetWinMetaFileBits** function to convert an enhanced metafile to the older Windows metafile format."},{"content":"The filename for the enhanced metafile should use the .EMF extension.","pos":[10270,10339]},{"content":"See Also","pos":[10348,10356]},{"content":"CDC Class","pos":[10361,10370]},{"content":"Hierarchy Chart","pos":[10411,10426]}],"content":"---\ntitle: \"CMetaFileDC Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMetaFileDC\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMetaFileDC class\"\n  - \"Windows metafiles [C++]\"\n  - \"metafiles, implementing\"\nms.assetid: ffce60fa-4181-4d46-9832-25e46fad4db4\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMetaFileDC Class\nImplements a Windows metafile, which contains a sequence of graphics device interface (GDI) commands that you can replay to create a desired image or text.  \n  \n## Syntax  \n  \n```  \nclass CMetaFileDC : public CDC  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMetaFileDC::CMetaFileDC](#cmetafiledc__cmetafiledc)|Constructs a `CMetaFileDC` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMetaFileDC::Close](#cmetafiledc__close)|Closes the device context and creates a metafile handle.|  \n|[CMetaFileDC::CloseEnhanced](#cmetafiledc__closeenhanced)|Closes an enhanced-metafile device context and creates an enhanced-metafile handle.|  \n|[CMetaFileDC::Create](#cmetafiledc__create)|Creates the Windows metafile device context and attaches it to the `CMetaFileDC` object.|  \n|[CMetaFileDC::CreateEnhanced](#cmetafiledc__createenhanced)|Creates a metafile device context for an enhanced-format metafile.|  \n  \n## Remarks  \n To implement a Windows metafile, first create a `CMetaFileDC` object. Invoke the `CMetaFileDC` constructor, then call the [Create](#cmetafiledc__create) member function, which creates a Windows metafile device context and attaches it to the `CMetaFileDC` object.  \n  \n Next send the `CMetaFileDC` object the sequence of `CDC` GDI commands that you intend for it to replay. Only those GDI commands that create output, such as `MoveTo` and `LineTo`, can be used.  \n  \n After you have sent the desired commands to the metafile, call the **Close** member function, which closes the metafile device contexts and returns a metafile handle. Then dispose of the `CMetaFileDC` object.  \n  \n [CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#cdc__playmetafile) can then use the metafile handle to play the metafile repeatedly. The metafile can also be manipulated by Windows functions such as [CopyMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183480), which copies a metafile to disk.  \n  \n When the metafile is no longer needed, delete it from memory with the [DeleteMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183537) Windows function.  \n  \n You can also implement the `CMetaFileDC` object so that it can handle both output calls and attribute GDI calls such as `GetTextExtent`. Such a metafile is more flexible and can more easily reuse general GDI code, which often consists of a mix of output and attribute calls. The `CMetaFileDC` class inherits two device contexts, `m_hDC` and `m_hAttribDC`, from `CDC`. The `m_hDC` device context handles all [CDC](../../mfc/reference/cdc-class.md) GDI output calls and the `m_hAttribDC` device context handles all `CDC` GDI attribute calls. Normally, these two device contexts refer to the same device. In the case of `CMetaFileDC`, the attribute DC is set to **NULL** by default.  \n  \n Create a second device context that points to the screen, a printer, or device other than a metafile, then call the `SetAttribDC` member function to associate the new device context with `m_hAttribDC`. GDI calls for information will now be directed to the new `m_hAttribDC`. Output GDI calls will go to `m_hDC`, which represents the metafile.  \n  \n For more information on `CMetaFileDC`, see [Device Contexts](../../mfc/device-contexts.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CDC](../../mfc/reference/cdc-class.md)  \n  \n `CMetaFileDC`  \n  \n## Requirements  \n **Header:** afxext.h  \n  \n##  <a name=\"cmetafiledc__close\"></a>  CMetaFileDC::Close  \n Closes the metafile device context and creates a Windows metafile handle that can be used to play the metafile by using the [CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#cdc__playmetafile) member function.  \n  \n```  \nHMETAFILE Close();\n```  \n  \n### Return Value  \n A valid **HMETAFILE** if the function is successful; otherwise **NULL**.  \n  \n### Remarks  \n The Windows metafile handle can also be used to manipulate the metafile with Windows functions such as [CopyMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183480).  \n  \n Delete the metafile after use by calling the Windows [DeleteMetaFile](http://msdn.microsoft.com/library/windows/desktop/dd183537) function.  \n  \n##  <a name=\"cmetafiledc__closeenhanced\"></a>  CMetaFileDC::CloseEnhanced  \n Closes an enhanced-metafile device context and returns a handle that identifies an enhanced-format metafile.  \n  \n```  \nHENHMETAFILE CloseEnhanced();\n```  \n  \n### Return Value  \n A handle of an enhanced metafile, if successful; otherwise **NULL**.  \n  \n### Remarks  \n An application can use the enhanced-metafile handle returned by this function to perform the following tasks:  \n  \n-   Display a picture stored in an enhanced metafile  \n  \n-   Create copies of the enhanced metafile  \n  \n-   Enumerate, edit, or copy individual records in the enhanced metafile  \n  \n-   Retrieve an optional description of the metafile contents from the enhanced-metafile header  \n  \n-   Retrieve a copy of the enhanced-metafile header  \n  \n-   Retrieve a binary copy of the enhanced metafile  \n  \n-   Enumerate the colors in the optional palette  \n  \n-   Convert an enhanced-format metafile into a Windows-format metafile  \n  \n When the application no longer needs the enhanced metafile handle, it should release the handle by calling the Win32 **DeleteEnhMetaFile** function.  \n  \n##  <a name=\"cmetafiledc__cmetafiledc\"></a>  CMetaFileDC::CMetaFileDC  \n Construct a `CMetaFileDC` object in two steps.  \n  \n```  \nCMetaFileDC();\n```  \n  \n### Remarks  \n First, call `CMetaFileDC`, then call **Create**, which creates the Windows metafile device context and attaches it to the `CMetaFileDC` object.  \n  \n##  <a name=\"cmetafiledc__create\"></a>  CMetaFileDC::Create  \n Construct a `CMetaFileDC` object in two steps.  \n  \n```  \nBOOL Create(LPCTSTR lpszFilename = NULL);\n```  \n  \n### Parameters  \n *lpszFilename*  \n Points to a null-terminated character string. Specifies the filename of the metafile to create. If *lpszFilename* is **NULL**, a new in-memory metafile is created.  \n  \n### Return Value  \n Nonzero if the function is successful; otherwise 0.  \n  \n### Remarks  \n First, call the constructor `CMetaFileDC`, then call **Create**, which creates the Windows metafile device context and attaches it to the `CMetaFileDC` object.  \n  \n##  <a name=\"cmetafiledc__createenhanced\"></a>  CMetaFileDC::CreateEnhanced  \n Creates a device context for an enhanced-format metafile.  \n  \n```  \nBOOL CreateEnhanced(\n    CDC* pDCRef,  \n    LPCTSTR lpszFileName,  \n    LPCRECT lpBounds,  \n    LPCTSTR lpszDescription);\n```  \n  \n### Parameters  \n `pDCRef`  \n Identifies a reference device for the enhanced metafile.  \n  \n `lpszFileName`  \n Points to a null-terminated character string. Specifies the filename for the enhanced metafile to be created. If this parameter is **NULL**, the enhanced metafile is memory based and its contents lost when the object is destroyed or when the Win32 **DeleteEnhMetaFile** function is called.  \n  \n `lpBounds`  \n Points to a [RECT](../../mfc/reference/rect-structure1.md) data structure or a [CRect](../../atl-mfc-shared/reference/crect-class.md) object that specifies the dimensions in **HIMETRIC** units (in .01-millimeter increments) of the picture to be stored in the enhanced metafile.  \n  \n `lpszDescription`  \n Points to a zero-terminated string that specifies the name of the application that created the picture, as well as the picture's title.  \n  \n### Return Value  \n A handle of the device context for the enhanced metafile, if successful; otherwise **NULL**.  \n  \n### Remarks  \n This DC can be used to store a device-independent picture.  \n  \n Windows uses the reference device identified by the `pDCRef` parameter to record the resolution and units of the device on which a picture originally appeared. If the `pDCRef` parameter is **NULL**, it uses the current display device for reference.  \n  \n The left and top members of the `RECT` data structure pointed to by the `lpBounds` parameter must be smaller than the right and bottom members, respectively. Points along the edges of the rectangle are included in the picture. If `lpBounds` is **NULL**, the graphics device interface (GDI) computes the dimensions of the smallest rectangle that can enclose the picture drawn by the application. The `lpBounds` parameter should be supplied where possible.  \n  \n The string pointed to by the `lpszDescription` parameter must contain a null character between the application name and the picture name and must terminate with two null characters —for example, \"XYZ Graphics Editor\\0Bald Eagle\\0\\0,\" where \\0 represents the null character. If `lpszDescription` is **NULL**, there is no corresponding entry in the enhanced-metafile header.  \n  \n Applications use the DC created by this function to store a graphics picture in an enhanced metafile. The handle identifying this DC can be passed to any GDI function.  \n  \n After an application stores a picture in an enhanced metafile, it can display the picture on any output device by calling the `CDC::PlayMetaFile` function. When displaying the picture, Windows uses the rectangle pointed to by the `lpBounds` parameter and the resolution data from the reference device to position and scale the picture. The device context returned by this function contains the same default attributes associated with any new DC.  \n  \n Applications must use the Win32 **GetWinMetaFileBits** function to convert an enhanced metafile to the older Windows metafile format.  \n  \n The filename for the enhanced metafile should use the .EMF extension.  \n  \n## See Also  \n [CDC Class](../../mfc/reference/cdc-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n\n\n"}