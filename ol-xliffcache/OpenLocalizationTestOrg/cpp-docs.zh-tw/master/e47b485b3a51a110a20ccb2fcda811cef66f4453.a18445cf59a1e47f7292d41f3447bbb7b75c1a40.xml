{"nodes":[{"pos":[12,52],"content":"CDaoIndexInfo Structure | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDaoIndexInfo Structure | Microsoft Docs","pos":[0,40]}]},{"content":"CDaoIndexInfo Structure","pos":[671,694]},{"pos":[695,806],"content":"The <ph id=\"ph1\">`CDaoIndexInfo`</ph> structure contains information about an index object defined for data access objects (DAO).","source":"The `CDaoIndexInfo` structure contains information about an index object defined for data access objects (DAO)."},{"content":"Syntax","pos":[815,821]},{"content":"Parameters","pos":[1428,1438]},{"content":"Uniquely names the field object.","pos":[1457,1489]},{"content":"For details, see the topic \"Name Property\" in DAO Help.","pos":[1490,1545]},{"content":"A pointer to an array of <bpt id=\"p1\">[</bpt>CDaoIndexFieldInfo<ept id=\"p1\">](../../mfc/reference/cdaoindexfieldinfo-structure.md)</ept> objects indicating which tabledef or recordset fields are key fields in an index.","pos":[1571,1751],"source":" A pointer to an array of [CDaoIndexFieldInfo](../../mfc/reference/cdaoindexfieldinfo-structure.md) objects indicating which tabledef or recordset fields are key fields in an index."},{"content":"Each object identifies one field in the index.","pos":[1752,1798]},{"content":"The default index ordering is ascending.","pos":[1799,1839]},{"content":"An index object can have one or more fields representing index keys for each record.","pos":[1840,1924]},{"content":"These can be ascending, descending, or a combination.","pos":[1925,1978]},{"content":"The number of fields stored in <ph id=\"ph1\">`m_pFieldInfos`</ph>.","pos":[2000,2047],"source":" The number of fields stored in `m_pFieldInfos`."},{"content":"m_bPrimary","pos":[2055,2065]},{"content":"If the Primary property is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the index object represents a primary index.","pos":[2070,2151],"source":" If the Primary property is **TRUE**, the index object represents a primary index."},{"content":"A primary index consists of one or more fields that uniquely identify all records in a table in a predefined order.","pos":[2152,2267]},{"content":"Because the index field must be unique, the Unique property of the Index object is also set to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> in DAO.","pos":[2268,2379],"source":" Because the index field must be unique, the Unique property of the Index object is also set to **TRUE** in DAO."},{"content":"If the primary index consists of more than one field, each field can contain duplicate values, but each combination of values from all the indexed fields must be unique.","pos":[2380,2549]},{"content":"A primary index consists of a key for the table and usually contains the same fields as the primary key.","pos":[2550,2654]},{"content":"When you set a primary key for a table, the primary key is automatically defined as the primary index for the table.","pos":[2661,2777]},{"content":"For more information, see the topics \"Primary Property\" and \"Unique Property\" in DAO Help.","pos":[2778,2868]},{"pos":[2876,2939],"content":"[!NOTE]\n There can be, at most, one primary index on a table.","leadings":["","> "],"nodes":[{"content":"There can be, at most, one primary index on a table.","pos":[9,61]}]},{"content":"m_bUnique","pos":[2947,2956]},{"content":"Indicates whether an index object represents a unique index for a table.","pos":[2961,3033]},{"content":"If this property is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the index object represents an index that is unique.","pos":[3034,3116],"source":" If this property is **TRUE**, the index object represents an index that is unique."},{"content":"A unique index consists of one or more fields that logically arrange all records in a table in a unique, predefined order.","pos":[3117,3239]},{"content":"If the index consists of one field, values in that field must be unique for the entire table.","pos":[3240,3333]},{"content":"If the index consists of more than one field, each field can contain duplicate values, but each combination of values from all the indexed fields must be unique.","pos":[3334,3495]},{"content":"If both the Unique and Primary properties of an index object are set to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the index is unique and primary: It uniquely identifies all records in the table in a predefined, logical order.","pos":[3502,3696],"source":"If both the Unique and Primary properties of an index object are set to **TRUE**, the index is unique and primary: It uniquely identifies all records in the table in a predefined, logical order."},{"content":"If the Primary property is set to <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, the index is a secondary index.","pos":[3697,3773],"source":" If the Primary property is set to **FALSE**, the index is a secondary index."},{"content":"Secondary indexes (both key and nonkey) logically arrange records in a predefined order without serving as an identifier for records in the table.","pos":[3774,3920]},{"content":"For more information, see the topics \"Primary Property\" and \"Unique Property\" in DAO Help.","pos":[3927,4017]},{"content":"m_bClustered","pos":[4025,4037]},{"content":"Indicates whether an index object represents a clustered index for a table.","pos":[4042,4117]},{"content":"If this property is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the index object represents a clustered index; otherwise, it does not.","pos":[4118,4218],"source":" If this property is **TRUE**, the index object represents a clustered index; otherwise, it does not."},{"content":"A clustered index consists of one or more nonkey fields that, taken together, arrange all records in a table in a predefined order.","pos":[4219,4350]},{"content":"With a clustered index, the data in the table is literally stored in the order specified by the clustered index.","pos":[4351,4463]},{"content":"A clustered index provides efficient access to records in a table.","pos":[4464,4530]},{"content":"For more information, see the topic \"Clustered Property\" in DAO Help.","pos":[4531,4600]},{"pos":[4608,4777],"content":"[!NOTE]\n The Clustered property is ignored for databases that use the Microsoft Jet database engine because the Jet database engine does not support clustered indexes.","leadings":["","> "],"nodes":[{"content":"The Clustered property is ignored for databases that use the Microsoft Jet database engine because the Jet database engine does not support clustered indexes.","pos":[9,167]}]},{"content":"m_bIgnoreNulls","pos":[4785,4799]},{"content":"Indicates whether there are index entries for records that have Null values in their index fields.","pos":[4804,4902]},{"content":"If this property is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, fields with Null values do not have an index entry.","pos":[4903,4984],"source":" If this property is **TRUE**, fields with Null values do not have an index entry."},{"content":"To make searching for records using a field faster, you can define an index for the field.","pos":[4985,5075]},{"content":"If you allow Null entries in an indexed field and expect many of the entries to be Null, you can set the IgnoreNulls property for the index object to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> to reduce the amount of storage space that the index uses.","pos":[5076,5293],"source":" If you allow Null entries in an indexed field and expect many of the entries to be Null, you can set the IgnoreNulls property for the index object to **TRUE** to reduce the amount of storage space that the index uses."},{"content":"The IgnoreNulls property setting and the Required property setting together determine whether a record with a Null index value has an index entry, as the following table shows.","pos":[5294,5470]},{"content":"IgnoreNulls","pos":[5477,5488]},{"content":"Required","pos":[5489,5497]},{"content":"Null in index field","pos":[5498,5517]},{"content":"True","pos":[5585,5589]},{"content":"False","pos":[5590,5595]},{"content":"Null value allowed; no index entry added.","pos":[5596,5637]},{"content":"False","pos":[5642,5647]},{"content":"False","pos":[5648,5653]},{"content":"Null value allowed; index entry added.","pos":[5654,5692]},{"content":"True or False","pos":[5697,5710]},{"content":"True","pos":[5711,5715]},{"content":"Null value not allowed; no index entry added.","pos":[5716,5761]},{"content":"For more information, see the topic \"IgnoreNulls Property\" in DAO Help.","pos":[5769,5840]},{"content":"Indicates whether a DAO index object requires a non-Null value.","pos":[5864,5927]},{"content":"If this property is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the index object does not allow a Null value.","pos":[5928,6003],"source":" If this property is **TRUE**, the index object does not allow a Null value."},{"content":"For more information, see the topic \"Required Property\" in DAO Help.","pos":[6004,6072]},{"pos":[6080,6354],"content":"[!TIP]\n When you can set this property for either a DAO index object or a field object (contained by a tabledef, recordset, or querydef object), set it for the field object. The validity of the property setting for a field object is checked before that of an index object.","leadings":["","> "],"nodes":[{"content":" When you can set this property for either a DAO index object or a field object (contained by a tabledef, recordset, or querydef object), set it for the field object. The validity of the property setting for a field object is checked before that of an index object.","pos":[7,272],"nodes":[{"content":"When you can set this property for either a DAO index object or a field object (contained by a tabledef, recordset, or querydef object), set it for the field object.","pos":[1,166]},{"content":"The validity of the property setting for a field object is checked before that of an index object.","pos":[167,265]}]}]},{"content":"m_bForeign","pos":[6362,6372]},{"content":"Indicates whether an index object represents a foreign key in a table.","pos":[6377,6447]},{"content":"If this property is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the index represents a foreign key in a table.","pos":[6448,6524],"source":" If this property is **TRUE**, the index represents a foreign key in a table."},{"content":"A foreign key consists of one or more fields in a foreign table that uniquely identify a row in a primary table.","pos":[6525,6637]},{"content":"The Microsoft Jet database engine creates an index object for the foreign table and sets the Foreign property when you create a relationship that enforces referential integrity.","pos":[6638,6815]},{"content":"For more information, see the topic \"Foreign Property\" in DAO Help.","pos":[6816,6883]},{"content":"m_lDistinctCount","pos":[6891,6907]},{"content":"Indicates the number of unique values for the index object that are included in the associated table.","pos":[6912,7013]},{"content":"Check the DistinctCount property to determine the number of unique values, or keys, in an index.","pos":[7014,7110]},{"content":"Any key is counted only once, even though there may be multiple occurrences of that value if the index permits duplicate values.","pos":[7111,7239]},{"content":"This information is useful in applications that attempt to optimize data access by evaluating index information.","pos":[7240,7352]},{"content":"The number of unique values is also known as the cardinality of an index object.","pos":[7353,7433]},{"content":"The DistinctCount property will not always reflect the actual number of keys at a particular time.","pos":[7434,7532]},{"content":"For example, a change caused by a transaction rollback will not be reflected immediately in the DistinctCount property.","pos":[7533,7652]},{"content":"For more information, see the topic \"DistinctCount Property\" in DAO Help.","pos":[7653,7726]},{"content":"Remarks","pos":[7735,7742]},{"pos":[7746,8065],"content":"The references to Primary, Secondary, and All above indicate how the information is returned by the <ph id=\"ph1\">`GetIndexInfo`</ph> member function in classes <bpt id=\"p1\">[</bpt>CDaoTableDef<ept id=\"p1\">](../../mfc/reference/cdaotabledef-class.md#cdaotabledef__getindexinfo)</ept> and <bpt id=\"p2\">[</bpt>CDaoRecordset<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__getindexinfo)</ept>.","source":"The references to Primary, Secondary, and All above indicate how the information is returned by the `GetIndexInfo` member function in classes [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md#cdaotabledef__getindexinfo) and [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__getindexinfo)."},{"content":"Index objects are not represented by an MFC class.","pos":[8072,8122]},{"content":"Instead, DAO objects underlying MFC objects of class <bpt id=\"p1\">[</bpt>CDaoTableDef<ept id=\"p1\">](../../mfc/reference/cdaotabledef-class.md)</ept> or <bpt id=\"p2\">[</bpt>CDaoRecordset<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md)</ept> contain a collection of index objects, called the Indexes collection.","pos":[8123,8366],"source":" Instead, DAO objects underlying MFC objects of class [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md) or [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) contain a collection of index objects, called the Indexes collection."},{"content":"These classes supply member functions to access individual items of index information, or you can access them all at once with a <ph id=\"ph1\">`CDaoIndexInfo`</ph> object by calling the <ph id=\"ph2\">`GetIndexInfo`</ph> member function of the containing object.","pos":[8367,8590],"source":" These classes supply member functions to access individual items of index information, or you can access them all at once with a `CDaoIndexInfo` object by calling the `GetIndexInfo` member function of the containing object."},{"pos":[8613,8740],"content":"has a constructor and a destructor in order to properly allocate and deallocate the index field information in <ph id=\"ph1\">`m_pFieldInfos`</ph>.","source":" has a constructor and a destructor in order to properly allocate and deallocate the index field information in `m_pFieldInfos`."},{"content":"Information retrieved by the <ph id=\"ph1\">`GetIndexInfo`</ph> member function of a tabledef object is stored in a <ph id=\"ph2\">`CDaoIndexInfo`</ph> structure.","pos":[8747,8869],"source":"Information retrieved by the `GetIndexInfo` member function of a tabledef object is stored in a `CDaoIndexInfo` structure."},{"content":"Call the <ph id=\"ph1\">`GetIndexInfo`</ph> member function of the containing tabledef object in whose Indexes collection the index object is stored.","pos":[8870,8999],"source":" Call the `GetIndexInfo` member function of the containing tabledef object in whose Indexes collection the index object is stored."},{"content":"also defines a <ph id=\"ph1\">`Dump`</ph> member function in debug builds.","pos":[9016,9070],"source":" also defines a `Dump` member function in debug builds."},{"content":"You can use <ph id=\"ph1\">`Dump`</ph> to dump the contents of a <ph id=\"ph2\">`CDaoIndexInfo`</ph> object.","pos":[9071,9139],"source":" You can use `Dump` to dump the contents of a `CDaoIndexInfo` object."},{"content":"Requirements","pos":[9148,9160]},{"pos":[9164,9184],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdao.h","source":"**Header:** afxdao.h"},{"content":"See Also","pos":[9193,9201]},{"content":"Structures, Styles, Callbacks, and Message Maps","pos":[9206,9253]},{"content":"CDaoTableDef::GetIndexInfo","pos":[9329,9355]}],"content":"---\ntitle: \"CDaoIndexInfo Structure | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"CDaoIndexInfo\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DAO (Data Access Objects), Indexes collection\"\n  - \"CDaoIndexInfo structure\"\nms.assetid: 251d8285-78ce-4716-a0b3-ccc3395fc437\ncaps.latest.revision: 13\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDaoIndexInfo Structure\nThe `CDaoIndexInfo` structure contains information about an index object defined for data access objects (DAO).  \n  \n## Syntax  \n  \n```  \nstruct CDaoIndexInfo {  \n    CDaoIndexInfo();\n*// Constructor  \n    CString m_strName;  // Primary  \n    CDaoIndexFieldInfo* m_pFieldInfos;  // Primary  \n    short m_nFields;    // Primary  \n    BOOL m_bPrimary;    // Secondary  \n    BOOL m_bUnique;     // Secondary  \n    BOOL m_bClustered;  // Secondary  \n    BOOL m_bIgnoreNulls;                // Secondary  \n    BOOL m_bRequired;   // Secondary  \n    BOOL m_bForeign;    // Secondary  \n    long m_lDistinctCount;              // All  \n *// Below the // Implementation comment: *// Destructor, not otherwise documented  \n};   \n```  \n  \n#### Parameters  \n `m_strName`  \n Uniquely names the field object. For details, see the topic \"Name Property\" in DAO Help.  \n  \n `m_pFieldInfos`  \n A pointer to an array of [CDaoIndexFieldInfo](../../mfc/reference/cdaoindexfieldinfo-structure.md) objects indicating which tabledef or recordset fields are key fields in an index. Each object identifies one field in the index. The default index ordering is ascending. An index object can have one or more fields representing index keys for each record. These can be ascending, descending, or a combination.  \n  \n `m_nFields`  \n The number of fields stored in `m_pFieldInfos`.  \n  \n *m_bPrimary*  \n If the Primary property is **TRUE**, the index object represents a primary index. A primary index consists of one or more fields that uniquely identify all records in a table in a predefined order. Because the index field must be unique, the Unique property of the Index object is also set to **TRUE** in DAO. If the primary index consists of more than one field, each field can contain duplicate values, but each combination of values from all the indexed fields must be unique. A primary index consists of a key for the table and usually contains the same fields as the primary key.  \n  \n When you set a primary key for a table, the primary key is automatically defined as the primary index for the table. For more information, see the topics \"Primary Property\" and \"Unique Property\" in DAO Help.  \n  \n> [!NOTE]\n>  There can be, at most, one primary index on a table.  \n  \n *m_bUnique*  \n Indicates whether an index object represents a unique index for a table. If this property is **TRUE**, the index object represents an index that is unique. A unique index consists of one or more fields that logically arrange all records in a table in a unique, predefined order. If the index consists of one field, values in that field must be unique for the entire table. If the index consists of more than one field, each field can contain duplicate values, but each combination of values from all the indexed fields must be unique.  \n  \n If both the Unique and Primary properties of an index object are set to **TRUE**, the index is unique and primary: It uniquely identifies all records in the table in a predefined, logical order. If the Primary property is set to **FALSE**, the index is a secondary index. Secondary indexes (both key and nonkey) logically arrange records in a predefined order without serving as an identifier for records in the table.  \n  \n For more information, see the topics \"Primary Property\" and \"Unique Property\" in DAO Help.  \n  \n *m_bClustered*  \n Indicates whether an index object represents a clustered index for a table. If this property is **TRUE**, the index object represents a clustered index; otherwise, it does not. A clustered index consists of one or more nonkey fields that, taken together, arrange all records in a table in a predefined order. With a clustered index, the data in the table is literally stored in the order specified by the clustered index. A clustered index provides efficient access to records in a table. For more information, see the topic \"Clustered Property\" in DAO Help.  \n  \n> [!NOTE]\n>  The Clustered property is ignored for databases that use the Microsoft Jet database engine because the Jet database engine does not support clustered indexes.  \n  \n *m_bIgnoreNulls*  \n Indicates whether there are index entries for records that have Null values in their index fields. If this property is **TRUE**, fields with Null values do not have an index entry. To make searching for records using a field faster, you can define an index for the field. If you allow Null entries in an indexed field and expect many of the entries to be Null, you can set the IgnoreNulls property for the index object to **TRUE** to reduce the amount of storage space that the index uses. The IgnoreNulls property setting and the Required property setting together determine whether a record with a Null index value has an index entry, as the following table shows.  \n  \n|IgnoreNulls|Required|Null in index field|  \n|-----------------|--------------|-------------------------|  \n|True|False|Null value allowed; no index entry added.|  \n|False|False|Null value allowed; index entry added.|  \n|True or False|True|Null value not allowed; no index entry added.|  \n  \n For more information, see the topic \"IgnoreNulls Property\" in DAO Help.  \n  \n `m_bRequired`  \n Indicates whether a DAO index object requires a non-Null value. If this property is **TRUE**, the index object does not allow a Null value. For more information, see the topic \"Required Property\" in DAO Help.  \n  \n> [!TIP]\n>  When you can set this property for either a DAO index object or a field object (contained by a tabledef, recordset, or querydef object), set it for the field object. The validity of the property setting for a field object is checked before that of an index object.  \n  \n *m_bForeign*  \n Indicates whether an index object represents a foreign key in a table. If this property is **TRUE**, the index represents a foreign key in a table. A foreign key consists of one or more fields in a foreign table that uniquely identify a row in a primary table. The Microsoft Jet database engine creates an index object for the foreign table and sets the Foreign property when you create a relationship that enforces referential integrity. For more information, see the topic \"Foreign Property\" in DAO Help.  \n  \n *m_lDistinctCount*  \n Indicates the number of unique values for the index object that are included in the associated table. Check the DistinctCount property to determine the number of unique values, or keys, in an index. Any key is counted only once, even though there may be multiple occurrences of that value if the index permits duplicate values. This information is useful in applications that attempt to optimize data access by evaluating index information. The number of unique values is also known as the cardinality of an index object. The DistinctCount property will not always reflect the actual number of keys at a particular time. For example, a change caused by a transaction rollback will not be reflected immediately in the DistinctCount property. For more information, see the topic \"DistinctCount Property\" in DAO Help.  \n  \n## Remarks  \n The references to Primary, Secondary, and All above indicate how the information is returned by the `GetIndexInfo` member function in classes [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md#cdaotabledef__getindexinfo) and [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__getindexinfo).  \n  \n Index objects are not represented by an MFC class. Instead, DAO objects underlying MFC objects of class [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md) or [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) contain a collection of index objects, called the Indexes collection. These classes supply member functions to access individual items of index information, or you can access them all at once with a `CDaoIndexInfo` object by calling the `GetIndexInfo` member function of the containing object.  \n  \n `CDaoIndexInfo` has a constructor and a destructor in order to properly allocate and deallocate the index field information in `m_pFieldInfos`.  \n  \n Information retrieved by the `GetIndexInfo` member function of a tabledef object is stored in a `CDaoIndexInfo` structure. Call the `GetIndexInfo` member function of the containing tabledef object in whose Indexes collection the index object is stored. `CDaoIndexInfo` also defines a `Dump` member function in debug builds. You can use `Dump` to dump the contents of a `CDaoIndexInfo` object.  \n  \n## Requirements  \n **Header:** afxdao.h  \n  \n## See Also  \n [Structures, Styles, Callbacks, and Message Maps](../../mfc/reference/structures-styles-callbacks-and-message-maps.md)   \n [CDaoTableDef::GetIndexInfo](../../mfc/reference/cdaotabledef-class.md#cdaotabledef__getindexinfo)\n\n"}