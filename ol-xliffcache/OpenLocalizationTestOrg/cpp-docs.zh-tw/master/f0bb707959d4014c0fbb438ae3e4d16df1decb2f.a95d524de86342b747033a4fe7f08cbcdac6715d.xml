{"nodes":[{"pos":[12,86],"content":"How to: Sink Windows Forms Events from Native C++ Classes | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Sink Windows Forms Events from Native C++ Classes | Microsoft Docs","pos":[0,74]}]},{"content":"How to: Sink Windows Forms Events from Native C++ Classes","pos":[773,830]},{"content":"You can enable native C++ classes to receive callbacks from managed events raised from Windows Forms controls or other forms with the MFC macro map format.","pos":[831,986]},{"content":"Sinking events in views and dialogs is similar to doing the same task for controls.","pos":[987,1070]},{"content":"To do this, you need to:","pos":[1077,1101]},{"pos":[1111,1254],"content":"Attach an <ph id=\"ph1\">`OnClick`</ph> event handler to the control using <bpt id=\"p1\">[</bpt>MAKE_DELEGATE<ept id=\"p1\">](http://msdn.microsoft.com/Library/acc07fd2-4ea7-4c56-8d2c-73175524caeb)</ept>.","source":"Attach an `OnClick` event handler to the control using [MAKE_DELEGATE](http://msdn.microsoft.com/Library/acc07fd2-4ea7-4c56-8d2c-73175524caeb)."},{"pos":[1264,1577],"content":"Create a delegate map using <bpt id=\"p1\">[</bpt>BEGIN_DELEGATE_MAP<ept id=\"p1\">](http://msdn.microsoft.com/Library/cdf4341f-1c71-40bb-abc8-fc2c35b8247d)</ept>, <bpt id=\"p2\">[</bpt>END_DELEGATE_MAP<ept id=\"p2\">](http://msdn.microsoft.com/Library/23992653-a52a-4c76-b1f8-8e67daae75da)</ept>, and <bpt id=\"p3\">[</bpt>EVENT_DELEGATE_ENTRY<ept id=\"p3\">](http://msdn.microsoft.com/Library/17539da5-bad7-43ff-8a54-6ea3dc564965)</ept>.","source":"Create a delegate map using [BEGIN_DELEGATE_MAP](http://msdn.microsoft.com/Library/cdf4341f-1c71-40bb-abc8-fc2c35b8247d), [END_DELEGATE_MAP](http://msdn.microsoft.com/Library/23992653-a52a-4c76-b1f8-8e67daae75da), and [EVENT_DELEGATE_ENTRY](http://msdn.microsoft.com/Library/17539da5-bad7-43ff-8a54-6ea3dc564965)."},{"pos":[1584,1743],"content":"This sample continues the work you did in <bpt id=\"p1\">[</bpt>How to: Do DDX/DDV Data Binding with Windows Forms<ept id=\"p1\">](../dotnet/how-to-do-ddx-ddv-data-binding-with-windows-forms.md)</ept>.","source":"This sample continues the work you did in [How to: Do DDX/DDV Data Binding with Windows Forms](../dotnet/how-to-do-ddx-ddv-data-binding-with-windows-forms.md)."},{"pos":[1750,1926],"content":"Now, you will associate your MFC control (<ph id=\"ph1\">`m_MyControl`</ph>) with a managed event handler delegate called <ph id=\"ph2\">`OnClick`</ph> for the managed &lt;xref:System.Windows.Forms.Control.Click&gt; event.","source":"Now, you will associate your MFC control (`m_MyControl`) with a managed event handler delegate called `OnClick` for the managed <xref:System.Windows.Forms.Control.Click> event."},{"content":"To attach the OnClick event handler:","pos":[1936,1972]},{"content":"Add the following code to the implementation of BOOL CMFC01Dlg::OnInitDialog:","pos":[1982,2059]},{"content":"Add the following code to the public section in the declaration of class CMFC01Dlg : public CDialog.","pos":[2190,2290]},{"pos":[2554,2617],"content":"Finally, add the implementation for <ph id=\"ph1\">`OnClick`</ph> to CMFC01Dlg.cpp:","source":"Finally, add the implementation for `OnClick` to CMFC01Dlg.cpp:"},{"content":"See Also","pos":[2788,2796]},{"content":"MAKE_DELEGATE","pos":[2801,2814]},{"content":"BEGIN_DELEGATE_MAP","pos":[2893,2911]},{"content":"END_DELEGATE_MAP","pos":[2990,3006]},{"content":"EVENT_DELEGATE_ENTRY","pos":[3085,3105]}],"content":"---\ntitle: \"How to: Sink Windows Forms Events from Native C++ Classes | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"event handling, managed/native interop\"\n  - \"event handling, sinking .NET in C++\"\n  - \"event handling, .NET/native interop\"\n  - \"event handling, Windows Forms in C++\"\nms.assetid: 6e30ddee-d058-4c8d-9956-2a43d86f19d5\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Sink Windows Forms Events from Native C++ Classes\nYou can enable native C++ classes to receive callbacks from managed events raised from Windows Forms controls or other forms with the MFC macro map format. Sinking events in views and dialogs is similar to doing the same task for controls.  \n  \n To do this, you need to:  \n  \n-   Attach an `OnClick` event handler to the control using [MAKE_DELEGATE](http://msdn.microsoft.com/Library/acc07fd2-4ea7-4c56-8d2c-73175524caeb).  \n  \n-   Create a delegate map using [BEGIN_DELEGATE_MAP](http://msdn.microsoft.com/Library/cdf4341f-1c71-40bb-abc8-fc2c35b8247d), [END_DELEGATE_MAP](http://msdn.microsoft.com/Library/23992653-a52a-4c76-b1f8-8e67daae75da), and [EVENT_DELEGATE_ENTRY](http://msdn.microsoft.com/Library/17539da5-bad7-43ff-8a54-6ea3dc564965).  \n  \n This sample continues the work you did in [How to: Do DDX/DDV Data Binding with Windows Forms](../dotnet/how-to-do-ddx-ddv-data-binding-with-windows-forms.md).  \n  \n Now, you will associate your MFC control (`m_MyControl`) with a managed event handler delegate called `OnClick` for the managed <xref:System.Windows.Forms.Control.Click> event.  \n  \n### To attach the OnClick event handler:  \n  \n1.  Add the following code to the implementation of BOOL CMFC01Dlg::OnInitDialog:  \n  \n    ```  \n    m_MyControl.GetControl()->button1->Click += MAKE_DELEGATE( System::EventHandler, OnClick );  \n    ```  \n  \n2.  Add the following code to the public section in the declaration of class CMFC01Dlg : public CDialog.  \n  \n    ```  \n    // delegate map  \n    BEGIN_DELEGATE_MAP( CMFC01Dlg )  \n    EVENT_DELEGATE_ENTRY( OnClick, System::Object^, System::EventArgs^ )  \n    END_DELEGATE_MAP()  \n  \n    void OnClick( System::Object^ sender, System::EventArgs^ e );  \n    ```  \n  \n3.  Finally, add the implementation for `OnClick` to CMFC01Dlg.cpp:  \n  \n    ```  \n    void CMFC01Dlg::OnClick(System::Object^ sender, System::EventArgs^ e)  \n    {  \n        AfxMessageBox(_T(\"Button clicked\"));  \n    }  \n    ```  \n  \n## See Also  \n [MAKE_DELEGATE](http://msdn.microsoft.com/Library/acc07fd2-4ea7-4c56-8d2c-73175524caeb)   \n [BEGIN_DELEGATE_MAP](http://msdn.microsoft.com/Library/cdf4341f-1c71-40bb-abc8-fc2c35b8247d)   \n [END_DELEGATE_MAP](http://msdn.microsoft.com/Library/23992653-a52a-4c76-b1f8-8e67daae75da)   \n [EVENT_DELEGATE_ENTRY](http://msdn.microsoft.com/Library/17539da5-bad7-43ff-8a54-6ea3dc564965)"}