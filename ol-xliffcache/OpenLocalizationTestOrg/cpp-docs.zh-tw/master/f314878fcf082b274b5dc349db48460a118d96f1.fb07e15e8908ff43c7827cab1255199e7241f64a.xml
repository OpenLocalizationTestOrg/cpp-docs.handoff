{"nodes":[{"pos":[12,48],"content":"OLE DB Object Model | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"OLE DB Object Model | Microsoft Docs","pos":[0,36]}]},{"content":"OLE DB Object Model","pos":[612,631]},{"content":"The OLE DB object model comprises the following objects or components.","pos":[632,702]},{"content":"The first four objects or components listed (data sources, sessions, commands, and rowsets) allow you to connect to a data source and view it.","pos":[703,845]},{"content":"The rest, starting with accessors, relate to working with the data when it is displayed.","pos":[846,934]},{"content":"Data Sources","pos":[943,955]},{"content":"Data source objects allow you to connect to a data source such as a file or DBMS.","pos":[959,1040]},{"content":"A data source object creates and manages the connection and contains permissions and authentications information (such as login name and password).","pos":[1041,1188]},{"content":"A data source object can create one or more sessions.","pos":[1189,1242]},{"content":"Sessions","pos":[1251,1259]},{"content":"A session manages a particular interaction with the data source to query and retrieve data.","pos":[1263,1354]},{"content":"Each session is a single transaction.","pos":[1355,1392]},{"content":"A transaction is an indivisible work unit defined by the ACID test.","pos":[1393,1460]},{"content":"For a definition of ACID, see <bpt id=\"p1\">[</bpt>Transactions<ept id=\"p1\">](#vcconoledbcomponents_transactions)</ept>.","pos":[1461,1542],"source":" For a definition of ACID, see [Transactions](#vcconoledbcomponents_transactions)."},{"content":"Sessions perform important tasks such as opening rowsets and returning the data source object that created it.","pos":[1549,1659]},{"content":"Sessions can also return metadata, or information about the data source itself (such as table information).","pos":[1660,1767]},{"content":"A session can create one or more commands.","pos":[1774,1816]},{"content":"Commands","pos":[1825,1833]},{"content":"Commands execute a text command such as a SQL statement.","pos":[1837,1893]},{"content":"If the text command specifies a rowset, such as a SQL <bpt id=\"p1\">**</bpt>SELECT<ept id=\"p1\">**</ept> statement, the command creates the rowset.","pos":[1894,2001],"source":" If the text command specifies a rowset, such as a SQL **SELECT** statement, the command creates the rowset."},{"content":"A command is simply a container for a text command, which is a string (such as a SQL statement) passed from a consumer to a data source object for execution by the provider's underlying data store.","pos":[2008,2205]},{"content":"Typically, the text command is a SQL <bpt id=\"p1\">**</bpt>SELECT<ept id=\"p1\">**</ept> statement (in which case, because SQL <bpt id=\"p2\">**</bpt>SELECT<ept id=\"p2\">**</ept> specifies a rowset, the command automatically creates a rowset).","pos":[2206,2367],"source":" Typically, the text command is a SQL **SELECT** statement (in which case, because SQL **SELECT** specifies a rowset, the command automatically creates a rowset)."},{"content":"Rowsets","pos":[2376,2383]},{"content":"Rowsets expose data in tabular format.","pos":[2387,2425]},{"content":"An index is a special case of a rowset.","pos":[2426,2465]},{"content":"You can create rowsets from the session or the command.","pos":[2466,2521]},{"content":"Schema Rowsets","pos":[2531,2545]},{"content":"Schemas contain metadata (structural information) about a database.","pos":[2549,2616]},{"content":"Schema rowsets are rowsets that contain schema information.","pos":[2617,2676]},{"content":"Some OLE DB providers for DBMS support schema rowset objects.","pos":[2677,2738]},{"content":"For more information about schema rowsets, see <bpt id=\"p1\">[</bpt>Obtaining Metadata with Schema Rowsets<ept id=\"p1\">](../../data/oledb/obtaining-metadata-with-schema-rowsets.md)</ept> and <bpt id=\"p2\">[</bpt>Schema Rowset Classes and Typedef Classes<ept id=\"p2\">](../../data/oledb/schema-rowset-classes-and-typedef-classes.md)</ept>.","pos":[2739,2998],"source":" For more information about schema rowsets, see [Obtaining Metadata with Schema Rowsets](../../data/oledb/obtaining-metadata-with-schema-rowsets.md) and [Schema Rowset Classes and Typedef Classes](../../data/oledb/schema-rowset-classes-and-typedef-classes.md)."},{"content":"View Objects","pos":[3008,3020]},{"content":"A view object defines a subset of the rows and columns from a rowset.","pos":[3024,3093]},{"content":"It contains no data of its own.","pos":[3094,3125]},{"content":"View objects cannot combine data from multiple rowsets.","pos":[3126,3181]},{"content":"Accessors","pos":[3190,3199]},{"content":"Only OLE DB uses the concept of accessors.","pos":[3203,3245]},{"content":"An accessor describes how data is stored in a consumer.","pos":[3246,3301]},{"content":"It contains a set of bindings (called a column map) between rowset fields (columns) and data members that you declare in the consumer.","pos":[3302,3436]},{"pos":[3495,3507],"content":"Transactions"},{"content":"Transaction objects are used when committing or aborting nested transactions at other than the lowest level.","pos":[3511,3619]},{"content":"A transaction is an indivisible work unit defined by the ACID test.","pos":[3620,3687]},{"content":"ACID stands for:","pos":[3688,3704]},{"content":"Atomicity: cannot be divided into smaller work units.","pos":[3714,3767]},{"content":"Concurrency: more than one transaction can occur at a time.","pos":[3777,3836]},{"content":"Isolation: one transaction has limited knowledge about changes made by another.","pos":[3846,3925]},{"content":"Durability: the transaction makes persistent changes.","pos":[3935,3988]},{"content":"Enumerators","pos":[3997,4008]},{"content":"Enumerators search for available data sources and other enumerators.","pos":[4012,4080]},{"content":"Consumers that are not customized for a particular data source use enumerators to search for a data source to use.","pos":[4081,4195]},{"content":"A root enumerator, shipped in the Microsoft Data Access SDK, traverses the registry looking for data sources and other enumerators.","pos":[4202,4333]},{"content":"Other enumerators traverse the registry or search in a provider-specific manner.","pos":[4334,4414]},{"content":"Errors","pos":[4423,4429]},{"content":"Any interface on any OLE DB object can generate errors.","pos":[4433,4488]},{"content":"Errors contain additional information about an error, including an optional custom error object.","pos":[4489,4585]},{"content":"This information is contained in an HRESULT.","pos":[4586,4630]},{"content":"Notifications","pos":[4639,4652]},{"content":"Notifications are used by groups of cooperating consumers sharing a rowset (where sharing means that the consumers are assumed to be working within the same transaction).","pos":[4656,4826]},{"content":"Notifications enable cooperating consumers sharing a rowset to be informed about actions on the rowset performed by their peers.","pos":[4827,4955]},{"content":"See Also","pos":[4964,4972]},{"content":"OLE DB Programming","pos":[4977,4995]},{"content":"OLE DB Programming Overview","pos":[5042,5069]}],"content":"---\ntitle: \"OLE DB Object Model | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"rowsets, OLE DB object model\"\n  - \"OLE DB, object model\"\nms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# OLE DB Object Model\nThe OLE DB object model comprises the following objects or components. The first four objects or components listed (data sources, sessions, commands, and rowsets) allow you to connect to a data source and view it. The rest, starting with accessors, relate to working with the data when it is displayed.  \n  \n## Data Sources  \n Data source objects allow you to connect to a data source such as a file or DBMS. A data source object creates and manages the connection and contains permissions and authentications information (such as login name and password). A data source object can create one or more sessions.  \n  \n## Sessions  \n A session manages a particular interaction with the data source to query and retrieve data. Each session is a single transaction. A transaction is an indivisible work unit defined by the ACID test. For a definition of ACID, see [Transactions](#vcconoledbcomponents_transactions).  \n  \n Sessions perform important tasks such as opening rowsets and returning the data source object that created it. Sessions can also return metadata, or information about the data source itself (such as table information).  \n  \n A session can create one or more commands.  \n  \n## Commands  \n Commands execute a text command such as a SQL statement. If the text command specifies a rowset, such as a SQL **SELECT** statement, the command creates the rowset.  \n  \n A command is simply a container for a text command, which is a string (such as a SQL statement) passed from a consumer to a data source object for execution by the provider's underlying data store. Typically, the text command is a SQL **SELECT** statement (in which case, because SQL **SELECT** specifies a rowset, the command automatically creates a rowset).  \n  \n## Rowsets  \n Rowsets expose data in tabular format. An index is a special case of a rowset. You can create rowsets from the session or the command.  \n  \n### Schema Rowsets  \n Schemas contain metadata (structural information) about a database. Schema rowsets are rowsets that contain schema information. Some OLE DB providers for DBMS support schema rowset objects. For more information about schema rowsets, see [Obtaining Metadata with Schema Rowsets](../../data/oledb/obtaining-metadata-with-schema-rowsets.md) and [Schema Rowset Classes and Typedef Classes](../../data/oledb/schema-rowset-classes-and-typedef-classes.md).  \n  \n### View Objects  \n A view object defines a subset of the rows and columns from a rowset. It contains no data of its own. View objects cannot combine data from multiple rowsets.  \n  \n## Accessors  \n Only OLE DB uses the concept of accessors. An accessor describes how data is stored in a consumer. It contains a set of bindings (called a column map) between rowset fields (columns) and data members that you declare in the consumer.  \n  \n##  <a name=\"vcconoledbcomponents_transactions\"></a> Transactions  \n Transaction objects are used when committing or aborting nested transactions at other than the lowest level. A transaction is an indivisible work unit defined by the ACID test. ACID stands for:  \n  \n-   Atomicity: cannot be divided into smaller work units.  \n  \n-   Concurrency: more than one transaction can occur at a time.  \n  \n-   Isolation: one transaction has limited knowledge about changes made by another.  \n  \n-   Durability: the transaction makes persistent changes.  \n  \n## Enumerators  \n Enumerators search for available data sources and other enumerators. Consumers that are not customized for a particular data source use enumerators to search for a data source to use.  \n  \n A root enumerator, shipped in the Microsoft Data Access SDK, traverses the registry looking for data sources and other enumerators. Other enumerators traverse the registry or search in a provider-specific manner.  \n  \n## Errors  \n Any interface on any OLE DB object can generate errors. Errors contain additional information about an error, including an optional custom error object. This information is contained in an HRESULT.  \n  \n## Notifications  \n Notifications are used by groups of cooperating consumers sharing a rowset (where sharing means that the consumers are assumed to be working within the same transaction). Notifications enable cooperating consumers sharing a rowset to be informed about actions on the rowset performed by their peers.  \n  \n## See Also  \n [OLE DB Programming](../../data/oledb/ole-db-programming.md)   \n [OLE DB Programming Overview](../../data/oledb/ole-db-programming-overview.md)"}