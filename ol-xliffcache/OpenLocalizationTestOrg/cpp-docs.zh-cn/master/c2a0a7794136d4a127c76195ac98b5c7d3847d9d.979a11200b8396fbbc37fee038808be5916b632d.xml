{"nodes":[{"pos":[12,58],"content":"Issuing a Parameterized Query | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Issuing a Parameterized Query | Microsoft Docs","pos":[0,46]}]},{"content":"Issuing a Parameterized Query","pos":[614,643]},{"content":"The following example issues a simple parameterized query that retrieves records with an age field (that is greater than 30) from a table in a Microsoft Access database.","pos":[644,813]},{"content":"To support the parameter, the user record must have an additional map.","pos":[814,884]},{"content":"The following code, in an ATL project, uses the <ph id=\"ph1\">`CCommand`</ph> class instead of the <ph id=\"ph2\">`CTable`</ph> class used in the previous example, <bpt id=\"p1\">[</bpt>Traversing a Simple Rowset<ept id=\"p1\">](../../data/oledb/traversing-a-simple-rowset.md)</ept>.","pos":[885,1087],"source":" The following code, in an ATL project, uses the `CCommand` class instead of the `CTable` class used in the previous example, [Traversing a Simple Rowset](../../data/oledb/traversing-a-simple-rowset.md)."},{"pos":[1788,1833],"content":"The user record, <ph id=\"ph1\">`CArtists`</ph>, looks like this:","source":"The user record, `CArtists`, looks like this:"},{"content":"See Also","pos":[2305,2313]},{"content":"Working with OLE DB Consumer Templates","pos":[2318,2356]}],"content":"---\ntitle: \"Issuing a Parameterized Query | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"parameter queries, running using CCommand class\"\nms.assetid: aedb0fce-52a4-4c97-a5c9-b2114be6c3b0\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Issuing a Parameterized Query\nThe following example issues a simple parameterized query that retrieves records with an age field (that is greater than 30) from a table in a Microsoft Access database. To support the parameter, the user record must have an additional map. The following code, in an ATL project, uses the `CCommand` class instead of the `CTable` class used in the previous example, [Traversing a Simple Rowset](../../data/oledb/traversing-a-simple-rowset.md).  \n  \n```  \n#include <atldbcli.h>  \n  \nCDataSource connection;  \nCSession session;  \nCCommand<CAccessor<CArtists> > artists;  \n  \n// Open the connection, session, and table, specifying authentication   \n// using Windows NT integrated security. Hard-coding a password is a major   \n// security weakness.  \nconnection.Open(CLSID_MSDASQL, \"NWind\", NULL, NULL,   \nDBPROP_AUTH_INTEGRATED);  \nsession.Open(connection);  \n  \n// Set the parameter for the query  \nartists.m_nAge = 30;  \nartists.Open(session, \"select * from artists where age > ?\");  \n  \n// Get data from the rowset  \nwhile (artists.MoveNext() == S_OK)  \n{  \n   cout << artists.m_szFirstName;  \n   cout << artists.m_szLastName;  \n}  \n```  \n  \n The user record, `CArtists`, looks like this:  \n  \n```  \nclass CArtists  \n{  \npublic:  \n// Data Elements  \n   CHAR m_szFirstName[20];  \n   CHAR m_szLastName[30];  \n   short m_nAge;  \n  \n// Column binding map  \nBEGIN_COLUMN_MAP(CArtists)  \n   COLUMN_ENTRY(1, m_szFirstName)  \n   COLUMN_ENTRY(2, m_szLastName)  \n   COLUMN_ENTRY(3, m_nAge)  \nEND_COLUMN_MAP()  \n  \n// Parameter binding map  \nBEGIN_PARAM_MAP(CArtists)  \n   SET_PARAM_TYPE(DBPARAMIO_INPUT)  \n   COLUMN_ENTRY(1, m_nAge)  \nEND_PARAM_MAP()  \n};  \n```  \n  \n## See Also  \n [Working with OLE DB Consumer Templates](../../data/oledb/working-with-ole-db-consumer-templates.md)"}