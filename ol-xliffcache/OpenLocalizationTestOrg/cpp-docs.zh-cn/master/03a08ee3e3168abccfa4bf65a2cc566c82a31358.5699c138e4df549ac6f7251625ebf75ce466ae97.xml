{"nodes":[{"pos":[12,51],"content":"COleDBRecordView Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleDBRecordView Class | Microsoft Docs","pos":[0,39]}]},{"content":"COleDBRecordView Class","pos":[640,662]},{"content":"A view that displays database records in controls.","pos":[663,713]},{"content":"Syntax","pos":[722,728]},{"content":"Members","pos":[796,803]},{"content":"Protected Constructors","pos":[813,835]},{"content":"Name","pos":[842,846]},{"content":"Description","pos":[847,858]},{"content":"COleDBRecordView::COleDBRecordView","pos":[897,931]},{"pos":[970,1009],"content":"Constructs a <ph id=\"ph1\">`COleDBRecordView`</ph> object.","source":"Constructs a `COleDBRecordView` object."},{"content":"Public Methods","pos":[1020,1034]},{"content":"Name","pos":[1041,1045]},{"content":"Description","pos":[1046,1057]},{"content":"COleDBRecordView::OnGetRowset","pos":[1096,1125]},{"pos":[1159,1194],"content":"Returns a standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"Returns a standard `HRESULT` value."},{"content":"COleDBRecordView::OnMove","pos":[1200,1224]},{"content":"Updates the current record (if dirty) on the data source and then moves to the specified record (next, previous, first, or last).","pos":[1253,1382]},{"content":"Remarks","pos":[1392,1399]},{"content":"The view is a form view directly connected to a <ph id=\"ph1\">`CRowset`</ph> object.","pos":[1403,1468],"source":"The view is a form view directly connected to a `CRowset` object."},{"content":"The view is created from a dialog template resource and displays the fields of the <ph id=\"ph1\">`CRowset`</ph> object in the dialog template's controls.","pos":[1469,1603],"source":" The view is created from a dialog template resource and displays the fields of the `CRowset` object in the dialog template's controls."},{"content":"The <ph id=\"ph1\">`COleDBRecordView`</ph> object uses dialog data exchange (DDX), and the navigational functionality built into <ph id=\"ph2\">`CRowset`</ph>, to automate the movement of data between the controls on the form and the fields of the rowset.","pos":[1604,1819],"source":" The `COleDBRecordView` object uses dialog data exchange (DDX), and the navigational functionality built into `CRowset`, to automate the movement of data between the controls on the form and the fields of the rowset."},{"content":"also supplies a default implementation for moving to the first, next, previous, or last record and an interface for updating the record currently on view.","pos":[1839,1993]},{"content":"You can use DDX functions with <bpt id=\"p1\">**</bpt>COleDbRecordView<ept id=\"p1\">**</ept> to get data directly from the database recordset and display it in a dialog control.","pos":[2000,2136],"source":"You can use DDX functions with **COleDbRecordView** to get data directly from the database recordset and display it in a dialog control."},{"content":"You should use the <bpt id=\"p1\">**</bpt>DDX_<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept> methods (such as <ph id=\"ph2\">`DDX_Text`</ph>), not the <bpt id=\"p2\">**</bpt>DDX_Field<ph id=\"ph3\">\\*</ph><ept id=\"p2\">**</ept> functions (such as <ph id=\"ph4\">`DDX_FieldText`</ph>) with <bpt id=\"p3\">**</bpt>COleDbRecordView<ept id=\"p3\">**</ept>.","pos":[2137,2283],"source":" You should use the **DDX_\\*** methods (such as `DDX_Text`), not the **DDX_Field\\*** functions (such as `DDX_FieldText`) with **COleDbRecordView**."},{"content":"will not work with <bpt id=\"p1\">**</bpt>COleDbRecordView<ept id=\"p1\">**</ept> because <ph id=\"ph1\">`DDX_FieldText`</ph> takes an additional argument of type <bpt id=\"p2\">**</bpt>CRecordset<ph id=\"ph2\">\\*</ph><ept id=\"p2\">**</ept> (for <ph id=\"ph3\">`CRecordView`</ph>) or <bpt id=\"p3\">**</bpt>CDaoRecordset<ph id=\"ph4\">\\*</ph><ept id=\"p3\">**</ept> (for <ph id=\"ph5\">`CDaoRecordView`</ph>).","pos":[2300,2484],"source":" will not work with **COleDbRecordView** because `DDX_FieldText` takes an additional argument of type **CRecordset\\*** (for `CRecordView`) or **CDaoRecordset\\*** (for `CDaoRecordView`)."},{"pos":[2492,2814],"content":"[!NOTE]\n If you are working with the Data Access Objects (DAO) classes rather than the OLE DB Consumer Template classes, use class [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) instead. For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md).","leadings":["","> "],"nodes":[{"content":" If you are working with the Data Access Objects (DAO) classes rather than the OLE DB Consumer Template classes, use class [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) instead. For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md).","pos":[8,320],"nodes":[{"content":"If you are working with the Data Access Objects (DAO) classes rather than the OLE DB Consumer Template classes, use class <bpt id=\"p1\">[</bpt>CDaoRecordView<ept id=\"p1\">](../../mfc/reference/cdaorecordview-class.md)</ept> instead.","pos":[1,193],"source":" If you are working with the Data Access Objects (DAO) classes rather than the OLE DB Consumer Template classes, use class [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) instead."},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Overview: Database Programming<ept id=\"p1\">](../../data/data-access-programming-mfc-atl.md)</ept>.","pos":[194,312],"source":" For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md)."}]}]},{"content":"keeps track of the user's position in the rowset so that the record view can update the user interface.","pos":[2840,2943]},{"content":"When the user moves to either end of the rowset, the record view disables user interface objects â€” such as menu items or toolbar buttons â€” for moving further in the same direction.","pos":[2944,3128]},{"pos":[3135,3279],"content":"For more information about rowset classes, see the <bpt id=\"p1\">[</bpt>Using OLE DB Consumer Templates<ept id=\"p1\">](../../data/oledb/ole-db-consumer-templates-cpp.md)</ept> article.","source":"For more information about rowset classes, see the [Using OLE DB Consumer Templates](../../data/oledb/ole-db-consumer-templates-cpp.md) article."},{"content":"Inheritance Hierarchy","pos":[3288,3309]},{"content":"CObject","pos":[3314,3321]},{"content":"CCmdTarget","pos":[3368,3378]},{"content":"CWnd","pos":[3428,3432]},{"content":"CView","pos":[3476,3481]},{"content":"CScrollView","pos":[3526,3537]},{"content":"CFormView","pos":[3588,3597]},{"content":"Requirements","pos":[3672,3684]},{"pos":[3688,3710],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxoledb.h","source":"**Header:** afxoledb.h"},{"pos":[3771,3805],"content":"COleDBRecordView::COleDBRecordView"},{"pos":[3809,3848],"content":"Constructs a <ph id=\"ph1\">`COleDBRecordView`</ph> object.","source":"Constructs a `COleDBRecordView` object."},{"content":"Parameters","pos":[3956,3966]},{"content":"Contains a null-terminated string that is the name of a dialog-template resource.","pos":[3992,4073]},{"content":"Contains the ID number of a dialog-template resource.","pos":[4097,4150]},{"content":"Remarks","pos":[4160,4167]},{"content":"When you create an object of a type derived from <ph id=\"ph1\">`COleDBRecordView`</ph>, invoke one of the constructors to create the view object and identify the dialog resource on which the view is based.","pos":[4171,4357],"source":"When you create an object of a type derived from `COleDBRecordView`, invoke one of the constructors to create the view object and identify the dialog resource on which the view is based."},{"content":"You can identify the resource either by name (pass a string as the argument to the constructor) or by its ID (pass an unsigned integer as the argument).","pos":[4358,4510]},{"pos":[4518,4709],"content":"[!NOTE]\n Your derived class *must* supply its own constructor. In the constructor, invoke the constructor, `COleDBRecordView::COleDBRecordView`, with the resource name or ID as an argument.","leadings":["","> "],"nodes":[{"content":" Your derived class *must* supply its own constructor. In the constructor, invoke the constructor, `COleDBRecordView::COleDBRecordView`, with the resource name or ID as an argument.","pos":[8,189],"nodes":[{"content":"Your derived class <bpt id=\"p1\">*</bpt>must<ept id=\"p1\">*</ept> supply its own constructor.","pos":[1,54],"source":" Your derived class *must* supply its own constructor."},{"content":"In the constructor, invoke the constructor, <ph id=\"ph1\">`COleDBRecordView::COleDBRecordView`</ph>, with the resource name or ID as an argument.","pos":[55,181],"source":" In the constructor, invoke the constructor, `COleDBRecordView::COleDBRecordView`, with the resource name or ID as an argument."}]}]},{"pos":[4765,4794],"content":"COleDBRecordView::OnGetRowset"},{"pos":[4798,4876],"content":"Returns a handle for the <bpt id=\"p1\">**</bpt>CRowset&lt;&gt;<ept id=\"p1\">**</ept> object associated with the record view.","source":"Returns a handle for the **CRowset<>** object associated with the record view."},{"content":"Return Value","pos":[4944,4956]},{"pos":[4960,4987],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"content":"Remarks","pos":[4997,5004]},{"content":"You must override this member function to construct or obtain a rowset object and return a handle to it.","pos":[5008,5112]},{"content":"If you declare your record view class with ClassWizard, the wizard writes a default override for you.","pos":[5113,5214]},{"content":"ClassWizard's default implementation returns the rowset handle stored in the record view if one exists.","pos":[5215,5318]},{"content":"If not, it constructs a rowset object of the type you specified with ClassWizard and calls its <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> member function to open the table or run the query, and then returns a handle to the object.","pos":[5319,5515],"source":" If not, it constructs a rowset object of the type you specified with ClassWizard and calls its **Open** member function to open the table or run the query, and then returns a handle to the object."},{"pos":[5523,5719],"content":"[!NOTE]\n Previous to MFC 7.0, `OnGetRowset` returned a pointer to `CRowset`. If you have code that calls `OnGetRowset`, you need to change the return type to the templatized class **CRowset<>**.","leadings":["","> "],"nodes":[{"content":" Previous to MFC 7.0, `OnGetRowset` returned a pointer to `CRowset`. If you have code that calls `OnGetRowset`, you need to change the return type to the templatized class **CRowset<>**.","pos":[8,194],"nodes":[{"content":"Previous to MFC 7.0, <ph id=\"ph1\">`OnGetRowset`</ph> returned a pointer to <ph id=\"ph2\">`CRowset`</ph>.","pos":[1,68],"source":" Previous to MFC 7.0, `OnGetRowset` returned a pointer to `CRowset`."},{"content":"If you have code that calls <ph id=\"ph1\">`OnGetRowset`</ph>, you need to change the return type to the templatized class <bpt id=\"p1\">**</bpt>CRowset&lt;&gt;<ept id=\"p1\">**</ept>.","pos":[69,186],"source":" If you have code that calls `OnGetRowset`, you need to change the return type to the templatized class **CRowset<>**."}]}]},{"content":"Example","pos":[5729,5736]},{"pos":[5751,5769],"content":"NVC_MFCDatabase#38"},{"pos":[5834,5972],"content":"For more information and examples, see the article <bpt id=\"p1\">[</bpt>Record Views: Using a Record View<ept id=\"p1\">](../../data/using-a-record-view-mfc-data-access.md)</ept>.","source":"For more information and examples, see the article [Record Views: Using a Record View](../../data/using-a-record-view-mfc-data-access.md)."},{"pos":[6023,6047],"content":"COleDBRecordView::OnMove"},{"content":"Moves to a different record in the rowset and display its fields in the controls of the record view.","pos":[6051,6151]},{"content":"Parameters","pos":[6218,6228]},{"content":"One of the following standard command ID values:","pos":[6252,6300]},{"pos":[6325,6373],"content":"Â Â Â Move to the first record in the recordset."},{"pos":[6397,6444],"content":"Â Â Â Move to the last record in the recordset."},{"pos":[6468,6515],"content":"Â Â Â Move to the next record in the recordset."},{"pos":[6539,6590],"content":"Â Â Â Move to the previous record in the recordset."},{"content":"Return Value","pos":[6600,6612]},{"content":"Nonzero if the move was successful; otherwise 0 if the move request was denied.","pos":[6616,6695]},{"content":"Remarks","pos":[6705,6712]},{"pos":[6716,6846],"content":"The default implementation calls the appropriate <bpt id=\"p1\">**</bpt>Move<ept id=\"p1\">**</ept> member function of the <ph id=\"ph1\">`CRowset`</ph> object associated with the record view.","source":"The default implementation calls the appropriate **Move** member function of the `CRowset` object associated with the record view."},{"pos":[6853,6966],"content":"By default, <ph id=\"ph1\">`OnMove`</ph> updates the current record on the data source if the user has changed it in the record view.","source":"By default, `OnMove` updates the current record on the data source if the user has changed it in the record view."},{"content":"The Application Wizard creates a menu resource with First Record, Last Record, Next Record, and Previous Record menu items.","pos":[6973,7096]},{"content":"If you select the Dockable Toolbar option, The Application Wizard also creates a toolbar with buttons corresponding to these commands.","pos":[7097,7231]},{"content":"If you move past the last record in the recordset, the record view continues to display the last record.","pos":[7238,7342]},{"content":"If you move backward past the first record, the record view continues to display the first record.","pos":[7343,7441]},{"content":"See Also","pos":[7450,7458]},{"content":"Hierarchy Chart","pos":[7463,7478]}],"content":"---\ntitle: \"COleDBRecordView Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleDBRecordView\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC, OLE DB\"\n  - \"COleDBRecordView class\"\nms.assetid: 98612427-c4c9-4760-b7e1-85b17448add9\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleDBRecordView Class\nA view that displays database records in controls.  \n  \n## Syntax  \n  \n```  \nclass COleDBRecordView : public CFormView  \n```  \n  \n## Members  \n  \n### Protected Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDBRecordView::COleDBRecordView](#coledbrecordview__coledbrecordview)|Constructs a `COleDBRecordView` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDBRecordView::OnGetRowset](#coledbrecordview__ongetrowset)|Returns a standard `HRESULT` value.|  \n|[COleDBRecordView::OnMove](#coledbrecordview__onmove)|Updates the current record (if dirty) on the data source and then moves to the specified record (next, previous, first, or last).|  \n  \n## Remarks  \n The view is a form view directly connected to a `CRowset` object. The view is created from a dialog template resource and displays the fields of the `CRowset` object in the dialog template's controls. The `COleDBRecordView` object uses dialog data exchange (DDX), and the navigational functionality built into `CRowset`, to automate the movement of data between the controls on the form and the fields of the rowset. `COleDBRecordView` also supplies a default implementation for moving to the first, next, previous, or last record and an interface for updating the record currently on view.  \n  \n You can use DDX functions with **COleDbRecordView** to get data directly from the database recordset and display it in a dialog control. You should use the **DDX_\\*** methods (such as `DDX_Text`), not the **DDX_Field\\*** functions (such as `DDX_FieldText`) with **COleDbRecordView**. `DDX_FieldText` will not work with **COleDbRecordView** because `DDX_FieldText` takes an additional argument of type **CRecordset\\*** (for `CRecordView`) or **CDaoRecordset\\*** (for `CDaoRecordView`).  \n  \n> [!NOTE]\n>  If you are working with the Data Access Objects (DAO) classes rather than the OLE DB Consumer Template classes, use class [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) instead. For more information, see the article [Overview: Database Programming](../../data/data-access-programming-mfc-atl.md).  \n  \n `COleDBRecordView` keeps track of the user's position in the rowset so that the record view can update the user interface. When the user moves to either end of the rowset, the record view disables user interface objects â€” such as menu items or toolbar buttons â€” for moving further in the same direction.  \n  \n For more information about rowset classes, see the [Using OLE DB Consumer Templates](../../data/oledb/ole-db-consumer-templates-cpp.md) article.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CView](../../mfc/reference/cview-class.md)  \n  \n [CScrollView](../../mfc/reference/cscrollview-class.md)  \n  \n [CFormView](../../mfc/reference/cformview-class.md)  \n  \n `COleDBRecordView`  \n  \n## Requirements  \n **Header:** afxoledb.h  \n  \n##  <a name=\"coledbrecordview__coledbrecordview\"></a>  COleDBRecordView::COleDBRecordView  \n Constructs a `COleDBRecordView` object.  \n  \n```  \nCOleDBRecordView(LPCTSTR lpszTemplateName);\n\n \nCOleDBRecordView(UINT nIDTemplate);\n```  \n  \n### Parameters  \n `lpszTemplateName`  \n Contains a null-terminated string that is the name of a dialog-template resource.  \n  \n `nIDTemplate`  \n Contains the ID number of a dialog-template resource.  \n  \n### Remarks  \n When you create an object of a type derived from `COleDBRecordView`, invoke one of the constructors to create the view object and identify the dialog resource on which the view is based. You can identify the resource either by name (pass a string as the argument to the constructor) or by its ID (pass an unsigned integer as the argument).  \n  \n> [!NOTE]\n>  Your derived class *must* supply its own constructor. In the constructor, invoke the constructor, `COleDBRecordView::COleDBRecordView`, with the resource name or ID as an argument.  \n  \n##  <a name=\"coledbrecordview__ongetrowset\"></a>  COleDBRecordView::OnGetRowset  \n Returns a handle for the **CRowset<>** object associated with the record view.  \n  \n```  \nvirtual CRowset<>* OnGetRowset(Â) = 0;  \n \n```  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n### Remarks  \n You must override this member function to construct or obtain a rowset object and return a handle to it. If you declare your record view class with ClassWizard, the wizard writes a default override for you. ClassWizard's default implementation returns the rowset handle stored in the record view if one exists. If not, it constructs a rowset object of the type you specified with ClassWizard and calls its **Open** member function to open the table or run the query, and then returns a handle to the object.  \n  \n> [!NOTE]\n>  Previous to MFC 7.0, `OnGetRowset` returned a pointer to `CRowset`. If you have code that calls `OnGetRowset`, you need to change the return type to the templatized class **CRowset<>**.  \n  \n### Example  \n [!code-cpp[NVC_MFCDatabase#38](../../mfc/codesnippet/cpp/coledbrecordview-class_1.cpp)]  \n  \n For more information and examples, see the article [Record Views: Using a Record View](../../data/using-a-record-view-mfc-data-access.md).  \n  \n##  <a name=\"coledbrecordview__onmove\"></a>  COleDBRecordView::OnMove  \n Moves to a different record in the rowset and display its fields in the controls of the record view.  \n  \n```  \nvirtual BOOL OnMove(UINT nIDMoveCommand);\n```  \n  \n### Parameters  \n `nIDMoveCommand`  \n One of the following standard command ID values:  \n  \n- `ID_RECORD_FIRST`Â Â Â Move to the first record in the recordset.  \n  \n- `ID_RECORD_LAST`Â Â Â Move to the last record in the recordset.  \n  \n- `ID_RECORD_NEXT`Â Â Â Move to the next record in the recordset.  \n  \n- `ID_RECORD_PREV`Â Â Â Move to the previous record in the recordset.  \n  \n### Return Value  \n Nonzero if the move was successful; otherwise 0 if the move request was denied.  \n  \n### Remarks  \n The default implementation calls the appropriate **Move** member function of the `CRowset` object associated with the record view.  \n  \n By default, `OnMove` updates the current record on the data source if the user has changed it in the record view.  \n  \n The Application Wizard creates a menu resource with First Record, Last Record, Next Record, and Previous Record menu items. If you select the Dockable Toolbar option, The Application Wizard also creates a toolbar with buttons corresponding to these commands.  \n  \n If you move past the last record in the recordset, the record view continues to display the last record. If you move backward past the first record, the record view continues to display the first record.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n\n\n"}