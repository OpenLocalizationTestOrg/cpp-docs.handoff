{"nodes":[{"pos":[12,58],"content":"Creating an Aggregated Object | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Creating an Aggregated Object | Microsoft Docs","pos":[0,46]}]},{"content":"Creating an Aggregated Object","pos":[654,683]},{"pos":[684,801],"content":"Aggregation delegates <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> calls, providing a pointer to the outer object's <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> to the inner object.","source":"Aggregation delegates **IUnknown** calls, providing a pointer to the outer object's **IUnknown** to the inner object."},{"content":"To create an aggregated object","pos":[811,841]},{"pos":[851,949],"content":"Add an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer to your class object and initialize it to <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> in the constructor.","source":"Add an **IUnknown** pointer to your class object and initialize it to **NULL** in the constructor."},{"pos":[959,1086],"content":"Override <bpt id=\"p1\">[</bpt>FinalConstruct<ept id=\"p1\">](../atl/reference/ccomobjectrootex-class.md#ccomobjectrootex__finalconstruct)</ept> to create the aggregate.","source":"Override [FinalConstruct](../atl/reference/ccomobjectrootex-class.md#ccomobjectrootex__finalconstruct) to create the aggregate."},{"pos":[1096,1288],"content":"Use the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer, defined in Step 1, as the second parameter for the <bpt id=\"p2\">[</bpt>COM_INTERFACE_ENTRY_AGGREGATE<ept id=\"p2\">](http://msdn.microsoft.com/library/c671fa40-a57b-4797-ae88-c9762dabd4dc)</ept> macros.","source":"Use the **IUnknown** pointer, defined in Step 1, as the second parameter for the [COM_INTERFACE_ENTRY_AGGREGATE](http://msdn.microsoft.com/library/c671fa40-a57b-4797-ae88-c9762dabd4dc) macros."},{"pos":[1298,1433],"content":"Override <bpt id=\"p1\">[</bpt>FinalRelease<ept id=\"p1\">](../atl/reference/ccomobjectrootex-class.md#ccomobjectrootex__finalrelease)</ept> to release the <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> pointer.","source":"Override [FinalRelease](../atl/reference/ccomobjectrootex-class.md#ccomobjectrootex__finalrelease) to release the **IUnknown** pointer."},{"pos":[1441,1710],"content":"[!NOTE]\n If you use and release an interface from the aggregated object during `FinalConstruct`, you should add the [DECLARE_PROTECT_FINAL_CONSTRUCT](http://msdn.microsoft.com/library/2d2e5ddc-057a-43ca-87c8-d3477a8193a0) macro to the definition of your class object.","leadings":["","> "],"nodes":[{"content":"If you use and release an interface from the aggregated object during <ph id=\"ph1\">`FinalConstruct`</ph>, you should add the <bpt id=\"p1\">[</bpt>DECLARE_PROTECT_FINAL_CONSTRUCT<ept id=\"p1\">](http://msdn.microsoft.com/library/2d2e5ddc-057a-43ca-87c8-d3477a8193a0)</ept> macro to the definition of your class object.","pos":[9,267],"source":" If you use and release an interface from the aggregated object during `FinalConstruct`, you should add the [DECLARE_PROTECT_FINAL_CONSTRUCT](http://msdn.microsoft.com/library/2d2e5ddc-057a-43ca-87c8-d3477a8193a0) macro to the definition of your class object."}]},{"content":"See Also","pos":[1719,1727]},{"content":"Fundamentals of ATL COM Objects","pos":[1732,1763]}],"content":"---\ntitle: \"Creating an Aggregated Object | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"aggregation [C++], creating aggregated objects\"\n  - \"aggregate objects [C++], creating\"\nms.assetid: fc29d7aa-fd53-4276-9c2f-37379f71b179\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Creating an Aggregated Object\nAggregation delegates **IUnknown** calls, providing a pointer to the outer object's **IUnknown** to the inner object.  \n  \n### To create an aggregated object  \n  \n1.  Add an **IUnknown** pointer to your class object and initialize it to **NULL** in the constructor.  \n  \n2.  Override [FinalConstruct](../atl/reference/ccomobjectrootex-class.md#ccomobjectrootex__finalconstruct) to create the aggregate.  \n  \n3.  Use the **IUnknown** pointer, defined in Step 1, as the second parameter for the [COM_INTERFACE_ENTRY_AGGREGATE](http://msdn.microsoft.com/library/c671fa40-a57b-4797-ae88-c9762dabd4dc) macros.  \n  \n4.  Override [FinalRelease](../atl/reference/ccomobjectrootex-class.md#ccomobjectrootex__finalrelease) to release the **IUnknown** pointer.  \n  \n> [!NOTE]\n>  If you use and release an interface from the aggregated object during `FinalConstruct`, you should add the [DECLARE_PROTECT_FINAL_CONSTRUCT](http://msdn.microsoft.com/library/2d2e5ddc-057a-43ca-87c8-d3477a8193a0) macro to the definition of your class object.  \n  \n## See Also  \n [Fundamentals of ATL COM Objects](../atl/fundamentals-of-atl-com-objects.md)\n\n"}