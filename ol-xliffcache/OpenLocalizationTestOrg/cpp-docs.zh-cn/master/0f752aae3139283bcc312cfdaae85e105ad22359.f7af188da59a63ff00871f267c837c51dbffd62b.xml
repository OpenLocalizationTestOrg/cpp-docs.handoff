{"nodes":[{"pos":[12,51],"content":"CPageSetupDialog Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CPageSetupDialog Class | Microsoft Docs","pos":[0,39]}]},{"content":"CPageSetupDialog Class","pos":[728,750]},{"content":"Encapsulates the services provided by the Windows common OLE Page Setup dialog box with additional support for setting and modifying print margins.","pos":[751,898]},{"content":"Syntax","pos":[907,913]},{"content":"Members","pos":[985,992]},{"content":"Public Constructors","pos":[1002,1021]},{"content":"Name","pos":[1028,1032]},{"content":"Description","pos":[1033,1044]},{"content":"CPageSetupDialog::CPageSetupDialog","pos":[1083,1117]},{"pos":[1156,1195],"content":"Constructs a <ph id=\"ph1\">`CPageSetupDialog`</ph> object.","source":"Constructs a `CPageSetupDialog` object."},{"content":"Public Methods","pos":[1206,1220]},{"content":"Name","pos":[1227,1231]},{"content":"Description","pos":[1232,1243]},{"content":"CPageSetupDialog::CreatePrinterDC","pos":[1282,1315]},{"content":"Creates a device context for printing.","pos":[1353,1391]},{"content":"CPageSetupDialog::DoModal","pos":[1397,1422]},{"content":"Displays the dialog box and allows the user make a selection.","pos":[1452,1513]},{"content":"CPageSetupDialog::GetDeviceName","pos":[1519,1550]},{"content":"Returns the device name of the printer.","pos":[1586,1625]},{"content":"CPageSetupDialog::GetDevMode","pos":[1631,1659]},{"pos":[1692,1737],"content":"Returns the current <ph id=\"ph1\">`DEVMODE`</ph> of the printer.","source":"Returns the current `DEVMODE` of the printer."},{"content":"CPageSetupDialog::GetDriverName","pos":[1743,1774]},{"content":"Returns the driver used by the printer.","pos":[1810,1849]},{"content":"CPageSetupDialog::GetMargins","pos":[1855,1883]},{"content":"Returns the current margin settings of the printer.","pos":[1916,1967]},{"content":"CPageSetupDialog::GetPaperSize","pos":[1973,2003]},{"content":"Returns the paper size of the printer.","pos":[2038,2076]},{"content":"CPageSetupDialog::GetPortName","pos":[2082,2111]},{"content":"Returns the output port name.","pos":[2145,2174]},{"content":"CPageSetupDialog::OnDrawPage","pos":[2180,2208]},{"content":"Called by the framework to render a screen image of a printed page.","pos":[2241,2308]},{"content":"CPageSetupDialog::PreDrawPage","pos":[2314,2343]},{"content":"Called by the framework before rendering a screen image of a printed page.","pos":[2377,2451]},{"content":"Public Data Members","pos":[2462,2481]},{"content":"Name","pos":[2488,2492]},{"content":"Description","pos":[2493,2504]},{"content":"CPageSetupDialog::m_psd","pos":[2543,2566]},{"pos":[2594,2652],"content":"A structure used to customize a <ph id=\"ph1\">`CPageSetupDialog`</ph> object.","source":"A structure used to customize a `CPageSetupDialog` object."},{"content":"Remarks","pos":[2662,2669]},{"content":"This class is designed to take the place of the Print Setup dialog box.","pos":[2673,2744]},{"content":"To use a <ph id=\"ph1\">`CPageSetupDialog`</ph> object, first create the object using the <ph id=\"ph2\">`CPageSetupDialog`</ph> constructor.","pos":[2751,2852],"source":"To use a `CPageSetupDialog` object, first create the object using the `CPageSetupDialog` constructor."},{"content":"Once the dialog box has been constructed, you can set or modify any values in the <ph id=\"ph1\">`m_psd`</ph> data member to initialize the values of the dialog box's controls.","pos":[2853,3009],"source":" Once the dialog box has been constructed, you can set or modify any values in the `m_psd` data member to initialize the values of the dialog box's controls."},{"content":"The <bpt id=\"p1\">[</bpt>m_psd<ept id=\"p1\">](#cpagesetupdialog__m_psd)</ept> structure is of type <bpt id=\"p2\">**</bpt>PAGESETUPDLG<ept id=\"p2\">**</ept>.","pos":[3010,3086],"source":" The [m_psd](#cpagesetupdialog__m_psd) structure is of type **PAGESETUPDLG**."},{"content":"After initializing the dialog box controls, call the <ph id=\"ph1\">`DoModal`</ph> member function to display the dialog box and allow the user to select print options.","pos":[3093,3241],"source":"After initializing the dialog box controls, call the `DoModal` member function to display the dialog box and allow the user to select print options."},{"content":"returns whether the user selected the OK ( <bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept>) or Cancel ( <bpt id=\"p2\">**</bpt>IDCANCEL<ept id=\"p2\">**</ept>) button.","pos":[3252,3338],"source":" returns whether the user selected the OK ( **IDOK**) or Cancel ( **IDCANCEL**) button."},{"pos":[3345,3515],"content":"If <ph id=\"ph1\">`DoModal`</ph> returns <bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept>, you can use several of <ph id=\"ph2\">`CPageSetupDialog`</ph>'s member functions, or access the <ph id=\"ph3\">`m_psd`</ph> data member, to retrieve information input by the user.","source":"If `DoModal` returns **IDOK**, you can use several of `CPageSetupDialog`'s member functions, or access the `m_psd` data member, to retrieve information input by the user."},{"pos":[3523,3822],"content":"[!NOTE]\n After the common OLE Page Setup dialog box is dismissed, any changes made by the user will not be saved by the framework. It is up to the application itself to save any values from this dialog box to a permanent location, such as member of the application's document or application class.","leadings":["","> "],"nodes":[{"content":" After the common OLE Page Setup dialog box is dismissed, any changes made by the user will not be saved by the framework. It is up to the application itself to save any values from this dialog box to a permanent location, such as member of the application's document or application class.","pos":[8,297],"nodes":[{"content":"After the common OLE Page Setup dialog box is dismissed, any changes made by the user will not be saved by the framework.","pos":[1,122]},{"content":"It is up to the application itself to save any values from this dialog box to a permanent location, such as member of the application's document or application class.","pos":[123,289]}]}]},{"content":"Inheritance Hierarchy","pos":[3831,3852]},{"content":"CObject","pos":[3857,3864]},{"content":"CCmdTarget","pos":[3911,3921]},{"content":"CWnd","pos":[3971,3975]},{"content":"CDialog","pos":[4019,4026]},{"content":"CCommonDialog","pos":[4073,4086]},{"content":"Requirements","pos":[4165,4177]},{"pos":[4181,4202],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdlgs.h","source":"**Header:** afxdlgs.h"},{"pos":[4263,4297],"content":"CPageSetupDialog::CPageSetupDialog"},{"pos":[4301,4361],"content":"Call this function to construct a <ph id=\"ph1\">`CPageSetupDialog`</ph> object.","source":"Call this function to construct a `CPageSetupDialog` object."},{"content":"Parameters","pos":[4495,4505]},{"content":"One or more flags you can use to customize the settings of the dialog box.","pos":[4522,4596]},{"content":"The values can be combined using the bitwise-OR operator.","pos":[4597,4654]},{"content":"These values have the following meanings:","pos":[4655,4696]},{"content":"<bpt id=\"p1\">**</bpt>PSD_DEFAULTMINMARGINS<ept id=\"p1\">**</ept> Sets the minimum allowable widths for the page margins to be the same as the printer's minimums.","pos":[4704,4826],"source":"**PSD_DEFAULTMINMARGINS** Sets the minimum allowable widths for the page margins to be the same as the printer's minimums."},{"content":"This flag is ignored if the <bpt id=\"p1\">**</bpt>PSD_MARGINS<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>PSD_MINMARGINS<ept id=\"p2\">**</ept> flags are also specified.","pos":[4827,4919],"source":" This flag is ignored if the **PSD_MARGINS** and **PSD_MINMARGINS** flags are also specified."},{"pos":[4927,4971],"content":"<bpt id=\"p1\">**</bpt>PSD_INWININIINTLMEASURE<ept id=\"p1\">**</ept> Not implemented.","source":"**PSD_INWININIINTLMEASURE** Not implemented."},{"content":"<bpt id=\"p1\">**</bpt>PSD_MINMARGINS<ept id=\"p1\">**</ept> Causes the system to use the values specified in the <bpt id=\"p2\">**</bpt>rtMinMargin<ept id=\"p2\">**</ept> member as the minimum allowable widths for the left, top, right, and bottom margins.","pos":[4979,5151],"source":"**PSD_MINMARGINS** Causes the system to use the values specified in the **rtMinMargin** member as the minimum allowable widths for the left, top, right, and bottom margins."},{"content":"The system prevents the user from entering a width that is less than the specified minimum.","pos":[5152,5243]},{"content":"If <bpt id=\"p1\">**</bpt>PSD_MINMARGINS<ept id=\"p1\">**</ept> is not specified, the system sets the minimum allowable widths to those allowed by the printer.","pos":[5244,5361],"source":" If **PSD_MINMARGINS** is not specified, the system sets the minimum allowable widths to those allowed by the printer."},{"pos":[5369,5419],"content":"<bpt id=\"p1\">**</bpt>PSD_MARGINS<ept id=\"p1\">**</ept> Activates the margin control area.","source":"**PSD_MARGINS** Activates the margin control area."},{"pos":[5427,5528],"content":"<bpt id=\"p1\">**</bpt>PSD_INTHOUSANDTHSOFINCHES<ept id=\"p1\">**</ept> Causes the units of the dialog box to be measured in 1/1000 of an inch.","source":"**PSD_INTHOUSANDTHSOFINCHES** Causes the units of the dialog box to be measured in 1/1000 of an inch."},{"pos":[5536,5645],"content":"<bpt id=\"p1\">**</bpt>PSD_INHUNDREDTHSOFMILLIMETERS<ept id=\"p1\">**</ept> Causes the units of the dialog box to be measured in 1/100 of a millimeter.","source":"**PSD_INHUNDREDTHSOFMILLIMETERS** Causes the units of the dialog box to be measured in 1/100 of a millimeter."},{"pos":[5653,5716],"content":"<bpt id=\"p1\">**</bpt>PSD_DISABLEMARGINS<ept id=\"p1\">**</ept> Disables the margin dialog box controls.","source":"**PSD_DISABLEMARGINS** Disables the margin dialog box controls."},{"pos":[5724,5775],"content":"<bpt id=\"p1\">**</bpt>PSD_DISABLEPRINTER<ept id=\"p1\">**</ept> Disables the Printer button.","source":"**PSD_DISABLEPRINTER** Disables the Printer button."},{"pos":[5783,5884],"content":"<bpt id=\"p1\">**</bpt>PSD_NOWARNING<ept id=\"p1\">**</ept> Prevents the warning message from being displayed when there is no default printer.","source":"**PSD_NOWARNING** Prevents the warning message from being displayed when there is no default printer."},{"pos":[5892,5964],"content":"<bpt id=\"p1\">**</bpt>PSD_DISABLEORIENTATION<ept id=\"p1\">**</ept> Disables the page orientation dialog control.","source":"**PSD_DISABLEORIENTATION** Disables the page orientation dialog control."},{"content":"<bpt id=\"p1\">**</bpt>PSD_RETURNDEFAULT<ept id=\"p1\">**</ept> Causes <ph id=\"ph1\">`CPageSetupDialog`</ph> to return <bpt id=\"p2\">[</bpt>DEVMODE<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/dd183565)</ept> and <bpt id=\"p3\">[</bpt>DEVNAMES<ept id=\"p3\">](../../mfc/reference/devnames-structure.md)</ept> structures that are initialized for the system default printer without displaying a dialog box.","pos":[5972,6253],"source":"**PSD_RETURNDEFAULT** Causes `CPageSetupDialog` to return [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) and [DEVNAMES](../../mfc/reference/devnames-structure.md) structures that are initialized for the system default printer without displaying a dialog box."},{"content":"It is assumed that both <bpt id=\"p1\">**</bpt>hDevNames<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>hDevMode<ept id=\"p2\">**</ept> are <bpt id=\"p3\">**</bpt>NULL<ept id=\"p3\">**</ept>; otherwise, the function returns an error.","pos":[6254,6364],"source":" It is assumed that both **hDevNames** and **hDevMode** are **NULL**; otherwise, the function returns an error."},{"content":"If the system default printer is supported by an old printer driver (earlier than Windows version 3.0), only <bpt id=\"p1\">**</bpt>hDevNames<ept id=\"p1\">**</ept> is returned; <bpt id=\"p2\">**</bpt>hDevMode<ept id=\"p2\">**</ept> is <bpt id=\"p3\">**</bpt>NULL<ept id=\"p3\">**</ept>.","pos":[6365,6526],"source":" If the system default printer is supported by an old printer driver (earlier than Windows version 3.0), only **hDevNames** is returned; **hDevMode** is **NULL**."},{"pos":[6534,6592],"content":"<bpt id=\"p1\">**</bpt>PSD_DISABLEPAPER<ept id=\"p1\">**</ept> Disables the paper selection control.","source":"**PSD_DISABLEPAPER** Disables the paper selection control."},{"content":"<bpt id=\"p1\">**</bpt>PSD_SHOWHELP<ept id=\"p1\">**</ept> Causes the dialog box to show the Help button.","pos":[6600,6663],"source":"**PSD_SHOWHELP** Causes the dialog box to show the Help button."},{"content":"The <bpt id=\"p1\">**</bpt>hwndOwner<ept id=\"p1\">**</ept> member must not be <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> if this flag is specified.","pos":[6664,6736],"source":" The **hwndOwner** member must not be **NULL** if this flag is specified."},{"pos":[6744,6829],"content":"<bpt id=\"p1\">**</bpt>PSD_ENABLEPAGESETUPHOOK<ept id=\"p1\">**</ept> Enables the hook function specified in <bpt id=\"p2\">**</bpt>lpfnSetupHook<ept id=\"p2\">**</ept>.","source":"**PSD_ENABLEPAGESETUPHOOK** Enables the hook function specified in **lpfnSetupHook**."},{"pos":[6837,7011],"content":"<bpt id=\"p1\">**</bpt>PSD_ENABLEPAGESETUPTEMPLATE<ept id=\"p1\">**</ept> Causes the operating system to create the dialog box by using the dialog template box identified by <bpt id=\"p2\">**</bpt>hInstance<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>lpSetupTemplateName<ept id=\"p3\">**</ept>.","source":"**PSD_ENABLEPAGESETUPTEMPLATE** Causes the operating system to create the dialog box by using the dialog template box identified by **hInstance** and **lpSetupTemplateName**."},{"content":"<bpt id=\"p1\">**</bpt>PSD_ENABLEPAGESETUPTEMPLATEHANDLE<ept id=\"p1\">**</ept> Indicates that <bpt id=\"p2\">**</bpt>hInstance<ept id=\"p2\">**</ept> identifies a data block that contains a preloaded dialog box template.","pos":[7019,7156],"source":"**PSD_ENABLEPAGESETUPTEMPLATEHANDLE** Indicates that **hInstance** identifies a data block that contains a preloaded dialog box template."},{"content":"The system ignores <bpt id=\"p1\">**</bpt>lpSetupTemplateName<ept id=\"p1\">**</ept> if this flag is specified.","pos":[7157,7226],"source":" The system ignores **lpSetupTemplateName** if this flag is specified."},{"pos":[7234,7323],"content":"<bpt id=\"p1\">**</bpt>PSD_ENABLEPAGEPAINTHOOK<ept id=\"p1\">**</ept> Enables the hook function specified in <bpt id=\"p2\">**</bpt>lpfnPagePaintHook<ept id=\"p2\">**</ept>.","source":"**PSD_ENABLEPAGEPAINTHOOK** Enables the hook function specified in **lpfnPagePaintHook**."},{"pos":[7331,7400],"content":"<bpt id=\"p1\">**</bpt>PSD_DISABLEPAGEPAINTING<ept id=\"p1\">**</ept> Disables the draw area of the dialog box.","source":"**PSD_DISABLEPAGEPAINTING** Disables the draw area of the dialog box."},{"pos":[7407,7467],"content":"`pParentWnd`  \nPointer to the dialog box's parent or owner.","leadings":[""," "],"nodes":[{"content":"Pointer to the dialog box's parent or owner.","pos":[15,59]}]},{"content":"Remarks","pos":[7477,7484]},{"pos":[7488,7596],"content":"Use the <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](../../mfc/reference/cdialog-class.md#cdialog__domodal)</ept> function to display the dialog box.","source":"Use the [DoModal](../../mfc/reference/cdialog-class.md#cdialog__domodal) function to display the dialog box."},{"content":"Example","pos":[7606,7613]},{"pos":[7628,7645],"content":"NVC_MFCDocView#94"},{"pos":[7763,7796],"content":"CPageSetupDialog::CreatePrinterDC"},{"pos":[7800,7981],"content":"Creates a printer device context from the <bpt id=\"p1\">[</bpt>DEVMODE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183565)</ept> and <bpt id=\"p2\">[</bpt>DEVNAMES<ept id=\"p2\">](../../mfc/reference/devnames-structure.md)</ept> structures.","source":"Creates a printer device context from the [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) and [DEVNAMES](../../mfc/reference/devnames-structure.md) structures."},{"content":"Return Value","pos":[8029,8041]},{"content":"Handle to the newly created printer device context (DC).","pos":[8045,8101]},{"pos":[8153,8178],"content":"CPageSetupDialog::DoModal"},{"content":"Call this function to display the Windows common OLE Page Setup dialog box and allow the user to select various print setup options such as the printing margins, size and orientation of the paper, and destination printer.","pos":[8182,8403]},{"content":"Return Value","pos":[8455,8467]},{"content":"<bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>IDCANCEL<ept id=\"p2\">**</ept>.","pos":[8471,8496],"source":"**IDOK** or **IDCANCEL**."},{"content":"If <bpt id=\"p1\">**</bpt>IDCANCEL<ept id=\"p1\">**</ept> is returned, call the Windows <bpt id=\"p2\">[</bpt>CommDlgExtendedError<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms646916)</ept> function to determine whether an error occurred.","pos":[8497,8674],"source":" If **IDCANCEL** is returned, call the Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) function to determine whether an error occurred."},{"pos":[8681,8785],"content":"<bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>IDCANCEL<ept id=\"p2\">**</ept> are constants that indicate whether the user selected the OK or Cancel button.","source":"**IDOK** and **IDCANCEL** are constants that indicate whether the user selected the OK or Cancel button."},{"content":"Remarks","pos":[8795,8802]},{"content":"In addition, the user can access the printer setup options such as network location and properties specific to the selected printer.","pos":[8806,8938]},{"content":"If you want to initialize the various Page Setup dialog options by setting members of the <ph id=\"ph1\">`m_psd`</ph> structure, you should do so before calling <ph id=\"ph2\">`DoModal`</ph>, and after the dialog object is constructed.","pos":[8945,9140],"source":"If you want to initialize the various Page Setup dialog options by setting members of the `m_psd` structure, you should do so before calling `DoModal`, and after the dialog object is constructed."},{"content":"After calling <ph id=\"ph1\">`DoModal`</ph>, call other member functions to retrieve the settings or information input by the user into the dialog box.","pos":[9141,9272],"source":" After calling `DoModal`, call other member functions to retrieve the settings or information input by the user into the dialog box."},{"content":"If you want to propagate the current settings entered by the user, make a call to <bpt id=\"p1\">[</bpt>CWinApp::SelectPrinter<ept id=\"p1\">](../../mfc/reference/cwinapp-class.md#cwinapp__selectprinter)</ept>.","pos":[9279,9447],"source":"If you want to propagate the current settings entered by the user, make a call to [CWinApp::SelectPrinter](../../mfc/reference/cwinapp-class.md#cwinapp__selectprinter)."},{"content":"This function takes the information from the <ph id=\"ph1\">`CPageSetupDialog`</ph> object and initializes and selects a new printer DC with the proper attributes.","pos":[9448,9591],"source":" This function takes the information from the `CPageSetupDialog` object and initializes and selects a new printer DC with the proper attributes."},{"pos":[9609,9626],"content":"NVC_MFCDocView#95"},{"content":"Example","pos":[9694,9701]},{"pos":[9706,9800],"content":"See the example for <bpt id=\"p1\">[</bpt>CPageSetupDialog::CPageSetupDialog<ept id=\"p1\">](#cpagesetupdialog__cpagesetupdialog)</ept>.","source":"See the example for [CPageSetupDialog::CPageSetupDialog](#cpagesetupdialog__cpagesetupdialog)."},{"pos":[9858,9889],"content":"CPageSetupDialog::GetDeviceName"},{"pos":[9893,9983],"content":"Call this function after <ph id=\"ph1\">`DoModal`</ph> to retrieve the name of the currently selected printer.","source":"Call this function after `DoModal` to retrieve the name of the currently selected printer."},{"content":"Return Value","pos":[10042,10054]},{"pos":[10058,10114],"content":"The device name used by the <bpt id=\"p1\">**</bpt>CPageSetupDialog<ept id=\"p1\">**</ept> object.","source":"The device name used by the **CPageSetupDialog** object."},{"pos":[10169,10197],"content":"CPageSetupDialog::GetDevMode"},{"pos":[10201,10334],"content":"Call this function after calling <ph id=\"ph1\">`DoModal`</ph> to retrieve information about the printer device context of the <ph id=\"ph2\">`CPageSetupDialog`</ph> object.","source":"Call this function after calling `DoModal` to retrieve information about the printer device context of the `CPageSetupDialog` object."},{"content":"Return Value","pos":[10392,10404]},{"content":"The <bpt id=\"p1\">[</bpt>DEVMODE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183565)</ept> data structure, which contains information about the device initialization and environment of a print driver.","pos":[10408,10591],"source":"The [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) data structure, which contains information about the device initialization and environment of a print driver."},{"content":"You must unlock the memory taken by this structure with the Windows <bpt id=\"p1\">[</bpt>GlobalUnlock<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa366595)</ept> function, which is described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[10592,10823],"source":" You must unlock the memory taken by this structure with the Windows [GlobalUnlock](http://msdn.microsoft.com/library/windows/desktop/aa366595) function, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[10881,10912],"content":"CPageSetupDialog::GetDriverName"},{"pos":[10916,11089],"content":"Call this function after calling <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](../../mfc/reference/cprintdialog-class.md#cprintdialog__domodal)</ept> to retrieve the name of the system-defined printer device driver.","source":"Call this function after calling [DoModal](../../mfc/reference/cprintdialog-class.md#cprintdialog__domodal) to retrieve the name of the system-defined printer device driver."},{"content":"Return Value","pos":[11148,11160]},{"pos":[11164,11218],"content":"A <ph id=\"ph1\">`CString`</ph> specifying the system-defined driver name.","source":"A `CString` specifying the system-defined driver name."},{"content":"Remarks","pos":[11228,11235]},{"pos":[11239,11415],"content":"Use a pointer to the <ph id=\"ph1\">`CString`</ph> object returned by <ph id=\"ph2\">`GetDriverName`</ph> as the value of <ph id=\"ph3\">`lpszDriverName`</ph> in a call to <bpt id=\"p1\">[</bpt>CDC::CreateDC<ept id=\"p1\">](../../mfc/reference/cdc-class.md#cdc__createdc)</ept>.","source":"Use a pointer to the `CString` object returned by `GetDriverName` as the value of `lpszDriverName` in a call to [CDC::CreateDC](../../mfc/reference/cdc-class.md#cdc__createdc)."},{"pos":[11470,11498],"content":"CPageSetupDialog::GetMargins"},{"pos":[11502,11600],"content":"Call this function after a call to <ph id=\"ph1\">`DoModal`</ph> to retrieve the margins of the printer device driver.","source":"Call this function after a call to `DoModal` to retrieve the margins of the printer device driver."},{"content":"Parameters","pos":[11709,11719]},{"content":"lpRectMargins","pos":[11724,11737]},{"content":"Pointer to a <bpt id=\"p1\">[</bpt>RECT<ept id=\"p1\">](https://www.microsoftonedoc.com/#/organizations/e6f6a65cf14f462597b64ac058dbe1d0/projects/3fedad16-eaf1-41a6-8f96-0c1949c68f32/containers/a3daf831-1c5f-4bbe-964d-503870caf874/tocpaths/18113766-3975-4369-bc07-92e34cba712e/locales/en-us)</ept> structure or <bpt id=\"p2\">[</bpt>CRect<ept id=\"p2\">](../../atl-mfc-shared/reference/crect-class.md)</ept> object that describes (in 1/1000 inches or 1/100 mm) the print margins for the currently selected printer.","pos":[11742,12172],"source":" Pointer to a [RECT](https://www.microsoftonedoc.com/#/organizations/e6f6a65cf14f462597b64ac058dbe1d0/projects/3fedad16-eaf1-41a6-8f96-0c1949c68f32/containers/a3daf831-1c5f-4bbe-964d-503870caf874/tocpaths/18113766-3975-4369-bc07-92e34cba712e/locales/en-us) structure or [CRect](../../atl-mfc-shared/reference/crect-class.md) object that describes (in 1/1000 inches or 1/100 mm) the print margins for the currently selected printer."},{"content":"Pass <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> for this parameter, if you are not interested in this rectangle.","pos":[12173,12251],"source":" Pass **NULL** for this parameter, if you are not interested in this rectangle."},{"content":"lpRectMinMargins","pos":[12259,12275]},{"content":"Pointer to a <ph id=\"ph1\">`RECT`</ph> structure or <ph id=\"ph2\">`CRect`</ph> object that describes (in 1/1000 inches or 1/100 mm) the minimum print margins for the currently selected printer.","pos":[12280,12435],"source":" Pointer to a `RECT` structure or `CRect` object that describes (in 1/1000 inches or 1/100 mm) the minimum print margins for the currently selected printer."},{"content":"Pass <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> for this parameter, if you are not interested in this rectangle.","pos":[12436,12514],"source":" Pass **NULL** for this parameter, if you are not interested in this rectangle."},{"pos":[12571,12601],"content":"CPageSetupDialog::GetPaperSize"},{"content":"Call this function to retrieve the size of the paper selected for printing.","pos":[12605,12680]},{"content":"Return Value","pos":[12736,12748]},{"pos":[12752,12902],"content":"A <bpt id=\"p1\">[</bpt>CSize<ept id=\"p1\">](../../atl-mfc-shared/reference/csize-class.md)</ept> object containing the size of the paper (in 1/1000 inches or 1/100 mm) selected for printing.","source":"A [CSize](../../atl-mfc-shared/reference/csize-class.md) object containing the size of the paper (in 1/1000 inches or 1/100 mm) selected for printing."},{"pos":[12958,12987],"content":"CPageSetupDialog::GetPortName"},{"pos":[12991,13094],"content":"Call this function after calling <ph id=\"ph1\">`DoModal`</ph> to retrieve the name of the currently selected printer port.","source":"Call this function after calling `DoModal` to retrieve the name of the currently selected printer port."},{"content":"Return Value","pos":[13151,13163]},{"content":"The name of the currently selected printer port.","pos":[13167,13215]},{"pos":[13265,13288],"content":"CPageSetupDialog::m_psd"},{"pos":[13292,13391],"content":"A structure of type <bpt id=\"p1\">**</bpt>PAGESETUPDLG<ept id=\"p1\">**</ept>, whose members store the characteristics of the dialog object.","source":"A structure of type **PAGESETUPDLG**, whose members store the characteristics of the dialog object."},{"content":"Remarks","pos":[13438,13445]},{"pos":[13449,13603],"content":"After constructing a <ph id=\"ph1\">`CPageSetupDialog`</ph> object, you can use <ph id=\"ph2\">`m_psd`</ph> to set various aspects of the dialog box before calling the <ph id=\"ph3\">`DoModal`</ph> member function.","source":"After constructing a `CPageSetupDialog` object, you can use `m_psd` to set various aspects of the dialog box before calling the `DoModal` member function."},{"pos":[13610,13697],"content":"If you modify the <ph id=\"ph1\">`m_psd`</ph> data member directly, you will override any default behavior.","source":"If you modify the `m_psd` data member directly, you will override any default behavior."},{"pos":[13704,13878],"content":"For more information on the <bpt id=\"p1\">[</bpt>PAGESETUPDLG<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms646842)</ept> structure, see the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on the [PAGESETUPDLG](http://msdn.microsoft.com/library/windows/desktop/ms646842) structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[13885,13979],"content":"See the example for <bpt id=\"p1\">[</bpt>CPageSetupDialog::CPageSetupDialog<ept id=\"p1\">](#cpagesetupdialog__cpagesetupdialog)</ept>.","source":"See the example for [CPageSetupDialog::CPageSetupDialog](#cpagesetupdialog__cpagesetupdialog)."},{"pos":[14034,14062],"content":"CPageSetupDialog::OnDrawPage"},{"content":"Called by the framework to draw a screen image of a printed page.","pos":[14066,14131]},{"content":"Parameters","pos":[14238,14248]},{"content":"Pointer to the printer device context.","pos":[14261,14299]},{"content":"Specifies a message, indicating the area of the page currently being drawn.","pos":[14320,14395]},{"content":"Can be one of the following:","pos":[14396,14424]},{"pos":[14432,14477],"content":"<bpt id=\"p1\">**</bpt>WM_PSD_FULLPAGERECT<ept id=\"p1\">**</ept> The entire page area.","source":"**WM_PSD_FULLPAGERECT** The entire page area."},{"pos":[14485,14534],"content":"<bpt id=\"p1\">**</bpt>WM_PSD_MINMARGINRECT<ept id=\"p1\">**</ept> Current minimum margins.","source":"**WM_PSD_MINMARGINRECT** Current minimum margins."},{"pos":[14542,14580],"content":"<bpt id=\"p1\">**</bpt>WM_PSD_MARGINRECT<ept id=\"p1\">**</ept> Current margins.","source":"**WM_PSD_MARGINRECT** Current margins."},{"pos":[14588,14634],"content":"<bpt id=\"p1\">**</bpt>WM_PSD_GREEKTEXTRECT<ept id=\"p1\">**</ept> Contents of the page.","source":"**WM_PSD_GREEKTEXTRECT** Contents of the page."},{"pos":[14642,14715],"content":"<bpt id=\"p1\">**</bpt>WM_PSD_ENVSTAMPRECT<ept id=\"p1\">**</ept> Area reserved for a postage stamp representation.","source":"**WM_PSD_ENVSTAMPRECT** Area reserved for a postage stamp representation."},{"content":"<bpt id=\"p1\">**</bpt>WM_PSD_YAFULLPAGERECT<ept id=\"p1\">**</ept> Area for a return address representation.","pos":[14723,14790],"source":"**WM_PSD_YAFULLPAGERECT** Area for a return address representation."},{"content":"This area extends to the edges of the sample page area.","pos":[14791,14846]},{"pos":[14853,15233],"content":"`lpRect`  \nPointer to a [CRect](../../atl-mfc-shared/reference/crect-class.md) or [RECT](https://www.microsoftonedoc.com/#/organizations/e6f6a65cf14f462597b64ac058dbe1d0/projects/3fedad16-eaf1-41a6-8f96-0c1949c68f32/containers/a3daf831-1c5f-4bbe-964d-503870caf874/tocpaths/18113766-3975-4369-bc07-92e34cba712e/locales/en-us) object containing the coordinates of the drawing area.","leadings":[""," "],"nodes":[{"content":"Pointer to a <bpt id=\"p1\">[</bpt>CRect<ept id=\"p1\">](../../atl-mfc-shared/reference/crect-class.md)</ept> or <bpt id=\"p2\">[</bpt>RECT<ept id=\"p2\">](https://www.microsoftonedoc.com/#/organizations/e6f6a65cf14f462597b64ac058dbe1d0/projects/3fedad16-eaf1-41a6-8f96-0c1949c68f32/containers/a3daf831-1c5f-4bbe-964d-503870caf874/tocpaths/18113766-3975-4369-bc07-92e34cba712e/locales/en-us)</ept> object containing the coordinates of the drawing area.","pos":[11,379],"source":"Pointer to a [CRect](../../atl-mfc-shared/reference/crect-class.md) or [RECT](https://www.microsoftonedoc.com/#/organizations/e6f6a65cf14f462597b64ac058dbe1d0/projects/3fedad16-eaf1-41a6-8f96-0c1949c68f32/containers/a3daf831-1c5f-4bbe-964d-503870caf874/tocpaths/18113766-3975-4369-bc07-92e34cba712e/locales/en-us) object containing the coordinates of the drawing area."}]},{"content":"Return Value","pos":[15243,15255]},{"content":"Nonzero value if handled; otherwise 0.","pos":[15259,15297]},{"content":"Remarks","pos":[15307,15314]},{"content":"This image is then displayed as part of the common OLE Page Setup dialog box.","pos":[15318,15395]},{"content":"The default implementation draws an image of a page of text.","pos":[15396,15456]},{"content":"Override this function to customize the drawing of a specific area of the image, or the entire image.","pos":[15463,15564]},{"content":"You can do this by using a <ph id=\"ph1\">`switch`</ph> statement with <bpt id=\"p1\">**</bpt>case<ept id=\"p1\">**</ept> statements checking the value of <ph id=\"ph2\">`nMessage`</ph>.","pos":[15565,15669],"source":" You can do this by using a `switch` statement with **case** statements checking the value of `nMessage`."},{"content":"For example, to customize the rendering of the contents of the page image, you could use the following example code:","pos":[15670,15786]},{"pos":[15804,15821],"content":"NVC_MFCDocView#96"},{"content":"Note that you do not need to handle every case of <ph id=\"ph1\">`nMessage`</ph>.","pos":[15886,15947],"source":"Note that you do not need to handle every case of `nMessage`."},{"content":"You can choose to handle one component of the image, several components of the image, or the whole area.","pos":[15948,16052]},{"pos":[16108,16137],"content":"CPageSetupDialog::PreDrawPage"},{"content":"Called by the framework before drawing the screen image of a printed page.","pos":[16141,16215]},{"content":"Parameters","pos":[16330,16340]},{"content":"wPaper","pos":[16345,16351]},{"content":"Specifies a value that indicates the paper size.","pos":[16356,16404]},{"content":"This value can be one of the <bpt id=\"p1\">**</bpt>DMPAPER_<ept id=\"p1\">**</ept> values listed in the description of the <bpt id=\"p2\">[</bpt>DEVMODE<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/dd183565)</ept> structure.","pos":[16405,16567],"source":" This value can be one of the **DMPAPER_** values listed in the description of the [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) structure."},{"content":"Indicates the orientation of the paper or envelope, and whether the printer is a dot-matrix or HPPCL (Hewlett Packard Printer Control Language) device.","pos":[16586,16737]},{"content":"This parameter can have one of the following values:","pos":[16738,16790]},{"content":"0x001   Paper in landscape mode (dot matrix)","pos":[16800,16844]},{"content":"0x003   Paper in landscape mode (HPPCL)","pos":[16854,16893]},{"content":"0x005   Paper in portrait mode (dot matrix)","pos":[16903,16946]},{"content":"0x007   Paper in portrait mode (HPPCL)","pos":[16956,16994]},{"content":"0x00b   Envelope in landscape mode (HPPCL)","pos":[17004,17046]},{"content":"0x00d   Envelope in portrait mode (dot matrix)","pos":[17056,17102]},{"content":"0x019   Envelope in landscape mode (dot matrix)","pos":[17112,17159]},{"content":"0x01f   Envelope in portrait mode (dot matrix)","pos":[17169,17215]},{"pos":[17222,17433],"content":"`pPSD`  \nPointer to a **PAGESETUPDLG** structure. For more information on [PAGESETUPDLG](http://msdn.microsoft.com/library/windows/desktop/ms646842), see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].","leadings":[""," "],"nodes":[{"content":"Pointer to a **PAGESETUPDLG** structure. For more information on [PAGESETUPDLG](http://msdn.microsoft.com/library/windows/desktop/ms646842), see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].","pos":[9,210],"nodes":[{"content":"Pointer to a <bpt id=\"p1\">**</bpt>PAGESETUPDLG<ept id=\"p1\">**</ept> structure.","pos":[0,40],"source":"Pointer to a **PAGESETUPDLG** structure."},{"content":"For more information on <bpt id=\"p1\">[</bpt>PAGESETUPDLG<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms646842)</ept>, see the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[41,201],"source":" For more information on [PAGESETUPDLG](http://msdn.microsoft.com/library/windows/desktop/ms646842), see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."}]}]},{"content":"Return Value","pos":[17443,17455]},{"content":"Nonzero value if handled; otherwise 0.","pos":[17459,17497]},{"content":"Remarks","pos":[17507,17514]},{"content":"Override this function to customize the drawing of the image.","pos":[17518,17579]},{"content":"If you override this function and return <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, you must draw the entire image.","pos":[17580,17662],"source":" If you override this function and return **TRUE**, you must draw the entire image."},{"content":"If you override this function and return <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, the entire default image is drawn by the framework.","pos":[17663,17766],"source":" If you override this function and return **FALSE**, the entire default image is drawn by the framework."},{"content":"See Also","pos":[17775,17783]},{"content":"MFC Sample WORDPAD","pos":[17788,17806]},{"content":"CCommonDialog Class","pos":[17842,17861]},{"content":"Hierarchy Chart","pos":[17912,17927]}],"content":"---\ntitle: \"CPageSetupDialog Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CPageSetupDialog\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"page setup\"\n  - \"Print Setup dialog box\"\n  - \"Page Setup dialog box\"\n  - \"OLE Page Setup dialog box\"\n  - \"CPageSetupDialog class\"\nms.assetid: 049c0ac8-f254-4854-9414-7a8271d1447a\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CPageSetupDialog Class\nEncapsulates the services provided by the Windows common OLE Page Setup dialog box with additional support for setting and modifying print margins.  \n  \n## Syntax  \n  \n```  \nclass CPageSetupDialog : public CCommonDialog  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPageSetupDialog::CPageSetupDialog](#cpagesetupdialog__cpagesetupdialog)|Constructs a `CPageSetupDialog` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPageSetupDialog::CreatePrinterDC](#cpagesetupdialog__createprinterdc)|Creates a device context for printing.|  \n|[CPageSetupDialog::DoModal](#cpagesetupdialog__domodal)|Displays the dialog box and allows the user make a selection.|  \n|[CPageSetupDialog::GetDeviceName](#cpagesetupdialog__getdevicename)|Returns the device name of the printer.|  \n|[CPageSetupDialog::GetDevMode](#cpagesetupdialog__getdevmode)|Returns the current `DEVMODE` of the printer.|  \n|[CPageSetupDialog::GetDriverName](#cpagesetupdialog__getdrivername)|Returns the driver used by the printer.|  \n|[CPageSetupDialog::GetMargins](#cpagesetupdialog__getmargins)|Returns the current margin settings of the printer.|  \n|[CPageSetupDialog::GetPaperSize](#cpagesetupdialog__getpapersize)|Returns the paper size of the printer.|  \n|[CPageSetupDialog::GetPortName](#cpagesetupdialog__getportname)|Returns the output port name.|  \n|[CPageSetupDialog::OnDrawPage](#cpagesetupdialog__ondrawpage)|Called by the framework to render a screen image of a printed page.|  \n|[CPageSetupDialog::PreDrawPage](#cpagesetupdialog__predrawpage)|Called by the framework before rendering a screen image of a printed page.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CPageSetupDialog::m_psd](#cpagesetupdialog__m_psd)|A structure used to customize a `CPageSetupDialog` object.|  \n  \n## Remarks  \n This class is designed to take the place of the Print Setup dialog box.  \n  \n To use a `CPageSetupDialog` object, first create the object using the `CPageSetupDialog` constructor. Once the dialog box has been constructed, you can set or modify any values in the `m_psd` data member to initialize the values of the dialog box's controls. The [m_psd](#cpagesetupdialog__m_psd) structure is of type **PAGESETUPDLG**.  \n  \n After initializing the dialog box controls, call the `DoModal` member function to display the dialog box and allow the user to select print options. `DoModal` returns whether the user selected the OK ( **IDOK**) or Cancel ( **IDCANCEL**) button.  \n  \n If `DoModal` returns **IDOK**, you can use several of `CPageSetupDialog`'s member functions, or access the `m_psd` data member, to retrieve information input by the user.  \n  \n> [!NOTE]\n>  After the common OLE Page Setup dialog box is dismissed, any changes made by the user will not be saved by the framework. It is up to the application itself to save any values from this dialog box to a permanent location, such as member of the application's document or application class.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CDialog](../../mfc/reference/cdialog-class.md)  \n  \n [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  \n  \n `CPageSetupDialog`  \n  \n## Requirements  \n **Header:** afxdlgs.h  \n  \n##  <a name=\"cpagesetupdialog__cpagesetupdialog\"></a>  CPageSetupDialog::CPageSetupDialog  \n Call this function to construct a `CPageSetupDialog` object.  \n  \n```  \nCPageSetupDialog(\n    DWORD dwFlags = PSD_MARGINS | PSD_INWININIINTLMEASURE,  \n    CWnd* pParentWnd = NULL);\n```  \n  \n### Parameters  \n `dwFlags`  \n One or more flags you can use to customize the settings of the dialog box. The values can be combined using the bitwise-OR operator. These values have the following meanings:  \n  \n- **PSD_DEFAULTMINMARGINS** Sets the minimum allowable widths for the page margins to be the same as the printer's minimums. This flag is ignored if the **PSD_MARGINS** and **PSD_MINMARGINS** flags are also specified.  \n  \n- **PSD_INWININIINTLMEASURE** Not implemented.  \n  \n- **PSD_MINMARGINS** Causes the system to use the values specified in the **rtMinMargin** member as the minimum allowable widths for the left, top, right, and bottom margins. The system prevents the user from entering a width that is less than the specified minimum. If **PSD_MINMARGINS** is not specified, the system sets the minimum allowable widths to those allowed by the printer.  \n  \n- **PSD_MARGINS** Activates the margin control area.  \n  \n- **PSD_INTHOUSANDTHSOFINCHES** Causes the units of the dialog box to be measured in 1/1000 of an inch.  \n  \n- **PSD_INHUNDREDTHSOFMILLIMETERS** Causes the units of the dialog box to be measured in 1/100 of a millimeter.  \n  \n- **PSD_DISABLEMARGINS** Disables the margin dialog box controls.  \n  \n- **PSD_DISABLEPRINTER** Disables the Printer button.  \n  \n- **PSD_NOWARNING** Prevents the warning message from being displayed when there is no default printer.  \n  \n- **PSD_DISABLEORIENTATION** Disables the page orientation dialog control.  \n  \n- **PSD_RETURNDEFAULT** Causes `CPageSetupDialog` to return [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) and [DEVNAMES](../../mfc/reference/devnames-structure.md) structures that are initialized for the system default printer without displaying a dialog box. It is assumed that both **hDevNames** and **hDevMode** are **NULL**; otherwise, the function returns an error. If the system default printer is supported by an old printer driver (earlier than Windows version 3.0), only **hDevNames** is returned; **hDevMode** is **NULL**.  \n  \n- **PSD_DISABLEPAPER** Disables the paper selection control.  \n  \n- **PSD_SHOWHELP** Causes the dialog box to show the Help button. The **hwndOwner** member must not be **NULL** if this flag is specified.  \n  \n- **PSD_ENABLEPAGESETUPHOOK** Enables the hook function specified in **lpfnSetupHook**.  \n  \n- **PSD_ENABLEPAGESETUPTEMPLATE** Causes the operating system to create the dialog box by using the dialog template box identified by **hInstance** and **lpSetupTemplateName**.  \n  \n- **PSD_ENABLEPAGESETUPTEMPLATEHANDLE** Indicates that **hInstance** identifies a data block that contains a preloaded dialog box template. The system ignores **lpSetupTemplateName** if this flag is specified.  \n  \n- **PSD_ENABLEPAGEPAINTHOOK** Enables the hook function specified in **lpfnPagePaintHook**.  \n  \n- **PSD_DISABLEPAGEPAINTING** Disables the draw area of the dialog box.  \n  \n `pParentWnd`  \n Pointer to the dialog box's parent or owner.  \n  \n### Remarks  \n Use the [DoModal](../../mfc/reference/cdialog-class.md#cdialog__domodal) function to display the dialog box.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#94](../../mfc/codesnippet/cpp/cpagesetupdialog-class_1.cpp)]  \n  \n##  <a name=\"cpagesetupdialog__createprinterdc\"></a>  CPageSetupDialog::CreatePrinterDC  \n Creates a printer device context from the [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) and [DEVNAMES](../../mfc/reference/devnames-structure.md) structures.  \n  \n```  \nHDC CreatePrinterDC();\n```  \n  \n### Return Value  \n Handle to the newly created printer device context (DC).  \n  \n##  <a name=\"cpagesetupdialog__domodal\"></a>  CPageSetupDialog::DoModal  \n Call this function to display the Windows common OLE Page Setup dialog box and allow the user to select various print setup options such as the printing margins, size and orientation of the paper, and destination printer.  \n  \n```  \nvirtual INT_PTR DoModal();\n```  \n  \n### Return Value  \n **IDOK** or **IDCANCEL**. If **IDCANCEL** is returned, call the Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) function to determine whether an error occurred.  \n  \n **IDOK** and **IDCANCEL** are constants that indicate whether the user selected the OK or Cancel button.  \n  \n### Remarks  \n In addition, the user can access the printer setup options such as network location and properties specific to the selected printer.  \n  \n If you want to initialize the various Page Setup dialog options by setting members of the `m_psd` structure, you should do so before calling `DoModal`, and after the dialog object is constructed. After calling `DoModal`, call other member functions to retrieve the settings or information input by the user into the dialog box.  \n  \n If you want to propagate the current settings entered by the user, make a call to [CWinApp::SelectPrinter](../../mfc/reference/cwinapp-class.md#cwinapp__selectprinter). This function takes the information from the `CPageSetupDialog` object and initializes and selects a new printer DC with the proper attributes.  \n  \n [!code-cpp[NVC_MFCDocView#95](../../mfc/codesnippet/cpp/cpagesetupdialog-class_2.cpp)]  \n  \n### Example  \n  See the example for [CPageSetupDialog::CPageSetupDialog](#cpagesetupdialog__cpagesetupdialog).  \n  \n##  <a name=\"cpagesetupdialog__getdevicename\"></a>  CPageSetupDialog::GetDeviceName  \n Call this function after `DoModal` to retrieve the name of the currently selected printer.  \n  \n```  \nCString GetDeviceName() const;\n\n \n```  \n  \n### Return Value  \n The device name used by the **CPageSetupDialog** object.  \n  \n##  <a name=\"cpagesetupdialog__getdevmode\"></a>  CPageSetupDialog::GetDevMode  \n Call this function after calling `DoModal` to retrieve information about the printer device context of the `CPageSetupDialog` object.  \n  \n```  \nLPDEVMODE GetDevMode() const;\n\n \n```  \n  \n### Return Value  \n The [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) data structure, which contains information about the device initialization and environment of a print driver. You must unlock the memory taken by this structure with the Windows [GlobalUnlock](http://msdn.microsoft.com/library/windows/desktop/aa366595) function, which is described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"cpagesetupdialog__getdrivername\"></a>  CPageSetupDialog::GetDriverName  \n Call this function after calling [DoModal](../../mfc/reference/cprintdialog-class.md#cprintdialog__domodal) to retrieve the name of the system-defined printer device driver.  \n  \n```  \nCString GetDriverName() const;\n\n \n```  \n  \n### Return Value  \n A `CString` specifying the system-defined driver name.  \n  \n### Remarks  \n Use a pointer to the `CString` object returned by `GetDriverName` as the value of `lpszDriverName` in a call to [CDC::CreateDC](../../mfc/reference/cdc-class.md#cdc__createdc).  \n  \n##  <a name=\"cpagesetupdialog__getmargins\"></a>  CPageSetupDialog::GetMargins  \n Call this function after a call to `DoModal` to retrieve the margins of the printer device driver.  \n  \n```  \nvoid GetMargins(\n    LPRECT lpRectMargins,  \n    LPRECT lpRectMinMargins) const;\n\n \n```  \n  \n### Parameters  \n *lpRectMargins*  \n Pointer to a [RECT](https://www.microsoftonedoc.com/#/organizations/e6f6a65cf14f462597b64ac058dbe1d0/projects/3fedad16-eaf1-41a6-8f96-0c1949c68f32/containers/a3daf831-1c5f-4bbe-964d-503870caf874/tocpaths/18113766-3975-4369-bc07-92e34cba712e/locales/en-us) structure or [CRect](../../atl-mfc-shared/reference/crect-class.md) object that describes (in 1/1000 inches or 1/100 mm) the print margins for the currently selected printer. Pass **NULL** for this parameter, if you are not interested in this rectangle.  \n  \n *lpRectMinMargins*  \n Pointer to a `RECT` structure or `CRect` object that describes (in 1/1000 inches or 1/100 mm) the minimum print margins for the currently selected printer. Pass **NULL** for this parameter, if you are not interested in this rectangle.  \n  \n##  <a name=\"cpagesetupdialog__getpapersize\"></a>  CPageSetupDialog::GetPaperSize  \n Call this function to retrieve the size of the paper selected for printing.  \n  \n```  \nCSize GetPaperSize() const;\n\n \n```  \n  \n### Return Value  \n A [CSize](../../atl-mfc-shared/reference/csize-class.md) object containing the size of the paper (in 1/1000 inches or 1/100 mm) selected for printing.  \n  \n##  <a name=\"cpagesetupdialog__getportname\"></a>  CPageSetupDialog::GetPortName  \n Call this function after calling `DoModal` to retrieve the name of the currently selected printer port.  \n  \n```  \nCString GetPortName() const;\n\n \n```  \n  \n### Return Value  \n The name of the currently selected printer port.  \n  \n##  <a name=\"cpagesetupdialog__m_psd\"></a>  CPageSetupDialog::m_psd  \n A structure of type **PAGESETUPDLG**, whose members store the characteristics of the dialog object.  \n  \n```  \nPAGESETUPDLG m_psd;  \n```  \n  \n### Remarks  \n After constructing a `CPageSetupDialog` object, you can use `m_psd` to set various aspects of the dialog box before calling the `DoModal` member function.  \n  \n If you modify the `m_psd` data member directly, you will override any default behavior.  \n  \n For more information on the [PAGESETUPDLG](http://msdn.microsoft.com/library/windows/desktop/ms646842) structure, see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n See the example for [CPageSetupDialog::CPageSetupDialog](#cpagesetupdialog__cpagesetupdialog).  \n  \n##  <a name=\"cpagesetupdialog__ondrawpage\"></a>  CPageSetupDialog::OnDrawPage  \n Called by the framework to draw a screen image of a printed page.  \n  \n```  \nvirtual UINT OnDrawPage(\n    CDC* pDC,  \n    UINT nMessage,  \n    LPRECT lpRect);\n```  \n  \n### Parameters  \n `pDC`  \n Pointer to the printer device context.  \n  \n `nMessage`  \n Specifies a message, indicating the area of the page currently being drawn. Can be one of the following:  \n  \n- **WM_PSD_FULLPAGERECT** The entire page area.  \n  \n- **WM_PSD_MINMARGINRECT** Current minimum margins.  \n  \n- **WM_PSD_MARGINRECT** Current margins.  \n  \n- **WM_PSD_GREEKTEXTRECT** Contents of the page.  \n  \n- **WM_PSD_ENVSTAMPRECT** Area reserved for a postage stamp representation.  \n  \n- **WM_PSD_YAFULLPAGERECT** Area for a return address representation. This area extends to the edges of the sample page area.  \n  \n `lpRect`  \n Pointer to a [CRect](../../atl-mfc-shared/reference/crect-class.md) or [RECT](https://www.microsoftonedoc.com/#/organizations/e6f6a65cf14f462597b64ac058dbe1d0/projects/3fedad16-eaf1-41a6-8f96-0c1949c68f32/containers/a3daf831-1c5f-4bbe-964d-503870caf874/tocpaths/18113766-3975-4369-bc07-92e34cba712e/locales/en-us) object containing the coordinates of the drawing area.  \n  \n### Return Value  \n Nonzero value if handled; otherwise 0.  \n  \n### Remarks  \n This image is then displayed as part of the common OLE Page Setup dialog box. The default implementation draws an image of a page of text.  \n  \n Override this function to customize the drawing of a specific area of the image, or the entire image. You can do this by using a `switch` statement with **case** statements checking the value of `nMessage`. For example, to customize the rendering of the contents of the page image, you could use the following example code:  \n  \n [!code-cpp[NVC_MFCDocView#96](../../mfc/codesnippet/cpp/cpagesetupdialog-class_3.cpp)]  \n  \n Note that you do not need to handle every case of `nMessage`. You can choose to handle one component of the image, several components of the image, or the whole area.  \n  \n##  <a name=\"cpagesetupdialog__predrawpage\"></a>  CPageSetupDialog::PreDrawPage  \n Called by the framework before drawing the screen image of a printed page.  \n  \n```  \nvirtual UINT PreDrawPage(\n    WORD wPaper,  \n    WORD wFlags,  \n    LPPAGESETUPDLG pPSD);\n```  \n  \n### Parameters  \n *wPaper*  \n Specifies a value that indicates the paper size. This value can be one of the **DMPAPER_** values listed in the description of the [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) structure.  \n  \n `wFlags`  \n Indicates the orientation of the paper or envelope, and whether the printer is a dot-matrix or HPPCL (Hewlett Packard Printer Control Language) device. This parameter can have one of the following values:  \n  \n-   0x001   Paper in landscape mode (dot matrix)  \n  \n-   0x003   Paper in landscape mode (HPPCL)  \n  \n-   0x005   Paper in portrait mode (dot matrix)  \n  \n-   0x007   Paper in portrait mode (HPPCL)  \n  \n-   0x00b   Envelope in landscape mode (HPPCL)  \n  \n-   0x00d   Envelope in portrait mode (dot matrix)  \n  \n-   0x019   Envelope in landscape mode (dot matrix)  \n  \n-   0x01f   Envelope in portrait mode (dot matrix)  \n  \n `pPSD`  \n Pointer to a **PAGESETUPDLG** structure. For more information on [PAGESETUPDLG](http://msdn.microsoft.com/library/windows/desktop/ms646842), see the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Return Value  \n Nonzero value if handled; otherwise 0.  \n  \n### Remarks  \n Override this function to customize the drawing of the image. If you override this function and return **TRUE**, you must draw the entire image. If you override this function and return **FALSE**, the entire default image is drawn by the framework.  \n  \n## See Also  \n [MFC Sample WORDPAD](../../visual-cpp-samples.md)   \n [CCommonDialog Class](../../mfc/reference/ccommondialog-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)\n\n\n\n"}