{"nodes":[{"pos":[12,50],"content":"Servers: Server Items | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Servers: Server Items | Microsoft Docs","pos":[0,38]}]},{"content":"Servers: Server Items","pos":[721,742]},{"content":"When a container launches a server so that a user can edit an embedded or linked OLE item, the server application creates a \"server item.\"","pos":[743,881]},{"content":"The server item, which is an object of a class derived from <ph id=\"ph1\">`COleServerItem`</ph>, provides an interface between the server document and the container application.","pos":[882,1040],"source":" The server item, which is an object of a class derived from `COleServerItem`, provides an interface between the server document and the container application."},{"content":"The <ph id=\"ph1\">`COleServerItem`</ph> class defines several overridable member functions that are called by OLE, usually in response to requests from the container.","pos":[1047,1194],"source":"The `COleServerItem` class defines several overridable member functions that are called by OLE, usually in response to requests from the container."},{"content":"Server items can represent part of the server document or the entire document.","pos":[1195,1273]},{"content":"When an OLE item is embedded in the container document, the server item represents the entire server document.","pos":[1274,1384]},{"content":"When the OLE item is linked, the server item can represent a part of the server document or the whole document, depending on whether the link is to a part or to the whole.","pos":[1385,1556]},{"content":"In the <bpt id=\"p1\">[</bpt>HIERSVR<ept id=\"p1\">](../visual-cpp-samples.md)</ept> sample, for example, the server-item class, <bpt id=\"p2\">**</bpt>CServerItem<ept id=\"p2\">**</ept>, has a member that is a pointer to an object of the class <bpt id=\"p3\">**</bpt>CServerNode<ept id=\"p3\">**</ept>.","pos":[1563,1740],"source":"In the [HIERSVR](../visual-cpp-samples.md) sample, for example, the server-item class, **CServerItem**, has a member that is a pointer to an object of the class **CServerNode**."},{"content":"The <bpt id=\"p1\">**</bpt>CServerNode<ept id=\"p1\">**</ept> object is a node in the HIERSVR application's document, which is a tree.","pos":[1741,1833],"source":" The **CServerNode** object is a node in the HIERSVR application's document, which is a tree."},{"content":"When the <bpt id=\"p1\">**</bpt>CServerNode<ept id=\"p1\">**</ept> object is the root node, the <bpt id=\"p2\">**</bpt>CServerItem<ept id=\"p2\">**</ept> object represents the whole document.","pos":[1834,1941],"source":" When the **CServerNode** object is the root node, the **CServerItem** object represents the whole document."},{"content":"When the <bpt id=\"p1\">**</bpt>CServerNode<ept id=\"p1\">**</ept> object is a child node, the <bpt id=\"p2\">**</bpt>CServerItem<ept id=\"p2\">**</ept> object represents a part of the document.","pos":[1942,2052],"source":" When the **CServerNode** object is a child node, the **CServerItem** object represents a part of the document."},{"content":"See the MFC OLE sample <bpt id=\"p1\">[</bpt>HIERSVR<ept id=\"p1\">](../visual-cpp-samples.md)</ept> for an example of this interaction.","pos":[2053,2147],"source":" See the MFC OLE sample [HIERSVR](../visual-cpp-samples.md) for an example of this interaction."},{"pos":[2204,2229],"content":"Implementing Server Items"},{"content":"If you use the application wizard to produce \"starter\" code for your application, all you have to do to include server items in your starter code is to choose one of the server options from the OLE Options page.","pos":[2233,2444]},{"content":"If you are adding server items to an existing application, perform the following steps:","pos":[2445,2532]},{"content":"To implement a server item","pos":[2543,2569]},{"pos":[2579,2616],"content":"Derive a class from <ph id=\"ph1\">`COleServerItem`</ph>.","source":"Derive a class from `COleServerItem`."},{"pos":[2626,2687],"content":"In your derived class, override the <ph id=\"ph1\">`OnDraw`</ph> member function.","source":"In your derived class, override the `OnDraw` member function."},{"content":"The framework calls <ph id=\"ph1\">`OnDraw`</ph> to render the OLE item into a metafile.","pos":[2698,2766],"source":"The framework calls `OnDraw` to render the OLE item into a metafile."},{"content":"The container application uses this metafile to render the item.","pos":[2767,2831]},{"content":"Your application's view class also has an <ph id=\"ph1\">`OnDraw`</ph> member function, which is used to render the item when the server application is active.","pos":[2832,2971],"source":" Your application's view class also has an `OnDraw` member function, which is used to render the item when the server application is active."},{"content":"Implement an override of <ph id=\"ph1\">`OnGetEmbeddedItem`</ph> for your server-document class.","pos":[2981,3057],"source":"Implement an override of `OnGetEmbeddedItem` for your server-document class."},{"content":"For further information, see the article <bpt id=\"p1\">[</bpt>Servers: Implementing Server Documents<ept id=\"p1\">](../mfc/servers-implementing-server-documents.md)</ept> and the MFC OLE sample <bpt id=\"p2\">[</bpt>HIERSVR<ept id=\"p2\">](../visual-cpp-samples.md)</ept>.","pos":[3058,3248],"source":" For further information, see the article [Servers: Implementing Server Documents](../mfc/servers-implementing-server-documents.md) and the MFC OLE sample [HIERSVR](../visual-cpp-samples.md)."},{"content":"Implement your server-item class's <ph id=\"ph1\">`OnGetExtent`</ph> member function.","pos":[3258,3323],"source":"Implement your server-item class's `OnGetExtent` member function."},{"content":"The framework calls this function to retrieve the size of the item.","pos":[3324,3391]},{"content":"The default implementation does nothing.","pos":[3392,3432]},{"pos":[3501,3535],"content":"A Tip for Server-Item Architecture"},{"content":"As noted in <bpt id=\"p1\">[</bpt>Implementing Server Items<ept id=\"p1\">](#_core_implementing_server_items)</ept>, server applications must be able to render items both in the server's view and in a metafile used by the container application.","pos":[3539,3741],"source":"As noted in [Implementing Server Items](#_core_implementing_server_items), server applications must be able to render items both in the server's view and in a metafile used by the container application."},{"content":"In the Microsoft Foundation Class Library's application architecture, the view class's <ph id=\"ph1\">`OnDraw`</ph> member function renders the item when it is being edited (see <bpt id=\"p1\">[</bpt>CView::OnDraw<ept id=\"p1\">](../mfc/reference/cview-class.md#cview__ondraw)</ept> in the <bpt id=\"p2\">*</bpt>Class Library Reference<ept id=\"p2\">*</ept>).","pos":[3742,3997],"source":" In the Microsoft Foundation Class Library's application architecture, the view class's `OnDraw` member function renders the item when it is being edited (see [CView::OnDraw](../mfc/reference/cview-class.md#cview__ondraw) in the *Class Library Reference*)."},{"content":"The server item's <ph id=\"ph1\">`OnDraw`</ph> renders the item into a metafile in all other cases (see <bpt id=\"p1\">[</bpt>COleServerItem::OnDraw<ept id=\"p1\">](../mfc/reference/coleserveritem-class.md#coleserveritem__ondraw)</ept>).","pos":[3998,4173],"source":" The server item's `OnDraw` renders the item into a metafile in all other cases (see [COleServerItem::OnDraw](../mfc/reference/coleserveritem-class.md#coleserveritem__ondraw))."},{"content":"You can avoid duplication of code by writing helper functions in your server-document class and calling them from the <ph id=\"ph1\">`OnDraw`</ph> functions in your view and server-item classes.","pos":[4180,4354],"source":"You can avoid duplication of code by writing helper functions in your server-document class and calling them from the `OnDraw` functions in your view and server-item classes."},{"content":"The MFC OLE sample <bpt id=\"p1\">[</bpt>HIERSVR<ept id=\"p1\">](../visual-cpp-samples.md)</ept> uses this strategy: the functions <bpt id=\"p2\">**</bpt>CServerView::OnDraw<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>CServerItem::OnDraw<ept id=\"p3\">**</ept> both call <bpt id=\"p4\">**</bpt>CServerDoc::DrawTree<ept id=\"p4\">**</ept> to render the item.","pos":[4355,4550],"source":" The MFC OLE sample [HIERSVR](../visual-cpp-samples.md) uses this strategy: the functions **CServerView::OnDraw** and **CServerItem::OnDraw** both call **CServerDoc::DrawTree** to render the item."},{"content":"The view and the item both have <ph id=\"ph1\">`OnDraw`</ph> member functions because they draw under different conditions.","pos":[4557,4660],"source":"The view and the item both have `OnDraw` member functions because they draw under different conditions."},{"content":"The view must take into account such factors as zooming, selection size and extent, clipping, and user-interface elements such as scroll bars.","pos":[4661,4803]},{"content":"The server item, on the other hand, always draws the entire OLE object.","pos":[4804,4875]},{"pos":[4882,5269],"content":"For more information, see <bpt id=\"p1\">[</bpt>CView::OnDraw<ept id=\"p1\">](../mfc/reference/cview-class.md#cview__ondraw)</ept>, <bpt id=\"p2\">[</bpt>COleServerItem<ept id=\"p2\">](../mfc/reference/coleserveritem-class.md)</ept>, <bpt id=\"p3\">[</bpt>COleServerItem::OnDraw<ept id=\"p3\">](../mfc/reference/coleserveritem-class.md#coleserveritem__ondraw)</ept>, and <bpt id=\"p4\">[</bpt>COleServerDoc::OnGetEmbeddedItem<ept id=\"p4\">](../mfc/reference/coleserverdoc-class.md#coleserverdoc__ongetembeddeditem)</ept> in the <bpt id=\"p5\">*</bpt>Class Library Reference<ept id=\"p5\">*</ept>.","source":"For more information, see [CView::OnDraw](../mfc/reference/cview-class.md#cview__ondraw), [COleServerItem](../mfc/reference/coleserveritem-class.md), [COleServerItem::OnDraw](../mfc/reference/coleserveritem-class.md#coleserveritem__ondraw), and [COleServerDoc::OnGetEmbeddedItem](../mfc/reference/coleserverdoc-class.md#coleserverdoc__ongetembeddeditem) in the *Class Library Reference*."},{"content":"See Also","pos":[5278,5286]},{"content":"Servers","pos":[5291,5298]}],"content":"---\ntitle: \"Servers: Server Items | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"server items, implementing\"\n  - \"servers [C++], server items\"\n  - \"architecture [C++], server-item\"\n  - \"server items\"\n  - \"OLE server applications, server items\"\nms.assetid: 28ba81a1-726a-4728-a52d-68bc7efd5a3c\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Servers: Server Items\nWhen a container launches a server so that a user can edit an embedded or linked OLE item, the server application creates a \"server item.\" The server item, which is an object of a class derived from `COleServerItem`, provides an interface between the server document and the container application.  \n  \n The `COleServerItem` class defines several overridable member functions that are called by OLE, usually in response to requests from the container. Server items can represent part of the server document or the entire document. When an OLE item is embedded in the container document, the server item represents the entire server document. When the OLE item is linked, the server item can represent a part of the server document or the whole document, depending on whether the link is to a part or to the whole.  \n  \n In the [HIERSVR](../visual-cpp-samples.md) sample, for example, the server-item class, **CServerItem**, has a member that is a pointer to an object of the class **CServerNode**. The **CServerNode** object is a node in the HIERSVR application's document, which is a tree. When the **CServerNode** object is the root node, the **CServerItem** object represents the whole document. When the **CServerNode** object is a child node, the **CServerItem** object represents a part of the document. See the MFC OLE sample [HIERSVR](../visual-cpp-samples.md) for an example of this interaction.  \n  \n##  <a name=\"_core_implementing_server_items\"></a> Implementing Server Items  \n If you use the application wizard to produce \"starter\" code for your application, all you have to do to include server items in your starter code is to choose one of the server options from the OLE Options page. If you are adding server items to an existing application, perform the following steps:  \n  \n#### To implement a server item  \n  \n1.  Derive a class from `COleServerItem`.  \n  \n2.  In your derived class, override the `OnDraw` member function.  \n  \n     The framework calls `OnDraw` to render the OLE item into a metafile. The container application uses this metafile to render the item. Your application's view class also has an `OnDraw` member function, which is used to render the item when the server application is active.  \n  \n3.  Implement an override of `OnGetEmbeddedItem` for your server-document class. For further information, see the article [Servers: Implementing Server Documents](../mfc/servers-implementing-server-documents.md) and the MFC OLE sample [HIERSVR](../visual-cpp-samples.md).  \n  \n4.  Implement your server-item class's `OnGetExtent` member function. The framework calls this function to retrieve the size of the item. The default implementation does nothing.  \n  \n##  <a name=\"_core_a_tip_for_server.2d.item_architecture\"></a> A Tip for Server-Item Architecture  \n As noted in [Implementing Server Items](#_core_implementing_server_items), server applications must be able to render items both in the server's view and in a metafile used by the container application. In the Microsoft Foundation Class Library's application architecture, the view class's `OnDraw` member function renders the item when it is being edited (see [CView::OnDraw](../mfc/reference/cview-class.md#cview__ondraw) in the *Class Library Reference*). The server item's `OnDraw` renders the item into a metafile in all other cases (see [COleServerItem::OnDraw](../mfc/reference/coleserveritem-class.md#coleserveritem__ondraw)).  \n  \n You can avoid duplication of code by writing helper functions in your server-document class and calling them from the `OnDraw` functions in your view and server-item classes. The MFC OLE sample [HIERSVR](../visual-cpp-samples.md) uses this strategy: the functions **CServerView::OnDraw** and **CServerItem::OnDraw** both call **CServerDoc::DrawTree** to render the item.  \n  \n The view and the item both have `OnDraw` member functions because they draw under different conditions. The view must take into account such factors as zooming, selection size and extent, clipping, and user-interface elements such as scroll bars. The server item, on the other hand, always draws the entire OLE object.  \n  \n For more information, see [CView::OnDraw](../mfc/reference/cview-class.md#cview__ondraw), [COleServerItem](../mfc/reference/coleserveritem-class.md), [COleServerItem::OnDraw](../mfc/reference/coleserveritem-class.md#coleserveritem__ondraw), and [COleServerDoc::OnGetEmbeddedItem](../mfc/reference/coleserverdoc-class.md#coleserverdoc__ongetembeddeditem) in the *Class Library Reference*.  \n  \n## See Also  \n [Servers](../mfc/servers.md)\n\n"}