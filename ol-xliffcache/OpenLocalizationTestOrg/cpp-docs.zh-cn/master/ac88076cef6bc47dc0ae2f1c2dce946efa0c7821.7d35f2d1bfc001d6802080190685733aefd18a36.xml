{"nodes":[{"pos":[12,51],"content":"CKeyboardManager Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CKeyboardManager Class | Microsoft Docs","pos":[0,39]}]},{"content":"CKeyboardManager Class","pos":[622,644]},{"content":"Manages shortcut key tables for the main frame window and child frame windows.","pos":[645,723]},{"content":"Syntax","pos":[732,738]},{"content":"Members","pos":[804,811]},{"content":"Public Constructors","pos":[821,840]},{"content":"Name","pos":[861,865]},{"content":"Description","pos":[866,877]},{"content":"CKeyboardManager::CKeyboardManager","pos":[883,917]},{"pos":[956,995],"content":"Constructs a <ph id=\"ph1\">`CKeyboardManager`</ph> object.","source":"Constructs a `CKeyboardManager` object."},{"content":"Public Methods","pos":[1006,1020]},{"content":"Name","pos":[1041,1045]},{"content":"Description","pos":[1046,1057]},{"content":"CKeyboardManager::CleanUp","pos":[1063,1088]},{"content":"Clears the shortcut key tables.","pos":[1118,1149]},{"content":"CKeyboardManager::FindDefaultAccelerator","pos":[1155,1195]},{"content":"Retrieves the default shortcut key for the specified command and window.","pos":[1240,1312]},{"content":"CKeyboardManager::IsKeyHandled","pos":[1318,1348]},{"content":"Determines whether a key is handled by the accelerator table.","pos":[1383,1444]},{"content":"CKeyboardManager::IsKeyPrintable","pos":[1450,1482]},{"content":"Indicates whether a character is printable.","pos":[1519,1562]},{"content":"CKeyboardManager::IsShowAllAccelerators","pos":[1568,1607]},{"content":"Indicates whether menus show all shortcut keys for a command or only the default shortcut key.","pos":[1651,1745]},{"content":"CKeyboardManager::LoadState","pos":[1751,1778]},{"content":"Loads the shortcut key tables from the Windows registry.","pos":[1810,1866]},{"content":"CKeyboardManager::ResetAll","pos":[1872,1898]},{"content":"Reloads the shortcut key tables from the application resource.","pos":[1929,1991]},{"content":"CKeyboardManager::SaveState","pos":[1997,2024]},{"content":"Saves the shortcut key tables to the Windows registry.","pos":[2056,2110]},{"content":"CKeyboardManager::ShowAllAccelerators","pos":[2116,2153]},{"content":"Specifies whether the framework displays all the shortcut keys for all commands, or a single shortcut key for each command.","pos":[2195,2318]},{"content":"This method does not affect commands that have only one associated shortcut key.","pos":[2319,2399]},{"content":"CKeyboardManager::TranslateCharToUpper","pos":[2405,2443]},{"content":"Converts a character to its upper register.","pos":[2486,2529]},{"content":"CKeyboardManager::UpdateAccelTable","pos":[2535,2569]},{"content":"Updates a shortcut key table with a new shortcut key table.","pos":[2608,2667]},{"content":"Remarks","pos":[2677,2684]},{"content":"The members of this class enable you to save and load shortcut key tables to the Windows registry, use a template to update the short cut key tables, and find the default shortcut key for a command in a frame window.","pos":[2688,2904]},{"content":"In addition, the <ph id=\"ph1\">`CKeyboardManager`</ph> object lets you control how shortcut keys are displayed to the user.","pos":[2905,3009],"source":" In addition, the `CKeyboardManager` object lets you control how shortcut keys are displayed to the user."},{"content":"You should not create a <ph id=\"ph1\">`CKeyboardManager`</ph> object manually.","pos":[3016,3075],"source":"You should not create a `CKeyboardManager` object manually."},{"content":"It will be created automatically by the framework of your application.","pos":[3076,3146]},{"content":"However, you should call <bpt id=\"p1\">[</bpt>CWinAppEx::InitKeyboardManager<ept id=\"p1\">](../../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager)</ept> during the initialization process of your application.","pos":[3147,3330],"source":" However, you should call [CWinAppEx::InitKeyboardManager](../../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager) during the initialization process of your application."},{"content":"To get a pointer to the keyboard manager for your application, call <bpt id=\"p1\">[</bpt>CWinAppEx::GetKeyboardManager<ept id=\"p1\">](../../mfc/reference/cwinappex-class.md#cwinappex__getkeyboardmanager)</ept>.","pos":[3331,3501],"source":" To get a pointer to the keyboard manager for your application, call [CWinAppEx::GetKeyboardManager](../../mfc/reference/cwinappex-class.md#cwinappex__getkeyboardmanager)."},{"content":"Example","pos":[3510,3517]},{"content":"The following example demonstrates how to retrieve a pointer to a <ph id=\"ph1\">`CKeyboardManager`</ph> object from a <ph id=\"ph2\">`CWinAppEx`</ph> class, and how to show all the shortcut keys associated with menu commands.","pos":[3521,3707],"source":"The following example demonstrates how to retrieve a pointer to a `CKeyboardManager` object from a `CWinAppEx` class, and how to show all the shortcut keys associated with menu commands."},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>Custom Pages sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[3708,3792],"source":" This code snippet is part of the [Custom Pages sample](../../visual-cpp-samples.md)."},{"pos":[3810,3831],"content":"NVC_MFC_CustomPages#5"},{"content":"Inheritance Hierarchy","pos":[3908,3929]},{"content":"CObject","pos":[3934,3941]},{"content":"CKeyboardManager","pos":[3988,4004]},{"content":"Requirements","pos":[4061,4073]},{"pos":[4077,4109],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxkeyboardmanager.h","source":"**Header:** afxkeyboardmanager.h"},{"pos":[4170,4204],"content":"CKeyboardManager::CKeyboardManager"},{"pos":[4208,4247],"content":"Constructs a <ph id=\"ph1\">`CKeyboardManager`</ph> object.","source":"Constructs a `CKeyboardManager` object."},{"content":"Remarks","pos":[4292,4299]},{"content":"In most cases, you do not have to create a <ph id=\"ph1\">`CKeyboardManager`</ph> directly.","pos":[4303,4374],"source":"In most cases, you do not have to create a `CKeyboardManager` directly."},{"content":"By default, the framework creates one for you.","pos":[4375,4421]},{"content":"To get a pointer to the <ph id=\"ph1\">`CKeyboardManager`</ph>, call <bpt id=\"p1\">[</bpt>CWinAppEx::GetKeyboardManager<ept id=\"p1\">](../../mfc/reference/cwinappex-class.md#cwinappex__getkeyboardmanager)</ept>.","pos":[4422,4573],"source":" To get a pointer to the `CKeyboardManager`, call [CWinAppEx::GetKeyboardManager](../../mfc/reference/cwinappex-class.md#cwinappex__getkeyboardmanager)."},{"content":"If you do create one manually, you must initialize it with the method <bpt id=\"p1\">[</bpt>CWinAppEx::InitKeyboardManager<ept id=\"p1\">](../../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager)</ept>.","pos":[4574,4748],"source":" If you do create one manually, you must initialize it with the method [CWinAppEx::InitKeyboardManager](../../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager)."},{"pos":[4800,4825],"content":"CKeyboardManager::CleanUp"},{"pos":[4829,4905],"content":"Frees the <ph id=\"ph1\">`CKeyboardManager`</ph> resources and clears all shortcut key mappings.","source":"Frees the `CKeyboardManager` resources and clears all shortcut key mappings."},{"content":"Remarks","pos":[4953,4960]},{"pos":[4964,5092],"content":"For more information about shortcut keys, see <bpt id=\"p1\">[</bpt>Keyboard and Mouse Customization<ept id=\"p1\">](../../mfc/keyboard-and-mouse-customization.md)</ept>.","source":"For more information about shortcut keys, see [Keyboard and Mouse Customization](../../mfc/keyboard-and-mouse-customization.md)."},{"content":"You do not have to call this function when your application exits because the framework calls it automatically during application exit.","pos":[5099,5234]},{"pos":[5301,5341],"content":"CKeyboardManager::FindDefaultAccelerator"},{"content":"Retrieves the default shortcut key for the specified command and window.","pos":[5345,5417]},{"content":"Parameters","pos":[5571,5581]},{"content":"[in]","pos":[5585,5589]},{"content":"The command ID.","pos":[5601,5616]},{"content":"[out]","pos":[5623,5628]},{"content":"A reference to a <ph id=\"ph1\">`CString`</ph> object.","pos":[5638,5672],"source":" A reference to a `CString` object."},{"content":"[in]","pos":[5679,5683]},{"content":"A pointer to a frame window.","pos":[5699,5727]},{"content":"[in]","pos":[5734,5738]},{"content":"Specifies whether the frame window is the default frame window.","pos":[5760,5823]},{"content":"Return Value","pos":[5833,5845]},{"content":"Nonzero if the shortcut is found; otherwise 0.","pos":[5849,5895]},{"content":"Remarks","pos":[5905,5912]},{"content":"This method looks up the command specified by <ph id=\"ph1\">`uiCmd`</ph> and retrieves the default shortcut key.","pos":[5916,6009],"source":"This method looks up the command specified by `uiCmd` and retrieves the default shortcut key."},{"content":"Then the method takes the string associated with this shortcut key and writes the value to the <ph id=\"ph1\">`str`</ph> parameter.","pos":[6010,6121],"source":" Then the method takes the string associated with this shortcut key and writes the value to the `str` parameter."},{"pos":[6178,6208],"content":"CKeyboardManager::IsKeyHandled"},{"pos":[6212,6339],"content":"Determines whether the specified key is handled by the <bpt id=\"p1\">[</bpt>CKeyboardManager Class<ept id=\"p1\">](../../mfc/reference/ckeyboardmanager-class.md)</ept>.","source":"Determines whether the specified key is handled by the [CKeyboardManager Class](../../mfc/reference/ckeyboardmanager-class.md)."},{"content":"Parameters","pos":[6490,6500]},{"content":"Parameter","pos":[6521,6530]},{"content":"Description","pos":[6531,6542]},{"pos":[6547,6551],"content":"[in]"},{"content":"The key to check.","pos":[6559,6576]},{"pos":[6581,6585],"content":"[in]"},{"content":"Specifies the behavior of the shortcut key.","pos":[6594,6637]},{"content":"For a list of possible values, see <bpt id=\"p1\">[</bpt>ACCEL Structure<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms646340)</ept>.","pos":[6638,6751],"source":" For a list of possible values, see [ACCEL Structure](http://msdn.microsoft.com/library/windows/desktop/ms646340)."},{"pos":[6756,6760],"content":"[in]"},{"content":"A frame window.","pos":[6773,6788]},{"content":"This method determines whether a shortcut key is handled in this frame.","pos":[6789,6860]},{"pos":[6865,6869],"content":"[in]"},{"pos":[6888,6971],"content":"A Boolean parameter that indicates whether <ph id=\"ph1\">`pWndFrame`</ph> is the default frame window.","source":"A Boolean parameter that indicates whether `pWndFrame` is the default frame window."},{"content":"Return Value","pos":[6982,6994]},{"content":"if the shortcut key is handled.","pos":[7005,7036]},{"content":"if the key is not handled or if <ph id=\"ph1\">`pWndFrame`</ph> is <ph id=\"ph2\">`NULL`</ph>.","pos":[7045,7099],"source":" if the key is not handled or if `pWndFrame` is `NULL`."},{"content":"Remarks","pos":[7109,7116]},{"pos":[7120,7277],"content":"The input parameters must match the entry in the accelerator table both for <ph id=\"ph1\">`nKey`</ph> and <ph id=\"ph2\">`fVirt`</ph> to determine whether a shortcut key is handled in <ph id=\"ph3\">`pWndFrame`</ph>.","source":"The input parameters must match the entry in the accelerator table both for `nKey` and `fVirt` to determine whether a shortcut key is handled in `pWndFrame`."},{"pos":[7336,7368],"content":"CKeyboardManager::IsKeyPrintable"},{"content":"Indicates whether a character is printable.","pos":[7372,7415]},{"content":"Parameters","pos":[7496,7506]},{"content":"Parameter","pos":[7527,7536]},{"content":"Description","pos":[7537,7548]},{"pos":[7553,7557],"content":"[in]"},{"content":"The character that this method checks.","pos":[7566,7604]},{"content":"Return Value","pos":[7615,7627]},{"content":"Nonzero if the character is printable, zero if it is not.","pos":[7631,7688]},{"content":"Remarks","pos":[7698,7705]},{"pos":[7709,7825],"content":"This method fails if a call to <bpt id=\"p1\">[</bpt>GetKeyboardState<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms646299)</ept> fails.","source":"This method fails if a call to [GetKeyboardState](http://msdn.microsoft.com/library/windows/desktop/ms646299) fails."},{"pos":[7891,7930],"content":"CKeyboardManager::IsShowAllAccelerators"},{"content":"Indicates whether menus show all the shortcut keys associated with menu commands or only the default shortcut keys.","pos":[7934,8049]},{"content":"Return Value","pos":[8111,8123]},{"content":"Nonzero if the application lists all the shortcut keys for menu commands; 0 if the application displays only default shortcut keys.","pos":[8127,8258]},{"content":"Remarks","pos":[8268,8275]},{"content":"The application lists the shortcut keys for menu commands in the menu bar.","pos":[8279,8353]},{"content":"Use the function <bpt id=\"p1\">[</bpt>CKeyboardManager::ShowAllAccelerators<ept id=\"p1\">](#ckeyboardmanager__showallaccelerators)</ept> to control whether the application lists all the shortcut keys or just the default shortcut keys.","pos":[8354,8548],"source":" Use the function [CKeyboardManager::ShowAllAccelerators](#ckeyboardmanager__showallaccelerators) to control whether the application lists all the shortcut keys or just the default shortcut keys."},{"pos":[8602,8629],"content":"CKeyboardManager::LoadState"},{"content":"Loads the shortcut key tables from the Windows registry.","pos":[8633,8689]},{"content":"Parameters","pos":[8806,8816]},{"content":"[in]","pos":[8820,8824]},{"content":"The registry path where <ph id=\"ph1\">`CKeyboardManager`</ph> data is saved.","pos":[8846,8903],"source":" The registry path where `CKeyboardManager` data is saved."},{"content":"[in]","pos":[8910,8914]},{"content":"A pointer to a frame window to use as the default window.","pos":[8934,8991]},{"content":"Return Value","pos":[9001,9013]},{"content":"Nonzero if the state was loaded successfully or 0 otherwise.","pos":[9017,9077]},{"content":"Remarks","pos":[9087,9094]},{"content":"If the <ph id=\"ph1\">`lpszProfileName`</ph> parameter is <ph id=\"ph2\">`NULL`</ph>, this method checks the default registry location for <ph id=\"ph3\">`CKeyboardManager`</ph> data.","pos":[9098,9221],"source":"If the `lpszProfileName` parameter is `NULL`, this method checks the default registry location for `CKeyboardManager` data."},{"content":"The default registry location is specified by the <bpt id=\"p1\">[</bpt>CWinAppEx Class<ept id=\"p1\">](../../mfc/reference/cwinappex-class.md)</ept>.","pos":[9222,9330],"source":" The default registry location is specified by the [CWinAppEx Class](../../mfc/reference/cwinappex-class.md)."},{"content":"The data must be previously written with the method <bpt id=\"p1\">[</bpt>CKeyboardManager::SaveState<ept id=\"p1\">](#ckeyboardmanager__savestate)</ept>.","pos":[9331,9443],"source":" The data must be previously written with the method [CKeyboardManager::SaveState](#ckeyboardmanager__savestate)."},{"content":"If you do not specify a default window, the main frame window of your application will be used.","pos":[9450,9545]},{"pos":[9598,9624],"content":"CKeyboardManager::ResetAll"},{"content":"Reloads the shortcut key tables from the application resource.","pos":[9628,9690]},{"content":"Remarks","pos":[9732,9739]},{"content":"This function clears the shortcuts stored in the <ph id=\"ph1\">`CKeyboardManager`</ph> instance.","pos":[9743,9820],"source":"This function clears the shortcuts stored in the `CKeyboardManager` instance."},{"content":"It will then reload the state of the keyboard manager from the application resource.","pos":[9821,9905]},{"pos":[9959,9986],"content":"CKeyboardManager::SaveState"},{"content":"Saves the shortcut key tables to the Windows registry.","pos":[9990,10044]},{"content":"Parameters","pos":[10161,10171]},{"content":"[in]","pos":[10175,10179]},{"content":"The registry path for saving the <ph id=\"ph1\">`CKeyboardManager`</ph> state.","pos":[10201,10259],"source":" The registry path for saving the `CKeyboardManager` state."},{"content":"[in]","pos":[10266,10270]},{"content":"A pointer to a frame window that becomes the default window.","pos":[10290,10350]},{"content":"Return Value","pos":[10360,10372]},{"content":"Nonzero if the keyboard manager state was saved successfully, or 0 otherwise.","pos":[10376,10453]},{"content":"Remarks","pos":[10463,10470]},{"content":"If the <ph id=\"ph1\">`lpszProfileName`</ph> parameter is <ph id=\"ph2\">`NULL`</ph>, this method will write the <ph id=\"ph3\">`CKeyboardManager`</ph> state to the default location specified by the <bpt id=\"p1\">[</bpt>CWinAppEx Class<ept id=\"p1\">](../../mfc/reference/cwinappex-class.md)</ept>.","pos":[10474,10671],"source":"If the `lpszProfileName` parameter is `NULL`, this method will write the `CKeyboardManager` state to the default location specified by the [CWinAppEx Class](../../mfc/reference/cwinappex-class.md)."},{"content":"If you specify a location, you can load the data later using the method <bpt id=\"p1\">[</bpt>CKeyboardManager::LoadState<ept id=\"p1\">](#ckeyboardmanager__loadstate)</ept>.","pos":[10672,10804],"source":" If you specify a location, you can load the data later using the method [CKeyboardManager::LoadState](#ckeyboardmanager__loadstate)."},{"content":"If you do not specify a default window, the main frame window will be used as the default window.","pos":[10811,10908]},{"pos":[10972,11009],"content":"CKeyboardManager::ShowAllAccelerators"},{"content":"Shows all the shortcut keys associated with menu commands.","pos":[11013,11071]},{"content":"Parameters","pos":[11219,11229]},{"content":"[in]","pos":[11233,11237]},{"content":"If <ph id=\"ph1\">`true`</ph>, all the shortcut keys will be displayed.","pos":[11252,11303],"source":" If `true`, all the shortcut keys will be displayed."},{"content":"If <ph id=\"ph1\">`false`</ph>, only the first shortcut key will be displayed.","pos":[11304,11362],"source":" If `false`, only the first shortcut key will be displayed."},{"content":"[in]","pos":[11369,11373]},{"content":"A string to insert between shortcut keys.","pos":[11393,11434]},{"content":"This delimiter has no effect if only one shortcut key is displayed.","pos":[11435,11502]},{"content":"Remarks","pos":[11512,11519]},{"content":"By default, if a command has more than one shortcut key associated with it, only the first shortcut key will be shown.","pos":[11523,11641]},{"content":"This function enables you to list all the shortcut keys associated with all commands.","pos":[11642,11727]},{"content":"The shortcut keys will be listed next to the command in the menu bar.","pos":[11734,11803]},{"content":"If all the shortcut keys are displayed, the string provided by <ph id=\"ph1\">`lpszDelimiter`</ph> will separate individual shortcut keys.","pos":[11804,11922],"source":" If all the shortcut keys are displayed, the string provided by `lpszDelimiter` will separate individual shortcut keys."},{"pos":[11987,12025],"content":"CKeyboardManager::TranslateCharToUpper"},{"content":"Converts a character to its upper register.","pos":[12029,12072]},{"content":"Parameters","pos":[12149,12159]},{"content":"[in]","pos":[12163,12167]},{"content":"The character to convert.","pos":[12179,12204]},{"content":"Return Value","pos":[12214,12226]},{"content":"The character that is the upper register of the input parameter.","pos":[12230,12294]},{"pos":[12355,12389],"content":"CKeyboardManager::UpdateAccelTable"},{"content":"Updates a shortcut key table with a new shortcut key table.","pos":[12393,12452]},{"content":"Parameters","pos":[12738,12748]},{"content":"[in]","pos":[12752,12756]},{"content":"A pointer to a document template.","pos":[12772,12805]},{"content":"[in]","pos":[12812,12816]},{"content":"A pointer to the new shortcut key.","pos":[12830,12864]},{"content":"[in]","pos":[12871,12875]},{"content":"The size of the new shortcut table.","pos":[12887,12922]},{"content":"[in]","pos":[12929,12933]},{"content":"A pointer to the default frame window.","pos":[12953,12991]},{"content":"[in]","pos":[12998,13002]},{"content":"A handle to the new shortcut table.","pos":[13018,13053]},{"content":"Return Value","pos":[13063,13075]},{"content":"Nonzero if the method is successful; otherwise 0.","pos":[13079,13128]},{"content":"Remarks","pos":[13138,13145]},{"content":"Use this function to replace the existing shortcut table with new shortcut keys for several frame window objects.","pos":[13149,13262]},{"content":"The function receives a document template as a parameter to obtain access to all frame window objects connected to the given document template.","pos":[13263,13406]},{"content":"See Also","pos":[13415,13423]},{"content":"Hierarchy Chart","pos":[13428,13443]},{"content":"Classes","pos":[13480,13487]},{"content":"CWinAppEx Class","pos":[13530,13545]},{"content":"CWinAppEx::InitKeyboardManager","pos":[13592,13622]},{"content":"Keyboard and Mouse Customization","pos":[13700,13732]}],"content":"---\ntitle: \"CKeyboardManager Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CKeyboardManager\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CKeyboardManager class\"\nms.assetid: 4809ece6-89df-4479-8b53-9bf476ee107b\ncaps.latest.revision: 33\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CKeyboardManager Class\nManages shortcut key tables for the main frame window and child frame windows.  \n  \n## Syntax  \n  \n```  \nclass CKeyboardManager : public CObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|||  \n|-|-|  \n|Name|Description|  \n|[CKeyboardManager::CKeyboardManager](#ckeyboardmanager__ckeyboardmanager)|Constructs a `CKeyboardManager` object.|  \n  \n### Public Methods  \n  \n|||  \n|-|-|  \n|Name|Description|  \n|[CKeyboardManager::CleanUp](#ckeyboardmanager__cleanup)|Clears the shortcut key tables.|  \n|[CKeyboardManager::FindDefaultAccelerator](#ckeyboardmanager__finddefaultaccelerator)|Retrieves the default shortcut key for the specified command and window.|  \n|[CKeyboardManager::IsKeyHandled](#ckeyboardmanager__iskeyhandled)|Determines whether a key is handled by the accelerator table.|  \n|[CKeyboardManager::IsKeyPrintable](#ckeyboardmanager__iskeyprintable)|Indicates whether a character is printable.|  \n|[CKeyboardManager::IsShowAllAccelerators](#ckeyboardmanager__isshowallaccelerators)|Indicates whether menus show all shortcut keys for a command or only the default shortcut key.|  \n|[CKeyboardManager::LoadState](#ckeyboardmanager__loadstate)|Loads the shortcut key tables from the Windows registry.|  \n|[CKeyboardManager::ResetAll](#ckeyboardmanager__resetall)|Reloads the shortcut key tables from the application resource.|  \n|[CKeyboardManager::SaveState](#ckeyboardmanager__savestate)|Saves the shortcut key tables to the Windows registry.|  \n|[CKeyboardManager::ShowAllAccelerators](#ckeyboardmanager__showallaccelerators)|Specifies whether the framework displays all the shortcut keys for all commands, or a single shortcut key for each command. This method does not affect commands that have only one associated shortcut key.|  \n|[CKeyboardManager::TranslateCharToUpper](#ckeyboardmanager__translatechartoupper)|Converts a character to its upper register.|  \n|[CKeyboardManager::UpdateAccelTable](#ckeyboardmanager__updateacceltable)|Updates a shortcut key table with a new shortcut key table.|  \n  \n## Remarks  \n The members of this class enable you to save and load shortcut key tables to the Windows registry, use a template to update the short cut key tables, and find the default shortcut key for a command in a frame window. In addition, the `CKeyboardManager` object lets you control how shortcut keys are displayed to the user.  \n  \n You should not create a `CKeyboardManager` object manually. It will be created automatically by the framework of your application. However, you should call [CWinAppEx::InitKeyboardManager](../../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager) during the initialization process of your application. To get a pointer to the keyboard manager for your application, call [CWinAppEx::GetKeyboardManager](../../mfc/reference/cwinappex-class.md#cwinappex__getkeyboardmanager).  \n  \n## Example  \n The following example demonstrates how to retrieve a pointer to a `CKeyboardManager` object from a `CWinAppEx` class, and how to show all the shortcut keys associated with menu commands. This code snippet is part of the [Custom Pages sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_CustomPages#5](../../mfc/reference/codesnippet/cpp/ckeyboardmanager-class_1.cpp)]  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)  \n  \n## Requirements  \n **Header:** afxkeyboardmanager.h  \n  \n##  <a name=\"ckeyboardmanager__ckeyboardmanager\"></a>  CKeyboardManager::CKeyboardManager  \n Constructs a `CKeyboardManager` object.  \n  \n```  \nCKeyboardManager();\n```  \n  \n### Remarks  \n In most cases, you do not have to create a `CKeyboardManager` directly. By default, the framework creates one for you. To get a pointer to the `CKeyboardManager`, call [CWinAppEx::GetKeyboardManager](../../mfc/reference/cwinappex-class.md#cwinappex__getkeyboardmanager). If you do create one manually, you must initialize it with the method [CWinAppEx::InitKeyboardManager](../../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager).  \n  \n##  <a name=\"ckeyboardmanager__cleanup\"></a>  CKeyboardManager::CleanUp  \n Frees the `CKeyboardManager` resources and clears all shortcut key mappings.  \n  \n```  \nstatic void CleanUp();\n```  \n  \n### Remarks  \n For more information about shortcut keys, see [Keyboard and Mouse Customization](../../mfc/keyboard-and-mouse-customization.md).  \n  \n You do not have to call this function when your application exits because the framework calls it automatically during application exit.  \n  \n##  <a name=\"ckeyboardmanager__finddefaultaccelerator\"></a>  CKeyboardManager::FindDefaultAccelerator  \n Retrieves the default shortcut key for the specified command and window.  \n  \n```  \nstatic BOOL FindDefaultAccelerator(\n    UINT uiCmd,  \n    CString& str,  \n    CFrameWnd* pWndFrame,  \n    BOOL bIsDefaultFrame);\n```  \n  \n### Parameters  \n [in] `uiCmd`  \n The command ID.  \n  \n [out] `str`  \n A reference to a `CString` object.  \n  \n [in] `pWndFrame`  \n A pointer to a frame window.  \n  \n [in] `bIsDefaultFrame`  \n Specifies whether the frame window is the default frame window.  \n  \n### Return Value  \n Nonzero if the shortcut is found; otherwise 0.  \n  \n### Remarks  \n This method looks up the command specified by `uiCmd` and retrieves the default shortcut key. Then the method takes the string associated with this shortcut key and writes the value to the `str` parameter.  \n  \n##  <a name=\"ckeyboardmanager__iskeyhandled\"></a>  CKeyboardManager::IsKeyHandled  \n Determines whether the specified key is handled by the [CKeyboardManager Class](../../mfc/reference/ckeyboardmanager-class.md).  \n  \n```  \nstatic BOOL __stdcall IsKeyHandled(\n    WORD nKey,  \n    BYTE fVirt,  \n    CFrameWnd* pWndFrame,  \n    BOOL bIsDefaultFrame);\n```  \n  \n### Parameters  \n  \n|||  \n|-|-|  \n|Parameter|Description|  \n|[in] `nKey`|The key to check.|  \n|[in] `fVirt`|Specifies the behavior of the shortcut key. For a list of possible values, see [ACCEL Structure](http://msdn.microsoft.com/library/windows/desktop/ms646340).|  \n|[in] `pWndFrame`|A frame window. This method determines whether a shortcut key is handled in this frame.|  \n|[in] `bIsDefaultFrame`|A Boolean parameter that indicates whether `pWndFrame` is the default frame window.|  \n  \n### Return Value  \n `TRUE` if the shortcut key is handled. `FALSE` if the key is not handled or if `pWndFrame` is `NULL`.  \n  \n### Remarks  \n The input parameters must match the entry in the accelerator table both for `nKey` and `fVirt` to determine whether a shortcut key is handled in `pWndFrame`.  \n  \n##  <a name=\"ckeyboardmanager__iskeyprintable\"></a>  CKeyboardManager::IsKeyPrintable  \n Indicates whether a character is printable.  \n  \n```  \nstatic BOOL __stdcall IsKeyPrintable(const UINT nChar);\n```  \n  \n### Parameters  \n  \n|||  \n|-|-|  \n|Parameter|Description|  \n|[in] `nChar`|The character that this method checks.|  \n  \n### Return Value  \n Nonzero if the character is printable, zero if it is not.  \n  \n### Remarks  \n This method fails if a call to [GetKeyboardState](http://msdn.microsoft.com/library/windows/desktop/ms646299) fails.  \n  \n##  <a name=\"ckeyboardmanager__isshowallaccelerators\"></a>  CKeyboardManager::IsShowAllAccelerators  \n Indicates whether menus show all the shortcut keys associated with menu commands or only the default shortcut keys.  \n  \n```  \nstatic BOOL IsShowAllAccelerators();\n```  \n  \n### Return Value  \n Nonzero if the application lists all the shortcut keys for menu commands; 0 if the application displays only default shortcut keys.  \n  \n### Remarks  \n The application lists the shortcut keys for menu commands in the menu bar. Use the function [CKeyboardManager::ShowAllAccelerators](#ckeyboardmanager__showallaccelerators) to control whether the application lists all the shortcut keys or just the default shortcut keys.  \n  \n##  <a name=\"ckeyboardmanager__loadstate\"></a>  CKeyboardManager::LoadState  \n Loads the shortcut key tables from the Windows registry.  \n  \n```  \nBOOL LoadState(\n    LPCTSTR lpszProfileName = NULL,  \n    CFrameWnd* pDefaultFrame = NULL);\n```  \n  \n### Parameters  \n [in] `lpszProfileName`  \n The registry path where `CKeyboardManager` data is saved.  \n  \n [in] `pDefaultFrame`  \n A pointer to a frame window to use as the default window.  \n  \n### Return Value  \n Nonzero if the state was loaded successfully or 0 otherwise.  \n  \n### Remarks  \n If the `lpszProfileName` parameter is `NULL`, this method checks the default registry location for `CKeyboardManager` data. The default registry location is specified by the [CWinAppEx Class](../../mfc/reference/cwinappex-class.md). The data must be previously written with the method [CKeyboardManager::SaveState](#ckeyboardmanager__savestate).  \n  \n If you do not specify a default window, the main frame window of your application will be used.  \n  \n##  <a name=\"ckeyboardmanager__resetall\"></a>  CKeyboardManager::ResetAll  \n Reloads the shortcut key tables from the application resource.  \n  \n```  \nvoid ResetAll();\n```  \n  \n### Remarks  \n This function clears the shortcuts stored in the `CKeyboardManager` instance. It will then reload the state of the keyboard manager from the application resource.  \n  \n##  <a name=\"ckeyboardmanager__savestate\"></a>  CKeyboardManager::SaveState  \n Saves the shortcut key tables to the Windows registry.  \n  \n```  \nBOOL SaveState(\n    LPCTSTR lpszProfileName = NULL,  \n    CFrameWnd* pDefaultFrame = NULL);\n```  \n  \n### Parameters  \n [in] `lpszProfileName`  \n The registry path for saving the `CKeyboardManager` state.  \n  \n [in] `pDefaultFrame`  \n A pointer to a frame window that becomes the default window.  \n  \n### Return Value  \n Nonzero if the keyboard manager state was saved successfully, or 0 otherwise.  \n  \n### Remarks  \n If the `lpszProfileName` parameter is `NULL`, this method will write the `CKeyboardManager` state to the default location specified by the [CWinAppEx Class](../../mfc/reference/cwinappex-class.md). If you specify a location, you can load the data later using the method [CKeyboardManager::LoadState](#ckeyboardmanager__loadstate).  \n  \n If you do not specify a default window, the main frame window will be used as the default window.  \n  \n##  <a name=\"ckeyboardmanager__showallaccelerators\"></a>  CKeyboardManager::ShowAllAccelerators  \n Shows all the shortcut keys associated with menu commands.  \n  \n```  \nstatic void ShowAllAccelerators(\n    BOOL bShowAll = TRUE,  \n    LPCTSTR lpszDelimiter = _afxDefaultAcceleratorDelimiter);\n```  \n  \n### Parameters  \n [in] `bShowAll`  \n If `true`, all the shortcut keys will be displayed. If `false`, only the first shortcut key will be displayed.  \n  \n [in] `lpszDelimiter`  \n A string to insert between shortcut keys. This delimiter has no effect if only one shortcut key is displayed.  \n  \n### Remarks  \n By default, if a command has more than one shortcut key associated with it, only the first shortcut key will be shown. This function enables you to list all the shortcut keys associated with all commands.  \n  \n The shortcut keys will be listed next to the command in the menu bar. If all the shortcut keys are displayed, the string provided by `lpszDelimiter` will separate individual shortcut keys.  \n  \n##  <a name=\"ckeyboardmanager__translatechartoupper\"></a>  CKeyboardManager::TranslateCharToUpper  \n Converts a character to its upper register.  \n  \n```  \nstatic UINT TranslateCharToUpper(const UINT nChar);\n```  \n  \n### Parameters  \n [in] `nChar`  \n The character to convert.  \n  \n### Return Value  \n The character that is the upper register of the input parameter.  \n  \n##  <a name=\"ckeyboardmanager__updateacceltable\"></a>  CKeyboardManager::UpdateAccelTable  \n Updates a shortcut key table with a new shortcut key table.  \n  \n```  \nBOOL UpdateAccelTable(\n    CMultiDocTemplate* pTemplate,  \n    LPACCEL lpAccel,  \n    int nSize,  \n    CFrameWnd* pDefaultFrame = NULL);\n\n \nBOOL UpdateAccelTable(\n    CMultiDocTemplate* pTemplate,  \n    HACCEL hAccelNew,  \n    CFrameWnd* pDefaultFrame = NULL);\n```  \n  \n### Parameters  \n [in] `pTemplate`  \n A pointer to a document template.  \n  \n [in] `lpAccel`  \n A pointer to the new shortcut key.  \n  \n [in] `nSize`  \n The size of the new shortcut table.  \n  \n [in] `pDefaultFrame`  \n A pointer to the default frame window.  \n  \n [in] `hAccelNew`  \n A handle to the new shortcut table.  \n  \n### Return Value  \n Nonzero if the method is successful; otherwise 0.  \n  \n### Remarks  \n Use this function to replace the existing shortcut table with new shortcut keys for several frame window objects. The function receives a document template as a parameter to obtain access to all frame window objects connected to the given document template.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CWinAppEx Class](../../mfc/reference/cwinappex-class.md)   \n [CWinAppEx::InitKeyboardManager](../../mfc/reference/cwinappex-class.md#cwinappex__initkeyboardmanager)   \n [Keyboard and Mouse Customization](../../mfc/keyboard-and-mouse-customization.md)\n\n\n\n"}