{"nodes":[{"pos":[12,112],"content":"TN048: Writing ODBC Setup and Administration Programs for MFC Database Applications | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"TN048: Writing ODBC Setup and Administration Programs for MFC Database Applications | Microsoft Docs","pos":[0,100]}]},{"content":"TN048: Writing ODBC Setup and Administration Programs for MFC Database Applications","pos":[789,872]},{"pos":[875,1190],"content":"[!NOTE]\n The following technical note has not been updated since it was first included in the online documentation. As a result, some procedures and topics might be out of date or incorrect. For the latest information, it is recommended that you search for the topic of interest in the online documentation index.","leadings":["","> "],"nodes":[{"content":" The following technical note has not been updated since it was first included in the online documentation. As a result, some procedures and topics might be out of date or incorrect. For the latest information, it is recommended that you search for the topic of interest in the online documentation index.","pos":[8,313],"nodes":[{"content":"The following technical note has not been updated since it was first included in the online documentation.","pos":[1,107]},{"content":"As a result, some procedures and topics might be out of date or incorrect.","pos":[108,182]},{"content":"For the latest information, it is recommended that you search for the topic of interest in the online documentation index.","pos":[183,305]}]}]},{"content":"Applications using MFC database classes will need a setup program that installs ODBC components.","pos":[1197,1293]},{"content":"They may also need an ODBC Administration program that will retrieve information about the available drivers, to specify default drivers and to configure data sources.","pos":[1294,1461]},{"content":"This note describes the use of the ODBC Installer API to write these programs.","pos":[1462,1540]},{"pos":[1605,1634],"content":"Writing an ODBC Setup Program"},{"content":"An MFC database application requires the ODBC Driver Manager (ODBC.DLL) and ODBC drivers to be able to get to data sources.","pos":[1638,1761]},{"content":"Many ODBC drivers also require additional network and communication DLLs.","pos":[1762,1835]},{"content":"Most ODBC drivers ship with a setup program that will install the required ODBC components.","pos":[1836,1927]},{"content":"Application developers using MFC database classes can:","pos":[1928,1982]},{"content":"Rely on the driver-specific setup programs for installing ODBC components.","pos":[1992,2066]},{"content":"This will require no further work on the developer's part — you can just redistribute the driver's setup program.","pos":[2067,2180]},{"content":"Alternatively, you can write your own setup program, which will install the driver manager and the driver.","pos":[2190,2296]},{"content":"The ODBC installer API can be used to write application-specific setup programs.","pos":[2303,2383]},{"content":"The functions in the installer API are implemented by the ODBC installer DLL — ODBCINST.DLL on 16-bit Windows and ODBCCP32.DLL on Win32.","pos":[2384,2520]},{"content":"An application can call <bpt id=\"p1\">**</bpt>SQLInstallODBC<ept id=\"p1\">**</ept> in the installer DLL, which will install the ODBC driver manager, ODBC drivers, and any required translators.","pos":[2521,2673],"source":" An application can call **SQLInstallODBC** in the installer DLL, which will install the ODBC driver manager, ODBC drivers, and any required translators."},{"content":"It then records the installed drivers and translators in the ODBCINST.INI file (or the registry, on NT).","pos":[2674,2778]},{"content":"<bpt id=\"p1\">**</bpt>SQLInstallODBC<ept id=\"p1\">**</ept> requires the full path to the ODBC.INF file, which contains the list of drivers to be installed and describes the files that comprise each driver.","pos":[2779,2944],"source":"**SQLInstallODBC** requires the full path to the ODBC.INF file, which contains the list of drivers to be installed and describes the files that comprise each driver."},{"content":"It also contains similar information about the driver manager and translators.","pos":[2945,3023]},{"content":"ODBC.INF files are typically supplied by driver developers.","pos":[3024,3083]},{"content":"A program can also install individual ODBC components.","pos":[3090,3144]},{"content":"To install the Driver Manager, a program first calls <bpt id=\"p1\">**</bpt>SQLInstallDriverManager<ept id=\"p1\">**</ept> in the installer DLL to get the target directory for the Driver Manager.","pos":[3145,3298],"source":" To install the Driver Manager, a program first calls **SQLInstallDriverManager** in the installer DLL to get the target directory for the Driver Manager."},{"content":"This is usually the directory in which Windows DLLs reside.","pos":[3299,3358]},{"content":"The program then uses the information in the [ODBC Driver Manager] section of the ODBC.INF file to copy the Driver Manager and related files from the installation disk to this directory.","pos":[3359,3545]},{"content":"To install an individual driver, a program first calls <bpt id=\"p1\">**</bpt>SQLInstallDriver<ept id=\"p1\">**</ept> in the installer DLL to add the driver specification to the ODBCINST.INI file (or the registry, on NT).","pos":[3546,3725],"source":" To install an individual driver, a program first calls **SQLInstallDriver** in the installer DLL to add the driver specification to the ODBCINST.INI file (or the registry, on NT)."},{"content":"<bpt id=\"p1\">**</bpt>SQLInstallDriver<ept id=\"p1\">**</ept> returns the driver's target directory — usually the directory in which Windows DLLs reside.","pos":[3726,3838],"source":"**SQLInstallDriver** returns the driver's target directory — usually the directory in which Windows DLLs reside."},{"content":"The program then uses the information in the driver's section of the ODBC.INF file to copy the driver DLL and related files from the installation disk to this directory.","pos":[3839,4008]},{"pos":[4015,4167],"content":"For more information on ODBC.INF, ODBCINST.INI and using the installer API, see ODBC SDK <bpt id=\"p1\">*</bpt>Programmer's Reference,<ept id=\"p1\">*</ept> Chapter 19, Installing ODBC Software.","source":"For more information on ODBC.INF, ODBCINST.INI and using the installer API, see ODBC SDK *Programmer's Reference,* Chapter 19, Installing ODBC Software."},{"pos":[4232,4261],"content":"Writing an ODBC Administrator"},{"content":"An MFC database application can set up and configure ODBC data sources in one of two ways, as follows:","pos":[4265,4367]},{"content":"Use the ODBC Administrator (available as a program or as a Control Panel item).","pos":[4377,4456]},{"content":"Create your own program to configure data sources.","pos":[4466,4516]},{"content":"A program that configures data sources makes function calls to the installer DLL.","pos":[4523,4604]},{"content":"The installer DLL calls a setup DLL to configure a data source.","pos":[4605,4668]},{"content":"There is one setup DLL for each driver; it may be the driver DLL itself, or a separate DLL.","pos":[4669,4760]},{"content":"The setup DLL prompts the user for information that the driver needs to connect to the data source and the default translator, if supported.","pos":[4761,4901]},{"content":"It then calls the installer DLL and Windows APIs to record this information in the ODBC.INI file (or registry).","pos":[4902,5013]},{"content":"To display a dialog box with which a user can add, modify, and delete data sources, a program calls <bpt id=\"p1\">**</bpt>SQLManageDataSources<ept id=\"p1\">**</ept> in the installer DLL.","pos":[5020,5166],"source":"To display a dialog box with which a user can add, modify, and delete data sources, a program calls **SQLManageDataSources** in the installer DLL."},{"content":"This function is invoked when the installer DLL is called from the Control Panel.","pos":[5167,5248]},{"content":"To add, modify, or delete a data source, <bpt id=\"p1\">**</bpt>SQLManageDataSources<ept id=\"p1\">**</ept> calls <bpt id=\"p2\">**</bpt>ConfigDSN<ept id=\"p2\">**</ept> in the setup DLL for the driver associated with that data source.","pos":[5249,5400],"source":" To add, modify, or delete a data source, **SQLManageDataSources** calls **ConfigDSN** in the setup DLL for the driver associated with that data source."},{"content":"To directly add, modify, or delete data sources, a program calls <bpt id=\"p1\">**</bpt>SQLConfigDataSource<ept id=\"p1\">**</ept> in the installer DLL.","pos":[5401,5511],"source":" To directly add, modify, or delete data sources, a program calls **SQLConfigDataSource** in the installer DLL."},{"content":"The program passes the name of the data source and an option that specifies the action to take.","pos":[5512,5607]},{"content":"<bpt id=\"p1\">**</bpt>SQLConfigDataSource<ept id=\"p1\">**</ept> calls <bpt id=\"p2\">**</bpt>ConfigDSN<ept id=\"p2\">**</ept> in the setup DLL and passes it the arguments from <bpt id=\"p3\">**</bpt>SQLConfigDataSource<ept id=\"p3\">**</ept>.","pos":[5608,5726],"source":"**SQLConfigDataSource** calls **ConfigDSN** in the setup DLL and passes it the arguments from **SQLConfigDataSource**."},{"pos":[5733,5885],"content":"For more information, see ODBC SDK <bpt id=\"p1\">*</bpt>Programmer's Reference,<ept id=\"p1\">*</ept> Chapter 23, Setup DLL Function Reference, and Chapter 24, Installer DLL Function Reference.","source":"For more information, see ODBC SDK *Programmer's Reference,* Chapter 23, Setup DLL Function Reference, and Chapter 24, Installer DLL Function Reference."},{"content":"See Also","pos":[5894,5902]},{"content":"Technical Notes by Number","pos":[5907,5932]},{"content":"Technical Notes by Category","pos":[5976,6003]}],"content":"---\ntitle: \"TN048: Writing ODBC Setup and Administration Programs for MFC Database Applications | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.mfc.odbc\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"installing ODBC\"\n  - \"ODBC, installing\"\n  - \"setup, ODBC setup programs\"\n  - \"TN048\"\n  - \"ODBC, and MFC\"\n  - \"MFC, database applications\"\nms.assetid: d456cdd4-0513-4a51-80c0-9132b66115ce\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# TN048: Writing ODBC Setup and Administration Programs for MFC Database Applications\n> [!NOTE]\n>  The following technical note has not been updated since it was first included in the online documentation. As a result, some procedures and topics might be out of date or incorrect. For the latest information, it is recommended that you search for the topic of interest in the online documentation index.  \n  \n Applications using MFC database classes will need a setup program that installs ODBC components. They may also need an ODBC Administration program that will retrieve information about the available drivers, to specify default drivers and to configure data sources. This note describes the use of the ODBC Installer API to write these programs.  \n  \n##  <a name=\"_mfcnotes_writing_an_odbc_setup_program\"></a> Writing an ODBC Setup Program  \n An MFC database application requires the ODBC Driver Manager (ODBC.DLL) and ODBC drivers to be able to get to data sources. Many ODBC drivers also require additional network and communication DLLs. Most ODBC drivers ship with a setup program that will install the required ODBC components. Application developers using MFC database classes can:  \n  \n-   Rely on the driver-specific setup programs for installing ODBC components. This will require no further work on the developer's part — you can just redistribute the driver's setup program.  \n  \n-   Alternatively, you can write your own setup program, which will install the driver manager and the driver.  \n  \n The ODBC installer API can be used to write application-specific setup programs. The functions in the installer API are implemented by the ODBC installer DLL — ODBCINST.DLL on 16-bit Windows and ODBCCP32.DLL on Win32. An application can call **SQLInstallODBC** in the installer DLL, which will install the ODBC driver manager, ODBC drivers, and any required translators. It then records the installed drivers and translators in the ODBCINST.INI file (or the registry, on NT). **SQLInstallODBC** requires the full path to the ODBC.INF file, which contains the list of drivers to be installed and describes the files that comprise each driver. It also contains similar information about the driver manager and translators. ODBC.INF files are typically supplied by driver developers.  \n  \n A program can also install individual ODBC components. To install the Driver Manager, a program first calls **SQLInstallDriverManager** in the installer DLL to get the target directory for the Driver Manager. This is usually the directory in which Windows DLLs reside. The program then uses the information in the [ODBC Driver Manager] section of the ODBC.INF file to copy the Driver Manager and related files from the installation disk to this directory. To install an individual driver, a program first calls **SQLInstallDriver** in the installer DLL to add the driver specification to the ODBCINST.INI file (or the registry, on NT). **SQLInstallDriver** returns the driver's target directory — usually the directory in which Windows DLLs reside. The program then uses the information in the driver's section of the ODBC.INF file to copy the driver DLL and related files from the installation disk to this directory.  \n  \n For more information on ODBC.INF, ODBCINST.INI and using the installer API, see ODBC SDK *Programmer's Reference,* Chapter 19, Installing ODBC Software.  \n  \n##  <a name=\"_mfcnotes_writing_an_odbc_administrator\"></a> Writing an ODBC Administrator  \n An MFC database application can set up and configure ODBC data sources in one of two ways, as follows:  \n  \n-   Use the ODBC Administrator (available as a program or as a Control Panel item).  \n  \n-   Create your own program to configure data sources.  \n  \n A program that configures data sources makes function calls to the installer DLL. The installer DLL calls a setup DLL to configure a data source. There is one setup DLL for each driver; it may be the driver DLL itself, or a separate DLL. The setup DLL prompts the user for information that the driver needs to connect to the data source and the default translator, if supported. It then calls the installer DLL and Windows APIs to record this information in the ODBC.INI file (or registry).  \n  \n To display a dialog box with which a user can add, modify, and delete data sources, a program calls **SQLManageDataSources** in the installer DLL. This function is invoked when the installer DLL is called from the Control Panel. To add, modify, or delete a data source, **SQLManageDataSources** calls **ConfigDSN** in the setup DLL for the driver associated with that data source. To directly add, modify, or delete data sources, a program calls **SQLConfigDataSource** in the installer DLL. The program passes the name of the data source and an option that specifies the action to take. **SQLConfigDataSource** calls **ConfigDSN** in the setup DLL and passes it the arguments from **SQLConfigDataSource**.  \n  \n For more information, see ODBC SDK *Programmer's Reference,* Chapter 23, Setup DLL Function Reference, and Chapter 24, Installer DLL Function Reference.  \n  \n## See Also  \n [Technical Notes by Number](../mfc/technical-notes-by-number.md)   \n [Technical Notes by Category](../mfc/technical-notes-by-category.md)\n\n"}