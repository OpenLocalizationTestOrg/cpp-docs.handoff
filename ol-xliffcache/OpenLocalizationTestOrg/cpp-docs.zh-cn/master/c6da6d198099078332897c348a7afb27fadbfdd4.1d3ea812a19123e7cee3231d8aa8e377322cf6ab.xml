{"nodes":[{"pos":[12,58],"content":"Specifying DLLs to Delay Load | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Specifying DLLs to Delay Load | Microsoft Docs","pos":[0,46]}]},{"content":"Specifying DLLs to Delay Load","pos":[693,722]},{"content":"You can specify which DLLs to delay load with the <bpt id=\"p1\">[</bpt>/delayload<ept id=\"p1\">](../../build/reference/delayload-delay-load-import.md)</ept>:<ph id=\"ph1\">`dllname`</ph> linker option.","pos":[723,864],"source":"You can specify which DLLs to delay load with the [/delayload](../../build/reference/delayload-delay-load-import.md):`dllname` linker option."},{"content":"If you do not plan to use your own version of a helper function, you must also link your program with delayimp.lib (for desktop applications) or dloadhelper.lib (for store apps).","pos":[865,1043]},{"content":"The following is a simple example of delay loading a DLL:","pos":[1050,1107]},{"content":"Build the DEBUG version of the project.","pos":[1467,1506]},{"content":"Step through the code using the debugger and you will notice that user32.dll is loaded only when you make the call to <ph id=\"ph1\">`MessageBox`</ph>.","pos":[1507,1638],"source":" Step through the code using the debugger and you will notice that user32.dll is loaded only when you make the call to `MessageBox`."},{"content":"See Also","pos":[1647,1655]},{"content":"Linker Support for Delay-Loaded DLLs","pos":[1660,1696]}],"content":"---\ntitle: \"Specifying DLLs to Delay Load | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DELAYLOAD linker option\"\n  - \"delayed loading of DLLs\"\n  - \"delayed loading of DLLs, specifying\"\n  - \"/DELAYLOAD linker option\"\nms.assetid: 94cbecfe-7a42-40d1-a618-9f2786bac0d8\ncaps.latest.revision: 8\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Specifying DLLs to Delay Load\nYou can specify which DLLs to delay load with the [/delayload](../../build/reference/delayload-delay-load-import.md):`dllname` linker option. If you do not plan to use your own version of a helper function, you must also link your program with delayimp.lib (for desktop applications) or dloadhelper.lib (for store apps).  \n  \n The following is a simple example of delay loading a DLL:  \n  \n```  \n// cl t.cpp user32.lib delayimp.lib  /link /DELAYLOAD:user32.dll  \n#include <windows.h>  \n// uncomment these lines to remove .libs from command line  \n// #pragma comment(lib, \"delayimp\")  \n// #pragma comment(lib, \"user32\")  \n  \nint main() {  \n   // user32.dll will load at this point  \n   MessageBox(NULL, \"Hello\", \"Hello\", MB_OK);  \n}  \n```  \n  \n Build the DEBUG version of the project. Step through the code using the debugger and you will notice that user32.dll is loaded only when you make the call to `MessageBox`.  \n  \n## See Also  \n [Linker Support for Delay-Loaded DLLs](../../build/reference/linker-support-for-delay-loaded-dlls.md)"}