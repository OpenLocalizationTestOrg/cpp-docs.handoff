{"nodes":[{"pos":[12,46],"content":"CDataSource Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDataSource Class | Microsoft Docs","pos":[0,34]}]},{"content":"CDataSource Class","pos":[650,667]},{"content":"Corresponds to an OLE DB data source object, which represents a connection through a provider to a data source.","pos":[668,779]},{"content":"Syntax","pos":[788,794]},{"content":"Members","pos":[838,845]},{"content":"Methods","pos":[855,862]},{"content":"Close","pos":[884,889]},{"content":"Closes the connection.","pos":[930,952]},{"content":"GetInitializationString","pos":[958,981]},{"content":"Retrieves the initialization string of the data source that is currently open.","pos":[1040,1118]},{"content":"GetProperties","pos":[1124,1137]},{"content":"Gets the values of properties currently set for the connected data source.","pos":[1186,1260]},{"content":"GetProperty","pos":[1266,1277]},{"content":"Gets the value of a single property currently set for the connected data source.","pos":[1324,1404]},{"content":"Open","pos":[1410,1414]},{"pos":[1454,1591],"content":"Creates a connection to a provider (data source) using either a <bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>ProgID<ept id=\"p2\">**</ept>, or a <ph id=\"ph1\">`CEnumerator`</ph> moniker provided by the caller.","source":"Creates a connection to a provider (data source) using either a **CLSID**, **ProgID**, or a `CEnumerator` moniker provided by the caller."},{"content":"OpenFromFileName","pos":[1597,1613]},{"content":"Opens a data source from a file specified by the user-supplied file name.","pos":[1665,1738]},{"content":"OpenFromInitializationString","pos":[1744,1772]},{"content":"Opens the data source specified by an initialization string.","pos":[1836,1896]},{"content":"OpenWithPromptFileName","pos":[1902,1924]},{"content":"Allows the user to select a previously created data link file to open the corresponding data source.","pos":[1982,2082]},{"content":"OpenWithServiceComponents","pos":[2088,2113]},{"content":"Opens a data source object using the Data Link dialog box.","pos":[2174,2232]},{"content":"Remarks","pos":[2242,2249]},{"content":"One or more database sessions can be created for a single connection.","pos":[2253,2322]},{"content":"These sessions are represented by <ph id=\"ph1\">`CSession`</ph>.","pos":[2323,2368],"source":" These sessions are represented by `CSession`."},{"content":"You must call <bpt id=\"p1\">[</bpt>CDataSource::Open<ept id=\"p1\">](../../data/oledb/cdatasource-open.md)</ept> to open the connection before creating a session with <ph id=\"ph1\">`CSession::Open`</ph>.","pos":[2369,2512],"source":" You must call [CDataSource::Open](../../data/oledb/cdatasource-open.md) to open the connection before creating a session with `CSession::Open`."},{"pos":[2519,2615],"content":"For an example of how to use <ph id=\"ph1\">`CDataSource`</ph>, see the <bpt id=\"p1\">[</bpt>CatDB<ept id=\"p1\">](../../visual-cpp-samples.md)</ept> sample.","source":"For an example of how to use `CDataSource`, see the [CatDB](../../visual-cpp-samples.md) sample."},{"content":"Requirements","pos":[2624,2636]},{"pos":[2640,2662],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldbcli.h","source":"**Header:** atldbcli.h"},{"content":"See Also","pos":[2671,2679]},{"content":"OLE DB Consumer Templates","pos":[2684,2709]},{"content":"OLE DB Consumer Templates Reference","pos":[2767,2802]}],"content":"---\ntitle: \"CDataSource Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"ATL.CDataSource\"\n  - \"ATL::CDataSource\"\n  - \"CDataSource\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CDataSource class\"\nms.assetid: 99bf862c-9d5c-4117-9501-aa0e2672085c\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDataSource Class\nCorresponds to an OLE DB data source object, which represents a connection through a provider to a data source.  \n  \n## Syntax  \n  \n```  \nclass CDataSource  \n```  \n  \n## Members  \n  \n### Methods  \n  \n|||  \n|-|-|  \n|[Close](../../data/oledb/cdatasource-close.md)|Closes the connection.|  \n|[GetInitializationString](../../data/oledb/cdatasource-getinitializationstring.md)|Retrieves the initialization string of the data source that is currently open.|  \n|[GetProperties](../../data/oledb/cdatasource-getproperties.md)|Gets the values of properties currently set for the connected data source.|  \n|[GetProperty](../../data/oledb/cdatasource-getproperty.md)|Gets the value of a single property currently set for the connected data source.|  \n|[Open](../../data/oledb/cdatasource-open.md)|Creates a connection to a provider (data source) using either a **CLSID**, **ProgID**, or a `CEnumerator` moniker provided by the caller.|  \n|[OpenFromFileName](../../data/oledb/cdatasource-openfromfilename.md)|Opens a data source from a file specified by the user-supplied file name.|  \n|[OpenFromInitializationString](../../data/oledb/cdatasource-openfrominitializationstring.md)|Opens the data source specified by an initialization string.|  \n|[OpenWithPromptFileName](../../data/oledb/cdatasource-openwithpromptfilename.md)|Allows the user to select a previously created data link file to open the corresponding data source.|  \n|[OpenWithServiceComponents](../../data/oledb/cdatasource-openwithservicecomponents.md)|Opens a data source object using the Data Link dialog box.|  \n  \n## Remarks  \n One or more database sessions can be created for a single connection. These sessions are represented by `CSession`. You must call [CDataSource::Open](../../data/oledb/cdatasource-open.md) to open the connection before creating a session with `CSession::Open`.  \n  \n For an example of how to use `CDataSource`, see the [CatDB](../../visual-cpp-samples.md) sample.  \n  \n## Requirements  \n **Header:** atldbcli.h  \n  \n## See Also  \n [OLE DB Consumer Templates](../../data/oledb/ole-db-consumer-templates-cpp.md)   \n [OLE DB Consumer Templates Reference](../../data/oledb/ole-db-consumer-templates-reference.md)"}