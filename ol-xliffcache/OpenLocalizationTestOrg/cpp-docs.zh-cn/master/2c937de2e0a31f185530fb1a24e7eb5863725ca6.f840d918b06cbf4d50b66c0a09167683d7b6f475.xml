{"nodes":[{"pos":[12,60],"content":"Modifying the ATL DHTML Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Modifying the ATL DHTML Control | Microsoft Docs","pos":[0,48]}]},{"content":"Modifying the ATL DHTML Control","pos":[673,704]},{"content":"The ATL Control Wizard provides starter code so you can build and run the control, and so you can see how the methods are written in the project files and how the DHTML calls into the control's C++ code using the dispatch methods.","pos":[705,935]},{"content":"You can add any dispatch method to the interface.","pos":[936,985]},{"content":"Then, you can call the methods in the HTML resource.","pos":[986,1038]},{"content":"To modify the ATL DHTML control","pos":[1049,1080]},{"content":"In Class View, expand the control project.","pos":[1090,1132]},{"content":"Note that the interface that ends in \"UI\" has one method, <ph id=\"ph1\">`OnClick`</ph>.","pos":[1143,1211],"source":"Note that the interface that ends in \"UI\" has one method, `OnClick`."},{"content":"The interface that does not end in \"UI\" does not have any methods.","pos":[1212,1278]},{"pos":[1288,1367],"content":"Add a method called <ph id=\"ph1\">`MethodInvoked`</ph> to the interface that does not end in \"UI.\"","source":"Add a method called `MethodInvoked` to the interface that does not end in \"UI.\""},{"content":"This method will be added to the interface that is used in the control container for container interaction, not to the interface used by DHTML to interact with the control.","pos":[1378,1550]},{"content":"Only the container can invoke this method.","pos":[1551,1593]},{"content":"Find the stubbed-out method in the .cpp file and add code to display a message box, for example:","pos":[1603,1699]},{"pos":[1717,1730],"content":"NVC_ATL_COM#5"},{"content":"Add another method called <ph id=\"ph1\">`HelloHTML`</ph>, only this time, add it to the interface that ends in \"UI.\"","pos":[1804,1901],"source":"Add another method called `HelloHTML`, only this time, add it to the interface that ends in \"UI.\""},{"content":"Find the stubbed-out <ph id=\"ph1\">`HelloHTML`</ph> method in the .cpp file and add code to display a message box, for example:","pos":[1902,2010],"source":" Find the stubbed-out `HelloHTML` method in the .cpp file and add code to display a message box, for example:"},{"pos":[2028,2041],"content":"NVC_ATL_COM#6"},{"content":"Add a third method, <ph id=\"ph1\">`GoToURL`</ph>, to the interface that does not end in \"UI.\"","pos":[2115,2189],"source":"Add a third method, `GoToURL`, to the interface that does not end in \"UI.\""},{"content":"Implement this method by calling <bpt id=\"p1\">[</bpt>IWebBrowser2::Navigate<ept id=\"p1\">](https://msdn.microsoft.com/library/aa752133.aspx)</ept>, as follows:","pos":[2190,2310],"source":" Implement this method by calling [IWebBrowser2::Navigate](https://msdn.microsoft.com/library/aa752133.aspx), as follows:"},{"pos":[2328,2341],"content":"NVC_ATL_COM#7"},{"pos":[2416,2530],"content":"You can use the <bpt id=\"p1\">**</bpt>IWebBrowser2<ept id=\"p1\">**</ept> methods because ATL provides a pointer to that interface for you in your .h file.","source":"You can use the **IWebBrowser2** methods because ATL provides a pointer to that interface for you in your .h file."},{"content":"Next, modify the HTML resource to invoke the methods you created.","pos":[2537,2602]},{"content":"You will add three buttons for invoking these methods.","pos":[2603,2657]},{"content":"To modify the HTML resource","pos":[2668,2695]},{"content":"In Solution Explorer, double-click the .htm file to display the HTML resource.","pos":[2705,2783]},{"content":"Examine the HTML, especially the calls to the external Windows dispatch methods.","pos":[2794,2874]},{"content":"The HTML calls the project's <ph id=\"ph1\">`OnClick`</ph> method, and the parameters indicate the body of the control (<ph id=\"ph2\">`theBody`</ph>) and the color to assign (\"<ph id=\"ph3\">`red`</ph>\").","pos":[2875,3020],"source":" The HTML calls the project's `OnClick` method, and the parameters indicate the body of the control (`theBody`) and the color to assign (\"`red`\")."},{"content":"The text following the method call is the label that appears on the button.","pos":[3021,3096]},{"content":"Add another <ph id=\"ph1\">`OnClick`</ph> method, only change the color.","pos":[3106,3158],"source":"Add another `OnClick` method, only change the color."},{"content":"For example:","pos":[3159,3171]},{"pos":[3296,3431],"content":"This method will create a button, labeled <bpt id=\"p1\">**</bpt>Refresh<ept id=\"p1\">**</ept>, that the user can click to return the control to the original, white background.","source":"This method will create a button, labeled **Refresh**, that the user can click to return the control to the original, white background."},{"content":"Add the call to the <ph id=\"ph1\">`HelloHTML`</ph> method you created.","pos":[3441,3492],"source":"Add the call to the `HelloHTML` method you created."},{"content":"For example:","pos":[3493,3505]},{"pos":[3618,3738],"content":"This method will create a button, labeled <bpt id=\"p1\">**</bpt>HelloHTML<ept id=\"p1\">**</ept>, that the user can click to display the <ph id=\"ph1\">`HelloHTML`</ph> message box.","source":"This method will create a button, labeled **HelloHTML**, that the user can click to display the `HelloHTML` message box."},{"pos":[3745,3851],"content":"You can now build and <bpt id=\"p1\">[</bpt>test the modified DHTML control<ept id=\"p1\">](../atl/testing-the-modified-atl-dhtml-control.md)</ept>.","source":"You can now build and [test the modified DHTML control](../atl/testing-the-modified-atl-dhtml-control.md)."},{"content":"See Also","pos":[3860,3868]},{"content":"Support for DHTML Control","pos":[3873,3898]}],"content":"---\ntitle: \"Modifying the ATL DHTML Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"HTML controls, modifying\"\n  - \"DHTML controls\"\n  - \"DHTML controls, modifying\"\nms.assetid: c053f35f-8629-4600-9595-721f5956777a\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Modifying the ATL DHTML Control\nThe ATL Control Wizard provides starter code so you can build and run the control, and so you can see how the methods are written in the project files and how the DHTML calls into the control's C++ code using the dispatch methods. You can add any dispatch method to the interface. Then, you can call the methods in the HTML resource.  \n  \n#### To modify the ATL DHTML control  \n  \n1.  In Class View, expand the control project.  \n  \n     Note that the interface that ends in \"UI\" has one method, `OnClick`. The interface that does not end in \"UI\" does not have any methods.  \n  \n2.  Add a method called `MethodInvoked` to the interface that does not end in \"UI.\"  \n  \n     This method will be added to the interface that is used in the control container for container interaction, not to the interface used by DHTML to interact with the control. Only the container can invoke this method.  \n  \n3.  Find the stubbed-out method in the .cpp file and add code to display a message box, for example:  \n  \n [!code-cpp[NVC_ATL_COM#5](../atl/codesnippet/cpp/modifying-the-atl-dhtml-control_1.cpp)]  \n  \n4.  Add another method called `HelloHTML`, only this time, add it to the interface that ends in \"UI.\" Find the stubbed-out `HelloHTML` method in the .cpp file and add code to display a message box, for example:  \n  \n [!code-cpp[NVC_ATL_COM#6](../atl/codesnippet/cpp/modifying-the-atl-dhtml-control_2.cpp)]  \n  \n5.  Add a third method, `GoToURL`, to the interface that does not end in \"UI.\" Implement this method by calling [IWebBrowser2::Navigate](https://msdn.microsoft.com/library/aa752133.aspx), as follows:  \n  \n [!code-cpp[NVC_ATL_COM#7](../atl/codesnippet/cpp/modifying-the-atl-dhtml-control_3.cpp)]  \n  \n     You can use the **IWebBrowser2** methods because ATL provides a pointer to that interface for you in your .h file.  \n  \n Next, modify the HTML resource to invoke the methods you created. You will add three buttons for invoking these methods.  \n  \n#### To modify the HTML resource  \n  \n1.  In Solution Explorer, double-click the .htm file to display the HTML resource.  \n  \n     Examine the HTML, especially the calls to the external Windows dispatch methods. The HTML calls the project's `OnClick` method, and the parameters indicate the body of the control (`theBody`) and the color to assign (\"`red`\"). The text following the method call is the label that appears on the button.  \n  \n2.  Add another `OnClick` method, only change the color. For example:  \n  \n ```  \n <br>  \n <br>  \n <BUTTON onclick='window.external.OnClick(theBody, \"white\");'>Refresh</BUTTON>  \n ```  \n  \n     This method will create a button, labeled **Refresh**, that the user can click to return the control to the original, white background.  \n  \n3.  Add the call to the `HelloHTML` method you created. For example:  \n  \n ```  \n <br>  \n <br>  \n <BUTTON onclick='window.external.HelloHTML();'>HelloHTML</BUTTON>  \n ```  \n  \n     This method will create a button, labeled **HelloHTML**, that the user can click to display the `HelloHTML` message box.  \n  \n You can now build and [test the modified DHTML control](../atl/testing-the-modified-atl-dhtml-control.md).  \n  \n## See Also  \n [Support for DHTML Control](../atl/atl-support-for-dhtml-controls.md)\n\n"}