{"nodes":[{"pos":[12,94],"content":"Converting Projects from Mixed Mode to Pure Intermediate Language | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Converting Projects from Mixed Mode to Pure Intermediate Language | Microsoft Docs","pos":[0,82]}]},{"content":"Converting Projects from Mixed Mode to Pure Intermediate Language","pos":[790,855]},{"content":"All Visual C++ CLR projects link to the C run-time libraries by default.","pos":[856,928]},{"content":"Consequently, these projects are classified as mixed-mode applications, because they combine native code with code that targets the common language runtime (managed code).","pos":[929,1100]},{"content":"When they are compiled, they are compiled into intermediate language (IL), also known as Microsoft intermediate language (MSIL).","pos":[1101,1229]},{"content":"To convert your mixed-mode application into pure intermediate language","pos":[1239,1309]},{"pos":[1319,1414],"content":"Remove links to the <bpt id=\"p1\">[</bpt>C run-time libraries<ept id=\"p1\">](../c-runtime-library/crt-library-features.md)</ept> (CRT):","source":"Remove links to the [C run-time libraries](../c-runtime-library/crt-library-features.md) (CRT):"},{"content":"In the .cpp file defining the entry point of your application, change the entry point to <ph id=\"ph1\">`Main()`</ph>.","pos":[1428,1526],"source":"In the .cpp file defining the entry point of your application, change the entry point to `Main()`."},{"content":"Using <ph id=\"ph1\">`Main()`</ph> indicates that your project does not link to the CRT.","pos":[1527,1595],"source":" Using `Main()` indicates that your project does not link to the CRT."},{"pos":[1609,1751],"content":"In Solution Explorer, right-click your project and select <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> on the shortcut menu to open the property pages for your application.","source":"In Solution Explorer, right-click your project and select **Properties** on the shortcut menu to open the property pages for your application."},{"pos":[1765,1892],"content":"In the <bpt id=\"p1\">**</bpt>Advanced<ept id=\"p1\">**</ept> project property page for the <bpt id=\"p2\">**</bpt>Linker<ept id=\"p2\">**</ept>, select the <bpt id=\"p3\">**</bpt>Entry Point<ept id=\"p3\">**</ept> and then enter <bpt id=\"p4\">**</bpt>Main<ept id=\"p4\">**</ept> in this field.","source":"In the **Advanced** project property page for the **Linker**, select the **Entry Point** and then enter **Main** in this field."},{"pos":[1906,2075],"content":"For console applications, in the <bpt id=\"p1\">**</bpt>System<ept id=\"p1\">**</ept> project property page for the <bpt id=\"p2\">**</bpt>Linker<ept id=\"p2\">**</ept>, select the <bpt id=\"p3\">**</bpt>SubSystem<ept id=\"p3\">**</ept> field and change this to <bpt id=\"p4\">**</bpt>Console (/SUBSYSTEM:CONSOLE)<ept id=\"p4\">**</ept>.","source":"For console applications, in the **System** project property page for the **Linker**, select the **SubSystem** field and change this to **Console (/SUBSYSTEM:CONSOLE)**."},{"pos":[2091,2264],"content":"[!NOTE]\n You do not have to set this property for Windows Forms applications because the **SubSystem** field is set to **Windows (/SUBSYSTEM:WINDOWS)** by default.","leadings":["","        > "],"nodes":[{"content":"You do not have to set this property for Windows Forms applications because the <bpt id=\"p1\">**</bpt>SubSystem<ept id=\"p1\">**</ept> field is set to <bpt id=\"p2\">**</bpt>Windows (/SUBSYSTEM:WINDOWS)<ept id=\"p2\">**</ept> by default.","pos":[9,163],"source":" You do not have to set this property for Windows Forms applications because the **SubSystem** field is set to **Windows (/SUBSYSTEM:WINDOWS)** by default."}]},{"content":"In stdafx.h, comment out all the <ph id=\"ph1\">`#include`</ph> statements.","pos":[2278,2333],"source":"In stdafx.h, comment out all the `#include` statements."},{"content":"For example, in console applications:","pos":[2334,2371]},{"content":"-or-","pos":[2482,2486]},{"content":"For example, in Windows Forms applications:","pos":[2501,2544]},{"content":"For Windows Forms applications, in Form1.cpp, comment out the <ph id=\"ph1\">`#include`</ph> statement that references windows.h.","pos":[2720,2829],"source":"For Windows Forms applications, in Form1.cpp, comment out the `#include` statement that references windows.h."},{"content":"For example:","pos":[2830,2842]},{"content":"Add the following code to stdafx.h:","pos":[2917,2952]},{"content":"Remove all unmanaged types:","pos":[3108,3135]},{"content":"Wherever appropriate, replace unmanaged types with references to structures from the <bpt id=\"p1\">[</bpt>System<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/system.appdomainmanager.appdomainmanager.aspx)</ept> namespace.","pos":[3149,3341],"source":"Wherever appropriate, replace unmanaged types with references to structures from the [System](https://msdn.microsoft.com/en-us/library/system.appdomainmanager.appdomainmanager.aspx) namespace."},{"content":"Common managed types are listed in the following table:","pos":[3342,3397]},{"content":"Structure","pos":[3412,3421]},{"content":"Description","pos":[3422,3433]},{"content":"Boolean","pos":[3493,3500]},{"content":"Represents a Boolean value.","pos":[3576,3603]},{"content":"Byte","pos":[3617,3621]},{"content":"Represents an 8-bit unsigned integer.","pos":[3694,3731]},{"content":"Char","pos":[3745,3749]},{"content":"Represents a Unicode character.","pos":[3822,3853]},{"content":"DateTime","pos":[3867,3875]},{"content":"Represents an instant in time, typically expressed as a date and time of day.","pos":[3949,4026]},{"content":"Decimal","pos":[4040,4047]},{"content":"Represents a decimal number.","pos":[4123,4151]},{"content":"Double","pos":[4165,4171]},{"content":"Represents a double-precision floating-point number.","pos":[4246,4298]},{"content":"Guid","pos":[4312,4316]},{"content":"Represents a globally unique identifier (GUID).","pos":[4389,4436]},{"content":"Int16","pos":[4450,4455]},{"content":"Represents a 16-bit signed integer.","pos":[4529,4564]},{"content":"Int32","pos":[4578,4583]},{"content":"Represents a 32-bit signed integer.","pos":[4657,4692]},{"content":"Int64","pos":[4706,4711]},{"content":"Represents a 64-bit signed integer.","pos":[4785,4820]},{"content":"IntPtr","pos":[4834,4840]},{"content":"A platform-specific type that is used to represent a pointer or a handle.","pos":[4915,4988]},{"content":"SByte","pos":[5002,5007]},{"content":"Represents an 8-bit signed integer.","pos":[5068,5103]},{"content":"Single","pos":[5117,5123]},{"content":"Represents a single-precision floating-point number.","pos":[5186,5238]},{"content":"TimeSpan","pos":[5252,5260]},{"content":"Represents a time interval.","pos":[5337,5364]},{"content":"UInt16","pos":[5378,5384]},{"content":"Represents a 16-bit unsigned integer.","pos":[5459,5496]},{"content":"UInt32","pos":[5510,5516]},{"content":"Represents a 32-bit unsigned integer.","pos":[5591,5628]},{"content":"UInt64","pos":[5642,5648]},{"content":"Represents a 64-bit unsigned integer.","pos":[5723,5760]},{"content":"UIntPtr","pos":[5774,5781]},{"content":"A platform-specific type that is used to represent a pointer or a handle.","pos":[5857,5930]},{"content":"Void","pos":[5944,5948]},{"content":"Indicates a method that does not return a value; that is, the method has the void return type.","pos":[6021,6115]}],"content":"---\ntitle: \"Converting Projects from Mixed Mode to Pure Intermediate Language | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"intermediate language, mixed-mode applications\"\n  - \"mixed-mode applications\"\n  - \"mixed-mode applications, intermediate language\"\n  - \"projects [C++], converting to intermediate language\"\nms.assetid: 855f9e3c-4f09-4bfe-8eab-a45f68292be9\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Converting Projects from Mixed Mode to Pure Intermediate Language\nAll Visual C++ CLR projects link to the C run-time libraries by default. Consequently, these projects are classified as mixed-mode applications, because they combine native code with code that targets the common language runtime (managed code). When they are compiled, they are compiled into intermediate language (IL), also known as Microsoft intermediate language (MSIL).  \n  \n### To convert your mixed-mode application into pure intermediate language  \n  \n1.  Remove links to the [C run-time libraries](../c-runtime-library/crt-library-features.md) (CRT):  \n  \n    1.  In the .cpp file defining the entry point of your application, change the entry point to `Main()`. Using `Main()` indicates that your project does not link to the CRT.  \n  \n    2.  In Solution Explorer, right-click your project and select **Properties** on the shortcut menu to open the property pages for your application.  \n  \n    3.  In the **Advanced** project property page for the **Linker**, select the **Entry Point** and then enter **Main** in this field.  \n  \n    4.  For console applications, in the **System** project property page for the **Linker**, select the **SubSystem** field and change this to **Console (/SUBSYSTEM:CONSOLE)**.  \n  \n        > [!NOTE]\n        >  You do not have to set this property for Windows Forms applications because the **SubSystem** field is set to **Windows (/SUBSYSTEM:WINDOWS)** by default.  \n  \n    5.  In stdafx.h, comment out all the `#include` statements. For example, in console applications:  \n  \n        ```  \n        // #include <iostream>  \n        // #include <tchar.h>  \n        ```  \n  \n         -or-  \n  \n         For example, in Windows Forms applications:  \n  \n        ```  \n        // #include <stdlib.h>  \n        // #include <malloc.h>  \n        // #include <memory.h>  \n        // #include <tchar.h>  \n        ```  \n  \n    6.  For Windows Forms applications, in Form1.cpp, comment out the `#include` statement that references windows.h. For example:  \n  \n        ```  \n        // #include <windows.h>  \n        ```  \n  \n2.  Add the following code to stdafx.h:  \n  \n    ```  \n    #ifndef __FLTUSED__  \n    #define __FLTUSED__  \n       extern \"C\" __declspec(selectany) int _fltused=1;  \n    #endif  \n    ```  \n  \n3.  Remove all unmanaged types:  \n  \n    1.  Wherever appropriate, replace unmanaged types with references to structures from the [System](https://msdn.microsoft.com/en-us/library/system.appdomainmanager.appdomainmanager.aspx) namespace. Common managed types are listed in the following table:  \n  \n        |Structure|Description|  \n        |---------------|-----------------|  \n        |[Boolean](https://msdn.microsoft.com/en-us/library/system.boolean\\(v=vs.140\\).aspx)|Represents a Boolean value.|  \n        |[Byte](https://msdn.microsoft.com/en-us/library/system.byte\\(v=vs.140\\).aspx)|Represents an 8-bit unsigned integer.|  \n        |[Char](https://msdn.microsoft.com/en-us/library/system.char\\(v=vs.140\\).aspx)|Represents a Unicode character.|  \n        |[DateTime](https://msdn.microsoft.com/en-us/library/system.datetime.datetime.aspx)|Represents an instant in time, typically expressed as a date and time of day.|  \n        |[Decimal](https://msdn.microsoft.com/en-us/library/system.decimal\\(v=vs.140\\).aspx)|Represents a decimal number.|  \n        |[Double](https://msdn.microsoft.com/en-us/library/system.double\\(v=vs.140\\).aspx)|Represents a double-precision floating-point number.|  \n        |[Guid](https://msdn.microsoft.com/en-us/library/system.guid\\(v=vs.140\\).aspx)|Represents a globally unique identifier (GUID).|  \n        |[Int16](https://msdn.microsoft.com/en-us/library/system.int16\\(v=vs.140\\).aspx)|Represents a 16-bit signed integer.|  \n        |[Int32](https://msdn.microsoft.com/en-us/library/system.int32\\(v=vs.140\\).aspx)|Represents a 32-bit signed integer.|  \n        |[Int64](https://msdn.microsoft.com/en-us/library/system.int64\\(v=vs.140\\).aspx)|Represents a 64-bit signed integer.|  \n        |[IntPtr](https://msdn.microsoft.com/en-us/library/system.intptr\\(v=vs.140\\).aspx)|A platform-specific type that is used to represent a pointer or a handle.|  \n        |[SByte](https://msdn.microsoft.com/en-us/library/system.byte.aspx)|Represents an 8-bit signed integer.|  \n        |[Single](https://msdn.microsoft.com/en-us/library/system.single.aspx)|Represents a single-precision floating-point number.|  \n        |[TimeSpan](https://msdn.microsoft.com/en-us/library/system.timespan\\(v=vs.140\\).aspx)|Represents a time interval.|  \n        |[UInt16](https://msdn.microsoft.com/en-us/library/system.uint16\\(v=vs.140\\).aspx)|Represents a 16-bit unsigned integer.|  \n        |[UInt32](https://msdn.microsoft.com/en-us/library/system.uint32\\(v=vs.140\\).aspx)|Represents a 32-bit unsigned integer.|  \n        |[UInt64](https://msdn.microsoft.com/en-us/library/system.uint64\\(v=vs.140\\).aspx)|Represents a 64-bit unsigned integer.|  \n        |[UIntPtr](https://msdn.microsoft.com/en-us/library/system.uintptr\\(v=vs.140\\).aspx)|A platform-specific type that is used to represent a pointer or a handle.|  \n        |[Void](https://msdn.microsoft.com/en-us/library/system.void\\(v=vs.140\\).aspx)|Indicates a method that does not return a value; that is, the method has the void return type.|"}