{"nodes":[{"pos":[12,71],"content":"MFC ActiveX Controls: Adding Custom Events | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Adding Custom Events | Microsoft Docs","pos":[0,59]}]},{"content":"MFC ActiveX Controls: Adding Custom Events","pos":[948,990]},{"content":"Custom events differ from stock events in that they are not automatically fired by class <ph id=\"ph1\">`COleControl`</ph>.","pos":[991,1094],"source":"Custom events differ from stock events in that they are not automatically fired by class `COleControl`."},{"content":"A custom event recognizes a certain action, determined by the control developer, as an event.","pos":[1095,1188]},{"content":"The event map entries for custom events are represented by the <ph id=\"ph1\">`EVENT_CUSTOM`</ph> macro.","pos":[1189,1273],"source":" The event map entries for custom events are represented by the `EVENT_CUSTOM` macro."},{"content":"The following section implements a custom event for an ActiveX control project that was created using the ActiveX Control Wizard.","pos":[1274,1403]},{"pos":[1473,1520],"content":"Adding a Custom Event with the Add Event Wizard"},{"content":"The following procedure adds a specific custom event, ClickIn.","pos":[1524,1586]},{"content":"You can use this procedure to add other custom events.","pos":[1587,1641]},{"content":"Substitute your custom event name and its parameters for the ClickIn event name and parameters.","pos":[1642,1737]},{"content":"To add the ClickIn custom event using the Add Event Wizard","pos":[1748,1806]},{"content":"Load your control's project.","pos":[1816,1844]},{"content":"In Class View, right-click your ActiveX control class to open the shortcut menu.","pos":[1854,1934]},{"pos":[1944,2011],"content":"From the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Event<ept id=\"p2\">**</ept>.","source":"From the shortcut menu, click **Add** and then click **Add Event**."},{"content":"This opens the Add Event Wizard.","pos":[2022,2054]},{"pos":[2064,2187],"content":"In the <bpt id=\"p1\">**</bpt>Event name<ept id=\"p1\">**</ept> box, first select any existing event, then click on the <bpt id=\"p2\">**</bpt>Custom<ept id=\"p2\">**</ept> radio button, then type <ph id=\"ph1\">`ClickIn`</ph>.","source":"In the **Event name** box, first select any existing event, then click on the **Custom** radio button, then type `ClickIn`."},{"content":"In the <bpt id=\"p1\">**</bpt>Internal name<ept id=\"p1\">**</ept> box, type the name of the event's firing function.","pos":[2197,2272],"source":"In the **Internal name** box, type the name of the event's firing function."},{"content":"For this example, use the default value provided by the Add Event Wizard (<ph id=\"ph1\">`FireClickIn`</ph>).","pos":[2273,2362],"source":" For this example, use the default value provided by the Add Event Wizard (`FireClickIn`)."},{"pos":[2372,2492],"content":"Add a parameter, called <ph id=\"ph1\">`xCoord`</ph> (type <ph id=\"ph2\">`OLE_XPOS_PIXELS`</ph>), using the <bpt id=\"p1\">**</bpt>Parameter Name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Parameter Type<ept id=\"p2\">**</ept> controls.","source":"Add a parameter, called `xCoord` (type `OLE_XPOS_PIXELS`), using the **Parameter Name** and **Parameter Type** controls."},{"pos":[2502,2567],"content":"Add a second parameter, called <ph id=\"ph1\">`yCoord`</ph> (type <ph id=\"ph2\">`OLE_YPOS_PIXELS`</ph>).","source":"Add a second parameter, called `yCoord` (type `OLE_YPOS_PIXELS`)."},{"pos":[2577,2614],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to create the event.","source":"Click **Finish** to create the event."},{"pos":[2683,2725],"content":"Add Event Wizard Changes for Custom Events"},{"content":"When you add a custom event, the Add Event Wizard makes changes to the control class .H, .CPP, and .IDL files.","pos":[2729,2839]},{"content":"The following code samples are specific to the ClickIn event.","pos":[2840,2901]},{"content":"The following lines are added to the header (.H) file of your control class:","pos":[2908,2984]},{"pos":[3002,3016],"content":"NVC_MFC_AxUI#7"},{"pos":[3095,3329],"content":"This code declares an inline function called <ph id=\"ph1\">`FireClickIn`</ph> that calls <bpt id=\"p1\">[</bpt>COleControl::FireEvent<ept id=\"p1\">](../mfc/reference/colecontrol-class.md#colecontrol__fireevent)</ept> with the ClickIn event and parameters you defined using the Add Event Wizard.","source":"This code declares an inline function called `FireClickIn` that calls [COleControl::FireEvent](../mfc/reference/colecontrol-class.md#colecontrol__fireevent) with the ClickIn event and parameters you defined using the Add Event Wizard."},{"content":"In addition, the following line is added to the event map for the control, located in the implementation (.CPP) file of your control class:","pos":[3336,3475]},{"pos":[3493,3507],"content":"NVC_MFC_AxUI#8"},{"pos":[3588,3721],"content":"This code maps the event ClickIn to the inline function <ph id=\"ph1\">`FireClickIn`</ph>, passing the parameters you defined using the Add Event Wizard.","source":"This code maps the event ClickIn to the inline function `FireClickIn`, passing the parameters you defined using the Add Event Wizard."},{"content":"Finally, the following line is added to your control's .IDL file:","pos":[3728,3793]},{"pos":[3811,3825],"content":"NVC_MFC_AxUI#9"},{"content":"This line assigns the ClickIn event a specific ID number, taken from the event's position in the Add Event Wizard event list.","pos":[3906,4031]},{"content":"The entry in the event list allows a container to anticipate the event.","pos":[4032,4103]},{"content":"For example, it might provide handler code to be executed when the event is fired.","pos":[4104,4186]},{"pos":[4237,4256],"content":"Calling FireClickIn"},{"content":"Now that you have added the ClickIn custom event using the Add Event Wizard, you must decide when this event is to be fired.","pos":[4260,4384]},{"content":"You do this by calling <ph id=\"ph1\">`FireClickIn`</ph> when the appropriate action occurs.","pos":[4385,4457],"source":" You do this by calling `FireClickIn` when the appropriate action occurs."},{"content":"For this discussion, the control uses the <ph id=\"ph1\">`InCircle`</ph> function inside a <ph id=\"ph2\">`WM_LBUTTONDOWN`</ph> message handler to fire the ClickIn event when a user clicks inside a circular or elliptical region.","pos":[4458,4646],"source":" For this discussion, the control uses the `InCircle` function inside a `WM_LBUTTONDOWN` message handler to fire the ClickIn event when a user clicks inside a circular or elliptical region."},{"content":"The following procedure adds the <ph id=\"ph1\">`WM_LBUTTONDOWN`</ph> handler.","pos":[4647,4705],"source":" The following procedure adds the `WM_LBUTTONDOWN` handler."},{"content":"To add a message handler with the Add Event Wizard","pos":[4716,4766]},{"content":"Load your control's project.","pos":[4776,4804]},{"content":"In Class View, select your ActiveX control class.","pos":[4814,4863]},{"pos":[4873,4929],"content":"In the Properties window, click the <bpt id=\"p1\">**</bpt>Messages<ept id=\"p1\">**</ept> button.","source":"In the Properties window, click the **Messages** button."},{"content":"The Properties window displays a list of messages that can be handled by the ActiveX control.","pos":[4940,5033]},{"content":"Any message shown in bold already has a handler function assigned to it.","pos":[5034,5106]},{"content":"From the Properties window, select the message you want to handle.","pos":[5116,5182]},{"content":"For this example, select <ph id=\"ph1\">`WM_LBUTTONDOWN`</ph>.","pos":[5183,5225],"source":" For this example, select `WM_LBUTTONDOWN`."},{"pos":[5235,5309],"content":"From the drop-down list box on the right, select <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\&lt;</ph>Add&gt; OnLButtonDown<ept id=\"p1\">**</ept>.","source":"From the drop-down list box on the right, select **\\<Add> OnLButtonDown**."},{"content":"Double-click the new handler function in Class View to jump to the message handler code in the implementation (.CPP) file of your ActiveX control.","pos":[5319,5465]},{"content":"The following code sample calls the <bpt id=\"p1\">**</bpt>InCircle<ept id=\"p1\">**</ept> function every time the left mouse button is clicked within the control window.","pos":[5472,5600],"source":"The following code sample calls the **InCircle** function every time the left mouse button is clicked within the control window."},{"content":"This sample can be found in the <ph id=\"ph1\">`WM_LBUTTONDOWN`</ph> handler function, <ph id=\"ph2\">`OnLButtonDown`</ph>, in the <bpt id=\"p1\">[</bpt>Circ sample<ept id=\"p1\">](../visual-cpp-samples.md)</ept> abstract.","pos":[5601,5741],"source":" This sample can be found in the `WM_LBUTTONDOWN` handler function, `OnLButtonDown`, in the [Circ sample](../visual-cpp-samples.md) abstract."},{"pos":[5759,5774],"content":"NVC_MFC_AxUI#10"},{"pos":[5856,6203],"content":"[!NOTE]\n When the Add Event Wizard creates message handlers for mouse button actions, a call to the same message handler of the base class is automatically added. Do not remove this call. If your control uses any of the stock mouse messages, the message handlers in the base class must be called to ensure that mouse capture is handled properly.","leadings":["","> "],"nodes":[{"content":" When the Add Event Wizard creates message handlers for mouse button actions, a call to the same message handler of the base class is automatically added. Do not remove this call. If your control uses any of the stock mouse messages, the message handlers in the base class must be called to ensure that mouse capture is handled properly.","pos":[8,345],"nodes":[{"content":"When the Add Event Wizard creates message handlers for mouse button actions, a call to the same message handler of the base class is automatically added.","pos":[1,154]},{"content":"Do not remove this call.","pos":[155,179]},{"content":"If your control uses any of the stock mouse messages, the message handlers in the base class must be called to ensure that mouse capture is handled properly.","pos":[180,337]}]}]},{"content":"In the following example, the event fires only when the click occurs inside a circular or elliptical region within the control.","pos":[6210,6337]},{"content":"To achieve this behavior, you can place the <ph id=\"ph1\">`InCircle`</ph> function in your control's implementation (.CPP) file:","pos":[6338,6447],"source":" To achieve this behavior, you can place the `InCircle` function in your control's implementation (.CPP) file:"},{"pos":[6465,6480],"content":"NVC_MFC_AxUI#11"},{"pos":[6561,6675],"content":"You will also need to add the following declaration of the <ph id=\"ph1\">`InCircle`</ph> function to your control's header (.H) file:","source":"You will also need to add the following declaration of the `InCircle` function to your control's header (.H) file:"},{"pos":[6693,6708],"content":"NVC_MFC_AxUI#12"},{"pos":[6842,6872],"content":"Custom Events with Stock Names"},{"content":"You can create custom events with the same name as stock events, however you can not implement both in the same control.","pos":[6876,6996]},{"content":"For example, you might want to create a custom event called Click that does not fire when the stock event Click would normally fire.","pos":[6997,7129]},{"content":"You could then fire the Click event at any time by calling its firing function.","pos":[7130,7209]},{"content":"The following procedure adds a custom Click event.","pos":[7216,7266]},{"content":"To add a custom event that uses a stock event name","pos":[7277,7327]},{"content":"Load your control's project.","pos":[7337,7365]},{"content":"In Class View, right-click your ActiveX control class to open the shortcut menu.","pos":[7375,7455]},{"pos":[7465,7532],"content":"From the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Event<ept id=\"p2\">**</ept>.","source":"From the shortcut menu, click **Add** and then click **Add Event**."},{"content":"This opens the Add Event Wizard.","pos":[7543,7575]},{"content":"In the <bpt id=\"p1\">**</bpt>Event Name<ept id=\"p1\">**</ept> drop-down list, select a stock event name.","pos":[7585,7649],"source":"In the **Event Name** drop-down list, select a stock event name."},{"content":"For this example, select <bpt id=\"p1\">**</bpt>Click<ept id=\"p1\">**</ept>.","pos":[7650,7685],"source":" For this example, select **Click**."},{"pos":[7695,7733],"content":"For <bpt id=\"p1\">**</bpt>Event Type<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Custom<ept id=\"p2\">**</ept>.","source":"For **Event Type**, select **Custom**."},{"pos":[7743,7780],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to create the event.","source":"Click **Finish** to create the event."},{"pos":[7790,7842],"content":"Call <ph id=\"ph1\">`FireClick`</ph> at appropriate places in your code.","source":"Call `FireClick` at appropriate places in your code."},{"content":"See Also","pos":[7851,7859]},{"content":"MFC ActiveX Controls","pos":[7864,7884]},{"content":"MFC ActiveX Controls: Methods","pos":[7923,7952]},{"content":"COleControl Class","pos":[7999,8016]}],"content":"---\ntitle: \"MFC ActiveX Controls: Adding Custom Events | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, events\"\n  - \"EVENT_CUSTOM prefix\"\n  - \"custom events, adding to ActiveX controls\"\n  - \"EVENT_CUSTOM macro\"\n  - \"InCircle method\"\n  - \"ClickIn event\"\n  - \"FireClickIn event\"\n  - \"COleControl class, custom events\"\n  - \"Click event, custom events\"\n  - \"events [C++], ActiveX controls\"\n  - \"custom events\"\n  - \"FireEvent method, adding custom events\"\nms.assetid: c584d053-1e34-47aa-958e-37d3e9b85892\ncaps.latest.revision: 14\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Adding Custom Events\nCustom events differ from stock events in that they are not automatically fired by class `COleControl`. A custom event recognizes a certain action, determined by the control developer, as an event. The event map entries for custom events are represented by the `EVENT_CUSTOM` macro. The following section implements a custom event for an ActiveX control project that was created using the ActiveX Control Wizard.  \n  \n##  <a name=\"_core_adding_a_custom_event_with_classwizard\"></a> Adding a Custom Event with the Add Event Wizard  \n The following procedure adds a specific custom event, ClickIn. You can use this procedure to add other custom events. Substitute your custom event name and its parameters for the ClickIn event name and parameters.  \n  \n#### To add the ClickIn custom event using the Add Event Wizard  \n  \n1.  Load your control's project.  \n  \n2.  In Class View, right-click your ActiveX control class to open the shortcut menu.  \n  \n3.  From the shortcut menu, click **Add** and then click **Add Event**.  \n  \n     This opens the Add Event Wizard.  \n  \n4.  In the **Event name** box, first select any existing event, then click on the **Custom** radio button, then type `ClickIn`.  \n  \n5.  In the **Internal name** box, type the name of the event's firing function. For this example, use the default value provided by the Add Event Wizard (`FireClickIn`).  \n  \n6.  Add a parameter, called `xCoord` (type `OLE_XPOS_PIXELS`), using the **Parameter Name** and **Parameter Type** controls.  \n  \n7.  Add a second parameter, called `yCoord` (type `OLE_YPOS_PIXELS`).  \n  \n8.  Click **Finish** to create the event.  \n  \n##  <a name=\"_core_classwizard_changes_for_custom_events\"></a> Add Event Wizard Changes for Custom Events  \n When you add a custom event, the Add Event Wizard makes changes to the control class .H, .CPP, and .IDL files. The following code samples are specific to the ClickIn event.  \n  \n The following lines are added to the header (.H) file of your control class:  \n  \n [!code-cpp[NVC_MFC_AxUI#7](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_1.h)]  \n  \n This code declares an inline function called `FireClickIn` that calls [COleControl::FireEvent](../mfc/reference/colecontrol-class.md#colecontrol__fireevent) with the ClickIn event and parameters you defined using the Add Event Wizard.  \n  \n In addition, the following line is added to the event map for the control, located in the implementation (.CPP) file of your control class:  \n  \n [!code-cpp[NVC_MFC_AxUI#8](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_2.cpp)]  \n  \n This code maps the event ClickIn to the inline function `FireClickIn`, passing the parameters you defined using the Add Event Wizard.  \n  \n Finally, the following line is added to your control's .IDL file:  \n  \n [!code-cpp[NVC_MFC_AxUI#9](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_3.idl)]  \n  \n This line assigns the ClickIn event a specific ID number, taken from the event's position in the Add Event Wizard event list. The entry in the event list allows a container to anticipate the event. For example, it might provide handler code to be executed when the event is fired.  \n  \n##  <a name=\"_core_calling_fireclickin\"></a> Calling FireClickIn  \n Now that you have added the ClickIn custom event using the Add Event Wizard, you must decide when this event is to be fired. You do this by calling `FireClickIn` when the appropriate action occurs. For this discussion, the control uses the `InCircle` function inside a `WM_LBUTTONDOWN` message handler to fire the ClickIn event when a user clicks inside a circular or elliptical region. The following procedure adds the `WM_LBUTTONDOWN` handler.  \n  \n#### To add a message handler with the Add Event Wizard  \n  \n1.  Load your control's project.  \n  \n2.  In Class View, select your ActiveX control class.  \n  \n3.  In the Properties window, click the **Messages** button.  \n  \n     The Properties window displays a list of messages that can be handled by the ActiveX control. Any message shown in bold already has a handler function assigned to it.  \n  \n4.  From the Properties window, select the message you want to handle. For this example, select `WM_LBUTTONDOWN`.  \n  \n5.  From the drop-down list box on the right, select **\\<Add> OnLButtonDown**.  \n  \n6.  Double-click the new handler function in Class View to jump to the message handler code in the implementation (.CPP) file of your ActiveX control.  \n  \n The following code sample calls the **InCircle** function every time the left mouse button is clicked within the control window. This sample can be found in the `WM_LBUTTONDOWN` handler function, `OnLButtonDown`, in the [Circ sample](../visual-cpp-samples.md) abstract.  \n  \n [!code-cpp[NVC_MFC_AxUI#10](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_4.cpp)]  \n  \n> [!NOTE]\n>  When the Add Event Wizard creates message handlers for mouse button actions, a call to the same message handler of the base class is automatically added. Do not remove this call. If your control uses any of the stock mouse messages, the message handlers in the base class must be called to ensure that mouse capture is handled properly.  \n  \n In the following example, the event fires only when the click occurs inside a circular or elliptical region within the control. To achieve this behavior, you can place the `InCircle` function in your control's implementation (.CPP) file:  \n  \n [!code-cpp[NVC_MFC_AxUI#11](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_5.cpp)]  \n  \n You will also need to add the following declaration of the `InCircle` function to your control's header (.H) file:  \n  \n [!code-cpp[NVC_MFC_AxUI#12](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-events_6.h)]  \n  \n##  <a name=\"_core_custom_events_with_stock_names\"></a> Custom Events with Stock Names  \n You can create custom events with the same name as stock events, however you can not implement both in the same control. For example, you might want to create a custom event called Click that does not fire when the stock event Click would normally fire. You could then fire the Click event at any time by calling its firing function.  \n  \n The following procedure adds a custom Click event.  \n  \n#### To add a custom event that uses a stock event name  \n  \n1.  Load your control's project.  \n  \n2.  In Class View, right-click your ActiveX control class to open the shortcut menu.  \n  \n3.  From the shortcut menu, click **Add** and then click **Add Event**.  \n  \n     This opens the Add Event Wizard.  \n  \n4.  In the **Event Name** drop-down list, select a stock event name. For this example, select **Click**.  \n  \n5.  For **Event Type**, select **Custom**.  \n  \n6.  Click **Finish** to create the event.  \n  \n7.  Call `FireClick` at appropriate places in your code.  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)   \n [MFC ActiveX Controls: Methods](../mfc/mfc-activex-controls-methods.md)   \n [COleControl Class](../mfc/reference/colecontrol-class.md)\n"}