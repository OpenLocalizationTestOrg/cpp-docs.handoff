{"nodes":[{"pos":[12,58],"content":"CComCachedTearOffObject Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComCachedTearOffObject Class | Microsoft Docs","pos":[0,46]}]},{"content":"CComCachedTearOffObject Class","pos":[844,873]},{"pos":[874,992],"content":"This class implements <bpt id=\"p1\">[</bpt>IUnknown<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680509)</ept> for a tear-off interface.","source":"This class implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) for a tear-off interface."},{"content":"Syntax","pos":[1001,1007]},{"content":"Parameters","pos":[1192,1202]},{"content":"Your tear-off class, derived from <ph id=\"ph1\">`CComTearOffObjectBase`</ph> and the interfaces you want your tear-off object to support.","pos":[1221,1339],"source":" Your tear-off class, derived from `CComTearOffObjectBase` and the interfaces you want your tear-off object to support."},{"content":"Members","pos":[1348,1355]},{"content":"Public Constructors","pos":[1365,1384]},{"content":"Name","pos":[1391,1395]},{"content":"Description","pos":[1396,1407]},{"content":"CComCachedTearOffObject::CComCachedTearOffObject","pos":[1446,1494]},{"content":"The constructor.","pos":[1547,1563]},{"content":"CComCachedTearOffObject::~CComCachedTearOffObject","pos":[1569,1618]},{"content":"The destructor.","pos":[1676,1691]},{"content":"Public Methods","pos":[1702,1716]},{"content":"Name","pos":[1723,1727]},{"content":"Description","pos":[1728,1739]},{"content":"CComCachedTearOffObject::AddRef","pos":[1778,1809]},{"pos":[1845,1915],"content":"Increments the reference count for a <ph id=\"ph1\">`CComCachedTearOffObject`</ph> object.","source":"Increments the reference count for a `CComCachedTearOffObject` object."},{"content":"CComCachedTearOffObject::FinalConstruct","pos":[1921,1960]},{"pos":[2004,2073],"content":"Calls the <ph id=\"ph1\">`m_contained::FinalConstruct`</ph> (the tear-off class' method).","source":"Calls the `m_contained::FinalConstruct` (the tear-off class' method)."},{"content":"CComCachedTearOffObject::FinalRelease","pos":[2079,2116]},{"pos":[2158,2225],"content":"Calls the <ph id=\"ph1\">`m_contained::FinalRelease`</ph> (the tear-off class' method).","source":"Calls the `m_contained::FinalRelease` (the tear-off class' method)."},{"content":"CComCachedTearOffObject::QueryInterface","pos":[2231,2270]},{"pos":[2314,2468],"content":"Returns a pointer to the <ph id=\"ph1\">`IUnknown`</ph> of the <ph id=\"ph2\">`CComCachedTearOffObject`</ph> object, or to the requested interface on your tear-off class (the class <ph id=\"ph3\">`contained`</ph>).","source":"Returns a pointer to the `IUnknown` of the `CComCachedTearOffObject` object, or to the requested interface on your tear-off class (the class `contained`)."},{"content":"CComCachedTearOffObject::Release","pos":[2474,2506]},{"pos":[2543,2657],"content":"Decrements the reference count for a <ph id=\"ph1\">`CComCachedTearOffObject`</ph> object and destroys it if the reference count is 0.","source":"Decrements the reference count for a `CComCachedTearOffObject` object and destroys it if the reference count is 0."},{"content":"Public Data Members","pos":[2668,2687]},{"content":"Name","pos":[2694,2698]},{"content":"Description","pos":[2699,2710]},{"content":"CComCachedTearOffObject::m_contained","pos":[2749,2785]},{"pos":[2826,2914],"content":"A <ph id=\"ph1\">`CComContainedObject`</ph> object derived from your tear-off class (the class <ph id=\"ph2\">`contained`</ph>).","source":"A `CComContainedObject` object derived from your tear-off class (the class `contained`)."},{"content":"Remarks","pos":[2924,2931]},{"content":"implements <bpt id=\"p1\">[</bpt>IUnknown<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680509)</ept> for a tear-off interface.","pos":[2961,3068],"source":" implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) for a tear-off interface."},{"content":"This class differs from <ph id=\"ph1\">`CComTearOffObject`</ph> in that <ph id=\"ph2\">`CComCachedTearOffObject`</ph> has its own <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>, separate from the owner object's <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> (the owner is the object for which the tear-off is being created).","pos":[3069,3285],"source":" This class differs from `CComTearOffObject` in that `CComCachedTearOffObject` has its own **IUnknown**, separate from the owner object's **IUnknown** (the owner is the object for which the tear-off is being created)."},{"content":"maintains its own reference count on its <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> and deletes itself once its reference count is zero.","pos":[3312,3418],"source":" maintains its own reference count on its **IUnknown** and deletes itself once its reference count is zero."},{"content":"However, if you query for any of its tear-off interfaces, the reference count of the owner object's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> will be incremented.","pos":[3419,3552],"source":" However, if you query for any of its tear-off interfaces, the reference count of the owner object's **IUnknown** will be incremented."},{"content":"If the <ph id=\"ph1\">`CComCachedTearOffObject`</ph> object implementing the tear-off is already instantiated, and the tear-off interface is queried for again, the same <ph id=\"ph2\">`CComCachedTearOffObject`</ph> object is reused.","pos":[3559,3751],"source":"If the `CComCachedTearOffObject` object implementing the tear-off is already instantiated, and the tear-off interface is queried for again, the same `CComCachedTearOffObject` object is reused."},{"content":"In contrast, if a tear-off interface implemented by a <ph id=\"ph1\">`CComTearOffObject`</ph> is again queried for through the owner object, another <ph id=\"ph2\">`CComTearOffObject`</ph> will be instantiated.","pos":[3752,3922],"source":" In contrast, if a tear-off interface implemented by a `CComTearOffObject` is again queried for through the owner object, another `CComTearOffObject` will be instantiated."},{"content":"The owner class must implement <ph id=\"ph1\">`FinalRelease`</ph> and call <bpt id=\"p1\">**</bpt>Release<ept id=\"p1\">**</ept> on the cached <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> for the <ph id=\"ph2\">`CComCachedTearOffObject`</ph>, which will decrement its reference count.","pos":[3929,4099],"source":"The owner class must implement `FinalRelease` and call **Release** on the cached **IUnknown** for the `CComCachedTearOffObject`, which will decrement its reference count."},{"content":"This will cause <ph id=\"ph1\">`CComCachedTearOffObject`</ph>'s <ph id=\"ph2\">`FinalRelease`</ph> to be called and delete the tear-off.","pos":[4100,4196],"source":" This will cause `CComCachedTearOffObject`'s `FinalRelease` to be called and delete the tear-off."},{"content":"Inheritance Hierarchy","pos":[4205,4226]},{"content":"CComObjectRootEx","pos":[4258,4274]},{"content":"Requirements","pos":[4380,4392]},{"pos":[4396,4416],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[4474,4505],"content":"CComCachedTearOffObject::AddRef"},{"pos":[4509,4585],"content":"Increments the reference count of the <ph id=\"ph1\">`CComCachedTearOffObject`</ph> object by 1.","source":"Increments the reference count of the `CComCachedTearOffObject` object by 1."},{"content":"Return Value","pos":[4637,4649]},{"content":"A value that may be useful for diagnostics and testing.","pos":[4653,4708]},{"pos":[4783,4831],"content":"CComCachedTearOffObject::CComCachedTearOffObject"},{"content":"The constructor.","pos":[4835,4851]},{"content":"Parameters","pos":[4909,4919]},{"content":"[in] Pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> of the <ph id=\"ph1\">`CComCachedTearOffObject`</ph>.","pos":[4931,4997],"source":" [in] Pointer to the **IUnknown** of the `CComCachedTearOffObject`."},{"content":"Remarks","pos":[5007,5014]},{"pos":[5018,5117],"content":"Initializes the <ph id=\"ph1\">`CComContainedObject`</ph> member, <bpt id=\"p1\">[</bpt>m_contained<ept id=\"p1\">](#ccomcachedtearoffobject__m_contained)</ept>.","source":"Initializes the `CComContainedObject` member, [m_contained](#ccomcachedtearoffobject__m_contained)."},{"pos":[5197,5246],"content":"CComCachedTearOffObject::~CComCachedTearOffObject"},{"content":"The destructor.","pos":[5250,5265]},{"content":"Remarks","pos":[5316,5323]},{"pos":[5327,5422],"content":"Frees all allocated resources and calls <bpt id=\"p1\">[</bpt>FinalRelease<ept id=\"p1\">](#ccomcachedtearoffobject__finalrelease)</ept>.","source":"Frees all allocated resources and calls [FinalRelease](#ccomcachedtearoffobject__finalrelease)."},{"pos":[5488,5527],"content":"CComCachedTearOffObject::FinalConstruct"},{"pos":[5531,5705],"content":"Calls <bpt id=\"p1\">**</bpt>m_contained::FinalConstruct<ept id=\"p1\">**</ept> to create <ph id=\"ph1\">`m_contained`</ph>, the <ph id=\"ph2\">`CComContainedObject`&lt; `contained`</ph>&gt; object used to access the interface implemented by your tear-off class.","source":"Calls **m_contained::FinalConstruct** to create `m_contained`, the `CComContainedObject`< `contained`> object used to access the interface implemented by your tear-off class."},{"content":"Return Value","pos":[5754,5766]},{"pos":[5770,5797],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"pos":[5861,5898],"content":"CComCachedTearOffObject::FinalRelease"},{"pos":[5902,6008],"content":"Calls <bpt id=\"p1\">**</bpt>m_contained::FinalRelease<ept id=\"p1\">**</ept> to free <ph id=\"ph1\">`m_contained`</ph>, the <ph id=\"ph2\">`CComContainedObject`&lt; `contained`</ph>&gt; object.","source":"Calls **m_contained::FinalRelease** to free `m_contained`, the `CComContainedObject`< `contained`> object."},{"pos":[6105,6141],"content":"CComCachedTearOffObject::m_contained"},{"pos":[6145,6259],"content":"A <bpt id=\"p1\">[</bpt>CComContainedObject<ept id=\"p1\">](../../atl/reference/ccomcontainedobject-class.md)</ept> object derived from your tear-off class.","source":"A [CComContainedObject](../../atl/reference/ccomcontainedobject-class.md) object derived from your tear-off class."},{"content":"Parameters","pos":[6334,6344]},{"content":"[in] Your tear-off class, derived from <ph id=\"ph1\">`CComTearOffObjectBase`</ph> and the interfaces you want your tear-off object to support.","pos":[6363,6486],"source":" [in] Your tear-off class, derived from `CComTearOffObjectBase` and the interfaces you want your tear-off object to support."},{"content":"Remarks","pos":[6496,6503]},{"pos":[6507,6699],"content":"The methods <ph id=\"ph1\">`m_contained`</ph> inherits are used to access the tear-off interface in your tear-off class through the cached tear-off object's <ph id=\"ph2\">`QueryInterface`</ph>, <ph id=\"ph3\">`FinalConstruct`</ph>, and <ph id=\"ph4\">`FinalRelease`</ph>.","source":"The methods `m_contained` inherits are used to access the tear-off interface in your tear-off class through the cached tear-off object's `QueryInterface`, `FinalConstruct`, and `FinalRelease`."},{"pos":[6765,6804],"content":"CComCachedTearOffObject::QueryInterface"},{"content":"Retrieves a pointer to the requested interface.","pos":[6808,6855]},{"content":"Parameters","pos":[6939,6949]},{"content":"[in] The GUID of the interface being requested.","pos":[6962,7009]},{"content":"[out] A pointer to the interface pointer identified by <ph id=\"ph1\">`iid`</ph>, or <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the interface is not found.","pos":[7031,7135],"source":" [out] A pointer to the interface pointer identified by `iid`, or **NULL** if the interface is not found."},{"content":"Return Value","pos":[7145,7157]},{"pos":[7161,7188],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"content":"Remarks","pos":[7198,7205]},{"content":"If the requested interface is <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>, returns a pointer to the <ph id=\"ph1\">`CComCachedTearOffObject`</ph>'s own <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> and increments the reference count.","pos":[7209,7358],"source":"If the requested interface is **IUnknown**, returns a pointer to the `CComCachedTearOffObject`'s own **IUnknown** and increments the reference count."},{"content":"Otherwise, queries for the interface on your tear-off class using the <bpt id=\"p1\">[</bpt>InternalQueryInterface<ept id=\"p1\">](ccomobjectrootex-class.md#ccomobjectrootex__internalqueryinterface)</ept> method inherited from <ph id=\"ph1\">`CComObjectRootEx`</ph>.","pos":[7359,7563],"source":" Otherwise, queries for the interface on your tear-off class using the [InternalQueryInterface](ccomobjectrootex-class.md#ccomobjectrootex__internalqueryinterface) method inherited from `CComObjectRootEx`."},{"pos":[7623,7655],"content":"CComCachedTearOffObject::Release"},{"pos":[7659,7774],"content":"Decrements the reference count by 1 and, if the reference count is 0, deletes the <ph id=\"ph1\">`CComCachedTearOffObject`</ph> object.","source":"Decrements the reference count by 1 and, if the reference count is 0, deletes the `CComCachedTearOffObject` object."},{"content":"Return Value","pos":[7827,7839]},{"content":"In non-debug builds, always returns 0.","pos":[7843,7881]},{"content":"In debug builds, returns a value that may be useful for diagnostics or testing.","pos":[7882,7961]},{"content":"See Also","pos":[7970,7978]},{"content":"CComTearOffObject Class","pos":[7983,8006]},{"content":"CComObjectRootEx Class","pos":[8061,8083]},{"content":"Class Overview","pos":[8137,8151]}],"content":"---\ntitle: \"CComCachedTearOffObject Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::CComCachedTearOffObject\"\n  - \"ATL.CComCachedTearOffObject\"\n  - \"ATL.CComCachedTearOffObject<contained>\"\n  - \"CComCachedTearOffObject\"\n  - \"ATL::CComCachedTearOffObject<contained>\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"cache, ATL cached tear-off objects\"\n  - \"CComCachedTearOffObject class\"\nms.assetid: ae19507d-a1de-4dbc-a988-da9f75a50c95\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComCachedTearOffObject Class\nThis class implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) for a tear-off interface.  \n  \n## Syntax  \n  \n```\ntemplate\n <class contained>\nclass CComCachedTearOffObject :             public\n    IUnknown,\npublic CComObjectRootEx<contained\n ::_ThreadModel::ThreadModelNoCS>\n```  \n  \n#### Parameters  \n `contained`  \n Your tear-off class, derived from `CComTearOffObjectBase` and the interfaces you want your tear-off object to support.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComCachedTearOffObject::CComCachedTearOffObject](#ccomcachedtearoffobject__ccomcachedtearoffobject)|The constructor.|  \n|[CComCachedTearOffObject::~CComCachedTearOffObject](#ccomcachedtearoffobject___dtorccomcachedtearoffobject)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComCachedTearOffObject::AddRef](#ccomcachedtearoffobject__addref)|Increments the reference count for a `CComCachedTearOffObject` object.|  \n|[CComCachedTearOffObject::FinalConstruct](#ccomcachedtearoffobject__finalconstruct)|Calls the `m_contained::FinalConstruct` (the tear-off class' method).|  \n|[CComCachedTearOffObject::FinalRelease](#ccomcachedtearoffobject__finalrelease)|Calls the `m_contained::FinalRelease` (the tear-off class' method).|  \n|[CComCachedTearOffObject::QueryInterface](#ccomcachedtearoffobject__queryinterface)|Returns a pointer to the `IUnknown` of the `CComCachedTearOffObject` object, or to the requested interface on your tear-off class (the class `contained`).|  \n|[CComCachedTearOffObject::Release](#ccomcachedtearoffobject__release)|Decrements the reference count for a `CComCachedTearOffObject` object and destroys it if the reference count is 0.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComCachedTearOffObject::m_contained](#ccomcachedtearoffobject__m_contained)|A `CComContainedObject` object derived from your tear-off class (the class `contained`).|  \n  \n## Remarks  \n `CComCachedTearOffObject` implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) for a tear-off interface. This class differs from `CComTearOffObject` in that `CComCachedTearOffObject` has its own **IUnknown**, separate from the owner object's **IUnknown** (the owner is the object for which the tear-off is being created). `CComCachedTearOffObject` maintains its own reference count on its **IUnknown** and deletes itself once its reference count is zero. However, if you query for any of its tear-off interfaces, the reference count of the owner object's **IUnknown** will be incremented.  \n  \n If the `CComCachedTearOffObject` object implementing the tear-off is already instantiated, and the tear-off interface is queried for again, the same `CComCachedTearOffObject` object is reused. In contrast, if a tear-off interface implemented by a `CComTearOffObject` is again queried for through the owner object, another `CComTearOffObject` will be instantiated.  \n  \n The owner class must implement `FinalRelease` and call **Release** on the cached **IUnknown** for the `CComCachedTearOffObject`, which will decrement its reference count. This will cause `CComCachedTearOffObject`'s `FinalRelease` to be called and delete the tear-off.  \n  \n## Inheritance Hierarchy  \n `CComObjectRootBase`  \n  \n [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md)  \n  \n `IUnknown`  \n  \n `CComCachedTearOffObject`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ccomcachedtearoffobject__addref\"></a>  CComCachedTearOffObject::AddRef  \n Increments the reference count of the `CComCachedTearOffObject` object by 1.  \n  \n```\nSTDMETHOD_(ULONG, AddRef)();\n```  \n  \n### Return Value  \n A value that may be useful for diagnostics and testing.  \n  \n##  <a name=\"ccomcachedtearoffobject__ccomcachedtearoffobject\"></a>  CComCachedTearOffObject::CComCachedTearOffObject  \n The constructor.  \n  \n```\nCComCachedTearOffObject(void* pv);\n```  \n  \n### Parameters  \n `pv`  \n [in] Pointer to the **IUnknown** of the `CComCachedTearOffObject`.  \n  \n### Remarks  \n Initializes the `CComContainedObject` member, [m_contained](#ccomcachedtearoffobject__m_contained).  \n  \n##  <a name=\"ccomcachedtearoffobject___dtorccomcachedtearoffobject\"></a>  CComCachedTearOffObject::~CComCachedTearOffObject  \n The destructor.  \n  \n```\n~CComCachedTearOffObject();\n```  \n  \n### Remarks  \n Frees all allocated resources and calls [FinalRelease](#ccomcachedtearoffobject__finalrelease).  \n  \n##  <a name=\"ccomcachedtearoffobject__finalconstruct\"></a>  CComCachedTearOffObject::FinalConstruct  \n Calls **m_contained::FinalConstruct** to create `m_contained`, the `CComContainedObject`< `contained`> object used to access the interface implemented by your tear-off class.  \n  \n```\nHRESULT FinalConstruct();\n```  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n##  <a name=\"ccomcachedtearoffobject__finalrelease\"></a>  CComCachedTearOffObject::FinalRelease  \n Calls **m_contained::FinalRelease** to free `m_contained`, the `CComContainedObject`< `contained`> object.  \n  \n```\nvoid FinalRelease();\n```  \n  \n##  <a name=\"ccomcachedtearoffobject__m_contained\"></a>  CComCachedTearOffObject::m_contained  \n A [CComContainedObject](../../atl/reference/ccomcontainedobject-class.md) object derived from your tear-off class.  \n  \n```\nCcomContainedObject <contained>\n    m_contained;\n```     \n  \n### Parameters  \n `contained`  \n [in] Your tear-off class, derived from `CComTearOffObjectBase` and the interfaces you want your tear-off object to support.  \n  \n### Remarks  \n The methods `m_contained` inherits are used to access the tear-off interface in your tear-off class through the cached tear-off object's `QueryInterface`, `FinalConstruct`, and `FinalRelease`.  \n  \n##  <a name=\"ccomcachedtearoffobject__queryinterface\"></a>  CComCachedTearOffObject::QueryInterface  \n Retrieves a pointer to the requested interface.  \n  \n```\nSTDMETHOD(QueryInterface)(REFIID iid,\n    void** ppvObject);\n```  \n  \n### Parameters  \n `iid`  \n [in] The GUID of the interface being requested.  \n  \n `ppvObject`  \n [out] A pointer to the interface pointer identified by `iid`, or **NULL** if the interface is not found.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n### Remarks  \n If the requested interface is **IUnknown**, returns a pointer to the `CComCachedTearOffObject`'s own **IUnknown** and increments the reference count. Otherwise, queries for the interface on your tear-off class using the [InternalQueryInterface](ccomobjectrootex-class.md#ccomobjectrootex__internalqueryinterface) method inherited from `CComObjectRootEx`.  \n\n  \n##  <a name=\"ccomcachedtearoffobject__release\"></a>  CComCachedTearOffObject::Release  \n Decrements the reference count by 1 and, if the reference count is 0, deletes the `CComCachedTearOffObject` object.  \n  \n```\nSTDMETHOD_(ULONG, Release)();\n```  \n  \n### Return Value  \n In non-debug builds, always returns 0. In debug builds, returns a value that may be useful for diagnostics or testing.  \n  \n## See Also  \n [CComTearOffObject Class](../../atl/reference/ccomtearoffobject-class.md)   \n [CComObjectRootEx Class](../../atl/reference/ccomobjectrootex-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}