{"nodes":[{"pos":[12,42],"content":"Kinds of DLLs | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Kinds of DLLs | Microsoft Docs","pos":[0,30]}]},{"content":"Kinds of DLLs","pos":[618,631]},{"content":"This topic provides information to help you determine the kind of DLL to build.","pos":[632,711]},{"pos":[799,832],"content":"Different Kinds of DLLs Available"},{"content":"Using Visual C++, you can build Win32 DLLs in C or C++ that do not use the Microsoft Foundation Class (MFC) library.","pos":[836,952]},{"content":"You can create a non-MFC DLL project with the Win32 Application Wizard.","pos":[953,1024]},{"content":"The MFC library itself is available, in either static link libraries or in a number of DLLs, with the MFC DLL Wizard.","pos":[1031,1148]},{"content":"If your DLL is using MFC, Visual C++ supports three different DLL development scenarios:","pos":[1149,1237]},{"content":"Building a regular DLL that statically links MFC","pos":[1247,1295]},{"content":"Building a regular DLL that dynamically links MFC","pos":[1305,1354]},{"content":"Building an MFC extension DLL, which always dynamically link MFC","pos":[1364,1428]},{"content":"What do you want to know more about?","pos":[1438,1474]},{"content":"Non-MFC DLLs: Overview","pos":[1485,1507]},{"content":"Regular DLLs statically linked to MFC","pos":[1554,1591]},{"content":"Regular DLLs dynamically linked to MFC","pos":[1654,1692]},{"content":"Extension DLLs: Overview","pos":[1756,1780]},{"content":"Which kind of DLL to use","pos":[1829,1853]},{"pos":[1943,1976],"content":"Deciding Which Kind of DLL to Use"},{"content":"If your DLL does not use MFC, use Visual C++ to build a non-MFC Win32 DLL.","pos":[1980,2054]},{"content":"Linking your DLL to MFC (either statically or dynamically) takes up significant disk space and memory.","pos":[2055,2157]},{"content":"You should not link to MFC unless your DLL actually uses MFC.","pos":[2158,2219]},{"content":"If your DLL will be using MFC, and will be used by either MFC or non-MFC applications, you must build either a regular DLL that dynamically links to MFC or a regular DLL that statically links to MFC.","pos":[2226,2425]},{"content":"In most cases, you probably want to use a regular DLL that dynamically links to MFC because the file size of the DLL will be much smaller and the savings in memory from using the shared version of MFC can be significant.","pos":[2426,2646]},{"content":"If you statically link to MFC, the file size of your DLL will be larger and potentially take up extra memory because it loads its own private copy of the MFC library code.","pos":[2647,2818]},{"content":"Building a DLL that dynamically links to MFC is faster than building a DLL that statically links to MFC because it is not necessary to link MFC itself.","pos":[2825,2976]},{"content":"This is especially true in debug builds where the linker must compact the debug information.","pos":[2977,3069]},{"content":"By linking with a DLL that already contains the debug information, there is less debug information to compact within your DLL.","pos":[3070,3196]},{"content":"One disadvantage to dynamically linking to MFC is that you must distribute the shared DLLs Mfcx0.dll and Msvcrxx.dll (or similar files) with your DLL.","pos":[3203,3353]},{"content":"The MFC DLLs are freely redistributable, but you still must install the DLLs in your setup program.","pos":[3354,3453]},{"content":"In addition, you must ship the Msvcrxx.dll, which contains the C run-time library that is used both by your program and the MFC DLLs themselves.","pos":[3454,3598]},{"content":"If your DLL will only be used by MFC executables, you have a choice between building a regular DLL or an extension DLL.","pos":[3605,3724]},{"content":"If your DLL implements reusable classes derived from the existing MFC classes or you need to pass MFC-derived objects between the application and the DLL, you must build an extension DLL.","pos":[3725,3912]},{"content":"If your DLL dynamically links to MFC, the MFC DLLs might be redistributed with your DLL.","pos":[3919,4007]},{"content":"This architecture is particularly useful for sharing the class library between multiple executable files to save disk space and minimize memory usage.","pos":[4008,4158]},{"content":"Prior to version 4.0, Visual C++ only supported two kinds of DLLs that used MFC: USRDLLs and AFXDLLs.","pos":[4165,4266]},{"content":"Regular DLLs statically linked to MFC have the same characteristics as the former USRDLL.","pos":[4267,4356]},{"content":"MFC extension DLLs have the same characteristics as the former AFXDLLs.","pos":[4357,4428]},{"content":"What do you want to know more about?","pos":[4438,4474]},{"content":"Non-MFC DLLs: Overview","pos":[4485,4507]},{"content":"Regular DLLs statically linked to MFC","pos":[4554,4591]},{"content":"Regular DLLs dynamically linked to MFC","pos":[4654,4692]},{"content":"Extension DLLs: Overview","pos":[4756,4780]},{"content":"See Also","pos":[4827,4835]},{"content":"DLLs in Visual C++","pos":[4840,4858]}],"content":"---\ntitle: \"Kinds of DLLs | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC DLLs [C++], types\"\n  - \"DLLs [C++], types\"\n  - \"DLLs [C++], MFC\"\nms.assetid: f6a30db9-6138-4b2c-90cc-a17855e499a6\ncaps.latest.revision: 8\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Kinds of DLLs\nThis topic provides information to help you determine the kind of DLL to build.  \n  \n##  <a name=\"_core_the_different_kinds_of_dlls_available_with_visual_c.2b2b\"></a> Different Kinds of DLLs Available  \n Using Visual C++, you can build Win32 DLLs in C or C++ that do not use the Microsoft Foundation Class (MFC) library. You can create a non-MFC DLL project with the Win32 Application Wizard.  \n  \n The MFC library itself is available, in either static link libraries or in a number of DLLs, with the MFC DLL Wizard. If your DLL is using MFC, Visual C++ supports three different DLL development scenarios:  \n  \n-   Building a regular DLL that statically links MFC  \n  \n-   Building a regular DLL that dynamically links MFC  \n  \n-   Building an MFC extension DLL, which always dynamically link MFC  \n  \n### What do you want to know more about?  \n  \n-   [Non-MFC DLLs: Overview](../build/non-mfc-dlls-overview.md)  \n  \n-   [Regular DLLs statically linked to MFC](../build/regular-dlls-statically-linked-to-mfc.md)  \n  \n-   [Regular DLLs dynamically linked to MFC](../build/regular-dlls-dynamically-linked-to-mfc.md)  \n  \n-   [Extension DLLs: Overview](../build/extension-dlls-overview.md)  \n  \n-   [Which kind of DLL to use](#_core_which_kind_of_dll_to_use)  \n  \n##  <a name=\"_core_which_kind_of_dll_to_use\"></a> Deciding Which Kind of DLL to Use  \n If your DLL does not use MFC, use Visual C++ to build a non-MFC Win32 DLL. Linking your DLL to MFC (either statically or dynamically) takes up significant disk space and memory. You should not link to MFC unless your DLL actually uses MFC.  \n  \n If your DLL will be using MFC, and will be used by either MFC or non-MFC applications, you must build either a regular DLL that dynamically links to MFC or a regular DLL that statically links to MFC. In most cases, you probably want to use a regular DLL that dynamically links to MFC because the file size of the DLL will be much smaller and the savings in memory from using the shared version of MFC can be significant. If you statically link to MFC, the file size of your DLL will be larger and potentially take up extra memory because it loads its own private copy of the MFC library code.  \n  \n Building a DLL that dynamically links to MFC is faster than building a DLL that statically links to MFC because it is not necessary to link MFC itself. This is especially true in debug builds where the linker must compact the debug information. By linking with a DLL that already contains the debug information, there is less debug information to compact within your DLL.  \n  \n One disadvantage to dynamically linking to MFC is that you must distribute the shared DLLs Mfcx0.dll and Msvcrxx.dll (or similar files) with your DLL. The MFC DLLs are freely redistributable, but you still must install the DLLs in your setup program. In addition, you must ship the Msvcrxx.dll, which contains the C run-time library that is used both by your program and the MFC DLLs themselves.  \n  \n If your DLL will only be used by MFC executables, you have a choice between building a regular DLL or an extension DLL. If your DLL implements reusable classes derived from the existing MFC classes or you need to pass MFC-derived objects between the application and the DLL, you must build an extension DLL.  \n  \n If your DLL dynamically links to MFC, the MFC DLLs might be redistributed with your DLL. This architecture is particularly useful for sharing the class library between multiple executable files to save disk space and minimize memory usage.  \n  \n Prior to version 4.0, Visual C++ only supported two kinds of DLLs that used MFC: USRDLLs and AFXDLLs. Regular DLLs statically linked to MFC have the same characteristics as the former USRDLL. MFC extension DLLs have the same characteristics as the former AFXDLLs.  \n  \n### What do you want to know more about?  \n  \n-   [Non-MFC DLLs: Overview](../build/non-mfc-dlls-overview.md)  \n  \n-   [Regular DLLs statically linked to MFC](../build/regular-dlls-statically-linked-to-mfc.md)  \n  \n-   [Regular DLLs dynamically linked to MFC](../build/regular-dlls-dynamically-linked-to-mfc.md)  \n  \n-   [Extension DLLs: Overview](../build/extension-dlls-overview.md)  \n  \n## See Also  \n [DLLs in Visual C++](../build/dlls-in-visual-cpp.md)"}