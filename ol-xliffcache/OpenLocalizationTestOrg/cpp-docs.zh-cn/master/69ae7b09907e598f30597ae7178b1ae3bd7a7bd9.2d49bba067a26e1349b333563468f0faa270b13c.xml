{"nodes":[{"pos":[12,64],"content":"Clipboard: Copying and Pasting Data | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Clipboard: Copying and Pasting Data | Microsoft Docs","pos":[0,52]}]},{"content":"Clipboard: Copying and Pasting Data","pos":[625,660]},{"content":"This topic describes the minimum work necessary to implement copying to and pasting from the Clipboard in your OLE application.","pos":[661,788]},{"content":"It is recommended that you read the <bpt id=\"p1\">[</bpt>Data Objects and Data Sources (OLE)<ept id=\"p1\">](../mfc/data-objects-and-data-sources-ole.md)</ept> topics before proceeding.","pos":[789,933],"source":" It is recommended that you read the [Data Objects and Data Sources (OLE)](../mfc/data-objects-and-data-sources-ole.md) topics before proceeding."},{"content":"Before you can implement either copying or pasting, you must first provide functions to handle the Copy, Cut, and Paste options on the Edit menu.","pos":[940,1085]},{"pos":[1140,1163],"content":"Copying or Cutting Data"},{"content":"To copy data to the Clipboard","pos":[1174,1203]},{"content":"Determine whether the data to be copied is native data or is an embedded or linked item.","pos":[1213,1301]},{"pos":[1315,1421],"content":"If the data is embedded or linked, obtain a pointer to the <ph id=\"ph1\">`COleClientItem`</ph> object that has been selected.","source":"If the data is embedded or linked, obtain a pointer to the `COleClientItem` object that has been selected."},{"content":"If the data is native and the application is a server, create a new object derived from <ph id=\"ph1\">`COleServerItem`</ph> containing the selected data.","pos":[1435,1569],"source":"If the data is native and the application is a server, create a new object derived from `COleServerItem` containing the selected data."},{"content":"Otherwise, create a <ph id=\"ph1\">`COleDataSource`</ph> object for the data.","pos":[1570,1627],"source":" Otherwise, create a `COleDataSource` object for the data."},{"pos":[1637,1696],"content":"Call the selected item's <ph id=\"ph1\">`CopyToClipboard`</ph> member function.","source":"Call the selected item's `CopyToClipboard` member function."},{"content":"If the user chose a Cut operation instead of a Copy operation, delete the selected data from your application.","pos":[1706,1816]},{"content":"To see an example of this sequence, see the <bpt id=\"p1\">**</bpt>OnEditCut<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>OnEditCopy<ept id=\"p2\">**</ept> functions in the MFC OLE sample programs <bpt id=\"p3\">[</bpt>OCLIENT<ept id=\"p3\">](../visual-cpp-samples.md)</ept> and <bpt id=\"p4\">[</bpt>HIERSVR<ept id=\"p4\">](../visual-cpp-samples.md)</ept>.","pos":[1823,2017],"source":"To see an example of this sequence, see the **OnEditCut** and **OnEditCopy** functions in the MFC OLE sample programs [OCLIENT](../visual-cpp-samples.md) and [HIERSVR](../visual-cpp-samples.md)."},{"content":"Note that these samples maintain a pointer to the currently selected data, so step 1 is already complete.","pos":[2018,2123]},{"pos":[2167,2179],"content":"Pasting Data"},{"content":"Pasting data is more complicated than copying it because you need to choose the format to use in pasting the data into your application.","pos":[2183,2319]},{"content":"To paste data from the Clipboard","pos":[2330,2362]},{"pos":[2372,2479],"content":"In your view class, implement <bpt id=\"p1\">**</bpt>OnEditPaste<ept id=\"p1\">**</ept> to handle users choosing the Paste option from the Edit menu.","source":"In your view class, implement **OnEditPaste** to handle users choosing the Paste option from the Edit menu."},{"pos":[2489,2651],"content":"In the <bpt id=\"p1\">**</bpt>OnEditPaste<ept id=\"p1\">**</ept> function, create a <ph id=\"ph1\">`COleDataObject`</ph> object and call its <ph id=\"ph2\">`AttachClipboard`</ph> member function to link this object to the data on the Clipboard.","source":"In the **OnEditPaste** function, create a `COleDataObject` object and call its `AttachClipboard` member function to link this object to the data on the Clipboard."},{"pos":[2661,2750],"content":"Call <ph id=\"ph1\">`COleDataObject::IsDataAvailable`</ph> to check whether a particular format is available.","source":"Call `COleDataObject::IsDataAvailable` to check whether a particular format is available."},{"pos":[2761,2898],"content":"Alternately, you can use <ph id=\"ph1\">`COleDataObject::BeginEnumFormats`</ph> to look for other formats until you find one most suited to your application.","source":"Alternately, you can use `COleDataObject::BeginEnumFormats` to look for other formats until you find one most suited to your application."},{"content":"Perform the paste of the format.","pos":[2908,2940]},{"pos":[2947,3179],"content":"For an example of how this works, see the implementation of the <bpt id=\"p1\">**</bpt>OnEditPaste<ept id=\"p1\">**</ept> member functions in the view classes defined in the MFC OLE sample programs <bpt id=\"p2\">[</bpt>OCLIENT<ept id=\"p2\">](../visual-cpp-samples.md)</ept> and <bpt id=\"p3\">[</bpt>HIERSVR<ept id=\"p3\">](../visual-cpp-samples.md)</ept>.","source":"For an example of how this works, see the implementation of the **OnEditPaste** member functions in the view classes defined in the MFC OLE sample programs [OCLIENT](../visual-cpp-samples.md) and [HIERSVR](../visual-cpp-samples.md)."},{"pos":[3187,3521],"content":"[!TIP]\n The main benefit of separating the paste operation into its own function is that the same paste code can be used when data is dropped in your application during a drag-and-drop operation. As in OCLIENT and HIERSVR, your `OnDrop` function can also call **DoPasteItem**, reusing the code written to implement Paste operations.","leadings":["","> "],"nodes":[{"content":" The main benefit of separating the paste operation into its own function is that the same paste code can be used when data is dropped in your application during a drag-and-drop operation. As in OCLIENT and HIERSVR, your `OnDrop` function can also call **DoPasteItem**, reusing the code written to implement Paste operations.","pos":[7,332],"nodes":[{"content":"The main benefit of separating the paste operation into its own function is that the same paste code can be used when data is dropped in your application during a drag-and-drop operation.","pos":[1,188]},{"content":"As in OCLIENT and HIERSVR, your <ph id=\"ph1\">`OnDrop`</ph> function can also call <bpt id=\"p1\">**</bpt>DoPasteItem<ept id=\"p1\">**</ept>, reusing the code written to implement Paste operations.","pos":[189,325],"source":" As in OCLIENT and HIERSVR, your `OnDrop` function can also call **DoPasteItem**, reusing the code written to implement Paste operations."}]}]},{"pos":[3528,3648],"content":"To handle the Paste Special option on the Edit menu, see the topic <bpt id=\"p1\">[</bpt>Dialog Boxes in OLE<ept id=\"p1\">](../mfc/dialog-boxes-in-ole.md)</ept>.","source":"To handle the Paste Special option on the Edit menu, see the topic [Dialog Boxes in OLE](../mfc/dialog-boxes-in-ole.md)."},{"content":"What do you want to know more about","pos":[3658,3693]},{"content":"Adding other formats","pos":[3704,3724]},{"content":"OLE data objects and data sources and uniform data transfer","pos":[3778,3837]},{"content":"OLE drag and drop","pos":[3894,3911]},{"content":"OLE","pos":[3952,3955]},{"content":"See Also","pos":[3991,3999]},{"content":"Clipboard: Using the OLE Clipboard Mechanism","pos":[4004,4048]}],"content":"---\ntitle: \"Clipboard: Copying and Pasting Data | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Clipboard, copying data to\"\n  - \"Clipboard, pasting\"\nms.assetid: 580e10be-241f-4f9f-94cf-8302edc5beef\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Clipboard: Copying and Pasting Data\nThis topic describes the minimum work necessary to implement copying to and pasting from the Clipboard in your OLE application. It is recommended that you read the [Data Objects and Data Sources (OLE)](../mfc/data-objects-and-data-sources-ole.md) topics before proceeding.  \n  \n Before you can implement either copying or pasting, you must first provide functions to handle the Copy, Cut, and Paste options on the Edit menu.  \n  \n##  <a name=\"_core_copying_or_cutting_data\"></a> Copying or Cutting Data  \n  \n#### To copy data to the Clipboard  \n  \n1.  Determine whether the data to be copied is native data or is an embedded or linked item.  \n  \n    -   If the data is embedded or linked, obtain a pointer to the `COleClientItem` object that has been selected.  \n  \n    -   If the data is native and the application is a server, create a new object derived from `COleServerItem` containing the selected data. Otherwise, create a `COleDataSource` object for the data.  \n  \n2.  Call the selected item's `CopyToClipboard` member function.  \n  \n3.  If the user chose a Cut operation instead of a Copy operation, delete the selected data from your application.  \n  \n To see an example of this sequence, see the **OnEditCut** and **OnEditCopy** functions in the MFC OLE sample programs [OCLIENT](../visual-cpp-samples.md) and [HIERSVR](../visual-cpp-samples.md). Note that these samples maintain a pointer to the currently selected data, so step 1 is already complete.  \n  \n##  <a name=\"_core_pasting_data\"></a> Pasting Data  \n Pasting data is more complicated than copying it because you need to choose the format to use in pasting the data into your application.  \n  \n#### To paste data from the Clipboard  \n  \n1.  In your view class, implement **OnEditPaste** to handle users choosing the Paste option from the Edit menu.  \n  \n2.  In the **OnEditPaste** function, create a `COleDataObject` object and call its `AttachClipboard` member function to link this object to the data on the Clipboard.  \n  \n3.  Call `COleDataObject::IsDataAvailable` to check whether a particular format is available.  \n  \n     Alternately, you can use `COleDataObject::BeginEnumFormats` to look for other formats until you find one most suited to your application.  \n  \n4.  Perform the paste of the format.  \n  \n For an example of how this works, see the implementation of the **OnEditPaste** member functions in the view classes defined in the MFC OLE sample programs [OCLIENT](../visual-cpp-samples.md) and [HIERSVR](../visual-cpp-samples.md).  \n  \n> [!TIP]\n>  The main benefit of separating the paste operation into its own function is that the same paste code can be used when data is dropped in your application during a drag-and-drop operation. As in OCLIENT and HIERSVR, your `OnDrop` function can also call **DoPasteItem**, reusing the code written to implement Paste operations.  \n  \n To handle the Paste Special option on the Edit menu, see the topic [Dialog Boxes in OLE](../mfc/dialog-boxes-in-ole.md).  \n  \n### What do you want to know more about  \n  \n-   [Adding other formats](../mfc/clipboard-adding-other-formats.md)  \n  \n-   [OLE data objects and data sources and uniform data transfer](../mfc/data-objects-and-data-sources-ole.md)  \n  \n-   [OLE drag and drop](../mfc/drag-and-drop-ole.md)  \n  \n-   [OLE](../mfc/ole-background.md)  \n  \n## See Also  \n [Clipboard: Using the OLE Clipboard Mechanism](../mfc/clipboard-using-the-ole-clipboard-mechanism.md)\n\n"}