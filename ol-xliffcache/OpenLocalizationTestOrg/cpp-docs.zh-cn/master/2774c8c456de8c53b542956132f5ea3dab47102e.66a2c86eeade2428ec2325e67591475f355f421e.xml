{"nodes":[{"pos":[12,68],"content":"Adding a Control (ATL Tutorial, Part 2) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Adding a Control (ATL Tutorial, Part 2) | Microsoft Docs","pos":[0,56]}]},{"content":"Adding a Control (ATL Tutorial, Part 2)","pos":[561,600]},{"content":"In this step, you will add a control to your project, build it, and test it on a Web page.","pos":[601,691]},{"content":"Procedures","pos":[700,710]},{"content":"To add an object to an ATL project","pos":[721,755]},{"content":"In Class View, right-click the Polygon project.","pos":[765,812]},{"pos":[822,896],"content":"Point to <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> on the shortcut menu, and click <bpt id=\"p2\">**</bpt>Class<ept id=\"p2\">**</ept> in the submenu.","source":"Point to **Add** on the shortcut menu, and click **Class** in the submenu."},{"content":"The <bpt id=\"p1\">**</bpt>Add Class<ept id=\"p1\">**</ept> dialog box appears.","pos":[907,944],"source":"The **Add Class** dialog box appears."},{"content":"The different object categories are listed in the tree structure on the left.","pos":[945,1022]},{"pos":[1032,1057],"content":"Click the <bpt id=\"p1\">**</bpt>ATL<ept id=\"p1\">**</ept> folder.","source":"Click the **ATL** folder."},{"content":"From the list of templates on the right, select <bpt id=\"p1\">**</bpt>ATL Control<ept id=\"p1\">**</ept>.","pos":[1067,1131],"source":"From the list of templates on the right, select **ATL Control**."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","pos":[1132,1146],"source":" Click **Add**."},{"content":"The ATL Control Wizard will open, and you can configure the control.","pos":[1147,1215]},{"content":"Type <ph id=\"ph1\">`PolyCtl`</ph> as the short name and note that the other fields are automatically completed.","pos":[1225,1317],"source":"Type `PolyCtl` as the short name and note that the other fields are automatically completed."},{"content":"Do not click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> yet, because you have to make some changes.","pos":[1318,1385],"source":" Do not click **Finish** yet, because you have to make some changes."},{"pos":[1392,1462],"content":"The ATL Control Wizard's <bpt id=\"p1\">**</bpt>Names<ept id=\"p1\">**</ept> page contains the following fields:","source":"The ATL Control Wizard's **Names** page contains the following fields:"},{"content":"Field","pos":[1469,1474]},{"content":"Contents","pos":[1475,1483]},{"content":"Short name","pos":[1521,1531]},{"content":"The name you entered for the control.","pos":[1534,1571]},{"content":"Class","pos":[1578,1583]},{"content":"The C++ class name created to implement the control.","pos":[1586,1638]},{"content":".h file","pos":[1645,1652]},{"content":"The file created to contain the definition of the C++ class.","pos":[1655,1715]},{"content":".cpp file","pos":[1722,1731]},{"content":"The file created to contain the implementation of the C++ class.","pos":[1734,1798]},{"content":"CoClass","pos":[1805,1812]},{"content":"The name of the component class for this control.","pos":[1815,1864]},{"content":"Interface","pos":[1871,1880]},{"content":"The name of the interface on which the control will implement its custom methods and properties.","pos":[1883,1979]},{"content":"Type","pos":[1986,1990]},{"content":"A description for the control.","pos":[1993,2023]},{"content":"ProgID","pos":[2030,2036]},{"content":"The readable name that can be used to look up the CLSID of the control.","pos":[2039,2110]},{"content":"You have to make several additional settings in the ATL Control Wizard.","pos":[2118,2189]},{"content":"To enable support for rich error information and connection points","pos":[2200,2266]},{"pos":[2276,2323],"content":"Click <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> to open the <bpt id=\"p2\">**</bpt>Options<ept id=\"p2\">**</ept> page.","source":"Click **Options** to open the **Options** page."},{"content":"Select the <bpt id=\"p1\">**</bpt>Connection points<ept id=\"p1\">**</ept> check box.","pos":[2333,2376],"source":"Select the **Connection points** check box."},{"content":"This will create support for an outgoing interface in the IDL file.","pos":[2377,2444]},{"content":"You can also make the control insertable, which means it can be embedded into applications that support embedded objects, such as Excel or Word.","pos":[2451,2595]},{"content":"To make the control insertable","pos":[2606,2636]},{"pos":[2646,2699],"content":"Click <bpt id=\"p1\">**</bpt>Appearance<ept id=\"p1\">**</ept> to open the <bpt id=\"p2\">**</bpt>Appearance<ept id=\"p2\">**</ept> page.","source":"Click **Appearance** to open the **Appearance** page."},{"pos":[2709,2745],"content":"Select the <bpt id=\"p1\">**</bpt>Insertable<ept id=\"p1\">**</ept> check box.","source":"Select the **Insertable** check box."},{"pos":[2752,2867],"content":"The polygon displayed by the object will have a solid fill color, so you have to add a <ph id=\"ph1\">`Fill Color`</ph> stock property.","source":"The polygon displayed by the object will have a solid fill color, so you have to add a `Fill Color` stock property."},{"content":"To add a Fill Color stock property and create the control","pos":[2878,2935]},{"pos":[2945,3010],"content":"Click <bpt id=\"p1\">**</bpt>Stock Properties<ept id=\"p1\">**</ept> to open the <bpt id=\"p2\">**</bpt>Stock Properties<ept id=\"p2\">**</ept> page.","source":"Click **Stock Properties** to open the **Stock Properties** page."},{"content":"Under <bpt id=\"p1\">**</bpt>Not supported<ept id=\"p1\">**</ept>, scroll down the list of possible stock properties.","pos":[3020,3095],"source":"Under **Not supported**, scroll down the list of possible stock properties."},{"content":"Double-click <ph id=\"ph1\">`Fill Color`</ph> to move it to the <bpt id=\"p1\">**</bpt>Supported<ept id=\"p1\">**</ept> list.","pos":[3096,3159],"source":" Double-click `Fill Color` to move it to the **Supported** list."},{"content":"This completes the options for the control.","pos":[3169,3212]},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","pos":[3213,3230],"source":" Click **Finish**."},{"content":"As the wizard created the control, several code changes and file additions occurred.","pos":[3237,3321]},{"content":"The following files were created:","pos":[3322,3355]},{"content":"File","pos":[3362,3366]},{"content":"Description","pos":[3367,3378]},{"content":"PolyCtl.h","pos":[3416,3425]},{"pos":[3426,3490],"content":"Contains most of the implementation of the C++ class <ph id=\"ph1\">`CPolyCtl`</ph>.","source":"Contains most of the implementation of the C++ class `CPolyCtl`."},{"content":"PolyCtl.cpp","pos":[3495,3506]},{"pos":[3507,3550],"content":"Contains the remaining parts of <ph id=\"ph1\">`CPolyCtl`</ph>.","source":"Contains the remaining parts of `CPolyCtl`."},{"content":"PolyCtl.rgs","pos":[3555,3566]},{"content":"A text file that contains the registry script used to register the control.","pos":[3567,3642]},{"content":"PolyCtl.htm","pos":[3647,3658]},{"content":"A Web page containing a reference to the newly created control.","pos":[3659,3722]},{"content":"The wizard also performed the following code changes:","pos":[3730,3783]},{"pos":[3793,3919],"content":"Added an <ph id=\"ph1\">`#include`</ph> statement to the stdafx.h and stdafx.cpp files to include the ATL files necessary for supporting controls.","source":"Added an `#include` statement to the stdafx.h and stdafx.cpp files to include the ATL files necessary for supporting controls."},{"content":"Changed Polygon.idl to include details of the new control.","pos":[3929,3987]},{"content":"Added the new control to the object map in Polygon.cpp.","pos":[3997,4052]},{"content":"Now you can build the control to see it in action.","pos":[4059,4109]},{"content":"Building and Testing the Control","pos":[4118,4150]},{"content":"To build and test the control","pos":[4161,4190]},{"pos":[4200,4247],"content":"On the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Build Polygon<ept id=\"p2\">**</ept>.","source":"On the **Build** menu, click **Build Polygon**."},{"content":"Once the control finishes building, right-click PolyCtl.htm in <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> and select <bpt id=\"p2\">**</bpt>View in Browser<ept id=\"p2\">**</ept>.","pos":[4258,4374],"source":"Once the control finishes building, right-click PolyCtl.htm in **Solution Explorer** and select **View in Browser**."},{"content":"The HTML Web page containing the control will be displayed.","pos":[4375,4434]},{"content":"You should see a page with the title “ATL 8.0 test page for object PolyCtl” and the text <bpt id=\"p1\">**</bpt>PolyCtl<ept id=\"p1\">**</ept>.","pos":[4435,4536],"source":" You should see a page with the title “ATL 8.0 test page for object PolyCtl” and the text **PolyCtl**."},{"content":"This is your control.","pos":[4537,4558]},{"pos":[4566,4878],"content":"[!NOTE]\n When completing this tutorial, if you receive an error message where the DLL file cannot be created, close the PolyCtl.htm file and the ActiveX Control Test container and build the solution again. If you still cannot create the DLL, reboot the computer or log off (if you are using Terminal Services).","leadings":["","> "],"nodes":[{"content":" When completing this tutorial, if you receive an error message where the DLL file cannot be created, close the PolyCtl.htm file and the ActiveX Control Test container and build the solution again. If you still cannot create the DLL, reboot the computer or log off (if you are using Terminal Services).","pos":[8,310],"nodes":[{"content":"When completing this tutorial, if you receive an error message where the DLL file cannot be created, close the PolyCtl.htm file and the ActiveX Control Test container and build the solution again.","pos":[1,197]},{"content":"If you still cannot create the DLL, reboot the computer or log off (if you are using Terminal Services).","pos":[198,302]}]}]},{"content":"Next, you will add a custom property to the control.","pos":[4885,4937]},{"pos":[4944,5098],"content":"<bpt id=\"p1\">[</bpt>Back to Step 1<ept id=\"p1\">](../atl/creating-the-project-atl-tutorial-part-1.md)</ept> &amp;#124; <bpt id=\"p2\">[</bpt>On to Step 3<ept id=\"p2\">](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)</ept>","source":"[Back to Step 1](../atl/creating-the-project-atl-tutorial-part-1.md) &#124; [On to Step 3](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)"},{"content":"See Also","pos":[5107,5115]},{"content":"Tutorial","pos":[5120,5128]}],"content":"---\ntitle: \"Adding a Control (ATL Tutorial, Part 2) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nms.assetid: c9575a75-1064-41f1-9697-7aada560c669\ncaps.latest.revision: 15\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Adding a Control (ATL Tutorial, Part 2)\nIn this step, you will add a control to your project, build it, and test it on a Web page.  \n  \n## Procedures  \n  \n#### To add an object to an ATL project  \n  \n1.  In Class View, right-click the Polygon project.  \n  \n2.  Point to **Add** on the shortcut menu, and click **Class** in the submenu.  \n  \n     The **Add Class** dialog box appears. The different object categories are listed in the tree structure on the left.  \n  \n3.  Click the **ATL** folder.  \n  \n4.  From the list of templates on the right, select **ATL Control**. Click **Add**. The ATL Control Wizard will open, and you can configure the control.  \n  \n5.  Type `PolyCtl` as the short name and note that the other fields are automatically completed. Do not click **Finish** yet, because you have to make some changes.  \n  \n The ATL Control Wizard's **Names** page contains the following fields:  \n  \n|Field|Contents|  \n|-----------|--------------|  \n|**Short name**|The name you entered for the control.|  \n|**Class**|The C++ class name created to implement the control.|  \n|**.h file**|The file created to contain the definition of the C++ class.|  \n|**.cpp file**|The file created to contain the implementation of the C++ class.|  \n|**CoClass**|The name of the component class for this control.|  \n|**Interface**|The name of the interface on which the control will implement its custom methods and properties.|  \n|**Type**|A description for the control.|  \n|**ProgID**|The readable name that can be used to look up the CLSID of the control.|  \n  \n You have to make several additional settings in the ATL Control Wizard.  \n  \n#### To enable support for rich error information and connection points  \n  \n1.  Click **Options** to open the **Options** page.  \n  \n2.  Select the **Connection points** check box. This will create support for an outgoing interface in the IDL file.  \n  \n You can also make the control insertable, which means it can be embedded into applications that support embedded objects, such as Excel or Word.  \n  \n#### To make the control insertable  \n  \n1.  Click **Appearance** to open the **Appearance** page.  \n  \n2.  Select the **Insertable** check box.  \n  \n The polygon displayed by the object will have a solid fill color, so you have to add a `Fill Color` stock property.  \n  \n#### To add a Fill Color stock property and create the control  \n  \n1.  Click **Stock Properties** to open the **Stock Properties** page.  \n  \n2.  Under **Not supported**, scroll down the list of possible stock properties. Double-click `Fill Color` to move it to the **Supported** list.  \n  \n3.  This completes the options for the control. Click **Finish**.  \n  \n As the wizard created the control, several code changes and file additions occurred. The following files were created:  \n  \n|File|Description|  \n|----------|-----------------|  \n|PolyCtl.h|Contains most of the implementation of the C++ class `CPolyCtl`.|  \n|PolyCtl.cpp|Contains the remaining parts of `CPolyCtl`.|  \n|PolyCtl.rgs|A text file that contains the registry script used to register the control.|  \n|PolyCtl.htm|A Web page containing a reference to the newly created control.|  \n  \n The wizard also performed the following code changes:  \n  \n-   Added an `#include` statement to the stdafx.h and stdafx.cpp files to include the ATL files necessary for supporting controls.  \n  \n-   Changed Polygon.idl to include details of the new control.  \n  \n-   Added the new control to the object map in Polygon.cpp.  \n  \n Now you can build the control to see it in action.  \n  \n## Building and Testing the Control  \n  \n#### To build and test the control  \n  \n1.  On the **Build** menu, click **Build Polygon**.  \n  \n     Once the control finishes building, right-click PolyCtl.htm in **Solution Explorer** and select **View in Browser**. The HTML Web page containing the control will be displayed. You should see a page with the title “ATL 8.0 test page for object PolyCtl” and the text **PolyCtl**. This is your control.  \n  \n> [!NOTE]\n>  When completing this tutorial, if you receive an error message where the DLL file cannot be created, close the PolyCtl.htm file and the ActiveX Control Test container and build the solution again. If you still cannot create the DLL, reboot the computer or log off (if you are using Terminal Services).  \n  \n Next, you will add a custom property to the control.  \n  \n [Back to Step 1](../atl/creating-the-project-atl-tutorial-part-1.md) &#124; [On to Step 3](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)  \n  \n## See Also  \n [Tutorial](../atl/active-template-library-atl-tutorial.md)\n\n"}