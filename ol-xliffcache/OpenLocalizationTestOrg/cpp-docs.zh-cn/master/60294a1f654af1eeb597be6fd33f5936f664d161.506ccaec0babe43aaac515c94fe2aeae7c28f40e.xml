{"nodes":[{"pos":[12,80],"content":"MFC ActiveX Controls: Creating an Automation Server | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Creating an Automation Server | Microsoft Docs","pos":[0,68]}]},{"content":"MFC ActiveX Controls: Creating an Automation Server","pos":[736,787]},{"content":"You can develop an MFC ActiveX control as an Automation server for the purpose of programmatically embedding that control in another application and calling methods in the control from the application.","pos":[788,989]},{"content":"Such a control would still be available to be hosted in an ActiveX control container.","pos":[990,1075]},{"content":"To create a control as an Automation server","pos":[1085,1128]},{"pos":[1138,1207],"content":"<bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](../mfc/reference/mfc-activex-control-wizard.md)</ept> the control.","source":"[Create](../mfc/reference/mfc-activex-control-wizard.md) the control."},{"pos":[1217,1271],"content":"<bpt id=\"p1\">[</bpt>Add methods<ept id=\"p1\">](../mfc/mfc-activex-controls-methods.md)</ept>.","source":"[Add methods](../mfc/mfc-activex-controls-methods.md)."},{"content":"Override <bpt id=\"p1\">[</bpt>IsInvokeAllowed<ept id=\"p1\">](../mfc/reference/colecontrol-class.md#colecontrol__isinvokeallowed)</ept>.","pos":[1281,1376],"source":"Override [IsInvokeAllowed](../mfc/reference/colecontrol-class.md#colecontrol__isinvokeallowed)."},{"content":"For more information, see Knowledge Base article Q146120.","pos":[1377,1434]},{"content":"Build the control.","pos":[1444,1462]},{"content":"To programmatically access the methods in an Automation server","pos":[1472,1534]},{"pos":[1544,1637],"content":"Create an application, for example, an <bpt id=\"p1\">[</bpt>MFC exe<ept id=\"p1\">](../mfc/reference/mfc-application-wizard.md)</ept>.","source":"Create an application, for example, an [MFC exe](../mfc/reference/mfc-application-wizard.md)."},{"pos":[1647,1719],"content":"At the beginning of the <ph id=\"ph1\">`InitInstance`</ph> function, add the following line:","source":"At the beginning of the `InitInstance` function, add the following line:"},{"pos":[1741,1758],"content":"NVC_MFC_AxCont#17"},{"pos":[1851,1960],"content":"In Class View, right-click the project node and select <bpt id=\"p1\">**</bpt>Add class from typelib<ept id=\"p1\">**</ept> to import the type library.","source":"In Class View, right-click the project node and select **Add class from typelib** to import the type library."},{"content":"This will add files with the file name extensions .h and .cpp to the project.","pos":[1971,2048]},{"pos":[2058,2300],"content":"In the header file of the class where you will call one or more methods in the ActiveX control, add the following line: <ph id=\"ph1\">`#include filename.h`</ph>, where file name is the name of the header file that was created when you imported the type library.","source":"In the header file of the class where you will call one or more methods in the ActiveX control, add the following line: `#include filename.h`, where file name is the name of the header file that was created when you imported the type library."},{"content":"In the function where a call will be made to a method in the ActiveX control, add code that creates an object of the control's wrapper class and create the ActiveX object.","pos":[2310,2481]},{"content":"For example, the following MFC code instantiates a <ph id=\"ph1\">`CCirc`</ph> control, gets the Caption property, and displays the result when the OK button is clicked in a dialog box:","pos":[2482,2647],"source":" For example, the following MFC code instantiates a `CCirc` control, gets the Caption property, and displays the result when the OK button is clicked in a dialog box:"},{"pos":[2669,2686],"content":"NVC_MFC_AxCont#18"},{"content":"If you add methods to the ActiveX control after you use it in an application, you can begin using the latest version of the control in the application by deleting the files that were created when you imported the type library.","pos":[2776,3002]},{"content":"Then import the type library again.","pos":[3003,3038]},{"content":"See Also","pos":[3047,3055]},{"content":"MFC ActiveX Controls","pos":[3060,3080]}],"content":"---\ntitle: \"MFC ActiveX Controls: Creating an Automation Server | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Automation servers [C++], MFC ActiveX controls\"\n  - \"ActiveX controls [C++], Automation server\"\n  - \"MFC ActiveX controls [C++], Automation server\"\nms.assetid: e0c24ed2-d61c-49ad-a4fa-4e1098d1d39b\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Creating an Automation Server\nYou can develop an MFC ActiveX control as an Automation server for the purpose of programmatically embedding that control in another application and calling methods in the control from the application. Such a control would still be available to be hosted in an ActiveX control container.  \n  \n### To create a control as an Automation server  \n  \n1.  [Create](../mfc/reference/mfc-activex-control-wizard.md) the control.  \n  \n2.  [Add methods](../mfc/mfc-activex-controls-methods.md).  \n  \n3.  Override [IsInvokeAllowed](../mfc/reference/colecontrol-class.md#colecontrol__isinvokeallowed). For more information, see Knowledge Base article Q146120.  \n  \n4.  Build the control.  \n  \n### To programmatically access the methods in an Automation server  \n  \n1.  Create an application, for example, an [MFC exe](../mfc/reference/mfc-application-wizard.md).  \n  \n2.  At the beginning of the `InitInstance` function, add the following line:  \n  \n     [!code-cpp[NVC_MFC_AxCont#17](../mfc/codesnippet/cpp/mfc-activex-controls-creating-an-automation-server_1.cpp)]  \n  \n3.  In Class View, right-click the project node and select **Add class from typelib** to import the type library.  \n  \n     This will add files with the file name extensions .h and .cpp to the project.  \n  \n4.  In the header file of the class where you will call one or more methods in the ActiveX control, add the following line: `#include filename.h`, where file name is the name of the header file that was created when you imported the type library.  \n  \n5.  In the function where a call will be made to a method in the ActiveX control, add code that creates an object of the control's wrapper class and create the ActiveX object. For example, the following MFC code instantiates a `CCirc` control, gets the Caption property, and displays the result when the OK button is clicked in a dialog box:  \n  \n     [!code-cpp[NVC_MFC_AxCont#18](../mfc/codesnippet/cpp/mfc-activex-controls-creating-an-automation-server_2.cpp)]  \n  \n If you add methods to the ActiveX control after you use it in an application, you can begin using the latest version of the control in the application by deleting the files that were created when you imported the type library. Then import the type library again.  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)\n\n"}