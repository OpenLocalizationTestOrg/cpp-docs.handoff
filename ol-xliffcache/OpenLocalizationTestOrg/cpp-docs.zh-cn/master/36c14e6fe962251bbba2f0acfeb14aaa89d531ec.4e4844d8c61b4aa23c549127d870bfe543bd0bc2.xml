{"nodes":[{"pos":[12,51],"content":"String Data Management | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"String Data Management | Microsoft Docs","pos":[0,39]}]},{"content":"String Data Management","pos":[586,608]},{"content":"Visual C++ provides several ways to manage string data:","pos":[609,664]},{"pos":[674,793],"content":"<bpt id=\"p1\">[</bpt>String Manipulation<ept id=\"p1\">](../c-runtime-library/string-manipulation-crt.md)</ept> for working with C-style null-terminated strings","source":"[String Manipulation](../c-runtime-library/string-manipulation-crt.md) for working with C-style null-terminated strings"},{"content":"Win32 API functions for managing strings","pos":[803,843]},{"pos":[853,979],"content":"MFC's class <bpt id=\"p1\">[</bpt>CStringT Class<ept id=\"p1\">](../atl-mfc-shared/reference/cstringt-class.md)</ept>, which provides flexible, resizable string objects","source":"MFC's class [CStringT Class](../atl-mfc-shared/reference/cstringt-class.md), which provides flexible, resizable string objects"},{"pos":[989,1138],"content":"Class <bpt id=\"p1\">[</bpt>CStringT Class<ept id=\"p1\">](../atl-mfc-shared/reference/cstringt-class.md)</ept>, which provides an MFC-independent string object with the same functionality as","source":"Class [CStringT Class](../atl-mfc-shared/reference/cstringt-class.md), which provides an MFC-independent string object with the same functionality as "},{"content":"Nearly all programs work with string data.","pos":[1155,1197]},{"content":"MFC's <ph id=\"ph1\">`CString`</ph> class is often the best solution for flexible string handling.","pos":[1198,1276],"source":" MFC's `CString` class is often the best solution for flexible string handling."},{"content":"Starting with version 7.0, <ph id=\"ph1\">`CString`</ph> can be used in MFC or MFC-independent programs.","pos":[1277,1361],"source":" Starting with version 7.0, `CString` can be used in MFC or MFC-independent programs."},{"content":"Both the run-time library and <ph id=\"ph1\">`CString`</ph> support strings containing multibyte (wide) characters, as in Unicode or MBCS programming.","pos":[1362,1492],"source":" Both the run-time library and `CString` support strings containing multibyte (wide) characters, as in Unicode or MBCS programming."},{"content":"This article describes the general-purpose services that the class library provides related to string manipulation.","pos":[1499,1614]},{"content":"Topics covered in this article include:","pos":[1615,1654]},{"content":"Unicode and MBCS Provide portability","pos":[1665,1701]},{"content":"CStrings and const char Pointers","pos":[1758,1790]},{"content":"CString Reference Counting","pos":[1843,1869]},{"content":"The <bpt id=\"p1\">[</bpt>CStringT Class<ept id=\"p1\">](../atl-mfc-shared/reference/cstringt-class.md)</ept> class provides support for manipulating strings.","pos":[1912,2028],"source":"The [CStringT Class](../atl-mfc-shared/reference/cstringt-class.md) class provides support for manipulating strings."},{"content":"It is intended to replace and extend the functionality normally provided by the C run-time library string package.","pos":[2029,2143]},{"content":"The <ph id=\"ph1\">`CString`</ph> class supplies member functions and operators for simplified string handling, similar to those found in Basic.","pos":[2144,2268],"source":" The `CString` class supplies member functions and operators for simplified string handling, similar to those found in Basic."},{"content":"The class also provides constructors and operators for constructing, assigning, and comparing <bpt id=\"p1\">**</bpt>CStrings<ept id=\"p1\">**</ept> and standard C++ string data types.","pos":[2269,2411],"source":" The class also provides constructors and operators for constructing, assigning, and comparing **CStrings** and standard C++ string data types."},{"content":"Because <ph id=\"ph1\">`CString`</ph> is not derived from <ph id=\"ph2\">`CObject`</ph>, you can use <ph id=\"ph3\">`CString`</ph> objects independently of most of the Microsoft Foundation Class Library (MFC).","pos":[2412,2561],"source":" Because `CString` is not derived from `CObject`, you can use `CString` objects independently of most of the Microsoft Foundation Class Library (MFC)."},{"content":"objects follow \"value semantics.\"","pos":[2578,2611]},{"content":"A <ph id=\"ph1\">`CString`</ph> object represents a unique value.","pos":[2612,2657],"source":" A `CString` object represents a unique value."},{"content":"Think of a <ph id=\"ph1\">`CString`</ph> as an actual string, not as a pointer to a string.","pos":[2658,2729],"source":" Think of a `CString` as an actual string, not as a pointer to a string."},{"content":"A <ph id=\"ph1\">`CString`</ph> object represents a sequence of a variable number of characters.","pos":[2736,2812],"source":"A `CString` object represents a sequence of a variable number of characters."},{"content":"objects can be thought of as arrays of characters.","pos":[2823,2873]},{"pos":[2941,2977],"content":"Unicode and MBCS Provide Portability"},{"content":"With MFC version 3.0 and later, MFC, including <ph id=\"ph1\">`CString`</ph>, is enabled for both Unicode and multibyte character sets (MBCS).","pos":[2981,3103],"source":"With MFC version 3.0 and later, MFC, including `CString`, is enabled for both Unicode and multibyte character sets (MBCS)."},{"content":"This support makes it easier for you to write portable applications that you can build for either Unicode or ANSI characters.","pos":[3104,3229]},{"content":"To enable this portability, each character in a <ph id=\"ph1\">`CString`</ph> object is of type <bpt id=\"p1\">**</bpt>TCHAR<ept id=\"p1\">**</ept>, which is defined as <ph id=\"ph2\">`wchar_t`</ph> if you define the symbol <bpt id=\"p2\">**</bpt>_UNICODE<ept id=\"p2\">**</ept> when you build your application, or as <ph id=\"ph3\">`char`</ph> if not.","pos":[3230,3438],"source":" To enable this portability, each character in a `CString` object is of type **TCHAR**, which is defined as `wchar_t` if you define the symbol **_UNICODE** when you build your application, or as `char` if not."},{"content":"A <ph id=\"ph1\">`wchar_t`</ph> character is 16 bits wide.","pos":[3439,3477],"source":" A `wchar_t` character is 16 bits wide."},{"content":"MBCS is enabled if you build with the symbol <bpt id=\"p1\">**</bpt>_MBCS<ept id=\"p1\">**</ept> defined.","pos":[3478,3541],"source":" MBCS is enabled if you build with the symbol **_MBCS** defined."},{"content":"MFC itself is built with either the <bpt id=\"p1\">**</bpt>_MBCS<ept id=\"p1\">**</ept> symbol (for the NAFX libraries) or the <bpt id=\"p2\">**</bpt>_UNICODE<ept id=\"p2\">**</ept> symbol (for the UAFX libraries) defined.","pos":[3542,3680],"source":" MFC itself is built with either the **_MBCS** symbol (for the NAFX libraries) or the **_UNICODE** symbol (for the UAFX libraries) defined."},{"pos":[3688,3908],"content":"[!NOTE]\n The `CString` examples in this and the accompanying articles on strings show literal strings properly formatted for Unicode portability, using the **_T** macro, which translates the literal string to the form:","leadings":["","> "],"nodes":[{"content":"The <ph id=\"ph1\">`CString`</ph> examples in this and the accompanying articles on strings show literal strings properly formatted for Unicode portability, using the <bpt id=\"p1\">**</bpt>_T<ept id=\"p1\">**</ept> macro, which translates the literal string to the form:","pos":[9,218],"source":" The `CString` examples in this and the accompanying articles on strings show literal strings properly formatted for Unicode portability, using the **_T** macro, which translates the literal string to the form:"}]},{"pos":[3942,4032],"content":"[!NOTE]\n which the compiler treats as a Unicode string. For example, the following code:","leadings":["","> "],"nodes":[{"content":" which the compiler treats as a Unicode string. For example, the following code:","pos":[8,88],"nodes":[{"content":"which the compiler treats as a Unicode string.","pos":[1,47]},{"content":"For example, the following code:","pos":[48,80]}]}]},{"pos":[4050,4074],"content":"NVC_ATLMFC_Utilities#187"},{"pos":[4148,4411],"content":"[!NOTE]\n is translated as a Unicode string if **_UNICODE** is defined or as an ANSI string if not. For more information, see the article [Unicode and Multibyte Character Set (MBCS) Support](../atl-mfc-shared/unicode-and-multibyte-character-set-mbcs-support.md).","leadings":["","> "],"nodes":[{"content":" is translated as a Unicode string if **_UNICODE** is defined or as an ANSI string if not. For more information, see the article [Unicode and Multibyte Character Set (MBCS) Support](../atl-mfc-shared/unicode-and-multibyte-character-set-mbcs-support.md).","pos":[8,261],"nodes":[{"content":"is translated as a Unicode string if <bpt id=\"p1\">**</bpt>_UNICODE<ept id=\"p1\">**</ept> is defined or as an ANSI string if not.","pos":[1,90],"source":" is translated as a Unicode string if **_UNICODE** is defined or as an ANSI string if not."},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Unicode and Multibyte Character Set (MBCS) Support<ept id=\"p1\">](../atl-mfc-shared/unicode-and-multibyte-character-set-mbcs-support.md)</ept>.","pos":[91,253],"source":" For more information, see the article [Unicode and Multibyte Character Set (MBCS) Support](../atl-mfc-shared/unicode-and-multibyte-character-set-mbcs-support.md)."}]}]},{"content":"A <ph id=\"ph1\">`CString`</ph> object can store up to <bpt id=\"p1\">**</bpt>INT_MAX<ept id=\"p1\">**</ept> (2,147,483,647) characters.","pos":[4418,4492],"source":"A `CString` object can store up to **INT_MAX** (2,147,483,647) characters."},{"content":"The <bpt id=\"p1\">**</bpt>TCHAR<ept id=\"p1\">**</ept> data type is used to get or set individual characters inside a <ph id=\"ph1\">`CString`</ph> object.","pos":[4493,4587],"source":" The **TCHAR** data type is used to get or set individual characters inside a `CString` object."},{"content":"Unlike character arrays, the <ph id=\"ph1\">`CString`</ph> class has a built-in memory allocation capability.","pos":[4588,4677],"source":" Unlike character arrays, the `CString` class has a built-in memory allocation capability."},{"content":"This allows <ph id=\"ph1\">`CString`</ph> objects to automatically grow as needed (that is, you do not have to worry about growing a <ph id=\"ph2\">`CString`</ph> object to fit longer strings).","pos":[4678,4831],"source":" This allows `CString` objects to automatically grow as needed (that is, you do not have to worry about growing a `CString` object to fit longer strings)."},{"pos":[4895,4927],"content":"CStrings and const char Pointers"},{"content":"A <ph id=\"ph1\">`CString`</ph> object also can act like a literal C-style string (an <ph id=\"ph2\">`PCXSTR`</ph>, which is the same as <bpt id=\"p1\">**</bpt>const char<ph id=\"ph3\">\\*</ph><ept id=\"p1\">**</ept> if not under Unicode).","pos":[4931,5067],"source":"A `CString` object also can act like a literal C-style string (an `PCXSTR`, which is the same as **const char\\*** if not under Unicode)."},{"content":"The <bpt id=\"p1\">[</bpt>CSimpleStringT::operator PCXSTR<ept id=\"p1\">](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__operator_pcxstr)</ept> conversion operator allows <ph id=\"ph1\">`CString`</ph> objects to be freely substituted for character pointers in function calls.","pos":[5068,5302],"source":" The [CSimpleStringT::operator PCXSTR](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__operator_pcxstr) conversion operator allows `CString` objects to be freely substituted for character pointers in function calls."},{"content":"The <bpt id=\"p1\">**</bpt>CString( LPCWSTR<ept id=\"p1\">**</ept> <ph id=\"ph1\">`pszSrc`</ph> <bpt id=\"p2\">**</bpt>)<ept id=\"p2\">**</ept> constructor allows character pointers to be substituted for <ph id=\"ph2\">`CString`</ph> objects.","pos":[5303,5421],"source":" The **CString( LPCWSTR** `pszSrc` **)** constructor allows character pointers to be substituted for `CString` objects."},{"content":"No attempt is made to fold <ph id=\"ph1\">`CString`</ph> objects.","pos":[5428,5473],"source":"No attempt is made to fold `CString` objects."},{"content":"If you make two <ph id=\"ph1\">`CString`</ph> objects containing <ph id=\"ph2\">`Chicago`</ph>, for example, the characters in <ph id=\"ph3\">`Chicago`</ph> are stored in two places.","pos":[5474,5596],"source":" If you make two `CString` objects containing `Chicago`, for example, the characters in `Chicago` are stored in two places."},{"content":"(This may not be true of future versions of MFC, so you should not depend on it.)","pos":[5597,5678]},{"pos":[5686,6033],"content":"[!NOTE]\n Use the [CSimpleStringT::GetBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__getbuffer) and [CSimpleStringT::ReleaseBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__releasebuffer) member functions when you need to directly access a `CString` as a nonconstant pointer to a character.","leadings":["","> "],"nodes":[{"content":"Use the <bpt id=\"p1\">[</bpt>CSimpleStringT::GetBuffer<ept id=\"p1\">](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__getbuffer)</ept> and <bpt id=\"p2\">[</bpt>CSimpleStringT::ReleaseBuffer<ept id=\"p2\">](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__releasebuffer)</ept> member functions when you need to directly access a <ph id=\"ph1\">`CString`</ph> as a nonconstant pointer to a character.","pos":[9,345],"source":" Use the [CSimpleStringT::GetBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__getbuffer) and [CSimpleStringT::ReleaseBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__releasebuffer) member functions when you need to directly access a `CString` as a nonconstant pointer to a character."}]},{"pos":[6041,6364],"content":"[!NOTE]\n Use the [CStringT::AllocSysString](../atl-mfc-shared/reference/cstringt-class.md#cstringt__allocsysstring) and [CStringT::SetSysString](../atl-mfc-shared/reference/cstringt-class.md#cstringt__setsysstring) member functions to allocate and set `BSTR` objects used in Automation (formerly known as OLE Automation).","leadings":["","> "],"nodes":[{"content":"Use the <bpt id=\"p1\">[</bpt>CStringT::AllocSysString<ept id=\"p1\">](../atl-mfc-shared/reference/cstringt-class.md#cstringt__allocsysstring)</ept> and <bpt id=\"p2\">[</bpt>CStringT::SetSysString<ept id=\"p2\">](../atl-mfc-shared/reference/cstringt-class.md#cstringt__setsysstring)</ept> member functions to allocate and set <ph id=\"ph1\">`BSTR`</ph> objects used in Automation (formerly known as OLE Automation).","pos":[9,321],"source":" Use the [CStringT::AllocSysString](../atl-mfc-shared/reference/cstringt-class.md#cstringt__allocsysstring) and [CStringT::SetSysString](../atl-mfc-shared/reference/cstringt-class.md#cstringt__setsysstring) member functions to allocate and set `BSTR` objects used in Automation (formerly known as OLE Automation)."}]},{"pos":[6372,6515],"content":"[!NOTE]\n Where possible, allocate `CString` objects on the frame rather than on the heap. This saves memory and simplifies parameter passing.","leadings":["","> "],"nodes":[{"content":" Where possible, allocate `CString` objects on the frame rather than on the heap. This saves memory and simplifies parameter passing.","pos":[8,141],"nodes":[{"content":"Where possible, allocate <ph id=\"ph1\">`CString`</ph> objects on the frame rather than on the heap.","pos":[1,81],"source":" Where possible, allocate `CString` objects on the frame rather than on the heap."},{"content":"This saves memory and simplifies parameter passing.","pos":[82,133]}]}]},{"pos":[6522,6695],"content":"The <ph id=\"ph1\">`CString`</ph> class is not implemented as a Microsoft Foundation Class Library collection class, though <ph id=\"ph2\">`CString`</ph> objects can certainly be stored as elements in collections.","source":"The `CString` class is not implemented as a Microsoft Foundation Class Library collection class, though `CString` objects can certainly be stored as elements in collections."},{"pos":[6753,6779],"content":"CString Reference Counting"},{"content":"As of MFC version 4.0, when <bpt id=\"p1\">[</bpt>CStringT Class<ept id=\"p1\">](../atl-mfc-shared/reference/cstringt-class.md)</ept> objects are copied, MFC increments a reference count rather than copying the data.","pos":[6783,6957],"source":"As of MFC version 4.0, when [CStringT Class](../atl-mfc-shared/reference/cstringt-class.md) objects are copied, MFC increments a reference count rather than copying the data."},{"content":"This makes passing parameters by value and returning <ph id=\"ph1\">`CString`</ph> objects by value more efficient.","pos":[6958,7053],"source":" This makes passing parameters by value and returning `CString` objects by value more efficient."},{"content":"These operations cause the copy constructor to be called, sometimes more than once.","pos":[7054,7137]},{"content":"Incrementing a reference count reduces that overhead for these common operations and makes using <ph id=\"ph1\">`CString`</ph> a more attractive option.","pos":[7138,7270],"source":" Incrementing a reference count reduces that overhead for these common operations and makes using `CString` a more attractive option."},{"content":"As each copy is destroyed, the reference count in the original object is decremented.","pos":[7277,7362]},{"content":"The original <ph id=\"ph1\">`CString`</ph> object is not destroyed until its reference count is reduced to zero.","pos":[7363,7455],"source":" The original `CString` object is not destroyed until its reference count is reduced to zero."},{"pos":[7462,7771],"content":"You can use the <ph id=\"ph1\">`CString`</ph> member functions <bpt id=\"p1\">[</bpt>CSimpleStringT::LockBuffer<ept id=\"p1\">](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__lockbuffer)</ept> and <bpt id=\"p2\">[</bpt>CSimpleStringT::UnlockBuffer<ept id=\"p2\">](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__unlockbuffer)</ept> to disable or enable reference counting.","source":"You can use the `CString` member functions [CSimpleStringT::LockBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__lockbuffer) and [CSimpleStringT::UnlockBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__unlockbuffer) to disable or enable reference counting."},{"content":"See Also","pos":[7780,7788]},{"content":"General MFC Topics","pos":[7793,7811]}],"content":"---\ntitle: \"String Data Management | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Unicode, string objects\"\nms.assetid: 0b53a542-eeb1-4108-9ada-6700645b6f8f\ncaps.latest.revision: 15\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# String Data Management\nVisual C++ provides several ways to manage string data:  \n  \n-   [String Manipulation](../c-runtime-library/string-manipulation-crt.md) for working with C-style null-terminated strings  \n  \n-   Win32 API functions for managing strings  \n  \n-   MFC's class [CStringT Class](../atl-mfc-shared/reference/cstringt-class.md), which provides flexible, resizable string objects  \n  \n-   Class [CStringT Class](../atl-mfc-shared/reference/cstringt-class.md), which provides an MFC-independent string object with the same functionality as `CString`  \n  \n Nearly all programs work with string data. MFC's `CString` class is often the best solution for flexible string handling. Starting with version 7.0, `CString` can be used in MFC or MFC-independent programs. Both the run-time library and `CString` support strings containing multibyte (wide) characters, as in Unicode or MBCS programming.  \n  \n This article describes the general-purpose services that the class library provides related to string manipulation. Topics covered in this article include:  \n  \n-   [Unicode and MBCS Provide portability](#_core_unicode_and_mbcs_provide_portability)  \n  \n-   [CStrings and const char Pointers](#_core_cstrings_and_const_char_pointers)  \n  \n-   [CString Reference Counting](#_core_cstring_reference_counting)  \n  \n The [CStringT Class](../atl-mfc-shared/reference/cstringt-class.md) class provides support for manipulating strings. It is intended to replace and extend the functionality normally provided by the C run-time library string package. The `CString` class supplies member functions and operators for simplified string handling, similar to those found in Basic. The class also provides constructors and operators for constructing, assigning, and comparing **CStrings** and standard C++ string data types. Because `CString` is not derived from `CObject`, you can use `CString` objects independently of most of the Microsoft Foundation Class Library (MFC).  \n  \n `CString` objects follow \"value semantics.\" A `CString` object represents a unique value. Think of a `CString` as an actual string, not as a pointer to a string.  \n  \n A `CString` object represents a sequence of a variable number of characters. `CString` objects can be thought of as arrays of characters.  \n  \n##  <a name=\"_core_unicode_and_mbcs_provide_portability\"></a> Unicode and MBCS Provide Portability  \n With MFC version 3.0 and later, MFC, including `CString`, is enabled for both Unicode and multibyte character sets (MBCS). This support makes it easier for you to write portable applications that you can build for either Unicode or ANSI characters. To enable this portability, each character in a `CString` object is of type **TCHAR**, which is defined as `wchar_t` if you define the symbol **_UNICODE** when you build your application, or as `char` if not. A `wchar_t` character is 16 bits wide. MBCS is enabled if you build with the symbol **_MBCS** defined. MFC itself is built with either the **_MBCS** symbol (for the NAFX libraries) or the **_UNICODE** symbol (for the UAFX libraries) defined.  \n  \n> [!NOTE]\n>  The `CString` examples in this and the accompanying articles on strings show literal strings properly formatted for Unicode portability, using the **_T** macro, which translates the literal string to the form:  \n  \n `L\"literal string\"`  \n  \n> [!NOTE]\n>  which the compiler treats as a Unicode string. For example, the following code:  \n  \n [!code-cpp[NVC_ATLMFC_Utilities#187](../atl-mfc-shared/codesnippet/cpp/string-data-management_1.cpp)]  \n  \n> [!NOTE]\n>  is translated as a Unicode string if **_UNICODE** is defined or as an ANSI string if not. For more information, see the article [Unicode and Multibyte Character Set (MBCS) Support](../atl-mfc-shared/unicode-and-multibyte-character-set-mbcs-support.md).  \n  \n A `CString` object can store up to **INT_MAX** (2,147,483,647) characters. The **TCHAR** data type is used to get or set individual characters inside a `CString` object. Unlike character arrays, the `CString` class has a built-in memory allocation capability. This allows `CString` objects to automatically grow as needed (that is, you do not have to worry about growing a `CString` object to fit longer strings).  \n  \n##  <a name=\"_core_cstrings_and_const_char_pointers\"></a> CStrings and const char Pointers  \n A `CString` object also can act like a literal C-style string (an `PCXSTR`, which is the same as **const char\\*** if not under Unicode). The [CSimpleStringT::operator PCXSTR](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__operator_pcxstr) conversion operator allows `CString` objects to be freely substituted for character pointers in function calls. The **CString( LPCWSTR** `pszSrc` **)** constructor allows character pointers to be substituted for `CString` objects.  \n  \n No attempt is made to fold `CString` objects. If you make two `CString` objects containing `Chicago`, for example, the characters in `Chicago` are stored in two places. (This may not be true of future versions of MFC, so you should not depend on it.)  \n  \n> [!NOTE]\n>  Use the [CSimpleStringT::GetBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__getbuffer) and [CSimpleStringT::ReleaseBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__releasebuffer) member functions when you need to directly access a `CString` as a nonconstant pointer to a character.  \n  \n> [!NOTE]\n>  Use the [CStringT::AllocSysString](../atl-mfc-shared/reference/cstringt-class.md#cstringt__allocsysstring) and [CStringT::SetSysString](../atl-mfc-shared/reference/cstringt-class.md#cstringt__setsysstring) member functions to allocate and set `BSTR` objects used in Automation (formerly known as OLE Automation).  \n  \n> [!NOTE]\n>  Where possible, allocate `CString` objects on the frame rather than on the heap. This saves memory and simplifies parameter passing.  \n  \n The `CString` class is not implemented as a Microsoft Foundation Class Library collection class, though `CString` objects can certainly be stored as elements in collections.  \n  \n##  <a name=\"_core_cstring_reference_counting\"></a> CString Reference Counting  \n As of MFC version 4.0, when [CStringT Class](../atl-mfc-shared/reference/cstringt-class.md) objects are copied, MFC increments a reference count rather than copying the data. This makes passing parameters by value and returning `CString` objects by value more efficient. These operations cause the copy constructor to be called, sometimes more than once. Incrementing a reference count reduces that overhead for these common operations and makes using `CString` a more attractive option.  \n  \n As each copy is destroyed, the reference count in the original object is decremented. The original `CString` object is not destroyed until its reference count is reduced to zero.  \n  \n You can use the `CString` member functions [CSimpleStringT::LockBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__lockbuffer) and [CSimpleStringT::UnlockBuffer](../atl-mfc-shared/reference/csimplestringt-class.md#csimplestringt__unlockbuffer) to disable or enable reference counting.  \n  \n## See Also  \n [General MFC Topics](../mfc/general-mfc-topics.md)\n\n"}