{"nodes":[{"pos":[12,52],"content":"CMFCShellTreeCtrl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCShellTreeCtrl Class | Microsoft Docs","pos":[0,40]}]},{"content":"CMFCShellTreeCtrl Class","pos":[625,648]},{"pos":[649,800],"content":"The <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph> class extends <bpt id=\"p1\">[</bpt>CTreeCtrl Class<ept id=\"p1\">](../../mfc/reference/ctreectrl-class.md)</ept> functionality by displaying a hierarchy of Shell items.","source":"The `CMFCShellTreeCtrl` class extends [CTreeCtrl Class](../../mfc/reference/ctreectrl-class.md) functionality by displaying a hierarchy of Shell items."},{"content":"Syntax","pos":[809,815]},{"content":"Members","pos":[884,891]},{"content":"Public Methods","pos":[901,915]},{"content":"Name","pos":[922,926]},{"content":"Description","pos":[927,938]},{"content":"CMFCShellTreeCtrl::EnableShellContextMenu","pos":[977,1018]},{"content":"Enables or disables the shortcut menu.","pos":[1064,1102]},{"content":"CMFCShellTreeCtrl::GetFlags","pos":[1108,1135]},{"pos":[1167,1305],"content":"Returns a combination of flags that are passed to <bpt id=\"p1\">[</bpt>IShellFolder::EnumObjects<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb775066)</ept>.","source":"Returns a combination of flags that are passed to [IShellFolder::EnumObjects](http://msdn.microsoft.com/library/windows/desktop/bb775066)."},{"content":"CMFCShellTreeCtrl::GetItemPath","pos":[1311,1341]},{"content":"Retrieves the path to an item.","pos":[1376,1406]},{"content":"CMFCShellTreeCtrl::GetRelatedList","pos":[1412,1445]},{"pos":[1483,1682],"content":"Returns a pointer to the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object that is used together with this <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph> object to create an Explorer-like window.","source":"Returns a pointer to the [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object that is used together with this `CMFCShellTreeCtrl` object to create an Explorer-like window."},{"content":"CMFCShellTreeCtrl::OnChildNotify","pos":[1688,1720]},{"content":"This member function is called by this window's parent window when it receives a notification message that applies to this window.","pos":[1757,1887]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CWnd::OnChildNotify<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__onchildnotify)</ept>.)","pos":[1888,1977],"source":" (Overrides [CWnd::OnChildNotify](../../mfc/reference/cwnd-class.md#cwnd__onchildnotify).)"},{"content":"CMFCShellTreeCtrl::OnGetItemIcon","pos":[1983,2015]},{"content":"CMFCShellTreeCtrl::OnGetItemText","pos":[2058,2090]},{"content":"CMFCShellTreeCtrl::Refresh","pos":[2133,2159]},{"pos":[2190,2252],"content":"Refreshes and repaints the current <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph> object.","source":"Refreshes and repaints the current `CMFCShellTreeCtrl` object."},{"content":"CMFCShellTreeCtrl::SelectPath","pos":[2258,2287]},{"content":"Selects the appropriate tree control item based on a supplied PIDL or string path.","pos":[2321,2403]},{"content":"CMFCShellTreeCtrl::SetFlags","pos":[2409,2436]},{"pos":[2468,2565],"content":"Sets flags to filter the tree context (similar to the flags used by <ph id=\"ph1\">`IShellFolder::EnumObjects`</ph>).","source":"Sets flags to filter the tree context (similar to the flags used by `IShellFolder::EnumObjects`)."},{"content":"CMFCShellTreeCtrl::SetRelatedList","pos":[2571,2604]},{"pos":[2642,2738],"content":"Sets a relation between the current <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph> object and a <ph id=\"ph2\">`CMFCShellListCtrl`</ph> object.","source":"Sets a relation between the current `CMFCShellTreeCtrl` object and a `CMFCShellListCtrl` object."},{"content":"Remarks","pos":[2748,2755]},{"content":"This class extends the <ph id=\"ph1\">`CTreeCtrl`</ph> class by enabling your program to include Windows Shell items in the tree.","pos":[2759,2868],"source":"This class extends the `CTreeCtrl` class by enabling your program to include Windows Shell items in the tree."},{"content":"This class can be associated with a <ph id=\"ph1\">`CMFCShellListCtrl`</ph> object to create a complete Explorer window.","pos":[2869,2969],"source":" This class can be associated with a `CMFCShellListCtrl` object to create a complete Explorer window."},{"content":"Then, selecting an item in the tree will display a list of Windows Shell items in the associated list.","pos":[2970,3072]},{"content":"Inheritance Hierarchy","pos":[3081,3102]},{"content":"CObject","pos":[3107,3114]},{"content":"CCmdTarget","pos":[3161,3171]},{"content":"CWnd","pos":[3221,3225]},{"content":"CTreeCtrl","pos":[3269,3278]},{"content":"CMFCShellTreeCtrl","pos":[3327,3344]},{"content":"Requirements","pos":[3402,3414]},{"pos":[3418,3448],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxshelltreeCtrl.h","source":"**Header:** afxshelltreeCtrl.h"},{"content":"Example","pos":[3457,3464]},{"content":"The following example demonstrates how to create an object of the <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph> class.","pos":[3468,3560],"source":"The following example demonstrates how to create an object of the `CMFCShellTreeCtrl` class."},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>Explorer sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[3561,3641],"source":" This code snippet is part of the [Explorer sample](../../visual-cpp-samples.md)."},{"content":"NVC_MFC_Explorer#4","pos":[3659,3677]},{"content":"NVC_MFC_Explorer#5","pos":[3758,3776]},{"pos":[3913,3954],"content":"CMFCShellTreeCtrl::EnableShellContextMenu"},{"content":"Enables the shortcut menu.","pos":[3958,3984]},{"content":"Parameters","pos":[4059,4069]},{"content":"[in]","pos":[4073,4077]},{"content":"A Boolean that specifies whether to enable the shortcut menu.","pos":[4091,4152]},{"pos":[4206,4233],"content":"CMFCShellTreeCtrl::GetFlags"},{"pos":[4237,4348],"content":"Returns the flags set for the <bpt id=\"p1\">[</bpt>CMFCShellTreeCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfcshelltreectrl-class.md)</ept> object.","source":"Returns the flags set for the [CMFCShellTreeCtrl Class](../../mfc/reference/cmfcshelltreectrl-class.md) object."},{"content":"Return Value","pos":[4400,4412]},{"pos":[4416,4486],"content":"A <ph id=\"ph1\">`DWORD`</ph> value that specifies the combination of flags currently set.","source":"A `DWORD` value that specifies the combination of flags currently set."},{"content":"Remarks","pos":[4496,4503]},{"content":"The flags set in the <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph> are sent to the method <bpt id=\"p1\">[</bpt>IShellFolder::EnumObjects<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb775066)</ept> whenever the object is refreshed.","pos":[4507,4692],"source":"The flags set in the `CMFCShellTreeCtrl` are sent to the method [IShellFolder::EnumObjects](http://msdn.microsoft.com/library/windows/desktop/bb775066) whenever the object is refreshed."},{"content":"You can change the flags with the <bpt id=\"p1\">[</bpt>CMFCShellTreeCtrl::SetFlags<ept id=\"p1\">](#cmfcshelltreectrl__setflags)</ept> method.","pos":[4693,4794],"source":" You can change the flags with the [CMFCShellTreeCtrl::SetFlags](#cmfcshelltreectrl__setflags) method."},{"pos":[4851,4881],"content":"CMFCShellTreeCtrl::GetItemPath"},{"pos":[4885,5003],"content":"Retrieves the path of an item in the <bpt id=\"p1\">[</bpt>CMFCShellTreeCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfcshelltreectrl-class.md)</ept> object.","source":"Retrieves the path of an item in the [CMFCShellTreeCtrl Class](../../mfc/reference/cmfcshelltreectrl-class.md) object."},{"content":"Parameters","pos":[5112,5122]},{"content":"[out]","pos":[5126,5131]},{"content":"A reference to a string parameter.","pos":[5145,5179]},{"content":"The method writes the path of the item to this parameter.","pos":[5180,5237]},{"content":"[in]","pos":[5244,5248]},{"content":"The method retrieves the path for this tree control item.","pos":[5264,5321]},{"content":"Return Value","pos":[5331,5343]},{"content":"Nonzero if successful; 0 otherwise.","pos":[5347,5382]},{"content":"Remarks","pos":[5392,5399]},{"pos":[5403,5461],"content":"If this method fails, <ph id=\"ph1\">`strPath`</ph> contains the empty string.","source":"If this method fails, `strPath` contains the empty string."},{"content":"If you do not specify <ph id=\"ph1\">`hTreeItem`</ph>, this method tries to obtain the string for the currently selected item.","pos":[5468,5574],"source":"If you do not specify `hTreeItem`, this method tries to obtain the string for the currently selected item."},{"content":"If no item is selected and <ph id=\"ph1\">`hTreeItem`</ph> is <ph id=\"ph2\">`NULL`</ph>, this method fails.","pos":[5575,5643],"source":" If no item is selected and `hTreeItem` is `NULL`, this method fails."},{"pos":[5703,5736],"content":"CMFCShellTreeCtrl::GetRelatedList"},{"pos":[5740,5950],"content":"Returns a pointer to the <bpt id=\"p1\">[</bpt>CMFCShellListCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object that is associated with this <bpt id=\"p2\">[</bpt>CMFCShellTreeCtrl<ept id=\"p2\">](../../mfc/reference/cmfcshelltreectrl-class.md)</ept> object.","source":"Returns a pointer to the [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object that is associated with this [CMFCShellTreeCtrl](../../mfc/reference/cmfcshelltreectrl-class.md) object."},{"content":"Return Value","pos":[6021,6033]},{"pos":[6037,6130],"content":"A pointer to the <ph id=\"ph1\">`CMFCShellListCtrl`</ph> object that is associated with this tree control object.","source":"A pointer to the `CMFCShellListCtrl` object that is associated with this tree control object."},{"content":"Remarks","pos":[6140,6147]},{"content":"By using a <ph id=\"ph1\">`CMFCShellListCtrl`</ph> object together with a <ph id=\"ph2\">`CMFCShellTreeCtrl`</ph> object, you can create an Explorer-like window.","pos":[6151,6272],"source":"By using a `CMFCShellListCtrl` object together with a `CMFCShellTreeCtrl` object, you can create an Explorer-like window."},{"content":"Use the method <bpt id=\"p1\">[</bpt>CMFCShellTreeCtrl::SetRelatedList<ept id=\"p1\">](#cmfcshelltreectrl__setrelatedlist)</ept> to associate the two classes.","pos":[6273,6389],"source":" Use the method [CMFCShellTreeCtrl::SetRelatedList](#cmfcshelltreectrl__setrelatedlist) to associate the two classes."},{"content":"After they are associated, the framework automatically updates the <ph id=\"ph1\">`CMFCShellListCtrl`</ph> if the selection in the <ph id=\"ph2\">`CMFCShellTreeCtrl`</ph> changes.","pos":[6390,6529],"source":" After they are associated, the framework automatically updates the `CMFCShellListCtrl` if the selection in the `CMFCShellTreeCtrl` changes."},{"pos":[6588,6620],"content":"CMFCShellTreeCtrl::OnChildNotify"},{"content":"Parameters","pos":[6862,6872]},{"content":"[in]","pos":[6876,6880]},{"content":"[in]","pos":[6894,6898]},{"content":"[in]","pos":[6911,6915]},{"content":"[in]","pos":[6928,6932]},{"content":"Return Value","pos":[6953,6965]},{"content":"Remarks","pos":[6975,6982]},{"pos":[7041,7073],"content":"CMFCShellTreeCtrl::OnGetItemIcon"},{"content":"Parameters","pos":[7282,7292]},{"content":"[in]","pos":[7296,7300]},{"content":"[in]","pos":[7312,7316]},{"content":"Return Value","pos":[7338,7350]},{"content":"Remarks","pos":[7360,7367]},{"pos":[7426,7458],"content":"CMFCShellTreeCtrl::OnGetItemText"},{"content":"Parameters","pos":[7644,7654]},{"pos":[7658,7662],"content":"[in]"},{"content":"Return Value","pos":[7680,7692]},{"content":"Remarks","pos":[7702,7709]},{"pos":[7762,7788],"content":"CMFCShellTreeCtrl::Refresh"},{"pos":[7792,7887],"content":"Refreshes and repaints the <bpt id=\"p1\">[</bpt>CMFCShellTreeCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelltreectrl-class.md)</ept>.","source":"Refreshes and repaints the [CMFCShellTreeCtrl](../../mfc/reference/cmfcshelltreectrl-class.md)."},{"content":"Remarks","pos":[7928,7935]},{"pos":[7939,8031],"content":"Call this method to refresh the hierarchy of the items displayed in the <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph>.","source":"Call this method to refresh the hierarchy of the items displayed in the `CMFCShellTreeCtrl`."},{"pos":[8087,8116],"content":"CMFCShellTreeCtrl::SelectPath"},{"pos":[8120,8244],"content":"Selects an item in the <bpt id=\"p1\">[</bpt>CMFCShellTreeCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfcshelltreectrl-class.md)</ept> based on the supplied path.","source":"Selects an item in the [CMFCShellTreeCtrl Class](../../mfc/reference/cmfcshelltreectrl-class.md) based on the supplied path."},{"content":"Parameters","pos":[8343,8353]},{"content":"[in]","pos":[8357,8361]},{"content":"A string that specifies the path of an item.","pos":[8376,8420]},{"content":"[in]","pos":[8427,8431]},{"content":"A PIDL that specifies the item","pos":[8443,8473]},{"content":"Return Value","pos":[8483,8495]},{"pos":[8506,8540],"content":"if successful; <ph id=\"ph1\">`E_FAIL`</ph> otherwise.","source":" if successful; `E_FAIL` otherwise."},{"pos":[8594,8621],"content":"CMFCShellTreeCtrl::SetFlags"},{"content":"Sets flags to filter the tree context.","pos":[8625,8663]},{"content":"Parameters","pos":[8751,8761]},{"content":"[in]","pos":[8765,8769]},{"content":"The flags to set.","pos":[8783,8800]},{"content":"[in]","pos":[8807,8811]},{"content":"A Boolean that specifies whether the <bpt id=\"p1\">[</bpt>CMFCShellTreeCtrl Class<ept id=\"p1\">](../../mfc/reference/cmfcshelltreectrl-class.md)</ept> should be refreshed immediately.","pos":[8826,8969],"source":" A Boolean that specifies whether the [CMFCShellTreeCtrl Class](../../mfc/reference/cmfcshelltreectrl-class.md) should be refreshed immediately."},{"content":"Remarks","pos":[8979,8986]},{"content":"The <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph> passes all set flags to <bpt id=\"p1\">[</bpt>IShellFolder::EnumObjects<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb775066)</ept>.","pos":[8990,9126],"source":"The `CMFCShellTreeCtrl` passes all set flags to [IShellFolder::EnumObjects](http://msdn.microsoft.com/library/windows/desktop/bb775066)."},{"content":"For more information about the values of different flags, see <bpt id=\"p1\">[</bpt>IShellFolder::EnumObjects<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb775066)</ept>.","pos":[9127,9277],"source":" For more information about the values of different flags, see [IShellFolder::EnumObjects](http://msdn.microsoft.com/library/windows/desktop/bb775066)."},{"pos":[9337,9370],"content":"CMFCShellTreeCtrl::SetRelatedList"},{"pos":[9374,9544],"content":"Associates a <bpt id=\"p1\">[</bpt>CMFCShellListCtrl<ept id=\"p1\">](../../mfc/reference/cmfcshelllistctrl-class.md)</ept> object with a <bpt id=\"p2\">[</bpt>CMFCShellTreeCtrl<ept id=\"p2\">](../../mfc/reference/cmfcshelltreectrl-class.md)</ept> object.","source":"Associates a [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object with a [CMFCShellTreeCtrl](../../mfc/reference/cmfcshelltreectrl-class.md) object."},{"content":"Parameters","pos":[9621,9631]},{"content":"[in]","pos":[9635,9639]},{"content":"A pointer to a <ph id=\"ph1\">`CMFCShellListCtrl`</ph> object.","pos":[9656,9698],"source":" A pointer to a `CMFCShellListCtrl` object."},{"content":"Remarks","pos":[9708,9715]},{"content":"This method associates a <ph id=\"ph1\">`CMFCShellListCtrl`</ph> with a <ph id=\"ph2\">`CMFCShellTreeCtrl`</ph>.","pos":[9719,9791],"source":"This method associates a `CMFCShellListCtrl` with a `CMFCShellTreeCtrl`."},{"content":"These objects may be displayed as an Explorer-like window: if the user selects an object in the <ph id=\"ph1\">`CMFCShellTreeCtrl`</ph>, the associated items in the <ph id=\"ph2\">`CMFCShellListCtrl`</ph> will be automatically updated.","pos":[9792,9987],"source":" These objects may be displayed as an Explorer-like window: if the user selects an object in the `CMFCShellTreeCtrl`, the associated items in the `CMFCShellListCtrl` will be automatically updated."},{"pos":[9994,10155],"content":"Use the method <bpt id=\"p1\">[</bpt>CMFCShellTreeCtrl::GetRelatedList<ept id=\"p1\">](#cmfcshelltreectrl__getrelatedlist)</ept> to retrieve the <ph id=\"ph1\">`CMFCShellListCtrl`</ph> associated with a <ph id=\"ph2\">`CMFCShellTreeCtrl`</ph>.","source":"Use the method [CMFCShellTreeCtrl::GetRelatedList](#cmfcshelltreectrl__getrelatedlist) to retrieve the `CMFCShellListCtrl` associated with a `CMFCShellTreeCtrl`."},{"content":"See Also","pos":[10164,10172]},{"content":"Hierarchy Chart","pos":[10177,10192]},{"content":"Classes","pos":[10229,10236]},{"content":"CTreeCtrl Class","pos":[10279,10294]},{"content":"CMFCShellListCtrl Class","pos":[10341,10364]}],"content":"---\ntitle: \"CMFCShellTreeCtrl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCShellTreeCtrl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCShellTreeCtrl class\"\nms.assetid: 3d1da715-9554-4ed7-968c-055c48146267\ncaps.latest.revision: 30\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCShellTreeCtrl Class\nThe `CMFCShellTreeCtrl` class extends [CTreeCtrl Class](../../mfc/reference/ctreectrl-class.md) functionality by displaying a hierarchy of Shell items.  \n  \n## Syntax  \n  \n```  \nclass CMFCShellTreeCtrl : public CTreeCtrl  \n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCShellTreeCtrl::EnableShellContextMenu](#cmfcshelltreectrl__enableshellcontextmenu)|Enables or disables the shortcut menu.|  \n|[CMFCShellTreeCtrl::GetFlags](#cmfcshelltreectrl__getflags)|Returns a combination of flags that are passed to [IShellFolder::EnumObjects](http://msdn.microsoft.com/library/windows/desktop/bb775066).|  \n|[CMFCShellTreeCtrl::GetItemPath](#cmfcshelltreectrl__getitempath)|Retrieves the path to an item.|  \n|[CMFCShellTreeCtrl::GetRelatedList](#cmfcshelltreectrl__getrelatedlist)|Returns a pointer to the [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object that is used together with this `CMFCShellTreeCtrl` object to create an Explorer-like window.|  \n|[CMFCShellTreeCtrl::OnChildNotify](#cmfcshelltreectrl__onchildnotify)|This member function is called by this window's parent window when it receives a notification message that applies to this window. (Overrides [CWnd::OnChildNotify](../../mfc/reference/cwnd-class.md#cwnd__onchildnotify).)|  \n|[CMFCShellTreeCtrl::OnGetItemIcon](#cmfcshelltreectrl__ongetitemicon)||  \n|[CMFCShellTreeCtrl::OnGetItemText](#cmfcshelltreectrl__ongetitemtext)||  \n|[CMFCShellTreeCtrl::Refresh](#cmfcshelltreectrl__refresh)|Refreshes and repaints the current `CMFCShellTreeCtrl` object.|  \n|[CMFCShellTreeCtrl::SelectPath](#cmfcshelltreectrl__selectpath)|Selects the appropriate tree control item based on a supplied PIDL or string path.|  \n|[CMFCShellTreeCtrl::SetFlags](#cmfcshelltreectrl__setflags)|Sets flags to filter the tree context (similar to the flags used by `IShellFolder::EnumObjects`).|  \n|[CMFCShellTreeCtrl::SetRelatedList](#cmfcshelltreectrl__setrelatedlist)|Sets a relation between the current `CMFCShellTreeCtrl` object and a `CMFCShellListCtrl` object.|  \n  \n## Remarks  \n This class extends the `CTreeCtrl` class by enabling your program to include Windows Shell items in the tree. This class can be associated with a `CMFCShellListCtrl` object to create a complete Explorer window. Then, selecting an item in the tree will display a list of Windows Shell items in the associated list.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CTreeCtrl](../../mfc/reference/ctreectrl-class.md)  \n  \n [CMFCShellTreeCtrl](../../mfc/reference/cmfcshelltreectrl-class.md)  \n  \n## Requirements  \n **Header:** afxshelltreeCtrl.h  \n  \n## Example  \n The following example demonstrates how to create an object of the `CMFCShellTreeCtrl` class. This code snippet is part of the [Explorer sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_Explorer#4](../../mfc/reference/codesnippet/cpp/cmfcshelltreectrl-class_1.h)]  \n[!code-cpp[NVC_MFC_Explorer#5](../../mfc/reference/codesnippet/cpp/cmfcshelltreectrl-class_2.cpp)]  \n  \n##  <a name=\"cmfcshelltreectrl__enableshellcontextmenu\"></a>  CMFCShellTreeCtrl::EnableShellContextMenu  \n Enables the shortcut menu.  \n  \n```  \nvoid EnableShellContextMenu(BOOL bEnable = TRUE);\n```  \n  \n### Parameters  \n [in] `bEnable`  \n A Boolean that specifies whether to enable the shortcut menu.  \n  \n##  <a name=\"cmfcshelltreectrl__getflags\"></a>  CMFCShellTreeCtrl::GetFlags  \n Returns the flags set for the [CMFCShellTreeCtrl Class](../../mfc/reference/cmfcshelltreectrl-class.md) object.  \n  \n```  \nDWORD GetFlags() const;\n\n \n```  \n  \n### Return Value  \n A `DWORD` value that specifies the combination of flags currently set.  \n  \n### Remarks  \n The flags set in the `CMFCShellTreeCtrl` are sent to the method [IShellFolder::EnumObjects](http://msdn.microsoft.com/library/windows/desktop/bb775066) whenever the object is refreshed. You can change the flags with the [CMFCShellTreeCtrl::SetFlags](#cmfcshelltreectrl__setflags) method.  \n  \n##  <a name=\"cmfcshelltreectrl__getitempath\"></a>  CMFCShellTreeCtrl::GetItemPath  \n Retrieves the path of an item in the [CMFCShellTreeCtrl Class](../../mfc/reference/cmfcshelltreectrl-class.md) object.  \n  \n```  \nBOOL GetItemPath(\n    CString& strPath,  \n    HTREEITEM htreeItem = NULL) const;\n\n \n```  \n  \n### Parameters  \n [out] `strPath`  \n A reference to a string parameter. The method writes the path of the item to this parameter.  \n  \n [in] `htreeItem`  \n The method retrieves the path for this tree control item.  \n  \n### Return Value  \n Nonzero if successful; 0 otherwise.  \n  \n### Remarks  \n If this method fails, `strPath` contains the empty string.  \n  \n If you do not specify `hTreeItem`, this method tries to obtain the string for the currently selected item. If no item is selected and `hTreeItem` is `NULL`, this method fails.  \n  \n##  <a name=\"cmfcshelltreectrl__getrelatedlist\"></a>  CMFCShellTreeCtrl::GetRelatedList  \n Returns a pointer to the [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md) object that is associated with this [CMFCShellTreeCtrl](../../mfc/reference/cmfcshelltreectrl-class.md) object.  \n  \n```  \nCMFCShellListCtrl* GetRelatedList() const;\n\n \n```  \n  \n### Return Value  \n A pointer to the `CMFCShellListCtrl` object that is associated with this tree control object.  \n  \n### Remarks  \n By using a `CMFCShellListCtrl` object together with a `CMFCShellTreeCtrl` object, you can create an Explorer-like window. Use the method [CMFCShellTreeCtrl::SetRelatedList](#cmfcshelltreectrl__setrelatedlist) to associate the two classes. After they are associated, the framework automatically updates the `CMFCShellListCtrl` if the selection in the `CMFCShellTreeCtrl` changes.  \n  \n##  <a name=\"cmfcshelltreectrl__onchildnotify\"></a>  CMFCShellTreeCtrl::OnChildNotify  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual BOOL OnChildNotify(\n    UINT message,  \n    WPARAM wParam,  \n    LPARAM lParam,  \n    LRESULT* pLResult);\n```  \n  \n### Parameters  \n [in] `message`  \n [in] `wParam`  \n [in] `lParam`  \n [in] `pLResult`  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcshelltreectrl__ongetitemicon\"></a>  CMFCShellTreeCtrl::OnGetItemIcon  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual int OnGetItemIcon(\n    LPAFX_SHELLITEMINFO pItem,  \n    BOOL bSelected);\n```  \n  \n### Parameters  \n [in] `pItem`  \n [in] `bSelected`  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcshelltreectrl__ongetitemtext\"></a>  CMFCShellTreeCtrl::OnGetItemText  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual CString OnGetItemText(LPAFX_SHELLITEMINFO pItem);\n```  \n  \n### Parameters  \n [in] `pItem`  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cmfcshelltreectrl__refresh\"></a>  CMFCShellTreeCtrl::Refresh  \n Refreshes and repaints the [CMFCShellTreeCtrl](../../mfc/reference/cmfcshelltreectrl-class.md).  \n  \n```  \nvoid Refresh();\n```  \n  \n### Remarks  \n Call this method to refresh the hierarchy of the items displayed in the `CMFCShellTreeCtrl`.  \n  \n##  <a name=\"cmfcshelltreectrl__selectpath\"></a>  CMFCShellTreeCtrl::SelectPath  \n Selects an item in the [CMFCShellTreeCtrl Class](../../mfc/reference/cmfcshelltreectrl-class.md) based on the supplied path.  \n  \n```  \nBOOL SelectPath(LPCTSTR lpszPath);\n\nBOOL SelectPath(LPCITEMIDLIST lpidl);\n```  \n  \n### Parameters  \n [in] `lpszPath`  \n A string that specifies the path of an item.  \n  \n [in] `lpidl`  \n A PIDL that specifies the item  \n  \n### Return Value  \n `S_OK` if successful; `E_FAIL` otherwise.  \n  \n##  <a name=\"cmfcshelltreectrl__setflags\"></a>  CMFCShellTreeCtrl::SetFlags  \n Sets flags to filter the tree context.  \n  \n```  \nvoid SetFlags(\n    DWORD dwFlags,  \n    BOOL bRefresh = TRUE);\n```  \n  \n### Parameters  \n [in] `dwFlags`  \n The flags to set.  \n  \n [in] `bRefresh`  \n A Boolean that specifies whether the [CMFCShellTreeCtrl Class](../../mfc/reference/cmfcshelltreectrl-class.md) should be refreshed immediately.  \n  \n### Remarks  \n The `CMFCShellTreeCtrl` passes all set flags to [IShellFolder::EnumObjects](http://msdn.microsoft.com/library/windows/desktop/bb775066). For more information about the values of different flags, see [IShellFolder::EnumObjects](http://msdn.microsoft.com/library/windows/desktop/bb775066).  \n  \n##  <a name=\"cmfcshelltreectrl__setrelatedlist\"></a>  CMFCShellTreeCtrl::SetRelatedList  \n Associates a [CMFCShellListCtrl](../../mfc/reference/cmfcshelllistctrl-class.md) object with a [CMFCShellTreeCtrl](../../mfc/reference/cmfcshelltreectrl-class.md) object.  \n  \n```  \nvoid SetRelatedList(CMFCShellListCtrl* pShellList);\n```  \n  \n### Parameters  \n [in] `pShellList`  \n A pointer to a `CMFCShellListCtrl` object.  \n  \n### Remarks  \n This method associates a `CMFCShellListCtrl` with a `CMFCShellTreeCtrl`. These objects may be displayed as an Explorer-like window: if the user selects an object in the `CMFCShellTreeCtrl`, the associated items in the `CMFCShellListCtrl` will be automatically updated.  \n  \n Use the method [CMFCShellTreeCtrl::GetRelatedList](#cmfcshelltreectrl__getrelatedlist) to retrieve the `CMFCShellListCtrl` associated with a `CMFCShellTreeCtrl`.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CTreeCtrl Class](../../mfc/reference/ctreectrl-class.md)   \n [CMFCShellListCtrl Class](../../mfc/reference/cmfcshelllistctrl-class.md)\n"}