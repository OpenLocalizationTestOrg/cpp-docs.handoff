{"nodes":[{"pos":[12,41],"content":"aggregatable | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"aggregatable | Microsoft Docs","pos":[0,29]}]},{"content":"aggregatable","pos":[625,637]},{"content":"Indicates that the class supports aggregation.","pos":[638,684]},{"content":"Syntax","pos":[693,699]},{"content":"Parameters","pos":[770,780]},{"content":"<bpt id=\"p1\">*</bpt>value<ept id=\"p1\">*</ept> (optional)","pos":[784,802],"source":"*value* (optional)"},{"content":"A parameter to indicate when the COM object can be aggregated:","pos":[806,868]},{"pos":[878,924],"content":"<bpt id=\"p1\">**</bpt>never<ept id=\"p1\">**</ept> The COM object cannot be aggregated.","source":"**never** The COM object cannot be aggregated."},{"content":"<bpt id=\"p1\">**</bpt>allowed<ept id=\"p1\">**</ept> The COM object can be created directly or it can be aggregated.","pos":[934,1009],"source":"**allowed** The COM object can be created directly or it can be aggregated."},{"content":"This is the default.","pos":[1010,1030]},{"content":"<bpt id=\"p1\">**</bpt>always<ept id=\"p1\">**</ept> The COM object cannot be created directly and can only be aggregated.","pos":[1040,1120],"source":"**always** The COM object cannot be created directly and can only be aggregated."},{"content":"When you call <ph id=\"ph1\">`CoCreateInstance`</ph> for this object, you must specify the aggregating object's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface (the controlling <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept>).","pos":[1121,1267],"source":" When you call `CoCreateInstance` for this object, you must specify the aggregating object's **IUnknown** interface (the controlling **IUnknown**)."},{"content":"Remarks","pos":[1276,1283]},{"content":"The <bpt id=\"p1\">**</bpt>aggregatable<ept id=\"p1\">**</ept> C++ attribute has the same functionality as the <bpt id=\"p2\">[</bpt>aggregatable<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/aa366721)</ept> MIDL attribute.","pos":[1287,1446],"source":"The **aggregatable** C++ attribute has the same functionality as the [aggregatable](http://msdn.microsoft.com/library/windows/desktop/aa366721) MIDL attribute."},{"content":"This means that the compiler will pass the <bpt id=\"p1\">**</bpt>aggregatable<ept id=\"p1\">**</ept> attribute through to the generated .idl file.","pos":[1447,1552],"source":" This means that the compiler will pass the **aggregatable** attribute through to the generated .idl file."},{"content":"This attribute requires that the <bpt id=\"p1\">[</bpt>coclass<ept id=\"p1\">](../windows/coclass.md)</ept>, <bpt id=\"p2\">[</bpt>progid<ept id=\"p2\">](../windows/progid.md)</ept>, or <bpt id=\"p3\">[</bpt>vi_progid<ept id=\"p3\">](../windows/vi-progid.md)</ept> attribute (or another attribute that implies one of these) also be applied to the same element.","pos":[1559,1793],"source":"This attribute requires that the [coclass](../windows/coclass.md), [progid](../windows/progid.md), or [vi_progid](../windows/vi-progid.md) attribute (or another attribute that implies one of these) also be applied to the same element."},{"content":"If any single attribute is used, the other two are automatically applied.","pos":[1794,1867]},{"content":"For example, if <bpt id=\"p1\">**</bpt>progid<ept id=\"p1\">**</ept> is applied, <bpt id=\"p2\">**</bpt>vi_progid<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>coclass<ept id=\"p3\">**</ept> are also applied.","pos":[1868,1954],"source":" For example, if **progid** is applied, **vi_progid** and **coclass** are also applied."},{"content":"ATL Projects","pos":[1963,1975]},{"content":"If this attribute is used within a project that uses ATL, the behavior of the attribute changes.","pos":[1984,2080]},{"content":"In addition to the previously described behavior, the attribute also adds one of the following macros to the target class:","pos":[2081,2203]},{"content":"Parameter value","pos":[2210,2225]},{"content":"Inserted macro","pos":[2226,2240]},{"content":"Never","pos":[2294,2299]},{"content":"DECLARE_NOT_AGGREGATABLE","pos":[2303,2327]},{"content":"Allowed","pos":[2407,2414]},{"content":"DECLARE_POLY_AGGREGATABLE","pos":[2418,2443]},{"content":"Always","pos":[2523,2529]},{"content":"DECLARE_ONLY_AGGREGATABLE","pos":[2533,2558]},{"content":"Example","pos":[2641,2648]},{"content":"Requirements","pos":[2943,2955]},{"content":"Attribute Context","pos":[2965,2982]},{"content":"Applies to","pos":[3005,3015]},{"pos":[3018,3028],"content":"<bpt id=\"p1\">**</bpt>class<ept id=\"p1\">**</ept>,","source":"**class**, "},{"content":"Repeatable","pos":[3044,3054]},{"content":"No","pos":[3057,3059]},{"content":"Required attributes","pos":[3066,3085]},{"pos":[3088,3160],"content":"One or more of the following: <bpt id=\"p1\">**</bpt>coclass<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>progid<ept id=\"p2\">**</ept>, or <bpt id=\"p3\">**</bpt>vi_progid<ept id=\"p3\">**</ept>.","source":"One or more of the following: **coclass**, **progid**, or **vi_progid**."},{"content":"Invalid attributes","pos":[3167,3185]},{"content":"None","pos":[3188,3192]},{"pos":[3200,3310],"content":"For more information about the attribute contexts, see <bpt id=\"p1\">[</bpt>Attribute Contexts<ept id=\"p1\">](../windows/attribute-contexts.md)</ept>.","source":"For more information about the attribute contexts, see [Attribute Contexts](../windows/attribute-contexts.md)."},{"content":"See Also","pos":[3319,3327]},{"content":"IDL Attributes","pos":[3332,3346]},{"content":"Class Attributes","pos":[3383,3399]},{"content":"Typedef, Enum, Union, and Struct Attributes","pos":[3438,3481]},{"content":"Aggregation","pos":[3544,3555]},{"content":"Attributes Samples","pos":[3622,3640]}],"content":"---\ntitle: \"aggregatable | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\nf1_keywords: \n  - \"vc-attr.aggregatable\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"aggregatable attribute\"\nms.assetid: 9253a46a-cd76-41f2-b3b6-86f709bb069c\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# aggregatable\nIndicates that the class supports aggregation.  \n  \n## Syntax  \n  \n```  \n  \n      [ aggregatable(   \n   value  \n) ]  \n```  \n  \n#### Parameters  \n *value* (optional)  \n A parameter to indicate when the COM object can be aggregated:  \n  \n-   **never** The COM object cannot be aggregated.  \n  \n-   **allowed** The COM object can be created directly or it can be aggregated. This is the default.  \n  \n-   **always** The COM object cannot be created directly and can only be aggregated. When you call `CoCreateInstance` for this object, you must specify the aggregating object's **IUnknown** interface (the controlling **IUnknown**).  \n  \n## Remarks  \n The **aggregatable** C++ attribute has the same functionality as the [aggregatable](http://msdn.microsoft.com/library/windows/desktop/aa366721) MIDL attribute. This means that the compiler will pass the **aggregatable** attribute through to the generated .idl file.  \n  \n This attribute requires that the [coclass](../windows/coclass.md), [progid](../windows/progid.md), or [vi_progid](../windows/vi-progid.md) attribute (or another attribute that implies one of these) also be applied to the same element. If any single attribute is used, the other two are automatically applied. For example, if **progid** is applied, **vi_progid** and **coclass** are also applied.  \n  \n **ATL Projects**  \n  \n If this attribute is used within a project that uses ATL, the behavior of the attribute changes. In addition to the previously described behavior, the attribute also adds one of the following macros to the target class:  \n  \n|Parameter value|Inserted macro|  \n|---------------------|--------------------|  \n|**Never**|[DECLARE_NOT_AGGREGATABLE](http://msdn.microsoft.com/Library/2a116c7c-bab8-4f2a-a9ad-03d7aba0f762)|  \n|**Allowed**|[DECLARE_POLY_AGGREGATABLE](http://msdn.microsoft.com/Library/7569e738-cfbc-4404-ba1d-78dcefa3bdb3)|  \n|**Always**|[DECLARE_ONLY_AGGREGATABLE](http://msdn.microsoft.com/Library/a54220df-4330-4e4d-b7fb-8b63dd62d337)|  \n  \n## Example  \n  \n```  \n// cpp_attr_ref_aggregatable.cpp  \n// compile with: /LD  \n#define _ATL_ATTRIBUTES  \n#include \"atlbase.h\"  \n#include \"atlcom.h\"  \n  \n[module(name=\"MyModule\")];  \n  \n[ coclass, aggregatable(allowed),  \n  uuid(\"1a8369cc-1c91-42c4-befa-5a5d8c9d2529\")]  \nclass CMyClass {};  \n```  \n  \n## Requirements  \n  \n### Attribute Context  \n  \n|||  \n|-|-|  \n|**Applies to**|**class**, `struct`|  \n|**Repeatable**|No|  \n|**Required attributes**|One or more of the following: **coclass**, **progid**, or **vi_progid**.|  \n|**Invalid attributes**|None|  \n  \n For more information about the attribute contexts, see [Attribute Contexts](../windows/attribute-contexts.md).  \n  \n## See Also  \n [IDL Attributes](../windows/idl-attributes.md)   \n [Class Attributes](../windows/class-attributes.md)   \n [Typedef, Enum, Union, and Struct Attributes](../windows/typedef-enum-union-and-struct-attributes.md)   \n [Aggregation](http://msdn.microsoft.com/library/windows/desktop/ms686558)   \n [Attributes Samples](http://msdn.microsoft.com/en-us/558ebdb2-082f-44dc-b442-d8d33bf7bdb8)"}