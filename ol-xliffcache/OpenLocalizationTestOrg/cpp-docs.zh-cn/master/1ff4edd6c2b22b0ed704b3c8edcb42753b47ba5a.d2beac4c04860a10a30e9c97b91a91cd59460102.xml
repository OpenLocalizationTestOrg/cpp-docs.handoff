{"nodes":[{"pos":[12,53],"content":"CMFCEditBrowseCtrl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCEditBrowseCtrl Class | Microsoft Docs","pos":[0,41]}]},{"content":"CMFCEditBrowseCtrl Class","pos":[718,742]},{"content":"The <ph id=\"ph1\">`CMFCEditBrowseCtrl`</ph> class supports the edit browse control, which is an editable text box that optionally contains a browse button.","pos":[743,879],"source":"The `CMFCEditBrowseCtrl` class supports the edit browse control, which is an editable text box that optionally contains a browse button."},{"content":"When the user clicks the browse button, the control performs a custom action or displays a standard dialog box that contains a file browser or a folder browser.","pos":[880,1040]},{"content":"Syntax","pos":[1049,1055]},{"content":"Members","pos":[1121,1128]},{"content":"Public Constructors","pos":[1138,1157]},{"content":"Name","pos":[1164,1168]},{"content":"Description","pos":[1169,1180]},{"content":"Default constructor.","pos":[1259,1279]},{"content":"Destructor.","pos":[1326,1337]},{"content":"Public Methods","pos":[1348,1362]},{"content":"Name","pos":[1369,1373]},{"content":"Description","pos":[1374,1385]},{"content":"CMFCEditBrowseCtrl::EnableBrowseButton","pos":[1424,1462]},{"content":"Enables or disables (hides) the browse button.","pos":[1505,1551]},{"content":"CMFCEditBrowseCtrl::EnableFileBrowseButton","pos":[1557,1599]},{"pos":[1646,1727],"content":"Enables the browse button and puts the edit browse control in <bpt id=\"p1\">*</bpt>file browse<ept id=\"p1\">*</ept> mode.","source":"Enables the browse button and puts the edit browse control in *file browse* mode."},{"content":"CMFCEditBrowseCtrl::EnableFolderBrowseButton","pos":[1733,1777]},{"pos":[1826,1909],"content":"Enables the browse button and puts the edit browse control in <bpt id=\"p1\">*</bpt>folder browse<ept id=\"p1\">*</ept> mode.","source":"Enables the browse button and puts the edit browse control in *folder browse* mode."},{"content":"CMFCEditBrowseCtrl::GetMode","pos":[1915,1942]},{"content":"Returns the current browse mode.","pos":[1974,2006]},{"content":"CMFCEditBrowseCtrl::OnAfterUpdate","pos":[2012,2045]},{"content":"Called by the framework after the edit browse control is updated with the result of a browse action.","pos":[2083,2183]},{"content":"CMFCEditBrowseCtrl::OnBrowse","pos":[2189,2217]},{"content":"Called by the framework after the user clicks the browse button.","pos":[2250,2314]},{"content":"CMFCEditBrowseCtrl::OnChangeLayout","pos":[2320,2354]},{"content":"Redraws the current edit browse control.","pos":[2393,2433]},{"content":"CMFCEditBrowseCtrl::OnDrawBrowseButton","pos":[2439,2477]},{"content":"Called by the framework to draw the browse button.","pos":[2520,2570]},{"content":"CMFCEditBrowseCtrl::OnIllegalFileName","pos":[2576,2613]},{"content":"Called by the framework when an illegal file name was entered in the edit control.","pos":[2655,2737]},{"content":"Translates window messages before they are dispatched to the <bpt id=\"p1\">[</bpt>TranslateMessage<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms644955)</ept> and <bpt id=\"p2\">[</bpt>DispatchMessage<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms644934)</ept> Windows functions.","pos":[2784,3024],"source":"Translates window messages before they are dispatched to the [TranslateMessage](http://msdn.microsoft.com/library/windows/desktop/ms644955) and [DispatchMessage](http://msdn.microsoft.com/library/windows/desktop/ms644934) Windows functions."},{"content":"For syntax and more information, see <bpt id=\"p1\">[</bpt>CWnd::PreTranslateMessage<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__pretranslatemessage)</ept>.","pos":[3025,3151],"source":" For syntax and more information, see [CWnd::PreTranslateMessage](../../mfc/reference/cwnd-class.md#cwnd__pretranslatemessage)."},{"content":"CMFCEditBrowseCtrl::SetBrowseButtonImage","pos":[3157,3197]},{"content":"Sets a custom image for the browse button.","pos":[3242,3284]},{"content":"Remarks","pos":[3294,3301]},{"content":"Use an edit browse control to select a file or folder name.","pos":[3305,3364]},{"content":"Optionally, use the control to perform a custom action such as to display a dialog box.","pos":[3365,3452]},{"content":"You can display or not display the browse button, and you can apply a custom label or image on the button.","pos":[3453,3559]},{"content":"The <bpt id=\"p1\">*</bpt>browse mode<ept id=\"p1\">*</ept> of the edit browse control determines whether it displays a browse button and what action occurs when the button is clicked.","pos":[3566,3708],"source":"The *browse mode* of the edit browse control determines whether it displays a browse button and what action occurs when the button is clicked."},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>GetMode<ept id=\"p1\">](#cmfceditbrowsectrl__getmode)</ept> method.","pos":[3709,3786],"source":" For more information, see the [GetMode](#cmfceditbrowsectrl__getmode) method."},{"pos":[3793,3853],"content":"The <ph id=\"ph1\">`CMFCEditBrowseCtrl`</ph> class supports the following modes.","source":"The `CMFCEditBrowseCtrl` class supports the following modes."},{"content":"A custom action is performed when the user clicks the browse button.","pos":[3877,3945]},{"content":"For example, you can display an application-specific dialog box.","pos":[3946,4010]},{"content":"A standard file selection dialog box is displayed when the user clicks the browse button.","pos":[4032,4121]},{"content":"A standard folder selection dialog box is displayed when the user clicks the browse button.","pos":[4145,4236]},{"content":"How-To: Specify an Edit Browse Control","pos":[4245,4283]},{"content":"Perform the following steps to incorporate an edit browse control in your application:","pos":[4287,4373]},{"content":"If you want to implement a custom browse mode, derive your own class from the <ph id=\"ph1\">`CMFCEditBrowseCtrl`</ph> class and then override the <bpt id=\"p1\">[</bpt>CMFCEditBrowseCtrl::OnBrowse<ept id=\"p1\">](#cmfceditbrowsectrl__onbrowse)</ept> method.","pos":[4383,4579],"source":"If you want to implement a custom browse mode, derive your own class from the `CMFCEditBrowseCtrl` class and then override the [CMFCEditBrowseCtrl::OnBrowse](#cmfceditbrowsectrl__onbrowse) method."},{"content":"In the overridden method, execute a custom browse action and update the edit browse control with the result.","pos":[4580,4688]},{"pos":[4698,4815],"content":"Embed either the <ph id=\"ph1\">`CMFCEditBrowseCtrl`</ph> object or the derived edit browse control object into the parent window object.","source":"Embed either the `CMFCEditBrowseCtrl` object or the derived edit browse control object into the parent window object."},{"content":"If you use the <bpt id=\"p1\">**</bpt>Class Wizard<ept id=\"p1\">**</ept> to create a dialog box, add an edit control ( <ph id=\"ph1\">`CEdit`</ph>) to the dialog box form.","pos":[4825,4935],"source":"If you use the **Class Wizard** to create a dialog box, add an edit control ( `CEdit`) to the dialog box form."},{"content":"Also, add a variable to access the control in your header file.","pos":[4936,4999]},{"content":"In your header file, change the type of the variable from <ph id=\"ph1\">`CEdit`</ph> to <ph id=\"ph2\">`CMFCEditBrowseCtrl`</ph>.","pos":[5000,5090],"source":" In your header file, change the type of the variable from `CEdit` to `CMFCEditBrowseCtrl`."},{"content":"The edit browse control will be created automatically.","pos":[5091,5145]},{"content":"If you do not use the <bpt id=\"p1\">**</bpt>Class Wizard<ept id=\"p1\">**</ept>, add a <ph id=\"ph1\">`CMFCEditBrowseCtrl`</ph> variable to your header file and then call its <ph id=\"ph2\">`Create`</ph> method.","pos":[5146,5276],"source":" If you do not use the **Class Wizard**, add a `CMFCEditBrowseCtrl` variable to your header file and then call its `Create` method."},{"pos":[5286,5390],"content":"If you add an edit browse control to a dialog box, use the <bpt id=\"p1\">**</bpt>ClassWizard<ept id=\"p1\">**</ept> tool to set up data exchange.","source":"If you add an edit browse control to a dialog box, use the **ClassWizard** tool to set up data exchange."},{"content":"Call the <bpt id=\"p1\">[</bpt>EnableFolderBrowseButton<ept id=\"p1\">](#cmfceditbrowsectrl__enablefolderbrowsebutton)</ept>, <bpt id=\"p2\">[</bpt>EnableFileBrowseButton<ept id=\"p2\">](#cmfceditbrowsectrl__enablefilebrowsebutton)</ept>, or <bpt id=\"p3\">[</bpt>EnableBrowseButton<ept id=\"p3\">](#cmfceditbrowsectrl__enablebrowsebutton)</ept> method to set the browse mode and display the browse button.","pos":[5400,5680],"source":"Call the [EnableFolderBrowseButton](#cmfceditbrowsectrl__enablefolderbrowsebutton), [EnableFileBrowseButton](#cmfceditbrowsectrl__enablefilebrowsebutton), or [EnableBrowseButton](#cmfceditbrowsectrl__enablebrowsebutton) method to set the browse mode and display the browse button."},{"content":"Call the <bpt id=\"p1\">[</bpt>GetMode<ept id=\"p1\">](#cmfceditbrowsectrl__getmode)</ept> method to obtain the current browse mode.","pos":[5681,5771],"source":" Call the [GetMode](#cmfceditbrowsectrl__getmode) method to obtain the current browse mode."},{"pos":[5781,5997],"content":"To provide a custom image for the browse button, call the <bpt id=\"p1\">[</bpt>SetBrowseButtonImage<ept id=\"p1\">](#cmfceditbrowsectrl__setbrowsebuttonimage)</ept> method or override the <bpt id=\"p2\">[</bpt>OnDrawBrowseButton<ept id=\"p2\">](#cmfceditbrowsectrl__ondrawbrowsebutton)</ept> method.","source":"To provide a custom image for the browse button, call the [SetBrowseButtonImage](#cmfceditbrowsectrl__setbrowsebuttonimage) method or override the [OnDrawBrowseButton](#cmfceditbrowsectrl__ondrawbrowsebutton) method."},{"pos":[6007,6187],"content":"To remove the browse button from the edit browse control, call the <bpt id=\"p1\">[</bpt>EnableBrowseButton<ept id=\"p1\">](#cmfceditbrowsectrl__enablebrowsebutton)</ept> method with the <ph id=\"ph1\">`bEnable`</ph> parameter set to <ph id=\"ph2\">`FALSE`</ph>.","source":"To remove the browse button from the edit browse control, call the [EnableBrowseButton](#cmfceditbrowsectrl__enablebrowsebutton) method with the `bEnable` parameter set to `FALSE`."},{"content":"Inheritance Hierarchy","pos":[6196,6217]},{"content":"CObject","pos":[6222,6229]},{"content":"CCmdTarget","pos":[6276,6286]},{"content":"CWnd","pos":[6336,6340]},{"content":"CEdit","pos":[6384,6389]},{"content":"CMFCEditBrowseCtrl","pos":[6434,6452]},{"content":"Example","pos":[6511,6518]},{"content":"The following example demonstrates how to use two methods in the <ph id=\"ph1\">`CMFCEditBrowseCtrl`</ph> class: <ph id=\"ph2\">`EnableFolderBrowseButton`</ph> and <ph id=\"ph3\">`EnableFileBrowseButton`</ph>.","pos":[6522,6671],"source":"The following example demonstrates how to use two methods in the `CMFCEditBrowseCtrl` class: `EnableFolderBrowseButton` and `EnableFileBrowseButton`."},{"content":"This example is part of the <bpt id=\"p1\">[</bpt>New Controls sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[6672,6751],"source":" This example is part of the [New Controls sample](../../visual-cpp-samples.md)."},{"content":"NVC_MFC_NewControls#6","pos":[6769,6790]},{"content":"NVC_MFC_NewControls#7","pos":[6872,6893]},{"content":"Requirements","pos":[6972,6984]},{"pos":[6988,7019],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxeditbrowsectrl.h","source":"**Header:** afxeditbrowsectrl.h"},{"pos":[7084,7122],"content":"CMFCEditBrowseCtrl::EnableBrowseButton"},{"content":"Displays or does not display the browse button on the current edit browse control.","pos":[7126,7208]},{"content":"Parameters","pos":[7315,7325]},{"content":"to display the browse button; <ph id=\"ph1\">`FALSE`</ph> not to display the browse button.","pos":[7349,7420],"source":" to display the browse button; `FALSE` not to display the browse button."},{"content":"The default value is <ph id=\"ph1\">`TRUE`</ph>.","pos":[7421,7449],"source":" The default value is `TRUE`."},{"content":"The label that is displayed on the browse button.","pos":[7469,7518]},{"content":"The default value is \" <bpt id=\"p1\">**</bpt>...<ept id=\"p1\">**</ept>\".","pos":[7519,7551],"source":" The default value is \" **...**\"."},{"content":"Remarks","pos":[7561,7568]},{"content":"If the <ph id=\"ph1\">`bEnable`</ph> parameter is <ph id=\"ph2\">`TRUE`</ph>, implement a custom action to perform when the browse button is clicked.","pos":[7572,7681],"source":"If the `bEnable` parameter is `TRUE`, implement a custom action to perform when the browse button is clicked."},{"content":"To implement a custom action, derive a class from the <ph id=\"ph1\">`CMFCEditBrowseCtrl`</ph> class and then override its <bpt id=\"p1\">[</bpt>OnBrowse<ept id=\"p1\">](#cmfceditbrowsectrl__onbrowse)</ept> method.","pos":[7682,7834],"source":" To implement a custom action, derive a class from the `CMFCEditBrowseCtrl` class and then override its [OnBrowse](#cmfceditbrowsectrl__onbrowse) method."},{"content":"If the <ph id=\"ph1\">`bEnable`</ph> parameter is <ph id=\"ph2\">`TRUE`</ph>, the browse mode of the control is <ph id=\"ph3\">`BrowseMode_Default`</ph>; otherwise, the browse mode is <ph id=\"ph4\">`BrowseMode_None`</ph>.","pos":[7841,7983],"source":"If the `bEnable` parameter is `TRUE`, the browse mode of the control is `BrowseMode_Default`; otherwise, the browse mode is `BrowseMode_None`."},{"content":"For more information about browse modes, see the <bpt id=\"p1\">[</bpt>GetMode<ept id=\"p1\">](#cmfceditbrowsectrl__getmode)</ept> method.","pos":[7984,8080],"source":" For more information about browse modes, see the [GetMode](#cmfceditbrowsectrl__getmode) method."},{"pos":[8149,8191],"content":"CMFCEditBrowseCtrl::EnableFileBrowseButton"},{"pos":[8195,8300],"content":"Displays the browse button on the current edit browse control and puts the control in <bpt id=\"p1\">*</bpt>file browse<ept id=\"p1\">*</ept> mode.","source":"Displays the browse button on the current edit browse control and puts the control in *file browse* mode."},{"content":"Parameters","pos":[8477,8487]},{"content":"Specifies the default file name extension that is used in the file selection dialog box.","pos":[8507,8595]},{"content":"The default value is <ph id=\"ph1\">`NULL`</ph>.","pos":[8596,8624],"source":" The default value is `NULL`."},{"content":"Specifies the default filter string that is used in the file selection dialog box.","pos":[8647,8729]},{"content":"The default value is <ph id=\"ph1\">`NULL`</ph>.","pos":[8730,8758],"source":" The default value is `NULL`."},{"content":"Dialog box flags.","pos":[8778,8795]},{"content":"The default value is a bitwise combination (OR) of OFN_HIDEREADONLY and OFN_OVERWRITEPROMPT.","pos":[8796,8888]},{"content":"Remarks","pos":[8898,8905]},{"content":"When the edit browse control is in file browse mode and the user clicks the browse button, the control displays the standard file selection dialog box.","pos":[8909,9060]},{"pos":[9067,9182],"content":"For a full list of available flags, see <bpt id=\"p1\">[</bpt>OPENFILENAME structure<ept id=\"p1\">](https://msdn.microsoft.com/library/ms646839.aspx)</ept>.","source":"For a full list of available flags, see [OPENFILENAME structure](https://msdn.microsoft.com/library/ms646839.aspx)."},{"pos":[9253,9297],"content":"CMFCEditBrowseCtrl::EnableFolderBrowseButton"},{"pos":[9301,9408],"content":"Displays the browse button on the current edit browse control and puts the control in <bpt id=\"p1\">*</bpt>folder browse<ept id=\"p1\">*</ept> mode.","source":"Displays the browse button on the current edit browse control and puts the control in *folder browse* mode."},{"content":"Remarks","pos":[9466,9473]},{"content":"When the edit browse control is in folder browse mode and the user clicks the browse button, the control displays the standard folder selection dialog box.","pos":[9477,9632]},{"pos":[9686,9713],"content":"CMFCEditBrowseCtrl::GetMode"},{"content":"Retrieves the browse mode of the current edit browse control.","pos":[9717,9778]},{"content":"Return Value","pos":[9854,9866]},{"content":"One of the enumeration values that specifies the current mode of the edit browse control.","pos":[9870,9959]},{"content":"The browse mode determines whether the framework displays the browse button and what action occurs when a user clicks that button.","pos":[9960,10090]},{"content":"The following table lists the possible return values.","pos":[10097,10150]},{"content":"Value","pos":[10157,10162]},{"content":"Description","pos":[10163,10174]},{"content":".","pos":[10247,10248]},{"content":"A programmer-defined action is performed.","pos":[10249,10290]},{"content":".","pos":[10324,10325]},{"content":"The standard file browser dialog box is displayed.","pos":[10326,10376]},{"content":".","pos":[10414,10415]},{"content":"The standard folder browser dialog box is displayed.","pos":[10416,10468]},{"content":"The browse button is not displayed.","pos":[10491,10526]},{"content":"Remarks","pos":[10537,10544]},{"content":"By default, a <ph id=\"ph1\">`CMFCEditBrowseCtrl`</ph> object is initialized to <ph id=\"ph2\">`BrowseMode_None`</ph> mode.","pos":[10548,10631],"source":"By default, a `CMFCEditBrowseCtrl` object is initialized to `BrowseMode_None` mode."},{"content":"Modify the browse mode with the <bpt id=\"p1\">[</bpt>CMFCEditBrowseCtrl::EnableBrowseButton<ept id=\"p1\">](#cmfceditbrowsectrl__enablebrowsebutton)</ept>, <bpt id=\"p2\">[</bpt>CMFCEditBrowseCtrl::EnableFileBrowseButton<ept id=\"p2\">](#cmfceditbrowsectrl__enablefilebrowsebutton)</ept>, and <bpt id=\"p3\">[</bpt>CMFCEditBrowseCtrl::EnableFolderBrowseButton<ept id=\"p3\">](#cmfceditbrowsectrl__enablefolderbrowsebutton)</ept> methods.","pos":[10632,10944],"source":" Modify the browse mode with the [CMFCEditBrowseCtrl::EnableBrowseButton](#cmfceditbrowsectrl__enablebrowsebutton), [CMFCEditBrowseCtrl::EnableFileBrowseButton](#cmfceditbrowsectrl__enablefilebrowsebutton), and [CMFCEditBrowseCtrl::EnableFolderBrowseButton](#cmfceditbrowsectrl__enablefolderbrowsebutton) methods."},{"pos":[11004,11037],"content":"CMFCEditBrowseCtrl::OnAfterUpdate"},{"content":"Called by the framework after the edit browse control is updated with the result of a browse action.","pos":[11041,11141]},{"content":"Remarks","pos":[11196,11203]},{"content":"Override this method in a derived class to implement a custom action.","pos":[11207,11276]},{"pos":[11331,11359],"content":"CMFCEditBrowseCtrl::OnBrowse"},{"content":"Called by the framework after the user clicks the browse button of the edit browse control.","pos":[11363,11454]},{"content":"Remarks","pos":[11504,11511]},{"content":"Use this method to execute custom code when the user clicks the browse button of the edit browse control.","pos":[11515,11620]},{"content":"Derive your own class from the <ph id=\"ph1\">`CMFCEditBrowseCtrl`</ph> class and override its <ph id=\"ph2\">`OnBrowse`</ph> method.","pos":[11621,11714],"source":" Derive your own class from the `CMFCEditBrowseCtrl` class and override its `OnBrowse` method."},{"content":"In that method, implement a custom browse action and optionally update the text box of the edit browse control.","pos":[11715,11826]},{"content":"In your application, use the <bpt id=\"p1\">[</bpt>EnableBrowseButton<ept id=\"p1\">](#cmfceditbrowsectrl__enablebrowsebutton)</ept> method to put the edit browse control in <bpt id=\"p2\">*</bpt>custom browse<ept id=\"p2\">*</ept> mode.","pos":[11827,11980],"source":" In your application, use the [EnableBrowseButton](#cmfceditbrowsectrl__enablebrowsebutton) method to put the edit browse control in *custom browse* mode."},{"pos":[12041,12075],"content":"CMFCEditBrowseCtrl::OnChangeLayout"},{"content":"Redraws the current edit browse control.","pos":[12079,12119]},{"content":"Remarks","pos":[12175,12182]},{"content":"The framework calls this method when the browse mode of the edit browse control changes.","pos":[12186,12274]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>CMFCEditBrowseCtrl::GetMode<ept id=\"p1\">](#cmfceditbrowsectrl__getmode)</ept>.","pos":[12275,12361],"source":" For more information, see [CMFCEditBrowseCtrl::GetMode](#cmfceditbrowsectrl__getmode)."},{"pos":[12426,12464],"content":"CMFCEditBrowseCtrl::OnDrawBrowseButton"},{"content":"Called by the framework to draw the browse button on the edit browse control.","pos":[12468,12545]},{"content":"Parameters","pos":[12690,12700]},{"content":"A pointer to a device context.","pos":[12713,12743]},{"content":"The bounding rectangle of the browse button.","pos":[12760,12804]},{"content":"if the button is pressed; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","pos":[12840,12885],"source":" if the button is pressed; otherwise, `FALSE`."},{"content":"if the button is highlighted; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","pos":[12917,12966],"source":" if the button is highlighted; otherwise, `FALSE`."},{"content":"Remarks","pos":[12976,12983]},{"content":"Override this function in a derived class to customize the appearance of the browse button.","pos":[12987,13078]},{"pos":[13145,13185],"content":"CMFCEditBrowseCtrl::SetBrowseButtonImage"},{"content":"Sets a custom image on the browse button of the edit browse control.","pos":[13189,13257]},{"content":"Parameters","pos":[13493,13503]},{"content":"The handle of an icon.","pos":[13518,13540]},{"content":"The handle of a bitmap.","pos":[13560,13583]},{"content":"The resource ID of a bitmap.","pos":[13606,13634]},{"content":"to delete the specified icon or bitmap when this method exits; otherwise, <ph id=\"ph1\">`FALSE`</ph>.","pos":[13666,13748],"source":" to delete the specified icon or bitmap when this method exits; otherwise, `FALSE`."},{"content":"The default value is <ph id=\"ph1\">`TRUE`</ph>.","pos":[13749,13777],"source":" The default value is `TRUE`."},{"content":"Remarks","pos":[13787,13794]},{"content":"Use this method to apply a custom image to the browse button.","pos":[13798,13859]},{"content":"By default, the framework obtains a standard image when the edit browse control is in <bpt id=\"p1\">*</bpt>file browse<ept id=\"p1\">*</ept> or <bpt id=\"p2\">*</bpt>folder browse<ept id=\"p2\">*</ept> mode.","pos":[13860,13984],"source":" By default, the framework obtains a standard image when the edit browse control is in *file browse* or *folder browse* mode."},{"pos":[14048,14085],"content":"CMFCEditBrowseCtrl::OnIllegalFileName"},{"content":"Called by the framework when an illegal file name was entered in the edit control.","pos":[14089,14171]},{"content":"Parameters","pos":[14250,14260]},{"content":"Specifies the illegal file name.","pos":[14281,14313]},{"content":"Return Value","pos":[14323,14335]},{"content":"Should return <ph id=\"ph1\">`FALSE`</ph> if this file name can not be passed further to the file dialog.","pos":[14339,14424],"source":"Should return `FALSE` if this file name can not be passed further to the file dialog."},{"content":"In this case, focus is set back to the edit control and the user should continue editing.","pos":[14425,14514]},{"content":"The default implementation displays a message box telling the user about the illegal file name and returns <ph id=\"ph1\">`FALSE`</ph>.","pos":[14515,14630],"source":" The default implementation displays a message box telling the user about the illegal file name and returns `FALSE`."},{"content":"You can override this method, correct the file name, and return <ph id=\"ph1\">`TRUE`</ph> for further processing.","pos":[14631,14725],"source":" You can override this method, correct the file name, and return `TRUE` for further processing."},{"content":"Remarks","pos":[14735,14742]},{"content":"See Also","pos":[14751,14759]},{"content":"Hierarchy Chart","pos":[14764,14779]},{"content":"Classes","pos":[14816,14823]}],"content":"---\ntitle: \"CMFCEditBrowseCtrl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCEditBrowseCtrl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCEditBrowseCtrl::PreTranslateMessage method\"\n  - \"CMFCEditBrowseCtrl constructor\"\n  - \"CMFCEditBrowseCtrl class\"\nms.assetid: 69cfd886-3d35-4bee-8901-7c88fcf9520f\ncaps.latest.revision: 33\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCEditBrowseCtrl Class\nThe `CMFCEditBrowseCtrl` class supports the edit browse control, which is an editable text box that optionally contains a browse button. When the user clicks the browse button, the control performs a custom action or displays a standard dialog box that contains a file browser or a folder browser.  \n  \n## Syntax  \n  \n```  \nclass CMFCEditBrowseCtrl : public CEdit  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|`CMFCEditBrowseCtrl::CMFCEditBrowseCtrl`|Default constructor.|  \n|`CMFCEditBrowseCtrl::~CMFCEditBrowseCtrl`|Destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCEditBrowseCtrl::EnableBrowseButton](#cmfceditbrowsectrl__enablebrowsebutton)|Enables or disables (hides) the browse button.|  \n|[CMFCEditBrowseCtrl::EnableFileBrowseButton](#cmfceditbrowsectrl__enablefilebrowsebutton)|Enables the browse button and puts the edit browse control in *file browse* mode.|  \n|[CMFCEditBrowseCtrl::EnableFolderBrowseButton](#cmfceditbrowsectrl__enablefolderbrowsebutton)|Enables the browse button and puts the edit browse control in *folder browse* mode.|  \n|[CMFCEditBrowseCtrl::GetMode](#cmfceditbrowsectrl__getmode)|Returns the current browse mode.|  \n|[CMFCEditBrowseCtrl::OnAfterUpdate](#cmfceditbrowsectrl__onafterupdate)|Called by the framework after the edit browse control is updated with the result of a browse action.|  \n|[CMFCEditBrowseCtrl::OnBrowse](#cmfceditbrowsectrl__onbrowse)|Called by the framework after the user clicks the browse button.|  \n|[CMFCEditBrowseCtrl::OnChangeLayout](#cmfceditbrowsectrl__onchangelayout)|Redraws the current edit browse control.|  \n|[CMFCEditBrowseCtrl::OnDrawBrowseButton](#cmfceditbrowsectrl__ondrawbrowsebutton)|Called by the framework to draw the browse button.|  \n|[CMFCEditBrowseCtrl::OnIllegalFileName](#cmfceditbrowsectrl__onillegalfilename)|Called by the framework when an illegal file name was entered in the edit control.|  \n|`CMFCEditBrowseCtrl::PreTranslateMessage`|Translates window messages before they are dispatched to the [TranslateMessage](http://msdn.microsoft.com/library/windows/desktop/ms644955) and [DispatchMessage](http://msdn.microsoft.com/library/windows/desktop/ms644934) Windows functions. For syntax and more information, see [CWnd::PreTranslateMessage](../../mfc/reference/cwnd-class.md#cwnd__pretranslatemessage).|  \n|[CMFCEditBrowseCtrl::SetBrowseButtonImage](#cmfceditbrowsectrl__setbrowsebuttonimage)|Sets a custom image for the browse button.|  \n  \n## Remarks  \n Use an edit browse control to select a file or folder name. Optionally, use the control to perform a custom action such as to display a dialog box. You can display or not display the browse button, and you can apply a custom label or image on the button.  \n  \n The *browse mode* of the edit browse control determines whether it displays a browse button and what action occurs when the button is clicked. For more information, see the [GetMode](#cmfceditbrowsectrl__getmode) method.  \n  \n The `CMFCEditBrowseCtrl` class supports the following modes.  \n  \n `custom mode`  \n A custom action is performed when the user clicks the browse button. For example, you can display an application-specific dialog box.  \n  \n `file mode`  \n A standard file selection dialog box is displayed when the user clicks the browse button.  \n  \n `folder mode`  \n A standard folder selection dialog box is displayed when the user clicks the browse button.  \n  \n## How-To: Specify an Edit Browse Control  \n Perform the following steps to incorporate an edit browse control in your application:  \n  \n1.  If you want to implement a custom browse mode, derive your own class from the `CMFCEditBrowseCtrl` class and then override the [CMFCEditBrowseCtrl::OnBrowse](#cmfceditbrowsectrl__onbrowse) method. In the overridden method, execute a custom browse action and update the edit browse control with the result.  \n  \n2.  Embed either the `CMFCEditBrowseCtrl` object or the derived edit browse control object into the parent window object.  \n  \n3.  If you use the **Class Wizard** to create a dialog box, add an edit control ( `CEdit`) to the dialog box form. Also, add a variable to access the control in your header file. In your header file, change the type of the variable from `CEdit` to `CMFCEditBrowseCtrl`. The edit browse control will be created automatically. If you do not use the **Class Wizard**, add a `CMFCEditBrowseCtrl` variable to your header file and then call its `Create` method.  \n  \n4.  If you add an edit browse control to a dialog box, use the **ClassWizard** tool to set up data exchange.  \n  \n5.  Call the [EnableFolderBrowseButton](#cmfceditbrowsectrl__enablefolderbrowsebutton), [EnableFileBrowseButton](#cmfceditbrowsectrl__enablefilebrowsebutton), or [EnableBrowseButton](#cmfceditbrowsectrl__enablebrowsebutton) method to set the browse mode and display the browse button. Call the [GetMode](#cmfceditbrowsectrl__getmode) method to obtain the current browse mode.  \n  \n6.  To provide a custom image for the browse button, call the [SetBrowseButtonImage](#cmfceditbrowsectrl__setbrowsebuttonimage) method or override the [OnDrawBrowseButton](#cmfceditbrowsectrl__ondrawbrowsebutton) method.  \n  \n7.  To remove the browse button from the edit browse control, call the [EnableBrowseButton](#cmfceditbrowsectrl__enablebrowsebutton) method with the `bEnable` parameter set to `FALSE`.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CEdit](../../mfc/reference/cedit-class.md)  \n  \n [CMFCEditBrowseCtrl](../../mfc/reference/cmfceditbrowsectrl-class.md)  \n  \n## Example  \n The following example demonstrates how to use two methods in the `CMFCEditBrowseCtrl` class: `EnableFolderBrowseButton` and `EnableFileBrowseButton`. This example is part of the [New Controls sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_NewControls#6](../../mfc/reference/codesnippet/cpp/cmfceditbrowsectrl-class_1.h)]  \n[!code-cpp[NVC_MFC_NewControls#7](../../mfc/reference/codesnippet/cpp/cmfceditbrowsectrl-class_2.cpp)]  \n  \n## Requirements  \n **Header:** afxeditbrowsectrl.h  \n  \n##  <a name=\"cmfceditbrowsectrl__enablebrowsebutton\"></a>  CMFCEditBrowseCtrl::EnableBrowseButton  \n Displays or does not display the browse button on the current edit browse control.  \n  \n```  \nvoid EnableBrowseButton(\n    BOOL bEnable=TRUE,  \n    LPCTSTR szLabel=_T(\"...\"));\n```  \n  \n### Parameters  \n `bEnable`  \n `TRUE` to display the browse button; `FALSE` not to display the browse button. The default value is `TRUE`.  \n  \n `szLabel`  \n The label that is displayed on the browse button. The default value is \" **...**\".  \n  \n### Remarks  \n If the `bEnable` parameter is `TRUE`, implement a custom action to perform when the browse button is clicked. To implement a custom action, derive a class from the `CMFCEditBrowseCtrl` class and then override its [OnBrowse](#cmfceditbrowsectrl__onbrowse) method.  \n  \n If the `bEnable` parameter is `TRUE`, the browse mode of the control is `BrowseMode_Default`; otherwise, the browse mode is `BrowseMode_None`. For more information about browse modes, see the [GetMode](#cmfceditbrowsectrl__getmode) method.  \n  \n##  <a name=\"cmfceditbrowsectrl__enablefilebrowsebutton\"></a>  CMFCEditBrowseCtrl::EnableFileBrowseButton  \n Displays the browse button on the current edit browse control and puts the control in *file browse* mode.  \n  \n```  \nvoid EnableFileBrowseButton(\n    LPCTSTR lpszDefExt=NULL,  \n    LPCTSTR lpszFilter=NULL,  \n    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT);\n```  \n  \n### Parameters  \n `lpszDefExt`  \n Specifies the default file name extension that is used in the file selection dialog box. The default value is `NULL`.  \n  \n `lpszFilter`  \n Specifies the default filter string that is used in the file selection dialog box. The default value is `NULL`.  \n  \n `dwFlags`  \n Dialog box flags. The default value is a bitwise combination (OR) of OFN_HIDEREADONLY and OFN_OVERWRITEPROMPT.  \n  \n### Remarks  \n When the edit browse control is in file browse mode and the user clicks the browse button, the control displays the standard file selection dialog box.  \n  \n For a full list of available flags, see [OPENFILENAME structure](https://msdn.microsoft.com/library/ms646839.aspx).  \n  \n##  <a name=\"cmfceditbrowsectrl__enablefolderbrowsebutton\"></a>  CMFCEditBrowseCtrl::EnableFolderBrowseButton  \n Displays the browse button on the current edit browse control and puts the control in *folder browse* mode.  \n  \n```  \nvoid EnableFolderBrowseButton();\n```  \n  \n### Remarks  \n When the edit browse control is in folder browse mode and the user clicks the browse button, the control displays the standard folder selection dialog box.  \n  \n##  <a name=\"cmfceditbrowsectrl__getmode\"></a>  CMFCEditBrowseCtrl::GetMode  \n Retrieves the browse mode of the current edit browse control.  \n  \n```  \nCMFCEditBrowseCtrl::BrowseMode GetMode() const;\n\n \n```  \n  \n### Return Value  \n One of the enumeration values that specifies the current mode of the edit browse control. The browse mode determines whether the framework displays the browse button and what action occurs when a user clicks that button.  \n  \n The following table lists the possible return values.  \n  \n|Value|Description|  \n|-----------|-----------------|  \n|`BrowseMode_Default`|`custom mode`. A programmer-defined action is performed.|  \n|`BrowseMode_File`|`file mode`. The standard file browser dialog box is displayed.|  \n|`BrowseMode_Folder`|`folder mode`. The standard folder browser dialog box is displayed.|  \n|`BrowseMode_None`|The browse button is not displayed.|  \n  \n### Remarks  \n By default, a `CMFCEditBrowseCtrl` object is initialized to `BrowseMode_None` mode. Modify the browse mode with the [CMFCEditBrowseCtrl::EnableBrowseButton](#cmfceditbrowsectrl__enablebrowsebutton), [CMFCEditBrowseCtrl::EnableFileBrowseButton](#cmfceditbrowsectrl__enablefilebrowsebutton), and [CMFCEditBrowseCtrl::EnableFolderBrowseButton](#cmfceditbrowsectrl__enablefolderbrowsebutton) methods.  \n  \n##  <a name=\"cmfceditbrowsectrl__onafterupdate\"></a>  CMFCEditBrowseCtrl::OnAfterUpdate  \n Called by the framework after the edit browse control is updated with the result of a browse action.  \n  \n```  \nvirtual void OnAfterUpdate();\n```  \n  \n### Remarks  \n Override this method in a derived class to implement a custom action.  \n  \n##  <a name=\"cmfceditbrowsectrl__onbrowse\"></a>  CMFCEditBrowseCtrl::OnBrowse  \n Called by the framework after the user clicks the browse button of the edit browse control.  \n  \n```  \nvirtual void OnBrowse();\n```  \n  \n### Remarks  \n Use this method to execute custom code when the user clicks the browse button of the edit browse control. Derive your own class from the `CMFCEditBrowseCtrl` class and override its `OnBrowse` method. In that method, implement a custom browse action and optionally update the text box of the edit browse control. In your application, use the [EnableBrowseButton](#cmfceditbrowsectrl__enablebrowsebutton) method to put the edit browse control in *custom browse* mode.  \n  \n##  <a name=\"cmfceditbrowsectrl__onchangelayout\"></a>  CMFCEditBrowseCtrl::OnChangeLayout  \n Redraws the current edit browse control.  \n  \n```  \nvirtual void OnChangeLayout();\n```  \n  \n### Remarks  \n The framework calls this method when the browse mode of the edit browse control changes. For more information, see [CMFCEditBrowseCtrl::GetMode](#cmfceditbrowsectrl__getmode).  \n  \n##  <a name=\"cmfceditbrowsectrl__ondrawbrowsebutton\"></a>  CMFCEditBrowseCtrl::OnDrawBrowseButton  \n Called by the framework to draw the browse button on the edit browse control.  \n  \n```  \nvirtual void OnDrawBrowseButton(\n    CDC* pDC,  \n    CRect rect,  \n    BOOL bIsButtonPressed,  \n    BOOL bIsButtonHot);\n```  \n  \n### Parameters  \n `pDC`  \n A pointer to a device context.  \n  \n `Rect`  \n The bounding rectangle of the browse button.  \n  \n `bIsButtonPressed`  \n `TRUE` if the button is pressed; otherwise, `FALSE`.  \n  \n `bIsButtonHot`  \n `TRUE` if the button is highlighted; otherwise, `FALSE`.  \n  \n### Remarks  \n Override this function in a derived class to customize the appearance of the browse button.  \n  \n##  <a name=\"cmfceditbrowsectrl__setbrowsebuttonimage\"></a>  CMFCEditBrowseCtrl::SetBrowseButtonImage  \n Sets a custom image on the browse button of the edit browse control.  \n  \n```  \nvoid SetBrowseButtonImage(\n    HICON hIcon,  \n    BOOL bAutoDestroy= TRUE);\n\n \nvoid SetBrowseButtonImage(\n    HBITMAP hBitmap,  \n    BOOL bAutoDestroy= TRUE);\n\n \nvoid SetBrowseButtonImage(\n    UINT uiBmpResId);\n```  \n  \n### Parameters  \n `hIcon`  \n The handle of an icon.  \n  \n `hBitmap`  \n The handle of a bitmap.  \n  \n `uiBmpResId`  \n The resource ID of a bitmap.  \n  \n `bAutoDestroy`  \n `TRUE` to delete the specified icon or bitmap when this method exits; otherwise, `FALSE`. The default value is `TRUE`.  \n  \n### Remarks  \n Use this method to apply a custom image to the browse button. By default, the framework obtains a standard image when the edit browse control is in *file browse* or *folder browse* mode.  \n  \n##  <a name=\"cmfceditbrowsectrl__onillegalfilename\"></a>  CMFCEditBrowseCtrl::OnIllegalFileName  \n Called by the framework when an illegal file name was entered in the edit control.  \n  \n```  \nvirtual BOOL OnIllegalFileName(CString& strFileName);\n```  \n  \n### Parameters  \n `strFileName`  \n Specifies the illegal file name.  \n  \n### Return Value  \n Should return `FALSE` if this file name can not be passed further to the file dialog. In this case, focus is set back to the edit control and the user should continue editing. The default implementation displays a message box telling the user about the illegal file name and returns `FALSE`. You can override this method, correct the file name, and return `TRUE` for further processing.  \n  \n### Remarks  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)\n"}