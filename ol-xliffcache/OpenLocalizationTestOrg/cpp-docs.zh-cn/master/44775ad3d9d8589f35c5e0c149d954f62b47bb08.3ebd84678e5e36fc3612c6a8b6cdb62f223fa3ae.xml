{"nodes":[{"pos":[12,63],"content":"MFC ActiveX Controls: Optimization | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Optimization | Microsoft Docs","pos":[0,51]}]},{"content":"MFC ActiveX Controls: Optimization","pos":[1032,1066]},{"content":"This article explains techniques you can use to optimize your ActiveX controls for better performance.","pos":[1067,1169]},{"content":"The topics <bpt id=\"p1\">[</bpt>Turning Off the Activate When Visible Option<ept id=\"p1\">](../mfc/turning-off-the-activate-when-visible-option.md)</ept> and <bpt id=\"p2\">[</bpt>Providing Mouse Interaction While Inactive<ept id=\"p2\">](../mfc/providing-mouse-interaction-while-inactive.md)</ept> discuss controls that don't create a window until activated.","pos":[1176,1453],"source":"The topics [Turning Off the Activate When Visible Option](../mfc/turning-off-the-activate-when-visible-option.md) and [Providing Mouse Interaction While Inactive](../mfc/providing-mouse-interaction-while-inactive.md) discuss controls that don't create a window until activated."},{"content":"The topic <bpt id=\"p1\">[</bpt>Providing Windowless Activation<ept id=\"p1\">](../mfc/providing-windowless-activation.md)</ept> discusses controls that never create a window, even when they are activated.","pos":[1454,1617],"source":" The topic [Providing Windowless Activation](../mfc/providing-windowless-activation.md) discusses controls that never create a window, even when they are activated."},{"content":"Windows have two major drawbacks for OLE objects: they prevent objects from being transparent or nonrectangular when active, and they add a large overhead to the instantiation and display of controls.","pos":[1624,1824]},{"content":"Typically, creating a window takes 60 percent of a control's creation time.","pos":[1825,1900]},{"content":"With a single shared window (usually the container's) and some dispatching code, a control receives the same window services, generally without a loss of performance.","pos":[1901,2067]},{"content":"Having a window is mostly unnecessary overhead for the object.","pos":[2068,2130]},{"content":"Some optimizations do not necessarily improve performance when your control is used in certain containers.","pos":[2137,2243]},{"content":"For example, containers released prior to 1996 did not support windowless activation, so implementing this feature will not provide a benefit in older containers.","pos":[2244,2406]},{"content":"However, nearly every container supports persistence, so optimizing your control's persistence code will likely improve its performance in any container.","pos":[2407,2560]},{"content":"If your control is specifically intended to be used with one particular type of container, you may want to research which of these optimizations is supported by that container.","pos":[2561,2737]},{"content":"In general, however, you should try to implement as many of these techniques as are applicable to your particular control to ensure your control performs as well as it possibly can in a wide array of containers.","pos":[2738,2949]},{"pos":[2956,3188],"content":"You can implement many of these optimizations through the <bpt id=\"p1\">[</bpt>MFC ActiveX Control Wizard<ept id=\"p1\">](../mfc/reference/mfc-activex-control-wizard.md)</ept>, on the <bpt id=\"p2\">[</bpt>Control Settings<ept id=\"p2\">](../mfc/reference/control-settings-mfc-activex-control-wizard.md)</ept> page.","source":"You can implement many of these optimizations through the [MFC ActiveX Control Wizard](../mfc/reference/mfc-activex-control-wizard.md), on the [Control Settings](../mfc/reference/control-settings-mfc-activex-control-wizard.md) page."},{"content":"MFC ActiveX Control Wizard OLE Optimization Options","pos":[3198,3249]},{"content":"Control setting in the MFC ActiveX Control Wizard","pos":[3256,3305]},{"content":"Action","pos":[3306,3312]},{"content":"More information","pos":[3313,3329]},{"pos":[3430,3465],"content":"<bpt id=\"p1\">**</bpt>Activate when visible<ept id=\"p1\">**</ept> check box","source":"**Activate when visible** check box"},{"content":"Clear","pos":[3466,3471]},{"content":"Turning Off the Activate When Visible Option","pos":[3473,3517]},{"pos":[3579,3614],"content":"<bpt id=\"p1\">**</bpt>Windowless activation<ept id=\"p1\">**</ept> check box","source":"**Windowless activation** check box"},{"content":"Select","pos":[3615,3621]},{"content":"Providing Windowless Activation","pos":[3623,3654]},{"pos":[3703,3741],"content":"<bpt id=\"p1\">**</bpt>Unclipped device context<ept id=\"p1\">**</ept> check box","source":"**Unclipped device context** check box"},{"content":"Select","pos":[3742,3748]},{"content":"Using an Unclipped Device Context","pos":[3750,3783]},{"pos":[3834,3871],"content":"<bpt id=\"p1\">**</bpt>Flicker-free activation<ept id=\"p1\">**</ept> check box","source":"**Flicker-free activation** check box"},{"content":"Select","pos":[3872,3878]},{"content":"Providing Flicker-Free Activation","pos":[3880,3913]},{"pos":[3964,4019],"content":"<bpt id=\"p1\">**</bpt>Mouse pointer notifications when inactive<ept id=\"p1\">**</ept> check box","source":"**Mouse pointer notifications when inactive** check box"},{"content":"Select","pos":[4020,4026]},{"content":"Providing Mouse Interaction While Inactive","pos":[4028,4070]},{"pos":[4130,4166],"content":"<bpt id=\"p1\">**</bpt>Optimized drawing code<ept id=\"p1\">**</ept> check box","source":"**Optimized drawing code** check box"},{"content":"Select","pos":[4167,4173]},{"content":"Optimizing Control Drawing","pos":[4175,4201]},{"content":"For detailed information about the member functions that implement these optimizations, see <bpt id=\"p1\">[</bpt>COleControl<ept id=\"p1\">](../mfc/reference/colecontrol-class.md)</ept>.","pos":[4248,4393],"source":"For detailed information about the member functions that implement these optimizations, see [COleControl](../mfc/reference/colecontrol-class.md)."},{"content":"The member functions are listed by use, such as <bpt id=\"p1\">[</bpt>Windowless Operations<ept id=\"p1\">](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df)</ept> and <bpt id=\"p2\">[</bpt>Inactive Pointer Handling Functions<ept id=\"p2\">](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df)</ept>.","pos":[4394,4648],"source":" The member functions are listed by use, such as [Windowless Operations](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) and [Inactive Pointer Handling Functions](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df)."},{"content":"For more information, see:","pos":[4655,4681]},{"content":"Optimizing Persistence and Initialization","pos":[4692,4733]},{"content":"Providing Windowless Activation","pos":[4798,4829]},{"content":"Turning Off the Activate When Visible Option","pos":[4884,4928]},{"content":"Providing Mouse Interaction While Inactive","pos":[4996,5038]},{"content":"Providing Flicker-Free Activation","pos":[5104,5137]},{"content":"Using an Unclipped Device Context","pos":[5194,5227]},{"content":"Optimizing Control Drawing","pos":[5284,5310]},{"content":"See Also","pos":[5358,5366]},{"content":"MFC ActiveX Controls","pos":[5371,5391]}],"content":"---\ntitle: \"MFC ActiveX Controls: Optimization | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, windowless\"\n  - \"flicker-free ActiveX controls\"\n  - \"MFC ActiveX controls, mouse interaction\"\n  - \"device contexts, unclipped for MFC ActiveX controls\"\n  - \"MFC ActiveX controls, optimizing\"\n  - \"performance, ActiveX controls\"\n  - \"optimization, ActiveX controls\"\n  - \"MFC ActiveX controls, flicker-free\"\n  - \"windowless MFC ActiveX controls\"\n  - \"MFC ActiveX controls, active/inactive state\"\n  - \"optimizing performance, ActiveX controls\"\nms.assetid: 8b11f26a-190d-469b-b594-5336094a0109\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Optimization\nThis article explains techniques you can use to optimize your ActiveX controls for better performance.  \n  \n The topics [Turning Off the Activate When Visible Option](../mfc/turning-off-the-activate-when-visible-option.md) and [Providing Mouse Interaction While Inactive](../mfc/providing-mouse-interaction-while-inactive.md) discuss controls that don't create a window until activated. The topic [Providing Windowless Activation](../mfc/providing-windowless-activation.md) discusses controls that never create a window, even when they are activated.  \n  \n Windows have two major drawbacks for OLE objects: they prevent objects from being transparent or nonrectangular when active, and they add a large overhead to the instantiation and display of controls. Typically, creating a window takes 60 percent of a control's creation time. With a single shared window (usually the container's) and some dispatching code, a control receives the same window services, generally without a loss of performance. Having a window is mostly unnecessary overhead for the object.  \n  \n Some optimizations do not necessarily improve performance when your control is used in certain containers. For example, containers released prior to 1996 did not support windowless activation, so implementing this feature will not provide a benefit in older containers. However, nearly every container supports persistence, so optimizing your control's persistence code will likely improve its performance in any container. If your control is specifically intended to be used with one particular type of container, you may want to research which of these optimizations is supported by that container. In general, however, you should try to implement as many of these techniques as are applicable to your particular control to ensure your control performs as well as it possibly can in a wide array of containers.  \n  \n You can implement many of these optimizations through the [MFC ActiveX Control Wizard](../mfc/reference/mfc-activex-control-wizard.md), on the [Control Settings](../mfc/reference/control-settings-mfc-activex-control-wizard.md) page.  \n  \n### MFC ActiveX Control Wizard OLE Optimization Options  \n  \n|Control setting in the MFC ActiveX Control Wizard|Action|More information|  \n|-------------------------------------------------------|------------|----------------------|  \n|**Activate when visible** check box|Clear|[Turning Off the Activate When Visible Option](../mfc/turning-off-the-activate-when-visible-option.md)|  \n|**Windowless activation** check box|Select|[Providing Windowless Activation](../mfc/providing-windowless-activation.md)|  \n|**Unclipped device context** check box|Select|[Using an Unclipped Device Context](../mfc/using-an-unclipped-device-context.md)|  \n|**Flicker-free activation** check box|Select|[Providing Flicker-Free Activation](../mfc/providing-flicker-free-activation.md)|  \n|**Mouse pointer notifications when inactive** check box|Select|[Providing Mouse Interaction While Inactive](../mfc/providing-mouse-interaction-while-inactive.md)|  \n|**Optimized drawing code** check box|Select|[Optimizing Control Drawing](../mfc/optimizing-control-drawing.md)|  \n  \n For detailed information about the member functions that implement these optimizations, see [COleControl](../mfc/reference/colecontrol-class.md). The member functions are listed by use, such as [Windowless Operations](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) and [Inactive Pointer Handling Functions](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df).  \n  \n For more information, see:  \n  \n-   [Optimizing Persistence and Initialization](../mfc/optimizing-persistence-and-initialization.md)  \n  \n-   [Providing Windowless Activation](../mfc/providing-windowless-activation.md)  \n  \n-   [Turning Off the Activate When Visible Option](../mfc/turning-off-the-activate-when-visible-option.md)  \n  \n-   [Providing Mouse Interaction While Inactive](../mfc/providing-mouse-interaction-while-inactive.md)  \n  \n-   [Providing Flicker-Free Activation](../mfc/providing-flicker-free-activation.md)  \n  \n-   [Using an Unclipped Device Context](../mfc/using-an-unclipped-device-context.md)  \n  \n-   [Optimizing Control Drawing](../mfc/optimizing-control-drawing.md)  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)\n\n"}