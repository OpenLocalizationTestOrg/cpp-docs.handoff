{"nodes":[{"pos":[12,65],"content":"MFC ActiveX Controls: Property Pages | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Property Pages | Microsoft Docs","pos":[0,53]}]},{"content":"MFC ActiveX Controls: Property Pages","pos":[800,836]},{"content":"Property pages allow an ActiveX control user to view and change ActiveX control properties.","pos":[837,928]},{"content":"These properties are accessed by invoking a control properties dialog box, which contains one or more property pages that provide a customized, graphical interface for viewing and editing the control properties.","pos":[929,1140]},{"content":"ActiveX control property pages are displayed in two ways:","pos":[1147,1204]},{"pos":[1214,1376],"content":"When the control's Properties verb (<bpt id=\"p1\">**</bpt>OLEIVERB_PROPERTIES<ept id=\"p1\">**</ept>) is invoked, the control opens a modal property dialog box that contains the control's property pages.","source":"When the control's Properties verb (**OLEIVERB_PROPERTIES**) is invoked, the control opens a modal property dialog box that contains the control's property pages."},{"content":"The container can display its own modeless dialog box that shows the property pages of the selected control.","pos":[1386,1494]},{"content":"The properties dialog box (illustrated in the following figure) consists of an area for displaying the current property page, tabs for switching between property pages, and a collection of buttons that perform common tasks such as closing the property page dialog, canceling any changes made, or immediately applying any changes to the ActiveX control.","pos":[1501,1853]},{"content":"Properties dialog box for Circ3","pos":[1862,1893]},{"content":"Properties Dialog Box","pos":[1933,1954]},{"content":"This article covers topics related to using property pages in an ActiveX control.","pos":[1961,2042]},{"content":"These include:","pos":[2043,2057]},{"content":"Implementing the default property page for an ActiveX control","pos":[2068,2129]},{"content":"Adding controls to a property page","pos":[2188,2222]},{"content":"Customizing the DoDataExchange function","pos":[2277,2316]},{"content":"For more information on using property pages in an ActiveX control, see the following articles:","pos":[2372,2467]},{"content":"MFC ActiveX Controls: Adding Another Custom Property Page","pos":[2478,2535]},{"content":"MFC ActiveX Controls: Using Stock Property Pages","pos":[2615,2663]},{"pos":[2730,2877],"content":"For information on using property sheets in an MFC application other than an ActiveX control, see <bpt id=\"p1\">[</bpt>Property Sheets<ept id=\"p1\">](../mfc/property-sheets-mfc.md)</ept>.","source":"For information on using property sheets in an MFC application other than an ActiveX control, see [Property Sheets](../mfc/property-sheets-mfc.md)."},{"pos":[2947,2985],"content":"Implementing the Default Property Page"},{"content":"If you use the ActiveX Control Wizard to create your control project, the ActiveX Control Wizard provides a default property page class for the control derived from <bpt id=\"p1\">[</bpt>COlePropertyPage Class<ept id=\"p1\">](../mfc/reference/colepropertypage-class.md)</ept>.","pos":[2989,3223],"source":"If you use the ActiveX Control Wizard to create your control project, the ActiveX Control Wizard provides a default property page class for the control derived from [COlePropertyPage Class](../mfc/reference/colepropertypage-class.md)."},{"content":"Initially, this property page is blank, but you can add any dialog box control or set of controls to it.","pos":[3224,3328]},{"content":"Because the ActiveX Control Wizard creates only one property page class by default, additional property page classes (also derived from <ph id=\"ph1\">`COlePropertyPage`</ph>) must be created using Class View.","pos":[3329,3518],"source":" Because the ActiveX Control Wizard creates only one property page class by default, additional property page classes (also derived from `COlePropertyPage`) must be created using Class View."},{"content":"For more information on this procedure, see <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Adding Another Custom Property Page<ept id=\"p1\">](../mfc/mfc-activex-controls-adding-another-custom-property-page.md)</ept>.","pos":[3519,3691],"source":" For more information on this procedure, see [MFC ActiveX Controls: Adding Another Custom Property Page](../mfc/mfc-activex-controls-adding-another-custom-property-page.md)."},{"content":"Implementing a property page (in this case, the default) is a three-step process:","pos":[3698,3779]},{"content":"To implement a property page","pos":[3790,3818]},{"content":"Add a <ph id=\"ph1\">`COlePropertyPage`</ph>-derived class to the control project.","pos":[3828,3890],"source":"Add a `COlePropertyPage`-derived class to the control project."},{"content":"If the project was created using the ActiveX Control Wizard (as in this case), the default property page class already exists.","pos":[3891,4017]},{"content":"Use the dialog editor to add any controls to the property page template.","pos":[4027,4099]},{"pos":[4109,4266],"content":"Customize the <ph id=\"ph1\">`DoDataExchange`</ph> function of the <ph id=\"ph2\">`COlePropertyPage`</ph>-derived class to exchange values between the property page control and the ActiveX control.","source":"Customize the `DoDataExchange` function of the `COlePropertyPage`-derived class to exchange values between the property page control and the ActiveX control."},{"content":"For example purposes, the following procedures use a simple control (named \"Sample\").","pos":[4273,4358]},{"content":"Sample was created using the ActiveX Control Wizard and contains only the stock Caption property.","pos":[4359,4456]},{"pos":[4522,4556],"content":"Adding Controls to a Property Page"},{"content":"To add controls to a property page","pos":[4567,4601]},{"content":"With your control project open, open Resource View.","pos":[4611,4662]},{"pos":[4672,4715],"content":"Double-click the <bpt id=\"p1\">**</bpt>Dialog<ept id=\"p1\">**</ept> directory icon.","source":"Double-click the **Dialog** directory icon."},{"pos":[4725,4769],"content":"Open the <bpt id=\"p1\">**</bpt>IDD_PROPPAGE_SAMPLE<ept id=\"p1\">**</ept> dialog box.","source":"Open the **IDD_PROPPAGE_SAMPLE** dialog box."},{"content":"The ActiveX Control Wizard appends the name of the project to the end of the dialog ID, in this case, Sample.","pos":[4780,4889]},{"content":"Drag and drop the selected control from the Toolbox onto the dialog box area.","pos":[4899,4976]},{"pos":[4986,5111],"content":"For this example, a text label control \"Caption :\" and an edit box control with an <bpt id=\"p1\">**</bpt>IDC_CAPTION<ept id=\"p1\">**</ept> identifier are sufficient.","source":"For this example, a text label control \"Caption :\" and an edit box control with an **IDC_CAPTION** identifier are sufficient."},{"pos":[5121,5172],"content":"Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> on the Toolbar to save your changes.","source":"Click **Save** on the Toolbar to save your changes."},{"content":"Now that the user interface has been modified, you need to link the edit box with the Caption property.","pos":[5179,5282]},{"content":"This is done in the following section by editing the <ph id=\"ph1\">`CSamplePropPage::DoDataExchange`</ph> function.","pos":[5283,5379],"source":" This is done in the following section by editing the `CSamplePropPage::DoDataExchange` function."},{"pos":[5450,5489],"content":"Customizing the DoDataExchange Function"},{"content":"Your property page <bpt id=\"p1\">[</bpt>CWnd::DoDataExchange<ept id=\"p1\">](../mfc/reference/cwnd-class.md#cwnd__dodataexchange)</ept> function allows you to link property page values with the actual values of properties in the control.","pos":[5493,5689],"source":"Your property page [CWnd::DoDataExchange](../mfc/reference/cwnd-class.md#cwnd__dodataexchange) function allows you to link property page values with the actual values of properties in the control."},{"content":"To establish links, you must map the appropriate property page fields to their respective control properties.","pos":[5690,5799]},{"content":"These mappings are implemented using the property page <bpt id=\"p1\">**</bpt>DDP_<ept id=\"p1\">**</ept> functions.","pos":[5806,5880],"source":"These mappings are implemented using the property page **DDP_** functions."},{"content":"The <bpt id=\"p1\">**</bpt>DDP_<ept id=\"p1\">**</ept> functions work like the <bpt id=\"p2\">**</bpt>DDX_<ept id=\"p2\">**</ept> functions used in standard MFC dialogs, with one exception.","pos":[5881,5986],"source":" The **DDP_** functions work like the **DDX_** functions used in standard MFC dialogs, with one exception."},{"content":"In addition to the reference to a member variable, <bpt id=\"p1\">**</bpt>DDP_<ept id=\"p1\">**</ept> functions take the name of the control property.","pos":[5987,6095],"source":" In addition to the reference to a member variable, **DDP_** functions take the name of the control property."},{"content":"The following is a typical entry in the <ph id=\"ph1\">`DoDataExchange`</ph> function for a property page.","pos":[6096,6182],"source":" The following is a typical entry in the `DoDataExchange` function for a property page."},{"pos":[6200,6215],"content":"NVC_MFC_AxUI#31"},{"pos":[6290,6411],"content":"This function associates the property page's <ph id=\"ph1\">`m_caption`</ph> member variable with the Caption, using the <ph id=\"ph2\">`DDP_TEXT`</ph> function.","source":"This function associates the property page's `m_caption` member variable with the Caption, using the `DDP_TEXT` function."},{"pos":[6418,6641],"content":"After you have the property page control inserted, you need to establish a link between the property page control, <ph id=\"ph1\">`IDC_CAPTION`</ph>, and the actual control property, Caption, using the <bpt id=\"p1\">**</bpt>DDP_Text<ept id=\"p1\">**</ept> function as described above.","source":"After you have the property page control inserted, you need to establish a link between the property page control, `IDC_CAPTION`, and the actual control property, Caption, using the **DDP_Text** function as described above."},{"content":"<bpt id=\"p1\">[</bpt>Property Pages<ept id=\"p1\">](../mfc/reference/property-pages-mfc.md)</ept> are available for other dialog control types, such as check boxes, radio buttons, and list boxes.","pos":[6648,6802],"source":"[Property Pages](../mfc/reference/property-pages-mfc.md) are available for other dialog control types, such as check boxes, radio buttons, and list boxes."},{"content":"The table below lists the entire set of property page <bpt id=\"p1\">**</bpt>DDP_<ept id=\"p1\">**</ept> functions and their purposes:","pos":[6803,6895],"source":" The table below lists the entire set of property page **DDP_** functions and their purposes:"},{"content":"Property Page Functions","pos":[6905,6928]},{"content":"Function name","pos":[6935,6948]},{"content":"Use this function to link","pos":[6949,6974]},{"content":"The selected string's index in a combo box with a control property.","pos":[7049,7116]},{"content":"The selected string in a combo box with a control property.","pos":[7136,7195]},{"content":"The selected string can begin with the same letters as the property's value but need not match it fully.","pos":[7196,7300]},{"content":"The selected string in a combo box with a control property.","pos":[7325,7384]},{"content":"The selected string and the property's string value must match exactly.","pos":[7385,7456]},{"content":"A check box with a control property.","pos":[7473,7509]},{"content":"The selected string's index in a list box with a control property.","pos":[7528,7594]},{"content":"The selected string in a list box with a control property.","pos":[7614,7672]},{"content":"The selected string can begin with the same letters as the property's value but need not match it fully.","pos":[7673,7777]},{"content":"The selected string in a list box with a control property.","pos":[7802,7860]},{"content":"The selected string and the property's string value must match exactly.","pos":[7861,7932]},{"content":"A radio button with a control property.","pos":[7949,7988]},{"content":"DDP_Text","pos":[7995,8003]},{"content":"Text with a control property.","pos":[8006,8035]},{"content":"See Also","pos":[8045,8053]},{"content":"MFC ActiveX Controls","pos":[8058,8078]},{"content":"COlePropertyPage Class","pos":[8117,8139]}],"content":"---\ntitle: \"MFC ActiveX Controls: Property Pages | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"DDP_ functions\"\n  - \"MFC ActiveX controls, properties\"\n  - \"property pages, MFC ActiveX controls\"\n  - \"DoDataExchange method\"\n  - \"OLEIVERB_PROPERTIES\"\n  - \"CPropertyPageDialog class\"\n  - \"MFC ActiveX controls, property pages\"\nms.assetid: 1506f87a-9fd6-4505-8380-0dbc9636230e\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Property Pages\nProperty pages allow an ActiveX control user to view and change ActiveX control properties. These properties are accessed by invoking a control properties dialog box, which contains one or more property pages that provide a customized, graphical interface for viewing and editing the control properties.  \n  \n ActiveX control property pages are displayed in two ways:  \n  \n-   When the control's Properties verb (**OLEIVERB_PROPERTIES**) is invoked, the control opens a modal property dialog box that contains the control's property pages.  \n  \n-   The container can display its own modeless dialog box that shows the property pages of the selected control.  \n  \n The properties dialog box (illustrated in the following figure) consists of an area for displaying the current property page, tabs for switching between property pages, and a collection of buttons that perform common tasks such as closing the property page dialog, canceling any changes made, or immediately applying any changes to the ActiveX control.  \n  \n ![Properties dialog box for Circ3](../mfc/media/vc373i1.gif \"vc373i1\")  \nProperties Dialog Box  \n  \n This article covers topics related to using property pages in an ActiveX control. These include:  \n  \n-   [Implementing the default property page for an ActiveX control](#_core_implementing_the_default_property_page)  \n  \n-   [Adding controls to a property page](#_core_adding_controls_to_a_property_page)  \n  \n-   [Customizing the DoDataExchange function](#_core_customizing_the_dodataexchange_function)  \n  \n For more information on using property pages in an ActiveX control, see the following articles:  \n  \n-   [MFC ActiveX Controls: Adding Another Custom Property Page](../mfc/mfc-activex-controls-adding-another-custom-property-page.md)  \n  \n-   [MFC ActiveX Controls: Using Stock Property Pages](../mfc/mfc-activex-controls-using-stock-property-pages.md)  \n  \n For information on using property sheets in an MFC application other than an ActiveX control, see [Property Sheets](../mfc/property-sheets-mfc.md).  \n  \n##  <a name=\"_core_implementing_the_default_property_page\"></a> Implementing the Default Property Page  \n If you use the ActiveX Control Wizard to create your control project, the ActiveX Control Wizard provides a default property page class for the control derived from [COlePropertyPage Class](../mfc/reference/colepropertypage-class.md). Initially, this property page is blank, but you can add any dialog box control or set of controls to it. Because the ActiveX Control Wizard creates only one property page class by default, additional property page classes (also derived from `COlePropertyPage`) must be created using Class View. For more information on this procedure, see [MFC ActiveX Controls: Adding Another Custom Property Page](../mfc/mfc-activex-controls-adding-another-custom-property-page.md).  \n  \n Implementing a property page (in this case, the default) is a three-step process:  \n  \n#### To implement a property page  \n  \n1.  Add a `COlePropertyPage`-derived class to the control project. If the project was created using the ActiveX Control Wizard (as in this case), the default property page class already exists.  \n  \n2.  Use the dialog editor to add any controls to the property page template.  \n  \n3.  Customize the `DoDataExchange` function of the `COlePropertyPage`-derived class to exchange values between the property page control and the ActiveX control.  \n  \n For example purposes, the following procedures use a simple control (named \"Sample\"). Sample was created using the ActiveX Control Wizard and contains only the stock Caption property.  \n  \n##  <a name=\"_core_adding_controls_to_a_property_page\"></a> Adding Controls to a Property Page  \n  \n#### To add controls to a property page  \n  \n1.  With your control project open, open Resource View.  \n  \n2.  Double-click the **Dialog** directory icon.  \n  \n3.  Open the **IDD_PROPPAGE_SAMPLE** dialog box.  \n  \n     The ActiveX Control Wizard appends the name of the project to the end of the dialog ID, in this case, Sample.  \n  \n4.  Drag and drop the selected control from the Toolbox onto the dialog box area.  \n  \n5.  For this example, a text label control \"Caption :\" and an edit box control with an **IDC_CAPTION** identifier are sufficient.  \n  \n6.  Click **Save** on the Toolbar to save your changes.  \n  \n Now that the user interface has been modified, you need to link the edit box with the Caption property. This is done in the following section by editing the `CSamplePropPage::DoDataExchange` function.  \n  \n##  <a name=\"_core_customizing_the_dodataexchange_function\"></a> Customizing the DoDataExchange Function  \n Your property page [CWnd::DoDataExchange](../mfc/reference/cwnd-class.md#cwnd__dodataexchange) function allows you to link property page values with the actual values of properties in the control. To establish links, you must map the appropriate property page fields to their respective control properties.  \n  \n These mappings are implemented using the property page **DDP_** functions. The **DDP_** functions work like the **DDX_** functions used in standard MFC dialogs, with one exception. In addition to the reference to a member variable, **DDP_** functions take the name of the control property. The following is a typical entry in the `DoDataExchange` function for a property page.  \n  \n [!code-cpp[NVC_MFC_AxUI#31](../mfc/codesnippet/cpp/mfc-activex-controls-property-pages_1.cpp)]  \n  \n This function associates the property page's `m_caption` member variable with the Caption, using the `DDP_TEXT` function.  \n  \n After you have the property page control inserted, you need to establish a link between the property page control, `IDC_CAPTION`, and the actual control property, Caption, using the **DDP_Text** function as described above.  \n  \n [Property Pages](../mfc/reference/property-pages-mfc.md) are available for other dialog control types, such as check boxes, radio buttons, and list boxes. The table below lists the entire set of property page **DDP_** functions and their purposes:  \n  \n### Property Page Functions  \n  \n|Function name|Use this function to link|  \n|-------------------|-------------------------------|  \n|`DDP_CBIndex`|The selected string's index in a combo box with a control property.|  \n|`DDP_CBString`|The selected string in a combo box with a control property. The selected string can begin with the same letters as the property's value but need not match it fully.|  \n|`DDP_CBStringExact`|The selected string in a combo box with a control property. The selected string and the property's string value must match exactly.|  \n|`DDP_Check`|A check box with a control property.|  \n|`DDP_LBIndex`|The selected string's index in a list box with a control property.|  \n|`DDP_LBString`|The selected string in a list box with a control property. The selected string can begin with the same letters as the property's value but need not match it fully.|  \n|`DDP_LBStringExact`|The selected string in a list box with a control property. The selected string and the property's string value must match exactly.|  \n|`DDP_Radio`|A radio button with a control property.|  \n|**DDP_Text**|Text with a control property.|  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)   \n [COlePropertyPage Class](../mfc/reference/colepropertypage-class.md)\n"}