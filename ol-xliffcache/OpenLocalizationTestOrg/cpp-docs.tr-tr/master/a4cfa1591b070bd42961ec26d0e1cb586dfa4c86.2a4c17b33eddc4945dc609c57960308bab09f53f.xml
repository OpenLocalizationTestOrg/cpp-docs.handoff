{"nodes":[{"pos":[12,88],"content":"How to: Convert an Existing MFC Ribbon to a Ribbon Resource | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Convert an Existing MFC Ribbon to a Ribbon Resource | Microsoft Docs","pos":[0,76]}]},{"content":"How to: Convert an Existing MFC Ribbon to a Ribbon Resource","pos":[693,752]},{"content":"Ribbon resources are easier to visualize, modify, and maintain than manually coded ribbons.","pos":[753,844]},{"content":"This topic describes how to convert a manually coded ribbon in an MFC Project into a ribbon resource.","pos":[845,946]},{"pos":[953,1115],"content":"You must have an existing MFC project that has code that uses the MFC ribbon classes, for example, <bpt id=\"p1\">[</bpt>CMFCRibbonBar Class<ept id=\"p1\">](../mfc/reference/cmfcribbonbar-class.md)</ept>.","source":"You must have an existing MFC project that has code that uses the MFC ribbon classes, for example, [CMFCRibbonBar Class](../mfc/reference/cmfcribbonbar-class.md)."},{"content":"To convert an MFC ribbon to a ribbon resource","pos":[1125,1170]},{"content":"In Visual Studio, in an existing MFC project, open the source file where the CMFCRibbonBar object is initialized.","pos":[1180,1293]},{"content":"Typically, the file is mainfrm.cpp.","pos":[1294,1329]},{"content":"Add the following code after the initialization code for the ribbon.","pos":[1330,1398]},{"content":"Save and close the file.","pos":[1481,1505]},{"content":"Build and run the MFC application, and then in Notepad, open RibbonOutput.txt and copy its contents.","pos":[1515,1615]},{"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Add Resource<ept id=\"p2\">**</ept>.","pos":[1625,1691],"source":"In Visual Studio, on the **Project** menu, click **Add Resource**."},{"content":"In the <bpt id=\"p1\">**</bpt>Add Resource<ept id=\"p1\">**</ept> dialog box, select <bpt id=\"p2\">**</bpt>Ribbon<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>New<ept id=\"p3\">**</ept>.","pos":[1692,1769],"source":" In the **Add Resource** dialog box, select **Ribbon** and then click **New**."},{"content":"Visual Studio creates a ribbon resource and opens it in design view.","pos":[1780,1848]},{"content":"The ribbon resource ID is IDR_RIBBON1, which is displayed in <bpt id=\"p1\">**</bpt>Resource View<ept id=\"p1\">**</ept>.","pos":[1849,1928],"source":" The ribbon resource ID is IDR_RIBBON1, which is displayed in **Resource View**."},{"content":"The ribbon is defined in the ribbon1.mfcribbon-ms XML file.","pos":[1929,1988]},{"content":"In Visual Studio, open ribbon1.mfcribbon-ms, delete its contents, and then paste the contents of RibbonOutput.txt, which you copied earlier.","pos":[1998,2138]},{"content":"Save and close ribbon1.mfcribbon-ms.","pos":[2139,2175]},{"content":"Again open the source file where the CMFCRibbonBar object is initialized (typically, mainfrm.cpp) and comment out the existing ribbon code.","pos":[2185,2324]},{"content":"Add the following code after the code that you commented out.","pos":[2325,2386]},{"content":"Build the project and run the program.","pos":[2464,2502]},{"content":"See Also","pos":[2511,2519]},{"content":"Ribbon Designer (MFC)","pos":[2524,2545]}],"content":"---\ntitle: \"How to: Convert an Existing MFC Ribbon to a Ribbon Resource | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ribbon resource, converting from an MFC ribbon\"\n  - \"MFC ribbon, converting to a ribbon resource\"\nms.assetid: 324b7ff6-58f9-4691-96a9-9836a79d0fb6\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Convert an Existing MFC Ribbon to a Ribbon Resource\nRibbon resources are easier to visualize, modify, and maintain than manually coded ribbons. This topic describes how to convert a manually coded ribbon in an MFC Project into a ribbon resource.  \n  \n You must have an existing MFC project that has code that uses the MFC ribbon classes, for example, [CMFCRibbonBar Class](../mfc/reference/cmfcribbonbar-class.md).  \n  \n### To convert an MFC ribbon to a ribbon resource  \n  \n1.  In Visual Studio, in an existing MFC project, open the source file where the CMFCRibbonBar object is initialized. Typically, the file is mainfrm.cpp. Add the following code after the initialization code for the ribbon.  \n  \n ```  \n    m_wndRibbonBar.SaveToXMLFile(\"RibbonOutput.xml\");\n\n ```  \n  \n     Save and close the file.  \n  \n2.  Build and run the MFC application, and then in Notepad, open RibbonOutput.txt and copy its contents.  \n  \n3.  In Visual Studio, on the **Project** menu, click **Add Resource**. In the **Add Resource** dialog box, select **Ribbon** and then click **New**.  \n  \n     Visual Studio creates a ribbon resource and opens it in design view. The ribbon resource ID is IDR_RIBBON1, which is displayed in **Resource View**. The ribbon is defined in the ribbon1.mfcribbon-ms XML file.  \n  \n4.  In Visual Studio, open ribbon1.mfcribbon-ms, delete its contents, and then paste the contents of RibbonOutput.txt, which you copied earlier. Save and close ribbon1.mfcribbon-ms.  \n  \n5.  Again open the source file where the CMFCRibbonBar object is initialized (typically, mainfrm.cpp) and comment out the existing ribbon code. Add the following code after the code that you commented out.  \n  \n ```  \n    m_wndRibbonBar.LoadFromResource(IDR_RIBBON1);\n\n ```  \n  \n6.  Build the project and run the program.  \n  \n## See Also  \n [Ribbon Designer (MFC)](../mfc/ribbon-designer-mfc.md)\n\n"}