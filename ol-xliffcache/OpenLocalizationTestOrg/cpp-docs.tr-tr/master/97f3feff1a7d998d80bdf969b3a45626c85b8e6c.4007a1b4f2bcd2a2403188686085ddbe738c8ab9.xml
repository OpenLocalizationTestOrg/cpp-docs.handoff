{"nodes":[{"pos":[12,59],"content":"Creating a CToolBarCtrl Object | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Creating a CToolBarCtrl Object | Microsoft Docs","pos":[0,47]}]},{"content":"Creating a CToolBarCtrl Object","pos":[678,708]},{"content":"<bpt id=\"p1\">[</bpt>CToolBarCtrl<ept id=\"p1\">](../mfc/reference/ctoolbarctrl-class.md)</ept> objects contain several internal data structures — a list of button image bitmaps, a list of button label strings, and a list of <ph id=\"ph1\">`TBBUTTON`</ph> structures — that associate an image and/or string with the position, style, state, and command ID of the button.","pos":[709,1017],"source":"[CToolBarCtrl](../mfc/reference/ctoolbarctrl-class.md) objects contain several internal data structures — a list of button image bitmaps, a list of button label strings, and a list of `TBBUTTON` structures — that associate an image and/or string with the position, style, state, and command ID of the button."},{"content":"Each of the elements of these data structures is referred to by a zero-based index.","pos":[1018,1101]},{"content":"Before you can use a <ph id=\"ph1\">`CToolBarCtrl`</ph> object, you must set up these data structures.","pos":[1102,1184],"source":" Before you can use a `CToolBarCtrl` object, you must set up these data structures."},{"content":"For a list of the data structures, see <bpt id=\"p1\">[</bpt>Toolbar Controls<ept id=\"p1\">](https://msdn.microsoft.com/library/47xcww9x.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]</ph>.","pos":[1185,1349],"source":" For a list of the data structures, see [Toolbar Controls](https://msdn.microsoft.com/library/47xcww9x.aspx) in the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]."},{"content":"The list of strings can only be used for button labels; you cannot retrieve strings from the toolbar.","pos":[1350,1451]},{"pos":[1458,1528],"content":"To use a <ph id=\"ph1\">`CToolBarCtrl`</ph> object, you will typically follow these steps:","source":"To use a `CToolBarCtrl` object, you will typically follow these steps:"},{"content":"To use a CToolBarCtrl object","pos":[1538,1566]},{"pos":[1576,1652],"content":"Construct the <bpt id=\"p1\">[</bpt>CToolBarCtrl<ept id=\"p1\">](../mfc/reference/ctoolbarctrl-class.md)</ept> object.","source":"Construct the [CToolBarCtrl](../mfc/reference/ctoolbarctrl-class.md) object."},{"content":"Call <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__create)</ept> to create the Windows toolbar common control and attach it to the <ph id=\"ph1\">`CToolBarCtrl`</ph> object.","pos":[1662,1825],"source":"Call [Create](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__create) to create the Windows toolbar common control and attach it to the `CToolBarCtrl` object."},{"content":"If you want bitmap images for buttons, add the button bitmaps to the toolbar by calling <bpt id=\"p1\">[</bpt>AddBitmap<ept id=\"p1\">](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addbitmap)</ept>.","pos":[1826,1990],"source":" If you want bitmap images for buttons, add the button bitmaps to the toolbar by calling [AddBitmap](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addbitmap)."},{"content":"If you want string labels for buttons, add the strings to the toolbar by calling <bpt id=\"p1\">[</bpt>AddString<ept id=\"p1\">](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addstring)</ept> and/or <bpt id=\"p2\">[</bpt>AddStrings<ept id=\"p2\">](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addstrings)</ept>.","pos":[1991,2233],"source":" If you want string labels for buttons, add the strings to the toolbar by calling [AddString](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addstring) and/or [AddStrings](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addstrings)."},{"content":"After calling <ph id=\"ph1\">`AddString`</ph> and/or <ph id=\"ph2\">`AddStrings`</ph>, you should call <bpt id=\"p1\">[</bpt>AutoSize<ept id=\"p1\">](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__autosize)</ept> in order to get the string or strings to appear.","pos":[2234,2419],"source":" After calling `AddString` and/or `AddStrings`, you should call [AutoSize](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__autosize) in order to get the string or strings to appear."},{"pos":[2429,2555],"content":"Add button structures to the toolbar by calling <bpt id=\"p1\">[</bpt>AddButtons<ept id=\"p1\">](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addbuttons)</ept>.","source":"Add button structures to the toolbar by calling [AddButtons](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addbuttons)."},{"pos":[2565,2744],"content":"If you want tool tips, handle <bpt id=\"p1\">**</bpt>TTN_NEEDTEXT<ept id=\"p1\">**</ept> messages in the toolbar's owner window as described in <bpt id=\"p2\">[</bpt>Handling Tool Tip Notifications<ept id=\"p2\">](../mfc/handling-tool-tip-notifications.md)</ept>.","source":"If you want tool tips, handle **TTN_NEEDTEXT** messages in the toolbar's owner window as described in [Handling Tool Tip Notifications](../mfc/handling-tool-tip-notifications.md)."},{"pos":[2754,2979],"content":"If you want your user to be able to customize the toolbar, handle customization notification messages in the owner window as described in <bpt id=\"p1\">[</bpt>Handling Customization Notifications<ept id=\"p1\">](../mfc/handling-customization-notifications.md)</ept>.","source":"If you want your user to be able to customize the toolbar, handle customization notification messages in the owner window as described in [Handling Customization Notifications](../mfc/handling-customization-notifications.md)."},{"content":"See Also","pos":[2988,2996]},{"content":"Using CToolBarCtrl","pos":[3001,3019]},{"content":"Controls","pos":[3056,3064]}],"content":"---\ntitle: \"Creating a CToolBarCtrl Object | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"CToolBarCtrl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"toolbar controls [MFC], creating\"\n  - \"CToolBarCtrl class, creating toolbars\"\nms.assetid: a4f6bf0c-0195-4dbf-a09e-aee503e19dc3\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Creating a CToolBarCtrl Object\n[CToolBarCtrl](../mfc/reference/ctoolbarctrl-class.md) objects contain several internal data structures — a list of button image bitmaps, a list of button label strings, and a list of `TBBUTTON` structures — that associate an image and/or string with the position, style, state, and command ID of the button. Each of the elements of these data structures is referred to by a zero-based index. Before you can use a `CToolBarCtrl` object, you must set up these data structures. For a list of the data structures, see [Toolbar Controls](https://msdn.microsoft.com/library/47xcww9x.aspx) in the [!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]. The list of strings can only be used for button labels; you cannot retrieve strings from the toolbar.  \n  \n To use a `CToolBarCtrl` object, you will typically follow these steps:  \n  \n### To use a CToolBarCtrl object  \n  \n1.  Construct the [CToolBarCtrl](../mfc/reference/ctoolbarctrl-class.md) object.  \n  \n2.  Call [Create](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__create) to create the Windows toolbar common control and attach it to the `CToolBarCtrl` object. If you want bitmap images for buttons, add the button bitmaps to the toolbar by calling [AddBitmap](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addbitmap). If you want string labels for buttons, add the strings to the toolbar by calling [AddString](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addstring) and/or [AddStrings](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addstrings). After calling `AddString` and/or `AddStrings`, you should call [AutoSize](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__autosize) in order to get the string or strings to appear.  \n  \n3.  Add button structures to the toolbar by calling [AddButtons](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__addbuttons).  \n  \n4.  If you want tool tips, handle **TTN_NEEDTEXT** messages in the toolbar's owner window as described in [Handling Tool Tip Notifications](../mfc/handling-tool-tip-notifications.md).  \n  \n5.  If you want your user to be able to customize the toolbar, handle customization notification messages in the owner window as described in [Handling Customization Notifications](../mfc/handling-customization-notifications.md).  \n  \n## See Also  \n [Using CToolBarCtrl](../mfc/using-ctoolbarctrl.md)   \n [Controls](../mfc/controls-mfc.md)\n\n"}