{"nodes":[{"pos":[12,42],"content":"Dispatch Maps | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Dispatch Maps | Microsoft Docs","pos":[0,30]}]},{"content":"Dispatch Maps","pos":[658,671]},{"content":"OLE Automation provides ways to call methods and to access properties across applications.","pos":[672,762]},{"content":"The mechanism supplied by the Microsoft Foundation Class Library for dispatching these requests is the \"dispatch map,\" which designates the internal and external names of object functions and properties, as well as the data types of the properties themselves and of function arguments.","pos":[763,1048]},{"content":"Dispatch Maps","pos":[1058,1071]},{"content":"DECLARE_DISPATCH_MAP","pos":[1093,1113]},{"content":"Declares that a dispatch map will be used to expose a class's methods and properties (must be used in the class declaration).","pos":[1138,1263]},{"content":"BEGIN_DISPATCH_MAP","pos":[1269,1287]},{"content":"Starts the definition of a dispatch map.","pos":[1310,1350]},{"content":"END_DISPATCH_MAP","pos":[1356,1372]},{"content":"Ends the definition of a dispatch map.","pos":[1393,1431]},{"content":"DISP_FUNCTION","pos":[1437,1450]},{"content":"Used in a dispatch map to define an OLE automation function.","pos":[1468,1528]},{"content":"DISP_PROPERTY","pos":[1534,1547]},{"content":"Defines an OLE automation property.","pos":[1565,1600]},{"content":"DISP_PROPERTY_EX","pos":[1606,1622]},{"content":"Defines an OLE automation property and names the Get and Set functions.","pos":[1643,1714]},{"content":"DISP_PROPERTY_NOTIFY","pos":[1720,1740]},{"content":"Defines an OLE automation property with notification.","pos":[1765,1818]},{"content":"DISP_PROPERTY_PARAM","pos":[1824,1843]},{"content":"Defines an OLE automation property that takes parameters and names the Get and Set functions.","pos":[1867,1960]},{"content":"DISP_DEFVALUE","pos":[1966,1979]},{"content":"Makes an existing property the default value of an object.","pos":[1997,2055]},{"pos":[2103,2123],"content":"DECLARE_DISPATCH_MAP"},{"pos":[2127,2276],"content":"If a <ph id=\"ph1\">`CCmdTarget`</ph>-derived class in your program supports OLE Automation, that class must provide a dispatch map to expose its methods and properties.","source":"If a `CCmdTarget`-derived class in your program supports OLE Automation, that class must provide a dispatch map to expose its methods and properties."},{"content":"Remarks","pos":[2327,2334]},{"content":"Use the <ph id=\"ph1\">`DECLARE_DISPATCH_MAP`</ph> macro at the end of your class declaration.","pos":[2338,2412],"source":"Use the `DECLARE_DISPATCH_MAP` macro at the end of your class declaration."},{"content":"Then, in the .CPP file that defines the member functions for the class, use the <ph id=\"ph1\">`BEGIN_DISPATCH_MAP`</ph> macro.","pos":[2413,2520],"source":" Then, in the .CPP file that defines the member functions for the class, use the `BEGIN_DISPATCH_MAP` macro."},{"content":"Then include macro entries for each of your class's exposed methods and properties ( <ph id=\"ph1\">`DISP_FUNCTION`</ph>, <ph id=\"ph2\">`DISP_PROPERTY`</ph>, and so on).","pos":[2521,2651],"source":" Then include macro entries for each of your class's exposed methods and properties ( `DISP_FUNCTION`, `DISP_PROPERTY`, and so on)."},{"content":"Finally, use the <ph id=\"ph1\">`END_DISPATCH_MAP`</ph> macro.","pos":[2652,2694],"source":" Finally, use the `END_DISPATCH_MAP` macro."},{"pos":[2702,2855],"content":"[!NOTE]\n If you declare any members after `DECLARE_DISPATCH_MAP`, you must specify a new access type ( **public**, `private`, or `protected`) for them.","leadings":["","> "],"nodes":[{"content":"If you declare any members after <ph id=\"ph1\">`DECLARE_DISPATCH_MAP`</ph>, you must specify a new access type ( <bpt id=\"p1\">**</bpt>public<ept id=\"p1\">**</ept>, <ph id=\"ph2\">`private`</ph>, or <ph id=\"ph3\">`protected`</ph>) for them.","pos":[9,151],"source":" If you declare any members after `DECLARE_DISPATCH_MAP`, you must specify a new access type ( **public**, `private`, or `protected`) for them."}]},{"content":"The Application Wizard and code wizards assist in creating Automation classes and in maintaining dispatch maps.","pos":[2862,2973]},{"content":"For more information on dispatch maps, see <bpt id=\"p1\">[</bpt>Automation Servers<ept id=\"p1\">](../../mfc/automation-servers.md)</ept>.","pos":[2974,3071],"source":" For more information on dispatch maps, see [Automation Servers](../../mfc/automation-servers.md)."},{"content":"Example","pos":[3081,3088]},{"pos":[3103,3123],"content":"NVC_MFCAutomation#10"},{"pos":[3215,3233],"content":"BEGIN_DISPATCH_MAP"},{"content":"Declares the definition of your dispatch map.","pos":[3237,3282]},{"content":"Parameters","pos":[3350,3360]},{"content":"Specifies the name of the class that owns this dispatch map.","pos":[3378,3438]},{"content":"Specifies the base class name of <ph id=\"ph1\">`theClass`</ph>.","pos":[3460,3504],"source":" Specifies the base class name of `theClass`."},{"content":"Remarks","pos":[3514,3521]},{"pos":[3525,3803],"content":"In the implementation (.cpp) file that defines the member functions for your class, start the dispatch map with the <ph id=\"ph1\">`BEGIN_DISPATCH_MAP`</ph> macro, add macro entries for each of your dispatch functions and properties, and complete the dispatch map with the <ph id=\"ph2\">`END_DISPATCH_MAP`</ph> macro.","source":"In the implementation (.cpp) file that defines the member functions for your class, start the dispatch map with the `BEGIN_DISPATCH_MAP` macro, add macro entries for each of your dispatch functions and properties, and complete the dispatch map with the `END_DISPATCH_MAP` macro."},{"pos":[3846,3862],"content":"END_DISPATCH_MAP"},{"content":"Ends the definition of your dispatch map.","pos":[3866,3907]},{"content":"Remarks","pos":[3954,3961]},{"pos":[3965,4022],"content":"It must be used in conjunction with <ph id=\"ph1\">`BEGIN_DISPATCH_MAP`</ph>.","source":"It must be used in conjunction with `BEGIN_DISPATCH_MAP`."},{"pos":[4062,4075],"content":"DISP_FUNCTION"},{"content":"Defines an OLE automation function in a dispatch map.","pos":[4079,4132]},{"content":"Parameters","pos":[4226,4236]},{"content":"Name of the class.","pos":[4254,4272]},{"content":"External name of the function.","pos":[4292,4322]},{"content":"Name of the member function.","pos":[4344,4372]},{"content":"A value specifying the function's return type.","pos":[4393,4439]},{"content":"A space-separated list of one or more constants specifying the function's parameter list.","pos":[4461,4550]},{"content":"Remarks","pos":[4560,4567]},{"content":"The <ph id=\"ph1\">`vtRetVal`</ph> argument is of type <bpt id=\"p1\">**</bpt>VARTYPE<ept id=\"p1\">**</ept>.","pos":[4571,4618],"source":"The `vtRetVal` argument is of type **VARTYPE**."},{"content":"The following possible values for this argument are taken from the <ph id=\"ph1\">`VARENUM`</ph> enumeration:","pos":[4619,4708],"source":" The following possible values for this argument are taken from the `VARENUM` enumeration:"},{"content":"Symbol","pos":[4715,4721]},{"content":"Return type","pos":[4722,4733]},{"content":"short","pos":[4805,4810]},{"content":"long","pos":[4827,4831]},{"content":"float","pos":[4848,4853]},{"content":"double","pos":[4870,4876]},{"content":"CY","pos":[4893,4895]},{"content":"DATE","pos":[4914,4918]},{"content":"VT_DISPATCH","pos":[4948,4959]},{"content":"BOOL","pos":[5014,5018]},{"content":"VT_VARIANT","pos":[5027,5037]},{"content":"VARIANT","pos":[5042,5049]},{"content":"VT_UNKNOWN","pos":[5058,5068]},{"content":"The <ph id=\"ph1\">`vtsParams`</ph> argument is a space-separated list of values from the <bpt id=\"p1\">**</bpt>VTS_<ept id=\"p1\">**</ept> constants.","pos":[5090,5179],"source":"The `vtsParams` argument is a space-separated list of values from the **VTS_** constants."},{"content":"One or more of these values separated by spaces (not commas) specifies the function's parameter list.","pos":[5180,5281]},{"content":"For example,","pos":[5282,5294]},{"pos":[5311,5331],"content":"NVC_MFCAutomation#14"},{"content":"specifies a list containing a short integer followed by a pointer to a short integer.","pos":[5387,5472]},{"pos":[5479,5536],"content":"The <bpt id=\"p1\">**</bpt>VTS_<ept id=\"p1\">**</ept> constants and their meanings are as follows:","source":"The **VTS_** constants and their meanings are as follows:"},{"content":"Symbol","pos":[5543,5549]},{"content":"Parameter type","pos":[5550,5564]},{"content":"VTS_I2","pos":[5609,5615]},{"content":"VTS_I4","pos":[5632,5638]},{"content":"VTS_R4","pos":[5654,5660]},{"content":"Float","pos":[5665,5670]},{"content":"VTS_R8","pos":[5679,5685]},{"content":"VTS_CY","pos":[5703,5709]},{"pos":[5712,5736],"content":"<bpt id=\"p1\">**</bpt>const CY<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>CY<ph id=\"ph1\">\\*</ph><ept id=\"p2\">**</ept>","source":"**const CY** or **CY\\***"},{"content":"VTS_DATE","pos":[5743,5751]},{"content":"DATE","pos":[5756,5760]},{"content":"VTS_BSTR","pos":[5769,5777]},{"content":"VTS_DISPATCH","pos":[5795,5807]},{"content":"VTS_SCODE","pos":[5829,5838]},{"content":"VTS_BOOL","pos":[5855,5863]},{"content":"BOOL","pos":[5868,5872]},{"content":"VTS_VARIANT","pos":[5881,5892]},{"pos":[5895,5930],"content":"<bpt id=\"p1\">**</bpt>const VARIANT<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>VARIANT&amp;<ept id=\"p2\">**</ept>","source":"**const VARIANT\\*** or **VARIANT&**"},{"content":"VTS_UNKNOWN","pos":[5937,5948]},{"content":"VTS_PI2","pos":[5969,5976]},{"content":"short","pos":[5981,5986]},{"content":"VTS_PI4","pos":[5997,6004]},{"content":"long","pos":[6009,6013]},{"content":"VTS_PR4","pos":[6024,6031]},{"content":"float","pos":[6036,6041]},{"content":"VTS_PR8","pos":[6052,6059]},{"content":"double","pos":[6064,6070]},{"content":"VTS_PCY","pos":[6081,6088]},{"content":"CY","pos":[6093,6095]},{"content":"VTS_PDATE","pos":[6106,6115]},{"content":"DATE","pos":[6120,6124]},{"content":"VTS_PBSTR","pos":[6135,6144]},{"content":"BSTR","pos":[6149,6153]},{"content":"VTS_PDISPATCH","pos":[6164,6177]},{"content":"LPDISPATCH","pos":[6182,6192]},{"content":"VTS_PSCODE","pos":[6203,6213]},{"content":"SCODE","pos":[6218,6223]},{"content":"VTS_PBOOL","pos":[6234,6243]},{"content":"BOOL","pos":[6248,6252]},{"content":"VTS_PVARIANT","pos":[6263,6275]},{"content":"VARIANT","pos":[6280,6287]},{"content":"VTS_PUNKNOWN","pos":[6298,6310]},{"content":"LPUNKNOWN","pos":[6315,6324]},{"content":"VTS_NONE","pos":[6335,6343]},{"content":"No parameters","pos":[6346,6359]},{"pos":[6400,6413],"content":"DISP_PROPERTY"},{"content":"Defines an OLE automation property in a dispatch map.","pos":[6417,6470]},{"content":"Parameters","pos":[6556,6566]},{"content":"Name of the class.","pos":[6584,6602]},{"content":"External name of the property.","pos":[6622,6652]},{"content":"Name of the member variable in which the property is stored.","pos":[6675,6735]},{"content":"A value specifying the property's type.","pos":[6758,6797]},{"content":"Remarks","pos":[6807,6814]},{"content":"The <ph id=\"ph1\">`vtPropType`</ph> argument is of type <bpt id=\"p1\">**</bpt>VARTYPE<ept id=\"p1\">**</ept>.","pos":[6818,6867],"source":"The `vtPropType` argument is of type **VARTYPE**."},{"content":"Possible values for this argument are taken from the <ph id=\"ph1\">`VARENUM`</ph> enumeration:","pos":[6868,6943],"source":" Possible values for this argument are taken from the `VARENUM` enumeration:"},{"content":"Symbol","pos":[6950,6956]},{"content":"Property type","pos":[6959,6972]},{"content":"short","pos":[7030,7035]},{"content":"long","pos":[7052,7056]},{"content":"float","pos":[7073,7078]},{"content":"double","pos":[7095,7101]},{"content":"CY","pos":[7118,7120]},{"content":"DATE","pos":[7139,7143]},{"content":"VT_DISPATCH","pos":[7176,7187]},{"content":"BOOL","pos":[7242,7246]},{"content":"VT_VARIANT","pos":[7255,7265]},{"content":"VARIANT","pos":[7270,7277]},{"content":"VT_UNKNOWN","pos":[7286,7296]},{"pos":[7318,7471],"content":"When an external client changes the property, the value of the member variable specified by <ph id=\"ph1\">`memberName`</ph> changes; there is no notification of the change.","source":"When an external client changes the property, the value of the member variable specified by `memberName` changes; there is no notification of the change."},{"pos":[7514,7530],"content":"DISP_PROPERTY_EX"},{"content":"Defines an OLE automation property and name the functions used to get and set the property's value in a dispatch map.","pos":[7534,7651]},{"content":"Parameters","pos":[7750,7760]},{"content":"Name of the class.","pos":[7778,7796]},{"content":"External name of the property.","pos":[7816,7846]},{"content":"Name of the member function used to get the property.","pos":[7868,7921]},{"content":"Name of the member function used to set the property.","pos":[7943,7996]},{"content":"A value specifying the property's type.","pos":[8019,8058]},{"content":"Remarks","pos":[8068,8075]},{"content":"The <ph id=\"ph1\">`memberGet`</ph> and <ph id=\"ph2\">`memberSet`</ph> functions have signatures determined by the <ph id=\"ph3\">`vtPropType`</ph> argument.","pos":[8079,8177],"source":"The `memberGet` and `memberSet` functions have signatures determined by the `vtPropType` argument."},{"content":"The <ph id=\"ph1\">`memberGet`</ph> function takes no arguments and returns a value of the type specified by <ph id=\"ph2\">`vtPropType`</ph>.","pos":[8178,8280],"source":" The `memberGet` function takes no arguments and returns a value of the type specified by `vtPropType`."},{"content":"The <ph id=\"ph1\">`memberSet`</ph> function takes an argument of the type specified by <ph id=\"ph2\">`vtPropType`</ph> and returns nothing.","pos":[8281,8382],"source":" The `memberSet` function takes an argument of the type specified by `vtPropType` and returns nothing."},{"content":"The <ph id=\"ph1\">`vtPropType`</ph> argument is of type <bpt id=\"p1\">**</bpt>VARTYPE<ept id=\"p1\">**</ept>.","pos":[8389,8438],"source":"The `vtPropType` argument is of type **VARTYPE**."},{"content":"Possible values for this argument are taken from the <ph id=\"ph1\">`VARENUM`</ph> enumeration.","pos":[8439,8514],"source":" Possible values for this argument are taken from the `VARENUM` enumeration."},{"content":"For a list of these values, see the Remarks for the <ph id=\"ph1\">`vtRetVal`</ph> parameter in <bpt id=\"p1\">[</bpt>DISP_FUNCTION<ept id=\"p1\">](#disp_function)</ept>.","pos":[8515,8623],"source":" For a list of these values, see the Remarks for the `vtRetVal` parameter in [DISP_FUNCTION](#disp_function)."},{"content":"Note that <ph id=\"ph1\">`VT_EMPTY`</ph>, listed in the <ph id=\"ph2\">`DISP_FUNCTION`</ph> remarks, is not permitted as a property data type.","pos":[8624,8726],"source":" Note that `VT_EMPTY`, listed in the `DISP_FUNCTION` remarks, is not permitted as a property data type."},{"pos":[8773,8793],"content":"DISP_PROPERTY_NOTIFY"},{"content":"Defines an OLE automation property with notification in a dispatch map.","pos":[8797,8868]},{"content":"Parameters","pos":[8981,8991]},{"content":"Name of the class.","pos":[9009,9027]},{"content":"External name of the property.","pos":[9054,9084]},{"content":"Name of the member variable in which the property is stored.","pos":[9107,9167]},{"content":"Name of the notification function for <ph id=\"ph1\">`szExternalName`</ph>.","pos":[9191,9246],"source":" Name of the notification function for `szExternalName`."},{"content":"A value specifying the property's type.","pos":[9269,9308]},{"content":"Remarks","pos":[9318,9325]},{"pos":[9329,9517],"content":"Unlike properties defined with <ph id=\"ph1\">`DISP_PROPERTY`</ph>, a property defined with <ph id=\"ph2\">`DISP_PROPERTY_NOTIFY`</ph> will automatically call the function specified by <ph id=\"ph3\">`pfnAfterSet`</ph> when the property is changed.","source":"Unlike properties defined with `DISP_PROPERTY`, a property defined with `DISP_PROPERTY_NOTIFY` will automatically call the function specified by `pfnAfterSet` when the property is changed."},{"content":"The <ph id=\"ph1\">`vtPropType`</ph> argument is of type <bpt id=\"p1\">**</bpt>VARTYPE<ept id=\"p1\">**</ept>.","pos":[9524,9573],"source":"The `vtPropType` argument is of type **VARTYPE**."},{"content":"Possible values for this argument are taken from the <ph id=\"ph1\">`VARENUM`</ph> enumeration:","pos":[9574,9649],"source":" Possible values for this argument are taken from the `VARENUM` enumeration:"},{"content":"Symbol","pos":[9656,9662]},{"content":"Property type","pos":[9665,9678]},{"content":"short","pos":[9736,9741]},{"content":"long","pos":[9758,9762]},{"content":"float","pos":[9779,9784]},{"content":"double","pos":[9801,9807]},{"content":"CY","pos":[9824,9826]},{"content":"DATE","pos":[9845,9849]},{"content":"VT_DISPATCH","pos":[9882,9893]},{"content":"BOOL","pos":[9948,9952]},{"content":"VT_VARIANT","pos":[9961,9971]},{"content":"VARIANT","pos":[9976,9983]},{"content":"VT_UNKNOWN","pos":[9992,10002]},{"pos":[10063,10082],"content":"DISP_PROPERTY_PARAM"},{"pos":[10086,10163],"content":"Defines a property accessed with separate <bpt id=\"p1\">**</bpt>Get<ept id=\"p1\">**</ept> and <ph id=\"ph1\">`Set`</ph> member functions.","source":"Defines a property accessed with separate **Get** and `Set` member functions."},{"content":"Parameters","pos":[10278,10288]},{"content":"Name of the class.","pos":[10306,10324]},{"content":"pszExternalName","pos":[10332,10347]},{"content":"External name of the property.","pos":[10352,10382]},{"content":"Name of the member function used to get the property.","pos":[10401,10454]},{"content":"Name of the member function used to set the property.","pos":[10473,10526]},{"content":"A value specifying the property's type.","pos":[10549,10588]},{"content":"A string of space-separated <bpt id=\"p1\">**</bpt>VTS_<ept id=\"p1\">**</ept> variant parameter types, one for each parameter.","pos":[10610,10695],"source":" A string of space-separated **VTS_** variant parameter types, one for each parameter."},{"content":"Remarks","pos":[10705,10712]},{"content":"Unlike the <ph id=\"ph1\">`DISP_PROPERTY_EX`</ph> macro, this macro allows you to specify a parameter list for the property.","pos":[10716,10820],"source":"Unlike the `DISP_PROPERTY_EX` macro, this macro allows you to specify a parameter list for the property."},{"content":"This is useful for implementing properties that are indexed or parameterized.","pos":[10821,10898]},{"content":"Example","pos":[10908,10915]},{"content":"Consider the following declaration of get and set member functions that allow the user to request a specific row and column when accessing the property:","pos":[10919,11071]},{"pos":[11089,11112],"content":"NVC_MFCActiveXControl#9"},{"pos":[11166,11256],"content":"These correspond to the following <ph id=\"ph1\">`DISP_PROPERTY_PARAM`</ph> macro in the control dispatch map:","source":"These correspond to the following `DISP_PROPERTY_PARAM` macro in the control dispatch map:"},{"pos":[11274,11298],"content":"NVC_MFCActiveXControl#10"},{"content":"As another example, consider the following get and set member functions:","pos":[11354,11426]},{"pos":[11444,11468],"content":"NVC_MFCActiveXControl#11"},{"pos":[11522,11612],"content":"These correspond to the following <ph id=\"ph1\">`DISP_PROPERTY_PARAM`</ph> macro in the control dispatch map:","source":"These correspond to the following `DISP_PROPERTY_PARAM` macro in the control dispatch map:"},{"pos":[11630,11654],"content":"NVC_MFCActiveXControl#12"},{"pos":[11743,11756],"content":"DISP_DEFVALUE"},{"content":"Makes an existing property the default value of an object.","pos":[11760,11818]},{"content":"Parameters","pos":[11880,11890]},{"content":"Name of the class.","pos":[11908,11926]},{"content":"External name of the property that represents the \"value\" of the object.","pos":[11946,12018]},{"content":"Remarks","pos":[12028,12035]},{"content":"Using a default value can make programming your automation object simpler for Visual Basic applications.","pos":[12039,12143]},{"content":"The \"default value\" of your object is the property that is retrieved or set when a reference to an object does not specify a property or member function.","pos":[12150,12303]},{"content":"See Also","pos":[12312,12320]},{"content":"Macros and Globals","pos":[12325,12343]}],"content":"---\ntitle: \"Dispatch Maps | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.mfc.macros.maps\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"dispatch maps. macros\"\n  - \"dispatch maps\"\n  - \"dispatch map macros\"\nms.assetid: bef9d08b-ad35-4c3a-99d8-04150c7c04e2\ncaps.latest.revision: 14\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Dispatch Maps\nOLE Automation provides ways to call methods and to access properties across applications. The mechanism supplied by the Microsoft Foundation Class Library for dispatching these requests is the \"dispatch map,\" which designates the internal and external names of object functions and properties, as well as the data types of the properties themselves and of function arguments.  \n  \n### Dispatch Maps  \n  \n|||  \n|-|-|  \n|[DECLARE_DISPATCH_MAP](#declare_dispatch_map)|Declares that a dispatch map will be used to expose a class's methods and properties (must be used in the class declaration).|  \n|[BEGIN_DISPATCH_MAP](#begin_dispatch_map)|Starts the definition of a dispatch map.|  \n|[END_DISPATCH_MAP](#end_dispatch_map)|Ends the definition of a dispatch map.|  \n|[DISP_FUNCTION](#disp_function)|Used in a dispatch map to define an OLE automation function.|  \n|[DISP_PROPERTY](#disp_property)|Defines an OLE automation property.|  \n|[DISP_PROPERTY_EX](#disp_property_ex)|Defines an OLE automation property and names the Get and Set functions.|  \n|[DISP_PROPERTY_NOTIFY](#disp_property_notify)|Defines an OLE automation property with notification.|  \n|[DISP_PROPERTY_PARAM](#disp_property_param)|Defines an OLE automation property that takes parameters and names the Get and Set functions.|  \n|[DISP_DEFVALUE](#disp_defvalue)|Makes an existing property the default value of an object.|  \n  \n##  <a name=\"declare_dispatch_map\"></a>  DECLARE_DISPATCH_MAP  \n If a `CCmdTarget`-derived class in your program supports OLE Automation, that class must provide a dispatch map to expose its methods and properties.  \n  \n```   \nDECLARE_DISPATCH_MAP()  \n```  \n  \n### Remarks  \n Use the `DECLARE_DISPATCH_MAP` macro at the end of your class declaration. Then, in the .CPP file that defines the member functions for the class, use the `BEGIN_DISPATCH_MAP` macro. Then include macro entries for each of your class's exposed methods and properties ( `DISP_FUNCTION`, `DISP_PROPERTY`, and so on). Finally, use the `END_DISPATCH_MAP` macro.  \n  \n> [!NOTE]\n>  If you declare any members after `DECLARE_DISPATCH_MAP`, you must specify a new access type ( **public**, `private`, or `protected`) for them.  \n  \n The Application Wizard and code wizards assist in creating Automation classes and in maintaining dispatch maps. For more information on dispatch maps, see [Automation Servers](../../mfc/automation-servers.md).  \n  \n### Example  \n [!code-cpp[NVC_MFCAutomation#10](../../mfc/codesnippet/cpp/dispatch-maps_1.h)]  \n  \n##  <a name=\"begin_dispatch_map\"></a>  BEGIN_DISPATCH_MAP  \n Declares the definition of your dispatch map.  \n  \n```  \nBEGIN_DISPATCH_MAP(theClass, baseClass)   \n```  \n  \n### Parameters  \n `theClass`  \n Specifies the name of the class that owns this dispatch map.  \n  \n `baseClass`  \n Specifies the base class name of `theClass`.  \n  \n### Remarks  \n In the implementation (.cpp) file that defines the member functions for your class, start the dispatch map with the `BEGIN_DISPATCH_MAP` macro, add macro entries for each of your dispatch functions and properties, and complete the dispatch map with the `END_DISPATCH_MAP` macro.  \n  \n##  <a name=\"end_dispatch_map\"></a>  END_DISPATCH_MAP  \n Ends the definition of your dispatch map.  \n  \n```   \nEND_DISPATCH_MAP()  \n```  \n  \n### Remarks  \n It must be used in conjunction with `BEGIN_DISPATCH_MAP`.  \n  \n##  <a name=\"disp_function\"></a>  DISP_FUNCTION  \n Defines an OLE automation function in a dispatch map.  \n  \n```   \nDISP_FUNCTION(theClass, pszName, pfnMember, vtRetVal, vtsParams)   \n```  \n  \n### Parameters  \n `theClass`  \n Name of the class.  \n  \n `pszName`  \n External name of the function.  \n  \n `pfnMember`  \n Name of the member function.  \n  \n `vtRetVal`  \n A value specifying the function's return type.  \n  \n `vtsParams`  \n A space-separated list of one or more constants specifying the function's parameter list.  \n  \n### Remarks  \n The `vtRetVal` argument is of type **VARTYPE**. The following possible values for this argument are taken from the `VARENUM` enumeration:  \n  \n|Symbol|Return type|  \n|------------|-----------------|  \n|`VT_EMPTY`|`void`|  \n|`VT_I2`|**short**|  \n|`VT_I4`|**long**|  \n|`VT_R4`|**float**|  \n|`VT_R8`|**double**|  \n|`VT_CY`|**CY**|  \n|`VT_DATE`|**DATE**|  \n|`VT_BSTR`|`BSTR`|  \n|**VT_DISPATCH**|`LPDISPATCH`|  \n|`VT_ERROR`|`SCODE`|  \n|`VT_BOOL`|**BOOL**|  \n|**VT_VARIANT**|**VARIANT**|  \n|**VT_UNKNOWN**|`LPUNKNOWN`|  \n  \n The `vtsParams` argument is a space-separated list of values from the **VTS_** constants. One or more of these values separated by spaces (not commas) specifies the function's parameter list. For example, \n  \n [!code-cpp[NVC_MFCAutomation#14](../../mfc/codesnippet/cpp/dispatch-maps_2.cpp)]  \n  \n specifies a list containing a short integer followed by a pointer to a short integer.  \n  \n The **VTS_** constants and their meanings are as follows:  \n  \n|Symbol|Parameter type|  \n|------------|--------------------|  \n|**VTS_I2**|`Short`|  \n|**VTS_I4**|`Long`|  \n|**VTS_R4**|**Float**|  \n|**VTS_R8**|`Double`|  \n|**VTS_CY**|**const CY** or **CY\\***|  \n|**VTS_DATE**|**DATE**|  \n|**VTS_BSTR**|`LPCSTR`|  \n|**VTS_DISPATCH**|`LPDISPATCH`|  \n|**VTS_SCODE**|`SCODE`|  \n|**VTS_BOOL**|**BOOL**|  \n|**VTS_VARIANT**|**const VARIANT\\*** or **VARIANT&**|  \n|**VTS_UNKNOWN**|`LPUNKNOWN`|  \n|**VTS_PI2**|**short\\***|  \n|**VTS_PI4**|**long\\***|  \n|**VTS_PR4**|**float\\***|  \n|**VTS_PR8**|**double\\***|  \n|**VTS_PCY**|**CY\\***|  \n|**VTS_PDATE**|**DATE\\***|  \n|**VTS_PBSTR**|**BSTR\\***|  \n|**VTS_PDISPATCH**|**LPDISPATCH\\***|  \n|**VTS_PSCODE**|**SCODE\\***|  \n|**VTS_PBOOL**|**BOOL\\***|  \n|**VTS_PVARIANT**|**VARIANT\\***|  \n|**VTS_PUNKNOWN**|**LPUNKNOWN\\***|  \n|**VTS_NONE**|No parameters|  \n  \n##  <a name=\"disp_property\"></a>  DISP_PROPERTY  \n Defines an OLE automation property in a dispatch map.  \n  \n```   \nDISP_PROPERTY(theClass, pszName, memberName, vtPropType)   \n```  \n  \n### Parameters  \n `theClass`  \n Name of the class.  \n  \n `pszName`  \n External name of the property.  \n  \n `memberName`  \n Name of the member variable in which the property is stored.  \n  \n `vtPropType`  \n A value specifying the property's type.  \n  \n### Remarks  \n The `vtPropType` argument is of type **VARTYPE**. Possible values for this argument are taken from the `VARENUM` enumeration:  \n  \n|Symbol|**Property type**|  \n|------------|-----------------------|  \n|`VT_I2`|**short**|  \n|`VT_I4`|**long**|  \n|`VT_R4`|**float**|  \n|`VT_R8`|**double**|  \n|`VT_CY`|**CY**|  \n|`VT_DATE`|**DATE**|  \n|`VT_BSTR`|`CString`|  \n|**VT_DISPATCH**|`LPDISPATCH`|  \n|`VT_ERROR`|`SCODE`|  \n|`VT_BOOL`|**BOOL**|  \n|**VT_VARIANT**|**VARIANT**|  \n|**VT_UNKNOWN**|`LPUNKNOWN`|  \n  \n When an external client changes the property, the value of the member variable specified by `memberName` changes; there is no notification of the change.  \n  \n##  <a name=\"disp_property_ex\"></a>  DISP_PROPERTY_EX  \n Defines an OLE automation property and name the functions used to get and set the property's value in a dispatch map.  \n  \n```   \nDISP_PROPERTY_EX(theClass, pszName, memberGet, memberSet, vtPropType)   \n```  \n  \n### Parameters  \n `theClass`  \n Name of the class.  \n  \n `pszName`  \n External name of the property.  \n  \n `memberGet`  \n Name of the member function used to get the property.  \n  \n `memberSet`  \n Name of the member function used to set the property.  \n  \n `vtPropType`  \n A value specifying the property's type.  \n  \n### Remarks  \n The `memberGet` and `memberSet` functions have signatures determined by the `vtPropType` argument. The `memberGet` function takes no arguments and returns a value of the type specified by `vtPropType`. The `memberSet` function takes an argument of the type specified by `vtPropType` and returns nothing.  \n  \n The `vtPropType` argument is of type **VARTYPE**. Possible values for this argument are taken from the `VARENUM` enumeration. For a list of these values, see the Remarks for the `vtRetVal` parameter in [DISP_FUNCTION](#disp_function). Note that `VT_EMPTY`, listed in the `DISP_FUNCTION` remarks, is not permitted as a property data type.  \n  \n##  <a name=\"disp_property_notify\"></a>  DISP_PROPERTY_NOTIFY  \n Defines an OLE automation property with notification in a dispatch map.  \n  \n```   \nDISP_PROPERTY_NOTIFY(theClass, szExternalName, memberName, pfnAfterSet, vtPropType)   \n```  \n  \n### Parameters  \n `theClass`  \n Name of the class.  \n  \n `szExternalName`  \n External name of the property.  \n  \n `memberName`  \n Name of the member variable in which the property is stored.  \n  \n `pfnAfterSet`  \n Name of the notification function for `szExternalName`.  \n  \n `vtPropType`  \n A value specifying the property's type.  \n  \n### Remarks  \n Unlike properties defined with `DISP_PROPERTY`, a property defined with `DISP_PROPERTY_NOTIFY` will automatically call the function specified by `pfnAfterSet` when the property is changed.  \n  \n The `vtPropType` argument is of type **VARTYPE**. Possible values for this argument are taken from the `VARENUM` enumeration:  \n  \n|Symbol|**Property type**|  \n|------------|-----------------------|  \n|`VT_I2`|**short**|  \n|`VT_I4`|**long**|  \n|`VT_R4`|**float**|  \n|`VT_R8`|**double**|  \n|`VT_CY`|**CY**|  \n|`VT_DATE`|**DATE**|  \n|`VT_BSTR`|`CString`|  \n|**VT_DISPATCH**|`LPDISPATCH`|  \n|`VT_ERROR`|`SCODE`|  \n|`VT_BOOL`|**BOOL**|  \n|**VT_VARIANT**|**VARIANT**|  \n|**VT_UNKNOWN**|`LPUNKNOWN`|  \n  \n##  <a name=\"disp_property_param\"></a>  DISP_PROPERTY_PARAM  \n Defines a property accessed with separate **Get** and `Set` member functions.  \n  \n```   \nDISP_PROPERTY_PARAM(theClass, pszExternalName, pfnGet, pfnSet, vtPropType, vtsParams)   \n```  \n  \n### Parameters  \n `theClass`  \n Name of the class.  \n  \n *pszExternalName*  \n External name of the property.  \n  \n `pfnGet`  \n Name of the member function used to get the property.  \n  \n `pfnSet`  \n Name of the member function used to set the property.  \n  \n `vtPropType`  \n A value specifying the property's type.  \n  \n `vtsParams`  \n A string of space-separated **VTS_** variant parameter types, one for each parameter.  \n  \n### Remarks  \n Unlike the `DISP_PROPERTY_EX` macro, this macro allows you to specify a parameter list for the property. This is useful for implementing properties that are indexed or parameterized.  \n  \n### Example  \n Consider the following declaration of get and set member functions that allow the user to request a specific row and column when accessing the property:  \n  \n [!code-cpp[NVC_MFCActiveXControl#9](../../mfc/codesnippet/cpp/dispatch-maps_3.h)]  \n  \n These correspond to the following `DISP_PROPERTY_PARAM` macro in the control dispatch map:  \n  \n [!code-cpp[NVC_MFCActiveXControl#10](../../mfc/codesnippet/cpp/dispatch-maps_4.cpp)]  \n  \n As another example, consider the following get and set member functions:  \n  \n [!code-cpp[NVC_MFCActiveXControl#11](../../mfc/codesnippet/cpp/dispatch-maps_5.h)]  \n  \n These correspond to the following `DISP_PROPERTY_PARAM` macro in the control dispatch map:  \n  \n [!code-cpp[NVC_MFCActiveXControl#12](../../mfc/codesnippet/cpp/dispatch-maps_6.cpp)]  \n  \n##  <a name=\"disp_defvalue\"></a>  DISP_DEFVALUE  \n Makes an existing property the default value of an object.  \n  \n```   \nDISP_DEFVALUE(theClass, pszName)   \n```  \n  \n### Parameters  \n `theClass`  \n Name of the class.  \n  \n `pszName`  \n External name of the property that represents the \"value\" of the object.  \n  \n### Remarks  \n Using a default value can make programming your automation object simpler for Visual Basic applications.  \n  \n The \"default value\" of your object is the property that is retrieved or set when a reference to an object does not specify a property or member function.  \n  \n## See Also  \n [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)\n"}