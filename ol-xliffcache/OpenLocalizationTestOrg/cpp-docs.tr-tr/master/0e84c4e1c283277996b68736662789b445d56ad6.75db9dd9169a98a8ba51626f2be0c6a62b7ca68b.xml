{"nodes":[{"pos":[12,85],"content":"Putting the Control on a Web Page (ATL Tutorial, Part 7) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Putting the Control on a Web Page (ATL Tutorial, Part 7) | Microsoft Docs","pos":[0,73]}]},{"content":"Putting the Control on a Web Page (ATL Tutorial, Part 7)","pos":[578,634]},{"content":"Your control is now finished.","pos":[635,664]},{"content":"To see your control work in a real-world situation, put it on a Web page.","pos":[665,738]},{"content":"An HTML file that contains the control was created when you defined your control.","pos":[739,820]},{"content":"Open the PolyCtl.htm file from <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, and you can see your control on a Web page.","pos":[821,918],"source":" Open the PolyCtl.htm file from **Solution Explorer**, and you can see your control on a Web page."},{"content":"In this step, you will script the Web page to respond to events.","pos":[925,989]},{"content":"You will also modify the control to let Internet Explorer know that the control is safe for scripting.","pos":[990,1092]},{"content":"Scripting the Web Page","pos":[1101,1123]},{"content":"The control does not do anything yet, so change the Web page to respond to the events that you send.","pos":[1127,1227]},{"content":"To script the Web page","pos":[1238,1260]},{"content":"Open PolyCtl.htm and select HTML view.","pos":[1270,1308]},{"content":"Add the following lines to the HTML code.","pos":[1309,1350]},{"content":"They should be added after <ph id=\"ph1\">`&lt;/OBJECT&gt;`</ph> but before <ph id=\"ph2\">`&lt;/BODY&gt;`</ph>.","pos":[1351,1411],"source":" They should be added after `</OBJECT>` but before `</BODY>`."},{"content":"Save the HTM file.","pos":[1673,1691]},{"content":"You have added some VBScript code that gets the Sides property from the control and increases the number of sides by one if you click inside the control.","pos":[1698,1851]},{"content":"If you click outside the control, you reduce the number of sides by one.","pos":[1852,1924]},{"content":"Indicating that the Control Is Safe for Scripting","pos":[1933,1982]},{"content":"You can view the Web page with the control in Internet Explorer or, more conveniently, use the Web browser view built into Visual C++.","pos":[1986,2120]},{"content":"To see your control in the Web browser view, right-click PolyCtl.htm, and click <bpt id=\"p1\">**</bpt>View in Browser<ept id=\"p1\">**</ept>.","pos":[2121,2221],"source":" To see your control in the Web browser view, right-click PolyCtl.htm, and click **View in Browser**."},{"content":"Based on your current Internet Explorer security settings, you may receive a Security Alert dialog box stating that the control may not be safe to script and could potentially do damage.","pos":[2228,2414]},{"content":"For example, if you had a control that displayed a file but also had a <ph id=\"ph1\">`Delete`</ph> method that deleted a file, it would be safe if you just viewed it on a page.","pos":[2415,2572],"source":" For example, if you had a control that displayed a file but also had a `Delete` method that deleted a file, it would be safe if you just viewed it on a page."},{"content":"It would be not safe to script, however, because someone could call the <ph id=\"ph1\">`Delete`</ph> method.","pos":[2573,2661],"source":" It would be not safe to script, however, because someone could call the `Delete` method."},{"pos":[2669,3020],"content":"[!IMPORTANT]\n For this tutorial, you can change your security settings in Internet Explorer to run ActiveX controls that are not marked as safe. In Control Panel, click **Internet Properties** and click **Security** to change the appropriate settings. When you have completed the tutorial, change your security settings back to their original state.","leadings":["","> "],"nodes":[{"content":" For this tutorial, you can change your security settings in Internet Explorer to run ActiveX controls that are not marked as safe. In Control Panel, click **Internet Properties** and click **Security** to change the appropriate settings. When you have completed the tutorial, change your security settings back to their original state.","pos":[13,349],"nodes":[{"content":"For this tutorial, you can change your security settings in Internet Explorer to run ActiveX controls that are not marked as safe.","pos":[1,131]},{"content":"In Control Panel, click <bpt id=\"p1\">**</bpt>Internet Properties<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>Security<ept id=\"p2\">**</ept> to change the appropriate settings.","pos":[132,238],"source":" In Control Panel, click **Internet Properties** and click **Security** to change the appropriate settings."},{"content":"When you have completed the tutorial, change your security settings back to their original state.","pos":[239,336]}]}]},{"content":"You can programmatically alert Internet Explorer that it does not need to display the Security Alert dialog box for this particular control.","pos":[3027,3167]},{"content":"You can do this with the <ph id=\"ph1\">`IObjectSafety`</ph> interface, and ATL supplies an implementation of this interface in the class <bpt id=\"p1\">[</bpt>IObjectSafetyImpl<ept id=\"p1\">](../atl/reference/iobjectsafetyimpl-class.md)</ept>.","pos":[3168,3351],"source":" You can do this with the `IObjectSafety` interface, and ATL supplies an implementation of this interface in the class [IObjectSafetyImpl](../atl/reference/iobjectsafetyimpl-class.md)."},{"content":"To add the interface to your control, add <ph id=\"ph1\">`IObjectSafetyImpl`</ph> to your list of inherited classes and add an entry for it in your COM map.","pos":[3352,3488],"source":" To add the interface to your control, add `IObjectSafetyImpl` to your list of inherited classes and add an entry for it in your COM map."},{"content":"To add IObjectSafetyImpl to the control","pos":[3499,3538]},{"content":"Add the following line to the end of the list of inherited classes in PolyCtl.h and add a comma to the previous line:","pos":[3548,3665]},{"pos":[3683,3703],"content":"NVC_ATL_Windowing#62"},{"content":"Add the following line to the COM map in PolyCtl.h:","pos":[3797,3848]},{"pos":[3866,3886],"content":"NVC_ATL_Windowing#63"},{"content":"Building and Testing the Control","pos":[3979,4011]},{"content":"Build the control.","pos":[4015,4033]},{"content":"Once the build has finished, open PolyCtl.htm in browser view again.","pos":[4034,4102]},{"content":"This time, the Web page should be displayed directly without the Safety Alert dialog box.","pos":[4103,4192]},{"content":"Click inside the polygon; the number of sides increases by one.","pos":[4193,4256]},{"content":"Click outside the polygon to reduce the number of sides.","pos":[4257,4313]},{"content":"If you try to reduce the number of sides below three, you will see the error message that you set.","pos":[4314,4412]},{"content":"Back to Step 6","pos":[4420,4434]},{"content":"Next Steps","pos":[4498,4508]},{"content":"This concludes the ATL tutorial.","pos":[4512,4544]},{"content":"For links to more information about ATL, see the <bpt id=\"p1\">[</bpt>ATL start page<ept id=\"p1\">](../atl/active-template-library-atl-concepts.md)</ept>.","pos":[4545,4659],"source":" For links to more information about ATL, see the [ATL start page](../atl/active-template-library-atl-concepts.md)."},{"content":"See Also","pos":[4668,4676]},{"content":"Tutorial","pos":[4681,4689]}],"content":"---\ntitle: \"Putting the Control on a Web Page (ATL Tutorial, Part 7) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nms.assetid: 50dc4c95-c95b-4006-b88a-9826f7bdb222\ncaps.latest.revision: 15\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Putting the Control on a Web Page (ATL Tutorial, Part 7)\nYour control is now finished. To see your control work in a real-world situation, put it on a Web page. An HTML file that contains the control was created when you defined your control. Open the PolyCtl.htm file from **Solution Explorer**, and you can see your control on a Web page.  \n  \n In this step, you will script the Web page to respond to events. You will also modify the control to let Internet Explorer know that the control is safe for scripting.  \n  \n## Scripting the Web Page  \n The control does not do anything yet, so change the Web page to respond to the events that you send.  \n  \n#### To script the Web page  \n  \n1.  Open PolyCtl.htm and select HTML view. Add the following lines to the HTML code. They should be added after `</OBJECT>` but before `</BODY>`.  \n  \n ```  \n \n <SCRIPT LANGUAGE=\"VBScript\">  \n <!--  \n    Sub PolyCtl_ClickIn(x, y)  \n    PolyCtl.Sides = PolyCtl.Sides + 1  \n    End Sub  \n    Sub PolyCtl_ClickOut(x, y)  \n    PolyCtl.Sides = PolyCtl.Sides - 1  \n    End Sub  \n -->  \n </SCRIPT>  \n ```  \n  \n2.  Save the HTM file.  \n  \n You have added some VBScript code that gets the Sides property from the control and increases the number of sides by one if you click inside the control. If you click outside the control, you reduce the number of sides by one.  \n  \n## Indicating that the Control Is Safe for Scripting  \n You can view the Web page with the control in Internet Explorer or, more conveniently, use the Web browser view built into Visual C++. To see your control in the Web browser view, right-click PolyCtl.htm, and click **View in Browser**.  \n  \n Based on your current Internet Explorer security settings, you may receive a Security Alert dialog box stating that the control may not be safe to script and could potentially do damage. For example, if you had a control that displayed a file but also had a `Delete` method that deleted a file, it would be safe if you just viewed it on a page. It would be not safe to script, however, because someone could call the `Delete` method.  \n  \n> [!IMPORTANT]\n>  For this tutorial, you can change your security settings in Internet Explorer to run ActiveX controls that are not marked as safe. In Control Panel, click **Internet Properties** and click **Security** to change the appropriate settings. When you have completed the tutorial, change your security settings back to their original state.  \n  \n You can programmatically alert Internet Explorer that it does not need to display the Security Alert dialog box for this particular control. You can do this with the `IObjectSafety` interface, and ATL supplies an implementation of this interface in the class [IObjectSafetyImpl](../atl/reference/iobjectsafetyimpl-class.md). To add the interface to your control, add `IObjectSafetyImpl` to your list of inherited classes and add an entry for it in your COM map.  \n  \n#### To add IObjectSafetyImpl to the control  \n  \n1.  Add the following line to the end of the list of inherited classes in PolyCtl.h and add a comma to the previous line:  \n  \n [!code-cpp[NVC_ATL_Windowing#62](../atl/codesnippet/cpp/putting-the-control-on-a-web-page-atl-tutorial-part-7_1.h)]  \n  \n2.  Add the following line to the COM map in PolyCtl.h:  \n  \n [!code-cpp[NVC_ATL_Windowing#63](../atl/codesnippet/cpp/putting-the-control-on-a-web-page-atl-tutorial-part-7_2.h)]  \n  \n## Building and Testing the Control  \n Build the control. Once the build has finished, open PolyCtl.htm in browser view again. This time, the Web page should be displayed directly without the Safety Alert dialog box. Click inside the polygon; the number of sides increases by one. Click outside the polygon to reduce the number of sides. If you try to reduce the number of sides below three, you will see the error message that you set.  \n  \n [Back to Step 6](../atl/adding-a-property-page-atl-tutorial-part-6.md)  \n  \n## Next Steps  \n This concludes the ATL tutorial. For links to more information about ATL, see the [ATL start page](../atl/active-template-library-atl-concepts.md).  \n  \n## See Also  \n [Tutorial](../atl/active-template-library-atl-tutorial.md)\n\n"}