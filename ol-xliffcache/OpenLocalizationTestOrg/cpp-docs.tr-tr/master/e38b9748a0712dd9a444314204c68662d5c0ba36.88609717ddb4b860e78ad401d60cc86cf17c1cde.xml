{"nodes":[{"pos":[12,49],"content":"set_unexpected (CRT) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"set_unexpected (CRT) | Microsoft Docs","pos":[0,37]}]},{"content":"set_unexpected (CRT)","pos":[965,985]},{"pos":[986,1054],"content":"Installs your own termination function to be called by <ph id=\"ph1\">`unexpected`</ph>.","source":"Installs your own termination function to be called by `unexpected`."},{"content":"Syntax","pos":[1063,1069]},{"content":"Parameters","pos":[1178,1188]},{"content":"Pointer to a function that you write to replace the <ph id=\"ph1\">`unexpected`</ph> function.","pos":[1211,1285],"source":" Pointer to a function that you write to replace the `unexpected` function."},{"content":"Return Value","pos":[1294,1306]},{"content":"Returns a pointer to the previous termination function registered by <ph id=\"ph1\">`_set_unexpected`</ph> so that the previous function can be restored later.","pos":[1310,1449],"source":"Returns a pointer to the previous termination function registered by `_set_unexpected` so that the previous function can be restored later."},{"content":"If no previous function has been set, the return value may be used to restore the default behavior; this value may be NULL.","pos":[1450,1573]},{"content":"Remarks","pos":[1582,1589]},{"content":"The <ph id=\"ph1\">`set_unexpected`</ph> function installs <ph id=\"ph2\">`unexpFunction`</ph> as the function called by <ph id=\"ph3\">`unexpected`</ph>.","pos":[1593,1687],"source":"The `set_unexpected` function installs `unexpFunction` as the function called by `unexpected`."},{"content":"is not used in the current C++ exception-handling implementation.","pos":[1701,1766]},{"content":"The <ph id=\"ph1\">`unexpected_function`</ph> type is defined in EH.H as a pointer to a user-defined unexpected function, <ph id=\"ph2\">`unexpFunction`</ph> that returns <ph id=\"ph3\">`void`</ph>.","pos":[1767,1905],"source":" The `unexpected_function` type is defined in EH.H as a pointer to a user-defined unexpected function, `unexpFunction` that returns `void`."},{"content":"Your custom <ph id=\"ph1\">`unexpFunction`</ph> function should not return to its caller.","pos":[1906,1975],"source":" Your custom `unexpFunction` function should not return to its caller."},{"content":"By default, <ph id=\"ph1\">`unexpected`</ph> calls <ph id=\"ph2\">`terminate`</ph>.","pos":[2041,2084],"source":"By default, `unexpected` calls `terminate`."},{"content":"You can change this default behavior by writing your own termination function and calling <ph id=\"ph1\">`set_unexpected`</ph> with the name of your function as its argument.","pos":[2085,2239],"source":" You can change this default behavior by writing your own termination function and calling `set_unexpected` with the name of your function as its argument."},{"content":"calls the last function given as an argument to <ph id=\"ph1\">`set_unexpected`</ph>.","pos":[2253,2318],"source":" calls the last function given as an argument to `set_unexpected`."},{"pos":[2325,2459],"content":"Unlike the custom termination function installed by a call to <ph id=\"ph1\">`set_terminate`</ph>, an exception can be thrown from within <ph id=\"ph2\">`unexpFunction`</ph>.","source":"Unlike the custom termination function installed by a call to `set_terminate`, an exception can be thrown from within `unexpFunction`."},{"content":"In a multithreaded environment, unexpected functions are maintained separately for each thread.","pos":[2466,2561]},{"content":"Each new thread needs to install its own unexpected function.","pos":[2562,2623]},{"content":"Thus, each thread is in charge of its own unexpected handling.","pos":[2624,2686]},{"content":"In the current Microsoft implementation of C++ exception handling, <ph id=\"ph1\">`unexpected`</ph> calls <ph id=\"ph2\">`terminate`</ph> by default and is never called by the exception-handling run-time library.","pos":[2693,2865],"source":"In the current Microsoft implementation of C++ exception handling, `unexpected` calls `terminate` by default and is never called by the exception-handling run-time library."},{"content":"There is no particular advantage to calling <ph id=\"ph1\">`unexpected`</ph> rather than <ph id=\"ph2\">`terminate`</ph>.","pos":[2866,2947],"source":" There is no particular advantage to calling `unexpected` rather than `terminate`."},{"pos":[2954,3174],"content":"There is a single <ph id=\"ph1\">`set_unexpected`</ph> handler for all dynamically linked DLLs or EXEs; even if you call <ph id=\"ph2\">`set_unexpected`</ph> your handler may be replaced by another or that you are replacing a handler set by another DLL or EXE.","source":"There is a single `set_unexpected` handler for all dynamically linked DLLs or EXEs; even if you call `set_unexpected` your handler may be replaced by another or that you are replacing a handler set by another DLL or EXE."},{"content":"Requirements","pos":[3183,3195]},{"content":"Routine","pos":[3202,3209]},{"content":"Required header","pos":[3210,3225]},{"content":"eh.h&gt;","pos":[3289,3294],"source":"eh.h>"},{"pos":[3302,3426],"content":"For additional compatibility information, see <bpt id=\"p1\">[</bpt>Compatibility<ept id=\"p1\">](../../c-runtime-library/compatibility.md)</ept> in the Introduction.","source":"For additional compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md) in the Introduction."},{"content":".NET Framework Equivalent","pos":[3435,3460]},{"content":"Not applicable.","pos":[3464,3479]},{"content":"To call the standard C function, use <ph id=\"ph1\">`PInvoke`</ph>.","pos":[3480,3527],"source":" To call the standard C function, use `PInvoke`."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Platform Invoke Examples<ept id=\"p1\">](http://msdn.microsoft.com/Library/15926806-f0b7-487e-93a6-4e9367ec689f)</ept>.","pos":[3528,3653],"source":" For more information, see [Platform Invoke Examples](http://msdn.microsoft.com/Library/15926806-f0b7-487e-93a6-4e9367ec689f)."},{"content":"See Also","pos":[3662,3670]},{"content":"Exception Handling Routines","pos":[3675,3702]},{"content":"abort","pos":[3765,3770]},{"content":"_get_unexpected","pos":[3821,3836]},{"content":"set_terminate","pos":[3896,3909]},{"content":"terminate","pos":[3972,3981]},{"content":"unexpected","pos":[4040,4050]}],"content":"---\ntitle: \"set_unexpected (CRT) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\napiname: \n  - \"set_unexpected\"\napilocation: \n  - \"msvcrt.dll\"\n  - \"msvcr80.dll\"\n  - \"msvcr90.dll\"\n  - \"msvcr100.dll\"\n  - \"msvcr100_clr0400.dll\"\n  - \"msvcr110.dll\"\n  - \"msvcr110_clr0400.dll\"\n  - \"msvcr120.dll\"\n  - \"msvcr120_clr0400.dll\"\n  - \"ucrtbase.dll\"\napitype: \"DLLExport\"\nf1_keywords: \n  - \"set_unexpected\"\ndev_langs: \n  - \"C++\"\n  - \"C\"\nhelpviewer_keywords: \n  - \"set_unexpected function\"\n  - \"unexpected function\"\n  - \"exception handling, termination\"\nms.assetid: ebcef032-4771-48e5-88aa-2a1ab8750aa6\ncaps.latest.revision: 11\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# set_unexpected (CRT)\nInstalls your own termination function to be called by `unexpected`.  \n  \n## Syntax  \n  \n```  \nunexpected_function set_unexpected(  \n   unexpected_function unexpFunction   \n);  \n```  \n  \n#### Parameters  \n `unexpFunction`  \n Pointer to a function that you write to replace the `unexpected` function.  \n  \n## Return Value  \n Returns a pointer to the previous termination function registered by `_set_unexpected` so that the previous function can be restored later. If no previous function has been set, the return value may be used to restore the default behavior; this value may be NULL.  \n  \n## Remarks  \n The `set_unexpected` function installs `unexpFunction` as the function called by `unexpected`. `unexpected` is not used in the current C++ exception-handling implementation. The `unexpected_function` type is defined in EH.H as a pointer to a user-defined unexpected function, `unexpFunction` that returns `void`. Your custom `unexpFunction` function should not return to its caller.  \n  \n```  \ntypedef void ( *unexpected_function )( );  \n```  \n  \n By default, `unexpected` calls `terminate`. You can change this default behavior by writing your own termination function and calling `set_unexpected` with the name of your function as its argument. `unexpected` calls the last function given as an argument to `set_unexpected`.  \n  \n Unlike the custom termination function installed by a call to `set_terminate`, an exception can be thrown from within `unexpFunction`.  \n  \n In a multithreaded environment, unexpected functions are maintained separately for each thread. Each new thread needs to install its own unexpected function. Thus, each thread is in charge of its own unexpected handling.  \n  \n In the current Microsoft implementation of C++ exception handling, `unexpected` calls `terminate` by default and is never called by the exception-handling run-time library. There is no particular advantage to calling `unexpected` rather than `terminate`.  \n  \n There is a single `set_unexpected` handler for all dynamically linked DLLs or EXEs; even if you call `set_unexpected` your handler may be replaced by another or that you are replacing a handler set by another DLL or EXE.  \n  \n## Requirements  \n  \n|Routine|Required header|  \n|-------------|---------------------|  \n|`set_unexpected`|\\<eh.h>|  \n  \n For additional compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md) in the Introduction.  \n  \n## .NET Framework Equivalent  \n Not applicable. To call the standard C function, use `PInvoke`. For more information, see [Platform Invoke Examples](http://msdn.microsoft.com/Library/15926806-f0b7-487e-93a6-4e9367ec689f).  \n  \n## See Also  \n [Exception Handling Routines](../../c-runtime-library/exception-handling-routines.md)   \n [abort](../../c-runtime-library/reference/abort.md)   \n [_get_unexpected](../../c-runtime-library/reference/get-unexpected.md)   \n [set_terminate](../../c-runtime-library/reference/set-terminate-crt.md)   \n [terminate](../../c-runtime-library/reference/terminate-crt.md)   \n [unexpected](../../c-runtime-library/reference/unexpected-crt.md)"}