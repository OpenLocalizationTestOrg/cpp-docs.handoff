{"nodes":[{"pos":[12,69],"content":"Using a Windows Form User Control in MFC | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using a Windows Form User Control in MFC | Microsoft Docs","pos":[0,57]}]},{"content":"Using a Windows Form User Control in MFC","pos":[802,842]},{"content":"Using the MFC Windows Forms support classes, you can host Windows Forms controls within your MFC applications as an ActiveX control within MFC dialog boxes or views.","pos":[843,1008]},{"content":"In addition, Windows Forms forms can be hosted as MFC dialog boxes.","pos":[1009,1076]},{"content":"The following sections describe how to:","pos":[1083,1122]},{"content":"Host a Windows Forms control in an MFC dialog box.","pos":[1132,1182]},{"content":"Host a Windows Forms user control as an MFC view.","pos":[1192,1241]},{"content":"Host a Windows Forms form as an MFC dialog box.","pos":[1251,1298]},{"pos":[1306,1439],"content":"[!NOTE]\n MFC Windows Forms integration works only in projects that link dynamically with MFC (projects in which AFXDLL is defined).","leadings":["","> "],"nodes":[{"content":"MFC Windows Forms integration works only in projects that link dynamically with MFC (projects in which AFXDLL is defined).","pos":[9,131]}]},{"pos":[1447,1945],"content":"[!NOTE]\n When you build your application using a private (modified) copy of the MFC Windows Forms interfaces DLL (mfcmifc80.dll), it will fail to install in the GAC unless you replace the Microsoft key with your own vendor key. For more information on assembly signing, see [Programming with Assemblies](http://msdn.microsoft.com/Library/25918b15-701d-42c7-95fc-c290d08648d6) and [Strong Name Assemblies (Assembly Signing) (C++/CLI)](../dotnet/strong-name-assemblies-assembly-signing-cpp-cli.md).","leadings":["","> "],"nodes":[{"content":" When you build your application using a private (modified) copy of the MFC Windows Forms interfaces DLL (mfcmifc80.dll), it will fail to install in the GAC unless you replace the Microsoft key with your own vendor key. For more information on assembly signing, see [Programming with Assemblies](http://msdn.microsoft.com/Library/25918b15-701d-42c7-95fc-c290d08648d6) and [Strong Name Assemblies (Assembly Signing) (C++/CLI)](../dotnet/strong-name-assemblies-assembly-signing-cpp-cli.md).","pos":[8,496],"nodes":[{"content":"When you build your application using a private (modified) copy of the MFC Windows Forms interfaces DLL (mfcmifc80.dll), it will fail to install in the GAC unless you replace the Microsoft key with your own vendor key.","pos":[1,219]},{"content":"For more information on assembly signing, see <bpt id=\"p1\">[</bpt>Programming with Assemblies<ept id=\"p1\">](http://msdn.microsoft.com/Library/25918b15-701d-42c7-95fc-c290d08648d6)</ept> and <bpt id=\"p2\">[</bpt>Strong Name Assemblies (Assembly Signing) (C++/CLI)<ept id=\"p2\">](../dotnet/strong-name-assemblies-assembly-signing-cpp-cli.md)</ept>.","pos":[220,488],"source":" For more information on assembly signing, see [Programming with Assemblies](http://msdn.microsoft.com/Library/25918b15-701d-42c7-95fc-c290d08648d6) and [Strong Name Assemblies (Assembly Signing) (C++/CLI)](../dotnet/strong-name-assemblies-assembly-signing-cpp-cli.md)."}]}]},{"pos":[1952,2395],"content":"For sample applications using Windows Forms, see <bpt id=\"p1\">[</bpt>BirthdayPicker Sample: Demonstrates .NET Framework Resources with Windows Forms<ept id=\"p1\">](http://msdn.microsoft.com/en-us/ac932aed-5502-4667-be29-709bca435317)</ept>, <bpt id=\"p2\">[</bpt>Calculator Sample: Windows Forms Pocket Calculator<ept id=\"p2\">](http://msdn.microsoft.com/en-us/2283b516-3b7e-45f2-80c4-fdcfb366ce25)</ept>, and <bpt id=\"p3\">[</bpt>Scribble Sample: MDI Drawing Application<ept id=\"p3\">](http://msdn.microsoft.com/en-us/f025da3e-659b-4222-b991-554a1b8b2358)</ept>.","source":"For sample applications using Windows Forms, see [BirthdayPicker Sample: Demonstrates .NET Framework Resources with Windows Forms](http://msdn.microsoft.com/en-us/ac932aed-5502-4667-be29-709bca435317), [Calculator Sample: Windows Forms Pocket Calculator](http://msdn.microsoft.com/en-us/2283b516-3b7e-45f2-80c4-fdcfb366ce25), and [Scribble Sample: MDI Drawing Application](http://msdn.microsoft.com/en-us/f025da3e-659b-4222-b991-554a1b8b2358)."},{"pos":[2402,2617],"content":"For a sample application that shows Windows Forms used with MFC, see <bpt id=\"p1\">[</bpt>MFC and Windows Forms Integration<ept id=\"p1\">](http://www.microsoft.com/downloads/details.aspx?FamilyID=987021bc-e575-4fe3-baa9-15aa50b0f599&amp;displaylang=en)</ept>.","source":"For a sample application that shows Windows Forms used with MFC, see [MFC and Windows Forms Integration](http://www.microsoft.com/downloads/details.aspx?FamilyID=987021bc-e575-4fe3-baa9-15aa50b0f599&displaylang=en)."},{"content":"If your MFC application uses Windows Forms, you need to redistribute mfcmifc90.dll with your application.","pos":[2624,2729]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Redistributing the MFC Library<ept id=\"p1\">](../ide/redistributing-the-mfc-library.md)</ept>.","pos":[2730,2831],"source":" For more information, see [Redistributing the MFC Library](../ide/redistributing-the-mfc-library.md)."},{"content":"In This Section","pos":[2840,2855]},{"content":"Hosting a Windows Form User Control in an MFC Dialog Box","pos":[2860,2916]},{"content":"Hosting a Windows Forms User Control as an MFC View","pos":[2996,3047]},{"content":"Hosting a Windows Form User Control as an MFC Dialog Box","pos":[3122,3178]},{"content":"Reference","pos":[3259,3268]},{"content":"CWinFormsControl Class","pos":[3273,3295]},{"content":"CWinFormsDialog Class","pos":[3348,3369]},{"content":"CWinFormsView Class","pos":[3421,3440]},{"content":"ICommandSource Interface","pos":[3490,3514]},{"content":"ICommandTarget Interface","pos":[3569,3593]},{"content":"ICommandUI Interface","pos":[3648,3668]},{"content":"IView Interface","pos":[3719,3734]},{"content":"CommandHandler","pos":[3780,3794]},{"content":"CommandUIHandler","pos":[3875,3891]},{"content":"DDX_ManagedControl","pos":[3972,3990]},{"content":"UICheckState","pos":[4071,4083]},{"content":"Related Sections","pos":[4165,4181]},{"content":"Windows Forms","pos":[4186,4199]},{"content":"Windows Forms Controls","pos":[4280,4302]},{"content":"ASP.NET User Controls","pos":[4383,4404]},{"content":"See Also","pos":[4486,4494]},{"content":"User Interface Elements","pos":[4499,4522]},{"content":"Form Views","pos":[4568,4578]}],"content":"---\ntitle: \"Using a Windows Form User Control in MFC | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC [C++], Windows Forms support\"\n  - \"interoperability [C++], Windows Forms in MFC\"\n  - \"interoperability [C++], MFC\"\n  - \"interop [C++], Windows Forms in MFC\"\n  - \"interop [C++], MFC\"\n  - \"Windows Forms [C++], MFC support\"\nms.assetid: 63fb099b-1dff-469c-9e34-dab52e122fcd\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Using a Windows Form User Control in MFC\nUsing the MFC Windows Forms support classes, you can host Windows Forms controls within your MFC applications as an ActiveX control within MFC dialog boxes or views. In addition, Windows Forms forms can be hosted as MFC dialog boxes.  \n  \n The following sections describe how to:  \n  \n-   Host a Windows Forms control in an MFC dialog box.  \n  \n-   Host a Windows Forms user control as an MFC view.  \n  \n-   Host a Windows Forms form as an MFC dialog box.  \n  \n> [!NOTE]\n>  MFC Windows Forms integration works only in projects that link dynamically with MFC (projects in which AFXDLL is defined).  \n  \n> [!NOTE]\n>  When you build your application using a private (modified) copy of the MFC Windows Forms interfaces DLL (mfcmifc80.dll), it will fail to install in the GAC unless you replace the Microsoft key with your own vendor key. For more information on assembly signing, see [Programming with Assemblies](http://msdn.microsoft.com/Library/25918b15-701d-42c7-95fc-c290d08648d6) and [Strong Name Assemblies (Assembly Signing) (C++/CLI)](../dotnet/strong-name-assemblies-assembly-signing-cpp-cli.md).  \n  \n For sample applications using Windows Forms, see [BirthdayPicker Sample: Demonstrates .NET Framework Resources with Windows Forms](http://msdn.microsoft.com/en-us/ac932aed-5502-4667-be29-709bca435317), [Calculator Sample: Windows Forms Pocket Calculator](http://msdn.microsoft.com/en-us/2283b516-3b7e-45f2-80c4-fdcfb366ce25), and [Scribble Sample: MDI Drawing Application](http://msdn.microsoft.com/en-us/f025da3e-659b-4222-b991-554a1b8b2358).  \n  \n For a sample application that shows Windows Forms used with MFC, see [MFC and Windows Forms Integration](http://www.microsoft.com/downloads/details.aspx?FamilyID=987021bc-e575-4fe3-baa9-15aa50b0f599&displaylang=en).  \n  \n If your MFC application uses Windows Forms, you need to redistribute mfcmifc90.dll with your application. For more information, see [Redistributing the MFC Library](../ide/redistributing-the-mfc-library.md).  \n  \n## In This Section  \n [Hosting a Windows Form User Control in an MFC Dialog Box](../dotnet/hosting-a-windows-form-user-control-in-an-mfc-dialog-box.md)  \n  \n [Hosting a Windows Forms User Control as an MFC View](../dotnet/hosting-a-windows-forms-user-control-as-an-mfc-view.md)  \n  \n [Hosting a Windows Form User Control as an MFC Dialog Box](../dotnet/hosting-a-windows-form-user-control-as-an-mfc-dialog-box.md)  \n  \n## Reference  \n [CWinFormsControl Class](../mfc/reference/cwinformscontrol-class.md)  \n  \n [CWinFormsDialog Class](../mfc/reference/cwinformsdialog-class.md)  \n  \n [CWinFormsView Class](../mfc/reference/cwinformsview-class.md)  \n  \n [ICommandSource Interface](../mfc/reference/icommandsource-interface.md)  \n  \n [ICommandTarget Interface](../mfc/reference/icommandtarget-interface.md)  \n  \n [ICommandUI Interface](../mfc/reference/icommandui-interface.md)  \n  \n [IView Interface](../mfc/reference/iview-interface.md)  \n  \n [CommandHandler](http://msdn.microsoft.com/Library/22096734-e074-4aca-8523-4b15590109f9)  \n  \n [CommandUIHandler](http://msdn.microsoft.com/Library/2da11ecc-20d6-4a53-97fc-08b48f06d71a)  \n  \n [DDX_ManagedControl](http://msdn.microsoft.com/Library/61b55a90-c993-478e-9dea-db27fbf0e193)  \n  \n [UICheckState](http://msdn.microsoft.com/Library/68d84834-e7f9-4ccb-8126-d492e27073e9)  \n  \n## Related Sections  \n [Windows Forms](http://msdn.microsoft.com/Library/627df1e9-b254-41af-bbac-9a4f02810c54)  \n  \n [Windows Forms Controls](http://msdn.microsoft.com/Library/f050de8f-4ebd-4042-94b8-edf9a1dbd52a)  \n  \n [ASP.NET User Controls](http://msdn.microsoft.com/Library/5e601b3d-bb16-4dbe-9e35-7e92a34565ca)  \n  \n## See Also  \n [User Interface Elements](../mfc/user-interface-elements-mfc.md)   \n [Form Views](../mfc/form-views-mfc.md)"}