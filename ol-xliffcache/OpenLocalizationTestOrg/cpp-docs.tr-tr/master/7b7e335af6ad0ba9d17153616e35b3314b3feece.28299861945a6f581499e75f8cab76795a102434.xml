{"nodes":[{"pos":[12,58],"content":"GetCodeForDllUnregisterServer | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"GetCodeForDllUnregisterServer | Microsoft Docs","pos":[0,46]}]},{"content":"GetCodeForDllUnregisterServer","pos":[653,682]},{"content":"Gets the appropriate code for unregistering a server.","pos":[683,736]},{"content":"Syntax","pos":[745,751]},{"content":"Parameters","pos":[868,878]},{"content":"The zero-based line number for the start of the function.","pos":[898,955]},{"content":"The zero-based line number for the end of the function.","pos":[976,1031]},{"content":"Return Value","pos":[1040,1052]},{"content":"A string containing the code for unregistering the server.","pos":[1056,1114]},{"content":"Remarks","pos":[1123,1130]},{"content":"Call this member function to retrieve the appropriate code for unregistering the server:","pos":[1134,1222]},{"content":"Line number","pos":[1229,1240]},{"content":"Code","pos":[1241,1245]},{"content":"0","pos":[1283,1284]},{"content":"AFX_MANAGE_STATE(AfxGetStaticModuleState());","pos":[1285,1329]},{"content":"1","pos":[1334,1335]},{"content":"_AtlModule.UpdateRegistryAppId(FALSE);","pos":[1336,1374]},{"content":"2","pos":[1379,1380]},{"content":"HRESULT hRes = _AtlModule.UnregisterServer(TRUE);","pos":[1381,1430]},{"content":"3","pos":[1435,1436]},{"content":"if (hRes != S_OK)","pos":[1437,1454]},{"content":"4","pos":[1459,1460]},{"content":"\\treturn hRes;","pos":[1461,1475]},{"content":"5","pos":[1480,1481]},{"content":"if (!COleObjectFactory::UpdateRegistryAll(FALSE))","pos":[1482,1531]},{"content":"6","pos":[1536,1537]},{"content":"\\treturn ResultFromScode(SELFREG_E_CLASS);","pos":[1538,1580]},{"content":"7","pos":[1585,1586]},{"content":"return S_OK;","pos":[1587,1599]},{"pos":[1607,1773],"content":"For each of the lines returned, <ph id=\"ph1\">`GetCodeForDllUnregisterServer`</ph> adds a leading tab (<ph id=\"ph2\">`\\t`</ph>) and a trailing \"CR-LF\" (carriage return - linefeed) character pair (<ph id=\"ph3\">`\\r\\n`</ph>).","source":"For each of the lines returned, `GetCodeForDllUnregisterServer` adds a leading tab (`\\t`) and a trailing \"CR-LF\" (carriage return - linefeed) character pair (`\\r\\n`)."},{"content":"Example","pos":[1782,1789]},{"content":"See Also","pos":[2019,2027]},{"content":"Customizing C++ Wizards with Common JScript Functions","pos":[2032,2085]},{"content":"JScript Functions for C++ Wizards","pos":[2157,2190]},{"content":"Creating a Custom Wizard","pos":[2242,2266]},{"content":"Designing a Wizard","pos":[2309,2327]},{"content":"GetCodeForDllRegisterServer","pos":[2364,2391]}],"content":"---\ntitle: \"GetCodeForDllUnregisterServer | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"GetCodeForDllUnregisterServer\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"GetCodeForDllUnregisterServer method\"\nms.assetid: 6b152943-8c30-49f4-a55c-d0cba8d27a17\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# GetCodeForDllUnregisterServer\nGets the appropriate code for unregistering a server.  \n  \n## Syntax  \n  \n```  \n  \n      function GetCodeForDllUnregisterServer(   \n   nLineStart,   \n   nLineEnd    \n);  \n```  \n  \n#### Parameters  \n `nLineStart`  \n The zero-based line number for the start of the function.  \n  \n `nLineEnd`  \n The zero-based line number for the end of the function.  \n  \n## Return Value  \n A string containing the code for unregistering the server.  \n  \n## Remarks  \n Call this member function to retrieve the appropriate code for unregistering the server:  \n  \n|Line number|Code|  \n|-----------------|----------|  \n|0|AFX_MANAGE_STATE(AfxGetStaticModuleState());|  \n|1|_AtlModule.UpdateRegistryAppId(FALSE);|  \n|2|HRESULT hRes = _AtlModule.UnregisterServer(TRUE);|  \n|3|if (hRes != S_OK)|  \n|4|\\treturn hRes;|  \n|5|if (!COleObjectFactory::UpdateRegistryAll(FALSE))|  \n|6|\\treturn ResultFromScode(SELFREG_E_CLASS);|  \n|7|return S_OK;|  \n  \n For each of the lines returned, `GetCodeForDllUnregisterServer` adds a leading tab (`\\t`) and a trailing \"CR-LF\" (carriage return - linefeed) character pair (`\\r\\n`).  \n  \n## Example  \n  \n```  \n// Get the lines numbered 2 and 3 above  \nGetCodeForDllUnregisterServer(2, 3)  \n  \n// returns the following string  \n// \"\\tHRESULT hRes = _AtlModule.UnregisterServer(TRUE);\\r\\n\\tif (hRes != S_OK)\\r\\n\"  \n  \n```  \n  \n## See Also  \n [Customizing C++ Wizards with Common JScript Functions](../ide/customizing-cpp-wizards-with-common-jscript-functions.md)   \n [JScript Functions for C++ Wizards](../ide/jscript-functions-for-cpp-wizards.md)   \n [Creating a Custom Wizard](../ide/creating-a-custom-wizard.md)   \n [Designing a Wizard](../ide/designing-a-wizard.md)   \n [GetCodeForDllRegisterServer](../ide/getcodefordllregisterserver.md)"}