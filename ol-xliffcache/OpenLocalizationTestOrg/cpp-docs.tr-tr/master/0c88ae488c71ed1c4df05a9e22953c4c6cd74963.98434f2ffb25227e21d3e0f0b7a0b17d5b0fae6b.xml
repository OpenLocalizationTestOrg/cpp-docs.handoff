{"nodes":[{"pos":[12,50],"content":"Programmatic Printing | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Programmatic Printing | Microsoft Docs","pos":[0,38]}]},{"content":"Programmatic Printing","pos":[710,731]},{"content":"OLE provided the means to uniquely identify persistent documents (<bpt id=\"p1\">**</bpt>GetClassFile<ept id=\"p1\">**</ept>) and load them into their associated code (<ph id=\"ph1\">`CoCreateInstance`</ph>, <bpt id=\"p2\">**</bpt>QueryInterface(IID_IPersistFile)<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>QueryInterface(IID_IPersistStorage)<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>IPersistFile::Load<ept id=\"p4\">**</ept>, and <bpt id=\"p5\">**</bpt>IPersistStorage::Load<ept id=\"p5\">**</ept>).","pos":[732,1012],"source":"OLE provided the means to uniquely identify persistent documents (**GetClassFile**) and load them into their associated code (`CoCreateInstance`, **QueryInterface(IID_IPersistFile)**, **QueryInterface(IID_IPersistStorage)**, **IPersistFile::Load**, and **IPersistStorage::Load**)."},{"content":"To further enable printing documents, active document containment (using an existing OLE design not shipped with OLE 2.0 originally) introduces a base-standard printing interface, <ph id=\"ph1\">`IPrint`</ph>, generally available through any object that can load the persistent state of the document type.","pos":[1013,1298],"source":" To further enable printing documents, active document containment (using an existing OLE design not shipped with OLE 2.0 originally) introduces a base-standard printing interface, `IPrint`, generally available through any object that can load the persistent state of the document type."},{"content":"Each view of an active document can optionally support the <bpt id=\"p1\">**</bpt>IPrint<ept id=\"p1\">**</ept> interface to provide these capabilities.","pos":[1299,1409],"source":" Each view of an active document can optionally support the **IPrint** interface to provide these capabilities."},{"pos":[1416,1461],"content":"The <ph id=\"ph1\">`IPrint`</ph> interface is defined as follows:","source":"The `IPrint` interface is defined as follows:"},{"content":"Clients and containers simply use <bpt id=\"p1\">**</bpt>IPrint::Print<ept id=\"p1\">**</ept> to instruct the document to print itself once that document is loaded, specifying printing control flags, the target device, the pages to print, and additional options.","pos":[1991,2211],"source":"Clients and containers simply use **IPrint::Print** to instruct the document to print itself once that document is loaded, specifying printing control flags, the target device, the pages to print, and additional options."},{"content":"The client can also control the continuation of printing through the interface <ph id=\"ph1\">`IContinueCallback`</ph> (see below).","pos":[2212,2323],"source":" The client can also control the continuation of printing through the interface `IContinueCallback` (see below)."},{"content":"In addition, <bpt id=\"p1\">**</bpt>IPrint::SetInitialPageNum<ept id=\"p1\">**</ept> supports the ability to print a series of documents as one by numbering pages seamlessly, obviously a benefit for active document containers like Office Binder.","pos":[2330,2533],"source":"In addition, **IPrint::SetInitialPageNum** supports the ability to print a series of documents as one by numbering pages seamlessly, obviously a benefit for active document containers like Office Binder."},{"content":"<bpt id=\"p1\">**</bpt>IPrint::GetPageInfo<ept id=\"p1\">**</ept> makes displaying pagination information simple by allowing the caller to retrieve the starting page number previously passed to <bpt id=\"p2\">**</bpt>SetInitialPageNum<ept id=\"p2\">**</ept> (or the document's internal default starting page number) and the number of pages in the document.","pos":[2534,2806],"source":"**IPrint::GetPageInfo** makes displaying pagination information simple by allowing the caller to retrieve the starting page number previously passed to **SetInitialPageNum** (or the document's internal default starting page number) and the number of pages in the document."},{"pos":[2813,2927],"content":"Objects that support <ph id=\"ph1\">`IPrint`</ph> are marked in the registry with the \"Printable\" key stored under the object's CLSID:","source":"Objects that support `IPrint` are marked in the registry with the \"Printable\" key stored under the object's CLSID:"},{"content":"HKEY_CLASSES_ROOT\\CLSID<ph id=\"ph1\">\\\\</ph>{...}\\Printable","pos":[2934,2974],"source":"HKEY_CLASSES_ROOT\\CLSID\\\\{...}\\Printable"},{"content":"is usually implemented on the same object that supports either <ph id=\"ph1\">`IPersistFile`</ph> or <ph id=\"ph2\">`IPersistStorage`</ph>.","pos":[2990,3089],"source":" is usually implemented on the same object that supports either `IPersistFile` or `IPersistStorage`."},{"content":"Callers note the capability to programmatically print the persistent state of some class by looking in the registry for the \"Printable\" key.","pos":[3090,3230]},{"content":"Currently, \"Printable\" indicates support for at least <ph id=\"ph1\">`IPrint`</ph>; other interfaces may be defined in the future which would then be available through <ph id=\"ph2\">`QueryInterface`</ph> where <bpt id=\"p1\">**</bpt>IPrint<ept id=\"p1\">**</ept> simply represents the base level of support.","pos":[3231,3457],"source":" Currently, \"Printable\" indicates support for at least `IPrint`; other interfaces may be defined in the future which would then be available through `QueryInterface` where **IPrint** simply represents the base level of support."},{"content":"During a print procedure, you may want the client or container that initiated the printing to control whether or not the printing should continue.","pos":[3464,3610]},{"content":"For example, the container may support a \"Stop Print\" command that should terminate the print job as soon as possible.","pos":[3611,3729]},{"content":"To support this capability, the client of a printable object can implement a small notification sink object with the interface <ph id=\"ph1\">`IContinueCallback`</ph>:","pos":[3730,3877],"source":" To support this capability, the client of a printable object can implement a small notification sink object with the interface `IContinueCallback`:"},{"content":"This interface is designed to be useful as a generic continuation callback function that takes the place of the various continuation procedures in the Win32 API (such as the <bpt id=\"p1\">**</bpt>AbortProc<ept id=\"p1\">**</ept> for printing and the <bpt id=\"p2\">**</bpt>EnumMetafileProc<ept id=\"p2\">**</ept> for metafile enumeration).","pos":[4124,4380],"source":"This interface is designed to be useful as a generic continuation callback function that takes the place of the various continuation procedures in the Win32 API (such as the **AbortProc** for printing and the **EnumMetafileProc** for metafile enumeration)."},{"content":"Thus this interface design is useful in a wide variety of time-consuming processes.","pos":[4381,4464]},{"content":"In the most generic cases, the <bpt id=\"p1\">**</bpt>IContinueCallback::FContinue<ept id=\"p1\">**</ept> function is called periodically by any lengthy process.","pos":[4471,4590],"source":"In the most generic cases, the **IContinueCallback::FContinue** function is called periodically by any lengthy process."},{"content":"The sink object returns <ph id=\"ph1\">`S_OK`</ph> to continue the operation, and <bpt id=\"p1\">**</bpt>S_FALSE<ept id=\"p1\">**</ept> to stop the procedure as soon as possible.","pos":[4591,4707],"source":" The sink object returns `S_OK` to continue the operation, and **S_FALSE** to stop the procedure as soon as possible."},{"content":"<bpt id=\"p1\">**</bpt>FContinue<ept id=\"p1\">**</ept>, however, is not used in the context of <bpt id=\"p2\">**</bpt>IPrint::Print<ept id=\"p2\">**</ept>; rather, printing uses <bpt id=\"p3\">**</bpt>IContinueCallback::FContinuePrint<ept id=\"p3\">**</ept>.","pos":[4714,4847],"source":"**FContinue**, however, is not used in the context of **IPrint::Print**; rather, printing uses **IContinueCallback::FContinuePrint**."},{"content":"Any printing object should periodically call <bpt id=\"p1\">**</bpt>FContinuePrinting<ept id=\"p1\">**</ept> passing the number of pages that have been printing, the number of the page being printed, and an additional string describing the print status that the client may choose to display to the user (such as \"Page 5 of 19\").","pos":[4848,5134],"source":" Any printing object should periodically call **FContinuePrinting** passing the number of pages that have been printing, the number of the page being printed, and an additional string describing the print status that the client may choose to display to the user (such as \"Page 5 of 19\")."},{"content":"See Also","pos":[5143,5151]},{"content":"Active Document Containers","pos":[5156,5182]}],"content":"---\ntitle: \"Programmatic Printing | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"printing [MFC], active documents\"\n  - \"active documents [C++], printing\"\n  - \"printing [MFC], programmatic\"\n  - \"IPrint interface\"\n  - \"printing [MFC]\"\nms.assetid: 3db0945b-5e13-4be4-86a0-6aecdae565bd\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Programmatic Printing\nOLE provided the means to uniquely identify persistent documents (**GetClassFile**) and load them into their associated code (`CoCreateInstance`, **QueryInterface(IID_IPersistFile)**, **QueryInterface(IID_IPersistStorage)**, **IPersistFile::Load**, and **IPersistStorage::Load**). To further enable printing documents, active document containment (using an existing OLE design not shipped with OLE 2.0 originally) introduces a base-standard printing interface, `IPrint`, generally available through any object that can load the persistent state of the document type. Each view of an active document can optionally support the **IPrint** interface to provide these capabilities.  \n  \n The `IPrint` interface is defined as follows:  \n  \n `interface IPrint : IUnknown`  \n  \n `{`  \n  \n `HRESULT SetInitialPageNum([in] LONG nFirstPage);`  \n  \n `HRESULT GetPageInfo(`  \n  \n `[out] LONG *pnFirstPage,`  \n  \n `[out] LONG *pcPages);`  \n  \n `HRESULT Print(`  \n  \n `[in] DWORD grfFlags,`  \n  \n `[in,out] DVTARGETDEVICE **pptd,`  \n  \n `[in,out] PAGESET ** ppPageSet,`  \n  \n `[in,out] STGMEDIUM **ppstgmOptions,`  \n  \n `[in] IContinueCallback* pCallback,`  \n  \n `[in] LONG nFirstPage,`  \n  \n `[out] LONG *pcPagesPrinted,`  \n  \n `[out] LONG *pnPageLast);`  \n  \n `};`  \n  \n Clients and containers simply use **IPrint::Print** to instruct the document to print itself once that document is loaded, specifying printing control flags, the target device, the pages to print, and additional options. The client can also control the continuation of printing through the interface `IContinueCallback` (see below).  \n  \n In addition, **IPrint::SetInitialPageNum** supports the ability to print a series of documents as one by numbering pages seamlessly, obviously a benefit for active document containers like Office Binder. **IPrint::GetPageInfo** makes displaying pagination information simple by allowing the caller to retrieve the starting page number previously passed to **SetInitialPageNum** (or the document's internal default starting page number) and the number of pages in the document.  \n  \n Objects that support `IPrint` are marked in the registry with the \"Printable\" key stored under the object's CLSID:  \n  \n HKEY_CLASSES_ROOT\\CLSID\\\\{...}\\Printable  \n  \n `IPrint` is usually implemented on the same object that supports either `IPersistFile` or `IPersistStorage`. Callers note the capability to programmatically print the persistent state of some class by looking in the registry for the \"Printable\" key. Currently, \"Printable\" indicates support for at least `IPrint`; other interfaces may be defined in the future which would then be available through `QueryInterface` where **IPrint** simply represents the base level of support.  \n  \n During a print procedure, you may want the client or container that initiated the printing to control whether or not the printing should continue. For example, the container may support a \"Stop Print\" command that should terminate the print job as soon as possible. To support this capability, the client of a printable object can implement a small notification sink object with the interface `IContinueCallback`:  \n  \n `interface IContinueCallback : IUnknown`  \n  \n `{`  \n  \n `HRESULT FContinue(void);`  \n  \n `HRESULT FContinuePrinting(`  \n  \n `[in] LONG cPagesPrinted,`  \n  \n `[in] LONG nCurrentPage,`  \n  \n `[in] LPOLESTR pszPrintStatus);`  \n  \n `};`  \n  \n This interface is designed to be useful as a generic continuation callback function that takes the place of the various continuation procedures in the Win32 API (such as the **AbortProc** for printing and the **EnumMetafileProc** for metafile enumeration). Thus this interface design is useful in a wide variety of time-consuming processes.  \n  \n In the most generic cases, the **IContinueCallback::FContinue** function is called periodically by any lengthy process. The sink object returns `S_OK` to continue the operation, and **S_FALSE** to stop the procedure as soon as possible.  \n  \n **FContinue**, however, is not used in the context of **IPrint::Print**; rather, printing uses **IContinueCallback::FContinuePrint**. Any printing object should periodically call **FContinuePrinting** passing the number of pages that have been printing, the number of the page being printed, and an additional string describing the print status that the client may choose to display to the user (such as \"Page 5 of 19\").  \n  \n## See Also  \n [Active Document Containers](../mfc/active-document-containers.md)\n\n"}