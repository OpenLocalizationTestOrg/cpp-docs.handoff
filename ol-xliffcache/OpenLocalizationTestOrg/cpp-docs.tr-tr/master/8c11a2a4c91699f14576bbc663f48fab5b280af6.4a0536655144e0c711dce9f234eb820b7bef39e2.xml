{"nodes":[{"pos":[12,54],"content":"CComDynamicUnkArray Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComDynamicUnkArray Class | Microsoft Docs","pos":[0,42]}]},{"pos":[732,757],"content":"CComDynamicUnkArray Class","linkify":"CComDynamicUnkArray Class","nodes":[{"content":"CComDynamicUnkArray Class","pos":[0,25]}]},{"pos":[758,810],"content":"This class stores an array of <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointers.","source":"This class stores an array of **IUnknown** pointers."},{"pos":[819,825],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[873,880],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[890,909],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[916,920]},{"content":"Description","pos":[921,932]},{"pos":[970,1055],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::CComDynamicUnkArray<ept id=\"p1\">](#ccomdynamicunkarray__ccomdynamicunkarray)</ept>","source":"[CComDynamicUnkArray::CComDynamicUnkArray](#ccomdynamicunkarray__ccomdynamicunkarray)"},{"content":"Constructor.","pos":[1056,1068]},{"content":"Initializes the collection values to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> and the collection size to zero.","pos":[1069,1147],"source":" Initializes the collection values to **NULL** and the collection size to zero."},{"pos":[1152,1243],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::~CComDynamicUnkArray<ept id=\"p1\">](#ccomdynamicunkarray___dtorccomdynamicunkarray)</ept>","source":"[CComDynamicUnkArray::~CComDynamicUnkArray](#ccomdynamicunkarray___dtorccomdynamicunkarray)"},{"content":"The destructor.","pos":[1244,1259]},{"pos":[1270,1284],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1291,1295]},{"content":"Description","pos":[1296,1307]},{"pos":[1345,1398],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::Add<ept id=\"p1\">](#ccomdynamicunkarray__add)</ept>","source":"[CComDynamicUnkArray::Add](#ccomdynamicunkarray__add)"},{"pos":[1399,1458],"content":"Call this method to add an <ph id=\"ph1\">`IUnknown`</ph> pointer to the array.","source":"Call this method to add an `IUnknown` pointer to the array."},{"pos":[1463,1520],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::begin<ept id=\"p1\">](#ccomdynamicunkarray__begin)</ept>","source":"[CComDynamicUnkArray::begin](#ccomdynamicunkarray__begin)"},{"pos":[1521,1589],"content":"Returns a pointer to the first <ph id=\"ph1\">`IUnknown`</ph> pointer in the collection.","source":"Returns a pointer to the first `IUnknown` pointer in the collection."},{"pos":[1594,1651],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::clear<ept id=\"p1\">](#ccomdynamicunkarray__clear)</ept>","source":"[CComDynamicUnkArray::clear](#ccomdynamicunkarray__clear)"},{"content":"Empties the array.","pos":[1652,1670]},{"pos":[1675,1728],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::end<ept id=\"p1\">](#ccomdynamicunkarray__end)</ept>","source":"[CComDynamicUnkArray::end](#ccomdynamicunkarray__end)"},{"pos":[1729,1807],"content":"Returns a pointer to one past the last <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer in the collection.","source":"Returns a pointer to one past the last **IUnknown** pointer in the collection."},{"pos":[1812,1869],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::GetAt<ept id=\"p1\">](#ccomdynamicunkarray__getat)</ept>","source":"[CComDynamicUnkArray::GetAt](#ccomdynamicunkarray__getat)"},{"content":"Retrieves the element at the specified index.","pos":[1870,1915]},{"pos":[1920,1985],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::GetCookie<ept id=\"p1\">](#ccomdynamicunkarray__getcookie)</ept>","source":"[CComDynamicUnkArray::GetCookie](#ccomdynamicunkarray__getcookie)"},{"pos":[1986,2066],"content":"Call this method to get the cookie associated with a given <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Call this method to get the cookie associated with a given **IUnknown** pointer."},{"pos":[2071,2132],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::GetSize<ept id=\"p1\">](#ccomdynamicunkarray__getsize)</ept>","source":"[CComDynamicUnkArray::GetSize](#ccomdynamicunkarray__getsize)"},{"content":"Returns the length of an array.","pos":[2133,2164]},{"pos":[2169,2236],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::GetUnknown<ept id=\"p1\">](#ccomdynamicunkarray__getunknown)</ept>","source":"[CComDynamicUnkArray::GetUnknown](#ccomdynamicunkarray__getunknown)"},{"pos":[2237,2317],"content":"Call this method to get the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer associated with a given cookie.","source":"Call this method to get the **IUnknown** pointer associated with a given cookie."},{"pos":[2322,2381],"content":"<bpt id=\"p1\">[</bpt>CComDynamicUnkArray::Remove<ept id=\"p1\">](#ccomdynamicunkarray__remove)</ept>","source":"[CComDynamicUnkArray::Remove](#ccomdynamicunkarray__remove)"},{"pos":[2382,2448],"content":"Call this method to remove an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer from the array.","source":"Call this method to remove an **IUnknown** pointer from the array."},{"pos":[2458,2465],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<bpt id=\"p1\">**</bpt>CComDynamicUnkArray<ept id=\"p1\">**</ept> holds a dynamically allocated array of <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> pointers, each an interface on a connection point.","pos":[2469,2595],"source":"**CComDynamicUnkArray** holds a dynamically allocated array of **IUnknown** pointers, each an interface on a connection point."},{"content":"<bpt id=\"p1\">**</bpt>CComDynamicUnkArray<ept id=\"p1\">**</ept> can be used as a parameter to the <bpt id=\"p2\">[</bpt>IConnectionPointImpl<ept id=\"p2\">](../../atl/reference/iconnectionpointimpl-class.md)</ept> template class.","pos":[2596,2743],"source":"**CComDynamicUnkArray** can be used as a parameter to the [IConnectionPointImpl](../../atl/reference/iconnectionpointimpl-class.md) template class."},{"pos":[2750,2948],"content":"The <bpt id=\"p1\">**</bpt>CComDynamicUnkArray<ept id=\"p1\">**</ept> methods <bpt id=\"p2\">[</bpt>begin<ept id=\"p2\">](#ccomdynamicunkarray__begin)</ept> and <bpt id=\"p3\">[</bpt>end<ept id=\"p3\">](#ccomdynamicunkarray__end)</ept> can be used to loop through all connection points (for example, when an event is fired).","source":"The **CComDynamicUnkArray** methods [begin](#ccomdynamicunkarray__begin) and [end](#ccomdynamicunkarray__end) can be used to loop through all connection points (for example, when an event is fired)."},{"pos":[2955,3114],"content":"See <bpt id=\"p1\">[</bpt>Adding Connection Points to an Object<ept id=\"p1\">](../../atl/adding-connection-points-to-an-object.md)</ept> for details on automating creation of connection point proxies.","source":"See [Adding Connection Points to an Object](../../atl/adding-connection-points-to-an-object.md) for details on automating creation of connection point proxies."},{"pos":[3122,3461],"content":"[!NOTE]\n**Note** The class **CComDynamicUnkArray** is used by the **Add Class** wizard when creating a control which has Connection Points. If you wish to specify the number of Connection Points manually, change the reference from **CComDynamicUnkArray** to `CComUnkArray<` *n* `>`, where *n* is the number of connection points required.","leadings":["","> "],"nodes":[{"content":"**Note** The class **CComDynamicUnkArray** is used by the **Add Class** wizard when creating a control which has Connection Points. If you wish to specify the number of Connection Points manually, change the reference from **CComDynamicUnkArray** to `CComUnkArray<` *n* `>`, where *n* is the number of connection points required.","pos":[8,337],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> The class <bpt id=\"p2\">**</bpt>CComDynamicUnkArray<ept id=\"p2\">**</ept> is used by the <bpt id=\"p3\">**</bpt>Add Class<ept id=\"p3\">**</ept> wizard when creating a control which has Connection Points.","pos":[0,131],"source":"**Note** The class **CComDynamicUnkArray** is used by the **Add Class** wizard when creating a control which has Connection Points."},{"content":"If you wish to specify the number of Connection Points manually, change the reference from <bpt id=\"p1\">**</bpt>CComDynamicUnkArray<ept id=\"p1\">**</ept> to <ph id=\"ph1\">`CComUnkArray&lt;`</ph> <bpt id=\"p2\">*</bpt>n<ept id=\"p2\">*</ept> <ph id=\"ph2\">`&gt;`</ph>, where <bpt id=\"p3\">*</bpt>n<ept id=\"p3\">*</ept> is the number of connection points required.","pos":[132,329],"source":" If you wish to specify the number of Connection Points manually, change the reference from **CComDynamicUnkArray** to `CComUnkArray<` *n* `>`, where *n* is the number of connection points required."}]}]},{"pos":[3470,3482],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3486,3506],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[3516,3581],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__add\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::Add","linkify":"<a name=\"ccomdynamicunkarray__add\"></a>  CComDynamicUnkArray::Add","source":"<a name=\"ccomdynamicunkarray__add\"></a>  CComDynamicUnkArray::Add"},{"pos":[3585,3646],"content":"Call this method to add an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer to the array.","source":"Call this method to add an **IUnknown** pointer to the array."},{"pos":[3696,3706],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pUnk<ept id=\"p1\">*</ept>","pos":[3710,3716],"source":"*pUnk*"},{"content":"The <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer to add to the array.","pos":[3720,3765],"source":" The **IUnknown** pointer to add to the array."},{"pos":[3775,3787],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns the cookie associated with the newly added pointer.","pos":[3791,3850]},{"pos":[3860,3929],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__begin\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::begin","linkify":"<a name=\"ccomdynamicunkarray__begin\"></a>  CComDynamicUnkArray::begin","source":"<a name=\"ccomdynamicunkarray__begin\"></a>  CComDynamicUnkArray::begin"},{"pos":[3933,4021],"content":"Returns a pointer to the beginning of the collection of <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface pointers.","source":"Returns a pointer to the beginning of the collection of **IUnknown** interface pointers."},{"pos":[4071,4083],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[4087,4134],"content":"A pointer to an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface pointer.","source":"A pointer to an **IUnknown** interface pointer."},{"pos":[4144,4151],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The collection contains pointers to interfaces stored locally as <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>.","pos":[4155,4233],"source":"The collection contains pointers to interfaces stored locally as **IUnknown**."},{"content":"You cast each <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface to the real interface type and then call through it.","pos":[4234,4323],"source":" You cast each **IUnknown** interface to the real interface type and then call through it."},{"content":"You do not need to query for the interface first.","pos":[4324,4373]},{"pos":[4380,4462],"content":"Before using the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface, you should check that it is not <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","source":"Before using the **IUnknown** interface, you should check that it is not **NULL**."},{"pos":[4472,4541],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__clear\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::clear","linkify":"<a name=\"ccomdynamicunkarray__clear\"></a>  CComDynamicUnkArray::clear","source":"<a name=\"ccomdynamicunkarray__clear\"></a>  CComDynamicUnkArray::clear"},{"content":"Empties the array.","pos":[4545,4563]},{"pos":[4600,4697],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__ccomdynamicunkarray\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::CComDynamicUnkArray","linkify":"<a name=\"ccomdynamicunkarray__ccomdynamicunkarray\"></a>  CComDynamicUnkArray::CComDynamicUnkArray","source":"<a name=\"ccomdynamicunkarray__ccomdynamicunkarray\"></a>  CComDynamicUnkArray::CComDynamicUnkArray"},{"content":"The constructor.","pos":[4701,4717]},{"pos":[4763,4770],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Sets the collection size to zero and initializes the values to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[4774,4846],"source":"Sets the collection size to zero and initializes the values to **NULL**."},{"content":"The destructor frees the collection, if necessary.","pos":[4847,4897]},{"pos":[4907,5010],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray___dtorccomdynamicunkarray\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::~CComDynamicUnkArray","linkify":"<a name=\"ccomdynamicunkarray___dtorccomdynamicunkarray\"></a>  CComDynamicUnkArray::~CComDynamicUnkArray","source":"<a name=\"ccomdynamicunkarray___dtorccomdynamicunkarray\"></a>  CComDynamicUnkArray::~CComDynamicUnkArray"},{"content":"The destructor.","pos":[5014,5029]},{"pos":[5076,5083],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Frees resources allocated by the class constructor.","pos":[5087,5138]},{"pos":[5148,5213],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__end\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::end","linkify":"<a name=\"ccomdynamicunkarray__end\"></a>  CComDynamicUnkArray::end","source":"<a name=\"ccomdynamicunkarray__end\"></a>  CComDynamicUnkArray::end"},{"pos":[5217,5295],"content":"Returns a pointer to one past the last <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer in the collection.","source":"Returns a pointer to one past the last **IUnknown** pointer in the collection."},{"pos":[5343,5355],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[5359,5406],"content":"A pointer to an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface pointer.","source":"A pointer to an **IUnknown** interface pointer."},{"pos":[5416,5485],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__getat\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::GetAt","linkify":"<a name=\"ccomdynamicunkarray__getat\"></a>  CComDynamicUnkArray::GetAt","source":"<a name=\"ccomdynamicunkarray__getat\"></a>  CComDynamicUnkArray::GetAt"},{"content":"Retrieves the element at the specified index.","pos":[5489,5534]},{"pos":[5588,5598],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The index of the element to retrieve.","pos":[5614,5651]},{"pos":[5661,5673],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[5677,5774],"content":"A pointer to an <bpt id=\"p1\">[</bpt>IUnknown<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680509)</ept> interface.","source":"A pointer to an [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) interface."},{"pos":[5784,5861],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__getcookie\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::GetCookie","linkify":"<a name=\"ccomdynamicunkarray__getcookie\"></a>  CComDynamicUnkArray::GetCookie","source":"<a name=\"ccomdynamicunkarray__getcookie\"></a>  CComDynamicUnkArray::GetCookie"},{"pos":[5865,5945],"content":"Call this method to get the cookie associated with a given <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Call this method to get the cookie associated with a given **IUnknown** pointer."},{"pos":[6011,6021],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer for which the associated cookie is required.","pos":[6037,6106],"source":" The **IUnknown** pointer for which the associated cookie is required."},{"pos":[6116,6128],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[6132,6246],"content":"Returns the cookie associated with the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer, or zero if no matching <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> pointer is found.","source":"Returns the cookie associated with the **IUnknown** pointer, or zero if no matching **IUnknown** pointer is found."},{"pos":[6256,6263],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6267,6387],"content":"If there is more than one instance of the same <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer, this function returns the cookie for the first one.","source":"If there is more than one instance of the same **IUnknown** pointer, this function returns the cookie for the first one."},{"pos":[6397,6470],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__getsize\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::GetSize","linkify":"<a name=\"ccomdynamicunkarray__getsize\"></a>  CComDynamicUnkArray::GetSize","source":"<a name=\"ccomdynamicunkarray__getsize\"></a>  CComDynamicUnkArray::GetSize"},{"content":"Returns the length of an array.","pos":[6474,6505]},{"pos":[6549,6561],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The length of the array.","pos":[6565,6589]},{"pos":[6599,6678],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__getunknown\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::GetUnknown","linkify":"<a name=\"ccomdynamicunkarray__getunknown\"></a>  CComDynamicUnkArray::GetUnknown","source":"<a name=\"ccomdynamicunkarray__getunknown\"></a>  CComDynamicUnkArray::GetUnknown"},{"pos":[6682,6762],"content":"Call this method to get the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer associated with a given cookie.","source":"Call this method to get the **IUnknown** pointer associated with a given cookie."},{"pos":[6832,6842],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The cookie for which the associated <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer is required.","pos":[6860,6929],"source":" The cookie for which the associated **IUnknown** pointer is required."},{"pos":[6939,6951],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[6955,7028],"content":"Returns the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer, or NULL if no matching cookie is found.","source":"Returns the **IUnknown** pointer, or NULL if no matching cookie is found."},{"pos":[7038,7109],"content":"<bpt id=\"p1\">&lt;a name=\"ccomdynamicunkarray__remove\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComDynamicUnkArray::Remove","linkify":"<a name=\"ccomdynamicunkarray__remove\"></a>  CComDynamicUnkArray::Remove","source":"<a name=\"ccomdynamicunkarray__remove\"></a>  CComDynamicUnkArray::Remove"},{"pos":[7113,7179],"content":"Call this method to remove an <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer from the array.","source":"Call this method to remove an **IUnknown** pointer from the array."},{"pos":[7233,7243],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The cookie referencing the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer to be removed from the array.","pos":[7261,7338],"source":" The cookie referencing the **IUnknown** pointer to be removed from the array."},{"pos":[7348,7360],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns TRUE if the pointer is removed; otherwise FALSE.","pos":[7364,7420]},{"pos":[7429,7437],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CComUnkArray Class<ept id=\"p1\">](../../atl/reference/ccomunkarray-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[7441,7505],"source":"[CComUnkArray Class](../../atl/reference/ccomunkarray-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","pos":[7508,7558],"source":" [Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"CComDynamicUnkArray Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL.CComDynamicUnkArray\"\n  - \"CComDynamicUnkArray\"\n  - \"ATL::CComDynamicUnkArray\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"connection points [C++], managing\"\n  - \"CComDynamicUnkArray class\"\nms.assetid: 202470d7-9a1b-498f-b96d-659d681acd65\ncaps.latest.revision: 17\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComDynamicUnkArray Class\nThis class stores an array of **IUnknown** pointers.  \n  \n## Syntax  \n  \n```\nclass CComDynamicUnkArray\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComDynamicUnkArray::CComDynamicUnkArray](#ccomdynamicunkarray__ccomdynamicunkarray)|Constructor. Initializes the collection values to **NULL** and the collection size to zero.|  \n|[CComDynamicUnkArray::~CComDynamicUnkArray](#ccomdynamicunkarray___dtorccomdynamicunkarray)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComDynamicUnkArray::Add](#ccomdynamicunkarray__add)|Call this method to add an `IUnknown` pointer to the array.|  \n|[CComDynamicUnkArray::begin](#ccomdynamicunkarray__begin)|Returns a pointer to the first `IUnknown` pointer in the collection.|  \n|[CComDynamicUnkArray::clear](#ccomdynamicunkarray__clear)|Empties the array.|  \n|[CComDynamicUnkArray::end](#ccomdynamicunkarray__end)|Returns a pointer to one past the last **IUnknown** pointer in the collection.|  \n|[CComDynamicUnkArray::GetAt](#ccomdynamicunkarray__getat)|Retrieves the element at the specified index.|  \n|[CComDynamicUnkArray::GetCookie](#ccomdynamicunkarray__getcookie)|Call this method to get the cookie associated with a given **IUnknown** pointer.|  \n|[CComDynamicUnkArray::GetSize](#ccomdynamicunkarray__getsize)|Returns the length of an array.|  \n|[CComDynamicUnkArray::GetUnknown](#ccomdynamicunkarray__getunknown)|Call this method to get the **IUnknown** pointer associated with a given cookie.|  \n|[CComDynamicUnkArray::Remove](#ccomdynamicunkarray__remove)|Call this method to remove an **IUnknown** pointer from the array.|  \n  \n## Remarks  \n **CComDynamicUnkArray** holds a dynamically allocated array of **IUnknown** pointers, each an interface on a connection point. **CComDynamicUnkArray** can be used as a parameter to the [IConnectionPointImpl](../../atl/reference/iconnectionpointimpl-class.md) template class.  \n  \n The **CComDynamicUnkArray** methods [begin](#ccomdynamicunkarray__begin) and [end](#ccomdynamicunkarray__end) can be used to loop through all connection points (for example, when an event is fired).  \n  \n See [Adding Connection Points to an Object](../../atl/adding-connection-points-to-an-object.md) for details on automating creation of connection point proxies.  \n  \n> [!NOTE]\n> **Note** The class **CComDynamicUnkArray** is used by the **Add Class** wizard when creating a control which has Connection Points. If you wish to specify the number of Connection Points manually, change the reference from **CComDynamicUnkArray** to `CComUnkArray<` *n* `>`, where *n* is the number of connection points required.  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ccomdynamicunkarray__add\"></a>  CComDynamicUnkArray::Add  \n Call this method to add an **IUnknown** pointer to the array.  \n  \n```\nDWORD Add(IUnknown* pUnk);\n```  \n  \n### Parameters  \n *pUnk*  \n The **IUnknown** pointer to add to the array.  \n  \n### Return Value  \n Returns the cookie associated with the newly added pointer.  \n  \n##  <a name=\"ccomdynamicunkarray__begin\"></a>  CComDynamicUnkArray::begin  \n Returns a pointer to the beginning of the collection of **IUnknown** interface pointers.  \n  \n```\nIUnknown**\n    begin();\n```     \n  \n### Return Value  \n A pointer to an **IUnknown** interface pointer.  \n  \n### Remarks  \n The collection contains pointers to interfaces stored locally as **IUnknown**. You cast each **IUnknown** interface to the real interface type and then call through it. You do not need to query for the interface first.  \n  \n Before using the **IUnknown** interface, you should check that it is not **NULL**.  \n  \n##  <a name=\"ccomdynamicunkarray__clear\"></a>  CComDynamicUnkArray::clear  \n Empties the array.  \n  \n```\nvoid clear();\n```  \n  \n##  <a name=\"ccomdynamicunkarray__ccomdynamicunkarray\"></a>  CComDynamicUnkArray::CComDynamicUnkArray  \n The constructor.  \n  \n```\nCComDynamicUnkArray();\n```  \n  \n### Remarks  \n Sets the collection size to zero and initializes the values to **NULL**. The destructor frees the collection, if necessary.  \n  \n##  <a name=\"ccomdynamicunkarray___dtorccomdynamicunkarray\"></a>  CComDynamicUnkArray::~CComDynamicUnkArray  \n The destructor.  \n  \n```\n~CComDynamicUnkArray();\n```  \n  \n### Remarks  \n Frees resources allocated by the class constructor.  \n  \n##  <a name=\"ccomdynamicunkarray__end\"></a>  CComDynamicUnkArray::end  \n Returns a pointer to one past the last **IUnknown** pointer in the collection.  \n  \n```\nIUnknown**\n    end();\n```     \n  \n### Return Value  \n A pointer to an **IUnknown** interface pointer.  \n  \n##  <a name=\"ccomdynamicunkarray__getat\"></a>  CComDynamicUnkArray::GetAt  \n Retrieves the element at the specified index.  \n  \n```\nIUnknown* GetAt(int   nIndex);\n```  \n  \n### Parameters  \n `nIndex`  \n The index of the element to retrieve.  \n  \n### Return Value  \n A pointer to an [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) interface.  \n  \n##  <a name=\"ccomdynamicunkarray__getcookie\"></a>  CComDynamicUnkArray::GetCookie  \n Call this method to get the cookie associated with a given **IUnknown** pointer.  \n  \n```\nDWORD WINAPI GetCookie(IUnknown** ppFind);\n```  \n  \n### Parameters  \n `ppFind`  \n The **IUnknown** pointer for which the associated cookie is required.  \n  \n### Return Value  \n Returns the cookie associated with the **IUnknown** pointer, or zero if no matching **IUnknown** pointer is found.  \n  \n### Remarks  \n If there is more than one instance of the same **IUnknown** pointer, this function returns the cookie for the first one.  \n  \n##  <a name=\"ccomdynamicunkarray__getsize\"></a>  CComDynamicUnkArray::GetSize  \n Returns the length of an array.  \n  \n```\nint GetSize() const;\n```  \n  \n### Return Value  \n The length of the array.  \n  \n##  <a name=\"ccomdynamicunkarray__getunknown\"></a>  CComDynamicUnkArray::GetUnknown  \n Call this method to get the **IUnknown** pointer associated with a given cookie.  \n  \n```\nIUnknown* WINAPI GetUnknown(DWORD   dwCookie);\n```  \n  \n### Parameters  \n `dwCookie`  \n The cookie for which the associated **IUnknown** pointer is required.  \n  \n### Return Value  \n Returns the **IUnknown** pointer, or NULL if no matching cookie is found.  \n  \n##  <a name=\"ccomdynamicunkarray__remove\"></a>  CComDynamicUnkArray::Remove  \n Call this method to remove an **IUnknown** pointer from the array.  \n  \n```\nBOOL Remove(DWORD   dwCookie);\n```  \n  \n### Parameters  \n `dwCookie`  \n The cookie referencing the **IUnknown** pointer to be removed from the array.  \n  \n### Return Value  \n Returns TRUE if the pointer is removed; otherwise FALSE.  \n  \n## See Also  \n [CComUnkArray Class](../../atl/reference/ccomunkarray-class.md)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}