{"nodes":[{"pos":[12,64],"content":"CDataSource::OpenWithPromptFileName | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDataSource::OpenWithPromptFileName | Microsoft Docs","pos":[0,52]}]},{"content":"CDataSource::OpenWithPromptFileName","pos":[821,856]},{"content":"This method prompts the user with a dialog box, then opens a data source using the file specified by the user.","pos":[857,967]},{"content":"Syntax","pos":[976,982]},{"content":"Parameters","pos":[1215,1225]},{"content":"[in] Handle to the window that is to be the parent of the dialog box.","pos":[1239,1308]},{"content":"[in] Determines the style of locator dialog box to display.","pos":[1336,1395]},{"content":"See Msdasc.h for possible values.","pos":[1396,1429]},{"content":"szInitialDirectory","pos":[1437,1455]},{"content":"[in] The initial directory to display in the locator dialog box.","pos":[1460,1524]},{"content":"Return Value","pos":[1533,1545]},{"pos":[1549,1570],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph>.","source":"A standard `HRESULT`."},{"content":"Remarks","pos":[1579,1586]},{"content":"This method opens a data source object using the service components in oledb32.dll; this DLL contains the implementation of Service Components features such as Resource Pooling, Automatic Transaction Enlistment, and so on.","pos":[1590,1812]},{"content":"For more information, see \"OLE DB Services\" in the OLE DB Programmer's Reference at <bpt id=\"p1\">[</bpt>http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true<ept id=\"p1\">](http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true)</ept>.","pos":[1813,2110],"source":" For more information, see \"OLE DB Services\" in the OLE DB Programmer's Reference at [http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true](http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true)."},{"content":"Requirements","pos":[2119,2131]},{"pos":[2135,2157],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldbcli.h","source":"**Header:** atldbcli.h"},{"content":"See Also","pos":[2166,2174]},{"content":"CDataSource Class","pos":[2179,2196]}],"content":"---\ntitle: \"CDataSource::OpenWithPromptFileName | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"CDataSource.OpenWithPromptFileName\"\n  - \"OpenWithPromptFileName\"\n  - \"ATL::CDataSource::OpenWithPromptFileName\"\n  - \"ATL.CDataSource.OpenWithPromptFileName\"\n  - \"CDataSource::OpenWithPromptFileName\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OpenWithPromptFileName method\"\nms.assetid: 89460504-1aaf-4412-aa7b-fa5a4b39ada3\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDataSource::OpenWithPromptFileName\nThis method prompts the user with a dialog box, then opens a data source using the file specified by the user.  \n  \n## Syntax  \n  \n```  \n  \n      HRESULT OpenWithPromptFileName(   \n   HWND hWnd = GetActiveWindow(   \n   ),   \n   DBPROMPTOPTIONS dwPromptOptions = DBPROMPTOPTIONS_NONE,   \n   LPCOLESTR szInitialDirectory = NULL    \n) throw( );  \n```  \n  \n#### Parameters  \n `hWnd`  \n [in] Handle to the window that is to be the parent of the dialog box.  \n  \n `dwPromptOptions`  \n [in] Determines the style of locator dialog box to display. See Msdasc.h for possible values.  \n  \n *szInitialDirectory*  \n [in] The initial directory to display in the locator dialog box.  \n  \n## Return Value  \n A standard `HRESULT`.  \n  \n## Remarks  \n This method opens a data source object using the service components in oledb32.dll; this DLL contains the implementation of Service Components features such as Resource Pooling, Automatic Transaction Enlistment, and so on. For more information, see \"OLE DB Services\" in the OLE DB Programmer's Reference at [http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true](http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true).  \n  \n## Requirements  \n **Header:** atldbcli.h  \n  \n## See Also  \n [CDataSource Class](../../data/oledb/cdatasource-class.md)"}