{"nodes":[{"pos":[12,40],"content":"CView Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CView Class | Microsoft Docs","pos":[0,28]}]},{"content":"CView Class","pos":[910,921]},{"content":"Provides the basic functionality for user-defined view classes.","pos":[922,985]},{"content":"Syntax","pos":[994,1000]},{"content":"Members","pos":[1065,1072]},{"content":"Protected Constructors","pos":[1082,1104]},{"content":"Name","pos":[1111,1115]},{"content":"Description","pos":[1116,1127]},{"content":"CView::CView","pos":[1166,1178]},{"pos":[1195,1223],"content":"Constructs a <ph id=\"ph1\">`CView`</ph> object.","source":"Constructs a `CView` object."},{"content":"Public Methods","pos":[1234,1248]},{"content":"Name","pos":[1255,1259]},{"content":"Description","pos":[1260,1271]},{"content":"CView::DoPreparePrinting","pos":[1310,1334]},{"pos":[1363,1486],"content":"Displays Print dialog box and creates printer device context; call when overriding the <ph id=\"ph1\">`OnPreparePrinting`</ph> member function.","source":"Displays Print dialog box and creates printer device context; call when overriding the `OnPreparePrinting` member function."},{"content":"CView::GetDocument","pos":[1492,1510]},{"content":"Returns the document associated with the view.","pos":[1533,1579]},{"content":"CView::IsSelected","pos":[1585,1602]},{"content":"Tests whether a document item is selected.","pos":[1624,1666]},{"content":"Required for OLE support.","pos":[1667,1692]},{"content":"CView::OnDragEnter","pos":[1698,1716]},{"content":"Called when an item is first dragged into the drag-and-drop region of a view.","pos":[1739,1816]},{"content":"CView::OnDragLeave","pos":[1822,1840]},{"content":"Called when a dragged item leaves the drag-and-drop region of a view.","pos":[1863,1932]},{"content":"CView::OnDragOver","pos":[1938,1955]},{"content":"Called when an item is dragged over the drag-and-drop region of a view.","pos":[1977,2048]},{"content":"CView::OnDragScroll","pos":[2054,2073]},{"content":"Called to determine whether the cursor is dragged into the scroll region of the window.","pos":[2097,2184]},{"content":"CView::OnDrop","pos":[2190,2203]},{"content":"Called when an item has been dropped into the drag-and-drop region of a view, default handler.","pos":[2221,2315]},{"content":"CView::OnDropEx","pos":[2321,2336]},{"content":"Called when an item has been dropped into the drag-and-drop region of a view, primary handler.","pos":[2356,2450]},{"content":"CView::OnInitialUpdate","pos":[2456,2478]},{"content":"Called after a view is first attached to a document.","pos":[2505,2557]},{"content":"CView::OnPrepareDC","pos":[2563,2581]},{"pos":[2604,2749],"content":"Called before the <ph id=\"ph1\">`OnDraw`</ph> member function is called for screen display or the <ph id=\"ph2\">`OnPrint`</ph> member function is called for printing or print preview.","source":"Called before the `OnDraw` member function is called for screen display or the `OnPrint` member function is called for printing or print preview."},{"content":"CView::OnScroll","pos":[2755,2770]},{"content":"Called when OLE items are dragged beyond the borders of the view.","pos":[2790,2855]},{"content":"CView::OnScrollBy","pos":[2861,2878]},{"content":"Called when a view containing active in-place OLE items is scrolled.","pos":[2900,2968]},{"content":"Protected Methods","pos":[2979,2996]},{"content":"Name","pos":[3003,3007]},{"content":"Description","pos":[3008,3019]},{"content":"CView::OnActivateFrame","pos":[3058,3080]},{"content":"Called when the frame window containing the view is activated or deactivated.","pos":[3107,3184]},{"content":"CView::OnActivateView","pos":[3190,3211]},{"content":"Called when a view is activated.","pos":[3237,3269]},{"content":"CView::OnBeginPrinting","pos":[3275,3297]},{"content":"Called when a print job begins; override to allocate graphics device interface (GDI) resources.","pos":[3324,3419]},{"content":"CView::OnDraw","pos":[3425,3438]},{"content":"Called to render an image of the document for screen display, printing, or print preview.","pos":[3456,3545]},{"content":"Implementation required.","pos":[3546,3570]},{"content":"CView::OnEndPrinting","pos":[3576,3596]},{"content":"Called when a print job ends; override to deallocate GDI resources.","pos":[3621,3688]},{"content":"CView::OnEndPrintPreview","pos":[3694,3718]},{"content":"Called when preview mode is exited.","pos":[3747,3782]},{"content":"CView::OnPreparePrinting","pos":[3788,3812]},{"content":"Called before a document is printed or previewed; override to initialize Print dialog box.","pos":[3841,3931]},{"content":"CView::OnPrint","pos":[3937,3951]},{"content":"Called to print or preview a page of the document.","pos":[3970,4020]},{"content":"CView::OnUpdate","pos":[4026,4041]},{"content":"Called to notify a view that its document has been modified.","pos":[4061,4121]},{"content":"Remarks","pos":[4131,4138]},{"content":"A view is attached to a document and acts as an intermediary between the document and the user: the view renders an image of the document on the screen or printer and interprets user input as operations upon the document.","pos":[4142,4363]},{"content":"A view is a child of a frame window.","pos":[4370,4406]},{"content":"More than one view can share a frame window, as in the case of a splitter window.","pos":[4407,4488]},{"content":"The relationship between a view class, a frame window class, and a document class is established by a <ph id=\"ph1\">`CDocTemplate`</ph> object.","pos":[4489,4613],"source":" The relationship between a view class, a frame window class, and a document class is established by a `CDocTemplate` object."},{"content":"When the user opens a new window or splits an existing one, the framework constructs a new view and attaches it to the document.","pos":[4614,4742]},{"content":"A view can be attached to only one document, but a document can have multiple views attached to it at once â€” for example, if the document is displayed in a splitter window or in multiple child windows in a multiple document interface (MDI) application.","pos":[4749,5001]},{"content":"Your application can support different types of views for a given document type; for example, a word-processing program might provide both a complete text view of a document and an outline view that shows only the section headings.","pos":[5002,5233]},{"content":"These different types of views can be placed in separate frame windows or in separate panes of a single frame window if you use a splitter window.","pos":[5234,5380]},{"content":"A view may be responsible for handling several different types of input, such as keyboard input, mouse input or input via drag-and-drop, as well as commands from menus, toolbars, or scroll bars.","pos":[5387,5581]},{"content":"A view receives commands forwarded by its frame window.","pos":[5582,5637]},{"content":"If the view does not handle a given command, it forwards the command to its associated document.","pos":[5638,5734]},{"content":"Like all command targets, a view handles messages via a message map.","pos":[5735,5803]},{"content":"The view is responsible for displaying and modifying the document's data but not for storing it.","pos":[5810,5906]},{"content":"The document provides the view with the necessary details about its data.","pos":[5907,5980]},{"content":"You can let the view access the document's data members directly, or you can provide member functions in the document class for the view class to call.","pos":[5981,6132]},{"content":"When a document's data changes, the view responsible for the changes typically calls the <bpt id=\"p1\">[</bpt>CDocument::UpdateAllViews<ept id=\"p1\">](../../mfc/reference/cdocument-class.md#cdocument__updateallviews)</ept> function for the document, which notifies all the other views by calling the <ph id=\"ph1\">`OnUpdate`</ph> member function for each.","pos":[6139,6435],"source":"When a document's data changes, the view responsible for the changes typically calls the [CDocument::UpdateAllViews](../../mfc/reference/cdocument-class.md#cdocument__updateallviews) function for the document, which notifies all the other views by calling the `OnUpdate` member function for each."},{"content":"The default implementation of <ph id=\"ph1\">`OnUpdate`</ph> invalidates the view's entire client area.","pos":[6436,6519],"source":" The default implementation of `OnUpdate` invalidates the view's entire client area."},{"content":"You can override it to invalidate only those regions of the client area that map to the modified portions of the document.","pos":[6520,6642]},{"content":"To use <ph id=\"ph1\">`CView`</ph>, derive a class from it and implement the <ph id=\"ph2\">`OnDraw`</ph> member function to perform screen display.","pos":[6649,6757],"source":"To use `CView`, derive a class from it and implement the `OnDraw` member function to perform screen display."},{"content":"You can also use <ph id=\"ph1\">`OnDraw`</ph> to perform printing and print preview.","pos":[6758,6822],"source":" You can also use `OnDraw` to perform printing and print preview."},{"content":"The framework handles the print loop for printing and previewing your document.","pos":[6823,6902]},{"content":"A view handles scroll-bar messages with the <bpt id=\"p1\">[</bpt>CWnd::OnHScroll<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__onhscroll)</ept> and <bpt id=\"p2\">[</bpt>CWnd::OnVScroll<ept id=\"p2\">](../../mfc/reference/cwnd-class.md#cwnd__onvscroll)</ept> member functions.","pos":[6909,7112],"source":"A view handles scroll-bar messages with the [CWnd::OnHScroll](../../mfc/reference/cwnd-class.md#cwnd__onhscroll) and [CWnd::OnVScroll](../../mfc/reference/cwnd-class.md#cwnd__onvscroll) member functions."},{"content":"You can implement scroll-bar message handling in these functions, or you can use the <ph id=\"ph1\">`CView`</ph> derived class <bpt id=\"p1\">[</bpt>CScrollView<ept id=\"p1\">](../../mfc/reference/cscrollview-class.md)</ept> to handle scrolling for you.","pos":[7113,7304],"source":" You can implement scroll-bar message handling in these functions, or you can use the `CView` derived class [CScrollView](../../mfc/reference/cscrollview-class.md) to handle scrolling for you."},{"pos":[7311,7422],"content":"Besides <ph id=\"ph1\">`CScrollView`</ph>, the Microsoft Foundation Class Library provides nine other classes derived from <ph id=\"ph2\">`CView`</ph>:","source":"Besides `CScrollView`, the Microsoft Foundation Class Library provides nine other classes derived from `CView`:"},{"pos":[7430,7580],"content":"<bpt id=\"p1\">[</bpt>CCtrlView<ept id=\"p1\">](../../mfc/reference/cctrlview-class.md)</ept>, a view that allows usage of document - view architecture with tree, list, and rich edit controls.","source":"[CCtrlView](../../mfc/reference/cctrlview-class.md), a view that allows usage of document - view architecture with tree, list, and rich edit controls."},{"pos":[7588,7712],"content":"<bpt id=\"p1\">[</bpt>CDaoRecordView<ept id=\"p1\">](../../mfc/reference/cdaorecordview-class.md)</ept>, a view that displays database records in dialog-box controls.","source":"[CDaoRecordView](../../mfc/reference/cdaorecordview-class.md), a view that displays database records in dialog-box controls."},{"content":"<bpt id=\"p1\">[</bpt>CEditView<ept id=\"p1\">](../../mfc/reference/ceditview-class.md)</ept>, a view that provides a simple multiline text editor.","pos":[7720,7825],"source":"[CEditView](../../mfc/reference/ceditview-class.md), a view that provides a simple multiline text editor."},{"content":"You can use a <ph id=\"ph1\">`CEditView`</ph> object as a control in a dialog box as well as a view on a document.","pos":[7826,7920],"source":" You can use a `CEditView` object as a control in a dialog box as well as a view on a document."},{"pos":[7928,8076],"content":"<bpt id=\"p1\">[</bpt>CFormView<ept id=\"p1\">](../../mfc/reference/cformview-class.md)</ept>, a scrollable view that contains dialog-box controls and is based on a dialog template resource.","source":"[CFormView](../../mfc/reference/cformview-class.md), a scrollable view that contains dialog-box controls and is based on a dialog template resource."},{"pos":[8084,8213],"content":"<bpt id=\"p1\">[</bpt>CListView<ept id=\"p1\">](../../mfc/reference/clistview-class.md)</ept>, a view that allows usage of document - view architecture with list controls.","source":"[CListView](../../mfc/reference/clistview-class.md), a view that allows usage of document - view architecture with list controls."},{"pos":[8221,8339],"content":"<bpt id=\"p1\">[</bpt>CRecordView<ept id=\"p1\">](../../mfc/reference/crecordview-class.md)</ept>, a view that displays database records in dialog-box controls.","source":"[CRecordView](../../mfc/reference/crecordview-class.md), a view that displays database records in dialog-box controls."},{"pos":[8347,8489],"content":"<bpt id=\"p1\">[</bpt>CRichEditView<ept id=\"p1\">](../../mfc/reference/cricheditview-class.md)</ept>, a view that allows usage of document - view architecture with rich edit controls.","source":"[CRichEditView](../../mfc/reference/cricheditview-class.md), a view that allows usage of document - view architecture with rich edit controls."},{"pos":[8497,8607],"content":"<bpt id=\"p1\">[</bpt>CScrollView<ept id=\"p1\">](../../mfc/reference/cscrollview-class.md)</ept>, a view that automatically provides scrolling support.","source":"[CScrollView](../../mfc/reference/cscrollview-class.md), a view that automatically provides scrolling support."},{"pos":[8615,8744],"content":"<bpt id=\"p1\">[</bpt>CTreeView<ept id=\"p1\">](../../mfc/reference/ctreeview-class.md)</ept>, a view that allows usage of document - view architecture with tree controls.","source":"[CTreeView](../../mfc/reference/ctreeview-class.md), a view that allows usage of document - view architecture with tree controls."},{"content":"The <ph id=\"ph1\">`CView`</ph> class also has a derived implementation class named <bpt id=\"p1\">**</bpt>CPreviewView<ept id=\"p1\">**</ept>, which is used by the framework to perform print previewing.","pos":[8751,8892],"source":"The `CView` class also has a derived implementation class named **CPreviewView**, which is used by the framework to perform print previewing."},{"content":"This class provides support for the features unique to the print-preview window, such as a toolbar, single- or double-page preview, and zooming, that is, enlarging the previewed image.","pos":[8893,9077]},{"content":"You don't need to call or override any of <bpt id=\"p1\">**</bpt>CPreviewView<ept id=\"p1\">**</ept>'s member functions unless you want to implement your own interface for print preview (for example, if you want to support editing in print preview mode).","pos":[9078,9290],"source":" You don't need to call or override any of **CPreviewView**'s member functions unless you want to implement your own interface for print preview (for example, if you want to support editing in print preview mode)."},{"content":"For more information on using <ph id=\"ph1\">`CView`</ph>, see <bpt id=\"p1\">[</bpt>Document/View Architecture<ept id=\"p1\">](../../mfc/document-view-architecture.md)</ept> and <bpt id=\"p2\">[</bpt>Printing<ept id=\"p2\">](../../mfc/printing.md)</ept>.","pos":[9291,9442],"source":" For more information on using `CView`, see [Document/View Architecture](../../mfc/document-view-architecture.md) and [Printing](../../mfc/printing.md)."},{"content":"In addition, see <bpt id=\"p1\">[</bpt>Technical Note 30<ept id=\"p1\">](../../mfc/tn030-customizing-printing-and-print-preview.md)</ept> for more details on customizing print preview.","pos":[9443,9585],"source":" In addition, see [Technical Note 30](../../mfc/tn030-customizing-printing-and-print-preview.md) for more details on customizing print preview."},{"content":"Inheritance Hierarchy","pos":[9594,9615]},{"content":"CObject","pos":[9620,9627]},{"content":"CCmdTarget","pos":[9674,9684]},{"content":"CWnd","pos":[9734,9738]},{"content":"Requirements","pos":[9797,9809]},{"pos":[9813,9833],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxwin.h","source":"**Header:** afxwin.h"},{"pos":[9872,9884],"content":"CView::CView"},{"pos":[9888,9916],"content":"Constructs a <ph id=\"ph1\">`CView`</ph> object.","source":"Constructs a `CView` object."},{"content":"Remarks","pos":[9950,9957]},{"content":"The framework calls the constructor when a new frame window is created or a window is split.","pos":[9961,10053]},{"content":"Override the <bpt id=\"p1\">[</bpt>OnInitialUpdate<ept id=\"p1\">](#cview__oninitialupdate)</ept> member function to initialize the view after the document is attached.","pos":[10054,10180],"source":" Override the [OnInitialUpdate](#cview__oninitialupdate) member function to initialize the view after the document is attached."},{"pos":[10231,10255],"content":"CView::DoPreparePrinting"},{"pos":[10259,10414],"content":"Call this function from your override of <bpt id=\"p1\">[</bpt>OnPreparePrinting<ept id=\"p1\">](#cview__onprepareprinting)</ept> to invoke the Print dialog box and create a printer device context.","source":"Call this function from your override of [OnPreparePrinting](#cview__onprepareprinting) to invoke the Print dialog box and create a printer device context."},{"content":"Parameters","pos":[10482,10492]},{"content":"Points to a <bpt id=\"p1\">[</bpt>CPrintInfo<ept id=\"p1\">](../../mfc/reference/cprintinfo-structure.md)</ept> structure that describes the current print job.","pos":[10507,10624],"source":" Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job."},{"content":"Return Value","pos":[10634,10646]},{"content":"Nonzero if printing or print preview can begin; 0 if the operation has been canceled.","pos":[10650,10735]},{"content":"Remarks","pos":[10745,10752]},{"content":"This function's behavior depends on whether it is being called for printing or print preview (specified by the <bpt id=\"p1\">**</bpt>m_bPreview<ept id=\"p1\">**</ept> member of the <ph id=\"ph1\">`pInfo`</ph> parameter).","pos":[10756,10915],"source":"This function's behavior depends on whether it is being called for printing or print preview (specified by the **m_bPreview** member of the `pInfo` parameter)."},{"content":"If a file is being printed, this function invokes the Print dialog box, using the values in the <bpt id=\"p1\">[</bpt>CPrintInfo<ept id=\"p1\">](../../mfc/reference/cprintinfo-structure.md)</ept> structure that <ph id=\"ph1\">`pInfo`</ph> points to; after the user has closed the dialog box, the function creates a printer device context based on settings the user specified in the dialog box and returns this device context through the <ph id=\"ph2\">`pInfo`</ph> parameter.","pos":[10916,11309],"source":" If a file is being printed, this function invokes the Print dialog box, using the values in the [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that `pInfo` points to; after the user has closed the dialog box, the function creates a printer device context based on settings the user specified in the dialog box and returns this device context through the `pInfo` parameter."},{"content":"This device context is used to print the document.","pos":[11310,11360]},{"content":"If a file is being previewed, this function creates a printer device context using the current printer settings; this device context is used for simulating the printer during preview.","pos":[11367,11550]},{"pos":[11595,11613],"content":"CView::GetDocument"},{"content":"Call this function to get a pointer to the view's document.","pos":[11617,11676]},{"content":"Return Value","pos":[11736,11748]},{"content":"A pointer to the <bpt id=\"p1\">[</bpt>CDocument<ept id=\"p1\">](../../mfc/reference/cdocument-class.md)</ept> object associated with the view.","pos":[11752,11853],"source":"A pointer to the [CDocument](../../mfc/reference/cdocument-class.md) object associated with the view."},{"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if the view is not attached to a document.","pos":[11854,11905],"source":"**NULL** if the view is not attached to a document."},{"content":"Remarks","pos":[11915,11922]},{"content":"This allows you to call the document's member functions.","pos":[11926,11982]},{"pos":[12026,12043],"content":"CView::IsSelected"},{"content":"Called by the framework to check whether the specified document item is selected.","pos":[12047,12128]},{"content":"Parameters","pos":[12212,12222]},{"content":"Points to the document item being tested.","pos":[12240,12281]},{"content":"Return Value","pos":[12291,12303]},{"content":"Nonzero if the specified document item is selected; otherwise 0.","pos":[12307,12371]},{"content":"Remarks","pos":[12381,12388]},{"content":"The default implementation of this function returns <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[12392,12454],"source":"The default implementation of this function returns **FALSE**."},{"content":"Override this function if you are implementing selection using <bpt id=\"p1\">[</bpt>CDocItem<ept id=\"p1\">](../../mfc/reference/cdocitem-class.md)</ept> objects.","pos":[12455,12576],"source":" Override this function if you are implementing selection using [CDocItem](../../mfc/reference/cdocitem-class.md) objects."},{"content":"You must override this function if your view contains OLE items.","pos":[12577,12641]},{"pos":[12690,12712],"content":"CView::OnActivateFrame"},{"content":"Called by the framework when the frame window containing the view is activated or deactivated.","pos":[12716,12810]},{"content":"Parameters","pos":[12911,12921]},{"content":"Specifies whether the frame window is being activated or deactivated.","pos":[12937,13006]},{"content":"It can be one of the following values:","pos":[13007,13045]},{"pos":[13053,13107],"content":"<bpt id=\"p1\">**</bpt>WA_INACTIVE<ept id=\"p1\">**</ept> The frame window is being deactivated.","source":"**WA_INACTIVE** The frame window is being deactivated."},{"pos":[13115,13279],"content":"<bpt id=\"p1\">**</bpt>WA_ACTIVE<ept id=\"p1\">**</ept> The frame window is being activated through some method other than a mouse click (for example, by use of the keyboard interface to select the window).","source":"**WA_ACTIVE** The frame window is being activated through some method other than a mouse click (for example, by use of the keyboard interface to select the window)."},{"pos":[13287,13358],"content":"<bpt id=\"p1\">**</bpt>WA_CLICKACTIVE<ept id=\"p1\">**</ept> The frame window is being activated by a mouse click","source":"**WA_CLICKACTIVE** The frame window is being activated by a mouse click"},{"pos":[13365,13432],"content":"`pFrameWnd`  \nPointer to the frame window that is to be activated.","leadings":[""," "],"nodes":[{"content":"Pointer to the frame window that is to be activated.","pos":[14,66]}]},{"content":"Remarks","pos":[13442,13449]},{"content":"Override this member function if you want to perform special processing when the frame window associated with the view is activated or deactivated.","pos":[13453,13600]},{"content":"For example, <bpt id=\"p1\">[</bpt>CFormView<ept id=\"p1\">](../../mfc/reference/cformview-class.md)</ept> performs this override when it saves and restores the control that has focus.","pos":[13601,13743],"source":" For example, [CFormView](../../mfc/reference/cformview-class.md) performs this override when it saves and restores the control that has focus."},{"pos":[13791,13812],"content":"CView::OnActivateView"},{"content":"Called by the framework when a view is activated or deactivated.","pos":[13816,13880]},{"content":"Parameters","pos":[14011,14021]},{"content":"Indicates whether the view is being activated or deactivated.","pos":[14040,14101]},{"content":"Points to the view object that is being activated.","pos":[14127,14177]},{"content":"Points to the view object that is being deactivated.","pos":[14203,14255]},{"content":"Remarks","pos":[14265,14272]},{"content":"The default implementation of this function sets the focus to the view being activated.","pos":[14276,14363]},{"content":"Override this function if you want to perform special processing when a view is activated or deactivated.","pos":[14364,14469]},{"content":"For example, if you want to provide special visual cues that distinguish the active view from the inactive views, you would examine the <ph id=\"ph1\">`bActivate`</ph> parameter and update the view's appearance accordingly.","pos":[14470,14673],"source":" For example, if you want to provide special visual cues that distinguish the active view from the inactive views, you would examine the `bActivate` parameter and update the view's appearance accordingly."},{"content":"The <ph id=\"ph1\">`pActivateView`</ph> and <ph id=\"ph2\">`pDeactiveView`</ph> parameters point to the same view if the application's main frame window is activated with no change in the active view â€” for example, if the focus is being transferred from another application to this one, rather than from one view to another within the application or when switching amongst MDI child windows.","pos":[14680,15031],"source":"The `pActivateView` and `pDeactiveView` parameters point to the same view if the application's main frame window is activated with no change in the active view â€” for example, if the focus is being transferred from another application to this one, rather than from one view to another within the application or when switching amongst MDI child windows."},{"content":"This allows a view to re-realize its palette, if needed.","pos":[15032,15088]},{"content":"These parameters differ when <bpt id=\"p1\">[</bpt>CFrameWnd::SetActiveView<ept id=\"p1\">](../../mfc/reference/cframewnd-class.md#cframewnd__setactiveview)</ept> is called with a view that is different from what <bpt id=\"p2\">[</bpt>CFrameWnd::GetActiveView<ept id=\"p2\">](../../mfc/reference/cframewnd-class.md#cframewnd__getactiveview)</ept> would return.","pos":[15095,15371],"source":"These parameters differ when [CFrameWnd::SetActiveView](../../mfc/reference/cframewnd-class.md#cframewnd__setactiveview) is called with a view that is different from what [CFrameWnd::GetActiveView](../../mfc/reference/cframewnd-class.md#cframewnd__getactiveview) would return."},{"content":"This happens most often with splitter windows.","pos":[15372,15418]},{"pos":[15467,15489],"content":"CView::OnBeginPrinting"},{"pos":[15493,15609],"content":"Called by the framework at the beginning of a print or print preview job, after <ph id=\"ph1\">`OnPreparePrinting`</ph> has been called.","source":"Called by the framework at the beginning of a print or print preview job, after `OnPreparePrinting` has been called."},{"content":"Parameters","pos":[15704,15714]},{"content":"Points to the printer device context.","pos":[15727,15764]},{"content":"Points to a <bpt id=\"p1\">[</bpt>CPrintInfo<ept id=\"p1\">](../../mfc/reference/cprintinfo-structure.md)</ept> structure that describes the current print job.","pos":[15782,15899],"source":" Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job."},{"content":"Remarks","pos":[15909,15916]},{"content":"The default implementation of this function does nothing.","pos":[15920,15977]},{"content":"Override this function to allocate any GDI resources, such as pens or fonts, needed specifically for printing.","pos":[15978,16088]},{"content":"Select the GDI objects into the device context from within the <bpt id=\"p1\">[</bpt>OnPrint<ept id=\"p1\">](#cview__onprint)</ept> member function for each page that uses them.","pos":[16089,16224],"source":" Select the GDI objects into the device context from within the [OnPrint](#cview__onprint) member function for each page that uses them."},{"content":"If you are using the same view object to perform both screen display and printing, use separate variables for the GDI resources needed for each display; this allows you to update the screen during printing.","pos":[16225,16431]},{"content":"You can also use this function to perform initializations that depend on properties of the printer device context.","pos":[16438,16552]},{"content":"For example, the number of pages needed to print the document may depend on settings that the user specified from the Print dialog box (such as page length).","pos":[16553,16710]},{"content":"In such a situation, you cannot specify the document length in the <bpt id=\"p1\">[</bpt>OnPreparePrinting<ept id=\"p1\">](#cview__onprepareprinting)</ept> member function, where you would normally do so; you must wait until the printer device context has been created based on the dialog box settings.","pos":[16711,16971],"source":" In such a situation, you cannot specify the document length in the [OnPreparePrinting](#cview__onprepareprinting) member function, where you would normally do so; you must wait until the printer device context has been created based on the dialog box settings."},{"content":"<bpt id=\"p1\">[</bpt>OnBeginPrinting<ept id=\"p1\">](#cview__onbeginprinting)</ept> is the first overridable function that gives you access to the <bpt id=\"p2\">[</bpt>CDC<ept id=\"p2\">](../../mfc/reference/cdc-class.md)</ept> object representing the printer device context, so you can set the document length from this function.","pos":[16972,17220],"source":"[OnBeginPrinting](#cview__onbeginprinting) is the first overridable function that gives you access to the [CDC](../../mfc/reference/cdc-class.md) object representing the printer device context, so you can set the document length from this function."},{"content":"Note that if the document length is not specified by this time, a scroll bar is not displayed during print preview.","pos":[17221,17336]},{"pos":[17381,17399],"content":"CView::OnDragEnter"},{"content":"Called by the framework when the mouse first enters the non-scrolling region of the drop target window.","pos":[17403,17506]},{"content":"Parameters","pos":[17641,17651]},{"content":"Points to the <bpt id=\"p1\">[</bpt>COleDataObject<ept id=\"p1\">](../../mfc/reference/coledataobject-class.md)</ept> being dragged into the drop area of the view.","pos":[17672,17793],"source":" Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) being dragged into the drop area of the view."},{"content":"Contains the state of the modifier keys.","pos":[17816,17856]},{"content":"This is a combination of any number of the following: <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>MK_SHIFT<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>MK_ALT<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>MK_LBUTTON<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>MK_MBUTTON<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>MK_RBUTTON<ept id=\"p6\">**</ept>.","pos":[17857,18004],"source":" This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**."},{"content":"The current mouse position relative to the client area of the view.","pos":[18022,18089]},{"content":"Return Value","pos":[18099,18111]},{"content":"A value from the <ph id=\"ph1\">`DROPEFFECT`</ph> enumerated type, which indicates the type of drop that would occur if the user dropped the object at this position.","pos":[18115,18260],"source":"A value from the `DROPEFFECT` enumerated type, which indicates the type of drop that would occur if the user dropped the object at this position."},{"content":"The type of drop usually depends on the current key state indicated by <ph id=\"ph1\">`dwKeyState`</ph>.","pos":[18261,18345],"source":" The type of drop usually depends on the current key state indicated by `dwKeyState`."},{"content":"A standard mapping of keystates to <ph id=\"ph1\">`DROPEFFECT`</ph> values is:","pos":[18346,18404],"source":" A standard mapping of keystates to `DROPEFFECT` values is:"},{"pos":[18430,18479],"content":"The data object cannot be dropped in this window."},{"pos":[18505,18592],"content":"for <bpt id=\"p1\">**</bpt>MK_CONTROL &amp;#124; MK_SHIFT<ept id=\"p1\">**</ept> Creates a linkage between the object and its server.","source":" for **MK_CONTROL &#124; MK_SHIFT** Creates a linkage between the object and its server."},{"pos":[18618,18674],"content":"for <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept> Creates a copy of the dropped object.","source":" for **MK_CONTROL** Creates a copy of the dropped object."},{"content":"for <bpt id=\"p1\">**</bpt>MK_ALT<ept id=\"p1\">**</ept> Creates a copy of the dropped object and delete the original object.","pos":[18700,18783],"source":" for **MK_ALT** Creates a copy of the dropped object and delete the original object."},{"content":"This is typically the default drop effect, when the view can accept this data object.","pos":[18784,18869]},{"pos":[18876,18974],"content":"For more information, see the MFC Advanced Concepts sample <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","source":"For more information, see the MFC Advanced Concepts sample [OCLIENT](../../visual-cpp-samples.md)."},{"content":"Remarks","pos":[18984,18991]},{"pos":[18995,19064],"content":"Default implementation is to do nothing and return <ph id=\"ph1\">`DROPEFFECT_NONE`</ph>.","source":"Default implementation is to do nothing and return `DROPEFFECT_NONE`."},{"content":"Override this function to prepare for future calls to the <bpt id=\"p1\">[</bpt>OnDragOver<ept id=\"p1\">](#cview__ondragover)</ept> member function.","pos":[19071,19178],"source":"Override this function to prepare for future calls to the [OnDragOver](#cview__ondragover) member function."},{"content":"Any data required from the data object should be retrieved at this time for later use in the <ph id=\"ph1\">`OnDragOver`</ph> member function.","pos":[19179,19301],"source":" Any data required from the data object should be retrieved at this time for later use in the `OnDragOver` member function."},{"content":"The view should also be updated at this time to give the user visual feedback.","pos":[19302,19380]},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Drag and Drop: Implementing a Drop Target<ept id=\"p1\">](../../mfc/drag-and-drop-implementing-a-drop-target.md)</ept>.","pos":[19381,19518],"source":" For more information, see the article [Drag and Drop: Implementing a Drop Target](../../mfc/drag-and-drop-implementing-a-drop-target.md)."},{"pos":[19563,19581],"content":"CView::OnDragLeave"},{"content":"Called by the framework during a drag operation when the mouse is moved out of the valid drop area for that window.","pos":[19585,19700]},{"content":"Remarks","pos":[19753,19760]},{"pos":[19764,20011],"content":"Override this function if the current view needs to clean up any actions taken during <bpt id=\"p1\">[</bpt>OnDragEnter<ept id=\"p1\">](#cview__ondragenter)</ept> or <bpt id=\"p2\">[</bpt>OnDragOver<ept id=\"p2\">](#cview__ondragover)</ept> calls, such as removing any visual user feedback while the object was dragged and dropped.","source":"Override this function if the current view needs to clean up any actions taken during [OnDragEnter](#cview__ondragenter) or [OnDragOver](#cview__ondragover) calls, such as removing any visual user feedback while the object was dragged and dropped."},{"pos":[20055,20072],"content":"CView::OnDragOver"},{"content":"Called by the framework during a drag operation when the mouse is moved over the drop target window.","pos":[20076,20176]},{"content":"Parameters","pos":[20310,20320]},{"content":"Points to the <bpt id=\"p1\">[</bpt>COleDataObject<ept id=\"p1\">](../../mfc/reference/coledataobject-class.md)</ept> being dragged over the drop target.","pos":[20341,20452],"source":" Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) being dragged over the drop target."},{"content":"Contains the state of the modifier keys.","pos":[20475,20515]},{"content":"This is a combination of any number of the following: <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>MK_SHIFT<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>MK_ALT<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>MK_LBUTTON<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>MK_MBUTTON<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>MK_RBUTTON<ept id=\"p6\">**</ept>.","pos":[20516,20663],"source":" This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**."},{"content":"The current mouse position relative to the view client area.","pos":[20681,20741]},{"content":"Return Value","pos":[20751,20763]},{"content":"A value from the <ph id=\"ph1\">`DROPEFFECT`</ph> enumerated type, which indicates the type of drop that would occur if the user dropped the object at this position.","pos":[20767,20912],"source":"A value from the `DROPEFFECT` enumerated type, which indicates the type of drop that would occur if the user dropped the object at this position."},{"content":"The type of drop often depends on the current key state as indicated by <ph id=\"ph1\">`dwKeyState`</ph>.","pos":[20913,20998],"source":" The type of drop often depends on the current key state as indicated by `dwKeyState`."},{"content":"A standard mapping of keystates to <ph id=\"ph1\">`DROPEFFECT`</ph> values is:","pos":[20999,21057],"source":" A standard mapping of keystates to `DROPEFFECT` values is:"},{"pos":[21083,21132],"content":"The data object cannot be dropped in this window."},{"pos":[21158,21245],"content":"for <bpt id=\"p1\">**</bpt>MK_CONTROL &amp;#124; MK_SHIFT<ept id=\"p1\">**</ept> Creates a linkage between the object and its server.","source":" for **MK_CONTROL &#124; MK_SHIFT** Creates a linkage between the object and its server."},{"pos":[21271,21327],"content":"for <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept> Creates a copy of the dropped object.","source":" for **MK_CONTROL** Creates a copy of the dropped object."},{"content":"for <bpt id=\"p1\">**</bpt>MK_ALT<ept id=\"p1\">**</ept> Creates a copy of the dropped object and delete the original object.","pos":[21353,21436],"source":" for **MK_ALT** Creates a copy of the dropped object and delete the original object."},{"content":"This is typically the default drop effect, when the view can accept the data object.","pos":[21437,21521]},{"pos":[21528,21626],"content":"For more information, see the MFC Advanced Concepts sample <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","source":"For more information, see the MFC Advanced Concepts sample [OCLIENT](../../visual-cpp-samples.md)."},{"content":"Remarks","pos":[21636,21643]},{"pos":[21647,21720],"content":"The default implementation is to do nothing and return <ph id=\"ph1\">`DROPEFFECT_NONE`</ph>.","source":"The default implementation is to do nothing and return `DROPEFFECT_NONE`."},{"content":"Override this function to give the user visual feedback during the drag operation.","pos":[21727,21809]},{"content":"Since this function is called continuously, any code contained within it should be optimized as much as possible.","pos":[21810,21923]},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Drag and Drop: Implementing a Drop Target<ept id=\"p1\">](../../mfc/drag-and-drop-implementing-a-drop-target.md)</ept>.","pos":[21924,22061],"source":" For more information, see the article [Drag and Drop: Implementing a Drop Target](../../mfc/drag-and-drop-implementing-a-drop-target.md)."},{"pos":[22107,22126],"content":"CView::OnDragScroll"},{"pos":[22130,22298],"content":"Called by the framework before calling <bpt id=\"p1\">[</bpt>OnDragEnter<ept id=\"p1\">](#cview__ondragenter)</ept> or <bpt id=\"p2\">[</bpt>OnDragOver<ept id=\"p2\">](#cview__ondragover)</ept> to determine whether the point is in the scrolling region.","source":"Called by the framework before calling [OnDragEnter](#cview__ondragenter) or [OnDragOver](#cview__ondragover) to determine whether the point is in the scrolling region."},{"content":"Parameters","pos":[22399,22409]},{"content":"Contains the state of the modifier keys.","pos":[22429,22469]},{"content":"This is a combination of any number of the following: <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>MK_SHIFT<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>MK_ALT<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>MK_LBUTTON<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>MK_MBUTTON<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>MK_RBUTTON<ept id=\"p6\">**</ept>.","pos":[22470,22617],"source":" This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**."},{"content":"Contains the location of the cursor, in pixels, relative to the screen.","pos":[22635,22706]},{"content":"Return Value","pos":[22716,22728]},{"content":"A value from the <ph id=\"ph1\">`DROPEFFECT`</ph> enumerated type, which indicates the type of drop that would occur if the user dropped the object at this position.","pos":[22732,22877],"source":"A value from the `DROPEFFECT` enumerated type, which indicates the type of drop that would occur if the user dropped the object at this position."},{"content":"The type of drop usually depends on the current key state indicated by <ph id=\"ph1\">`dwKeyState`</ph>.","pos":[22878,22962],"source":" The type of drop usually depends on the current key state indicated by `dwKeyState`."},{"content":"A standard mapping of keystates to <ph id=\"ph1\">`DROPEFFECT`</ph> values is:","pos":[22963,23021],"source":" A standard mapping of keystates to `DROPEFFECT` values is:"},{"pos":[23047,23096],"content":"The data object cannot be dropped in this window."},{"pos":[23122,23209],"content":"for <bpt id=\"p1\">**</bpt>MK_CONTROL &amp;#124; MK_SHIFT<ept id=\"p1\">**</ept> Creates a linkage between the object and its server.","source":" for **MK_CONTROL &#124; MK_SHIFT** Creates a linkage between the object and its server."},{"pos":[23235,23291],"content":"for <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept> Creates a copy of the dropped object.","source":" for **MK_CONTROL** Creates a copy of the dropped object."},{"pos":[23317,23400],"content":"for <bpt id=\"p1\">**</bpt>MK_ALT<ept id=\"p1\">**</ept> Creates a copy of the dropped object and delete the original object.","source":" for **MK_ALT** Creates a copy of the dropped object and delete the original object."},{"pos":[23428,23520],"content":"Indicates that a drag scroll operation is about to occur or is occurring in the target view."},{"pos":[23527,23625],"content":"For more information, see the MFC Advanced Concepts sample <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","source":"For more information, see the MFC Advanced Concepts sample [OCLIENT](../../visual-cpp-samples.md)."},{"content":"Remarks","pos":[23635,23642]},{"content":"Override this function when you want to provide special behavior for this event.","pos":[23646,23726]},{"content":"The default implementation automatically scrolls windows when the cursor is dragged into the default scroll region inside the border of each window.For more information, see the article <bpt id=\"p1\">[</bpt>Drag and Drop: Implementing a Drop Target<ept id=\"p1\">](../../mfc/drag-and-drop-implementing-a-drop-target.md)</ept>.","pos":[23727,24012],"source":" The default implementation automatically scrolls windows when the cursor is dragged into the default scroll region inside the border of each window.For more information, see the article [Drag and Drop: Implementing a Drop Target](../../mfc/drag-and-drop-implementing-a-drop-target.md)."},{"pos":[24052,24065],"content":"CView::OnDraw"},{"content":"Called by the framework to render an image of the document.","pos":[24069,24128]},{"content":"Parameters","pos":[24190,24200]},{"content":"Points to the device context to be used for rendering an image of the document.","pos":[24213,24292]},{"content":"Remarks","pos":[24302,24309]},{"content":"The framework calls this function to perform screen display, printing, and print preview, and it passes a different device context in each case.","pos":[24313,24457]},{"content":"There is no default implementation.","pos":[24458,24493]},{"content":"You must override this function to display your view of the document.","pos":[24500,24569]},{"content":"You can make graphic device interface (GDI) calls using the <bpt id=\"p1\">[</bpt>CDC<ept id=\"p1\">](../../mfc/reference/cdc-class.md)</ept> object pointed to by the <ph id=\"ph1\">`pDC`</ph> parameter.","pos":[24570,24711],"source":" You can make graphic device interface (GDI) calls using the [CDC](../../mfc/reference/cdc-class.md) object pointed to by the `pDC` parameter."},{"content":"You can select GDI resources, such as pens or fonts, into the device context before drawing and then deselect them afterwards.","pos":[24712,24838]},{"content":"Often your drawing code can be device-independent; that is, it doesn't require information about what type of device is displaying the image.","pos":[24839,24980]},{"content":"To optimize drawing, call the <bpt id=\"p1\">[</bpt>RectVisible<ept id=\"p1\">](../../mfc/reference/cdc-class.md#cdc__rectvisible)</ept> member function of the device context to find out whether a given rectangle will be drawn.","pos":[24987,25172],"source":"To optimize drawing, call the [RectVisible](../../mfc/reference/cdc-class.md#cdc__rectvisible) member function of the device context to find out whether a given rectangle will be drawn."},{"content":"If you need to distinguish between normal screen display and printing, call the <bpt id=\"p1\">[</bpt>IsPrinting<ept id=\"p1\">](../../mfc/reference/cdc-class.md#cdc__isprinting)</ept> member function of the device context.","pos":[25173,25354],"source":" If you need to distinguish between normal screen display and printing, call the [IsPrinting](../../mfc/reference/cdc-class.md#cdc__isprinting) member function of the device context."},{"pos":[25394,25407],"content":"CView::OnDrop"},{"content":"Called by the framework when the user releases a data object over a valid drop target.","pos":[25411,25497]},{"content":"Parameters","pos":[25626,25636]},{"content":"Points to the <bpt id=\"p1\">[</bpt>COleDataObject<ept id=\"p1\">](../../mfc/reference/coledataobject-class.md)</ept> that is dropped into the drop target.","pos":[25657,25770],"source":" Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) that is dropped into the drop target."},{"content":"The drop effect that the user has requested.","pos":[25793,25837]},{"pos":[25863,25911],"content":"Creates a copy of the data object being dropped."},{"pos":[25937,25989],"content":"Moves the data object to the current mouse location."},{"pos":[26015,26067],"content":"Creates a link between a data object and its server."},{"pos":[26074,26145],"content":"`point`  \nThe current mouse position relative to the view client area.","leadings":[""," "],"nodes":[{"content":"The current mouse position relative to the view client area.","pos":[10,70]}]},{"content":"Return Value","pos":[26155,26167]},{"content":"Nonzero if the drop was successful; otherwise 0.","pos":[26171,26219]},{"content":"Remarks","pos":[26229,26236]},{"pos":[26240,26302],"content":"The default implementation does nothing and returns <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","source":"The default implementation does nothing and returns **FALSE**."},{"content":"Override this function to implement the effect of an OLE drop into the client area of the view.","pos":[26309,26404]},{"content":"The data object can be examined via <ph id=\"ph1\">`pDataObject`</ph> for Clipboard data formats and data dropped at the specified point.","pos":[26405,26522],"source":" The data object can be examined via `pDataObject` for Clipboard data formats and data dropped at the specified point."},{"pos":[26530,26658],"content":"[!NOTE]\n The framework does not call this function if there is an override to [OnDropEx](#cview__ondropex) in this view class.","leadings":["","> "],"nodes":[{"content":"The framework does not call this function if there is an override to <bpt id=\"p1\">[</bpt>OnDropEx<ept id=\"p1\">](#cview__ondropex)</ept> in this view class.","pos":[9,126],"source":" The framework does not call this function if there is an override to [OnDropEx](#cview__ondropex) in this view class."}]},{"pos":[26700,26715],"content":"CView::OnDropEx"},{"content":"Called by the framework when the user releases a data object over a valid drop target.","pos":[26719,26805]},{"content":"Parameters","pos":[26970,26980]},{"content":"Points to the <bpt id=\"p1\">[</bpt>COleDataObject<ept id=\"p1\">](../../mfc/reference/coledataobject-class.md)</ept> that is dropped into the drop target.","pos":[27001,27114],"source":" Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) that is dropped into the drop target."},{"content":"The effect that the user chose for the default drop operation based on the current key state.","pos":[27138,27231]},{"content":"It may be <ph id=\"ph1\">`DROPEFFECT_NONE`</ph>.","pos":[27232,27260],"source":" It may be `DROPEFFECT_NONE`."},{"content":"Drop effects are discussed in the Remarks section.","pos":[27261,27311]},{"content":"A list of the drop effects that the drop source supports.","pos":[27332,27389]},{"content":"Drop effect values can be combined using the bitwise OR ( <bpt id=\"p1\">**</bpt>&amp;#124;<ept id=\"p1\">**</ept>) operation.","pos":[27390,27470],"source":" Drop effect values can be combined using the bitwise OR ( **&#124;**) operation."},{"content":"Drop effects are discussed in the Remarks section.","pos":[27471,27521]},{"content":"The current mouse position relative to the view client area.","pos":[27539,27599]},{"content":"Return Value","pos":[27609,27621]},{"content":"The drop effect that resulted from the drop attempt at the location specified by <ph id=\"ph1\">`point`</ph>.","pos":[27625,27714],"source":"The drop effect that resulted from the drop attempt at the location specified by `point`."},{"content":"This must be one of the values indicated by <bpt id=\"p1\">*</bpt>dropEffectList<ept id=\"p1\">*</ept>.","pos":[27715,27776],"source":" This must be one of the values indicated by *dropEffectList*."},{"content":"Drop effects are discussed in the Remarks section.","pos":[27777,27827]},{"content":"Remarks","pos":[27837,27844]},{"pos":[27848,28004],"content":"The default implementation is to do nothing and return a dummy value ( -1 ) to indicate that the framework should call the <bpt id=\"p1\">[</bpt>OnDrop<ept id=\"p1\">](#cview__ondrop)</ept> handler.","source":"The default implementation is to do nothing and return a dummy value ( -1 ) to indicate that the framework should call the [OnDrop](#cview__ondrop) handler."},{"content":"Override this function to implement the effect of an right mouse-button drag and drop.","pos":[28011,28097]},{"content":"Right mouse-button drag and drop typically displays a menu of choices when the right mouse-button is released.","pos":[28098,28208]},{"content":"Your override of <ph id=\"ph1\">`OnDropEx`</ph> should query for the right mouse-button.","pos":[28215,28283],"source":"Your override of `OnDropEx` should query for the right mouse-button."},{"content":"You can call <bpt id=\"p1\">[</bpt>GetKeyState<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms646301)</ept> or store the right mouse-button state from your <bpt id=\"p2\">[</bpt>OnDragEnter<ept id=\"p2\">](#cview__ondragenter)</ept> handler.","pos":[28284,28462],"source":" You can call [GetKeyState](http://msdn.microsoft.com/library/windows/desktop/ms646301) or store the right mouse-button state from your [OnDragEnter](#cview__ondragenter) handler."},{"content":"If the right mouse-button is down, your override should display a popup menu which offers the drop effects support by the drop source.","pos":[28472,28606]},{"content":"Examine <ph id=\"ph1\">`dropList`</ph> to determine the drop effects supported by the drop source.","pos":[28620,28698],"source":"Examine `dropList` to determine the drop effects supported by the drop source."},{"content":"Enable only these actions on the popup menu.","pos":[28699,28743]},{"pos":[28757,28891],"content":"Use <bpt id=\"p1\">[</bpt>SetMenuDefaultItem<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms647996)</ept> to set the default action based on <ph id=\"ph1\">`dropDefault`</ph>.","source":"Use [SetMenuDefaultItem](http://msdn.microsoft.com/library/windows/desktop/ms647996) to set the default action based on `dropDefault`."},{"content":"Finally, take the action indicated by the user selection from the popup menu.","pos":[28905,28982]},{"content":"If the right mouse-button is not down, your override should process this as a standard drop request.","pos":[28992,29092]},{"content":"Use the drop effect specified in <ph id=\"ph1\">`dropDefault`</ph>.","pos":[29093,29140],"source":" Use the drop effect specified in `dropDefault`."},{"content":"Alternately, your override can return the dummy value ( -1 ) to indicate that <ph id=\"ph1\">`OnDrop`</ph> will handle this drop operation.","pos":[29141,29260],"source":" Alternately, your override can return the dummy value ( -1 ) to indicate that `OnDrop` will handle this drop operation."},{"pos":[29267,29383],"content":"Use <ph id=\"ph1\">`pDataObject`</ph> to examine the <ph id=\"ph2\">`COleDataObject`</ph> for Clipboard data format and data dropped at the specified point.","source":"Use `pDataObject` to examine the `COleDataObject` for Clipboard data format and data dropped at the specified point."},{"content":"Drop effects describe the action associated with a drop operation.","pos":[29390,29456]},{"content":"See the following list of drop effects:","pos":[29457,29496]},{"pos":[29522,29550],"content":"A drop would not be allowed."},{"pos":[29576,29612],"content":"A copy operation would be performed."},{"pos":[29638,29674],"content":"A move operation would be performed."},{"pos":[29700,29771],"content":"A link from the dropped data to the original data would be established."},{"pos":[29799,29886],"content":"Indicates that a drag scroll operation is about to occur or is occurring in the target."},{"pos":[29893,30192],"content":"For more information on setting the default menu command, see <bpt id=\"p1\">[</bpt>SetMenuDefaultItem<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms647996)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> and <bpt id=\"p2\">[</bpt>CMenu::GetSafeHmenu<ept id=\"p2\">](../../mfc/reference/cmenu-class.md#cmenu__getsafehmenu)</ept> in this volume.","source":"For more information on setting the default menu command, see [SetMenuDefaultItem](http://msdn.microsoft.com/library/windows/desktop/ms647996) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] and [CMenu::GetSafeHmenu](../../mfc/reference/cmenu-class.md#cmenu__getsafehmenu) in this volume."},{"pos":[30239,30259],"content":"CView::OnEndPrinting"},{"content":"Called by the framework after a document has been printed or previewed.","pos":[30263,30334]},{"content":"Parameters","pos":[30427,30437]},{"content":"Points to the printer device context.","pos":[30450,30487]},{"content":"Points to a <bpt id=\"p1\">[</bpt>CPrintInfo<ept id=\"p1\">](../../mfc/reference/cprintinfo-structure.md)</ept> structure that describes the current print job.","pos":[30505,30622],"source":" Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job."},{"content":"Remarks","pos":[30632,30639]},{"content":"The default implementation of this function does nothing.","pos":[30643,30700]},{"content":"Override this function to free any GDI resources you allocated in the <bpt id=\"p1\">[</bpt>OnBeginPrinting<ept id=\"p1\">](#cview__onbeginprinting)</ept> member function.","pos":[30701,30830],"source":" Override this function to free any GDI resources you allocated in the [OnBeginPrinting](#cview__onbeginprinting) member function."},{"pos":[30881,30905],"content":"CView::OnEndPrintPreview"},{"content":"Called by the framework when the user exits print preview mode.","pos":[30909,30972]},{"content":"Parameters","pos":[31115,31125]},{"content":"Points to the printer device context.","pos":[31138,31175]},{"content":"Points to a <bpt id=\"p1\">[</bpt>CPrintInfo<ept id=\"p1\">](../../mfc/reference/cprintinfo-structure.md)</ept> structure that describes the current print job.","pos":[31193,31310],"source":" Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job."},{"content":"Specifies the point on the page that was last displayed in preview mode.","pos":[31328,31400]},{"content":"Points to the view object used for previewing.","pos":[31418,31464]},{"content":"Remarks","pos":[31474,31481]},{"content":"The default implementation of this function calls the <bpt id=\"p1\">[</bpt>OnEndPrinting<ept id=\"p1\">](#cview__onendprinting)</ept> member function and restores the main frame window to the state it was in before print preview began.","pos":[31485,31679],"source":"The default implementation of this function calls the [OnEndPrinting](#cview__onendprinting) member function and restores the main frame window to the state it was in before print preview began."},{"content":"Override this function to perform special processing when preview mode is terminated.","pos":[31680,31765]},{"content":"For example, if you want to maintain the user's position in the document when switching from preview mode to normal display mode, you can scroll to the position described by the <ph id=\"ph1\">`point`</ph> parameter and the <ph id=\"ph2\">`m_nCurPage`</ph> member of the <ph id=\"ph3\">`CPrintInfo`</ph> structure that the <ph id=\"ph4\">`pInfo`</ph> parameter points to.","pos":[31766,32057],"source":" For example, if you want to maintain the user's position in the document when switching from preview mode to normal display mode, you can scroll to the position described by the `point` parameter and the `m_nCurPage` member of the `CPrintInfo` structure that the `pInfo` parameter points to."},{"pos":[32064,32179],"content":"Always call the base class version of <ph id=\"ph1\">`OnEndPrintPreview`</ph> from your override, typically at the end of the function.","source":"Always call the base class version of `OnEndPrintPreview` from your override, typically at the end of the function."},{"pos":[32228,32250],"content":"CView::OnInitialUpdate"},{"content":"Called by the framework after the view is first attached to the document, but before the view is initially displayed.","pos":[32254,32371]},{"content":"Remarks","pos":[32428,32435]},{"content":"The default implementation of this function calls the <bpt id=\"p1\">[</bpt>OnUpdate<ept id=\"p1\">](#cview__onupdate)</ept> member function with no hint information (that is, using the default values of 0 for the <ph id=\"ph1\">`lHint`</ph> parameter and <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> for the <ph id=\"ph2\">`pHint`</ph> parameter).","pos":[32439,32669],"source":"The default implementation of this function calls the [OnUpdate](#cview__onupdate) member function with no hint information (that is, using the default values of 0 for the `lHint` parameter and **NULL** for the `pHint` parameter)."},{"content":"Override this function to perform any one-time initialization that requires information about the document.","pos":[32670,32777]},{"content":"For example, if your application has fixed-sized documents, you can use this function to initialize a view's scrolling limits based on the document size.","pos":[32778,32931]},{"content":"If your application supports variable-sized documents, use <bpt id=\"p1\">[</bpt>OnUpdate<ept id=\"p1\">](#cview__onupdate)</ept> to update the scrolling limits every time the document changes.","pos":[32932,33083],"source":" If your application supports variable-sized documents, use [OnUpdate](#cview__onupdate) to update the scrolling limits every time the document changes."},{"pos":[33128,33146],"content":"CView::OnPrepareDC"},{"pos":[33150,33370],"content":"Called by the framework before the <bpt id=\"p1\">[</bpt>OnDraw<ept id=\"p1\">](#cview__ondraw)</ept> member function is called for screen display and before the <bpt id=\"p2\">[</bpt>OnPrint<ept id=\"p2\">](#cview__onprint)</ept> member function is called for each page during printing or print preview.","source":"Called by the framework before the [OnDraw](#cview__ondraw) member function is called for screen display and before the [OnPrint](#cview__onprint) member function is called for each page during printing or print preview."},{"content":"Parameters","pos":[33468,33478]},{"content":"Points to the device context to be used for rendering an image of the document.","pos":[33491,33570]},{"content":"Points to a <bpt id=\"p1\">[</bpt>CPrintInfo<ept id=\"p1\">](../../mfc/reference/cprintinfo-structure.md)</ept> structure that describes the current print job if <ph id=\"ph1\">`OnPrepareDC`</ph> is being called for printing or print preview; the <ph id=\"ph2\">`m_nCurPage`</ph> member specifies the page about to be printed.","pos":[33588,33832],"source":" Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job if `OnPrepareDC` is being called for printing or print preview; the `m_nCurPage` member specifies the page about to be printed."},{"content":"This parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if <ph id=\"ph1\">`OnPrepareDC`</ph> is being called for screen display.","pos":[33833,33912],"source":" This parameter is **NULL** if `OnPrepareDC` is being called for screen display."},{"content":"Remarks","pos":[33922,33929]},{"content":"The default implementation of this function does nothing if the function is called for screen display.","pos":[33933,34035]},{"content":"However, this function is overridden in derived classes, such as <bpt id=\"p1\">[</bpt>CScrollView<ept id=\"p1\">](../../mfc/reference/cscrollview-class.md)</ept>, to adjust attributes of the device context; consequently, you should always call the base class implementation at the beginning of your override.","pos":[34036,34303],"source":" However, this function is overridden in derived classes, such as [CScrollView](../../mfc/reference/cscrollview-class.md), to adjust attributes of the device context; consequently, you should always call the base class implementation at the beginning of your override."},{"content":"If the function is called for printing, the default implementation examines the page information stored in the <ph id=\"ph1\">`pInfo`</ph> parameter.","pos":[34310,34439],"source":"If the function is called for printing, the default implementation examines the page information stored in the `pInfo` parameter."},{"content":"If the length of the document has not been specified, <ph id=\"ph1\">`OnPrepareDC`</ph> assumes the document to be one page long and stops the print loop after one page has been printed.","pos":[34440,34606],"source":" If the length of the document has not been specified, `OnPrepareDC` assumes the document to be one page long and stops the print loop after one page has been printed."},{"content":"The function stops the print loop by setting the <ph id=\"ph1\">`m_bContinuePrinting`</ph> member of the structure to <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[34607,34715],"source":" The function stops the print loop by setting the `m_bContinuePrinting` member of the structure to **FALSE**."},{"pos":[34722,34778],"content":"Override <ph id=\"ph1\">`OnPrepareDC`</ph> for any of the following reasons:","source":"Override `OnPrepareDC` for any of the following reasons:"},{"content":"To adjust attributes of the device context as needed for the specified page.","pos":[34788,34864]},{"content":"For example, if you need to set the mapping mode or other characteristics of the device context, do so in this function.","pos":[34865,34985]},{"content":"To perform print-time pagination.","pos":[34995,35028]},{"content":"Normally you specify the length of the document when printing begins, using the <bpt id=\"p1\">[</bpt>OnPreparePrinting<ept id=\"p1\">](#cview__onprepareprinting)</ept> member function.","pos":[35029,35172],"source":" Normally you specify the length of the document when printing begins, using the [OnPreparePrinting](#cview__onprepareprinting) member function."},{"content":"However, if you don't know in advance how long the document is (for example, when printing an undetermined number of records from a database), override <ph id=\"ph1\">`OnPrepareDC`</ph> to test for the end of the document while it is being printed.","pos":[35173,35401],"source":" However, if you don't know in advance how long the document is (for example, when printing an undetermined number of records from a database), override `OnPrepareDC` to test for the end of the document while it is being printed."},{"content":"When there is no more of the document to be printed, set the <ph id=\"ph1\">`m_bContinuePrinting`</ph> member of the <ph id=\"ph2\">`CPrintInfo`</ph> structure to <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[35402,35535],"source":" When there is no more of the document to be printed, set the `m_bContinuePrinting` member of the `CPrintInfo` structure to **FALSE**."},{"content":"To send escape codes to the printer on a page-by-page basis.","pos":[35545,35605]},{"content":"To send escape codes from <ph id=\"ph1\">`OnPrepareDC`</ph>, call the <bpt id=\"p1\">**</bpt>Escape<ept id=\"p1\">**</ept> member function of the <ph id=\"ph2\">`pDC`</ph> parameter.","pos":[35606,35706],"source":" To send escape codes from `OnPrepareDC`, call the **Escape** member function of the `pDC` parameter."},{"pos":[35713,35792],"content":"Call the base class version of <ph id=\"ph1\">`OnPrepareDC`</ph> at the beginning of your override.","source":"Call the base class version of `OnPrepareDC` at the beginning of your override."},{"content":"Example","pos":[35802,35809]},{"pos":[35824,35842],"content":"NVC_MFCDocView#183"},{"pos":[35940,35964],"content":"CView::OnPreparePrinting"},{"content":"Called by the framework before a document is printed or previewed.","pos":[35968,36034]},{"content":"Parameters","pos":[36110,36120]},{"content":"Points to a <bpt id=\"p1\">[</bpt>CPrintInfo<ept id=\"p1\">](../../mfc/reference/cprintinfo-structure.md)</ept> structure that describes the current print job.","pos":[36135,36252],"source":" Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job."},{"content":"Return Value","pos":[36262,36274]},{"content":"Nonzero to begin printing; 0 if the print job has been canceled.","pos":[36278,36342]},{"content":"Remarks","pos":[36352,36359]},{"content":"The default implementation does nothing.","pos":[36363,36403]},{"content":"You must override this function to enable printing and print preview.","pos":[36410,36479]},{"content":"Call the <bpt id=\"p1\">[</bpt>DoPreparePrinting<ept id=\"p1\">](#cview__doprepareprinting)</ept> member function, passing it the <ph id=\"ph1\">`pInfo`</ph> parameter, and then return its return value; <ph id=\"ph2\">`DoPreparePrinting`</ph> displays the Print dialog box and creates a printer device context.","pos":[36480,36708],"source":" Call the [DoPreparePrinting](#cview__doprepareprinting) member function, passing it the `pInfo` parameter, and then return its return value; `DoPreparePrinting` displays the Print dialog box and creates a printer device context."},{"content":"If you want to initialize the Print dialog box with values other than the defaults, assign values to the members of <ph id=\"ph1\">`pInfo`</ph>.","pos":[36709,36833],"source":" If you want to initialize the Print dialog box with values other than the defaults, assign values to the members of `pInfo`."},{"content":"For example, if you know the length of the document, pass the value to the <bpt id=\"p1\">[</bpt>SetMaxPage<ept id=\"p1\">](../../mfc/reference/cprintinfo-structure.md#cprintinfo__setmaxpage)</ept> member function of <ph id=\"ph1\">`pInfo`</ph> before calling <ph id=\"ph2\">`DoPreparePrinting`</ph>.","pos":[36834,37052],"source":" For example, if you know the length of the document, pass the value to the [SetMaxPage](../../mfc/reference/cprintinfo-structure.md#cprintinfo__setmaxpage) member function of `pInfo` before calling `DoPreparePrinting`."},{"content":"This value is displayed in the To: box in the Range portion of the Print dialog box.","pos":[37053,37137]},{"content":"does not display the Print dialog box for a preview job.","pos":[37164,37220]},{"content":"If you want to bypass the Print dialog box for a print job, check that the <bpt id=\"p1\">**</bpt>m_bPreview<ept id=\"p1\">**</ept> member of <ph id=\"ph1\">`pInfo`</ph> is <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> and then set it to <bpt id=\"p3\">**</bpt>TRUE<ept id=\"p3\">**</ept> before passing it to <ph id=\"ph2\">`DoPreparePrinting`</ph>; reset it to <bpt id=\"p4\">**</bpt>FALSE<ept id=\"p4\">**</ept> afterwards.","pos":[37221,37445],"source":" If you want to bypass the Print dialog box for a print job, check that the **m_bPreview** member of `pInfo` is **FALSE** and then set it to **TRUE** before passing it to `DoPreparePrinting`; reset it to **FALSE** afterwards."},{"pos":[37452,37713],"content":"If you need to perform initializations that require access to the <ph id=\"ph1\">`CDC`</ph> object representing the printer device context (for example, if you need to know the page size before specifying the length of the document), override the <ph id=\"ph2\">`OnBeginPrinting`</ph> member function.","source":"If you need to perform initializations that require access to the `CDC` object representing the printer device context (for example, if you need to know the page size before specifying the length of the document), override the `OnBeginPrinting` member function."},{"content":"If you want to set the value of the <bpt id=\"p1\">**</bpt>m_nNumPreviewPages<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>m_strPageDesc<ept id=\"p2\">**</ept> members of the <ph id=\"ph1\">`pInfo`</ph> parameter, do so after calling <ph id=\"ph2\">`DoPreparePrinting`</ph>.","pos":[37720,37874],"source":"If you want to set the value of the **m_nNumPreviewPages** or **m_strPageDesc** members of the `pInfo` parameter, do so after calling `DoPreparePrinting`."},{"content":"The <ph id=\"ph1\">`DoPreparePrinting`</ph> member function sets <bpt id=\"p1\">**</bpt>m_nNumPreviewPages<ept id=\"p1\">**</ept> to the value found in the application's .INI file and sets <bpt id=\"p2\">**</bpt>m_strPageDesc<ept id=\"p2\">**</ept> to its default value.","pos":[37875,38041],"source":" The `DoPreparePrinting` member function sets **m_nNumPreviewPages** to the value found in the application's .INI file and sets **m_strPageDesc** to its default value."},{"content":"Example","pos":[38051,38058]},{"pos":[38063,38225],"content":"Override <ph id=\"ph1\">`OnPreparePrinting`</ph> and call <ph id=\"ph2\">`DoPreparePrinting`</ph> from the override so that the framework will display a Print dialog box and create a printer DC for you.","source":"Override `OnPreparePrinting` and call `DoPreparePrinting` from the override so that the framework will display a Print dialog box and create a printer DC for you."},{"pos":[38243,38261],"content":"NVC_MFCDocView#184"},{"content":"If you know how many pages the document contains, set the maximum page in <ph id=\"ph1\">`OnPreparePrinting`</ph> before calling <ph id=\"ph2\">`DoPreparePrinting`</ph>.","pos":[38315,38444],"source":"If you know how many pages the document contains, set the maximum page in `OnPreparePrinting` before calling `DoPreparePrinting`."},{"content":"The framework will display the maximum page number in the \"to\" box of the Print dialog box.","pos":[38445,38536]},{"pos":[38554,38572],"content":"NVC_MFCDocView#185"},{"pos":[38660,38674],"content":"CView::OnPrint"},{"content":"Called by the framework to print or preview a page of the document.","pos":[38678,38745]},{"content":"Parameters","pos":[38832,38842]},{"content":"Points to the printer device context.","pos":[38855,38892]},{"content":"Points to a <ph id=\"ph1\">`CPrintInfo`</ph> structure that describes the current print job.","pos":[38910,38982],"source":" Points to a `CPrintInfo` structure that describes the current print job."},{"content":"Remarks","pos":[38992,38999]},{"content":"For each page being printed, the framework calls this function immediately after calling the <bpt id=\"p1\">[</bpt>OnPrepareDC<ept id=\"p1\">](#cview__onpreparedc)</ept> member function.","pos":[39003,39147],"source":"For each page being printed, the framework calls this function immediately after calling the [OnPrepareDC](#cview__onpreparedc) member function."},{"content":"The page being printed is specified by the <ph id=\"ph1\">`m_nCurPage`</ph> member of the <bpt id=\"p1\">[</bpt>CPrintInfo<ept id=\"p1\">](../../mfc/reference/cprintinfo-structure.md)</ept> structure that <ph id=\"ph2\">`pInfo`</ph> points to.","pos":[39148,39309],"source":" The page being printed is specified by the `m_nCurPage` member of the [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that `pInfo` points to."},{"content":"The default implementation calls the <bpt id=\"p1\">[</bpt>OnDraw<ept id=\"p1\">](#cview__ondraw)</ept> member function and passes it the printer device context.","pos":[39310,39429],"source":" The default implementation calls the [OnDraw](#cview__ondraw) member function and passes it the printer device context."},{"content":"Override this function for any of the following reasons:","pos":[39436,39492]},{"content":"To allow printing of multipage documents.","pos":[39502,39543]},{"content":"Render only the portion of the document that corresponds to the page currently being printed.","pos":[39544,39637]},{"content":"If you're using <ph id=\"ph1\">`OnDraw`</ph> to perform the rendering, you can adjust the viewport origin so that only the appropriate portion of the document is printed.","pos":[39638,39788],"source":" If you're using `OnDraw` to perform the rendering, you can adjust the viewport origin so that only the appropriate portion of the document is printed."},{"content":"To make the printed image look different from the screen image (that is, if your application is not WYSIWYG).","pos":[39798,39907]},{"content":"Instead of passing the printer device context to <ph id=\"ph1\">`OnDraw`</ph>, use the device context to render an image using attributes not shown on the screen.","pos":[39908,40050],"source":" Instead of passing the printer device context to `OnDraw`, use the device context to render an image using attributes not shown on the screen."},{"content":"If you need GDI resources for printing that you don't use for screen display, select them into the device context before drawing and deselect them afterwards.","pos":[40061,40219]},{"content":"These GDI resources should be allocated in <bpt id=\"p1\">[</bpt>OnBeginPrinting<ept id=\"p1\">](#cview__onbeginprinting)</ept> and released in <bpt id=\"p2\">[</bpt>OnEndPrinting<ept id=\"p2\">](#cview__onendprinting)</ept>.","pos":[40220,40361],"source":" These GDI resources should be allocated in [OnBeginPrinting](#cview__onbeginprinting) and released in [OnEndPrinting](#cview__onendprinting)."},{"content":"To implement headers or footers.","pos":[40371,40403]},{"content":"You can still use <ph id=\"ph1\">`OnDraw`</ph> to do the rendering by restricting the area that it can print on.","pos":[40404,40496],"source":" You can still use `OnDraw` to do the rendering by restricting the area that it can print on."},{"pos":[40503,40622],"content":"Note that the <bpt id=\"p1\">**</bpt>m_rectDraw<ept id=\"p1\">**</ept> member of the <ph id=\"ph1\">`pInfo`</ph> parameter describes the printable area of the page in logical units.","source":"Note that the **m_rectDraw** member of the `pInfo` parameter describes the printable area of the page in logical units."},{"pos":[40629,40759],"content":"Do not call <ph id=\"ph1\">`OnPrepareDC`</ph> in your override of <ph id=\"ph2\">`OnPrint`</ph>; the framework calls <ph id=\"ph3\">`OnPrepareDC`</ph> automatically before calling <ph id=\"ph4\">`OnPrint`</ph>.","source":"Do not call `OnPrepareDC` in your override of `OnPrint`; the framework calls `OnPrepareDC` automatically before calling `OnPrint`."},{"content":"Example","pos":[40769,40776]},{"pos":[40780,40845],"content":"The following is a skeleton for an overridden <ph id=\"ph1\">`OnPrint`</ph> function:","source":"The following is a skeleton for an overridden `OnPrint` function:"},{"pos":[40863,40881],"content":"NVC_MFCDocView#186"},{"pos":[40935,41068],"content":"For another example, see <bpt id=\"p1\">[</bpt>CRichEditView::PrintInsideRect<ept id=\"p1\">](../../mfc/reference/cricheditview-class.md#cricheditview__printinsiderect)</ept>.","source":"For another example, see [CRichEditView::PrintInsideRect](../../mfc/reference/cricheditview-class.md#cricheditview__printinsiderect)."},{"pos":[41110,41125],"content":"CView::OnScroll"},{"content":"Called by the framework to determine whether scrolling is possible.","pos":[41129,41196]},{"content":"Parameters","pos":[41313,41323]},{"content":"A scroll-bar code that indicates the user's scrolling request.","pos":[41344,41406]},{"content":"This parameter is composed of two parts: a low-order byte, which determines the type of scrolling occurring horizontally, and a high-order byte, which determines the type of scrolling occurring vertically:","pos":[41407,41612]},{"pos":[41620,41652],"content":"<bpt id=\"p1\">**</bpt>SB_BOTTOM<ept id=\"p1\">**</ept> Scrolls to bottom.","source":"**SB_BOTTOM** Scrolls to bottom."},{"pos":[41660,41698],"content":"<bpt id=\"p1\">**</bpt>SB_LINEDOWN<ept id=\"p1\">**</ept> Scrolls one line down.","source":"**SB_LINEDOWN** Scrolls one line down."},{"pos":[41706,41740],"content":"<bpt id=\"p1\">**</bpt>SB_LINEUP<ept id=\"p1\">**</ept> Scrolls one line up.","source":"**SB_LINEUP** Scrolls one line up."},{"pos":[41748,41786],"content":"<bpt id=\"p1\">**</bpt>SB_PAGEDOWN<ept id=\"p1\">**</ept> Scrolls one page down.","source":"**SB_PAGEDOWN** Scrolls one page down."},{"pos":[41794,41828],"content":"<bpt id=\"p1\">**</bpt>SB_PAGEUP<ept id=\"p1\">**</ept> Scrolls one page up.","source":"**SB_PAGEUP** Scrolls one page up."},{"content":"<bpt id=\"p1\">**</bpt>SB_THUMBTRACK<ept id=\"p1\">**</ept> Drags scroll box to specified position.","pos":[41836,41893],"source":"**SB_THUMBTRACK** Drags scroll box to specified position."},{"content":"The current position is specified in <ph id=\"ph1\">`nPos`</ph>.","pos":[41894,41938],"source":" The current position is specified in `nPos`."},{"pos":[41946,41972],"content":"<bpt id=\"p1\">**</bpt>SB_TOP<ept id=\"p1\">**</ept> Scrolls to top.","source":"**SB_TOP** Scrolls to top."},{"pos":[41979,42207],"content":"`nPos`  \nContains the current scroll-box position if the scroll-bar code is **SB_THUMBTRACK**; otherwise it is not used. Depending on the initial scroll range, `nPos` may be negative and should be cast to an `int` if necessary.","leadings":[""," "],"nodes":[{"content":"Contains the current scroll-box position if the scroll-bar code is **SB_THUMBTRACK**; otherwise it is not used. Depending on the initial scroll range, `nPos` may be negative and should be cast to an `int` if necessary.","pos":[9,227],"nodes":[{"content":"Contains the current scroll-box position if the scroll-bar code is <bpt id=\"p1\">**</bpt>SB_THUMBTRACK<ept id=\"p1\">**</ept>; otherwise it is not used.","pos":[0,111],"source":"Contains the current scroll-box position if the scroll-bar code is **SB_THUMBTRACK**; otherwise it is not used."},{"content":"Depending on the initial scroll range, <ph id=\"ph1\">`nPos`</ph> may be negative and should be cast to an <ph id=\"ph2\">`int`</ph> if necessary.","pos":[112,218],"source":" Depending on the initial scroll range, `nPos` may be negative and should be cast to an `int` if necessary."}]}]},{"pos":[42214,42396],"content":"`bDoScroll`  \nDetermines whether you should actually do the specified scrolling action. If **TRUE,** then scrolling should take place; if **FALSE**, then scrolling should not occur.","leadings":[""," "],"nodes":[{"content":"Determines whether you should actually do the specified scrolling action. If **TRUE,** then scrolling should take place; if **FALSE**, then scrolling should not occur.","pos":[14,181],"nodes":[{"content":"Determines whether you should actually do the specified scrolling action.","pos":[0,73]},{"content":"If <bpt id=\"p1\">**</bpt>TRUE,<ept id=\"p1\">**</ept> then scrolling should take place; if <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>, then scrolling should not occur.","pos":[74,167],"source":" If **TRUE,** then scrolling should take place; if **FALSE**, then scrolling should not occur."}]}]},{"content":"Return Value","pos":[42406,42418]},{"content":"If <ph id=\"ph1\">`bDoScroll`</ph> is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> and the view was actually scrolled, then return nonzero; otherwise 0.","pos":[42422,42518],"source":"If `bDoScroll` is **TRUE** and the view was actually scrolled, then return nonzero; otherwise 0."},{"content":"If <ph id=\"ph1\">`bDoScroll`</ph> is <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, then return the value that you would have returned if <ph id=\"ph2\">`bDoScroll`</ph> were <bpt id=\"p2\">**</bpt>TRUE<ept id=\"p2\">**</ept>, even though you don't actually do the scrolling.","pos":[42519,42677],"source":" If `bDoScroll` is **FALSE**, then return the value that you would have returned if `bDoScroll` were **TRUE**, even though you don't actually do the scrolling."},{"content":"Remarks","pos":[42687,42694]},{"content":"In one case this function is called by the framework with <ph id=\"ph1\">`bDoScroll`</ph> set to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> when the view receives a scrollbar message.","pos":[42698,42827],"source":"In one case this function is called by the framework with `bDoScroll` set to **TRUE** when the view receives a scrollbar message."},{"content":"In this case, you should actually scroll the view.","pos":[42828,42878]},{"content":"In the other case this function is called with <ph id=\"ph1\">`bDoScroll`</ph> set to <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> when an OLE item is initially dragged into the auto-scrolling region of a drop target before scrolling actually takes place.","pos":[42879,43079],"source":" In the other case this function is called with `bDoScroll` set to **FALSE** when an OLE item is initially dragged into the auto-scrolling region of a drop target before scrolling actually takes place."},{"content":"In this case, you should not actually scroll the view.","pos":[43080,43134]},{"pos":[43178,43195],"content":"CView::OnScrollBy"},{"content":"Called by the framework when the user views an area beyond the present view of the document, either by dragging an OLE item against the view's current borders or by manipulating the vertical or horizontal scrollbars.","pos":[43199,43415]},{"content":"Parameters","pos":[43517,43527]},{"content":"Number of pixels scrolled horizontally and vertically.","pos":[43547,43601]},{"content":"Determines whether scrolling of the view occurs.","pos":[43623,43671]},{"content":"If <bpt id=\"p1\">**</bpt>TRUE,<ept id=\"p1\">**</ept> then scrolling takes place; if <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>, then scrolling does not occur.","pos":[43672,43757],"source":" If **TRUE,** then scrolling takes place; if **FALSE**, then scrolling does not occur."},{"content":"Return Value","pos":[43767,43779]},{"content":"Nonzero if the view was able to be scrolled; otherwise 0.","pos":[43783,43840]},{"content":"Remarks","pos":[43850,43857]},{"content":"In derived classes this method checks to see whether the view is scrollable in the direction the user requested and then updates the new region if necessary.","pos":[43861,44018]},{"content":"This function is automatically called by <bpt id=\"p1\">[</bpt>CWnd::OnHScroll<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__onhscroll)</ept> and <bpt id=\"p2\">[</bpt>CWnd::OnVScroll<ept id=\"p2\">](../../mfc/reference/cwnd-class.md#cwnd__onvscroll)</ept> to perform the actual scrolling request.","pos":[44019,44242],"source":" This function is automatically called by [CWnd::OnHScroll](../../mfc/reference/cwnd-class.md#cwnd__onhscroll) and [CWnd::OnVScroll](../../mfc/reference/cwnd-class.md#cwnd__onvscroll) to perform the actual scrolling request."},{"pos":[44249,44400],"content":"The default implementation of this method does not change the view, but if it is not called, the view will not scroll in a <ph id=\"ph1\">`CScrollView`</ph>-derived class.","source":"The default implementation of this method does not change the view, but if it is not called, the view will not scroll in a `CScrollView`-derived class."},{"pos":[44407,44561],"content":"If the document width or height exceeds 32767 pixels, scrolling past 32767 will fail because <ph id=\"ph1\">`OnScrollBy`</ph> is called with an invalid <ph id=\"ph2\">`sizeScroll`</ph> argument.","source":"If the document width or height exceeds 32767 pixels, scrolling past 32767 will fail because `OnScrollBy` is called with an invalid `sizeScroll` argument."},{"pos":[44603,44618],"content":"CView::OnUpdate"},{"pos":[44622,44885],"content":"Called by the framework after the view's document has been modified; this function is called by <bpt id=\"p1\">[</bpt>CDocument::UpdateAllViews<ept id=\"p1\">](../../mfc/reference/cdocument-class.md#cdocument__updateallviews)</ept> and allows the view to update its display to reflect those modifications.","source":"Called by the framework after the view's document has been modified; this function is called by [CDocument::UpdateAllViews](../../mfc/reference/cdocument-class.md#cdocument__updateallviews) and allows the view to update its display to reflect those modifications."},{"content":"Parameters","pos":[44996,45006]},{"content":"Points to the view that modified the document, or <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if all views are to be updated.","pos":[45023,45113],"source":" Points to the view that modified the document, or **NULL** if all views are to be updated."},{"content":"Contains information about the modifications.","pos":[45131,45176]},{"content":"Points to an object storing information about the modifications.","pos":[45194,45258]},{"content":"Remarks","pos":[45268,45275]},{"content":"It is also called by the default implementation of <bpt id=\"p1\">[</bpt>OnInitialUpdate<ept id=\"p1\">](#cview__oninitialupdate)</ept>.","pos":[45279,45373],"source":"It is also called by the default implementation of [OnInitialUpdate](#cview__oninitialupdate)."},{"content":"The default implementation invalidates the entire client area, marking it for painting when the next <ph id=\"ph1\">`WM_PAINT`</ph> message is received.","pos":[45374,45506],"source":" The default implementation invalidates the entire client area, marking it for painting when the next `WM_PAINT` message is received."},{"content":"Override this function if you want to update only those regions that map to the modified portions of the document.","pos":[45507,45621]},{"content":"To do this you must pass information about the modifications using the hint parameters.","pos":[45622,45709]},{"content":"To use <ph id=\"ph1\">`lHint`</ph>, define special hint values, typically a bitmask or an enumerated type, and have the document pass one of these values.","pos":[45716,45850],"source":"To use `lHint`, define special hint values, typically a bitmask or an enumerated type, and have the document pass one of these values."},{"content":"To use <ph id=\"ph1\">`pHint`</ph>, derive a hint class from <bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept> and have the document pass a pointer to a hint object; when overriding <ph id=\"ph2\">`OnUpdate`</ph>, use the <bpt id=\"p2\">[</bpt>CObject::IsKindOf<ept id=\"p2\">](../../mfc/reference/cobject-class.md#cobject__iskindof)</ept> member function to determine the run-time type of the hint object.","pos":[45851,46173],"source":" To use `pHint`, derive a hint class from [CObject](../../mfc/reference/cobject-class.md) and have the document pass a pointer to a hint object; when overriding `OnUpdate`, use the [CObject::IsKindOf](../../mfc/reference/cobject-class.md#cobject__iskindof) member function to determine the run-time type of the hint object."},{"content":"Typically you should not perform any drawing directly from <ph id=\"ph1\">`OnUpdate`</ph>.","pos":[46180,46250],"source":"Typically you should not perform any drawing directly from `OnUpdate`."},{"content":"Instead, determine the rectangle describing, in device coordinates, the area that requires updating; pass this rectangle to <bpt id=\"p1\">[</bpt>CWnd::InvalidateRect<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__invalidaterect)</ept>.","pos":[46251,46454],"source":" Instead, determine the rectangle describing, in device coordinates, the area that requires updating; pass this rectangle to [CWnd::InvalidateRect](../../mfc/reference/cwnd-class.md#cwnd__invalidaterect)."},{"content":"This causes painting to occur the next time a <bpt id=\"p1\">[</bpt>WM_PAINT<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd145213)</ept> message is received.","pos":[46455,46592],"source":" This causes painting to occur the next time a [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) message is received."},{"content":"If <ph id=\"ph1\">`lHint`</ph> is 0 and <ph id=\"ph2\">`pHint`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the document has sent a generic update notification.","pos":[46599,46692],"source":"If `lHint` is 0 and `pHint` is **NULL**, the document has sent a generic update notification."},{"content":"If a view receives a generic update notification, or if it cannot decode the hints, it should invalidate its entire client area.","pos":[46693,46821]},{"content":"See Also","pos":[46830,46838]},{"content":"MFC Sample MDIDOCVW","pos":[46843,46862]},{"content":"CWnd Class","pos":[46898,46908]},{"content":"Hierarchy Chart","pos":[46950,46965]},{"content":"CWnd Class","pos":[47002,47012]},{"content":"CFrameWnd Class","pos":[47054,47069]},{"content":"CSplitterWnd Class","pos":[47116,47134]},{"content":"CDC Class","pos":[47184,47193]},{"content":"CDocTemplate Class","pos":[47234,47252]},{"content":"CDocument Class","pos":[47302,47317]}],"content":"---\ntitle: \"CView Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CView\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"views [C++], view classes\"\n  - \"multiple views\"\n  - \"CView class\"\n  - \"document/view architecture\"\n  - \"input, and view class\"\n  - \"MDI [C++], view windows\"\n  - \"print preview, view windows\"\n  - \"windows [C++], views\"\n  - \"child windows, views\"\n  - \"frame windows [C++], views\"\n  - \"user input [C++], interpreting through view class\"\nms.assetid: 9cff3c56-7564-416b-b9a4-71a9254ed755\ncaps.latest.revision: 25\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CView Class\nProvides the basic functionality for user-defined view classes.  \n  \n## Syntax  \n  \n```  \nclass AFX_NOVTABLE CView : public CWnd  \n```  \n  \n## Members  \n  \n### Protected Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CView::CView](#cview__cview)|Constructs a `CView` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CView::DoPreparePrinting](#cview__doprepareprinting)|Displays Print dialog box and creates printer device context; call when overriding the `OnPreparePrinting` member function.|  \n|[CView::GetDocument](#cview__getdocument)|Returns the document associated with the view.|  \n|[CView::IsSelected](#cview__isselected)|Tests whether a document item is selected. Required for OLE support.|  \n|[CView::OnDragEnter](#cview__ondragenter)|Called when an item is first dragged into the drag-and-drop region of a view.|  \n|[CView::OnDragLeave](#cview__ondragleave)|Called when a dragged item leaves the drag-and-drop region of a view.|  \n|[CView::OnDragOver](#cview__ondragover)|Called when an item is dragged over the drag-and-drop region of a view.|  \n|[CView::OnDragScroll](#cview__ondragscroll)|Called to determine whether the cursor is dragged into the scroll region of the window.|  \n|[CView::OnDrop](#cview__ondrop)|Called when an item has been dropped into the drag-and-drop region of a view, default handler.|  \n|[CView::OnDropEx](#cview__ondropex)|Called when an item has been dropped into the drag-and-drop region of a view, primary handler.|  \n|[CView::OnInitialUpdate](#cview__oninitialupdate)|Called after a view is first attached to a document.|  \n|[CView::OnPrepareDC](#cview__onpreparedc)|Called before the `OnDraw` member function is called for screen display or the `OnPrint` member function is called for printing or print preview.|  \n|[CView::OnScroll](#cview__onscroll)|Called when OLE items are dragged beyond the borders of the view.|  \n|[CView::OnScrollBy](#cview__onscrollby)|Called when a view containing active in-place OLE items is scrolled.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CView::OnActivateFrame](#cview__onactivateframe)|Called when the frame window containing the view is activated or deactivated.|  \n|[CView::OnActivateView](#cview__onactivateview)|Called when a view is activated.|  \n|[CView::OnBeginPrinting](#cview__onbeginprinting)|Called when a print job begins; override to allocate graphics device interface (GDI) resources.|  \n|[CView::OnDraw](#cview__ondraw)|Called to render an image of the document for screen display, printing, or print preview. Implementation required.|  \n|[CView::OnEndPrinting](#cview__onendprinting)|Called when a print job ends; override to deallocate GDI resources.|  \n|[CView::OnEndPrintPreview](#cview__onendprintpreview)|Called when preview mode is exited.|  \n|[CView::OnPreparePrinting](#cview__onprepareprinting)|Called before a document is printed or previewed; override to initialize Print dialog box.|  \n|[CView::OnPrint](#cview__onprint)|Called to print or preview a page of the document.|  \n|[CView::OnUpdate](#cview__onupdate)|Called to notify a view that its document has been modified.|  \n  \n## Remarks  \n A view is attached to a document and acts as an intermediary between the document and the user: the view renders an image of the document on the screen or printer and interprets user input as operations upon the document.  \n  \n A view is a child of a frame window. More than one view can share a frame window, as in the case of a splitter window. The relationship between a view class, a frame window class, and a document class is established by a `CDocTemplate` object. When the user opens a new window or splits an existing one, the framework constructs a new view and attaches it to the document.  \n  \n A view can be attached to only one document, but a document can have multiple views attached to it at once â€” for example, if the document is displayed in a splitter window or in multiple child windows in a multiple document interface (MDI) application. Your application can support different types of views for a given document type; for example, a word-processing program might provide both a complete text view of a document and an outline view that shows only the section headings. These different types of views can be placed in separate frame windows or in separate panes of a single frame window if you use a splitter window.  \n  \n A view may be responsible for handling several different types of input, such as keyboard input, mouse input or input via drag-and-drop, as well as commands from menus, toolbars, or scroll bars. A view receives commands forwarded by its frame window. If the view does not handle a given command, it forwards the command to its associated document. Like all command targets, a view handles messages via a message map.  \n  \n The view is responsible for displaying and modifying the document's data but not for storing it. The document provides the view with the necessary details about its data. You can let the view access the document's data members directly, or you can provide member functions in the document class for the view class to call.  \n  \n When a document's data changes, the view responsible for the changes typically calls the [CDocument::UpdateAllViews](../../mfc/reference/cdocument-class.md#cdocument__updateallviews) function for the document, which notifies all the other views by calling the `OnUpdate` member function for each. The default implementation of `OnUpdate` invalidates the view's entire client area. You can override it to invalidate only those regions of the client area that map to the modified portions of the document.  \n  \n To use `CView`, derive a class from it and implement the `OnDraw` member function to perform screen display. You can also use `OnDraw` to perform printing and print preview. The framework handles the print loop for printing and previewing your document.  \n  \n A view handles scroll-bar messages with the [CWnd::OnHScroll](../../mfc/reference/cwnd-class.md#cwnd__onhscroll) and [CWnd::OnVScroll](../../mfc/reference/cwnd-class.md#cwnd__onvscroll) member functions. You can implement scroll-bar message handling in these functions, or you can use the `CView` derived class [CScrollView](../../mfc/reference/cscrollview-class.md) to handle scrolling for you.  \n  \n Besides `CScrollView`, the Microsoft Foundation Class Library provides nine other classes derived from `CView`:  \n  \n- [CCtrlView](../../mfc/reference/cctrlview-class.md), a view that allows usage of document - view architecture with tree, list, and rich edit controls.  \n  \n- [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md), a view that displays database records in dialog-box controls.  \n  \n- [CEditView](../../mfc/reference/ceditview-class.md), a view that provides a simple multiline text editor. You can use a `CEditView` object as a control in a dialog box as well as a view on a document.  \n  \n- [CFormView](../../mfc/reference/cformview-class.md), a scrollable view that contains dialog-box controls and is based on a dialog template resource.  \n  \n- [CListView](../../mfc/reference/clistview-class.md), a view that allows usage of document - view architecture with list controls.  \n  \n- [CRecordView](../../mfc/reference/crecordview-class.md), a view that displays database records in dialog-box controls.  \n  \n- [CRichEditView](../../mfc/reference/cricheditview-class.md), a view that allows usage of document - view architecture with rich edit controls.  \n  \n- [CScrollView](../../mfc/reference/cscrollview-class.md), a view that automatically provides scrolling support.  \n  \n- [CTreeView](../../mfc/reference/ctreeview-class.md), a view that allows usage of document - view architecture with tree controls.  \n  \n The `CView` class also has a derived implementation class named **CPreviewView**, which is used by the framework to perform print previewing. This class provides support for the features unique to the print-preview window, such as a toolbar, single- or double-page preview, and zooming, that is, enlarging the previewed image. You don't need to call or override any of **CPreviewView**'s member functions unless you want to implement your own interface for print preview (for example, if you want to support editing in print preview mode). For more information on using `CView`, see [Document/View Architecture](../../mfc/document-view-architecture.md) and [Printing](../../mfc/printing.md). In addition, see [Technical Note 30](../../mfc/tn030-customizing-printing-and-print-preview.md) for more details on customizing print preview.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n `CView`  \n  \n## Requirements  \n **Header:** afxwin.h  \n  \n##  <a name=\"cview__cview\"></a>  CView::CView  \n Constructs a `CView` object.  \n  \n```  \nCView();\n```  \n  \n### Remarks  \n The framework calls the constructor when a new frame window is created or a window is split. Override the [OnInitialUpdate](#cview__oninitialupdate) member function to initialize the view after the document is attached.  \n  \n##  <a name=\"cview__doprepareprinting\"></a>  CView::DoPreparePrinting  \n Call this function from your override of [OnPreparePrinting](#cview__onprepareprinting) to invoke the Print dialog box and create a printer device context.  \n  \n```  \nBOOL DoPreparePrinting(CPrintInfo* pInfo);\n```  \n  \n### Parameters  \n `pInfo`  \n Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job.  \n  \n### Return Value  \n Nonzero if printing or print preview can begin; 0 if the operation has been canceled.  \n  \n### Remarks  \n This function's behavior depends on whether it is being called for printing or print preview (specified by the **m_bPreview** member of the `pInfo` parameter). If a file is being printed, this function invokes the Print dialog box, using the values in the [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that `pInfo` points to; after the user has closed the dialog box, the function creates a printer device context based on settings the user specified in the dialog box and returns this device context through the `pInfo` parameter. This device context is used to print the document.  \n  \n If a file is being previewed, this function creates a printer device context using the current printer settings; this device context is used for simulating the printer during preview.  \n  \n##  <a name=\"cview__getdocument\"></a>  CView::GetDocument  \n Call this function to get a pointer to the view's document.  \n  \n```  \nCDocument* GetDocument() const;\n\n \n```  \n  \n### Return Value  \n A pointer to the [CDocument](../../mfc/reference/cdocument-class.md) object associated with the view. **NULL** if the view is not attached to a document.  \n  \n### Remarks  \n This allows you to call the document's member functions.  \n  \n##  <a name=\"cview__isselected\"></a>  CView::IsSelected  \n Called by the framework to check whether the specified document item is selected.  \n  \n```  \nvirtual BOOL IsSelected(const CObject* pDocItem) const;\n\n \n```  \n  \n### Parameters  \n `pDocItem`  \n Points to the document item being tested.  \n  \n### Return Value  \n Nonzero if the specified document item is selected; otherwise 0.  \n  \n### Remarks  \n The default implementation of this function returns **FALSE**. Override this function if you are implementing selection using [CDocItem](../../mfc/reference/cdocitem-class.md) objects. You must override this function if your view contains OLE items.  \n  \n##  <a name=\"cview__onactivateframe\"></a>  CView::OnActivateFrame  \n Called by the framework when the frame window containing the view is activated or deactivated.  \n  \n```  \nvirtual void OnActivateFrame(\n    UINT nState,  \n    CFrameWnd* pFrameWnd);\n```  \n  \n### Parameters  \n `nState`  \n Specifies whether the frame window is being activated or deactivated. It can be one of the following values:  \n  \n- **WA_INACTIVE** The frame window is being deactivated.  \n  \n- **WA_ACTIVE** The frame window is being activated through some method other than a mouse click (for example, by use of the keyboard interface to select the window).  \n  \n- **WA_CLICKACTIVE** The frame window is being activated by a mouse click  \n  \n `pFrameWnd`  \n Pointer to the frame window that is to be activated.  \n  \n### Remarks  \n Override this member function if you want to perform special processing when the frame window associated with the view is activated or deactivated. For example, [CFormView](../../mfc/reference/cformview-class.md) performs this override when it saves and restores the control that has focus.  \n  \n##  <a name=\"cview__onactivateview\"></a>  CView::OnActivateView  \n Called by the framework when a view is activated or deactivated.  \n  \n```  \nvirtual void OnActivateView(\n    BOOL bActivate,  \n    CView* pActivateView,  \n    CView* pDeactiveView);\n```  \n  \n### Parameters  \n `bActivate`  \n Indicates whether the view is being activated or deactivated.  \n  \n `pActivateView`  \n Points to the view object that is being activated.  \n  \n `pDeactiveView`  \n Points to the view object that is being deactivated.  \n  \n### Remarks  \n The default implementation of this function sets the focus to the view being activated. Override this function if you want to perform special processing when a view is activated or deactivated. For example, if you want to provide special visual cues that distinguish the active view from the inactive views, you would examine the `bActivate` parameter and update the view's appearance accordingly.  \n  \n The `pActivateView` and `pDeactiveView` parameters point to the same view if the application's main frame window is activated with no change in the active view â€” for example, if the focus is being transferred from another application to this one, rather than from one view to another within the application or when switching amongst MDI child windows. This allows a view to re-realize its palette, if needed.  \n  \n These parameters differ when [CFrameWnd::SetActiveView](../../mfc/reference/cframewnd-class.md#cframewnd__setactiveview) is called with a view that is different from what [CFrameWnd::GetActiveView](../../mfc/reference/cframewnd-class.md#cframewnd__getactiveview) would return. This happens most often with splitter windows.  \n  \n##  <a name=\"cview__onbeginprinting\"></a>  CView::OnBeginPrinting  \n Called by the framework at the beginning of a print or print preview job, after `OnPreparePrinting` has been called.  \n  \n```  \nvirtual void OnBeginPrinting(\n    CDC* pDC,  \n    CPrintInfo* pInfo);\n```  \n  \n### Parameters  \n `pDC`  \n Points to the printer device context.  \n  \n `pInfo`  \n Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job.  \n  \n### Remarks  \n The default implementation of this function does nothing. Override this function to allocate any GDI resources, such as pens or fonts, needed specifically for printing. Select the GDI objects into the device context from within the [OnPrint](#cview__onprint) member function for each page that uses them. If you are using the same view object to perform both screen display and printing, use separate variables for the GDI resources needed for each display; this allows you to update the screen during printing.  \n  \n You can also use this function to perform initializations that depend on properties of the printer device context. For example, the number of pages needed to print the document may depend on settings that the user specified from the Print dialog box (such as page length). In such a situation, you cannot specify the document length in the [OnPreparePrinting](#cview__onprepareprinting) member function, where you would normally do so; you must wait until the printer device context has been created based on the dialog box settings. [OnBeginPrinting](#cview__onbeginprinting) is the first overridable function that gives you access to the [CDC](../../mfc/reference/cdc-class.md) object representing the printer device context, so you can set the document length from this function. Note that if the document length is not specified by this time, a scroll bar is not displayed during print preview.  \n  \n##  <a name=\"cview__ondragenter\"></a>  CView::OnDragEnter  \n Called by the framework when the mouse first enters the non-scrolling region of the drop target window.  \n  \n```  \nvirtual DROPEFFECT OnDragEnter(\n    COleDataObject* pDataObject,  \n    DWORD dwKeyState,  \n    CPoint point);\n```  \n  \n### Parameters  \n `pDataObject`  \n Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) being dragged into the drop area of the view.  \n  \n `dwKeyState`  \n Contains the state of the modifier keys. This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**.  \n  \n `point`  \n The current mouse position relative to the client area of the view.  \n  \n### Return Value  \n A value from the `DROPEFFECT` enumerated type, which indicates the type of drop that would occur if the user dropped the object at this position. The type of drop usually depends on the current key state indicated by `dwKeyState`. A standard mapping of keystates to `DROPEFFECT` values is:  \n  \n- `DROPEFFECT_NONE` The data object cannot be dropped in this window.  \n  \n- `DROPEFFECT_LINK` for **MK_CONTROL &#124; MK_SHIFT** Creates a linkage between the object and its server.  \n  \n- `DROPEFFECT_COPY` for **MK_CONTROL** Creates a copy of the dropped object.  \n  \n- `DROPEFFECT_MOVE` for **MK_ALT** Creates a copy of the dropped object and delete the original object. This is typically the default drop effect, when the view can accept this data object.  \n  \n For more information, see the MFC Advanced Concepts sample [OCLIENT](../../visual-cpp-samples.md).  \n  \n### Remarks  \n Default implementation is to do nothing and return `DROPEFFECT_NONE`.  \n  \n Override this function to prepare for future calls to the [OnDragOver](#cview__ondragover) member function. Any data required from the data object should be retrieved at this time for later use in the `OnDragOver` member function. The view should also be updated at this time to give the user visual feedback. For more information, see the article [Drag and Drop: Implementing a Drop Target](../../mfc/drag-and-drop-implementing-a-drop-target.md).  \n  \n##  <a name=\"cview__ondragleave\"></a>  CView::OnDragLeave  \n Called by the framework during a drag operation when the mouse is moved out of the valid drop area for that window.  \n  \n```  \nvirtual void OnDragLeave();\n```  \n  \n### Remarks  \n Override this function if the current view needs to clean up any actions taken during [OnDragEnter](#cview__ondragenter) or [OnDragOver](#cview__ondragover) calls, such as removing any visual user feedback while the object was dragged and dropped.  \n  \n##  <a name=\"cview__ondragover\"></a>  CView::OnDragOver  \n Called by the framework during a drag operation when the mouse is moved over the drop target window.  \n  \n```  \nvirtual DROPEFFECT OnDragOver(\n    COleDataObject* pDataObject,  \n    DWORD dwKeyState,  \n    CPoint point);\n```  \n  \n### Parameters  \n `pDataObject`  \n Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) being dragged over the drop target.  \n  \n `dwKeyState`  \n Contains the state of the modifier keys. This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**.  \n  \n `point`  \n The current mouse position relative to the view client area.  \n  \n### Return Value  \n A value from the `DROPEFFECT` enumerated type, which indicates the type of drop that would occur if the user dropped the object at this position. The type of drop often depends on the current key state as indicated by `dwKeyState`. A standard mapping of keystates to `DROPEFFECT` values is:  \n  \n- `DROPEFFECT_NONE` The data object cannot be dropped in this window.  \n  \n- `DROPEFFECT_LINK` for **MK_CONTROL &#124; MK_SHIFT** Creates a linkage between the object and its server.  \n  \n- `DROPEFFECT_COPY` for **MK_CONTROL** Creates a copy of the dropped object.  \n  \n- `DROPEFFECT_MOVE` for **MK_ALT** Creates a copy of the dropped object and delete the original object. This is typically the default drop effect, when the view can accept the data object.  \n  \n For more information, see the MFC Advanced Concepts sample [OCLIENT](../../visual-cpp-samples.md).  \n  \n### Remarks  \n The default implementation is to do nothing and return `DROPEFFECT_NONE`.  \n  \n Override this function to give the user visual feedback during the drag operation. Since this function is called continuously, any code contained within it should be optimized as much as possible. For more information, see the article [Drag and Drop: Implementing a Drop Target](../../mfc/drag-and-drop-implementing-a-drop-target.md).  \n  \n##  <a name=\"cview__ondragscroll\"></a>  CView::OnDragScroll  \n Called by the framework before calling [OnDragEnter](#cview__ondragenter) or [OnDragOver](#cview__ondragover) to determine whether the point is in the scrolling region.  \n  \n```  \nvirtual DROPEFFECT OnDragScroll(\n    DWORD dwKeyState,  \n    CPoint point);\n```  \n  \n### Parameters  \n `dwKeyState`  \n Contains the state of the modifier keys. This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**.  \n  \n `point`  \n Contains the location of the cursor, in pixels, relative to the screen.  \n  \n### Return Value  \n A value from the `DROPEFFECT` enumerated type, which indicates the type of drop that would occur if the user dropped the object at this position. The type of drop usually depends on the current key state indicated by `dwKeyState`. A standard mapping of keystates to `DROPEFFECT` values is:  \n  \n- `DROPEFFECT_NONE` The data object cannot be dropped in this window.  \n  \n- `DROPEFFECT_LINK` for **MK_CONTROL &#124; MK_SHIFT** Creates a linkage between the object and its server.  \n  \n- `DROPEFFECT_COPY` for **MK_CONTROL** Creates a copy of the dropped object.  \n  \n- `DROPEFFECT_MOVE` for **MK_ALT** Creates a copy of the dropped object and delete the original object.  \n  \n- `DROPEFFECT_SCROLL` Indicates that a drag scroll operation is about to occur or is occurring in the target view.  \n  \n For more information, see the MFC Advanced Concepts sample [OCLIENT](../../visual-cpp-samples.md).  \n  \n### Remarks  \n Override this function when you want to provide special behavior for this event. The default implementation automatically scrolls windows when the cursor is dragged into the default scroll region inside the border of each window.For more information, see the article [Drag and Drop: Implementing a Drop Target](../../mfc/drag-and-drop-implementing-a-drop-target.md).  \n  \n##  <a name=\"cview__ondraw\"></a>  CView::OnDraw  \n Called by the framework to render an image of the document.  \n  \n```  \nvirtual void OnDraw(CDC* pDC) = 0;  \n```  \n  \n### Parameters  \n `pDC`  \n Points to the device context to be used for rendering an image of the document.  \n  \n### Remarks  \n The framework calls this function to perform screen display, printing, and print preview, and it passes a different device context in each case. There is no default implementation.  \n  \n You must override this function to display your view of the document. You can make graphic device interface (GDI) calls using the [CDC](../../mfc/reference/cdc-class.md) object pointed to by the `pDC` parameter. You can select GDI resources, such as pens or fonts, into the device context before drawing and then deselect them afterwards. Often your drawing code can be device-independent; that is, it doesn't require information about what type of device is displaying the image.  \n  \n To optimize drawing, call the [RectVisible](../../mfc/reference/cdc-class.md#cdc__rectvisible) member function of the device context to find out whether a given rectangle will be drawn. If you need to distinguish between normal screen display and printing, call the [IsPrinting](../../mfc/reference/cdc-class.md#cdc__isprinting) member function of the device context.  \n  \n##  <a name=\"cview__ondrop\"></a>  CView::OnDrop  \n Called by the framework when the user releases a data object over a valid drop target.  \n  \n```  \nvirtual BOOL OnDrop(\n    COleDataObject* pDataObject,  \n    DROPEFFECT dropEffect,  \n    CPoint point);\n```  \n  \n### Parameters  \n `pDataObject`  \n Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) that is dropped into the drop target.  \n  \n `dropEffect`  \n The drop effect that the user has requested.  \n  \n- `DROPEFFECT_COPY` Creates a copy of the data object being dropped.  \n  \n- `DROPEFFECT_MOVE` Moves the data object to the current mouse location.  \n  \n- `DROPEFFECT_LINK` Creates a link between a data object and its server.  \n  \n `point`  \n The current mouse position relative to the view client area.  \n  \n### Return Value  \n Nonzero if the drop was successful; otherwise 0.  \n  \n### Remarks  \n The default implementation does nothing and returns **FALSE**.  \n  \n Override this function to implement the effect of an OLE drop into the client area of the view. The data object can be examined via `pDataObject` for Clipboard data formats and data dropped at the specified point.  \n  \n> [!NOTE]\n>  The framework does not call this function if there is an override to [OnDropEx](#cview__ondropex) in this view class.  \n  \n##  <a name=\"cview__ondropex\"></a>  CView::OnDropEx  \n Called by the framework when the user releases a data object over a valid drop target.  \n  \n```  \nvirtual DROPEFFECT OnDropEx(\n    COleDataObject* pDataObject,  \n    DROPEFFECT dropDefault,  \n    DROPEFFECT dropList,  \n    CPoint point);\n```  \n  \n### Parameters  \n `pDataObject`  \n Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) that is dropped into the drop target.  \n  \n `dropDefault`  \n The effect that the user chose for the default drop operation based on the current key state. It may be `DROPEFFECT_NONE`. Drop effects are discussed in the Remarks section.  \n  \n `dropList`  \n A list of the drop effects that the drop source supports. Drop effect values can be combined using the bitwise OR ( **&#124;**) operation. Drop effects are discussed in the Remarks section.  \n  \n `point`  \n The current mouse position relative to the view client area.  \n  \n### Return Value  \n The drop effect that resulted from the drop attempt at the location specified by `point`. This must be one of the values indicated by *dropEffectList*. Drop effects are discussed in the Remarks section.  \n  \n### Remarks  \n The default implementation is to do nothing and return a dummy value ( -1 ) to indicate that the framework should call the [OnDrop](#cview__ondrop) handler.  \n  \n Override this function to implement the effect of an right mouse-button drag and drop. Right mouse-button drag and drop typically displays a menu of choices when the right mouse-button is released.  \n  \n Your override of `OnDropEx` should query for the right mouse-button. You can call [GetKeyState](http://msdn.microsoft.com/library/windows/desktop/ms646301) or store the right mouse-button state from your [OnDragEnter](#cview__ondragenter) handler.  \n  \n-   If the right mouse-button is down, your override should display a popup menu which offers the drop effects support by the drop source.  \n  \n    -   Examine `dropList` to determine the drop effects supported by the drop source. Enable only these actions on the popup menu.  \n  \n    -   Use [SetMenuDefaultItem](http://msdn.microsoft.com/library/windows/desktop/ms647996) to set the default action based on `dropDefault`.  \n  \n    -   Finally, take the action indicated by the user selection from the popup menu.  \n  \n-   If the right mouse-button is not down, your override should process this as a standard drop request. Use the drop effect specified in `dropDefault`. Alternately, your override can return the dummy value ( -1 ) to indicate that `OnDrop` will handle this drop operation.  \n  \n Use `pDataObject` to examine the `COleDataObject` for Clipboard data format and data dropped at the specified point.  \n  \n Drop effects describe the action associated with a drop operation. See the following list of drop effects:  \n  \n- `DROPEFFECT_NONE` A drop would not be allowed.  \n  \n- `DROPEFFECT_COPY` A copy operation would be performed.  \n  \n- `DROPEFFECT_MOVE` A move operation would be performed.  \n  \n- `DROPEFFECT_LINK` A link from the dropped data to the original data would be established.  \n  \n- `DROPEFFECT_SCROLL` Indicates that a drag scroll operation is about to occur or is occurring in the target.  \n  \n For more information on setting the default menu command, see [SetMenuDefaultItem](http://msdn.microsoft.com/library/windows/desktop/ms647996) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] and [CMenu::GetSafeHmenu](../../mfc/reference/cmenu-class.md#cmenu__getsafehmenu) in this volume.  \n  \n##  <a name=\"cview__onendprinting\"></a>  CView::OnEndPrinting  \n Called by the framework after a document has been printed or previewed.  \n  \n```  \nvirtual void OnEndPrinting(\n    CDC* pDC,  \n    CPrintInfo* pInfo);\n```  \n  \n### Parameters  \n `pDC`  \n Points to the printer device context.  \n  \n `pInfo`  \n Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job.  \n  \n### Remarks  \n The default implementation of this function does nothing. Override this function to free any GDI resources you allocated in the [OnBeginPrinting](#cview__onbeginprinting) member function.  \n  \n##  <a name=\"cview__onendprintpreview\"></a>  CView::OnEndPrintPreview  \n Called by the framework when the user exits print preview mode.  \n  \n```  \nvirtual void OnEndPrintPreview(\n    CDC* pDC,  \n    CPrintInfo* pInfo,  \n    POINT point,  \n    CPreviewView* pView);\n```  \n  \n### Parameters  \n `pDC`  \n Points to the printer device context.  \n  \n `pInfo`  \n Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job.  \n  \n `point`  \n Specifies the point on the page that was last displayed in preview mode.  \n  \n `pView`  \n Points to the view object used for previewing.  \n  \n### Remarks  \n The default implementation of this function calls the [OnEndPrinting](#cview__onendprinting) member function and restores the main frame window to the state it was in before print preview began. Override this function to perform special processing when preview mode is terminated. For example, if you want to maintain the user's position in the document when switching from preview mode to normal display mode, you can scroll to the position described by the `point` parameter and the `m_nCurPage` member of the `CPrintInfo` structure that the `pInfo` parameter points to.  \n  \n Always call the base class version of `OnEndPrintPreview` from your override, typically at the end of the function.  \n  \n##  <a name=\"cview__oninitialupdate\"></a>  CView::OnInitialUpdate  \n Called by the framework after the view is first attached to the document, but before the view is initially displayed.  \n  \n```  \nvirtual void OnInitialUpdate();\n```  \n  \n### Remarks  \n The default implementation of this function calls the [OnUpdate](#cview__onupdate) member function with no hint information (that is, using the default values of 0 for the `lHint` parameter and **NULL** for the `pHint` parameter). Override this function to perform any one-time initialization that requires information about the document. For example, if your application has fixed-sized documents, you can use this function to initialize a view's scrolling limits based on the document size. If your application supports variable-sized documents, use [OnUpdate](#cview__onupdate) to update the scrolling limits every time the document changes.  \n  \n##  <a name=\"cview__onpreparedc\"></a>  CView::OnPrepareDC  \n Called by the framework before the [OnDraw](#cview__ondraw) member function is called for screen display and before the [OnPrint](#cview__onprint) member function is called for each page during printing or print preview.  \n  \n```  \nvirtual void OnPrepareDC(\n    CDC* pDC,  \n    CPrintInfo* pInfo = NULL);\n```  \n  \n### Parameters  \n `pDC`  \n Points to the device context to be used for rendering an image of the document.  \n  \n `pInfo`  \n Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job if `OnPrepareDC` is being called for printing or print preview; the `m_nCurPage` member specifies the page about to be printed. This parameter is **NULL** if `OnPrepareDC` is being called for screen display.  \n  \n### Remarks  \n The default implementation of this function does nothing if the function is called for screen display. However, this function is overridden in derived classes, such as [CScrollView](../../mfc/reference/cscrollview-class.md), to adjust attributes of the device context; consequently, you should always call the base class implementation at the beginning of your override.  \n  \n If the function is called for printing, the default implementation examines the page information stored in the `pInfo` parameter. If the length of the document has not been specified, `OnPrepareDC` assumes the document to be one page long and stops the print loop after one page has been printed. The function stops the print loop by setting the `m_bContinuePrinting` member of the structure to **FALSE**.  \n  \n Override `OnPrepareDC` for any of the following reasons:  \n  \n-   To adjust attributes of the device context as needed for the specified page. For example, if you need to set the mapping mode or other characteristics of the device context, do so in this function.  \n  \n-   To perform print-time pagination. Normally you specify the length of the document when printing begins, using the [OnPreparePrinting](#cview__onprepareprinting) member function. However, if you don't know in advance how long the document is (for example, when printing an undetermined number of records from a database), override `OnPrepareDC` to test for the end of the document while it is being printed. When there is no more of the document to be printed, set the `m_bContinuePrinting` member of the `CPrintInfo` structure to **FALSE**.  \n  \n-   To send escape codes to the printer on a page-by-page basis. To send escape codes from `OnPrepareDC`, call the **Escape** member function of the `pDC` parameter.  \n  \n Call the base class version of `OnPrepareDC` at the beginning of your override.  \n  \n### Example  \n [!code-cpp[NVC_MFCDocView#183](../../mfc/codesnippet/cpp/cview-class_1.cpp)]  \n  \n##  <a name=\"cview__onprepareprinting\"></a>  CView::OnPreparePrinting  \n Called by the framework before a document is printed or previewed.  \n  \n```  \nvirtual BOOL OnPreparePrinting(CPrintInfo* pInfo);\n```  \n  \n### Parameters  \n `pInfo`  \n Points to a [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that describes the current print job.  \n  \n### Return Value  \n Nonzero to begin printing; 0 if the print job has been canceled.  \n  \n### Remarks  \n The default implementation does nothing.  \n  \n You must override this function to enable printing and print preview. Call the [DoPreparePrinting](#cview__doprepareprinting) member function, passing it the `pInfo` parameter, and then return its return value; `DoPreparePrinting` displays the Print dialog box and creates a printer device context. If you want to initialize the Print dialog box with values other than the defaults, assign values to the members of `pInfo`. For example, if you know the length of the document, pass the value to the [SetMaxPage](../../mfc/reference/cprintinfo-structure.md#cprintinfo__setmaxpage) member function of `pInfo` before calling `DoPreparePrinting`. This value is displayed in the To: box in the Range portion of the Print dialog box.  \n  \n `DoPreparePrinting` does not display the Print dialog box for a preview job. If you want to bypass the Print dialog box for a print job, check that the **m_bPreview** member of `pInfo` is **FALSE** and then set it to **TRUE** before passing it to `DoPreparePrinting`; reset it to **FALSE** afterwards.  \n  \n If you need to perform initializations that require access to the `CDC` object representing the printer device context (for example, if you need to know the page size before specifying the length of the document), override the `OnBeginPrinting` member function.  \n  \n If you want to set the value of the **m_nNumPreviewPages** or **m_strPageDesc** members of the `pInfo` parameter, do so after calling `DoPreparePrinting`. The `DoPreparePrinting` member function sets **m_nNumPreviewPages** to the value found in the application's .INI file and sets **m_strPageDesc** to its default value.  \n  \n### Example  \n  Override `OnPreparePrinting` and call `DoPreparePrinting` from the override so that the framework will display a Print dialog box and create a printer DC for you.  \n  \n [!code-cpp[NVC_MFCDocView#184](../../mfc/codesnippet/cpp/cview-class_2.cpp)]  \n  \n If you know how many pages the document contains, set the maximum page in `OnPreparePrinting` before calling `DoPreparePrinting`. The framework will display the maximum page number in the \"to\" box of the Print dialog box.  \n  \n [!code-cpp[NVC_MFCDocView#185](../../mfc/codesnippet/cpp/cview-class_3.cpp)]  \n  \n##  <a name=\"cview__onprint\"></a>  CView::OnPrint  \n Called by the framework to print or preview a page of the document.  \n  \n```  \nvirtual void OnPrint(\n    CDC* pDC,  \n    CPrintInfo* pInfo);\n```  \n  \n### Parameters  \n `pDC`  \n Points to the printer device context.  \n  \n `pInfo`  \n Points to a `CPrintInfo` structure that describes the current print job.  \n  \n### Remarks  \n For each page being printed, the framework calls this function immediately after calling the [OnPrepareDC](#cview__onpreparedc) member function. The page being printed is specified by the `m_nCurPage` member of the [CPrintInfo](../../mfc/reference/cprintinfo-structure.md) structure that `pInfo` points to. The default implementation calls the [OnDraw](#cview__ondraw) member function and passes it the printer device context.  \n  \n Override this function for any of the following reasons:  \n  \n-   To allow printing of multipage documents. Render only the portion of the document that corresponds to the page currently being printed. If you're using `OnDraw` to perform the rendering, you can adjust the viewport origin so that only the appropriate portion of the document is printed.  \n  \n-   To make the printed image look different from the screen image (that is, if your application is not WYSIWYG). Instead of passing the printer device context to `OnDraw`, use the device context to render an image using attributes not shown on the screen.  \n  \n     If you need GDI resources for printing that you don't use for screen display, select them into the device context before drawing and deselect them afterwards. These GDI resources should be allocated in [OnBeginPrinting](#cview__onbeginprinting) and released in [OnEndPrinting](#cview__onendprinting).  \n  \n-   To implement headers or footers. You can still use `OnDraw` to do the rendering by restricting the area that it can print on.  \n  \n Note that the **m_rectDraw** member of the `pInfo` parameter describes the printable area of the page in logical units.  \n  \n Do not call `OnPrepareDC` in your override of `OnPrint`; the framework calls `OnPrepareDC` automatically before calling `OnPrint`.  \n  \n### Example  \n The following is a skeleton for an overridden `OnPrint` function:  \n  \n [!code-cpp[NVC_MFCDocView#186](../../mfc/codesnippet/cpp/cview-class_4.cpp)]  \n  \n For another example, see [CRichEditView::PrintInsideRect](../../mfc/reference/cricheditview-class.md#cricheditview__printinsiderect).  \n  \n##  <a name=\"cview__onscroll\"></a>  CView::OnScroll  \n Called by the framework to determine whether scrolling is possible.  \n  \n```  \nvirtual BOOL OnScroll(\n    UINT nScrollCode,  \n    UINT nPos,  \n    BOOL bDoScroll = TRUE);\n```  \n  \n### Parameters  \n `nScrollCode`  \n A scroll-bar code that indicates the user's scrolling request. This parameter is composed of two parts: a low-order byte, which determines the type of scrolling occurring horizontally, and a high-order byte, which determines the type of scrolling occurring vertically:  \n  \n- **SB_BOTTOM** Scrolls to bottom.  \n  \n- **SB_LINEDOWN** Scrolls one line down.  \n  \n- **SB_LINEUP** Scrolls one line up.  \n  \n- **SB_PAGEDOWN** Scrolls one page down.  \n  \n- **SB_PAGEUP** Scrolls one page up.  \n  \n- **SB_THUMBTRACK** Drags scroll box to specified position. The current position is specified in `nPos`.  \n  \n- **SB_TOP** Scrolls to top.  \n  \n `nPos`  \n Contains the current scroll-box position if the scroll-bar code is **SB_THUMBTRACK**; otherwise it is not used. Depending on the initial scroll range, `nPos` may be negative and should be cast to an `int` if necessary.  \n  \n `bDoScroll`  \n Determines whether you should actually do the specified scrolling action. If **TRUE,** then scrolling should take place; if **FALSE**, then scrolling should not occur.  \n  \n### Return Value  \n If `bDoScroll` is **TRUE** and the view was actually scrolled, then return nonzero; otherwise 0. If `bDoScroll` is **FALSE**, then return the value that you would have returned if `bDoScroll` were **TRUE**, even though you don't actually do the scrolling.  \n  \n### Remarks  \n In one case this function is called by the framework with `bDoScroll` set to **TRUE** when the view receives a scrollbar message. In this case, you should actually scroll the view. In the other case this function is called with `bDoScroll` set to **FALSE** when an OLE item is initially dragged into the auto-scrolling region of a drop target before scrolling actually takes place. In this case, you should not actually scroll the view.  \n  \n##  <a name=\"cview__onscrollby\"></a>  CView::OnScrollBy  \n Called by the framework when the user views an area beyond the present view of the document, either by dragging an OLE item against the view's current borders or by manipulating the vertical or horizontal scrollbars.  \n  \n```  \nvirtual BOOL OnScrollBy(\n    CSize sizeScroll,  \n    BOOL bDoScroll = TRUE);\n```  \n  \n### Parameters  \n `sizeScroll`  \n Number of pixels scrolled horizontally and vertically.  \n  \n `bDoScroll`  \n Determines whether scrolling of the view occurs. If **TRUE,** then scrolling takes place; if **FALSE**, then scrolling does not occur.  \n  \n### Return Value  \n Nonzero if the view was able to be scrolled; otherwise 0.  \n  \n### Remarks  \n In derived classes this method checks to see whether the view is scrollable in the direction the user requested and then updates the new region if necessary. This function is automatically called by [CWnd::OnHScroll](../../mfc/reference/cwnd-class.md#cwnd__onhscroll) and [CWnd::OnVScroll](../../mfc/reference/cwnd-class.md#cwnd__onvscroll) to perform the actual scrolling request.  \n  \n The default implementation of this method does not change the view, but if it is not called, the view will not scroll in a `CScrollView`-derived class.  \n  \n If the document width or height exceeds 32767 pixels, scrolling past 32767 will fail because `OnScrollBy` is called with an invalid `sizeScroll` argument.  \n  \n##  <a name=\"cview__onupdate\"></a>  CView::OnUpdate  \n Called by the framework after the view's document has been modified; this function is called by [CDocument::UpdateAllViews](../../mfc/reference/cdocument-class.md#cdocument__updateallviews) and allows the view to update its display to reflect those modifications.  \n  \n```  \nvirtual void OnUpdate(\n    CView* pSender,  \n    LPARAM lHint,  \n    CObject* pHint);\n```  \n  \n### Parameters  \n `pSender`  \n Points to the view that modified the document, or **NULL** if all views are to be updated.  \n  \n `lHint`  \n Contains information about the modifications.  \n  \n `pHint`  \n Points to an object storing information about the modifications.  \n  \n### Remarks  \n It is also called by the default implementation of [OnInitialUpdate](#cview__oninitialupdate). The default implementation invalidates the entire client area, marking it for painting when the next `WM_PAINT` message is received. Override this function if you want to update only those regions that map to the modified portions of the document. To do this you must pass information about the modifications using the hint parameters.  \n  \n To use `lHint`, define special hint values, typically a bitmask or an enumerated type, and have the document pass one of these values. To use `pHint`, derive a hint class from [CObject](../../mfc/reference/cobject-class.md) and have the document pass a pointer to a hint object; when overriding `OnUpdate`, use the [CObject::IsKindOf](../../mfc/reference/cobject-class.md#cobject__iskindof) member function to determine the run-time type of the hint object.  \n  \n Typically you should not perform any drawing directly from `OnUpdate`. Instead, determine the rectangle describing, in device coordinates, the area that requires updating; pass this rectangle to [CWnd::InvalidateRect](../../mfc/reference/cwnd-class.md#cwnd__invalidaterect). This causes painting to occur the next time a [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) message is received.  \n  \n If `lHint` is 0 and `pHint` is **NULL**, the document has sent a generic update notification. If a view receives a generic update notification, or if it cannot decode the hints, it should invalidate its entire client area.  \n  \n## See Also  \n [MFC Sample MDIDOCVW](../../visual-cpp-samples.md)   \n [CWnd Class](../../mfc/reference/cwnd-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CWnd Class](../../mfc/reference/cwnd-class.md)   \n [CFrameWnd Class](../../mfc/reference/cframewnd-class.md)   \n [CSplitterWnd Class](../../mfc/reference/csplitterwnd-class.md)   \n [CDC Class](../../mfc/reference/cdc-class.md)   \n [CDocTemplate Class](../../mfc/reference/cdoctemplate-class.md)   \n [CDocument Class](../../mfc/reference/cdocument-class.md)\n"}