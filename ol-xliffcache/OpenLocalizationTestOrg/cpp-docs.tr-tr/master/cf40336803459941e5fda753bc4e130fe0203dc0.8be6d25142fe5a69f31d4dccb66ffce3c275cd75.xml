{"nodes":[{"pos":[12,55],"content":"IAxWinHostWindow Interface | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IAxWinHostWindow Interface | Microsoft Docs","pos":[0,43]}]},{"content":"IAxWinHostWindow Interface","pos":[630,656]},{"content":"This interface provides methods for manipulating a control and its host object.","pos":[657,736]},{"pos":[744,894],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,148],"source":" This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"content":"Syntax","pos":[903,909]},{"content":"Members","pos":[969,976]},{"content":"Methods","pos":[986,993]},{"content":"AttachControl","pos":[1015,1028]},{"content":"Attaches an existing control to the host object.","pos":[1064,1112]},{"content":"CreateControl","pos":[1118,1131]},{"content":"Creates a control and attaches it to the host object.","pos":[1167,1220]},{"content":"CreateControlEx","pos":[1226,1241]},{"content":"Creates a control, attaches it to the host object, and optionally sets up an event handler.","pos":[1279,1370]},{"content":"QueryControl","pos":[1376,1388]},{"content":"Returns an interface pointer to the hosted control.","pos":[1423,1474]},{"content":"SetExternalDispatch","pos":[1480,1499]},{"pos":[1541,1581],"content":"Sets the external <ph id=\"ph1\">`IDispatch`</ph> interface.","source":"Sets the external `IDispatch` interface."},{"content":"SetExternalUIHandler","pos":[1587,1607]},{"pos":[1650,1706],"content":"Sets the external <ph id=\"ph1\">`IDocHostUIHandlerDispatch`</ph> interface.","source":"Sets the external `IDocHostUIHandlerDispatch` interface."},{"content":"Remarks","pos":[1716,1723]},{"content":"This interface is exposed by ATL's ActiveX control hosting objects.","pos":[1727,1794]},{"content":"Call the methods on this interface to create and/or attach a control to the host object, to get an interface from a hosted control, or to set the external dispinterface or UI handler for use when hosting the Web browser.","pos":[1795,2015]},{"content":"Requirements","pos":[2024,2036]},{"content":"The definition of this interface is available as IDL or C++, as shown below.","pos":[2040,2116]},{"content":"Definition type","pos":[2123,2138]},{"content":"File","pos":[2139,2143]},{"content":"IDL","pos":[2185,2188]},{"content":"ATLIFace.idl","pos":[2189,2201]},{"content":"C++","pos":[2206,2209]},{"content":"ATLIFace.h (also included in ATLBase.h)","pos":[2210,2249]},{"pos":[2308,2339],"content":"IAxWinHostWindow::AttachControl"},{"pos":[2343,2458],"content":"Attaches an existing (and previously initialized) control to the host object using the window identified by <ph id=\"ph1\">`hWnd`</ph>.","source":"Attaches an existing (and previously initialized) control to the host object using the window identified by `hWnd`."},{"content":"Parameters","pos":[2547,2557]},{"content":"pUnkControl","pos":[2562,2573]},{"content":"[in] A pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface of the control to be attached to the host object.","pos":[2578,2672],"source":" [in] A pointer to the **IUnknown** interface of the control to be attached to the host object."},{"content":"[in] A handle to the window to be used for hosting.","pos":[2689,2740]},{"content":"Return Value","pos":[2750,2762]},{"pos":[2766,2793],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"pos":[2851,2882],"content":"IAxWinHostWindow::CreateControl"},{"pos":[2886,2969],"content":"Creates a control, initializes it, and hosts it in the window identified by <ph id=\"ph1\">`hWnd`</ph>.","source":"Creates a control, initializes it, and hosts it in the window identified by `hWnd`."},{"content":"Parameters","pos":[3083,3093]},{"content":"[in] A string identifying the control to create.","pos":[3114,3162]},{"content":"Can be a CLSID (must include the braces), ProgID, URL, or raw HTML (prefixed by <bpt id=\"p1\">**</bpt>MSHTML:<ept id=\"p1\">**</ept>).","pos":[3163,3256],"source":" Can be a CLSID (must include the braces), ProgID, URL, or raw HTML (prefixed by **MSHTML:**)."},{"content":"[in] A handle to the window to be used for hosting.","pos":[3273,3324]},{"content":"[in] An interface pointer for a stream containing initialization data for the control.","pos":[3344,3430]},{"content":"Can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[3431,3447],"source":" Can be **NULL**."},{"content":"Return Value","pos":[3457,3469]},{"pos":[3473,3500],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"content":"Remarks","pos":[3510,3517]},{"content":"This window will be subclassed by the host object exposing this interface so that messages can be reflected to the control and other container features will work.","pos":[3521,3683]},{"pos":[3690,3807],"content":"Calling this method is equivalent to calling <bpt id=\"p1\">[</bpt>IAxWinHostWindow::CreateControlEx<ept id=\"p1\">](#iaxwinhostwindow__createcontrolex)</ept>.","source":"Calling this method is equivalent to calling [IAxWinHostWindow::CreateControlEx](#iaxwinhostwindow__createcontrolex)."},{"pos":[3814,3990],"content":"To create a licensed ActiveX control, see <bpt id=\"p1\">[</bpt>IAxWinHostWindowLic::CreateControlLic<ept id=\"p1\">](../../atl/reference/iaxwinhostwindowlic-interface.md#iaxwinhostwindowlic__createcontrollicex)</ept>.","source":"To create a licensed ActiveX control, see [IAxWinHostWindowLic::CreateControlLic](../../atl/reference/iaxwinhostwindowlic-interface.md#iaxwinhostwindowlic__createcontrollicex)."},{"pos":[4050,4083],"content":"IAxWinHostWindow::CreateControlEx"},{"pos":[4087,4248],"content":"Creates an ActiveX control, initializes it, and hosts it in the specified window, similar to <bpt id=\"p1\">[</bpt>IAxWinHostWindow::CreateControl<ept id=\"p1\">](#iaxwinhostwindow__createcontrol)</ept>.","source":"Creates an ActiveX control, initializes it, and hosts it in the specified window, similar to [IAxWinHostWindow::CreateControl](#iaxwinhostwindow__createcontrol)."},{"content":"Parameters","pos":[4437,4447]},{"content":"[in] A string identifying the control to create.","pos":[4468,4516]},{"content":"Can be a CLSID (must include the braces), ProgID, URL, or raw HTML (prefixed with <bpt id=\"p1\">**</bpt>MSHTML:<ept id=\"p1\">**</ept>).","pos":[4517,4612],"source":" Can be a CLSID (must include the braces), ProgID, URL, or raw HTML (prefixed with **MSHTML:**)."},{"content":"[in] A handle to the window to be used for hosting.","pos":[4629,4680]},{"content":"[in] An interface pointer for a stream containing initialization data for the control.","pos":[4700,4786]},{"content":"Can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[4787,4803],"source":" Can be **NULL**."},{"content":"[out] The address of a pointer that will receive the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface of the created control.","pos":[4821,4920],"source":" [out] The address of a pointer that will receive the **IUnknown** interface of the created control."},{"content":"Can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[4921,4937],"source":" Can be **NULL**."},{"content":"riidAdvise","pos":[4945,4955]},{"content":"[in] The interface identifier of an outgoing interface on the contained object.","pos":[4960,5039]},{"content":"Can be <bpt id=\"p1\">**</bpt>IID_NULL<ept id=\"p1\">**</ept>.","pos":[5040,5060],"source":" Can be **IID_NULL**."},{"content":"punkAdvise","pos":[5068,5078]},{"content":"[in] A pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface of the sink object to be connected to the connection point on the contained object specified by <ph id=\"ph1\">`iidSink`</ph>.","pos":[5083,5234],"source":" [in] A pointer to the **IUnknown** interface of the sink object to be connected to the connection point on the contained object specified by `iidSink`."},{"content":"Return Value","pos":[5244,5256]},{"pos":[5260,5287],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"content":"Remarks","pos":[5297,5304]},{"pos":[5308,5502],"content":"Unlike the <ph id=\"ph1\">`CreateControl`</ph> method, <ph id=\"ph2\">`CreateControlEx`</ph> also allows you to receive an interface pointer to the newly created control and set up an event sink to receive events fired by the control.","source":"Unlike the `CreateControl` method, `CreateControlEx` also allows you to receive an interface pointer to the newly created control and set up an event sink to receive events fired by the control."},{"pos":[5509,5687],"content":"To create a licensed ActiveX control, see <bpt id=\"p1\">[</bpt>IAxWinHostWindowLic::CreateControlLicEx<ept id=\"p1\">](../../atl/reference/iaxwinhostwindowlic-interface.md#iaxwinhostwindowlic__createcontrollicex)</ept>.","source":"To create a licensed ActiveX control, see [IAxWinHostWindowLic::CreateControlLicEx](../../atl/reference/iaxwinhostwindowlic-interface.md#iaxwinhostwindowlic__createcontrollicex)."},{"pos":[5744,5774],"content":"IAxWinHostWindow::QueryControl"},{"content":"Returns the specified interface pointer provided by the hosted control.","pos":[5778,5849]},{"content":"Parameters","pos":[5937,5947]},{"content":"[in] The ID of an interface on the control being requested.","pos":[5961,6020]},{"content":"[out] The address of a pointer that will receive the specified interface of the created control.","pos":[6042,6138]},{"content":"Return Value","pos":[6148,6160]},{"pos":[6164,6191],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"pos":[6255,6292],"content":"IAxWinHostWindow::SetExternalDispatch"},{"pos":[6296,6490],"content":"Sets the external dispinterface, which is available to contained controls through the <bpt id=\"p1\">[</bpt>IDocHostUIHandlerDispatch::GetExternal<ept id=\"p1\">](../../atl/reference/idochostuihandlerdispatch-interface.md)</ept> method.","source":"Sets the external dispinterface, which is available to contained controls through the [IDocHostUIHandlerDispatch::GetExternal](../../atl/reference/idochostuihandlerdispatch-interface.md) method."},{"content":"Parameters","pos":[6563,6573]},{"content":"[in] A pointer to an <ph id=\"ph1\">`IDispatch`</ph> interface.","pos":[6588,6631],"source":" [in] A pointer to an `IDispatch` interface."},{"content":"Return Value","pos":[6641,6653]},{"pos":[6657,6684],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"pos":[6749,6787],"content":"IAxWinHostWindow::SetExternalUIHandler"},{"pos":[6791,6955],"content":"Call this function to set the external <bpt id=\"p1\">[</bpt>IDocHostUIHandlerDispatch<ept id=\"p1\">](../../atl/reference/idochostuihandlerdispatch-interface.md)</ept> interface for the <ph id=\"ph1\">`CAxWindow`</ph> object.","source":"Call this function to set the external [IDocHostUIHandlerDispatch](../../atl/reference/idochostuihandlerdispatch-interface.md) interface for the `CAxWindow` object."},{"content":"Parameters","pos":[7045,7055]},{"content":"[in] A pointer to an <bpt id=\"p1\">**</bpt>IDocHostUIHandlerDispatch<ept id=\"p1\">**</ept> interface.","pos":[7070,7131],"source":" [in] A pointer to an **IDocHostUIHandlerDispatch** interface."},{"content":"Return Value","pos":[7141,7153]},{"pos":[7157,7184],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"content":"Remarks","pos":[7194,7201]},{"pos":[7205,7346],"content":"This function is used by controls (such as the Web browser control) that query the host's site for the <ph id=\"ph1\">`IDocHostUIHandlerDispatch`</ph> interface.","source":"This function is used by controls (such as the Web browser control) that query the host's site for the `IDocHostUIHandlerDispatch` interface."},{"content":"See Also","pos":[7355,7363]},{"content":"IAxWinAmbientDispatch Interface","pos":[7368,7399]},{"content":"CAxWindow::QueryHost","pos":[7462,7482]},{"content":"AtlAxGetHost","pos":[7550,7562]}],"content":"---\ntitle: \"IAxWinHostWindow Interface | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"IAxWinHostWindow\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IAxWinHostWindow interface\"\nms.assetid: 9821c035-cd52-4c46-b58a-9278064f09b4\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IAxWinHostWindow Interface\nThis interface provides methods for manipulating a control and its host object.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n## Syntax  \n  \n```\ninterface IAxWinHostWindow : IUnknown\n```  \n  \n## Members  \n  \n### Methods  \n  \n|||  \n|-|-|  \n|[AttachControl](#iaxwinhostwindow__attachcontrol)|Attaches an existing control to the host object.|  \n|[CreateControl](#iaxwinhostwindow__createcontrol)|Creates a control and attaches it to the host object.|  \n|[CreateControlEx](#iaxwinhostwindow__createcontrolex)|Creates a control, attaches it to the host object, and optionally sets up an event handler.|  \n|[QueryControl](#iaxwinhostwindow__querycontrol)|Returns an interface pointer to the hosted control.|  \n|[SetExternalDispatch](#iaxwinhostwindow__setexternaldispatch)|Sets the external `IDispatch` interface.|  \n|[SetExternalUIHandler](#iaxwinhostwindow__setexternaluihandler)|Sets the external `IDocHostUIHandlerDispatch` interface.|  \n  \n## Remarks  \n This interface is exposed by ATL's ActiveX control hosting objects. Call the methods on this interface to create and/or attach a control to the host object, to get an interface from a hosted control, or to set the external dispinterface or UI handler for use when hosting the Web browser.  \n  \n## Requirements  \n The definition of this interface is available as IDL or C++, as shown below.  \n  \n|Definition type|File|  \n|---------------------|----------|  \n|IDL|ATLIFace.idl|  \n|C++|ATLIFace.h (also included in ATLBase.h)|  \n  \n##  <a name=\"iaxwinhostwindow__attachcontrol\"></a>  IAxWinHostWindow::AttachControl  \n Attaches an existing (and previously initialized) control to the host object using the window identified by `hWnd`.  \n  \n```\nSTDMETHOD(AttachControl)(\n    IUnknown* pUnkControl,  HWND hWnd);\n```  \n  \n### Parameters  \n *pUnkControl*  \n [in] A pointer to the **IUnknown** interface of the control to be attached to the host object.  \n  \n `hWnd`  \n [in] A handle to the window to be used for hosting.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n##  <a name=\"iaxwinhostwindow__createcontrol\"></a>  IAxWinHostWindow::CreateControl  \n Creates a control, initializes it, and hosts it in the window identified by `hWnd`.  \n  \n```\nSTDMETHOD(CreateControl)(\n    LPCOLESTR lpTricsData,\n    HWND hWnd,\n    IStream* pStream);\n```  \n  \n### Parameters  \n `lpTricsData`  \n [in] A string identifying the control to create. Can be a CLSID (must include the braces), ProgID, URL, or raw HTML (prefixed by **MSHTML:**).  \n  \n `hWnd`  \n [in] A handle to the window to be used for hosting.  \n  \n `pStream`  \n [in] An interface pointer for a stream containing initialization data for the control. Can be **NULL**.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n### Remarks  \n This window will be subclassed by the host object exposing this interface so that messages can be reflected to the control and other container features will work.  \n  \n Calling this method is equivalent to calling [IAxWinHostWindow::CreateControlEx](#iaxwinhostwindow__createcontrolex).  \n  \n To create a licensed ActiveX control, see [IAxWinHostWindowLic::CreateControlLic](../../atl/reference/iaxwinhostwindowlic-interface.md#iaxwinhostwindowlic__createcontrollicex).  \n  \n##  <a name=\"iaxwinhostwindow__createcontrolex\"></a>  IAxWinHostWindow::CreateControlEx  \n Creates an ActiveX control, initializes it, and hosts it in the specified window, similar to [IAxWinHostWindow::CreateControl](#iaxwinhostwindow__createcontrol).  \n  \n```\nSTDMETHOD(CreateControlEx)(\n    LPCOLESTR lpszTricsData,\n    HWND hWnd,\n    IStream* pStream,\n    IUnknown** ppUnk,\n    REFIID riidAdvise,\n    IUnknown* punkAdvise);\n```  \n  \n### Parameters  \n `lpTricsData`  \n [in] A string identifying the control to create. Can be a CLSID (must include the braces), ProgID, URL, or raw HTML (prefixed with **MSHTML:**).  \n  \n `hWnd`  \n [in] A handle to the window to be used for hosting.  \n  \n `pStream`  \n [in] An interface pointer for a stream containing initialization data for the control. Can be **NULL**.  \n  \n `ppUnk`  \n [out] The address of a pointer that will receive the **IUnknown** interface of the created control. Can be **NULL**.  \n  \n *riidAdvise*  \n [in] The interface identifier of an outgoing interface on the contained object. Can be **IID_NULL**.  \n  \n *punkAdvise*  \n [in] A pointer to the **IUnknown** interface of the sink object to be connected to the connection point on the contained object specified by `iidSink`.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n### Remarks  \n Unlike the `CreateControl` method, `CreateControlEx` also allows you to receive an interface pointer to the newly created control and set up an event sink to receive events fired by the control.  \n  \n To create a licensed ActiveX control, see [IAxWinHostWindowLic::CreateControlLicEx](../../atl/reference/iaxwinhostwindowlic-interface.md#iaxwinhostwindowlic__createcontrollicex).  \n  \n##  <a name=\"iaxwinhostwindow__querycontrol\"></a>  IAxWinHostWindow::QueryControl  \n Returns the specified interface pointer provided by the hosted control.  \n  \n```\nSTDMETHOD(QueryControl)(\n    REFIID riid,\n    void** ppvObject);\n```  \n  \n### Parameters  \n `riid`  \n [in] The ID of an interface on the control being requested.  \n  \n `ppvObject`  \n [out] The address of a pointer that will receive the specified interface of the created control.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n##  <a name=\"iaxwinhostwindow__setexternaldispatch\"></a>  IAxWinHostWindow::SetExternalDispatch  \n Sets the external dispinterface, which is available to contained controls through the [IDocHostUIHandlerDispatch::GetExternal](../../atl/reference/idochostuihandlerdispatch-interface.md) method.  \n  \n```\nSTDMETHOD(SetExternalDispatch)(IDispatch* pDisp);\n```  \n  \n### Parameters  \n `pDisp`  \n [in] A pointer to an `IDispatch` interface.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n##  <a name=\"iaxwinhostwindow__setexternaluihandler\"></a>  IAxWinHostWindow::SetExternalUIHandler  \n Call this function to set the external [IDocHostUIHandlerDispatch](../../atl/reference/idochostuihandlerdispatch-interface.md) interface for the `CAxWindow` object.  \n  \n```\nSTDMETHOD(SetExternalUIHandler)(IDocHostUIHandlerDispatch* pDisp);\n```  \n  \n### Parameters  \n `pDisp`  \n [in] A pointer to an **IDocHostUIHandlerDispatch** interface.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n### Remarks  \n This function is used by controls (such as the Web browser control) that query the host's site for the `IDocHostUIHandlerDispatch` interface.  \n  \n## See Also  \n [IAxWinAmbientDispatch Interface](../../atl/reference/iaxwinambientdispatch-interface.md)   \n [CAxWindow::QueryHost](../../atl/reference/caxwindow-class.md#caxwindow__queryhost)   \n [AtlAxGetHost](http://msdn.microsoft.com/library/ad1f4f16-608d-4e96-8d30-04d4ca906a7b)\n\n\n\n\n\n\n\n\n\n"}