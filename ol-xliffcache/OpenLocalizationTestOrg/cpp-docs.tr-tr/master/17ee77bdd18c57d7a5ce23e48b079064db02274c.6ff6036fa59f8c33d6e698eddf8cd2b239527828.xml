{"nodes":[{"pos":[12,61],"content":"Record Field Exchange: Using RFX | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Record Field Exchange: Using RFX | Microsoft Docs","pos":[0,49]}]},{"content":"Record Field Exchange: Using RFX","pos":[594,626]},{"content":"This topic explains what you do to use RFX in relation to what the framework does.","pos":[627,709]},{"pos":[717,1136],"content":"[!NOTE]\n This topic applies to classes derived from [CRecordset](../../mfc/reference/crecordset-class.md) in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","leadings":["","> "],"nodes":[{"content":" This topic applies to classes derived from [CRecordset](../../mfc/reference/crecordset-class.md) in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","pos":[8,417],"nodes":[{"content":"This topic applies to classes derived from <bpt id=\"p1\">[</bpt>CRecordset<ept id=\"p1\">](../../mfc/reference/crecordset-class.md)</ept> in which bulk row fetching has not been implemented.","pos":[1,150],"source":" This topic applies to classes derived from [CRecordset](../../mfc/reference/crecordset-class.md) in which bulk row fetching has not been implemented."},{"content":"If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented.","pos":[151,240]},{"content":"Bulk RFX is similar to RFX.","pos":[241,268]},{"content":"To understand the differences, see <bpt id=\"p1\">[</bpt>Recordset: Fetching Records in Bulk (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)</ept>.","pos":[269,409],"source":" To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)."}]}]},{"content":"The following topics contain related information:","pos":[1143,1192]},{"pos":[1202,1607],"content":"<bpt id=\"p1\">[</bpt>Record Field Exchange: Working with the Wizard Code<ept id=\"p1\">](../../data/odbc/record-field-exchange-working-with-the-wizard-code.md)</ept> introduces the main components of RFX and explains the code that the MFC Application Wizard and <bpt id=\"p2\">**</bpt>Add Class<ept id=\"p2\">**</ept> (as described in <bpt id=\"p3\">[</bpt>Adding an MFC ODBC Consumer<ept id=\"p3\">](../../mfc/reference/adding-an-mfc-odbc-consumer.md)</ept>) write to support RFX and how you might want to modify the wizard code.","source":"[Record Field Exchange: Working with the Wizard Code](../../data/odbc/record-field-exchange-working-with-the-wizard-code.md) introduces the main components of RFX and explains the code that the MFC Application Wizard and **Add Class** (as described in [Adding an MFC ODBC Consumer](../../mfc/reference/adding-an-mfc-odbc-consumer.md)) write to support RFX and how you might want to modify the wizard code."},{"pos":[1617,1811],"content":"<bpt id=\"p1\">[</bpt>Record Field Exchange: Using the RFX Functions<ept id=\"p1\">](../../data/odbc/record-field-exchange-using-the-rfx-functions.md)</ept> explains writing calls to the RFX functions in your <ph id=\"ph1\">`DoFieldExchange`</ph> override.","source":"[Record Field Exchange: Using the RFX Functions](../../data/odbc/record-field-exchange-using-the-rfx-functions.md) explains writing calls to the RFX functions in your `DoFieldExchange` override."},{"content":"The following table shows your role in relation to what the framework does for you.","pos":[1818,1901]},{"content":"Using RFX: You and the Framework","pos":[1911,1943]},{"content":"You","pos":[1950,1953]},{"content":"The framework","pos":[1954,1967]},{"content":"|Declare your recordset classes with a wizard.","pos":[2006,2052]},{"content":"Specify names and data types of field data members.|The wizard derives a <ph id=\"ph1\">`CRecordset`</ph> class and writes a <bpt id=\"p1\">[</bpt>DoFieldExchange<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange)</ept> override for you, including an RFX function call for each field data member.|","pos":[2053,2322],"source":" Specify names and data types of field data members.|The wizard derives a `CRecordset` class and writes a [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) override for you, including an RFX function call for each field data member.|"},{"content":"|(Optional) Manually add any needed parameter data members to the class.","pos":[2325,2397]},{"content":"Manually add an RFX function call to <ph id=\"ph1\">`DoFieldExchange`</ph> for each parameter data member, add a call to <bpt id=\"p1\">[</bpt>CFieldExchange::SetFieldType<ept id=\"p1\">](../../mfc/reference/cfieldexchange-class.md#cfieldexchange__setfieldtype)</ept> for the group of parameters, and specify the total number of parameters in <bpt id=\"p2\">[</bpt>m_nParams<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__m_nparams)</ept>.","pos":[2398,2754],"source":" Manually add an RFX function call to `DoFieldExchange` for each parameter data member, add a call to [CFieldExchange::SetFieldType](../../mfc/reference/cfieldexchange-class.md#cfieldexchange__setfieldtype) for the group of parameters, and specify the total number of parameters in [m_nParams](../../mfc/reference/crecordset-class.md#crecordset__m_nparams)."},{"content":"See <bpt id=\"p1\">[</bpt>Recordset: Parameterizing a Recordset (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)</ept>.||","pos":[2755,2870],"source":" See [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).||"},{"content":"|(Optional) Manually bind additional columns to field data members.","pos":[2873,2940]},{"content":"Manually increment <bpt id=\"p1\">[</bpt>m_nFields<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__m_nfields)</ept>.","pos":[2941,3035],"source":" Manually increment [m_nFields](../../mfc/reference/crecordset-class.md#crecordset__m_nfields)."},{"content":"See <bpt id=\"p1\">[</bpt>Recordset: Dynamically Binding Data Columns (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)</ept>.||","pos":[3036,3163],"source":" See [Recordset: Dynamically Binding Data Columns (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md).||"},{"content":"|Construct an object of your recordset class.","pos":[3167,3212]},{"content":"Before using the object, set the values of its parameter data members, if any.|For efficiency, the framework prebinds the parameters, using ODBC.","pos":[3213,3358]},{"content":"When you pass parameter values, the framework passes them to the data source.","pos":[3359,3436]},{"content":"Only the parameter values are sent for requeries, unless the sort and/or filter strings have changed.|","pos":[3437,3539]},{"content":"|Open a recordset object using <bpt id=\"p1\">[</bpt>CRecordset::Open<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__open)</ept>.|Executes the recordset's query, binds columns to field data members of the recordset, and calls <ph id=\"ph1\">`DoFieldExchange`</ph> to exchange data between the first selected record and the recordset's field data members.|","pos":[3542,3856],"source":"|Open a recordset object using [CRecordset::Open](../../mfc/reference/crecordset-class.md#crecordset__open).|Executes the recordset's query, binds columns to field data members of the recordset, and calls `DoFieldExchange` to exchange data between the first selected record and the recordset's field data members.|"},{"content":"|Scroll in the recordset using <bpt id=\"p1\">[</bpt>CRecordset::Move<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__move)</ept> or a menu or toolbar command.|Calls <ph id=\"ph1\">`DoFieldExchange`</ph> to transfer data to the field data members from the new current record.|","pos":[3859,4093],"source":"|Scroll in the recordset using [CRecordset::Move](../../mfc/reference/crecordset-class.md#crecordset__move) or a menu or toolbar command.|Calls `DoFieldExchange` to transfer data to the field data members from the new current record.|"},{"content":"|Add, update, and delete records.|Calls <ph id=\"ph1\">`DoFieldExchange`</ph> to transfer data to the data source.|","pos":[4096,4191],"source":"|Add, update, and delete records.|Calls `DoFieldExchange` to transfer data to the data source.|"},{"content":"See Also","pos":[4200,4208]},{"content":"Record Field Exchange (RFX)","pos":[4213,4240]},{"content":"Record Field Exchange: How RFX Works","pos":[4293,4329]},{"content":"Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)","pos":[4392,4452]},{"content":"CRecordset Class","pos":[4537,4553]},{"content":"CFieldExchange Class","pos":[4601,4621]},{"content":"Macros, Global Functions, and Global Variables","pos":[4673,4719]}],"content":"---\ntitle: \"Record Field Exchange: Using RFX | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"RFX (ODBC), implementing\"\nms.assetid: ada8f043-37e6-4d41-9db3-92c997a61957\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Record Field Exchange: Using RFX\nThis topic explains what you do to use RFX in relation to what the framework does.  \n  \n> [!NOTE]\n>  This topic applies to classes derived from [CRecordset](../../mfc/reference/crecordset-class.md) in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).  \n  \n The following topics contain related information:  \n  \n-   [Record Field Exchange: Working with the Wizard Code](../../data/odbc/record-field-exchange-working-with-the-wizard-code.md) introduces the main components of RFX and explains the code that the MFC Application Wizard and **Add Class** (as described in [Adding an MFC ODBC Consumer](../../mfc/reference/adding-an-mfc-odbc-consumer.md)) write to support RFX and how you might want to modify the wizard code.  \n  \n-   [Record Field Exchange: Using the RFX Functions](../../data/odbc/record-field-exchange-using-the-rfx-functions.md) explains writing calls to the RFX functions in your `DoFieldExchange` override.  \n  \n The following table shows your role in relation to what the framework does for you.  \n  \n### Using RFX: You and the Framework  \n  \n|You|The framework|  \n|---------|-------------------|  \n\n|Declare your recordset classes with a wizard. Specify names and data types of field data members.|The wizard derives a `CRecordset` class and writes a [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) override for you, including an RFX function call for each field data member.|  \n|(Optional) Manually add any needed parameter data members to the class. Manually add an RFX function call to `DoFieldExchange` for each parameter data member, add a call to [CFieldExchange::SetFieldType](../../mfc/reference/cfieldexchange-class.md#cfieldexchange__setfieldtype) for the group of parameters, and specify the total number of parameters in [m_nParams](../../mfc/reference/crecordset-class.md#crecordset__m_nparams). See [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).||  \n|(Optional) Manually bind additional columns to field data members. Manually increment [m_nFields](../../mfc/reference/crecordset-class.md#crecordset__m_nfields). See [Recordset: Dynamically Binding Data Columns (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md).||  \n\n|Construct an object of your recordset class. Before using the object, set the values of its parameter data members, if any.|For efficiency, the framework prebinds the parameters, using ODBC. When you pass parameter values, the framework passes them to the data source. Only the parameter values are sent for requeries, unless the sort and/or filter strings have changed.|  \n|Open a recordset object using [CRecordset::Open](../../mfc/reference/crecordset-class.md#crecordset__open).|Executes the recordset's query, binds columns to field data members of the recordset, and calls `DoFieldExchange` to exchange data between the first selected record and the recordset's field data members.|  \n|Scroll in the recordset using [CRecordset::Move](../../mfc/reference/crecordset-class.md#crecordset__move) or a menu or toolbar command.|Calls `DoFieldExchange` to transfer data to the field data members from the new current record.|  \n|Add, update, and delete records.|Calls `DoFieldExchange` to transfer data to the data source.|  \n  \n## See Also  \n [Record Field Exchange (RFX)](../../data/odbc/record-field-exchange-rfx.md)   \n [Record Field Exchange: How RFX Works](../../data/odbc/record-field-exchange-how-rfx-works.md)   \n [Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)](../../data/odbc/recordset-obtaining-sums-and-other-aggregate-results-odbc.md)   \n [CRecordset Class](../../mfc/reference/crecordset-class.md)   \n [CFieldExchange Class](../../mfc/reference/cfieldexchange-class.md)   \n [Macros, Global Functions, and Global Variables](../../mfc/reference/mfc-macros-and-globals.md)\n\n"}