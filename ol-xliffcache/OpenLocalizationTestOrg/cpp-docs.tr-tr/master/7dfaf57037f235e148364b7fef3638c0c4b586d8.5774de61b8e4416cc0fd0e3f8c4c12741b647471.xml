{"nodes":[{"pos":[12,79],"content":"Unicode and Multibyte Character Set (MBCS) Support | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Unicode and Multibyte Character Set (MBCS) Support | Microsoft Docs","pos":[0,67]}]},{"content":"Unicode and Multibyte Character Set (MBCS) Support","pos":[911,961]},{"content":"Some languages, for example, Japanese and Chinese, have large character sets.","pos":[962,1039]},{"content":"To support programming for these markets, the Microsoft Foundation Class Library (MFC) is enabled for two different approaches to handling large character sets:","pos":[1040,1200]},{"content":"Unicode","pos":[1211,1218]},{"content":"Multibyte Character Sets (MBCS)","pos":[1270,1301]},{"content":"You should use Unicode for all new development.","pos":[1346,1393]},{"pos":[1456,1487],"content":"MFC Support for Unicode Strings"},{"content":"The entire class library is conditionally enabled for Unicode characters and strings.","pos":[1491,1576]},{"content":"In particular, class <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../atl-mfc-shared/reference/cstringt-class.md)</ept> is Unicode-enabled.","pos":[1577,1674],"source":" In particular, class [CString](../atl-mfc-shared/reference/cstringt-class.md) is Unicode-enabled."},{"content":"UAFXCW.LIB","pos":[1701,1711]},{"content":"UAFXCW.PDB","pos":[1712,1722]},{"content":"UAFXCWD.LIB","pos":[1723,1734]},{"content":"UAFXCWD.PDB","pos":[1735,1746]},{"pos":[1751,1763],"content":"MFC<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>U.LIB","source":"MFC*xx*U.LIB"},{"pos":[1764,1776],"content":"MFC<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>U.PDB","source":"MFC*xx*U.PDB"},{"pos":[1777,1789],"content":"MFC<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>U.DLL","source":"MFC*xx*U.DLL"},{"pos":[1790,1803],"content":"MFC<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>UD.LIB","source":"MFC*xx*UD.LIB"},{"pos":[1808,1821],"content":"MFC<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>UD.PDB","source":"MFC*xx*UD.PDB"},{"pos":[1822,1835],"content":"MFC<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>UD.DLL","source":"MFC*xx*UD.DLL"},{"pos":[1836,1849],"content":"MFCS<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>U.LIB","source":"MFCS*xx*U.LIB"},{"pos":[1850,1863],"content":"MFCS<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>U.PDB","source":"MFCS*xx*U.PDB"},{"pos":[1868,1882],"content":"MFCS<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>UD.LIB","source":"MFCS*xx*UD.LIB"},{"pos":[1883,1897],"content":"MFCS<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>UD.PDB","source":"MFCS*xx*UD.PDB"},{"pos":[1898,1911],"content":"MFCM<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>U.LIB","source":"MFCM*xx*U.LIB"},{"pos":[1912,1925],"content":"MFCM<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>U.PDB","source":"MFCM*xx*U.PDB"},{"pos":[1930,1943],"content":"MFCM<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>U.DLL","source":"MFCM*xx*U.DLL"},{"pos":[1944,1958],"content":"MFCM<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>UD.LIB","source":"MFCM*xx*UD.LIB"},{"pos":[1959,1973],"content":"MFCM<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>UD.PDB","source":"MFCM*xx*UD.PDB"},{"pos":[1974,1988],"content":"MFCM<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept>UD.DLL","source":"MFCM*xx*UD.DLL"},{"pos":[1996,2082],"content":"(<bpt id=\"p1\">*</bpt>xx<ept id=\"p1\">*</ept> represents the version number of the file; for example, '80' means version 8.0.)","source":"(*xx* represents the version number of the file; for example, '80' means version 8.0.)"},{"content":"is based on the <ph id=\"ph1\">`TCHAR`</ph> data type.","pos":[2099,2133],"source":" is based on the `TCHAR` data type."},{"content":"If the symbol <ph id=\"ph1\">`_UNICODE`</ph> is defined for a build of your program, <ph id=\"ph2\">`TCHAR`</ph> is defined as type <ph id=\"ph3\">`wchar_t`</ph>, a 16-bit character encoding type.","pos":[2134,2270],"source":" If the symbol `_UNICODE` is defined for a build of your program, `TCHAR` is defined as type `wchar_t`, a 16-bit character encoding type."},{"content":"Otherwise, <ph id=\"ph1\">`TCHAR`</ph> is defined as <ph id=\"ph2\">`char`</ph>, the normal 8-bit character encoding.","pos":[2271,2348],"source":" Otherwise, `TCHAR` is defined as `char`, the normal 8-bit character encoding."},{"content":"Therefore, under Unicode, a <ph id=\"ph1\">`CString`</ph> is composed of 16-bit characters.","pos":[2349,2420],"source":" Therefore, under Unicode, a `CString` is composed of 16-bit characters."},{"content":"Without Unicode, it is composed of characters of type <ph id=\"ph1\">`char`</ph>.","pos":[2421,2482],"source":" Without Unicode, it is composed of characters of type `char`."},{"content":"To complete Unicode programming of your application, you must also:","pos":[2489,2556]},{"pos":[2566,2649],"content":"Use the <ph id=\"ph1\">`_T`</ph> macro to conditionally code literal strings to be portable to Unicode.","source":"Use the `_T` macro to conditionally code literal strings to be portable to Unicode."},{"content":"When you pass strings, pay attention to whether function arguments require a length in characters or a length in bytes.","pos":[2659,2778]},{"content":"The difference is important if you are using Unicode strings.","pos":[2779,2840]},{"content":"Use portable versions of the C run-time string-handling functions.","pos":[2850,2916]},{"content":"Use the following data types for characters and character pointers:","pos":[2926,2993]},{"pos":[3015,3042],"content":"Where you would use <ph id=\"ph1\">`char`</ph>.","source":" Where you would use `char`."},{"pos":[3065,3093],"content":"Where you would use <ph id=\"ph1\">`char*`</ph>.","source":" Where you would use `char*`."},{"content":"Where you would use <ph id=\"ph1\">`const char*`</ph>.","pos":[3117,3151],"source":" Where you would use `const char*`."},{"content":"provides the operator <ph id=\"ph1\">`LPCTSTR`</ph> to convert between <ph id=\"ph2\">`CString`</ph> and <ph id=\"ph3\">`LPCTSTR`</ph>.","pos":[3162,3237],"source":" provides the operator `LPCTSTR` to convert between `CString` and `LPCTSTR`."},{"pos":[3254,3343],"content":"also supplies Unicode-aware constructors, assignment operators, and comparison operators."},{"content":"For related information on Unicode programming, see <bpt id=\"p1\">[</bpt>Unicode Topics<ept id=\"p1\">](../mfc/unicode-in-mfc.md)</ept>.","pos":[3350,3445],"source":"For related information on Unicode programming, see [Unicode Topics](../mfc/unicode-in-mfc.md)."},{"content":"The <bpt id=\"p1\">[</bpt>Run-Time Library Reference<ept id=\"p1\">](../c-runtime-library/c-run-time-library-reference.md)</ept> defines portable versions of all its string-handling functions.","pos":[3446,3596],"source":" The [Run-Time Library Reference](../c-runtime-library/c-run-time-library-reference.md) defines portable versions of all its string-handling functions."},{"content":"See the category <bpt id=\"p1\">[</bpt>Internationalization<ept id=\"p1\">](../c-runtime-library/internationalization.md)</ept>.","pos":[3597,3683],"source":" See the category [Internationalization](../c-runtime-library/internationalization.md)."},{"pos":[3743,3771],"content":"MFC Support for MBCS Strings"},{"pos":[3779,4037],"content":"[!WARNING]\n MBCS strings are legacy technology and should not be used in new projects. The following information is provided for scenarios in which you need to maintain existing code that uses MBCS and it is not feasible to upgrade the code to use Unicode.","leadings":["","> "],"nodes":[{"content":" MBCS strings are legacy technology and should not be used in new projects. The following information is provided for scenarios in which you need to maintain existing code that uses MBCS and it is not feasible to upgrade the code to use Unicode.","pos":[11,256],"nodes":[{"content":"MBCS strings are legacy technology and should not be used in new projects.","pos":[1,75]},{"content":"The following information is provided for scenarios in which you need to maintain existing code that uses MBCS and it is not feasible to upgrade the code to use Unicode.","pos":[76,245]}]}]},{"content":"The class library is also enabled for multibyte character sets, but only for double-byte character sets (DBCS).","pos":[4044,4155]},{"pos":[4163,4447],"content":"[!IMPORTANT]\n In [!INCLUDE[vs_dev12](../atl-mfc-shared/includes/vs_dev12_md.md)] and later, the MBCS versions of the MFC DLLs are available as a free add-in to Visual Studio from the MSDN download site. For more information, see [MFC MBCS DLL Add-in](../mfc/mfc-mbcs-dll-add-on.md).","leadings":["","> "],"nodes":[{"content":" In [!INCLUDE[vs_dev12](../atl-mfc-shared/includes/vs_dev12_md.md)] and later, the MBCS versions of the MFC DLLs are available as a free add-in to Visual Studio from the MSDN download site. For more information, see [MFC MBCS DLL Add-in](../mfc/mfc-mbcs-dll-add-on.md).","pos":[13,282],"nodes":[{"content":"In <ph id=\"ph1\">[!INCLUDE[vs_dev12](../atl-mfc-shared/includes/vs_dev12_md.md)]</ph> and later, the MBCS versions of the MFC DLLs are available as a free add-in to Visual Studio from the MSDN download site.","pos":[1,189],"source":" In [!INCLUDE[vs_dev12](../atl-mfc-shared/includes/vs_dev12_md.md)] and later, the MBCS versions of the MFC DLLs are available as a free add-in to Visual Studio from the MSDN download site."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>MFC MBCS DLL Add-in<ept id=\"p1\">](../mfc/mfc-mbcs-dll-add-on.md)</ept>.","pos":[190,269],"source":" For more information, see [MFC MBCS DLL Add-in](../mfc/mfc-mbcs-dll-add-on.md)."}]}]},{"content":"In a multibyte character set, a character can be one or two bytes wide.","pos":[4454,4525]},{"content":"If it is two bytes wide, its first byte is a special \"lead byte\" that is chosen from a particular range, depending on which code page is in use.","pos":[4526,4670]},{"content":"Taken together, the lead and \"trail bytes\" specify a unique character encoding.","pos":[4671,4750]},{"content":"If the symbol <ph id=\"ph1\">`_MBCS`</ph> is defined for a build of your program, type <ph id=\"ph2\">`TCHAR`</ph>, on which <ph id=\"ph3\">`CString`</ph> is based, maps to <ph id=\"ph4\">`char`</ph>.","pos":[4757,4877],"source":"If the symbol `_MBCS` is defined for a build of your program, type `TCHAR`, on which `CString` is based, maps to `char`."},{"content":"It is up to you to determine which bytes in a <ph id=\"ph1\">`CString`</ph> are lead bytes and which are trail bytes.","pos":[4878,4975],"source":" It is up to you to determine which bytes in a `CString` are lead bytes and which are trail bytes."},{"content":"The C run-time library supplies functions to help you determine this.","pos":[4976,5045]},{"content":"Under DBCS, a given string can contain all single-byte ANSI characters, all double-byte characters, or a combination of the two.","pos":[5052,5180]},{"content":"These possibilities require special care in parsing strings.","pos":[5181,5241]},{"content":"This includes <ph id=\"ph1\">`CString`</ph> objects.","pos":[5242,5274],"source":" This includes `CString` objects."},{"pos":[5282,5516],"content":"[!NOTE]\n Unicode string serialization in MFC can read both Unicode and MBCS strings regardless of which version of the application that you are running. Your data files are portable between Unicode and MBCS versions of your program.","leadings":["","> "],"nodes":[{"content":" Unicode string serialization in MFC can read both Unicode and MBCS strings regardless of which version of the application that you are running. Your data files are portable between Unicode and MBCS versions of your program.","pos":[8,232],"nodes":[{"content":"Unicode string serialization in MFC can read both Unicode and MBCS strings regardless of which version of the application that you are running.","pos":[1,144]},{"content":"Your data files are portable between Unicode and MBCS versions of your program.","pos":[145,224]}]}]},{"content":"member functions use special \"generic text\" versions of the C run-time functions they call, or they use Unicode-aware functions.","pos":[5533,5661]},{"content":"Therefore, for example, if a <ph id=\"ph1\">`CString`</ph> function would typically call <ph id=\"ph2\">`strcmp`</ph>, it calls the corresponding generic-text function <ph id=\"ph3\">`_tcscmp`</ph> instead.","pos":[5662,5808],"source":" Therefore, for example, if a `CString` function would typically call `strcmp`, it calls the corresponding generic-text function `_tcscmp` instead."},{"content":"Depending on how the symbols <ph id=\"ph1\">`_MBCS`</ph> and <ph id=\"ph2\">`_UNICODE`</ph> are defined, <ph id=\"ph3\">`_tcscmp`</ph> maps as follows:","pos":[5809,5900],"source":" Depending on how the symbols `_MBCS` and `_UNICODE` are defined, `_tcscmp` maps as follows:"},{"pos":[5929,5936],"content":"defined"},{"pos":[5962,5969],"content":"defined"},{"content":"Neither symbol defined","pos":[5983,6005]},{"pos":[6023,6092],"content":"[!NOTE]\n The symbols `_MBCS` and `_UNICODE` are mutually exclusive.","leadings":["","> "],"nodes":[{"content":"The symbols <ph id=\"ph1\">`_MBCS`</ph> and <ph id=\"ph2\">`_UNICODE`</ph> are mutually exclusive.","pos":[9,67],"source":" The symbols `_MBCS` and `_UNICODE` are mutually exclusive."}]},{"content":"Generic-text function mappings for all of the run-time string-handling routines are discussed in <bpt id=\"p1\">[</bpt>C Run-Time Library Reference<ept id=\"p1\">](../c-runtime-library/c-run-time-library-reference.md)</ept>.","pos":[6099,6281],"source":"Generic-text function mappings for all of the run-time string-handling routines are discussed in [C Run-Time Library Reference](../c-runtime-library/c-run-time-library-reference.md)."},{"content":"In particular, see <bpt id=\"p1\">[</bpt>Internationalization<ept id=\"p1\">](../c-runtime-library/internationalization.md)</ept>.","pos":[6282,6370],"source":" In particular, see [Internationalization](../c-runtime-library/internationalization.md)."},{"content":"Similarly, <ph id=\"ph1\">`CString`</ph> methods are implemented by using \"generic\" data type mappings.","pos":[6377,6460],"source":"Similarly, `CString` methods are implemented by using \"generic\" data type mappings."},{"content":"To enable both MBCS and Unicode, MFC uses <ph id=\"ph1\">`TCHAR`</ph> for <ph id=\"ph2\">`char`</ph>, <ph id=\"ph3\">`LPTSTR`</ph> for <ph id=\"ph4\">`char*`</ph>, and <ph id=\"ph5\">`LPCTSTR`</ph> for <ph id=\"ph6\">`const char*`</ph>.","pos":[6461,6577],"source":" To enable both MBCS and Unicode, MFC uses `TCHAR` for `char`, `LPTSTR` for `char*`, and `LPCTSTR` for `const char*`."},{"content":"These ensure the correct mappings for either MBCS or Unicode.","pos":[6578,6639]},{"content":"See Also","pos":[6648,6656]},{"content":"Strings (ATL/MFC)","pos":[6661,6678]},{"content":"String Manipulation","pos":[6723,6742]}],"content":"---\ntitle: \"Unicode and Multibyte Character Set (MBCS) Support | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC [C++], character set support\"\n  - \"MBCS [C++], strings and MFC support\"\n  - \"strings [C++], MBCS support in MFC\"\n  - \"character sets [C++], multibyte\"\n  - \"Unicode [C++], MFC strings\"\n  - \"Unicode [C++], string objects\"\n  - \"strings [C++], Unicode\"\n  - \"strings [C++], character set support\"\nms.assetid: 44b3193b-c92d-40c5-9fa8-5774da303cce\ncaps.latest.revision: 17\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Unicode and Multibyte Character Set (MBCS) Support\nSome languages, for example, Japanese and Chinese, have large character sets. To support programming for these markets, the Microsoft Foundation Class Library (MFC) is enabled for two different approaches to handling large character sets:  \n  \n-   [Unicode](#_core_mfc_support_for_unicode_strings)  \n  \n-   [Multibyte Character Sets (MBCS)](#_core_mfc_support_for_mbcs_strings)  \n  \n You should use Unicode for all new development.  \n  \n##  <a name=\"_core_mfc_support_for_unicode_strings\"></a> MFC Support for Unicode Strings  \n The entire class library is conditionally enabled for Unicode characters and strings. In particular, class [CString](../atl-mfc-shared/reference/cstringt-class.md) is Unicode-enabled.  \n  \n|||||  \n|-|-|-|-|  \n|UAFXCW.LIB|UAFXCW.PDB|UAFXCWD.LIB|UAFXCWD.PDB|  \n|MFC*xx*U.LIB|MFC*xx*U.PDB|MFC*xx*U.DLL|MFC*xx*UD.LIB|  \n|MFC*xx*UD.PDB|MFC*xx*UD.DLL|MFCS*xx*U.LIB|MFCS*xx*U.PDB|  \n|MFCS*xx*UD.LIB|MFCS*xx*UD.PDB|MFCM*xx*U.LIB|MFCM*xx*U.PDB|  \n|MFCM*xx*U.DLL|MFCM*xx*UD.LIB|MFCM*xx*UD.PDB|MFCM*xx*UD.DLL|  \n  \n (*xx* represents the version number of the file; for example, '80' means version 8.0.)  \n  \n `CString` is based on the `TCHAR` data type. If the symbol `_UNICODE` is defined for a build of your program, `TCHAR` is defined as type `wchar_t`, a 16-bit character encoding type. Otherwise, `TCHAR` is defined as `char`, the normal 8-bit character encoding. Therefore, under Unicode, a `CString` is composed of 16-bit characters. Without Unicode, it is composed of characters of type `char`.  \n  \n To complete Unicode programming of your application, you must also:  \n  \n-   Use the `_T` macro to conditionally code literal strings to be portable to Unicode.  \n  \n-   When you pass strings, pay attention to whether function arguments require a length in characters or a length in bytes. The difference is important if you are using Unicode strings.  \n  \n-   Use portable versions of the C run-time string-handling functions.  \n  \n-   Use the following data types for characters and character pointers:  \n  \n    -   `TCHAR` Where you would use `char`.  \n  \n    -   `LPTSTR` Where you would use `char*`.  \n  \n    -   `LPCTSTR` Where you would use `const char*`. `CString` provides the operator `LPCTSTR` to convert between `CString` and `LPCTSTR`.  \n  \n `CString` also supplies Unicode-aware constructors, assignment operators, and comparison operators.  \n  \n For related information on Unicode programming, see [Unicode Topics](../mfc/unicode-in-mfc.md). The [Run-Time Library Reference](../c-runtime-library/c-run-time-library-reference.md) defines portable versions of all its string-handling functions. See the category [Internationalization](../c-runtime-library/internationalization.md).  \n  \n##  <a name=\"_core_mfc_support_for_mbcs_strings\"></a> MFC Support for MBCS Strings  \n  \n> [!WARNING]\n>  MBCS strings are legacy technology and should not be used in new projects. The following information is provided for scenarios in which you need to maintain existing code that uses MBCS and it is not feasible to upgrade the code to use Unicode.  \n  \n The class library is also enabled for multibyte character sets, but only for double-byte character sets (DBCS).  \n  \n> [!IMPORTANT]\n>  In [!INCLUDE[vs_dev12](../atl-mfc-shared/includes/vs_dev12_md.md)] and later, the MBCS versions of the MFC DLLs are available as a free add-in to Visual Studio from the MSDN download site. For more information, see [MFC MBCS DLL Add-in](../mfc/mfc-mbcs-dll-add-on.md).  \n  \n In a multibyte character set, a character can be one or two bytes wide. If it is two bytes wide, its first byte is a special \"lead byte\" that is chosen from a particular range, depending on which code page is in use. Taken together, the lead and \"trail bytes\" specify a unique character encoding.  \n  \n If the symbol `_MBCS` is defined for a build of your program, type `TCHAR`, on which `CString` is based, maps to `char`. It is up to you to determine which bytes in a `CString` are lead bytes and which are trail bytes. The C run-time library supplies functions to help you determine this.  \n  \n Under DBCS, a given string can contain all single-byte ANSI characters, all double-byte characters, or a combination of the two. These possibilities require special care in parsing strings. This includes `CString` objects.  \n  \n> [!NOTE]\n>  Unicode string serialization in MFC can read both Unicode and MBCS strings regardless of which version of the application that you are running. Your data files are portable between Unicode and MBCS versions of your program.  \n  \n `CString` member functions use special \"generic text\" versions of the C run-time functions they call, or they use Unicode-aware functions. Therefore, for example, if a `CString` function would typically call `strcmp`, it calls the corresponding generic-text function `_tcscmp` instead. Depending on how the symbols `_MBCS` and `_UNICODE` are defined, `_tcscmp` maps as follows:  \n  \n|||  \n|-|-|  \n|`_MBCS` defined|`_mbscmp`|  \n|`_UNICODE` defined|`wcscmp`|  \n|Neither symbol defined|`strcmp`|  \n  \n> [!NOTE]\n>  The symbols `_MBCS` and `_UNICODE` are mutually exclusive.  \n  \n Generic-text function mappings for all of the run-time string-handling routines are discussed in [C Run-Time Library Reference](../c-runtime-library/c-run-time-library-reference.md). In particular, see [Internationalization](../c-runtime-library/internationalization.md).  \n  \n Similarly, `CString` methods are implemented by using \"generic\" data type mappings. To enable both MBCS and Unicode, MFC uses `TCHAR` for `char`, `LPTSTR` for `char*`, and `LPCTSTR` for `const char*`. These ensure the correct mappings for either MBCS or Unicode.  \n  \n## See Also  \n [Strings (ATL/MFC)](../atl-mfc-shared/strings-atl-mfc.md)   \n [String Manipulation](../c-runtime-library/string-manipulation-crt.md)\n\n"}