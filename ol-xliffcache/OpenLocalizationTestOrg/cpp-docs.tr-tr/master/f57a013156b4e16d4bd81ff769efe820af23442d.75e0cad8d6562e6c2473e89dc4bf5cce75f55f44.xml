{"nodes":[{"pos":[12,42],"content":"CRegKey Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CRegKey Class | Microsoft Docs","pos":[0,30]}]},{"content":"CRegKey Class","pos":[741,754]},{"content":"This class provides methods for manipulating entries in the system registry.","pos":[755,831]},{"pos":[839,949],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"content":"Syntax","pos":[958,964]},{"content":"Members","pos":[1000,1007]},{"content":"Public Constructors","pos":[1017,1036]},{"content":"Name","pos":[1043,1047]},{"content":"Description","pos":[1048,1059]},{"content":"CRegKey::CRegKey","pos":[1098,1114]},{"content":"The constructor.","pos":[1135,1151]},{"content":"CRegKey::~CRegKey","pos":[1157,1174]},{"content":"The destructor.","pos":[1200,1215]},{"content":"Public Methods","pos":[1226,1240]},{"content":"Name","pos":[1247,1251]},{"content":"Description","pos":[1252,1263]},{"content":"CRegKey::Attach","pos":[1302,1317]},{"pos":[1337,1462],"content":"Call this method to attach an HKEY to the <ph id=\"ph1\">`CRegKey`</ph> object by setting the <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept> member handle to <ph id=\"ph2\">`hKey`</ph>.","source":"Call this method to attach an HKEY to the `CRegKey` object by setting the [m_hKey](#cregkey__m_hkey) member handle to `hKey`."},{"content":"CRegKey::Close","pos":[1468,1482]},{"pos":[1501,1593],"content":"Call this method to release the <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept> member handle and set it to NULL.","source":"Call this method to release the [m_hKey](#cregkey__m_hkey) member handle and set it to NULL."},{"content":"CRegKey::Create","pos":[1599,1614]},{"pos":[1634,1729],"content":"Call this method to create the specified key, if it does not exist as a subkey of <ph id=\"ph1\">`hKeyParent`</ph>.","source":"Call this method to create the specified key, if it does not exist as a subkey of `hKeyParent`."},{"content":"CRegKey::DeleteSubKey","pos":[1735,1756]},{"content":"Call this method to remove the specified key from the registry.","pos":[1782,1845]},{"content":"CRegKey::DeleteValue","pos":[1851,1871]},{"pos":[1896,1969],"content":"Call this method to remove a value field from <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept>.","source":"Call this method to remove a value field from [m_hKey](#cregkey__m_hkey)."},{"content":"CRegKey::Detach","pos":[1975,1990]},{"pos":[2010,2133],"content":"Call this method to detach the <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept> member handle from the <ph id=\"ph1\">`CRegKey`</ph> object and set <ph id=\"ph2\">`m_hKey`</ph> to NULL.","source":"Call this method to detach the [m_hKey](#cregkey__m_hkey) member handle from the `CRegKey` object and set `m_hKey` to NULL."},{"content":"CRegKey::EnumKey","pos":[2139,2155]},{"content":"Call this method to enumerate the subkeys of the open registry key.","pos":[2176,2243]},{"content":"CRegKey::Flush","pos":[2249,2263]},{"content":"Call this method to write all of the attributes of the open registry key into the registry.","pos":[2282,2373]},{"content":"CRegKey::GetKeySecurity","pos":[2379,2402]},{"content":"Call this method to retrieve a copy of the security descriptor protecting the open registry key.","pos":[2430,2526]},{"content":"CRegKey::NotifyChangeKeyValue","pos":[2532,2561]},{"content":"This method notifies the caller about changes to the attributes or contents of the open registry key.","pos":[2595,2696]},{"content":"CRegKey::Open","pos":[2702,2715]},{"pos":[2733,2837],"content":"Call this method to open the specified key and set <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept> to the handle of this key.","source":"Call this method to open the specified key and set [m_hKey](#cregkey__m_hkey) to the handle of this key."},{"content":"CRegKey::QueryBinaryValue","pos":[2843,2868]},{"content":"Call this method to retrieve the binary data for a specified value name.","pos":[2898,2970]},{"content":"CRegKey::QueryDWORDValue","pos":[2976,3000]},{"content":"Call this method to retrieve the DWORD data for a specified value name.","pos":[3029,3100]},{"content":"CRegKey::QueryGUIDValue","pos":[3106,3129]},{"content":"Call this method to retrieve the GUID data for a specified value name.","pos":[3157,3227]},{"content":"CRegKey::QueryMultiStringValue","pos":[3233,3263]},{"content":"Call this method to retrieve the multistring data for a specified value name.","pos":[3298,3375]},{"content":"CRegKey::QueryQWORDValue","pos":[3381,3405]},{"content":"Call this method to retrieve the QWORD data for a specified value name.","pos":[3434,3505]},{"content":"CRegKey::QueryStringValue","pos":[3511,3536]},{"content":"Call this method to retrieve the string data for a specified value name.","pos":[3566,3638]},{"content":"CRegKey::QueryValue","pos":[3644,3663]},{"content":"Call this method to retrieve the data for the specified value field of <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept>.","pos":[3687,3785],"source":"Call this method to retrieve the data for the specified value field of [m_hKey](#cregkey__m_hkey)."},{"content":"Earlier versions of this method are no longer supported and are marked as <bpt id=\"p1\">**</bpt>ATL_DEPRECATED<ept id=\"p1\">**</ept>.","pos":[3786,3879],"source":" Earlier versions of this method are no longer supported and are marked as **ATL_DEPRECATED**."},{"content":"CRegKey::RecurseDeleteKey","pos":[3885,3910]},{"content":"Call this method to remove the specified key from the registry and explicitly remove any subkeys.","pos":[3940,4037]},{"content":"CRegKey::SetBinaryValue","pos":[4043,4066]},{"content":"Call this method to set the binary value of the registry key.","pos":[4094,4155]},{"content":"CRegKey::SetDWORDValue","pos":[4161,4183]},{"content":"Call this method to set the DWORD value of the registry key.","pos":[4210,4270]},{"content":"CRegKey::SetGUIDValue","pos":[4276,4297]},{"content":"Call this method to set the GUID value of the registry key.","pos":[4323,4382]},{"content":"CRegKey::SetKeySecurity","pos":[4388,4411]},{"content":"Call this method to set the security of the registry key.","pos":[4439,4496]},{"content":"CRegKey::SetKeyValue","pos":[4502,4522]},{"content":"Call this method to store data in a specified value field of a specified key.","pos":[4547,4624]},{"content":"CRegKey::SetMultiStringValue","pos":[4630,4658]},{"content":"Call this method to set the multistring value of the registry key.","pos":[4691,4757]},{"content":"CRegKey::SetQWORDValue","pos":[4763,4785]},{"content":"Call this method to set the QWORD value of the registry key.","pos":[4812,4872]},{"content":"CRegKey::SetStringValue","pos":[4878,4901]},{"content":"Call this method to set the string value of the registry key.","pos":[4929,4990]},{"content":"CRegKey::SetValue","pos":[4996,5013]},{"content":"Call this method to store data in the specified value field of <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept>.","pos":[5035,5125],"source":"Call this method to store data in the specified value field of [m_hKey](#cregkey__m_hkey)."},{"content":"Earlier versions of this method are no longer supported and are marked as <bpt id=\"p1\">**</bpt>ATL_DEPRECATED<ept id=\"p1\">**</ept>.","pos":[5126,5219],"source":" Earlier versions of this method are no longer supported and are marked as **ATL_DEPRECATED**."},{"content":"Public Operators","pos":[5230,5246]},{"content":"Name","pos":[5253,5257]},{"content":"Description","pos":[5258,5269]},{"content":"CRegKey::operator HKEY","pos":[5308,5330]},{"pos":[5357,5396],"content":"Converts a <ph id=\"ph1\">`CRegKey`</ph> object to an HKEY.","source":"Converts a `CRegKey` object to an HKEY."},{"content":"CRegKey::operator =","pos":[5402,5421]},{"content":"Assignment operator.","pos":[5446,5466]},{"content":"Public Data Members","pos":[5477,5496]},{"content":"Name","pos":[5503,5507]},{"content":"Description","pos":[5508,5519]},{"content":"CRegKey::m_hKey","pos":[5558,5573]},{"pos":[5593,5668],"content":"Contains a handle of the registry key associated with the <ph id=\"ph1\">`CRegKey`</ph> object.","source":"Contains a handle of the registry key associated with the `CRegKey` object."},{"content":"CRegKey::m_pTM","pos":[5674,5688]},{"pos":[5707,5749],"content":"Pointer to <ph id=\"ph1\">`CAtlTransactionManager`</ph> object","source":"Pointer to `CAtlTransactionManager` object"},{"content":"Remarks","pos":[5759,5766]},{"content":"provides methods for creating and deleting keys and values in the system registry.","pos":[5780,5862]},{"content":"The registry contains an installation-specific set of definitions for system components, such as software version numbers, logical-to-physical mappings of installed hardware, and COM objects.","pos":[5863,6054]},{"content":"provides a programming interface to the system registry for a given machine.","pos":[6071,6147]},{"content":"For example, to open a particular registry key, call <ph id=\"ph1\">`CRegKey::Open`</ph>.","pos":[6148,6217],"source":" For example, to open a particular registry key, call `CRegKey::Open`."},{"content":"To retrieve or modify a data value, call <ph id=\"ph1\">`CRegKey::QueryValue`</ph> or <ph id=\"ph2\">`CRegKey::SetValue`</ph>, respectively.","pos":[6218,6318],"source":" To retrieve or modify a data value, call `CRegKey::QueryValue` or `CRegKey::SetValue`, respectively."},{"content":"To close a key, call <ph id=\"ph1\">`CRegKey::Close`</ph>.","pos":[6319,6357],"source":" To close a key, call `CRegKey::Close`."},{"content":"When you close a key, its registry data is written (flushed) to the hard disk.","pos":[6364,6442]},{"content":"This process may take several seconds.","pos":[6443,6481]},{"content":"If your application must explicitly write registry data to the hard disk, you can call the <bpt id=\"p1\">[</bpt>RegFlushKey<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724867)</ept> Win32 function.","pos":[6482,6662],"source":" If your application must explicitly write registry data to the hard disk, you can call the [RegFlushKey](http://msdn.microsoft.com/library/windows/desktop/ms724867) Win32 function."},{"content":"However, <bpt id=\"p1\">**</bpt>RegFlushKey<ept id=\"p1\">**</ept> uses many system resources and should be called only when absolutely necessary.","pos":[6663,6767],"source":" However, **RegFlushKey** uses many system resources and should be called only when absolutely necessary."},{"pos":[6775,7185],"content":"[!IMPORTANT]\n Any methods that allow the caller to specify a registry location have the potential to read data that cannot be trusted. Methods that make use of [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) should take into consideration that this function does not explicitly handle strings which are NULL terminated. Both conditions should be checked for by the calling code.","leadings":["","> "],"nodes":[{"content":" Any methods that allow the caller to specify a registry location have the potential to read data that cannot be trusted. Methods that make use of [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) should take into consideration that this function does not explicitly handle strings which are NULL terminated. Both conditions should be checked for by the calling code.","pos":[13,408],"nodes":[{"content":"Any methods that allow the caller to specify a registry location have the potential to read data that cannot be trusted.","pos":[1,121]},{"content":"Methods that make use of <bpt id=\"p1\">[</bpt>RegQueryValueEx<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724911)</ept> should take into consideration that this function does not explicitly handle strings which are NULL terminated.","pos":[122,336],"source":" Methods that make use of [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) should take into consideration that this function does not explicitly handle strings which are NULL terminated."},{"content":"Both conditions should be checked for by the calling code.","pos":[337,395]}]}]},{"content":"Requirements","pos":[7194,7206]},{"pos":[7210,7231],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlbase.h","source":"**Header:** atlbase.h"},{"pos":[7273,7288],"content":"CRegKey::Attach"},{"pos":[7292,7417],"content":"Call this method to attach an HKEY to the <ph id=\"ph1\">`CRegKey`</ph> object by setting the <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept> member handle to <ph id=\"ph2\">`hKey`</ph>.","source":"Call this method to attach an HKEY to the `CRegKey` object by setting the [m_hKey](#cregkey__m_hkey) member handle to `hKey`."},{"content":"Parameters","pos":[7472,7482]},{"content":"The handle of a registry key.","pos":[7496,7525]},{"content":"Remarks","pos":[7535,7542]},{"pos":[7546,7593],"content":"<bpt id=\"p1\">**</bpt>Attach<ept id=\"p1\">**</ept> will assert if <ph id=\"ph1\">`m_hKey`</ph> is non-NULL.","source":"**Attach** will assert if `m_hKey` is non-NULL."},{"pos":[7634,7648],"content":"CRegKey::Close"},{"pos":[7652,7744],"content":"Call this method to release the <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept> member handle and set it to NULL.","source":"Call this method to release the [m_hKey](#cregkey__m_hkey) member handle and set it to NULL."},{"content":"Return Value","pos":[7789,7801]},{"content":"If successful, returns ERROR_SUCCESS; otherwise returns an error value.","pos":[7805,7876]},{"pos":[7918,7933],"content":"CRegKey::Create"},{"pos":[7937,8032],"content":"Call this method to create the specified key, if it does not exist as a subkey of <ph id=\"ph1\">`hKeyParent`</ph>.","source":"Call this method to create the specified key, if it does not exist as a subkey of `hKeyParent`."},{"content":"Parameters","pos":[8324,8334]},{"content":"The handle of an open key.","pos":[8354,8380]},{"content":"Specifies the name of a key to be created or opened.","pos":[8404,8456]},{"content":"This name must be a subkey of <ph id=\"ph1\">`hKeyParent`</ph>.","pos":[8457,8500],"source":" This name must be a subkey of `hKeyParent`."},{"content":"Specifies the class of the key to be created or opened.","pos":[8522,8577]},{"content":"The default value is REG_NONE.","pos":[8578,8608]},{"content":"Options for the key.","pos":[8630,8650]},{"content":"The default value is REG_OPTION_NON_VOLATILE.","pos":[8651,8696]},{"content":"For a list of possible values and descriptions, see <bpt id=\"p1\">[</bpt>RegCreateKeyEx<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724844)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[8697,8885],"source":" For a list of possible values and descriptions, see [RegCreateKeyEx](http://msdn.microsoft.com/library/windows/desktop/ms724844) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"The security access for the key.","pos":[8908,8940]},{"content":"The default value is KEY_READ &amp;#124; KEY_WRITE.","pos":[8941,8988],"source":" The default value is KEY_READ &#124; KEY_WRITE."},{"content":"For a list of possible values and descriptions, see <bpt id=\"p1\">**</bpt>RegCreateKeyEx<ept id=\"p1\">**</ept>.","pos":[8989,9060],"source":" For a list of possible values and descriptions, see **RegCreateKeyEx**."},{"content":"lpSecAttr","pos":[9068,9077]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>SECURITY_ATTRIBUTES<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa379560)</ept> structure that indicates whether the handle of the key can be inherited by a child process.","pos":[9082,9270],"source":" A pointer to a [SECURITY_ATTRIBUTES](http://msdn.microsoft.com/library/windows/desktop/aa379560) structure that indicates whether the handle of the key can be inherited by a child process."},{"content":"By default, this parameter is NULL (meaning the handle cannot be inherited).","pos":[9271,9347]},{"content":"lpdwDisposition","pos":[9355,9370]},{"content":"[out] If non-NULL, retrieves either REG_CREATED_NEW_KEY (if the key did not exist and was created) or REG_OPENED_EXISTING_KEY (if the key existed and was opened).","pos":[9375,9537]},{"content":"Return Value","pos":[9547,9559]},{"content":"If successful, returns ERROR_SUCCESS and opens the key.","pos":[9563,9618]},{"content":"If the method fails, the return value is a nonzero error code defined in WINERROR.H.","pos":[9619,9703]},{"content":"Remarks","pos":[9713,9720]},{"pos":[9724,9804],"content":"<bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> sets the <bpt id=\"p2\">[</bpt>m_hKey<ept id=\"p2\">](#cregkey__m_hkey)</ept> member to the handle of this key.","source":"**Create** sets the [m_hKey](#cregkey__m_hkey) member to the handle of this key."},{"pos":[9847,9863],"content":"CRegKey::CRegKey"},{"content":"The constructor.","pos":[9867,9883]},{"content":"Parameters","pos":[10041,10051]},{"content":"A reference to a <ph id=\"ph1\">`CRegKey`</ph> object.","pos":[10064,10098],"source":" A reference to a `CRegKey` object."},{"content":"A handle to a registry key.","pos":[10115,10142]},{"content":"Pointer to CAtlTransactionManager object","pos":[10158,10198]},{"content":"Remarks","pos":[10208,10215]},{"content":"Creates a new <ph id=\"ph1\">`CRegKey`</ph> object.","pos":[10219,10250],"source":"Creates a new `CRegKey` object."},{"content":"The object can be created from an existing <ph id=\"ph1\">`CRegKey`</ph> object, or from a handle to a registry key.","pos":[10251,10347],"source":" The object can be created from an existing `CRegKey` object, or from a handle to a registry key."},{"pos":[10395,10412],"content":"CRegKey::~CRegKey"},{"content":"The destructor.","pos":[10416,10431]},{"content":"Remarks","pos":[10474,10481]},{"pos":[10485,10518],"content":"The destructor releases <ph id=\"ph1\">`m_hKey`</ph>.","source":"The destructor releases `m_hKey`."},{"pos":[10566,10587],"content":"CRegKey::DeleteSubKey"},{"content":"Call this method to remove the specified key from the registry.","pos":[10591,10654]},{"content":"Parameters","pos":[10724,10734]},{"content":"Specifies the name of the key to delete.","pos":[10754,10794]},{"content":"This name must be a subkey of <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept>.","pos":[10795,10852],"source":" This name must be a subkey of [m_hKey](#cregkey__m_hkey)."},{"content":"Return Value","pos":[10862,10874]},{"content":"If successful, returns ERROR_SUCCESS.","pos":[10878,10915]},{"content":"If the method fails, the return value is a nonzero error code defined in WINERROR.H.","pos":[10916,11000]},{"content":"Remarks","pos":[11010,11017]},{"content":"can only delete a key that has no subkeys.","pos":[11036,11078]},{"content":"If the key has subkeys, call <bpt id=\"p1\">[</bpt>RecurseDeleteKey<ept id=\"p1\">](#cregkey__recursedeletekey)</ept> instead.","pos":[11079,11163],"source":" If the key has subkeys, call [RecurseDeleteKey](#cregkey__recursedeletekey) instead."},{"pos":[11210,11230],"content":"CRegKey::DeleteValue"},{"pos":[11234,11307],"content":"Call this method to remove a value field from <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept>.","source":"Call this method to remove a value field from [m_hKey](#cregkey__m_hkey)."},{"content":"Parameters","pos":[11375,11385]},{"content":"Specifies the value field to remove.","pos":[11404,11440]},{"content":"Return Value","pos":[11450,11462]},{"content":"If successful, returns ERROR_SUCCESS.","pos":[11466,11503]},{"content":"If the method fails, the return value is a nonzero error code defined in WINERROR.H.","pos":[11504,11588]},{"pos":[11630,11645],"content":"CRegKey::Detach"},{"pos":[11649,11772],"content":"Call this method to detach the <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept> member handle from the <ph id=\"ph1\">`CRegKey`</ph> object and set <ph id=\"ph2\">`m_hKey`</ph> to NULL.","source":"Call this method to detach the [m_hKey](#cregkey__m_hkey) member handle from the `CRegKey` object and set `m_hKey` to NULL."},{"content":"Return Value","pos":[11818,11830]},{"pos":[11834,11880],"content":"The HKEY associated with the <ph id=\"ph1\">`CRegKey`</ph> object.","source":"The HKEY associated with the `CRegKey` object."},{"pos":[11923,11939],"content":"CRegKey::EnumKey"},{"content":"Call this method to enumerate the subkeys of the open registry key.","pos":[11943,12010]},{"content":"Parameters","pos":[12154,12164]},{"content":"The subkey index.","pos":[12180,12197]},{"content":"This parameter should be zero for the first call and then incremented for subsequent calls","pos":[12198,12288]},{"content":"Pointer to a buffer that receives the name of the subkey, including the terminating null character.","pos":[12308,12407]},{"content":"Only the name of the subkey is copied to the buffer, not the full key hierarchy.","pos":[12408,12488]},{"content":"pnNameLength","pos":[12496,12508]},{"content":"Pointer to a variable that specifies the size, in TCHARs, of the buffer specified by the <ph id=\"ph1\">`pszName`</ph> parameter.","pos":[12513,12622],"source":" Pointer to a variable that specifies the size, in TCHARs, of the buffer specified by the `pszName` parameter."},{"content":"This size should include the terminating null character.","pos":[12623,12679]},{"content":"When the method returns, the variable pointed to by <bpt id=\"p1\">*</bpt>pnNameLength<ept id=\"p1\">*</ept> contains the number of characters stored in the buffer.","pos":[12680,12802],"source":" When the method returns, the variable pointed to by *pnNameLength* contains the number of characters stored in the buffer."},{"content":"The count returned does not include the terminating null character.","pos":[12803,12870]},{"content":"pftLastWriteTime","pos":[12878,12894]},{"content":"Pointer to a variable that receives the time the enumerated subkey was last written to.","pos":[12899,12986]},{"content":"Return Value","pos":[12996,13008]},{"content":"If the method succeeds, the return value is ERROR_SUCCESS.","pos":[13012,13070]},{"content":"If the method fails, the return value is a nonzero error code defined in WINERROR.H.","pos":[13071,13155]},{"content":"Remarks","pos":[13165,13172]},{"content":"To enumerate the subkeys, call <ph id=\"ph1\">`CRegKey::EnumKey`</ph> with an index of zero.","pos":[13176,13248],"source":"To enumerate the subkeys, call `CRegKey::EnumKey` with an index of zero."},{"content":"Increment the index value and repeat until the method returns ERROR_NO_MORE_ITEMS.","pos":[13249,13331]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>RegEnumKeyEx<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724862)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[13332,13492],"source":" For more information, see [RegEnumKeyEx](http://msdn.microsoft.com/library/windows/desktop/ms724862) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[13533,13547],"content":"CRegKey::Flush"},{"content":"Call this method to write all of the attributes of the open registry key into the registry.","pos":[13551,13642]},{"content":"Return Value","pos":[13687,13699]},{"content":"If the method succeeds, the return value is ERROR_SUCCESS.","pos":[13703,13761]},{"content":"If the method fails, the return value is a nonzero error code defined in WINERROR.H.","pos":[13762,13846]},{"content":"Remarks","pos":[13856,13863]},{"pos":[13867,14027],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegEnumFlush<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724867)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegEnumFlush](http://msdn.microsoft.com/library/windows/desktop/ms724867) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[14077,14100],"content":"CRegKey::GetKeySecurity"},{"content":"Call this method to retrieve a copy of the security descriptor protecting the open registry key.","pos":[14104,14200]},{"content":"Parameters","pos":[14328,14338]},{"content":"The <bpt id=\"p1\">[</bpt>SECURITY_INFORMATION<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa379573)</ept> value that indicates the requested security information.","pos":[14350,14493],"source":" The [SECURITY_INFORMATION](http://msdn.microsoft.com/library/windows/desktop/aa379573) value that indicates the requested security information."},{"content":"A pointer to a buffer that receives a copy of the requested security descriptor.","pos":[14509,14589]},{"content":"The size, in bytes, of the buffer pointed to by <ph id=\"ph1\">`psd`</ph>.","pos":[14609,14663],"source":" The size, in bytes, of the buffer pointed to by `psd`."},{"content":"Return Value","pos":[14673,14685]},{"content":"If the method succeeds, the return value is ERROR_SUCCESS.","pos":[14689,14747]},{"content":"If the method fails, the return value is a nonzero error code is defined in WINERROR.H.","pos":[14748,14835]},{"content":"Remarks","pos":[14845,14852]},{"pos":[14856,14962],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegGetKeySecurity<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa379313)</ept>.","source":"For more information, see [RegGetKeySecurity](http://msdn.microsoft.com/library/windows/desktop/aa379313)."},{"pos":[15004,15019],"content":"CRegKey::m_hKey"},{"pos":[15023,15098],"content":"Contains a handle of the registry key associated with the <ph id=\"ph1\">`CRegKey`</ph> object.","source":"Contains a handle of the registry key associated with the `CRegKey` object."},{"pos":[15165,15179],"content":"CRegKey::m_pTM"},{"pos":[15183,15228],"content":"Pointer to a <ph id=\"ph1\">`CAtlTransactionManager`</ph> object.","source":"Pointer to a `CAtlTransactionManager` object."},{"content":"Remarks","pos":[15282,15289]},{"pos":[15345,15374],"content":"CRegKey::NotifyChangeKeyValue"},{"content":"This method notifies the caller about changes to the attributes or contents of the open registry key.","pos":[15378,15479]},{"content":"Parameters","pos":[15626,15636]},{"content":"bWatchSubtree","pos":[15641,15654]},{"content":"Specifies a flag that indicates whether to report changes in the specified key and all of its subkeys or only in the specified key.","pos":[15659,15790]},{"content":"If this parameter is TRUE, the method reports changes in the key and its subkeys.","pos":[15791,15872]},{"content":"If the parameter is FALSE, the method reports changes only in the key.","pos":[15873,15943]},{"content":"dwNotifyFilter","pos":[15951,15965]},{"content":"Specifies a set of flags that control which changes should be reported.","pos":[15970,16041]},{"content":"This parameter can be a combination of the following values:","pos":[16042,16102]},{"content":"Value","pos":[16109,16114]},{"content":"Meaning","pos":[16115,16122]},{"content":"REG_NOTIFY_CHANGE_NAME","pos":[16157,16179]},{"content":"Notify the caller if a subkey is added or deleted.","pos":[16180,16230]},{"content":"REG_NOTIFY_CHANGE_ATTRIBUTES","pos":[16235,16263]},{"content":"Notify the caller of changes to the attributes of the key, such as the security descriptor information.","pos":[16264,16367]},{"content":"REG_NOTIFY_CHANGE_LAST_SET","pos":[16372,16398]},{"content":"Notify the caller of changes to a value of the key.","pos":[16399,16450]},{"content":"This can include adding or deleting a value, or changing an existing value.","pos":[16451,16526]},{"content":"REG_NOTIFY_CHANGE_SECURITY","pos":[16531,16557]},{"content":"Notify the caller of changes to the security descriptor of the key.","pos":[16558,16625]},{"content":"Handle to an event.","pos":[16645,16664]},{"content":"If the <bpt id=\"p1\">*</bpt>bAsync<ept id=\"p1\">*</ept> parameter is TRUE, the method returns immediately and changes are reported by signaling this event.","pos":[16665,16780],"source":" If the *bAsync* parameter is TRUE, the method returns immediately and changes are reported by signaling this event."},{"content":"If <ph id=\"ph1\">`bAsync`</ph> is FALSE, <ph id=\"ph2\">`hEvent`</ph> is ignored.","pos":[16781,16823],"source":" If `bAsync` is FALSE, `hEvent` is ignored."},{"content":"Specifies a flag that indicates how the method reports changes.","pos":[16842,16905]},{"content":"If this parameter is TRUE, the method returns immediately and reports changes by signaling the specified event.","pos":[16906,17017]},{"content":"When this parameter is FALSE, the method does not return until a change has occurred.","pos":[17018,17103]},{"content":"If <ph id=\"ph1\">`hEvent`</ph> does not specify a valid event, the <ph id=\"ph2\">`bAsync`</ph> parameter cannot be TRUE.","pos":[17104,17186],"source":" If `hEvent` does not specify a valid event, the `bAsync` parameter cannot be TRUE."},{"content":"Return Value","pos":[17196,17208]},{"content":"If the method succeeds, the return value is ERROR_SUCCESS.","pos":[17212,17270]},{"content":"If the method fails, the return value is a nonzero error code defined in WINERROR.H.","pos":[17271,17355]},{"content":"Remarks","pos":[17365,17372]},{"pos":[17380,17462],"content":"[!NOTE]\n This method does not notify the caller if the specified key is deleted.","leadings":["","> "],"nodes":[{"content":"This method does not notify the caller if the specified key is deleted.","pos":[9,80]}]},{"pos":[17469,17598],"content":"For more details and a sample program, see <bpt id=\"p1\">[</bpt>RegNotifyChangeKeyValue<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724892)</ept>.","source":"For more details and a sample program, see [RegNotifyChangeKeyValue](http://msdn.microsoft.com/library/windows/desktop/ms724892)."},{"pos":[17638,17651],"content":"CRegKey::Open"},{"pos":[17655,17759],"content":"Call this method to open the specified key and set <bpt id=\"p1\">[</bpt>m_hKey<ept id=\"p1\">](#cregkey__m_hkey)</ept> to the handle of this key.","source":"Call this method to open the specified key and set [m_hKey](#cregkey__m_hkey) to the handle of this key."},{"content":"Parameters","pos":[17889,17899]},{"content":"The handle of an open key.","pos":[17919,17945]},{"content":"Specifies the name of a key to be created or opened.","pos":[17969,18021]},{"content":"This name must be a subkey of <ph id=\"ph1\">`hKeyParent`</ph>.","pos":[18022,18065],"source":" This name must be a subkey of `hKeyParent`."},{"content":"The security access for the key.","pos":[18088,18120]},{"content":"The default value is KEY_ALL_ACCESS.","pos":[18121,18157]},{"content":"For a list of possible values and descriptions, see <bpt id=\"p1\">[</bpt>RegCreateKeyEx<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724844)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[18158,18346],"source":" For a list of possible values and descriptions, see [RegCreateKeyEx](http://msdn.microsoft.com/library/windows/desktop/ms724844) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Return Value","pos":[18356,18368]},{"content":"If successful, returns ERROR_SUCCESS; otherwise, a non-zero error value defined in WINERROR.H.","pos":[18372,18466]},{"content":"Remarks","pos":[18476,18483]},{"pos":[18487,18671],"content":"If the <ph id=\"ph1\">`lpszKeyName`</ph> parameter is NULL or points to an empty string, <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> opens a new handle of the key identified by <ph id=\"ph2\">`hKeyParent`</ph>, but does not close any previously opened handle.","source":"If the `lpszKeyName` parameter is NULL or points to an empty string, **Open** opens a new handle of the key identified by `hKeyParent`, but does not close any previously opened handle."},{"pos":[18678,18786],"content":"Unlike <bpt id=\"p1\">[</bpt>CRegKey::Create<ept id=\"p1\">](#cregkey__create)</ept>, <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> will not create the specified key if it does not exist.","source":"Unlike [CRegKey::Create](#cregkey__create), **Open** will not create the specified key if it does not exist."},{"pos":[18835,18857],"content":"CRegKey::operator HKEY"},{"pos":[18861,18900],"content":"Converts a <ph id=\"ph1\">`CRegKey`</ph> object to an HKEY.","source":"Converts a `CRegKey` object to an HKEY."},{"content":"```operator HKEY() const throw();","pos":[18906,18939]},{"content":"CRegKey&amp; operator= (CRegKey&amp; key) throw();","pos":[19043,19085],"source":"CRegKey& operator= (CRegKey& key) throw();"},{"pos":[19483,19573],"content":"LONG QueryBinaryValue(LPCTSTR pszValueName, void<bpt id=\"p1\">*</bpt> pValue, ULONG<ept id=\"p1\">*</ept> pnBytes) throw();","source":"LONG QueryBinaryValue(LPCTSTR pszValueName,\n    void* pValue,\n    ULONG* pnBytes) throw();"},{"pos":[20992,21063],"content":"LONG QueryDWORDValue(LPCTSTR pszValueName, DWORD&amp; dwValue) throw();","source":"LONG QueryDWORDValue(LPCTSTR pszValueName,\n    DWORD& dwValue) throw();"},{"pos":[22253,22324],"content":"LONG QueryGUIDValue(LPCTSTR pszValueName, GUID&amp; guidValue) throw();","source":"LONG QueryGUIDValue(LPCTSTR pszValueName,\n    GUID& guidValue) throw();"},{"pos":[23268,23366],"content":"LONG QueryMultiStringValue(LPCTSTR pszValueName, LPTSTR pszValue, ULONG* pnChars) throw();","source":"LONG QueryMultiStringValue(LPCTSTR pszValueName,\n    LPTSTR pszValue,\n    ULONG* pnChars) throw();"},{"pos":[24878,24953],"content":"LONG QueryQWORDValue(LPCTSTR pszValueName, ULONGLONG&amp; qwValue) throw();","source":"LONG QueryQWORDValue(LPCTSTR pszValueName,\n    ULONGLONG& qwValue) throw();"},{"pos":[26149,26242],"content":"LONG QueryStringValue(LPCTSTR pszValueName, LPTSTR pszValue, ULONG* pnChars) throw();","source":"LONG QueryStringValue(LPCTSTR pszValueName,\n    LPTSTR pszValue,\n    ULONG* pnChars) throw();"},{"pos":[27861,28044],"content":"LONG QueryValue(LPCTSTR pszValueName, DWORD<bpt id=\"p1\">*</bpt> pdwType, void<ept id=\"p1\">*</ept> pData, ULONG* pnBytes) throw(); ATL_DEPRECATED LONG QueryValue( DWORD&amp; dwValue, LPCTSTR lpszValueName);","source":"LONG QueryValue(LPCTSTR pszValueName,\n    DWORD* pdwType,\n    void* pData,\n    ULONG* pnBytes) throw();\nATL_DEPRECATED LONG QueryValue(\n    DWORD& dwValue,\n    LPCTSTR lpszValueName);"},{"content":"LONG RecurseDeleteKey(LPCTSTR lpszKey) throw();","pos":[30073,30120]},{"pos":[30616,30708],"content":"LONG SetBinaryValue(LPCTSTR pszValueName, const void* pValue, ULONG nBytes) throw();","source":"LONG SetBinaryValue(LPCTSTR pszValueName,\n    const void* pValue,\n    ULONG nBytes) throw();"},{"content":"LONG SetDWORDValue(LPCTSTR pszValueName,  DWORD dwValue) throw();","pos":[31565,31630]},{"content":"LONG SetGUIDValue(LPCTSTR pszValueName,  REFGUID guidValue) throw();","pos":[32355,32423]},{"pos":[33216,33319],"content":"LONG SetKeyValue(LPCTSTR lpszKeyName, LPCTSTR lpszValue, LPCTSTR lpszValueName = NULL) throw();","source":"LONG SetKeyValue(LPCTSTR lpszKeyName,\n    LPCTSTR lpszValue,\n    LPCTSTR lpszValueName = NULL) throw();"},{"content":"LONG SetKeySecurity(SECURITY_INFORMATION si,  PSECURITY_DESCRIPTOR psd) throw();","pos":[34111,34191]},{"content":"LONG SetMultiStringValue(LPCTSTR pszValueName,  LPCTSTR pszValue) throw();","pos":[36011,36085]},{"content":"LONG SetQWORDValue(LPCTSTR pszValueName,  ULONGLONG qwValue) throw();","pos":[36920,36989]},{"pos":[37720,37819],"content":"LONG SetStringValue(LPCTSTR pszValueName, LPCTSTR pszValue, DWORD dwType = REG_SZ) throw();","source":"LONG SetStringValue(LPCTSTR pszValueName,\n    LPCTSTR pszValue,\n    DWORD dwType = REG_SZ) throw();"},{"pos":[38822,39054],"content":"LONG SetValue(LPCTSTR pszValueName, DWORD dwType, const void* pValue, ULONG nBytes) throw(); static LONG WINAPI SetValue(HKEY hKeyParent, LPCTSTR lpszKeyName, LPCTSTR lpszValue, LPCTSTR lpszValueName = NULL);","source":"LONG SetValue(LPCTSTR pszValueName,\n    DWORD dwType,\n    const void* pValue,\n    ULONG nBytes) throw();\nstatic LONG WINAPI SetValue(HKEY hKeyParent,\n    LPCTSTR lpszKeyName,\n    LPCTSTR lpszValue,\n    LPCTSTR lpszValueName = NULL);"}],"content":"---\ntitle: \"CRegKey Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CRegKey\"\n  - \"ATL::CRegKey\"\n  - \"ATL.CRegKey\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CRegKey class\"\n  - \"ATL, registry\"\n  - \"registry, deleting values\"\n  - \"registry, writing to\"\n  - \"registry, deleting keys\"\nms.assetid: 3afce82b-ba2c-4c1a-8404-dc969e1af74b\ncaps.latest.revision: 25\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CRegKey Class\nThis class provides methods for manipulating entries in the system registry.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\nclass CRegKey\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRegKey::CRegKey](#cregkey__cregkey)|The constructor.|  \n|[CRegKey::~CRegKey](#cregkey___dtorcregkey)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRegKey::Attach](#cregkey__attach)|Call this method to attach an HKEY to the `CRegKey` object by setting the [m_hKey](#cregkey__m_hkey) member handle to `hKey`.|  \n|[CRegKey::Close](#cregkey__close)|Call this method to release the [m_hKey](#cregkey__m_hkey) member handle and set it to NULL.|  \n|[CRegKey::Create](#cregkey__create)|Call this method to create the specified key, if it does not exist as a subkey of `hKeyParent`.|  \n|[CRegKey::DeleteSubKey](#cregkey__deletesubkey)|Call this method to remove the specified key from the registry.|  \n|[CRegKey::DeleteValue](#cregkey__deletevalue)|Call this method to remove a value field from [m_hKey](#cregkey__m_hkey).|  \n|[CRegKey::Detach](#cregkey__detach)|Call this method to detach the [m_hKey](#cregkey__m_hkey) member handle from the `CRegKey` object and set `m_hKey` to NULL.|  \n|[CRegKey::EnumKey](#cregkey__enumkey)|Call this method to enumerate the subkeys of the open registry key.|  \n|[CRegKey::Flush](#cregkey__flush)|Call this method to write all of the attributes of the open registry key into the registry.|  \n|[CRegKey::GetKeySecurity](#cregkey__getkeysecurity)|Call this method to retrieve a copy of the security descriptor protecting the open registry key.|  \n|[CRegKey::NotifyChangeKeyValue](#cregkey__notifychangekeyvalue)|This method notifies the caller about changes to the attributes or contents of the open registry key.|  \n|[CRegKey::Open](#cregkey__open)|Call this method to open the specified key and set [m_hKey](#cregkey__m_hkey) to the handle of this key.|  \n|[CRegKey::QueryBinaryValue](#cregkey__querybinaryvalue)|Call this method to retrieve the binary data for a specified value name.|  \n|[CRegKey::QueryDWORDValue](#cregkey__querydwordvalue)|Call this method to retrieve the DWORD data for a specified value name.|  \n|[CRegKey::QueryGUIDValue](#cregkey__queryguidvalue)|Call this method to retrieve the GUID data for a specified value name.|  \n|[CRegKey::QueryMultiStringValue](#cregkey__querymultistringvalue)|Call this method to retrieve the multistring data for a specified value name.|  \n|[CRegKey::QueryQWORDValue](#cregkey__queryqwordvalue)|Call this method to retrieve the QWORD data for a specified value name.|  \n|[CRegKey::QueryStringValue](#cregkey__querystringvalue)|Call this method to retrieve the string data for a specified value name.|  \n|[CRegKey::QueryValue](#cregkey__queryvalue)|Call this method to retrieve the data for the specified value field of [m_hKey](#cregkey__m_hkey). Earlier versions of this method are no longer supported and are marked as **ATL_DEPRECATED**.|  \n|[CRegKey::RecurseDeleteKey](#cregkey__recursedeletekey)|Call this method to remove the specified key from the registry and explicitly remove any subkeys.|  \n|[CRegKey::SetBinaryValue](#cregkey__setbinaryvalue)|Call this method to set the binary value of the registry key.|  \n|[CRegKey::SetDWORDValue](#cregkey__setdwordvalue)|Call this method to set the DWORD value of the registry key.|  \n|[CRegKey::SetGUIDValue](#cregkey__setguidvalue)|Call this method to set the GUID value of the registry key.|  \n|[CRegKey::SetKeySecurity](#cregkey__setkeysecurity)|Call this method to set the security of the registry key.|  \n|[CRegKey::SetKeyValue](#cregkey__setkeyvalue)|Call this method to store data in a specified value field of a specified key.|  \n|[CRegKey::SetMultiStringValue](#cregkey__setmultistringvalue)|Call this method to set the multistring value of the registry key.|  \n|[CRegKey::SetQWORDValue](#cregkey__setqwordvalue)|Call this method to set the QWORD value of the registry key.|  \n|[CRegKey::SetStringValue](#cregkey__setstringvalue)|Call this method to set the string value of the registry key.|  \n|[CRegKey::SetValue](#cregkey__setvalue)|Call this method to store data in the specified value field of [m_hKey](#cregkey__m_hkey). Earlier versions of this method are no longer supported and are marked as **ATL_DEPRECATED**.|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRegKey::operator HKEY](#cregkey__operator_hkey)|Converts a `CRegKey` object to an HKEY.|  \n|[CRegKey::operator =](#cregkey__operator_eq)|Assignment operator.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CRegKey::m_hKey](#cregkey__m_hkey)|Contains a handle of the registry key associated with the `CRegKey` object.|  \n|[CRegKey::m_pTM](#cregkey__m_ptm)|Pointer to `CAtlTransactionManager` object|  \n  \n## Remarks  \n `CRegKey` provides methods for creating and deleting keys and values in the system registry. The registry contains an installation-specific set of definitions for system components, such as software version numbers, logical-to-physical mappings of installed hardware, and COM objects.  \n  \n `CRegKey` provides a programming interface to the system registry for a given machine. For example, to open a particular registry key, call `CRegKey::Open`. To retrieve or modify a data value, call `CRegKey::QueryValue` or `CRegKey::SetValue`, respectively. To close a key, call `CRegKey::Close`.  \n  \n When you close a key, its registry data is written (flushed) to the hard disk. This process may take several seconds. If your application must explicitly write registry data to the hard disk, you can call the [RegFlushKey](http://msdn.microsoft.com/library/windows/desktop/ms724867) Win32 function. However, **RegFlushKey** uses many system resources and should be called only when absolutely necessary.  \n  \n> [!IMPORTANT]\n>  Any methods that allow the caller to specify a registry location have the potential to read data that cannot be trusted. Methods that make use of [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) should take into consideration that this function does not explicitly handle strings which are NULL terminated. Both conditions should be checked for by the calling code.  \n  \n## Requirements  \n **Header:** atlbase.h  \n  \n##  <a name=\"cregkey__attach\"></a>  CRegKey::Attach  \n Call this method to attach an HKEY to the `CRegKey` object by setting the [m_hKey](#cregkey__m_hkey) member handle to `hKey`.  \n  \n```\nvoid Attach(HKEY hKey) throw();\n```  \n  \n### Parameters  \n `hKey`  \n The handle of a registry key.  \n  \n### Remarks  \n **Attach** will assert if `m_hKey` is non-NULL.  \n  \n##  <a name=\"cregkey__close\"></a>  CRegKey::Close  \n Call this method to release the [m_hKey](#cregkey__m_hkey) member handle and set it to NULL.  \n  \n```\nLONG Close() throw();\n```  \n  \n### Return Value  \n If successful, returns ERROR_SUCCESS; otherwise returns an error value.  \n  \n##  <a name=\"cregkey__create\"></a>  CRegKey::Create  \n Call this method to create the specified key, if it does not exist as a subkey of `hKeyParent`.  \n  \n```\nLONG Create(HKEY hKeyParent,\n    LPCTSTR lpszKeyName,\n    LPTSTR lpszClass = REG_NONE,\n    DWORD dwOptions = REG_OPTION_NON_VOLATILE,\n    REGSAM samDesired = KEY_READ | KEY_WRITE,\n    LPSECURITY_ATTRIBUTES lpSecAttr = NULL,\n    LPDWORD lpdwDisposition = NULL) throw();\n```  \n  \n### Parameters  \n `hKeyParent`  \n The handle of an open key.  \n  \n `lpszKeyName`  \n Specifies the name of a key to be created or opened. This name must be a subkey of `hKeyParent`.  \n  \n `lpszClass`  \n Specifies the class of the key to be created or opened. The default value is REG_NONE.  \n  \n `dwOptions`  \n Options for the key. The default value is REG_OPTION_NON_VOLATILE. For a list of possible values and descriptions, see [RegCreateKeyEx](http://msdn.microsoft.com/library/windows/desktop/ms724844) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n `samDesired`  \n The security access for the key. The default value is KEY_READ &#124; KEY_WRITE. For a list of possible values and descriptions, see **RegCreateKeyEx**.  \n  \n *lpSecAttr*  \n A pointer to a [SECURITY_ATTRIBUTES](http://msdn.microsoft.com/library/windows/desktop/aa379560) structure that indicates whether the handle of the key can be inherited by a child process. By default, this parameter is NULL (meaning the handle cannot be inherited).  \n  \n *lpdwDisposition*  \n [out] If non-NULL, retrieves either REG_CREATED_NEW_KEY (if the key did not exist and was created) or REG_OPENED_EXISTING_KEY (if the key existed and was opened).  \n  \n### Return Value  \n If successful, returns ERROR_SUCCESS and opens the key. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n **Create** sets the [m_hKey](#cregkey__m_hkey) member to the handle of this key.  \n  \n##  <a name=\"cregkey__cregkey\"></a>  CRegKey::CRegKey  \n The constructor.  \n  \n```\nCRegKey() throw();\nCRegKey(CRegKey& key) throw();\nexplicit CRegKey(HKEY   hKey) throw();\nCRegKey(CAtlTransactionManager* pTM) throw();\n```  \n  \n### Parameters  \n `key`  \n A reference to a `CRegKey` object.  \n  \n `hKey`  \n A handle to a registry key.  \n  \n `pTM`  \n Pointer to CAtlTransactionManager object  \n  \n### Remarks  \n Creates a new `CRegKey` object. The object can be created from an existing `CRegKey` object, or from a handle to a registry key.  \n  \n##  <a name=\"cregkey___dtorcregkey\"></a>  CRegKey::~CRegKey  \n The destructor.  \n  \n```\n~CRegKey() throw();\n```  \n  \n### Remarks  \n The destructor releases `m_hKey`.  \n  \n##  <a name=\"cregkey__deletesubkey\"></a>  CRegKey::DeleteSubKey  \n Call this method to remove the specified key from the registry.  \n  \n```\nLONG DeleteSubKey(LPCTSTR lpszSubKey) throw();\n```  \n  \n### Parameters  \n `lpszSubKey`  \n Specifies the name of the key to delete. This name must be a subkey of [m_hKey](#cregkey__m_hkey).  \n  \n### Return Value  \n If successful, returns ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n `DeleteSubKey` can only delete a key that has no subkeys. If the key has subkeys, call [RecurseDeleteKey](#cregkey__recursedeletekey) instead.  \n  \n##  <a name=\"cregkey__deletevalue\"></a>  CRegKey::DeleteValue  \n Call this method to remove a value field from [m_hKey](#cregkey__m_hkey).  \n  \n```\nLONG DeleteValue(LPCTSTR lpszValue) throw();\n```  \n  \n### Parameters  \n `lpszValue`  \n Specifies the value field to remove.  \n  \n### Return Value  \n If successful, returns ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n##  <a name=\"cregkey__detach\"></a>  CRegKey::Detach  \n Call this method to detach the [m_hKey](#cregkey__m_hkey) member handle from the `CRegKey` object and set `m_hKey` to NULL.  \n  \n```\nHKEY Detach() throw();\n```  \n  \n### Return Value  \n The HKEY associated with the `CRegKey` object.  \n  \n##  <a name=\"cregkey__enumkey\"></a>  CRegKey::EnumKey  \n Call this method to enumerate the subkeys of the open registry key.  \n  \n```\nLONG EnumKey(DWORD iIndex,\n    LPTSTR pszName,\n    LPDWORD pnNameLength,\n    FILETIME* pftLastWriteTime = NULL) throw();\n```  \n  \n### Parameters  \n `iIndex`  \n The subkey index. This parameter should be zero for the first call and then incremented for subsequent calls  \n  \n `pszName`  \n Pointer to a buffer that receives the name of the subkey, including the terminating null character. Only the name of the subkey is copied to the buffer, not the full key hierarchy.  \n  \n *pnNameLength*  \n Pointer to a variable that specifies the size, in TCHARs, of the buffer specified by the `pszName` parameter. This size should include the terminating null character. When the method returns, the variable pointed to by *pnNameLength* contains the number of characters stored in the buffer. The count returned does not include the terminating null character.  \n  \n *pftLastWriteTime*  \n Pointer to a variable that receives the time the enumerated subkey was last written to.  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n To enumerate the subkeys, call `CRegKey::EnumKey` with an index of zero. Increment the index value and repeat until the method returns ERROR_NO_MORE_ITEMS. For more information, see [RegEnumKeyEx](http://msdn.microsoft.com/library/windows/desktop/ms724862) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"cregkey__flush\"></a>  CRegKey::Flush  \n Call this method to write all of the attributes of the open registry key into the registry.  \n  \n```\nLONG Flush() throw();\n```  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n For more information, see [RegEnumFlush](http://msdn.microsoft.com/library/windows/desktop/ms724867) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"cregkey__getkeysecurity\"></a>  CRegKey::GetKeySecurity  \n Call this method to retrieve a copy of the security descriptor protecting the open registry key.  \n  \n```\nLONG GetKeySecurity(SECURITY_INFORMATION si,\n    PSECURITY_DESCRIPTOR psd,\n    LPDWORD pnBytes) throw();\n```  \n  \n### Parameters  \n `si`  \n The [SECURITY_INFORMATION](http://msdn.microsoft.com/library/windows/desktop/aa379573) value that indicates the requested security information.  \n  \n `psd`  \n A pointer to a buffer that receives a copy of the requested security descriptor.  \n  \n `pnBytes`  \n The size, in bytes, of the buffer pointed to by `psd`.  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code is defined in WINERROR.H.  \n  \n### Remarks  \n For more information, see [RegGetKeySecurity](http://msdn.microsoft.com/library/windows/desktop/aa379313).  \n  \n##  <a name=\"cregkey__m_hkey\"></a>  CRegKey::m_hKey  \n Contains a handle of the registry key associated with the `CRegKey` object.  \n  \n```\nHKEY m_hKey;\n```  \n  \n##  <a name=\"cregkey__m_ptm\"></a>  CRegKey::m_pTM  \n Pointer to a `CAtlTransactionManager` object.  \n  \n```\nCAtlTransactionManager* m_pTM;\n```  \n  \n### Remarks  \n  \n##  <a name=\"cregkey__notifychangekeyvalue\"></a>  CRegKey::NotifyChangeKeyValue  \n This method notifies the caller about changes to the attributes or contents of the open registry key.  \n  \n```\nLONG NotifyChangeKeyValue(BOOL bWatchSubtree,\n    DWORD dwNotifyFilter,\n    HANDLE hEvent,\n    BOOL bAsync = TRUE) throw();\n```  \n  \n### Parameters  \n *bWatchSubtree*  \n Specifies a flag that indicates whether to report changes in the specified key and all of its subkeys or only in the specified key. If this parameter is TRUE, the method reports changes in the key and its subkeys. If the parameter is FALSE, the method reports changes only in the key.  \n  \n *dwNotifyFilter*  \n Specifies a set of flags that control which changes should be reported. This parameter can be a combination of the following values:  \n  \n|Value|Meaning|  \n|-----------|-------------|  \n|REG_NOTIFY_CHANGE_NAME|Notify the caller if a subkey is added or deleted.|  \n|REG_NOTIFY_CHANGE_ATTRIBUTES|Notify the caller of changes to the attributes of the key, such as the security descriptor information.|  \n|REG_NOTIFY_CHANGE_LAST_SET|Notify the caller of changes to a value of the key. This can include adding or deleting a value, or changing an existing value.|  \n|REG_NOTIFY_CHANGE_SECURITY|Notify the caller of changes to the security descriptor of the key.|  \n  \n `hEvent`  \n Handle to an event. If the *bAsync* parameter is TRUE, the method returns immediately and changes are reported by signaling this event. If `bAsync` is FALSE, `hEvent` is ignored.  \n  \n `bAsync`  \n Specifies a flag that indicates how the method reports changes. If this parameter is TRUE, the method returns immediately and reports changes by signaling the specified event. When this parameter is FALSE, the method does not return until a change has occurred. If `hEvent` does not specify a valid event, the `bAsync` parameter cannot be TRUE.  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n  \n> [!NOTE]\n>  This method does not notify the caller if the specified key is deleted.  \n  \n For more details and a sample program, see [RegNotifyChangeKeyValue](http://msdn.microsoft.com/library/windows/desktop/ms724892).  \n  \n##  <a name=\"cregkey__open\"></a>  CRegKey::Open  \n Call this method to open the specified key and set [m_hKey](#cregkey__m_hkey) to the handle of this key.  \n  \n```\nLONG Open(HKEY hKeyParent,\n    LPCTSTR lpszKeyName,\n    REGSAM samDesired = KEY_READ | KEY_WRITE) throw();\n```  \n  \n### Parameters  \n `hKeyParent`  \n The handle of an open key.  \n  \n `lpszKeyName`  \n Specifies the name of a key to be created or opened. This name must be a subkey of `hKeyParent`.  \n  \n `samDesired`  \n The security access for the key. The default value is KEY_ALL_ACCESS. For a list of possible values and descriptions, see [RegCreateKeyEx](http://msdn.microsoft.com/library/windows/desktop/ms724844) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Return Value  \n If successful, returns ERROR_SUCCESS; otherwise, a non-zero error value defined in WINERROR.H.  \n  \n### Remarks  \n If the `lpszKeyName` parameter is NULL or points to an empty string, **Open** opens a new handle of the key identified by `hKeyParent`, but does not close any previously opened handle.  \n  \n Unlike [CRegKey::Create](#cregkey__create), **Open** will not create the specified key if it does not exist.  \n  \n##  <a name=\"cregkey__operator_hkey\"></a>  CRegKey::operator HKEY  \n Converts a `CRegKey` object to an HKEY.  \n  \n```operator HKEY() const throw();\n```  \n  \n##  <a name=\"cregkey__operator_eq\"></a>  CRegKey::operator =  \n Assignment operator.  \n  \n```\nCRegKey& operator= (CRegKey& key) throw();\n```  \n  \n### Parameters  \n `key`  \n The key to copy.  \n  \n### Return Value  \n Returns a reference to the new key.  \n  \n### Remarks  \n This operator detaches `key` from its current object and assigns it to the `CRegKey` object instead.  \n  \n##  <a name=\"cregkey__querybinaryvalue\"></a>  CRegKey::QueryBinaryValue  \n Call this method to retrieve the binary data for a specified value name.  \n  \n```\nLONG QueryBinaryValue(LPCTSTR pszValueName,\n    void* pValue,\n    ULONG* pnBytes) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a null-terminated string containing the name of the value to query.  \n  \n `pValue`  \n Pointer to a buffer that receives the value's data.  \n  \n `pnBytes`  \n Pointer to a variable that specifies the size, in bytes, of the buffer pointed to by the `pValue` parameter. When the method returns, this variable contains the size of the data copied to the buffer.  \n  \n### Return Value  \n If the method succeeds, ERROR_SUCCESS is returned. If the method fails to read a value, it returns a nonzero error code defined in WINERROR.H. If the data referenced is not of type REG_BINARY, ERROR_INVALID_DATA is returned.  \n  \n### Remarks  \n This method makes use of **RegQueryValueEx** and confirms that the correct type of data is returned. See [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) for more details.  \n  \n> [!IMPORTANT]\n>  This method allows the caller to specify any registry location, potentially reading data which cannot be trusted. Also, the [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) function used by this method does not explicitly handle strings which are NULL terminated. Both conditions should be checked for by the calling code.  \n  \n##  <a name=\"cregkey__querydwordvalue\"></a>  CRegKey::QueryDWORDValue  \n Call this method to retrieve the DWORD data for a specified value name.  \n  \n```\nLONG QueryDWORDValue(LPCTSTR pszValueName,\n    DWORD& dwValue) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a null-terminated string containing the name of the value to query.  \n  \n `dwValue`  \n Pointer to a buffer that receives the DWORD.  \n  \n### Return Value  \n If the method succeeds, ERROR_SUCCESS is returned. If the method fails to read a value, it returns a nonzero error code defined in WINERROR.H. If the data referenced is not of type REG_DWORD, ERROR_INVALID_DATA is returned.  \n  \n### Remarks  \n This method makes use of **RegQueryValueEx** and confirms that the correct type of data is returned. See [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) for more details.  \n  \n> [!IMPORTANT]\n>  This method allows the caller to specify any registry location, potentially reading data which cannot be trusted. Also, the [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) function used by this method does not explicitly handle strings which are NULL terminated. Both conditions should be checked for by the calling code.  \n  \n##  <a name=\"cregkey__queryguidvalue\"></a>  CRegKey::QueryGUIDValue  \n Call this method to retrieve the GUID data for a specified value name.  \n  \n```\nLONG QueryGUIDValue(LPCTSTR pszValueName,\n    GUID& guidValue) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a null-terminated string containing the name of the value to query.  \n  \n `guidValue`  \n Pointer to a variable that receives the GUID.  \n  \n### Return Value  \n If the method succeeds, ERROR_SUCCESS is returned. If the method fails to read a value, it returns a nonzero error code defined in WINERROR.H. If the data referenced is not a valid GUID, ERROR_INVALID_DATA is returned.  \n  \n### Remarks  \n This method makes use of `CRegKey::QueryStringValue` and converts the string into a GUID using [CLSIDFromString](http://msdn.microsoft.com/library/windows/desktop/ms680589).  \n  \n> [!IMPORTANT]\n>  This method allows the caller to specify any registry location, potentially reading data which cannot be trusted.  \n  \n##  <a name=\"cregkey__querymultistringvalue\"></a>  CRegKey::QueryMultiStringValue  \n Call this method to retrieve the multistring data for a specified value name.  \n  \n```\nLONG QueryMultiStringValue(LPCTSTR pszValueName,\n    LPTSTR pszValue,\n    ULONG* pnChars) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a null-terminated string containing the name of the value to query.  \n  \n `pszValue`  \n Pointer to a buffer that receives the multistring data. A multistring is an array of null-terminated strings, terminated by two null characters.  \n  \n `pnChars`  \n The size, in TCHARs, of the buffer pointed to by `pszValue`. When the method returns, `pnChars` contains the size, in TCHARs, of the multistring retrieved, including a terminating null character.  \n  \n### Return Value  \n If the method succeeds, ERROR_SUCCESS is returned. If the method fails to read a value, it returns a nonzero error code defined in WINERROR.H. If the data referenced is not of type REG_MULTI_SZ, ERROR_INVALID_DATA is returned.  \n  \n### Remarks  \n This method makes use of **RegQueryValueEx** and confirms that the correct type of data is returned. See [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) for more details.  \n  \n> [!IMPORTANT]\n>  This method allows the caller to specify any registry location, potentially reading data which cannot be trusted. Also, the [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) function used by this method does not explicitly handle strings which are NULL terminated. Both conditions should be checked for by the calling code.  \n  \n##  <a name=\"cregkey__queryqwordvalue\"></a>  CRegKey::QueryQWORDValue  \n Call this method to retrieve the QWORD data for a specified value name.  \n  \n```\nLONG QueryQWORDValue(LPCTSTR pszValueName,\n    ULONGLONG& qwValue) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a null-terminated string containing the name of the value to query.  \n  \n `qwValue`  \n Pointer to a buffer that receives the QWORD.  \n  \n### Return Value  \n If the method succeeds, ERROR_SUCCESS is returned. If the method fails to read a value, it returns a nonzero error code defined in WINERROR.H. If the data referenced is not of type REG_QWORD, ERROR_INVALID_DATA is returned.  \n  \n### Remarks  \n This method makes use of **RegQueryValueEx** and confirms that the correct type of data is returned. See [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) for more details.  \n  \n> [!IMPORTANT]\n>  This method allows the caller to specify any registry location, potentially reading data which cannot be trusted. Also, the [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) function used by this method does not explicitly handle strings which are NULL terminated. Both conditions should be checked for by the calling code.  \n  \n##  <a name=\"cregkey__querystringvalue\"></a>  CRegKey::QueryStringValue  \n Call this method to retrieve the string data for a specified value name.  \n  \n```\nLONG QueryStringValue(LPCTSTR pszValueName,\n    LPTSTR pszValue,\n    ULONG* pnChars) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a null-terminated string containing the name of the value to query.  \n  \n `pszValue`  \n Pointer to a buffer that receives the string data.  \n  \n `pnChars`  \n The size, in TCHARs, of the buffer pointed to by `pszValue`. When the method returns, `pnChars` contains the size, in TCHARs, of the string retrieved, including a terminating null character.  \n  \n### Return Value  \n If the method succeeds, ERROR_SUCCESS is returned. If the method fails to read a value, it returns a nonzero error code defined in WINERROR.H. If the data referenced is not of type REG_SZ, ERROR_INVALID_DATA is returned. If the method returns ERROR_MORE_DATA, `pnChars` equals zero, not the required buffer size in bytes.  \n  \n### Remarks  \n This method makes use of **RegQueryValueEx** and confirms that the correct type of data is returned. See [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) for more details.  \n  \n> [!IMPORTANT]\n>  This method allows the caller to specify any registry location, potentially reading data which cannot be trusted. Also, the [RegQueryValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724911) function used by this method does not explicitly handle strings which are NULL terminated. Both conditions should be checked for by the calling code.  \n  \n##  <a name=\"cregkey__queryvalue\"></a>  CRegKey::QueryValue  \n Call this method to retrieve the data for the specified value field of [m_hKey](#cregkey__m_hkey). Earlier versions of this method are no longer supported and are marked as **ATL_DEPRECATED**.  \n  \n```\nLONG QueryValue(LPCTSTR pszValueName,\n    DWORD* pdwType,\n    void* pData,\n    ULONG* pnBytes) throw();\nATL_DEPRECATED LONG QueryValue(\n    DWORD& dwValue,\n    LPCTSTR lpszValueName);\n\n    ATL_DEPRECATED LONG QueryValue(LPTSTR szValue,\n    LPCTSTR lpszValueName,\n    DWORD* pdwCount);\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a null-terminated string containing the name of the value to query. If `pszValueName` is NULL or an empty string, \"\", the method retrieves the type and data for the key's unnamed or default value, if any.  \n  \n `pdwType`  \n Pointer to a variable that receives a code indicating the type of data stored in the specified value. The `pdwType` parameter can be NULL if the type code is not required.  \n  \n `pData`  \n Pointer to a buffer that receives the value's data. This parameter can be NULL if the data is not required.  \n  \n `pnBytes`  \n Pointer to a variable that specifies the size, in bytes, of the buffer pointed to by the `pData` parameter. When the method returns, this variable contains the size of the data copied to *pData.*  \n  \n `dwValue`  \n The value field's numerical data.  \n  \n `lpszValueName`  \n Specifies the value field to be queried.  \n  \n `szValue`  \n The value field's string data.  \n  \n `pdwCount`  \n The size of the string data. Its value is initially set to the size of the `szValue` buffer.  \n  \n### Return Value  \n If successful, returns ERROR_SUCCESS; otherwise, a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n The two original versions of `QueryValue` are no longer supported and are marked as **ATL_DEPRECATED**. The compiler will issue a warning if these forms are used.  \n  \n The remaining method calls RegQueryValueEx.  \n  \n> [!IMPORTANT]\n>  This method allows the caller to specify any registry location, potentially reading data which cannot be trusted. Also, the RegQueryValueEx function used by this method does not explicitly handle strings which are `NULL` terminated. Both conditions should be checked for by the calling code.  \n  \n##  <a name=\"cregkey__recursedeletekey\"></a>  CRegKey::RecurseDeleteKey  \n Call this method to remove the specified key from the registry and explicitly remove any subkeys.  \n  \n```\nLONG RecurseDeleteKey(LPCTSTR lpszKey) throw();\n```  \n  \n### Parameters  \n *lpszKey*  \n Specifies the name of the key to delete. This name must be a subkey of [m_hKey](#cregkey__m_hkey).  \n  \n### Return Value  \n If successful, returns ERROR_SUCCESS; otherwise, a non-zero error value defined in WINERROR.H.  \n  \n### Remarks  \n If the key has subkeys, you must call this method to delete the key.  \n  \n##  <a name=\"cregkey__setbinaryvalue\"></a>  CRegKey::SetBinaryValue  \n Call this method to set the binary value of the registry key.  \n  \n```\nLONG SetBinaryValue(LPCTSTR pszValueName,\n    const void* pValue,\n    ULONG nBytes) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a string containing the name of the value to set. If a value with this name is not already present, the method adds it to the key.  \n  \n `pValue`  \n Pointer to a buffer containing the data to be stored with the specified value name.  \n  \n `nBytes`  \n Specifies the size, in bytes, of the information pointed to by the `pValue` parameter.  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n This method uses [RegSetValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724923) to write the value to the registry.  \n  \n##  <a name=\"cregkey__setdwordvalue\"></a>  CRegKey::SetDWORDValue  \n Call this method to set the DWORD value of the registry key.  \n  \n```\nLONG SetDWORDValue(LPCTSTR pszValueName,  DWORD dwValue) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a string containing the name of the value to set. If a value with this name is not already present, the method adds it to the key.  \n  \n `dwValue`  \n The DWORD data to be stored with the specified value name.  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n This method uses [RegSetValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724923) to write the value to the registry.  \n  \n##  <a name=\"cregkey__setguidvalue\"></a>  CRegKey::SetGUIDValue  \n Call this method to set the GUID value of the registry key.  \n  \n```\nLONG SetGUIDValue(LPCTSTR pszValueName,  REFGUID guidValue) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a string containing the name of the value to set. If a value with this name is not already present, the method adds it to the key.  \n  \n `guidValue`  \n Reference to the GUID to be stored with the specified value name.  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n This method makes use of `CRegKey::SetStringValue` and converts the GUID into a string using [StringFromGUID2](http://msdn.microsoft.com/library/windows/desktop/ms683893).  \n  \n##  <a name=\"cregkey__setkeyvalue\"></a>  CRegKey::SetKeyValue  \n Call this method to store data in a specified value field of a specified key.  \n  \n```\nLONG SetKeyValue(LPCTSTR lpszKeyName,\n    LPCTSTR lpszValue,\n    LPCTSTR lpszValueName = NULL) throw();\n```  \n  \n### Parameters  \n `lpszKeyName`  \n Specifies the name of the key to be created or opened. This name must be a subkey of [m_hKey](#cregkey__m_hkey).  \n  \n `lpszValue`  \n Specifies the data to be stored. This parameter must be non-NULL.  \n  \n `lpszValueName`  \n Specifies the value field to be set. If a value field with this name does not already exist in the key, it is added.  \n  \n### Return Value  \n If successful, returns ERROR_SUCCESS; otherwise, a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n Call this method to create or open the `lpszKeyName` key and store the `lpszValue` data in the `lpszValueName` value field.  \n  \n##  <a name=\"cregkey__setkeysecurity\"></a>  CRegKey::SetKeySecurity  \n Call this method to set the security of the registry key.  \n  \n```\nLONG SetKeySecurity(SECURITY_INFORMATION si,  PSECURITY_DESCRIPTOR psd) throw();\n```  \n  \n### Parameters  \n `si`  \n Specifies the components of the security descriptor to set. The value can be a combination of the following values:  \n  \n|Value|Meaning|  \n|-----------|-------------|  \n|DACL_SECURITY_INFORMATION|Sets the key's discretionary access-control list (DACL). The key must have WRITE_DAC access, or the calling process must be the object's owner.|  \n|GROUP_SECURITY_INFORMATION|Sets the key's primary group security identifier (SID). The key must have WRITE_OWNER access, or the calling process must be the object's owner.|  \n|OWNER_SECURITY_INFORMATION|Sets the key's owner SID. The key must have WRITE_OWNER access, or the calling process must be the object's owner or have the SE_TAKE_OWNERSHIP_NAME privilege enabled.|  \n|SACL_SECURITY_INFORMATION|Sets the key's system access-control list (SACL). The key must have ACCESS_SYSTEM_SECURITY access. The proper way to get this access is to enable the SE_SECURITY_NAME [privilege](http://msdn.microsoft.com/library/windows/desktop/aa379306) in the caller's current access token, open the handle for ACCESS_SYSTEM_SECURITY access, and then disable the privilege.|  \n  \n `psd`  \n Pointer to a [SECURITY_DESCRIPTOR](http://msdn.microsoft.com/library/windows/desktop/aa379561) structure that specifies the security attributes to set for the specified key.  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n Sets the key's security attributes. See [RegSetKeySecurity](http://msdn.microsoft.com/library/windows/desktop/aa379314) for more details.  \n  \n##  <a name=\"cregkey__setmultistringvalue\"></a>  CRegKey::SetMultiStringValue  \n Call this method to set the multistring value of the registry key.  \n  \n```\nLONG SetMultiStringValue(LPCTSTR pszValueName,  LPCTSTR pszValue) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a string containing the name of the value to set. If a value with this name is not already present, the method adds it to the key.  \n  \n `pszValue`  \n Pointer to the multistring data to be stored with the specified value name. A multistring is an array of null-terminated strings, terminated by two null characters.  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n This method uses [RegSetValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724923) to write the value to the registry.  \n  \n##  <a name=\"cregkey__setqwordvalue\"></a>  CRegKey::SetQWORDValue  \n Call this method to set the QWORD value of the registry key.  \n  \n```\nLONG SetQWORDValue(LPCTSTR pszValueName,  ULONGLONG qwValue) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a string containing the name of the value to set. If a value with this name is not already present, the method adds it to the key.  \n  \n `qwValue`  \n The QWORD data to be stored with the specified value name.  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n This method uses [RegSetValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724923) to write the value to the registry.  \n  \n##  <a name=\"cregkey__setstringvalue\"></a>  CRegKey::SetStringValue  \n Call this method to set the string value of the registry key.  \n  \n```\nLONG SetStringValue(LPCTSTR pszValueName,\n    LPCTSTR pszValue,\n    DWORD dwType = REG_SZ) throw();\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a string containing the name of the value to set. If a value with this name is not already present, the method adds it to the key.  \n  \n `pszValue`  \n Pointer to the string data to be stored with the specified value name.  \n  \n `dwType`  \n The type of the string to write to the registry: either REG_SZ (the default) or REG_EXPAND_SZ (for multistrings).  \n  \n### Return Value  \n If the method succeeds, the return value is ERROR_SUCCESS. If the method fails, the return value is a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n This method uses [RegSetValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724923\\(v=vs.85\\).aspx) to write the value to the registry.  \n  \n##  <a name=\"cregkey__setvalue\"></a>  CRegKey::SetValue  \n Call this method to store data in the specified value field of [m_hKey](#cregkey__m_hkey). Earlier versions of this method are no longer supported and are marked as **ATL_DEPRECATED**.  \n  \n```\nLONG SetValue(LPCTSTR pszValueName,\n    DWORD dwType,\n    const void* pValue,\n    ULONG nBytes) throw();\nstatic LONG WINAPI SetValue(HKEY hKeyParent,\n    LPCTSTR lpszKeyName,\n    LPCTSTR lpszValue,\n    LPCTSTR lpszValueName = NULL);\n\n    ATL_DEPRECATED LONG SetValue(DWORD dwValue,\n    LPCTSTR lpszValueName);\n\n    ATL_DEPRECATED LONG SetValue(LPCTSTR lpszValue,\n    LPCTSTR lpszValueName = NULL,\n    bool bMulti = false,\n    int nValueLen = -1);\n```  \n  \n### Parameters  \n `pszValueName`  \n Pointer to a string containing the name of the value to set. If a value with this name is not already present in the key, the method adds it to the key. If `pszValueName` is NULL or an empty string, \"\", the method sets the type and data for the key's unnamed or default value.  \n  \n `dwType`  \n Specifies a code indicating the type of data pointed to by the `pValue` parameter.  \n  \n `pValue`  \n Pointer to a buffer containing the data to be stored with the specified value name.  \n  \n `nBytes`  \n Specifies the size, in bytes, of the information pointed to by the `pValue` parameter. If the data is of type REG_SZ, REG_EXPAND_SZ, or REG_MULTI_SZ, `nBytes` must include the size of the terminating null character.  \n  \n `hKeyParent`  \n The handle of an open key.  \n  \n `lpszKeyName`  \n Specifies the name of a key to be created or opened. This name must be a subkey of `hKeyParent`.  \n  \n `lpszValue`  \n Specifies the data to be stored. This parameter must be non-NULL.  \n  \n `lpszValueName`  \n Specifies the value field to be set. If a value field with this name does not already exist in the key, it is added.  \n  \n `dwValue`  \n Specifies the data to be stored.  \n  \n `bMulti`  \n If false, indicates the string is of type REG_SZ. If true, indicates the string is a multistring of type REG_MULTI_SZ.  \n  \n `nValueLen`  \n If `bMulti` is true, `nValueLen` is the length of the *lpszValue* string in characters. If `bMulti` is false, a value of -1 indicates that the method will calculate the length automatically.  \n  \n### Return Value  \n If successful, returns ERROR_SUCCESS; otherwise, a nonzero error code defined in WINERROR.H.  \n  \n### Remarks  \n The two original versions of `SetValue` are marked as **ATL_DEPRECATED** and should no longer be used. The compiler will issue a warning if these forms are used.  \n  \n The third method calls [RegSetValueEx](http://msdn.microsoft.com/library/windows/desktop/ms724923).  \n  \n## See Also  \n [DCOM Sample](../../visual-cpp-samples.md)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}