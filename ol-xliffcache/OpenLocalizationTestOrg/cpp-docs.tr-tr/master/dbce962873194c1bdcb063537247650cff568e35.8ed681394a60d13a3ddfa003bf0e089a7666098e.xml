{"nodes":[{"pos":[12,52],"content":"Compiler Options Macros | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Compiler Options Macros | Microsoft Docs","pos":[0,40]}]},{"content":"Compiler Options Macros","pos":[588,611]},{"content":"These macros control specific compiler features.","pos":[612,660]},{"content":"_ATL_ALL_WARNINGS","pos":[682,699]},{"content":"A symbol which enables errors in projects converted from previous versions of ATL.","pos":[721,803]},{"content":"_ATL_APARTMENT_THREADED","pos":[809,832]},{"content":"Define if one or more of your objects use apartment threading.","pos":[860,922]},{"content":"_ATL_CSTRING_EXPLICIT_CONSTRUCTORS","pos":[928,962]},{"pos":[1001,1089],"content":"Makes certain <ph id=\"ph1\">`CString`</ph> constructors explicit, preventing any unintentional conversions.","source":"Makes certain `CString` constructors explicit, preventing any unintentional conversions."},{"content":"_ATL_ENABLE_PTM_WARNING","pos":[1095,1118]},{"content":"Define this macro in order to use C++ standard compliant syntax, which generates the C4867 compiler error when a non standard syntax is used to initialize a pointer to a member function.","pos":[1146,1332]},{"content":"_ATL_FREE_THREADED","pos":[1338,1356]},{"content":"Define if one or more of your objects use free or neutral threading.","pos":[1379,1447]},{"content":"_ATL_MULTI_THREADED","pos":[1453,1472]},{"content":"A symbol that indicates the project will have objects that are marked as Both, Free or Neutral.","pos":[1496,1591]},{"content":"The macro <bpt id=\"p1\">[</bpt>_ATL_FREE_THREADED<ept id=\"p1\">](#_atl_free_threaded)</ept> should be used instead.","pos":[1592,1667],"source":" The macro [_ATL_FREE_THREADED](#_atl_free_threaded) should be used instead."},{"content":"_ATL_NO_AUTOMATIC_NAMESPACE","pos":[1673,1700]},{"content":"A symbol which prevents the default use of namespace as ATL.","pos":[1732,1792]},{"content":"_ATL_NO_COM_SUPPORT","pos":[1798,1817]},{"content":"A symbol which prevents COM-related code from being compiled with your project.","pos":[1841,1920]},{"content":"ATL_NO_VTABLE","pos":[1926,1939]},{"content":"A symbol that prevents the vtable pointer from being initialized in the class's constructor and destructor.","pos":[1957,2064]},{"content":"ATL_NOINLINE","pos":[2070,2082]},{"content":"A symbol that indicates a function should not be inlined.","pos":[2099,2156]},{"content":"_ATL_SINGLE_THREADED","pos":[2162,2182]},{"content":"Define if all of your objects use the single threading model.","pos":[2207,2268]},{"pos":[2313,2330],"content":"_ATL_ALL_WARNINGS"},{"content":"A symbol which enables errors in projects converted from previous versions of ATL.","pos":[2334,2416]},{"content":"Remarks","pos":[2465,2472]},{"content":"Before Visual C++ .NET 2002, ATL disabled a lot of warnings and left them disabled so that they never showed up in user code.","pos":[2476,2601]},{"content":"Specifically:","pos":[2602,2615]},{"content":"C4127 conditional expression is constant","pos":[2625,2665]},{"content":"C4786 'identifier' : identifier was truncated to 'number' characters in the debug information","pos":[2675,2768]},{"content":"C4201 nonstandard extension used : nameless struct/union","pos":[2778,2834]},{"content":"C4103 'filename' : used #pragma pack to change alignment","pos":[2844,2900]},{"content":"C4291 'declaration' : no matching operator delete found; memory will not be freed if initialization throws an exception","pos":[2910,3029]},{"content":"C4268 'identifier' : 'const' static/global data initialized with compiler generated default constructor fills the object with zeros","pos":[3039,3170]},{"content":"C4702 unreachable code","pos":[3180,3202]},{"content":"In projects converted from previous versions, these warnings are still disabled by the libraries headers.","pos":[3209,3314]},{"content":"By adding the following line to the stdafx.h file before including libraries headers, this behavior can be changed.","pos":[3321,3436]},{"pos":[3454,3474],"content":"NVC_ATL_Utilities#97"},{"pos":[3538,3750],"content":"If this <ph id=\"ph1\">`#define`</ph> is added, the ATL headers are careful to preserve the state of these warnings so that they are not disabled globally (or if the user explicitly disables individual warnings, not to enable them).","source":"If this `#define` is added, the ATL headers are careful to preserve the state of these warnings so that they are not disabled globally (or if the user explicitly disables individual warnings, not to enable them)."},{"pos":[3757,3858],"content":"New projects generated with Visual C++ .NET 2002 will have this <ph id=\"ph1\">`#define`</ph> set in stdafx.h by default.","source":"New projects generated with Visual C++ .NET 2002 will have this `#define` set in stdafx.h by default."},{"pos":[3908,3931],"content":"_ATL_APARTMENT_THREADED"},{"content":"Define if one or more of your objects use apartment threading.","pos":[3935,3997]},{"content":"Remarks","pos":[4044,4051]},{"content":"Specifies apartment threading.","pos":[4055,4085]},{"content":"See <bpt id=\"p1\">[</bpt>Specifying the Project's Threading Model<ept id=\"p1\">](../../atl/specifying-the-threading-model-for-a-project-atl.md)</ept> for other threading options, and <bpt id=\"p2\">[</bpt>Options, ATL Simple Object Wizard<ept id=\"p2\">](../../atl/reference/options-atl-simple-object-wizard.md)</ept> for a description of the threading models available for an ATL object.","pos":[4086,4392],"source":" See [Specifying the Project's Threading Model](../../atl/specifying-the-threading-model-for-a-project-atl.md) for other threading options, and [Options, ATL Simple Object Wizard](../../atl/reference/options-atl-simple-object-wizard.md) for a description of the threading models available for an ATL object."},{"pos":[4453,4487],"content":"_ATL_CSTRING_EXPLICIT_CONSTRUCTORS"},{"pos":[4491,4579],"content":"Makes certain <ph id=\"ph1\">`CString`</ph> constructors explicit, preventing any unintentional conversions.","source":"Makes certain `CString` constructors explicit, preventing any unintentional conversions."},{"content":"Remarks","pos":[4637,4644]},{"content":"When this is defined, all CString constructors that take a single parameter are compiled with the explicit keyword, which prevents implicit conversions of input arguments.","pos":[4648,4819]},{"content":"This means for example, that when _UNICODE is defined, if you attempt use a char* string as a CString constructor argument, a compiler error will result.","pos":[4820,4973]},{"content":"Use this macro in situations where you need to prevent implicit conversions between narrow and wide string types.","pos":[4974,5087]},{"content":"By using the _T macro on all constructor string arguments, you can define _ATL_CSTRING_EXPLICIT_CONSTRUCTORS and avoid compile errors regardless of whether _UNICODE is defined.","pos":[5094,5270]},{"pos":[5320,5343],"content":"_ATL_ENABLE_PTM_WARNING"},{"content":"Define this macro in order to force the use of ANSI C++ standard-compliant syntax for pointer to member functions.","pos":[5347,5461]},{"content":"Using this macro will cause the C4867 compiler error to be generated when non-standard syntax is used to initialize a pointer to a member function.","pos":[5462,5609]},{"content":"Remarks","pos":[5664,5671]},{"content":"The ATL and MFC libraries have been changed to match the Visual C++ compiler's improved standard C++ compliance.","pos":[5675,5787]},{"content":"According to the ANSI C++ standard, the syntax of a pointer to a class member function should be <ph id=\"ph1\">`&amp;CMyClass::MyFunc`</ph>.","pos":[5788,5905],"source":" According to the ANSI C++ standard, the syntax of a pointer to a class member function should be `&CMyClass::MyFunc`."},{"content":"When <bpt id=\"p1\">[</bpt>_ATL_ENABLE_PTM_WARNING<ept id=\"p1\">](#_atl_enable_ptm_warning)</ept> is not defined (the default case), ATL/MFC disables the C4867 error in macro maps (notably message maps) so that code that was created in earlier versions can continue to build as before.","pos":[5912,6156],"source":"When [_ATL_ENABLE_PTM_WARNING](#_atl_enable_ptm_warning) is not defined (the default case), ATL/MFC disables the C4867 error in macro maps (notably message maps) so that code that was created in earlier versions can continue to build as before."},{"content":"If you define <bpt id=\"p1\">**</bpt>_ATL_ENABLE_PTM_WARNING<ept id=\"p1\">**</ept>, your code should be C++ standard compliant.","pos":[6157,6243],"source":" If you define **_ATL_ENABLE_PTM_WARNING**, your code should be C++ standard compliant."},{"content":"However, the non-standard form has been deprecated, so you need to move existing code to C++ standard compliant syntax.","pos":[6250,6369]},{"content":"For example, the following:","pos":[6370,6397]},{"pos":[6415,6433],"content":"NVC_MFCListView#14"},{"content":"Should be changed to:","pos":[6509,6530]},{"pos":[6548,6566],"content":"NVC_MFCListView#11"},{"content":"Note that for map macros that add the '&amp;' character, you should not add it again in your code.","pos":[6642,6736],"source":"Note that for map macros that add the '&' character, you should not add it again in your code."},{"pos":[6781,6799],"content":"_ATL_FREE_THREADED"},{"content":"Define if one or more of your objects use free or neutral threading.","pos":[6803,6871]},{"content":"Remarks","pos":[6913,6920]},{"content":"Specifies free threading.","pos":[6924,6949]},{"content":"Free threading is equivalent to a multithread apartment model.","pos":[6950,7012]},{"content":"See <bpt id=\"p1\">[</bpt>Specifying the Project's Threading Model<ept id=\"p1\">](../../atl/specifying-the-threading-model-for-a-project-atl.md)</ept> for other threading options, and <bpt id=\"p2\">[</bpt>Options, ATL Simple Object Wizard<ept id=\"p2\">](../../atl/reference/options-atl-simple-object-wizard.md)</ept> for a description of the threading models available for an ATL object.","pos":[7013,7319],"source":" See [Specifying the Project's Threading Model](../../atl/specifying-the-threading-model-for-a-project-atl.md) for other threading options, and [Options, ATL Simple Object Wizard](../../atl/reference/options-atl-simple-object-wizard.md) for a description of the threading models available for an ATL object."},{"pos":[7365,7384],"content":"_ATL_MULTI_THREADED"},{"content":"A symbol that indicates the project will have objects that are marked as Both, Free or Neutral.","pos":[7388,7483]},{"content":"Remarks","pos":[7526,7533]},{"content":"If this symbol is defined, ATL will pull in code that will correctly synchronize access to global data.","pos":[7537,7640]},{"content":"New code should use the equivalent macro <bpt id=\"p1\">[</bpt>_ATL_FREE_THREADED<ept id=\"p1\">](#_atl_free_threaded)</ept> instead.","pos":[7641,7732],"source":" New code should use the equivalent macro [_ATL_FREE_THREADED](#_atl_free_threaded) instead."},{"pos":[7786,7813],"content":"_ATL_NO_AUTOMATIC_NAMESPACE"},{"content":"A symbol which prevents the default use of namespace as ATL.","pos":[7817,7877]},{"content":"Remarks","pos":[7928,7935]},{"content":"If this symbol is not defined, including atlbase.h will perform <bpt id=\"p1\">**</bpt>using namespace ATL<ept id=\"p1\">**</ept> by default, which may lead to naming conflicts.","pos":[7939,8074],"source":"If this symbol is not defined, including atlbase.h will perform **using namespace ATL** by default, which may lead to naming conflicts."},{"content":"To prevent this, define this symbol.","pos":[8075,8111]},{"pos":[8157,8176],"content":"_ATL_NO_COM_SUPPORT"},{"content":"A symbol which prevents COM-related code from being compiled with your project.","pos":[8180,8259]},{"content":"ATL_NO_VTABLE","pos":[8465,8478]},{"pos":[8986,8994],"content":"{ ... }","source":"{\n...\n }"},{"content":"_ATL_SINGLE_THREADED","pos":[9448,9468]}],"content":"---\ntitle: \"Compiler Options Macros | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"compiler options, macros\"\nms.assetid: a869adc6-b3de-4299-b040-9ae20b45f82c\ncaps.latest.revision: 17\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Compiler Options Macros\nThese macros control specific compiler features.  \n  \n|||  \n|-|-|  \n|[_ATL_ALL_WARNINGS](#_atl_all_warnings)|A symbol which enables errors in projects converted from previous versions of ATL.|  \n|[_ATL_APARTMENT_THREADED](#_atl_apartment_threaded)|Define if one or more of your objects use apartment threading.|  \n|[_ATL_CSTRING_EXPLICIT_CONSTRUCTORS](#_atl_cstring_explicit_constructors)|Makes certain `CString` constructors explicit, preventing any unintentional conversions.|  \n|[_ATL_ENABLE_PTM_WARNING](#_atl_enable_ptm_warning)|Define this macro in order to use C++ standard compliant syntax, which generates the C4867 compiler error when a non standard syntax is used to initialize a pointer to a member function.|  \n|[_ATL_FREE_THREADED](#_atl_free_threaded)|Define if one or more of your objects use free or neutral threading.|  \n|[_ATL_MULTI_THREADED](#_atl_multi_threaded)|A symbol that indicates the project will have objects that are marked as Both, Free or Neutral. The macro [_ATL_FREE_THREADED](#_atl_free_threaded) should be used instead.|  \n|[_ATL_NO_AUTOMATIC_NAMESPACE](#_atl_no_automatic_namespace)|A symbol which prevents the default use of namespace as ATL.|  \n|[_ATL_NO_COM_SUPPORT](#_atl_no_com_support)|A symbol which prevents COM-related code from being compiled with your project.|  \n|[ATL_NO_VTABLE](#atl_no_vtable)|A symbol that prevents the vtable pointer from being initialized in the class's constructor and destructor.|  \n|[ATL_NOINLINE](#atl_noinline)|A symbol that indicates a function should not be inlined.|  \n|[_ATL_SINGLE_THREADED](#_atl_single_threaded)|Define if all of your objects use the single threading model.|  \n  \n##  <a name=\"_atl_all_warnings\"></a>  _ATL_ALL_WARNINGS  \n A symbol which enables errors in projects converted from previous versions of ATL.  \n  \n```\n#define _ATL_ALL_WARNINGS\n```  \n  \n### Remarks  \n Before Visual C++ .NET 2002, ATL disabled a lot of warnings and left them disabled so that they never showed up in user code. Specifically:  \n  \n-   C4127 conditional expression is constant  \n  \n-   C4786 'identifier' : identifier was truncated to 'number' characters in the debug information  \n  \n-   C4201 nonstandard extension used : nameless struct/union  \n  \n-   C4103 'filename' : used #pragma pack to change alignment  \n  \n-   C4291 'declaration' : no matching operator delete found; memory will not be freed if initialization throws an exception  \n  \n-   C4268 'identifier' : 'const' static/global data initialized with compiler generated default constructor fills the object with zeros  \n  \n-   C4702 unreachable code  \n  \n In projects converted from previous versions, these warnings are still disabled by the libraries headers.  \n  \n By adding the following line to the stdafx.h file before including libraries headers, this behavior can be changed.  \n  \n [!code-cpp[NVC_ATL_Utilities#97](../../atl/codesnippet/cpp/compiler-options-macros_1.h)]  \n  \n If this `#define` is added, the ATL headers are careful to preserve the state of these warnings so that they are not disabled globally (or if the user explicitly disables individual warnings, not to enable them).  \n  \n New projects generated with Visual C++ .NET 2002 will have this `#define` set in stdafx.h by default.  \n  \n##  <a name=\"_atl_apartment_threaded\"></a>  _ATL_APARTMENT_THREADED  \n Define if one or more of your objects use apartment threading.  \n  \n```\n_ATL_APARTMENT_THREADED\n```  \n  \n### Remarks  \n Specifies apartment threading. See [Specifying the Project's Threading Model](../../atl/specifying-the-threading-model-for-a-project-atl.md) for other threading options, and [Options, ATL Simple Object Wizard](../../atl/reference/options-atl-simple-object-wizard.md) for a description of the threading models available for an ATL object.  \n  \n##  <a name=\"_atl_cstring_explicit_constructors\"></a>  _ATL_CSTRING_EXPLICIT_CONSTRUCTORS  \n Makes certain `CString` constructors explicit, preventing any unintentional conversions.  \n  \n```\n_ATL_CSTRING_EXPLICIT_CONSTRUCTORS\n```  \n  \n### Remarks  \n When this is defined, all CString constructors that take a single parameter are compiled with the explicit keyword, which prevents implicit conversions of input arguments. This means for example, that when _UNICODE is defined, if you attempt use a char* string as a CString constructor argument, a compiler error will result. Use this macro in situations where you need to prevent implicit conversions between narrow and wide string types.  \n  \n By using the _T macro on all constructor string arguments, you can define _ATL_CSTRING_EXPLICIT_CONSTRUCTORS and avoid compile errors regardless of whether _UNICODE is defined.  \n  \n##  <a name=\"_atl_enable_ptm_warning\"></a>  _ATL_ENABLE_PTM_WARNING  \n Define this macro in order to force the use of ANSI C++ standard-compliant syntax for pointer to member functions. Using this macro will cause the C4867 compiler error to be generated when non-standard syntax is used to initialize a pointer to a member function.  \n  \n```\n#define _ATL_ENABLE_PTM_WARNING\n```  \n  \n### Remarks  \n The ATL and MFC libraries have been changed to match the Visual C++ compiler's improved standard C++ compliance. According to the ANSI C++ standard, the syntax of a pointer to a class member function should be `&CMyClass::MyFunc`.  \n  \n When [_ATL_ENABLE_PTM_WARNING](#_atl_enable_ptm_warning) is not defined (the default case), ATL/MFC disables the C4867 error in macro maps (notably message maps) so that code that was created in earlier versions can continue to build as before. If you define **_ATL_ENABLE_PTM_WARNING**, your code should be C++ standard compliant.  \n  \n However, the non-standard form has been deprecated, so you need to move existing code to C++ standard compliant syntax. For example, the following:  \n  \n [!code-cpp[NVC_MFCListView#14](../../atl/reference/codesnippet/cpp/compiler-options-macros_2.cpp)]  \n  \n Should be changed to:  \n  \n [!code-cpp[NVC_MFCListView#11](../../atl/reference/codesnippet/cpp/compiler-options-macros_3.cpp)]  \n  \n Note that for map macros that add the '&' character, you should not add it again in your code.  \n  \n##  <a name=\"_atl_free_threaded\"></a>  _ATL_FREE_THREADED  \n Define if one or more of your objects use free or neutral threading.  \n  \n```\n_ATL_FREE_THREADED\n```  \n  \n### Remarks  \n Specifies free threading. Free threading is equivalent to a multithread apartment model. See [Specifying the Project's Threading Model](../../atl/specifying-the-threading-model-for-a-project-atl.md) for other threading options, and [Options, ATL Simple Object Wizard](../../atl/reference/options-atl-simple-object-wizard.md) for a description of the threading models available for an ATL object.  \n  \n##  <a name=\"_atl_multi_threaded\"></a>  _ATL_MULTI_THREADED  \n A symbol that indicates the project will have objects that are marked as Both, Free or Neutral.  \n  \n```\n_ATL_MULTI_THREADED\n```  \n  \n### Remarks  \n If this symbol is defined, ATL will pull in code that will correctly synchronize access to global data. New code should use the equivalent macro [_ATL_FREE_THREADED](#_atl_free_threaded) instead.  \n  \n##  <a name=\"_atl_no_automatic_namespace\"></a>  _ATL_NO_AUTOMATIC_NAMESPACE  \n A symbol which prevents the default use of namespace as ATL.  \n  \n```\n_ATL_NO_AUTOMATIC_NAMESPACE\n```  \n  \n### Remarks  \n If this symbol is not defined, including atlbase.h will perform **using namespace ATL** by default, which may lead to naming conflicts. To prevent this, define this symbol.  \n  \n##  <a name=\"_atl_no_com_support\"></a>  _ATL_NO_COM_SUPPORT  \n A symbol which prevents COM-related code from being compiled with your project.  \n  \n```\n_ATL_NO_COM_SUPPORT```  \n  \n##  <a name=\"atl_no_vtable\"></a>  ATL_NO_VTABLE  \n A symbol that prevents the vtable pointer from being initialized in the class's constructor and destructor.  \n  \n```\nATL_NO_VTABLE\n```  \n  \n### Remarks  \n If the vtable pointer is prevented from being initialized in the class's constructor and destructor, the linker can eliminate the vtable and all of the functions to which it points. Expands to **__declspec(novtable)**.  \n  \n### Example  \n [!code-cpp[NVC_ATL_COM#53](../../atl/codesnippet/cpp/compiler-options-macros_4.h)]  \n  \n##  <a name=\"atl_noinline\"></a>  ATL_NOINLINE  \n A symbol that indicates a function should not be inlined.  \n  \n```\n    ATL_NOINLINE inline\n    myfunction\n {\n...\n }\n```  \n  \n### Parameters  \n *myfunction*  \n The function that should not be inlined.  \n  \n### Remarks  \n Use this symbol if you want to ensure a function does not get inlined by the compiler, even though it must be declared as inline so that it can be placed in a header file. Expands to **__declspec(noinline)**.  \n  \n##  <a name=\"_atl_single_threaded\"></a>  _ATL_SINGLE_THREADED  \n Define if all of your objects use the single threading model  \n  \n```\n_ATL_SINGLE_THREADED\n```  \n  \n### Remarks  \n Specifies that the object always runs in the primary COM thread. See [Specifying the Project's Threading Model](../../atl/specifying-the-threading-model-for-a-project-atl.md) for other threading options, and [Options, ATL Simple Object Wizard](../../atl/reference/options-atl-simple-object-wizard.md) for a description of the threading models available for an ATL object.  \n  \n## See Also  \n [Macros](../../atl/reference/atl-macros.md)\n"}