{"nodes":[{"pos":[12,81],"content":"MFC: Using Database Classes with Documents and Views | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC: Using Database Classes with Documents and Views | Microsoft Docs","pos":[0,69]}]},{"content":"MFC: Using Database Classes with Documents and Views","pos":[1288,1340]},{"content":"You can use the MFC database classes — DAO or ODBC — with or without the document/view architecture.","pos":[1341,1441]},{"content":"This topic emphasizes working with documents and views.","pos":[1442,1497]},{"content":"It explains:","pos":[1498,1510]},{"pos":[1520,1687],"content":"<bpt id=\"p1\">[</bpt>How to write a form-based application<ept id=\"p1\">](#_core_writing_a_form.2d.based_application)</ept> using a <ph id=\"ph1\">`CRecordView`</ph> or <ph id=\"ph2\">`CDaoRecordView`</ph> object as the main view on your document.","source":"[How to write a form-based application](#_core_writing_a_form.2d.based_application) using a `CRecordView` or `CDaoRecordView` object as the main view on your document."},{"pos":[1697,1804],"content":"<bpt id=\"p1\">[</bpt>How to use recordset objects in your documents and views<ept id=\"p1\">](#_core_using_recordsets_in_documents_and_views)</ept>.","source":"[How to use recordset objects in your documents and views](#_core_using_recordsets_in_documents_and_views)."},{"pos":[1814,1859],"content":"<bpt id=\"p1\">[</bpt>Other considerations<ept id=\"p1\">](#_core_other_factors)</ept>.","source":"[Other considerations](#_core_other_factors)."},{"pos":[1866,2013],"content":"For alternatives, see <bpt id=\"p1\">[</bpt>MFC: Using Database Classes Without Documents and Views<ept id=\"p1\">](../data/mfc-using-database-classes-without-documents-and-views.md)</ept>.","source":"For alternatives, see [MFC: Using Database Classes Without Documents and Views](../data/mfc-using-database-classes-without-documents-and-views.md)."},{"pos":[2080,2112],"content":"Writing a Form-Based Application"},{"content":"Many data-access applications are based on forms.","pos":[2116,2165]},{"content":"The user interface is a form containing controls in which the user examines, enters, or edits data.","pos":[2166,2265]},{"content":"To make your application form based, use class <ph id=\"ph1\">`CRecordView`</ph> or <ph id=\"ph2\">`CDaoRecordView`</ph>.","pos":[2266,2347],"source":" To make your application form based, use class `CRecordView` or `CDaoRecordView`."},{"content":"When you run the MFC Application Wizard and select <bpt id=\"p1\">**</bpt>ODBC<ept id=\"p1\">**</ept> client type on the <bpt id=\"p2\">**</bpt>Database Support<ept id=\"p2\">**</ept> page, the project uses <ph id=\"ph1\">`CRecordView`</ph> for the view class.","pos":[2348,2504],"source":" When you run the MFC Application Wizard and select **ODBC** client type on the **Database Support** page, the project uses `CRecordView` for the view class."},{"content":"The wizards no longer support DAO, so if you want to use <ph id=\"ph1\">`CDaoRecordView`</ph>, you have to code it manually.","pos":[2505,2609],"source":" The wizards no longer support DAO, so if you want to use `CDaoRecordView`, you have to code it manually."},{"content":"In a form-based application, each record view object stores a pointer to a <ph id=\"ph1\">`CRecordset`</ph> or <ph id=\"ph2\">`CDaoRecordset`</ph> object.","pos":[2616,2730],"source":"In a form-based application, each record view object stores a pointer to a `CRecordset` or `CDaoRecordset` object."},{"content":"The framework's record field exchange (RFX) mechanism exchanges data between the recordset and the data source.","pos":[2731,2842]},{"content":"The dialog data exchange (DDX) mechanism exchanges data between the field data members of the recordset object and the controls on the form.","pos":[2843,2983]},{"content":"or <ph id=\"ph1\">`CDaoRecordView`</ph> also provides default command handler functions for navigating from record to record on the form.","pos":[2998,3115],"source":" or `CDaoRecordView` also provides default command handler functions for navigating from record to record on the form."},{"pos":[3122,3399],"content":"To create a form-based application with the application wizard, see <bpt id=\"p1\">[</bpt>Creating a Forms-Based MFC Application<ept id=\"p1\">](../mfc/reference/creating-a-forms-based-mfc-application.md)</ept> and <bpt id=\"p2\">[</bpt>Database Support, MFC Application Wizard<ept id=\"p2\">](../mfc/reference/database-support-mfc-application-wizard.md)</ept>.","source":"To create a form-based application with the application wizard, see [Creating a Forms-Based MFC Application](../mfc/reference/creating-a-forms-based-mfc-application.md) and [Database Support, MFC Application Wizard](../mfc/reference/database-support-mfc-application-wizard.md)."},{"pos":[3406,3498],"content":"For a full discussion of forms, see <bpt id=\"p1\">[</bpt>Record Views<ept id=\"p1\">](../data/record-views-mfc-data-access.md)</ept>.","source":"For a full discussion of forms, see [Record Views](../data/record-views-mfc-data-access.md)."},{"pos":[3569,3608],"content":"Using Recordsets in Documents and Views"},{"content":"Many simple form-based applications do not need documents.","pos":[3612,3670]},{"content":"If your application is more complex, you probably want to use a document as a proxy for the database, storing a <ph id=\"ph1\">`CDatabase`</ph> or <ph id=\"ph2\">`CDaoDatabase`</ph> object that connects to the data source.","pos":[3671,3853],"source":" If your application is more complex, you probably want to use a document as a proxy for the database, storing a `CDatabase` or `CDaoDatabase` object that connects to the data source."},{"content":"Form-based applications usually store a pointer to a recordset object in the view.","pos":[3854,3936]},{"content":"Other kinds of database applications store recordsets and <ph id=\"ph1\">`CDatabase`</ph> or <ph id=\"ph2\">`CDaoDatabase`</ph> object in the document.","pos":[3937,4048],"source":" Other kinds of database applications store recordsets and `CDatabase` or `CDaoDatabase` object in the document."},{"content":"Here are some possibilities for using documents in database applications:","pos":[4049,4122]},{"pos":[4132,4300],"content":"If you are accessing a recordset in a local context, create a <ph id=\"ph1\">`CRecordset`</ph> or <ph id=\"ph2\">`CDaoRecordset`</ph> object locally in member functions of the document or the view, as needed.","source":"If you are accessing a recordset in a local context, create a `CRecordset` or `CDaoRecordset` object locally in member functions of the document or the view, as needed."},{"content":"Declare a recordset object as a local variable in a function.","pos":[4311,4372]},{"content":"Pass <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> to the constructor, which causes the framework to create and open a temporary <ph id=\"ph1\">`CDatabase`</ph> or <ph id=\"ph2\">`CDaoDatabase`</ph> object for you.","pos":[4373,4510],"source":" Pass **NULL** to the constructor, which causes the framework to create and open a temporary `CDatabase` or `CDaoDatabase` object for you."},{"content":"As an alternative, pass a pointer to a <ph id=\"ph1\">`CDatabase`</ph> or <ph id=\"ph2\">`CDaoDatabase`</ph> object.","pos":[4511,4587],"source":" As an alternative, pass a pointer to a `CDatabase` or `CDaoDatabase` object."},{"content":"Use the recordset within the function and let it be destroyed automatically when the function exits.","pos":[4588,4688]},{"content":"When you pass <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> to a recordset constructor, the framework uses information returned by the recordset's <ph id=\"ph1\">`GetDefaultConnect`</ph> member function to create a <ph id=\"ph2\">`CDatabase`</ph> or <ph id=\"ph3\">`CDaoDatabase`</ph> object and open it.","pos":[4699,4906],"source":"When you pass **NULL** to a recordset constructor, the framework uses information returned by the recordset's `GetDefaultConnect` member function to create a `CDatabase` or `CDaoDatabase` object and open it."},{"content":"The wizards implement <ph id=\"ph1\">`GetDefaultConnect`</ph> for you.","pos":[4907,4957],"source":" The wizards implement `GetDefaultConnect` for you."},{"pos":[4967,5113],"content":"If you are accessing a recordset during the lifetime of your document, embed one or more <ph id=\"ph1\">`CRecordset`</ph> or <ph id=\"ph2\">`CDaoRecordset`</ph> objects in your document.","source":"If you are accessing a recordset during the lifetime of your document, embed one or more `CRecordset` or `CDaoRecordset` objects in your document."},{"content":"Construct the recordset objects either when you initialize the document or as needed.","pos":[5124,5209]},{"content":"You might write a function that returns a pointer to the recordset if it already exists or constructs and opens the recordset if it does not exist yet.","pos":[5210,5361]},{"content":"Close, delete, and recreate the recordset as needed, or call its <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> member function to refresh the records.","pos":[5362,5478],"source":" Close, delete, and recreate the recordset as needed, or call its **Requery** member function to refresh the records."},{"pos":[5488,5673],"content":"If you are accessing a data source during the lifetime of your document, embed a <ph id=\"ph1\">`CDatabase`</ph> or <ph id=\"ph2\">`CDaoDatabase`</ph> object or store a pointer to a <ph id=\"ph3\">`CDatabase`</ph> or <ph id=\"ph4\">`CDaoDatabase`</ph> object in it.","source":"If you are accessing a data source during the lifetime of your document, embed a `CDatabase` or `CDaoDatabase` object or store a pointer to a `CDatabase` or `CDaoDatabase` object in it."},{"content":"The <ph id=\"ph1\">`CDatabase`</ph> or <ph id=\"ph2\">`CDaoDatabase`</ph> object manages a connection to your data source.","pos":[5684,5766],"source":"The `CDatabase` or `CDaoDatabase` object manages a connection to your data source."},{"content":"The object is constructed automatically during document construction, and you call its <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> member function when you initialize the document.","pos":[5767,5912],"source":" The object is constructed automatically during document construction, and you call its **Open** member function when you initialize the document."},{"content":"When you construct recordset objects in document member functions, you pass a pointer to the document's <ph id=\"ph1\">`CDatabase`</ph> or <ph id=\"ph2\">`CDaoDatabase`</ph> object.","pos":[5913,6054],"source":" When you construct recordset objects in document member functions, you pass a pointer to the document's `CDatabase` or `CDaoDatabase` object."},{"content":"This associates each recordset with its data source.","pos":[6055,6107]},{"content":"The database object is usually destroyed when the document closes.","pos":[6108,6174]},{"content":"The recordset objects are typically destroyed when they exit the scope of a function.","pos":[6175,6260]},{"pos":[6305,6318],"content":"Other Factors"},{"content":"Form-based applications often do not have any use for the framework's document serialization mechanism, so you might want to remove, disable, or replace the <ph id=\"ph1\">`New`</ph> and <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> commands on the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu.","pos":[6322,6528],"source":"Form-based applications often do not have any use for the framework's document serialization mechanism, so you might want to remove, disable, or replace the `New` and **Open** commands on the **File** menu."},{"content":"See the article <bpt id=\"p1\">[</bpt>Serialization: Serialization vs. Database Input/Output<ept id=\"p1\">](../mfc/serialization-serialization-vs-database-input-output.md)</ept>.","pos":[6529,6666],"source":" See the article [Serialization: Serialization vs. Database Input/Output](../mfc/serialization-serialization-vs-database-input-output.md)."},{"content":"You might also want to make use of the many user-interface possibilities that the framework can support.","pos":[6673,6777]},{"content":"For example, you could use multiple <ph id=\"ph1\">`CRecordView`</ph> or <ph id=\"ph2\">`CDaoRecordView`</ph> objects in a splitter window, open multiple recordsets in different multiple document interface (MDI) child windows, and so on.","pos":[6778,6975],"source":" For example, you could use multiple `CRecordView` or `CDaoRecordView` objects in a splitter window, open multiple recordsets in different multiple document interface (MDI) child windows, and so on."},{"content":"You might want to implement printing of whatever is in your view, whether it is a form implemented with <ph id=\"ph1\">`CRecordView`</ph> or <ph id=\"ph2\">`CDaoRecordView`</ph> or something else.","pos":[6982,7138],"source":"You might want to implement printing of whatever is in your view, whether it is a form implemented with `CRecordView` or `CDaoRecordView` or something else."},{"content":"As classes derived from <ph id=\"ph1\">`CFormView`</ph>, <ph id=\"ph2\">`CRecordView`</ph> and <ph id=\"ph3\">`CDaoRecordView`</ph> do not support printing, but you can override the <ph id=\"ph4\">`OnPrint`</ph> member function to allow printing.","pos":[7139,7305],"source":" As classes derived from `CFormView`, `CRecordView` and `CDaoRecordView` do not support printing, but you can override the `OnPrint` member function to allow printing."},{"content":"For more information, see class <bpt id=\"p1\">[</bpt>CFormView<ept id=\"p1\">](../mfc/reference/cformview-class.md)</ept>.","pos":[7306,7387],"source":" For more information, see class [CFormView](../mfc/reference/cformview-class.md)."},{"content":"You might not want to use documents and views at all.","pos":[7394,7447]},{"content":"In that case, see <bpt id=\"p1\">[</bpt>MFC: Using Database Classes Without Documents and Views<ept id=\"p1\">](../data/mfc-using-database-classes-without-documents-and-views.md)</ept>.","pos":[7448,7591],"source":" In that case, see [MFC: Using Database Classes Without Documents and Views](../data/mfc-using-database-classes-without-documents-and-views.md)."},{"content":"See Also","pos":[7600,7608]},{"content":"MFC Database Classes (ODBC and DAO)","pos":[7613,7648]}],"content":"---\ntitle: \"MFC: Using Database Classes with Documents and Views | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"documents [C++], database applications\"\n  - \"CDaoRecordView class, using in database forms\"\n  - \"recordsets [C++], documents and views\"\n  - \"CRecordView class, using in database forms\"\n  - \"DAO recordsets [C++], documents and views\"\n  - \"views [C++], database applications\"\n  - \"forms [C++], database applications\"\n  - \"record views [C++], form-based applications\"\n  - \"document/view architecture [C++], in databases\"\n  - \"database applications [C++], forms\"\n  - \"database classes [C++], MFC\"\n  - \"DAO [C++], forms in database applications\"\n  - \"ODBC recordsets [C++], documents and views\"\n  - \"ODBC [C++], forms\"\n  - \"CDaoRecordView class, using in database applications\"\n  - \"DAO recordsets [C++]\"\nms.assetid: 83979974-fc63-46ac-b162-e8403a572e2c\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC: Using Database Classes with Documents and Views\nYou can use the MFC database classes — DAO or ODBC — with or without the document/view architecture. This topic emphasizes working with documents and views. It explains:  \n  \n-   [How to write a form-based application](#_core_writing_a_form.2d.based_application) using a `CRecordView` or `CDaoRecordView` object as the main view on your document.  \n  \n-   [How to use recordset objects in your documents and views](#_core_using_recordsets_in_documents_and_views).  \n  \n-   [Other considerations](#_core_other_factors).  \n  \n For alternatives, see [MFC: Using Database Classes Without Documents and Views](../data/mfc-using-database-classes-without-documents-and-views.md).  \n  \n##  <a name=\"_core_writing_a_form.2d.based_application\"></a> Writing a Form-Based Application  \n Many data-access applications are based on forms. The user interface is a form containing controls in which the user examines, enters, or edits data. To make your application form based, use class `CRecordView` or `CDaoRecordView`. When you run the MFC Application Wizard and select **ODBC** client type on the **Database Support** page, the project uses `CRecordView` for the view class. The wizards no longer support DAO, so if you want to use `CDaoRecordView`, you have to code it manually.  \n  \n In a form-based application, each record view object stores a pointer to a `CRecordset` or `CDaoRecordset` object. The framework's record field exchange (RFX) mechanism exchanges data between the recordset and the data source. The dialog data exchange (DDX) mechanism exchanges data between the field data members of the recordset object and the controls on the form. `CRecordView` or `CDaoRecordView` also provides default command handler functions for navigating from record to record on the form.  \n  \n To create a form-based application with the application wizard, see [Creating a Forms-Based MFC Application](../mfc/reference/creating-a-forms-based-mfc-application.md) and [Database Support, MFC Application Wizard](../mfc/reference/database-support-mfc-application-wizard.md).  \n  \n For a full discussion of forms, see [Record Views](../data/record-views-mfc-data-access.md).  \n  \n##  <a name=\"_core_using_recordsets_in_documents_and_views\"></a> Using Recordsets in Documents and Views  \n Many simple form-based applications do not need documents. If your application is more complex, you probably want to use a document as a proxy for the database, storing a `CDatabase` or `CDaoDatabase` object that connects to the data source. Form-based applications usually store a pointer to a recordset object in the view. Other kinds of database applications store recordsets and `CDatabase` or `CDaoDatabase` object in the document. Here are some possibilities for using documents in database applications:  \n  \n-   If you are accessing a recordset in a local context, create a `CRecordset` or `CDaoRecordset` object locally in member functions of the document or the view, as needed.  \n  \n     Declare a recordset object as a local variable in a function. Pass **NULL** to the constructor, which causes the framework to create and open a temporary `CDatabase` or `CDaoDatabase` object for you. As an alternative, pass a pointer to a `CDatabase` or `CDaoDatabase` object. Use the recordset within the function and let it be destroyed automatically when the function exits.  \n  \n     When you pass **NULL** to a recordset constructor, the framework uses information returned by the recordset's `GetDefaultConnect` member function to create a `CDatabase` or `CDaoDatabase` object and open it. The wizards implement `GetDefaultConnect` for you.  \n  \n-   If you are accessing a recordset during the lifetime of your document, embed one or more `CRecordset` or `CDaoRecordset` objects in your document.  \n  \n     Construct the recordset objects either when you initialize the document or as needed. You might write a function that returns a pointer to the recordset if it already exists or constructs and opens the recordset if it does not exist yet. Close, delete, and recreate the recordset as needed, or call its **Requery** member function to refresh the records.  \n  \n-   If you are accessing a data source during the lifetime of your document, embed a `CDatabase` or `CDaoDatabase` object or store a pointer to a `CDatabase` or `CDaoDatabase` object in it.  \n  \n     The `CDatabase` or `CDaoDatabase` object manages a connection to your data source. The object is constructed automatically during document construction, and you call its **Open** member function when you initialize the document. When you construct recordset objects in document member functions, you pass a pointer to the document's `CDatabase` or `CDaoDatabase` object. This associates each recordset with its data source. The database object is usually destroyed when the document closes. The recordset objects are typically destroyed when they exit the scope of a function.  \n  \n##  <a name=\"_core_other_factors\"></a> Other Factors  \n Form-based applications often do not have any use for the framework's document serialization mechanism, so you might want to remove, disable, or replace the `New` and **Open** commands on the **File** menu. See the article [Serialization: Serialization vs. Database Input/Output](../mfc/serialization-serialization-vs-database-input-output.md).  \n  \n You might also want to make use of the many user-interface possibilities that the framework can support. For example, you could use multiple `CRecordView` or `CDaoRecordView` objects in a splitter window, open multiple recordsets in different multiple document interface (MDI) child windows, and so on.  \n  \n You might want to implement printing of whatever is in your view, whether it is a form implemented with `CRecordView` or `CDaoRecordView` or something else. As classes derived from `CFormView`, `CRecordView` and `CDaoRecordView` do not support printing, but you can override the `OnPrint` member function to allow printing. For more information, see class [CFormView](../mfc/reference/cformview-class.md).  \n  \n You might not want to use documents and views at all. In that case, see [MFC: Using Database Classes Without Documents and Views](../data/mfc-using-database-classes-without-documents-and-views.md).  \n  \n## See Also  \n [MFC Database Classes (ODBC and DAO)](../data/mfc-database-classes-odbc-and-dao.md)"}