{"nodes":[{"pos":[12,77],"content":"Exceptions: Converting from MFC Exception Macros | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Exceptions: Converting from MFC Exception Macros | Microsoft Docs","pos":[0,65]}]},{"content":"Exceptions: Converting from MFC Exception Macros","pos":[981,1029]},{"content":"This is an advanced topic.","pos":[1030,1056]},{"content":"This article explains how to convert existing code written with Microsoft Foundation Class macros — <bpt id=\"p1\">**</bpt>TRY<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>CATCH<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>THROW<ept id=\"p3\">**</ept>, and so on — to use the C++ exception-handling keywords <bpt id=\"p4\">**</bpt>try<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>catch<ept id=\"p5\">**</ept>, and <ph id=\"ph1\">`throw`</ph>.","pos":[1063,1281],"source":"This article explains how to convert existing code written with Microsoft Foundation Class macros — **TRY**, **CATCH**, **THROW**, and so on — to use the C++ exception-handling keywords **try**, **catch**, and `throw`."},{"content":"Topics include:","pos":[1282,1297]},{"content":"Conversion advantages","pos":[1308,1329]},{"content":"Converting code with exception macros to use C++ exceptions","pos":[1374,1433]},{"pos":[1519,1543],"content":"Advantages of Converting"},{"content":"You probably do not need to convert existing code, although you should be aware of differences between the macro implementations in MFC version 3.0 and the implementations in earlier versions.","pos":[1547,1739]},{"content":"These differences and subsequent changes in code behavior are discussed in <bpt id=\"p1\">[</bpt>Exceptions: Changes to Exception Macros in Version 3.0<ept id=\"p1\">](../mfc/exceptions-changes-to-exception-macros-in-version-3-0.md)</ept>.","pos":[1740,1937],"source":" These differences and subsequent changes in code behavior are discussed in [Exceptions: Changes to Exception Macros in Version 3.0](../mfc/exceptions-changes-to-exception-macros-in-version-3-0.md)."},{"content":"The principal advantages of converting are:","pos":[1944,1987]},{"content":"Code that uses the C++ exception-handling keywords compiles to a slightly smaller .EXE or .DLL.","pos":[1997,2092]},{"pos":[2102,2352],"content":"The C++ exception-handling keywords are more versatile: They can handle exceptions of any data type that can be copied (<ph id=\"ph1\">`int`</ph>, <bpt id=\"p1\">**</bpt>float<ept id=\"p1\">**</ept>, <ph id=\"ph2\">`char`</ph>, and so on), whereas the macros handle exceptions only of class <ph id=\"ph3\">`CException`</ph> and classes derived from it.","source":"The C++ exception-handling keywords are more versatile: They can handle exceptions of any data type that can be copied (`int`, **float**, `char`, and so on), whereas the macros handle exceptions only of class `CException` and classes derived from it."},{"content":"The major difference between the macros and the keywords is that code using the macros \"automatically\" deletes a caught exception when the exception goes out of scope.","pos":[2359,2526]},{"content":"Code using the keywords does not, so you must explicitly delete a caught exception.","pos":[2527,2610]},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Exceptions: Catching and Deleting Exceptions<ept id=\"p1\">](../mfc/exceptions-catching-and-deleting-exceptions.md)</ept>.","pos":[2611,2751],"source":" For more information, see the article [Exceptions: Catching and Deleting Exceptions](../mfc/exceptions-catching-and-deleting-exceptions.md)."},{"content":"Another difference is syntax.","pos":[2758,2787]},{"content":"The syntax for macros and keywords differs in three respects:","pos":[2788,2849]},{"content":"Macro arguments and exception declarations:","pos":[2859,2902]},{"pos":[2913,2967],"content":"A <bpt id=\"p1\">**</bpt>CATCH<ept id=\"p1\">**</ept> macro invocation has the following syntax:","source":"A **CATCH** macro invocation has the following syntax:"},{"pos":[2978,3045],"content":"<bpt id=\"p1\">**</bpt>CATCH(<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>exception_class<ept id=\"p2\">*</ept>, <bpt id=\"p3\">*</bpt>exception_object_pointer_name<ept id=\"p3\">*</ept> <bpt id=\"p4\">**</bpt>)<ept id=\"p4\">**</ept>","source":"**CATCH(** *exception_class*, *exception_object_pointer_name* **)**"},{"content":"Notice the comma between the class name and the object pointer name.","pos":[3056,3124]},{"pos":[3135,3204],"content":"The exception declaration for the <bpt id=\"p1\">**</bpt>catch<ept id=\"p1\">**</ept> keyword uses this syntax:","source":"The exception declaration for the **catch** keyword uses this syntax:"},{"pos":[3215,3264],"content":"<bpt id=\"p1\">**</bpt>catch(<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>exception_type<ept id=\"p2\">*</ept> <bpt id=\"p3\">*</bpt>exception_name<ept id=\"p3\">*</ept><bpt id=\"p4\">**</bpt>)<ept id=\"p4\">**</ept>","source":"**catch(** *exception_type* *exception_name***)**"},{"content":"This exception declaration statement indicates the type of exception the catch block handles.","pos":[3275,3368]},{"content":"Delimitation of catch blocks:","pos":[3378,3407]},{"pos":[3418,3626],"content":"With the macros, the <bpt id=\"p1\">**</bpt>CATCH<ept id=\"p1\">**</ept> macro (with its arguments) begins the first catch block; the <ph id=\"ph1\">`AND_CATCH`</ph> macro begins subsequent catch blocks, and the <ph id=\"ph2\">`END_CATCH`</ph> macro terminates the sequence of catch blocks.","source":"With the macros, the **CATCH** macro (with its arguments) begins the first catch block; the `AND_CATCH` macro begins subsequent catch blocks, and the `END_CATCH` macro terminates the sequence of catch blocks."},{"content":"With the keywords, the <bpt id=\"p1\">**</bpt>catch<ept id=\"p1\">**</ept> keyword (with its exception declaration) begins each catch block.","pos":[3637,3735],"source":"With the keywords, the **catch** keyword (with its exception declaration) begins each catch block."},{"content":"There is no counterpart to the <ph id=\"ph1\">`END_CATCH`</ph> macro; the catch block ends with its closing brace.","pos":[3736,3830],"source":" There is no counterpart to the `END_CATCH` macro; the catch block ends with its closing brace."},{"content":"The throw expression:","pos":[3840,3861]},{"content":"The macros use <ph id=\"ph1\">`THROW_LAST`</ph> to re-throw the current exception.","pos":[3872,3934],"source":"The macros use `THROW_LAST` to re-throw the current exception."},{"content":"The <ph id=\"ph1\">`throw`</ph> keyword, with no argument, has the same effect.","pos":[3935,3994],"source":" The `throw` keyword, with no argument, has the same effect."},{"pos":[4046,4066],"content":"Doing the Conversion"},{"content":"To convert code using macros to use the C++ exception-handling keywords","pos":[4077,4148]},{"pos":[4158,4273],"content":"Locate all occurrences of the MFC macros <bpt id=\"p1\">**</bpt>TRY<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>CATCH<ept id=\"p2\">**</ept>, <ph id=\"ph1\">`AND_CATCH`</ph>, <ph id=\"ph2\">`END_CATCH`</ph>, <bpt id=\"p3\">**</bpt>THROW<ept id=\"p3\">**</ept>, and <ph id=\"ph3\">`THROW_LAST`</ph>.","source":"Locate all occurrences of the MFC macros **TRY**, **CATCH**, `AND_CATCH`, `END_CATCH`, **THROW**, and `THROW_LAST`."},{"content":"Replace or delete all occurrences of the following macros:","pos":[4283,4341]},{"pos":[4352,4385],"content":"<bpt id=\"p1\">**</bpt>TRY<ept id=\"p1\">**</ept> (Replace it with <bpt id=\"p2\">**</bpt>try<ept id=\"p2\">**</ept>)","source":"**TRY** (Replace it with **try**)"},{"pos":[4396,4433],"content":"<bpt id=\"p1\">**</bpt>CATCH<ept id=\"p1\">**</ept> (Replace it with <bpt id=\"p2\">**</bpt>catch<ept id=\"p2\">**</ept>)","source":"**CATCH** (Replace it with **catch**)"},{"pos":[4456,4483],"content":"(Replace it with <bpt id=\"p1\">**</bpt>catch<ept id=\"p1\">**</ept>)","source":" (Replace it with **catch**)"},{"pos":[4506,4517],"content":"(Delete it)"},{"pos":[4528,4563],"content":"<bpt id=\"p1\">**</bpt>THROW<ept id=\"p1\">**</ept> (Replace it with <ph id=\"ph1\">`throw`</ph>)","source":"**THROW** (Replace it with `throw`)"},{"pos":[4587,4612],"content":"(Replace it with <ph id=\"ph1\">`throw`</ph>)","source":" (Replace it with `throw`)"},{"content":"Modify the macro arguments so that they form valid exception declarations.","pos":[4622,4696]},{"content":"For example, change","pos":[4707,4726]},{"pos":[4748,4767],"content":"NVC_MFCExceptions#6"},{"content":"to","pos":[4858,4860]},{"pos":[4882,4901],"content":"NVC_MFCExceptions#7"},{"content":"Modify the code in the catch blocks so that it deletes exception objects as necessary.","pos":[4991,5077]},{"content":"For more information, see the article <bpt id=\"p1\">[</bpt>Exceptions: Catching and Deleting Exceptions<ept id=\"p1\">](../mfc/exceptions-catching-and-deleting-exceptions.md)</ept>.","pos":[5078,5218],"source":" For more information, see the article [Exceptions: Catching and Deleting Exceptions](../mfc/exceptions-catching-and-deleting-exceptions.md)."},{"content":"Here is an example of exception-handling code using MFC exception macros.","pos":[5225,5298]},{"content":"Note that because the code in the following example uses the macros, the exception <ph id=\"ph1\">`e`</ph> is deleted automatically:","pos":[5299,5411],"source":" Note that because the code in the following example uses the macros, the exception `e` is deleted automatically:"},{"pos":[5429,5448],"content":"NVC_MFCExceptions#8"},{"content":"The code in the next example uses the C++ exception keywords, so the exception must be explicitly deleted:","pos":[5535,5641]},{"pos":[5659,5678],"content":"NVC_MFCExceptions#9"},{"pos":[5765,5899],"content":"For more information, see <bpt id=\"p1\">[</bpt>Exceptions: Using MFC Macros and C++ Exceptions<ept id=\"p1\">](../mfc/exceptions-using-mfc-macros-and-cpp-exceptions.md)</ept>.","source":"For more information, see [Exceptions: Using MFC Macros and C++ Exceptions](../mfc/exceptions-using-mfc-macros-and-cpp-exceptions.md)."},{"content":"See Also","pos":[5908,5916]},{"content":"Exception Handling","pos":[5921,5939]}],"content":"---\ntitle: \"Exceptions: Converting from MFC Exception Macros | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"converting exceptions\"\n  - \"exception objects\"\n  - \"conversions, code written with MFC macros\"\n  - \"keywords [C++], macros\"\n  - \"macros, C++ keywords\"\n  - \"exception objects, deleting\"\n  - \"CException class, deleting CException class objects\"\n  - \"exceptions, converting\"\n  - \"exceptions, deleting exception objects\"\n  - \"catch blocks, delimiting\"\n  - \"exception handling, converting exceptions\"\nms.assetid: bd3ac3b3-f3ce-4fdd-a168-a2cff13ed796\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Exceptions: Converting from MFC Exception Macros\nThis is an advanced topic.  \n  \n This article explains how to convert existing code written with Microsoft Foundation Class macros — **TRY**, **CATCH**, **THROW**, and so on — to use the C++ exception-handling keywords **try**, **catch**, and `throw`. Topics include:  \n  \n-   [Conversion advantages](#_core_advantages_of_converting)  \n  \n-   [Converting code with exception macros to use C++ exceptions](#_core_doing_the_conversion)  \n  \n##  <a name=\"_core_advantages_of_converting\"></a> Advantages of Converting  \n You probably do not need to convert existing code, although you should be aware of differences between the macro implementations in MFC version 3.0 and the implementations in earlier versions. These differences and subsequent changes in code behavior are discussed in [Exceptions: Changes to Exception Macros in Version 3.0](../mfc/exceptions-changes-to-exception-macros-in-version-3-0.md).  \n  \n The principal advantages of converting are:  \n  \n-   Code that uses the C++ exception-handling keywords compiles to a slightly smaller .EXE or .DLL.  \n  \n-   The C++ exception-handling keywords are more versatile: They can handle exceptions of any data type that can be copied (`int`, **float**, `char`, and so on), whereas the macros handle exceptions only of class `CException` and classes derived from it.  \n  \n The major difference between the macros and the keywords is that code using the macros \"automatically\" deletes a caught exception when the exception goes out of scope. Code using the keywords does not, so you must explicitly delete a caught exception. For more information, see the article [Exceptions: Catching and Deleting Exceptions](../mfc/exceptions-catching-and-deleting-exceptions.md).  \n  \n Another difference is syntax. The syntax for macros and keywords differs in three respects:  \n  \n1.  Macro arguments and exception declarations:  \n  \n     A **CATCH** macro invocation has the following syntax:  \n  \n     **CATCH(** *exception_class*, *exception_object_pointer_name* **)**  \n  \n     Notice the comma between the class name and the object pointer name.  \n  \n     The exception declaration for the **catch** keyword uses this syntax:  \n  \n     **catch(** *exception_type* *exception_name***)**  \n  \n     This exception declaration statement indicates the type of exception the catch block handles.  \n  \n2.  Delimitation of catch blocks:  \n  \n     With the macros, the **CATCH** macro (with its arguments) begins the first catch block; the `AND_CATCH` macro begins subsequent catch blocks, and the `END_CATCH` macro terminates the sequence of catch blocks.  \n  \n     With the keywords, the **catch** keyword (with its exception declaration) begins each catch block. There is no counterpart to the `END_CATCH` macro; the catch block ends with its closing brace.  \n  \n3.  The throw expression:  \n  \n     The macros use `THROW_LAST` to re-throw the current exception. The `throw` keyword, with no argument, has the same effect.  \n  \n##  <a name=\"_core_doing_the_conversion\"></a> Doing the Conversion  \n  \n#### To convert code using macros to use the C++ exception-handling keywords  \n  \n1.  Locate all occurrences of the MFC macros **TRY**, **CATCH**, `AND_CATCH`, `END_CATCH`, **THROW**, and `THROW_LAST`.  \n  \n2.  Replace or delete all occurrences of the following macros:  \n  \n     **TRY** (Replace it with **try**)  \n  \n     **CATCH** (Replace it with **catch**)  \n  \n     `AND_CATCH` (Replace it with **catch**)  \n  \n     `END_CATCH` (Delete it)  \n  \n     **THROW** (Replace it with `throw`)  \n  \n     `THROW_LAST` (Replace it with `throw`)  \n  \n3.  Modify the macro arguments so that they form valid exception declarations.  \n  \n     For example, change  \n  \n     [!code-cpp[NVC_MFCExceptions#6](../mfc/codesnippet/cpp/exceptions-converting-from-mfc-exception-macros_1.cpp)]  \n  \n     to  \n  \n     [!code-cpp[NVC_MFCExceptions#7](../mfc/codesnippet/cpp/exceptions-converting-from-mfc-exception-macros_2.cpp)]  \n  \n4.  Modify the code in the catch blocks so that it deletes exception objects as necessary. For more information, see the article [Exceptions: Catching and Deleting Exceptions](../mfc/exceptions-catching-and-deleting-exceptions.md).  \n  \n Here is an example of exception-handling code using MFC exception macros. Note that because the code in the following example uses the macros, the exception `e` is deleted automatically:  \n  \n [!code-cpp[NVC_MFCExceptions#8](../mfc/codesnippet/cpp/exceptions-converting-from-mfc-exception-macros_3.cpp)]  \n  \n The code in the next example uses the C++ exception keywords, so the exception must be explicitly deleted:  \n  \n [!code-cpp[NVC_MFCExceptions#9](../mfc/codesnippet/cpp/exceptions-converting-from-mfc-exception-macros_4.cpp)]  \n  \n For more information, see [Exceptions: Using MFC Macros and C++ Exceptions](../mfc/exceptions-using-mfc-macros-and-cpp-exceptions.md).  \n  \n## See Also  \n [Exception Handling](../mfc/exception-handling-in-mfc.md)\n\n"}