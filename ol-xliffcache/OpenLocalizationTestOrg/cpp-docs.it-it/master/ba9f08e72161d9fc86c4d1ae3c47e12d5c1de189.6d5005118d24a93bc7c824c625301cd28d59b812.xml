{"nodes":[{"pos":[12,55],"content":"ATL OLE DB Consumer Wizard | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ATL OLE DB Consumer Wizard | Microsoft Docs","pos":[0,43]}]},{"content":"ATL OLE DB Consumer Wizard","pos":[749,775]},{"content":"This wizard sets up an OLE DB consumer class with the data bindings necessary to access the specified data source through the specified OLE DB provider.","pos":[776,928]},{"pos":[936,1092],"content":"[!NOTE]\n This wizard requires you to click the **Data Source** button to select a data source before entering names in the `Class` and **.h file** fields.","leadings":["","> "],"nodes":[{"content":"This wizard requires you to click the <bpt id=\"p1\">**</bpt>Data Source<ept id=\"p1\">**</ept> button to select a data source before entering names in the <ph id=\"ph1\">`Class`</ph> and <bpt id=\"p2\">**</bpt>.h file<ept id=\"p2\">**</ept> fields.","pos":[9,154],"source":" This wizard requires you to click the **Data Source** button to select a data source before entering names in the `Class` and **.h file** fields."}]},{"content":"UIElement List","pos":[1101,1115]},{"content":"Data Source","pos":[1121,1132]},{"content":"The <bpt id=\"p1\">**</bpt>Data Source<ept id=\"p1\">**</ept> button lets you set up the specified data source using the specified OLE DB provider.","pos":[1138,1243],"source":" The **Data Source** button lets you set up the specified data source using the specified OLE DB provider."},{"content":"When you click this button, the <bpt id=\"p1\">**</bpt>Data Link Properties<ept id=\"p1\">**</ept> dialog box appears.","pos":[1244,1320],"source":" When you click this button, the **Data Link Properties** dialog box appears."},{"content":"For more information on building connection strings and the <bpt id=\"p1\">**</bpt>Data Link Properties<ept id=\"p1\">**</ept> dialog box, see <bpt id=\"p2\">[</bpt>Data Link API Overview<ept id=\"p2\">](https://msdn.microsoft.com/library/ms718102.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winsdkshort](../../atl-mfc-shared/reference/includes/winsdkshort_md.md)]</ph> documentation.","pos":[1321,1601],"source":" For more information on building connection strings and the **Data Link Properties** dialog box, see [Data Link API Overview](https://msdn.microsoft.com/library/ms718102.aspx) in the [!INCLUDE[winsdkshort](../../atl-mfc-shared/reference/includes/winsdkshort_md.md)] documentation."},{"pos":[1609,1800],"content":"[!NOTE]\n In previous releases, Shift-clicking the **Data Source** button opened a File Open dialog to allow you to select a Data Link (.udl) file. This functionality is no longer supported.","leadings":["","> "],"nodes":[{"content":" In previous releases, Shift-clicking the **Data Source** button opened a File Open dialog to allow you to select a Data Link (.udl) file. This functionality is no longer supported.","pos":[8,189],"nodes":[{"content":"In previous releases, Shift-clicking the <bpt id=\"p1\">**</bpt>Data Source<ept id=\"p1\">**</ept> button opened a File Open dialog to allow you to select a Data Link (.udl) file.","pos":[1,138],"source":" In previous releases, Shift-clicking the **Data Source** button opened a File Open dialog to allow you to select a Data Link (.udl) file."},{"content":"This functionality is no longer supported.","pos":[139,181]}]}]},{"content":"The dialog box has four tabs:","pos":[1807,1836]},{"pos":[1844,1860],"content":"<bpt id=\"p1\">**</bpt>Provider<ept id=\"p1\">**</ept> tab","source":"**Provider** tab"},{"pos":[1868,1886],"content":"<bpt id=\"p1\">**</bpt>Connection<ept id=\"p1\">**</ept> tab","source":"**Connection** tab"},{"pos":[1894,1910],"content":"<bpt id=\"p1\">**</bpt>Advanced<ept id=\"p1\">**</ept> tab","source":"**Advanced** tab"},{"pos":[1918,1929],"content":"<bpt id=\"p1\">**</bpt>All<ept id=\"p1\">**</ept> tab","source":"**All** tab"},{"pos":[1940,2039],"content":"The following additional information describes the tabs in the <bpt id=\"p1\">**</bpt>Data Link Properties<ept id=\"p1\">**</ept> dialog box.","source":"The following additional information describes the tabs in the **Data Link Properties** dialog box."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to finish.","pos":[2050,2073],"source":"Click **OK** to finish."},{"content":"The <bpt id=\"p1\">**</bpt>Select Database Object<ept id=\"p1\">**</ept> dialog box appears.","pos":[2074,2124],"source":" The **Select Database Object** dialog box appears."},{"content":"From this dialog box, select the table, view, or stored procedure that the consumer will use.","pos":[2125,2218]},{"pos":[2225,2475],"content":"**Provider**  \n   Select an appropriate provider to manage the connection to the data source. The type of provider is typically determined by the type of database to which you are connecting. Click the `Next` button or click the **Connection** tab.","leadings":["","  "],"nodes":[{"content":"Provider","pos":[2,10]},{"content":"   Select an appropriate provider to manage the connection to the data source. The type of provider is typically determined by the type of database to which you are connecting. Click the `Next` button or click the **Connection** tab.","pos":[15,248],"nodes":[{"content":"Select an appropriate provider to manage the connection to the data source.","pos":[3,78]},{"content":"The type of provider is typically determined by the type of database to which you are connecting.","pos":[79,176]},{"content":"Click the <ph id=\"ph1\">`Next`</ph> button or click the <bpt id=\"p1\">**</bpt>Connection<ept id=\"p1\">**</ept> tab.","pos":[177,233],"source":" Click the `Next` button or click the **Connection** tab."}]}]},{"pos":[2482,2749],"content":"**Connection**  \n   The contents of this tab depend on the provider you selected. Although there are many types of providers, this section covers connections for the two most common: SQL and ODBC data. The others are similar variations on the fields described here.","leadings":["","  "],"nodes":[{"content":"Connection","pos":[2,12]},{"content":"   The contents of this tab depend on the provider you selected. Although there are many types of providers, this section covers connections for the two most common: SQL and ODBC data. The others are similar variations on the fields described here.","pos":[17,265],"nodes":[{"content":"The contents of this tab depend on the provider you selected.","pos":[3,64]},{"content":"Although there are many types of providers, this section covers connections for the two most common: SQL and ODBC data.","pos":[65,184]},{"content":"The others are similar variations on the fields described here.","pos":[185,248]}]}]},{"content":"For SQL data:","pos":[2760,2773]},{"pos":[2786,2921],"content":"<bpt id=\"p1\">**</bpt>Select or enter a server name:<ept id=\"p1\">**</ept> Click the drop-down list menu to display all registered data servers on the network, and select one.","source":"**Select or enter a server name:** Click the drop-down list menu to display all registered data servers on the network, and select one."},{"pos":[2934,3041],"content":"<bpt id=\"p1\">**</bpt>Enter information to log on to the server:<ept id=\"p1\">**</ept> Enter a user name and password to log on to the data server.","source":"**Enter information to log on to the server:** Enter a user name and password to log on to the data server."},{"pos":[3054,3194],"content":"<bpt id=\"p1\">**</bpt>Select the database on the server:<ept id=\"p1\">**</ept> Click the drop-down list menu to display all registered databases on the data server, and select one.","source":"**Select the database on the server:** Click the drop-down list menu to display all registered databases on the data server, and select one."},{"content":"-or-","pos":[3209,3213]},{"pos":[3220,3338],"content":"<bpt id=\"p1\">**</bpt>Attach a database file as a database name:<ept id=\"p1\">**</ept> Specify a file to be used as the database; enter the explicit pathname.","source":"**Attach a database file as a database name:** Specify a file to be used as the database; enter the explicit pathname."},{"content":"Use Windows NT integrated security","pos":[3570,3604]},{"content":"Use a specific user name and password","pos":[3615,3652]},{"content":"<bpt id=\"p1\">**</bpt>Use data source name:<ept id=\"p1\">**</ept> This drop-down list displays data sources registered in your machine.","pos":[4508,4603],"source":"**Use data source name:** This drop-down list displays data sources registered in your machine."},{"content":"You can set up data sources ahead of time using the ODBC Data Source Administrator-or-<bpt id=\"p1\">**</bpt>Use connection string:<ept id=\"p1\">**</ept> Either enter a connection string you have already obtained, or click the <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept> button; the <bpt id=\"p3\">**</bpt>Select Data Source<ept id=\"p3\">**</ept> dialog box appears.","pos":[4604,4854],"source":" You can set up data sources ahead of time using the ODBC Data Source Administrator-or-**Use connection string:** Either enter a connection string you have already obtained, or click the **Build** button; the **Select Data Source** dialog box appears."},{"content":"Select a file or machine data source and click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[4855,4909],"source":" Select a file or machine data source and click **OK**."},{"pos":[5490,5844],"content":"**Advanced**  \n**Network settings:** Specify the **Impersonation level** (the level of impersonation that the server is allowed to use when impersonating the client; corresponds directly to RPC impersonation levels) and **Protection level** (the level of protection of data sent between client and server; corresponds directly to RPC protection levels).","leadings":[""," "],"nodes":[{"content":"Advanced","pos":[2,10]},{"content":"<bpt id=\"p1\">**</bpt>Network settings:<ept id=\"p1\">**</ept> Specify the <bpt id=\"p2\">**</bpt>Impersonation level<ept id=\"p2\">**</ept> (the level of impersonation that the server is allowed to use when impersonating the client; corresponds directly to RPC impersonation levels) and <bpt id=\"p3\">**</bpt>Protection level<ept id=\"p3\">**</ept> (the level of protection of data sent between client and server; corresponds directly to RPC protection levels).","pos":[15,353],"source":"**Network settings:** Specify the **Impersonation level** (the level of impersonation that the server is allowed to use when impersonating the client; corresponds directly to RPC impersonation levels) and **Protection level** (the level of protection of data sent between client and server; corresponds directly to RPC protection levels)."}]},{"content":"<bpt id=\"p1\">**</bpt>Other:<ept id=\"p1\">**</ept> In <bpt id=\"p2\">**</bpt>Connect timeout<ept id=\"p2\">**</ept>, specify the number of seconds of idle time allowed before a timeout occurs.","pos":[5851,5961],"source":"**Other:** In **Connect timeout**, specify the number of seconds of idle time allowed before a timeout occurs."},{"content":"In <bpt id=\"p1\">**</bpt>Access permissions<ept id=\"p1\">**</ept>, specify the access permissions on the data connection.","pos":[5962,6043],"source":" In **Access permissions**, specify the access permissions on the data connection."},{"content":"For more information about advanced initialization properties, refer to the documentation provided with each specific OLE DB provider.","pos":[6054,6188]},{"pos":[6195,6352],"content":"**All**  \n   This tab displays a summary of the initialization properties for the data source and connection you have specified. You can edit these values.","leadings":["","  "],"nodes":[{"content":"All","pos":[2,5]},{"content":"   This tab displays a summary of the initialization properties for the data source and connection you have specified. You can edit these values.","pos":[10,155],"nodes":[{"content":"This tab displays a summary of the initialization properties for the data source and connection you have specified.","pos":[3,118]},{"content":"You can edit these values.","pos":[119,145]}]}]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to finish.","pos":[6363,6386],"source":"Click **OK** to finish."},{"content":"The <bpt id=\"p1\">**</bpt>Select Database Object<ept id=\"p1\">**</ept> dialog box appears.","pos":[6387,6437],"source":" The **Select Database Object** dialog box appears."},{"content":"From this dialog box, select the table, view, or stored procedure that the consumer will use.","pos":[6438,6531]},{"pos":[6538,6752],"content":"`Class`  \nAfter you select a data source, this box is populated with a default class name based on the table or stored procedure that you selected (see **Select a data source** below). You can edit the class name.","leadings":[""," "],"nodes":[{"content":"After you select a data source, this box is populated with a default class name based on the table or stored procedure that you selected (see **Select a data source** below). You can edit the class name.","pos":[10,213],"nodes":[{"content":"After you select a data source, this box is populated with a default class name based on the table or stored procedure that you selected (see <bpt id=\"p1\">**</bpt>Select a data source<ept id=\"p1\">**</ept> below).","pos":[0,174],"source":"After you select a data source, this box is populated with a default class name based on the table or stored procedure that you selected (see **Select a data source** below)."},{"content":"You can edit the class name.","pos":[175,203]}]}]},{"pos":[6759,7026],"content":"**.h file**  \nAfter you select a data source, this box is populated with a default header class name based on the table or stored procedure that you selected (see **Select a data source** below). You can edit the header file's name or select an existing header file.","leadings":[""," "],"nodes":[{"content":".h file","pos":[2,9]},{"content":"After you select a data source, this box is populated with a default header class name based on the table or stored procedure that you selected (see **Select a data source** below). You can edit the header file's name or select an existing header file.","pos":[14,266],"nodes":[{"content":"After you select a data source, this box is populated with a default header class name based on the table or stored procedure that you selected (see <bpt id=\"p1\">**</bpt>Select a data source<ept id=\"p1\">**</ept> below).","pos":[0,181],"source":"After you select a data source, this box is populated with a default header class name based on the table or stored procedure that you selected (see **Select a data source** below)."},{"content":"You can edit the header file's name or select an existing header file.","pos":[182,252]}]}]},{"pos":[7033,7374],"content":"**Attributed**  \nThis option specifies whether the wizard will create consumer classes using attributes or template declarations. When you select this option, the wizard uses attributes instead of template declarations (this is the default option). When you deselect this option, the wizard uses template declarations instead of attributes.","leadings":[""," "],"nodes":[{"content":"Attributed","pos":[2,12]},{"content":"This option specifies whether the wizard will create consumer classes using attributes or template declarations. When you select this option, the wizard uses attributes instead of template declarations (this is the default option). When you deselect this option, the wizard uses template declarations instead of attributes.","pos":[17,340],"nodes":[{"content":"This option specifies whether the wizard will create consumer classes using attributes or template declarations.","pos":[0,112]},{"content":"When you select this option, the wizard uses attributes instead of template declarations (this is the default option).","pos":[113,231]},{"content":"When you deselect this option, the wizard uses template declarations instead of attributes.","pos":[232,323]}]}]},{"pos":[7384,7608],"content":"If you select a consumer <bpt id=\"p1\">**</bpt>Type<ept id=\"p1\">**</ept> of Table, the wizard uses the <ph id=\"ph1\">`db_source`</ph> and <bpt id=\"p2\">**</bpt>db_table<ept id=\"p2\">**</ept> attributes to create the table and table accessor class declarations, and uses <bpt id=\"p3\">**</bpt>db_column<ept id=\"p3\">**</ept> to create the column map, for example:","source":"If you select a consumer **Type** of Table, the wizard uses the `db_source` and **db_table** attributes to create the table and table accessor class declarations, and uses **db_column** to create the column map, for example:"},{"pos":[7615,7988],"content":"``` *// Inject table class and table accessor class declarations  \n[  \ndb_source(\"<initialization_string>\"), \ndb_table(\"dbo.Orders\") \n]  \n... *// Column map  \n[ db_column(1, status=m_dwOrderIDStatus,      length=m_dwOrderIDLength) ] LONG m_OrderID;  \n[ db_column(2, status=m_dwCustomerIDStatus,      length=m_dwCustomerIDLength) ] TCHAR m_CustomerID[6];  \n...","leadings":[""," ","    ","    "," "," "," "," "," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>// Inject table class and table accessor class declarations [ db_source(\"&lt;initialization_string&gt;\"), db_table(\"dbo.Orders\") ] ... <ept id=\"p1\">*</ept>// Column map","pos":[4,156],"source":"*// Inject table class and table accessor class declarations  \n[  \ndb_source(\"<initialization_string>\"), \ndb_table(\"dbo.Orders\") \n]  \n... *// Column map"},{"content":"[ db_column(1, status=m_dwOrderIDStatus,      length=m_dwOrderIDLength) ] LONG m_OrderID;","pos":[159,248]},{"content":"[ db_column(2, status=m_dwCustomerIDStatus,      length=m_dwCustomerIDLength) ] TCHAR m_CustomerID[6];","pos":[251,353]},{"content":"...","pos":[356,359]}]},{"pos":[8634,8804],"content":"If you select a consumer <bpt id=\"p1\">**</bpt>Type<ept id=\"p1\">**</ept> of Command, the wizard uses the <ph id=\"ph1\">`db_source`</ph> and <bpt id=\"p2\">**</bpt>db_command<ept id=\"p2\">**</ept> attributes, and uses <bpt id=\"p3\">**</bpt>db_column<ept id=\"p3\">**</ept> to create the column map, for example:","source":"If you select a consumer **Type** of Command, the wizard uses the `db_source` and **db_command** attributes, and uses **db_column** to create the column map, for example:"},{"content":"instead of using the command and command accessor class declarations in the command class' .h file, for example:","pos":[8998,9110]},{"pos":[9405,9510],"content":"See <bpt id=\"p1\">[</bpt>Basic Mechanics of Attributes<ept id=\"p1\">](../../windows/basic-mechanics-of-attributes.md)</ept> for more information.","source":"See [Basic Mechanics of Attributes](../../windows/basic-mechanics-of-attributes.md) for more information."},{"pos":[9517,9655],"content":"**Type**  \nSelect one of these radio buttons to specify whether the consumer class will be derived from `CTable` or `CCommand` (default).","leadings":[""," "],"nodes":[{"content":"Type","pos":[2,6]},{"content":"Select one of these radio buttons to specify whether the consumer class will be derived from <ph id=\"ph1\">`CTable`</ph> or <ph id=\"ph2\">`CCommand`</ph> (default).","pos":[11,137],"source":"Select one of these radio buttons to specify whether the consumer class will be derived from `CTable` or `CCommand` (default)."}]},{"pos":[9662,9796],"content":"**Table**  \nSelect this option if you want to use `CTable` or **db_table** to create the table and table accessor class declarations.","leadings":[""," "],"nodes":[{"content":"Table","pos":[2,7]},{"content":"Select this option if you want to use <ph id=\"ph1\">`CTable`</ph> or <bpt id=\"p1\">**</bpt>db_table<ept id=\"p1\">**</ept> to create the table and table accessor class declarations.","pos":[12,133],"source":"Select this option if you want to use `CTable` or **db_table** to create the table and table accessor class declarations."}]},{"pos":[9803,9978],"content":"**Command**  \nSelect this option if you want to use `CCommand` or **db_command** to create the command and command accessor class declarations. This is the default selection.","leadings":[""," "],"nodes":[{"content":"Command","pos":[2,9]},{"content":"Select this option if you want to use `CCommand` or **db_command** to create the command and command accessor class declarations. This is the default selection.","pos":[14,174],"nodes":[{"content":"Select this option if you want to use <ph id=\"ph1\">`CCommand`</ph> or <bpt id=\"p1\">**</bpt>db_command<ept id=\"p1\">**</ept> to create the command and command accessor class declarations.","pos":[0,129],"source":"Select this option if you want to use `CCommand` or **db_command** to create the command and command accessor class declarations."},{"content":"This is the default selection.","pos":[130,160]}]}]},{"pos":[9985,10342],"content":"**Support**  \nSelect the check boxes to specify the kinds of updates to be supported in the consumer (the default is none). Each of the following will set [DBPROP_IRowsetChange](https://msdn.microsoft.com/library/ms715892.aspx) and the appropriate entries for [DBPROP_UPDATABILITY](https://msdn.microsoft.com/library/ms722676.aspx) in the property set map.","leadings":[""," "],"nodes":[{"content":"Support","pos":[2,9]},{"content":"Select the check boxes to specify the kinds of updates to be supported in the consumer (the default is none). Each of the following will set [DBPROP_IRowsetChange](https://msdn.microsoft.com/library/ms715892.aspx) and the appropriate entries for [DBPROP_UPDATABILITY](https://msdn.microsoft.com/library/ms722676.aspx) in the property set map.","pos":[14,356],"nodes":[{"content":"Select the check boxes to specify the kinds of updates to be supported in the consumer (the default is none).","pos":[0,109]},{"content":"Each of the following will set <bpt id=\"p1\">[</bpt>DBPROP_IRowsetChange<ept id=\"p1\">](https://msdn.microsoft.com/library/ms715892.aspx)</ept> and the appropriate entries for <bpt id=\"p2\">[</bpt>DBPROP_UPDATABILITY<ept id=\"p2\">](https://msdn.microsoft.com/library/ms722676.aspx)</ept> in the property set map.","pos":[110,342],"source":" Each of the following will set [DBPROP_IRowsetChange](https://msdn.microsoft.com/library/ms715892.aspx) and the appropriate entries for [DBPROP_UPDATABILITY](https://msdn.microsoft.com/library/ms722676.aspx) in the property set map."}]}]},{"pos":[10349,10433],"content":"**Change**  \nSpecifies that the consumer support updates of row data in the rowset.","leadings":[""," "],"nodes":[{"content":"Change","pos":[2,8]},{"content":"Specifies that the consumer support updates of row data in the rowset.","pos":[13,83]}]},{"pos":[10440,10524],"content":"**Insert**  \nSpecifies that the consumer support insertion of rows into the rowset.","leadings":[""," "],"nodes":[{"content":"Insert","pos":[2,8]},{"content":"Specifies that the consumer support insertion of rows into the rowset.","pos":[13,83]}]},{"pos":[10531,10614],"content":"**Delete**  \nSpecifies that the consumer support deletion of rows from the rowset.","leadings":[""," "],"nodes":[{"content":"Delete","pos":[2,8]},{"content":"Specifies that the consumer support deletion of rows from the rowset.","pos":[13,82]}]},{"content":"See Also","pos":[10623,10631]},{"content":"ATL OLE DB Consumer","pos":[10636,10655]},{"content":"Adding Functionality with Code Wizards","pos":[10716,10754]},{"content":"Connection Strings and Data Links (OLE DB)","pos":[10818,10860]}],"content":"---\ntitle: \"ATL OLE DB Consumer Wizard | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"vc.codewiz.class.atl.consumer.overview\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ATL projects, adding ATL OLE DB consumers\"\n  - \"connection strings [C++], OLE DB consumers\"\n  - \"ATL OLE DB Consumer Wizard\"\nms.assetid: dcb68ed1-2224-422f-9f7b-108a74864204\ncaps.latest.revision: 13\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# ATL OLE DB Consumer Wizard\nThis wizard sets up an OLE DB consumer class with the data bindings necessary to access the specified data source through the specified OLE DB provider.  \n  \n> [!NOTE]\n>  This wizard requires you to click the **Data Source** button to select a data source before entering names in the `Class` and **.h file** fields.  \n  \n## UIElement List  \n **Data Source**  \n The **Data Source** button lets you set up the specified data source using the specified OLE DB provider. When you click this button, the **Data Link Properties** dialog box appears. For more information on building connection strings and the **Data Link Properties** dialog box, see [Data Link API Overview](https://msdn.microsoft.com/library/ms718102.aspx) in the [!INCLUDE[winsdkshort](../../atl-mfc-shared/reference/includes/winsdkshort_md.md)] documentation.  \n  \n> [!NOTE]\n>  In previous releases, Shift-clicking the **Data Source** button opened a File Open dialog to allow you to select a Data Link (.udl) file. This functionality is no longer supported.  \n  \n The dialog box has four tabs:  \n  \n- **Provider** tab  \n  \n- **Connection** tab  \n  \n- **Advanced** tab  \n  \n- **All** tab  \n  \n     The following additional information describes the tabs in the **Data Link Properties** dialog box.  \n  \n     Click **OK** to finish. The **Select Database Object** dialog box appears. From this dialog box, select the table, view, or stored procedure that the consumer will use.  \n  \n **Provider**  \n     Select an appropriate provider to manage the connection to the data source. The type of provider is typically determined by the type of database to which you are connecting. Click the `Next` button or click the **Connection** tab.  \n  \n **Connection**  \n     The contents of this tab depend on the provider you selected. Although there are many types of providers, this section covers connections for the two most common: SQL and ODBC data. The others are similar variations on the fields described here.  \n  \n     For SQL data:  \n  \n    1. **Select or enter a server name:** Click the drop-down list menu to display all registered data servers on the network, and select one.  \n  \n    2. **Enter information to log on to the server:** Enter a user name and password to log on to the data server.  \n  \n    3. **Select the database on the server:** Click the drop-down list menu to display all registered databases on the data server, and select one.  \n  \n         -or-  \n  \n **Attach a database file as a database name:** Specify a file to be used as the database; enter the explicit pathname.  \n  \n        > [!NOTE]\n        >  There is a security problem with the \"Allow saving of password\" feature of the Data Link Properties dialog box. In \"Enter information to log on to the server,\" there are two radio buttons:  \n  \n **Use Windows NT integrated security**  \n  \n **Use a specific user name and password**  \n  \n         If you select **Use a specific user name and password**, you have the option of saving the password (using the check box for \"Allow saving password\"); however, this option is not secure. It is recommended that you select **Use Windows NT integrated security**; this option is secure because it encrypts the password.  \n  \n         There might be situations in which you want to select \"Allow saving password.\" For example, if you are releasing a library with a private database solution, you should not access the database directly but instead use a middle-tier application to verify the user (through whatever authentication scheme you choose) and then limit the sort of data available to the user.  \n  \n         For ODBC data:  \n  \n         1. **Specify the source of data:** You can use a data source name or a connection string.  \n  \n **Use data source name:** This drop-down list displays data sources registered in your machine. You can set up data sources ahead of time using the ODBC Data Source Administrator-or-**Use connection string:** Either enter a connection string you have already obtained, or click the **Build** button; the **Select Data Source** dialog box appears. Select a file or machine data source and click **OK**.  \n  \n        > [!NOTE]\n        >  You can obtain a connection string by viewing the properties of an existing connection in Server Explorer, or you can create a connection by double-clicking **Add Connection** in Server Explorer.  \n  \n         2. **Enter information to log on to the server:** Enter a user name and password to log on to the data server.  \n  \n         3. Enter the initial catalog to use.  \n  \n         4. Click **Test Connection**; if the test succeeds, click **OK**. If not, check your logon information, try another database, or try another data server.  \n  \n **Advanced**  \n **Network settings:** Specify the **Impersonation level** (the level of impersonation that the server is allowed to use when impersonating the client; corresponds directly to RPC impersonation levels) and **Protection level** (the level of protection of data sent between client and server; corresponds directly to RPC protection levels).  \n  \n **Other:** In **Connect timeout**, specify the number of seconds of idle time allowed before a timeout occurs. In **Access permissions**, specify the access permissions on the data connection.  \n  \n     For more information about advanced initialization properties, refer to the documentation provided with each specific OLE DB provider.  \n  \n **All**  \n     This tab displays a summary of the initialization properties for the data source and connection you have specified. You can edit these values.  \n  \n     Click **OK** to finish. The **Select Database Object** dialog box appears. From this dialog box, select the table, view, or stored procedure that the consumer will use.  \n  \n `Class`  \n After you select a data source, this box is populated with a default class name based on the table or stored procedure that you selected (see **Select a data source** below). You can edit the class name.  \n  \n **.h file**  \n After you select a data source, this box is populated with a default header class name based on the table or stored procedure that you selected (see **Select a data source** below). You can edit the header file's name or select an existing header file.  \n  \n **Attributed**  \n This option specifies whether the wizard will create consumer classes using attributes or template declarations. When you select this option, the wizard uses attributes instead of template declarations (this is the default option). When you deselect this option, the wizard uses template declarations instead of attributes.  \n  \n-   If you select a consumer **Type** of Table, the wizard uses the `db_source` and **db_table** attributes to create the table and table accessor class declarations, and uses **db_column** to create the column map, for example:  \n  \n ``` *// Inject table class and table accessor class declarations  \n [  \n    db_source(\"<initialization_string>\"), \n    db_table(\"dbo.Orders\") \n ]  \n ... *// Column map  \n [ db_column(1, status=m_dwOrderIDStatus,      length=m_dwOrderIDLength) ] LONG m_OrderID;  \n [ db_column(2, status=m_dwCustomerIDStatus,      length=m_dwCustomerIDLength) ] TCHAR m_CustomerID[6];  \n ...  \n ```  \n  \n     instead of using the `CTable` template class to declare the table and table accessor class, and the BEGIN_COLUMN_MAP and END_COLUMN_MAP macros to create the column map, for example:  \n  \n ``` *// Table accessor class  \n    class COrdersAccessor; *// Table class  \n    class COrders : public CTable<CAccessor<COrdersAccessor>>;  \n ... *// Column map  \n    BEGIN_COLUMN_MAP(COrderDetailsAccessor) \n    COLUMN_ENTRY_LENGTH_STATUS(1, m_OrderID,      m_dwOrderIDLength, m_dwOrderIDStatus)  \n    COLUMN_ENTRY_LENGTH_STATUS(2, m_CustomerID,      m_dwCustomerIDLength, m_dwCustomerIDStatus)  \n ...  \n    END_COLUMN_MAP() \n ```  \n  \n-   If you select a consumer **Type** of Command, the wizard uses the `db_source` and **db_command** attributes, and uses **db_column** to create the column map, for example:  \n  \n ```  \n [  \n    db_source(\"<initialization_string>\"), \n    db_command(\"SQL_command\") \n ]  \n ... *// Column map using db_column is the same as for consumer type of 'table'  \n ```  \n  \n     instead of using the command and command accessor class declarations in the command class' .h file, for example:  \n  \n ```  \n    Command accessor class:  \n    class CListOrdersAccessor;  \n    Command class:  \n    class CListOrders : public CCommand<CAccessor<CListOrdersAccessor>>;  \n ... *// Column map using BEGIN_COLUMN_MAP ... END_COLUMN_MAP is the same as *// for consumer type of 'table'  \n ```  \n  \n See [Basic Mechanics of Attributes](../../windows/basic-mechanics-of-attributes.md) for more information.  \n  \n **Type**  \n Select one of these radio buttons to specify whether the consumer class will be derived from `CTable` or `CCommand` (default).  \n  \n **Table**  \n Select this option if you want to use `CTable` or **db_table** to create the table and table accessor class declarations.  \n  \n **Command**  \n Select this option if you want to use `CCommand` or **db_command** to create the command and command accessor class declarations. This is the default selection.  \n  \n **Support**  \n Select the check boxes to specify the kinds of updates to be supported in the consumer (the default is none). Each of the following will set [DBPROP_IRowsetChange](https://msdn.microsoft.com/library/ms715892.aspx) and the appropriate entries for [DBPROP_UPDATABILITY](https://msdn.microsoft.com/library/ms722676.aspx) in the property set map.  \n  \n **Change**  \n Specifies that the consumer support updates of row data in the rowset.  \n  \n **Insert**  \n Specifies that the consumer support insertion of rows into the rowset.  \n  \n **Delete**  \n Specifies that the consumer support deletion of rows from the rowset.  \n  \n## See Also  \n [ATL OLE DB Consumer](../../atl/reference/adding-an-atl-ole-db-consumer.md)   \n [Adding Functionality with Code Wizards](../../ide/adding-functionality-with-code-wizards-cpp.md)   \n [Connection Strings and Data Links (OLE DB)](https://msdn.microsoft.com/library/ms718376.aspx)\n"}