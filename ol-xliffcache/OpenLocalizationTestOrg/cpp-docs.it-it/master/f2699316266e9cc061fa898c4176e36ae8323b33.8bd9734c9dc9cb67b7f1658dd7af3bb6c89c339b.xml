{"nodes":[{"pos":[12,59],"content":"AFX_EXTENSION_MODULE Structure | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"AFX_EXTENSION_MODULE Structure | Microsoft Docs","pos":[0,47]}]},{"pos":[640,670],"content":"AFX_EXTENSION_MODULE Structure","linkify":"AFX_EXTENSION_MODULE Structure","nodes":[{"content":"AFX_EXTENSION_MODULE Structure","pos":[0,30]}]},{"pos":[671,792],"content":"The <ph id=\"ph1\">`AFX_EXTENSION_MODULE`</ph> is used during initialization of MFC extension DLLs to hold the state of extension DLL module.","source":"The `AFX_EXTENSION_MODULE` is used during initialization of MFC extension DLLs to hold the state of extension DLL module."},{"pos":[801,807],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1031,1041],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>bInitialized<ept id=\"p1\">*</ept>","pos":[1045,1059],"source":"*bInitialized*"},{"content":"<bpt id=\"p1\"> **</bpt>TRUE<ept id=\"p1\">**</ept> if the DLL module has been initialized with <ph id=\"ph1\">`AfxInitExtensionModule`</ph>.","pos":[1062,1141],"source":" **TRUE** if the DLL module has been initialized with `AfxInitExtensionModule`."},{"content":"Specifies the handle of the DLL module.","pos":[1161,1200]},{"content":"<bpt id=\"p1\">*</bpt>hResource<ept id=\"p1\">*</ept>","pos":[1207,1218],"source":"*hResource*"},{"content":"Specifies the handle of the DLL custom resource module.","pos":[1222,1277]},{"content":"<bpt id=\"p1\">*</bpt>pFirstSharedClass<ept id=\"p1\">*</ept>","pos":[1284,1303],"source":"*pFirstSharedClass*"},{"content":"A pointer to information (the <ph id=\"ph1\">`CRuntimeClass`</ph> structure) about the DLL module's first runtime class.","pos":[1307,1407],"source":" A pointer to information (the `CRuntimeClass` structure) about the DLL module's first runtime class."},{"content":"Used to provide the start of the runtime class list.","pos":[1408,1460]},{"content":"<bpt id=\"p1\">*</bpt>pFirstSharedFactory<ept id=\"p1\">*</ept>","pos":[1467,1488],"source":"*pFirstSharedFactory*"},{"content":"A pointer to the DLL module's first object factory (a <ph id=\"ph1\">`COleObjectFactory`</ph> object).","pos":[1492,1574],"source":" A pointer to the DLL module's first object factory (a `COleObjectFactory` object)."},{"content":"Used to provide the start of the class factory list.","pos":[1575,1627]},{"pos":[1636,1643],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1647,1716],"content":"MFC extension DLLs need to do two things in their <ph id=\"ph1\">`DllMain`</ph> function:","source":"MFC extension DLLs need to do two things in their `DllMain` function:"},{"pos":[1726,1855],"content":"Call <bpt id=\"p1\">[</bpt>AfxInitExtensionModule<ept id=\"p1\">](http://msdn.microsoft.com/library/15f0c820-ff34-4da6-8077-79afbbb8dac1)</ept> and check the return value.","source":"Call [AfxInitExtensionModule](http://msdn.microsoft.com/library/15f0c820-ff34-4da6-8077-79afbbb8dac1) and check the return value."},{"pos":[1865,2034],"content":"Create a <bpt id=\"p1\">**</bpt>CDynLinkLibrary<ept id=\"p1\">**</ept> object if the DLL will be exporting <bpt id=\"p2\">[</bpt>CRuntimeClass<ept id=\"p2\">](../../mfc/reference/cruntimeclass-structure.md)</ept> objects or has its own custom resources.","source":"Create a **CDynLinkLibrary** object if the DLL will be exporting [CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md) objects or has its own custom resources."},{"content":"The <ph id=\"ph1\">`AFX_EXTENSION_MODULE`</ph> structure is used to hold a copy of the extension DLL module state, including a copy of the runtime class objects that have been initialized by the extension DLL as part of normal static object construction executed before <ph id=\"ph2\">`DllMain`</ph> is entered.","pos":[2041,2312],"source":"The `AFX_EXTENSION_MODULE` structure is used to hold a copy of the extension DLL module state, including a copy of the runtime class objects that have been initialized by the extension DLL as part of normal static object construction executed before `DllMain` is entered."},{"content":"For example:","pos":[2313,2325]},{"pos":[2332,2433],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFC_DLL#2<ept id=\"p2\">](../../atl-mfc-shared/codesnippet/cpp/afx-extension-module-structure_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFC_DLL#2](../../atl-mfc-shared/codesnippet/cpp/afx-extension-module-structure_1.cpp)]"},{"content":"The module information stored in the <ph id=\"ph1\">`AFX_EXTENSION_MODULE`</ph> structure can be copied into the <bpt id=\"p1\">**</bpt>CDynLinkLibrary<ept id=\"p1\">**</ept> object.","pos":[2440,2560],"source":"The module information stored in the `AFX_EXTENSION_MODULE` structure can be copied into the **CDynLinkLibrary** object."},{"content":"For example:","pos":[2561,2573]},{"pos":[2580,2681],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFC_DLL#5<ept id=\"p2\">](../../atl-mfc-shared/codesnippet/cpp/afx-extension-module-structure_2.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFC_DLL#5](../../atl-mfc-shared/codesnippet/cpp/afx-extension-module-structure_2.cpp)]"},{"pos":[2690,2702],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2706,2723],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afx.h","source":"**Header:** afx.h"},{"pos":[2732,2740],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Structures, Styles, Callbacks, and Message Maps<ept id=\"p1\">](../../mfc/reference/structures-styles-callbacks-and-message-maps.md)</ept><ph id=\"ph1\"> </ph>","pos":[2744,2863],"source":"[Structures, Styles, Callbacks, and Message Maps](../../mfc/reference/structures-styles-callbacks-and-message-maps.md) "},{"content":"<bpt id=\"p1\"> [</bpt>AfxInitExtensionModule<ept id=\"p1\">](http://msdn.microsoft.com/library/15f0c820-ff34-4da6-8077-79afbbb8dac1)</ept><ph id=\"ph1\"> </ph>","pos":[2866,2964],"source":" [AfxInitExtensionModule](http://msdn.microsoft.com/library/15f0c820-ff34-4da6-8077-79afbbb8dac1) "},{"content":"<bpt id=\"p1\"> [</bpt>AfxTermExtensionModule<ept id=\"p1\">](http://msdn.microsoft.com/library/b64de402-f1e3-4c26-9823-08c07876aaaa)</ept>","pos":[2967,3064],"source":" [AfxTermExtensionModule](http://msdn.microsoft.com/library/b64de402-f1e3-4c26-9823-08c07876aaaa)"}],"content":"---\ntitle: \"AFX_EXTENSION_MODULE Structure | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"AFX_EXTENSION_MODULE\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"AFX_EXTENSION_MODULE structure\"\nms.assetid: b85a989c-d0c5-4b28-b53c-dad45b75704e\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# AFX_EXTENSION_MODULE Structure\nThe `AFX_EXTENSION_MODULE` is used during initialization of MFC extension DLLs to hold the state of extension DLL module.  \n  \n## Syntax  \n  \n```  \nstruct AFX_EXTENSION_MODULE  \n{  \n    BOOL bInitialized;  \n    HMODULE hModule;  \n    HMODULE hResource;  \n    CRuntimeClass* pFirstSharedClass;  \n    COleObjectFactory* pFirstSharedFactory;  \n};  \n```  \n  \n#### Parameters  \n *bInitialized*  \n **TRUE** if the DLL module has been initialized with `AfxInitExtensionModule`.  \n  \n `hModule`  \n Specifies the handle of the DLL module.  \n  \n *hResource*  \n Specifies the handle of the DLL custom resource module.  \n  \n *pFirstSharedClass*  \n A pointer to information (the `CRuntimeClass` structure) about the DLL module's first runtime class. Used to provide the start of the runtime class list.  \n  \n *pFirstSharedFactory*  \n A pointer to the DLL module's first object factory (a `COleObjectFactory` object). Used to provide the start of the class factory list.  \n  \n## Remarks  \n MFC extension DLLs need to do two things in their `DllMain` function:  \n  \n-   Call [AfxInitExtensionModule](http://msdn.microsoft.com/library/15f0c820-ff34-4da6-8077-79afbbb8dac1) and check the return value.  \n  \n-   Create a **CDynLinkLibrary** object if the DLL will be exporting [CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md) objects or has its own custom resources.  \n  \n The `AFX_EXTENSION_MODULE` structure is used to hold a copy of the extension DLL module state, including a copy of the runtime class objects that have been initialized by the extension DLL as part of normal static object construction executed before `DllMain` is entered. For example:  \n  \n [!code-cpp[NVC_MFC_DLL#2](../../atl-mfc-shared/codesnippet/cpp/afx-extension-module-structure_1.cpp)]  \n  \n The module information stored in the `AFX_EXTENSION_MODULE` structure can be copied into the **CDynLinkLibrary** object. For example:  \n  \n [!code-cpp[NVC_MFC_DLL#5](../../atl-mfc-shared/codesnippet/cpp/afx-extension-module-structure_2.cpp)]  \n  \n## Requirements  \n **Header:** afx.h  \n  \n## See Also  \n [Structures, Styles, Callbacks, and Message Maps](../../mfc/reference/structures-styles-callbacks-and-message-maps.md)   \n [AfxInitExtensionModule](http://msdn.microsoft.com/library/15f0c820-ff34-4da6-8077-79afbbb8dac1)   \n [AfxTermExtensionModule](http://msdn.microsoft.com/library/b64de402-f1e3-4c26-9823-08c07876aaaa)\n\n"}