{"nodes":[{"pos":[12,54],"content":"CAtlPreviewCtrlImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CAtlPreviewCtrlImpl Class | Microsoft Docs","pos":[0,42]}]},{"content":"CAtlPreviewCtrlImpl Class","pos":[681,706]},{"content":"This class is an ATL implementation of a window that is placed on a host window provided by the Shell  for Rich Preview.","pos":[707,827]},{"pos":[835,945],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the Windows Runtime.","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the Windows Runtime.","pos":[14,108]}]},{"content":"Syntax","pos":[954,960]},{"content":"Members","pos":[1072,1079]},{"content":"Public Constructors","pos":[1089,1108]},{"content":"Name","pos":[1115,1119]},{"content":"Description","pos":[1120,1131]},{"content":"CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl","pos":[1170,1211]},{"content":"Destructs a preview control object.","pos":[1261,1296]},{"content":"CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl","pos":[1302,1342]},{"content":"Constructs a preview control object.","pos":[1387,1423]},{"content":"Public Methods","pos":[1434,1448]},{"content":"Name","pos":[1455,1459]},{"content":"Description","pos":[1460,1471]},{"content":"CAtlPreviewCtrlImpl::Create","pos":[1510,1537]},{"content":"Called by a Rich Preview handler to create the Windows window.","pos":[1569,1631]},{"content":"CAtlPreviewCtrlImpl::Destroy","pos":[1637,1665]},{"content":"Called by a Rich Preview handler when it needs to destroy this control.","pos":[1698,1769]},{"content":"CAtlPreviewCtrlImpl::Focus","pos":[1775,1801]},{"content":"Sets input focus to this control.","pos":[1832,1865]},{"content":"CAtlPreviewCtrlImpl::OnPaint","pos":[1871,1899]},{"content":"Handles the WM_PAINT message.","pos":[1932,1961]},{"content":"CAtlPreviewCtrlImpl::Redraw","pos":[1967,1994]},{"content":"Tells this control to redraw.","pos":[2026,2055]},{"content":"CAtlPreviewCtrlImpl::SetHost","pos":[2061,2089]},{"content":"Sets a new parent for this control.","pos":[2122,2157]},{"content":"CAtlPreviewCtrlImpl::SetPreviewVisuals","pos":[2163,2201]},{"content":"Called by a Rich Preview handler when it needs to set visuals of rich preview content.","pos":[2244,2330]},{"content":"CAtlPreviewCtrlImpl::SetRect","pos":[2336,2364]},{"content":"Sets a new bounding rectangle for this control.","pos":[2397,2444]},{"content":"Protected Methods","pos":[2455,2472]},{"content":"Name","pos":[2479,2483]},{"content":"Description","pos":[2484,2495]},{"content":"CAtlPreviewCtrlImpl::DoPaint","pos":[2534,2562]},{"content":"Called by the framework to render the preview.","pos":[2595,2641]},{"content":"Protected Constants","pos":[2652,2671]},{"content":"Name","pos":[2678,2682]},{"content":"Description","pos":[2683,2694]},{"content":"CAtlPreviewCtrlImpl::m_plf","pos":[2733,2759]},{"content":"Font used to display text in the preview window.","pos":[2790,2838]},{"content":"Protected Data Members","pos":[2849,2871]},{"content":"Name","pos":[2878,2882]},{"content":"Description","pos":[2883,2894]},{"content":"CAtlPreviewCtrlImpl::m_clrBack","pos":[2933,2963]},{"content":"Background color of the preview window.","pos":[2998,3037]},{"content":"CAtlPreviewCtrlImpl::m_clrText","pos":[3043,3073]},{"content":"Text color of preview window.","pos":[3108,3137]},{"content":"Remarks","pos":[3148,3155]},{"content":"Inheritance Hierarchy","pos":[3164,3185]},{"content":"ATL::CWindowImpl<ph id=\"ph1\">\\&lt;</ph>CAtlPreviewCtrlImpl&gt;","pos":[3313,3351],"source":"ATL::CWindowImpl\\<CAtlPreviewCtrlImpl>"},{"content":"Requirements","pos":[3457,3469]},{"pos":[3473,3505],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlpreviewctrlimpl.h","source":"**Header:** atlpreviewctrlimpl.h"},{"pos":[3572,3612],"content":"CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl"},{"content":"Constructs a preview control object.","pos":[3616,3652]},{"content":"Remarks","pos":[3771,3778]},{"pos":[3850,3891],"content":"CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl"},{"content":"Destructs a preview control object.","pos":[3895,3930]},{"content":"Remarks","pos":[3989,3996]},{"pos":[4050,4077],"content":"CAtlPreviewCtrlImpl::Create"},{"content":"Called by a Rich Preview handler to create the Windows window.","pos":[4081,4143]},{"content":"Parameters","pos":[4222,4232]},{"content":"A handle to the host window supplied by the Shell for Rich Preview.","pos":[4252,4319]},{"content":"Specifies the initial size and position of the window.","pos":[4335,4389]},{"content":"Return Value","pos":[4399,4411]},{"pos":[4422,4455],"content":"if successful; otherwise <ph id=\"ph1\">`FALSE`</ph>.","source":" if successful; otherwise `FALSE`."},{"content":"Remarks","pos":[4465,4472]},{"pos":[4527,4555],"content":"CAtlPreviewCtrlImpl::Destroy"},{"content":"Called by a Rich Preview handler when it needs to destroy this control.","pos":[4559,4630]},{"content":"Remarks","pos":[4677,4684]},{"pos":[4739,4767],"content":"CAtlPreviewCtrlImpl::DoPaint"},{"content":"Called by the framework to render the preview.","pos":[4771,4817]},{"content":"Parameters","pos":[4871,4881]},{"content":"A handle to a device context for painting.","pos":[4894,4936]},{"content":"Remarks","pos":[4946,4953]},{"pos":[5006,5032],"content":"CAtlPreviewCtrlImpl::Focus"},{"content":"Sets input focus to this control.","pos":[5036,5069]},{"content":"Remarks","pos":[5114,5121]},{"pos":[5178,5208],"content":"CAtlPreviewCtrlImpl::m_clrBack"},{"content":"Background color of the preview window.","pos":[5212,5251]},{"content":"Remarks","pos":[5294,5301]},{"pos":[5358,5388],"content":"CAtlPreviewCtrlImpl::m_clrText"},{"content":"Text color of the preview window.","pos":[5392,5425]},{"content":"Remarks","pos":[5468,5475]},{"pos":[5528,5554],"content":"CAtlPreviewCtrlImpl::m_plf"},{"content":"Font used to display text in the preview window.","pos":[5558,5606]},{"content":"Remarks","pos":[5652,5659]},{"pos":[5714,5742],"content":"CAtlPreviewCtrlImpl::OnPaint"},{"content":"Handles the WM_PAINT message.","pos":[5746,5775]},{"content":"Parameters","pos":[5884,5894]},{"content":"Set to WM_PAINT.","pos":[5908,5924]},{"content":"This parameter is not used.","pos":[5943,5970]},{"content":"This parameter is not used.","pos":[5989,6016]},{"content":"When this function returns, it contains <ph id=\"ph1\">`TRUE`</ph>.","pos":[6037,6084],"source":" When this function returns, it contains `TRUE`."},{"content":"Return Value","pos":[6094,6106]},{"content":"Always returns 0.","pos":[6110,6127]},{"content":"Remarks","pos":[6137,6144]},{"pos":[6198,6225],"content":"CAtlPreviewCtrlImpl::Redraw"},{"content":"Tells this control to redraw.","pos":[6229,6258]},{"content":"Remarks","pos":[6304,6311]},{"pos":[6366,6394],"content":"CAtlPreviewCtrlImpl::SetHost"},{"content":"Sets a new parent for this control.","pos":[6398,6433]},{"content":"Parameters","pos":[6495,6505]},{"content":"A handle to the new parent window.","pos":[6525,6559]},{"content":"Remarks","pos":[6569,6576]},{"pos":[6641,6679],"content":"CAtlPreviewCtrlImpl::SetPreviewVisuals"},{"content":"Called by a Rich Preview handler when it needs to set visuals of rich preview content.","pos":[6683,6769]},{"content":"Parameters","pos":[6889,6899]},{"content":"Background color of the preview window.","pos":[6916,6955]},{"content":"Text color of the preview window.","pos":[6975,7008]},{"content":"Font used to display text in the preview window.","pos":[7024,7072]},{"content":"Remarks","pos":[7082,7089]},{"pos":[7144,7172],"content":"CAtlPreviewCtrlImpl::SetRect"},{"content":"Sets a new bounding rectangle for this control.","pos":[7176,7223]},{"content":"Parameters","pos":[7300,7310]},{"content":"Specifies the new size and position of the preview control.","pos":[7323,7382]},{"content":"Specifies whether the control should be redrawn.","pos":[7402,7450]},{"content":"Remarks","pos":[7460,7467]},{"content":"See Also","pos":[7476,7484]},{"content":"ATL COM Desktop Components","pos":[7489,7515]}],"content":"---\ntitle: \"CAtlPreviewCtrlImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"atlpreviewctrlimpl/ATL::CAtlPreviewCtrlImpl\"\n  - \"CAtlPreviewCtrlImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CAtlPreviewCtrlImpl class\"\nms.assetid: 39b3299e-07e4-4abc-9b6e-b54bfa3b0802\ncaps.latest.revision: 26\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CAtlPreviewCtrlImpl Class\nThis class is an ATL implementation of a window that is placed on a host window provided by the Shell  for Rich Preview.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the Windows Runtime.  \n  \n## Syntax  \n  \n```\nclass CAtlPreviewCtrlImpl : public CWindowImpl<CAtlPreviewCtrlImpl>, public IPreviewCtrl;\n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl](#catlpreviewctrlimpl___dtorcatlpreviewctrlimpl)|Destructs a preview control object.|  \n|[CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl](#catlpreviewctrlimpl__catlpreviewctrlimpl)|Constructs a preview control object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::Create](#catlpreviewctrlimpl__create)|Called by a Rich Preview handler to create the Windows window.|  \n|[CAtlPreviewCtrlImpl::Destroy](#catlpreviewctrlimpl__destroy)|Called by a Rich Preview handler when it needs to destroy this control.|  \n|[CAtlPreviewCtrlImpl::Focus](#catlpreviewctrlimpl__focus)|Sets input focus to this control.|  \n|[CAtlPreviewCtrlImpl::OnPaint](#catlpreviewctrlimpl__onpaint)|Handles the WM_PAINT message.|  \n|[CAtlPreviewCtrlImpl::Redraw](#catlpreviewctrlimpl__redraw)|Tells this control to redraw.|  \n|[CAtlPreviewCtrlImpl::SetHost](#catlpreviewctrlimpl__sethost)|Sets a new parent for this control.|  \n|[CAtlPreviewCtrlImpl::SetPreviewVisuals](#catlpreviewctrlimpl__setpreviewvisuals)|Called by a Rich Preview handler when it needs to set visuals of rich preview content.|  \n|[CAtlPreviewCtrlImpl::SetRect](#catlpreviewctrlimpl__setrect)|Sets a new bounding rectangle for this control.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::DoPaint](#catlpreviewctrlimpl__dopaint)|Called by the framework to render the preview.|  \n  \n### Protected Constants  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::m_plf](#catlpreviewctrlimpl__m_plf)|Font used to display text in the preview window.|  \n  \n### Protected Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAtlPreviewCtrlImpl::m_clrBack](#catlpreviewctrlimpl__m_clrback)|Background color of the preview window.|  \n|[CAtlPreviewCtrlImpl::m_clrText](#catlpreviewctrlimpl__m_clrtext)|Text color of preview window.|  \n\n  \n## Remarks  \n  \n## Inheritance Hierarchy  \n `TBase`  \n  \n `ATL::CMessageMap`  \n  \n `ATL::CWindowImplRoot<TBase>`  \n  \n `ATL::CWindowImplBaseT<TBase,TWinTraits>`  \n  \n [ATL::CWindowImpl\\<CAtlPreviewCtrlImpl>](../../atl/reference/cwindowimpl-class.md)  \n  \n `IPreviewCtrl`  \n  \n `ATL::CAtlPreviewCtrlImpl`  \n  \n## Requirements  \n **Header:** atlpreviewctrlimpl.h  \n  \n##  <a name=\"catlpreviewctrlimpl__catlpreviewctrlimpl\"></a>  CAtlPreviewCtrlImpl::CAtlPreviewCtrlImpl  \n Constructs a preview control object.  \n  \n```\nCAtlPreviewCtrlImpl(void) : m_clrText(0),\n    m_clrBack(RGB(255,\n 255,\n    255)),\n m_plf(NULL);\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl___dtorcatlpreviewctrlimpl\"></a>  CAtlPreviewCtrlImpl::~CAtlPreviewCtrlImpl  \n Destructs a preview control object.  \n  \n```\nvirtual ~CAtlPreviewCtrlImpl(void);\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__create\"></a>  CAtlPreviewCtrlImpl::Create  \n Called by a Rich Preview handler to create the Windows window.  \n  \n```\nvirtual BOOL Create(HWND hWndParent,  const RECT* prc);\n```  \n  \n### Parameters  \n `hWndParent`  \n A handle to the host window supplied by the Shell for Rich Preview.  \n  \n `prc`  \n Specifies the initial size and position of the window.  \n  \n### Return Value  \n `TRUE` if successful; otherwise `FALSE`.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__destroy\"></a>  CAtlPreviewCtrlImpl::Destroy  \n Called by a Rich Preview handler when it needs to destroy this control.  \n  \n```\nvirtual void Destroy();\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__dopaint\"></a>  CAtlPreviewCtrlImpl::DoPaint  \n Called by the framework to render the preview.  \n  \n```\nvirtual void DoPaint(HDC hdc);\n```  \n  \n### Parameters  \n `hdc`  \n A handle to a device context for painting.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__focus\"></a>  CAtlPreviewCtrlImpl::Focus  \n Sets input focus to this control.  \n  \n```\nvirtual void Focus();\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__m_clrback\"></a>  CAtlPreviewCtrlImpl::m_clrBack  \n Background color of the preview window.  \n  \n```\nCOLORREF m_clrBack;\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__m_clrtext\"></a>  CAtlPreviewCtrlImpl::m_clrText  \n Text color of the preview window.  \n  \n```\nCOLORREF m_clrText;\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__m_plf\"></a>  CAtlPreviewCtrlImpl::m_plf  \n Font used to display text in the preview window.  \n  \n```\nconst LOGFONTW* m_plf;\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__onpaint\"></a>  CAtlPreviewCtrlImpl::OnPaint  \n Handles the WM_PAINT message.  \n  \n```\nLRESULT OnPaint(UINT nMsg,\n    WPARAM wParam,\n    LPARAM lParam,\n    BOOL& bHandled);\n```  \n  \n### Parameters  \n `nMsg`  \n Set to WM_PAINT.  \n  \n `wParam`  \n This parameter is not used.  \n  \n `lParam`  \n This parameter is not used.  \n  \n `bHandled`  \n When this function returns, it contains `TRUE`.  \n  \n### Return Value  \n Always returns 0.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__redraw\"></a>  CAtlPreviewCtrlImpl::Redraw  \n Tells this control to redraw.  \n  \n```\nvirtual void Redraw();\n```  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__sethost\"></a>  CAtlPreviewCtrlImpl::SetHost  \n Sets a new parent for this control.  \n  \n```\nvirtual void SetHost(HWND hWndParent);\n```  \n  \n### Parameters  \n `hWndParent`  \n A handle to the new parent window.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__setpreviewvisuals\"></a>  CAtlPreviewCtrlImpl::SetPreviewVisuals  \n Called by a Rich Preview handler when it needs to set visuals of rich preview content.  \n  \n```\nvirtual void SetPreviewVisuals(COLORREF clrBack,\n    COLORREF clrText,\n    const LOGFONTW* plf);\n```  \n  \n### Parameters  \n `clrBack`  \n Background color of the preview window.  \n  \n `clrText`  \n Text color of the preview window.  \n  \n `plf`  \n Font used to display text in the preview window.  \n  \n### Remarks  \n  \n##  <a name=\"catlpreviewctrlimpl__setrect\"></a>  CAtlPreviewCtrlImpl::SetRect  \n Sets a new bounding rectangle for this control.  \n  \n```\nvirtual void SetRect(const RECT* prc,  BOOL bRedraw);\n```  \n  \n### Parameters  \n `prc`  \n Specifies the new size and position of the preview control.  \n  \n `bRedraw`  \n Specifies whether the control should be redrawn.  \n  \n### Remarks  \n  \n## See Also  \n [ATL COM Desktop Components](../../atl/atl-com-desktop-components.md)\n\n\n\n\n\n\n\n\n\n"}