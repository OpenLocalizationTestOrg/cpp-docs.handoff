{"nodes":[{"pos":[12,84],"content":"Field Status Data Members in Wizard-Generated Accessors | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Field Status Data Members in Wizard-Generated Accessors | Microsoft Docs","pos":[0,72]}]},{"content":"Field Status Data Members in Wizard-Generated Accessors","pos":[672,727]},{"content":"When you use the ATL OLE DB Consumer Wizard to create a consumer, the wizard generates a data member in the user record class for each field that you specify in your column map.","pos":[728,905]},{"content":"Each data member is of type <ph id=\"ph1\">`DWORD`</ph> and contains a status value corresponding to its respective field.","pos":[906,1008],"source":" Each data member is of type `DWORD` and contains a status value corresponding to its respective field."},{"content":"For example, for a data member <bpt id=\"p1\">*</bpt>m_OwnerID<ept id=\"p1\">*</ept>, the wizard generates an additional data member for field status (<bpt id=\"p2\">*</bpt>dwOwnerIDStatus<ept id=\"p2\">*</ept>) and another one for field length (<bpt id=\"p3\">*</bpt>dwOwnerIDLength<ept id=\"p3\">*</ept>).","pos":[1015,1196],"source":"For example, for a data member *m_OwnerID*, the wizard generates an additional data member for field status (*dwOwnerIDStatus*) and another one for field length (*dwOwnerIDLength*)."},{"content":"It also generates a column map with <ph id=\"ph1\">`COLUMN_ENTRY_LENGTH_STATUS`</ph> entries.","pos":[1197,1270],"source":" It also generates a column map with `COLUMN_ENTRY_LENGTH_STATUS` entries."},{"content":"This is shown in the following code:","pos":[1277,1313]},{"pos":[3094,3237],"content":"[!NOTE]\n If you modify the user record class or write your own consumer, the data variables must come before the status and length variables.","leadings":["","> "],"nodes":[{"content":"If you modify the user record class or write your own consumer, the data variables must come before the status and length variables.","pos":[9,141]}]},{"content":"You can use the status values for debugging purposes.","pos":[3244,3297]},{"content":"If code generated by the ATL OLE DB Consumer Wizard generates compilation errors such as <bpt id=\"p1\">**</bpt>DB_S_ERRORSOCCURRED<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>DB_E_ERRORSOCCURRED<ept id=\"p2\">**</ept>, you should first look at the current values of the field status data members.","pos":[3298,3516],"source":" If code generated by the ATL OLE DB Consumer Wizard generates compilation errors such as **DB_S_ERRORSOCCURRED** or **DB_E_ERRORSOCCURRED**, you should first look at the current values of the field status data members."},{"content":"Those that have nonzero values correspond to the offending columns.","pos":[3517,3584]},{"content":"You can also use the status values to set a NULL value for a particular field.","pos":[3591,3669]},{"content":"Doing so helps you in cases in which you want to distinguish a field value as NULL rather than zero.","pos":[3670,3770]},{"content":"It is up to you to decide whether NULL is a valid value or a special value and decide how your application should handle it.","pos":[3771,3895]},{"content":"OLE DB defines <bpt id=\"p1\">**</bpt>DBSTATUS_S_ISNULL<ept id=\"p1\">**</ept> as the correct means of specifying a generic NULL value.","pos":[3896,3989],"source":" OLE DB defines **DBSTATUS_S_ISNULL** as the correct means of specifying a generic NULL value."},{"content":"If the consumer reads data and the value is null, the status field is set to <bpt id=\"p1\">**</bpt>DBSTATUS_S_ISNULL<ept id=\"p1\">**</ept>.","pos":[3990,4089],"source":" If the consumer reads data and the value is null, the status field is set to **DBSTATUS_S_ISNULL**."},{"content":"If the consumer wants to set a NULL value, the consumer sets the status value to <bpt id=\"p1\">**</bpt>DBSTATUS_S_ISNULL<ept id=\"p1\">**</ept> before calling the provider.","pos":[4090,4221],"source":" If the consumer wants to set a NULL value, the consumer sets the status value to **DBSTATUS_S_ISNULL** before calling the provider."},{"content":"Next, open Oledb.h and search for <bpt id=\"p1\">**</bpt>DBSTATUSENUM<ept id=\"p1\">**</ept>.","pos":[4228,4279],"source":"Next, open Oledb.h and search for **DBSTATUSENUM**."},{"content":"You can then match the numerical value of the nonzero status against the <bpt id=\"p1\">**</bpt>DBSTATUSENUM<ept id=\"p1\">**</ept> enumeration values.","pos":[4280,4389],"source":" You can then match the numerical value of the nonzero status against the **DBSTATUSENUM** enumeration values."},{"content":"If the enumeration name is not sufficient to tell you what is wrong, see the \"Status\" topic in the \"Binding Data Values\" section of the <bpt id=\"p1\">[</bpt>OLE DB Programmer's Guide<ept id=\"p1\">](http://go.microsoft.com/fwlink/?linkid=121548)</ept>.","pos":[4390,4601],"source":" If the enumeration name is not sufficient to tell you what is wrong, see the \"Status\" topic in the \"Binding Data Values\" section of the [OLE DB Programmer's Guide](http://go.microsoft.com/fwlink/?linkid=121548)."},{"content":"This topic contains tables of status values used when getting or setting data.","pos":[4602,4680]},{"content":"For information about length values, see the \"Length\" topic in the same section.","pos":[4681,4761]},{"content":"Retrieving the Length or Status of a Column","pos":[4770,4813]},{"pos":[4817,4949],"content":"You can retrieve the length of a variable-length column or the status of a column (to check for <bpt id=\"p1\">**</bpt>DBSTATUS_S_ISNULL<ept id=\"p1\">**</ept>, for example):","source":"You can retrieve the length of a variable-length column or the status of a column (to check for **DBSTATUS_S_ISNULL**, for example):"},{"pos":[4959,5014],"content":"To get the length, use the <ph id=\"ph1\">`COLUMN_ENTRY_LENGTH`</ph> macro.","source":"To get the length, use the `COLUMN_ENTRY_LENGTH` macro."},{"pos":[5024,5079],"content":"To get the status, use the <ph id=\"ph1\">`COLUMN_ENTRY_STATUS`</ph> macro.","source":"To get the status, use the `COLUMN_ENTRY_STATUS` macro."},{"pos":[5089,5151],"content":"To get both, use <ph id=\"ph1\">`COLUMN_ENTRY_LENGTH_STATUS`</ph>, as shown below.","source":"To get both, use `COLUMN_ENTRY_LENGTH_STATUS`, as shown below."},{"content":"When you use <ph id=\"ph1\">`CDynamicAccessor`</ph>, the length and status are bound for you automatically.","pos":[5837,5924],"source":"When you use `CDynamicAccessor`, the length and status are bound for you automatically."},{"content":"To retrieve the length and status values, use the <ph id=\"ph1\">`GetLength`</ph> and <bpt id=\"p1\">**</bpt>GetStatus<ept id=\"p1\">**</ept> member functions.","pos":[5925,6022],"source":" To retrieve the length and status values, use the `GetLength` and **GetStatus** member functions."},{"content":"See Also","pos":[6031,6039]},{"content":"Working with OLE DB Consumer Templates","pos":[6044,6082]}],"content":"---\ntitle: \"Field Status Data Members in Wizard-Generated Accessors | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE DB consumer templates, field status\"\n  - \"field status in OLE DB templates\"\nms.assetid: 66e4e223-c60c-471e-860d-d23abcdfe371\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Field Status Data Members in Wizard-Generated Accessors\nWhen you use the ATL OLE DB Consumer Wizard to create a consumer, the wizard generates a data member in the user record class for each field that you specify in your column map. Each data member is of type `DWORD` and contains a status value corresponding to its respective field.  \n  \n For example, for a data member *m_OwnerID*, the wizard generates an additional data member for field status (*dwOwnerIDStatus*) and another one for field length (*dwOwnerIDLength*). It also generates a column map with `COLUMN_ENTRY_LENGTH_STATUS` entries.  \n  \n This is shown in the following code:  \n  \n```  \n[db_source(\"insert connection string\")]  \n[db_command(\" \\  \n   SELECT \\  \n      Au_ID, \\  \n      Author, \\  \n      `Year Born`, \\  \n      FROM Authors\")]  \n  \nclass CAuthors  \n{  \npublic:  \n  \n   // The following wizard-generated data members contain status   \n   // values for the corresponding fields in the column map. You   \n   // can use these values to hold NULL values that the database   \n   // returns or to hold error information when the compiler returns   \n   // errors. See \"Field Status Data Members in Wizard-Generated   \n   // Accessors\" in the Visual C++ documentation for more information   \n   // on using these fields.  \n   DWORD m_dwAuIDStatus;  \n   DWORD m_dwAuthorStatus;  \n   DWORD m_dwYearBornStatus;  \n  \n   // The following wizard-generated data members contain length  \n   // values for the corresponding fields in the column map.  \n   DWORD m_dwAuIDLength;  \n   DWORD m_dwAuthorLength;  \n   DWORD m_dwYearBornLength;  \n  \nBEGIN_COLUMN_MAP(CAuthorsAccessor)  \n   COLUMN_ENTRY_LENGTH_STATUS(1, m_AuID, dwAuIDLength, dwAuIDStatus)  \n   COLUMN_ENTRY_LENGTH_STATUS(2, m_Author, dwAuthorLength, dwAuthorStatus)  \n   COLUMN_ENTRY_LENGTH_STATUS(3, m_YearBorn, dwYearBornLength, dwYearBornStatus)  \nEND_COLUMN_MAP()  \n  \n   [ db_column(1, status=m_dwAuIDStatus, length=m_dwAuIDLength) ] LONG m_AuID;  \n   [ db_column(2, status=m_dwAuthorStatus, length=m_dwAuthorLength) ] TCHAR m_Author[51];  \n   [ db_column(3, status=m_dwYearBornStatus, length=m_dwYearBornLength) ] SHORT m_YearBorn;  \n  \n   void GetRowsetProperties(CDBPropSet* pPropSet)  \n   {  \n      pPropSet->AddProperty(DBPROP_IRowsetChange, true);  \n      pPropSet->AddProperty(DBPROP_UPDATABILITY, DBPROPVAL_UP_CHANGE | DBPROPVAL_UP_INSERT | DBPROPVAL_UP_DELETE);  \n   }  \n};  \n```  \n  \n> [!NOTE]\n>  If you modify the user record class or write your own consumer, the data variables must come before the status and length variables.  \n  \n You can use the status values for debugging purposes. If code generated by the ATL OLE DB Consumer Wizard generates compilation errors such as **DB_S_ERRORSOCCURRED** or **DB_E_ERRORSOCCURRED**, you should first look at the current values of the field status data members. Those that have nonzero values correspond to the offending columns.  \n  \n You can also use the status values to set a NULL value for a particular field. Doing so helps you in cases in which you want to distinguish a field value as NULL rather than zero. It is up to you to decide whether NULL is a valid value or a special value and decide how your application should handle it. OLE DB defines **DBSTATUS_S_ISNULL** as the correct means of specifying a generic NULL value. If the consumer reads data and the value is null, the status field is set to **DBSTATUS_S_ISNULL**. If the consumer wants to set a NULL value, the consumer sets the status value to **DBSTATUS_S_ISNULL** before calling the provider.  \n  \n Next, open Oledb.h and search for **DBSTATUSENUM**. You can then match the numerical value of the nonzero status against the **DBSTATUSENUM** enumeration values. If the enumeration name is not sufficient to tell you what is wrong, see the \"Status\" topic in the \"Binding Data Values\" section of the [OLE DB Programmer's Guide](http://go.microsoft.com/fwlink/?linkid=121548). This topic contains tables of status values used when getting or setting data. For information about length values, see the \"Length\" topic in the same section.  \n  \n## Retrieving the Length or Status of a Column  \n You can retrieve the length of a variable-length column or the status of a column (to check for **DBSTATUS_S_ISNULL**, for example):  \n  \n-   To get the length, use the `COLUMN_ENTRY_LENGTH` macro.  \n  \n-   To get the status, use the `COLUMN_ENTRY_STATUS` macro.  \n  \n-   To get both, use `COLUMN_ENTRY_LENGTH_STATUS`, as shown below.  \n  \n```  \nclass CProducts  \n{  \npublic:  \n   char      szName[40];  \n   long      nNameLength;  \n   DBSTATUS   nNameStatus;  \n  \nBEGIN_COLUMN_MAP(CProducts)  \n// Bind the column to CProducts.m_ProductName.  \n// nOrdinal is zero-based, so the column number of m_ProductName is 1.  \n   COLUMN_ENTRY_LENGTH_STATUS(1, szName, nNameLength, nNameStatus)  \nEND_COLUMN_MAP()  \n};  \n  \nCTable<CAccessor<CProducts > > product;  \n  \nproduct.Open(session, \"Product\");  \nwhile (product.MoveNext() == S_OK)  \n{  \n   // Check the product name isn't NULL before tracing it  \n   if (product.nNameStatus == DBSTATUS_S_OK)  \n      ATLTRACE(\"%s is %d characters\\n\", szName, nNameLength);  \n}  \n```  \n  \n When you use `CDynamicAccessor`, the length and status are bound for you automatically. To retrieve the length and status values, use the `GetLength` and **GetStatus** member functions.  \n  \n## See Also  \n [Working with OLE DB Consumer Templates](../../data/oledb/working-with-ole-db-consumer-templates.md)"}