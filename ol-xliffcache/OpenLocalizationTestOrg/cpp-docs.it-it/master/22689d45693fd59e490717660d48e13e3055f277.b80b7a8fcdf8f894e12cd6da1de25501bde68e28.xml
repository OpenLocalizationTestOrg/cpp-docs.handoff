{"nodes":[{"pos":[12,52],"content":"CInterpolatorBase Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CInterpolatorBase Class | Microsoft Docs","pos":[0,40]}]},{"content":"CInterpolatorBase Class","pos":[672,695]},{"content":"Implements a callback, which is called by the Animation API when it has to calculate a new value of an animation variable.","pos":[696,818]},{"content":"Syntax","pos":[827,833]},{"content":"Members","pos":[941,948]},{"content":"Public Constructors","pos":[958,977]},{"content":"Name","pos":[984,988]},{"content":"Description","pos":[989,1000]},{"content":"CInterpolatorBase::CInterpolatorBase","pos":[1039,1075]},{"pos":[1116,1158],"content":"Constructs the <ph id=\"ph1\">`CInterpolatorBase`</ph> object.","source":"Constructs the `CInterpolatorBase` object."},{"content":"Public Methods","pos":[1169,1183]},{"content":"Name","pos":[1190,1194]},{"content":"Description","pos":[1195,1206]},{"content":"CInterpolatorBase::CreateInstance","pos":[1245,1278]},{"pos":[1316,1434],"content":"Creates an instance of <ph id=\"ph1\">`CInterpolatorBase`</ph> and stores a pointer to custom interpolator, which will be handling events.","source":"Creates an instance of `CInterpolatorBase` and stores a pointer to custom interpolator, which will be handling events."},{"content":"CInterpolatorBase::GetDependencies","pos":[1440,1474]},{"content":"Gets the interpolator's dependencies.","pos":[1513,1550]},{"content":"(Overrides <ph id=\"ph1\">`CUIAnimationInterpolatorBase::GetDependencies`</ph>.)","pos":[1551,1611],"source":" (Overrides `CUIAnimationInterpolatorBase::GetDependencies`.)"},{"content":"CInterpolatorBase::GetDuration","pos":[1617,1647]},{"content":"Gets the interpolator's duration.","pos":[1682,1715]},{"content":"(Overrides <ph id=\"ph1\">`CUIAnimationInterpolatorBase::GetDuration`</ph>.)","pos":[1716,1772],"source":" (Overrides `CUIAnimationInterpolatorBase::GetDuration`.)"},{"content":"CInterpolatorBase::GetFinalValue","pos":[1778,1810]},{"content":"Gets the final value to which the interpolator leads.","pos":[1847,1900]},{"content":"(Overrides <ph id=\"ph1\">`CUIAnimationInterpolatorBase::GetFinalValue`</ph>.)","pos":[1901,1959],"source":" (Overrides `CUIAnimationInterpolatorBase::GetFinalValue`.)"},{"content":"CInterpolatorBase::InterpolateValue","pos":[1965,2000]},{"pos":[2040,2142],"content":"Interpolates the value at a given offset (Overrides <ph id=\"ph1\">`CUIAnimationInterpolatorBase::InterpolateValue`</ph>.)","source":"Interpolates the value at a given offset (Overrides `CUIAnimationInterpolatorBase::InterpolateValue`.)"},{"content":"CInterpolatorBase::InterpolateVelocity","pos":[2148,2186]},{"pos":[2229,2337],"content":"Interpolates the velocity at a given offset (Overrides <ph id=\"ph1\">`CUIAnimationInterpolatorBase::InterpolateVelocity`</ph>.)","source":"Interpolates the velocity at a given offset (Overrides `CUIAnimationInterpolatorBase::InterpolateVelocity`.)"},{"content":"CInterpolatorBase::SetCustomInterpolator","pos":[2343,2383]},{"content":"Stores a pointer to custom interpolator, which will be handling events.","pos":[2428,2499]},{"content":"CInterpolatorBase::SetDuration","pos":[2505,2535]},{"pos":[2570,2659],"content":"Sets the interpolator's duration (Overrides <ph id=\"ph1\">`CUIAnimationInterpolatorBase::SetDuration`</ph>.)","source":"Sets the interpolator's duration (Overrides `CUIAnimationInterpolatorBase::SetDuration`.)"},{"content":"CInterpolatorBase::SetInitialValueAndVelocity","pos":[2665,2710]},{"content":"Sets the interpolator's initial value and velocity.","pos":[2760,2811]},{"content":"(Overrides <ph id=\"ph1\">`CUIAnimationInterpolatorBase::SetInitialValueAndVelocity`</ph>.)","pos":[2812,2883],"source":" (Overrides `CUIAnimationInterpolatorBase::SetInitialValueAndVelocity`.)"},{"content":"Remarks","pos":[2893,2900]},{"content":"This handler is created and passed to <ph id=\"ph1\">`IUIAnimationTransitionFactory::CreateTransition`</ph> when a <ph id=\"ph2\">`CCustomTransition`</ph> object is being created as a part of animation initialization process (started by <ph id=\"ph3\">`CAnimationController::AnimateGroup`</ph>).","pos":[2904,3139],"source":"This handler is created and passed to `IUIAnimationTransitionFactory::CreateTransition` when a `CCustomTransition` object is being created as a part of animation initialization process (started by `CAnimationController::AnimateGroup`)."},{"content":"Usually you don't need to use this class directly, it just routs all events to a <ph id=\"ph1\">`CCustomInterpolator`</ph>-derived class, whose pointer is passed to constructor of <ph id=\"ph2\">`CCustomTransition`</ph>.","pos":[3140,3320],"source":" Usually you don't need to use this class directly, it just routs all events to a `CCustomInterpolator`-derived class, whose pointer is passed to constructor of `CCustomTransition`."},{"content":"Inheritance Hierarchy","pos":[3329,3350]},{"content":"Requirements","pos":[3452,3464]},{"pos":[3468,3504],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxanimationcontroller.h","source":"**Header:** afxanimationcontroller.h"},{"pos":[3567,3603],"content":"CInterpolatorBase::CInterpolatorBase"},{"content":"Constructs the CInterpolatorBase object.","pos":[3607,3647]},{"pos":[3743,3776],"content":"CInterpolatorBase::CreateInstance"},{"content":"Creates an instance of CInterpolatorBase and stores a pointer to custom interpolator, which will be handling events.","pos":[3780,3896]},{"content":"Parameters","pos":[4058,4068]},{"content":"A pointer to custom interpolator.","pos":[4091,4124]},{"content":"Output.","pos":[4146,4153]},{"content":"Contains a pointer to instance of CInterpolatorBase when the function returns.","pos":[4154,4232]},{"content":"Return Value","pos":[4242,4254]},{"pos":[4315,4349],"content":"CInterpolatorBase::GetDependencies"},{"content":"Gets the interpolator's dependencies.","pos":[4353,4390]},{"content":"Parameters","pos":[4634,4644]},{"content":"Output.","pos":[4678,4685]},{"content":"Aspects of the interpolator that depend on the initial value passed to SetInitialValueAndVelocity.","pos":[4686,4784]},{"content":"Output.","pos":[4824,4831]},{"content":"Aspects of the interpolator that depend on the initial velocity passed to SetInitialValueAndVelocity.","pos":[4832,4933]},{"content":"Output.","pos":[4966,4973]},{"content":"Aspects of the interpolator that depend on the duration passed to SetDuration.","pos":[4974,5052]},{"content":"Return Value","pos":[5062,5074]},{"content":"If the method succeeds, it returns S_OK.","pos":[5078,5118]},{"content":"It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the GetDependencies method.","pos":[5119,5243]},{"pos":[5300,5330],"content":"CInterpolatorBase::GetDuration"},{"content":"Gets the interpolator's duration.","pos":[5334,5367]},{"content":"Parameters","pos":[5456,5466]},{"content":"Output.","pos":[5484,5491]},{"content":"The duration of the transition, in seconds.","pos":[5492,5535]},{"content":"Return Value","pos":[5545,5557]},{"content":"If the method succeeds, it returns S_OK.","pos":[5561,5601]},{"content":"It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the GetDuration method.","pos":[5602,5722]},{"pos":[5781,5813],"content":"CInterpolatorBase::GetFinalValue"},{"content":"Gets the final value to which the interpolator leads.","pos":[5817,5870]},{"content":"Parameters","pos":[5944,5954]},{"content":"Output.","pos":[5969,5976]},{"content":"The final value of a variable at the end of the transition.","pos":[5977,6036]},{"content":"Return Value","pos":[6046,6058]},{"content":"If the method succeeds, it returns S_OK.","pos":[6062,6102]},{"content":"It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the GetFinalValue method.","pos":[6103,6225]},{"pos":[6287,6322],"content":"CInterpolatorBase::InterpolateValue"},{"content":"Interpolates the value at a given offset","pos":[6326,6366]},{"content":"Parameters","pos":[6482,6492]},{"content":"The offset from the start of the transition.","pos":[6508,6552]},{"content":"The offset is always greater than or equal to zero and less than the duration of the transition.","pos":[6553,6649]},{"content":"This method is not called if the duration of the transition is zero.","pos":[6650,6718]},{"content":"Output.","pos":[6736,6743]},{"content":"The interpolated value.","pos":[6744,6767]},{"content":"Return Value","pos":[6777,6789]},{"content":"If the method succeeds, it returns S_OK.","pos":[6793,6833]},{"content":"It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the InterpolateValue method.","pos":[6834,6959]},{"pos":[7024,7062],"content":"CInterpolatorBase::InterpolateVelocity"},{"content":"Interpolates the velocity at a given offset","pos":[7066,7109]},{"content":"Parameters","pos":[7231,7241]},{"content":"The offset from the start of the transition.","pos":[7257,7301]},{"content":"The offset is always greater than or equal to zero and less than or equal to the duration of the transition.","pos":[7302,7410]},{"content":"This method is not called if the duration of the transition is zero.","pos":[7411,7479]},{"content":"Output.","pos":[7500,7507]},{"content":"The velocity of the variable at the offset.","pos":[7508,7551]},{"content":"Return Value","pos":[7561,7573]},{"content":"If the method succeeds, it returns S_OK.","pos":[7577,7617]},{"content":"It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the InterpolateVelocity method.","pos":[7618,7746]},{"pos":[7813,7853],"content":"CInterpolatorBase::SetCustomInterpolator"},{"content":"Stores a pointer to custom interpolator, which will be handling events.","pos":[7857,7928]},{"content":"Parameters","pos":[8017,8027]},{"content":"A pointer to custom interpolator.","pos":[8050,8083]},{"pos":[8140,8170],"content":"CInterpolatorBase::SetDuration"},{"content":"Sets the interpolator's duration","pos":[8174,8206]},{"content":"Parameters","pos":[8293,8303]},{"content":"The duration of the transition.","pos":[8321,8352]},{"content":"Return Value","pos":[8362,8374]},{"content":"If the method succeeds, it returns S_OK.","pos":[8378,8418]},{"content":"It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the SetDuration method.","pos":[8419,8539]},{"pos":[8611,8656],"content":"CInterpolatorBase::SetInitialValueAndVelocity"},{"content":"Sets the interpolator's initial value and velocity.","pos":[8660,8711]},{"content":"Parameters","pos":[8837,8847]},{"content":"The value of the variable at the start of the transition.","pos":[8869,8926]},{"content":"The velocity of the variable at the start of the transition.","pos":[8954,9014]},{"content":"Return Value","pos":[9024,9036]},{"content":"If the method succeeds, it returns S_OK.","pos":[9040,9080]},{"content":"It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the SetInitialValueAndVelocity method.","pos":[9081,9216]},{"content":"See Also","pos":[9225,9233]},{"content":"Classes","pos":[9238,9245]}],"content":"---\ntitle: \"CInterpolatorBase Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"afxanimationcontroller/CInterpolatorBase\"\n  - \"CInterpolatorBase\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CInterpolatorBase class\"\nms.assetid: bbc3dce7-8398-47f9-b97e-e4fd2d737232\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CInterpolatorBase Class\nImplements a callback, which is called by the Animation API when it has to calculate a new value of an animation variable.  \n  \n## Syntax  \n  \n```  \nclass CInterpolatorBase : public CUIAnimationInterpolatorBase<CInterpolatorBase>;  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CInterpolatorBase::CInterpolatorBase](#cinterpolatorbase__cinterpolatorbase)|Constructs the `CInterpolatorBase` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CInterpolatorBase::CreateInstance](#cinterpolatorbase__createinstance)|Creates an instance of `CInterpolatorBase` and stores a pointer to custom interpolator, which will be handling events.|  \n|[CInterpolatorBase::GetDependencies](#cinterpolatorbase__getdependencies)|Gets the interpolator's dependencies. (Overrides `CUIAnimationInterpolatorBase::GetDependencies`.)|  \n|[CInterpolatorBase::GetDuration](#cinterpolatorbase__getduration)|Gets the interpolator's duration. (Overrides `CUIAnimationInterpolatorBase::GetDuration`.)|  \n|[CInterpolatorBase::GetFinalValue](#cinterpolatorbase__getfinalvalue)|Gets the final value to which the interpolator leads. (Overrides `CUIAnimationInterpolatorBase::GetFinalValue`.)|  \n|[CInterpolatorBase::InterpolateValue](#cinterpolatorbase__interpolatevalue)|Interpolates the value at a given offset (Overrides `CUIAnimationInterpolatorBase::InterpolateValue`.)|  \n|[CInterpolatorBase::InterpolateVelocity](#cinterpolatorbase__interpolatevelocity)|Interpolates the velocity at a given offset (Overrides `CUIAnimationInterpolatorBase::InterpolateVelocity`.)|  \n|[CInterpolatorBase::SetCustomInterpolator](#cinterpolatorbase__setcustominterpolator)|Stores a pointer to custom interpolator, which will be handling events.|  \n|[CInterpolatorBase::SetDuration](#cinterpolatorbase__setduration)|Sets the interpolator's duration (Overrides `CUIAnimationInterpolatorBase::SetDuration`.)|  \n|[CInterpolatorBase::SetInitialValueAndVelocity](#cinterpolatorbase__setinitialvalueandvelocity)|Sets the interpolator's initial value and velocity. (Overrides `CUIAnimationInterpolatorBase::SetInitialValueAndVelocity`.)|  \n  \n## Remarks  \n This handler is created and passed to `IUIAnimationTransitionFactory::CreateTransition` when a `CCustomTransition` object is being created as a part of animation initialization process (started by `CAnimationController::AnimateGroup`). Usually you don't need to use this class directly, it just routs all events to a `CCustomInterpolator`-derived class, whose pointer is passed to constructor of `CCustomTransition`.  \n  \n## Inheritance Hierarchy  \n `CUIAnimationCallbackBase`  \n  \n `CUIAnimationInterpolatorBase`  \n  \n `CInterpolatorBase`  \n  \n## Requirements  \n **Header:** afxanimationcontroller.h  \n  \n##  <a name=\"cinterpolatorbase__cinterpolatorbase\"></a>  CInterpolatorBase::CInterpolatorBase  \n Constructs the CInterpolatorBase object.  \n  \n```  \nCInterpolatorBase();\n```  \n  \n##  <a name=\"cinterpolatorbase__createinstance\"></a>  CInterpolatorBase::CreateInstance  \n Creates an instance of CInterpolatorBase and stores a pointer to custom interpolator, which will be handling events.  \n  \n```  \nstatic COM_DECLSPEC_NOTHROW HRESULT CreateInstance(\n    CCustomInterpolator* pInterpolator,  \n    IUIAnimationInterpolator** ppHandler);\n```  \n  \n### Parameters  \n `pInterpolator`  \n A pointer to custom interpolator.  \n  \n `ppHandler`  \n Output. Contains a pointer to instance of CInterpolatorBase when the function returns.  \n  \n### Return Value  \n  \n##  <a name=\"cinterpolatorbase__getdependencies\"></a>  CInterpolatorBase::GetDependencies  \n Gets the interpolator's dependencies.  \n  \n```  \nIFACEMETHOD(\n    GetDependencies)(__out UI_ANIMATION_DEPENDENCIES* initialValueDependencies,\n    __out UI_ANIMATION_DEPENDENCIES* initialVelocityDependencies,\n    __out UI_ANIMATION_DEPENDENCIES* durationDependencies);\n```  \n  \n### Parameters  \n `initialValueDependencies`  \n Output. Aspects of the interpolator that depend on the initial value passed to SetInitialValueAndVelocity.  \n  \n `initialVelocityDependencies`  \n Output. Aspects of the interpolator that depend on the initial velocity passed to SetInitialValueAndVelocity.  \n  \n `durationDependencies`  \n Output. Aspects of the interpolator that depend on the duration passed to SetDuration.  \n  \n### Return Value  \n If the method succeeds, it returns S_OK. It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the GetDependencies method.  \n  \n##  <a name=\"cinterpolatorbase__getduration\"></a>  CInterpolatorBase::GetDuration  \n Gets the interpolator's duration.  \n  \n```  \nIFACEMETHOD(GetDuration)(__out UI_ANIMATION_SECONDS* duration);\n```  \n  \n### Parameters  \n `duration`  \n Output. The duration of the transition, in seconds.  \n  \n### Return Value  \n If the method succeeds, it returns S_OK. It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the GetDuration method.  \n  \n##  <a name=\"cinterpolatorbase__getfinalvalue\"></a>  CInterpolatorBase::GetFinalValue  \n Gets the final value to which the interpolator leads.  \n  \n```  \nIFACEMETHOD(GetFinalValue)(__out DOUBLE* value);\n```  \n  \n### Parameters  \n `value`  \n Output. The final value of a variable at the end of the transition.  \n  \n### Return Value  \n If the method succeeds, it returns S_OK. It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the GetFinalValue method.  \n  \n##  <a name=\"cinterpolatorbase__interpolatevalue\"></a>  CInterpolatorBase::InterpolateValue  \n Interpolates the value at a given offset  \n  \n```  \nIFACEMETHOD(\n    InterpolateValue)(__in UI_ANIMATION_SECONDS offset, __out DOUBLE* value);\n```  \n  \n### Parameters  \n `offset`  \n The offset from the start of the transition. The offset is always greater than or equal to zero and less than the duration of the transition. This method is not called if the duration of the transition is zero.  \n  \n `value`  \n Output. The interpolated value.  \n  \n### Return Value  \n If the method succeeds, it returns S_OK. It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the InterpolateValue method.  \n  \n##  <a name=\"cinterpolatorbase__interpolatevelocity\"></a>  CInterpolatorBase::InterpolateVelocity  \n Interpolates the velocity at a given offset  \n  \n```  \nIFACEMETHOD(\n    InterpolateVelocity)(__in UI_ANIMATION_SECONDS offset, __out DOUBLE* velocity);\n```  \n  \n### Parameters  \n `offset`  \n The offset from the start of the transition. The offset is always greater than or equal to zero and less than or equal to the duration of the transition. This method is not called if the duration of the transition is zero.  \n  \n `velocity`  \n Output. The velocity of the variable at the offset.  \n  \n### Return Value  \n If the method succeeds, it returns S_OK. It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the InterpolateVelocity method.  \n  \n##  <a name=\"cinterpolatorbase__setcustominterpolator\"></a>  CInterpolatorBase::SetCustomInterpolator  \n Stores a pointer to custom interpolator, which will be handling events.  \n  \n```  \nvoid SetCustomInterpolator(CCustomInterpolator* pInterpolator);\n```  \n  \n### Parameters  \n `pInterpolator`  \n A pointer to custom interpolator.  \n  \n##  <a name=\"cinterpolatorbase__setduration\"></a>  CInterpolatorBase::SetDuration  \n Sets the interpolator's duration  \n  \n```  \nIFACEMETHOD(SetDuration)(__in UI_ANIMATION_SECONDS duration);\n```  \n  \n### Parameters  \n `duration`  \n The duration of the transition.  \n  \n### Return Value  \n If the method succeeds, it returns S_OK. It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the SetDuration method.  \n  \n##  <a name=\"cinterpolatorbase__setinitialvalueandvelocity\"></a>  CInterpolatorBase::SetInitialValueAndVelocity  \n Sets the interpolator's initial value and velocity.  \n  \n```  \nIFACEMETHOD(\n    SetInitialValueAndVelocity)(__in DOUBLE initialValue, __in DOUBLE initialVelocity);\n```  \n  \n### Parameters  \n `initialValue`  \n The value of the variable at the start of the transition.  \n  \n `initialVelocity`  \n The velocity of the variable at the start of the transition.  \n  \n### Return Value  \n If the method succeeds, it returns S_OK. It returns E_FAIL if CCustomInterpolator is not set, or custom implementation returns FALSE from the SetInitialValueAndVelocity method.  \n  \n## See Also  \n [Classes](../../mfc/reference/mfc-classes.md)\n"}