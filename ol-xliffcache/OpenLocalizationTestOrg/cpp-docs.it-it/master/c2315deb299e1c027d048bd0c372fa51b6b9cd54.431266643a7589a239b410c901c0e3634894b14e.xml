{"nodes":[{"pos":[12,46],"content":"Output Parameters | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Output Parameters | Microsoft Docs","pos":[0,34]}]},{"content":"Output Parameters","pos":[738,755]},{"content":"Calling a stored procedure is similar to invoking a SQL command.","pos":[756,820]},{"content":"The main difference is that stored procedures use output parameters (or \"outparameters\") and return values.","pos":[821,928]},{"content":"In the following stored procedure, the first '?' is the return value (phone) and the second '?' is the input parameter (name):","pos":[935,1061]},{"content":"You specify the in and out parameters in the parameter map:","pos":[1174,1233]},{"content":"Your application must handle the output returned from stored procedures.","pos":[1507,1579]},{"content":"Different OLE DB providers return output parameters and return values at different times during result processing.","pos":[1580,1694]},{"content":"For example, the Microsoft OLE DB provider for SQL Server (SQLOLEDB) does not supply output parameters and return codes until after the consumer has retrieved or canceled the result sets returned by the stored procedure.","pos":[1695,1915]},{"content":"The output is returned in the last TDS packet from the server.","pos":[1916,1978]},{"content":"Row Count","pos":[1987,1996]},{"content":"If you use the OLE DB Consumer Templates to execute a stored procedure that has outparameters, the row count is not set until you close the rowset.","pos":[2000,2147]},{"content":"For example, consider a stored procedure with a rowset and an outparameter:","pos":[2154,2229]},{"content":"The @_rowcount outparameter reports how many rows were actually returned from the test table.","pos":[2385,2478]},{"content":"However, this stored procedure limits the number of rows to a maximum of 50.","pos":[2479,2555]},{"content":"For example, if there were 100 rows in test, the rowcount would be 50 (because this code retrieves only the top 50 rows).","pos":[2556,2677]},{"content":"If there were only 30 rows in the table, the rowcount would be 30.","pos":[2678,2744]},{"content":"You must call <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>CloseAll<ept id=\"p2\">**</ept> to populate the outparameter before you fetch its value.","pos":[2745,2841],"source":" You must call **Close** or **CloseAll** to populate the outparameter before you fetch its value."},{"content":"See Also","pos":[2850,2858]},{"content":"Using Stored Procedures","pos":[2863,2886]}],"content":"---\ntitle: \"Output Parameters | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE DB, stored procedures\"\n  - \"stored procedures, calling\"\n  - \"stored procedures, parameters\"\n  - \"procedure calls\"\n  - \"procedure calls, stored procedures\"\nms.assetid: 4f7c2700-1c2d-42f3-8c9f-7e83962b2442\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Output Parameters\nCalling a stored procedure is similar to invoking a SQL command. The main difference is that stored procedures use output parameters (or \"outparameters\") and return values.  \n  \n In the following stored procedure, the first '?' is the return value (phone) and the second '?' is the input parameter (name):  \n  \n```  \nDEFINE_COMMAND(CMySProcAccessor, _T(\"{ ? = SELECT phone FROM shippers WHERE name = ? }\")  \n```  \n  \n You specify the in and out parameters in the parameter map:  \n  \n```  \nBEGIN_PARAM_MAP(CMySProcAccessor)  \n   SET_PARAM_TYPE(DBPARAMIO_OUTPUT)  \n   COLUMN_ENTRY(1, m_Phone)   // Phone is the return value  \n   SET_PARAM_TYPE(DBPARAMIO_INPUT)  \n   COLUMN_ENTRY(2, m_Name)   // Name is the input parameter  \nEND_PARAM_MAP()  \n```  \n  \n Your application must handle the output returned from stored procedures. Different OLE DB providers return output parameters and return values at different times during result processing. For example, the Microsoft OLE DB provider for SQL Server (SQLOLEDB) does not supply output parameters and return codes until after the consumer has retrieved or canceled the result sets returned by the stored procedure. The output is returned in the last TDS packet from the server.  \n  \n## Row Count  \n If you use the OLE DB Consumer Templates to execute a stored procedure that has outparameters, the row count is not set until you close the rowset.  \n  \n For example, consider a stored procedure with a rowset and an outparameter:  \n  \n```  \ncreate procedure sp_test  \n   @_rowcount integer output  \nas  \n   select top 50 * from test  \n   @_rowcount = @@rowcount  \nreturn 0  \n```  \n  \n The @_rowcount outparameter reports how many rows were actually returned from the test table. However, this stored procedure limits the number of rows to a maximum of 50. For example, if there were 100 rows in test, the rowcount would be 50 (because this code retrieves only the top 50 rows). If there were only 30 rows in the table, the rowcount would be 30. You must call **Close** or **CloseAll** to populate the outparameter before you fetch its value.  \n  \n## See Also  \n [Using Stored Procedures](../../data/oledb/using-stored-procedures.md)"}