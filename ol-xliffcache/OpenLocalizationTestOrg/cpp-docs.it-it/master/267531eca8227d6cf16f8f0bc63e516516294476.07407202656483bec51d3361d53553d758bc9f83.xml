{"nodes":[{"pos":[12,54],"content":"IObjectWithSiteImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IObjectWithSiteImpl Class | Microsoft Docs","pos":[0,42]}]},{"pos":[759,784],"content":"IObjectWithSiteImpl Class","linkify":"IObjectWithSiteImpl Class","nodes":[{"content":"IObjectWithSiteImpl Class","pos":[0,25]}]},{"content":"This class provides methods allowing an object to communicate with its site.","pos":[785,861]},{"pos":[870,876],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[994,1004],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Your class, derived from <ph id=\"ph1\">`IObjectWithSiteImpl`</ph>.","pos":[1015,1062],"source":" Your class, derived from `IObjectWithSiteImpl`."},{"pos":[1071,1078],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1088,1102],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1109,1113]},{"content":"Description","pos":[1114,1125]},{"pos":[1163,1224],"content":"<bpt id=\"p1\">[</bpt>IObjectWithSiteImpl::GetSite<ept id=\"p1\">](#iobjectwithsiteimpl__getsite)</ept>","source":"[IObjectWithSiteImpl::GetSite](#iobjectwithsiteimpl__getsite)"},{"content":"Queries the site for an interface pointer.","pos":[1225,1267]},{"pos":[1272,1343],"content":"<bpt id=\"p1\">[</bpt>IObjectWithSiteImpl::SetChildSite<ept id=\"p1\">](#iobjectwithsiteimpl__setchildsite)</ept>","source":"[IObjectWithSiteImpl::SetChildSite](#iobjectwithsiteimpl__setchildsite)"},{"pos":[1344,1401],"content":"Provides the object with the site's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Provides the object with the site's **IUnknown** pointer."},{"pos":[1406,1467],"content":"<bpt id=\"p1\">[</bpt>IObjectWithSiteImpl::SetSite<ept id=\"p1\">](#iobjectwithsiteimpl__setsite)</ept>","source":"[IObjectWithSiteImpl::SetSite](#iobjectwithsiteimpl__setsite)"},{"pos":[1468,1525],"content":"Provides the object with the site's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Provides the object with the site's **IUnknown** pointer."},{"pos":[1536,1555],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[1562,1566]},{"content":"Description","pos":[1567,1578]},{"pos":[1616,1685],"content":"<bpt id=\"p1\">[</bpt>IObjectWithSiteImpl::m_spUnkSite<ept id=\"p1\">](#iobjectwithsiteimpl__m_spunksite)</ept>","source":"[IObjectWithSiteImpl::m_spUnkSite](#iobjectwithsiteimpl__m_spunksite)"},{"pos":[1686,1726],"content":"Manages the site's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Manages the site's **IUnknown** pointer."},{"pos":[1736,1743],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <bpt id=\"p1\">[</bpt>IObjectWithSite<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms693765)</ept> interface allows an object to communicate with its site.","pos":[1747,1885],"source":"The [IObjectWithSite](http://msdn.microsoft.com/library/windows/desktop/ms693765) interface allows an object to communicate with its site."},{"content":"Class <ph id=\"ph1\">`IObjectWithSiteImpl`</ph> provides a default implementation of this interface and implements <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> by sending information to the dump device in debug builds.","pos":[1886,2052],"source":" Class `IObjectWithSiteImpl` provides a default implementation of this interface and implements **IUnknown** by sending information to the dump device in debug builds."},{"content":"<ph id=\"ph1\">`IObjectWithSiteImpl`</ph> specifies two methods.","pos":[2059,2103],"source":"`IObjectWithSiteImpl` specifies two methods."},{"content":"The client first calls <ph id=\"ph1\">`SetSite`</ph>, passing the site's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","pos":[2104,2178],"source":" The client first calls `SetSite`, passing the site's **IUnknown** pointer."},{"content":"This pointer is stored within the object, and can later be retrieved through a call to <ph id=\"ph1\">`GetSite`</ph>.","pos":[2179,2276],"source":" This pointer is stored within the object, and can later be retrieved through a call to `GetSite`."},{"content":"Typically, you derive your class from <ph id=\"ph1\">`IObjectWithSiteImpl`</ph> when you are creating an object that is not a control.","pos":[2283,2397],"source":"Typically, you derive your class from `IObjectWithSiteImpl` when you are creating an object that is not a control."},{"content":"For controls, derive your class from <bpt id=\"p1\">[</bpt>IOleObjectImpl<ept id=\"p1\">](../../atl/reference/ioleobjectimpl-class.md)</ept>, which also provides a site pointer.","pos":[2398,2533],"source":" For controls, derive your class from [IOleObjectImpl](../../atl/reference/ioleobjectimpl-class.md), which also provides a site pointer."},{"content":"Do not derive your class from both <ph id=\"ph1\">`IObjectWithSiteImpl`</ph> and <ph id=\"ph2\">`IOleObjectImpl`</ph>.","pos":[2534,2612],"source":" Do not derive your class from both `IObjectWithSiteImpl` and `IOleObjectImpl`."},{"pos":[2621,2642],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[2700,2712],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[2716,2736],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[2746,2819],"content":"<bpt id=\"p1\">&lt;a name=\"iobjectwithsiteimpl__getsite\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IObjectWithSiteImpl::GetSite","linkify":"<a name=\"iobjectwithsiteimpl__getsite\"></a>  IObjectWithSiteImpl::GetSite","source":"<a name=\"iobjectwithsiteimpl__getsite\"></a>  IObjectWithSiteImpl::GetSite"},{"pos":[2823,2892],"content":"Queries the site for a pointer to the interface identified by <ph id=\"ph1\">`riid`</ph>.","source":"Queries the site for a pointer to the interface identified by `riid`."},{"pos":[2973,2980],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If the site supports this interface, the pointer is returned via <ph id=\"ph1\">`ppvSite`</ph>.","pos":[2984,3059],"source":"If the site supports this interface, the pointer is returned via `ppvSite`."},{"content":"Otherwise, <ph id=\"ph1\">`ppvSite`</ph> is set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[3060,3100],"source":" Otherwise, `ppvSite` is set to **NULL**."},{"pos":[3107,3257],"content":"See <bpt id=\"p1\">[</bpt>IObjectWithSite::GetSite<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694452)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IObjectWithSite::GetSite](http://msdn.microsoft.com/library/windows/desktop/ms694452) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3267,3348],"content":"<bpt id=\"p1\">&lt;a name=\"iobjectwithsiteimpl__m_spunksite\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IObjectWithSiteImpl::m_spUnkSite","linkify":"<a name=\"iobjectwithsiteimpl__m_spunksite\"></a>  IObjectWithSiteImpl::m_spUnkSite","source":"<a name=\"iobjectwithsiteimpl__m_spunksite\"></a>  IObjectWithSiteImpl::m_spUnkSite"},{"pos":[3352,3392],"content":"Manages the site's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Manages the site's **IUnknown** pointer."},{"pos":[3446,3453],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[3457,3562],"content":"<ph id=\"ph1\">`m_spUnkSite`</ph> initially receives this pointer through a call to <bpt id=\"p1\">[</bpt>SetSite<ept id=\"p1\">](#iobjectwithsiteimpl__setsite)</ept>.","source":"`m_spUnkSite` initially receives this pointer through a call to [SetSite](#iobjectwithsiteimpl__setsite)."},{"pos":[3572,3655],"content":"<bpt id=\"p1\">&lt;a name=\"iobjectwithsiteimpl__setchildsite\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IObjectWithSiteImpl::SetChildSite","linkify":"<a name=\"iobjectwithsiteimpl__setchildsite\"></a>  IObjectWithSiteImpl::SetChildSite","source":"<a name=\"iobjectwithsiteimpl__setchildsite\"></a>  IObjectWithSiteImpl::SetChildSite"},{"pos":[3659,3716],"content":"Provides the object with the site's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Provides the object with the site's **IUnknown** pointer."},{"pos":[3781,3791],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pUnkSite<ept id=\"p1\">*</ept>","pos":[3795,3805],"source":"*pUnkSite*"},{"content":"[in] Pointer to the <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface pointer of the site managing this object.","pos":[3809,3893],"source":" [in] Pointer to the **IUnknown** interface pointer of the site managing this object."},{"content":"If NULL, the object should call <ph id=\"ph1\">`IUnknown::Release`</ph> on any existing site at which point the object no longer knows its site.","pos":[3894,4018],"source":" If NULL, the object should call `IUnknown::Release` on any existing site at which point the object no longer knows its site."},{"pos":[4028,4040],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[4044,4059],"content":"Returns <ph id=\"ph1\">`S_OK`</ph>.","source":"Returns `S_OK`."},{"pos":[4069,4142],"content":"<bpt id=\"p1\">&lt;a name=\"iobjectwithsiteimpl__setsite\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  IObjectWithSiteImpl::SetSite","linkify":"<a name=\"iobjectwithsiteimpl__setsite\"></a>  IObjectWithSiteImpl::SetSite","source":"<a name=\"iobjectwithsiteimpl__setsite\"></a>  IObjectWithSiteImpl::SetSite"},{"pos":[4146,4203],"content":"Provides the object with the site's <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> pointer.","source":"Provides the object with the site's **IUnknown** pointer."},{"pos":[4266,4273],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4277,4427],"content":"See <bpt id=\"p1\">[</bpt>IObjectWithSite::SetSite<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms683869)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IObjectWithSite::SetSite](http://msdn.microsoft.com/library/windows/desktop/ms683869) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4436,4444],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[4448,4497],"content":"<bpt id=\"p1\">[</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","source":"[Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"IObjectWithSiteImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::IObjectWithSiteImpl\"\n  - \"ATL.IObjectWithSiteImpl<T>\"\n  - \"IObjectWithSiteImpl\"\n  - \"ATL.IObjectWithSiteImpl\"\n  - \"ATL::IObjectWithSiteImpl<T>\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IObjectWithSiteImpl class\"\nms.assetid: 4e1f774f-bc3d-45ee-9a1c-c3533a511588\ncaps.latest.revision: 18\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IObjectWithSiteImpl Class\nThis class provides methods allowing an object to communicate with its site.  \n  \n## Syntax  \n  \n```\ntemplate <class   T>\n    class ATL_NO_VTABLE IObjectWithSiteImpl :\n    public IObjectWithSite\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `IObjectWithSiteImpl`.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IObjectWithSiteImpl::GetSite](#iobjectwithsiteimpl__getsite)|Queries the site for an interface pointer.|  \n|[IObjectWithSiteImpl::SetChildSite](#iobjectwithsiteimpl__setchildsite)|Provides the object with the site's **IUnknown** pointer.|  \n|[IObjectWithSiteImpl::SetSite](#iobjectwithsiteimpl__setsite)|Provides the object with the site's **IUnknown** pointer.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IObjectWithSiteImpl::m_spUnkSite](#iobjectwithsiteimpl__m_spunksite)|Manages the site's **IUnknown** pointer.|  \n  \n## Remarks  \n The [IObjectWithSite](http://msdn.microsoft.com/library/windows/desktop/ms693765) interface allows an object to communicate with its site. Class `IObjectWithSiteImpl` provides a default implementation of this interface and implements **IUnknown** by sending information to the dump device in debug builds.  \n  \n `IObjectWithSiteImpl` specifies two methods. The client first calls `SetSite`, passing the site's **IUnknown** pointer. This pointer is stored within the object, and can later be retrieved through a call to `GetSite`.  \n  \n Typically, you derive your class from `IObjectWithSiteImpl` when you are creating an object that is not a control. For controls, derive your class from [IOleObjectImpl](../../atl/reference/ioleobjectimpl-class.md), which also provides a site pointer. Do not derive your class from both `IObjectWithSiteImpl` and `IOleObjectImpl`.  \n  \n## Inheritance Hierarchy  \n `IObjectWithSite`  \n  \n `IObjectWithSiteImpl`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"iobjectwithsiteimpl__getsite\"></a>  IObjectWithSiteImpl::GetSite  \n Queries the site for a pointer to the interface identified by `riid`.  \n  \n```\nSTDMETHOD(GetSite)(\n    REFIID riid,\n    void** ppvSite);\n```  \n  \n### Remarks  \n If the site supports this interface, the pointer is returned via `ppvSite`. Otherwise, `ppvSite` is set to **NULL**.  \n  \n See [IObjectWithSite::GetSite](http://msdn.microsoft.com/library/windows/desktop/ms694452) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"iobjectwithsiteimpl__m_spunksite\"></a>  IObjectWithSiteImpl::m_spUnkSite  \n Manages the site's **IUnknown** pointer.  \n  \n```\nCComPtr<IUnknown> m_spUnkSite;\n```  \n  \n### Remarks  \n `m_spUnkSite` initially receives this pointer through a call to [SetSite](#iobjectwithsiteimpl__setsite).  \n  \n##  <a name=\"iobjectwithsiteimpl__setchildsite\"></a>  IObjectWithSiteImpl::SetChildSite  \n Provides the object with the site's **IUnknown** pointer.  \n  \n```\nHRESULT SetChildSite(IUnknown* pUnkSite);\n```  \n  \n### Parameters  \n *pUnkSite*  \n [in] Pointer to the **IUnknown** interface pointer of the site managing this object. If NULL, the object should call `IUnknown::Release` on any existing site at which point the object no longer knows its site.  \n  \n### Return Value  \n Returns `S_OK`.  \n  \n##  <a name=\"iobjectwithsiteimpl__setsite\"></a>  IObjectWithSiteImpl::SetSite  \n Provides the object with the site's **IUnknown** pointer.  \n  \n```\nSTDMETHOD(SetSite)(IUnknown* pUnkSite);\n```  \n  \n### Remarks  \n See [IObjectWithSite::SetSite](http://msdn.microsoft.com/library/windows/desktop/ms683869) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}