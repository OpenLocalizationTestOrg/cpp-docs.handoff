{"nodes":[{"pos":[12,67],"content":"CDataSource::OpenWithServiceComponents | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDataSource::OpenWithServiceComponents | Microsoft Docs","pos":[0,55]}]},{"content":"CDataSource::OpenWithServiceComponents","pos":[744,782]},{"content":"Opens a data source object using the service components in oledb32.dll.","pos":[783,854]},{"content":"Syntax","pos":[863,869]},{"content":"Parameters","pos":[1156,1166]},{"content":"[in] The <bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept> of a data provider.","pos":[1181,1219],"source":" [in] The **CLSID** of a data provider."},{"content":"[in] Program ID of a data provider.","pos":[1240,1275]},{"content":"[in] A pointer to an array of <bpt id=\"p1\">[</bpt>DBPROPSET<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms714367.aspx)</ept> structures containing properties and values to be set.","pos":[1296,1448],"source":" [in] A pointer to an array of [DBPROPSET](https://msdn.microsoft.com/en-us/library/ms714367.aspx) structures containing properties and values to be set."},{"content":"See <bpt id=\"p1\">[</bpt>Property Sets and Property Groups<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms713696.aspx)</ept> in the <bpt id=\"p2\">*</bpt>OLE DB Programmer's Reference<ept id=\"p2\">*</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[1449,1643],"source":" See [Property Sets and Property Groups](https://msdn.microsoft.com/en-us/library/ms713696.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"If the data source object is initialized, the properties must belong to the Data Source property group.","pos":[1644,1747]},{"content":"If the same property is specified more than once in <ph id=\"ph1\">`pPropset`</ph>, then which value is used is provider-specific.","pos":[1748,1858],"source":" If the same property is specified more than once in `pPropset`, then which value is used is provider-specific."},{"content":"If <ph id=\"ph1\">`ulPropSets`</ph> is zero, this parameter is ignored.","pos":[1859,1910],"source":" If `ulPropSets` is zero, this parameter is ignored."},{"content":"[in] The number of <bpt id=\"p1\">[</bpt>DBPROPSET<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms714367.aspx)</ept> structures passed in the <bpt id=\"p2\">*</bpt>pPropSet<ept id=\"p2\">*</ept> argument.","pos":[1933,2065],"source":" [in] The number of [DBPROPSET](https://msdn.microsoft.com/en-us/library/ms714367.aspx) structures passed in the *pPropSet* argument."},{"content":"If this is zero, the provider ignores <ph id=\"ph1\">`pPropset`</ph>.","pos":[2066,2115],"source":" If this is zero, the provider ignores `pPropset`."},{"content":"Return Value","pos":[2124,2136]},{"pos":[2140,2161],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph>.","source":"A standard `HRESULT`."},{"content":"Remarks","pos":[2170,2177]},{"content":"This method opens a data source object using the service components in oledb32.dll; this DLL contains the implementation of Service Components features such as Resource Pooling, Automatic Transaction Enlistment, and so on.","pos":[2181,2403]},{"content":"For more information, see \"OLE DB Services\" in the OLE DB Programmer's Reference at <bpt id=\"p1\">[</bpt>http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true<ept id=\"p1\">](http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true)</ept>.","pos":[2404,2701],"source":" For more information, see \"OLE DB Services\" in the OLE DB Programmer's Reference at [http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true](http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true)."},{"content":"Requirements","pos":[2710,2722]},{"pos":[2726,2748],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldbcli.h","source":"**Header:** atldbcli.h"},{"content":"See Also","pos":[2757,2765]},{"content":"CDataSource Class","pos":[2770,2787]}],"content":"---\ntitle: \"CDataSource::OpenWithServiceComponents | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"CDataSource::OpenWithServiceComponents\"\n  - \"OpenWithServiceComponents\"\n  - \"CDataSource.OpenWithServiceComponents\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OpenWithServiceComponents method\"\nms.assetid: 49c1d037-36ae-4fde-8e54-ced623abe1a9\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDataSource::OpenWithServiceComponents\nOpens a data source object using the service components in oledb32.dll.  \n  \n## Syntax  \n  \n```  \n  \n      HRESULT OpenWithServiceComponents (  \n   const CLSID clsid,  \n   DBPROPSET* pPropset = NULL,  \n   ULONG ulPropSets = 1   \n);  \nHRESULT OpenWithServiceComponents (  \n   LPCSTR szProgID,  \n   DBPROPSET* pPropset = NULL,  \n   ULONG ulPropSets = 1   \n);  \n```  \n  \n#### Parameters  \n `clsid`  \n [in] The **CLSID** of a data provider.  \n  \n `szProgID`  \n [in] Program ID of a data provider.  \n  \n `pPropset`  \n [in] A pointer to an array of [DBPROPSET](https://msdn.microsoft.com/en-us/library/ms714367.aspx) structures containing properties and values to be set. See [Property Sets and Property Groups](https://msdn.microsoft.com/en-us/library/ms713696.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]. If the data source object is initialized, the properties must belong to the Data Source property group. If the same property is specified more than once in `pPropset`, then which value is used is provider-specific. If `ulPropSets` is zero, this parameter is ignored.  \n  \n `ulPropSets`  \n [in] The number of [DBPROPSET](https://msdn.microsoft.com/en-us/library/ms714367.aspx) structures passed in the *pPropSet* argument. If this is zero, the provider ignores `pPropset`.  \n  \n## Return Value  \n A standard `HRESULT`.  \n  \n## Remarks  \n This method opens a data source object using the service components in oledb32.dll; this DLL contains the implementation of Service Components features such as Resource Pooling, Automatic Transaction Enlistment, and so on. For more information, see \"OLE DB Services\" in the OLE DB Programmer's Reference at [http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true](http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true).  \n  \n## Requirements  \n **Header:** atldbcli.h  \n  \n## See Also  \n [CDataSource Class](../../data/oledb/cdatasource-class.md)"}