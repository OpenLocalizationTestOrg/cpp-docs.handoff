{"nodes":[{"pos":[12,53],"content":"String Conversion Macros | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"String Conversion Macros | Microsoft Docs","pos":[0,41]}]},{"pos":[536,560],"content":"String Conversion Macros","linkify":"String Conversion Macros","nodes":[{"content":"String Conversion Macros","pos":[0,24]}]},{"content":"These macros provide string conversion features.","pos":[561,609]},{"pos":[630,740],"content":"<bpt id=\"p1\">[</bpt>ATL and MFC String Conversion Macros<ept id=\"p1\">](http://msdn.microsoft.com/library/8f53659e-0464-4424-97db-6b8453c49863)</ept>","source":"[ATL and MFC String Conversion Macros](http://msdn.microsoft.com/library/8f53659e-0464-4424-97db-6b8453c49863)"},{"content":"Set of macros that convert between string types.","pos":[741,789]},{"pos":[794,915],"content":"<bpt id=\"p1\">[</bpt>DEVMODE and TEXTMETRIC String Conversion Macros<ept id=\"p1\">](http://msdn.microsoft.com/library/85cebec0-2a18-48e5-9c1c-99d5b7f15425)</ept>","source":"[DEVMODE and TEXTMETRIC String Conversion Macros](http://msdn.microsoft.com/library/85cebec0-2a18-48e5-9c1c-99d5b7f15425)"},{"pos":[916,1000],"content":"Set of macros that convert the strings within <ph id=\"ph1\">`DEVMODE`</ph> and <ph id=\"ph2\">`TEXTMETRIC`</ph> structures.","source":"Set of macros that convert the strings within `DEVMODE` and `TEXTMETRIC` structures."},{"pos":[1011,1100],"content":"<bpt id=\"p1\">&lt;a name=\"atl_and_mfc_string_conversion_macros\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  ATL and MFC String Conversion Macros","linkify":"<a name=\"atl_and_mfc_string_conversion_macros\"></a>  ATL and MFC String Conversion Macros","source":"<a name=\"atl_and_mfc_string_conversion_macros\"></a>  ATL and MFC String Conversion Macros"},{"content":"The string conversion macros discussed here are valid for both ATL and MFC.","pos":[1104,1179]},{"content":"For more information on MFC string conversion, see <bpt id=\"p1\">[</bpt>TN059: Using MFC MBCS/Unicode Conversion Macros<ept id=\"p1\">](../../mfc/tn059-using-mfc-mbcs-unicode-conversion-macros.md)</ept> and <bpt id=\"p2\">[</bpt>MFC Macros and Globals<ept id=\"p2\">](../../mfc/reference/mfc-macros-and-globals.md)</ept>.","pos":[1180,1418],"source":" For more information on MFC string conversion, see [TN059: Using MFC MBCS/Unicode Conversion Macros](../../mfc/tn059-using-mfc-mbcs-unicode-conversion-macros.md) and [MFC Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)."},{"pos":[1428,1539],"content":"<bpt id=\"p1\">&lt;a name=\"devmode_and_textmetric_string_conversion_macros\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  DEVMODE and TEXTMETRIC String Conversion Macros","linkify":"<a name=\"devmode_and_textmetric_string_conversion_macros\"></a>  DEVMODE and TEXTMETRIC String Conversion Macros","source":"<a name=\"devmode_and_textmetric_string_conversion_macros\"></a>  DEVMODE and TEXTMETRIC String Conversion Macros"},{"content":"These macros create a copy of a <bpt id=\"p1\">[</bpt>DEVMODE<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/dd183565)</ept> or <bpt id=\"p2\">[</bpt>TEXTMETRIC<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/dd145132)</ept> structure and convert the strings within the new structure to a new string type.","pos":[1543,1801],"source":"These macros create a copy of a [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) or [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) structure and convert the strings within the new structure to a new string type."},{"content":"The macros allocate memory on the stack for the new structure and return a pointer to the new structure.","pos":[1802,1906]},{"pos":[1963,1970],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"For example:","pos":[1974,1986]},{"pos":[1993,2085],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_ATL_Utilities#128<ept id=\"p2\">](../../atl/codesnippet/cpp/string-conversion-macros_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_ATL_Utilities#128](../../atl/codesnippet/cpp/string-conversion-macros_1.cpp)]"},{"content":"and:","pos":[2092,2096]},{"pos":[2103,2195],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_ATL_Utilities#129<ept id=\"p2\">](../../atl/codesnippet/cpp/string-conversion-macros_2.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_ATL_Utilities#129](../../atl/codesnippet/cpp/string-conversion-macros_2.cpp)]"},{"content":"In the macro names, the string type in the source structure is on the left (for example, <bpt id=\"p1\">**</bpt>A<ept id=\"p1\">**</ept>) and the string type in the destination structure is on the right (for example, <bpt id=\"p2\">**</bpt>W<ept id=\"p2\">**</ept>).","pos":[2202,2384],"source":"In the macro names, the string type in the source structure is on the left (for example, **A**) and the string type in the destination structure is on the right (for example, **W**)."},{"content":"<bpt id=\"p1\">**</bpt>A<ept id=\"p1\">**</ept> stands for <bpt id=\"p2\">**</bpt>LPSTR<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>OLE<ept id=\"p3\">**</ept> stands for <ph id=\"ph1\">`LPOLESTR`</ph>, <bpt id=\"p4\">**</bpt>T<ept id=\"p4\">**</ept> stands for <ph id=\"ph2\">`LPTSTR`</ph>, and <bpt id=\"p5\">**</bpt>W<ept id=\"p5\">**</ept> stands for <ph id=\"ph3\">`LPWSTR`</ph>.","pos":[2385,2501],"source":"**A** stands for **LPSTR**, **OLE** stands for `LPOLESTR`, **T** stands for `LPTSTR`, and **W** stands for `LPWSTR`."},{"pos":[2508,2766],"content":"Thus, <ph id=\"ph1\">`DEVMODEA2W`</ph> copies a <ph id=\"ph2\">`DEVMODE`</ph> structure with <bpt id=\"p1\">**</bpt>LPSTR<ept id=\"p1\">**</ept> strings into a <ph id=\"ph3\">`DEVMODE`</ph> structure with <ph id=\"ph4\">`LPWSTR`</ph> strings, <ph id=\"ph5\">`TEXTMETRICOLE2T`</ph> copies a <ph id=\"ph6\">`TEXTMETRIC`</ph> structure with <ph id=\"ph7\">`LPOLESTR`</ph> strings into a <ph id=\"ph8\">`TEXTMETRIC`</ph> structure with <ph id=\"ph9\">`LPTSTR`</ph> strings, and so on.","source":"Thus, `DEVMODEA2W` copies a `DEVMODE` structure with **LPSTR** strings into a `DEVMODE` structure with `LPWSTR` strings, `TEXTMETRICOLE2T` copies a `TEXTMETRIC` structure with `LPOLESTR` strings into a `TEXTMETRIC` structure with `LPTSTR` strings, and so on."},{"content":"The two strings converted in the <ph id=\"ph1\">`DEVMODE`</ph> structure are the device name ( <bpt id=\"p1\">**</bpt>dmDeviceName<ept id=\"p1\">**</ept>) and the form name ( <bpt id=\"p2\">**</bpt>dmFormName<ept id=\"p2\">**</ept>).","pos":[2773,2902],"source":"The two strings converted in the `DEVMODE` structure are the device name ( **dmDeviceName**) and the form name ( **dmFormName**)."},{"content":"The <ph id=\"ph1\">`DEVMODE`</ph> string conversion macros also update the structure size ( <bpt id=\"p1\">**</bpt>dmSize<ept id=\"p1\">**</ept>).","pos":[2903,2987],"source":" The `DEVMODE` string conversion macros also update the structure size ( **dmSize**)."},{"pos":[2994,3220],"content":"The four strings converted in the <ph id=\"ph1\">`TEXTMETRIC`</ph> structure are the first character ( <bpt id=\"p1\">**</bpt>tmFirstChar<ept id=\"p1\">**</ept>), the last character ( <bpt id=\"p2\">**</bpt>tmLastChar<ept id=\"p2\">**</ept>), the default character ( <bpt id=\"p3\">**</bpt>tmDefaultChar<ept id=\"p3\">**</ept>), and the break character ( <bpt id=\"p4\">**</bpt>tmBreakChar<ept id=\"p4\">**</ept>).","source":"The four strings converted in the `TEXTMETRIC` structure are the first character ( **tmFirstChar**), the last character ( **tmLastChar**), the default character ( **tmDefaultChar**), and the break character ( **tmBreakChar**)."},{"content":"The behavior of the <ph id=\"ph1\">`DEVMODE`</ph> and <ph id=\"ph2\">`TEXTMETRIC`</ph> string conversion macros depends on the compiler directive in effect, if any.","pos":[3227,3351],"source":"The behavior of the `DEVMODE` and `TEXTMETRIC` string conversion macros depends on the compiler directive in effect, if any."},{"content":"If the source and destination types are the same, no conversion takes place.","pos":[3352,3428]},{"content":"Compiler directives change <bpt id=\"p1\">**</bpt>T<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>OLE<ept id=\"p2\">**</ept> as follows:","pos":[3429,3485],"source":" Compiler directives change **T** and **OLE** as follows:"},{"content":"Compiler directive in effect","pos":[3492,3520]},{"content":"T becomes","pos":[3521,3530]},{"content":"OLE becomes","pos":[3531,3542]},{"content":"none","pos":[3620,3624]},{"pos":[3625,3630],"content":"<bpt id=\"p1\">**</bpt>A<ept id=\"p1\">**</ept>","source":"**A**"},{"pos":[3631,3636],"content":"<bpt id=\"p1\">**</bpt>W<ept id=\"p1\">**</ept>","source":"**W**"},{"pos":[3641,3653],"content":"<bpt id=\"p1\">**</bpt>_UNICODE<ept id=\"p1\">**</ept>","source":"**_UNICODE**"},{"pos":[3654,3659],"content":"<bpt id=\"p1\">**</bpt>W<ept id=\"p1\">**</ept>","source":"**W**"},{"pos":[3660,3665],"content":"<bpt id=\"p1\">**</bpt>W<ept id=\"p1\">**</ept>","source":"**W**"},{"pos":[3670,3682],"content":"<bpt id=\"p1\">**</bpt>OLE2ANSI<ept id=\"p1\">**</ept>","source":"**OLE2ANSI**"},{"pos":[3683,3688],"content":"<bpt id=\"p1\">**</bpt>A<ept id=\"p1\">**</ept>","source":"**A**"},{"pos":[3689,3694],"content":"<bpt id=\"p1\">**</bpt>A<ept id=\"p1\">**</ept>","source":"**A**"},{"pos":[3699,3728],"content":"<bpt id=\"p1\">**</bpt>_UNICODE<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>OLE2ANSI<ept id=\"p2\">**</ept>","source":"**_UNICODE** and **OLE2ANSI**"},{"pos":[3729,3734],"content":"<bpt id=\"p1\">**</bpt>W<ept id=\"p1\">**</ept>","source":"**W**"},{"pos":[3735,3740],"content":"<bpt id=\"p1\">**</bpt>A<ept id=\"p1\">**</ept>","source":"**A**"},{"pos":[3748,3830],"content":"The following table lists the <ph id=\"ph1\">`DEVMODE`</ph> and <ph id=\"ph2\">`TEXTMETRIC`</ph> string conversion macros.","source":"The following table lists the `DEVMODE` and `TEXTMETRIC` string conversion macros."},{"pos":[3840,3887],"content":"DEVMODE and TEXTMETRIC String Conversion Macros","linkify":"DEVMODE and TEXTMETRIC String Conversion Macros","nodes":[{"content":"DEVMODE and TEXTMETRIC String Conversion Macros","pos":[0,47]}]},{"pos":[4053,4061],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[4065,4108],"content":"<bpt id=\"p1\">[</bpt>Macros<ept id=\"p1\">](../../atl/reference/atl-macros.md)</ept>","source":"[Macros](../../atl/reference/atl-macros.md)"}],"content":"---\ntitle: \"String Conversion Macros | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nms.assetid: 2ff7c0b6-2bde-45fe-897f-6128e18e0c27\ncaps.latest.revision: 16\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# String Conversion Macros\nThese macros provide string conversion features.  \n  \n|||  \n|-|-|  \n|[ATL and MFC String Conversion Macros](http://msdn.microsoft.com/library/8f53659e-0464-4424-97db-6b8453c49863)|Set of macros that convert between string types.|  \n|[DEVMODE and TEXTMETRIC String Conversion Macros](http://msdn.microsoft.com/library/85cebec0-2a18-48e5-9c1c-99d5b7f15425)|Set of macros that convert the strings within `DEVMODE` and `TEXTMETRIC` structures.|  \n  \n##  <a name=\"atl_and_mfc_string_conversion_macros\"></a>  ATL and MFC String Conversion Macros  \n The string conversion macros discussed here are valid for both ATL and MFC. For more information on MFC string conversion, see [TN059: Using MFC MBCS/Unicode Conversion Macros](../../mfc/tn059-using-mfc-mbcs-unicode-conversion-macros.md) and [MFC Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md).  \n  \n##  <a name=\"devmode_and_textmetric_string_conversion_macros\"></a>  DEVMODE and TEXTMETRIC String Conversion Macros  \n These macros create a copy of a [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) or [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) structure and convert the strings within the new structure to a new string type. The macros allocate memory on the stack for the new structure and return a pointer to the new structure.  \n  \n```\nMACRONAME( address_of_structure )\n```  \n  \n### Remarks  \n For example:  \n  \n [!code-cpp[NVC_ATL_Utilities#128](../../atl/codesnippet/cpp/string-conversion-macros_1.cpp)]  \n  \n and:  \n  \n [!code-cpp[NVC_ATL_Utilities#129](../../atl/codesnippet/cpp/string-conversion-macros_2.cpp)]  \n  \n In the macro names, the string type in the source structure is on the left (for example, **A**) and the string type in the destination structure is on the right (for example, **W**). **A** stands for **LPSTR**, **OLE** stands for `LPOLESTR`, **T** stands for `LPTSTR`, and **W** stands for `LPWSTR`.  \n  \n Thus, `DEVMODEA2W` copies a `DEVMODE` structure with **LPSTR** strings into a `DEVMODE` structure with `LPWSTR` strings, `TEXTMETRICOLE2T` copies a `TEXTMETRIC` structure with `LPOLESTR` strings into a `TEXTMETRIC` structure with `LPTSTR` strings, and so on.  \n  \n The two strings converted in the `DEVMODE` structure are the device name ( **dmDeviceName**) and the form name ( **dmFormName**). The `DEVMODE` string conversion macros also update the structure size ( **dmSize**).  \n  \n The four strings converted in the `TEXTMETRIC` structure are the first character ( **tmFirstChar**), the last character ( **tmLastChar**), the default character ( **tmDefaultChar**), and the break character ( **tmBreakChar**).  \n  \n The behavior of the `DEVMODE` and `TEXTMETRIC` string conversion macros depends on the compiler directive in effect, if any. If the source and destination types are the same, no conversion takes place. Compiler directives change **T** and **OLE** as follows:  \n  \n|Compiler directive in effect|T becomes|OLE becomes|  \n|----------------------------------|---------------|-----------------|  \n|none|**A**|**W**|  \n|**_UNICODE**|**W**|**W**|  \n|**OLE2ANSI**|**A**|**A**|  \n|**_UNICODE** and **OLE2ANSI**|**W**|**A**|  \n  \n The following table lists the `DEVMODE` and `TEXTMETRIC` string conversion macros.  \n  \n### DEVMODE and TEXTMETRIC String Conversion Macros  \n  \n|||  \n|-|-|  \n|`DEVMODEA2W`|`TEXTMETRICA2W`|  \n|`DEVMODEOLE2T`|`TEXTMETRICOLE2T`|  \n|`DEVMODET2OLE`|`TEXTMETRICT2OLE`|  \n|`DEVMODEW2A`|`TEXTMETRICW2A`|  \n  \n## See Also  \n [Macros](../../atl/reference/atl-macros.md)\n\n"}