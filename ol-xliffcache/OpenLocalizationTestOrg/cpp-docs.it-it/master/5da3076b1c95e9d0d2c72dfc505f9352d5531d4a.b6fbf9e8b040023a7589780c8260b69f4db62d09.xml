{"nodes":[{"pos":[12,47],"content":"CDaoTableDef Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDaoTableDef Class | Microsoft Docs","pos":[0,35]}]},{"content":"CDaoTableDef Class","pos":[772,790]},{"content":"Represents the stored definition of a base table or an attached table.","pos":[791,861]},{"content":"Syntax","pos":[870,876]},{"content":"Members","pos":[938,945]},{"content":"Public Constructors","pos":[955,974]},{"content":"Name","pos":[981,985]},{"content":"Description","pos":[986,997]},{"content":"CDaoTableDef::CDaoTableDef","pos":[1036,1062]},{"pos":[1093,1130],"content":"Constructs a <bpt id=\"p1\">**</bpt>CDaoTableDef<ept id=\"p1\">**</ept> object.","source":"Constructs a **CDaoTableDef** object."},{"content":"Public Methods","pos":[1141,1155]},{"content":"Name","pos":[1162,1166]},{"content":"Description","pos":[1167,1178]},{"content":"CDaoTableDef::Append","pos":[1217,1237]},{"content":"Adds a new table to the database.","pos":[1262,1295]},{"content":"CDaoTableDef::CanUpdate","pos":[1301,1324]},{"content":"Returns nonzero if the table can be updated (you can modify the definition of fields or the table properties).","pos":[1352,1462]},{"content":"CDaoTableDef::Close","pos":[1468,1487]},{"content":"Closes an open tabledef.","pos":[1511,1535]},{"content":"CDaoTableDef::Create","pos":[1541,1561]},{"pos":[1586,1675],"content":"Creates a table which can be added to the database using <bpt id=\"p1\">[</bpt>Append<ept id=\"p1\">](#cdaotabledef__append)</ept>.","source":"Creates a table which can be added to the database using [Append](#cdaotabledef__append)."},{"content":"CDaoTableDef::CreateField","pos":[1681,1706]},{"content":"Called to create a field for a table.","pos":[1736,1773]},{"content":"CDaoTableDef::CreateIndex","pos":[1779,1804]},{"content":"Called to create an index for a table.","pos":[1834,1872]},{"content":"CDaoTableDef::DeleteField","pos":[1878,1903]},{"content":"Called to delete a field from a table.","pos":[1933,1971]},{"content":"CDaoTableDef::DeleteIndex","pos":[1977,2002]},{"content":"Called to delete an index from a table.","pos":[2032,2071]},{"content":"CDaoTableDef::GetAttributes","pos":[2077,2104]},{"pos":[2136,2222],"content":"Returns a value that indicates one or more characteristics of a <ph id=\"ph1\">`CDaoTableDef`</ph> object.","source":"Returns a value that indicates one or more characteristics of a `CDaoTableDef` object."},{"content":"CDaoTableDef::GetConnect","pos":[2228,2252]},{"content":"Returns a value that provides information about the source of a table.","pos":[2281,2351]},{"content":"CDaoTableDef::GetDateCreated","pos":[2357,2385]},{"pos":[2418,2506],"content":"Returns the date and time the base table underlying a <ph id=\"ph1\">`CDaoTableDef`</ph> object was created.","source":"Returns the date and time the base table underlying a `CDaoTableDef` object was created."},{"content":"CDaoTableDef::GetDateLastUpdated","pos":[2512,2544]},{"content":"Returns the date and time of the most recent change made to the design of the base table.","pos":[2581,2670]},{"content":"CDaoTableDef::GetFieldCount","pos":[2676,2703]},{"content":"Returns a value that represents the number of fields in the table.","pos":[2735,2801]},{"content":"CDaoTableDef::GetFieldInfo","pos":[2807,2833]},{"content":"Returns specific kinds of information about the fields in the table.","pos":[2864,2932]},{"content":"CDaoTableDef::GetIndexCount","pos":[2938,2965]},{"content":"Returns the number of indexes for the table.","pos":[2997,3041]},{"content":"CDaoTableDef::GetIndexInfo","pos":[3047,3073]},{"content":"Returns specific kinds of information about the indexes for the table.","pos":[3104,3174]},{"content":"CDaoTableDef::GetName","pos":[3180,3201]},{"content":"Returns the user-defined name of the table.","pos":[3227,3270]},{"content":"CDaoTableDef::GetRecordCount","pos":[3276,3304]},{"content":"Returns the number of records in the table.","pos":[3337,3380]},{"content":"CDaoTableDef::GetSourceTableName","pos":[3386,3418]},{"content":"Returns a value that specifies the name of the attached table in the source database.","pos":[3455,3540]},{"content":"CDaoTableDef::GetValidationRule","pos":[3546,3577]},{"content":"Returns a value that validates the data in a field as it is changed or added to a table.","pos":[3613,3701]},{"content":"CDaoTableDef::GetValidationText","pos":[3707,3738]},{"content":"Returns a value that specifies the text of the message that your application displays if the value of a Field object does not satisfy the specified validation rule.","pos":[3774,3938]},{"content":"CDaoTableDef::IsOpen","pos":[3944,3964]},{"content":"Returns nonzero if the table is open.","pos":[3989,4026]},{"content":"CDaoTableDef::Open","pos":[4032,4050]},{"content":"Opens an existing tabledef stored in the database's TableDef's collection.","pos":[4073,4147]},{"content":"CDaoTableDef::RefreshLink","pos":[4153,4178]},{"content":"Updates the connection information for an attached table.","pos":[4208,4265]},{"content":"CDaoTableDef::SetAttributes","pos":[4271,4298]},{"pos":[4330,4413],"content":"Sets a value that indicates one or more characteristics of a <ph id=\"ph1\">`CDaoTableDef`</ph> object.","source":"Sets a value that indicates one or more characteristics of a `CDaoTableDef` object."},{"content":"CDaoTableDef::SetConnect","pos":[4419,4443]},{"content":"Sets a value that provides information about the source of a table.","pos":[4472,4539]},{"content":"CDaoTableDef::SetName","pos":[4545,4566]},{"content":"Sets the name of the table.","pos":[4592,4619]},{"content":"CDaoTableDef::SetSourceTableName","pos":[4625,4657]},{"content":"Sets a value that specifies the name of an attached table in the source database.","pos":[4694,4775]},{"content":"CDaoTableDef::SetValidationRule","pos":[4781,4812]},{"content":"Sets a value that validates the data in a field as it is changed or added to a table.","pos":[4848,4933]},{"content":"CDaoTableDef::SetValidationText","pos":[4939,4970]},{"content":"Sets a value that specifies the text of the message that your application displays if the value of a Field object does not satisfy the specified validation rule.","pos":[5006,5167]},{"content":"Public Data Members","pos":[5178,5197]},{"content":"Name","pos":[5204,5208]},{"content":"Description","pos":[5209,5220]},{"content":"CDaoTableDef::m_pDAOTableDef","pos":[5259,5287]},{"content":"A pointer to the DAO interface underlying the tabledef object.","pos":[5320,5382]},{"content":"CDaoTableDef::m_pDatabase","pos":[5388,5413]},{"content":"Source database for this table.","pos":[5443,5474]},{"content":"Remarks","pos":[5484,5491]},{"content":"Each DAO database object maintains a collection, called TableDefs, that contains all saved DAO tabledef objects.","pos":[5495,5607]},{"content":"You manipulate a table definition using a <ph id=\"ph1\">`CDaoTableDef`</ph> object.","pos":[5614,5678],"source":"You manipulate a table definition using a `CDaoTableDef` object."},{"content":"For example, you can:","pos":[5679,5700]},{"content":"Examine the field and index structure of any local, attached, or external table in a database.","pos":[5710,5804]},{"pos":[5814,5982],"content":"Call the <ph id=\"ph1\">`SetConnect`</ph> and <ph id=\"ph2\">`SetSourceTableName`</ph> member functions for attached tables, and use the <ph id=\"ph3\">`RefreshLink`</ph> member function to update connections to attached tables.","source":"Call the `SetConnect` and `SetSourceTableName` member functions for attached tables, and use the `RefreshLink` member function to update connections to attached tables."},{"pos":[5992,6089],"content":"Call the <ph id=\"ph1\">`CanUpdate`</ph> member function to determine if you can edit field definitions in the table.","source":"Call the `CanUpdate` member function to determine if you can edit field definitions in the table."},{"pos":[6099,6256],"content":"Get or set validation conditions using the <ph id=\"ph1\">`GetValidationRule`</ph> and <ph id=\"ph2\">`SetValidationRule`</ph>, and the <ph id=\"ph3\">`GetValidationText`</ph> and <ph id=\"ph4\">`SetValidationText`</ph> member functions.","source":"Get or set validation conditions using the `GetValidationRule` and `SetValidationRule`, and the `GetValidationText` and `SetValidationText` member functions."},{"pos":[6266,6369],"content":"Use the <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> member function to create a table-, dynaset-, or snapshot-type <ph id=\"ph1\">`CDaoRecordset`</ph> object.","source":"Use the **Open** member function to create a table-, dynaset-, or snapshot-type `CDaoRecordset` object."},{"pos":[6381,6739],"content":"[!NOTE]\n The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes; the DAO classes generally offer superior capabilities because they are specific to the Microsoft Jet database engine.","leadings":["","    > "],"nodes":[{"content":" The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes; the DAO classes generally offer superior capabilities because they are specific to the Microsoft Jet database engine.","pos":[8,352],"nodes":[{"content":"The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC).","pos":[1,112]},{"content":"All DAO database class names have the \"CDao\" prefix.","pos":[113,165]},{"content":"You can still access ODBC data sources with the DAO classes; the DAO classes generally offer superior capabilities because they are specific to the Microsoft Jet database engine.","pos":[166,344]}]}]},{"content":"To use tabledef objects either to work with an existing table or to create a new table","pos":[6749,6835]},{"pos":[6845,7017],"content":"In all cases, first construct a <ph id=\"ph1\">`CDaoTableDef`</ph> object, supplying a pointer to a <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object to which the table belongs.","source":"In all cases, first construct a `CDaoTableDef` object, supplying a pointer to a [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object to which the table belongs."},{"content":"Then do the following, depending on what you want:","pos":[7027,7077]},{"pos":[7091,7233],"content":"To use an existing saved table, call the tabledef object's <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaotabledef__open)</ept> member function, supplying the name of the saved table.","source":"To use an existing saved table, call the tabledef object's [Open](#cdaotabledef__open) member function, supplying the name of the saved table."},{"content":"To create a new table, call the tabledef object's <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaotabledef__create)</ept> member function, supplying the name of the table.","pos":[7247,7378],"source":"To create a new table, call the tabledef object's [Create](#cdaotabledef__create) member function, supplying the name of the table."},{"content":"Call <bpt id=\"p1\">[</bpt>CreateField<ept id=\"p1\">](#cdaotabledef__createfield)</ept> and <bpt id=\"p2\">[</bpt>CreateIndex<ept id=\"p2\">](#cdaotabledef__createindex)</ept> to add fields and indexes to the table.","pos":[7379,7511],"source":" Call [CreateField](#cdaotabledef__createfield) and [CreateIndex](#cdaotabledef__createindex) to add fields and indexes to the table."},{"content":"Call <bpt id=\"p1\">[</bpt>Append<ept id=\"p1\">](#cdaotabledef__append)</ept> to save the table by appending it to the database's TableDefs collection.","pos":[7525,7635],"source":"Call [Append](#cdaotabledef__append) to save the table by appending it to the database's TableDefs collection."},{"content":"<bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> puts the tabledef into an open state, so after calling <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept> you do not call <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept>.","pos":[7636,7738],"source":"**Create** puts the tabledef into an open state, so after calling **Create** you do not call **Open**."},{"pos":[7754,7933],"content":"[!TIP]\n The easiest way to create saved tables is to create them and store them in your database using Microsoft Access. Then you can open and use them in your MFC code.","leadings":["","        > "],"nodes":[{"content":" The easiest way to create saved tables is to create them and store them in your database using Microsoft Access. Then you can open and use them in your MFC code.","pos":[7,169],"nodes":[{"content":"The easiest way to create saved tables is to create them and store them in your database using Microsoft Access.","pos":[1,113]},{"content":"Then you can open and use them in your MFC code.","pos":[114,162]}]}]},{"pos":[7940,8131],"content":"To use the tabledef object you have opened or created, create and open a <ph id=\"ph1\">`CDaoRecordset`</ph> object, specifying the name of the tabledef with a <bpt id=\"p1\">**</bpt>dbOpenTable<ept id=\"p1\">**</ept> value in the <ph id=\"ph2\">`nOpenType`</ph> parameter.","source":"To use the tabledef object you have opened or created, create and open a `CDaoRecordset` object, specifying the name of the tabledef with a **dbOpenTable** value in the `nOpenType` parameter."},{"content":"To use a tabledef object to create a <ph id=\"ph1\">`CDaoRecordset`</ph> object, you typically create or open a tabledef as described above, then construct a recordset object, passing a pointer to your tabledef object when you call <bpt id=\"p1\">[</bpt>CDaoRecordset::Open<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__open)</ept>.","pos":[8138,8436],"source":"To use a tabledef object to create a `CDaoRecordset` object, you typically create or open a tabledef as described above, then construct a recordset object, passing a pointer to your tabledef object when you call [CDaoRecordset::Open](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__open)."},{"content":"The tabledef you pass must be in an open state.","pos":[8437,8484]},{"content":"For more information, see class <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept>.","pos":[8485,8577],"source":" For more information, see class [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)."},{"pos":[8584,8757],"content":"When you finish using a tabledef object, call its <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__close)</ept> member function; then destroy the tabledef object.","source":"When you finish using a tabledef object, call its [Close](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__close) member function; then destroy the tabledef object."},{"content":"Inheritance Hierarchy","pos":[8766,8787]},{"content":"CObject","pos":[8792,8799]},{"content":"Requirements","pos":[8868,8880]},{"pos":[8884,8904],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdao.h","source":"**Header:** afxdao.h"},{"pos":[8951,8971],"content":"CDaoTableDef::Append"},{"pos":[8975,9117],"content":"Call this member function after you call <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaotabledef__create)</ept> to create a new tabledef object to save the tabledef in the database.","source":"Call this member function after you call [Create](#cdaotabledef__create) to create a new tabledef object to save the tabledef in the database."},{"content":"Remarks","pos":[9165,9172]},{"content":"The function appends the object to the database's TableDefs collection.","pos":[9176,9247]},{"content":"You can use the tabledef as a temporary object while defining it by not appending it, but if you want to save and use it, you must call <bpt id=\"p1\">**</bpt>Append<ept id=\"p1\">**</ept>.","pos":[9248,9395],"source":" You can use the tabledef as a temporary object while defining it by not appending it, but if you want to save and use it, you must call **Append**."},{"pos":[9403,9520],"content":"[!NOTE]\n If you attempt to append an unnamed tabledef (containing a null or empty string), MFC throws an exception.","leadings":["","> "],"nodes":[{"content":"If you attempt to append an unnamed tabledef (containing a null or empty string), MFC throws an exception.","pos":[9,115]}]},{"content":"For related information, see the topic \"Append Method\" in DAO Help.","pos":[9527,9594]},{"pos":[9644,9667],"content":"CDaoTableDef::CanUpdate"},{"pos":[9671,9796],"content":"Call this member function to determine whether the definition of the table underlying a <ph id=\"ph1\">`CDaoTableDef`</ph> object can be changed.","source":"Call this member function to determine whether the definition of the table underlying a `CDaoTableDef` object can be changed."},{"content":"Return Value","pos":[9839,9851]},{"content":"Nonzero if the table structure (schema) can be modified (add or delete fields and indexes), otherwise 0.","pos":[9855,9959]},{"content":"Remarks","pos":[9969,9976]},{"content":"By default, a newly created table underlying a <ph id=\"ph1\">`CDaoTableDef`</ph> object can be updated, and an attached table underlying a <ph id=\"ph2\">`CDaoTableDef`</ph> object cannot be updated.","pos":[9980,10140],"source":"By default, a newly created table underlying a `CDaoTableDef` object can be updated, and an attached table underlying a `CDaoTableDef` object cannot be updated."},{"content":"A <ph id=\"ph1\">`CDaoTableDef`</ph> object may be updatable, even if the resulting recordset is not updatable.","pos":[10141,10232],"source":" A `CDaoTableDef` object may be updatable, even if the resulting recordset is not updatable."},{"content":"For related information, see the topic \"Updatable Property\" in DAO Help.","pos":[10239,10311]},{"pos":[10364,10390],"content":"CDaoTableDef::CDaoTableDef"},{"pos":[10394,10431],"content":"Constructs a <bpt id=\"p1\">**</bpt>CDaoTableDef<ept id=\"p1\">**</ept> object.","source":"Constructs a **CDaoTableDef** object."},{"content":"Parameters","pos":[10495,10505]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object.","pos":[10524,10604],"source":" A pointer to a [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object."},{"content":"Remarks","pos":[10614,10621]},{"content":"After constructing the object, you must call the <bpt id=\"p1\">[</bpt>Create<ept id=\"p1\">](#cdaotabledef__create)</ept> or <bpt id=\"p2\">[</bpt>Open<ept id=\"p2\">](#cdaotabledef__open)</ept> member function.","pos":[10625,10753],"source":"After constructing the object, you must call the [Create](#cdaotabledef__create) or [Open](#cdaotabledef__open) member function."},{"content":"When you finish with the object, you must call its <bpt id=\"p1\">[</bpt>Close<ept id=\"p1\">](#cdaotabledef__close)</ept> member function and destroy the <ph id=\"ph1\">`CDaoTableDef`</ph> object.","pos":[10754,10889],"source":" When you finish with the object, you must call its [Close](#cdaotabledef__close) member function and destroy the `CDaoTableDef` object."},{"pos":[10935,10954],"content":"CDaoTableDef::Close"},{"content":"Call this member function to close and release the tabledef object.","pos":[10958,11025]},{"content":"Remarks","pos":[11072,11079]},{"pos":[11083,11180],"content":"Usually after calling <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept>, you delete the tabledef object if it was allocated with <bpt id=\"p2\">**</bpt>new<ept id=\"p2\">**</ept>.","source":"Usually after calling **Close**, you delete the tabledef object if it was allocated with **new**."},{"content":"You can call <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](#cdaotabledef__open)</ept> again after calling <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[11187,11258],"source":"You can call [Open](#cdaotabledef__open) again after calling **Close**."},{"content":"This lets you reuse the tabledef object.","pos":[11259,11299]},{"content":"For related information, see the topic \"Close Method\" in DAO Help.","pos":[11306,11372]},{"pos":[11419,11439],"content":"CDaoTableDef::Create"},{"content":"Call this member function to create a new saved table.","pos":[11443,11497]},{"content":"Parameters","pos":[11663,11673]},{"content":"A pointer to a string containing the name of the table.","pos":[11691,11746]},{"content":"A value corresponding to characteristics of the table represented by the tabledef object.","pos":[11770,11859]},{"content":"You can use the bitwise-OR to combine any of the following constants:","pos":[11860,11929]},{"content":"Constant","pos":[11936,11944]},{"content":"Description","pos":[11945,11956]},{"content":"dbAttachExclusive","pos":[12000,12017]},{"content":"For databases that use the Microsoft Jet database engine, indicates the table is an attached table opened for exclusive use.","pos":[12020,12144]},{"content":"dbAttachSavePWD","pos":[12151,12166]},{"content":"For databases that use the Microsoft Jet database engine, indicates that the user ID and password for the attached table are saved with the connection information.","pos":[12169,12332]},{"content":"dbSystemObject","pos":[12339,12353]},{"content":"Indicates the table is a system table provided by the Microsoft Jet database engine.","pos":[12356,12440]},{"content":"dbHiddenObject","pos":[12447,12461]},{"content":"Indicates the table is a hidden table provided by the Microsoft Jet database engine.","pos":[12464,12548]},{"content":"lpszSrcTable","pos":[12557,12569]},{"content":"A pointer to a string containing the source table name.","pos":[12574,12629]},{"content":"By default this value is initialized as <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[12630,12679],"source":" By default this value is initialized as **NULL**."},{"content":"A pointer to a string containing the default connection string.","pos":[12703,12766]},{"content":"By default this value is initialized as <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[12767,12816],"source":" By default this value is initialized as **NULL**."},{"content":"Remarks","pos":[12826,12833]},{"content":"Once you have named the tabledef, you can then call <bpt id=\"p1\">[</bpt>Append<ept id=\"p1\">](#cdaotabledef__append)</ept> to save the tabledef in the database's TableDefs collection.","pos":[12837,12981],"source":"Once you have named the tabledef, you can then call [Append](#cdaotabledef__append) to save the tabledef in the database's TableDefs collection."},{"content":"After calling <bpt id=\"p1\">**</bpt>Append<ept id=\"p1\">**</ept>, the tabledef is in an open state, and you can use it to create a <bpt id=\"p2\">[</bpt>CDaoRecordset<ept id=\"p2\">](../../mfc/reference/cdaorecordset-class.md)</ept> object.","pos":[12982,13140],"source":" After calling **Append**, the tabledef is in an open state, and you can use it to create a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object."},{"content":"For related information, see the topic \"CreateTableDef Method\" in DAO Help.","pos":[13147,13222]},{"pos":[13274,13299],"content":"CDaoTableDef::CreateField"},{"content":"Call this member function to add a field to the table.","pos":[13303,13357]},{"content":"Parameters","pos":[13540,13550]},{"content":"A pointer to a string expression specifying the name of this field.","pos":[13568,13635]},{"content":"A value indicating the data type of the field.","pos":[13653,13699]},{"content":"The setting can be one of these values:","pos":[13700,13739]},{"content":"Type","pos":[13746,13750]},{"content":"Size (bytes)","pos":[13751,13763]},{"content":"Description","pos":[13764,13775]},{"content":"dbBoolean","pos":[13836,13845]},{"content":"1 byte","pos":[13848,13854]},{"content":"BOOL","pos":[13855,13859]},{"content":"dbByte","pos":[13866,13872]},{"content":"1","pos":[13875,13876]},{"content":"BYTE","pos":[13877,13881]},{"content":"dbInteger","pos":[13888,13897]},{"content":"2","pos":[13900,13901]},{"content":"int","pos":[13902,13905]},{"content":"dbLong","pos":[13912,13918]},{"content":"4","pos":[13921,13922]},{"content":"long","pos":[13923,13927]},{"content":"dbCurrency","pos":[13934,13944]},{"content":"8","pos":[13947,13948]},{"pos":[13949,14018],"content":"Currency ( <bpt id=\"p1\">[</bpt>COleCurrency<ept id=\"p1\">](../../mfc/reference/colecurrency-class.md)</ept>)","source":"Currency ( [COleCurrency](../../mfc/reference/colecurrency-class.md))"},{"content":"dbSingle","pos":[14025,14033]},{"content":"4","pos":[14036,14037]},{"content":"float","pos":[14038,14043]},{"content":"dbDouble","pos":[14050,14058]},{"content":"8","pos":[14061,14062]},{"content":"double","pos":[14063,14069]},{"content":"dbDate","pos":[14076,14082]},{"content":"8","pos":[14085,14086]},{"pos":[14087,14168],"content":"Date/Time ( <bpt id=\"p1\">[</bpt>COleDateTime<ept id=\"p1\">](../../atl-mfc-shared/reference/coledatetime-class.md)</ept>)","source":"Date/Time ( [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md))"},{"content":"dbText","pos":[14175,14181]},{"content":"1 – 255","pos":[14184,14191]},{"pos":[14192,14259],"content":"Text ( <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept>)","source":"Text ( [CString](../../atl-mfc-shared/reference/cstringt-class.md))"},{"content":"dbLongBinary","pos":[14266,14278]},{"content":"0","pos":[14281,14282]},{"pos":[14283,14421],"content":"Long Binary (OLE Object), <bpt id=\"p1\">[</bpt>CLongBinary<ept id=\"p1\">](../../mfc/reference/clongbinary-class.md)</ept> or <bpt id=\"p2\">[</bpt>CByteArray<ept id=\"p2\">](../../mfc/reference/cbytearray-class.md)</ept>","source":"Long Binary (OLE Object), [CLongBinary](../../mfc/reference/clongbinary-class.md) or [CByteArray](../../mfc/reference/cbytearray-class.md)"},{"content":"dbMemo","pos":[14428,14434]},{"content":"0","pos":[14437,14438]},{"pos":[14439,14506],"content":"Memo ( <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept>)","source":"Memo ( [CString](../../atl-mfc-shared/reference/cstringt-class.md))"},{"content":"A value that indicates the maximum size, in bytes, of a field that contains text, or the fixed size of a field that contains text or numeric values.","pos":[14525,14673]},{"content":"The <ph id=\"ph1\">`lSize`</ph> parameter is ignored for all but text fields.","pos":[14674,14731],"source":" The `lSize` parameter is ignored for all but text fields."},{"content":"A value corresponding to characteristics of the field and that can be combined using a bitwise-OR.","pos":[14755,14853]},{"content":"Constant","pos":[14860,14868]},{"content":"Description","pos":[14869,14880]},{"content":"dbFixedField","pos":[14924,14936]},{"content":"The field size is fixed (default for Numeric fields).","pos":[14939,14992]},{"content":"dbVariableField","pos":[14999,15014]},{"content":"The field size is variable (Text fields only).","pos":[15017,15063]},{"content":"dbAutoIncrField","pos":[15070,15085]},{"content":"The field value for new records is automatically incremented to a unique long integer that cannot be changed.","pos":[15088,15197]},{"content":"Only supported for Microsoft Jet database tables.","pos":[15198,15247]},{"content":"dbUpdatableField","pos":[15254,15270]},{"content":"The field value can be changed.","pos":[15273,15304]},{"content":"dbDescending","pos":[15311,15323]},{"content":"The field is sorted in descending (Z – A or 100 – 0) order (applies only to a Field object in a Fields collection of an Index object).","pos":[15326,15460]},{"content":"If you omit this constant, the field is sorted in ascending (A – Z or 0 – 100) order (default).","pos":[15461,15556]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoFieldInfo<ept id=\"p1\">](../../mfc/reference/cdaofieldinfo-structure.md)</ept> structure.","pos":[15579,15670],"source":" A reference to a [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) structure."},{"content":"Remarks","pos":[15680,15687]},{"content":"A <bpt id=\"p1\">**</bpt>DAOField<ept id=\"p1\">**</ept> (OLE) object is created and appended to the Fields collection of the <bpt id=\"p2\">**</bpt>DAOTableDef<ept id=\"p2\">**</ept> (OLE) object.","pos":[15691,15804],"source":"A **DAOField** (OLE) object is created and appended to the Fields collection of the **DAOTableDef** (OLE) object."},{"content":"Besides its use for examining object properties, you can also use <ph id=\"ph1\">`CDaoFieldInfo`</ph> to construct an input parameter for creating new fields in a tabledef.","pos":[15805,15957],"source":" Besides its use for examining object properties, you can also use `CDaoFieldInfo` to construct an input parameter for creating new fields in a tabledef."},{"content":"The first version of <ph id=\"ph1\">`CreateField`</ph> is simpler to use, but if you want finer control, you can use the second version of <ph id=\"ph2\">`CreateField`</ph>, which takes a <ph id=\"ph3\">`CDaoFieldInfo`</ph> parameter.","pos":[15958,16132],"source":" The first version of `CreateField` is simpler to use, but if you want finer control, you can use the second version of `CreateField`, which takes a `CDaoFieldInfo` parameter."},{"pos":[16139,16305],"content":"If you use the version of <ph id=\"ph1\">`CreateField`</ph> that takes a <ph id=\"ph2\">`CDaoFieldInfo`</ph> parameter, you must carefully set each of the following members of the <ph id=\"ph3\">`CDaoFieldInfo`</ph> structure:","source":"If you use the version of `CreateField` that takes a `CDaoFieldInfo` parameter, you must carefully set each of the following members of the `CDaoFieldInfo` structure:"},{"content":"m_strName","pos":[16315,16324]},{"content":"m_lSize","pos":[16353,16360]},{"content":"m_lAttributes","pos":[16372,16385]},{"content":"m_bAllowZeroLength","pos":[16397,16415]},{"pos":[16424,16582],"content":"The remaining members of <ph id=\"ph1\">`CDaoFieldInfo`</ph> should be set to <bpt id=\"p1\">**</bpt>0<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>, or an empty string, as appropriate for the member, or a <ph id=\"ph2\">`CDaoException`</ph> may occur.","source":"The remaining members of `CDaoFieldInfo` should be set to **0**, **FALSE**, or an empty string, as appropriate for the member, or a `CDaoException` may occur."},{"content":"For related information, see the topic \"CreateField Method\" in DAO Help.","pos":[16589,16661]},{"pos":[16713,16738],"content":"CDaoTableDef::CreateIndex"},{"content":"Call this function to add an index to a table.","pos":[16742,16788]},{"content":"Parameters","pos":[16857,16867]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoIndexInfo<ept id=\"p1\">](../../mfc/reference/cdaoindexinfo-structure.md)</ept> structure.","pos":[16886,16977],"source":" A reference to a [CDaoIndexInfo](../../mfc/reference/cdaoindexinfo-structure.md) structure."},{"content":"Remarks","pos":[16987,16994]},{"content":"Indexes specify the order of records accessed from database tables and whether or not duplicate records are accepted.","pos":[16998,17115]},{"content":"Indexes also provide efficient access to data.","pos":[17116,17162]},{"content":"You do not have to create indexes for tables, but in large, unindexed tables, accessing a specific record or creating a recordset can take a long time.","pos":[17169,17320]},{"content":"On the other hand, creating too many indexes slows down update, append, and delete operations as all indexes are automatically updated.","pos":[17321,17456]},{"content":"Consider these factors as you decide which indexes to create.","pos":[17457,17518]},{"pos":[17525,17592],"content":"The following members of the <ph id=\"ph1\">`CDaoIndexInfo`</ph> structure must be set:","source":"The following members of the `CDaoIndexInfo` structure must be set:"},{"pos":[17600,17638],"content":"<bpt id=\"p1\">**</bpt>m_strName<ept id=\"p1\">**</ept> A name must be supplied.","source":"**m_strName** A name must be supplied."},{"pos":[17662,17720],"content":"Must point to an array of <ph id=\"ph1\">`CDaoIndexFieldInfo`</ph> structures.","source":" Must point to an array of `CDaoIndexFieldInfo` structures."},{"pos":[17740,17817],"content":"Must specify the number of fields in the array of <ph id=\"ph1\">`CDaoFieldInfo`</ph> structures.","source":" Must specify the number of fields in the array of `CDaoFieldInfo` structures."},{"content":"The remaining members will be ignored if set to <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[17824,17882],"source":"The remaining members will be ignored if set to **FALSE**."},{"content":"In addition, the <bpt id=\"p1\">**</bpt>m_lDistinctCount<ept id=\"p1\">**</ept> member is ignored during creation of the index.","pos":[17883,17968],"source":" In addition, the **m_lDistinctCount** member is ignored during creation of the index."},{"pos":[18020,18045],"content":"CDaoTableDef::DeleteField"},{"content":"Call this member function to remove a field and make it inaccessible.","pos":[18049,18118]},{"content":"Parameters","pos":[18212,18222]},{"content":"A pointer to a string expression that is the name of an existing field.","pos":[18240,18311]},{"content":"The index of the field in the table's zero-based Fields collection, for lookup by index.","pos":[18330,18418]},{"content":"Remarks","pos":[18428,18435]},{"pos":[18439,18593],"content":"You can use this member function on a new object that has not been appended to the database or when <bpt id=\"p1\">[</bpt>CanUpdate<ept id=\"p1\">](#cdaotabledef__canupdate)</ept> returns nonzero.","source":"You can use this member function on a new object that has not been appended to the database or when [CanUpdate](#cdaotabledef__canupdate) returns nonzero."},{"content":"For related information, see the topic \"Delete Method\" in DAO Help.","pos":[18600,18667]},{"pos":[18719,18744],"content":"CDaoTableDef::DeleteIndex"},{"content":"Call this member function to delete an index in an underlying table.","pos":[18748,18816]},{"content":"Parameters","pos":[18910,18920]},{"content":"A pointer to a string expression that is the name of an existing index.","pos":[18938,19009]},{"content":"The array index of the index object in the database's zero-based TableDefs collection, for lookup by index.","pos":[19028,19135]},{"content":"Remarks","pos":[19145,19152]},{"pos":[19156,19309],"content":"You can use this member function on a new object that hasn't been appended to the database or when <bpt id=\"p1\">[</bpt>CanUpdate<ept id=\"p1\">](#cdaotabledef__canupdate)</ept> returns nonzero.","source":"You can use this member function on a new object that hasn't been appended to the database or when [CanUpdate](#cdaotabledef__canupdate) returns nonzero."},{"content":"For related information, see the topic \"Delete Method\" in DAO Help.","pos":[19316,19383]},{"pos":[19437,19464],"content":"CDaoTableDef::GetAttributes"},{"pos":[19468,19630],"content":"For a <ph id=\"ph1\">`CDaoTableDef`</ph> object, the return value specifies characteristics of the table represented by the <ph id=\"ph2\">`CDaoTableDef`</ph> object and can be a sum of these constants:","source":"For a `CDaoTableDef` object, the return value specifies characteristics of the table represented by the `CDaoTableDef` object and can be a sum of these constants:"},{"content":"Return Value","pos":[19677,19689]},{"pos":[19693,19779],"content":"Returns a value that indicates one or more characteristics of a <ph id=\"ph1\">`CDaoTableDef`</ph> object.","source":"Returns a value that indicates one or more characteristics of a `CDaoTableDef` object."},{"content":"Remarks","pos":[19789,19796]},{"content":"Constant","pos":[19803,19811]},{"content":"Description","pos":[19812,19823]},{"content":"dbAttachExclusive","pos":[19867,19884]},{"content":"For databases that use the Microsoft Jet database engine, indicates the table is an attached table opened for exclusive use.","pos":[19887,20011]},{"content":"dbAttachSavePWD","pos":[20018,20033]},{"content":"For databases that use the Microsoft Jet database engine, indicates that the user ID and password for the attached table are saved with the connection information.","pos":[20036,20199]},{"content":"dbSystemObject","pos":[20206,20220]},{"content":"Indicates the table is a system table provided by the Microsoft Jet database engine.","pos":[20223,20307]},{"content":"dbHiddenObject","pos":[20314,20328]},{"content":"Indicates the table is a hidden table provided by the Microsoft Jet database engine.","pos":[20331,20415]},{"content":"dbAttachedTable","pos":[20422,20437]},{"content":"Indicates the table is an attached table from a non-ODBC database, such as a Paradox database.","pos":[20440,20534]},{"content":"dbAttachedODBC","pos":[20541,20555]},{"content":"Indicates the table is an attached table from an ODBC database, such as Microsoft SQL Server.","pos":[20558,20651]},{"content":"A system table is a table created by the Microsoft Jet database engine to contain various internal information.","pos":[20659,20770]},{"content":"A hidden table is a table created for temporary use by the Microsoft Jet database engine.","pos":[20777,20866]},{"content":"For related information, see the topic \"Attributes Property\" in DAO Help.","pos":[20873,20946]},{"pos":[20997,21021],"content":"CDaoTableDef::GetConnect"},{"content":"Call this member function to obtain the connection string for a data source.","pos":[21025,21101]},{"content":"Return Value","pos":[21148,21160]},{"pos":[21164,21235],"content":"A <ph id=\"ph1\">`CString`</ph> object containing the path and database type for the table.","source":"A `CString` object containing the path and database type for the table."},{"content":"Remarks","pos":[21245,21252]},{"pos":[21256,21424],"content":"For a <ph id=\"ph1\">`CDaoTableDef`</ph> object that represents an attached table, the <ph id=\"ph2\">`CString`</ph> object consists of one or two parts (a database type specifier and a path to the database).","source":"For a `CDaoTableDef` object that represents an attached table, the `CString` object consists of one or two parts (a database type specifier and a path to the database)."},{"content":"The path as shown in the table below is the full path for the directory containing the database files and must be preceded by the identifier \"DATABASE=\".","pos":[21431,21584]},{"content":"In some cases (as with Microsoft Jet and Microsoft Excel databases), a specific filename is included in the database path argument.","pos":[21585,21716]},{"pos":[21723,21874],"content":"The table in <bpt id=\"p1\">[</bpt>CDaoTableDef::SetConnect<ept id=\"p1\">](#cdaotabledef__setconnect)</ept> shows possible database types and their corresponding database specifiers and paths:","source":"The table in [CDaoTableDef::SetConnect](#cdaotabledef__setconnect) shows possible database types and their corresponding database specifiers and paths:"},{"content":"For Microsoft Jet database base tables, the specifier is a empty string (\"\").","pos":[21881,21958]},{"content":"If a password is required but not provided, the ODBC driver displays a login dialog box the first time a table is accessed and again if the connection is closed and reopened.","pos":[21965,22139]},{"content":"If an attached table has the <bpt id=\"p1\">**</bpt>dbAttachSavePWD<ept id=\"p1\">**</ept> attribute, the login prompt will not appear when the table is reopened.","pos":[22140,22260],"source":" If an attached table has the **dbAttachSavePWD** attribute, the login prompt will not appear when the table is reopened."},{"content":"For related information, see the topic \"Connect Property\" in DAO Help.","pos":[22267,22337]},{"pos":[22392,22420],"content":"CDaoTableDef::GetDateCreated"},{"pos":[22424,22533],"content":"Call this function to determine the date and time the table underlying the <ph id=\"ph1\">`CDaoTableDef`</ph> object was created.","source":"Call this function to determine the date and time the table underlying the `CDaoTableDef` object was created."},{"content":"Return Value","pos":[22589,22601]},{"pos":[22605,22708],"content":"A value containing the date and time of the creation of the table underlying the <ph id=\"ph1\">`CDaoTableDef`</ph> object.","source":"A value containing the date and time of the creation of the table underlying the `CDaoTableDef` object."},{"content":"Remarks","pos":[22718,22725]},{"content":"The date and time settings are derived from the computer on which the base table was created or last updated.","pos":[22729,22838]},{"content":"In a multiuser environment, users should get these settings directly from the file server to avoid discrepancies; that is, all clients should use a \"standard\" time source — perhaps from one server.","pos":[22839,23036]},{"content":"For related information, see the topic \"DateCreated, LastUpdated Properties\" in DAO Help.","pos":[23043,23132]},{"pos":[23191,23223],"content":"CDaoTableDef::GetDateLastUpdated"},{"pos":[23227,23343],"content":"Call this function to determine the date and time the table underlying the <bpt id=\"p1\">**</bpt>CDaoTableDef<ept id=\"p1\">**</ept> object was last updated.","source":"Call this function to determine the date and time the table underlying the **CDaoTableDef** object was last updated."},{"content":"Return Value","pos":[23403,23415]},{"pos":[23419,23525],"content":"A value that contains the date and time the table underlying the <bpt id=\"p1\">**</bpt>CDaoTableDef<ept id=\"p1\">**</ept> object was last updated.","source":"A value that contains the date and time the table underlying the **CDaoTableDef** object was last updated."},{"content":"Remarks","pos":[23535,23542]},{"content":"The date and time settings are derived from the computer on which the base table was created or last updated.","pos":[23546,23655]},{"content":"In a multiuser environment, users should get these settings directly from the file server to avoid discrepancies; that is, all clients should use a \"standard\" time source — perhaps from one server.","pos":[23656,23853]},{"content":"For related information, see the topic \"DateCreated, LastUpdated Properties\" in DAO Help.","pos":[23860,23949]},{"pos":[24003,24030],"content":"CDaoTableDef::GetFieldCount"},{"content":"Call this member function to retrieve the number of fields defined in the table.","pos":[24034,24114]},{"content":"Return Value","pos":[24162,24174]},{"content":"The number of fields in the table.","pos":[24178,24212]},{"content":"Remarks","pos":[24222,24229]},{"content":"If its value is 0, there are no objects in the collection.","pos":[24233,24291]},{"content":"For related information, see the topic \"Count Property\" in DAO Help.","pos":[24298,24366]},{"pos":[24419,24445],"content":"CDaoTableDef::GetFieldInfo"},{"content":"Call this member function to obtain various kinds of information about a field defined in the tabledef.","pos":[24449,24552]},{"content":"Parameters","pos":[24822,24832]},{"content":"The index of the field object in the table's zero-based Fields collection, for lookup by index.","pos":[24848,24943]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoFieldInfo<ept id=\"p1\">](../../mfc/reference/cdaofieldinfo-structure.md)</ept> structure.","pos":[24965,25056],"source":" A reference to a [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) structure."},{"content":"Options that specify which information about the field to retrieve.","pos":[25082,25149]},{"content":"The available options are listed here along with what they cause the function to return:","pos":[25150,25238]},{"content":"(Default) Name, Type, Size, Attributes.","pos":[25269,25308]},{"content":"Use this option for fastest performance.","pos":[25309,25349]},{"pos":[25382,25513],"content":"Primary information, plus: Ordinal Position, Required, Allow Zero Length, Collating Order, Foreign Name, Source Field, Source Table"},{"pos":[25540,25628],"content":"Primary and secondary information, plus: Validation Rule, Validation Text, Default Value"},{"pos":[25635,25788],"content":"`lpszName`  \nA pointer to the name of the field object, for lookup by name. The name is a string with up to 64 characters that uniquely names the field.","leadings":[""," "],"nodes":[{"content":"A pointer to the name of the field object, for lookup by name. The name is a string with up to 64 characters that uniquely names the field.","pos":[13,152],"nodes":[{"content":"A pointer to the name of the field object, for lookup by name.","pos":[0,62]},{"content":"The name is a string with up to 64 characters that uniquely names the field.","pos":[63,139]}]}]},{"content":"Remarks","pos":[25798,25805]},{"content":"One version of the function lets you look up a field by index.","pos":[25809,25871]},{"content":"The other version lets you look up a field by name.","pos":[25872,25923]},{"content":"For a description of the information returned, see the <bpt id=\"p1\">[</bpt>CDaoFieldInfo<ept id=\"p1\">](../../mfc/reference/cdaofieldinfo-structure.md)</ept> structure.","pos":[25930,26059],"source":"For a description of the information returned, see the [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) structure."},{"content":"This structure has members that correspond to the items of information listed above in the description of <ph id=\"ph1\">`dwInfoOptions`</ph>.","pos":[26060,26182],"source":" This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`."},{"content":"When you request information at one level, you get information for any prior levels as well.","pos":[26183,26275]},{"content":"For related information, see the topic \"Attributes Property\" in DAO Help.","pos":[26282,26355]},{"pos":[26409,26436],"content":"CDaoTableDef::GetIndexCount"},{"content":"Call this member function to obtain the number of indexes for a table.","pos":[26440,26510]},{"content":"Return Value","pos":[26558,26570]},{"content":"The number of indexes for the table.","pos":[26574,26610]},{"content":"Remarks","pos":[26620,26627]},{"content":"If its value is 0, there are no indexes in the collection.","pos":[26631,26689]},{"content":"For related information, see the topic \"Count Property\" in DAO Help.","pos":[26696,26764]},{"pos":[26817,26843],"content":"CDaoTableDef::GetIndexInfo"},{"content":"Call this member function to obtain various kinds of information about an index defined in the tabledef.","pos":[26847,26951]},{"content":"Parameters","pos":[27221,27231]},{"content":"The numeric index of the Index object in the table's zero-based Indexes collection, for lookup by its position in the collection.","pos":[27247,27376]},{"content":"A reference to a <bpt id=\"p1\">[</bpt>CDaoIndexInfo<ept id=\"p1\">](../../mfc/reference/cdaoindexinfo-structure.md)</ept> structure.","pos":[27398,27489],"source":" A reference to a [CDaoIndexInfo](../../mfc/reference/cdaoindexinfo-structure.md) structure."},{"content":"Options that specify which information about the index to retrieve.","pos":[27515,27582]},{"content":"The available options are listed here along with what they cause the function to return:","pos":[27583,27671]},{"content":"Name, Field Info, Fields.","pos":[27702,27727]},{"content":"Use this option for fastest performance.","pos":[27728,27768]},{"pos":[27801,27887],"content":"Primary information, plus: Primary, Unique, Clustered, Ignore Nulls, Required, Foreign"},{"pos":[27914,27969],"content":"Primary and secondary information, plus: Distinct Count"},{"pos":[27976,28052],"content":"`lpszName`  \nA pointer to the name of the index object, for lookup by name.","leadings":[""," "],"nodes":[{"content":"A pointer to the name of the index object, for lookup by name.","pos":[13,75]}]},{"content":"Remarks","pos":[28062,28069]},{"content":"One version of the function lets you look up an index by its position in the collection.","pos":[28073,28161]},{"content":"The other version lets you look up an index by name.","pos":[28162,28214]},{"content":"For a description of the information returned, see the <bpt id=\"p1\">[</bpt>CDaoIndexInfo<ept id=\"p1\">](../../mfc/reference/cdaoindexinfo-structure.md)</ept> structure.","pos":[28221,28350],"source":"For a description of the information returned, see the [CDaoIndexInfo](../../mfc/reference/cdaoindexinfo-structure.md) structure."},{"content":"This structure has members that correspond to the items of information listed above in the description of <ph id=\"ph1\">`dwInfoOptions`</ph>.","pos":[28351,28473],"source":" This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`."},{"content":"When you request information at one level, you get information for any prior levels as well.","pos":[28474,28566]},{"content":"For related information, see the topic \"Attributes Property\" in DAO Help.","pos":[28573,28646]},{"pos":[28694,28715],"content":"CDaoTableDef::GetName"},{"content":"Call this member function to obtain the user-defined name of the underlying table.","pos":[28719,28801]},{"content":"Return Value","pos":[28845,28857]},{"content":"A user-defined name for a table.","pos":[28861,28893]},{"content":"Remarks","pos":[28903,28910]},{"content":"This name starts with a letter and can contain a maximum of 64 characters.","pos":[28914,28988]},{"content":"It can include numbers and underscore characters but cannot include punctuation or spaces.","pos":[28989,29079]},{"content":"For related information, see the topic \"Name Property\" in DAO Help.","pos":[29086,29153]},{"pos":[29208,29236],"content":"CDaoTableDef::GetRecordCount"},{"pos":[29240,29326],"content":"Call this member function to find out how many records are in a <ph id=\"ph1\">`CDaoTableDef`</ph> object.","source":"Call this member function to find out how many records are in a `CDaoTableDef` object."},{"content":"Return Value","pos":[29374,29386]},{"content":"The number of records accessed in a tabledef object.","pos":[29390,29442]},{"content":"Remarks","pos":[29452,29459]},{"content":"Calling <ph id=\"ph1\">`GetRecordCount`</ph> for a table-type <ph id=\"ph2\">`CDaoTableDef`</ph> object reflects the approximate number of records in the table and is affected immediately as table records are added and deleted.","pos":[29463,29650],"source":"Calling `GetRecordCount` for a table-type `CDaoTableDef` object reflects the approximate number of records in the table and is affected immediately as table records are added and deleted."},{"content":"Rolled back transactions will appear as part of the record count until you call <bpt id=\"p1\">[</bpt>CDaoWorkSpace::CompactDatabase<ept id=\"p1\">](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__compactdatabase)</ept>.","pos":[29651,29839],"source":" Rolled back transactions will appear as part of the record count until you call [CDaoWorkSpace::CompactDatabase](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__compactdatabase)."},{"content":"A <ph id=\"ph1\">`CDaoTableDef`</ph> object with no records has a record count property setting of 0.","pos":[29840,29921],"source":" A `CDaoTableDef` object with no records has a record count property setting of 0."},{"content":"When working with attached tables or ODBC databases, <ph id=\"ph1\">`GetRecordCount`</ph> always returns –1.","pos":[29922,30010],"source":" When working with attached tables or ODBC databases, `GetRecordCount` always returns –1."},{"content":"For related information, see the topic \"RecordCount Property\" in DAO Help.","pos":[30017,30091]},{"pos":[30150,30182],"content":"CDaoTableDef::GetSourceTableName"},{"content":"Call this member function to retrieve the name of an attached table in a source database.","pos":[30186,30275]},{"content":"Return Value","pos":[30330,30342]},{"pos":[30346,30460],"content":"A <ph id=\"ph1\">`CString`</ph> object that specifies the source name of an attached table, or an empty string if a native data table.","source":"A `CString` object that specifies the source name of an attached table, or an empty string if a native data table."},{"content":"Remarks","pos":[30470,30477]},{"content":"An attached table is a table in another database linked to a Microsoft Jet database.","pos":[30481,30565]},{"content":"Data for attached tables remains in the external database, where it can be manipulated by other applications.","pos":[30566,30675]},{"content":"For related information, see the topic \"SourceTableName Property\" in DAO Help.","pos":[30682,30760]},{"pos":[30818,30849],"content":"CDaoTableDef::GetValidationRule"},{"content":"Call this member function to retrieve the validation rule for a tabledef.","pos":[30853,30926]},{"content":"Return Value","pos":[30980,30992]},{"pos":[30996,31089],"content":"A <bpt id=\"p1\">**</bpt>CString<ept id=\"p1\">**</ept> object that validates the data in a field as it is changed or added to a table.","source":"A **CString** object that validates the data in a field as it is changed or added to a table."},{"content":"Remarks","pos":[31099,31106]},{"content":"Validation rules are used in connection with update operations.","pos":[31110,31173]},{"content":"If a tabledef contains a validation rule, updates to that tabledef must match predetermined criteria before the data is changed.","pos":[31174,31302]},{"content":"If the change does not match the criteria, an exception containing the value of <bpt id=\"p1\">[</bpt>GetValidationText<ept id=\"p1\">](#cdaotabledef__getvalidationtext)</ept> is thrown.","pos":[31303,31447],"source":" If the change does not match the criteria, an exception containing the value of [GetValidationText](#cdaotabledef__getvalidationtext) is thrown."},{"content":"For a <ph id=\"ph1\">`CDaoTableDef`</ph> object, this <ph id=\"ph2\">`CString`</ph> is read-only for an attached table and read/write for a base table.","pos":[31448,31559],"source":" For a `CDaoTableDef` object, this `CString` is read-only for an attached table and read/write for a base table."},{"content":"For related information, see the topic \"ValidationRule Property\" in DAO Help.","pos":[31566,31643]},{"pos":[31701,31732],"content":"CDaoTableDef::GetValidationText"},{"content":"Call this function to retrieve the string to display when a user enters data that does not match the validation rule.","pos":[31736,31853]},{"content":"Return Value","pos":[31907,31919]},{"pos":[31923,32040],"content":"A <ph id=\"ph1\">`CString`</ph> object that specifies the text displayed if the user enters data that does not match the validation rule.","source":"A `CString` object that specifies the text displayed if the user enters data that does not match the validation rule."},{"content":"Remarks","pos":[32050,32057]},{"pos":[32061,32172],"content":"For a <ph id=\"ph1\">`CDaoTableDef`</ph> object, this <ph id=\"ph2\">`CString`</ph> is read-only for an attached table and read/write for a base table.","source":"For a `CDaoTableDef` object, this `CString` is read-only for an attached table and read/write for a base table."},{"content":"For related information, see the topic \"ValidationText Property\" in DAO Help.","pos":[32179,32256]},{"pos":[32303,32323],"content":"CDaoTableDef::IsOpen"},{"pos":[32327,32418],"content":"Call this member function to determine whether the <ph id=\"ph1\">`CDaoTableDef`</ph> object is currently open.","source":"Call this member function to determine whether the `CDaoTableDef` object is currently open."},{"content":"Return Value","pos":[32467,32479]},{"pos":[32483,32541],"content":"Nonzero if the <ph id=\"ph1\">`CDaoTableDef`</ph> object is open; otherwise 0.","source":"Nonzero if the `CDaoTableDef` object is open; otherwise 0."},{"content":"Remarks","pos":[32551,32558]},{"pos":[32610,32635],"content":"CDaoTableDef::m_pDatabase"},{"pos":[32639,32745],"content":"Contains a pointer to the <bpt id=\"p1\">[</bpt>CDaoDatabase<ept id=\"p1\">](../../mfc/reference/cdaodatabase-class.md)</ept> object for this table.","source":"Contains a pointer to the [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object for this table."},{"content":"Remarks","pos":[32755,32762]},{"pos":[32817,32845],"content":"CDaoTableDef::m_pDAOTableDef"},{"pos":[32849,32954],"content":"Contains a pointer to the OLE interface for the DAO tabledef object underlying the <ph id=\"ph1\">`CDaoTableDef`</ph> object.","source":"Contains a pointer to the OLE interface for the DAO tabledef object underlying the `CDaoTableDef` object."},{"content":"Remarks","pos":[32964,32971]},{"content":"Use this pointer if you need to access the DAO interface directly.","pos":[32975,33041]},{"pos":[33086,33104],"content":"CDaoTableDef::Open"},{"content":"Call this member function to open a tabledef previously saved in the database's TableDef's collection.","pos":[33108,33210]},{"content":"Parameters","pos":[33272,33282]},{"content":"A pointer to a string that specifies a table name.","pos":[33300,33350]},{"content":"Remarks","pos":[33360,33367]},{"pos":[33419,33444],"content":"CDaoTableDef::RefreshLink"},{"content":"Call this member function to update the connection information for an attached table.","pos":[33448,33533]},{"content":"Remarks","pos":[33578,33585]},{"content":"You change the connection information for an attached table by calling <bpt id=\"p1\">[</bpt>SetConnect<ept id=\"p1\">](#cdaotabledef__setconnect)</ept> on the corresponding <ph id=\"ph1\">`CDaoTableDef`</ph> object and then using the <ph id=\"ph2\">`RefreshLink`</ph> member function to update the information.","pos":[33589,33818],"source":"You change the connection information for an attached table by calling [SetConnect](#cdaotabledef__setconnect) on the corresponding `CDaoTableDef` object and then using the `RefreshLink` member function to update the information."},{"content":"When you call <ph id=\"ph1\">`RefreshLink`</ph>, the attached table's properties are not changed.","pos":[33819,33896],"source":" When you call `RefreshLink`, the attached table's properties are not changed."},{"pos":[33903,34076],"content":"To force the modified connect information to take effect, all open <bpt id=\"p1\">[</bpt>CDaoRecordset<ept id=\"p1\">](../../mfc/reference/cdaorecordset-class.md)</ept> objects based on this tabledef must be closed.","source":"To force the modified connect information to take effect, all open [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) objects based on this tabledef must be closed."},{"content":"For related information, see the topic \"RefreshLink Method\" in DAO Help.","pos":[34083,34155]},{"pos":[34209,34236],"content":"CDaoTableDef::SetAttributes"},{"pos":[34240,34323],"content":"Sets a value that indicates one or more characteristics of a <ph id=\"ph1\">`CDaoTableDef`</ph> object.","source":"Sets a value that indicates one or more characteristics of a `CDaoTableDef` object."},{"content":"Parameters","pos":[34386,34396]},{"content":"Characteristics of the table represented by the <ph id=\"ph1\">`CDaoTableDef`</ph> object and can be a sum of these constants:","pos":[34417,34523],"source":" Characteristics of the table represented by the `CDaoTableDef` object and can be a sum of these constants:"},{"content":"Constant","pos":[34530,34538]},{"content":"Description","pos":[34539,34550]},{"content":"dbAttachExclusive","pos":[34594,34611]},{"content":"For databases that use the Microsoft Jet database engine, indicates the table is an attached table opened for exclusive use.","pos":[34614,34738]},{"content":"dbAttachSavePWD","pos":[34745,34760]},{"content":"For databases that use the Microsoft Jet database engine, indicates that the user ID and password for the attached table are saved with the connection information.","pos":[34763,34926]},{"content":"dbSystemObject","pos":[34933,34947]},{"content":"Indicates the table is a system table provided by the Microsoft Jet database engine.","pos":[34950,35034]},{"content":"dbHiddenObject","pos":[35041,35055]},{"content":"Indicates the table is a hidden table provided by the Microsoft Jet database engine.","pos":[35058,35142]},{"content":"Remarks","pos":[35153,35160]},{"content":"When setting multiple attributes, you can combine them by summing the appropriate constants using the bitwise-OR operator.","pos":[35164,35286]},{"content":"Setting <bpt id=\"p1\">**</bpt>dbAttachExclusive<ept id=\"p1\">**</ept> on a nonattached table produces an exception.","pos":[35287,35362],"source":" Setting **dbAttachExclusive** on a nonattached table produces an exception."},{"content":"Combining the following values also produce an exception:","pos":[35363,35420]},{"content":"dbAttachExclusive &amp;#124; dbAttachedODBC","pos":[35430,35469],"source":"dbAttachExclusive &#124; dbAttachedODBC"},{"content":"dbAttachSavePWD &amp;#124; dbAttachedTable","pos":[35481,35519],"source":"dbAttachSavePWD &#124; dbAttachedTable"},{"content":"For related information, see the topic \"Attributes Property\" in DAO Help.","pos":[35528,35601]},{"pos":[35652,35676],"content":"CDaoTableDef::SetConnect"},{"pos":[35680,35845],"content":"For a <ph id=\"ph1\">`CDaoTableDef`</ph> object that represents an attached table, the string object consists of one or two parts (a database type specifier and a path to the database).","source":"For a `CDaoTableDef` object that represents an attached table, the string object consists of one or two parts (a database type specifier and a path to the database)."},{"content":"Parameters","pos":[35908,35918]},{"content":"A pointer to a string expression that specifies additional parameters to pass to ODBC or installable ISAM drivers.","pos":[35939,36053]},{"content":"Remarks","pos":[36063,36070]},{"content":"The path as shown in the table below is the full path for the directory containing the database files and must be preceded by the identifier \"DATABASE=\".","pos":[36074,36227]},{"content":"In some cases (as with Microsoft Jet and Microsoft Excel databases), a specific filename is included in the database path argument.","pos":[36228,36359]},{"pos":[36367,36556],"content":"[!NOTE]\n Do not include whitespace around the equal sign in path statements of the form \"DATABASE=drive:\\\\\\path\". This will result in an exception being thrown and the connection failing.","leadings":["","> "],"nodes":[{"content":" Do not include whitespace around the equal sign in path statements of the form \"DATABASE=drive:\\\\\\path\". This will result in an exception being thrown and the connection failing.","pos":[8,187],"nodes":[{"content":"Do not include whitespace around the equal sign in path statements of the form \"DATABASE=drive:<ph id=\"ph1\">\\\\</ph>\\path\".","pos":[1,105],"source":" Do not include whitespace around the equal sign in path statements of the form \"DATABASE=drive:\\\\\\path\"."},{"content":"This will result in an exception being thrown and the connection failing.","pos":[106,179]}]}]},{"content":"The following table shows possible database types and their corresponding database specifiers and paths:","pos":[36563,36667]},{"content":"Database type","pos":[36674,36687]},{"content":"Specifier","pos":[36688,36697]},{"content":"Path","pos":[36698,36702]},{"content":"Database using the Jet database engine","pos":[36758,36796]},{"pos":[36797,36813],"content":"\"[ <ph id=\"ph1\">`database`</ph>];\"","source":"\"[ `database`];\""},{"pos":[36814,36853],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept><ph id=\"ph3\">\\\\\\ </ph><bpt id=\"p2\">*</bpt>filename<ept id=\"p2\">*</ept>.MDB\"","source":"\" `drive`:\\\\\\ *path*\\\\\\ *filename*.MDB\""},{"content":"dBASE III","pos":[36858,36867]},{"content":"\"dBASE III;\"","pos":[36868,36880]},{"pos":[36881,36902],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept>\"","source":"\" `drive`:\\\\\\ *path*\""},{"content":"dBASE IV","pos":[36907,36915]},{"content":"\"dBASE IV;\"","pos":[36916,36927]},{"pos":[36928,36949],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept>\"","source":"\" `drive`:\\\\\\ *path*\""},{"content":"dBASE 5","pos":[36954,36961]},{"content":"\"dBASE 5.0;\"","pos":[36962,36974]},{"pos":[36975,36996],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept>\"","source":"\" `drive`:\\\\\\ *path*\""},{"content":"Paradox 3.x","pos":[37001,37012]},{"content":"\"Paradox 3.x;\"","pos":[37013,37027]},{"pos":[37028,37049],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept>\"","source":"\" `drive`:\\\\\\ *path*\""},{"content":"Paradox 4.x","pos":[37054,37065]},{"content":"\"Paradox 4.x;\"","pos":[37066,37080]},{"pos":[37081,37102],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept>\"","source":"\" `drive`:\\\\\\ *path*\""},{"content":"Paradox 5.x","pos":[37107,37118]},{"content":"\"Paradox 5.x;\"","pos":[37119,37133]},{"pos":[37134,37155],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept>\"","source":"\" `drive`:\\\\\\ *path*\""},{"content":"Excel 3.0","pos":[37160,37169]},{"content":"\"Excel 3.0;\"","pos":[37170,37182]},{"pos":[37183,37222],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept><ph id=\"ph3\">\\\\\\ </ph><bpt id=\"p2\">*</bpt>filename<ept id=\"p2\">*</ept>.XLS\"","source":"\" `drive`:\\\\\\ *path*\\\\\\ *filename*.XLS\""},{"content":"Excel 4.0","pos":[37227,37236]},{"content":"\"Excel 4.0;\"","pos":[37237,37249]},{"pos":[37250,37289],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept><ph id=\"ph3\">\\\\\\ </ph><bpt id=\"p2\">*</bpt>filename<ept id=\"p2\">*</ept>.XLS\"","source":"\" `drive`:\\\\\\ *path*\\\\\\ *filename*.XLS\""},{"content":"Excel 5.0 or Excel 95","pos":[37294,37315]},{"content":"\"Excel 5.0;\"","pos":[37316,37328]},{"pos":[37329,37368],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept><ph id=\"ph3\">\\\\\\ </ph><bpt id=\"p2\">*</bpt>filename<ept id=\"p2\">*</ept>.XLS\"","source":"\" `drive`:\\\\\\ *path*\\\\\\ *filename*.XLS\""},{"content":"Excel 97","pos":[37373,37381]},{"content":"\"Excel 8.0;\"","pos":[37382,37394]},{"pos":[37395,37432],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept><ph id=\"ph3\">\\ </ph><bpt id=\"p2\">*</bpt>filename<ept id=\"p2\">*</ept>.XLS\"","source":"\" `drive`:\\\\\\ *path*\\ *filename*.XLS\""},{"content":"HTML Import","pos":[37437,37448]},{"content":"\"HTML Import;\"","pos":[37449,37463]},{"pos":[37464,37497],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept><ph id=\"ph3\">\\ </ph><bpt id=\"p2\">*</bpt>filename<ept id=\"p2\">*</ept>\"","source":"\" `drive`:\\\\\\ *path*\\ *filename*\""},{"content":"HTML Export","pos":[37502,37513]},{"content":"\"HTML Export;\"","pos":[37514,37528]},{"pos":[37529,37550],"content":"\" <ph id=\"ph1\">`drive`</ph>:<ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p1\">*</bpt>path<ept id=\"p1\">*</ept>\"","source":"\" `drive`:\\\\\\ *path*\""},{"content":"Text","pos":[37555,37559]},{"content":"\"Text;\"","pos":[37560,37567]},{"content":"\"drive:<ph id=\"ph1\">\\\\</ph>\\path\"","pos":[37568,37583],"source":"\"drive:\\\\\\path\""},{"content":"ODBC","pos":[37588,37592]},{"content":"\"ODBC; DATABASE= <ph id=\"ph1\">`database`</ph>; UID= <bpt id=\"p1\">*</bpt>user<ept id=\"p1\">*</ept>;PWD= <bpt id=\"p2\">*</bpt>password<ept id=\"p2\">*</ept>; DSN= <bpt id=\"p3\">*</bpt>datasourcename;<ept id=\"p3\">*</ept> LOGINTIMEOUT= <bpt id=\"p4\">*</bpt>seconds;<ept id=\"p4\">*</ept>\" (This may not be a complete connection string for all servers; it is just an example.","pos":[37593,37785],"source":"\"ODBC; DATABASE= `database`; UID= *user*;PWD= *password*; DSN= *datasourcename;* LOGINTIMEOUT= *seconds;*\" (This may not be a complete connection string for all servers; it is just an example."},{"content":"It is very important not to have spaces between the parameters.)","pos":[37786,37850]},{"content":"None","pos":[37851,37855]},{"content":"Exchange","pos":[37860,37868]},{"content":"\"Exchange;","pos":[37869,37879]},{"content":"MAPILEVEL= <bpt id=\"p1\">*</bpt>folderpath<ept id=\"p1\">*</ept>;","pos":[37892,37916],"source":" MAPILEVEL= *folderpath*;"},{"content":"[TABLETYPE={ 0 &amp;#124; 1 };]","pos":[37929,37956],"source":" [TABLETYPE={ 0 &#124; 1 };]"},{"content":"[PROFILE= <bpt id=\"p1\">*</bpt>profile<ept id=\"p1\">*</ept>;]","pos":[37969,37990],"source":" [PROFILE= *profile*;]"},{"content":"[PWD= <bpt id=\"p1\">*</bpt>password<ept id=\"p1\">*</ept>;]","pos":[38003,38021],"source":" [PWD= *password*;]"},{"content":"[DATABASE= <ph id=\"ph1\">`database`</ph>;]\"","pos":[38034,38058],"source":" [DATABASE= `database`;]\""},{"pos":[38059,38097],"content":"<bpt id=\"p1\">*</bpt>\"drive<ept id=\"p1\">*</ept>:<ph id=\"ph1\">\\\\\\ </ph><bpt id=\"p2\">*</bpt>path<ept id=\"p2\">*</ept><ph id=\"ph2\">\\\\\\ </ph><bpt id=\"p3\">*</bpt>filename<ept id=\"p3\">*</ept>.MDB\"","source":"*\"drive*:\\\\\\ *path*\\\\\\ *filename*.MDB\""},{"pos":[38106,38162],"content":"[!NOTE]\n Btrieve is no longer supported as of DAO 3.5.","leadings":["","> "],"nodes":[{"content":"Btrieve is no longer supported as of DAO 3.5.","pos":[9,54]}]},{"content":"You must use a double backslash (<ph id=\"ph1\">\\\\\\\\</ph>) in the connection strings.","pos":[38169,38234],"source":"You must use a double backslash (\\\\\\\\) in the connection strings."},{"content":"If you have modified the properties of an existing connection using <ph id=\"ph1\">`SetConnect`</ph>, you must subsequently call <bpt id=\"p1\">[</bpt>RefreshLink<ept id=\"p1\">](#cdaotabledef__refreshlink)</ept>.","pos":[38235,38386],"source":" If you have modified the properties of an existing connection using `SetConnect`, you must subsequently call [RefreshLink](#cdaotabledef__refreshlink)."},{"content":"If you are initializing the connection properties using <ph id=\"ph1\">`SetConnect`</ph>, you need not call <ph id=\"ph2\">`RefreshLink`</ph>, but should you choose to do so, first append the tabledef.","pos":[38387,38548],"source":" If you are initializing the connection properties using `SetConnect`, you need not call `RefreshLink`, but should you choose to do so, first append the tabledef."},{"content":"If a password is required but not provided, the ODBC driver displays a login dialog box the first time a table is accessed and again if the connection is closed and reopened.","pos":[38555,38729]},{"content":"You can set the connection string for a <ph id=\"ph1\">`CDaoTableDef`</ph> object by providing a source argument to the <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> member function.","pos":[38736,38863],"source":"You can set the connection string for a `CDaoTableDef` object by providing a source argument to the **Create** member function."},{"content":"You can check the setting to determine the type, path, user ID, password, or ODBC data source of the database.","pos":[38864,38974]},{"content":"For more information, see the documentation for the specific driver.","pos":[38975,39043]},{"content":"For related information, see the topic \"Connect Property\" in DAO Help.","pos":[39050,39120]},{"pos":[39168,39189],"content":"CDaoTableDef::SetName"},{"content":"Call this member function to set a user-defined name for a table.","pos":[39193,39258]},{"content":"Parameters","pos":[39315,39325]},{"content":"A pointer to a string expression that specifies a name for a table.","pos":[39343,39410]},{"content":"Remarks","pos":[39420,39427]},{"content":"The name must start with a letter and can contain a maximum of 64 characters.","pos":[39431,39508]},{"content":"It can include numbers and underscore characters but cannot include punctuation or spaces.","pos":[39509,39599]},{"content":"For related information, see the topic \"Name Property\" in DAO Help.","pos":[39606,39673]},{"pos":[39732,39764],"content":"CDaoTableDef::SetSourceTableName"},{"pos":[39768,39958],"content":"Call this member function to specify the name of an attached table or the name of the base table on which the <ph id=\"ph1\">`CDaoTableDef`</ph> object is based, as it exists in the original source of the data.","source":"Call this member function to specify the name of an attached table or the name of the base table on which the `CDaoTableDef` object is based, as it exists in the original source of the data."},{"content":"Parameters","pos":[40034,40044]},{"content":"lpszSrcTableName","pos":[40049,40065]},{"content":"A pointer to a string expression that specifies a table name in the external database.","pos":[40070,40156]},{"content":"For a base table, the setting is an empty string (\"\").","pos":[40157,40211]},{"content":"Remarks","pos":[40221,40228]},{"content":"You must then call <bpt id=\"p1\">[</bpt>RefreshLink<ept id=\"p1\">](#cdaotabledef__refreshlink)</ept>.","pos":[40232,40293],"source":"You must then call [RefreshLink](#cdaotabledef__refreshlink)."},{"content":"This property setting is empty for a base table and read/write for an attached table or an object not appended to a collection.","pos":[40294,40421]},{"content":"For related information, see the topic \"SourceTableName Property\" in DAO Help.","pos":[40428,40506]},{"pos":[40564,40595],"content":"CDaoTableDef::SetValidationRule"},{"content":"Call this member function to set a validation rule for a tabledef.","pos":[40599,40665]},{"content":"Parameters","pos":[40742,40752]},{"content":"lpszValidationRule","pos":[40757,40775]},{"content":"A pointer to a string expression that validates an operation.","pos":[40780,40841]},{"content":"Remarks","pos":[40851,40858]},{"content":"Validation rules are used in connection with update operations.","pos":[40862,40925]},{"content":"If a tabledef contains a validation rule, updates to that tabledef must match predetermined criteria before the data is changed.","pos":[40926,41054]},{"content":"If the change does not match the criteria, an exception containing the text of <bpt id=\"p1\">[</bpt>GetValidationText<ept id=\"p1\">](#cdaotabledef__getvalidationtext)</ept> is displayed.","pos":[41055,41201],"source":" If the change does not match the criteria, an exception containing the text of [GetValidationText](#cdaotabledef__getvalidationtext) is displayed."},{"content":"Validation is supported only for databases that use the Microsoft Jet database engine.","pos":[41208,41294]},{"content":"The expression cannot refer to user-defined functions, domain aggregate functions, SQL aggregate functions, or queries.","pos":[41295,41414]},{"content":"A validation rule for a <ph id=\"ph1\">`CDaoTableDef`</ph> object can refer to multiple fields in that object.","pos":[41415,41505],"source":" A validation rule for a `CDaoTableDef` object can refer to multiple fields in that object."},{"pos":[41512,41605],"content":"For example, for fields named <ph id=\"ph1\">`hire_date`</ph> and <ph id=\"ph2\">`termination_date`</ph>, a validation rule might be:","source":"For example, for fields named `hire_date` and `termination_date`, a validation rule might be:"},{"pos":[41623,41641],"content":"NVC_MFCDatabase#34"},{"content":"For related information, see the topic \"ValidationRule Property\" in DAO Help.","pos":[41702,41779]},{"pos":[41837,41868],"content":"CDaoTableDef::SetValidationText"},{"pos":[41872,42050],"content":"Call this member function to set the exception text of a validation rule for a <ph id=\"ph1\">`CDaoTableDef`</ph> object with an underlying base table supported by the Microsoft Jet database engine.","source":"Call this member function to set the exception text of a validation rule for a `CDaoTableDef` object with an underlying base table supported by the Microsoft Jet database engine."},{"content":"Parameters","pos":[42127,42137]},{"content":"lpszValidationText","pos":[42142,42160]},{"content":"A pointer to a string expression that specifies the text displayed if entered data is invalid.","pos":[42165,42259]},{"content":"Remarks","pos":[42269,42276]},{"content":"You cannot set the validation text of an attached table.","pos":[42280,42336]},{"content":"For related information, see the topic \"ValidationText Property\" in DAO Help.","pos":[42343,42420]},{"content":"See Also","pos":[42429,42437]},{"content":"CObject Class","pos":[42442,42455]},{"content":"Hierarchy Chart","pos":[42500,42515]},{"content":"CDaoDatabase Class","pos":[42552,42570]},{"content":"CDaoRecordset Class","pos":[42620,42639]}],"content":"---\ntitle: \"CDaoTableDef Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CDaoTableDef\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"database classes [C++], DAO\"\n  - \"tabledefs [C++]\"\n  - \"CDaoTableDef class\"\n  - \"database tables [C++], attached table definition\"\n  - \"database tables [C++], base table definition\"\nms.assetid: 7c5d2254-8475-43c4-8a6c-2d32ead194c9\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDaoTableDef Class\nRepresents the stored definition of a base table or an attached table.  \n  \n## Syntax  \n  \n```  \nclass CDaoTableDef : public CObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoTableDef::CDaoTableDef](#cdaotabledef__cdaotabledef)|Constructs a **CDaoTableDef** object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoTableDef::Append](#cdaotabledef__append)|Adds a new table to the database.|  \n|[CDaoTableDef::CanUpdate](#cdaotabledef__canupdate)|Returns nonzero if the table can be updated (you can modify the definition of fields or the table properties).|  \n|[CDaoTableDef::Close](#cdaotabledef__close)|Closes an open tabledef.|  \n|[CDaoTableDef::Create](#cdaotabledef__create)|Creates a table which can be added to the database using [Append](#cdaotabledef__append).|  \n|[CDaoTableDef::CreateField](#cdaotabledef__createfield)|Called to create a field for a table.|  \n|[CDaoTableDef::CreateIndex](#cdaotabledef__createindex)|Called to create an index for a table.|  \n|[CDaoTableDef::DeleteField](#cdaotabledef__deletefield)|Called to delete a field from a table.|  \n|[CDaoTableDef::DeleteIndex](#cdaotabledef__deleteindex)|Called to delete an index from a table.|  \n|[CDaoTableDef::GetAttributes](#cdaotabledef__getattributes)|Returns a value that indicates one or more characteristics of a `CDaoTableDef` object.|  \n|[CDaoTableDef::GetConnect](#cdaotabledef__getconnect)|Returns a value that provides information about the source of a table.|  \n|[CDaoTableDef::GetDateCreated](#cdaotabledef__getdatecreated)|Returns the date and time the base table underlying a `CDaoTableDef` object was created.|  \n|[CDaoTableDef::GetDateLastUpdated](#cdaotabledef__getdatelastupdated)|Returns the date and time of the most recent change made to the design of the base table.|  \n|[CDaoTableDef::GetFieldCount](#cdaotabledef__getfieldcount)|Returns a value that represents the number of fields in the table.|  \n|[CDaoTableDef::GetFieldInfo](#cdaotabledef__getfieldinfo)|Returns specific kinds of information about the fields in the table.|  \n|[CDaoTableDef::GetIndexCount](#cdaotabledef__getindexcount)|Returns the number of indexes for the table.|  \n|[CDaoTableDef::GetIndexInfo](#cdaotabledef__getindexinfo)|Returns specific kinds of information about the indexes for the table.|  \n|[CDaoTableDef::GetName](#cdaotabledef__getname)|Returns the user-defined name of the table.|  \n|[CDaoTableDef::GetRecordCount](#cdaotabledef__getrecordcount)|Returns the number of records in the table.|  \n|[CDaoTableDef::GetSourceTableName](#cdaotabledef__getsourcetablename)|Returns a value that specifies the name of the attached table in the source database.|  \n|[CDaoTableDef::GetValidationRule](#cdaotabledef__getvalidationrule)|Returns a value that validates the data in a field as it is changed or added to a table.|  \n|[CDaoTableDef::GetValidationText](#cdaotabledef__getvalidationtext)|Returns a value that specifies the text of the message that your application displays if the value of a Field object does not satisfy the specified validation rule.|  \n|[CDaoTableDef::IsOpen](#cdaotabledef__isopen)|Returns nonzero if the table is open.|  \n|[CDaoTableDef::Open](#cdaotabledef__open)|Opens an existing tabledef stored in the database's TableDef's collection.|  \n|[CDaoTableDef::RefreshLink](#cdaotabledef__refreshlink)|Updates the connection information for an attached table.|  \n|[CDaoTableDef::SetAttributes](#cdaotabledef__setattributes)|Sets a value that indicates one or more characteristics of a `CDaoTableDef` object.|  \n|[CDaoTableDef::SetConnect](#cdaotabledef__setconnect)|Sets a value that provides information about the source of a table.|  \n|[CDaoTableDef::SetName](#cdaotabledef__setname)|Sets the name of the table.|  \n|[CDaoTableDef::SetSourceTableName](#cdaotabledef__setsourcetablename)|Sets a value that specifies the name of an attached table in the source database.|  \n|[CDaoTableDef::SetValidationRule](#cdaotabledef__setvalidationrule)|Sets a value that validates the data in a field as it is changed or added to a table.|  \n|[CDaoTableDef::SetValidationText](#cdaotabledef__setvalidationtext)|Sets a value that specifies the text of the message that your application displays if the value of a Field object does not satisfy the specified validation rule.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CDaoTableDef::m_pDAOTableDef](#cdaotabledef__m_pdaotabledef)|A pointer to the DAO interface underlying the tabledef object.|  \n|[CDaoTableDef::m_pDatabase](#cdaotabledef__m_pdatabase)|Source database for this table.|  \n  \n## Remarks  \n Each DAO database object maintains a collection, called TableDefs, that contains all saved DAO tabledef objects.  \n  \n You manipulate a table definition using a `CDaoTableDef` object. For example, you can:  \n  \n-   Examine the field and index structure of any local, attached, or external table in a database.  \n  \n-   Call the `SetConnect` and `SetSourceTableName` member functions for attached tables, and use the `RefreshLink` member function to update connections to attached tables.  \n  \n-   Call the `CanUpdate` member function to determine if you can edit field definitions in the table.  \n  \n-   Get or set validation conditions using the `GetValidationRule` and `SetValidationRule`, and the `GetValidationText` and `SetValidationText` member functions.  \n  \n-   Use the **Open** member function to create a table-, dynaset-, or snapshot-type `CDaoRecordset` object.  \n  \n    > [!NOTE]\n    >  The DAO database classes are distinct from the MFC database classes based on Open Database Connectivity (ODBC). All DAO database class names have the \"CDao\" prefix. You can still access ODBC data sources with the DAO classes; the DAO classes generally offer superior capabilities because they are specific to the Microsoft Jet database engine.  \n  \n### To use tabledef objects either to work with an existing table or to create a new table  \n  \n1.  In all cases, first construct a `CDaoTableDef` object, supplying a pointer to a [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object to which the table belongs.  \n  \n2.  Then do the following, depending on what you want:  \n  \n    -   To use an existing saved table, call the tabledef object's [Open](#cdaotabledef__open) member function, supplying the name of the saved table.  \n  \n    -   To create a new table, call the tabledef object's [Create](#cdaotabledef__create) member function, supplying the name of the table. Call [CreateField](#cdaotabledef__createfield) and [CreateIndex](#cdaotabledef__createindex) to add fields and indexes to the table.  \n  \n    -   Call [Append](#cdaotabledef__append) to save the table by appending it to the database's TableDefs collection. **Create** puts the tabledef into an open state, so after calling **Create** you do not call **Open**.  \n  \n        > [!TIP]\n        >  The easiest way to create saved tables is to create them and store them in your database using Microsoft Access. Then you can open and use them in your MFC code.  \n  \n To use the tabledef object you have opened or created, create and open a `CDaoRecordset` object, specifying the name of the tabledef with a **dbOpenTable** value in the `nOpenType` parameter.  \n  \n To use a tabledef object to create a `CDaoRecordset` object, you typically create or open a tabledef as described above, then construct a recordset object, passing a pointer to your tabledef object when you call [CDaoRecordset::Open](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__open). The tabledef you pass must be in an open state. For more information, see class [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md).  \n  \n When you finish using a tabledef object, call its [Close](../../mfc/reference/cdaorecordset-class.md#cdaorecordset__close) member function; then destroy the tabledef object.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n `CDaoTableDef`  \n  \n## Requirements  \n **Header:** afxdao.h  \n  \n##  <a name=\"cdaotabledef__append\"></a>  CDaoTableDef::Append  \n Call this member function after you call [Create](#cdaotabledef__create) to create a new tabledef object to save the tabledef in the database.  \n  \n```  \nvirtual void Append();\n```  \n  \n### Remarks  \n The function appends the object to the database's TableDefs collection. You can use the tabledef as a temporary object while defining it by not appending it, but if you want to save and use it, you must call **Append**.  \n  \n> [!NOTE]\n>  If you attempt to append an unnamed tabledef (containing a null or empty string), MFC throws an exception.  \n  \n For related information, see the topic \"Append Method\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__canupdate\"></a>  CDaoTableDef::CanUpdate  \n Call this member function to determine whether the definition of the table underlying a `CDaoTableDef` object can be changed.  \n  \n```  \nBOOL CanUpdate();\n```  \n  \n### Return Value  \n Nonzero if the table structure (schema) can be modified (add or delete fields and indexes), otherwise 0.  \n  \n### Remarks  \n By default, a newly created table underlying a `CDaoTableDef` object can be updated, and an attached table underlying a `CDaoTableDef` object cannot be updated. A `CDaoTableDef` object may be updatable, even if the resulting recordset is not updatable.  \n  \n For related information, see the topic \"Updatable Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__cdaotabledef\"></a>  CDaoTableDef::CDaoTableDef  \n Constructs a **CDaoTableDef** object.  \n  \n```  \nCDaoTableDef(CDaoDatabase* pDatabase);\n```  \n  \n### Parameters  \n `pDatabase`  \n A pointer to a [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object.  \n  \n### Remarks  \n After constructing the object, you must call the [Create](#cdaotabledef__create) or [Open](#cdaotabledef__open) member function. When you finish with the object, you must call its [Close](#cdaotabledef__close) member function and destroy the `CDaoTableDef` object.  \n  \n##  <a name=\"cdaotabledef__close\"></a>  CDaoTableDef::Close  \n Call this member function to close and release the tabledef object.  \n  \n```  \nvirtual void Close();\n```  \n  \n### Remarks  \n Usually after calling **Close**, you delete the tabledef object if it was allocated with **new**.  \n  \n You can call [Open](#cdaotabledef__open) again after calling **Close**. This lets you reuse the tabledef object.  \n  \n For related information, see the topic \"Close Method\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__create\"></a>  CDaoTableDef::Create  \n Call this member function to create a new saved table.  \n  \n```  \nvirtual void Create(\n    LPCTSTR lpszName,  \n    long lAttributes = 0,  \n    LPCTSTR lpszSrcTable = NULL,  \n    LPCTSTR lpszConnect = NULL);\n```  \n  \n### Parameters  \n `lpszName`  \n A pointer to a string containing the name of the table.  \n  \n `lAttributes`  \n A value corresponding to characteristics of the table represented by the tabledef object. You can use the bitwise-OR to combine any of the following constants:  \n  \n|Constant|Description|  \n|--------------|-----------------|  \n|**dbAttachExclusive**|For databases that use the Microsoft Jet database engine, indicates the table is an attached table opened for exclusive use.|  \n|**dbAttachSavePWD**|For databases that use the Microsoft Jet database engine, indicates that the user ID and password for the attached table are saved with the connection information.|  \n|**dbSystemObject**|Indicates the table is a system table provided by the Microsoft Jet database engine.|  \n|**dbHiddenObject**|Indicates the table is a hidden table provided by the Microsoft Jet database engine.|  \n  \n *lpszSrcTable*  \n A pointer to a string containing the source table name. By default this value is initialized as **NULL**.  \n  \n `lpszConnect`  \n A pointer to a string containing the default connection string. By default this value is initialized as **NULL**.  \n  \n### Remarks  \n Once you have named the tabledef, you can then call [Append](#cdaotabledef__append) to save the tabledef in the database's TableDefs collection. After calling **Append**, the tabledef is in an open state, and you can use it to create a [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) object.  \n  \n For related information, see the topic \"CreateTableDef Method\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__createfield\"></a>  CDaoTableDef::CreateField  \n Call this member function to add a field to the table.  \n  \n```  \nvoid CreateField(\n    LPCTSTR lpszName,  \n    short nType,  \n    long lSize,  \n    long lAttributes = 0);\n\n \nvoid CreateField(\n    CDaoFieldInfo& fieldinfo);\n```  \n  \n### Parameters  \n `lpszName`  \n A pointer to a string expression specifying the name of this field.  \n  \n `nType`  \n A value indicating the data type of the field. The setting can be one of these values:  \n  \n|Type|Size (bytes)|Description|  \n|----------|--------------------|-----------------|  \n|**dbBoolean**|1 byte|BOOL|  \n|**dbByte**|1|BYTE|  \n|**dbInteger**|2|int|  \n|**dbLong**|4|long|  \n|**dbCurrency**|8|Currency ( [COleCurrency](../../mfc/reference/colecurrency-class.md))|  \n|**dbSingle**|4|float|  \n|**dbDouble**|8|double|  \n|**dbDate**|8|Date/Time ( [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md))|  \n|**dbText**|1 – 255|Text ( [CString](../../atl-mfc-shared/reference/cstringt-class.md))|  \n|**dbLongBinary**|0|Long Binary (OLE Object), [CLongBinary](../../mfc/reference/clongbinary-class.md) or [CByteArray](../../mfc/reference/cbytearray-class.md)|  \n|**dbMemo**|0|Memo ( [CString](../../atl-mfc-shared/reference/cstringt-class.md))|  \n  \n `lSize`  \n A value that indicates the maximum size, in bytes, of a field that contains text, or the fixed size of a field that contains text or numeric values. The `lSize` parameter is ignored for all but text fields.  \n  \n `lAttributes`  \n A value corresponding to characteristics of the field and that can be combined using a bitwise-OR.  \n  \n|Constant|Description|  \n|--------------|-----------------|  \n|**dbFixedField**|The field size is fixed (default for Numeric fields).|  \n|**dbVariableField**|The field size is variable (Text fields only).|  \n|**dbAutoIncrField**|The field value for new records is automatically incremented to a unique long integer that cannot be changed. Only supported for Microsoft Jet database tables.|  \n|**dbUpdatableField**|The field value can be changed.|  \n|**dbDescending**|The field is sorted in descending (Z – A or 100 – 0) order (applies only to a Field object in a Fields collection of an Index object). If you omit this constant, the field is sorted in ascending (A – Z or 0 – 100) order (default).|  \n  \n `fieldinfo`  \n A reference to a [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) structure.  \n  \n### Remarks  \n A **DAOField** (OLE) object is created and appended to the Fields collection of the **DAOTableDef** (OLE) object. Besides its use for examining object properties, you can also use `CDaoFieldInfo` to construct an input parameter for creating new fields in a tabledef. The first version of `CreateField` is simpler to use, but if you want finer control, you can use the second version of `CreateField`, which takes a `CDaoFieldInfo` parameter.  \n  \n If you use the version of `CreateField` that takes a `CDaoFieldInfo` parameter, you must carefully set each of the following members of the `CDaoFieldInfo` structure:  \n  \n- **m_strName**  \n  \n- `m_nType`  \n  \n- **m_lSize**  \n  \n- **m_lAttributes**  \n  \n- **m_bAllowZeroLength**  \n  \n The remaining members of `CDaoFieldInfo` should be set to **0**, **FALSE**, or an empty string, as appropriate for the member, or a `CDaoException` may occur.  \n  \n For related information, see the topic \"CreateField Method\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__createindex\"></a>  CDaoTableDef::CreateIndex  \n Call this function to add an index to a table.  \n  \n```  \nvoid CreateIndex(CDaoIndexInfo& indexinfo);\n```  \n  \n### Parameters  \n `indexinfo`  \n A reference to a [CDaoIndexInfo](../../mfc/reference/cdaoindexinfo-structure.md) structure.  \n  \n### Remarks  \n Indexes specify the order of records accessed from database tables and whether or not duplicate records are accepted. Indexes also provide efficient access to data.  \n  \n You do not have to create indexes for tables, but in large, unindexed tables, accessing a specific record or creating a recordset can take a long time. On the other hand, creating too many indexes slows down update, append, and delete operations as all indexes are automatically updated. Consider these factors as you decide which indexes to create.  \n  \n The following members of the `CDaoIndexInfo` structure must be set:  \n  \n- **m_strName** A name must be supplied.  \n  \n- `m_pFieldInfos` Must point to an array of `CDaoIndexFieldInfo` structures.  \n  \n- `m_nFields` Must specify the number of fields in the array of `CDaoFieldInfo` structures.  \n  \n The remaining members will be ignored if set to **FALSE**. In addition, the **m_lDistinctCount** member is ignored during creation of the index.  \n  \n##  <a name=\"cdaotabledef__deletefield\"></a>  CDaoTableDef::DeleteField  \n Call this member function to remove a field and make it inaccessible.  \n  \n```  \nvoid DeleteField(LPCTSTR lpszName);\n\n \nvoid DeleteField(int nIndex);\n```  \n  \n### Parameters  \n `lpszName`  \n A pointer to a string expression that is the name of an existing field.  \n  \n `nIndex`  \n The index of the field in the table's zero-based Fields collection, for lookup by index.  \n  \n### Remarks  \n You can use this member function on a new object that has not been appended to the database or when [CanUpdate](#cdaotabledef__canupdate) returns nonzero.  \n  \n For related information, see the topic \"Delete Method\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__deleteindex\"></a>  CDaoTableDef::DeleteIndex  \n Call this member function to delete an index in an underlying table.  \n  \n```  \nvoid DeleteIndex(LPCTSTR lpszName);\n\n \nvoid DeleteIndex(int nIndex);\n```  \n  \n### Parameters  \n `lpszName`  \n A pointer to a string expression that is the name of an existing index.  \n  \n `nIndex`  \n The array index of the index object in the database's zero-based TableDefs collection, for lookup by index.  \n  \n### Remarks  \n You can use this member function on a new object that hasn't been appended to the database or when [CanUpdate](#cdaotabledef__canupdate) returns nonzero.  \n  \n For related information, see the topic \"Delete Method\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getattributes\"></a>  CDaoTableDef::GetAttributes  \n For a `CDaoTableDef` object, the return value specifies characteristics of the table represented by the `CDaoTableDef` object and can be a sum of these constants:  \n  \n```  \nlong GetAttributes();\n```  \n  \n### Return Value  \n Returns a value that indicates one or more characteristics of a `CDaoTableDef` object.  \n  \n### Remarks  \n  \n|Constant|Description|  \n|--------------|-----------------|  \n|**dbAttachExclusive**|For databases that use the Microsoft Jet database engine, indicates the table is an attached table opened for exclusive use.|  \n|**dbAttachSavePWD**|For databases that use the Microsoft Jet database engine, indicates that the user ID and password for the attached table are saved with the connection information.|  \n|**dbSystemObject**|Indicates the table is a system table provided by the Microsoft Jet database engine.|  \n|**dbHiddenObject**|Indicates the table is a hidden table provided by the Microsoft Jet database engine.|  \n|**dbAttachedTable**|Indicates the table is an attached table from a non-ODBC database, such as a Paradox database.|  \n|**dbAttachedODBC**|Indicates the table is an attached table from an ODBC database, such as Microsoft SQL Server.|  \n  \n A system table is a table created by the Microsoft Jet database engine to contain various internal information.  \n  \n A hidden table is a table created for temporary use by the Microsoft Jet database engine.  \n  \n For related information, see the topic \"Attributes Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getconnect\"></a>  CDaoTableDef::GetConnect  \n Call this member function to obtain the connection string for a data source.  \n  \n```  \nCString GetConnect();\n```  \n  \n### Return Value  \n A `CString` object containing the path and database type for the table.  \n  \n### Remarks  \n For a `CDaoTableDef` object that represents an attached table, the `CString` object consists of one or two parts (a database type specifier and a path to the database).  \n  \n The path as shown in the table below is the full path for the directory containing the database files and must be preceded by the identifier \"DATABASE=\". In some cases (as with Microsoft Jet and Microsoft Excel databases), a specific filename is included in the database path argument.  \n  \n The table in [CDaoTableDef::SetConnect](#cdaotabledef__setconnect) shows possible database types and their corresponding database specifiers and paths:  \n  \n For Microsoft Jet database base tables, the specifier is a empty string (\"\").  \n  \n If a password is required but not provided, the ODBC driver displays a login dialog box the first time a table is accessed and again if the connection is closed and reopened. If an attached table has the **dbAttachSavePWD** attribute, the login prompt will not appear when the table is reopened.  \n  \n For related information, see the topic \"Connect Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getdatecreated\"></a>  CDaoTableDef::GetDateCreated  \n Call this function to determine the date and time the table underlying the `CDaoTableDef` object was created.  \n  \n```  \nCOleDateTime GetDateCreated();\n```  \n  \n### Return Value  \n A value containing the date and time of the creation of the table underlying the `CDaoTableDef` object.  \n  \n### Remarks  \n The date and time settings are derived from the computer on which the base table was created or last updated. In a multiuser environment, users should get these settings directly from the file server to avoid discrepancies; that is, all clients should use a \"standard\" time source — perhaps from one server.  \n  \n For related information, see the topic \"DateCreated, LastUpdated Properties\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getdatelastupdated\"></a>  CDaoTableDef::GetDateLastUpdated  \n Call this function to determine the date and time the table underlying the **CDaoTableDef** object was last updated.  \n  \n```  \nCOleDateTime GetDateLastUpdated();\n```  \n  \n### Return Value  \n A value that contains the date and time the table underlying the **CDaoTableDef** object was last updated.  \n  \n### Remarks  \n The date and time settings are derived from the computer on which the base table was created or last updated. In a multiuser environment, users should get these settings directly from the file server to avoid discrepancies; that is, all clients should use a \"standard\" time source — perhaps from one server.  \n  \n For related information, see the topic \"DateCreated, LastUpdated Properties\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getfieldcount\"></a>  CDaoTableDef::GetFieldCount  \n Call this member function to retrieve the number of fields defined in the table.  \n  \n```  \nshort GetFieldCount();\n```  \n  \n### Return Value  \n The number of fields in the table.  \n  \n### Remarks  \n If its value is 0, there are no objects in the collection.  \n  \n For related information, see the topic \"Count Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getfieldinfo\"></a>  CDaoTableDef::GetFieldInfo  \n Call this member function to obtain various kinds of information about a field defined in the tabledef.  \n  \n```  \nvoid GetFieldInfo(\n    int nIndex,  \n    CDaoFieldInfo& fieldinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n\n \nvoid GetFieldInfo(\n    LPCTSTR lpszName,  \n    CDaoFieldInfo& fieldinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n```  \n  \n### Parameters  \n `nIndex`  \n The index of the field object in the table's zero-based Fields collection, for lookup by index.  \n  \n `fieldinfo`  \n A reference to a [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) structure.  \n  \n `dwInfoOptions`  \n Options that specify which information about the field to retrieve. The available options are listed here along with what they cause the function to return:  \n  \n- `AFX_DAO_PRIMARY_INFO` (Default) Name, Type, Size, Attributes. Use this option for fastest performance.  \n  \n- `AFX_DAO_SECONDARY_INFO` Primary information, plus: Ordinal Position, Required, Allow Zero Length, Collating Order, Foreign Name, Source Field, Source Table  \n  \n- `AFX_DAO_ALL_INFO` Primary and secondary information, plus: Validation Rule, Validation Text, Default Value  \n  \n `lpszName`  \n A pointer to the name of the field object, for lookup by name. The name is a string with up to 64 characters that uniquely names the field.  \n  \n### Remarks  \n One version of the function lets you look up a field by index. The other version lets you look up a field by name.  \n  \n For a description of the information returned, see the [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) structure. This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`. When you request information at one level, you get information for any prior levels as well.  \n  \n For related information, see the topic \"Attributes Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getindexcount\"></a>  CDaoTableDef::GetIndexCount  \n Call this member function to obtain the number of indexes for a table.  \n  \n```  \nshort GetIndexCount();\n```  \n  \n### Return Value  \n The number of indexes for the table.  \n  \n### Remarks  \n If its value is 0, there are no indexes in the collection.  \n  \n For related information, see the topic \"Count Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getindexinfo\"></a>  CDaoTableDef::GetIndexInfo  \n Call this member function to obtain various kinds of information about an index defined in the tabledef.  \n  \n```  \nvoid GetIndexInfo(\n    int nIndex,  \n    CDaoIndexInfo& indexinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n\n \nvoid GetIndexInfo(\n    LPCTSTR lpszName,  \n    CDaoIndexInfo& indexinfo,  \n    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);\n```  \n  \n### Parameters  \n `nIndex`  \n The numeric index of the Index object in the table's zero-based Indexes collection, for lookup by its position in the collection.  \n  \n `indexinfo`  \n A reference to a [CDaoIndexInfo](../../mfc/reference/cdaoindexinfo-structure.md) structure.  \n  \n `dwInfoOptions`  \n Options that specify which information about the index to retrieve. The available options are listed here along with what they cause the function to return:  \n  \n- `AFX_DAO_PRIMARY_INFO` Name, Field Info, Fields. Use this option for fastest performance.  \n  \n- `AFX_DAO_SECONDARY_INFO` Primary information, plus: Primary, Unique, Clustered, Ignore Nulls, Required, Foreign  \n  \n- `AFX_DAO_ALL_INFO` Primary and secondary information, plus: Distinct Count  \n  \n `lpszName`  \n A pointer to the name of the index object, for lookup by name.  \n  \n### Remarks  \n One version of the function lets you look up an index by its position in the collection. The other version lets you look up an index by name.  \n  \n For a description of the information returned, see the [CDaoIndexInfo](../../mfc/reference/cdaoindexinfo-structure.md) structure. This structure has members that correspond to the items of information listed above in the description of `dwInfoOptions`. When you request information at one level, you get information for any prior levels as well.  \n  \n For related information, see the topic \"Attributes Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getname\"></a>  CDaoTableDef::GetName  \n Call this member function to obtain the user-defined name of the underlying table.  \n  \n```  \nCString GetName();\n```  \n  \n### Return Value  \n A user-defined name for a table.  \n  \n### Remarks  \n This name starts with a letter and can contain a maximum of 64 characters. It can include numbers and underscore characters but cannot include punctuation or spaces.  \n  \n For related information, see the topic \"Name Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getrecordcount\"></a>  CDaoTableDef::GetRecordCount  \n Call this member function to find out how many records are in a `CDaoTableDef` object.  \n  \n```  \nlong GetRecordCount();\n```  \n  \n### Return Value  \n The number of records accessed in a tabledef object.  \n  \n### Remarks  \n Calling `GetRecordCount` for a table-type `CDaoTableDef` object reflects the approximate number of records in the table and is affected immediately as table records are added and deleted. Rolled back transactions will appear as part of the record count until you call [CDaoWorkSpace::CompactDatabase](../../mfc/reference/cdaoworkspace-class.md#cdaoworkspace__compactdatabase). A `CDaoTableDef` object with no records has a record count property setting of 0. When working with attached tables or ODBC databases, `GetRecordCount` always returns –1.  \n  \n For related information, see the topic \"RecordCount Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getsourcetablename\"></a>  CDaoTableDef::GetSourceTableName  \n Call this member function to retrieve the name of an attached table in a source database.  \n  \n```  \nCString GetSourceTableName();\n```  \n  \n### Return Value  \n A `CString` object that specifies the source name of an attached table, or an empty string if a native data table.  \n  \n### Remarks  \n An attached table is a table in another database linked to a Microsoft Jet database. Data for attached tables remains in the external database, where it can be manipulated by other applications.  \n  \n For related information, see the topic \"SourceTableName Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getvalidationrule\"></a>  CDaoTableDef::GetValidationRule  \n Call this member function to retrieve the validation rule for a tabledef.  \n  \n```  \nCString GetValidationRule();\n```  \n  \n### Return Value  \n A **CString** object that validates the data in a field as it is changed or added to a table.  \n  \n### Remarks  \n Validation rules are used in connection with update operations. If a tabledef contains a validation rule, updates to that tabledef must match predetermined criteria before the data is changed. If the change does not match the criteria, an exception containing the value of [GetValidationText](#cdaotabledef__getvalidationtext) is thrown. For a `CDaoTableDef` object, this `CString` is read-only for an attached table and read/write for a base table.  \n  \n For related information, see the topic \"ValidationRule Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__getvalidationtext\"></a>  CDaoTableDef::GetValidationText  \n Call this function to retrieve the string to display when a user enters data that does not match the validation rule.  \n  \n```  \nCString GetValidationText();\n```  \n  \n### Return Value  \n A `CString` object that specifies the text displayed if the user enters data that does not match the validation rule.  \n  \n### Remarks  \n For a `CDaoTableDef` object, this `CString` is read-only for an attached table and read/write for a base table.  \n  \n For related information, see the topic \"ValidationText Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__isopen\"></a>  CDaoTableDef::IsOpen  \n Call this member function to determine whether the `CDaoTableDef` object is currently open.  \n  \n```  \nBOOL IsOpen() const;\n\n \n```  \n  \n### Return Value  \n Nonzero if the `CDaoTableDef` object is open; otherwise 0.  \n  \n### Remarks  \n  \n##  <a name=\"cdaotabledef__m_pdatabase\"></a>  CDaoTableDef::m_pDatabase  \n Contains a pointer to the [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) object for this table.  \n  \n### Remarks  \n  \n##  <a name=\"cdaotabledef__m_pdaotabledef\"></a>  CDaoTableDef::m_pDAOTableDef  \n Contains a pointer to the OLE interface for the DAO tabledef object underlying the `CDaoTableDef` object.  \n  \n### Remarks  \n Use this pointer if you need to access the DAO interface directly.  \n  \n##  <a name=\"cdaotabledef__open\"></a>  CDaoTableDef::Open  \n Call this member function to open a tabledef previously saved in the database's TableDef's collection.  \n  \n```  \nvirtual void Open(LPCTSTR lpszName);\n```  \n  \n### Parameters  \n `lpszName`  \n A pointer to a string that specifies a table name.  \n  \n### Remarks  \n  \n##  <a name=\"cdaotabledef__refreshlink\"></a>  CDaoTableDef::RefreshLink  \n Call this member function to update the connection information for an attached table.  \n  \n```  \nvoid RefreshLink();\n```  \n  \n### Remarks  \n You change the connection information for an attached table by calling [SetConnect](#cdaotabledef__setconnect) on the corresponding `CDaoTableDef` object and then using the `RefreshLink` member function to update the information. When you call `RefreshLink`, the attached table's properties are not changed.  \n  \n To force the modified connect information to take effect, all open [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) objects based on this tabledef must be closed.  \n  \n For related information, see the topic \"RefreshLink Method\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__setattributes\"></a>  CDaoTableDef::SetAttributes  \n Sets a value that indicates one or more characteristics of a `CDaoTableDef` object.  \n  \n```  \nvoid SetAttributes(long lAttributes);\n```  \n  \n### Parameters  \n `lAttributes`  \n Characteristics of the table represented by the `CDaoTableDef` object and can be a sum of these constants:  \n  \n|Constant|Description|  \n|--------------|-----------------|  \n|**dbAttachExclusive**|For databases that use the Microsoft Jet database engine, indicates the table is an attached table opened for exclusive use.|  \n|**dbAttachSavePWD**|For databases that use the Microsoft Jet database engine, indicates that the user ID and password for the attached table are saved with the connection information.|  \n|**dbSystemObject**|Indicates the table is a system table provided by the Microsoft Jet database engine.|  \n|**dbHiddenObject**|Indicates the table is a hidden table provided by the Microsoft Jet database engine.|  \n  \n### Remarks  \n When setting multiple attributes, you can combine them by summing the appropriate constants using the bitwise-OR operator. Setting **dbAttachExclusive** on a nonattached table produces an exception. Combining the following values also produce an exception:  \n  \n- **dbAttachExclusive &#124; dbAttachedODBC**  \n  \n- **dbAttachSavePWD &#124; dbAttachedTable**  \n  \n For related information, see the topic \"Attributes Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__setconnect\"></a>  CDaoTableDef::SetConnect  \n For a `CDaoTableDef` object that represents an attached table, the string object consists of one or two parts (a database type specifier and a path to the database).  \n  \n```  \nvoid SetConnect(LPCTSTR lpszConnect);\n```  \n  \n### Parameters  \n `lpszConnect`  \n A pointer to a string expression that specifies additional parameters to pass to ODBC or installable ISAM drivers.  \n  \n### Remarks  \n The path as shown in the table below is the full path for the directory containing the database files and must be preceded by the identifier \"DATABASE=\". In some cases (as with Microsoft Jet and Microsoft Excel databases), a specific filename is included in the database path argument.  \n  \n> [!NOTE]\n>  Do not include whitespace around the equal sign in path statements of the form \"DATABASE=drive:\\\\\\path\". This will result in an exception being thrown and the connection failing.  \n  \n The following table shows possible database types and their corresponding database specifiers and paths:  \n  \n|Database type|Specifier|Path|  \n|-------------------|---------------|----------|  \n|Database using the Jet database engine|\"[ `database`];\"|\" `drive`:\\\\\\ *path*\\\\\\ *filename*.MDB\"|  \n|dBASE III|\"dBASE III;\"|\" `drive`:\\\\\\ *path*\"|  \n|dBASE IV|\"dBASE IV;\"|\" `drive`:\\\\\\ *path*\"|  \n|dBASE 5|\"dBASE 5.0;\"|\" `drive`:\\\\\\ *path*\"|  \n|Paradox 3.x|\"Paradox 3.x;\"|\" `drive`:\\\\\\ *path*\"|  \n|Paradox 4.x|\"Paradox 4.x;\"|\" `drive`:\\\\\\ *path*\"|  \n|Paradox 5.x|\"Paradox 5.x;\"|\" `drive`:\\\\\\ *path*\"|  \n|Excel 3.0|\"Excel 3.0;\"|\" `drive`:\\\\\\ *path*\\\\\\ *filename*.XLS\"|  \n|Excel 4.0|\"Excel 4.0;\"|\" `drive`:\\\\\\ *path*\\\\\\ *filename*.XLS\"|  \n|Excel 5.0 or Excel 95|\"Excel 5.0;\"|\" `drive`:\\\\\\ *path*\\\\\\ *filename*.XLS\"|  \n|Excel 97|\"Excel 8.0;\"|\" `drive`:\\\\\\ *path*\\ *filename*.XLS\"|  \n|HTML Import|\"HTML Import;\"|\" `drive`:\\\\\\ *path*\\ *filename*\"|  \n|HTML Export|\"HTML Export;\"|\" `drive`:\\\\\\ *path*\"|  \n|Text|\"Text;\"|\"drive:\\\\\\path\"|  \n|ODBC|\"ODBC; DATABASE= `database`; UID= *user*;PWD= *password*; DSN= *datasourcename;* LOGINTIMEOUT= *seconds;*\" (This may not be a complete connection string for all servers; it is just an example. It is very important not to have spaces between the parameters.)|None|  \n|Exchange|\"Exchange;<br /><br /> MAPILEVEL= *folderpath*;<br /><br /> [TABLETYPE={ 0 &#124; 1 };]<br /><br /> [PROFILE= *profile*;]<br /><br /> [PWD= *password*;]<br /><br /> [DATABASE= `database`;]\"|*\"drive*:\\\\\\ *path*\\\\\\ *filename*.MDB\"|  \n  \n> [!NOTE]\n>  Btrieve is no longer supported as of DAO 3.5.  \n  \n You must use a double backslash (\\\\\\\\) in the connection strings. If you have modified the properties of an existing connection using `SetConnect`, you must subsequently call [RefreshLink](#cdaotabledef__refreshlink). If you are initializing the connection properties using `SetConnect`, you need not call `RefreshLink`, but should you choose to do so, first append the tabledef.  \n  \n If a password is required but not provided, the ODBC driver displays a login dialog box the first time a table is accessed and again if the connection is closed and reopened.  \n  \n You can set the connection string for a `CDaoTableDef` object by providing a source argument to the **Create** member function. You can check the setting to determine the type, path, user ID, password, or ODBC data source of the database. For more information, see the documentation for the specific driver.  \n  \n For related information, see the topic \"Connect Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__setname\"></a>  CDaoTableDef::SetName  \n Call this member function to set a user-defined name for a table.  \n  \n```  \nvoid SetName(LPCTSTR lpszName);\n```  \n  \n### Parameters  \n `lpszName`  \n A pointer to a string expression that specifies a name for a table.  \n  \n### Remarks  \n The name must start with a letter and can contain a maximum of 64 characters. It can include numbers and underscore characters but cannot include punctuation or spaces.  \n  \n For related information, see the topic \"Name Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__setsourcetablename\"></a>  CDaoTableDef::SetSourceTableName  \n Call this member function to specify the name of an attached table or the name of the base table on which the `CDaoTableDef` object is based, as it exists in the original source of the data.  \n  \n```  \nvoid SetSourceTableName(LPCTSTR lpszSrcTableName);\n```  \n  \n### Parameters  \n *lpszSrcTableName*  \n A pointer to a string expression that specifies a table name in the external database. For a base table, the setting is an empty string (\"\").  \n  \n### Remarks  \n You must then call [RefreshLink](#cdaotabledef__refreshlink). This property setting is empty for a base table and read/write for an attached table or an object not appended to a collection.  \n  \n For related information, see the topic \"SourceTableName Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__setvalidationrule\"></a>  CDaoTableDef::SetValidationRule  \n Call this member function to set a validation rule for a tabledef.  \n  \n```  \nvoid SetValidationRule(LPCTSTR lpszValidationRule);\n```  \n  \n### Parameters  \n *lpszValidationRule*  \n A pointer to a string expression that validates an operation.  \n  \n### Remarks  \n Validation rules are used in connection with update operations. If a tabledef contains a validation rule, updates to that tabledef must match predetermined criteria before the data is changed. If the change does not match the criteria, an exception containing the text of [GetValidationText](#cdaotabledef__getvalidationtext) is displayed.  \n  \n Validation is supported only for databases that use the Microsoft Jet database engine. The expression cannot refer to user-defined functions, domain aggregate functions, SQL aggregate functions, or queries. A validation rule for a `CDaoTableDef` object can refer to multiple fields in that object.  \n  \n For example, for fields named `hire_date` and `termination_date`, a validation rule might be:  \n  \n [!code-cpp[NVC_MFCDatabase#34](../../mfc/codesnippet/cpp/cdaotabledef-class_1.cpp)]  \n  \n For related information, see the topic \"ValidationRule Property\" in DAO Help.  \n  \n##  <a name=\"cdaotabledef__setvalidationtext\"></a>  CDaoTableDef::SetValidationText  \n Call this member function to set the exception text of a validation rule for a `CDaoTableDef` object with an underlying base table supported by the Microsoft Jet database engine.  \n  \n```  \nvoid SetValidationText(LPCTSTR lpszValidationText);\n```  \n  \n### Parameters  \n *lpszValidationText*  \n A pointer to a string expression that specifies the text displayed if entered data is invalid.  \n  \n### Remarks  \n You cannot set the validation text of an attached table.  \n  \n For related information, see the topic \"ValidationText Property\" in DAO Help.  \n  \n## See Also  \n [CObject Class](../../mfc/reference/cobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CDaoDatabase Class](../../mfc/reference/cdaodatabase-class.md)   \n [CDaoRecordset Class](../../mfc/reference/cdaorecordset-class.md)\n"}