{"nodes":[{"pos":[12,43],"content":"CCommand Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CCommand Class | Microsoft Docs","pos":[0,31]}]},{"content":"CCommand Class","pos":[635,649]},{"content":"Provides methods to set and execute a command.","pos":[650,696]},{"content":"Syntax","pos":[705,711]},{"content":"Parameters","pos":[1030,1040]},{"content":"The type of accessor class (such as <ph id=\"ph1\">`CDynamicParameterAccessor`</ph>, <ph id=\"ph2\">`CDynamicStringAccessor`</ph>, or <ph id=\"ph3\">`CEnumeratorAccessor`</ph>) that you want the command to use.","pos":[1059,1209],"source":" The type of accessor class (such as `CDynamicParameterAccessor`, `CDynamicStringAccessor`, or `CEnumeratorAccessor`) that you want the command to use."},{"content":"The default is <ph id=\"ph1\">`CNoAccessor`</ph>, which specifies that the class not support parameters or output columns.","pos":[1210,1312],"source":" The default is `CNoAccessor`, which specifies that the class not support parameters or output columns."},{"content":"The type of rowset class (such as <ph id=\"ph1\">`CArrayRowset`</ph> or <ph id=\"ph2\">`CNoRowset`</ph>) that you want the command to use.","pos":[1332,1430],"source":" The type of rowset class (such as `CArrayRowset` or `CNoRowset`) that you want the command to use."},{"content":"The default is <ph id=\"ph1\">`CRowset`</ph>.","pos":[1431,1456],"source":" The default is `CRowset`."},{"content":"To use an OLE DB command that can return multiple results, specify <bpt id=\"p1\">[</bpt>CMultipleResults<ept id=\"p1\">](../../data/oledb/cmultipleresults-class.md)</ept>.","pos":[1478,1608],"source":" To use an OLE DB command that can return multiple results, specify [CMultipleResults](../../data/oledb/cmultipleresults-class.md)."},{"content":"Otherwise, use <bpt id=\"p1\">[</bpt>CNoMultipleResults<ept id=\"p1\">](../../data/oledb/cnomultipleresults-class.md)</ept>.","pos":[1609,1691],"source":" Otherwise, use [CNoMultipleResults](../../data/oledb/cnomultipleresults-class.md)."},{"content":"For details, see <bpt id=\"p1\">[</bpt>IMultipleResults<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms721289.aspx)</ept>.","pos":[1692,1784],"source":" For details, see [IMultipleResults](https://msdn.microsoft.com/en-us/library/ms721289.aspx)."},{"content":"Members","pos":[1793,1800]},{"content":"Methods","pos":[1810,1817]},{"content":"Close","pos":[1839,1844]},{"content":"Closes the current command.","pos":[1882,1909]},{"content":"GetNextResult","pos":[1915,1928]},{"content":"Fetches the next result when using multiple result sets.","pos":[1974,2030]},{"content":"Open","pos":[2036,2040]},{"content":"Executes and optionally binds the command.","pos":[2077,2119]},{"content":"Inherited Methods","pos":[2130,2147]},{"content":"Create","pos":[2169,2175]},{"content":"Creates a new command for the specified session, then sets the command text.","pos":[2214,2290]},{"content":"CreateCommand","pos":[2296,2309]},{"content":"Creates a new command.","pos":[2355,2377]},{"content":"GetParameterInfo","pos":[2383,2399]},{"content":"Gets a list of the command's parameters, their names, and their types.","pos":[2448,2518]},{"content":"Prepare","pos":[2524,2531]},{"content":"Validates and optimizes the current command.","pos":[2571,2615]},{"content":"ReleaseCommand","pos":[2621,2635]},{"content":"Releases the parameter accessor if necessary, then releases the command.","pos":[2682,2754]},{"content":"SetParameterInfo","pos":[2760,2776]},{"content":"Specifies the native type of each command parameter.","pos":[2825,2877]},{"content":"Unprepare","pos":[2883,2892]},{"content":"Discards the current command execution plan.","pos":[2934,2978]},{"content":"Remarks","pos":[2988,2995]},{"content":"Use this class when you need to perform a parameter-based operation or execute a command.","pos":[2999,3088]},{"content":"If you merely need to open a simple rowset, use <bpt id=\"p1\">[</bpt>CTable<ept id=\"p1\">](../../data/oledb/ctable-class.md)</ept> instead.","pos":[3089,3188],"source":" If you merely need to open a simple rowset, use [CTable](../../data/oledb/ctable-class.md) instead."},{"content":"The accessor class you are using determines the method of binding parameters and data.","pos":[3195,3281]},{"content":"Note that you cannot use stored procedures with the OLE DB Provider for Jet because that provider does not support stored procedures (only constants are allowed in query strings).","pos":[3288,3467]},{"content":"Requirements","pos":[3476,3488]},{"pos":[3492,3514],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldbcli.h","source":"**Header:** atldbcli.h"},{"content":"See Also","pos":[3523,3531]},{"content":"OLE DB Consumer Templates","pos":[3536,3561]},{"content":"OLE DB Consumer Templates Reference","pos":[3619,3654]}],"content":"---\ntitle: \"CCommand Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"ATL::CCommand\"\n  - \"CCommand\"\n  - \"ATL.CCommand\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CCommand class\"\nms.assetid: 0760bfc5-b9ee-4aee-8e54-31bd78714d3a\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CCommand Class\nProvides methods to set and execute a command.  \n  \n## Syntax  \n  \n```  \ntemplate <  \n   class TAccessor = CNoAccessor,  \n   template < typename T > class TRowset = CRowset,  \n   class TMultiple = CNoMultipleResults   \n>  \nclass CCommand :   \n   public CAccessorRowset <  \n      TAccessor,   \n      TRowset   \n   >,  \n   public CCommandBase,  \n   public TMultiple  \n```  \n  \n#### Parameters  \n `TAccessor`  \n The type of accessor class (such as `CDynamicParameterAccessor`, `CDynamicStringAccessor`, or `CEnumeratorAccessor`) that you want the command to use. The default is `CNoAccessor`, which specifies that the class not support parameters or output columns.  \n  \n `TRowset`  \n The type of rowset class (such as `CArrayRowset` or `CNoRowset`) that you want the command to use. The default is `CRowset`.  \n  \n `TMultiple`  \n To use an OLE DB command that can return multiple results, specify [CMultipleResults](../../data/oledb/cmultipleresults-class.md). Otherwise, use [CNoMultipleResults](../../data/oledb/cnomultipleresults-class.md). For details, see [IMultipleResults](https://msdn.microsoft.com/en-us/library/ms721289.aspx).  \n  \n## Members  \n  \n### Methods  \n  \n|||  \n|-|-|  \n|[Close](../../data/oledb/ccommand-close.md)|Closes the current command.|  \n|[GetNextResult](../../data/oledb/ccommand-getnextresult.md)|Fetches the next result when using multiple result sets.|  \n|[Open](../../data/oledb/ccommand-open.md)|Executes and optionally binds the command.|  \n  \n### Inherited Methods  \n  \n|||  \n|-|-|  \n|[Create](../../data/oledb/ccommand-create.md)|Creates a new command for the specified session, then sets the command text.|  \n|[CreateCommand](../../data/oledb/ccommand-createcommand.md)|Creates a new command.|  \n|[GetParameterInfo](../../data/oledb/ccommand-getparameterinfo.md)|Gets a list of the command's parameters, their names, and their types.|  \n|[Prepare](../../data/oledb/ccommand-prepare.md)|Validates and optimizes the current command.|  \n|[ReleaseCommand](../../data/oledb/ccommand-releasecommand.md)|Releases the parameter accessor if necessary, then releases the command.|  \n|[SetParameterInfo](../../data/oledb/ccommand-setparameterinfo.md)|Specifies the native type of each command parameter.|  \n|[Unprepare](../../data/oledb/ccommand-unprepare.md)|Discards the current command execution plan.|  \n  \n## Remarks  \n Use this class when you need to perform a parameter-based operation or execute a command. If you merely need to open a simple rowset, use [CTable](../../data/oledb/ctable-class.md) instead.  \n  \n The accessor class you are using determines the method of binding parameters and data.  \n  \n Note that you cannot use stored procedures with the OLE DB Provider for Jet because that provider does not support stored procedures (only constants are allowed in query strings).  \n  \n## Requirements  \n **Header:** atldbcli.h  \n  \n## See Also  \n [OLE DB Consumer Templates](../../data/oledb/ole-db-consumer-templates-cpp.md)   \n [OLE DB Consumer Templates Reference](../../data/oledb/ole-db-consumer-templates-reference.md)"}