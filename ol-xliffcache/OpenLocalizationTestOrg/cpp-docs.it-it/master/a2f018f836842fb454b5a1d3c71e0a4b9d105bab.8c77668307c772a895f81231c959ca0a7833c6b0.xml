{"nodes":[{"pos":[12,55],"content":"CMFCRibbonUndoButton Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCRibbonUndoButton Class | Microsoft Docs","pos":[0,43]}]},{"content":"CMFCRibbonUndoButton Class","pos":[634,660]},{"content":"The <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> class implements a drop-down list button that contains the most recent user commands.","pos":[661,773],"source":"The `CMFCRibbonUndoButton` class implements a drop-down list button that contains the most recent user commands."},{"content":"Users can select one or more of the most recent commands from the drop-down list to either redo or undo them.","pos":[774,883]},{"content":"Syntax","pos":[892,898]},{"content":"Members","pos":[978,985]},{"content":"Public Constructors","pos":[995,1014]},{"content":"Name","pos":[1021,1025]},{"content":"Description","pos":[1026,1037]},{"content":"CMFCRibbonUndoButton::CMFCRibbonUndoButton","pos":[1076,1118]},{"pos":[1165,1317],"content":"Constructs a new <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> object by using the command ID that you specify, text label and images from the image list of the parent object.","source":"Constructs a new `CMFCRibbonUndoButton` object by using the command ID that you specify, text label and images from the image list of the parent object."},{"content":"Public Methods","pos":[1328,1342]},{"content":"Name","pos":[1349,1353]},{"content":"Description","pos":[1354,1365]},{"content":"CMFCRibbonUndoButton::AddUndoAction","pos":[1404,1439]},{"content":"Adds a new action to the list of actions.","pos":[1479,1520]},{"content":"CMFCRibbonUndoButton::CleanUpUndoList","pos":[1526,1563]},{"content":"Clears the action list, which is the drop-down list.","pos":[1605,1657]},{"content":"CMFCRibbonUndoButton::GetActionNumber","pos":[1663,1700]},{"content":"Determines the number of items that a user selected from the drop-down list.","pos":[1742,1818]},{"content":"CMFCRibbonUndoButton::HasMenu","pos":[1824,1853]},{"content":"Indicates whether the object contains a menu.","pos":[1887,1932]},{"content":"Remarks","pos":[1942,1949]},{"pos":[1953,2031],"content":"The <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> class uses a stack to represent the drop-down list.","source":"The `CMFCRibbonUndoButton` class uses a stack to represent the drop-down list."},{"content":"Example","pos":[2040,2047]},{"content":"The following example demonstrates how to construct an object of the <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> class, and add a new action to the list of actions.","pos":[2051,2194],"source":"The following example demonstrates how to construct an object of the `CMFCRibbonUndoButton` class, and add a new action to the list of actions."},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>Ribbon Gadgets sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[2195,2281],"source":" This code snippet is part of the [Ribbon Gadgets sample](../../visual-cpp-samples.md)."},{"pos":[2299,2322],"content":"NVC_MFC_RibbonGadgets#2"},{"content":"Inheritance Hierarchy","pos":[2403,2424]},{"content":"CObject","pos":[2429,2436]},{"content":"CMFCRibbonBaseElement","pos":[2483,2504]},{"content":"CMFCRibbonButton","pos":[2565,2581]},{"content":"CMFCRibbonGallery","pos":[2637,2654]},{"content":"CMFCRibbonUndoButton","pos":[2711,2731]},{"content":"Requirements","pos":[2792,2804]},{"pos":[2808,2841],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxribbonundobutton.h","source":"**Header:** afxribbonundobutton.h"},{"pos":[2903,2938],"content":"CMFCRibbonUndoButton::AddUndoAction"},{"content":"Adds a new action to the list of actions.","pos":[2942,2983]},{"content":"Parameters","pos":[3047,3057]},{"content":"[in]","pos":[3061,3065]},{"content":"The action label that will be displayed in the drop-down list.","pos":[3081,3143]},{"pos":[3207,3244],"content":"CMFCRibbonUndoButton::CleanUpUndoList"},{"content":"Clears the action list, which is the drop-down list.","pos":[3248,3300]},{"pos":[3408,3450],"content":"CMFCRibbonUndoButton::CMFCRibbonUndoButton"},{"pos":[3454,3606],"content":"Constructs a new <ph id=\"ph1\">`CMFCRibbonUndoButton`</ph> object by using the command ID that you specify, text label and images from the image list of the parent object.","source":"Constructs a new `CMFCRibbonUndoButton` object by using the command ID that you specify, text label and images from the image list of the parent object."},{"content":"Parameters","pos":[3837,3847]},{"content":"[in]","pos":[3851,3855]},{"content":"Specifies the command identifier.","pos":[3865,3898]},{"content":"[in]","pos":[3905,3909]},{"content":"Specifies the text label of the button.","pos":[3924,3963]},{"content":"[in]","pos":[3970,3974]},{"content":"Zero-based index in the image list of the parent object for the button's small image.","pos":[3997,4082]},{"content":"[in]","pos":[4089,4093]},{"content":"Zero-based index in the image list of the parent object for the of button's large image.","pos":[4116,4204]},{"content":"[in]","pos":[4211,4215]},{"content":"A handle to an icon that you can use as a button's image.","pos":[4227,4284]},{"pos":[4348,4385],"content":"CMFCRibbonUndoButton::GetActionNumber"},{"content":"Determines the number of items that a user selected from the drop-down list.","pos":[4389,4465]},{"content":"Return Value","pos":[4522,4534]},{"content":"The number of items that a user selected.","pos":[4538,4579]},{"pos":[4635,4664],"content":"CMFCRibbonUndoButton::HasMenu"},{"content":"Indicates whether the object contains a menu.","pos":[4668,4713]},{"content":"Return Value","pos":[4771,4783]},{"pos":[4787,4809],"content":"Always returns <ph id=\"ph1\">`TRUE`</ph>.","source":"Always returns `TRUE`."},{"content":"Remarks","pos":[4819,4826]},{"content":"See Also","pos":[4835,4843]},{"content":"Hierarchy Chart","pos":[4848,4863]},{"content":"Classes","pos":[4900,4907]},{"content":"CMFCRibbonGallery Class","pos":[4950,4973]},{"content":"CMFCRibbonButton Class","pos":[5028,5050]}],"content":"---\ntitle: \"CMFCRibbonUndoButton Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCRibbonUndoButton\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCRibbonUndoButton class\"\nms.assetid: 5c42adf7-871d-4239-901e-47ae7fb816fc\ncaps.latest.revision: 35\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CMFCRibbonUndoButton Class\nThe `CMFCRibbonUndoButton` class implements a drop-down list button that contains the most recent user commands. Users can select one or more of the most recent commands from the drop-down list to either redo or undo them.  \n  \n## Syntax  \n  \n```  \nclass CMFCRibbonUndoButton : public CMFCRibbonGallery  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCRibbonUndoButton::CMFCRibbonUndoButton](#cmfcribbonundobutton__cmfcribbonundobutton)|Constructs a new `CMFCRibbonUndoButton` object by using the command ID that you specify, text label and images from the image list of the parent object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCRibbonUndoButton::AddUndoAction](#cmfcribbonundobutton__addundoaction)|Adds a new action to the list of actions.|  \n|[CMFCRibbonUndoButton::CleanUpUndoList](#cmfcribbonundobutton__cleanupundolist)|Clears the action list, which is the drop-down list.|  \n|[CMFCRibbonUndoButton::GetActionNumber](#cmfcribbonundobutton__getactionnumber)|Determines the number of items that a user selected from the drop-down list.|  \n|[CMFCRibbonUndoButton::HasMenu](#cmfcribbonundobutton__hasmenu)|Indicates whether the object contains a menu.|  \n  \n## Remarks  \n The `CMFCRibbonUndoButton` class uses a stack to represent the drop-down list.  \n  \n## Example  \n The following example demonstrates how to construct an object of the `CMFCRibbonUndoButton` class, and add a new action to the list of actions. This code snippet is part of the [Ribbon Gadgets sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_RibbonGadgets#2](../../mfc/reference/codesnippet/cpp/cmfcribbonundobutton-class_1.cpp)]  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)  \n  \n [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)  \n  \n [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)  \n  \n [CMFCRibbonUndoButton](../../mfc/reference/cmfcribbonundobutton-class.md)  \n  \n## Requirements  \n **Header:** afxribbonundobutton.h  \n  \n##  <a name=\"cmfcribbonundobutton__addundoaction\"></a>  CMFCRibbonUndoButton::AddUndoAction  \n Adds a new action to the list of actions.  \n  \n```  \nvoid AddUndoAction(LPCTSTR lpszLabel);\n```  \n  \n### Parameters  \n [in] `lpszLabel`  \n The action label that will be displayed in the drop-down list.  \n  \n##  <a name=\"cmfcribbonundobutton__cleanupundolist\"></a>  CMFCRibbonUndoButton::CleanUpUndoList  \n Clears the action list, which is the drop-down list.  \n  \n```  \nvoid CleanUpUndoList();\n```  \n  \n##  <a name=\"cmfcribbonundobutton__cmfcribbonundobutton\"></a>  CMFCRibbonUndoButton::CMFCRibbonUndoButton  \n Constructs a new `CMFCRibbonUndoButton` object by using the command ID that you specify, text label and images from the image list of the parent object.  \n  \n```  \nCMFCRibbonUndoButton(\n    UINT nID,  \n    LPCTSTR lpszText,  \n    int nSmallImageIndex=-1,  \n    int nLargeImageIndex=-1);\n\n \nCMFCRibbonUndoButton(\n    UINT nID,  \n    LPCTSTR lpszText,  \n    HICON hIcon);\n```  \n  \n### Parameters  \n [in] `nID`  \n Specifies the command identifier.  \n  \n [in] `lpszText`  \n Specifies the text label of the button.  \n  \n [in] `nSmallImageIndex`  \n Zero-based index in the image list of the parent object for the button's small image.  \n  \n [in] `nLargeImageIndex`  \n Zero-based index in the image list of the parent object for the of button's large image.  \n  \n [in] `hIcon`  \n A handle to an icon that you can use as a button's image.  \n  \n##  <a name=\"cmfcribbonundobutton__getactionnumber\"></a>  CMFCRibbonUndoButton::GetActionNumber  \n Determines the number of items that a user selected from the drop-down list.  \n  \n```  \nint GetActionNumber() const;\n\n \n```  \n  \n### Return Value  \n The number of items that a user selected.  \n  \n##  <a name=\"cmfcribbonundobutton__hasmenu\"></a>  CMFCRibbonUndoButton::HasMenu  \n Indicates whether the object contains a menu.  \n  \n```  \nvirtual BOOL HasMenu() const;\n\n \n```  \n  \n### Return Value  \n Always returns `TRUE`.  \n  \n### Remarks  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CMFCRibbonGallery Class](../../mfc/reference/cmfcribbongallery-class.md)   \n [CMFCRibbonButton Class](../../mfc/reference/cmfcribbonbutton-class.md)\n"}