{"nodes":[{"pos":[12,79],"content":"MFC ActiveX Controls: Accessing Ambient Properties | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Accessing Ambient Properties | Microsoft Docs","pos":[0,67]}]},{"content":"MFC ActiveX Controls: Accessing Ambient Properties","pos":[681,731]},{"content":"This article discusses how an ActiveX control can access the ambient properties of its control container.","pos":[732,837]},{"content":"A control can obtain information about its container by accessing the container's ambient properties.","pos":[844,945]},{"content":"These properties expose visual characteristics, such as the container's background color, the current font used by the container, and operational characteristics, such as whether the container is currently in user mode or designer mode.","pos":[946,1182]},{"content":"A control can use ambient properties to tailor its appearance and behavior to the particular container in which it is embedded.","pos":[1183,1310]},{"content":"However, a control should never assume that its container will support any particular ambient property.","pos":[1311,1414]},{"content":"In fact, some containers may not support any ambient properties at all.","pos":[1415,1486]},{"content":"In the absence of an ambient property, a control should assume a reasonable default value.","pos":[1487,1577]},{"content":"To access an ambient property, make a call to <bpt id=\"p1\">[</bpt>COleControl::GetAmbientProperty<ept id=\"p1\">](../mfc/reference/colecontrol-class.md#colecontrol__getambientproperty)</ept>.","pos":[1584,1735],"source":"To access an ambient property, make a call to [COleControl::GetAmbientProperty](../mfc/reference/colecontrol-class.md#colecontrol__getambientproperty)."},{"content":"This function expects the dispatch ID for the ambient property as the first parameter (the file OLECTL.H defines dispatch IDs for the standard set of ambient properties).","pos":[1736,1906]},{"content":"The parameters of the <ph id=\"ph1\">`GetAmbientProperty`</ph> function are the dispatch ID, a variant tag indicating the expected property type, and a pointer to memory where the value should be returned.","pos":[1913,2098],"source":"The parameters of the `GetAmbientProperty` function are the dispatch ID, a variant tag indicating the expected property type, and a pointer to memory where the value should be returned."},{"content":"The type of data to which this pointer refers will vary depending on the variant tag.","pos":[2099,2184]},{"content":"The function returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if the container supports the property, otherwise it returns <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","pos":[2185,2286],"source":" The function returns **TRUE** if the container supports the property, otherwise it returns **FALSE**."},{"content":"The following code example obtains the value of the ambient property called \"UserMode.\"","pos":[2293,2380]},{"content":"If the property is not supported by the container, a default value of <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> is assumed:","pos":[2381,2471],"source":" If the property is not supported by the container, a default value of **TRUE** is assumed:"},{"pos":[2489,2504],"content":"NVC_MFC_AxUI#30"},{"content":"For your convenience, <ph id=\"ph1\">`COleControl`</ph> supplies helper functions that access many of the commonly used ambient properties and return appropriate defaults when the properties are not available.","pos":[2593,2782],"source":"For your convenience, `COleControl` supplies helper functions that access many of the commonly used ambient properties and return appropriate defaults when the properties are not available."},{"content":"These helper functions are as follows:","pos":[2783,2821]},{"content":"COleControl::AmbientBackColor","pos":[2832,2861]},{"content":"AmbientDisplayName","pos":[2942,2960]},{"content":"AmbientFont","pos":[3043,3054]},{"pos":[3131,3199],"content":"[!NOTE]\n Caller must call **Release( )** on the returned font.","leadings":["","    > "],"nodes":[{"content":"Caller must call <bpt id=\"p1\">**</bpt>Release( )<ept id=\"p1\">**</ept> on the returned font.","pos":[9,62],"source":" Caller must call **Release( )** on the returned font."}]},{"content":"AmbientForeColor","pos":[3210,3226]},{"content":"AmbientLocaleID","pos":[3307,3322]},{"content":"AmbientScaleUnits","pos":[3402,3419]},{"content":"AmbientTextAlign","pos":[3501,3517]},{"content":"AmbientUserMode","pos":[3598,3613]},{"content":"AmbientUIDead","pos":[3693,3706]},{"content":"AmbientShowHatching","pos":[3784,3803]},{"content":"AmbientShowGrabHandles","pos":[3887,3909]},{"content":"If the value of an ambient property changes (through some action of the container), the <bpt id=\"p1\">**</bpt>OnAmbientPropertyChanged<ept id=\"p1\">**</ept> member function of the control is called.","pos":[3992,4150],"source":"If the value of an ambient property changes (through some action of the container), the **OnAmbientPropertyChanged** member function of the control is called."},{"content":"Override this member function to handle such a notification.","pos":[4151,4211]},{"content":"The parameter for <bpt id=\"p1\">**</bpt>OnAmbientPropertyChanged<ept id=\"p1\">**</ept> is the dispatch ID of the affected ambient property.","pos":[4212,4311],"source":" The parameter for **OnAmbientPropertyChanged** is the dispatch ID of the affected ambient property."},{"content":"The value of this dispatch ID may be <bpt id=\"p1\">**</bpt>DISPID_UNKNOWN<ept id=\"p1\">**</ept>, which indicates that one or more ambient properties has changed, but information about which properties were affected is unavailable.","pos":[4312,4502],"source":" The value of this dispatch ID may be **DISPID_UNKNOWN**, which indicates that one or more ambient properties has changed, but information about which properties were affected is unavailable."},{"content":"See Also","pos":[4511,4519]},{"content":"MFC ActiveX Controls","pos":[4524,4544]}],"content":"---\ntitle: \"MFC ActiveX Controls: Accessing Ambient Properties | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, accessing ambient properties\"\n  - \"properties [MFC], accessing ambient\"\nms.assetid: fdc9db29-e6b0-45d2-a879-8bd60e2058a7\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Accessing Ambient Properties\nThis article discusses how an ActiveX control can access the ambient properties of its control container.  \n  \n A control can obtain information about its container by accessing the container's ambient properties. These properties expose visual characteristics, such as the container's background color, the current font used by the container, and operational characteristics, such as whether the container is currently in user mode or designer mode. A control can use ambient properties to tailor its appearance and behavior to the particular container in which it is embedded. However, a control should never assume that its container will support any particular ambient property. In fact, some containers may not support any ambient properties at all. In the absence of an ambient property, a control should assume a reasonable default value.  \n  \n To access an ambient property, make a call to [COleControl::GetAmbientProperty](../mfc/reference/colecontrol-class.md#colecontrol__getambientproperty). This function expects the dispatch ID for the ambient property as the first parameter (the file OLECTL.H defines dispatch IDs for the standard set of ambient properties).  \n  \n The parameters of the `GetAmbientProperty` function are the dispatch ID, a variant tag indicating the expected property type, and a pointer to memory where the value should be returned. The type of data to which this pointer refers will vary depending on the variant tag. The function returns **TRUE** if the container supports the property, otherwise it returns **FALSE**.  \n  \n The following code example obtains the value of the ambient property called \"UserMode.\" If the property is not supported by the container, a default value of **TRUE** is assumed:  \n  \n [!code-cpp[NVC_MFC_AxUI#30](../mfc/codesnippet/cpp/mfc-activex-controls-accessing-ambient-properties_1.cpp)]  \n  \n For your convenience, `COleControl` supplies helper functions that access many of the commonly used ambient properties and return appropriate defaults when the properties are not available. These helper functions are as follows:  \n  \n-   [COleControl::AmbientBackColor](../mfc/reference/colecontrol-class.md#colecontrol__ambientbackcolor)  \n  \n-   [AmbientDisplayName](../mfc/reference/colecontrol-class.md#colecontrol__ambientdisplayname)  \n  \n-   [AmbientFont](../mfc/reference/colecontrol-class.md#colecontrol__ambientfont)  \n  \n    > [!NOTE]\n    >  Caller must call **Release( )** on the returned font.  \n  \n-   [AmbientForeColor](../mfc/reference/colecontrol-class.md#colecontrol__ambientforecolor)  \n  \n-   [AmbientLocaleID](../mfc/reference/colecontrol-class.md#colecontrol__ambientlocaleid)  \n  \n-   [AmbientScaleUnits](../mfc/reference/colecontrol-class.md#colecontrol__ambientscaleunits)  \n  \n-   [AmbientTextAlign](../mfc/reference/colecontrol-class.md#colecontrol__ambienttextalign)  \n  \n-   [AmbientUserMode](../mfc/reference/colecontrol-class.md#colecontrol__ambientusermode)  \n  \n-   [AmbientUIDead](../mfc/reference/colecontrol-class.md#colecontrol__ambientuidead)  \n  \n-   [AmbientShowHatching](../mfc/reference/colecontrol-class.md#colecontrol__ambientshowhatching)  \n  \n-   [AmbientShowGrabHandles](../mfc/reference/colecontrol-class.md#colecontrol__ambientshowgrabhandles)  \n  \n If the value of an ambient property changes (through some action of the container), the **OnAmbientPropertyChanged** member function of the control is called. Override this member function to handle such a notification. The parameter for **OnAmbientPropertyChanged** is the dispatch ID of the affected ambient property. The value of this dispatch ID may be **DISPID_UNKNOWN**, which indicates that one or more ambient properties has changed, but information about which properties were affected is unavailable.  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)\n\n"}