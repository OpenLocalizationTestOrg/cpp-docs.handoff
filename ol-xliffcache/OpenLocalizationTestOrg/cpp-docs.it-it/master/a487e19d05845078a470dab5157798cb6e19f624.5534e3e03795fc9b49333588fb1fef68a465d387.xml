{"nodes":[{"pos":[12,92],"content":"vsnprintf, _vsnprintf, _vsnprintf_l, _vsnwprintf, _vsnwprintf_l | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"vsnprintf, _vsnprintf, _vsnprintf_l, _vsnwprintf, _vsnwprintf_l | Microsoft Docs","pos":[0,80]}]},{"pos":[1650,1713],"content":"vsnprintf, _vsnprintf, _vsnprintf_l, _vsnwprintf, _vsnwprintf_l","linkify":"vsnprintf, _vsnprintf, _vsnprintf_l, _vsnwprintf, _vsnwprintf_l","nodes":[{"content":"vsnprintf, _vsnprintf, _vsnprintf_l, _vsnwprintf, _vsnwprintf_l","pos":[0,63]}]},{"content":"Write formatted output using a pointer to a list of arguments.","pos":[1714,1776]},{"content":"More secure versions of these functions are available; see <bpt id=\"p1\">[</bpt>vsnprintf_s, _vsnprintf_s, _vsnprintf_s_l, _vsnwprintf_s, _vsnwprintf_s_l<ept id=\"p1\">](../../c-runtime-library/reference/vsnprintf-s-vsnprintf-s-vsnprintf-s-l-vsnwprintf-s-vsnwprintf-s-l.md)</ept>.","pos":[1777,2016],"source":" More secure versions of these functions are available; see [vsnprintf_s, _vsnprintf_s, _vsnprintf_s_l, _vsnwprintf_s, _vsnwprintf_s_l](../../c-runtime-library/reference/vsnprintf-s-vsnprintf-s-vsnprintf-s-l-vsnwprintf-s-vsnwprintf-s-l.md)."},{"pos":[2025,2031],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[3474,3484],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Storage location for output.","pos":[3500,3528]},{"content":"Maximum number of characters to write.","pos":[3546,3584]},{"content":"Format specification.","pos":[3603,3624]},{"content":"Pointer to list of arguments.","pos":[3643,3672]},{"content":"The locale to use.","pos":[3691,3709]},{"pos":[3716,3851],"content":"For more information, see <bpt id=\"p1\">[</bpt>Format Specifications<ept id=\"p1\">](../../c-runtime-library/format-specification-syntax-printf-and-wprintf-functions.md)</ept>.","source":"For more information, see [Format Specifications](../../c-runtime-library/format-specification-syntax-printf-and-wprintf-functions.md)."},{"pos":[3860,3872],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The <ph id=\"ph1\">`vsnprintf`</ph> function returns the number of characters written, not counting the terminating null character.","pos":[3876,3987],"source":"The `vsnprintf` function returns the number of characters written, not counting the terminating null character."},{"content":"If the buffer size specified by <ph id=\"ph1\">`count`</ph> is not sufficiently large to contain the output specified by <ph id=\"ph2\">`format`</ph> and <ph id=\"ph3\">`argptr`</ph>, the return value of <ph id=\"ph4\">`vsnprintf`</ph> is the number of characters that would be written, not counting the null character, if <ph id=\"ph5\">`count`</ph> were sufficiently large.","pos":[3988,4263],"source":" If the buffer size specified by `count` is not sufficiently large to contain the output specified by `format` and `argptr`, the return value of `vsnprintf` is the number of characters that would be written, not counting the null character, if `count` were sufficiently large."},{"content":"If the return value is greater than <ph id=\"ph1\">`count`</ph> - 1, the output has been truncated.","pos":[4264,4343],"source":" If the return value is greater than `count` - 1, the output has been truncated."},{"content":"A return value of -1 indicates that an encoding error has occurred.","pos":[4344,4411]},{"pos":[4418,4705],"content":"Both <ph id=\"ph1\">`_vsnprintf`</ph> and <ph id=\"ph2\">`_vsnwprintf`</ph> functions return the number of characters written if the number of characters to write is less than or equal to <ph id=\"ph3\">`count`</ph>; if the number of characters to write is greater than <ph id=\"ph4\">`count`</ph>, these functions return -1 indicating that output has been truncated.","source":"Both `_vsnprintf` and `_vsnwprintf` functions return the number of characters written if the number of characters to write is less than or equal to `count`; if the number of characters to write is greater than `count`, these functions return -1 indicating that output has been truncated."},{"content":"The value returned by all these functions does not include the terminating null, whether one is written or not.","pos":[4712,4823]},{"content":"When <ph id=\"ph1\">`count`</ph> is zero, the value returned is the number of characters the functions would write, not including any terminating null.","pos":[4824,4955],"source":" When `count` is zero, the value returned is the number of characters the functions would write, not including any terminating null."},{"content":"You can use this result to allocate sufficient buffer space for the string and its terminating null, and then call the function again to fill the buffer.","pos":[4956,5109]},{"content":"If <ph id=\"ph1\">`format`</ph> is <ph id=\"ph2\">`NULL`</ph>, or if <ph id=\"ph3\">`buffer`</ph> is NULL and <ph id=\"ph4\">`count`</ph> is not equal to zero, these functions invoke the invalid parameter handler, as described in <bpt id=\"p1\">[</bpt>Parameter Validation<ept id=\"p1\">](../../c-runtime-library/parameter-validation.md)</ept>.","pos":[5116,5338],"source":"If `format` is `NULL`, or if `buffer` is NULL and `count` is not equal to zero, these functions invoke the invalid parameter handler, as described in [Parameter Validation](../../c-runtime-library/parameter-validation.md)."},{"content":"If execution is allowed to continue, these functions return -1 and set <ph id=\"ph1\">`errno`</ph> to <ph id=\"ph2\">`EINVAL`</ph>.","pos":[5339,5430],"source":" If execution is allowed to continue, these functions return -1 and set `errno` to `EINVAL`."},{"pos":[5439,5446],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Each of these functions takes a pointer to an argument list, then formats the data, and writes up to <ph id=\"ph1\">`count`</ph> characters  to the memory pointed to by <ph id=\"ph2\">`buffer`</ph>.","pos":[5450,5608],"source":"Each of these functions takes a pointer to an argument list, then formats the data, and writes up to `count` characters  to the memory pointed to by `buffer`."},{"content":"The <ph id=\"ph1\">`vsnprintf`</ph> function always writes a null terminator, even if it truncates the output.","pos":[5609,5699],"source":" The `vsnprintf` function always writes a null terminator, even if it truncates the output."},{"content":"When using <ph id=\"ph1\">`_vsnprintf`</ph> and <ph id=\"ph2\">`_vsnwprintf`</ph>, the buffer will be null-terminated only if there is room at the end (that is, if the number of characters to write is less than <ph id=\"ph3\">`count`</ph>).","pos":[5700,5880],"source":" When using `_vsnprintf` and `_vsnwprintf`, the buffer will be null-terminated only if there is room at the end (that is, if the number of characters to write is less than `count`)."},{"pos":[5888,6112],"content":"[!IMPORTANT]\n To prevent certain kinds of security risks, ensure that `format` is not a user-defined string. For more information, see [Avoiding Buffer Overruns](http://msdn.microsoft.com/library/windows/desktop/ms717795).","leadings":["","> "],"nodes":[{"content":" To prevent certain kinds of security risks, ensure that `format` is not a user-defined string. For more information, see [Avoiding Buffer Overruns](http://msdn.microsoft.com/library/windows/desktop/ms717795).","pos":[13,222],"nodes":[{"content":"To prevent certain kinds of security risks, ensure that <ph id=\"ph1\">`format`</ph> is not a user-defined string.","pos":[1,95],"source":" To prevent certain kinds of security risks, ensure that `format` is not a user-defined string."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Avoiding Buffer Overruns<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms717795)</ept>.","pos":[96,209],"source":" For more information, see [Avoiding Buffer Overruns](http://msdn.microsoft.com/library/windows/desktop/ms717795)."}]}]},{"pos":[6120,6388],"content":"[!NOTE]\n To ensure that there is room for the terminating null when calling `_vsnprintf`, `_vsnprintf_l`, `_vsnwprintf` and `_vsnwprintf_l`, be sure that `count` is strictly less than the buffer length and initialize the buffer to null prior to calling the function.","leadings":["","> "],"nodes":[{"content":"To ensure that there is room for the terminating null when calling <ph id=\"ph1\">`_vsnprintf`</ph>, <ph id=\"ph2\">`_vsnprintf_l`</ph>, <ph id=\"ph3\">`_vsnwprintf`</ph> and <ph id=\"ph4\">`_vsnwprintf_l`</ph>, be sure that <ph id=\"ph5\">`count`</ph> is strictly less than the buffer length and initialize the buffer to null prior to calling the function.","pos":[9,266],"source":" To ensure that there is room for the terminating null when calling `_vsnprintf`, `_vsnprintf_l`, `_vsnwprintf` and `_vsnwprintf_l`, be sure that `count` is strictly less than the buffer length and initialize the buffer to null prior to calling the function."}]},{"pos":[6399,6516],"content":"Because <ph id=\"ph1\">`vsnprintf`</ph> always writes the terminating null, the <ph id=\"ph2\">`count`</ph> parameter may be equal to the size of the buffer.","source":"Because `vsnprintf` always writes the terminating null, the `count` parameter may be equal to the size of the buffer."},{"content":"Beginning with the UCRT in Visual Studio 2015 and Windows 10,         <ph id=\"ph1\">`vsnprintf`</ph> is no longer identical to <ph id=\"ph2\">`_vsnprintf`</ph>.","pos":[6523,6644],"source":"Beginning with the UCRT in Visual Studio 2015 and Windows 10,         `vsnprintf` is no longer identical to `_vsnprintf`."},{"content":"The <ph id=\"ph1\">`vsnprintf`</ph> function complies with the C99 standard; <ph id=\"ph2\">`_vnsprintf`</ph> is retained for backward compatibility with older Visual Studio code.","pos":[6645,6784],"source":" The `vsnprintf` function complies with the C99 standard; `_vnsprintf` is retained for backward compatibility with older Visual Studio code."},{"pos":[6791,6947],"content":"The versions of these functions with the <ph id=\"ph1\">`_l`</ph> suffix are identical except that they use the locale parameter passed in instead of the current thread locale.","source":"The versions of these functions with the `_l` suffix are identical except that they use the locale parameter passed in instead of the current thread locale."},{"content":"In C++, these functions have template overloads that invoke the newer, secure counterparts of these functions.","pos":[6954,7064]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Secure Template Overloads<ept id=\"p1\">](../../c-runtime-library/secure-template-overloads.md)</ept>.","pos":[7065,7173],"source":" For more information, see [Secure Template Overloads](../../c-runtime-library/secure-template-overloads.md)."},{"pos":[7183,7212],"content":"Generic-Text Routine Mappings","linkify":"Generic-Text Routine Mappings","nodes":[{"content":"Generic-Text Routine Mappings","pos":[0,29]}]},{"content":"TCHAR.H routine","pos":[7219,7234]},{"content":"_UNICODE &amp; _MBCS not defined","pos":[7235,7263],"source":"_UNICODE & _MBCS not defined"},{"content":"_MBCS defined","pos":[7264,7277]},{"content":"_UNICODE defined","pos":[7278,7294]},{"pos":[7536,7548],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"content":"Routine","pos":[7555,7562]},{"content":"Required header (C)","pos":[7563,7582]},{"content":"Required header (C++)","pos":[7583,7604]},{"pos":[7687,7728],"content":"<ph id=\"ph1\">`vsnprintf`</ph>, <ph id=\"ph2\">`_vsnprintf`</ph>, <ph id=\"ph3\">`_vsnprintf_l`</ph>","source":"`vsnprintf`, `_vsnprintf`, `_vsnprintf_l`"},{"content":"<ph id=\"ph1\">\\&lt;</ph>stdio.h&gt;","pos":[7729,7739],"source":"\\<stdio.h>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>stdio.h&gt; or  <ph id=\"ph2\">\\&lt;</ph>cstdio&gt;","pos":[7740,7764],"source":"\\<stdio.h> or  \\<cstdio>"},{"pos":[7769,7799],"content":"<ph id=\"ph1\">`_vsnwprintf`</ph>, <ph id=\"ph2\">`_vsnwprintf_l`</ph>","source":"`_vsnwprintf`, `_vsnwprintf_l`"},{"content":"<ph id=\"ph1\">\\&lt;</ph>stdio.h&gt; or <ph id=\"ph2\">\\&lt;</ph>wchar.h&gt;","pos":[7800,7824],"source":"\\<stdio.h> or \\<wchar.h>"},{"content":"<ph id=\"ph1\">\\&lt;</ph>stdio.h&gt;, <ph id=\"ph2\">\\&lt;</ph>wchar.h&gt;, <ph id=\"ph3\">\\&lt;</ph>cstdio&gt;, or <ph id=\"ph4\">\\&lt;</ph>cwchar&gt;","pos":[7825,7872],"source":"\\<stdio.h>, \\<wchar.h>, \\<cstdio>, or \\<cwchar>"},{"content":"The <ph id=\"ph1\">`_vsnprintf`</ph>, <ph id=\"ph2\">`_vsnprintf_l`</ph>, <ph id=\"ph3\">`_vsnwprintf`</ph> and <ph id=\"ph4\">`_vsnwprintf_l`</ph> functions are Microsoft specific.","pos":[7880,7981],"source":"The `_vsnprintf`, `_vsnprintf_l`, `_vsnwprintf` and `_vsnwprintf_l` functions are Microsoft specific."},{"content":"For additional compatibility information, see <bpt id=\"p1\">[</bpt>Compatibility<ept id=\"p1\">](../../c-runtime-library/compatibility.md)</ept> in the Introduction.","pos":[7982,8106],"source":" For additional compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md) in the Introduction."},{"pos":[8115,8122],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"content":"The behavior changes if you use vsnprintf instead, along with narrow-string parameters.","pos":[9059,9146]},{"content":"The <ph id=\"ph1\">`count`</ph> parameter can be the entire size of the buffer, and the return value is the number of characters that would have been written if <ph id=\"ph2\">`count`</ph> was large enough:","pos":[9147,9313],"source":" The `count` parameter can be the entire size of the buffer, and the return value is the number of characters that would have been written if `count` was large enough:"},{"pos":[9322,9329],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[10190,10198],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>Stream I/O<ept id=\"p1\">](../../c-runtime-library/stream-i-o.md)</ept><ph id=\"ph1\"> </ph>","pos":[10202,10254],"source":"[Stream I/O](../../c-runtime-library/stream-i-o.md) "},{"content":"<bpt id=\"p1\"> [</bpt>vprintf Functions<ept id=\"p1\">](../../c-runtime-library/vprintf-functions.md)</ept><ph id=\"ph1\"> </ph>","pos":[10257,10324],"source":" [vprintf Functions](../../c-runtime-library/vprintf-functions.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Format Specification Syntax: printf and wprintf Functions<ept id=\"p1\">](../../c-runtime-library/format-specification-syntax-printf-and-wprintf-functions.md)</ept><ph id=\"ph1\"> </ph>","pos":[10327,10473],"source":" [Format Specification Syntax: printf and wprintf Functions](../../c-runtime-library/format-specification-syntax-printf-and-wprintf-functions.md) "},{"content":"<bpt id=\"p1\"> [</bpt>fprintf, _fprintf_l, fwprintf, _fwprintf_l<ept id=\"p1\">](../../c-runtime-library/reference/fprintf-fprintf-l-fwprintf-fwprintf-l.md)</ept><ph id=\"ph1\"> </ph>","pos":[10476,10598],"source":" [fprintf, _fprintf_l, fwprintf, _fwprintf_l](../../c-runtime-library/reference/fprintf-fprintf-l-fwprintf-fwprintf-l.md) "},{"content":"<bpt id=\"p1\"> [</bpt>printf, _printf_l, wprintf, _wprintf_l<ept id=\"p1\">](../../c-runtime-library/reference/printf-printf-l-wprintf-wprintf-l.md)</ept><ph id=\"ph1\"> </ph>","pos":[10601,10715],"source":" [printf, _printf_l, wprintf, _wprintf_l](../../c-runtime-library/reference/printf-printf-l-wprintf-wprintf-l.md) "},{"content":"<bpt id=\"p1\"> [</bpt>sprintf, _sprintf_l, swprintf, _swprintf_l, <ph id=\"ph1\">\\_</ph>_swprintf_l<ept id=\"p1\">](../../c-runtime-library/reference/sprintf-sprintf-l-swprintf-swprintf-l-swprintf-l.md)</ept><ph id=\"ph2\"> </ph>","pos":[10718,10866],"source":" [sprintf, _sprintf_l, swprintf, _swprintf_l, \\__swprintf_l](../../c-runtime-library/reference/sprintf-sprintf-l-swprintf-swprintf-l-swprintf-l.md) "},{"content":"<bpt id=\"p1\"> [</bpt>va_arg, va_copy, va_end, va_start<ept id=\"p1\">](../../c-runtime-library/reference/va-arg-va-copy-va-end-va-start.md)</ept>","pos":[10869,10974],"source":" [va_arg, va_copy, va_end, va_start](../../c-runtime-library/reference/va-arg-va-copy-va-end-va-start.md)"}],"content":"---\ntitle: \"vsnprintf, _vsnprintf, _vsnprintf_l, _vsnwprintf, _vsnwprintf_l | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\napiname: \n  - \"_vsnprintf\"\n  - \"_vsnprintf_l\"\n  - \"_vsnwprintf\"\n  - \"_vsnwprintf_l\"\n  - \"_vsnprintf\"\n  - \"_vsnprintf;\"\n  - \"vsnprintf; _vsnprintf\"\n  - \"_vsnwprintf;\"\n  - \"_vsnprintf_l;\"\n  - \"_vsnwprintf_l;\"\napilocation: \n  - \"msvcrt.dll\"\n  - \"msvcr80.dll\"\n  - \"msvcr90.dll\"\n  - \"msvcr100.dll\"\n  - \"msvcr100_clr0400.dll\"\n  - \"msvcr110.dll\"\n  - \"msvcr110_clr0400.dll\"\n  - \"msvcr120.dll\"\n  - \"msvcr120_clr0400.dll\"\n  - \"ucrtbase.dll\"\napitype: \"DLLExport\"\nf1_keywords: \n  - \"_vsnprintf\"\n  - \"_vsnwprintf\"\n  - \"_vsntprintf\"\n  - \"vsnprintf\"\n  - \"stdio/vsnprintf\"\n  - \"stdio/_vsnprintf\"\n  - \"stdio/_vsnprintf_l\"\n  - \"stdio/_vsnwprintf\"\n  - \"stdio/_vsnwprintf_l\"\n  - \"_vsnprintf_l\"\n  - \"_vsnwprintf_l\"\ndev_langs: \n  - \"C++\"\n  - \"C\"\nhelpviewer_keywords: \n  - \"vsntprintf function\"\n  - \"_vsnwprintf_l function\"\n  - \"vsnwprintf_l function\"\n  - \"vsntprintf_l function\"\n  - \"_vsntprintf function\"\n  - \"_vsnprintf_l function\"\n  - \"vsnprintf function\"\n  - \"_vsntprintf_l function\"\n  - \"vsnprintf_l function\"\n  - \"_vsnwprintf function\"\n  - \"_vsnprintf function\"\n  - \"formatted text [C++]\"\n  - \"vsnwprintf function\"\nms.assetid: a97f92df-c2f8-4ea0-9269-76920d2d566a\ncaps.latest.revision: 35\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# vsnprintf, _vsnprintf, _vsnprintf_l, _vsnwprintf, _vsnwprintf_l\nWrite formatted output using a pointer to a list of arguments. More secure versions of these functions are available; see [vsnprintf_s, _vsnprintf_s, _vsnprintf_s_l, _vsnwprintf_s, _vsnwprintf_s_l](../../c-runtime-library/reference/vsnprintf-s-vsnprintf-s-vsnprintf-s-l-vsnwprintf-s-vsnwprintf-s-l.md).  \n  \n## Syntax  \n  \n```  \nint vsnprintf(  \n   char *buffer,  \n   size_t count,  \n   const char *format,  \n   va_list argptr   \n);  \nint _vsnprintf(  \n   char *buffer,  \n   size_t count,  \n   const char *format,  \n   va_list argptr   \n);  \nint _vsnprintf_l(  \n   char *buffer,  \n   size_t count,  \n   const char *format,  \n   locale_t locale,  \n   va_list argptr   \n);  \nint _vsnwprintf(  \n   wchar_t *buffer,  \n   size_t count,  \n   const wchar_t *format,  \n   va_list argptr   \n);  \nint _vsnwprintf_l(  \n   wchar_t *buffer,  \n   size_t count,  \n   const wchar_t *format,  \n   locale_t locale,  \n   va_list argptr   \n);  \ntemplate <size_t size>  \nint vsnprintf(  \n   char (&buffer)[size],  \n   size_t count,  \n   const char *format,  \n   va_list argptr   \n); // C++ only  \ntemplate <size_t size>  \nint _vsnprintf(  \n   char (&buffer)[size],  \n   size_t count,  \n   const char *format,  \n   va_list argptr   \n); // C++ only  \ntemplate <size_t size>  \nint _vsnprintf_l(  \n   char (&buffer)[size],  \n   size_t count,  \n   const char *format,  \n   locale_t locale,  \n   va_list argptr   \n); // C++ only  \ntemplate <size_t size>  \nint _vsnwprintf(  \n   wchar_t (&buffer)[size],  \n   size_t count,  \n   const wchar_t *format,  \n   va_list argptr   \n); // C++ only  \ntemplate <size_t size>  \nint _vsnwprintf_l(  \n   wchar_t (&buffer)[size],  \n   size_t count,  \n   const wchar_t *format,  \n   locale_t locale,  \n   va_list argptr   \n); // C++ only  \n```  \n  \n#### Parameters  \n `buffer`  \n Storage location for output.  \n  \n `count`  \n Maximum number of characters to write.  \n  \n `format`  \n Format specification.  \n  \n `argptr`  \n Pointer to list of arguments.  \n  \n `locale`  \n The locale to use.  \n  \n For more information, see [Format Specifications](../../c-runtime-library/format-specification-syntax-printf-and-wprintf-functions.md).  \n  \n## Return Value  \n The `vsnprintf` function returns the number of characters written, not counting the terminating null character. If the buffer size specified by `count` is not sufficiently large to contain the output specified by `format` and `argptr`, the return value of `vsnprintf` is the number of characters that would be written, not counting the null character, if `count` were sufficiently large. If the return value is greater than `count` - 1, the output has been truncated. A return value of -1 indicates that an encoding error has occurred.  \n  \n Both `_vsnprintf` and `_vsnwprintf` functions return the number of characters written if the number of characters to write is less than or equal to `count`; if the number of characters to write is greater than `count`, these functions return -1 indicating that output has been truncated.  \n  \n The value returned by all these functions does not include the terminating null, whether one is written or not. When `count` is zero, the value returned is the number of characters the functions would write, not including any terminating null. You can use this result to allocate sufficient buffer space for the string and its terminating null, and then call the function again to fill the buffer.  \n  \n If `format` is `NULL`, or if `buffer` is NULL and `count` is not equal to zero, these functions invoke the invalid parameter handler, as described in [Parameter Validation](../../c-runtime-library/parameter-validation.md). If execution is allowed to continue, these functions return -1 and set `errno` to `EINVAL`.  \n  \n## Remarks  \n Each of these functions takes a pointer to an argument list, then formats the data, and writes up to `count` characters  to the memory pointed to by `buffer`. The `vsnprintf` function always writes a null terminator, even if it truncates the output. When using `_vsnprintf` and `_vsnwprintf`, the buffer will be null-terminated only if there is room at the end (that is, if the number of characters to write is less than `count`).  \n  \n> [!IMPORTANT]\n>  To prevent certain kinds of security risks, ensure that `format` is not a user-defined string. For more information, see [Avoiding Buffer Overruns](http://msdn.microsoft.com/library/windows/desktop/ms717795).  \n  \n> [!NOTE]\n>  To ensure that there is room for the terminating null when calling `_vsnprintf`, `_vsnprintf_l`, `_vsnwprintf` and `_vsnwprintf_l`, be sure that `count` is strictly less than the buffer length and initialize the buffer to null prior to calling the function.  \n>   \n>  Because `vsnprintf` always writes the terminating null, the `count` parameter may be equal to the size of the buffer.  \n  \n Beginning with the UCRT in Visual Studio 2015 and Windows 10,         `vsnprintf` is no longer identical to `_vsnprintf`. The `vsnprintf` function complies with the C99 standard; `_vnsprintf` is retained for backward compatibility with older Visual Studio code.  \n  \n The versions of these functions with the `_l` suffix are identical except that they use the locale parameter passed in instead of the current thread locale.  \n  \n In C++, these functions have template overloads that invoke the newer, secure counterparts of these functions. For more information, see [Secure Template Overloads](../../c-runtime-library/secure-template-overloads.md).  \n  \n### Generic-Text Routine Mappings  \n  \n|TCHAR.H routine|_UNICODE & _MBCS not defined|_MBCS defined|_UNICODE defined|  \n|---------------------|------------------------------------|--------------------|-----------------------|  \n|`_vsntprintf`|`_vsnprintf`|`_vsnprintf`|`_vsnwprintf`|  \n|`_vsntprintf_l`|`_vsnprintf_l`|`_vsnprintf_l`|`_vsnwprintf_l`|  \n  \n## Requirements  \n  \n|Routine|Required header (C)|Required header (C++)|  \n|-------------|---------------------------|-------------------------------|  \n|`vsnprintf`, `_vsnprintf`, `_vsnprintf_l`|\\<stdio.h>|\\<stdio.h> or  \\<cstdio>|  \n|`_vsnwprintf`, `_vsnwprintf_l`|\\<stdio.h> or \\<wchar.h>|\\<stdio.h>, \\<wchar.h>, \\<cstdio>, or \\<cwchar>|  \n  \n The `_vsnprintf`, `_vsnprintf_l`, `_vsnwprintf` and `_vsnwprintf_l` functions are Microsoft specific. For additional compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md) in the Introduction.  \n  \n## Example  \n  \n```c  \n// crt_vsnwprintf.c  \n// compile by using: cl /W3 crt_vsnwprintf.c  \n  \n// To turn off error C4996, define this symbol:  \n#define _CRT_SECURE_NO_WARNINGS  \n  \n#include <stdio.h>  \n#include <wtypes.h>  \n  \n#define BUFFCOUNT (10)  \n  \nvoid FormatOutput(LPCWSTR formatstring, ...)  \n{  \n    int nSize = 0;  \n    wchar_t buff[BUFFCOUNT];  \n    memset(buff, 0, sizeof(buff));  \n    va_list args;  \n    va_start(args, formatstring);  \n    // Note: _vsnwprintf is deprecated; consider vsnwprintf_s instead  \n    nSize = _vsnwprintf(buff, BUFFCOUNT - 1, formatstring, args); // C4996  \n    wprintf(L\"nSize: %d, buff: %ls\\n\", nSize, buff);  \n}  \n  \nint main() {  \n    FormatOutput(L\"%ls %ls\", L\"Hi\", L\"there\");  \n    FormatOutput(L\"%ls %ls\", L\"Hi\", L\"there!\");  \n    FormatOutput(L\"%ls %ls\", L\"Hi\", L\"there!!\");  \n}  \n```  \n  \n```Output  \nnSize: 8, buff: Hi there  \nnSize: 9, buff: Hi there!  \nnSize: -1, buff: Hi there!  \n```  \n  \n The behavior changes if you use vsnprintf instead, along with narrow-string parameters. The `count` parameter can be the entire size of the buffer, and the return value is the number of characters that would have been written if `count` was large enough:  \n  \n## Example  \n  \n```c  \n// crt_vsnprintf.c  \n// compile by using: cl /W4 crt_vsnprintf.c  \n#include <stdio.h>  \n#include <stdarg.h> // for va_list, va_start  \n#include <string.h> // for memset  \n  \n#define BUFFCOUNT (10)  \n  \nvoid FormatOutput(char* formatstring, ...)  \n{  \n    int nSize = 0;  \n    char buff[BUFFCOUNT];  \n    memset(buff, 0, sizeof(buff));  \n    va_list args;  \n    va_start(args, formatstring);  \n    nSize = vsnprintf(buff, sizeof(buff), formatstring, args);  \n    printf(\"nSize: %d, buff: %s\\n\", nSize, buff);  \n}  \n  \nint main() {  \n    FormatOutput(\"%s %s\", \"Hi\", \"there\");   //  8 chars + null  \n    FormatOutput(\"%s %s\", \"Hi\", \"there!\");  //  9 chars + null  \n    FormatOutput(\"%s %s\", \"Hi\", \"there!!\"); // 10 chars + null  \n}  \n```  \n  \n```Output  \nnSize: 8, buff: Hi there  \nnSize: 9, buff: Hi there!  \nnSize: 10, buff: Hi there!  \n```  \n  \n## See Also  \n [Stream I/O](../../c-runtime-library/stream-i-o.md)   \n [vprintf Functions](../../c-runtime-library/vprintf-functions.md)   \n [Format Specification Syntax: printf and wprintf Functions](../../c-runtime-library/format-specification-syntax-printf-and-wprintf-functions.md)   \n [fprintf, _fprintf_l, fwprintf, _fwprintf_l](../../c-runtime-library/reference/fprintf-fprintf-l-fwprintf-fwprintf-l.md)   \n [printf, _printf_l, wprintf, _wprintf_l](../../c-runtime-library/reference/printf-printf-l-wprintf-wprintf-l.md)   \n [sprintf, _sprintf_l, swprintf, _swprintf_l, \\__swprintf_l](../../c-runtime-library/reference/sprintf-sprintf-l-swprintf-swprintf-l-swprintf-l.md)   \n [va_arg, va_copy, va_end, va_start](../../c-runtime-library/reference/va-arg-va-copy-va-end-va-start.md)"}