{"nodes":[{"pos":[12,71],"content":"Providing Mouse Interaction While Inactive | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Providing Mouse Interaction While Inactive | Microsoft Docs","pos":[0,59]}]},{"content":"Providing Mouse Interaction While Inactive","pos":[620,662]},{"content":"If your control is not immediately activated, you may still want it to process <ph id=\"ph1\">`WM_SETCURSOR`</ph> and <ph id=\"ph2\">`WM_MOUSEMOVE`</ph> messages, even though the control has no window of its own.","pos":[663,835],"source":"If your control is not immediately activated, you may still want it to process `WM_SETCURSOR` and `WM_MOUSEMOVE` messages, even though the control has no window of its own."},{"content":"This can be accomplished by enabling <ph id=\"ph1\">`COleControl`</ph>'s implementation of the <ph id=\"ph2\">`IPointerInactive`</ph> interface, which is disabled by default.","pos":[836,970],"source":" This can be accomplished by enabling `COleControl`'s implementation of the `IPointerInactive` interface, which is disabled by default."},{"content":"(See the <bpt id=\"p1\">*</bpt>ActiveX SDK<ept id=\"p1\">*</ept> for a description of this interface.) To enable it, include the <ph id=\"ph1\">`pointerInactive`</ph> flag in the set of flags returned by <bpt id=\"p2\">[</bpt>COleControl::GetControlFlags<ept id=\"p2\">](../mfc/reference/colecontrol-class.md#colecontrol__getcontrolflags)</ept>:","pos":[971,1212],"source":" (See the *ActiveX SDK* for a description of this interface.) To enable it, include the `pointerInactive` flag in the set of flags returned by [COleControl::GetControlFlags](../mfc/reference/colecontrol-class.md#colecontrol__getcontrolflags):"},{"content":"NVC_MFC_AxOpt#5","pos":[1230,1245]},{"content":"NVC_MFC_AxOpt#10","pos":[1334,1350]},{"content":"NVC_MFC_AxOpt#7","pos":[1439,1454]},{"pos":[1536,1827],"content":"The code to include this flag is automatically generated if you select the <bpt id=\"p1\">**</bpt>Mouse Pointer Notifications When Inactive<ept id=\"p1\">**</ept> option on the <bpt id=\"p2\">[</bpt>Control Settings<ept id=\"p2\">](../mfc/reference/control-settings-mfc-activex-control-wizard.md)</ept> page when creating your control with the <bpt id=\"p3\">**</bpt>MFC ActiveX Control Wizard<ept id=\"p3\">**</ept>.","source":"The code to include this flag is automatically generated if you select the **Mouse Pointer Notifications When Inactive** option on the [Control Settings](../mfc/reference/control-settings-mfc-activex-control-wizard.md) page when creating your control with the **MFC ActiveX Control Wizard**."},{"content":"When the <ph id=\"ph1\">`IPointerInactive`</ph> interface is enabled, the container delegates <ph id=\"ph2\">`WM_SETCURSOR`</ph> and <ph id=\"ph3\">`WM_MOUSEMOVE`</ph> messages to it.","pos":[1834,1957],"source":"When the `IPointerInactive` interface is enabled, the container delegates `WM_SETCURSOR` and `WM_MOUSEMOVE` messages to it."},{"content":"'s implementation of <ph id=\"ph1\">`IPointerInactive`</ph> dispatches the messages through your control's message map after adjusting the mouse coordinates appropriately.","pos":[1971,2122],"source":"'s implementation of `IPointerInactive` dispatches the messages through your control's message map after adjusting the mouse coordinates appropriately."},{"content":"You can process the messages just like ordinary window messages by adding the corresponding entries to the message map.","pos":[2123,2242]},{"content":"In your handlers for these messages, avoid using the <ph id=\"ph1\">`m_hWnd`</ph> member variable (or any member function that uses it) without first checking that its value is not <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[2243,2413],"source":" In your handlers for these messages, avoid using the `m_hWnd` member variable (or any member function that uses it) without first checking that its value is not **NULL**."},{"content":"You may also want an inactive control to be the target of an OLE drag-and-drop operation.","pos":[2420,2509]},{"content":"This requires activating the control at the moment the user drags an object over it, so that the control's window can be registered as a drop target.","pos":[2510,2659]},{"content":"To cause activation to occur during a drag, override <bpt id=\"p1\">[</bpt>COleControl::GetActivationPolicy<ept id=\"p1\">](../mfc/reference/colecontrol-class.md#colecontrol__getactivationpolicy)</ept>, and return the <bpt id=\"p2\">**</bpt>POINTERINACTIVE_ACTIVATEONDRAG<ept id=\"p2\">**</ept> flag:","pos":[2660,2876],"source":" To cause activation to occur during a drag, override [COleControl::GetActivationPolicy](../mfc/reference/colecontrol-class.md#colecontrol__getactivationpolicy), and return the **POINTERINACTIVE_ACTIVATEONDRAG** flag:"},{"pos":[2894,2910],"content":"NVC_MFC_AxOpt#11"},{"content":"Enabling the <ph id=\"ph1\">`IPointerInactive`</ph> interface typically means that you want the control to be capable of processing mouse messages at all times.","pos":[2992,3132],"source":"Enabling the `IPointerInactive` interface typically means that you want the control to be capable of processing mouse messages at all times."},{"content":"To get this behavior in a container that doesn't support the <ph id=\"ph1\">`IPointerInactive`</ph> interface, you need to have your control always activated when visible, which means the control should include the <bpt id=\"p1\">**</bpt>OLEMISC_ACTIVATEWHENVISIBLE<ept id=\"p1\">**</ept> flag among its miscellaneous flags.","pos":[3133,3395],"source":" To get this behavior in a container that doesn't support the `IPointerInactive` interface, you need to have your control always activated when visible, which means the control should include the **OLEMISC_ACTIVATEWHENVISIBLE** flag among its miscellaneous flags."},{"content":"However, to prevent this flag from taking effect in a container that does support <ph id=\"ph1\">`IPointerInactive`</ph>, you can also specify the <bpt id=\"p1\">**</bpt>OLEMISC_IGNOREACTIVATEWHENVISIBLE<ept id=\"p1\">**</ept> flag:","pos":[3396,3566],"source":" However, to prevent this flag from taking effect in a container that does support `IPointerInactive`, you can also specify the **OLEMISC_IGNOREACTIVATEWHENVISIBLE** flag:"},{"pos":[3584,3600],"content":"NVC_MFC_AxOpt#12"},{"content":"See Also","pos":[3684,3692]},{"content":"MFC ActiveX Controls: Optimization","pos":[3697,3731]}],"content":"---\ntitle: \"Providing Mouse Interaction While Inactive | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, mouse interaction\"\nms.assetid: b09106bf-44c7-4b9b-a6d9-0d624f16f5b3\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Providing Mouse Interaction While Inactive\nIf your control is not immediately activated, you may still want it to process `WM_SETCURSOR` and `WM_MOUSEMOVE` messages, even though the control has no window of its own. This can be accomplished by enabling `COleControl`'s implementation of the `IPointerInactive` interface, which is disabled by default. (See the *ActiveX SDK* for a description of this interface.) To enable it, include the `pointerInactive` flag in the set of flags returned by [COleControl::GetControlFlags](../mfc/reference/colecontrol-class.md#colecontrol__getcontrolflags):  \n  \n [!code-cpp[NVC_MFC_AxOpt#5](../mfc/codesnippet/cpp/providing-mouse-interaction-while-inactive_1.cpp)]  \n[!code-cpp[NVC_MFC_AxOpt#10](../mfc/codesnippet/cpp/providing-mouse-interaction-while-inactive_2.cpp)]  \n[!code-cpp[NVC_MFC_AxOpt#7](../mfc/codesnippet/cpp/providing-mouse-interaction-while-inactive_3.cpp)]  \n  \n The code to include this flag is automatically generated if you select the **Mouse Pointer Notifications When Inactive** option on the [Control Settings](../mfc/reference/control-settings-mfc-activex-control-wizard.md) page when creating your control with the **MFC ActiveX Control Wizard**.  \n  \n When the `IPointerInactive` interface is enabled, the container delegates `WM_SETCURSOR` and `WM_MOUSEMOVE` messages to it. `COleControl`'s implementation of `IPointerInactive` dispatches the messages through your control's message map after adjusting the mouse coordinates appropriately. You can process the messages just like ordinary window messages by adding the corresponding entries to the message map. In your handlers for these messages, avoid using the `m_hWnd` member variable (or any member function that uses it) without first checking that its value is not **NULL**.  \n  \n You may also want an inactive control to be the target of an OLE drag-and-drop operation. This requires activating the control at the moment the user drags an object over it, so that the control's window can be registered as a drop target. To cause activation to occur during a drag, override [COleControl::GetActivationPolicy](../mfc/reference/colecontrol-class.md#colecontrol__getactivationpolicy), and return the **POINTERINACTIVE_ACTIVATEONDRAG** flag:  \n  \n [!code-cpp[NVC_MFC_AxOpt#11](../mfc/codesnippet/cpp/providing-mouse-interaction-while-inactive_4.cpp)]  \n  \n Enabling the `IPointerInactive` interface typically means that you want the control to be capable of processing mouse messages at all times. To get this behavior in a container that doesn't support the `IPointerInactive` interface, you need to have your control always activated when visible, which means the control should include the **OLEMISC_ACTIVATEWHENVISIBLE** flag among its miscellaneous flags. However, to prevent this flag from taking effect in a container that does support `IPointerInactive`, you can also specify the **OLEMISC_IGNOREACTIVATEWHENVISIBLE** flag:  \n  \n [!code-cpp[NVC_MFC_AxOpt#12](../mfc/codesnippet/cpp/providing-mouse-interaction-while-inactive_5.cpp)]  \n  \n## See Also  \n [MFC ActiveX Controls: Optimization](../mfc/mfc-activex-controls-optimization.md)\n\n"}