{"nodes":[{"pos":[12,64],"content":"Using ADO Databinding in Visual C++ | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Using ADO Databinding in Visual C++ | Microsoft Docs","pos":[0,52]}]},{"content":"Using ADO Databinding in Visual C++","pos":[720,755]},{"content":"Using ADO databinding in Visual C++ requires the following steps:","pos":[756,821]},{"content":"Add an ADO data control.","pos":[831,855]},{"content":"Point to a data source.","pos":[865,888]},{"content":"Specify the record source (SQL query or data retrieval language).","pos":[898,963]},{"content":"Add an ADO data-bound control.","pos":[973,1003]},{"content":"Connect the data-bound control to an ADO data control.","pos":[1013,1067]},{"content":"Select the fields to bind to the ADO data control's record source.","pos":[1077,1143]},{"content":"To use ADO databinding in Visual C++","pos":[1153,1189]},{"content":"Create an MFC dialog application or MFC Formview application using the MFC Application Wizard.","pos":[1199,1293]},{"pos":[1303,1490],"content":"Add the Microsoft ADO data control to the dialog box; see <bpt id=\"p1\">[</bpt>Inserting the Control into a Visual C++ Application<ept id=\"p1\">](../../data/ado-rdo/inserting-the-control-into-a-visual-cpp-application.md)</ept>.","source":"Add the Microsoft ADO data control to the dialog box; see [Inserting the Control into a Visual C++ Application](../../data/ado-rdo/inserting-the-control-into-a-visual-cpp-application.md)."},{"content":"Point the ADO data control to your OLE DB data source.","pos":[1500,1554]},{"pos":[1568,1632],"content":"Right-click the ADO data control, and then click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","source":"Right-click the ADO data control, and then click **Properties**."},{"content":"On the <bpt id=\"p1\">**</bpt>Control<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>Use Connection String<ept id=\"p2\">**</ept>.","pos":[1646,1702],"source":"On the **Control** tab, click **Use Connection String**."},{"content":"You can use the supplied provider or you can delete it.","pos":[1703,1758]},{"content":"Click <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept>.","pos":[1772,1788],"source":"Click **Build**."},{"content":"If you deleted the provider from <bpt id=\"p1\">**</bpt>Use Connection String<ept id=\"p1\">**</ept>, you are now able to define one.","pos":[1789,1880],"source":" If you deleted the provider from **Use Connection String**, you are now able to define one."},{"content":"After you define the provider, access the properties of the ADO data control again, and then select <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> again to continue.","pos":[1881,2009],"source":" After you define the provider, access the properties of the ADO data control again, and then select **Build** again to continue."},{"content":"If a provider is defined in <bpt id=\"p1\">**</bpt>Use Connection String<ept id=\"p1\">**</ept> before you select <bpt id=\"p2\">**</bpt>Build<ept id=\"p2\">**</ept>, you are able to define the data link properties.","pos":[2024,2155],"source":"If a provider is defined in **Use Connection String** before you select **Build**, you are able to define the data link properties."},{"content":"This displays the DataLink Wizard.","pos":[2156,2190]},{"content":"Change the <bpt id=\"p1\">**</bpt>Provider<ept id=\"p1\">**</ept> if necessary, and define <bpt id=\"p2\">**</bpt>Location<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Data Source<ept id=\"p3\">**</ept> values, as appropriate for your provider.","pos":[2204,2327],"source":"Change the **Provider** if necessary, and define **Location** and **Data Source** values, as appropriate for your provider."},{"content":"For example, if you are using a SQL Server provider, <bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept> specifies the database server and <bpt id=\"p2\">**</bpt>Data Source<ept id=\"p2\">**</ept> specifies the database.","pos":[2328,2467],"source":" For example, if you are using a SQL Server provider, **Location** specifies the database server and **Data Source** specifies the database."},{"content":"If you are using an ODBC provider, the <bpt id=\"p1\">**</bpt>Data Source<ept id=\"p1\">**</ept> corresponds to the ODBC DSN.","pos":[2468,2551],"source":" If you are using an ODBC provider, the **Data Source** corresponds to the ODBC DSN."},{"pos":[2565,2686],"content":"Click the <bpt id=\"p1\">**</bpt>Authentication<ept id=\"p1\">**</ept> tab, and then set values for <bpt id=\"p2\">**</bpt>User Name<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Password<ept id=\"p3\">**</ept>, if required by the data source.","source":"Click the **Authentication** tab, and then set values for **User Name** and **Password**, if required by the data source."},{"content":"Click the <bpt id=\"p1\">**</bpt>Connection<ept id=\"p1\">**</ept> tab, and then click <bpt id=\"p2\">**</bpt>Test Connection<ept id=\"p2\">**</ept> to test the data source.","pos":[2700,2789],"source":"Click the **Connection** tab, and then click **Test Connection** to test the data source."},{"content":"Scroll to the end of the Results window to see if the test passed.","pos":[2790,2856]},{"content":"If it failed, check the configuration of your data source.","pos":[2857,2915]},{"content":"Common errors include invalid passwords and incorrect values for the <bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Data Source<ept id=\"p2\">**</ept> fields.","pos":[2916,3025],"source":" Common errors include invalid passwords and incorrect values for the **Location** and **Data Source** fields."},{"content":"Exit the DataLink Wizard and return to the property sheet for the ADO data control.","pos":[3039,3122]},{"content":"On the <ph id=\"ph1\">`RecordSource`</ph> tab, enter a query into <bpt id=\"p1\">**</bpt>Command Text (SQL)<ept id=\"p1\">**</ept>.","pos":[3132,3201],"source":"On the `RecordSource` tab, enter a query into **Command Text (SQL)**."},{"content":"The data-bound controls can bind to the results of this query.","pos":[3202,3264]},{"content":"The query is usually SQL.","pos":[3265,3290]},{"content":"However, some OLE DB providers do not use SQL.","pos":[3291,3337]},{"content":"Set any other ADO data control properties as needed and close the property sheet for the ADO data control.","pos":[3347,3453]},{"content":"Add a data-bound control.","pos":[3463,3488]},{"content":"For example, add the DataGrid control, which is different from the RDO DBGrid control.)","pos":[3489,3576]},{"content":"Set the DataGrid's properties.","pos":[3586,3616]},{"pos":[3630,3686],"content":"Right-click the DataGrid, and then click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","source":"Right-click the DataGrid, and then click **Properties**."},{"content":"Click the <bpt id=\"p1\">**</bpt>All<ept id=\"p1\">**</ept> tab, and then set the <bpt id=\"p2\">**</bpt>DataSource<ept id=\"p2\">**</ept> property to the ADO data control.","pos":[3700,3788],"source":"Click the **All** tab, and then set the **DataSource** property to the ADO data control."},{"content":"Click the <bpt id=\"p1\">**</bpt>DataSource<ept id=\"p1\">**</ept> drop-down list and find the ID of the ADO data control.","pos":[3789,3869],"source":" Click the **DataSource** drop-down list and find the ID of the ADO data control."},{"content":"The default ID name is IDC_ADODC1.","pos":[3870,3904]},{"content":"To run in test mode, press CTRL+T.","pos":[3914,3948]},{"content":"You are able to scroll through the data.","pos":[3949,3989]},{"content":"Press the Esc key or close the dialog box to end test mode.","pos":[3990,4049]},{"content":"If you compile and run the program, you are able to scroll through the data as well.","pos":[4056,4140]},{"content":"See Also","pos":[4149,4157]},{"content":"ADO Databinding","pos":[4162,4177]},{"content":"Databinding with ActiveX Controls in Visual C++","pos":[4223,4270]}],"content":"---\ntitle: \"Using ADO Databinding in Visual C++ | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"bound controls [C++], ADO\"\n  - \"ADO [C++], data binding\"\n  - \"data binding [C++], RDO\"\n  - \"data binding [C++], ADO\"\n  - \"bound controls [C++], RDO\"\nms.assetid: ad193919-3437-41ee-b41c-9d353f6274e5\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Using ADO Databinding in Visual C++\nUsing ADO databinding in Visual C++ requires the following steps:  \n  \n-   Add an ADO data control.  \n  \n-   Point to a data source.  \n  \n-   Specify the record source (SQL query or data retrieval language).  \n  \n-   Add an ADO data-bound control.  \n  \n-   Connect the data-bound control to an ADO data control.  \n  \n-   Select the fields to bind to the ADO data control's record source.  \n  \n### To use ADO databinding in Visual C++  \n  \n1.  Create an MFC dialog application or MFC Formview application using the MFC Application Wizard.  \n  \n2.  Add the Microsoft ADO data control to the dialog box; see [Inserting the Control into a Visual C++ Application](../../data/ado-rdo/inserting-the-control-into-a-visual-cpp-application.md).  \n  \n3.  Point the ADO data control to your OLE DB data source.  \n  \n    1.  Right-click the ADO data control, and then click **Properties**.  \n  \n    2.  On the **Control** tab, click **Use Connection String**. You can use the supplied provider or you can delete it.  \n  \n    3.  Click **Build**. If you deleted the provider from **Use Connection String**, you are now able to define one. After you define the provider, access the properties of the ADO data control again, and then select **Build** again to continue.  \n  \n         If a provider is defined in **Use Connection String** before you select **Build**, you are able to define the data link properties. This displays the DataLink Wizard.  \n  \n    4.  Change the **Provider** if necessary, and define **Location** and **Data Source** values, as appropriate for your provider. For example, if you are using a SQL Server provider, **Location** specifies the database server and **Data Source** specifies the database. If you are using an ODBC provider, the **Data Source** corresponds to the ODBC DSN.  \n  \n    5.  Click the **Authentication** tab, and then set values for **User Name** and **Password**, if required by the data source.  \n  \n    6.  Click the **Connection** tab, and then click **Test Connection** to test the data source. Scroll to the end of the Results window to see if the test passed. If it failed, check the configuration of your data source. Common errors include invalid passwords and incorrect values for the **Location** and **Data Source** fields.  \n  \n    7.  Exit the DataLink Wizard and return to the property sheet for the ADO data control.  \n  \n4.  On the `RecordSource` tab, enter a query into **Command Text (SQL)**. The data-bound controls can bind to the results of this query. The query is usually SQL. However, some OLE DB providers do not use SQL.  \n  \n5.  Set any other ADO data control properties as needed and close the property sheet for the ADO data control.  \n  \n6.  Add a data-bound control. For example, add the DataGrid control, which is different from the RDO DBGrid control.)  \n  \n7.  Set the DataGrid's properties.  \n  \n    1.  Right-click the DataGrid, and then click **Properties**.  \n  \n    2.  Click the **All** tab, and then set the **DataSource** property to the ADO data control. Click the **DataSource** drop-down list and find the ID of the ADO data control. The default ID name is IDC_ADODC1.  \n  \n8.  To run in test mode, press CTRL+T. You are able to scroll through the data. Press the Esc key or close the dialog box to end test mode.  \n  \n If you compile and run the program, you are able to scroll through the data as well.  \n  \n## See Also  \n [ADO Databinding](../../data/ado-rdo/ado-databinding.md)   \n [Databinding with ActiveX Controls in Visual C++](../../data/ado-rdo/databinding-with-activex-controls-in-visual-cpp.md)"}