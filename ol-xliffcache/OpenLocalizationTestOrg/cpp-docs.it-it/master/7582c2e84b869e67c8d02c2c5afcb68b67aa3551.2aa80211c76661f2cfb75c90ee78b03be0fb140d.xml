{"nodes":[{"pos":[12,50],"content":"CAnimationValue Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CAnimationValue Class | Microsoft Docs","pos":[0,38]}]},{"content":"CAnimationValue Class","pos":[664,685]},{"content":"Implements the functionality of animation object that has one value.","pos":[686,754]},{"content":"Syntax","pos":[763,769]},{"content":"Members","pos":[848,855]},{"content":"Public Constructors","pos":[865,884]},{"content":"Name","pos":[891,895]},{"content":"Description","pos":[896,907]},{"content":"CAnimationValue::CAnimationValue","pos":[946,978]},{"content":"Overloaded.","pos":[1015,1026]},{"content":"Constructs a CAnimationValue object.","pos":[1027,1063]},{"content":"Public Methods","pos":[1074,1088]},{"content":"Name","pos":[1095,1099]},{"content":"Description","pos":[1100,1111]},{"content":"CAnimationValue::AddTransition","pos":[1150,1180]},{"content":"Adds a transition to be applied to a value.","pos":[1215,1258]},{"content":"CAnimationValue::GetValue","pos":[1264,1289]},{"content":"Overloaded.","pos":[1319,1330]},{"content":"Retrieves the current value.","pos":[1331,1359]},{"content":"CAnimationValue::GetVariable","pos":[1365,1393]},{"content":"Provides access to encapsulated animation variable.","pos":[1426,1477]},{"content":"CAnimationValue::SetDefaultValue","pos":[1483,1515]},{"content":"Sets default value.","pos":[1552,1571]},{"content":"Protected Methods","pos":[1582,1599]},{"content":"Name","pos":[1606,1610]},{"content":"Description","pos":[1611,1622]},{"content":"CAnimationValue::GetAnimationVariableList","pos":[1661,1702]},{"content":"Puts the encapsulated animation variable into a list.","pos":[1748,1801]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CAnimationBaseObject::GetAnimationVariableList<ept id=\"p1\">](../../mfc/reference/canimationbaseobject-class.md#canimationbaseobject__getanimationvariablelist)</ept>.)","pos":[1802,1961],"source":" (Overrides [CAnimationBaseObject::GetAnimationVariableList](../../mfc/reference/canimationbaseobject-class.md#canimationbaseobject__getanimationvariablelist).)"},{"content":"Public Operators","pos":[1972,1988]},{"content":"Name","pos":[1995,1999]},{"content":"Description","pos":[2000,2011]},{"content":"CAnimationValue::operator DOUBLE","pos":[2050,2082]},{"content":"Provides conversion between CAnimationValue and DOUBLE.","pos":[2119,2174]},{"content":"CAnimationValue::operator INT32","pos":[2180,2211]},{"content":"Provides conversion between CAnimationValue and INT32.","pos":[2247,2301]},{"content":"CAnimationValue::operator=","pos":[2307,2333]},{"content":"Overloaded.","pos":[2366,2377]},{"content":"Assigns an INT32 value to CAnimationValue.","pos":[2378,2420]},{"content":"Protected Data Members","pos":[2431,2453]},{"content":"Name","pos":[2460,2464]},{"content":"Description","pos":[2465,2476]},{"content":"CAnimationValue::m_value","pos":[2515,2539]},{"content":"The encapsulated animation variable that represents animation value.","pos":[2568,2636]},{"content":"Remarks","pos":[2646,2653]},{"content":"The CAnimationValue class encapsulates a single CAnimationVariable object and can represent in applications a single animated value.","pos":[2657,2789]},{"content":"For example, you can use this class for animated transparency (fade effect), angle (to rotate objects), or for any other case when you need to create an animation depending on a single animated value.","pos":[2790,2990]},{"content":"To use this class in application, just instantiate an object of this class, add it to animation controller using CAnimationController::AddAnimationObject and call AddTransition for each transition to be applied to the value.","pos":[2991,3215]},{"content":"Inheritance Hierarchy","pos":[3224,3245]},{"content":"CObject","pos":[3250,3257]},{"content":"CAnimationBaseObject","pos":[3304,3324]},{"content":"CAnimationValue","pos":[3384,3399]},{"content":"Requirements","pos":[3455,3467]},{"pos":[3471,3507],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxanimationcontroller.h","source":"**Header:** afxanimationcontroller.h"},{"pos":[3564,3594],"content":"CAnimationValue::AddTransition"},{"content":"Adds a transition to be applied to a value.","pos":[3598,3641]},{"content":"Parameters","pos":[3716,3726]},{"content":"A pointer to transition object.","pos":[3747,3778]},{"content":"Remarks","pos":[3788,3795]},{"content":"Call this function to add a transition to internal list of transitions to be applied to an animation variable.","pos":[3799,3909]},{"content":"When you add transitions, they are not applied immediately and stored in an internal list.","pos":[3910,4000]},{"content":"Transitions are applied (added to a storyboard for a particular value) when you call CAnimationController::AnimateGroup.","pos":[4001,4121]},{"pos":[4180,4212],"content":"CAnimationValue::CAnimationValue"},{"content":"Constructs a CAnimationValue object.","pos":[4216,4252]},{"content":"Parameters","pos":[4433,4443]},{"content":"Specifies default value.","pos":[4468,4492]},{"content":"Specifies Group ID.","pos":[4513,4532]},{"content":"Specifies Object ID.","pos":[4554,4574]},{"content":"specifies user-defined data.","pos":[4597,4625]},{"content":"Remarks","pos":[4635,4642]},{"content":"Constructs CAnimationValue object with default properties: default value, Group ID and Object ID are set to 0.","pos":[4646,4756]},{"pos":[4824,4865],"content":"CAnimationValue::GetAnimationVariableList"},{"content":"Puts the encapsulated animation variable into a list.","pos":[4869,4922]},{"content":"Parameters","pos":[5050,5060]},{"content":"When the function returns, it contains a pointer to CAnimationVariable representing the animated value.","pos":[5073,5176]},{"pos":[5228,5253],"content":"CAnimationValue::GetValue"},{"content":"Retrieves the current value.","pos":[5257,5285]},{"content":"Parameters","pos":[5376,5386]},{"content":"Output.","pos":[5404,5411]},{"content":"When the function returns it contains a current value of animation variable.","pos":[5412,5488]},{"content":"Output.","pos":[5507,5514]},{"content":"When the function returns it contains a current value of animation variable.","pos":[5515,5591]},{"content":"Return Value","pos":[5601,5613]},{"content":"TRUE if the current value was retrieved successfully; otherwise FALSE.","pos":[5617,5687]},{"content":"Remarks","pos":[5697,5704]},{"content":"Call this function to retrieve the current value.","pos":[5708,5757]},{"content":"This implementation calls the encapsulated COM object, and if the call fails, this method returns the default value that was previously set in constructor or with SetDefaultValue.","pos":[5758,5937]},{"pos":[5992,6020],"content":"CAnimationValue::GetVariable"},{"content":"Provides access to encapsulated animation variable.","pos":[6024,6075]},{"content":"Return Value","pos":[6135,6147]},{"content":"A reference to encapsulated animation variable.","pos":[6151,6198]},{"content":"Remarks","pos":[6208,6215]},{"content":"Use this method to access the encapsulated animation variable.","pos":[6219,6281]},{"content":"From CAnimationVariable you get access to underlying IUIAnimationVariable object, whose pointer can be NULL if animation variable has not been created.","pos":[6282,6433]},{"pos":[6484,6508],"content":"CAnimationValue::m_value"},{"content":"The encapsulated animation variable that represents animation value.","pos":[6512,6580]},{"pos":[6684,6716],"content":"CAnimationValue::operator DOUBLE"},{"content":"Provides conversion between CAnimationValue and DOUBLE.","pos":[6720,6775]},{"content":"Return Value","pos":[6820,6832]},{"content":"Current value of Animation Value.","pos":[6836,6869]},{"content":"Remarks","pos":[6879,6886]},{"content":"Provides conversion between CAnimationValue and DOUBLE.","pos":[6890,6945]},{"content":"This method internally calls GetValue and doesn't check for errors.","pos":[6946,7013]},{"content":"If GetValue fails, the returned value will contain a default value previously set in constructor or with SetDefaultValue.","pos":[7014,7135]},{"pos":[7193,7224],"content":"CAnimationValue::operator INT32"},{"content":"Provides conversion between CAnimationValue and INT32.","pos":[7228,7282]},{"content":"Return Value","pos":[7326,7338]},{"content":"Current value of Animation Value as integer.","pos":[7342,7386]},{"content":"Remarks","pos":[7396,7403]},{"content":"Provides conversion between CAnimationValue and INT32.","pos":[7407,7461]},{"content":"This method internally calls GetValue and doesn't check for errors.","pos":[7462,7529]},{"content":"If GetValue fails, the returned value will contain a default value previously set in constructor or with SetDefaultValue.","pos":[7530,7651]},{"pos":[7706,7732],"content":"CAnimationValue::operator="},{"content":"Assigns a DOUBLE value to CAnimationValue.","pos":[7736,7778]},{"content":"Parameters","pos":[7865,7875]},{"content":"Specifies the value to be assigned to Animation Value.","pos":[7891,7945]},{"content":"Specifies the value to be assigned to Animation Value.","pos":[7962,8016]},{"content":"Remarks","pos":[8026,8033]},{"content":"Assigns a DOUBLE value to CAnimationValue.","pos":[8037,8079]},{"content":"This value is set as a default value for encapsulated animation variable.","pos":[8080,8153]},{"content":"If you subscribed this animation object to events (ValueChanged or IntegerValueChanged), you need to re-enable these events.","pos":[8154,8278]},{"pos":[8337,8369],"content":"CAnimationValue::SetDefaultValue"},{"content":"Sets default value.","pos":[8373,8392]},{"content":"Parameters","pos":[8463,8473]},{"content":"Specifies the default value.","pos":[8498,8526]},{"content":"Remarks","pos":[8536,8543]},{"content":"Use this method to set a default value.","pos":[8547,8586]},{"content":"A default value is returned to application when animation has not been started and/or underlying COM object has not been created.","pos":[8587,8716]},{"content":"If the underlying COM object encapsulated in CAnimationVarible was already created, this method recreates it, therefore you might need to call EnableValueChanged/EnableIntegerValueChanged methods again.","pos":[8717,8919]},{"content":"See Also","pos":[8928,8936]},{"content":"Classes","pos":[8941,8948]}],"content":"---\ntitle: \"CAnimationValue Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"afxanimationcontroller/CAnimationValue\"\n  - \"CAnimationValue\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CAnimationValue class\"\nms.assetid: 78c5ae19-ede5-4f20-bfbe-68b467b603c2\ncaps.latest.revision: 17\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CAnimationValue Class\nImplements the functionality of animation object that has one value.  \n  \n## Syntax  \n  \n```  \nclass CAnimationValue : public CAnimationBaseObject;  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAnimationValue::CAnimationValue](#canimationvalue__canimationvalue)|Overloaded. Constructs a CAnimationValue object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAnimationValue::AddTransition](#canimationvalue__addtransition)|Adds a transition to be applied to a value.|  \n|[CAnimationValue::GetValue](#canimationvalue__getvalue)|Overloaded. Retrieves the current value.|  \n|[CAnimationValue::GetVariable](#canimationvalue__getvariable)|Provides access to encapsulated animation variable.|  \n|[CAnimationValue::SetDefaultValue](#canimationvalue__setdefaultvalue)|Sets default value.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAnimationValue::GetAnimationVariableList](#canimationvalue__getanimationvariablelist)|Puts the encapsulated animation variable into a list. (Overrides [CAnimationBaseObject::GetAnimationVariableList](../../mfc/reference/canimationbaseobject-class.md#canimationbaseobject__getanimationvariablelist).)|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAnimationValue::operator DOUBLE](#canimationvalue__operator_double)|Provides conversion between CAnimationValue and DOUBLE.|  \n|[CAnimationValue::operator INT32](#canimationvalue__operator_int32)|Provides conversion between CAnimationValue and INT32.|  \n|[CAnimationValue::operator=](#canimationvalue__operator_eq)|Overloaded. Assigns an INT32 value to CAnimationValue.|  \n  \n### Protected Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CAnimationValue::m_value](#canimationvalue__m_value)|The encapsulated animation variable that represents animation value.|  \n  \n## Remarks  \n The CAnimationValue class encapsulates a single CAnimationVariable object and can represent in applications a single animated value. For example, you can use this class for animated transparency (fade effect), angle (to rotate objects), or for any other case when you need to create an animation depending on a single animated value. To use this class in application, just instantiate an object of this class, add it to animation controller using CAnimationController::AddAnimationObject and call AddTransition for each transition to be applied to the value.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CAnimationBaseObject](../../mfc/reference/canimationbaseobject-class.md)  \n  \n [CAnimationValue](../../mfc/reference/canimationvalue-class.md)  \n  \n## Requirements  \n **Header:** afxanimationcontroller.h  \n  \n##  <a name=\"canimationvalue__addtransition\"></a>  CAnimationValue::AddTransition  \n Adds a transition to be applied to a value.  \n  \n```  \nvoid AddTransition(CBaseTransition* pTransition);\n```  \n  \n### Parameters  \n `pTransition`  \n A pointer to transition object.  \n  \n### Remarks  \n Call this function to add a transition to internal list of transitions to be applied to an animation variable. When you add transitions, they are not applied immediately and stored in an internal list. Transitions are applied (added to a storyboard for a particular value) when you call CAnimationController::AnimateGroup.  \n  \n##  <a name=\"canimationvalue__canimationvalue\"></a>  CAnimationValue::CAnimationValue  \n Constructs a CAnimationValue object.  \n  \n```  \nCAnimationValue();\n\n \nCAnimationValue(\n    DOUBLE dblDefaultValue,  \n    UINT32 nGroupID,  \n    UINT32 nObjectID = (UINT32)-1,  \n    DWORD dwUserData = 0);\n```  \n  \n### Parameters  \n `dblDefaultValue`  \n Specifies default value.  \n  \n `nGroupID`  \n Specifies Group ID.  \n  \n `nObjectID`  \n Specifies Object ID.  \n  \n `dwUserData`  \n specifies user-defined data.  \n  \n### Remarks  \n Constructs CAnimationValue object with default properties: default value, Group ID and Object ID are set to 0.  \n  \n##  <a name=\"canimationvalue__getanimationvariablelist\"></a>  CAnimationValue::GetAnimationVariableList  \n Puts the encapsulated animation variable into a list.  \n  \n```  \nvirtual void GetAnimationVariableList(\n    CList<CAnimationVariable*, \n    CAnimationVariable*>& lst);\n```  \n  \n### Parameters  \n `lst`  \n When the function returns, it contains a pointer to CAnimationVariable representing the animated value.  \n  \n##  <a name=\"canimationvalue__getvalue\"></a>  CAnimationValue::GetValue  \n Retrieves the current value.  \n  \n```  \nBOOL GetValue(DOUBLE& dblValue);\n\n \nBOOL GetValue(INT32& nValue);\n```  \n  \n### Parameters  \n `dblValue`  \n Output. When the function returns it contains a current value of animation variable.  \n  \n `nValue`  \n Output. When the function returns it contains a current value of animation variable.  \n  \n### Return Value  \n TRUE if the current value was retrieved successfully; otherwise FALSE.  \n  \n### Remarks  \n Call this function to retrieve the current value. This implementation calls the encapsulated COM object, and if the call fails, this method returns the default value that was previously set in constructor or with SetDefaultValue.  \n  \n##  <a name=\"canimationvalue__getvariable\"></a>  CAnimationValue::GetVariable  \n Provides access to encapsulated animation variable.  \n  \n```  \nCAnimationVariable& GetVariable();\n```  \n  \n### Return Value  \n A reference to encapsulated animation variable.  \n  \n### Remarks  \n Use this method to access the encapsulated animation variable. From CAnimationVariable you get access to underlying IUIAnimationVariable object, whose pointer can be NULL if animation variable has not been created.  \n  \n##  <a name=\"canimationvalue__m_value\"></a>  CAnimationValue::m_value  \n The encapsulated animation variable that represents animation value.  \n  \n```  \nCAnimationVariable m_value;  \n```  \n  \n##  <a name=\"canimationvalue__operator_double\"></a>  CAnimationValue::operator DOUBLE  \n Provides conversion between CAnimationValue and DOUBLE.  \n  \n```  \noperator DOUBLE();\n```   \n  \n### Return Value  \n Current value of Animation Value.  \n  \n### Remarks  \n Provides conversion between CAnimationValue and DOUBLE. This method internally calls GetValue and doesn't check for errors. If GetValue fails, the returned value will contain a default value previously set in constructor or with SetDefaultValue.  \n  \n##  <a name=\"canimationvalue__operator_int32\"></a>  CAnimationValue::operator INT32  \n Provides conversion between CAnimationValue and INT32.  \n  \n```  \noperator INT32();\n```   \n  \n### Return Value  \n Current value of Animation Value as integer.  \n  \n### Remarks  \n Provides conversion between CAnimationValue and INT32. This method internally calls GetValue and doesn't check for errors. If GetValue fails, the returned value will contain a default value previously set in constructor or with SetDefaultValue.  \n  \n##  <a name=\"canimationvalue__operator_eq\"></a>  CAnimationValue::operator=  \n Assigns a DOUBLE value to CAnimationValue.  \n  \n```  \nvoid operator=(DOUBLE dblVal);\n\n \nvoid operator=(INT32 nVal);\n```  \n  \n### Parameters  \n `dblVal`  \n Specifies the value to be assigned to Animation Value.  \n  \n `nVal`  \n Specifies the value to be assigned to Animation Value.  \n  \n### Remarks  \n Assigns a DOUBLE value to CAnimationValue. This value is set as a default value for encapsulated animation variable. If you subscribed this animation object to events (ValueChanged or IntegerValueChanged), you need to re-enable these events.  \n  \n##  <a name=\"canimationvalue__setdefaultvalue\"></a>  CAnimationValue::SetDefaultValue  \n Sets default value.  \n  \n```  \nvoid SetDefaultValue(DOUBLE dblDefaultValue);\n```  \n  \n### Parameters  \n `dblDefaultValue`  \n Specifies the default value.  \n  \n### Remarks  \n Use this method to set a default value. A default value is returned to application when animation has not been started and/or underlying COM object has not been created. If the underlying COM object encapsulated in CAnimationVarible was already created, this method recreates it, therefore you might need to call EnableValueChanged/EnableIntegerValueChanged methods again.  \n  \n## See Also  \n [Classes](../../mfc/reference/mfc-classes.md)\n"}