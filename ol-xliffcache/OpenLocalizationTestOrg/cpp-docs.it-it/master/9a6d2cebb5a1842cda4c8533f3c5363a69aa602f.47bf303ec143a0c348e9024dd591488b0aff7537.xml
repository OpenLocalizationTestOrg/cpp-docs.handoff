{"nodes":[{"pos":[12,92],"content":"MFC ActiveX Controls: Adding Stock Events to an ActiveX Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Adding Stock Events to an ActiveX Control | Microsoft Docs","pos":[0,80]}]},{"content":"MFC ActiveX Controls: Adding Stock Events to an ActiveX Control","pos":[1664,1727]},{"content":"Stock events differ from custom events in that they are automatically fired by class <bpt id=\"p1\">[</bpt>COleControl<ept id=\"p1\">](../mfc/reference/colecontrol-class.md)</ept>.","pos":[1728,1866],"source":"Stock events differ from custom events in that they are automatically fired by class [COleControl](../mfc/reference/colecontrol-class.md)."},{"content":"contains predefined member functions that fire events resulting from common actions.","pos":[1881,1965]},{"content":"Some common actions implemented by <ph id=\"ph1\">`COleControl`</ph> include single- and double-clicks on the control, keyboard events, and changes in the state of the mouse buttons.","pos":[1966,2128],"source":" Some common actions implemented by `COleControl` include single- and double-clicks on the control, keyboard events, and changes in the state of the mouse buttons."},{"content":"Event map entries for stock events are always preceded by the <bpt id=\"p1\">**</bpt>EVENT_STOCK<ept id=\"p1\">**</ept> prefix.","pos":[2129,2214],"source":" Event map entries for stock events are always preceded by the **EVENT_STOCK** prefix."},{"pos":[2283,2329],"content":"Stock Events Supported by the Add Event Wizard"},{"content":"The <ph id=\"ph1\">`COleControl`</ph> class provides ten stock events, listed in the following table.","pos":[2333,2414],"source":"The `COleControl` class provides ten stock events, listed in the following table."},{"content":"You can specify the events you want in your control using the <bpt id=\"p1\">[</bpt>Add Event Wizard<ept id=\"p1\">](../ide/add-event-wizard.md)</ept>.","pos":[2415,2524],"source":" You can specify the events you want in your control using the [Add Event Wizard](../ide/add-event-wizard.md)."},{"content":"Stock Events","pos":[2534,2546]},{"content":"Event","pos":[2553,2558]},{"content":"Firing function","pos":[2559,2574]},{"content":"Comments","pos":[2575,2583]},{"content":"Click","pos":[2641,2646]},{"content":"void FireClick( )","pos":[2649,2666]},{"content":"Fired when the control captures the mouse, any <bpt id=\"p1\">**</bpt>BUTTONUP<ept id=\"p1\">**</ept> (left, middle, or right) message is received, and the button is released over the control.","pos":[2669,2819],"source":"Fired when the control captures the mouse, any **BUTTONUP** (left, middle, or right) message is received, and the button is released over the control."},{"content":"The stock MouseDown and MouseUp events occur before this event.","pos":[2820,2883]},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_CLICK( )<ept id=\"p1\">**</ept>","pos":[2896,2937],"source":" Event map entry: **EVENT_STOCK_CLICK( )**"},{"content":"DblClick","pos":[2942,2950]},{"content":"void FireDblClick( )","pos":[2953,2973]},{"content":"Similar to Click but fired when a <bpt id=\"p1\">**</bpt>BUTTONDBLCLK<ept id=\"p1\">**</ept> message is received.","pos":[2976,3047],"source":"Similar to Click but fired when a **BUTTONDBLCLK** message is received."},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_DBLCLICK( )<ept id=\"p1\">**</ept>","pos":[3060,3104],"source":" Event map entry: **EVENT_STOCK_DBLCLICK( )**"},{"content":"Error","pos":[3109,3114]},{"pos":[3115,3214],"content":"<bpt id=\"p1\">**</bpt>void FireError( SCODE<ept id=\"p1\">**</ept>  <bpt id=\"p2\">*</bpt>scode<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt>, LPCSTR<ept id=\"p3\">**</ept>  <ph id=\"ph1\">`lpszDescription`</ph> <bpt id=\"p4\">**</bpt>, UINT<ept id=\"p4\">**</ept>  <ph id=\"ph2\">`nHelpID`</ph>  <bpt id=\"p5\">**</bpt>= 0 )<ept id=\"p5\">**</ept>","source":"**void FireError( SCODE**  *scode* **, LPCSTR**  `lpszDescription` **, UINT**  `nHelpID`  **= 0 )**"},{"content":"Fired when an error occurs within your ActiveX control outside of the scope of a method call or property access.","pos":[3215,3327]},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_ERROREVENT( )<ept id=\"p1\">**</ept>","pos":[3340,3386],"source":" Event map entry: **EVENT_STOCK_ERROREVENT( )**"},{"content":"KeyDown","pos":[3391,3398]},{"pos":[3399,3469],"content":"<bpt id=\"p1\">**</bpt>void FireKeyDown( short<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`nChar`</ph> <bpt id=\"p2\">**</bpt>, short<ept id=\"p2\">**</ept>  <ph id=\"ph2\">`nShiftState`</ph>  <bpt id=\"p3\">**</bpt>)<ept id=\"p3\">**</ept>","source":"**void FireKeyDown( short**  `nChar` **, short**  `nShiftState`  **)**"},{"content":"Fired when a <ph id=\"ph1\">`WM_SYSKEYDOWN`</ph> or <ph id=\"ph2\">`WM_KEYDOWN`</ph> message is received.","pos":[3470,3535],"source":"Fired when a `WM_SYSKEYDOWN` or `WM_KEYDOWN` message is received."},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_KEYDOWN( )<ept id=\"p1\">**</ept>","pos":[3548,3591],"source":" Event map entry: **EVENT_STOCK_KEYDOWN( )**"},{"content":"KeyPress","pos":[3596,3604]},{"pos":[3605,3652],"content":"<bpt id=\"p1\">**</bpt>void FireKeyPress( short<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>  <ph id=\"ph2\">`pnChar`</ph>  <bpt id=\"p2\">**</bpt>)<ept id=\"p2\">**</ept>","source":"**void FireKeyPress( short\\***  `pnChar`  **)**"},{"content":"Fired when a <ph id=\"ph1\">`WM_CHAR`</ph> message is received.","pos":[3653,3696],"source":"Fired when a `WM_CHAR` message is received."},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_KEYPRESS( )<ept id=\"p1\">**</ept>","pos":[3709,3753],"source":" Event map entry: **EVENT_STOCK_KEYPRESS( )**"},{"content":"KeyUp","pos":[3758,3763]},{"pos":[3764,3832],"content":"<bpt id=\"p1\">**</bpt>void FireKeyUp( short<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`nChar`</ph> <bpt id=\"p2\">**</bpt>, short<ept id=\"p2\">**</ept>  <ph id=\"ph2\">`nShiftState`</ph>  <bpt id=\"p3\">**</bpt>)<ept id=\"p3\">**</ept>","source":"**void FireKeyUp( short**  `nChar` **, short**  `nShiftState`  **)**"},{"content":"Fired when a <ph id=\"ph1\">`WM_SYSKEYUP`</ph> or <ph id=\"ph2\">`WM_KEYUP`</ph> message is received.","pos":[3833,3894],"source":"Fired when a `WM_SYSKEYUP` or `WM_KEYUP` message is received."},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_KEYUP( )<ept id=\"p1\">**</ept>","pos":[3907,3948],"source":" Event map entry: **EVENT_STOCK_KEYUP( )**"},{"content":"MouseDown","pos":[3953,3962]},{"pos":[3963,4071],"content":"<bpt id=\"p1\">**</bpt>void FireMouseDown( short<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`nButton`</ph> <bpt id=\"p2\">**</bpt>, short<ept id=\"p2\">**</ept>  <ph id=\"ph2\">`nShiftState`</ph> <bpt id=\"p3\">**</bpt>, float<ept id=\"p3\">**</ept>  <bpt id=\"p4\">*</bpt>x<ept id=\"p4\">*</ept> <bpt id=\"p5\">**</bpt>, float<ept id=\"p5\">**</ept>  <bpt id=\"p6\">*</bpt>y<ept id=\"p6\">*</ept>  <bpt id=\"p7\">**</bpt>)<ept id=\"p7\">**</ept>","source":"**void FireMouseDown( short**  `nButton` **, short**  `nShiftState` **, float**  *x* **, float**  *y*  **)**"},{"content":"Fired if any <bpt id=\"p1\">**</bpt>BUTTONDOWN<ept id=\"p1\">**</ept> (left, middle, or right) is received.","pos":[4072,4137],"source":"Fired if any **BUTTONDOWN** (left, middle, or right) is received."},{"content":"The mouse is captured immediately before this event is fired.","pos":[4138,4199]},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_MOUSEDOWN( )<ept id=\"p1\">**</ept>","pos":[4212,4257],"source":" Event map entry: **EVENT_STOCK_MOUSEDOWN( )**"},{"content":"MouseMove","pos":[4262,4271]},{"pos":[4272,4380],"content":"<bpt id=\"p1\">**</bpt>void FireMouseMove( short<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`nButton`</ph> <bpt id=\"p2\">**</bpt>, short<ept id=\"p2\">**</ept>  <ph id=\"ph2\">`nShiftState`</ph> <bpt id=\"p3\">**</bpt>, float<ept id=\"p3\">**</ept>  <bpt id=\"p4\">*</bpt>x<ept id=\"p4\">*</ept> <bpt id=\"p5\">**</bpt>, float<ept id=\"p5\">**</ept>  <bpt id=\"p6\">*</bpt>y<ept id=\"p6\">*</ept>  <bpt id=\"p7\">**</bpt>)<ept id=\"p7\">**</ept>","source":"**void FireMouseMove( short**  `nButton` **, short**  `nShiftState` **, float**  *x* **, float**  *y*  **)**"},{"content":"Fired when a <ph id=\"ph1\">`WM_MOUSEMOVE`</ph> message is received.","pos":[4381,4429],"source":"Fired when a `WM_MOUSEMOVE` message is received."},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_MOUSEMOVE( )<ept id=\"p1\">**</ept>","pos":[4442,4487],"source":" Event map entry: **EVENT_STOCK_MOUSEMOVE( )**"},{"content":"MouseUp","pos":[4492,4499]},{"pos":[4500,4606],"content":"<bpt id=\"p1\">**</bpt>void FireMouseUp( short<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`nButton`</ph> <bpt id=\"p2\">**</bpt>, short<ept id=\"p2\">**</ept>  <ph id=\"ph2\">`nShiftState`</ph> <bpt id=\"p3\">**</bpt>, float<ept id=\"p3\">**</ept>  <bpt id=\"p4\">*</bpt>x<ept id=\"p4\">*</ept> <bpt id=\"p5\">**</bpt>, float<ept id=\"p5\">**</ept>  <bpt id=\"p6\">*</bpt>y<ept id=\"p6\">*</ept>  <bpt id=\"p7\">**</bpt>)<ept id=\"p7\">**</ept>","source":"**void FireMouseUp( short**  `nButton` **, short**  `nShiftState` **, float**  *x* **, float**  *y*  **)**"},{"content":"Fired if any <bpt id=\"p1\">**</bpt>BUTTONUP<ept id=\"p1\">**</ept> (left, middle, or right) is received.","pos":[4607,4670],"source":"Fired if any **BUTTONUP** (left, middle, or right) is received."},{"content":"The mouse capture is released before this event is fired.","pos":[4671,4728]},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_MOUSEUP( )<ept id=\"p1\">**</ept>","pos":[4741,4784],"source":" Event map entry: **EVENT_STOCK_MOUSEUP( )**"},{"content":"ReadyStateChange","pos":[4789,4805]},{"content":"void FireReadyStateChange( )","pos":[4808,4836]},{"content":"Fired when a control transitions to the next ready state due to the amount of data received.","pos":[4839,4931]},{"content":"Event map entry: <bpt id=\"p1\">**</bpt>EVENT_STOCK_READYSTATECHANGE( )<ept id=\"p1\">**</ept>","pos":[4944,4996],"source":" Event map entry: **EVENT_STOCK_READYSTATECHANGE( )**"},{"pos":[5067,5114],"content":"Adding a Stock Event Using the Add Event Wizard"},{"content":"Adding stock events requires less work than adding custom events because the firing of the actual event is handled automatically by the base class, <ph id=\"ph1\">`COleControl`</ph>.","pos":[5118,5280],"source":"Adding stock events requires less work than adding custom events because the firing of the actual event is handled automatically by the base class, `COleControl`."},{"content":"The following procedure adds a stock event to a control that was developed using <bpt id=\"p1\">[</bpt>MFC ActiveX Control Wizard<ept id=\"p1\">](../mfc/reference/mfc-activex-control-wizard.md)</ept>.","pos":[5281,5439],"source":" The following procedure adds a stock event to a control that was developed using [MFC ActiveX Control Wizard](../mfc/reference/mfc-activex-control-wizard.md)."},{"content":"The event, called KeyPress, fires when a key is pressed and the control is active.","pos":[5440,5522]},{"content":"This procedure can also be used to add other stock events.","pos":[5523,5581]},{"content":"Substitute the selected stock event name for KeyPress.","pos":[5582,5636]},{"content":"To add the KeyPress stock event using the Add Event Wizard","pos":[5647,5705]},{"content":"Load your control's project.","pos":[5715,5743]},{"content":"In Class View, right-click your ActiveX control class to open the shortcut menu.","pos":[5753,5833]},{"pos":[5843,5910],"content":"From the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Event<ept id=\"p2\">**</ept>.","source":"From the shortcut menu, click **Add** and then click **Add Event**."},{"content":"This opens the Add Event Wizard.","pos":[5921,5953]},{"pos":[5963,6019],"content":"In the <bpt id=\"p1\">**</bpt>Event Name<ept id=\"p1\">**</ept> drop-down list, select <ph id=\"ph1\">`KeyPress`</ph>.","source":"In the **Event Name** drop-down list, select `KeyPress`."},{"pos":[6029,6046],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Click **Finish**."},{"pos":[6114,6155],"content":"Add Event Wizard Changes for Stock Events"},{"content":"Because stock events are handled by the control's base class, the Add Event Wizard does not change your class declaration in any way.","pos":[6159,6292]},{"content":"It adds the event to the control's event map and makes an entry in its .IDL file.","pos":[6293,6374]},{"content":"The following line is added to the control's event map, located in the control class implementation (.CPP) file:","pos":[6375,6487]},{"pos":[6505,6519],"content":"NVC_MFC_AxUI#5"},{"content":"Adding this code fires a KeyPress event when a <ph id=\"ph1\">`WM_CHAR`</ph> message is received and the control is active.","pos":[6621,6724],"source":"Adding this code fires a KeyPress event when a `WM_CHAR` message is received and the control is active."},{"content":"The KeyPress event can be fired at other times by calling its firing function (for example, <ph id=\"ph1\">`FireKeyPress`</ph>) from within the control code.","pos":[6725,6862],"source":" The KeyPress event can be fired at other times by calling its firing function (for example, `FireKeyPress`) from within the control code."},{"content":"The Add Event Wizard adds the following line of code to the control's .IDL file:","pos":[6869,6949]},{"pos":[6967,6981],"content":"NVC_MFC_AxUI#6"},{"content":"This line associates the KeyPress event with its standard dispatch ID and allows the container to anticipate the KeyPress event.","pos":[7083,7211]},{"content":"See Also","pos":[7220,7228]},{"content":"MFC ActiveX Controls","pos":[7233,7253]},{"content":"MFC ActiveX Controls: Methods","pos":[7292,7321]},{"content":"COleControl Class","pos":[7368,7385]}],"content":"---\ntitle: \"MFC ActiveX Controls: Adding Stock Events to an ActiveX Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"EVENT__STOCK_ERROR\"\n  - \"EVENT__STOCK_READYSTATECHANGE\"\n  - \"ReadyStateChange\"\n  - \"EVENT__STOCK_MOUSEMOVE\"\n  - \"EVENT__STOCK_MOUSEUP\"\n  - \"EVENT__STOCK_DBLCLICK\"\n  - \"KeyPress\"\n  - \"EVENT__STOCK_KEYDOWN\"\n  - \"EVENT__STOCK\"\n  - \"EVENT__STOCK_MOUSEDOWN\"\n  - \"EVENT__STOCK_KEYPRESS\"\n  - \"EVENT__STOCK_CLICK\"\n  - \"EVENT__STOCK_KEYUP\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, events\"\n  - \"KeyPress event\"\n  - \"FireDblClick event\"\n  - \"FireMouseDown event\"\n  - \"events [C++], stock\"\n  - \"FireKeyPress event\"\n  - \"EVENT_STOCK_MOUSEMOVE event\"\n  - \"EVENT_STOCK_CLICK event\"\n  - \"FireClick event\"\n  - \"FireKeyUp event\"\n  - \"FireMouseUp event\"\n  - \"EVENT_STOCK_ERROREVENT event\"\n  - \"EVENT_STOCK_KEYDOWN event\"\n  - \"EVENT_STOCK_MOUSEDOWN event\"\n  - \"EVENT_STOCK_KEYPRESS macro\"\n  - \"EVENT_STOCK_KEYUP event\"\n  - \"EVENT_STOCK_DBLCLICK event\"\n  - \"FireError event\"\n  - \"FireKeyDown event\"\n  - \"ReadyStateChange event\"\n  - \"EVENT_STOCK_MOUSEUP event\"\n  - \"FireMouseMove event\"\n  - \"EVENT_STOCK prefix\"\n  - \"EVENT_STOCK_READYSTATECHANGE event\"\n  - \"EVENT_STOCK_KEYPRESS event\"\nms.assetid: 3eeadc67-4b3d-4444-8caa-53054073988a\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Adding Stock Events to an ActiveX Control\nStock events differ from custom events in that they are automatically fired by class [COleControl](../mfc/reference/colecontrol-class.md). `COleControl` contains predefined member functions that fire events resulting from common actions. Some common actions implemented by `COleControl` include single- and double-clicks on the control, keyboard events, and changes in the state of the mouse buttons. Event map entries for stock events are always preceded by the **EVENT_STOCK** prefix.  \n  \n##  <a name=\"_core_stock_events_supported_by_classwizard\"></a> Stock Events Supported by the Add Event Wizard  \n The `COleControl` class provides ten stock events, listed in the following table. You can specify the events you want in your control using the [Add Event Wizard](../ide/add-event-wizard.md).  \n  \n### Stock Events  \n  \n|Event|Firing function|Comments|  \n|-----------|---------------------|--------------|  \n|Click|**void FireClick( )**|Fired when the control captures the mouse, any **BUTTONUP** (left, middle, or right) message is received, and the button is released over the control. The stock MouseDown and MouseUp events occur before this event.<br /><br /> Event map entry: **EVENT_STOCK_CLICK( )**|  \n|DblClick|**void FireDblClick( )**|Similar to Click but fired when a **BUTTONDBLCLK** message is received.<br /><br /> Event map entry: **EVENT_STOCK_DBLCLICK( )**|  \n|Error|**void FireError( SCODE**  *scode* **, LPCSTR**  `lpszDescription` **, UINT**  `nHelpID`  **= 0 )**|Fired when an error occurs within your ActiveX control outside of the scope of a method call or property access.<br /><br /> Event map entry: **EVENT_STOCK_ERROREVENT( )**|  \n|KeyDown|**void FireKeyDown( short**  `nChar` **, short**  `nShiftState`  **)**|Fired when a `WM_SYSKEYDOWN` or `WM_KEYDOWN` message is received.<br /><br /> Event map entry: **EVENT_STOCK_KEYDOWN( )**|  \n|KeyPress|**void FireKeyPress( short\\***  `pnChar`  **)**|Fired when a `WM_CHAR` message is received.<br /><br /> Event map entry: **EVENT_STOCK_KEYPRESS( )**|  \n|KeyUp|**void FireKeyUp( short**  `nChar` **, short**  `nShiftState`  **)**|Fired when a `WM_SYSKEYUP` or `WM_KEYUP` message is received.<br /><br /> Event map entry: **EVENT_STOCK_KEYUP( )**|  \n|MouseDown|**void FireMouseDown( short**  `nButton` **, short**  `nShiftState` **, float**  *x* **, float**  *y*  **)**|Fired if any **BUTTONDOWN** (left, middle, or right) is received. The mouse is captured immediately before this event is fired.<br /><br /> Event map entry: **EVENT_STOCK_MOUSEDOWN( )**|  \n|MouseMove|**void FireMouseMove( short**  `nButton` **, short**  `nShiftState` **, float**  *x* **, float**  *y*  **)**|Fired when a `WM_MOUSEMOVE` message is received.<br /><br /> Event map entry: **EVENT_STOCK_MOUSEMOVE( )**|  \n|MouseUp|**void FireMouseUp( short**  `nButton` **, short**  `nShiftState` **, float**  *x* **, float**  *y*  **)**|Fired if any **BUTTONUP** (left, middle, or right) is received. The mouse capture is released before this event is fired.<br /><br /> Event map entry: **EVENT_STOCK_MOUSEUP( )**|  \n|ReadyStateChange|**void FireReadyStateChange( )**|Fired when a control transitions to the next ready state due to the amount of data received.<br /><br /> Event map entry: **EVENT_STOCK_READYSTATECHANGE( )**|  \n  \n##  <a name=\"_core_adding_a_stock_event_using_classwizard\"></a> Adding a Stock Event Using the Add Event Wizard  \n Adding stock events requires less work than adding custom events because the firing of the actual event is handled automatically by the base class, `COleControl`. The following procedure adds a stock event to a control that was developed using [MFC ActiveX Control Wizard](../mfc/reference/mfc-activex-control-wizard.md). The event, called KeyPress, fires when a key is pressed and the control is active. This procedure can also be used to add other stock events. Substitute the selected stock event name for KeyPress.  \n  \n#### To add the KeyPress stock event using the Add Event Wizard  \n  \n1.  Load your control's project.  \n  \n2.  In Class View, right-click your ActiveX control class to open the shortcut menu.  \n  \n3.  From the shortcut menu, click **Add** and then click **Add Event**.  \n  \n     This opens the Add Event Wizard.  \n  \n4.  In the **Event Name** drop-down list, select `KeyPress`.  \n  \n5.  Click **Finish**.  \n  \n##  <a name=\"_core_classwizard_changes_for_stock_events\"></a> Add Event Wizard Changes for Stock Events  \n Because stock events are handled by the control's base class, the Add Event Wizard does not change your class declaration in any way. It adds the event to the control's event map and makes an entry in its .IDL file. The following line is added to the control's event map, located in the control class implementation (.CPP) file:  \n  \n [!code-cpp[NVC_MFC_AxUI#5](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-events-to-an-activex-control_1.cpp)]  \n  \n Adding this code fires a KeyPress event when a `WM_CHAR` message is received and the control is active. The KeyPress event can be fired at other times by calling its firing function (for example, `FireKeyPress`) from within the control code.  \n  \n The Add Event Wizard adds the following line of code to the control's .IDL file:  \n  \n [!code-cpp[NVC_MFC_AxUI#6](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-events-to-an-activex-control_2.idl)]  \n  \n This line associates the KeyPress event with its standard dispatch ID and allows the container to anticipate the KeyPress event.  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)   \n [MFC ActiveX Controls: Methods](../mfc/mfc-activex-controls-methods.md)   \n [COleControl Class](../mfc/reference/colecontrol-class.md)\n"}