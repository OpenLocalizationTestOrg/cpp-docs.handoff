{"nodes":[{"pos":[12,50],"content":"CComCritSecLock Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComCritSecLock Class | Microsoft Docs","pos":[0,38]}]},{"pos":[739,760],"content":"CComCritSecLock Class","linkify":"CComCritSecLock Class","nodes":[{"content":"CComCritSecLock Class","pos":[0,21]}]},{"content":"This class provides methods for locking and unlocking a critical section object.","pos":[761,841]},{"pos":[850,856],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[924,934],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>TLock<ept id=\"p1\">*</ept>","pos":[938,945],"source":"*TLock*"},{"content":"The object to be locked and unlocked.","pos":[949,986]},{"pos":[995,1002],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1012,1031],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1038,1042]},{"content":"Description","pos":[1043,1054]},{"pos":[1092,1150],"content":"<bpt id=\"p1\">[</bpt>CComCritSecLock::CComCritSecLock<ept id=\"p1\">](#ccomcritseclock__ctor)</ept>","source":"[CComCritSecLock::CComCritSecLock](#ccomcritseclock__ctor)"},{"content":"The constructor.","pos":[1151,1167]},{"pos":[1172,1231],"content":"<bpt id=\"p1\">[</bpt>CComCritSecLock::~CComCritSecLock<ept id=\"p1\">](#ccomcritseclock__dtor)</ept>","source":"[CComCritSecLock::~CComCritSecLock](#ccomcritseclock__dtor)"},{"content":"The destructor.","pos":[1232,1247]},{"pos":[1258,1272],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1279,1283]},{"content":"Description","pos":[1284,1295]},{"pos":[1333,1380],"content":"<bpt id=\"p1\">[</bpt>CComCritSecLock::Lock<ept id=\"p1\">](#ccomcritseclock__lock)</ept>","source":"[CComCritSecLock::Lock](#ccomcritseclock__lock)"},{"content":"Call this method to lock the critical section object.","pos":[1381,1434]},{"pos":[1439,1490],"content":"<bpt id=\"p1\">[</bpt>CComCritSecLock::Unlock<ept id=\"p1\">](#ccomcritseclock__unlock)</ept>","source":"[CComCritSecLock::Unlock](#ccomcritseclock__unlock)"},{"content":"Call this method to unlock the critical section object.","pos":[1491,1546]},{"pos":[1556,1563],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[1567,1805],"content":"Use this class to lock and unlock objects in a safer way than with the <bpt id=\"p1\">[</bpt>CComCriticalSection Class<ept id=\"p1\">](../../atl/reference/ccomcriticalsection-class.md)</ept> or <bpt id=\"p2\">[</bpt>CComAutoCriticalSection Class<ept id=\"p2\">](../../atl/reference/ccomautocriticalsection-class.md)</ept>.","source":"Use this class to lock and unlock objects in a safer way than with the [CComCriticalSection Class](../../atl/reference/ccomcriticalsection-class.md) or [CComAutoCriticalSection Class](../../atl/reference/ccomautocriticalsection-class.md)."},{"pos":[1814,1826],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[1830,1851],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlbase.h","source":"**Header:** atlbase.h"},{"pos":[1861,1931],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcritseclock__ctor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCritSecLock::CComCritSecLock","linkify":"<a name=\"ccomcritseclock__ctor\"></a>  CComCritSecLock::CComCritSecLock","source":"<a name=\"ccomcritseclock__ctor\"></a>  CComCritSecLock::CComCritSecLock"},{"content":"The constructor.","pos":[1935,1951]},{"pos":[2034,2044],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>cs<ept id=\"p1\">*</ept>","pos":[2048,2052],"source":"*cs*"},{"content":"The critical section object.","pos":[2056,2084]},{"content":"The initial lock state: <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> means locked.","pos":[2109,2155],"source":" The initial lock state: **true** means locked."},{"pos":[2165,2172],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Initializes the critical section object.","pos":[2176,2216]},{"pos":[2226,2297],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcritseclock__dtor\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCritSecLock::~CComCritSecLock","linkify":"<a name=\"ccomcritseclock__dtor\"></a>  CComCritSecLock::~CComCritSecLock","source":"<a name=\"ccomcritseclock__dtor\"></a>  CComCritSecLock::~CComCritSecLock"},{"content":"The destructor.","pos":[2301,2316]},{"pos":[2367,2374],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"Unlocks the critical section object.","pos":[2378,2414]},{"pos":[2424,2483],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcritseclock__lock\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCritSecLock::Lock","linkify":"<a name=\"ccomcritseclock__lock\"></a>  CComCritSecLock::Lock","source":"<a name=\"ccomcritseclock__lock\"></a>  CComCritSecLock::Lock"},{"content":"Call this method to lock the critical section object.","pos":[2487,2540]},{"pos":[2587,2599],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns S_OK if the object has successfully been locked, or an error HRESULT on failure.","pos":[2603,2691]},{"pos":[2701,2708],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If the object is already locked, an ASSERT error will occur in debug builds.","pos":[2712,2788]},{"pos":[2798,2861],"content":"<bpt id=\"p1\">&lt;a name=\"ccomcritseclock__unlock\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComCritSecLock::Unlock","linkify":"<a name=\"ccomcritseclock__unlock\"></a>  CComCritSecLock::Unlock","source":"<a name=\"ccomcritseclock__unlock\"></a>  CComCritSecLock::Unlock"},{"content":"Call this method to unlock the critical section object.","pos":[2865,2920]},{"pos":[2966,2973],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If the object is already unlocked, an ASSERT error will occur in debug builds.","pos":[2977,3055]},{"pos":[3064,3072],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CComCriticalSection Class<ept id=\"p1\">](../../atl/reference/ccomcriticalsection-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[3076,3154],"source":"[CComCriticalSection Class](../../atl/reference/ccomcriticalsection-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CComAutoCriticalSection Class<ept id=\"p1\">](../../atl/reference/ccomautocriticalsection-class.md)</ept>","pos":[3157,3243],"source":" [CComAutoCriticalSection Class](../../atl/reference/ccomautocriticalsection-class.md)"}],"content":"---\ntitle: \"CComCritSecLock Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::CComCritSecLock\"\n  - \"ATL.CComCritSecLock<TLock>\"\n  - \"ATL::CComCritSecLock<TLock>\"\n  - \"ATL.CComCritSecLock\"\n  - \"CComCritSecLock\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CComCritSecLock class\"\nms.assetid: 223152a1-86c3-4ef9-89a7-f455fe791b0e\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComCritSecLock Class\nThis class provides methods for locking and unlocking a critical section object.  \n  \n## Syntax  \n  \n```\ntemplate<class TLock> class CComCritSecLock\n```  \n  \n#### Parameters  \n *TLock*  \n The object to be locked and unlocked.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComCritSecLock::CComCritSecLock](#ccomcritseclock__ctor)|The constructor.|  \n|[CComCritSecLock::~CComCritSecLock](#ccomcritseclock__dtor)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComCritSecLock::Lock](#ccomcritseclock__lock)|Call this method to lock the critical section object.|  \n|[CComCritSecLock::Unlock](#ccomcritseclock__unlock)|Call this method to unlock the critical section object.|  \n  \n## Remarks  \n Use this class to lock and unlock objects in a safer way than with the [CComCriticalSection Class](../../atl/reference/ccomcriticalsection-class.md) or [CComAutoCriticalSection Class](../../atl/reference/ccomautocriticalsection-class.md).  \n  \n## Requirements  \n **Header:** atlbase.h  \n  \n##  <a name=\"ccomcritseclock__ctor\"></a>  CComCritSecLock::CComCritSecLock  \n The constructor.  \n  \n```\nCComCritSecLock(\n    TLock& cs,  bool bInitialLock = true);\n```  \n  \n### Parameters  \n *cs*  \n The critical section object.  \n  \n `bInitialLock`  \n The initial lock state: **true** means locked.  \n  \n### Remarks  \n Initializes the critical section object.  \n  \n##  <a name=\"ccomcritseclock__dtor\"></a>  CComCritSecLock::~CComCritSecLock  \n The destructor.  \n  \n```\n~CComCritSecLock() throw();\n```  \n  \n### Remarks  \n Unlocks the critical section object.  \n  \n##  <a name=\"ccomcritseclock__lock\"></a>  CComCritSecLock::Lock  \n Call this method to lock the critical section object.  \n  \n```\nHRESULT Lock() throw();\n```  \n  \n### Return Value  \n Returns S_OK if the object has successfully been locked, or an error HRESULT on failure.  \n  \n### Remarks  \n If the object is already locked, an ASSERT error will occur in debug builds.  \n  \n##  <a name=\"ccomcritseclock__unlock\"></a>  CComCritSecLock::Unlock  \n Call this method to unlock the critical section object.  \n  \n```\nvoid Unlock() throw();\n```  \n  \n### Remarks  \n If the object is already unlocked, an ASSERT error will occur in debug builds.  \n  \n## See Also  \n [CComCriticalSection Class](../../atl/reference/ccomcriticalsection-class.md)   \n [CComAutoCriticalSection Class](../../atl/reference/ccomautocriticalsection-class.md)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"}