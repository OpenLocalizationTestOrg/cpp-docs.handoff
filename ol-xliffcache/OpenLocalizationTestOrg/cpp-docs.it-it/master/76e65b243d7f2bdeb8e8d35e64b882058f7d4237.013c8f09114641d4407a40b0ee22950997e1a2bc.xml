{"nodes":[{"pos":[12,86],"content":"MFC ActiveX Controls: Adding Another Custom Property Page | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Adding Another Custom Property Page | Microsoft Docs","pos":[0,74]}]},{"content":"MFC ActiveX Controls: Adding Another Custom Property Page","pos":[760,817]},{"content":"Occasionally, an ActiveX control will have more properties than can reasonably fit on one property page.","pos":[818,922]},{"content":"In this case, you can add property pages to the ActiveX control to display these properties.","pos":[923,1015]},{"content":"This article discusses adding new property pages to an ActiveX control that already has at least one property page.","pos":[1022,1137]},{"content":"For more information on adding stock property pages (font, picture, or color), see the article <bpt id=\"p1\">[</bpt>MFC ActiveX Controls: Using Stock Property Pages<ept id=\"p1\">](../mfc/mfc-activex-controls-using-stock-property-pages.md)</ept>.","pos":[1138,1343],"source":" For more information on adding stock property pages (font, picture, or color), see the article [MFC ActiveX Controls: Using Stock Property Pages](../mfc/mfc-activex-controls-using-stock-property-pages.md)."},{"content":"The following procedures use a sample ActiveX control framework created by the ActiveX Control Wizard.","pos":[1350,1452]},{"content":"Therefore, the class names and identifiers are unique to this example.","pos":[1453,1523]},{"content":"For more information on using property pages in an ActiveX control, see the following articles:","pos":[1530,1625]},{"content":"MFC ActiveX Controls: Property Pages","pos":[1636,1672]},{"content":"MFC ActiveX Controls: Using Stock Property Pages","pos":[1731,1779]},{"pos":[1851,2201],"content":"[!NOTE]\n It is strongly recommended that new property pages adhere to the size standard for ActiveX control property pages. The stock picture and color property pages measure 250x62 dialog units (DLU). The standard font property page is 250x110 DLUs. The default property page created by the ActiveX Control Wizard uses the 250x62 DLU standard.","leadings":["","    > "],"nodes":[{"content":" It is strongly recommended that new property pages adhere to the size standard for ActiveX control property pages. The stock picture and color property pages measure 250x62 dialog units (DLU). The standard font property page is 250x110 DLUs. The default property page created by the ActiveX Control Wizard uses the 250x62 DLU standard.","pos":[8,344],"nodes":[{"content":"It is strongly recommended that new property pages adhere to the size standard for ActiveX control property pages.","pos":[1,115]},{"content":"The stock picture and color property pages measure 250x62 dialog units (DLU).","pos":[116,193]},{"content":"The standard font property page is 250x110 DLUs.","pos":[194,242]},{"content":"The default property page created by the ActiveX Control Wizard uses the 250x62 DLU standard.","pos":[243,336]}]}]},{"content":"To insert a new property page template into your project","pos":[2211,2267]},{"content":"With your control project open, open Resource View in the project workspace.","pos":[2277,2353]},{"pos":[2363,2445],"content":"Right-click in Resource View to open the shortcut menu and click <bpt id=\"p1\">**</bpt>Add Resource<ept id=\"p1\">**</ept>.","source":"Right-click in Resource View to open the shortcut menu and click **Add Resource**."},{"pos":[2455,2521],"content":"Expand the <bpt id=\"p1\">**</bpt>Dialog<ept id=\"p1\">**</ept> node, and select <bpt id=\"p2\">**</bpt>IDD_OLE_PROPPAGE_SMALL<ept id=\"p2\">**</ept>.","source":"Expand the **Dialog** node, and select **IDD_OLE_PROPPAGE_SMALL**."},{"pos":[2531,2579],"content":"Click <ph id=\"ph1\">`New`</ph> to add the resource to your project.","source":"Click `New` to add the resource to your project."},{"content":"Select the new property page template to refresh the Properties window.","pos":[2589,2660]},{"content":"Enter a new value for the <bpt id=\"p1\">**</bpt>ID<ept id=\"p1\">**</ept> property.","pos":[2670,2712],"source":"Enter a new value for the **ID** property."},{"content":"This example uses <bpt id=\"p1\">**</bpt>IDD_PROPPAGE_NEWPAGE<ept id=\"p1\">**</ept>.","pos":[2713,2756],"source":" This example uses **IDD_PROPPAGE_NEWPAGE**."},{"pos":[2766,2796],"content":"Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> on the toolbar.","source":"Click **Save** on the toolbar."},{"content":"To associate the new template with a class","pos":[2806,2848]},{"content":"Open Class View.","pos":[2858,2874]},{"content":"Right-click in Class View to open the shortcut menu.","pos":[2884,2936]},{"pos":[2946,3013],"content":"From the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Class<ept id=\"p2\">**</ept>.","source":"From the shortcut menu, click **Add** and then click **Add Class**."},{"pos":[3024,3094],"content":"This opens the <bpt id=\"p1\">[</bpt>Add Class<ept id=\"p1\">](../ide/add-class-dialog-box.md)</ept> dialog box.","source":"This opens the [Add Class](../ide/add-class-dialog-box.md) dialog box."},{"pos":[3104,3144],"content":"Double-click the <bpt id=\"p1\">**</bpt>MFC Class<ept id=\"p1\">**</ept> template.","source":"Double-click the **MFC Class** template."},{"content":"In the <bpt id=\"p1\">**</bpt>Class Name<ept id=\"p1\">**</ept> box in the <bpt id=\"p2\">[</bpt>MFC Class Wizard<ept id=\"p2\">](../mfc/reference/mfc-add-class-wizard.md)</ept>, type a name for the new dialog class.","pos":[3154,3286],"source":"In the **Class Name** box in the [MFC Class Wizard](../mfc/reference/mfc-add-class-wizard.md), type a name for the new dialog class."},{"content":"(In this example, <ph id=\"ph1\">`CAddtlPropPage`</ph>.)","pos":[3287,3323],"source":" (In this example, `CAddtlPropPage`.)"},{"content":"If you want to change file names, click <bpt id=\"p1\">**</bpt>Change<ept id=\"p1\">**</ept>.","pos":[3333,3384],"source":"If you want to change file names, click **Change**."},{"content":"Type in the names for your implementation and header files, or accept the default names.","pos":[3385,3473]},{"pos":[3483,3536],"content":"In the <bpt id=\"p1\">**</bpt>Base Class<ept id=\"p1\">**</ept> box, select <ph id=\"ph1\">`COlePropertyPage`</ph>.","source":"In the **Base Class** box, select `COlePropertyPage`."},{"pos":[3546,3604],"content":"In the <bpt id=\"p1\">**</bpt>Dialog ID<ept id=\"p1\">**</ept> box, select <bpt id=\"p2\">**</bpt>IDD_PROPPAGE_NEWPAGE<ept id=\"p2\">**</ept>.","source":"In the **Dialog ID** box, select **IDD_PROPPAGE_NEWPAGE**."},{"pos":[3613,3650],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to create the class.","source":"Click **Finish** to create the class."},{"content":"To allow the control's users access to this new property page, make the following changes to the control's property page IDs macro section (located in the control implementation file):","pos":[3657,3841]},{"pos":[3859,3874],"content":"NVC_MFC_AxUI#32"},{"pos":[3970,4090],"content":"Note that you must increase the second parameter of the <ph id=\"ph1\">`BEGIN_PROPPAGEIDS`</ph> macro (the property page count) from 1 to 2.","source":"Note that you must increase the second parameter of the `BEGIN_PROPPAGEIDS` macro (the property page count) from 1 to 2."},{"content":"You must also modify the control implementation file (.CPP) file to include the header (.H) file of the new property page class.","pos":[4097,4225]},{"content":"The next step involves creating two new string resources that will provide a type name and a caption for the new property page.","pos":[4232,4359]},{"content":"To add new string resources to a property page","pos":[4370,4416]},{"content":"With your control project open, open Resource View.","pos":[4426,4477]},{"pos":[4487,4619],"content":"Double-click the <bpt id=\"p1\">**</bpt>String Table<ept id=\"p1\">**</ept> folder and then double-click the existing string table resource to which you want to add a string.","source":"Double-click the **String Table** folder and then double-click the existing string table resource to which you want to add a string."},{"content":"This opens the string table in a window.","pos":[4630,4670]},{"content":"Select the blank line at the end of the string table and type the text, or caption, of the string: for example, \"Additional Property Page.\"","pos":[4680,4819]},{"content":"This opens a <bpt id=\"p1\">**</bpt>String Properties<ept id=\"p1\">**</ept> page showing <bpt id=\"p2\">**</bpt>Caption<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>ID<ept id=\"p3\">**</ept> boxes.","pos":[4830,4907],"source":"This opens a **String Properties** page showing **Caption** and **ID** boxes."},{"content":"The <bpt id=\"p1\">**</bpt>Caption<ept id=\"p1\">**</ept> box contains the string you typed.","pos":[4908,4958],"source":" The **Caption** box contains the string you typed."},{"content":"In the <bpt id=\"p1\">**</bpt>ID<ept id=\"p1\">**</ept> box, select or type an ID for the string.","pos":[4968,5023],"source":"In the **ID** box, select or type an ID for the string."},{"content":"Press Enter when you finish.","pos":[5024,5052]},{"pos":[5063,5147],"content":"This example uses <bpt id=\"p1\">**</bpt>IDS_SAMPLE_ADDPAGE<ept id=\"p1\">**</ept> for the type name of the new property page.","source":"This example uses **IDS_SAMPLE_ADDPAGE** for the type name of the new property page."},{"pos":[5157,5272],"content":"Repeat steps 3 and 4 using <bpt id=\"p1\">**</bpt>IDS_SAMPLE_ADDPPG_CAPTION<ept id=\"p1\">**</ept> for the ID and \"Additional Property Page\" for the caption.","source":"Repeat steps 3 and 4 using **IDS_SAMPLE_ADDPPG_CAPTION** for the ID and \"Additional Property Page\" for the caption."},{"pos":[5282,5615],"content":"In the .CPP file of your new property page class (in this example, <ph id=\"ph1\">`CAddtlPropPage`</ph>) modify the <ph id=\"ph2\">`CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry`</ph> so that IDS_SAMPLE_ADDPAGE is passed by <bpt id=\"p1\">[</bpt>AfxOleRegisterPropertyPageClass<ept id=\"p1\">](../mfc/reference/registering-ole-controls.md#afxoleregisterpropertypageclass)</ept>, as in the following example:","source":"In the .CPP file of your new property page class (in this example, `CAddtlPropPage`) modify the `CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry` so that IDS_SAMPLE_ADDPAGE is passed by [AfxOleRegisterPropertyPageClass](../mfc/reference/registering-ole-controls.md#afxoleregisterpropertypageclass), as in the following example:"},{"pos":[5637,5652],"content":"NVC_MFC_AxUI#33"},{"pos":[5751,5892],"content":"Modify the constructor of <ph id=\"ph1\">`CAddtlPropPage`</ph> so that <bpt id=\"p1\">**</bpt>IDS_SAMPLE_ADDPPG_CAPTION<ept id=\"p1\">**</ept> is passed to the <ph id=\"ph2\">`COlePropertyPage`</ph> constructor, as follows:","source":"Modify the constructor of `CAddtlPropPage` so that **IDS_SAMPLE_ADDPPG_CAPTION** is passed to the `COlePropertyPage` constructor, as follows:"},{"pos":[5914,5929],"content":"NVC_MFC_AxUI#34"},{"content":"After you have made the necessary modifications rebuild your project and use Test Container to test the new property page.","pos":[6025,6147]},{"content":"See <bpt id=\"p1\">[</bpt>Testing Properties and Events with Test Container<ept id=\"p1\">](../mfc/testing-properties-and-events-with-test-container.md)</ept> for information on how to access the test container.","pos":[6148,6317],"source":" See [Testing Properties and Events with Test Container](../mfc/testing-properties-and-events-with-test-container.md) for information on how to access the test container."},{"content":"See Also","pos":[6326,6334]},{"content":"MFC ActiveX Controls","pos":[6339,6359]}],"content":"---\ntitle: \"MFC ActiveX Controls: Adding Another Custom Property Page | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"property pages [C++], MFC ActiveX controls\"\n  - \"custom property pages\"\n  - \"ActiveX controls [C++], property pages\"\n  - \"MFC ActiveX controls [C++], property pages\"\nms.assetid: fcf7e119-9f29-41a9-908d-e9b1607e08af\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Adding Another Custom Property Page\nOccasionally, an ActiveX control will have more properties than can reasonably fit on one property page. In this case, you can add property pages to the ActiveX control to display these properties.  \n  \n This article discusses adding new property pages to an ActiveX control that already has at least one property page. For more information on adding stock property pages (font, picture, or color), see the article [MFC ActiveX Controls: Using Stock Property Pages](../mfc/mfc-activex-controls-using-stock-property-pages.md).  \n  \n The following procedures use a sample ActiveX control framework created by the ActiveX Control Wizard. Therefore, the class names and identifiers are unique to this example.  \n  \n For more information on using property pages in an ActiveX control, see the following articles:  \n  \n-   [MFC ActiveX Controls: Property Pages](../mfc/mfc-activex-controls-property-pages.md)  \n  \n-   [MFC ActiveX Controls: Using Stock Property Pages](../mfc/mfc-activex-controls-using-stock-property-pages.md)  \n  \n    > [!NOTE]\n    >  It is strongly recommended that new property pages adhere to the size standard for ActiveX control property pages. The stock picture and color property pages measure 250x62 dialog units (DLU). The standard font property page is 250x110 DLUs. The default property page created by the ActiveX Control Wizard uses the 250x62 DLU standard.  \n  \n### To insert a new property page template into your project  \n  \n1.  With your control project open, open Resource View in the project workspace.  \n  \n2.  Right-click in Resource View to open the shortcut menu and click **Add Resource**.  \n  \n3.  Expand the **Dialog** node, and select **IDD_OLE_PROPPAGE_SMALL**.  \n  \n4.  Click `New` to add the resource to your project.  \n  \n5.  Select the new property page template to refresh the Properties window.  \n  \n6.  Enter a new value for the **ID** property. This example uses **IDD_PROPPAGE_NEWPAGE**.  \n  \n7.  Click **Save** on the toolbar.  \n  \n### To associate the new template with a class  \n  \n1.  Open Class View.  \n  \n2.  Right-click in Class View to open the shortcut menu.  \n  \n3.  From the shortcut menu, click **Add** and then click **Add Class**.  \n  \n     This opens the [Add Class](../ide/add-class-dialog-box.md) dialog box.  \n  \n4.  Double-click the **MFC Class** template.  \n  \n5.  In the **Class Name** box in the [MFC Class Wizard](../mfc/reference/mfc-add-class-wizard.md), type a name for the new dialog class. (In this example, `CAddtlPropPage`.)  \n  \n6.  If you want to change file names, click **Change**. Type in the names for your implementation and header files, or accept the default names.  \n  \n7.  In the **Base Class** box, select `COlePropertyPage`.  \n  \n8.  In the **Dialog ID** box, select **IDD_PROPPAGE_NEWPAGE**.  \n  \n9. Click **Finish** to create the class.  \n  \n To allow the control's users access to this new property page, make the following changes to the control's property page IDs macro section (located in the control implementation file):  \n  \n [!code-cpp[NVC_MFC_AxUI#32](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_1.cpp)]  \n  \n Note that you must increase the second parameter of the `BEGIN_PROPPAGEIDS` macro (the property page count) from 1 to 2.  \n  \n You must also modify the control implementation file (.CPP) file to include the header (.H) file of the new property page class.  \n  \n The next step involves creating two new string resources that will provide a type name and a caption for the new property page.  \n  \n#### To add new string resources to a property page  \n  \n1.  With your control project open, open Resource View.  \n  \n2.  Double-click the **String Table** folder and then double-click the existing string table resource to which you want to add a string.  \n  \n     This opens the string table in a window.  \n  \n3.  Select the blank line at the end of the string table and type the text, or caption, of the string: for example, \"Additional Property Page.\"  \n  \n     This opens a **String Properties** page showing **Caption** and **ID** boxes. The **Caption** box contains the string you typed.  \n  \n4.  In the **ID** box, select or type an ID for the string. Press Enter when you finish.  \n  \n     This example uses **IDS_SAMPLE_ADDPAGE** for the type name of the new property page.  \n  \n5.  Repeat steps 3 and 4 using **IDS_SAMPLE_ADDPPG_CAPTION** for the ID and \"Additional Property Page\" for the caption.  \n  \n6.  In the .CPP file of your new property page class (in this example, `CAddtlPropPage`) modify the `CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry` so that IDS_SAMPLE_ADDPAGE is passed by [AfxOleRegisterPropertyPageClass](../mfc/reference/registering-ole-controls.md#afxoleregisterpropertypageclass), as in the following example:  \n  \n     [!code-cpp[NVC_MFC_AxUI#33](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_2.cpp)]  \n  \n7.  Modify the constructor of `CAddtlPropPage` so that **IDS_SAMPLE_ADDPPG_CAPTION** is passed to the `COlePropertyPage` constructor, as follows:  \n  \n     [!code-cpp[NVC_MFC_AxUI#34](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_3.cpp)]  \n  \n After you have made the necessary modifications rebuild your project and use Test Container to test the new property page. See [Testing Properties and Events with Test Container](../mfc/testing-properties-and-events-with-test-container.md) for information on how to access the test container.  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)\n\n"}