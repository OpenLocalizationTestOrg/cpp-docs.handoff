{"nodes":[{"pos":[12,40],"content":"synchronize | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"synchronize | Microsoft Docs","pos":[0,28]}]},{"content":"synchronize","pos":[622,633]},{"content":"Synchronizes access to the target method.","pos":[634,675]},{"content":"Syntax","pos":[684,690]},{"content":"Remarks","pos":[736,743]},{"content":"The <bpt id=\"p1\">**</bpt>synchronize<ept id=\"p1\">**</ept> C++ attribute implements support for synchronizing the target method of an object.","pos":[747,849],"source":"The **synchronize** C++ attribute implements support for synchronizing the target method of an object."},{"content":"Synchronization allows multiple objects to use a common resource (such as a method of a class) by controlling the access of the target method.","pos":[850,992]},{"content":"The code inserted by this attribute calls the proper <ph id=\"ph1\">`Lock`</ph> method (determined by the threading model) at the beginning of the target method.","pos":[999,1140],"source":"The code inserted by this attribute calls the proper `Lock` method (determined by the threading model) at the beginning of the target method."},{"content":"When the method is exited, <ph id=\"ph1\">`Unlock`</ph> is automatically called.","pos":[1141,1201],"source":" When the method is exited, `Unlock` is automatically called."},{"content":"For more information on these functions, see <bpt id=\"p1\">[</bpt>CComAutoThreadModule::Lock<ept id=\"p1\">](../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)</ept>","pos":[1202,1350],"source":" For more information on these functions, see [CComAutoThreadModule::Lock](../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)"},{"content":"This attribute requires that the <bpt id=\"p1\">[</bpt>coclass<ept id=\"p1\">](../windows/coclass.md)</ept>, <bpt id=\"p2\">[</bpt>progid<ept id=\"p2\">](../windows/progid.md)</ept>, or <bpt id=\"p3\">[</bpt>vi_progid<ept id=\"p3\">](../windows/vi-progid.md)</ept> attribute (or another attribute that implies one of these) also be applied to the same element.","pos":[1357,1591],"source":"This attribute requires that the [coclass](../windows/coclass.md), [progid](../windows/progid.md), or [vi_progid](../windows/vi-progid.md) attribute (or another attribute that implies one of these) also be applied to the same element."},{"content":"If any single attribute is used, the other two are automatically applied.","pos":[1592,1665]},{"content":"For example, if <bpt id=\"p1\">**</bpt>progid<ept id=\"p1\">**</ept> is applied, <bpt id=\"p2\">**</bpt>vi_progid<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>coclass<ept id=\"p3\">**</ept> are also applied.","pos":[1666,1752],"source":" For example, if **progid** is applied, **vi_progid** and **coclass** are also applied."},{"content":"Example","pos":[1761,1768]},{"pos":[1772,1872],"content":"The following code provides synchronization for the <ph id=\"ph1\">`UpdateBalance`</ph> method of the <ph id=\"ph2\">`CMyClass`</ph> object.","source":"The following code provides synchronization for the `UpdateBalance` method of the `CMyClass` object."},{"content":"Requirements","pos":[2356,2368]},{"content":"Attribute Context","pos":[2378,2395]},{"content":"Applies to","pos":[2418,2428]},{"content":"Class method, method","pos":[2431,2451]},{"content":"Repeatable","pos":[2458,2468]},{"content":"No","pos":[2471,2473]},{"content":"Required attributes","pos":[2480,2499]},{"pos":[2502,2574],"content":"One or more of the following: <bpt id=\"p1\">**</bpt>coclass<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>progid<ept id=\"p2\">**</ept>, or <bpt id=\"p3\">**</bpt>vi_progid<ept id=\"p3\">**</ept>.","source":"One or more of the following: **coclass**, **progid**, or **vi_progid**."},{"content":"Invalid attributes","pos":[2581,2599]},{"content":"None","pos":[2602,2606]},{"pos":[2614,2724],"content":"For more information about the attribute contexts, see <bpt id=\"p1\">[</bpt>Attribute Contexts<ept id=\"p1\">](../windows/attribute-contexts.md)</ept>.","source":"For more information about the attribute contexts, see [Attribute Contexts](../windows/attribute-contexts.md)."},{"content":"See Also","pos":[2733,2741]},{"content":"COM Attributes","pos":[2746,2760]},{"content":"Attributes Samples","pos":[2797,2815]}],"content":"---\ntitle: \"synchronize | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\nf1_keywords: \n  - \"vc-attr.synchronize\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"synchronize attribute\"\nms.assetid: 15fc8544-955d-4765-b3d5-0f619c8b3f40\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# synchronize\nSynchronizes access to the target method.  \n  \n## Syntax  \n  \n```  \n  \n[synchronize]  \n  \n```  \n  \n## Remarks  \n The **synchronize** C++ attribute implements support for synchronizing the target method of an object. Synchronization allows multiple objects to use a common resource (such as a method of a class) by controlling the access of the target method.  \n  \n The code inserted by this attribute calls the proper `Lock` method (determined by the threading model) at the beginning of the target method. When the method is exited, `Unlock` is automatically called. For more information on these functions, see [CComAutoThreadModule::Lock](../atl/reference/ccomautothreadmodule-class.md#ccomautothreadmodule__lock)  \n  \n This attribute requires that the [coclass](../windows/coclass.md), [progid](../windows/progid.md), or [vi_progid](../windows/vi-progid.md) attribute (or another attribute that implies one of these) also be applied to the same element. If any single attribute is used, the other two are automatically applied. For example, if **progid** is applied, **vi_progid** and **coclass** are also applied.  \n  \n## Example  \n The following code provides synchronization for the `UpdateBalance` method of the `CMyClass` object.  \n  \n```  \n// cpp_attr_ref_synchronize.cpp  \n// compile with: /LD  \n#define _ATL_ATTRIBUTES  \n#include \"atlbase.h\"  \n#include \"atlcom.h\"  \n  \n[module(name=\"SYNC\")];  \n  \n[coclass,  \n threading(both),  \n vi_progid(\"MyProject.MyClass\"),  \n progid(\"MyProject.MyClass.1\"),  \n uuid(\"7a7baa0d-59b8-4576-b754-79d07e1d1cc3\")  \n]  \nclass CMyClass {  \n   float m_nBalance;  \n  \n   [synchronize]  \n   void UpdateBalance(float nAdjust) {  \n      m_nBalance += nAdjust;  \n   }  \n};  \n```  \n  \n## Requirements  \n  \n### Attribute Context  \n  \n|||  \n|-|-|  \n|**Applies to**|Class method, method|  \n|**Repeatable**|No|  \n|**Required attributes**|One or more of the following: **coclass**, **progid**, or **vi_progid**.|  \n|**Invalid attributes**|None|  \n  \n For more information about the attribute contexts, see [Attribute Contexts](../windows/attribute-contexts.md).  \n  \n## See Also  \n [COM Attributes](../windows/com-attributes.md)   \n [Attributes Samples](http://msdn.microsoft.com/en-us/558ebdb2-082f-44dc-b442-d8d33bf7bdb8)"}