{"nodes":[{"pos":[12,49],"content":"COleDropTarget Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleDropTarget Class | Microsoft Docs","pos":[0,37]}]},{"content":"COleDropTarget Class","pos":[700,720]},{"content":"Provides the communication mechanism between a window and the OLE libraries.","pos":[721,797]},{"content":"Syntax","pos":[806,812]},{"content":"Members","pos":[879,886]},{"content":"Public Constructors","pos":[896,915]},{"content":"Name","pos":[922,926]},{"content":"Description","pos":[927,938]},{"content":"COleDropTarget::COleDropTarget","pos":[977,1007]},{"pos":[1042,1079],"content":"Constructs a <ph id=\"ph1\">`COleDropTarget`</ph> object.","source":"Constructs a `COleDropTarget` object."},{"content":"Public Methods","pos":[1090,1104]},{"content":"Name","pos":[1111,1115]},{"content":"Description","pos":[1116,1127]},{"content":"COleDropTarget::OnDragEnter","pos":[1166,1193]},{"content":"Called when the cursor first enters the window.","pos":[1225,1272]},{"content":"COleDropTarget::OnDragLeave","pos":[1278,1305]},{"content":"Called when the cursor is dragged out of the window.","pos":[1337,1389]},{"content":"COleDropTarget::OnDragOver","pos":[1395,1421]},{"content":"Called repeatedly when the cursor is dragged over the window.","pos":[1452,1513]},{"content":"COleDropTarget::OnDragScroll","pos":[1519,1547]},{"content":"Called to determine whether the cursor is dragged into the scroll region of the window.","pos":[1580,1667]},{"content":"COleDropTarget::OnDrop","pos":[1673,1695]},{"content":"Called when data is dropped into the window, default handler.","pos":[1722,1783]},{"content":"COleDropTarget::OnDropEx","pos":[1789,1813]},{"content":"Called when data is dropped into the window, initial handler.","pos":[1842,1903]},{"content":"COleDropTarget::Register","pos":[1909,1933]},{"content":"Registers the window as a valid drop target.","pos":[1962,2006]},{"content":"COleDropTarget::Revoke","pos":[2012,2034]},{"content":"Causes the window to cease being a valid drop target.","pos":[2061,2114]},{"content":"Remarks","pos":[2124,2131]},{"content":"Creating an object of this class allows a window to accept data through the OLE drag-and-drop mechanism.","pos":[2135,2239]},{"pos":[2246,2483],"content":"To get a window to accept drop commands, you should first create an object of the <ph id=\"ph1\">`COleDropTarget`</ph> class, and then call the <bpt id=\"p1\">[</bpt>Register<ept id=\"p1\">](#coledroptarget__register)</ept> function with a pointer to the desired <ph id=\"ph2\">`CWnd`</ph> object as the only parameter.","source":"To get a window to accept drop commands, you should first create an object of the `COleDropTarget` class, and then call the [Register](#coledroptarget__register) function with a pointer to the desired `CWnd` object as the only parameter."},{"pos":[2490,2620],"content":"For more information on drag-and-drop operations using OLE, see the article <bpt id=\"p1\">[</bpt>Drag and Drop (OLE)<ept id=\"p1\">](../../mfc/drag-and-drop-ole.md)</ept>.","source":"For more information on drag-and-drop operations using OLE, see the article [Drag and Drop (OLE)](../../mfc/drag-and-drop-ole.md)."},{"content":"Inheritance Hierarchy","pos":[2629,2650]},{"content":"CObject","pos":[2655,2662]},{"content":"CCmdTarget","pos":[2709,2719]},{"content":"Requirements","pos":[2793,2805]},{"pos":[2809,2829],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxole.h","source":"**Header:** afxole.h"},{"pos":[2886,2916],"content":"COleDropTarget::COleDropTarget"},{"pos":[2920,2967],"content":"Constructs an object of class <ph id=\"ph1\">`COleDropTarget`</ph>.","source":"Constructs an object of class `COleDropTarget`."},{"content":"Remarks","pos":[3010,3017]},{"pos":[3021,3103],"content":"Call <bpt id=\"p1\">[</bpt>Register<ept id=\"p1\">](#coledroptarget__register)</ept> to associate this object with a window.","source":"Call [Register](#coledroptarget__register) to associate this object with a window."},{"pos":[3157,3184],"content":"COleDropTarget::OnDragEnter"},{"content":"Called by the framework when the cursor is first dragged into the window.","pos":[3188,3261]},{"content":"Parameters","pos":[3414,3424]},{"content":"Points to the window the cursor is entering.","pos":[3438,3482]},{"content":"Points to the data object containing the data that can be dropped.","pos":[3506,3572]},{"content":"Contains the state of the modifier keys.","pos":[3595,3635]},{"content":"This is a combination of any number of the following: <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>MK_SHIFT<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>MK_ALT<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>MK_LBUTTON<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>MK_MBUTTON<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>MK_RBUTTON<ept id=\"p6\">**</ept>.","pos":[3636,3783],"source":" This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**."},{"content":"Contains the current location of the cursor in client coordinates.","pos":[3801,3867]},{"content":"Return Value","pos":[3877,3889]},{"content":"The effect that would result if a drop were attempted at the location specified by <ph id=\"ph1\">`point`</ph>.","pos":[3893,3984],"source":"The effect that would result if a drop were attempted at the location specified by `point`."},{"content":"It can be one or more of the following:","pos":[3985,4024]},{"pos":[4050,4078],"content":"A drop would not be allowed."},{"pos":[4104,4140],"content":"A copy operation would be performed."},{"pos":[4166,4202],"content":"A move operation would be performed."},{"pos":[4228,4299],"content":"A link from the dropped data to the original data would be established."},{"pos":[4327,4399],"content":"A drag scroll operation is about to occur or is occurring in the target."},{"content":"Remarks","pos":[4409,4416]},{"content":"Override this function to allow drop operations to occur in the window.","pos":[4420,4491]},{"content":"The default implementation calls <bpt id=\"p1\">[</bpt>CView::OnDragEnter<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondragenter)</ept>, which simply returns <ph id=\"ph1\">`DROPEFFECT_NONE`</ph> by default.","pos":[4492,4652],"source":" The default implementation calls [CView::OnDragEnter](../../mfc/reference/cview-class.md#cview__ondragenter), which simply returns `DROPEFFECT_NONE` by default."},{"pos":[4659,4829],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDropTarget::DragEnter<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680106)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDropTarget::DragEnter](http://msdn.microsoft.com/library/windows/desktop/ms680106) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4883,4910],"content":"COleDropTarget::OnDragLeave"},{"content":"Called by the framework when the cursor leaves the window while a dragging operation is in effect.","pos":[4914,5012]},{"content":"Parameters","pos":[5075,5085]},{"content":"Points to the window the cursor is leaving.","pos":[5099,5142]},{"content":"Remarks","pos":[5152,5159]},{"content":"Override this function if you want special behavior when the drag operation leaves the specified window.","pos":[5163,5267]},{"content":"The default implementation of this function calls <bpt id=\"p1\">[</bpt>CView::OnDragLeave<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondragleave)</ept>.","pos":[5268,5394],"source":" The default implementation of this function calls [CView::OnDragLeave](../../mfc/reference/cview-class.md#cview__ondragleave)."},{"pos":[5401,5571],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDropTarget::DragLeave<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680110)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDropTarget::DragLeave](http://msdn.microsoft.com/library/windows/desktop/ms680110) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[5624,5650],"content":"COleDropTarget::OnDragOver"},{"content":"Called by the framework when the cursor is dragged over the window.","pos":[5654,5721]},{"content":"Parameters","pos":[5873,5883]},{"content":"Points to the window that the cursor is over.","pos":[5897,5942]},{"content":"Points to the data object that contains the data to be dropped.","pos":[5966,6029]},{"content":"Contains the state of the modifier keys.","pos":[6052,6092]},{"content":"This is a combination of any number of the following: <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>MK_SHIFT<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>MK_ALT<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>MK_LBUTTON<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>MK_MBUTTON<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>MK_RBUTTON<ept id=\"p6\">**</ept>.","pos":[6093,6240],"source":" This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**."},{"content":"Contains the current location of the cursor in client coordinates.","pos":[6258,6324]},{"content":"Return Value","pos":[6334,6346]},{"content":"The effect that would result if a drop were attempted at the location specified by <ph id=\"ph1\">`point`</ph>.","pos":[6350,6441],"source":"The effect that would result if a drop were attempted at the location specified by `point`."},{"content":"It can be one or more of the following:","pos":[6442,6481]},{"pos":[6507,6535],"content":"A drop would not be allowed."},{"pos":[6561,6597],"content":"A copy operation would be performed."},{"pos":[6623,6659],"content":"A move operation would be performed."},{"pos":[6685,6756],"content":"A link from the dropped data to the original data would be established."},{"pos":[6784,6871],"content":"Indicates that a drag scroll operation is about to occur or is occurring in the target."},{"content":"Remarks","pos":[6881,6888]},{"content":"This function should be overridden to allow drop operations to occur in the window.","pos":[6892,6975]},{"content":"The default implementation of this function calls <bpt id=\"p1\">[</bpt>CView::OnDragOver<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondragover)</ept>, which returns <ph id=\"ph1\">`DROPEFFECT_NONE`</ph> by default.","pos":[6976,7144],"source":" The default implementation of this function calls [CView::OnDragOver](../../mfc/reference/cview-class.md#cview__ondragover), which returns `DROPEFFECT_NONE` by default."},{"content":"Because this function is called frequently during a drag-and-drop operation, it should be optimized as much as possible.","pos":[7145,7265]},{"pos":[7272,7441],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDropTarget::DragOver<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680129)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDropTarget::DragOver](http://msdn.microsoft.com/library/windows/desktop/ms680129) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Example","pos":[7451,7458]},{"pos":[7473,7495],"content":"NVC_MFCOleContainer#21"},{"pos":[7606,7634],"content":"COleDropTarget::OnDragScroll"},{"pos":[7638,7822],"content":"Called by the framework before calling <bpt id=\"p1\">[</bpt>OnDragEnter<ept id=\"p1\">](#coledroptarget__ondragenter)</ept> or <bpt id=\"p2\">[</bpt>OnDragOver<ept id=\"p2\">](#coledroptarget__ondragover)</ept> to determine whether <ph id=\"ph1\">`point`</ph> is in the scrolling region.","source":"Called by the framework before calling [OnDragEnter](#coledroptarget__ondragenter) or [OnDragOver](#coledroptarget__ondragover) to determine whether `point` is in the scrolling region."},{"content":"Parameters","pos":[7941,7951]},{"content":"Points to the window the cursor is currently over.","pos":[7965,8015]},{"content":"Contains the state of the modifier keys.","pos":[8038,8078]},{"content":"This is a combination of any number of the following: <bpt id=\"p1\">**</bpt>MK_CONTROL<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>MK_SHIFT<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>MK_ALT<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>MK_LBUTTON<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>MK_MBUTTON<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>MK_RBUTTON<ept id=\"p6\">**</ept>.","pos":[8079,8226],"source":" This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**."},{"content":"Contains the location of the cursor, in pixels, relative to the screen.","pos":[8244,8315]},{"content":"Return Value","pos":[8325,8337]},{"content":"The effect that would result if a drop were attempted at the location specified by <ph id=\"ph1\">`point`</ph>.","pos":[8341,8432],"source":"The effect that would result if a drop were attempted at the location specified by `point`."},{"content":"It can be one or more of the following:","pos":[8433,8472]},{"pos":[8498,8526],"content":"A drop would not be allowed."},{"pos":[8552,8588],"content":"A copy operation would be performed."},{"pos":[8614,8650],"content":"A move operation would be performed."},{"pos":[8676,8747],"content":"A link from the dropped data to the original data would be established."},{"pos":[8775,8862],"content":"Indicates that a drag scroll operation is about to occur or is occurring in the target."},{"content":"Remarks","pos":[8872,8879]},{"content":"Override this function when you want to provide special behavior for this event.","pos":[8883,8963]},{"content":"The default implementation of this function calls <bpt id=\"p1\">[</bpt>CView::OnDragScroll<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondragscroll)</ept>, which returns <ph id=\"ph1\">`DROPEFFECT_NONE`</ph> and scrolls the window when the cursor is dragged into the default scroll region inside the border of the window.","pos":[8964,9238],"source":" The default implementation of this function calls [CView::OnDragScroll](../../mfc/reference/cview-class.md#cview__ondragscroll), which returns `DROPEFFECT_NONE` and scrolls the window when the cursor is dragged into the default scroll region inside the border of the window."},{"pos":[9287,9309],"content":"COleDropTarget::OnDrop"},{"content":"Called by the framework when a drop operation is to occur.","pos":[9313,9371]},{"content":"Parameters","pos":[9518,9528]},{"content":"Points to the window the cursor is currently over.","pos":[9542,9592]},{"content":"Points to the data object that contains the data to be dropped.","pos":[9616,9679]},{"content":"The effect that the user chose for the drop operation.","pos":[9702,9756]},{"content":"It can be one or more of the following:","pos":[9757,9796]},{"pos":[9822,9858],"content":"A copy operation would be performed."},{"pos":[9884,9920],"content":"A move operation would be performed."},{"pos":[9946,10017],"content":"A link from the dropped data to the original data would be established."},{"pos":[10024,10106],"content":"`point`  \nContains the location of the cursor, in pixels, relative to the screen.","leadings":[""," "],"nodes":[{"content":"Contains the location of the cursor, in pixels, relative to the screen.","pos":[10,81]}]},{"content":"Return Value","pos":[10116,10128]},{"content":"Nonzero if the drop is successful; otherwise 0.","pos":[10132,10179]},{"content":"Remarks","pos":[10189,10196]},{"content":"The framework first calls <bpt id=\"p1\">[</bpt>OnDropEx<ept id=\"p1\">](#coledroptarget__ondropex)</ept>.","pos":[10200,10264],"source":"The framework first calls [OnDropEx](#coledroptarget__ondropex)."},{"content":"If the <ph id=\"ph1\">`OnDropEx`</ph> function does not handle the drop, the framework then calls this member function, <ph id=\"ph2\">`OnDrop`</ph>.","pos":[10265,10374],"source":" If the `OnDropEx` function does not handle the drop, the framework then calls this member function, `OnDrop`."},{"content":"Typically, the application overrides <bpt id=\"p1\">[</bpt>OnDropEx<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondropex)</ept> in the view class to handle right mouse-button drag and drop.","pos":[10375,10536],"source":" Typically, the application overrides [OnDropEx](../../mfc/reference/cview-class.md#cview__ondropex) in the view class to handle right mouse-button drag and drop."},{"content":"Typically, the view class <bpt id=\"p1\">[</bpt>OnDrop<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondrop)</ept> is used to handle simple drag and drop.","pos":[10537,10661],"source":" Typically, the view class [OnDrop](../../mfc/reference/cview-class.md#cview__ondrop) is used to handle simple drag and drop."},{"pos":[10668,10838],"content":"The default implementation of <ph id=\"ph1\">`COleDropTarget::OnDrop`</ph> calls <bpt id=\"p1\">[</bpt>CView::OnDrop<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondrop)</ept>, which simply returns <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> by default.","source":"The default implementation of `COleDropTarget::OnDrop` calls [CView::OnDrop](../../mfc/reference/cview-class.md#cview__ondrop), which simply returns **FALSE** by default."},{"pos":[10845,11010],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDropTarget::Drop<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms687242)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDropTarget::Drop](http://msdn.microsoft.com/library/windows/desktop/ms687242) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[11061,11085],"content":"COleDropTarget::OnDropEx"},{"content":"Called by the framework when a drop operation is to occur.","pos":[11089,11147]},{"content":"Parameters","pos":[11330,11340]},{"content":"Points to the window the cursor is currently over.","pos":[11354,11404]},{"content":"Points to the data object that contains the data to be dropped.","pos":[11428,11491]},{"content":"The effect that the user chose for the default drop operation based on the current key state.","pos":[11515,11608]},{"content":"It can be <ph id=\"ph1\">`DROPEFFECT_NONE`</ph>.","pos":[11609,11637],"source":" It can be `DROPEFFECT_NONE`."},{"content":"Drop effects are discussed in the Remarks section.","pos":[11638,11688]},{"content":"A list of the drop effects that the drop source supports.","pos":[11709,11766]},{"content":"Drop effect values can be combined using the bitwise OR ( <bpt id=\"p1\">**</bpt>&amp;#124;<ept id=\"p1\">**</ept>) operation.","pos":[11767,11847],"source":" Drop effect values can be combined using the bitwise OR ( **&#124;**) operation."},{"content":"Drop effects are discussed in the Remarks section.","pos":[11848,11898]},{"content":"Contains the location of the cursor, in pixels, relative to the screen.","pos":[11916,11987]},{"content":"Return Value","pos":[11997,12009]},{"content":"The drop effect that resulted from the drop attempt at the location specified by <ph id=\"ph1\">`point`</ph>.","pos":[12013,12102],"source":"The drop effect that resulted from the drop attempt at the location specified by `point`."},{"content":"Drop effects are discussed in the Remarks section.","pos":[12103,12153]},{"content":"Remarks","pos":[12163,12170]},{"content":"The framework first calls this function.","pos":[12174,12214]},{"content":"If it does not handle the drop, the framework then calls <bpt id=\"p1\">[</bpt>OnDrop<ept id=\"p1\">](#coledroptarget__ondrop)</ept>.","pos":[12215,12306],"source":" If it does not handle the drop, the framework then calls [OnDrop](#coledroptarget__ondrop)."},{"content":"Typically, you will override <bpt id=\"p1\">[</bpt>OnDropEx<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondropex)</ept> in the view class to support right mouse-button drag and drop.","pos":[12307,12461],"source":" Typically, you will override [OnDropEx](../../mfc/reference/cview-class.md#cview__ondropex) in the view class to support right mouse-button drag and drop."},{"content":"Typically, the view class <bpt id=\"p1\">[</bpt>OnDrop<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondrop)</ept> is used to handle the case of support for simple drag and drop.","pos":[12462,12610],"source":" Typically, the view class [OnDrop](../../mfc/reference/cview-class.md#cview__ondrop) is used to handle the case of support for simple drag and drop."},{"content":"The default implementation of <ph id=\"ph1\">`COleDropTarget::OnDropEx`</ph> calls <bpt id=\"p1\">[</bpt>CView::OnDropEx<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondropex)</ept>.","pos":[12617,12750],"source":"The default implementation of `COleDropTarget::OnDropEx` calls [CView::OnDropEx](../../mfc/reference/cview-class.md#cview__ondropex)."},{"content":"By default, <bpt id=\"p1\">[</bpt>CView::OnDropEx<ept id=\"p1\">](../../mfc/reference/cview-class.md#cview__ondropex)</ept> simply returns a dummy value to indicate the <bpt id=\"p2\">[</bpt>OnDrop<ept id=\"p2\">](#coledroptarget__ondrop)</ept> member function should be called.","pos":[12751,12945],"source":" By default, [CView::OnDropEx](../../mfc/reference/cview-class.md#cview__ondropex) simply returns a dummy value to indicate the [OnDrop](#coledroptarget__ondrop) member function should be called."},{"content":"Drop effects describe the action associated with a drop operation.","pos":[12952,13018]},{"content":"See the following list of drop effects:","pos":[13019,13058]},{"pos":[13084,13112],"content":"A drop would not be allowed."},{"pos":[13138,13174],"content":"A copy operation would be performed."},{"pos":[13200,13236],"content":"A move operation would be performed."},{"pos":[13262,13333],"content":"A link from the dropped data to the original data would be established."},{"pos":[13361,13448],"content":"Indicates that a drag scroll operation is about to occur or is occurring in the target."},{"pos":[13455,13620],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDropTarget::Drop<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms687242)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDropTarget::Drop](http://msdn.microsoft.com/library/windows/desktop/ms687242) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[13671,13695],"content":"COleDropTarget::Register"},{"content":"Call this function to register your window with the OLE DLLs as a valid drop target.","pos":[13699,13783]},{"content":"Parameters","pos":[13835,13845]},{"content":"Points to the window that is to be registered as a drop target.","pos":[13859,13922]},{"content":"Return Value","pos":[13932,13944]},{"content":"Nonzero if registration is successful; otherwise 0.","pos":[13948,13999]},{"content":"Remarks","pos":[14009,14016]},{"content":"This function must be called for drop operations to be accepted.","pos":[14020,14084]},{"pos":[14091,14255],"content":"For more information, see <bpt id=\"p1\">[</bpt>RegisterDragDrop<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms678405)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RegisterDragDrop](http://msdn.microsoft.com/library/windows/desktop/ms678405) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[14304,14326],"content":"COleDropTarget::Revoke"},{"pos":[14330,14519],"content":"Call this function before destroying any window that has been registered as a drop target through a call to <bpt id=\"p1\">[</bpt>Register<ept id=\"p1\">](#coledroptarget__register)</ept> to remove it from the list of drop targets.","source":"Call this function before destroying any window that has been registered as a drop target through a call to [Register](#coledroptarget__register) to remove it from the list of drop targets."},{"content":"Remarks","pos":[14567,14574]},{"pos":[14578,14796],"content":"This function is called automatically from the <bpt id=\"p1\">[</bpt>OnDestroy<ept id=\"p1\">](../../mfc/reference/cwnd-class.md#cwnd__ondestroy)</ept> handler for the window that was registered, so it is usually not necessary to call this function explicitly.","source":"This function is called automatically from the [OnDestroy](../../mfc/reference/cwnd-class.md#cwnd__ondestroy) handler for the window that was registered, so it is usually not necessary to call this function explicitly."},{"pos":[14803,14965],"content":"For more information, see <bpt id=\"p1\">[</bpt>RevokeDragDrop<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms692643)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [RevokeDragDrop](http://msdn.microsoft.com/library/windows/desktop/ms692643) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"See Also","pos":[14974,14982]},{"content":"MFC Sample HIERSVR","pos":[14987,15005]},{"content":"MFC Sample OCLIENT","pos":[15041,15059]},{"content":"CCmdTarget Class","pos":[15095,15111]},{"content":"Hierarchy Chart","pos":[15159,15174]},{"content":"COleDropSource Class","pos":[15211,15231]}],"content":"---\ntitle: \"COleDropTarget Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleDropTarget\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"COleDropTarget class\"\n  - \"drag and drop, drop target\"\n  - \"drop commands, accepting\"\n  - \"drop commands\"\nms.assetid: a58c9a48-6a93-4357-b078-4594df258311\ncaps.latest.revision: 23\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleDropTarget Class\nProvides the communication mechanism between a window and the OLE libraries.  \n  \n## Syntax  \n  \n```  \nclass COleDropTarget : public CCmdTarget  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDropTarget::COleDropTarget](#coledroptarget__coledroptarget)|Constructs a `COleDropTarget` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDropTarget::OnDragEnter](#coledroptarget__ondragenter)|Called when the cursor first enters the window.|  \n|[COleDropTarget::OnDragLeave](#coledroptarget__ondragleave)|Called when the cursor is dragged out of the window.|  \n|[COleDropTarget::OnDragOver](#coledroptarget__ondragover)|Called repeatedly when the cursor is dragged over the window.|  \n|[COleDropTarget::OnDragScroll](#coledroptarget__ondragscroll)|Called to determine whether the cursor is dragged into the scroll region of the window.|  \n|[COleDropTarget::OnDrop](#coledroptarget__ondrop)|Called when data is dropped into the window, default handler.|  \n|[COleDropTarget::OnDropEx](#coledroptarget__ondropex)|Called when data is dropped into the window, initial handler.|  \n|[COleDropTarget::Register](#coledroptarget__register)|Registers the window as a valid drop target.|  \n|[COleDropTarget::Revoke](#coledroptarget__revoke)|Causes the window to cease being a valid drop target.|  \n  \n## Remarks  \n Creating an object of this class allows a window to accept data through the OLE drag-and-drop mechanism.  \n  \n To get a window to accept drop commands, you should first create an object of the `COleDropTarget` class, and then call the [Register](#coledroptarget__register) function with a pointer to the desired `CWnd` object as the only parameter.  \n  \n For more information on drag-and-drop operations using OLE, see the article [Drag and Drop (OLE)](../../mfc/drag-and-drop-ole.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n `COleDropTarget`  \n  \n## Requirements  \n **Header:** afxole.h  \n  \n##  <a name=\"coledroptarget__coledroptarget\"></a>  COleDropTarget::COleDropTarget  \n Constructs an object of class `COleDropTarget`.  \n  \n```  \nCOleDropTarget();\n```  \n  \n### Remarks  \n Call [Register](#coledroptarget__register) to associate this object with a window.  \n  \n##  <a name=\"coledroptarget__ondragenter\"></a>  COleDropTarget::OnDragEnter  \n Called by the framework when the cursor is first dragged into the window.  \n  \n```  \nvirtual DROPEFFECT OnDragEnter(\n    CWnd* pWnd,  \n    COleDataObject* pDataObject,  \n    DWORD dwKeyState,  \n    CPoint point);\n```  \n  \n### Parameters  \n `pWnd`  \n Points to the window the cursor is entering.  \n  \n `pDataObject`  \n Points to the data object containing the data that can be dropped.  \n  \n `dwKeyState`  \n Contains the state of the modifier keys. This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**.  \n  \n `point`  \n Contains the current location of the cursor in client coordinates.  \n  \n### Return Value  \n The effect that would result if a drop were attempted at the location specified by `point`. It can be one or more of the following:  \n  \n- `DROPEFFECT_NONE` A drop would not be allowed.  \n  \n- `DROPEFFECT_COPY` A copy operation would be performed.  \n  \n- `DROPEFFECT_MOVE` A move operation would be performed.  \n  \n- `DROPEFFECT_LINK` A link from the dropped data to the original data would be established.  \n  \n- `DROPEFFECT_SCROLL` A drag scroll operation is about to occur or is occurring in the target.  \n  \n### Remarks  \n Override this function to allow drop operations to occur in the window. The default implementation calls [CView::OnDragEnter](../../mfc/reference/cview-class.md#cview__ondragenter), which simply returns `DROPEFFECT_NONE` by default.  \n  \n For more information, see [IDropTarget::DragEnter](http://msdn.microsoft.com/library/windows/desktop/ms680106) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledroptarget__ondragleave\"></a>  COleDropTarget::OnDragLeave  \n Called by the framework when the cursor leaves the window while a dragging operation is in effect.  \n  \n```  \nvirtual void OnDragLeave(CWnd* pWnd);\n```  \n  \n### Parameters  \n `pWnd`  \n Points to the window the cursor is leaving.  \n  \n### Remarks  \n Override this function if you want special behavior when the drag operation leaves the specified window. The default implementation of this function calls [CView::OnDragLeave](../../mfc/reference/cview-class.md#cview__ondragleave).  \n  \n For more information, see [IDropTarget::DragLeave](http://msdn.microsoft.com/library/windows/desktop/ms680110) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledroptarget__ondragover\"></a>  COleDropTarget::OnDragOver  \n Called by the framework when the cursor is dragged over the window.  \n  \n```  \nvirtual DROPEFFECT OnDragOver(\n    CWnd* pWnd,  \n    COleDataObject* pDataObject,  \n    DWORD dwKeyState,  \n    CPoint point);\n```  \n  \n### Parameters  \n `pWnd`  \n Points to the window that the cursor is over.  \n  \n `pDataObject`  \n Points to the data object that contains the data to be dropped.  \n  \n `dwKeyState`  \n Contains the state of the modifier keys. This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**.  \n  \n `point`  \n Contains the current location of the cursor in client coordinates.  \n  \n### Return Value  \n The effect that would result if a drop were attempted at the location specified by `point`. It can be one or more of the following:  \n  \n- `DROPEFFECT_NONE` A drop would not be allowed.  \n  \n- `DROPEFFECT_COPY` A copy operation would be performed.  \n  \n- `DROPEFFECT_MOVE` A move operation would be performed.  \n  \n- `DROPEFFECT_LINK` A link from the dropped data to the original data would be established.  \n  \n- `DROPEFFECT_SCROLL` Indicates that a drag scroll operation is about to occur or is occurring in the target.  \n  \n### Remarks  \n This function should be overridden to allow drop operations to occur in the window. The default implementation of this function calls [CView::OnDragOver](../../mfc/reference/cview-class.md#cview__ondragover), which returns `DROPEFFECT_NONE` by default. Because this function is called frequently during a drag-and-drop operation, it should be optimized as much as possible.  \n  \n For more information, see [IDropTarget::DragOver](http://msdn.microsoft.com/library/windows/desktop/ms680129) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n [!code-cpp[NVC_MFCOleContainer#21](../../mfc/codesnippet/cpp/coledroptarget-class_1.cpp)]  \n  \n##  <a name=\"coledroptarget__ondragscroll\"></a>  COleDropTarget::OnDragScroll  \n Called by the framework before calling [OnDragEnter](#coledroptarget__ondragenter) or [OnDragOver](#coledroptarget__ondragover) to determine whether `point` is in the scrolling region.  \n  \n```  \nvirtual DROPEFFECT OnDragScroll(\n    CWnd* pWnd,  \n    DWORD dwKeyState,  \n    CPoint point);\n```  \n  \n### Parameters  \n `pWnd`  \n Points to the window the cursor is currently over.  \n  \n `dwKeyState`  \n Contains the state of the modifier keys. This is a combination of any number of the following: **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_LBUTTON**, **MK_MBUTTON**, and **MK_RBUTTON**.  \n  \n `point`  \n Contains the location of the cursor, in pixels, relative to the screen.  \n  \n### Return Value  \n The effect that would result if a drop were attempted at the location specified by `point`. It can be one or more of the following:  \n  \n- `DROPEFFECT_NONE` A drop would not be allowed.  \n  \n- `DROPEFFECT_COPY` A copy operation would be performed.  \n  \n- `DROPEFFECT_MOVE` A move operation would be performed.  \n  \n- `DROPEFFECT_LINK` A link from the dropped data to the original data would be established.  \n  \n- `DROPEFFECT_SCROLL` Indicates that a drag scroll operation is about to occur or is occurring in the target.  \n  \n### Remarks  \n Override this function when you want to provide special behavior for this event. The default implementation of this function calls [CView::OnDragScroll](../../mfc/reference/cview-class.md#cview__ondragscroll), which returns `DROPEFFECT_NONE` and scrolls the window when the cursor is dragged into the default scroll region inside the border of the window.  \n  \n##  <a name=\"coledroptarget__ondrop\"></a>  COleDropTarget::OnDrop  \n Called by the framework when a drop operation is to occur.  \n  \n```  \nvirtual BOOL OnDrop(\n    CWnd* pWnd,  \n    COleDataObject* pDataObject,  \n    DROPEFFECT dropEffect,  \n    CPoint point);\n```  \n  \n### Parameters  \n `pWnd`  \n Points to the window the cursor is currently over.  \n  \n `pDataObject`  \n Points to the data object that contains the data to be dropped.  \n  \n `dropEffect`  \n The effect that the user chose for the drop operation. It can be one or more of the following:  \n  \n- `DROPEFFECT_COPY` A copy operation would be performed.  \n  \n- `DROPEFFECT_MOVE` A move operation would be performed.  \n  \n- `DROPEFFECT_LINK` A link from the dropped data to the original data would be established.  \n  \n `point`  \n Contains the location of the cursor, in pixels, relative to the screen.  \n  \n### Return Value  \n Nonzero if the drop is successful; otherwise 0.  \n  \n### Remarks  \n The framework first calls [OnDropEx](#coledroptarget__ondropex). If the `OnDropEx` function does not handle the drop, the framework then calls this member function, `OnDrop`. Typically, the application overrides [OnDropEx](../../mfc/reference/cview-class.md#cview__ondropex) in the view class to handle right mouse-button drag and drop. Typically, the view class [OnDrop](../../mfc/reference/cview-class.md#cview__ondrop) is used to handle simple drag and drop.  \n  \n The default implementation of `COleDropTarget::OnDrop` calls [CView::OnDrop](../../mfc/reference/cview-class.md#cview__ondrop), which simply returns **FALSE** by default.  \n  \n For more information, see [IDropTarget::Drop](http://msdn.microsoft.com/library/windows/desktop/ms687242) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledroptarget__ondropex\"></a>  COleDropTarget::OnDropEx  \n Called by the framework when a drop operation is to occur.  \n  \n```  \nvirtual DROPEFFECT OnDropEx(\n    CWnd* pWnd,  \n    COleDataObject* pDataObject,  \n    DROPEFFECT dropDefault,  \n    DROPEFFECT dropList,  \n    CPoint point);\n```  \n  \n### Parameters  \n `pWnd`  \n Points to the window the cursor is currently over.  \n  \n `pDataObject`  \n Points to the data object that contains the data to be dropped.  \n  \n `dropDefault`  \n The effect that the user chose for the default drop operation based on the current key state. It can be `DROPEFFECT_NONE`. Drop effects are discussed in the Remarks section.  \n  \n `dropList`  \n A list of the drop effects that the drop source supports. Drop effect values can be combined using the bitwise OR ( **&#124;**) operation. Drop effects are discussed in the Remarks section.  \n  \n `point`  \n Contains the location of the cursor, in pixels, relative to the screen.  \n  \n### Return Value  \n The drop effect that resulted from the drop attempt at the location specified by `point`. Drop effects are discussed in the Remarks section.  \n  \n### Remarks  \n The framework first calls this function. If it does not handle the drop, the framework then calls [OnDrop](#coledroptarget__ondrop). Typically, you will override [OnDropEx](../../mfc/reference/cview-class.md#cview__ondropex) in the view class to support right mouse-button drag and drop. Typically, the view class [OnDrop](../../mfc/reference/cview-class.md#cview__ondrop) is used to handle the case of support for simple drag and drop.  \n  \n The default implementation of `COleDropTarget::OnDropEx` calls [CView::OnDropEx](../../mfc/reference/cview-class.md#cview__ondropex). By default, [CView::OnDropEx](../../mfc/reference/cview-class.md#cview__ondropex) simply returns a dummy value to indicate the [OnDrop](#coledroptarget__ondrop) member function should be called.  \n  \n Drop effects describe the action associated with a drop operation. See the following list of drop effects:  \n  \n- `DROPEFFECT_NONE` A drop would not be allowed.  \n  \n- `DROPEFFECT_COPY` A copy operation would be performed.  \n  \n- `DROPEFFECT_MOVE` A move operation would be performed.  \n  \n- `DROPEFFECT_LINK` A link from the dropped data to the original data would be established.  \n  \n- `DROPEFFECT_SCROLL` Indicates that a drag scroll operation is about to occur or is occurring in the target.  \n  \n For more information, see [IDropTarget::Drop](http://msdn.microsoft.com/library/windows/desktop/ms687242) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledroptarget__register\"></a>  COleDropTarget::Register  \n Call this function to register your window with the OLE DLLs as a valid drop target.  \n  \n```  \nBOOL Register(CWnd* pWnd);\n```  \n  \n### Parameters  \n `pWnd`  \n Points to the window that is to be registered as a drop target.  \n  \n### Return Value  \n Nonzero if registration is successful; otherwise 0.  \n  \n### Remarks  \n This function must be called for drop operations to be accepted.  \n  \n For more information, see [RegisterDragDrop](http://msdn.microsoft.com/library/windows/desktop/ms678405) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"coledroptarget__revoke\"></a>  COleDropTarget::Revoke  \n Call this function before destroying any window that has been registered as a drop target through a call to [Register](#coledroptarget__register) to remove it from the list of drop targets.  \n  \n```  \nvirtual void Revoke();\n```  \n  \n### Remarks  \n This function is called automatically from the [OnDestroy](../../mfc/reference/cwnd-class.md#cwnd__ondestroy) handler for the window that was registered, so it is usually not necessary to call this function explicitly.  \n  \n For more information, see [RevokeDragDrop](http://msdn.microsoft.com/library/windows/desktop/ms692643) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [MFC Sample HIERSVR](../../visual-cpp-samples.md)   \n [MFC Sample OCLIENT](../../visual-cpp-samples.md)   \n [CCmdTarget Class](../../mfc/reference/ccmdtarget-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [COleDropSource Class](../../mfc/reference/coledropsource-class.md)\n"}