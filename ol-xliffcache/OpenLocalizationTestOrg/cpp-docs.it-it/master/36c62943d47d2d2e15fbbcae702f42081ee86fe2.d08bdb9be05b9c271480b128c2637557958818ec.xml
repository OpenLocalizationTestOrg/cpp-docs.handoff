{"nodes":[{"pos":[12,44],"content":"CUserTool Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CUserTool Class | Microsoft Docs","pos":[0,32]}]},{"content":"CUserTool Class","pos":[601,616]},{"content":"A user tool is a menu item that runs an external application.","pos":[617,678]},{"content":"The <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> tab of the <bpt id=\"p2\">**</bpt>Customize<ept id=\"p2\">**</ept> dialog box ( <bpt id=\"p3\">[</bpt>CMFCToolBarsCustomizeDialog Class<ept id=\"p3\">](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)</ept>) enables the user to add user tools, and to specify the name, command, arguments, and initial directory for each user tool.","pos":[679,948],"source":" The **Tools** tab of the **Customize** dialog box ( [CMFCToolBarsCustomizeDialog Class](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)) enables the user to add user tools, and to specify the name, command, arguments, and initial directory for each user tool."},{"content":"Syntax","pos":[957,963]},{"content":"Members","pos":[1022,1029]},{"content":"Public Methods","pos":[1039,1053]},{"content":"Name","pos":[1060,1064]},{"content":"Description","pos":[1065,1076]},{"content":"CUserTool::CopyIconToClipboard","pos":[1115,1145]},{"content":"CUserTool::DrawToolIcon","pos":[1186,1209]},{"content":"Draws the user tool icon in a specified rectangle.","pos":[1237,1287]},{"content":"CUserTool::GetCommand","pos":[1293,1314]},{"content":"Returns a string that contains the text of the command associated with the user tool.","pos":[1340,1425]},{"content":"CUserTool::GetCommandId","pos":[1431,1454]},{"content":"Returns the command ID of the menu item of the user tool.","pos":[1482,1539]},{"content":"CUserTool::Invoke","pos":[1545,1562]},{"content":"Executes the command associated with the user tool.","pos":[1584,1635]},{"content":"CUserTool::Serialize","pos":[1641,1661]},{"content":"Reads or writes this object from or to an archive.","pos":[1686,1736]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CObject::Serialize<ept id=\"p1\">](../../mfc/reference/cobject-class.md#cobject__serialize)</ept>.)","pos":[1737,1827],"source":" (Overrides [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize).)"},{"content":"CUserTool::SetCommand","pos":[1833,1854]},{"content":"Sets the command associated with the user tool.","pos":[1880,1927]},{"content":"CUserTool::SetToolIcon","pos":[1933,1955]},{"content":"Loads the icon for the user tool from the application associated with the tool.","pos":[1982,2061]},{"content":"Protected Methods","pos":[2072,2089]},{"content":"Name","pos":[2096,2100]},{"content":"Description","pos":[2101,2112]},{"content":"CUserTool::LoadDefaultIcon","pos":[2151,2177]},{"content":"Loads the default icon for a user tool.","pos":[2208,2247]},{"content":"Data Members","pos":[2258,2270]},{"content":"Name","pos":[2277,2281]},{"content":"Description","pos":[2282,2293]},{"content":"CUserTool::m_strArguments","pos":[2332,2357]},{"content":"The command-line arguments for the user tool.","pos":[2387,2432]},{"content":"CUserTool::m_strInitialDirectory","pos":[2438,2470]},{"content":"The initial directory for the user tool.","pos":[2507,2547]},{"content":"CUserTool::m_strLabel","pos":[2553,2574]},{"content":"The tool name that is displayed in the menu item for the tool.","pos":[2600,2662]},{"content":"Remarks","pos":[2672,2679]},{"pos":[2683,2834],"content":"For more information about how to enable user tools in your application, see <bpt id=\"p1\">[</bpt>CUserToolsManager Class<ept id=\"p1\">](../../mfc/reference/cusertoolsmanager-class.md)</ept>.","source":"For more information about how to enable user tools in your application, see [CUserToolsManager Class](../../mfc/reference/cusertoolsmanager-class.md)."},{"content":"Example","pos":[2843,2850]},{"content":"The following example demonstrates how to create a tool from a <ph id=\"ph1\">`CUserToolsManager`</ph> object, set the <ph id=\"ph2\">`m_strLabel`</ph> member variable, and set the application that the user tool runs.","pos":[2854,3031],"source":"The following example demonstrates how to create a tool from a `CUserToolsManager` object, set the `m_strLabel` member variable, and set the application that the user tool runs."},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>Visual Studio Demo sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[3032,3122],"source":" This code snippet is part of the [Visual Studio Demo sample](../../visual-cpp-samples.md)."},{"pos":[3140,3167],"content":"NVC_MFC_VisualStudioDemo#35"},{"content":"Inheritance Hierarchy","pos":[3227,3248]},{"content":"CObject","pos":[3253,3260]},{"content":"CUserTool","pos":[3307,3316]},{"content":"Requirements","pos":[3366,3378]},{"pos":[3382,3407],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxusertool.h","source":"**Header:** afxusertool.h"},{"pos":[3464,3494],"content":"CUserTool::CopyIconToClipboard"},{"content":"Return Value","pos":[3650,3662]},{"content":"Remarks","pos":[3672,3679]},{"pos":[3729,3752],"content":"CUserTool::DrawToolIcon"},{"content":"Draws the user tool icon at the center of a specified rectangle.","pos":[3756,3820]},{"content":"Parameters","pos":[3909,3919]},{"content":"[in]","pos":[3923,3927]},{"content":"A pointer to a device context.","pos":[3937,3967]},{"content":"[in]","pos":[3974,3978]},{"content":"Specifies the coordinates of the area to display the icon.","pos":[3994,4052]},{"pos":[4100,4121],"content":"CUserTool::GetCommand"},{"content":"Returns a string that contains the text of the command associated with the user tool.","pos":[4125,4210]},{"content":"Return Value","pos":[4273,4285]},{"pos":[4289,4389],"content":"A reference to <ph id=\"ph1\">`CString`</ph> object that contains the text of the command associated with the user tool.","source":"A reference to `CString` object that contains the text of the command associated with the user tool."},{"pos":[4439,4462],"content":"CUserTool::GetCommandId"},{"content":"Returns the command ID of the user tool.","pos":[4466,4506]},{"content":"Return Value","pos":[4561,4573]},{"content":"The command ID of this user tool.","pos":[4577,4610]},{"pos":[4654,4671],"content":"CUserTool::Invoke"},{"content":"Executes the command associated with the user tool.","pos":[4675,4726]},{"content":"Return Value","pos":[4774,4786]},{"content":"Nonzero if the command was executed successfully; otherwise 0.","pos":[4790,4852]},{"content":"Remarks","pos":[4862,4869]},{"content":"Calls <bpt id=\"p1\">[</bpt>ShellExecute<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb762153)</ept> to execute a command associated with the user tool.","pos":[4873,5005],"source":"Calls [ShellExecute](http://msdn.microsoft.com/library/windows/desktop/bb762153) to execute a command associated with the user tool."},{"content":"The function fails if the command is empty or if <bpt id=\"p1\">[</bpt>ShellExecute<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/bb762153)</ept> fails.","pos":[5006,5136],"source":" The function fails if the command is empty or if [ShellExecute](http://msdn.microsoft.com/library/windows/desktop/bb762153) fails."},{"pos":[5189,5215],"content":"CUserTool::LoadDefaultIcon"},{"content":"Loads the default icon for a user tool.","pos":[5219,5258]},{"content":"Return Value","pos":[5316,5328]},{"pos":[5332,5419],"content":"A handle to the loaded icon ( <ph id=\"ph1\">`HICON`</ph>), or <ph id=\"ph2\">`NULL`</ph> if the default icon cannot be loaded.","source":"A handle to the loaded icon ( `HICON`), or `NULL` if the default icon cannot be loaded."},{"content":"Remarks","pos":[5429,5436]},{"content":"The framework calls this method when it is unable to load an icon for a user-defined tool from the executable file of the tool.","pos":[5440,5567]},{"content":"Override this method to supply your own default tool icon.","pos":[5574,5632]},{"pos":[5684,5709],"content":"CUserTool::m_strArguments"},{"content":"The command-line arguments for the user tool.","pos":[5713,5758]},{"content":"Remarks","pos":[5809,5816]},{"pos":[5820,5968],"content":"This string is passed to the tool when you call <bpt id=\"p1\">[</bpt>CUserTool::Invoke<ept id=\"p1\">](#cusertool__invoke)</ept> or when a user clicks the command associated with this tool.","source":"This string is passed to the tool when you call [CUserTool::Invoke](#cusertool__invoke) or when a user clicks the command associated with this tool."},{"pos":[6027,6059],"content":"CUserTool::m_strInitialDirectory"},{"content":"Specifies the initial directory for the user tool.","pos":[6063,6113]},{"content":"Remarks","pos":[6171,6178]},{"pos":[6182,6368],"content":"This variable specifies the initial directory that the tool executes in when you call <bpt id=\"p1\">[</bpt>CUserTool::Invoke<ept id=\"p1\">](#cusertool__invoke)</ept> or when a user clicks the command associated with this tool.","source":"This variable specifies the initial directory that the tool executes in when you call [CUserTool::Invoke](#cusertool__invoke) or when a user clicks the command associated with this tool."},{"pos":[6416,6437],"content":"CUserTool::m_strLabel"},{"content":"The label that is displayed in the menu item for the tool.","pos":[6441,6499]},{"pos":[6583,6603],"content":"CUserTool::Serialize"},{"content":"Parameters","pos":[6769,6779]},{"pos":[6783,6787],"content":"[in]"},{"content":"Remarks","pos":[6802,6809]},{"pos":[6857,6878],"content":"CUserTool::SetCommand"},{"content":"Sets the application that the user tool runs.","pos":[6882,6927]},{"content":"Parameters","pos":[6986,6996]},{"content":"[in]","pos":[7000,7004]},{"content":"Specifies the new application to be associated with the user tool.","pos":[7018,7084]},{"content":"Remarks","pos":[7094,7101]},{"content":"Call this method to set a new application that the user tool runs.","pos":[7105,7171]},{"content":"The method destroys the old icon and loads a new icon from the given application.","pos":[7172,7253]},{"content":"If it cannot load an icon from the application, it loads the default icon for a user tool by calling <bpt id=\"p1\">[</bpt>CUserTool::LoadDefaultIcon<ept id=\"p1\">](#cusertool__loaddefaulticon)</ept>.","pos":[7254,7413],"source":" If it cannot load an icon from the application, it loads the default icon for a user tool by calling [CUserTool::LoadDefaultIcon](#cusertool__loaddefaulticon)."},{"pos":[7462,7484],"content":"CUserTool::SetToolIcon"},{"content":"Loads the icon for the user tool from the application that the tool uses.","pos":[7488,7561]},{"content":"Return Value","pos":[7615,7627]},{"content":"A handle to the loaded icon.","pos":[7631,7659]},{"content":"Remarks","pos":[7669,7676]},{"content":"Call this method to load the icon to be displayed on the menu item.","pos":[7680,7747]},{"content":"This method searches for the icon in the executable file that the tool uses.","pos":[7748,7824]},{"content":"If it does not have a default icon, the icon provided by <bpt id=\"p1\">[</bpt>CUserTool::LoadDefaultIcon<ept id=\"p1\">](#cusertool__loaddefaulticon)</ept> is used instead.","pos":[7825,7956],"source":" If it does not have a default icon, the icon provided by [CUserTool::LoadDefaultIcon](#cusertool__loaddefaulticon) is used instead."},{"content":"See Also","pos":[7965,7973]},{"content":"Hierarchy Chart","pos":[7978,7993]},{"content":"Classes","pos":[8030,8037]},{"content":"CWinAppEx Class","pos":[8080,8095]},{"content":"CUserToolsManager Class","pos":[8142,8165]}],"content":"---\ntitle: \"CUserTool Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CUserTool\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CUserTool class\"\nms.assetid: 7c287d3e-d012-488d-b4e1-aa0f83f294bb\ncaps.latest.revision: 25\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CUserTool Class\nA user tool is a menu item that runs an external application. The **Tools** tab of the **Customize** dialog box ( [CMFCToolBarsCustomizeDialog Class](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)) enables the user to add user tools, and to specify the name, command, arguments, and initial directory for each user tool.  \n  \n## Syntax  \n  \n```  \nclass CUserTool : public CObject  \n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CUserTool::CopyIconToClipboard](#cusertool__copyicontoclipboard)||  \n|[CUserTool::DrawToolIcon](#cusertool__drawtoolicon)|Draws the user tool icon in a specified rectangle.|  \n|[CUserTool::GetCommand](#cusertool__getcommand)|Returns a string that contains the text of the command associated with the user tool.|  \n|[CUserTool::GetCommandId](#cusertool__getcommandid)|Returns the command ID of the menu item of the user tool.|  \n|[CUserTool::Invoke](#cusertool__invoke)|Executes the command associated with the user tool.|  \n|[CUserTool::Serialize](#cusertool__serialize)|Reads or writes this object from or to an archive. (Overrides [CObject::Serialize](../../mfc/reference/cobject-class.md#cobject__serialize).)|  \n|[CUserTool::SetCommand](#cusertool__setcommand)|Sets the command associated with the user tool.|  \n|[CUserTool::SetToolIcon](#cusertool__settoolicon)|Loads the icon for the user tool from the application associated with the tool.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CUserTool::LoadDefaultIcon](#cusertool__loaddefaulticon)|Loads the default icon for a user tool.|  \n  \n### Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CUserTool::m_strArguments](#cusertool__m_strarguments)|The command-line arguments for the user tool.|  \n|[CUserTool::m_strInitialDirectory](#cusertool__m_strinitialdirectory)|The initial directory for the user tool.|  \n|[CUserTool::m_strLabel](#cusertool__m_strlabel)|The tool name that is displayed in the menu item for the tool.|  \n  \n## Remarks  \n For more information about how to enable user tools in your application, see [CUserToolsManager Class](../../mfc/reference/cusertoolsmanager-class.md).  \n  \n## Example  \n The following example demonstrates how to create a tool from a `CUserToolsManager` object, set the `m_strLabel` member variable, and set the application that the user tool runs. This code snippet is part of the [Visual Studio Demo sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_VisualStudioDemo#35](../../mfc/codesnippet/cpp/cusertool-class_1.cpp)]  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CUserTool](../../mfc/reference/cusertool-class.md)  \n  \n## Requirements  \n **Header:** afxusertool.h  \n  \n##  <a name=\"cusertool__copyicontoclipboard\"></a>  CUserTool::CopyIconToClipboard  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nBOOL CopyIconToClipboard();\n```  \n  \n### Return Value  \n  \n### Remarks  \n  \n##  <a name=\"cusertool__drawtoolicon\"></a>  CUserTool::DrawToolIcon  \n Draws the user tool icon at the center of a specified rectangle.  \n  \n```  \nvoid DrawToolIcon(\n    CDC* pDC,  \n    const CRect& rectImage);\n```  \n  \n### Parameters  \n [in] `pDC`  \n A pointer to a device context.  \n  \n [in] `rectImage`  \n Specifies the coordinates of the area to display the icon.  \n  \n##  <a name=\"cusertool__getcommand\"></a>  CUserTool::GetCommand  \n Returns a string that contains the text of the command associated with the user tool.  \n  \n```  \nconst CString& GetCommand() const;\n\n \n```  \n  \n### Return Value  \n A reference to `CString` object that contains the text of the command associated with the user tool.  \n  \n##  <a name=\"cusertool__getcommandid\"></a>  CUserTool::GetCommandId  \n Returns the command ID of the user tool.  \n  \n```  \nUINT GetCommandId() const;\n\n \n```  \n  \n### Return Value  \n The command ID of this user tool.  \n  \n##  <a name=\"cusertool__invoke\"></a>  CUserTool::Invoke  \n Executes the command associated with the user tool.  \n  \n```  \nvirtual BOOL Invoke();\n```  \n  \n### Return Value  \n Nonzero if the command was executed successfully; otherwise 0.  \n  \n### Remarks  \n Calls [ShellExecute](http://msdn.microsoft.com/library/windows/desktop/bb762153) to execute a command associated with the user tool. The function fails if the command is empty or if [ShellExecute](http://msdn.microsoft.com/library/windows/desktop/bb762153) fails.  \n  \n##  <a name=\"cusertool__loaddefaulticon\"></a>  CUserTool::LoadDefaultIcon  \n Loads the default icon for a user tool.  \n  \n```  \nvirtual HICON LoadDefaultIcon();\n```  \n  \n### Return Value  \n A handle to the loaded icon ( `HICON`), or `NULL` if the default icon cannot be loaded.  \n  \n### Remarks  \n The framework calls this method when it is unable to load an icon for a user-defined tool from the executable file of the tool.  \n  \n Override this method to supply your own default tool icon.  \n  \n##  <a name=\"cusertool__m_strarguments\"></a>  CUserTool::m_strArguments  \n The command-line arguments for the user tool.  \n  \n```  \nCString m_strArguments;  \n```  \n  \n### Remarks  \n This string is passed to the tool when you call [CUserTool::Invoke](#cusertool__invoke) or when a user clicks the command associated with this tool.  \n  \n##  <a name=\"cusertool__m_strinitialdirectory\"></a>  CUserTool::m_strInitialDirectory  \n Specifies the initial directory for the user tool.  \n  \n```  \nCString m_strInitialDirectory;  \n```  \n  \n### Remarks  \n This variable specifies the initial directory that the tool executes in when you call [CUserTool::Invoke](#cusertool__invoke) or when a user clicks the command associated with this tool.  \n  \n##  <a name=\"cusertool__m_strlabel\"></a>  CUserTool::m_strLabel  \n The label that is displayed in the menu item for the tool.  \n  \n```  \nCString m_strLabel;  \n```  \n  \n##  <a name=\"cusertool__serialize\"></a>  CUserTool::Serialize  \n [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  \n  \n```  \nvirtual void Serialize(CArchive& ar);\n```  \n  \n### Parameters  \n [in] `ar`  \n  \n### Remarks  \n  \n##  <a name=\"cusertool__setcommand\"></a>  CUserTool::SetCommand  \n Sets the application that the user tool runs.  \n  \n```  \nvoid SetCommand(LPCTSTR lpszCmd);\n```  \n  \n### Parameters  \n [in] `lpszCmd`  \n Specifies the new application to be associated with the user tool.  \n  \n### Remarks  \n Call this method to set a new application that the user tool runs. The method destroys the old icon and loads a new icon from the given application. If it cannot load an icon from the application, it loads the default icon for a user tool by calling [CUserTool::LoadDefaultIcon](#cusertool__loaddefaulticon).  \n  \n##  <a name=\"cusertool__settoolicon\"></a>  CUserTool::SetToolIcon  \n Loads the icon for the user tool from the application that the tool uses.  \n  \n```  \nvirtual HICON SetToolIcon();\n```  \n  \n### Return Value  \n A handle to the loaded icon.  \n  \n### Remarks  \n Call this method to load the icon to be displayed on the menu item. This method searches for the icon in the executable file that the tool uses. If it does not have a default icon, the icon provided by [CUserTool::LoadDefaultIcon](#cusertool__loaddefaulticon) is used instead.  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)   \n [CWinAppEx Class](../../mfc/reference/cwinappex-class.md)   \n [CUserToolsManager Class](../../mfc/reference/cusertoolsmanager-class.md)\n"}