{"nodes":[{"pos":[12,58],"content":"IPersistPropertyBagImpl Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"IPersistPropertyBagImpl Class | Microsoft Docs","pos":[0,46]}]},{"content":"IPersistPropertyBagImpl Class","pos":[787,816]},{"pos":[817,930],"content":"This class implements <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> and allows an object to save its properties to a client-supplied property bag.","source":"This class implements **IUnknown** and allows an object to save its properties to a client-supplied property bag."},{"pos":[938,1088],"content":"[!IMPORTANT]\n This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].","leadings":["","> "],"nodes":[{"content":"This class and its members cannot be used in applications that execute in the <ph id=\"ph1\">[!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]</ph>.","pos":[14,148],"source":" This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)]."}]},{"content":"Syntax","pos":[1097,1103]},{"content":"Parameters","pos":[1221,1231]},{"content":"Your class, derived from <ph id=\"ph1\">`IPersistPropertyBagImpl`</ph>.","pos":[1242,1293],"source":" Your class, derived from `IPersistPropertyBagImpl`."},{"content":"Members","pos":[1302,1309]},{"content":"Public Methods","pos":[1319,1333]},{"content":"Name","pos":[1340,1344]},{"content":"Description","pos":[1345,1356]},{"content":"IPersistPropertyBagImpl::GetClassID","pos":[1395,1430]},{"content":"Retrieves the object's CLSID.","pos":[1470,1499]},{"content":"IPersistPropertyBagImpl::InitNew","pos":[1505,1537]},{"content":"Initializes a newly created object.","pos":[1574,1609]},{"content":"The ATL implementation returns <ph id=\"ph1\">`S_OK`</ph>.","pos":[1610,1648],"source":" The ATL implementation returns `S_OK`."},{"content":"IPersistPropertyBagImpl::Load","pos":[1654,1683]},{"content":"Loads the object's properties from a client-supplied property bag.","pos":[1717,1783]},{"content":"IPersistPropertyBagImpl::Save","pos":[1789,1818]},{"content":"Saves the object's properties into a client-supplied property bag.","pos":[1852,1918]},{"content":"Remarks","pos":[1928,1935]},{"content":"The <bpt id=\"p1\">[</bpt>IPersistPropertyBag<ept id=\"p1\">](https://msdn.microsoft.com/library/aa768205.aspx)</ept> interface allows an object to save its properties to a client-supplied property bag.","pos":[1939,2099],"source":"The [IPersistPropertyBag](https://msdn.microsoft.com/library/aa768205.aspx) interface allows an object to save its properties to a client-supplied property bag."},{"content":"Class <ph id=\"ph1\">`IPersistPropertyBagImpl`</ph> provides a default implementation of this interface and implements <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> by sending information to the dump device in debug builds.","pos":[2100,2270],"source":" Class `IPersistPropertyBagImpl` provides a default implementation of this interface and implements **IUnknown** by sending information to the dump device in debug builds."},{"content":"<bpt id=\"p1\">**</bpt>IPersistPropertyBag<ept id=\"p1\">**</ept> works in conjunction with <bpt id=\"p2\">[</bpt>IPropertyBag<ept id=\"p2\">](https://msdn.microsoft.com/library/aa768196.aspx)</ept> and <bpt id=\"p3\">[</bpt>IErrorLog<ept id=\"p3\">](https://msdn.microsoft.com/library/aa768231.aspx)</ept>.","pos":[2277,2458],"source":"**IPersistPropertyBag** works in conjunction with [IPropertyBag](https://msdn.microsoft.com/library/aa768196.aspx) and [IErrorLog](https://msdn.microsoft.com/library/aa768231.aspx)."},{"content":"These latter two interfaces must be implemented by the client.","pos":[2459,2521]},{"content":"Through <ph id=\"ph1\">`IPropertyBag`</ph>, the client saves and loads the object's individual properties.","pos":[2522,2608],"source":" Through `IPropertyBag`, the client saves and loads the object's individual properties."},{"content":"Through <bpt id=\"p1\">**</bpt>IErrorLog<ept id=\"p1\">**</ept>, both the object and the client can report any errors encountered.","pos":[2609,2697],"source":" Through **IErrorLog**, both the object and the client can report any errors encountered."},{"pos":[2704,2865],"content":"<bpt id=\"p1\">**</bpt>Related Articles<ept id=\"p1\">**</ept> <bpt id=\"p2\">[</bpt>ATL Tutorial<ept id=\"p2\">](../../atl/active-template-library-atl-tutorial.md)</ept>, <bpt id=\"p3\">[</bpt>Creating an ATL Project<ept id=\"p3\">](../../atl/reference/creating-an-atl-project.md)</ept>","source":"**Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)"},{"content":"Inheritance Hierarchy","pos":[2874,2895]},{"content":"Requirements","pos":[2961,2973]},{"pos":[2977,2997],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[3059,3094],"content":"IPersistPropertyBagImpl::GetClassID"},{"content":"Retrieves the object's CLSID.","pos":[3098,3127]},{"content":"Remarks","pos":[3190,3197]},{"pos":[3201,3347],"content":"See <bpt id=\"p1\">[</bpt>IPersist::GetClassID<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms688664)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3406,3438],"content":"IPersistPropertyBagImpl::InitNew"},{"content":"Initializes a newly created object.","pos":[3442,3477]},{"content":"Return Value","pos":[3522,3534]},{"pos":[3538,3553],"content":"Returns <ph id=\"ph1\">`S_OK`</ph>.","source":"Returns `S_OK`."},{"content":"Remarks","pos":[3563,3570]},{"pos":[3574,3718],"content":"See <bpt id=\"p1\">[</bpt>IPersistPropertyBag::InitNew<ept id=\"p1\">](https://msdn.microsoft.com/library/aa768204.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistPropertyBag::InitNew](https://msdn.microsoft.com/library/aa768204.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3774,3803],"content":"IPersistPropertyBagImpl::Load"},{"content":"Loads the object's properties from a client-supplied property bag.","pos":[3807,3873]},{"content":"Remarks","pos":[3960,3967]},{"content":"ATL uses the object's property map to retrieve this information.","pos":[3971,4035]},{"pos":[4042,4183],"content":"See <bpt id=\"p1\">[</bpt>IPersistPropertyBag::Load<ept id=\"p1\">](https://msdn.microsoft.com/library/aa768206.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistPropertyBag::Load](https://msdn.microsoft.com/library/aa768206.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[4239,4268],"content":"IPersistPropertyBagImpl::Save"},{"content":"Saves the object's properties into a client-supplied property bag.","pos":[4272,4338]},{"content":"Remarks","pos":[4453,4460]},{"content":"ATL uses the object's property map to store this information.","pos":[4464,4525]},{"content":"By default, this method saves all properties, regardless of the value of <bpt id=\"p1\">*</bpt>fSaveAllProperties<ept id=\"p1\">*</ept>.","pos":[4526,4620],"source":" By default, this method saves all properties, regardless of the value of *fSaveAllProperties*."},{"pos":[4627,4768],"content":"See <bpt id=\"p1\">[</bpt>IPersistPropertyBag::Save<ept id=\"p1\">](https://msdn.microsoft.com/library/aa768207.aspx)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"See [IPersistPropertyBag::Save](https://msdn.microsoft.com/library/aa768207.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"See Also","pos":[4777,4785]},{"content":"BEGIN_PROP_MAP","pos":[4790,4804]},{"content":"Class Overview","pos":[4883,4897]}],"content":"---\ntitle: \"IPersistPropertyBagImpl Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"IPersistPropertyBagImpl\"\n  - \"ATL.IPersistPropertyBagImpl<T>\"\n  - \"ATL::IPersistPropertyBagImpl\"\n  - \"ATL::IPersistPropertyBagImpl<T>\"\n  - \"ATL.IPersistPropertyBagImpl\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"IPersistPropertyBagImpl class\"\nms.assetid: 712af24d-99f8-40f2-9811-53b3ff6e5b19\ncaps.latest.revision: 20\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# IPersistPropertyBagImpl Class\nThis class implements **IUnknown** and allows an object to save its properties to a client-supplied property bag.  \n  \n> [!IMPORTANT]\n>  This class and its members cannot be used in applications that execute in the [!INCLUDE[wrt](../../atl/reference/includes/wrt_md.md)].  \n  \n## Syntax  \n  \n```\ntemplate <class T>  class ATL_NO_VTABLE IPersistPropertyBagImpl :  public IPersistPropertyBag\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `IPersistPropertyBagImpl`.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[IPersistPropertyBagImpl::GetClassID](#ipersistpropertybagimpl__getclassid)|Retrieves the object's CLSID.|  \n|[IPersistPropertyBagImpl::InitNew](#ipersistpropertybagimpl__initnew)|Initializes a newly created object. The ATL implementation returns `S_OK`.|  \n|[IPersistPropertyBagImpl::Load](#ipersistpropertybagimpl__load)|Loads the object's properties from a client-supplied property bag.|  \n|[IPersistPropertyBagImpl::Save](#ipersistpropertybagimpl__save)|Saves the object's properties into a client-supplied property bag.|  \n  \n## Remarks  \n The [IPersistPropertyBag](https://msdn.microsoft.com/library/aa768205.aspx) interface allows an object to save its properties to a client-supplied property bag. Class `IPersistPropertyBagImpl` provides a default implementation of this interface and implements **IUnknown** by sending information to the dump device in debug builds.  \n  \n **IPersistPropertyBag** works in conjunction with [IPropertyBag](https://msdn.microsoft.com/library/aa768196.aspx) and [IErrorLog](https://msdn.microsoft.com/library/aa768231.aspx). These latter two interfaces must be implemented by the client. Through `IPropertyBag`, the client saves and loads the object's individual properties. Through **IErrorLog**, both the object and the client can report any errors encountered.  \n  \n **Related Articles** [ATL Tutorial](../../atl/active-template-library-atl-tutorial.md), [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)  \n  \n## Inheritance Hierarchy  \n `IPersistPropertyBag`  \n  \n `IPersistPropertyBagImpl`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ipersistpropertybagimpl__getclassid\"></a>  IPersistPropertyBagImpl::GetClassID  \n Retrieves the object's CLSID.  \n  \n```\nSTDMETHOD(GetClassID)(CLSID* pClassID);\n```  \n  \n### Remarks  \n See [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersistpropertybagimpl__initnew\"></a>  IPersistPropertyBagImpl::InitNew  \n Initializes a newly created object.  \n  \n```\nSTDMETHOD(InitNew)();\n```  \n  \n### Return Value  \n Returns `S_OK`.  \n  \n### Remarks  \n See [IPersistPropertyBag::InitNew](https://msdn.microsoft.com/library/aa768204.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersistpropertybagimpl__load\"></a>  IPersistPropertyBagImpl::Load  \n Loads the object's properties from a client-supplied property bag.  \n  \n```\nSTDMETHOD(Load)(LPPROPERTYBAG pPropBag,  LPERRORLOG pErrorLog);\n```  \n  \n### Remarks  \n ATL uses the object's property map to retrieve this information.  \n  \n See [IPersistPropertyBag::Load](https://msdn.microsoft.com/library/aa768206.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"ipersistpropertybagimpl__save\"></a>  IPersistPropertyBagImpl::Save  \n Saves the object's properties into a client-supplied property bag.  \n  \n```\nSTDMETHOD(Save)(LPPROPERTYBAG pPropBag,\n    BOOL fClearDirty,\n    BOOL fSaveAllProperties);\n```  \n  \n### Remarks  \n ATL uses the object's property map to store this information. By default, this method saves all properties, regardless of the value of *fSaveAllProperties*.  \n  \n See [IPersistPropertyBag::Save](https://msdn.microsoft.com/library/aa768207.aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [BEGIN_PROP_MAP](http://msdn.microsoft.com/library/bfe30be6-62c3-4dc2-bd49-21ef96f15427)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}