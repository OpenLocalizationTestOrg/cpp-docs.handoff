{"nodes":[{"pos":[12,54],"content":"Language Specific Handler | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Language Specific Handler | Microsoft Docs","pos":[0,42]}]},{"content":"Language Specific Handler","pos":[534,559]},{"content":"The relative address of the language specific handler is present in the UNWIND_INFO whenever flags UNW_FLAG_EHANDLER or UNW_FLAG_UHANDLER are set.","pos":[560,706]},{"content":"As described in the previous section, the language specific handler is called as part of the search for an exception handler or as part of an unwind.","pos":[707,856]},{"content":"It has the following prototype:","pos":[857,888]},{"pos":[1138,1241],"content":"<bpt id=\"p1\">**</bpt>ExceptionRecord<ept id=\"p1\">**</ept> supplies a pointer to an exception record, which has the standard Win64 definition.","source":"**ExceptionRecord** supplies a pointer to an exception record, which has the standard Win64 definition."},{"pos":[1248,1344],"content":"<bpt id=\"p1\">**</bpt>EstablisherFrame<ept id=\"p1\">**</ept> is the address of the base of the fixed stack allocation for this function.","source":"**EstablisherFrame** is the address of the base of the fixed stack allocation for this function."},{"pos":[1351,1536],"content":"<bpt id=\"p1\">**</bpt>ContextRecord<ept id=\"p1\">**</ept> points to the exception context at the time the exception was raised (in the exception handler case) or the current \"unwind\" context (in the termination handler case).","source":"**ContextRecord** points to the exception context at the time the exception was raised (in the exception handler case) or the current \"unwind\" context (in the termination handler case)."},{"content":"<bpt id=\"p1\">**</bpt>DispatcherContext<ept id=\"p1\">**</ept> points to the dispatcher context for this function.","pos":[1543,1616],"source":"**DispatcherContext** points to the dispatcher context for this function."},{"content":"It has the following definition:","pos":[1617,1649]},{"content":"<bpt id=\"p1\">**</bpt>ControlPc<ept id=\"p1\">**</ept> is the value of RIP within this function.","pos":[1998,2053],"source":"**ControlPc** is the value of RIP within this function."},{"content":"This is either an exception address or the address at which control left the establishing function.","pos":[2054,2153]},{"content":"This is the RIP that will be used to determine if control is within some guarded construct within this function (for example, a __try block for <ph id=\"ph1\">\\_</ph>_try/<ph id=\"ph2\">\\_</ph>_except or <ph id=\"ph3\">\\_</ph>_try/<ph id=\"ph4\">\\_</ph>_finally).","pos":[2154,2337],"source":" This is the RIP that will be used to determine if control is within some guarded construct within this function (for example, a __try block for \\__try/\\__except or \\__try/\\__finally)."},{"pos":[2344,2537],"content":"<bpt id=\"p1\">**</bpt>ImageBase<ept id=\"p1\">**</ept> is the image base (load address) of the module containing this function, to be added to the 32-bit offsets used in the function entry and unwind info to record relative addresses.","source":"**ImageBase** is the image base (load address) of the module containing this function, to be added to the 32-bit offsets used in the function entry and unwind info to record relative addresses."},{"pos":[2544,2705],"content":"<bpt id=\"p1\">**</bpt>FunctionEntry<ept id=\"p1\">**</ept> supplies a pointer to the RUNTIME_FUNCTION function entry holding the function and unwind info image-base relative addresses for this function.","source":"**FunctionEntry** supplies a pointer to the RUNTIME_FUNCTION function entry holding the function and unwind info image-base relative addresses for this function."},{"pos":[2712,2808],"content":"<bpt id=\"p1\">**</bpt>EstablisherFrame<ept id=\"p1\">**</ept> is the address of the base of the fixed stack allocation for this function.","source":"**EstablisherFrame** is the address of the base of the fixed stack allocation for this function."},{"content":"<bpt id=\"p1\">**</bpt>TargetIp<ept id=\"p1\">**</ept> Supplies an optional instruction address that specifies the continuation address of the unwind.","pos":[2815,2923],"source":"**TargetIp** Supplies an optional instruction address that specifies the continuation address of the unwind."},{"content":"This address is ignored if <bpt id=\"p1\">**</bpt>EstablisherFrame<ept id=\"p1\">**</ept> is not specified.","pos":[2924,2989],"source":" This address is ignored if **EstablisherFrame** is not specified."},{"pos":[2996,3100],"content":"<bpt id=\"p1\">**</bpt>ContextRecord<ept id=\"p1\">**</ept> points to the exception context, for use by the system exception dispatch/unwind code.","source":"**ContextRecord** points to the exception context, for use by the system exception dispatch/unwind code."},{"pos":[3107,3197],"content":"<bpt id=\"p1\">**</bpt>LanguageHandler<ept id=\"p1\">**</ept> points to the language-specific language handler routine being called.","source":"**LanguageHandler** points to the language-specific language handler routine being called."},{"pos":[3204,3283],"content":"<bpt id=\"p1\">**</bpt>HandlerData<ept id=\"p1\">**</ept> points to the language-specific handler data for this function.","source":"**HandlerData** points to the language-specific handler data for this function."},{"content":"See Also","pos":[3292,3300]},{"content":"Exception Handling (x64)","pos":[3305,3329]}],"content":"---\ntitle: \"Language Specific Handler | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nms.assetid: 6503e0cd-2d3a-4330-a925-8bed8c27c2be\ncaps.latest.revision: 9\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Language Specific Handler\nThe relative address of the language specific handler is present in the UNWIND_INFO whenever flags UNW_FLAG_EHANDLER or UNW_FLAG_UHANDLER are set. As described in the previous section, the language specific handler is called as part of the search for an exception handler or as part of an unwind. It has the following prototype:  \n  \n```  \ntypedef EXCEPTION_DISPOSITION (*PEXCEPTION_ROUTINE) (  \n    IN PEXCEPTION_RECORD ExceptionRecord,  \n    IN ULONG64 EstablisherFrame,  \n    IN OUT PCONTEXT ContextRecord,  \n    IN OUT PDISPATCHER_CONTEXT DispatcherContext  \n);  \n```  \n  \n **ExceptionRecord** supplies a pointer to an exception record, which has the standard Win64 definition.  \n  \n **EstablisherFrame** is the address of the base of the fixed stack allocation for this function.  \n  \n **ContextRecord** points to the exception context at the time the exception was raised (in the exception handler case) or the current \"unwind\" context (in the termination handler case).  \n  \n **DispatcherContext** points to the dispatcher context for this function. It has the following definition:  \n  \n```  \ntypedef struct _DISPATCHER_CONTEXT {  \n    ULONG64 ControlPc;  \n    ULONG64 ImageBase;  \n    PRUNTIME_FUNCTION FunctionEntry;  \n    ULONG64 EstablisherFrame;  \n    ULONG64 TargetIp;  \n    PCONTEXT ContextRecord;  \n    PEXCEPTION_ROUTINE LanguageHandler;  \n    PVOID HandlerData;  \n} DISPATCHER_CONTEXT, *PDISPATCHER_CONTEXT;  \n```  \n  \n **ControlPc** is the value of RIP within this function. This is either an exception address or the address at which control left the establishing function. This is the RIP that will be used to determine if control is within some guarded construct within this function (for example, a __try block for \\__try/\\__except or \\__try/\\__finally).  \n  \n **ImageBase** is the image base (load address) of the module containing this function, to be added to the 32-bit offsets used in the function entry and unwind info to record relative addresses.  \n  \n **FunctionEntry** supplies a pointer to the RUNTIME_FUNCTION function entry holding the function and unwind info image-base relative addresses for this function.  \n  \n **EstablisherFrame** is the address of the base of the fixed stack allocation for this function.  \n  \n **TargetIp** Supplies an optional instruction address that specifies the continuation address of the unwind. This address is ignored if **EstablisherFrame** is not specified.  \n  \n **ContextRecord** points to the exception context, for use by the system exception dispatch/unwind code.  \n  \n **LanguageHandler** points to the language-specific language handler routine being called.  \n  \n **HandlerData** points to the language-specific handler data for this function.  \n  \n## See Also  \n [Exception Handling (x64)](../build/exception-handling-x64.md)"}