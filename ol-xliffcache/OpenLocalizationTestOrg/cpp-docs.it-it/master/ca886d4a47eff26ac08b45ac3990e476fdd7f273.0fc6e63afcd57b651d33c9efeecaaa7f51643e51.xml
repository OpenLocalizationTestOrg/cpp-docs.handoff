{"nodes":[{"pos":[12,71],"content":"CString Formatting and Message-Box Display | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CString Formatting and Message-Box Display | Microsoft Docs","pos":[0,59]}]},{"content":"CString Formatting and Message-Box Display","pos":[668,710]},{"content":"A number of functions are provided to format and parse <ph id=\"ph1\">`CString`</ph> objects.","pos":[711,784],"source":"A number of functions are provided to format and parse `CString` objects."},{"content":"You can use these functions whenever you have to manipulate <ph id=\"ph1\">`CString`</ph> objects, but they are particularly useful for formatting strings that will appear in message-box text.","pos":[785,957],"source":" You can use these functions whenever you have to manipulate `CString` objects, but they are particularly useful for formatting strings that will appear in message-box text."},{"content":"This group of functions also includes a global routine for displaying a message box.","pos":[964,1048]},{"content":"CString Functions","pos":[1058,1075]},{"content":"AfxExtractSubString","pos":[1097,1116]},{"content":"Extracts substrings separated by a single character from a given source string.","pos":[1140,1219]},{"content":"AfxFormatString1","pos":[1225,1241]},{"content":"Substitutes a given string for the format characters \"%1\" in a string contained in the string table.","pos":[1262,1362]},{"content":"AfxFormatString2","pos":[1368,1384]},{"content":"Substitutes two strings for the format characters \"%1\" and \"%2\" in a string contained in the string table.","pos":[1405,1511]},{"content":"AfxMessageBox","pos":[1517,1530]},{"content":"Displays a message box.","pos":[1548,1571]},{"pos":[1618,1637],"content":"AfxExtractSubString"},{"content":"This global function can be used to extract a substring from a given source string.","pos":[1641,1724]},{"content":"Parameters","pos":[1887,1897]},{"content":"rString","pos":[1902,1909]},{"pos":[1918,2031],"content":"Reference to a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/using-cstring.md)</ept> object that will receive an individual substring.","source":"Reference to a [CString](../../atl-mfc-shared/using-cstring.md) object that will receive an individual substring."},{"content":"lpszFullString","pos":[2039,2053]},{"content":"String containing the full text of the string to extract from.","pos":[2062,2124]},{"content":"iSubString","pos":[2132,2142]},{"pos":[2151,2218],"content":"Zero-based index of the substring to extract from <bpt id=\"p1\">*</bpt>lpszFullString<ept id=\"p1\">*</ept>.","source":"Zero-based index of the substring to extract from *lpszFullString*."},{"content":"chSep","pos":[2226,2231]},{"content":"Separator character used to delimit substrings.","pos":[2240,2287]},{"content":"Return Value","pos":[2297,2309]},{"pos":[2313,2419],"content":"<bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if the function successfully extracted the substring at the provided index; otherwise, <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","source":"**TRUE** if the function successfully extracted the substring at the provided index; otherwise, **FALSE**."},{"content":"Remarks","pos":[2429,2436]},{"content":"This function is useful for extracting multiple substrings from a source string when a known single character separates each substring.","pos":[2440,2575]},{"content":"This function searches from the beginning of the <ph id=\"ph1\">`lpszFullString`</ph> parameter each time it is called.","pos":[2576,2675],"source":" This function searches from the beginning of the `lpszFullString` parameter each time it is called."},{"content":"This function will return FALSE if either <ph id=\"ph1\">`lpszFullString`</ph> is set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or the function reaches the end of <ph id=\"ph2\">`lpszFullString`</ph> without finding <ph id=\"ph3\">`iSubString`</ph>+1 occurrences of the specified separator character.","pos":[2682,2892],"source":"This function will return FALSE if either `lpszFullString` is set to **NULL** or the function reaches the end of `lpszFullString` without finding `iSubString`+1 occurrences of the specified separator character."},{"content":"The <ph id=\"ph1\">`rString`</ph> parameter will not be modified from its original value if <ph id=\"ph2\">`lpszFullString`</ph> was set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>; otherwise, the <ph id=\"ph3\">`rString`</ph> parameter is set to the empty string if the substring could not be extracted for the specified index.","pos":[2893,3129],"source":" The `rString` parameter will not be modified from its original value if `lpszFullString` was set to **NULL**; otherwise, the `rString` parameter is set to the empty string if the substring could not be extracted for the specified index."},{"content":"Example","pos":[3139,3146]},{"pos":[3161,3181],"content":"NVC_MFC_Utilities#48"},{"pos":[3302,3318],"content":"AfxFormatString1"},{"pos":[3322,3461],"content":"Substitutes the string pointed to by <ph id=\"ph1\">`lpsz1`</ph> for any instances of the characters \"%1\" in the template string resource identified by <ph id=\"ph2\">`nIDS`</ph>.","source":"Substitutes the string pointed to by `lpsz1` for any instances of the characters \"%1\" in the template string resource identified by `nIDS`."},{"content":"Parameters","pos":[3572,3582]},{"content":"A reference to a <ph id=\"ph1\">`CString`</ph> object that will contain the resultant string after the substitution is performed.","pos":[3599,3708],"source":" A reference to a `CString` object that will contain the resultant string after the substitution is performed."},{"content":"The resource ID of the template string on which the substitution will be performed.","pos":[3725,3808]},{"content":"A string that will replace the format characters \"%1\" in the template string.","pos":[3826,3903]},{"content":"Remarks","pos":[3913,3920]},{"content":"The newly formed string is stored in <ph id=\"ph1\">`rString`</ph>.","pos":[3924,3971],"source":"The newly formed string is stored in `rString`."},{"content":"For example, if the string in the string table is \"File %1 not found\", and <ph id=\"ph1\">`lpsz1`</ph> is equal to \"C:\\MYFILE.TXT\", then <ph id=\"ph2\">`rString`</ph> will contain the string \"File C:\\MYFILE.TXT not found\".","pos":[3972,4154],"source":" For example, if the string in the string table is \"File %1 not found\", and `lpsz1` is equal to \"C:\\MYFILE.TXT\", then `rString` will contain the string \"File C:\\MYFILE.TXT not found\"."},{"content":"This function is useful for formatting strings sent to message boxes and other windows.","pos":[4155,4242]},{"content":"If the format characters \"%1\" appear in the string more than once, multiple substitutions will be made.","pos":[4249,4352]},{"content":"Example","pos":[4362,4369]},{"pos":[4384,4404],"content":"NVC_MFC_Utilities#25"},{"pos":[4525,4541],"content":"AfxFormatString2"},{"pos":[4545,4764],"content":"Substitutes the string pointed to by <ph id=\"ph1\">`lpsz1`</ph> for any instances of the characters \"%1\", and the string pointed to by <ph id=\"ph2\">`lpsz2`</ph> for any instances of the characters \"%2\", in the template string resource identified by <ph id=\"ph3\">`nIDS`</ph>.","source":"Substitutes the string pointed to by `lpsz1` for any instances of the characters \"%1\", and the string pointed to by `lpsz2` for any instances of the characters \"%2\", in the template string resource identified by `nIDS`."},{"content":"Parameters","pos":[4896,4906]},{"content":"A reference to the <ph id=\"ph1\">`CString`</ph> that will contain the resultant string after the substitution is performed.","pos":[4923,5027],"source":" A reference to the `CString` that will contain the resultant string after the substitution is performed."},{"content":"The string table ID of the template string on which the substitution will be performed.","pos":[5044,5131]},{"content":"A string that will replace the format characters \"%1\" in the template string.","pos":[5149,5226]},{"content":"A string that will replace the format characters \"%2\" in the template string.","pos":[5244,5321]},{"content":"Remarks","pos":[5331,5338]},{"content":"The newly formed string is stored in <ph id=\"ph1\">`rString`</ph>.","pos":[5342,5389],"source":"The newly formed string is stored in `rString`."},{"content":"For example, if the string in the string table is \"File %1 not found in directory %2\", <ph id=\"ph1\">`lpsz1`</ph> points to \"MYFILE.TXT\", and <ph id=\"ph2\">`lpsz2`</ph> points to \"C:\\MYDIR\", then <ph id=\"ph3\">`rString`</ph> will contain the string \"File MYFILE.TXT not found in directory C:\\MYDIR\"","pos":[5390,5631],"source":" For example, if the string in the string table is \"File %1 not found in directory %2\", `lpsz1` points to \"MYFILE.TXT\", and `lpsz2` points to \"C:\\MYDIR\", then `rString` will contain the string \"File MYFILE.TXT not found in directory C:\\MYDIR\""},{"content":"If the format characters \"%1\" or \"%2\" appear in the string more than once, multiple substitutions will be made.","pos":[5638,5749]},{"content":"They do not have to be in numerical order.","pos":[5750,5792]},{"content":"Example","pos":[5802,5809]},{"pos":[5824,5844],"content":"NVC_MFC_Utilities#26"},{"pos":[5962,5975],"content":"AfxMessageBox"},{"content":"Displays a message box on the screen.","pos":[5979,6016]},{"content":"Parameters","pos":[6240,6250]},{"content":"Points to a <ph id=\"ph1\">`CString`</ph> object or null-terminated string containing the message to be displayed in the message box.","pos":[6268,6381],"source":" Points to a `CString` object or null-terminated string containing the message to be displayed in the message box."},{"content":"The style of the message box.","pos":[6399,6428]},{"content":"Apply any of the <bpt id=\"p1\">[</bpt>message-box styles<ept id=\"p1\">](../../mfc/reference/message-box-styles.md)</ept> to the box.","pos":[6429,6521],"source":" Apply any of the [message-box styles](../../mfc/reference/message-box-styles.md) to the box."},{"content":"The Help context ID for the message; 0 indicates the application's default Help context will be used.","pos":[6541,6642]},{"content":"A unique ID used to reference a string in the string table.","pos":[6664,6723]},{"content":"Return Value","pos":[6733,6745]},{"content":"Zero if there is not enough memory to display the message box; otherwise, one of the following values is returned:","pos":[6749,6863]},{"pos":[6871,6913],"content":"<bpt id=\"p1\">**</bpt>IDABORT<ept id=\"p1\">**</ept> The Abort button was selected.","source":"**IDABORT** The Abort button was selected."},{"pos":[6921,6965],"content":"<bpt id=\"p1\">**</bpt>IDCANCEL<ept id=\"p1\">**</ept> The Cancel button was selected.","source":"**IDCANCEL** The Cancel button was selected."},{"pos":[6973,7017],"content":"<bpt id=\"p1\">**</bpt>IDIGNORE<ept id=\"p1\">**</ept> The Ignore button was selected.","source":"**IDIGNORE** The Ignore button was selected."},{"pos":[7025,7061],"content":"<bpt id=\"p1\">**</bpt>IDNO<ept id=\"p1\">**</ept> The No button was selected.","source":"**IDNO** The No button was selected."},{"pos":[7069,7105],"content":"<bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept> The OK button was selected.","source":"**IDOK** The OK button was selected."},{"pos":[7113,7155],"content":"<bpt id=\"p1\">**</bpt>IDRETRY<ept id=\"p1\">**</ept> The Retry button was selected.","source":"**IDRETRY** The Retry button was selected."},{"pos":[7163,7201],"content":"<bpt id=\"p1\">**</bpt>IDYES<ept id=\"p1\">**</ept> The Yes button was selected.","source":"**IDYES** The Yes button was selected."},{"content":"If a message box has a Cancel button, the <bpt id=\"p1\">**</bpt>IDCANCEL<ept id=\"p1\">**</ept> value will be returned if either the ESC key is pressed or the Cancel button is selected.","pos":[7208,7352],"source":"If a message box has a Cancel button, the **IDCANCEL** value will be returned if either the ESC key is pressed or the Cancel button is selected."},{"content":"If the message box has no Cancel button, pressing the ESC key has no effect.","pos":[7353,7429]},{"pos":[7436,7593],"content":"The functions <bpt id=\"p1\">[</bpt>AfxFormatString1<ept id=\"p1\">](#afxformatstring1)</ept> and <bpt id=\"p2\">[</bpt>AfxFormatString2<ept id=\"p2\">](#afxformatstring2)</ept> can be useful in formatting text that appears in a message box.","source":"The functions [AfxFormatString1](#afxformatstring1) and [AfxFormatString2](#afxformatstring2) can be useful in formatting text that appears in a message box."},{"content":"Remarks","pos":[7603,7610]},{"content":"The first form of this overloaded function displays a text string pointed to by <ph id=\"ph1\">`lpszText`</ph> in the message box and uses <ph id=\"ph2\">`nIDHelp`</ph> to describe a Help context.","pos":[7614,7770],"source":"The first form of this overloaded function displays a text string pointed to by `lpszText` in the message box and uses `nIDHelp` to describe a Help context."},{"content":"The Help context is used to jump to an associated Help topic when the user presses the Help key (typically F1).","pos":[7771,7882]},{"content":"The second form of the function uses the string resource with the ID <ph id=\"ph1\">`nIDPrompt`</ph> to display a message in the message box.","pos":[7889,8010],"source":"The second form of the function uses the string resource with the ID `nIDPrompt` to display a message in the message box."},{"content":"The associated Help page is found through the value of <ph id=\"ph1\">`nIDHelp`</ph>.","pos":[8011,8076],"source":" The associated Help page is found through the value of `nIDHelp`."},{"content":"If the default value of <ph id=\"ph1\">`nIDHelp`</ph> is used (â€“ 1), the string resource ID, <ph id=\"ph2\">`nIDPrompt`</ph>, is used for the Help context.","pos":[8077,8194],"source":" If the default value of `nIDHelp` is used (â€“ 1), the string resource ID, `nIDPrompt`, is used for the Help context."},{"content":"For more information about defining Help contexts, see <bpt id=\"p1\">[</bpt>Technical Note 28<ept id=\"p1\">](../../mfc/tn028-context-sensitive-help-support.md)</ept>.","pos":[8195,8321],"source":" For more information about defining Help contexts, see [Technical Note 28](../../mfc/tn028-context-sensitive-help-support.md)."},{"content":"Example","pos":[8331,8338]},{"pos":[8353,8373],"content":"NVC_MFCWindowing#133"},{"content":"See Also","pos":[8470,8478]},{"content":"Macros and Globals","pos":[8483,8501]},{"content":"CStringT Class","pos":[8555,8569]}],"content":"---\ntitle: \"CString Formatting and Message-Box Display | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.mfc.macros.strings\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CString objects, formatting and message boxes\"\nms.assetid: d1068cf4-9cc5-4952-b9e7-d612c53cbc28\ncaps.latest.revision: 14\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CString Formatting and Message-Box Display\nA number of functions are provided to format and parse `CString` objects. You can use these functions whenever you have to manipulate `CString` objects, but they are particularly useful for formatting strings that will appear in message-box text.  \n  \n This group of functions also includes a global routine for displaying a message box.  \n  \n### CString Functions  \n  \n|||  \n|-|-|  \n|[AfxExtractSubString](#afxextractsubstring)|Extracts substrings separated by a single character from a given source string.|  \n|[AfxFormatString1](#afxformatstring1)|Substitutes a given string for the format characters \"%1\" in a string contained in the string table.|  \n|[AfxFormatString2](#afxformatstring2)|Substitutes two strings for the format characters \"%1\" and \"%2\" in a string contained in the string table.|  \n|[AfxMessageBox](#afxmessagebox)|Displays a message box.|  \n  \n##  <a name=\"afxextractsubstring\"></a>  AfxExtractSubString  \n This global function can be used to extract a substring from a given source string.  \n  \n```   \nBOOL AFXAPI AfxExtractSubString (\n    CString& rString,  \n    LPCTSTR lpszFullString,  \n    int iSubString,  \n    TCHAR chSep  = '\\n'); \n```  \n  \n### Parameters  \n *rString*  \n -   Reference to a [CString](../../atl-mfc-shared/using-cstring.md) object that will receive an individual substring.  \n  \n *lpszFullString*  \n -   String containing the full text of the string to extract from.  \n  \n *iSubString*  \n -   Zero-based index of the substring to extract from *lpszFullString*.  \n  \n *chSep*  \n -   Separator character used to delimit substrings.  \n  \n### Return Value  \n **TRUE** if the function successfully extracted the substring at the provided index; otherwise, **FALSE**.  \n  \n### Remarks  \n This function is useful for extracting multiple substrings from a source string when a known single character separates each substring. This function searches from the beginning of the `lpszFullString` parameter each time it is called.  \n  \n This function will return FALSE if either `lpszFullString` is set to **NULL** or the function reaches the end of `lpszFullString` without finding `iSubString`+1 occurrences of the specified separator character. The `rString` parameter will not be modified from its original value if `lpszFullString` was set to **NULL**; otherwise, the `rString` parameter is set to the empty string if the substring could not be extracted for the specified index.  \n  \n### Example  \n [!code-cpp[NVC_MFC_Utilities#48](../../mfc/codesnippet/cpp/cstring-formatting-and-message-box-display_1.cpp)]  \n  \n##  <a name=\"afxformatstring1\"></a>  AfxFormatString1  \n Substitutes the string pointed to by `lpsz1` for any instances of the characters \"%1\" in the template string resource identified by `nIDS`.  \n  \n```  \nvoid  AfxFormatString1(\n    CString& rString,  \n    UINT nIDS,  \n    LPCTSTR lpsz1); \n```  \n  \n### Parameters  \n `rString`  \n A reference to a `CString` object that will contain the resultant string after the substitution is performed.  \n  \n `nIDS`  \n The resource ID of the template string on which the substitution will be performed.  \n  \n `lpsz1`  \n A string that will replace the format characters \"%1\" in the template string.  \n  \n### Remarks  \n The newly formed string is stored in `rString`. For example, if the string in the string table is \"File %1 not found\", and `lpsz1` is equal to \"C:\\MYFILE.TXT\", then `rString` will contain the string \"File C:\\MYFILE.TXT not found\". This function is useful for formatting strings sent to message boxes and other windows.  \n  \n If the format characters \"%1\" appear in the string more than once, multiple substitutions will be made.  \n  \n### Example  \n [!code-cpp[NVC_MFC_Utilities#25](../../mfc/codesnippet/cpp/cstring-formatting-and-message-box-display_2.cpp)]  \n  \n##  <a name=\"afxformatstring2\"></a>  AfxFormatString2  \n Substitutes the string pointed to by `lpsz1` for any instances of the characters \"%1\", and the string pointed to by `lpsz2` for any instances of the characters \"%2\", in the template string resource identified by `nIDS`.  \n  \n```   \nvoid AfxFormatString2(\n    CString& rString,  \n    UINT nIDS,  \n    LPCTSTR lpsz1,  \n    LPCTSTR lpsz2); \n```  \n  \n### Parameters  \n `rString`  \n A reference to the `CString` that will contain the resultant string after the substitution is performed.  \n  \n `nIDS`  \n The string table ID of the template string on which the substitution will be performed.  \n  \n `lpsz1`  \n A string that will replace the format characters \"%1\" in the template string.  \n  \n `lpsz2`  \n A string that will replace the format characters \"%2\" in the template string.  \n  \n### Remarks  \n The newly formed string is stored in `rString`. For example, if the string in the string table is \"File %1 not found in directory %2\", `lpsz1` points to \"MYFILE.TXT\", and `lpsz2` points to \"C:\\MYDIR\", then `rString` will contain the string \"File MYFILE.TXT not found in directory C:\\MYDIR\"  \n  \n If the format characters \"%1\" or \"%2\" appear in the string more than once, multiple substitutions will be made. They do not have to be in numerical order.  \n  \n### Example  \n [!code-cpp[NVC_MFC_Utilities#26](../../mfc/codesnippet/cpp/cstring-formatting-and-message-box-display_3.cpp)]  \n  \n##  <a name=\"afxmessagebox\"></a>  AfxMessageBox  \n Displays a message box on the screen.  \n  \n```  \nint AfxMessageBox(\n    LPCTSTR lpszText,  \n    UINT nType = MB_OK,  \n    UINT nIDHelp = 0);\n\nint AFXAPI AfxMessageBox(\n    UINT nIDPrompt,  \n    UINT nType = MB_OK,  \n    UINT nIDHelp = (UINT) -1); \n```  \n  \n### Parameters  \n `lpszText`  \n Points to a `CString` object or null-terminated string containing the message to be displayed in the message box.  \n  \n `nType`  \n The style of the message box. Apply any of the [message-box styles](../../mfc/reference/message-box-styles.md) to the box.  \n  \n `nIDHelp`  \n The Help context ID for the message; 0 indicates the application's default Help context will be used.  \n  \n `nIDPrompt`  \n A unique ID used to reference a string in the string table.  \n  \n### Return Value  \n Zero if there is not enough memory to display the message box; otherwise, one of the following values is returned:  \n  \n- **IDABORT** The Abort button was selected.  \n  \n- **IDCANCEL** The Cancel button was selected.  \n  \n- **IDIGNORE** The Ignore button was selected.  \n  \n- **IDNO** The No button was selected.  \n  \n- **IDOK** The OK button was selected.  \n  \n- **IDRETRY** The Retry button was selected.  \n  \n- **IDYES** The Yes button was selected.  \n  \n If a message box has a Cancel button, the **IDCANCEL** value will be returned if either the ESC key is pressed or the Cancel button is selected. If the message box has no Cancel button, pressing the ESC key has no effect.  \n  \n The functions [AfxFormatString1](#afxformatstring1) and [AfxFormatString2](#afxformatstring2) can be useful in formatting text that appears in a message box.  \n  \n### Remarks  \n The first form of this overloaded function displays a text string pointed to by `lpszText` in the message box and uses `nIDHelp` to describe a Help context. The Help context is used to jump to an associated Help topic when the user presses the Help key (typically F1).  \n  \n The second form of the function uses the string resource with the ID `nIDPrompt` to display a message in the message box. The associated Help page is found through the value of `nIDHelp`. If the default value of `nIDHelp` is used (â€“ 1), the string resource ID, `nIDPrompt`, is used for the Help context. For more information about defining Help contexts, see [Technical Note 28](../../mfc/tn028-context-sensitive-help-support.md).  \n  \n### Example  \n [!code-cpp[NVC_MFCWindowing#133](../../mfc/reference/codesnippet/cpp/cstring-formatting-and-message-box-display_4.cpp)]  \n  \n## See Also  \n [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)   \n [CStringT Class](../../atl-mfc-shared/reference/cstringt-class.md)\n"}