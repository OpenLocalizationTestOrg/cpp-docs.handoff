{"nodes":[{"pos":[12,62],"content":"Recordset: Sorting Records (ODBC) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Recordset: Sorting Records (ODBC) | Microsoft Docs","pos":[0,50]}]},{"content":"Recordset: Sorting Records (ODBC)","pos":[656,689]},{"content":"This topic applies to the MFC ODBC classes.","pos":[690,733]},{"content":"This topic explains how to sort your recordset.","pos":[740,787]},{"content":"You can specify one or more columns on which to base the sort, and you can specify ascending or descending order (<ph id=\"ph1\">`ASC`</ph> or <bpt id=\"p1\">**</bpt>DESC<ept id=\"p1\">**</ept>; <ph id=\"ph2\">`ASC`</ph> is the default) for each specified column.","pos":[788,969],"source":" You can specify one or more columns on which to base the sort, and you can specify ascending or descending order (`ASC` or **DESC**; `ASC` is the default) for each specified column."},{"content":"For example, if you specify two columns, the records are sorted first on the first column named and then on the second column named.","pos":[970,1102]},{"content":"A SQL <bpt id=\"p1\">**</bpt>ORDER BY<ept id=\"p1\">**</ept> clause defines a sort.","pos":[1103,1144],"source":" A SQL **ORDER BY** clause defines a sort."},{"content":"When the framework appends the <bpt id=\"p1\">**</bpt>ORDER BY<ept id=\"p1\">**</ept> clause to the recordset's SQL query, the clause controls the selection's ordering.","pos":[1145,1271],"source":" When the framework appends the **ORDER BY** clause to the recordset's SQL query, the clause controls the selection's ordering."},{"pos":[1278,1546],"content":"You must establish a recordset's sort order after you construct the object but before you call its <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> member function (or before you call the <bpt id=\"p2\">**</bpt>Requery<ept id=\"p2\">**</ept> member function for an existing recordset object whose <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept> member function has been called previously).","source":"You must establish a recordset's sort order after you construct the object but before you call its **Open** member function (or before you call the **Requery** member function for an existing recordset object whose **Open** member function has been called previously)."},{"content":"To specify a sort order for a recordset object","pos":[1557,1603]},{"pos":[1613,1699],"content":"Construct a new recordset object (or prepare to call <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> for an existing one).","source":"Construct a new recordset object (or prepare to call **Requery** for an existing one)."},{"pos":[1709,1826],"content":"Set the value of the object's <bpt id=\"p1\">[</bpt>m_strSort<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__m_strsort)</ept> data member.","source":"Set the value of the object's [m_strSort](../../mfc/reference/crecordset-class.md#crecordset__m_strsort) data member."},{"content":"The sort is a null-terminated string.","pos":[1837,1874]},{"content":"It contains the contents of the <bpt id=\"p1\">**</bpt>ORDER BY<ept id=\"p1\">**</ept> clause but not the keyword <bpt id=\"p2\">**</bpt>ORDER BY<ept id=\"p2\">**</ept>.","pos":[1875,1960],"source":" It contains the contents of the **ORDER BY** clause but not the keyword **ORDER BY**."},{"content":"For example, use:","pos":[1961,1978]},{"content":"not","pos":[2073,2076]},{"content":"Set any other options you need, such as a filter, locking mode, or parameters.","pos":[2179,2257]},{"pos":[2267,2340],"content":"Call <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> for the new object (or <bpt id=\"p2\">**</bpt>Requery<ept id=\"p2\">**</ept> for an existing object).","source":"Call **Open** for the new object (or **Requery** for an existing object)."},{"content":"The selected records are ordered as specified.","pos":[2347,2393]},{"content":"For example, to sort a set of student records in descending order by last name, then first name, do the following:","pos":[2394,2508]},{"content":"The recordset contains all of the student records, sorted in descending order (Z to A) by last name, then by first name.","pos":[2730,2850]},{"pos":[2858,3041],"content":"[!NOTE]\n If you choose to override the recordset's default SQL string by passing your own SQL string to **Open**, do not set a sort if your custom string has an **ORDER BY** clause.","leadings":["","> "],"nodes":[{"content":"If you choose to override the recordset's default SQL string by passing your own SQL string to <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>, do not set a sort if your custom string has an <bpt id=\"p2\">**</bpt>ORDER BY<ept id=\"p2\">**</ept> clause.","pos":[9,181],"source":" If you choose to override the recordset's default SQL string by passing your own SQL string to **Open**, do not set a sort if your custom string has an **ORDER BY** clause."}]},{"content":"See Also","pos":[3050,3058]},{"content":"Recordset (ODBC)","pos":[3063,3079]},{"content":"Recordset: Parameterizing a Recordset (ODBC)","pos":[3121,3165]},{"content":"Recordset: Filtering Records (ODBC)","pos":[3234,3269]}],"content":"---\ntitle: \"Recordset: Sorting Records (ODBC) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"sorting data, recordset data\"\n  - \"ODBC recordsets, sorting\"\n  - \"recordsets, sorting\"\nms.assetid: b40b152e-0a91-452e-be7b-e5bc27f744c7\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Recordset: Sorting Records (ODBC)\nThis topic applies to the MFC ODBC classes.  \n  \n This topic explains how to sort your recordset. You can specify one or more columns on which to base the sort, and you can specify ascending or descending order (`ASC` or **DESC**; `ASC` is the default) for each specified column. For example, if you specify two columns, the records are sorted first on the first column named and then on the second column named. A SQL **ORDER BY** clause defines a sort. When the framework appends the **ORDER BY** clause to the recordset's SQL query, the clause controls the selection's ordering.  \n  \n You must establish a recordset's sort order after you construct the object but before you call its **Open** member function (or before you call the **Requery** member function for an existing recordset object whose **Open** member function has been called previously).  \n  \n#### To specify a sort order for a recordset object  \n  \n1.  Construct a new recordset object (or prepare to call **Requery** for an existing one).  \n  \n2.  Set the value of the object's [m_strSort](../../mfc/reference/crecordset-class.md#crecordset__m_strsort) data member.  \n  \n     The sort is a null-terminated string. It contains the contents of the **ORDER BY** clause but not the keyword **ORDER BY**. For example, use:  \n  \n    ```  \n    recordset.m_strSort = \"LastName DESC, FirstName DESC\";  \n    ```  \n  \n     not  \n  \n    ```  \n    recordset.m_strSort = \"ORDER BY LastName DESC, FirstName DESC\";  \n    ```  \n  \n3.  Set any other options you need, such as a filter, locking mode, or parameters.  \n  \n4.  Call **Open** for the new object (or **Requery** for an existing object).  \n  \n The selected records are ordered as specified. For example, to sort a set of student records in descending order by last name, then first name, do the following:  \n  \n```  \n// Construct the recordset  \nCStudentSet rsStudent( NULL );  \n// Set the sort  \nrsStudent.m_strSort = \"LastName DESC, FirstName DESC\";  \n// Run the query with the sort in place  \nrsStudent.Open( );  \n```  \n  \n The recordset contains all of the student records, sorted in descending order (Z to A) by last name, then by first name.  \n  \n> [!NOTE]\n>  If you choose to override the recordset's default SQL string by passing your own SQL string to **Open**, do not set a sort if your custom string has an **ORDER BY** clause.  \n  \n## See Also  \n [Recordset (ODBC)](../../data/odbc/recordset-odbc.md)   \n [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)   \n [Recordset: Filtering Records (ODBC)](../../data/odbc/recordset-filtering-records-odbc.md)"}