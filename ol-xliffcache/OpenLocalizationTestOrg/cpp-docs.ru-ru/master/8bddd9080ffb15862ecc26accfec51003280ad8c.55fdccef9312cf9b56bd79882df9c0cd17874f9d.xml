{"nodes":[{"pos":[12,46],"content":"CDataSource::Open | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CDataSource::Open | Microsoft Docs","pos":[0,34]}]},{"content":"CDataSource::Open","pos":[684,701]},{"pos":[702,840],"content":"Opens a connection to a data source using a <bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>ProgID<ept id=\"p2\">**</ept>, or <ph id=\"ph1\">`CEnumerator`</ph> moniker or prompts the user with a locator dialog box.","source":"Opens a connection to a data source using a **CLSID**, **ProgID**, or `CEnumerator` moniker or prompts the user with a locator dialog box."},{"content":"Syntax","pos":[849,855]},{"content":"Parameters","pos":[2166,2176]},{"content":"[in] The <bpt id=\"p1\">**</bpt>CLSID<ept id=\"p1\">**</ept> of the data provider.","pos":[2191,2231],"source":" [in] The **CLSID** of the data provider."},{"content":"pPropSet","pos":[2239,2247]},{"content":"[in] A pointer to an array of <bpt id=\"p1\">[</bpt>DBPROPSET<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms714367.aspx)</ept> structures containing properties and values to be set.","pos":[2252,2404],"source":" [in] A pointer to an array of [DBPROPSET](https://msdn.microsoft.com/en-us/library/ms714367.aspx) structures containing properties and values to be set."},{"content":"See <bpt id=\"p1\">[</bpt>Property Sets and Property Groups<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms713696.aspx)</ept> in the <bpt id=\"p2\">*</bpt>OLE DB Programmer's Reference<ept id=\"p2\">*</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[2405,2599],"source":" See [Property Sets and Property Groups](https://msdn.microsoft.com/en-us/library/ms713696.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"nPropertySets","pos":[2607,2620]},{"content":"[in] The number of <bpt id=\"p1\">[</bpt>DBPROPSET<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms714367.aspx)</ept> structures passed in the <bpt id=\"p2\">*</bpt>pPropSet<ept id=\"p2\">*</ept> argument.","pos":[2625,2757],"source":" [in] The number of [DBPROPSET](https://msdn.microsoft.com/en-us/library/ms714367.aspx) structures passed in the *pPropSet* argument."},{"content":"pName","pos":[2765,2770]},{"content":"[in] The name of the database to which to connect.","pos":[2775,2825]},{"content":"pUserName","pos":[2833,2842]},{"content":"[in] The name of the user.","pos":[2847,2873]},{"content":"pPassword","pos":[2881,2890]},{"content":"[in] The user's password.","pos":[2895,2920]},{"content":"[in] Database initialization mode.","pos":[2942,2976]},{"content":"See <bpt id=\"p1\">[</bpt>Initialization Properties<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/ms723127.aspx)</ept>in the <bpt id=\"p2\">*</bpt>OLE DB Programmer's Reference<ept id=\"p2\">*</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for a list of valid initialization modes.","pos":[2977,3203],"source":" See [Initialization Properties](https://msdn.microsoft.com/en-us/library/ms723127.aspx)in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a list of valid initialization modes."},{"content":"If <ph id=\"ph1\">`nInitMode`</ph> is zero, no initialization mode is included in the property set used to open the connection.","pos":[3204,3311],"source":" If `nInitMode` is zero, no initialization mode is included in the property set used to open the connection."},{"content":"[in] A program identifier.","pos":[3332,3358]},{"content":"[in] A <bpt id=\"p1\">[</bpt>CEnumerator<ept id=\"p1\">](../../data/oledb/cenumerator-class.md)</ept> object used to obtain a moniker for opening the connection when the caller does not specify a <bpt id=\"p2\">**</bpt>CLSID<ept id=\"p2\">**</ept>.","pos":[3381,3545],"source":" [in] A [CEnumerator](../../data/oledb/cenumerator-class.md) object used to obtain a moniker for opening the connection when the caller does not specify a **CLSID**."},{"content":"[in] Handle to the window that is to be the parent of the dialog box.","pos":[3562,3631]},{"content":"Using the function overload that uses the <ph id=\"ph1\">`hWnd`</ph> parameter will automatically invoke Service Components; see Remarks for details.","pos":[3632,3761],"source":" Using the function overload that uses the `hWnd` parameter will automatically invoke Service Components; see Remarks for details."},{"content":"[in] Determines the style of locator dialog box to display.","pos":[3789,3848]},{"content":"See Msdasc.h for possible values.","pos":[3849,3882]},{"content":"Return Value","pos":[3891,3903]},{"pos":[3907,3928],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph>.","source":"A standard `HRESULT`."},{"content":"Remarks","pos":[3937,3944]},{"content":"The method overload that uses the <ph id=\"ph1\">`hWnd`</ph> parameter opens a data source object with the service components in oledb32.dll; this DLL contains the implementation of Service Components features such as Resource Pooling, Automatic Transaction Enlistment, and so on.","pos":[3948,4208],"source":"The method overload that uses the `hWnd` parameter opens a data source object with the service components in oledb32.dll; this DLL contains the implementation of Service Components features such as Resource Pooling, Automatic Transaction Enlistment, and so on."},{"content":"For more information, see \"OLE DB Services\" in the OLE DB Programmer's Reference at <bpt id=\"p1\">[</bpt>http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true<ept id=\"p1\">](http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true)</ept>.","pos":[4209,4506],"source":" For more information, see \"OLE DB Services\" in the OLE DB Programmer's Reference at [http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true](http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true)."},{"content":"The method overloads that do not use the <ph id=\"ph1\">`hWnd`</ph> parameter open a data source object without using the service components in oledb32.dll.","pos":[4513,4649],"source":"The method overloads that do not use the `hWnd` parameter open a data source object without using the service components in oledb32.dll."},{"content":"A <bpt id=\"p1\">[</bpt>CDataSource<ept id=\"p1\">](../../data/oledb/cdatasource-class.md)</ept> object opened with these function overloads will be unable to utilize any of the functionality of Service Components.","pos":[4650,4822],"source":" A [CDataSource](../../data/oledb/cdatasource-class.md) object opened with these function overloads will be unable to utilize any of the functionality of Service Components."},{"content":"Example","pos":[4831,4838]},{"content":"The following code shows how to open a Jet 4.0 data source with OLE DB Templates.","pos":[4842,4923]},{"content":"You treat the Jet data source as an OLE DB data source.","pos":[4924,4979]},{"content":"However, your call to <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> needs two property sets: one for <bpt id=\"p2\">**</bpt>DBPROPSET_DBINIT<ept id=\"p2\">**</ept> and the other for <bpt id=\"p3\">**</bpt>DBPROPSET_JETOLEDB_DBINIT<ept id=\"p3\">**</ept>, so that you can set <bpt id=\"p4\">**</bpt>DBPROP_JETOLEDB_DATABASEPASSWORD<ept id=\"p4\">**</ept>.","pos":[4980,5171],"source":" However, your call to **Open** needs two property sets: one for **DBPROPSET_DBINIT** and the other for **DBPROPSET_JETOLEDB_DBINIT**, so that you can set **DBPROP_JETOLEDB_DATABASEPASSWORD**."},{"pos":[5189,5209],"content":"NVC_OLEDB_Consumer#7"},{"content":"Requirements","pos":[5277,5289]},{"pos":[5293,5315],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atldbcli.h","source":"**Header:** atldbcli.h"},{"content":"See Also","pos":[5324,5332]},{"content":"CDataSource Class","pos":[5337,5354]}],"content":"---\ntitle: \"CDataSource::Open | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"ATL::CDataSource::Open\"\n  - \"ATL.CDataSource.Open\"\n  - \"CDataSource::Open\"\n  - \"CDataSource.Open\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Open method\"\nms.assetid: a6d28bd1-799a-48ed-8993-5f82d1705b77\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CDataSource::Open\nOpens a connection to a data source using a **CLSID**, **ProgID**, or `CEnumerator` moniker or prompts the user with a locator dialog box.  \n  \n## Syntax  \n  \n```  \n  \n      HRESULT Open(  \n   const CLSID& clsid,  \n   DBPROPSET* pPropSet = NULL,  \n   ULONG nPropertySets = 1   \n) throw( );  \nHRESULT Open(  \n   const CLSID& clsid,  \n   LPCTSTR pName,  \n   LPCTSTR pUserName = NULL,  \n   LPCTSTR pPassword = NULL,  \n   long nInitMode = 0   \n) throw( );  \nHRESULT Open(  \n   LPCTSTR szProgID,  \n   DBPROPSET* pPropSet = NULL,  \n   ULONG nPropertySets = 1   \n) throw( );  \nHRESULT Open(  \n   LPCTSTR szProgID,  \n   LPCTSTR pName,  \n   LPCTSTR pUserName = NULL,  \n   LPCTSTR pPassword = NULL,  \n   long nInitMode = 0   \n) throw( );  \nHRESULT Open(  \n   const CEnumerator& enumerator,  \n   DBPROPSET* pPropSet = NULL,  \n   ULONG nPropertySets = 1   \n) throw( );  \nHRESULT Open(  \n   const CEnumerator& enumerator,  \n   LPCTSTR pName,  \n   LPCTSTR pUserName = NULL,  \n   LPCTSTR pPassword = NULL,  \n   long nInitMode = 0   \n) throw( );  \nHRESULT Open(  \n   HWND hWnd = GetActiveWindow( ),  \n   DBPROMPTOPTIONS dwPromptOptions = DBPROMPTOPTIONS_WIZARDSHEET   \n) throw( );  \nHRESULT Open(   \n   LPCWSTR szProgID,   \n   DBPROPSET* pPropSet = NULL,   \n   ULONG nPropertySets = 1   \n) throw( );  \nHRESULT Open(   \n   LPCSTR szProgID,   \n   LPCTSTR pName,   \n   LPCTSTR pUserName = NULL,   \n   LPCTSTR pPassword = NULL,   \n   long nInitMode = 0   \n) throw( );  \n```  \n  \n#### Parameters  \n `clsid`  \n [in] The **CLSID** of the data provider.  \n  \n *pPropSet*  \n [in] A pointer to an array of [DBPROPSET](https://msdn.microsoft.com/en-us/library/ms714367.aspx) structures containing properties and values to be set. See [Property Sets and Property Groups](https://msdn.microsoft.com/en-us/library/ms713696.aspx) in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n *nPropertySets*  \n [in] The number of [DBPROPSET](https://msdn.microsoft.com/en-us/library/ms714367.aspx) structures passed in the *pPropSet* argument.  \n  \n *pName*  \n [in] The name of the database to which to connect.  \n  \n *pUserName*  \n [in] The name of the user.  \n  \n *pPassword*  \n [in] The user's password.  \n  \n `nInitMode`  \n [in] Database initialization mode. See [Initialization Properties](https://msdn.microsoft.com/en-us/library/ms723127.aspx)in the *OLE DB Programmer's Reference* in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a list of valid initialization modes. If `nInitMode` is zero, no initialization mode is included in the property set used to open the connection.  \n  \n `szProgID`  \n [in] A program identifier.  \n  \n `enumerator`  \n [in] A [CEnumerator](../../data/oledb/cenumerator-class.md) object used to obtain a moniker for opening the connection when the caller does not specify a **CLSID**.  \n  \n `hWnd`  \n [in] Handle to the window that is to be the parent of the dialog box. Using the function overload that uses the `hWnd` parameter will automatically invoke Service Components; see Remarks for details.  \n  \n `dwPromptOptions`  \n [in] Determines the style of locator dialog box to display. See Msdasc.h for possible values.  \n  \n## Return Value  \n A standard `HRESULT`.  \n  \n## Remarks  \n The method overload that uses the `hWnd` parameter opens a data source object with the service components in oledb32.dll; this DLL contains the implementation of Service Components features such as Resource Pooling, Automatic Transaction Enlistment, and so on. For more information, see \"OLE DB Services\" in the OLE DB Programmer's Reference at [http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true](http://msdn.microsoft.com/library/default.asp?url=/library/oledb/htm/oledbole_db_services.asp?frame=true).  \n  \n The method overloads that do not use the `hWnd` parameter open a data source object without using the service components in oledb32.dll. A [CDataSource](../../data/oledb/cdatasource-class.md) object opened with these function overloads will be unable to utilize any of the functionality of Service Components.  \n  \n## Example  \n The following code shows how to open a Jet 4.0 data source with OLE DB Templates. You treat the Jet data source as an OLE DB data source. However, your call to **Open** needs two property sets: one for **DBPROPSET_DBINIT** and the other for **DBPROPSET_JETOLEDB_DBINIT**, so that you can set **DBPROP_JETOLEDB_DATABASEPASSWORD**.  \n  \n [!code-cpp[NVC_OLEDB_Consumer#7](../../data/oledb/codesnippet/cpp/cdatasource-open_1.cpp)]  \n  \n## Requirements  \n **Header:** atldbcli.h  \n  \n## See Also  \n [CDataSource Class](../../data/oledb/cdatasource-class.md)"}