{"nodes":[{"pos":[12,65],"content":"Record Field Exchange: How RFX Works | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Record Field Exchange: How RFX Works | Microsoft Docs","pos":[0,53]}]},{"content":"Record Field Exchange: How RFX Works","pos":[812,848]},{"content":"This topic explains the RFX process.","pos":[849,885]},{"content":"This is an advanced topic covering:","pos":[886,921]},{"content":"RFX and the recordset","pos":[932,953]},{"content":"The RFX process","pos":[995,1010]},{"pos":[1061,1439],"content":"[!NOTE]\n This topic applies to classes derived from `CRecordset` in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","leadings":["","> "],"nodes":[{"content":" This topic applies to classes derived from `CRecordset` in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","pos":[8,376],"nodes":[{"content":"This topic applies to classes derived from <ph id=\"ph1\">`CRecordset`</ph> in which bulk row fetching has not been implemented.","pos":[1,109],"source":" This topic applies to classes derived from `CRecordset` in which bulk row fetching has not been implemented."},{"content":"If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented.","pos":[110,199]},{"content":"Bulk RFX is similar to RFX.","pos":[200,227]},{"content":"To understand the differences, see <bpt id=\"p1\">[</bpt>Recordset: Fetching Records in Bulk (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)</ept>.","pos":[228,368],"source":" To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)."}]}]},{"pos":[1492,1513],"content":"RFX and the Recordset"},{"content":"The recordset object's field data members, taken together, constitute an edit buffer that holds the selected columns of one record.","pos":[1517,1648]},{"content":"When the recordset is first opened and is about to read the first record, RFX binds (associates) each selected column to the address of the appropriate field data member.","pos":[1649,1819]},{"content":"When the recordset updates a record, RFX calls ODBC API functions to send a SQL <bpt id=\"p1\">**</bpt>UPDATE<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>INSERT<ept id=\"p2\">**</ept> statement to the driver.","pos":[1820,1949],"source":" When the recordset updates a record, RFX calls ODBC API functions to send a SQL **UPDATE** or **INSERT** statement to the driver."},{"content":"RFX uses its knowledge of the field data members to specify the columns to write.","pos":[1950,2031]},{"content":"The framework backs up the edit buffer at certain stages so it can restore its contents if necessary.","pos":[2038,2139]},{"content":"RFX backs up the edit buffer before adding a new record and before editing an existing record.","pos":[2140,2234]},{"content":"It restores the edit buffer in some cases, for example, after an <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept> call following <ph id=\"ph1\">`AddNew`</ph>.","pos":[2235,2335],"source":" It restores the edit buffer in some cases, for example, after an **Update** call following `AddNew`."},{"content":"The edit buffer is not restored if you abandon a newly changed edit buffer by, for example, moving to another record before calling <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept>.","pos":[2336,2479],"source":" The edit buffer is not restored if you abandon a newly changed edit buffer by, for example, moving to another record before calling **Update**."},{"content":"Besides exchanging data between the data source and the recordset's field data members, RFX manages binding parameters.","pos":[2486,2605]},{"content":"When the recordset is opened, any parameter data members are bound in the order of the \"?\" placeholders in the SQL statement that <ph id=\"ph1\">`CRecordset::Open`</ph> constructs.","pos":[2606,2766],"source":" When the recordset is opened, any parameter data members are bound in the order of the \"?\" placeholders in the SQL statement that `CRecordset::Open` constructs."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Recordset: Parameterizing a Recordset (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)</ept>.","pos":[2767,2902],"source":" For more information, see [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)."},{"content":"Your recordset class's override of <ph id=\"ph1\">`DoFieldExchange`</ph> does all the work, moving data in both directions.","pos":[2909,3012],"source":"Your recordset class's override of `DoFieldExchange` does all the work, moving data in both directions."},{"content":"Like dialog data exchange (DDX), RFX needs information about the data members of your class.","pos":[3013,3105]},{"content":"The wizard provides the necessary information by writing a recordset-specific implementation of <ph id=\"ph1\">`DoFieldExchange`</ph> for you, based on the field data member names and data types you specify with the wizard.","pos":[3106,3309],"source":" The wizard provides the necessary information by writing a recordset-specific implementation of `DoFieldExchange` for you, based on the field data member names and data types you specify with the wizard."},{"pos":[3374,3403],"content":"Record Field Exchange Process"},{"content":"This section describes the sequence of RFX events as a recordset object is opened and as you add, update, and delete records.","pos":[3407,3532]},{"content":"The table <bpt id=\"p1\">[</bpt>Sequence of RFX Operations During Recordset Open<ept id=\"p1\">](#_core_sequence_of_rfx_operations_during_recordset_open)</ept> and the table <bpt id=\"p2\">[</bpt>Sequence of RFX Operations During Scrolling<ept id=\"p2\">](#_core_sequence_of_rfx_operations_during_scrolling)</ept> in this topic show the process as RFX processes a <bpt id=\"p3\">**</bpt>Move<ept id=\"p3\">**</ept> command in the recordset and as RFX manages an update.","pos":[3533,3876],"source":" The table [Sequence of RFX Operations During Recordset Open](#_core_sequence_of_rfx_operations_during_recordset_open) and the table [Sequence of RFX Operations During Scrolling](#_core_sequence_of_rfx_operations_during_scrolling) in this topic show the process as RFX processes a **Move** command in the recordset and as RFX manages an update."},{"content":"During these processes, <bpt id=\"p1\">[</bpt>DoFieldExchange<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange)</ept> is called to perform many different operations.","pos":[3877,4035],"source":" During these processes, [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) is called to perform many different operations."},{"content":"The <bpt id=\"p1\">**</bpt>m_nOperation<ept id=\"p1\">**</ept> data member of the <bpt id=\"p2\">[</bpt>CFieldExchange<ept id=\"p2\">](../../mfc/reference/cfieldexchange-class.md)</ept> object determines which operation is requested.","pos":[4036,4185],"source":" The **m_nOperation** data member of the [CFieldExchange](../../mfc/reference/cfieldexchange-class.md) object determines which operation is requested."},{"content":"You might find it helpful to read <bpt id=\"p1\">[</bpt>Recordset: How Recordsets Select Records (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-how-recordsets-select-records-odbc.md)</ept> and <bpt id=\"p2\">[</bpt>Recordset: How Recordsets Update Records (ODBC)<ept id=\"p2\">](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)</ept> before you read this material.","pos":[4186,4484],"source":" You might find it helpful to read [Recordset: How Recordsets Select Records (ODBC)](../../data/odbc/recordset-how-recordsets-select-records-odbc.md) and [Recordset: How Recordsets Update Records (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md) before you read this material."},{"pos":[4565,4611],"content":"RFX: Initial Binding of Columns and Parameters"},{"pos":[4615,4787],"content":"The following RFX activities occur, in the order shown, when you call a recordset object's <bpt id=\"p1\">[</bpt>Open<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__open)</ept> member function:","source":"The following RFX activities occur, in the order shown, when you call a recordset object's [Open](../../mfc/reference/crecordset-class.md#crecordset__open) member function:"},{"content":"If the recordset has parameter data members, the framework calls <ph id=\"ph1\">`DoFieldExchange`</ph> to bind the parameters to parameter placeholders in the recordset's SQL statement string.","pos":[4797,4969],"source":"If the recordset has parameter data members, the framework calls `DoFieldExchange` to bind the parameters to parameter placeholders in the recordset's SQL statement string."},{"content":"A data type-dependent representation of the value of the parameter is used for each placeholder found in the <bpt id=\"p1\">**</bpt>SELECT<ept id=\"p1\">**</ept> statement.","pos":[4970,5100],"source":" A data type-dependent representation of the value of the parameter is used for each placeholder found in the **SELECT** statement."},{"content":"This occurs after the SQL statement is prepared but before it is executed.","pos":[5101,5175]},{"content":"For information about statement preparation, see the <bpt id=\"p1\">**</bpt>::SQLPrepare<ept id=\"p1\">**</ept> function in the ODBC <bpt id=\"p2\">*</bpt>Programmer's Reference<ept id=\"p2\">*</ept>.","pos":[5176,5292],"source":" For information about statement preparation, see the **::SQLPrepare** function in the ODBC *Programmer's Reference*."},{"content":"The framework calls <ph id=\"ph1\">`DoFieldExchange`</ph> a second time to bind the values of selected columns to corresponding field data members in the recordset.","pos":[5302,5446],"source":"The framework calls `DoFieldExchange` a second time to bind the values of selected columns to corresponding field data members in the recordset."},{"content":"This establishes the recordset object as an edit buffer containing the columns of the first record.","pos":[5447,5546]},{"content":"The recordset executes the SQL statement and the data source selects the first record.","pos":[5556,5642]},{"content":"The record's columns are loaded into the recordset's field data members.","pos":[5643,5715]},{"content":"The following table shows the sequence of RFX operations when you open a recordset.","pos":[5722,5805]},{"content":"Sequence of RFX Operations During Recordset Open","pos":[5815,5863]},{"content":"Your operation","pos":[5870,5884]},{"content":"DoFieldExchange operation","pos":[5885,5910]},{"content":"Database/SQL operation","pos":[5911,5933]},{"content":"1. Open recordset.","pos":[6025,6043]},{"content":"2. Build a SQL statement.","pos":[6051,6076]},{"content":"3. Send the SQL.","pos":[6084,6100]},{"content":"4. Bind parameter data members.","pos":[6106,6137]},{"content":"5. Bind field data members to columns.","pos":[6144,6182]},{"content":"6. ODBC does the move and fills in the data.","pos":[6190,6234]},{"content":"7. Fix up the data for C++.","pos":[6240,6267]},{"content":"Recordsets use ODBC's prepared execution to allow for fast requerying with the same SQL statement.","pos":[6276,6374]},{"content":"For more information about prepared execution, see the ODBC SDK <bpt id=\"p1\">*</bpt>Programmer's Reference<ept id=\"p1\">*</ept> in the MSDN Library.","pos":[6375,6484],"source":" For more information about prepared execution, see the ODBC SDK *Programmer's Reference* in the MSDN Library."},{"pos":[6533,6547],"content":"RFX: Scrolling"},{"pos":[6551,6730],"content":"When you scroll from one record to another, the framework calls <ph id=\"ph1\">`DoFieldExchange`</ph> to replace the values previously stored in the field data members with values for the new record.","source":"When you scroll from one record to another, the framework calls `DoFieldExchange` to replace the values previously stored in the field data members with values for the new record."},{"content":"The following table shows the sequence of RFX operations when the user moves from record to record.","pos":[6737,6836]},{"content":"Sequence of RFX Operations During Scrolling","pos":[6846,6889]},{"content":"Your operation","pos":[6896,6910]},{"content":"DoFieldExchange operation","pos":[6911,6936]},{"content":"Database/SQL operation","pos":[6937,6959]},{"pos":[7051,7105],"content":"1. Call <ph id=\"ph1\">`MoveNext`</ph> or one of the other Move functions.","source":"1. Call `MoveNext` or one of the other Move functions."},{"content":"2. ODBC does the move and fills in the data.","pos":[7114,7158]},{"content":"3. Fix up the data for C++.","pos":[7164,7191]},{"pos":[7280,7332],"content":"RFX: Adding New Records and Editing Existing Records"},{"content":"If you add a new record, the recordset operates as an edit buffer to build up the contents of the new record.","pos":[7336,7445]},{"content":"As with adding records, editing records involves changing the values of the recordset's field data members.","pos":[7446,7553]},{"content":"From the RFX perspective, the sequence is as follows:","pos":[7554,7607]},{"pos":[7617,7871],"content":"Your call to the recordset's <bpt id=\"p1\">[</bpt>AddNew<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__addnew)</ept> or <bpt id=\"p2\">[</bpt>Edit<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__edit)</ept> member function causes RFX to store the current edit buffer so it can be restored later.","source":"Your call to the recordset's [AddNew](../../mfc/reference/crecordset-class.md#crecordset__addnew) or [Edit](../../mfc/reference/crecordset-class.md#crecordset__edit) member function causes RFX to store the current edit buffer so it can be restored later."},{"pos":[7890,7986],"content":"or <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept> prepares the fields in the edit buffer so RFX can detect changed field data members.","source":" or **Edit** prepares the fields in the edit buffer so RFX can detect changed field data members."},{"content":"Because a new record has no previous values to compare new ones with, <ph id=\"ph1\">`AddNew`</ph> sets the value of each field data member to a <bpt id=\"p1\">**</bpt>PSEUDO_NULL<ept id=\"p1\">**</ept> value.","pos":[7997,8144],"source":"Because a new record has no previous values to compare new ones with, `AddNew` sets the value of each field data member to a **PSEUDO_NULL** value."},{"content":"Later, when you call <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept>, RFX compares each data member's value with the <bpt id=\"p2\">**</bpt>PSEUDO_NULL<ept id=\"p2\">**</ept> value.","pos":[8145,8247],"source":" Later, when you call **Update**, RFX compares each data member's value with the **PSEUDO_NULL** value."},{"content":"If there is a difference, the data member has been set.","pos":[8248,8303]},{"content":"(<bpt id=\"p1\">**</bpt>PSEUDO_NULL<ept id=\"p1\">**</ept> is not the same as a record column with a true Null value nor is either of these the same as C++ <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.)","pos":[8304,8428],"source":" (**PSEUDO_NULL** is not the same as a record column with a true Null value nor is either of these the same as C++ **NULL**.)"},{"content":"Unlike the <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept> call for <ph id=\"ph1\">`AddNew`</ph>, the <bpt id=\"p2\">**</bpt>Update<ept id=\"p2\">**</ept> call for <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> compares updated values with previously stored values rather than using <bpt id=\"p4\">**</bpt>PSEUDO_NULL<ept id=\"p4\">**</ept>.","pos":[8439,8601],"source":"Unlike the **Update** call for `AddNew`, the **Update** call for **Edit** compares updated values with previously stored values rather than using **PSEUDO_NULL**."},{"content":"The difference is that <ph id=\"ph1\">`AddNew`</ph> has no previously stored values for comparison.","pos":[8602,8681],"source":" The difference is that `AddNew` has no previously stored values for comparison."},{"content":"You directly set the values of field data members whose values you want to edit or that you want filled for a new record.","pos":[8691,8812]},{"content":"This can include calling <ph id=\"ph1\">`SetFieldNull`</ph>.","pos":[8813,8853],"source":" This can include calling `SetFieldNull`."},{"content":"Your call to <bpt id=\"p1\">[</bpt>Update<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__update)</ept> checks for changed field data members, as described in step 2 (see the table <bpt id=\"p2\">[</bpt>Sequence of RFX Operations During Scrolling<ept id=\"p2\">](#_core_sequence_of_rfx_operations_during_scrolling)</ept>).","pos":[8863,9121],"source":"Your call to [Update](../../mfc/reference/crecordset-class.md#crecordset__update) checks for changed field data members, as described in step 2 (see the table [Sequence of RFX Operations During Scrolling](#_core_sequence_of_rfx_operations_during_scrolling))."},{"content":"If none have changed, <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept> returns 0.","pos":[9122,9165],"source":" If none have changed, **Update** returns 0."},{"content":"If some field data members have changed, <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept> prepares and executes a SQL <bpt id=\"p2\">**</bpt>INSERT<ept id=\"p2\">**</ept> statement that contains values for all updated fields in the record.","pos":[9166,9325],"source":" If some field data members have changed, **Update** prepares and executes a SQL **INSERT** statement that contains values for all updated fields in the record."},{"content":"For <ph id=\"ph1\">`AddNew`</ph>, <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept> concludes by restoring the previously stored values of the record that was current before the <ph id=\"ph2\">`AddNew`</ph> call.","pos":[9335,9468],"source":"For `AddNew`, **Update** concludes by restoring the previously stored values of the record that was current before the `AddNew` call."},{"content":"For <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept>, the new, edited values remain in place.","pos":[9469,9522],"source":" For **Edit**, the new, edited values remain in place."},{"content":"The following table shows the sequence of RFX operations when you add a new record or edit an existing record.","pos":[9529,9639]},{"content":"Sequence of RFX Operations During AddNew and Edit","pos":[9649,9698]},{"content":"Your operation","pos":[9705,9719]},{"content":"DoFieldExchange operation","pos":[9720,9745]},{"content":"Database/SQL operation","pos":[9746,9768]},{"pos":[9860,9889],"content":"1. Call <ph id=\"ph1\">`AddNew`</ph> or <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept>.","source":"1. Call `AddNew` or **Edit**."},{"content":"2. Back up the edit buffer.","pos":[9897,9924]},{"pos":[9931,9992],"content":"3. For <ph id=\"ph1\">`AddNew`</ph>, mark field data members as \"clean\" and Null.","source":"3. For `AddNew`, mark field data members as \"clean\" and Null."},{"content":"4. Assign values to recordset field data members.","pos":[9998,10047]},{"pos":[10054,10073],"content":"5. Call <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept>.","source":"5. Call **Update**."},{"content":"6. Check for changed fields.","pos":[10081,10109]},{"pos":[10116,10200],"content":"7. Build SQL <bpt id=\"p1\">**</bpt>INSERT<ept id=\"p1\">**</ept> statement for <ph id=\"ph1\">`AddNew`</ph> or <bpt id=\"p2\">**</bpt>UPDATE<ept id=\"p2\">**</ept> statement for <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept>.","source":"7. Build SQL **INSERT** statement for `AddNew` or **UPDATE** statement for **Edit**."},{"content":"8. Send the SQL.","pos":[10208,10224]},{"content":"9. For <ph id=\"ph1\">`AddNew`</ph>, restore the edit buffer to its backed-up contents.","pos":[10230,10297],"source":"9. For `AddNew`, restore the edit buffer to its backed-up contents."},{"content":"For <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept>, delete the backup.","pos":[10298,10330],"source":" For **Edit**, delete the backup."},{"content":"RFX: Deleting Existing Records","pos":[10342,10372]},{"content":"When you delete a record, RFX sets all the fields to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> as a reminder that the record is deleted and you must move off it.","pos":[10376,10504],"source":"When you delete a record, RFX sets all the fields to **NULL** as a reminder that the record is deleted and you must move off it."},{"content":"You do not need any other RFX sequence information.","pos":[10505,10556]},{"content":"See Also","pos":[10565,10573]},{"content":"Record Field Exchange (RFX)","pos":[10578,10605]},{"content":"MFC ODBC Consume","pos":[10658,10674]},{"content":"Macros, Global Functions, and Global Variables","pos":[10733,10779]},{"content":"CFieldExchange Class","pos":[10832,10852]},{"content":"CRecordset::DoFieldExchange","pos":[10904,10931]}],"content":"---\ntitle: \"Record Field Exchange: How RFX Works | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"record editing [C++], using RFX\"\n  - \"RFX (ODBC) [C++], updating data in recordsets\"\n  - \"scrolling [C++]\"\n  - \"ODBC [C++], RFX\"\n  - \"data binding [C++], DFX\"\n  - \"scrolling [C++], RFX\"\n  - \"RFX (ODBC) [C++], binding fields and parameters\"\nms.assetid: e647cacd-62b0-4b80-9e20-b392deca5a88\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Record Field Exchange: How RFX Works\nThis topic explains the RFX process. This is an advanced topic covering:  \n  \n-   [RFX and the recordset](#_core_rfx_and_the_recordset)  \n  \n-   [The RFX process](#_core_the_record_field_exchange_process)  \n  \n> [!NOTE]\n>  This topic applies to classes derived from `CRecordset` in which bulk row fetching has not been implemented. If you are using bulk row fetching, bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).  \n  \n##  <a name=\"_core_rfx_and_the_recordset\"></a> RFX and the Recordset  \n The recordset object's field data members, taken together, constitute an edit buffer that holds the selected columns of one record. When the recordset is first opened and is about to read the first record, RFX binds (associates) each selected column to the address of the appropriate field data member. When the recordset updates a record, RFX calls ODBC API functions to send a SQL **UPDATE** or **INSERT** statement to the driver. RFX uses its knowledge of the field data members to specify the columns to write.  \n  \n The framework backs up the edit buffer at certain stages so it can restore its contents if necessary. RFX backs up the edit buffer before adding a new record and before editing an existing record. It restores the edit buffer in some cases, for example, after an **Update** call following `AddNew`. The edit buffer is not restored if you abandon a newly changed edit buffer by, for example, moving to another record before calling **Update**.  \n  \n Besides exchanging data between the data source and the recordset's field data members, RFX manages binding parameters. When the recordset is opened, any parameter data members are bound in the order of the \"?\" placeholders in the SQL statement that `CRecordset::Open` constructs. For more information, see [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).  \n  \n Your recordset class's override of `DoFieldExchange` does all the work, moving data in both directions. Like dialog data exchange (DDX), RFX needs information about the data members of your class. The wizard provides the necessary information by writing a recordset-specific implementation of `DoFieldExchange` for you, based on the field data member names and data types you specify with the wizard.  \n  \n##  <a name=\"_core_the_record_field_exchange_process\"></a> Record Field Exchange Process  \n This section describes the sequence of RFX events as a recordset object is opened and as you add, update, and delete records. The table [Sequence of RFX Operations During Recordset Open](#_core_sequence_of_rfx_operations_during_recordset_open) and the table [Sequence of RFX Operations During Scrolling](#_core_sequence_of_rfx_operations_during_scrolling) in this topic show the process as RFX processes a **Move** command in the recordset and as RFX manages an update. During these processes, [DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange) is called to perform many different operations. The **m_nOperation** data member of the [CFieldExchange](../../mfc/reference/cfieldexchange-class.md) object determines which operation is requested. You might find it helpful to read [Recordset: How Recordsets Select Records (ODBC)](../../data/odbc/recordset-how-recordsets-select-records-odbc.md) and [Recordset: How Recordsets Update Records (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md) before you read this material.  \n  \n###  <a name=\"_mfc_rfx.3a_.initial_binding_of_columns_and_parameters\"></a> RFX: Initial Binding of Columns and Parameters  \n The following RFX activities occur, in the order shown, when you call a recordset object's [Open](../../mfc/reference/crecordset-class.md#crecordset__open) member function:  \n  \n-   If the recordset has parameter data members, the framework calls `DoFieldExchange` to bind the parameters to parameter placeholders in the recordset's SQL statement string. A data type-dependent representation of the value of the parameter is used for each placeholder found in the **SELECT** statement. This occurs after the SQL statement is prepared but before it is executed. For information about statement preparation, see the **::SQLPrepare** function in the ODBC *Programmer's Reference*.  \n  \n-   The framework calls `DoFieldExchange` a second time to bind the values of selected columns to corresponding field data members in the recordset. This establishes the recordset object as an edit buffer containing the columns of the first record.  \n  \n-   The recordset executes the SQL statement and the data source selects the first record. The record's columns are loaded into the recordset's field data members.  \n  \n The following table shows the sequence of RFX operations when you open a recordset.  \n  \n### Sequence of RFX Operations During Recordset Open  \n  \n|Your operation|DoFieldExchange operation|Database/SQL operation|  \n|--------------------|-------------------------------|-----------------------------|  \n|1. Open recordset.|||  \n||2. Build a SQL statement.||  \n|||3. Send the SQL.|  \n||4. Bind parameter data members.||  \n||5. Bind field data members to columns.||  \n|||6. ODBC does the move and fills in the data.|  \n||7. Fix up the data for C++.||  \n  \n Recordsets use ODBC's prepared execution to allow for fast requerying with the same SQL statement. For more information about prepared execution, see the ODBC SDK *Programmer's Reference* in the MSDN Library.  \n  \n###  <a name=\"_mfc_rfx.3a_.scrolling\"></a> RFX: Scrolling  \n When you scroll from one record to another, the framework calls `DoFieldExchange` to replace the values previously stored in the field data members with values for the new record.  \n  \n The following table shows the sequence of RFX operations when the user moves from record to record.  \n  \n### Sequence of RFX Operations During Scrolling  \n  \n|Your operation|DoFieldExchange operation|Database/SQL operation|  \n|--------------------|-------------------------------|-----------------------------|  \n|1. Call `MoveNext` or one of the other Move functions.|||  \n|||2. ODBC does the move and fills in the data.|  \n||3. Fix up the data for C++.||  \n  \n###  <a name=\"_mfc_rfx.3a_.adding_new_records_and_editing_existing_records\"></a> RFX: Adding New Records and Editing Existing Records  \n If you add a new record, the recordset operates as an edit buffer to build up the contents of the new record. As with adding records, editing records involves changing the values of the recordset's field data members. From the RFX perspective, the sequence is as follows:  \n  \n1.  Your call to the recordset's [AddNew](../../mfc/reference/crecordset-class.md#crecordset__addnew) or [Edit](../../mfc/reference/crecordset-class.md#crecordset__edit) member function causes RFX to store the current edit buffer so it can be restored later.  \n  \n2.  `AddNew` or **Edit** prepares the fields in the edit buffer so RFX can detect changed field data members.  \n  \n     Because a new record has no previous values to compare new ones with, `AddNew` sets the value of each field data member to a **PSEUDO_NULL** value. Later, when you call **Update**, RFX compares each data member's value with the **PSEUDO_NULL** value. If there is a difference, the data member has been set. (**PSEUDO_NULL** is not the same as a record column with a true Null value nor is either of these the same as C++ **NULL**.)  \n  \n     Unlike the **Update** call for `AddNew`, the **Update** call for **Edit** compares updated values with previously stored values rather than using **PSEUDO_NULL**. The difference is that `AddNew` has no previously stored values for comparison.  \n  \n3.  You directly set the values of field data members whose values you want to edit or that you want filled for a new record. This can include calling `SetFieldNull`.  \n  \n4.  Your call to [Update](../../mfc/reference/crecordset-class.md#crecordset__update) checks for changed field data members, as described in step 2 (see the table [Sequence of RFX Operations During Scrolling](#_core_sequence_of_rfx_operations_during_scrolling)). If none have changed, **Update** returns 0. If some field data members have changed, **Update** prepares and executes a SQL **INSERT** statement that contains values for all updated fields in the record.  \n  \n5.  For `AddNew`, **Update** concludes by restoring the previously stored values of the record that was current before the `AddNew` call. For **Edit**, the new, edited values remain in place.  \n  \n The following table shows the sequence of RFX operations when you add a new record or edit an existing record.  \n  \n### Sequence of RFX Operations During AddNew and Edit  \n  \n|Your operation|DoFieldExchange operation|Database/SQL operation|  \n|--------------------|-------------------------------|-----------------------------|  \n|1. Call `AddNew` or **Edit**.|||  \n||2. Back up the edit buffer.||  \n||3. For `AddNew`, mark field data members as \"clean\" and Null.||  \n|4. Assign values to recordset field data members.|||  \n|5. Call **Update**.|||  \n||6. Check for changed fields.||  \n||7. Build SQL **INSERT** statement for `AddNew` or **UPDATE** statement for **Edit**.||  \n|||8. Send the SQL.|  \n||9. For `AddNew`, restore the edit buffer to its backed-up contents. For **Edit**, delete the backup.||  \n  \n### RFX: Deleting Existing Records  \n When you delete a record, RFX sets all the fields to **NULL** as a reminder that the record is deleted and you must move off it. You do not need any other RFX sequence information.  \n  \n## See Also  \n [Record Field Exchange (RFX)](../../data/odbc/record-field-exchange-rfx.md)   \n [MFC ODBC Consume](../../mfc/reference/adding-an-mfc-odbc-consumer.md)   \n [Macros, Global Functions, and Global Variables](../../mfc/reference/mfc-macros-and-globals.md)  \n [CFieldExchange Class](../../mfc/reference/cfieldexchange-class.md)   \n [CRecordset::DoFieldExchange](../../mfc/reference/crecordset-class.md#crecordset__dofieldexchange)"}