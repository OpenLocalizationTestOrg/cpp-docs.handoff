{"nodes":[{"pos":[12,78],"content":"TN047: Relaxing Database Transaction Requirements | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"TN047: Relaxing Database Transaction Requirements | Microsoft Docs","pos":[0,66]}]},{"content":"TN047: Relaxing Database Transaction Requirements","pos":[620,669]},{"content":"This tech note, which discussed the transaction requirements of the MFC ODBC database classes, is now obsolete.","pos":[670,781]},{"content":"Before MFC 4.2, the database classes required that cursors be preserved on recordsets after a <bpt id=\"p1\">**</bpt>CommitTrans<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Rollback<ept id=\"p2\">**</ept> operation.","pos":[782,918],"source":" Before MFC 4.2, the database classes required that cursors be preserved on recordsets after a **CommitTrans** or **Rollback** operation."},{"content":"If the ODBC driver and DBMS did not support this level of cursor preservation, then the database classes did not enable transactions.","pos":[919,1052]},{"content":"Beginning with MFC 4.2, the database classes have relaxed the restriction of requiring cursor preservation.","pos":[1059,1166]},{"content":"Transactions will be enabled if the driver supports them.","pos":[1167,1224]},{"content":"However, you must now check the effect of a <bpt id=\"p1\">**</bpt>CommitTrans<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Rollback<ept id=\"p2\">**</ept> operation on open recordsets.","pos":[1225,1330],"source":" However, you must now check the effect of a **CommitTrans** or **Rollback** operation on open recordsets."},{"content":"See the member functions <bpt id=\"p1\">[</bpt>CDatabase::GetCursorCommitBehavior<ept id=\"p1\">](../mfc/reference/cdatabase-class.md#cdatabase__getcursorcommitbehavior)</ept> and <bpt id=\"p2\">[</bpt>CDatabase::GetCursorRollbackBehavior<ept id=\"p2\">](../mfc/reference/cdatabase-class.md#cdatabase__getcursorrollbackbehavior)</ept> for more information.","pos":[1331,1603],"source":" See the member functions [CDatabase::GetCursorCommitBehavior](../mfc/reference/cdatabase-class.md#cdatabase__getcursorcommitbehavior) and [CDatabase::GetCursorRollbackBehavior](../mfc/reference/cdatabase-class.md#cdatabase__getcursorrollbackbehavior) for more information."},{"content":"See Also","pos":[1612,1620]},{"content":"Technical Notes by Number","pos":[1625,1650]},{"content":"Technical Notes by Category","pos":[1694,1721]}],"content":"---\ntitle: \"TN047: Relaxing Database Transaction Requirements | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.data\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"TN047\"\nms.assetid: f93c51cf-a8c0-43d0-aa47-7bcb8333d693\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# TN047: Relaxing Database Transaction Requirements\nThis tech note, which discussed the transaction requirements of the MFC ODBC database classes, is now obsolete. Before MFC 4.2, the database classes required that cursors be preserved on recordsets after a **CommitTrans** or **Rollback** operation. If the ODBC driver and DBMS did not support this level of cursor preservation, then the database classes did not enable transactions.  \n  \n Beginning with MFC 4.2, the database classes have relaxed the restriction of requiring cursor preservation. Transactions will be enabled if the driver supports them. However, you must now check the effect of a **CommitTrans** or **Rollback** operation on open recordsets. See the member functions [CDatabase::GetCursorCommitBehavior](../mfc/reference/cdatabase-class.md#cdatabase__getcursorcommitbehavior) and [CDatabase::GetCursorRollbackBehavior](../mfc/reference/cdatabase-class.md#cdatabase__getcursorrollbackbehavior) for more information.  \n  \n## See Also  \n [Technical Notes by Number](../mfc/technical-notes-by-number.md)   \n [Technical Notes by Category](../mfc/technical-notes-by-category.md)\n\n"}