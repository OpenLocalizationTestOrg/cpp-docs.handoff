{"nodes":[{"pos":[12,76],"content":"Recordset: How Recordsets Update Records (ODBC) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Recordset: How Recordsets Update Records (ODBC) | Microsoft Docs","pos":[0,64]}]},{"content":"Recordset: How Recordsets Update Records (ODBC)","pos":[721,768]},{"content":"This topic applies to the MFC ODBC classes.","pos":[769,812]},{"content":"Besides their ability to select records from a data source, recordsets can (optionally) update or delete the selected records or add new records.","pos":[819,964]},{"content":"Three factors determine a recordset's updateability: whether the connected data source is updateable, the options you specify when you create a recordset object, and the SQL that is created.","pos":[965,1155]},{"pos":[1163,1375],"content":"[!NOTE]\n The SQL on which your `CRecordset` object is based can affect your recordset's updateability. For example, if your SQL contains a join or a **GROUP BY** clause, MFC sets the updateability to **FALSE**.","leadings":["","> "],"nodes":[{"content":" The SQL on which your `CRecordset` object is based can affect your recordset's updateability. For example, if your SQL contains a join or a **GROUP BY** clause, MFC sets the updateability to **FALSE**.","pos":[8,210],"nodes":[{"content":"The SQL on which your <ph id=\"ph1\">`CRecordset`</ph> object is based can affect your recordset's updateability.","pos":[1,94],"source":" The SQL on which your `CRecordset` object is based can affect your recordset's updateability."},{"content":"For example, if your SQL contains a join or a <bpt id=\"p1\">**</bpt>GROUP BY<ept id=\"p1\">**</ept> clause, MFC sets the updateability to <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","pos":[95,202],"source":" For example, if your SQL contains a join or a **GROUP BY** clause, MFC sets the updateability to **FALSE**."}]}]},{"pos":[1383,1648],"content":"[!NOTE]\n This topic applies to objects derived from `CRecordset` in which bulk row fetching has not been implemented. If you are using bulk row fetching, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","leadings":["","> "],"nodes":[{"content":" This topic applies to objects derived from `CRecordset` in which bulk row fetching has not been implemented. If you are using bulk row fetching, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).","pos":[8,263],"nodes":[{"content":"This topic applies to objects derived from <ph id=\"ph1\">`CRecordset`</ph> in which bulk row fetching has not been implemented.","pos":[1,109],"source":" This topic applies to objects derived from `CRecordset` in which bulk row fetching has not been implemented."},{"content":"If you are using bulk row fetching, see <bpt id=\"p1\">[</bpt>Recordset: Fetching Records in Bulk (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)</ept>.","pos":[110,255],"source":" If you are using bulk row fetching, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)."}]}]},{"content":"This topic explains:","pos":[1655,1675]},{"pos":[1685,1795],"content":"<bpt id=\"p1\">[</bpt>Your role in recordset updating<ept id=\"p1\">](#_core_your_role_in_recordset_updating)</ept> and what the framework does for you.","source":"[Your role in recordset updating](#_core_your_role_in_recordset_updating) and what the framework does for you."},{"pos":[1805,1947],"content":"<bpt id=\"p1\">[</bpt>The recordset as an edit buffer<ept id=\"p1\">](#_core_the_edit_buffer)</ept> and the <bpt id=\"p2\">[</bpt>differences between dynasets and snapshots<ept id=\"p2\">](#_core_dynasets_and_snapshots)</ept>.","source":"[The recordset as an edit buffer](#_core_the_edit_buffer) and the [differences between dynasets and snapshots](#_core_dynasets_and_snapshots)."},{"pos":[1954,2156],"content":"<bpt id=\"p1\">[</bpt>Recordset: How AddNew, Edit, and Delete Work (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md)</ept> describes the actions of these functions from the point of view of the recordset.","source":"[Recordset: How AddNew, Edit, and Delete Work (ODBC)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md) describes the actions of these functions from the point of view of the recordset."},{"pos":[2163,2468],"content":"<bpt id=\"p1\">[</bpt>Recordset: More About Updates (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-more-about-updates-odbc.md)</ept> completes the recordset update story by explaining how transactions affect updates, how closing a recordset or scrolling affects updates in progress, and how your updates interact with the updates of other users.","source":"[Recordset: More About Updates (ODBC)](../../data/odbc/recordset-more-about-updates-odbc.md) completes the recordset update story by explaining how transactions affect updates, how closing a recordset or scrolling affects updates in progress, and how your updates interact with the updates of other users."},{"pos":[2531,2562],"content":"Your Role in Recordset Updating"},{"content":"The following table shows your role in using recordsets to add, edit, or delete records, along with what the framework does for you.","pos":[2566,2698]},{"content":"Recordset Updating: You and the Framework","pos":[2708,2749]},{"content":"You","pos":[2756,2759]},{"content":"The framework","pos":[2760,2773]},{"content":"Determine whether the data source is updateable (or appendable).","pos":[2812,2876]},{"pos":[2877,3016],"content":"Supplies <bpt id=\"p1\">[</bpt>CDatabase<ept id=\"p1\">](../../mfc/reference/cdatabase-class.md)</ept> member functions for testing the data source's updateability or appendability.","source":"Supplies [CDatabase](../../mfc/reference/cdatabase-class.md) member functions for testing the data source's updateability or appendability."},{"content":"Open an updatable recordset (of any type).","pos":[3021,3063]},{"pos":[3069,3190],"content":"Determine whether the recordset is updatable by calling <ph id=\"ph1\">`CRecordset`</ph> update functions such as <ph id=\"ph2\">`CanUpdate`</ph> or <ph id=\"ph3\">`CanAppend`</ph>.","source":"Determine whether the recordset is updatable by calling `CRecordset` update functions such as `CanUpdate` or `CanAppend`."},{"content":"Call recordset member functions to add, edit, and delete records.","pos":[3196,3261]},{"content":"Manages the mechanics of exchanging data between your recordset object and the data source.","pos":[3262,3353]},{"content":"Optionally, use transactions to control the update process.","pos":[3358,3417]},{"pos":[3418,3480],"content":"Supplies <ph id=\"ph1\">`CDatabase`</ph> member functions to support transactions.","source":"Supplies `CDatabase` member functions to support transactions."},{"pos":[3488,3591],"content":"For more information about transactions, see <bpt id=\"p1\">[</bpt>Transaction (ODBC)<ept id=\"p1\">](../../data/odbc/transaction-odbc.md)</ept>.","source":"For more information about transactions, see [Transaction (ODBC)](../../data/odbc/transaction-odbc.md)."},{"pos":[3638,3653],"content":"The Edit Buffer"},{"content":"Taken collectively, the field data members of a recordset serve as an edit buffer that contains one record — the current record.","pos":[3657,3785]},{"content":"Update operations use this buffer to operate on the current record.","pos":[3786,3853]},{"content":"When you add a record, the edit buffer is used to build a new record.","pos":[3863,3932]},{"content":"When you finish adding the record, the record that was previously current becomes current again.","pos":[3933,4029]},{"content":"When you update (edit) a record, the edit buffer is used to set the field data members of the recordset to new values.","pos":[4039,4157]},{"content":"When you finish updating, the updated record is still current.","pos":[4158,4220]},{"content":"When you call <bpt id=\"p1\">[</bpt>AddNew<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__addnew)</ept> or <bpt id=\"p2\">[</bpt>Edit<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__edit)</ept>, the current record is stored so it can be restored later as needed.","pos":[4227,4446],"source":"When you call [AddNew](../../mfc/reference/crecordset-class.md#crecordset__addnew) or [Edit](../../mfc/reference/crecordset-class.md#crecordset__edit), the current record is stored so it can be restored later as needed."},{"content":"When you call <bpt id=\"p1\">[</bpt>Delete<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__delete)</ept>, the current record is not stored but is marked as deleted and you must scroll to another record.","pos":[4447,4627],"source":" When you call [Delete](../../mfc/reference/crecordset-class.md#crecordset__delete), the current record is not stored but is marked as deleted and you must scroll to another record."},{"pos":[4635,4843],"content":"[!NOTE]\n The edit buffer plays no role in record deletion. When you delete the current record, the record is marked as deleted, and the recordset is \"not on a record\" until you scroll to a different record.","leadings":["","> "],"nodes":[{"content":" The edit buffer plays no role in record deletion. When you delete the current record, the record is marked as deleted, and the recordset is \"not on a record\" until you scroll to a different record.","pos":[8,206],"nodes":[{"content":"The edit buffer plays no role in record deletion.","pos":[1,50]},{"content":"When you delete the current record, the record is marked as deleted, and the recordset is \"not on a record\" until you scroll to a different record.","pos":[51,198]}]}]},{"pos":[4897,4919],"content":"Dynasets and Snapshots"},{"content":"<bpt id=\"p1\">[</bpt>Dynasets<ept id=\"p1\">](../../data/odbc/dynaset.md)</ept> refresh a record's contents as you scroll to the record.","pos":[4923,5018],"source":"[Dynasets](../../data/odbc/dynaset.md) refresh a record's contents as you scroll to the record."},{"content":"<bpt id=\"p1\">[</bpt>Snapshots<ept id=\"p1\">](../../data/odbc/snapshot.md)</ept> are static representations of the records, so a record's contents are not refreshed unless you call <bpt id=\"p2\">[</bpt>Requery<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__requery)</ept>.","pos":[5019,5231],"source":"[Snapshots](../../data/odbc/snapshot.md) are static representations of the records, so a record's contents are not refreshed unless you call [Requery](../../mfc/reference/crecordset-class.md#crecordset__requery)."},{"content":"To use all the functionality of dynasets, you must be working with an ODBC driver that conforms to the correct level of ODBC API support.","pos":[5232,5369]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ODBC<ept id=\"p1\">](../../data/odbc/odbc-basics.md)</ept> and <bpt id=\"p2\">[</bpt>Dynaset<ept id=\"p2\">](../../data/odbc/dynaset.md)</ept>.","pos":[5370,5477],"source":" For more information, see [ODBC](../../data/odbc/odbc-basics.md) and [Dynaset](../../data/odbc/dynaset.md)."},{"content":"See Also","pos":[5486,5494]},{"content":"Recordset (ODBC)","pos":[5499,5515]},{"content":"Recordset: How AddNew, Edit, and Delete Work (ODBC)","pos":[5557,5608]}],"content":"---\ntitle: \"Recordset: How Recordsets Update Records (ODBC) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"records, updating\"\n  - \"ODBC recordsets, updating\"\n  - \"recordsets, editing records\"\n  - \"updating recordsets\"\n  - \"recordsets, updating\"\nms.assetid: 5ceecc06-7a86-43b1-93db-a54fb1e717c7\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Recordset: How Recordsets Update Records (ODBC)\nThis topic applies to the MFC ODBC classes.  \n  \n Besides their ability to select records from a data source, recordsets can (optionally) update or delete the selected records or add new records. Three factors determine a recordset's updateability: whether the connected data source is updateable, the options you specify when you create a recordset object, and the SQL that is created.  \n  \n> [!NOTE]\n>  The SQL on which your `CRecordset` object is based can affect your recordset's updateability. For example, if your SQL contains a join or a **GROUP BY** clause, MFC sets the updateability to **FALSE**.  \n  \n> [!NOTE]\n>  This topic applies to objects derived from `CRecordset` in which bulk row fetching has not been implemented. If you are using bulk row fetching, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).  \n  \n This topic explains:  \n  \n-   [Your role in recordset updating](#_core_your_role_in_recordset_updating) and what the framework does for you.  \n  \n-   [The recordset as an edit buffer](#_core_the_edit_buffer) and the [differences between dynasets and snapshots](#_core_dynasets_and_snapshots).  \n  \n [Recordset: How AddNew, Edit, and Delete Work (ODBC)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md) describes the actions of these functions from the point of view of the recordset.  \n  \n [Recordset: More About Updates (ODBC)](../../data/odbc/recordset-more-about-updates-odbc.md) completes the recordset update story by explaining how transactions affect updates, how closing a recordset or scrolling affects updates in progress, and how your updates interact with the updates of other users.  \n  \n##  <a name=\"_core_your_role_in_recordset_updating\"></a> Your Role in Recordset Updating  \n The following table shows your role in using recordsets to add, edit, or delete records, along with what the framework does for you.  \n  \n### Recordset Updating: You and the Framework  \n  \n|You|The framework|  \n|---------|-------------------|  \n|Determine whether the data source is updateable (or appendable).|Supplies [CDatabase](../../mfc/reference/cdatabase-class.md) member functions for testing the data source's updateability or appendability.|  \n|Open an updatable recordset (of any type).||  \n|Determine whether the recordset is updatable by calling `CRecordset` update functions such as `CanUpdate` or `CanAppend`.||  \n|Call recordset member functions to add, edit, and delete records.|Manages the mechanics of exchanging data between your recordset object and the data source.|  \n|Optionally, use transactions to control the update process.|Supplies `CDatabase` member functions to support transactions.|  \n  \n For more information about transactions, see [Transaction (ODBC)](../../data/odbc/transaction-odbc.md).  \n  \n##  <a name=\"_core_the_edit_buffer\"></a> The Edit Buffer  \n Taken collectively, the field data members of a recordset serve as an edit buffer that contains one record — the current record. Update operations use this buffer to operate on the current record.  \n  \n-   When you add a record, the edit buffer is used to build a new record. When you finish adding the record, the record that was previously current becomes current again.  \n  \n-   When you update (edit) a record, the edit buffer is used to set the field data members of the recordset to new values. When you finish updating, the updated record is still current.  \n  \n When you call [AddNew](../../mfc/reference/crecordset-class.md#crecordset__addnew) or [Edit](../../mfc/reference/crecordset-class.md#crecordset__edit), the current record is stored so it can be restored later as needed. When you call [Delete](../../mfc/reference/crecordset-class.md#crecordset__delete), the current record is not stored but is marked as deleted and you must scroll to another record.  \n  \n> [!NOTE]\n>  The edit buffer plays no role in record deletion. When you delete the current record, the record is marked as deleted, and the recordset is \"not on a record\" until you scroll to a different record.  \n  \n##  <a name=\"_core_dynasets_and_snapshots\"></a> Dynasets and Snapshots  \n [Dynasets](../../data/odbc/dynaset.md) refresh a record's contents as you scroll to the record. [Snapshots](../../data/odbc/snapshot.md) are static representations of the records, so a record's contents are not refreshed unless you call [Requery](../../mfc/reference/crecordset-class.md#crecordset__requery). To use all the functionality of dynasets, you must be working with an ODBC driver that conforms to the correct level of ODBC API support. For more information, see [ODBC](../../data/odbc/odbc-basics.md) and [Dynaset](../../data/odbc/dynaset.md).  \n  \n## See Also  \n [Recordset (ODBC)](../../data/odbc/recordset-odbc.md)   \n [Recordset: How AddNew, Edit, and Delete Work (ODBC)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md)"}