{"nodes":[{"pos":[12,91],"content":"How to: Activate and Use a Windows Runtime Component Using WRL | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Activate and Use a Windows Runtime Component Using WRL | Microsoft Docs","pos":[0,79]}]},{"content":"How to: Activate and Use a Windows Runtime Component Using WRL","pos":[574,636]},{"pos":[637,956],"content":"This document shows how to use the <ph id=\"ph1\">[!INCLUDE[cppwrl](../windows/includes/cppwrl_md.md)]</ph> (<ph id=\"ph2\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph>) to initialize the <ph id=\"ph3\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> and how to activate and use a <ph id=\"ph4\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> component.","source":"This document shows how to use the [!INCLUDE[cppwrl](../windows/includes/cppwrl_md.md)] ([!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]) to initialize the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] and how to activate and use a [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component."},{"pos":[964,1300],"content":"[!NOTE]\n This example activates a built-in [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component. To learn how to create your own component that you can activate in a similar manner, see [Walkthrough: Creating a Basic Windows Runtime Component](../windows/walkthrough-creating-a-basic-windows-runtime-component-using-wrl.md).","leadings":["","> "],"nodes":[{"content":" This example activates a built-in [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component. To learn how to create your own component that you can activate in a similar manner, see [Walkthrough: Creating a Basic Windows Runtime Component](../windows/walkthrough-creating-a-basic-windows-runtime-component-using-wrl.md).","pos":[8,334],"nodes":[{"content":"This example activates a built-in <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> component.","pos":[1,98],"source":" This example activates a built-in [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component."},{"content":"To learn how to create your own component that you can activate in a similar manner, see <bpt id=\"p1\">[</bpt>Walkthrough: Creating a Basic Windows Runtime Component<ept id=\"p1\">](../windows/walkthrough-creating-a-basic-windows-runtime-component-using-wrl.md)</ept>.","pos":[99,326],"source":" To learn how to create your own component that you can activate in a similar manner, see [Walkthrough: Creating a Basic Windows Runtime Component](../windows/walkthrough-creating-a-basic-windows-runtime-component-using-wrl.md)."}]}]},{"content":"To use a component, you must acquire an interface pointer to the type that is implemented by the component.","pos":[1307,1414]},{"content":"And because the underlying technology of the <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> is the Component Object Model (COM), you must follow COM rules to maintain an instance of the type.","pos":[1415,1612],"source":" And because the underlying technology of the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] is the Component Object Model (COM), you must follow COM rules to maintain an instance of the type."},{"content":"For example, you must maintain the <bpt id=\"p1\">*</bpt>reference count<ept id=\"p1\">*</ept> that determines when the type is deleted from memory.","pos":[1613,1719],"source":" For example, you must maintain the *reference count* that determines when the type is deleted from memory."},{"content":"To simplify the use of the <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph>, <ph id=\"ph2\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> provides the smart pointer template, <bpt id=\"p1\">[</bpt>ComPtr<ph id=\"ph3\">\\&lt;</ph>T&gt;<ept id=\"p1\">](../windows/comptr-class.md)</ept>, that automatically performs reference counting.","pos":[1726,1998],"source":"To simplify the use of the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] provides the smart pointer template, [ComPtr\\<T>](../windows/comptr-class.md), that automatically performs reference counting."},{"content":"When you declare a variable, specify <ph id=\"ph1\">`ComPtr&lt;`</ph><bpt id=\"p1\">*</bpt>interface-name<ept id=\"p1\">*</ept><ph id=\"ph2\">`&gt;`</ph> <bpt id=\"p2\">*</bpt>identifier<ept id=\"p2\">*</ept>.","pos":[1999,2078],"source":" When you declare a variable, specify `ComPtr<`*interface-name*`>` *identifier*."},{"content":"To access an interface member, apply the arrow member-access operator (<ph id=\"ph1\">`-&gt;`</ph>) to the identifier.","pos":[2079,2174],"source":" To access an interface member, apply the arrow member-access operator (`->`) to the identifier."},{"pos":[2182,2274],"content":"[!IMPORTANT]\n When you call an interface function, always test the `HRESULT` return value.","leadings":["","> "],"nodes":[{"content":"When you call an interface function, always test the <ph id=\"ph1\">`HRESULT`</ph> return value.","pos":[14,90],"source":" When you call an interface function, always test the `HRESULT` return value."}]},{"content":"Activating and Using a Windows Runtime Component","pos":[2283,2331]},{"content":"The following steps use the <ph id=\"ph1\">`Windows::Foundation::IUriRuntimeClass`</ph> interface to demonstrate how to create an activation factory for a <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> component, create an instance of that component, and retrieve a property value.","pos":[2335,2602],"source":"The following steps use the `Windows::Foundation::IUriRuntimeClass` interface to demonstrate how to create an activation factory for a [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component, create an instance of that component, and retrieve a property value."},{"content":"They also show how to initialize the <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph>.","pos":[2603,2693],"source":" They also show how to initialize the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]."},{"content":"The complete example follows.","pos":[2694,2723]},{"pos":[2731,3470],"content":"[!IMPORTANT]\n Although you typically use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app, this example uses a console app for illustration. Functions such as `wprintf_s` are not available from a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app. For more information about the types and functions that you can use in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app, see [CRT functions not supported with /ZW](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx) and [Win32 and COM for Windows Store apps](http://msdn.microsoft.com/library/windows/apps/br205757.aspx).","leadings":["","> "],"nodes":[{"content":" Although you typically use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app, this example uses a console app for illustration. Functions such as `wprintf_s` are not available from a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app. For more information about the types and functions that you can use in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app, see [CRT functions not supported with /ZW](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx) and [Win32 and COM for Windows Store apps](http://msdn.microsoft.com/library/windows/apps/br205757.aspx).","pos":[13,737],"nodes":[{"content":"Although you typically use the <ph id=\"ph1\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph> in a <ph id=\"ph2\">[!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)]</ph> app, this example uses a console app for illustration.","pos":[1,229],"source":" Although you typically use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app, this example uses a console app for illustration."},{"content":"Functions such as <ph id=\"ph1\">`wprintf_s`</ph> are not available from a <ph id=\"ph2\">[!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)]</ph> app.","pos":[230,362],"source":" Functions such as `wprintf_s` are not available from a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app."},{"content":"For more information about the types and functions that you can use in a <ph id=\"ph1\">[!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)]</ph> app, see <bpt id=\"p1\">[</bpt>CRT functions not supported with /ZW<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx)</ept> and <bpt id=\"p2\">[</bpt>Win32 and COM for Windows Store apps<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/apps/br205757.aspx)</ept>.","pos":[363,724],"source":" For more information about the types and functions that you can use in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app, see [CRT functions not supported with /ZW](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx) and [Win32 and COM for Windows Store apps](http://msdn.microsoft.com/library/windows/apps/br205757.aspx)."}]}]},{"content":"To activate and use a Windows Runtime component","pos":[3481,3528]},{"pos":[3538,3724],"content":"Include (<ph id=\"ph1\">`#include`</ph>) any required <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph>, <ph id=\"ph3\">[!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]</ph>, or standard C++ library headers.","source":"Include (`#include`) any required [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)], or standard C++ library headers."},{"pos":[3746,3769],"content":"wrl-consume-component#2"},{"pos":[3878,3989],"content":"We recommend that you utilize the <ph id=\"ph1\">`using namespace`</ph> directive in your .cpp file to make the code more readable.","source":"We recommend that you utilize the `using namespace` directive in your .cpp file to make the code more readable."},{"content":"Initialize the thread in which the app executes.","pos":[3999,4047]},{"content":"Every app must initialize its thread and threading model.","pos":[4048,4105]},{"content":"This example uses the <bpt id=\"p1\">[</bpt>Microsoft::WRL::Wrappers::RoInitializeWrapper<ept id=\"p1\">](../windows/roinitializewrapper-class.md)</ept> class to initialize the <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> and specifies <bpt id=\"p2\">[</bpt>RO_INIT_MULTITHREADED<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/apps/br224661.aspx)</ept> as the threading model.","pos":[4106,4417],"source":" This example uses the [Microsoft::WRL::Wrappers::RoInitializeWrapper](../windows/roinitializewrapper-class.md) class to initialize the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] and specifies [RO_INIT_MULTITHREADED](http://msdn.microsoft.com/library/windows/apps/br224661.aspx) as the threading model."},{"content":"The <ph id=\"ph1\">`RoInitializeWrapper`</ph> class calls <ph id=\"ph2\">`Windows::Foundation::Initialize`</ph> at construction, and <ph id=\"ph3\">`Windows::Foundation::Uninitialize`</ph> when it is destroyed.","pos":[4418,4568],"source":" The `RoInitializeWrapper` class calls `Windows::Foundation::Initialize` at construction, and `Windows::Foundation::Uninitialize` when it is destroyed."},{"pos":[4590,4613],"content":"wrl-consume-component#3"},{"pos":[4722,4923],"content":"In the second statement, the <bpt id=\"p1\">[</bpt>RoInitializeWrapper::HRESULT<ept id=\"p1\">](../windows/roinitializewrapper-hresult-parens-operator.md)</ept> operator returns the <ph id=\"ph1\">`HRESULT`</ph> from the call to <ph id=\"ph2\">`Windows::Foundation::Initialize`</ph>.","source":"In the second statement, the [RoInitializeWrapper::HRESULT](../windows/roinitializewrapper-hresult-parens-operator.md) operator returns the `HRESULT` from the call to `Windows::Foundation::Initialize`."},{"pos":[4933,5034],"content":"Create an <bpt id=\"p1\">*</bpt>activation factory<ept id=\"p1\">*</ept> for the <ph id=\"ph1\">`ABI::Windows::Foundation::IUriRuntimeClassFactory`</ph> interface.","source":"Create an *activation factory* for the `ABI::Windows::Foundation::IUriRuntimeClassFactory` interface."},{"pos":[5056,5079],"content":"wrl-consume-component#4"},{"content":"The <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> uses fully-qualified names to identify types.","pos":[5188,5290],"source":"The [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] uses fully-qualified names to identify types."},{"content":"The <ph id=\"ph1\">`RuntimeClass_Windows_Foundation_Uri`</ph> parameter is a string that's provided by the <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> and contains the required runtime class name.","pos":[5291,5476],"source":" The `RuntimeClass_Windows_Foundation_Uri` parameter is a string that's provided by the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] and contains the required runtime class name."},{"pos":[5486,5626],"content":"Initialize a <bpt id=\"p1\">[</bpt>Microsoft::WRL::Wrappers::HString<ept id=\"p1\">](../windows/hstring-class.md)</ept> variable that represents the URI <ph id=\"ph1\">`\"http://www.microsoft.com\"`</ph>.","source":"Initialize a [Microsoft::WRL::Wrappers::HString](../windows/hstring-class.md) variable that represents the URI `\"http://www.microsoft.com\"`."},{"pos":[5648,5671],"content":"wrl-consume-component#6"},{"content":"In the <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph>, you don’t allocate memory for a string that the <ph id=\"ph2\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> will use.","pos":[5780,5951],"source":"In the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], you don’t allocate memory for a string that the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] will use."},{"content":"Instead, the <ph id=\"ph1\">[!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]</ph> creates a copy of your string in a buffer that it maintains and uses for operations, and then returns a handle to the buffer that it created.","pos":[5952,6159],"source":" Instead, the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] creates a copy of your string in a buffer that it maintains and uses for operations, and then returns a handle to the buffer that it created."},{"pos":[6169,6293],"content":"Use the <ph id=\"ph1\">`IUriRuntimeClassFactory::CreateUri`</ph> factory method to create a <ph id=\"ph2\">`ABI::Windows::Foundation::IUriRuntimeClass`</ph> object.","source":"Use the `IUriRuntimeClassFactory::CreateUri` factory method to create a `ABI::Windows::Foundation::IUriRuntimeClass` object."},{"pos":[6315,6338],"content":"wrl-consume-component#7"},{"pos":[6446,6540],"content":"Call the <ph id=\"ph1\">`IUriRuntimeClass::get_Domain`</ph> method to retrieve the value of the <ph id=\"ph2\">`Domain`</ph> property.","source":"Call the `IUriRuntimeClass::get_Domain` method to retrieve the value of the `Domain` property."},{"pos":[6562,6585],"content":"wrl-consume-component#8"},{"content":"Print the domain name to the console and return.","pos":[6693,6741]},{"content":"All <ph id=\"ph1\">`ComPtr`</ph> and RAII objects leave scope and are released automatically.","pos":[6742,6815],"source":" All `ComPtr` and RAII objects leave scope and are released automatically."},{"pos":[6837,6860],"content":"wrl-consume-component#9"},{"pos":[6969,7128],"content":"The <bpt id=\"p1\">[</bpt>WindowsGetStringRawBuffer<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/apps/br224636.aspx)</ept> function retrieves the underlying Unicode form of the URI string.","source":"The [WindowsGetStringRawBuffer](http://msdn.microsoft.com/library/windows/apps/br224636.aspx) function retrieves the underlying Unicode form of the URI string."},{"content":"Here's the complete example:","pos":[7135,7163]},{"pos":[7181,7204],"content":"wrl-consume-component#1"},{"content":"Compiling the Code","pos":[7311,7329]},{"pos":[7333,7548],"content":"To compile the code, copy it and then paste it in a Visual Studio project, or paste it in a file that is named <ph id=\"ph1\">`wrl-consume-component.cpp`</ph> and then run the following command in a Visual Studio Command Prompt window.","source":"To compile the code, copy it and then paste it in a Visual Studio project, or paste it in a file that is named `wrl-consume-component.cpp` and then run the following command in a Visual Studio Command Prompt window."},{"content":"cl.exe wrl-consume-component.cpp runtimeobject.lib","pos":[7557,7607]},{"content":"See Also","pos":[7618,7626]},{"content":"Windows Runtime C++ Template Library (WRL)","pos":[7631,7673]}],"content":"---\ntitle: \"How to: Activate and Use a Windows Runtime Component Using WRL | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\ndev_langs: \n  - \"C++\"\nms.assetid: 54828f02-6af3-45d1-b965-d0104442f8d5\ncaps.latest.revision: 17\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Activate and Use a Windows Runtime Component Using WRL\nThis document shows how to use the [!INCLUDE[cppwrl](../windows/includes/cppwrl_md.md)] ([!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)]) to initialize the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] and how to activate and use a [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component.  \n  \n> [!NOTE]\n>  This example activates a built-in [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component. To learn how to create your own component that you can activate in a similar manner, see [Walkthrough: Creating a Basic Windows Runtime Component](../windows/walkthrough-creating-a-basic-windows-runtime-component-using-wrl.md).  \n  \n To use a component, you must acquire an interface pointer to the type that is implemented by the component. And because the underlying technology of the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] is the Component Object Model (COM), you must follow COM rules to maintain an instance of the type. For example, you must maintain the *reference count* that determines when the type is deleted from memory.  \n  \n To simplify the use of the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] provides the smart pointer template, [ComPtr\\<T>](../windows/comptr-class.md), that automatically performs reference counting. When you declare a variable, specify `ComPtr<`*interface-name*`>` *identifier*. To access an interface member, apply the arrow member-access operator (`->`) to the identifier.  \n  \n> [!IMPORTANT]\n>  When you call an interface function, always test the `HRESULT` return value.  \n  \n## Activating and Using a Windows Runtime Component  \n The following steps use the `Windows::Foundation::IUriRuntimeClass` interface to demonstrate how to create an activation factory for a [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] component, create an instance of that component, and retrieve a property value. They also show how to initialize the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)]. The complete example follows.  \n  \n> [!IMPORTANT]\n>  Although you typically use the [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)] in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app, this example uses a console app for illustration. Functions such as `wprintf_s` are not available from a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app. For more information about the types and functions that you can use in a [!INCLUDE[win8_appname_long](../build/includes/win8_appname_long_md.md)] app, see [CRT functions not supported with /ZW](http://msdn.microsoft.com/library/windows/apps/jj606124.aspx) and [Win32 and COM for Windows Store apps](http://msdn.microsoft.com/library/windows/apps/br205757.aspx).  \n  \n#### To activate and use a Windows Runtime component  \n  \n1.  Include (`#include`) any required [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], [!INCLUDE[cppwrl_short](../windows/includes/cppwrl_short_md.md)], or standard C++ library headers.  \n  \n     [!code-cpp[wrl-consume-component#2](../windows/codesnippet/CPP/how-to-activate-and-use-a-windows-runtime-component-using-wrl_1.cpp)]  \n  \n     We recommend that you utilize the `using namespace` directive in your .cpp file to make the code more readable.  \n  \n2.  Initialize the thread in which the app executes. Every app must initialize its thread and threading model. This example uses the [Microsoft::WRL::Wrappers::RoInitializeWrapper](../windows/roinitializewrapper-class.md) class to initialize the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] and specifies [RO_INIT_MULTITHREADED](http://msdn.microsoft.com/library/windows/apps/br224661.aspx) as the threading model. The `RoInitializeWrapper` class calls `Windows::Foundation::Initialize` at construction, and `Windows::Foundation::Uninitialize` when it is destroyed.  \n  \n     [!code-cpp[wrl-consume-component#3](../windows/codesnippet/CPP/how-to-activate-and-use-a-windows-runtime-component-using-wrl_2.cpp)]  \n  \n     In the second statement, the [RoInitializeWrapper::HRESULT](../windows/roinitializewrapper-hresult-parens-operator.md) operator returns the `HRESULT` from the call to `Windows::Foundation::Initialize`.  \n  \n3.  Create an *activation factory* for the `ABI::Windows::Foundation::IUriRuntimeClassFactory` interface.  \n  \n     [!code-cpp[wrl-consume-component#4](../windows/codesnippet/CPP/how-to-activate-and-use-a-windows-runtime-component-using-wrl_3.cpp)]  \n  \n     The [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] uses fully-qualified names to identify types. The `RuntimeClass_Windows_Foundation_Uri` parameter is a string that's provided by the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] and contains the required runtime class name.  \n  \n4.  Initialize a [Microsoft::WRL::Wrappers::HString](../windows/hstring-class.md) variable that represents the URI `\"http://www.microsoft.com\"`.  \n  \n     [!code-cpp[wrl-consume-component#6](../windows/codesnippet/CPP/how-to-activate-and-use-a-windows-runtime-component-using-wrl_4.cpp)]  \n  \n     In the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)], you don’t allocate memory for a string that the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] will use. Instead, the [!INCLUDE[wrt](../atl/reference/includes/wrt_md.md)] creates a copy of your string in a buffer that it maintains and uses for operations, and then returns a handle to the buffer that it created.  \n  \n5.  Use the `IUriRuntimeClassFactory::CreateUri` factory method to create a `ABI::Windows::Foundation::IUriRuntimeClass` object.  \n  \n     [!code-cpp[wrl-consume-component#7](../windows/codesnippet/CPP/how-to-activate-and-use-a-windows-runtime-component-using-wrl_5.cpp)]  \n  \n6.  Call the `IUriRuntimeClass::get_Domain` method to retrieve the value of the `Domain` property.  \n  \n     [!code-cpp[wrl-consume-component#8](../windows/codesnippet/CPP/how-to-activate-and-use-a-windows-runtime-component-using-wrl_6.cpp)]  \n  \n7.  Print the domain name to the console and return. All `ComPtr` and RAII objects leave scope and are released automatically.  \n  \n     [!code-cpp[wrl-consume-component#9](../windows/codesnippet/CPP/how-to-activate-and-use-a-windows-runtime-component-using-wrl_7.cpp)]  \n  \n     The [WindowsGetStringRawBuffer](http://msdn.microsoft.com/library/windows/apps/br224636.aspx) function retrieves the underlying Unicode form of the URI string.  \n  \n Here's the complete example:  \n  \n [!code-cpp[wrl-consume-component#1](../windows/codesnippet/CPP/how-to-activate-and-use-a-windows-runtime-component-using-wrl_8.cpp)]  \n  \n## Compiling the Code  \n To compile the code, copy it and then paste it in a Visual Studio project, or paste it in a file that is named `wrl-consume-component.cpp` and then run the following command in a Visual Studio Command Prompt window.  \n  \n **cl.exe wrl-consume-component.cpp runtimeobject.lib**  \n  \n## See Also  \n [Windows Runtime C++ Template Library (WRL)](../windows/windows-runtime-cpp-template-library-wrl.md)"}