{"nodes":[{"pos":[12,53],"content":"Registering OLE Controls | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Registering OLE Controls | Microsoft Docs","pos":[0,41]}]},{"pos":[657,681],"content":"Registering OLE Controls","linkify":"Registering OLE Controls","nodes":[{"content":"Registering OLE Controls","pos":[0,24]}]},{"content":"OLE controls, like other OLE server objects, can be accessed by other OLE-aware applications.","pos":[682,775]},{"content":"This is achieved by registering the control's type library and class.","pos":[776,845]},{"content":"The following functions allow you to add and remove the control's class, property pages, and type library in the Windows registration database:","pos":[852,995]},{"pos":[1005,1029],"content":"Registering OLE Controls","linkify":"Registering OLE Controls","nodes":[{"content":"Registering OLE Controls","pos":[0,24]}]},{"pos":[1050,1107],"content":"<bpt id=\"p1\">[</bpt>AfxOleRegisterControlClass<ept id=\"p1\">](#afxoleregistercontrolclass)</ept>","source":"[AfxOleRegisterControlClass](#afxoleregistercontrolclass)"},{"content":"Adds the control's class to the registration database.","pos":[1108,1162]},{"pos":[1167,1234],"content":"<bpt id=\"p1\">[</bpt>AfxOleRegisterPropertyPageClass<ept id=\"p1\">](#afxoleregisterpropertypageclass)</ept>","source":"[AfxOleRegisterPropertyPageClass](#afxoleregisterpropertypageclass)"},{"content":"Adds a control property page to the registration database.","pos":[1235,1293]},{"pos":[1298,1345],"content":"<bpt id=\"p1\">[</bpt>AfxOleRegisterTypeLib<ept id=\"p1\">](#afxoleregistertypelib)</ept>","source":"[AfxOleRegisterTypeLib](#afxoleregistertypelib)"},{"content":"Adds the control's type library to the registration database.","pos":[1346,1407]},{"pos":[1412,1459],"content":"<bpt id=\"p1\">[</bpt>AfxOleUnregisterClass<ept id=\"p1\">](#afxoleunregisterclass)</ept>","source":"[AfxOleUnregisterClass](#afxoleunregisterclass)"},{"content":"Removes a control class or a property page class from the registration database.","pos":[1460,1540]},{"pos":[1545,1596],"content":"<bpt id=\"p1\">[</bpt>AfxOleUnregisterTypeLib<ept id=\"p1\">](#afxoleunregistertypelib)</ept>","source":"[AfxOleUnregisterTypeLib](#afxoleunregistertypelib)"},{"content":"Removes the control's type library from the registration database.","pos":[1597,1663]},{"content":"<ph id=\"ph1\">`AfxOleRegisterTypeLib`</ph> is typically called in a control DLL's implementation of <ph id=\"ph2\">`DllRegisterServer`</ph>.","pos":[1671,1772],"source":"`AfxOleRegisterTypeLib` is typically called in a control DLL's implementation of `DllRegisterServer`."},{"content":"Similarly, <ph id=\"ph1\">`AfxOleUnregisterTypeLib`</ph> is called by <ph id=\"ph2\">`DllUnregisterServer`</ph>.","pos":[1773,1845],"source":" Similarly, `AfxOleUnregisterTypeLib` is called by `DllUnregisterServer`."},{"content":"<ph id=\"ph1\">`AfxOleRegisterControlClass`</ph>, <ph id=\"ph2\">`AfxOleRegisterPropertyPageClass`</ph>, and <ph id=\"ph3\">`AfxOleUnregisterClass`</ph> are typically called by the <ph id=\"ph4\">`UpdateRegistry`</ph> member function of a control's class factory or property page.","pos":[1846,2046],"source":"`AfxOleRegisterControlClass`, `AfxOleRegisterPropertyPageClass`, and `AfxOleUnregisterClass` are typically called by the `UpdateRegistry` member function of a control's class factory or property page."},{"pos":[2056,2125],"content":"<bpt id=\"p1\">&lt;a name=\"afxoleregistercontrolclass\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AfxOleRegisterControlClass","linkify":"<a name=\"afxoleregistercontrolclass\"></a>  AfxOleRegisterControlClass","source":"<a name=\"afxoleregistercontrolclass\"></a>  AfxOleRegisterControlClass"},{"content":"Registers the control class with the Windows registration database.","pos":[2129,2196]},{"pos":[2491,2501],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The instance handle of the module associated with the control class.","pos":[2520,2588]},{"content":"The unique class ID of the control.","pos":[2606,2641]},{"content":"The unique program ID of the control.","pos":[2663,2700]},{"content":"The resource ID of the string that contains a user-readable type name for the control.","pos":[2723,2809]},{"content":"<bpt id=\"p1\">*</bpt>idBitmap<ept id=\"p1\">*</ept>","pos":[2816,2826],"source":"*idBitmap*"},{"content":"The resource ID of the bitmap used to represent the OLE control in a toolbar or palette.","pos":[2830,2918]},{"content":"Contains one or more of the following flags:","pos":[2940,2984]},{"pos":[2992,3088],"content":"<ph id=\"ph1\">`afxRegInsertable`</ph> Allows the control to appear in the Insert Object dialog box for OLE objects.","source":"`afxRegInsertable` Allows the control to appear in the Insert Object dialog box for OLE objects."},{"pos":[3096,3192],"content":"<ph id=\"ph1\">`afxRegApartmentThreading`</ph> Sets the threading model in the registry to ThreadingModel=Apartment.","source":"`afxRegApartmentThreading` Sets the threading model in the registry to ThreadingModel=Apartment."},{"pos":[3200,3286],"content":"<ph id=\"ph1\">`afxRegFreeThreading`</ph> Sets the threading model in the registry to ThreadingModel=Free.","source":"`afxRegFreeThreading` Sets the threading model in the registry to ThreadingModel=Free."},{"content":"You can combine the two flags <ph id=\"ph1\">`afxRegApartmentThreading`</ph> and <ph id=\"ph2\">`afxRegFreeThreading`</ph> to set ThreadingModel=Both.","pos":[3297,3407],"source":"You can combine the two flags `afxRegApartmentThreading` and `afxRegFreeThreading` to set ThreadingModel=Both."},{"content":"See <bpt id=\"p1\">[</bpt>InprocServer32<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682390)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for more information on threading model registration.","pos":[3408,3601],"source":" See [InprocServer32](http://msdn.microsoft.com/library/windows/desktop/ms682390) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information on threading model registration."},{"pos":[3609,3813],"content":"[!NOTE]\n In MFC versions before MFC 4.2, the `int` `nRegFlags` parameter was a **BOOL** parameter, *bInsertable*, that allowed or disallowed the control to be inserted from the Insert Object dialog box.","leadings":["","> "],"nodes":[{"content":"In MFC versions before MFC 4.2, the <ph id=\"ph1\">`int`</ph> <ph id=\"ph2\">`nRegFlags`</ph> parameter was a <bpt id=\"p1\">**</bpt>BOOL<ept id=\"p1\">**</ept> parameter, <bpt id=\"p2\">*</bpt>bInsertable<ept id=\"p2\">*</ept>, that allowed or disallowed the control to be inserted from the Insert Object dialog box.","pos":[9,202],"source":" In MFC versions before MFC 4.2, the `int` `nRegFlags` parameter was a **BOOL** parameter, *bInsertable*, that allowed or disallowed the control to be inserted from the Insert Object dialog box."}]},{"content":"<bpt id=\"p1\">*</bpt>dwMiscStatus<ept id=\"p1\">*</ept>","pos":[3820,3834],"source":"*dwMiscStatus*"},{"content":"Contains one or more of the following status flags (for a description of the flags, see <bpt id=\"p1\">**</bpt>OLEMISC<ept id=\"p1\">**</ept> enumeration in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>):","pos":[3838,4010],"source":" Contains one or more of the following status flags (for a description of the flags, see **OLEMISC** enumeration in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]):"},{"content":"OLEMISC_RECOMPOSEONRESIZE","pos":[4020,4045]},{"content":"OLEMISC_ONLYICONIC","pos":[4055,4073]},{"content":"OLEMISC_INSERTNOTREPLACE","pos":[4083,4107]},{"content":"OLEMISC_STATIC","pos":[4117,4131]},{"content":"OLEMISC_CANTLINKINSIDE","pos":[4141,4163]},{"content":"OLEMISC_CANLINKBYOLE1","pos":[4173,4194]},{"content":"OLEMISC_ISLINKOBJECT","pos":[4204,4224]},{"content":"OLEMISC_INSIDEOUT","pos":[4234,4251]},{"content":"OLEMISC_ACTIVATEWHENVISIBLE","pos":[4261,4288]},{"content":"OLEMISC_RENDERINGISDEVICEINDEPENDENT","pos":[4298,4334]},{"content":"OLEMISC_INVISIBLEATRUNTIME","pos":[4344,4370]},{"content":"OLEMISC_ALWAYSRUN","pos":[4380,4397]},{"content":"OLEMISC_ACTSLIKEBUTTON","pos":[4407,4429]},{"content":"OLEMISC_ACTSLIKELABEL","pos":[4439,4460]},{"content":"OLEMISC_NOUIACTIVATE","pos":[4470,4490]},{"content":"OLEMISC_ALIGNABLE","pos":[4500,4517]},{"content":"OLEMISC_IMEMODE","pos":[4527,4542]},{"content":"OLEMISC_SIMPLEFRAME","pos":[4552,4571]},{"content":"OLEMISC_SETCLIENTSITEFIRST","pos":[4581,4607]},{"pos":[4614,4659],"content":"*tlid*  \nThe unique ID of the control class.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>tlid<ept id=\"p1\">*</ept>","pos":[0,6],"source":"*tlid*"},{"content":"The unique ID of the control class.","pos":[9,44]}]},{"pos":[4666,4727],"content":"`wVerMajor`  \nThe major version number of the control class.","leadings":[""," "],"nodes":[{"content":"The major version number of the control class.","pos":[14,60]}]},{"pos":[4734,4795],"content":"`wVerMinor`  \nThe minor version number of the control class.","leadings":[""," "],"nodes":[{"content":"The minor version number of the control class.","pos":[14,60]}]},{"pos":[4805,4817],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control class was registered; otherwise 0.","pos":[4821,4878]},{"pos":[4888,4895],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This allows the control to be used by containers that are OLE-control aware.","pos":[4899,4975]},{"content":"<ph id=\"ph1\">`AfxOleRegisterControlClass`</ph> updates the registry with the control's name and location on the system and also sets the threading model that the control supports in the registry.","pos":[4976,5153],"source":"`AfxOleRegisterControlClass` updates the registry with the control's name and location on the system and also sets the threading model that the control supports in the registry."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Technical Note 64<ept id=\"p1\">](../../mfc/tn064-apartment-model-threading-in-activex-controls.md)</ept>, \"Apartment-Model Threading in OLE Controls,\" and <bpt id=\"p2\">[</bpt>About Processes and Threads<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms681917)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[5154,5465],"source":" For more information, see [Technical Note 64](../../mfc/tn064-apartment-model-threading-in-activex-controls.md), \"Apartment-Model Threading in OLE Controls,\" and [About Processes and Threads](http://msdn.microsoft.com/library/windows/desktop/ms681917) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[5475,5482],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[5486,5582],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#11<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/registering-ole-controls_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#11](../../mfc/reference/codesnippet/cpp/registering-ole-controls_1.cpp)]"},{"pos":[5589,5769],"content":"The above example demonstrates how <ph id=\"ph1\">`AfxOleRegisterControlClass`</ph> is called with the flag for insertable and the flag for apartment model ORed together to create the sixth parameter:","source":"The above example demonstrates how `AfxOleRegisterControlClass` is called with the flag for insertable and the flag for apartment model ORed together to create the sixth parameter:"},{"pos":[5776,5872],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#12<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/registering-ole-controls_2.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#12](../../mfc/reference/codesnippet/cpp/registering-ole-controls_2.cpp)]"},{"content":"The control will show up in the Insert Object dialog box for enabled containers, and it will be apartment model-aware.","pos":[5879,5997]},{"content":"Apartment model-aware controls must ensure that static class data is protected by locks, so that while a control in one apartment is accessing the static data, it isn't disabled by the scheduler before it is finished, and another instance of the same class starts using the same static data.","pos":[5998,6289]},{"content":"Any accesses to the static data will be surrounded by critical section code.","pos":[6290,6366]},{"pos":[6376,6455],"content":"<bpt id=\"p1\">&lt;a name=\"afxoleregisterpropertypageclass\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AfxOleRegisterPropertyPageClass","linkify":"<a name=\"afxoleregisterpropertypageclass\"></a>  AfxOleRegisterPropertyPageClass","source":"<a name=\"afxoleregisterpropertypageclass\"></a>  AfxOleRegisterPropertyPageClass"},{"content":"Registers the property page class with the Windows registration database.","pos":[6459,6532]},{"pos":[6692,6702],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The instance handle of the module associated with the property page class.","pos":[6721,6795]},{"content":"The unique class ID of the property page.","pos":[6813,6854]},{"content":"The resource ID of the string that contains a user-readable name for the property page.","pos":[6877,6964]},{"content":"May contain the flag:","pos":[6986,7007]},{"pos":[7015,7113],"content":"<ph id=\"ph1\">`afxRegApartmentThreading`</ph> Sets the threading model in the registry to ThreadingModel = Apartment.","source":"`afxRegApartmentThreading` Sets the threading model in the registry to ThreadingModel = Apartment."},{"pos":[7121,7345],"content":"[!NOTE]\n In MFC versions prior to MFC 4.2, the `int` `nRegFlags` parameter was not available. Note also that the `afxRegInsertable` flag is not a valid option for property pages and will cause an ASSERT in MFC if it is set","leadings":["","> "],"nodes":[{"content":" In MFC versions prior to MFC 4.2, the `int` `nRegFlags` parameter was not available. Note also that the `afxRegInsertable` flag is not a valid option for property pages and will cause an ASSERT in MFC if it is set","pos":[8,222],"nodes":[{"content":"In MFC versions prior to MFC 4.2, the <ph id=\"ph1\">`int`</ph> <ph id=\"ph2\">`nRegFlags`</ph> parameter was not available.","pos":[1,85],"source":" In MFC versions prior to MFC 4.2, the `int` `nRegFlags` parameter was not available."},{"content":"Note also that the <ph id=\"ph1\">`afxRegInsertable`</ph> flag is not a valid option for property pages and will cause an ASSERT in MFC if it is set","pos":[86,214],"source":" Note also that the `afxRegInsertable` flag is not a valid option for property pages and will cause an ASSERT in MFC if it is set"}]}]},{"pos":[7355,7367],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control class was registered; otherwise 0.","pos":[7371,7428]},{"pos":[7438,7445],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This allows the property page to be used by containers that are OLE-control aware.","pos":[7449,7531]},{"content":"<ph id=\"ph1\">`AfxOleRegisterPropertyPageClass`</ph> updates the registry with the property page name and its location on the system and also sets the threading model that the control supports in the registry.","pos":[7532,7722],"source":"`AfxOleRegisterPropertyPageClass` updates the registry with the property page name and its location on the system and also sets the threading model that the control supports in the registry."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Technical Note 64<ept id=\"p1\">](../../mfc/tn064-apartment-model-threading-in-activex-controls.md)</ept>, \"Apartment-Model Threading in OLE Controls,\" and <bpt id=\"p2\">[</bpt>About Processes and Threads<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms681917)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[7723,8034],"source":" For more information, see [Technical Note 64](../../mfc/tn064-apartment-model-threading-in-activex-controls.md), \"Apartment-Model Threading in OLE Controls,\" and [About Processes and Threads](http://msdn.microsoft.com/library/windows/desktop/ms681917) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[8044,8103],"content":"<bpt id=\"p1\">&lt;a name=\"afxoleregistertypelib\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AfxOleRegisterTypeLib","linkify":"<a name=\"afxoleregistertypelib\"></a>  AfxOleRegisterTypeLib","source":"<a name=\"afxoleregistertypelib\"></a>  AfxOleRegisterTypeLib"},{"content":"Registers the type library with the Windows registration database and allows the type library to be used by other containers that are OLE-control aware.","pos":[8107,8259]},{"pos":[8428,8438],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The instance handle of the application associated with the type library.","pos":[8457,8529]},{"content":"<bpt id=\"p1\">*</bpt>tlid<ept id=\"p1\">*</ept>","pos":[8536,8542],"source":"*tlid*"},{"content":"The unique ID of the type library.","pos":[8546,8580]},{"content":"<bpt id=\"p1\">*</bpt>pszFileName<ept id=\"p1\">*</ept>","pos":[8587,8600],"source":"*pszFileName*"},{"content":"Points to the optional filename of a localized type library (.TLB) file for the control.","pos":[8604,8692]},{"content":"<bpt id=\"p1\">*</bpt>pszHelpDir<ept id=\"p1\">*</ept>","pos":[8699,8711],"source":"*pszHelpDir*"},{"content":"The name of the directory where the help file for the type library can be found.","pos":[8715,8795]},{"content":"If <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the help file is assumed to be in the same directory as the type library itself.","pos":[8796,8889],"source":" If **NULL**, the help file is assumed to be in the same directory as the type library itself."},{"pos":[8899,8911],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the type library was registered; otherwise 0.","pos":[8915,8971]},{"pos":[8981,8988],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"This function updates the registry with the type library name and its location on the system.","pos":[8992,9085]},{"pos":[9095,9102],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[9106,9196],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAutomation#7<ept id=\"p2\">](../../mfc/codesnippet/cpp/registering-ole-controls_3.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAutomation#7](../../mfc/codesnippet/cpp/registering-ole-controls_3.cpp)]"},{"pos":[9203,9293],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAutomation#8<ept id=\"p2\">](../../mfc/codesnippet/cpp/registering-ole-controls_4.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAutomation#8](../../mfc/codesnippet/cpp/registering-ole-controls_4.cpp)]"},{"pos":[9303,9362],"content":"<bpt id=\"p1\">&lt;a name=\"afxoleunregisterclass\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AfxOleUnregisterClass","linkify":"<a name=\"afxoleunregisterclass\"></a>  AfxOleUnregisterClass","source":"<a name=\"afxoleunregisterclass\"></a>  AfxOleUnregisterClass"},{"content":"Removes the control or property page class entry from the Windows registration database.","pos":[9366,9454]},{"pos":[9550,9560],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>clsID<ept id=\"p1\">*</ept>","pos":[9564,9571],"source":"*clsID*"},{"content":"The unique class ID of the control or property page.","pos":[9575,9627]},{"content":"The unique program ID of the control or property page.","pos":[9649,9703]},{"pos":[9713,9725],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the control or property page class was successfully unregistered; otherwise 0.","pos":[9729,9818]},{"pos":[9828,9891],"content":"<bpt id=\"p1\">&lt;a name=\"afxoleunregistertypelib\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  AfxOleUnregisterTypeLib","linkify":"<a name=\"afxoleunregistertypelib\"></a>  AfxOleUnregisterTypeLib","source":"<a name=\"afxoleunregistertypelib\"></a>  AfxOleUnregisterTypeLib"},{"content":"Call this function to remove the type library entry from the Windows registration database.","pos":[9895,9986]},{"pos":[10064,10074],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The unique ID of the type library.","pos":[10088,10122]},{"pos":[10132,10144],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if the type library was successfully unregistered; otherwise 0.","pos":[10148,10219]},{"pos":[10229,10236],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[10240,10336],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCAxCtl#13<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/registering-ole-controls_5.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCAxCtl#13](../../mfc/reference/codesnippet/cpp/registering-ole-controls_5.cpp)]"},{"pos":[10345,10353],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"pos":[10357,10424],"content":"<bpt id=\"p1\">[</bpt>Macros and Globals<ept id=\"p1\">](../../mfc/reference/mfc-macros-and-globals.md)</ept>","source":"[Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)"}],"content":"---\ntitle: \"Registering OLE Controls | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"vc.mfc.macros.ole\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"registering OLE controls\"\n  - \"OLE controls, registering\"\nms.assetid: 73c45b7f-7dbc-43f5-bd17-dd77c6acec72\ncaps.latest.revision: 15\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Registering OLE Controls\nOLE controls, like other OLE server objects, can be accessed by other OLE-aware applications. This is achieved by registering the control's type library and class.  \n  \n The following functions allow you to add and remove the control's class, property pages, and type library in the Windows registration database:  \n  \n### Registering OLE Controls  \n  \n|||  \n|-|-|  \n|[AfxOleRegisterControlClass](#afxoleregistercontrolclass)|Adds the control's class to the registration database.|  \n|[AfxOleRegisterPropertyPageClass](#afxoleregisterpropertypageclass)|Adds a control property page to the registration database.|  \n|[AfxOleRegisterTypeLib](#afxoleregistertypelib)|Adds the control's type library to the registration database.|  \n|[AfxOleUnregisterClass](#afxoleunregisterclass)|Removes a control class or a property page class from the registration database.|  \n|[AfxOleUnregisterTypeLib](#afxoleunregistertypelib)|Removes the control's type library from the registration database.|  \n  \n `AfxOleRegisterTypeLib` is typically called in a control DLL's implementation of `DllRegisterServer`. Similarly, `AfxOleUnregisterTypeLib` is called by `DllUnregisterServer`. `AfxOleRegisterControlClass`, `AfxOleRegisterPropertyPageClass`, and `AfxOleUnregisterClass` are typically called by the `UpdateRegistry` member function of a control's class factory or property page.  \n  \n##  <a name=\"afxoleregistercontrolclass\"></a>  AfxOleRegisterControlClass  \n Registers the control class with the Windows registration database.  \n  \n```   \nBOOL AFXAPI AfxOleRegisterControlClass(\n    HINSTANCE hInstance,  \n    REFCLSID clsid,  \n    LPCTSTR pszProgID,  \n    UINT idTypeName,  \n    UINT idBitmap,  \n    int nRegFlags,  \n    DWORD dwMiscStatus,  \n    REFGUID tlid,  \n    WORD wVerMajor,  \n    WORD wVerMinor); \n```  \n  \n### Parameters  \n `hInstance`  \n The instance handle of the module associated with the control class.  \n  \n `clsid`  \n The unique class ID of the control.  \n  \n `pszProgID`  \n The unique program ID of the control.  \n  \n `idTypeName`  \n The resource ID of the string that contains a user-readable type name for the control.  \n  \n *idBitmap*  \n The resource ID of the bitmap used to represent the OLE control in a toolbar or palette.  \n  \n `nRegFlags`  \n Contains one or more of the following flags:  \n  \n- `afxRegInsertable` Allows the control to appear in the Insert Object dialog box for OLE objects.  \n  \n- `afxRegApartmentThreading` Sets the threading model in the registry to ThreadingModel=Apartment.  \n  \n- `afxRegFreeThreading` Sets the threading model in the registry to ThreadingModel=Free.  \n  \n     You can combine the two flags `afxRegApartmentThreading` and `afxRegFreeThreading` to set ThreadingModel=Both. See [InprocServer32](http://msdn.microsoft.com/library/windows/desktop/ms682390) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for more information on threading model registration.  \n  \n> [!NOTE]\n>  In MFC versions before MFC 4.2, the `int` `nRegFlags` parameter was a **BOOL** parameter, *bInsertable*, that allowed or disallowed the control to be inserted from the Insert Object dialog box.  \n  \n *dwMiscStatus*  \n Contains one or more of the following status flags (for a description of the flags, see **OLEMISC** enumeration in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]):  \n  \n-   OLEMISC_RECOMPOSEONRESIZE  \n  \n-   OLEMISC_ONLYICONIC  \n  \n-   OLEMISC_INSERTNOTREPLACE  \n  \n-   OLEMISC_STATIC  \n  \n-   OLEMISC_CANTLINKINSIDE  \n  \n-   OLEMISC_CANLINKBYOLE1  \n  \n-   OLEMISC_ISLINKOBJECT  \n  \n-   OLEMISC_INSIDEOUT  \n  \n-   OLEMISC_ACTIVATEWHENVISIBLE  \n  \n-   OLEMISC_RENDERINGISDEVICEINDEPENDENT  \n  \n-   OLEMISC_INVISIBLEATRUNTIME  \n  \n-   OLEMISC_ALWAYSRUN  \n  \n-   OLEMISC_ACTSLIKEBUTTON  \n  \n-   OLEMISC_ACTSLIKELABEL  \n  \n-   OLEMISC_NOUIACTIVATE  \n  \n-   OLEMISC_ALIGNABLE  \n  \n-   OLEMISC_IMEMODE  \n  \n-   OLEMISC_SIMPLEFRAME  \n  \n-   OLEMISC_SETCLIENTSITEFIRST  \n  \n *tlid*  \n The unique ID of the control class.  \n  \n `wVerMajor`  \n The major version number of the control class.  \n  \n `wVerMinor`  \n The minor version number of the control class.  \n  \n### Return Value  \n Nonzero if the control class was registered; otherwise 0.  \n  \n### Remarks  \n This allows the control to be used by containers that are OLE-control aware. `AfxOleRegisterControlClass` updates the registry with the control's name and location on the system and also sets the threading model that the control supports in the registry. For more information, see [Technical Note 64](../../mfc/tn064-apartment-model-threading-in-activex-controls.md), \"Apartment-Model Threading in OLE Controls,\" and [About Processes and Threads](http://msdn.microsoft.com/library/windows/desktop/ms681917) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n [!code-cpp[NVC_MFCAxCtl#11](../../mfc/reference/codesnippet/cpp/registering-ole-controls_1.cpp)]  \n  \n The above example demonstrates how `AfxOleRegisterControlClass` is called with the flag for insertable and the flag for apartment model ORed together to create the sixth parameter:  \n  \n [!code-cpp[NVC_MFCAxCtl#12](../../mfc/reference/codesnippet/cpp/registering-ole-controls_2.cpp)]  \n  \n The control will show up in the Insert Object dialog box for enabled containers, and it will be apartment model-aware. Apartment model-aware controls must ensure that static class data is protected by locks, so that while a control in one apartment is accessing the static data, it isn't disabled by the scheduler before it is finished, and another instance of the same class starts using the same static data. Any accesses to the static data will be surrounded by critical section code.  \n  \n##  <a name=\"afxoleregisterpropertypageclass\"></a>  AfxOleRegisterPropertyPageClass  \n Registers the property page class with the Windows registration database.  \n  \n```  \nBOOL AFXAPI AfxOleRegisterPropertyPageClass(\n   HINSTANCE hInstance,  \n   REFCLSID  clsid,  \n   UINT idTypeName,  \n   int nRegFlags); \n```  \n  \n### Parameters  \n `hInstance`  \n The instance handle of the module associated with the property page class.  \n  \n `clsid`  \n The unique class ID of the property page.  \n  \n `idTypeName`  \n The resource ID of the string that contains a user-readable name for the property page.  \n  \n `nRegFlags`  \n May contain the flag:  \n  \n- `afxRegApartmentThreading` Sets the threading model in the registry to ThreadingModel = Apartment.  \n  \n> [!NOTE]\n>  In MFC versions prior to MFC 4.2, the `int` `nRegFlags` parameter was not available. Note also that the `afxRegInsertable` flag is not a valid option for property pages and will cause an ASSERT in MFC if it is set  \n  \n### Return Value  \n Nonzero if the control class was registered; otherwise 0.  \n  \n### Remarks  \n This allows the property page to be used by containers that are OLE-control aware. `AfxOleRegisterPropertyPageClass` updates the registry with the property page name and its location on the system and also sets the threading model that the control supports in the registry. For more information, see [Technical Note 64](../../mfc/tn064-apartment-model-threading-in-activex-controls.md), \"Apartment-Model Threading in OLE Controls,\" and [About Processes and Threads](http://msdn.microsoft.com/library/windows/desktop/ms681917) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"afxoleregistertypelib\"></a>  AfxOleRegisterTypeLib  \n Registers the type library with the Windows registration database and allows the type library to be used by other containers that are OLE-control aware.  \n  \n```   \nBOOL AfxOleRegisterTypeLib(\n    HINSTANCE hInstance,  \n    REFGUID tlid,  \n    LPCTSTR pszFileName = NULL,  \n    LPCTSTR pszHelpDir  = NULL); \n```  \n  \n### Parameters  \n `hInstance`  \n The instance handle of the application associated with the type library.  \n  \n *tlid*  \n The unique ID of the type library.  \n  \n *pszFileName*  \n Points to the optional filename of a localized type library (.TLB) file for the control.  \n  \n *pszHelpDir*  \n The name of the directory where the help file for the type library can be found. If **NULL**, the help file is assumed to be in the same directory as the type library itself.  \n  \n### Return Value  \n Nonzero if the type library was registered; otherwise 0.  \n  \n### Remarks  \n This function updates the registry with the type library name and its location on the system.  \n  \n### Example  \n [!code-cpp[NVC_MFCAutomation#7](../../mfc/codesnippet/cpp/registering-ole-controls_3.cpp)]  \n  \n [!code-cpp[NVC_MFCAutomation#8](../../mfc/codesnippet/cpp/registering-ole-controls_4.cpp)]  \n  \n##  <a name=\"afxoleunregisterclass\"></a>  AfxOleUnregisterClass  \n Removes the control or property page class entry from the Windows registration database.  \n  \n```   \nBOOL AFXAPI AfxOleUnregisterClass(REFCLSID clsID, LPCSTR pszProgID); \n```  \n  \n### Parameters  \n *clsID*  \n The unique class ID of the control or property page.  \n  \n `pszProgID`  \n The unique program ID of the control or property page.  \n  \n### Return Value  \n Nonzero if the control or property page class was successfully unregistered; otherwise 0.  \n  \n##  <a name=\"afxoleunregistertypelib\"></a>  AfxOleUnregisterTypeLib  \n Call this function to remove the type library entry from the Windows registration database.  \n  \n```   \nBOOL AFXAPI AfxOleUnregisterTypeLib(REFGUID tlID); \n```  \n  \n### Parameters  \n `tlID`  \n The unique ID of the type library.  \n  \n### Return Value  \n Nonzero if the type library was successfully unregistered; otherwise 0.  \n  \n### Example  \n [!code-cpp[NVC_MFCAxCtl#13](../../mfc/reference/codesnippet/cpp/registering-ole-controls_5.cpp)]  \n  \n## See Also  \n [Macros and Globals](../../mfc/reference/mfc-macros-and-globals.md)\n"}