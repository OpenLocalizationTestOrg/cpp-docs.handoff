{"nodes":[{"pos":[12,48],"content":"CComAggObject Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComAggObject Class | Microsoft Docs","pos":[0,36]}]},{"pos":[808,827],"content":"CComAggObject Class","linkify":"CComAggObject Class","nodes":[{"content":"CComAggObject Class","pos":[0,19]}]},{"content":"This class implements the <bpt id=\"p1\">[</bpt>IUnknown<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680509)</ept> interface for an aggregated object.","pos":[828,960],"source":"This class implements the [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) interface for an aggregated object."},{"content":"By definition, an aggregated object is contained within an outer object.","pos":[961,1033]},{"content":"The <ph id=\"ph1\">`CComAggObject`</ph> class is similar to the <bpt id=\"p1\">[</bpt>CComObject Class<ept id=\"p1\">](../../atl/reference/ccomobject-class.md)</ept>, except that it exposes an interface that is directly accessible to external clients.","pos":[1034,1223],"source":" The `CComAggObject` class is similar to the [CComObject Class](../../atl/reference/ccomobject-class.md), except that it exposes an interface that is directly accessible to external clients."},{"pos":[1232,1238],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[1399,1409],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Your class, derived from <bpt id=\"p1\">[</bpt>CComObjectRoot<ept id=\"p1\">](../../atl/reference/ccomobjectroot-class.md)</ept> or <bpt id=\"p2\">[</bpt>CComObjectRootEx<ept id=\"p2\">](../../atl/reference/ccomobjectrootex-class.md)</ept>, as well as from any other interfaces you want to support on the object.","pos":[1428,1656],"source":" Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md), as well as from any other interfaces you want to support on the object."},{"pos":[1665,1672],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[1682,1701],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[1708,1712]},{"content":"Description","pos":[1713,1724]},{"pos":[1762,1823],"content":"<bpt id=\"p1\">[</bpt>CComAggObject::CComAggObject<ept id=\"p1\">](#ccomaggobject__ccomaggobject)</ept>","source":"[CComAggObject::CComAggObject](#ccomaggobject__ccomaggobject)"},{"content":"The constructor.","pos":[1824,1840]},{"pos":[1845,1912],"content":"<bpt id=\"p1\">[</bpt>CComAggObject::~CComAggObject<ept id=\"p1\">](#ccomaggobject___dtorccomaggobject)</ept>","source":"[CComAggObject::~CComAggObject](#ccomaggobject___dtorccomaggobject)"},{"content":"The destructor.","pos":[1913,1928]},{"pos":[1939,1953],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1960,1964]},{"content":"Description","pos":[1965,1976]},{"pos":[2014,2061],"content":"<bpt id=\"p1\">[</bpt>CComAggObject::AddRef<ept id=\"p1\">](#ccomaggobject__addref)</ept>","source":"[CComAggObject::AddRef](#ccomaggobject__addref)"},{"content":"Increments the reference count on the aggregated object.","pos":[2062,2118]},{"pos":[2123,2186],"content":"<bpt id=\"p1\">[</bpt>CComAggObject::CreateInstance<ept id=\"p1\">](#ccomaggobject__createinstance)</ept>","source":"[CComAggObject::CreateInstance](#ccomaggobject__createinstance)"},{"pos":[2187,2382],"content":"This static function allows you to create a new <bpt id=\"p1\">**</bpt>CComAggObject&lt;<ept id=\"p1\">**</ept> <ph id=\"ph1\">`contained`</ph> <bpt id=\"p2\">**</bpt><ph id=\"ph2\">&gt;</ph><ept id=\"p2\">**</ept> object without the overhead of <bpt id=\"p3\">[</bpt>CoCreateInstance<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/ms686615)</ept>.","source":"This static function allows you to create a new **CComAggObject<** `contained` **>** object without the overhead of [CoCreateInstance](http://msdn.microsoft.com/library/windows/desktop/ms686615)."},{"pos":[2387,2450],"content":"<bpt id=\"p1\">[</bpt>CComAggObject::FinalConstruct<ept id=\"p1\">](#ccomaggobject__finalconstruct)</ept>","source":"[CComAggObject::FinalConstruct](#ccomaggobject__finalconstruct)"},{"pos":[2451,2498],"content":"Performs final initialization of <ph id=\"ph1\">`m_contained`</ph>.","source":"Performs final initialization of `m_contained`."},{"pos":[2503,2562],"content":"<bpt id=\"p1\">[</bpt>CComAggObject::FinalRelease<ept id=\"p1\">](#ccomaggobject__finalrelease)</ept>","source":"[CComAggObject::FinalRelease](#ccomaggobject__finalrelease)"},{"pos":[2563,2607],"content":"Performs final destruction of <ph id=\"ph1\">`m_contained`</ph>.","source":"Performs final destruction of `m_contained`."},{"pos":[2612,2675],"content":"<bpt id=\"p1\">[</bpt>CComAggObject::QueryInterface<ept id=\"p1\">](#ccomaggobject__queryinterface)</ept>","source":"[CComAggObject::QueryInterface](#ccomaggobject__queryinterface)"},{"content":"Retrieves a pointer to the requested interface.","pos":[2676,2723]},{"pos":[2728,2777],"content":"<bpt id=\"p1\">[</bpt>CComAggObject::Release<ept id=\"p1\">](#ccomaggobject__release)</ept>","source":"[CComAggObject::Release](#ccomaggobject__release)"},{"content":"Decrements the reference count on the aggregated object.","pos":[2778,2834]},{"pos":[2845,2864],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[2871,2875]},{"content":"Description","pos":[2876,2887]},{"pos":[2925,2982],"content":"<bpt id=\"p1\">[</bpt>CComAggObject::m_contained<ept id=\"p1\">](#ccomaggobject__m_contained)</ept>","source":"[CComAggObject::m_contained](#ccomaggobject__m_contained)"},{"pos":[2983,3031],"content":"Delegates <ph id=\"ph1\">`IUnknown`</ph> calls to the outer unknown.","source":"Delegates `IUnknown` calls to the outer unknown."},{"pos":[3041,3048],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`CComAggObject`</ph> implements <bpt id=\"p1\">[</bpt>IUnknown<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms680509)</ept> for an aggregated object.","pos":[3052,3175],"source":"`CComAggObject` implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) for an aggregated object."},{"content":"<ph id=\"ph1\">`CComAggObject`</ph> has its own <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> interface, separate from the outer object's <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> interface, and maintains its own reference count.","pos":[3176,3323],"source":"`CComAggObject` has its own **IUnknown** interface, separate from the outer object's **IUnknown** interface, and maintains its own reference count."},{"pos":[3330,3466],"content":"For more information about aggregation, see the article <bpt id=\"p1\">[</bpt>Fundamentals of ATL COM Objects<ept id=\"p1\">](../../atl/fundamentals-of-atl-com-objects.md)</ept>.","source":"For more information about aggregation, see the article [Fundamentals of ATL COM Objects](../../atl/fundamentals-of-atl-com-objects.md)."},{"pos":[3475,3496],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3527,3592],"content":"<bpt id=\"p1\">[</bpt>CComObjectRootEx<ept id=\"p1\">](../../atl/reference/ccomobjectrootex-class.md)</ept>","source":"[CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md)"},{"pos":[3640,3652],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3656,3676],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[3686,3745],"content":"<bpt id=\"p1\">&lt;a name=\"ccomaggobject__addref\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComAggObject::AddRef","linkify":"<a name=\"ccomaggobject__addref\"></a>  CComAggObject::AddRef","source":"<a name=\"ccomaggobject__addref\"></a>  CComAggObject::AddRef"},{"content":"Increments the reference count on the aggregated object.","pos":[3749,3805]},{"pos":[3857,3869],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A value that may be useful for diagnostics or testing.","pos":[3873,3927]},{"pos":[3937,4010],"content":"<bpt id=\"p1\">&lt;a name=\"ccomaggobject__ccomaggobject\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComAggObject::CComAggObject","linkify":"<a name=\"ccomaggobject__ccomaggobject\"></a>  CComAggObject::CComAggObject","source":"<a name=\"ccomaggobject__ccomaggobject\"></a>  CComAggObject::CComAggObject"},{"content":"The constructor.","pos":[4014,4030]},{"pos":[4078,4088],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The outer unknown.","pos":[4100,4123]},{"pos":[4133,4140],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4144,4271],"content":"Initializes the <ph id=\"ph1\">`CComContainedObject`</ph> member, <bpt id=\"p1\">[</bpt>m_contained<ept id=\"p1\">](#ccomaggobject__m_contained)</ept>, and increments the module lock count.","source":"Initializes the `CComContainedObject` member, [m_contained](#ccomaggobject__m_contained), and increments the module lock count."},{"content":"The destructor decrements the module lock count.","pos":[4278,4326]},{"pos":[4336,4415],"content":"<bpt id=\"p1\">&lt;a name=\"ccomaggobject___dtorccomaggobject\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComAggObject::~CComAggObject","linkify":"<a name=\"ccomaggobject___dtorccomaggobject\"></a>  CComAggObject::~CComAggObject","source":"<a name=\"ccomaggobject___dtorccomaggobject\"></a>  CComAggObject::~CComAggObject"},{"content":"The destructor.","pos":[4419,4434]},{"pos":[4475,4482],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4486,4606],"content":"Frees all allocated resources, calls <bpt id=\"p1\">[</bpt>FinalRelease<ept id=\"p1\">](#ccomaggobject__finalrelease)</ept>, and decrements the module lock count.","source":"Frees all allocated resources, calls [FinalRelease](#ccomaggobject__finalrelease), and decrements the module lock count."},{"pos":[4616,4691],"content":"<bpt id=\"p1\">&lt;a name=\"ccomaggobject__createinstance\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComAggObject::CreateInstance","linkify":"<a name=\"ccomaggobject__createinstance\"></a>  CComAggObject::CreateInstance","source":"<a name=\"ccomaggobject__createinstance\"></a>  CComAggObject::CreateInstance"},{"pos":[4695,4889],"content":"This static function allows you to create a new <bpt id=\"p1\">**</bpt>CComAggObject&lt;<ept id=\"p1\">**</ept><ph id=\"ph1\">`contained`</ph> <bpt id=\"p2\">**</bpt><ph id=\"ph2\">&gt;</ph><ept id=\"p2\">**</ept> object without the overhead of <bpt id=\"p3\">[</bpt>CoCreateInstance<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/ms686615)</ept>.","source":"This static function allows you to create a new **CComAggObject<**`contained` **>** object without the overhead of [CoCreateInstance](http://msdn.microsoft.com/library/windows/desktop/ms686615)."},{"pos":[5006,5016],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[out] A pointer to a <bpt id=\"p1\">**</bpt>CComAggObject<ph id=\"ph1\">\\&lt;</ph><ept id=\"p1\">**</ept><bpt id=\"p2\">*</bpt>contained<ept id=\"p2\">*</ept> <bpt id=\"p3\">**</bpt><ph id=\"ph2\">&gt;</ph><ept id=\"p3\">**</ept> pointer.","pos":[5028,5094],"source":" [out] A pointer to a **CComAggObject\\<***contained* **>** pointer."},{"content":"If <ph id=\"ph1\">`CreateInstance`</ph> is unsuccessful, <ph id=\"ph2\">`pp`</ph> is set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[5095,5156],"source":" If `CreateInstance` is unsuccessful, `pp` is set to **NULL**."},{"pos":[5166,5178],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[5182,5209],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"pos":[5219,5226],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5230,5393],"content":"The object returned has a reference count of zero, so call <ph id=\"ph1\">`AddRef`</ph> immediately, then use <bpt id=\"p1\">**</bpt>Release<ept id=\"p1\">**</ept> to free the reference on the object pointer when you're done.","source":"The object returned has a reference count of zero, so call `AddRef` immediately, then use **Release** to free the reference on the object pointer when you're done."},{"pos":[5400,5642],"content":"If you do not need direct access to the object, but still want to create a new object without the overhead of <ph id=\"ph1\">`CoCreateInstance`</ph>, use <bpt id=\"p1\">[</bpt>CComCoClass::CreateInstance<ept id=\"p1\">](../../atl/reference/ccomcoclass-class.md#ccomcoclass__createinstance)</ept> instead.","source":"If you do not need direct access to the object, but still want to create a new object without the overhead of `CoCreateInstance`, use [CComCoClass::CreateInstance](../../atl/reference/ccomcoclass-class.md#ccomcoclass__createinstance) instead."},{"pos":[5652,5727],"content":"<bpt id=\"p1\">&lt;a name=\"ccomaggobject__finalconstruct\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComAggObject::FinalConstruct","linkify":"<a name=\"ccomaggobject__finalconstruct\"></a>  CComAggObject::FinalConstruct","source":"<a name=\"ccomaggobject__finalconstruct\"></a>  CComAggObject::FinalConstruct"},{"pos":[5731,5889],"content":"Called during the final stages of object construction, this method performs any final initialization on the <bpt id=\"p1\">[</bpt>m_contained<ept id=\"p1\">](#ccomaggobject__m_contained)</ept> member.","source":"Called during the final stages of object construction, this method performs any final initialization on the [m_contained](#ccomaggobject__m_contained) member."},{"pos":[5938,5950],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[5954,5981],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"pos":[5991,6062],"content":"<bpt id=\"p1\">&lt;a name=\"ccomaggobject__finalrelease\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComAggObject::FinalRelease","linkify":"<a name=\"ccomaggobject__finalrelease\"></a>  CComAggObject::FinalRelease","source":"<a name=\"ccomaggobject__finalrelease\"></a>  CComAggObject::FinalRelease"},{"pos":[6066,6172],"content":"Called during object destruction, this method frees the <bpt id=\"p1\">[</bpt>m_contained<ept id=\"p1\">](#ccomaggobject__m_contained)</ept> member.","source":"Called during object destruction, this method frees the [m_contained](#ccomaggobject__m_contained) member."},{"pos":[6216,6285],"content":"<bpt id=\"p1\">&lt;a name=\"ccomaggobject__m_contained\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComAggObject::m_contained","linkify":"<a name=\"ccomaggobject__m_contained\"></a>  CComAggObject::m_contained","source":"<a name=\"ccomaggobject__m_contained\"></a>  CComAggObject::m_contained"},{"pos":[6289,6394],"content":"A <bpt id=\"p1\">[</bpt>CComContainedObject<ept id=\"p1\">](../../atl/reference/ccomcontainedobject-class.md)</ept> object derived from your class.","source":"A [CComContainedObject](../../atl/reference/ccomcontainedobject-class.md) object derived from your class."},{"pos":[6461,6471],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] Your class, derived from <bpt id=\"p1\">[</bpt>CComObjectRoot<ept id=\"p1\">](../../atl/reference/ccomobjectroot-class.md)</ept> or <bpt id=\"p2\">[</bpt>CComObjectRootEx<ept id=\"p2\">](../../atl/reference/ccomobjectrootex-class.md)</ept>, as well as from any other interfaces you want to support on the object.","pos":[6490,6723],"source":" [in] Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md), as well as from any other interfaces you want to support on the object."},{"pos":[6733,6740],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[6744,6824],"content":"All <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept> calls through <ph id=\"ph1\">`m_contained`</ph> are delegated to the outer unknown.","source":"All **IUnknown** calls through `m_contained` are delegated to the outer unknown."},{"pos":[6834,6909],"content":"<bpt id=\"p1\">&lt;a name=\"ccomaggobject__queryinterface\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComAggObject::QueryInterface","linkify":"<a name=\"ccomaggobject__queryinterface\"></a>  CComAggObject::QueryInterface","source":"<a name=\"ccomaggobject__queryinterface\"></a>  CComAggObject::QueryInterface"},{"content":"Retrieves a pointer to the requested interface.","pos":[6913,6960]},{"pos":[7124,7134],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"[in] The identifier of the interface being requested.","pos":[7147,7200]},{"content":"[out] A pointer to the interface pointer identified by <ph id=\"ph1\">`iid`</ph>.","pos":[7222,7283],"source":" [out] A pointer to the interface pointer identified by `iid`."},{"content":"If the object does not support this interface, <ph id=\"ph1\">`ppvObject`</ph> is set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[7284,7362],"source":" If the object does not support this interface, `ppvObject` is set to **NULL**."},{"content":"[out] A pointer to the interface pointer identified by type <ph id=\"ph1\">`Q`</ph>.","pos":[7377,7441],"source":" [out] A pointer to the interface pointer identified by type `Q`."},{"content":"If the object does not support this interface, <ph id=\"ph1\">`pp`</ph> is set to <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[7442,7513],"source":" If the object does not support this interface, `pp` is set to **NULL**."},{"pos":[7523,7535],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[7539,7566],"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","source":"A standard `HRESULT` value."},{"pos":[7576,7583],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"If the requested interface is <bpt id=\"p1\">**</bpt>IUnknown<ept id=\"p1\">**</ept>, <ph id=\"ph1\">`QueryInterface`</ph> returns a pointer to the aggregated object's own <bpt id=\"p2\">**</bpt>IUnknown<ept id=\"p2\">**</ept> and increments the reference count.","pos":[7587,7745],"source":"If the requested interface is **IUnknown**, `QueryInterface` returns a pointer to the aggregated object's own **IUnknown** and increments the reference count."},{"content":"Otherwise, this method queries for the interface through the <ph id=\"ph1\">`CComContainedObject`</ph> member, <bpt id=\"p1\">[</bpt>m_contained<ept id=\"p1\">](#ccomaggobject__m_contained)</ept>.","pos":[7746,7880],"source":" Otherwise, this method queries for the interface through the `CComContainedObject` member, [m_contained](#ccomaggobject__m_contained)."},{"pos":[7890,7951],"content":"<bpt id=\"p1\">&lt;a name=\"ccomaggobject__release\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CComAggObject::Release","linkify":"<a name=\"ccomaggobject__release\"></a>  CComAggObject::Release","source":"<a name=\"ccomaggobject__release\"></a>  CComAggObject::Release"},{"content":"Decrements the reference count on the aggregated object.","pos":[7955,8011]},{"pos":[8064,8076],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"In debug builds, <bpt id=\"p1\">**</bpt>Release<ept id=\"p1\">**</ept> returns a value that may be useful for diagnostics or testing.","pos":[8080,8171],"source":"In debug builds, **Release** returns a value that may be useful for diagnostics or testing."},{"content":"In non-debug builds, <bpt id=\"p1\">**</bpt>Release<ept id=\"p1\">**</ept> always returns 0.","pos":[8172,8222],"source":" In non-debug builds, **Release** always returns 0."},{"pos":[8231,8239],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CComObject Class<ept id=\"p1\">](../../atl/reference/ccomobject-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[8243,8303],"source":"[CComObject Class](../../atl/reference/ccomobject-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CComPolyObject Class<ept id=\"p1\">](../../atl/reference/ccompolyobject-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[8306,8375],"source":" [CComPolyObject Class](../../atl/reference/ccompolyobject-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>DECLARE_AGGREGATABLE<ept id=\"p1\">](http://msdn.microsoft.com/library/e7e568d7-04e0-4226-b5dc-224deed229ab)</ept><ph id=\"ph1\"> </ph>","pos":[8378,8474],"source":" [DECLARE_AGGREGATABLE](http://msdn.microsoft.com/library/e7e568d7-04e0-4226-b5dc-224deed229ab) "},{"content":"<bpt id=\"p1\"> [</bpt>DECLARE_ONLY_AGGREGATABLE<ept id=\"p1\">](http://msdn.microsoft.com/library/a54220df-4330-4e4d-b7fb-8b63dd62d337)</ept><ph id=\"ph1\"> </ph>","pos":[8477,8578],"source":" [DECLARE_ONLY_AGGREGATABLE](http://msdn.microsoft.com/library/a54220df-4330-4e4d-b7fb-8b63dd62d337) "},{"content":"<bpt id=\"p1\"> [</bpt>DECLARE_NOT_AGGREGATABLE<ept id=\"p1\">](http://msdn.microsoft.com/library/2a116c7c-bab8-4f2a-a9ad-03d7aba0f762)</ept><ph id=\"ph1\"> </ph>","pos":[8581,8681],"source":" [DECLARE_NOT_AGGREGATABLE](http://msdn.microsoft.com/library/2a116c7c-bab8-4f2a-a9ad-03d7aba0f762) "},{"content":"<bpt id=\"p1\"> [</bpt>Class Overview<ept id=\"p1\">](../../atl/atl-class-overview.md)</ept>","pos":[8684,8734],"source":" [Class Overview](../../atl/atl-class-overview.md)"}],"content":"---\ntitle: \"CComAggObject Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"ATL::CComAggObject<contained>\"\n  - \"ATL.CComAggObject\"\n  - \"ATL.CComAggObject<contained>\"\n  - \"CComAggObject\"\n  - \"ATL::CComAggObject\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"aggregate objects [C++], in ATL\"\n  - \"aggregation [C++], ATL objects\"\n  - \"CComAggObject class\"\nms.assetid: 7aa90d69-d399-477b-880d-e2cdf0ef7881\ncaps.latest.revision: 29\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComAggObject Class\nThis class implements the [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) interface for an aggregated object. By definition, an aggregated object is contained within an outer object. The `CComAggObject` class is similar to the [CComObject Class](../../atl/reference/ccomobject-class.md), except that it exposes an interface that is directly accessible to external clients.  \n  \n## Syntax  \n  \n```\ntemplate<class contained>  class CComAggObject :  public IUnknown, public CComObjectRootEx\n <contained\n ::_ThreadModel::ThreadModelNoCS>\n```  \n  \n#### Parameters  \n `contained`  \n Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md), as well as from any other interfaces you want to support on the object.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComAggObject::CComAggObject](#ccomaggobject__ccomaggobject)|The constructor.|  \n|[CComAggObject::~CComAggObject](#ccomaggobject___dtorccomaggobject)|The destructor.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComAggObject::AddRef](#ccomaggobject__addref)|Increments the reference count on the aggregated object.|  \n|[CComAggObject::CreateInstance](#ccomaggobject__createinstance)|This static function allows you to create a new **CComAggObject<** `contained` **>** object without the overhead of [CoCreateInstance](http://msdn.microsoft.com/library/windows/desktop/ms686615).|  \n|[CComAggObject::FinalConstruct](#ccomaggobject__finalconstruct)|Performs final initialization of `m_contained`.|  \n|[CComAggObject::FinalRelease](#ccomaggobject__finalrelease)|Performs final destruction of `m_contained`.|  \n|[CComAggObject::QueryInterface](#ccomaggobject__queryinterface)|Retrieves a pointer to the requested interface.|  \n|[CComAggObject::Release](#ccomaggobject__release)|Decrements the reference count on the aggregated object.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComAggObject::m_contained](#ccomaggobject__m_contained)|Delegates `IUnknown` calls to the outer unknown.|  \n  \n## Remarks  \n `CComAggObject` implements [IUnknown](http://msdn.microsoft.com/library/windows/desktop/ms680509) for an aggregated object. `CComAggObject` has its own **IUnknown** interface, separate from the outer object's **IUnknown** interface, and maintains its own reference count.  \n  \n For more information about aggregation, see the article [Fundamentals of ATL COM Objects](../../atl/fundamentals-of-atl-com-objects.md).  \n  \n## Inheritance Hierarchy  \n `CComObjectRootBase`  \n  \n [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md)  \n  \n `IUnknown`  \n  \n `CComAggObject`  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ccomaggobject__addref\"></a>  CComAggObject::AddRef  \n Increments the reference count on the aggregated object.  \n  \n```\nSTDMETHOD_(ULONG, AddRef)();\n```  \n  \n### Return Value  \n A value that may be useful for diagnostics or testing.  \n  \n##  <a name=\"ccomaggobject__ccomaggobject\"></a>  CComAggObject::CComAggObject  \n The constructor.  \n  \n```\nCComAggObject(void* pv);\n```  \n  \n### Parameters  \n `pv`  \n [in] The outer unknown.  \n  \n### Remarks  \n Initializes the `CComContainedObject` member, [m_contained](#ccomaggobject__m_contained), and increments the module lock count.  \n  \n The destructor decrements the module lock count.  \n  \n##  <a name=\"ccomaggobject___dtorccomaggobject\"></a>  CComAggObject::~CComAggObject  \n The destructor.  \n  \n```\n~CComAggObject();\n```  \n  \n### Remarks  \n Frees all allocated resources, calls [FinalRelease](#ccomaggobject__finalrelease), and decrements the module lock count.  \n  \n##  <a name=\"ccomaggobject__createinstance\"></a>  CComAggObject::CreateInstance  \n This static function allows you to create a new **CComAggObject<**`contained` **>** object without the overhead of [CoCreateInstance](http://msdn.microsoft.com/library/windows/desktop/ms686615).  \n  \n```\nstatic HRESULT WINAPI CreateInstance(LPUNKNOWN pUnkOuter,\n    CComAggObject<contained>** pp);\n```  \n  \n### Parameters  \n `pp`  \n [out] A pointer to a **CComAggObject\\<***contained* **>** pointer. If `CreateInstance` is unsuccessful, `pp` is set to **NULL**.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n### Remarks  \n The object returned has a reference count of zero, so call `AddRef` immediately, then use **Release** to free the reference on the object pointer when you're done.  \n  \n If you do not need direct access to the object, but still want to create a new object without the overhead of `CoCreateInstance`, use [CComCoClass::CreateInstance](../../atl/reference/ccomcoclass-class.md#ccomcoclass__createinstance) instead.  \n  \n##  <a name=\"ccomaggobject__finalconstruct\"></a>  CComAggObject::FinalConstruct  \n Called during the final stages of object construction, this method performs any final initialization on the [m_contained](#ccomaggobject__m_contained) member.  \n  \n```\nHRESULT FinalConstruct();\n```  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n##  <a name=\"ccomaggobject__finalrelease\"></a>  CComAggObject::FinalRelease  \n Called during object destruction, this method frees the [m_contained](#ccomaggobject__m_contained) member.  \n  \n```\nvoid FinalRelease();\n```  \n  \n##  <a name=\"ccomaggobject__m_contained\"></a>  CComAggObject::m_contained  \n A [CComContainedObject](../../atl/reference/ccomcontainedobject-class.md) object derived from your class.  \n  \n```\nCComContainedObject<contained> m_contained;\n```  \n  \n### Parameters  \n `contained`  \n [in] Your class, derived from [CComObjectRoot](../../atl/reference/ccomobjectroot-class.md) or [CComObjectRootEx](../../atl/reference/ccomobjectrootex-class.md), as well as from any other interfaces you want to support on the object.  \n  \n### Remarks  \n All **IUnknown** calls through `m_contained` are delegated to the outer unknown.  \n  \n##  <a name=\"ccomaggobject__queryinterface\"></a>  CComAggObject::QueryInterface  \n Retrieves a pointer to the requested interface.  \n  \n```\nSTDMETHOD(QueryInterface)(REFIID iid,\n    void** ppvObject);\n\n    template <class Q>  HRESULT STDMETHODCALLTYPE QueryInterface(\n    Q** pp);\n```  \n  \n### Parameters  \n `iid`  \n [in] The identifier of the interface being requested.  \n  \n `ppvObject`  \n [out] A pointer to the interface pointer identified by `iid`. If the object does not support this interface, `ppvObject` is set to **NULL**.  \n  \n `pp`  \n [out] A pointer to the interface pointer identified by type `Q`. If the object does not support this interface, `pp` is set to **NULL**.  \n  \n### Return Value  \n A standard `HRESULT` value.  \n  \n### Remarks  \n If the requested interface is **IUnknown**, `QueryInterface` returns a pointer to the aggregated object's own **IUnknown** and increments the reference count. Otherwise, this method queries for the interface through the `CComContainedObject` member, [m_contained](#ccomaggobject__m_contained).  \n  \n##  <a name=\"ccomaggobject__release\"></a>  CComAggObject::Release  \n Decrements the reference count on the aggregated object.  \n  \n```\nSTDMETHOD_(ULONG, Release)();\n```  \n  \n### Return Value  \n In debug builds, **Release** returns a value that may be useful for diagnostics or testing. In non-debug builds, **Release** always returns 0.  \n  \n## See Also  \n [CComObject Class](../../atl/reference/ccomobject-class.md)   \n [CComPolyObject Class](../../atl/reference/ccompolyobject-class.md)   \n [DECLARE_AGGREGATABLE](http://msdn.microsoft.com/library/e7e568d7-04e0-4226-b5dc-224deed229ab)   \n [DECLARE_ONLY_AGGREGATABLE](http://msdn.microsoft.com/library/a54220df-4330-4e4d-b7fb-8b63dd62d337)   \n [DECLARE_NOT_AGGREGATABLE](http://msdn.microsoft.com/library/2a116c7c-bab8-4f2a-a9ad-03d7aba0f762)   \n [Class Overview](../../atl/atl-class-overview.md)\n"}