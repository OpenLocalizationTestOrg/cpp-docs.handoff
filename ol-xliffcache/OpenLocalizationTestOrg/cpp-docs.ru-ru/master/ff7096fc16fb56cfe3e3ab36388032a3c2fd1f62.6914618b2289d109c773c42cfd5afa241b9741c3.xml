{"nodes":[{"pos":[12,48],"content":"ConvertBSTRToString | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ConvertBSTRToString | Microsoft Docs","pos":[0,36]}]},{"content":"ConvertBSTRToString","pos":[637,656]},{"content":"Microsoft Specific","pos":[659,677]},{"pos":[686,727],"content":"Converts a <ph id=\"ph1\">`BSTR`</ph> value to a <bpt id=\"p1\">**</bpt>char <ph id=\"ph2\">\\*</ph><ept id=\"p1\">**</ept>.","source":"Converts a `BSTR` value to a **char \\***."},{"content":"Syntax","pos":[736,742]},{"content":"Parameters","pos":[836,846]},{"content":"A BSTR variable.","pos":[860,876]},{"content":"Remarks","pos":[885,892]},{"pos":[918,953],"content":"allocates a string you must delete."},{"content":"Example","pos":[962,969]},{"content":"END Microsoft Specific","pos":[1456,1478]},{"content":"Requirements","pos":[1487,1499]},{"pos":[1503,1525],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> comutil.h.","source":"**Header:** comutil.h."},{"pos":[1532,1693],"content":"<bpt id=\"p1\">**</bpt>Lib:<ept id=\"p1\">**</ept> comsuppw.lib or comsuppwd.lib (see <bpt id=\"p2\">[</bpt>/Zc:wchar_t (wchar_t Is Native Type)<ept id=\"p2\">](../build/reference/zc-wchar-t-wchar-t-is-native-type.md)</ept> for more information)","source":"**Lib:** comsuppw.lib or comsuppwd.lib (see [/Zc:wchar_t (wchar_t Is Native Type)](../build/reference/zc-wchar-t-wchar-t-is-native-type.md) for more information)"},{"content":"See Also","pos":[1702,1710]},{"content":"Compiler COM Global Functions","pos":[1715,1744]}],"content":"---\ntitle: \"ConvertBSTRToString | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\nf1_keywords: \n  - \"ConvertBSTRToString\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ConvertBSTRToString function\"\nms.assetid: ab6ce555-3d75-4e9c-9cb8-ada6d8ce43b1\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# ConvertBSTRToString\n**Microsoft Specific**  \n  \n Converts a `BSTR` value to a **char \\***.  \n  \n## Syntax  \n  \n```  \n  \n      char* __stdcall ConvertBSTRToString(  \n   BSTR pSrc  \n);  \n```  \n  \n#### Parameters  \n `pSrc`  \n A BSTR variable.  \n  \n## Remarks  \n `ConvertBSTRToString` allocates a string you must delete.  \n  \n## Example  \n  \n```  \n// ConvertBSTRToString.cpp  \n#include <comutil.h>  \n#include <stdio.h>  \n  \n#pragma comment(lib, \"comsuppw.lib\")  \n  \nint main() {  \n   BSTR bstrText = ::SysAllocString(L\"Test\");  \n   wprintf_s(L\"BSTR text: %s\\n\", bstrText);  \n  \n   char* lpszText2 = _com_util::ConvertBSTRToString(bstrText);  \n   printf_s(\"char * text: %s\\n\", lpszText2);  \n  \n   SysFreeString(bstrText);  \n   delete[] lpszText2;  \n}  \n```  \n  \n```Output  \nBSTR text: Test  \nchar * text: Test  \n```  \n  \n## END Microsoft Specific  \n  \n## Requirements  \n **Header:** comutil.h.  \n  \n **Lib:** comsuppw.lib or comsuppwd.lib (see [/Zc:wchar_t (wchar_t Is Native Type)](../build/reference/zc-wchar-t-wchar-t-is-native-type.md) for more information)  \n  \n## See Also  \n [Compiler COM Global Functions](../cpp/compiler-com-global-functions.md)"}