{"nodes":[{"pos":[12,57],"content":"COlePasteSpecialDialog Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COlePasteSpecialDialog Class | Microsoft Docs","pos":[0,45]}]},{"content":"COlePasteSpecialDialog Class","pos":[740,768]},{"content":"Used for the OLE Paste Special dialog box.","pos":[769,811]},{"content":"Syntax","pos":[820,826]},{"content":"Members","pos":[901,908]},{"content":"Public Constructors","pos":[918,937]},{"content":"Name","pos":[944,948]},{"content":"Description","pos":[949,960]},{"content":"COlePasteSpecialDialog::COlePasteSpecialDialog","pos":[999,1045]},{"pos":[1096,1141],"content":"Constructs a <ph id=\"ph1\">`COlePasteSpecialDialog`</ph> object.","source":"Constructs a `COlePasteSpecialDialog` object."},{"content":"Public Methods","pos":[1152,1166]},{"content":"Name","pos":[1173,1177]},{"content":"Description","pos":[1178,1189]},{"content":"COlePasteSpecialDialog::AddFormat","pos":[1228,1261]},{"content":"Adds custom formats to the list of formats your application can paste.","pos":[1299,1369]},{"content":"COlePasteSpecialDialog::AddLinkEntry","pos":[1375,1411]},{"content":"Adds a new entry to the list of supported Clipboard formats.","pos":[1452,1512]},{"content":"COlePasteSpecialDialog::AddStandardFormats","pos":[1518,1560]},{"pos":[1607,1739],"content":"Adds <bpt id=\"p1\">**</bpt>CF_BITMAP<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>CF_DIB<ept id=\"p2\">**</ept>, <ph id=\"ph1\">`CF_METAFILEPICT`</ph>, and optionally <ph id=\"ph2\">`CF_LINKSOURCE`</ph> to the list of formats your application can paste.","source":"Adds **CF_BITMAP**, **CF_DIB**, `CF_METAFILEPICT`, and optionally `CF_LINKSOURCE` to the list of formats your application can paste."},{"content":"COlePasteSpecialDialog::CreateItem","pos":[1745,1779]},{"content":"Creates the item in the container document using the specified format.","pos":[1818,1888]},{"content":"COlePasteSpecialDialog::DoModal","pos":[1894,1925]},{"content":"Displays the OLE Paste Special dialog box.","pos":[1961,2003]},{"content":"COlePasteSpecialDialog::GetDrawAspect","pos":[2009,2046]},{"content":"Tells whether to draw item as an icon or not.","pos":[2088,2133]},{"content":"COlePasteSpecialDialog::GetIconicMetafile","pos":[2139,2180]},{"content":"Gets a handle to the metafile associated with the iconic form of this item.","pos":[2226,2301]},{"content":"COlePasteSpecialDialog::GetPasteIndex","pos":[2307,2344]},{"content":"Gets the index of available paste options that was chosen by the user.","pos":[2386,2456]},{"content":"COlePasteSpecialDialog::GetSelectionType","pos":[2462,2502]},{"content":"Gets the type of selection chosen.","pos":[2547,2581]},{"content":"Public Data Members","pos":[2592,2611]},{"content":"Name","pos":[2618,2622]},{"content":"Description","pos":[2623,2634]},{"content":"COlePasteSpecialDialog::m_ps","pos":[2673,2701]},{"pos":[2734,2821],"content":"A structure of type <bpt id=\"p1\">**</bpt>OLEUIPASTESPECIAL<ept id=\"p1\">**</ept> that controls the function of the dialog box.","source":"A structure of type **OLEUIPASTESPECIAL** that controls the function of the dialog box."},{"content":"Remarks","pos":[2831,2838]},{"content":"Create an object of class <ph id=\"ph1\">`COlePasteSpecialDialog`</ph> when you want to call this dialog box.","pos":[2842,2931],"source":"Create an object of class `COlePasteSpecialDialog` when you want to call this dialog box."},{"content":"After a <ph id=\"ph1\">`COlePasteSpecialDialog`</ph> object has been constructed, you can use the <bpt id=\"p1\">[</bpt>AddFormat<ept id=\"p1\">](#colepastespecialdialog__addformat)</ept> and <bpt id=\"p2\">[</bpt>AddStandardFormats<ept id=\"p2\">](#colepastespecialdialog__addstandardformats)</ept> member functions to add Clipboard formats to the dialog box.","pos":[2932,3188],"source":" After a `COlePasteSpecialDialog` object has been constructed, you can use the [AddFormat](#colepastespecialdialog__addformat) and [AddStandardFormats](#colepastespecialdialog__addstandardformats) member functions to add Clipboard formats to the dialog box."},{"content":"You can also use the <bpt id=\"p1\">[</bpt>m_ps<ept id=\"p1\">](#colepastespecialdialog__m_ps)</ept> structure to initialize the values or states of controls in the dialog box.","pos":[3189,3323],"source":" You can also use the [m_ps](#colepastespecialdialog__m_ps) structure to initialize the values or states of controls in the dialog box."},{"content":"The <ph id=\"ph1\">`m_ps`</ph> structure is of type <bpt id=\"p1\">**</bpt>OLEUIPASTESPECIAL<ept id=\"p1\">**</ept>.","pos":[3324,3378],"source":" The `m_ps` structure is of type **OLEUIPASTESPECIAL**."},{"pos":[3385,3564],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUIPASTESPECIAL<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms692434)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUIPASTESPECIAL](http://msdn.microsoft.com/library/windows/desktop/ms692434) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[3571,3701],"content":"For more information regarding OLE-specific dialog boxes, see the article <bpt id=\"p1\">[</bpt>Dialog Boxes in OLE<ept id=\"p1\">](../../mfc/dialog-boxes-in-ole.md)</ept>.","source":"For more information regarding OLE-specific dialog boxes, see the article [Dialog Boxes in OLE](../../mfc/dialog-boxes-in-ole.md)."},{"content":"Inheritance Hierarchy","pos":[3710,3731]},{"content":"CObject","pos":[3736,3743]},{"content":"CCmdTarget","pos":[3790,3800]},{"content":"CWnd","pos":[3850,3854]},{"content":"CDialog","pos":[3898,3905]},{"content":"CCommonDialog","pos":[3952,3965]},{"content":"COleDialog","pos":[4018,4028]},{"content":"Requirements","pos":[4110,4122]},{"pos":[4126,4148],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxodlgs.h","source":"**Header:** afxodlgs.h"},{"pos":[4208,4241],"content":"COlePasteSpecialDialog::AddFormat"},{"content":"Call this function to add new formats to the list of formats your application can support in a Paste Special operation.","pos":[4245,4364]},{"content":"Parameters","pos":[4623,4633]},{"content":"fmt","pos":[4638,4641]},{"content":"Reference to the data type to add.","pos":[4646,4680]},{"content":"String that describes the format to the user.","pos":[4703,4748]},{"content":"lpszResult","pos":[4756,4766]},{"content":"String that describes the result if this format is chosen in the dialog box.","pos":[4771,4847]},{"content":"The different linking and embedding options available for this format.","pos":[4865,4935]},{"content":"This flag is a bitwise combination of one or more of the different values in the <bpt id=\"p1\">**</bpt>OLEUIPASTEFLAG<ept id=\"p1\">**</ept> enumerated type.","pos":[4936,5052],"source":" This flag is a bitwise combination of one or more of the different values in the **OLEUIPASTEFLAG** enumerated type."},{"content":"The clipboard format to add.","pos":[5067,5095]},{"content":"tymed","pos":[5103,5108]},{"content":"The types of media available in this format.","pos":[5113,5157]},{"content":"This is a bitwise combination of one or more of the values in the <bpt id=\"p1\">**</bpt>TYMED<ept id=\"p1\">**</ept> enumerated type.","pos":[5158,5250],"source":" This is a bitwise combination of one or more of the values in the **TYMED** enumerated type."},{"content":"The ID of the string that identifies this format.","pos":[5272,5321]},{"content":"The format of this string is two separate strings separated by a '\\n' character.","pos":[5322,5402]},{"content":"The first string is the same that would be passed in the <bpt id=\"p1\">*</bpt>lpstrFormat<ept id=\"p1\">*</ept> parameter, and the second is the same as the <bpt id=\"p2\">*</bpt>lpstrResult<ept id=\"p2\">*</ept> parameter.","pos":[5403,5543],"source":" The first string is the same that would be passed in the *lpstrFormat* parameter, and the second is the same as the *lpstrResult* parameter."},{"content":"bEnableIcon","pos":[5551,5562]},{"content":"Flag that determines whether the Display As Icon check box is enabled when this format is chosen in the list box.","pos":[5567,5680]},{"content":"bLink","pos":[5688,5693]},{"content":"Flag that determines whether the Paste Link radio button is enabled when this format is chosen in the list box.","pos":[5698,5809]},{"content":"Remarks","pos":[5819,5826]},{"content":"This function can be called to add either standard formats such as <bpt id=\"p1\">**</bpt>CF_TEXT<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>CF_TIFF<ept id=\"p2\">**</ept> or custom formats that your application has registered with the system.","pos":[5830,5995],"source":"This function can be called to add either standard formats such as **CF_TEXT** or **CF_TIFF** or custom formats that your application has registered with the system."},{"content":"For more information about pasting data objects into your application, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources: Manipulation<ept id=\"p1\">](../../mfc/data-objects-and-data-sources-manipulation.md)</ept>.","pos":[5996,6186],"source":" For more information about pasting data objects into your application, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md)."},{"pos":[6193,6457],"content":"For more information, see the <bpt id=\"p1\">[</bpt>TYMED<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms691227)</ept> enumeration type and the <bpt id=\"p2\">[</bpt>FORMATETC<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [TYMED](http://msdn.microsoft.com/library/windows/desktop/ms691227) enumeration type and the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6464,6646],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUIPASTEFLAG<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682172)</ept> enumerated type in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUIPASTEFLAG](http://msdn.microsoft.com/library/windows/desktop/ms682172) enumerated type in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[6709,6745],"content":"COlePasteSpecialDialog::AddLinkEntry"},{"content":"Adds a new entry to the list of supported Clipboard formats.","pos":[6749,6809]},{"content":"Parameters","pos":[6872,6882]},{"content":"The clipboard format to add.","pos":[6894,6922]},{"content":"Return Value","pos":[6932,6944]},{"pos":[6948,7088],"content":"An <bpt id=\"p1\">[</bpt>OLEUIPASTEFLAG<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682172)</ept> structure containing the information for the new link entry.","source":"An [OLEUIPASTEFLAG](http://msdn.microsoft.com/library/windows/desktop/ms682172) structure containing the information for the new link entry."},{"pos":[7157,7199],"content":"COlePasteSpecialDialog::AddStandardFormats"},{"content":"Call this function to add the following Clipboard formats to the list of formats your application can support in a Paste Special operation:","pos":[7203,7342]},{"content":"Parameters","pos":[7417,7427]},{"content":"bEnableLink","pos":[7432,7443]},{"content":"Flag that determines whether to add <ph id=\"ph1\">`CF_LINKSOURCE`</ph> to the list of formats your application can paste.","pos":[7448,7550],"source":" Flag that determines whether to add `CF_LINKSOURCE` to the list of formats your application can paste."},{"content":"Remarks","pos":[7560,7567]},{"content":"CF_BITMAP","pos":[7577,7586]},{"content":"CF_DIB","pos":[7598,7604]},{"content":"\"Embedded Object\"","pos":[7641,7658]},{"pos":[7670,7700],"content":"(optionally) <bpt id=\"p1\">**</bpt>\"Link Source\"<ept id=\"p1\">**</ept>","source":"(optionally) **\"Link Source\"**"},{"content":"These formats are used to support embedding and linking.","pos":[7707,7763]},{"pos":[7836,7882],"content":"COlePasteSpecialDialog::COlePasteSpecialDialog"},{"pos":[7886,7931],"content":"Constructs a <ph id=\"ph1\">`COlePasteSpecialDialog`</ph> object.","source":"Constructs a `COlePasteSpecialDialog` object."},{"content":"Parameters","pos":[8091,8101]},{"content":"Creation flag, contains any number of the following flags combined using the bitwise-OR operator:","pos":[8118,8215]},{"content":"Specifies that the Paste radio button will be checked initially when the dialog box is called.","pos":[8241,8335]},{"content":"Cannot be used in combination with <ph id=\"ph1\">`PSF_SELECTPASTELINK`</ph>.","pos":[8336,8393],"source":" Cannot be used in combination with `PSF_SELECTPASTELINK`."},{"content":"This is the default.","pos":[8394,8414]},{"content":"Specifies that the Paste Link radio button will be checked initially when the dialog box is called.","pos":[8444,8543]},{"content":"Cannot be used in combination with <ph id=\"ph1\">`PSF_SELECTPASTE`</ph>.","pos":[8544,8597],"source":" Cannot be used in combination with `PSF_SELECTPASTE`."},{"pos":[8630,8731],"content":"Specifies that the Display As Icon check box will be checked initially when the dialog box is called."},{"pos":[8754,8833],"content":"Specifies that the Help button will be displayed when the dialog box is called."},{"pos":[8840,9021],"content":"`pDataObject`  \nPoints to the [COleDataObject](../../mfc/reference/coledataobject-class.md) for pasting. If this value is **NULL**, it gets the `COleDataObject` from the Clipboard.","leadings":[""," "],"nodes":[{"content":"Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) for pasting. If this value is **NULL**, it gets the `COleDataObject` from the Clipboard.","pos":[16,180],"nodes":[{"content":"Points to the <bpt id=\"p1\">[</bpt>COleDataObject<ept id=\"p1\">](../../mfc/reference/coledataobject-class.md)</ept> for pasting.","pos":[0,88],"source":"Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) for pasting."},{"content":"If this value is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, it gets the <ph id=\"ph1\">`COleDataObject`</ph> from the Clipboard.","pos":[89,164],"source":" If this value is **NULL**, it gets the `COleDataObject` from the Clipboard."}]}]},{"pos":[9028,9234],"content":"`pParentWnd`  \nPoints to the parent or owner window object (of type `CWnd`) to which the dialog object belongs. If it is **NULL**, the parent window of the dialog box is set to the main application window.","leadings":[""," "],"nodes":[{"content":"Points to the parent or owner window object (of type `CWnd`) to which the dialog object belongs. If it is **NULL**, the parent window of the dialog box is set to the main application window.","pos":[15,205],"nodes":[{"content":"Points to the parent or owner window object (of type <ph id=\"ph1\">`CWnd`</ph>) to which the dialog object belongs.","pos":[0,96],"source":"Points to the parent or owner window object (of type `CWnd`) to which the dialog object belongs."},{"content":"If it is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the parent window of the dialog box is set to the main application window.","pos":[97,190],"source":" If it is **NULL**, the parent window of the dialog box is set to the main application window."}]}]},{"content":"Remarks","pos":[9244,9251]},{"content":"This function only constructs a <ph id=\"ph1\">`COlePasteSpecialDialog`</ph> object.","pos":[9255,9319],"source":"This function only constructs a `COlePasteSpecialDialog` object."},{"content":"To display the dialog box, call the <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#colepastespecialdialog__domodal)</ept> function.","pos":[9320,9409],"source":" To display the dialog box, call the [DoModal](#colepastespecialdialog__domodal) function."},{"pos":[9416,9598],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUIPASTEFLAG<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682172)</ept> enumerated type in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUIPASTEFLAG](http://msdn.microsoft.com/library/windows/desktop/ms682172) enumerated type in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[9659,9693],"content":"COlePasteSpecialDialog::CreateItem"},{"content":"Creates the new item that was chosen in the Paste Special dialog box.","pos":[9697,9766]},{"content":"Parameters","pos":[9834,9844]},{"content":"pNewItem","pos":[9849,9857]},{"content":"Points to a <ph id=\"ph1\">`COleClientItem`</ph> instance.","pos":[9862,9900],"source":" Points to a `COleClientItem` instance."},{"content":"Cannot be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[9901,9920],"source":" Cannot be **NULL**."},{"content":"Return Value","pos":[9930,9942]},{"content":"Nonzero if the item was created successfully; otherwise 0.","pos":[9946,10004]},{"content":"Remarks","pos":[10014,10021]},{"pos":[10025,10128],"content":"This function should only be called after <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#colepastespecialdialog__domodal)</ept> returns <bpt id=\"p2\">**</bpt>IDOK<ept id=\"p2\">**</ept>.","source":"This function should only be called after [DoModal](#colepastespecialdialog__domodal) returns **IDOK**."},{"pos":[10186,10217],"content":"COlePasteSpecialDialog::DoModal"},{"content":"Displays the OLE Paste Special dialog box.","pos":[10221,10263]},{"content":"Return Value","pos":[10315,10327]},{"content":"Completion status for the dialog box.","pos":[10331,10368]},{"content":"One of the following values:","pos":[10369,10397]},{"pos":[10405,10459],"content":"<bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept> if the dialog box was successfully displayed.","source":"**IDOK** if the dialog box was successfully displayed."},{"pos":[10467,10516],"content":"<bpt id=\"p1\">**</bpt>IDCANCEL<ept id=\"p1\">**</ept> if the user canceled the dialog box.","source":"**IDCANCEL** if the user canceled the dialog box."},{"content":"<bpt id=\"p1\">**</bpt>IDABORT<ept id=\"p1\">**</ept> if an error occurred.","pos":[10524,10557],"source":"**IDABORT** if an error occurred."},{"content":"If <bpt id=\"p1\">**</bpt>IDABORT<ept id=\"p1\">**</ept> is returned, call the <ph id=\"ph1\">`COleDialog::GetLastError`</ph> member function to get more information about the type of error that occurred.","pos":[10558,10700],"source":" If **IDABORT** is returned, call the `COleDialog::GetLastError` member function to get more information about the type of error that occurred."},{"content":"For a listing of possible errors, see the <bpt id=\"p1\">[</bpt>OleUIPasteSpecial<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms694512)</ept> function in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[10701,10891],"source":" For a listing of possible errors, see the [OleUIPasteSpecial](http://msdn.microsoft.com/library/windows/desktop/ms694512) function in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Remarks","pos":[10901,10908]},{"pos":[10912,11133],"content":"If you want to initialize the various dialog box controls by setting members of the <bpt id=\"p1\">[</bpt>m_ps<ept id=\"p1\">](#colepastespecialdialog__m_ps)</ept> structure, you should do this before calling <ph id=\"ph1\">`DoModal`</ph>, but after the dialog object is constructed.","source":"If you want to initialize the various dialog box controls by setting members of the [m_ps](#colepastespecialdialog__m_ps) structure, you should do this before calling `DoModal`, but after the dialog object is constructed."},{"pos":[11140,11285],"content":"If <ph id=\"ph1\">`DoModal`</ph> returns <bpt id=\"p1\">**</bpt>IDOK<ept id=\"p1\">**</ept>, you can call other member functions to retrieve the settings or information input by the user into the dialog box.","source":"If `DoModal` returns **IDOK**, you can call other member functions to retrieve the settings or information input by the user into the dialog box."},{"pos":[11349,11386],"content":"COlePasteSpecialDialog::GetDrawAspect"},{"content":"Determines if the user chose to display the selected item as an icon.","pos":[11390,11459]},{"content":"Return Value","pos":[11519,11531]},{"content":"The method needed to render the object.","pos":[11535,11574]},{"pos":[11601,11693],"content":"Returned if the Display As Icon check box was not checked when the dialog box was dismissed."},{"pos":[11717,11805],"content":"Returned if the Display As Icon check box was checked when the dialog box was dismissed."},{"content":"Remarks","pos":[11815,11822]},{"pos":[11826,11917],"content":"Only call this function after <bpt id=\"p1\">[</bpt>DoModal<ept id=\"p1\">](#colepastespecialdialog__domodal)</ept> returns <bpt id=\"p2\">**</bpt>IDOK<ept id=\"p2\">**</ept>.","source":"Only call this function after [DoModal](#colepastespecialdialog__domodal) returns **IDOK**."},{"pos":[11924,12113],"content":"For more information on drawing aspect, see the <bpt id=\"p1\">[</bpt>FORMATETC<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682177)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on drawing aspect, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[12181,12222],"content":"COlePasteSpecialDialog::GetIconicMetafile"},{"content":"Gets the metafile associated with the item selected by the user.","pos":[12226,12290]},{"content":"Return Value","pos":[12353,12365]},{"pos":[12369,12566],"content":"The handle to the metafile containing the iconic aspect of the selected item, if the Display As Icon check box was selected when the dialog box was dismissed by choosing <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>; otherwise <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>.","source":"The handle to the metafile containing the iconic aspect of the selected item, if the Display As Icon check box was selected when the dialog box was dismissed by choosing **OK**; otherwise **NULL**."},{"pos":[12630,12667],"content":"COlePasteSpecialDialog::GetPasteIndex"},{"content":"Gets the index value associated with the entry the user selected.","pos":[12671,12736]},{"content":"Return Value","pos":[12791,12803]},{"content":"The index into the array of <bpt id=\"p1\">**</bpt>OLEUIPASTEENTRY<ept id=\"p1\">**</ept> structures that was selected by the user.","pos":[12807,12896],"source":"The index into the array of **OLEUIPASTEENTRY** structures that was selected by the user."},{"content":"The format that corresponds to the selected index should be used when performing the paste operation.","pos":[12897,12998]},{"content":"Remarks","pos":[13008,13015]},{"pos":[13019,13196],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUIPASTEENTRY<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms690165)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUIPASTEENTRY](http://msdn.microsoft.com/library/windows/desktop/ms690165) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[13263,13303],"content":"COlePasteSpecialDialog::GetSelectionType"},{"content":"Determines the type of selection the user made.","pos":[13307,13354]},{"content":"Return Value","pos":[13413,13425]},{"content":"Returns type of selection made.","pos":[13429,13460]},{"content":"Remarks","pos":[13470,13477]},{"pos":[13481,13603],"content":"The return type values are specified by the <bpt id=\"p1\">**</bpt>Selection<ept id=\"p1\">**</ept> enumeration type declared in the <ph id=\"ph1\">`COlePasteSpecialDialog`</ph> class.","source":"The return type values are specified by the **Selection** enumeration type declared in the `COlePasteSpecialDialog` class."},{"content":"Brief desccriptions of these values follow:","pos":[13734,13777]},{"pos":[13785,13911],"content":"<bpt id=\"p1\">**</bpt>COlePasteSpecialDialog::pasteLink<ept id=\"p1\">**</ept> The Paste Link radio button was checked and the chosen format was a standard OLE format.","source":"**COlePasteSpecialDialog::pasteLink** The Paste Link radio button was checked and the chosen format was a standard OLE format."},{"pos":[13919,14042],"content":"<bpt id=\"p1\">**</bpt>COlePasteSpecialDialog::pasteNormal<ept id=\"p1\">**</ept> The Paste radio button was checked and the chosen format was a standard OLE format.","source":"**COlePasteSpecialDialog::pasteNormal** The Paste radio button was checked and the chosen format was a standard OLE format."},{"pos":[14050,14138],"content":"<bpt id=\"p1\">**</bpt>COlePasteSpecialDialog::pasteOther<ept id=\"p1\">**</ept> The selected format is not a standard OLE format.","source":"**COlePasteSpecialDialog::pasteOther** The selected format is not a standard OLE format."},{"pos":[14146,14219],"content":"<bpt id=\"p1\">**</bpt>COlePasteSpecialDialog::pasteStatic<ept id=\"p1\">**</ept> The chosen format was a metafile.","source":"**COlePasteSpecialDialog::pasteStatic** The chosen format was a metafile."},{"pos":[14274,14302],"content":"COlePasteSpecialDialog::m_ps"},{"pos":[14306,14407],"content":"Structure of type <bpt id=\"p1\">**</bpt>OLEUIPASTESPECIAL<ept id=\"p1\">**</ept> used to control the behavior of the Paste Special dialog box.","source":"Structure of type **OLEUIPASTESPECIAL** used to control the behavior of the Paste Special dialog box."},{"content":"Remarks","pos":[14458,14465]},{"content":"Members of this structure can be modified directly or through member functions.","pos":[14469,14548]},{"pos":[14555,14734],"content":"For more information, see the <bpt id=\"p1\">[</bpt>OLEUIPASTESPECIAL<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms692434)</ept> structure in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see the [OLEUIPASTESPECIAL](http://msdn.microsoft.com/library/windows/desktop/ms692434) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"See Also","pos":[14743,14751]},{"content":"MFC Sample OCLIENT","pos":[14756,14774]},{"content":"COleDialog Class","pos":[14810,14826]},{"content":"Hierarchy Chart","pos":[14874,14889]},{"content":"COleDialog Class","pos":[14926,14942]}],"content":"---\ntitle: \"COlePasteSpecialDialog Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COlePasteSpecialDialog\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Paste Special dialog box\"\n  - \"dialog boxes, Paste Special\"\n  - \"OLE Paste Special dialog box\"\n  - \"COlePasteSpecialDialog class\"\nms.assetid: 0e82ef9a-9bbe-457e-8240-42c86a0534f7\ncaps.latest.revision: 24\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COlePasteSpecialDialog Class\nUsed for the OLE Paste Special dialog box.  \n  \n## Syntax  \n  \n```  \nclass COlePasteSpecialDialog : public COleDialog  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COlePasteSpecialDialog::COlePasteSpecialDialog](#colepastespecialdialog__colepastespecialdialog)|Constructs a `COlePasteSpecialDialog` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COlePasteSpecialDialog::AddFormat](#colepastespecialdialog__addformat)|Adds custom formats to the list of formats your application can paste.|  \n|[COlePasteSpecialDialog::AddLinkEntry](#colepastespecialdialog__addlinkentry)|Adds a new entry to the list of supported Clipboard formats.|  \n|[COlePasteSpecialDialog::AddStandardFormats](#colepastespecialdialog__addstandardformats)|Adds **CF_BITMAP**, **CF_DIB**, `CF_METAFILEPICT`, and optionally `CF_LINKSOURCE` to the list of formats your application can paste.|  \n|[COlePasteSpecialDialog::CreateItem](#colepastespecialdialog__createitem)|Creates the item in the container document using the specified format.|  \n|[COlePasteSpecialDialog::DoModal](#colepastespecialdialog__domodal)|Displays the OLE Paste Special dialog box.|  \n|[COlePasteSpecialDialog::GetDrawAspect](#colepastespecialdialog__getdrawaspect)|Tells whether to draw item as an icon or not.|  \n|[COlePasteSpecialDialog::GetIconicMetafile](#colepastespecialdialog__geticonicmetafile)|Gets a handle to the metafile associated with the iconic form of this item.|  \n|[COlePasteSpecialDialog::GetPasteIndex](#colepastespecialdialog__getpasteindex)|Gets the index of available paste options that was chosen by the user.|  \n|[COlePasteSpecialDialog::GetSelectionType](#colepastespecialdialog__getselectiontype)|Gets the type of selection chosen.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COlePasteSpecialDialog::m_ps](#colepastespecialdialog__m_ps)|A structure of type **OLEUIPASTESPECIAL** that controls the function of the dialog box.|  \n  \n## Remarks  \n Create an object of class `COlePasteSpecialDialog` when you want to call this dialog box. After a `COlePasteSpecialDialog` object has been constructed, you can use the [AddFormat](#colepastespecialdialog__addformat) and [AddStandardFormats](#colepastespecialdialog__addstandardformats) member functions to add Clipboard formats to the dialog box. You can also use the [m_ps](#colepastespecialdialog__m_ps) structure to initialize the values or states of controls in the dialog box. The `m_ps` structure is of type **OLEUIPASTESPECIAL**.  \n  \n For more information, see the [OLEUIPASTESPECIAL](http://msdn.microsoft.com/library/windows/desktop/ms692434) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information regarding OLE-specific dialog boxes, see the article [Dialog Boxes in OLE](../../mfc/dialog-boxes-in-ole.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CDialog](../../mfc/reference/cdialog-class.md)  \n  \n [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  \n  \n [COleDialog](../../mfc/reference/coledialog-class.md)  \n  \n `COlePasteSpecialDialog`  \n  \n## Requirements  \n **Header:** afxodlgs.h  \n  \n##  <a name=\"colepastespecialdialog__addformat\"></a>  COlePasteSpecialDialog::AddFormat  \n Call this function to add new formats to the list of formats your application can support in a Paste Special operation.  \n  \n```  \nvoid AddFormat(\n    const FORMATETC& formatEtc,  \n    LPTSTR lpszFormat,  \n    LPTSTR lpszResult,  \n    DWORD flags);\n\n \nvoid AddFormat(\n    UINT cf,  \n    DWORD tymed,  \n    UINT nFormatID,  \n    BOOL bEnableIcon,  \n    BOOL bLink);\n```  \n  \n### Parameters  \n *fmt*  \n Reference to the data type to add.  \n  \n `lpszFormat`  \n String that describes the format to the user.  \n  \n *lpszResult*  \n String that describes the result if this format is chosen in the dialog box.  \n  \n `flags`  \n The different linking and embedding options available for this format. This flag is a bitwise combination of one or more of the different values in the **OLEUIPASTEFLAG** enumerated type.  \n  \n `cf`  \n The clipboard format to add.  \n  \n *tymed*  \n The types of media available in this format. This is a bitwise combination of one or more of the values in the **TYMED** enumerated type.  \n  \n `nFormatID`  \n The ID of the string that identifies this format. The format of this string is two separate strings separated by a '\\n' character. The first string is the same that would be passed in the *lpstrFormat* parameter, and the second is the same as the *lpstrResult* parameter.  \n  \n *bEnableIcon*  \n Flag that determines whether the Display As Icon check box is enabled when this format is chosen in the list box.  \n  \n *bLink*  \n Flag that determines whether the Paste Link radio button is enabled when this format is chosen in the list box.  \n  \n### Remarks  \n This function can be called to add either standard formats such as **CF_TEXT** or **CF_TIFF** or custom formats that your application has registered with the system. For more information about pasting data objects into your application, see the article [Data Objects and Data Sources: Manipulation](../../mfc/data-objects-and-data-sources-manipulation.md).  \n  \n For more information, see the [TYMED](http://msdn.microsoft.com/library/windows/desktop/ms691227) enumeration type and the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n For more information, see the [OLEUIPASTEFLAG](http://msdn.microsoft.com/library/windows/desktop/ms682172) enumerated type in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colepastespecialdialog__addlinkentry\"></a>  COlePasteSpecialDialog::AddLinkEntry  \n Adds a new entry to the list of supported Clipboard formats.  \n  \n```  \nOLEUIPASTEFLAG AddLinkEntry(UINT cf);\n```  \n  \n### Parameters  \n `cf`  \n The clipboard format to add.  \n  \n### Return Value  \n An [OLEUIPASTEFLAG](http://msdn.microsoft.com/library/windows/desktop/ms682172) structure containing the information for the new link entry.  \n  \n##  <a name=\"colepastespecialdialog__addstandardformats\"></a>  COlePasteSpecialDialog::AddStandardFormats  \n Call this function to add the following Clipboard formats to the list of formats your application can support in a Paste Special operation:  \n  \n```  \nvoid AddStandardFormats(BOOL bEnableLink = TRUE);\n```  \n  \n### Parameters  \n *bEnableLink*  \n Flag that determines whether to add `CF_LINKSOURCE` to the list of formats your application can paste.  \n  \n### Remarks  \n  \n- **CF_BITMAP**  \n  \n- **CF_DIB**  \n  \n- `CF_METAFILEPICT`  \n  \n- **\"Embedded Object\"**  \n  \n-   (optionally) **\"Link Source\"**  \n  \n These formats are used to support embedding and linking.  \n  \n##  <a name=\"colepastespecialdialog__colepastespecialdialog\"></a>  COlePasteSpecialDialog::COlePasteSpecialDialog  \n Constructs a `COlePasteSpecialDialog` object.  \n  \n```  \nCOlePasteSpecialDialog(\n    DWORD dwFlags = PSF_SELECTPASTE,  \n    COleDataObject* pDataObject = NULL,  \n    CWnd* pParentWnd = NULL);\n```  \n  \n### Parameters  \n `dwFlags`  \n Creation flag, contains any number of the following flags combined using the bitwise-OR operator:  \n  \n- `PSF_SELECTPASTE` Specifies that the Paste radio button will be checked initially when the dialog box is called. Cannot be used in combination with `PSF_SELECTPASTELINK`. This is the default.  \n  \n- `PSF_SELECTPASTELINK` Specifies that the Paste Link radio button will be checked initially when the dialog box is called. Cannot be used in combination with `PSF_SELECTPASTE`.  \n  \n- `PSF_CHECKDISPLAYASICON` Specifies that the Display As Icon check box will be checked initially when the dialog box is called.  \n  \n- `PSF_SHOWHELP` Specifies that the Help button will be displayed when the dialog box is called.  \n  \n `pDataObject`  \n Points to the [COleDataObject](../../mfc/reference/coledataobject-class.md) for pasting. If this value is **NULL**, it gets the `COleDataObject` from the Clipboard.  \n  \n `pParentWnd`  \n Points to the parent or owner window object (of type `CWnd`) to which the dialog object belongs. If it is **NULL**, the parent window of the dialog box is set to the main application window.  \n  \n### Remarks  \n This function only constructs a `COlePasteSpecialDialog` object. To display the dialog box, call the [DoModal](#colepastespecialdialog__domodal) function.  \n  \n For more information, see the [OLEUIPASTEFLAG](http://msdn.microsoft.com/library/windows/desktop/ms682172) enumerated type in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colepastespecialdialog__createitem\"></a>  COlePasteSpecialDialog::CreateItem  \n Creates the new item that was chosen in the Paste Special dialog box.  \n  \n```  \nBOOL CreateItem(COleClientItem* pNewItem);\n```  \n  \n### Parameters  \n *pNewItem*  \n Points to a `COleClientItem` instance. Cannot be **NULL**.  \n  \n### Return Value  \n Nonzero if the item was created successfully; otherwise 0.  \n  \n### Remarks  \n This function should only be called after [DoModal](#colepastespecialdialog__domodal) returns **IDOK**.  \n  \n##  <a name=\"colepastespecialdialog__domodal\"></a>  COlePasteSpecialDialog::DoModal  \n Displays the OLE Paste Special dialog box.  \n  \n```  \nvirtual INT_PTR DoModal();\n```  \n  \n### Return Value  \n Completion status for the dialog box. One of the following values:  \n  \n- **IDOK** if the dialog box was successfully displayed.  \n  \n- **IDCANCEL** if the user canceled the dialog box.  \n  \n- **IDABORT** if an error occurred. If **IDABORT** is returned, call the `COleDialog::GetLastError` member function to get more information about the type of error that occurred. For a listing of possible errors, see the [OleUIPasteSpecial](http://msdn.microsoft.com/library/windows/desktop/ms694512) function in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Remarks  \n If you want to initialize the various dialog box controls by setting members of the [m_ps](#colepastespecialdialog__m_ps) structure, you should do this before calling `DoModal`, but after the dialog object is constructed.  \n  \n If `DoModal` returns **IDOK**, you can call other member functions to retrieve the settings or information input by the user into the dialog box.  \n  \n##  <a name=\"colepastespecialdialog__getdrawaspect\"></a>  COlePasteSpecialDialog::GetDrawAspect  \n Determines if the user chose to display the selected item as an icon.  \n  \n```  \nDVASPECT GetDrawAspect() const;\n\n \n```  \n  \n### Return Value  \n The method needed to render the object.  \n  \n- `DVASPECT_CONTENT` Returned if the Display As Icon check box was not checked when the dialog box was dismissed.  \n  \n- `DVASPECT_ICON` Returned if the Display As Icon check box was checked when the dialog box was dismissed.  \n  \n### Remarks  \n Only call this function after [DoModal](#colepastespecialdialog__domodal) returns **IDOK**.  \n  \n For more information on drawing aspect, see the [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colepastespecialdialog__geticonicmetafile\"></a>  COlePasteSpecialDialog::GetIconicMetafile  \n Gets the metafile associated with the item selected by the user.  \n  \n```  \nHGLOBAL GetIconicMetafile() const;\n\n \n```  \n  \n### Return Value  \n The handle to the metafile containing the iconic aspect of the selected item, if the Display As Icon check box was selected when the dialog box was dismissed by choosing **OK**; otherwise **NULL**.  \n  \n##  <a name=\"colepastespecialdialog__getpasteindex\"></a>  COlePasteSpecialDialog::GetPasteIndex  \n Gets the index value associated with the entry the user selected.  \n  \n```  \nint GetPasteIndex() const;\n\n \n```  \n  \n### Return Value  \n The index into the array of **OLEUIPASTEENTRY** structures that was selected by the user. The format that corresponds to the selected index should be used when performing the paste operation.  \n  \n### Remarks  \n For more information, see the [OLEUIPASTEENTRY](http://msdn.microsoft.com/library/windows/desktop/ms690165) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"colepastespecialdialog__getselectiontype\"></a>  COlePasteSpecialDialog::GetSelectionType  \n Determines the type of selection the user made.  \n  \n```  \nUINT GetSelectionType() const;\n\n \n```  \n  \n### Return Value  \n Returns type of selection made.  \n  \n### Remarks  \n The return type values are specified by the **Selection** enumeration type declared in the `COlePasteSpecialDialog` class.  \n  \n `enum Selection`  \n  \n `{`  \n  \n `pasteLink,`  \n  \n `pasteNormal,`  \n  \n `pasteOther,`  \n  \n `pasteStatic`  \n  \n `};`  \n  \n Brief desccriptions of these values follow:  \n  \n- **COlePasteSpecialDialog::pasteLink** The Paste Link radio button was checked and the chosen format was a standard OLE format.  \n  \n- **COlePasteSpecialDialog::pasteNormal** The Paste radio button was checked and the chosen format was a standard OLE format.  \n  \n- **COlePasteSpecialDialog::pasteOther** The selected format is not a standard OLE format.  \n  \n- **COlePasteSpecialDialog::pasteStatic** The chosen format was a metafile.  \n  \n##  <a name=\"colepastespecialdialog__m_ps\"></a>  COlePasteSpecialDialog::m_ps  \n Structure of type **OLEUIPASTESPECIAL** used to control the behavior of the Paste Special dialog box.  \n  \n```  \nOLEUIPASTESPECIAL m_ps;  \n```  \n  \n### Remarks  \n Members of this structure can be modified directly or through member functions.  \n  \n For more information, see the [OLEUIPASTESPECIAL](http://msdn.microsoft.com/library/windows/desktop/ms692434) structure in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n## See Also  \n [MFC Sample OCLIENT](../../visual-cpp-samples.md)   \n [COleDialog Class](../../mfc/reference/coledialog-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [COleDialog Class](../../mfc/reference/coledialog-class.md)\n"}