{"nodes":[{"pos":[12,41],"content":"CArray Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CArray Class | Microsoft Docs","pos":[0,29]}]},{"content":"CArray Class","pos":[697,709]},{"content":"Supports arrays that are like C arrays, but can dynamically reduce and grow as necessary.","pos":[710,799]},{"content":"Syntax","pos":[808,814]},{"content":"Parameters","pos":[932,942]},{"content":"Template parameter that specifies the type of objects stored in the array.","pos":[956,1030]},{"content":"is a parameter that is returned by <ph id=\"ph1\">`CArray`</ph>.","pos":[1038,1082],"source":" is a parameter that is returned by `CArray`."},{"content":"_","pos":[1096,1097]},{"content":"Template parameter that specifies the argument type that is used to access objects stored in the array.","pos":[1109,1212]},{"content":"Often a reference to <ph id=\"ph1\">`TYPE`</ph>.","pos":[1213,1241],"source":" Often a reference to `TYPE`."},{"content":"is a parameter that is passed to <ph id=\"ph1\">`CArray`</ph>.","pos":[1253,1295],"source":" is a parameter that is passed to `CArray`."},{"content":"Members","pos":[1304,1311]},{"content":"Public Constructors","pos":[1321,1340]},{"content":"Name","pos":[1347,1351]},{"content":"Description","pos":[1352,1363]},{"content":"CArray::CArray","pos":[1402,1416]},{"content":"Constructs an empty array.","pos":[1435,1461]},{"content":"Public Methods","pos":[1472,1486]},{"content":"Name","pos":[1493,1497]},{"content":"Description","pos":[1498,1509]},{"content":"CArray::Add","pos":[1548,1559]},{"content":"Adds an element to the end of the array; grows the array if necessary.","pos":[1575,1645]},{"content":"CArray::Append","pos":[1651,1665]},{"content":"Appends another array to the array; grows the array if necessary","pos":[1684,1748]},{"content":"CArray::Copy","pos":[1754,1766]},{"content":"Copies another array to the array; grows the array if necessary.","pos":[1783,1847]},{"content":"CArray::ElementAt","pos":[1853,1870]},{"content":"Returns a temporary reference to the element pointer within the array.","pos":[1892,1962]},{"content":"CArray::FreeExtra","pos":[1968,1985]},{"content":"Frees all unused memory above the current upper bound.","pos":[2007,2061]},{"content":"CArray::GetAt","pos":[2067,2080]},{"content":"Returns the value at a given index.","pos":[2098,2133]},{"content":"CArray::GetCount","pos":[2139,2155]},{"content":"Gets the number of elements in this array.","pos":[2176,2218]},{"content":"CArray::GetData","pos":[2224,2239]},{"content":"Allows access to elements in the array.","pos":[2259,2298]},{"content":"Can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[2299,2315],"source":" Can be **NULL**."},{"content":"CArray::GetSize","pos":[2321,2336]},{"content":"Gets the number of elements in this array.","pos":[2356,2398]},{"content":"CArray::GetUpperBound","pos":[2404,2425]},{"content":"Returns the largest valid index.","pos":[2451,2483]},{"content":"CArray::InsertAt","pos":[2489,2505]},{"content":"Inserts an element (or all the elements in another array) at a specified index.","pos":[2526,2605]},{"content":"CArray::IsEmpty","pos":[2611,2626]},{"content":"Determines whether the array is empty.","pos":[2646,2684]},{"content":"CArray::RemoveAll","pos":[2690,2707]},{"content":"Removes all the elements from this array.","pos":[2729,2770]},{"content":"CArray::RemoveAt","pos":[2776,2792]},{"content":"Removes an element at a specific index.","pos":[2813,2852]},{"content":"CArray::SetAt","pos":[2858,2871]},{"content":"Sets the value for a given index; array not allowed to grow.","pos":[2889,2949]},{"content":"CArray::SetAtGrow","pos":[2955,2972]},{"content":"Sets the value for a given index; grows the array if necessary.","pos":[2994,3057]},{"content":"CArray::SetSize","pos":[3063,3078]},{"content":"Sets the number of elements to be contained in this array.","pos":[3098,3156]},{"content":"Public Operators","pos":[3167,3183]},{"content":"Name","pos":[3190,3194]},{"content":"Description","pos":[3195,3206]},{"content":"operator&amp;#91;&amp;#93;","pos":[3245,3263],"source":"operator&#91;&#93;"},{"content":"Sets or gets the element at the specified index.","pos":[3287,3335]},{"content":"Remarks","pos":[3345,3352]},{"content":"Array indexes always start at position 0.","pos":[3356,3397]},{"content":"You can decide whether to fix the upper bound or enable the array to expand when you add elements past the current bound.","pos":[3398,3519]},{"content":"Memory is allocated contiguously to the upper bound, even if some elements are null.","pos":[3520,3604]},{"pos":[3612,4195],"content":"[!NOTE]\n Most methods that resize a `CArray` object or add elements to it use [memcpy_s](../../c-runtime-library/reference/memcpy-s-wmemcpy-s.md) to move elements. This is a problem because `memcpy_s` is not compatible with any objects that require the constructor to be called. If the items in the `CArray` are not compatible with `memcpy_s`, you must create a new `CArray` of the appropriate size. You must then use [CArray::Copy](#carray__copy) and [CArray::SetAt](#carray__setat) to populate the new array because those methods use an assignment operator instead of `memcpy_s`.","leadings":["","> "],"nodes":[{"content":" Most methods that resize a `CArray` object or add elements to it use [memcpy_s](../../c-runtime-library/reference/memcpy-s-wmemcpy-s.md) to move elements. This is a problem because `memcpy_s` is not compatible with any objects that require the constructor to be called. If the items in the `CArray` are not compatible with `memcpy_s`, you must create a new `CArray` of the appropriate size. You must then use [CArray::Copy](#carray__copy) and [CArray::SetAt](#carray__setat) to populate the new array because those methods use an assignment operator instead of `memcpy_s`.","pos":[8,581],"nodes":[{"content":"Most methods that resize a <ph id=\"ph1\">`CArray`</ph> object or add elements to it use <bpt id=\"p1\">[</bpt>memcpy_s<ept id=\"p1\">](../../c-runtime-library/reference/memcpy-s-wmemcpy-s.md)</ept> to move elements.","pos":[1,155],"source":" Most methods that resize a `CArray` object or add elements to it use [memcpy_s](../../c-runtime-library/reference/memcpy-s-wmemcpy-s.md) to move elements."},{"content":"This is a problem because <ph id=\"ph1\">`memcpy_s`</ph> is not compatible with any objects that require the constructor to be called.","pos":[156,270],"source":" This is a problem because `memcpy_s` is not compatible with any objects that require the constructor to be called."},{"content":"If the items in the <ph id=\"ph1\">`CArray`</ph> are not compatible with <ph id=\"ph2\">`memcpy_s`</ph>, you must create a new <ph id=\"ph3\">`CArray`</ph> of the appropriate size.","pos":[271,391],"source":" If the items in the `CArray` are not compatible with `memcpy_s`, you must create a new `CArray` of the appropriate size."},{"content":"You must then use <bpt id=\"p1\">[</bpt>CArray::Copy<ept id=\"p1\">](#carray__copy)</ept> and <bpt id=\"p2\">[</bpt>CArray::SetAt<ept id=\"p2\">](#carray__setat)</ept> to populate the new array because those methods use an assignment operator instead of <ph id=\"ph1\">`memcpy_s`</ph>.","pos":[392,573],"source":" You must then use [CArray::Copy](#carray__copy) and [CArray::SetAt](#carray__setat) to populate the new array because those methods use an assignment operator instead of `memcpy_s`."}]}]},{"pos":[4202,4317],"content":"As with a C array, the access time for a <ph id=\"ph1\">`CArray`</ph> indexed element is constant and is independent of the array size.","source":"As with a C array, the access time for a `CArray` indexed element is constant and is independent of the array size."},{"pos":[4325,4624],"content":"[!TIP]\n Before using an array, use [SetSize](#carray__setsize) to establish its size and allocate memory for it. If you do not use `SetSize`, adding elements to your array causes it to be frequently reallocated and copied. Frequent reallocation and copying are inefficient and can fragment memory.","leadings":["","> "],"nodes":[{"content":" Before using an array, use [SetSize](#carray__setsize) to establish its size and allocate memory for it. If you do not use `SetSize`, adding elements to your array causes it to be frequently reallocated and copied. Frequent reallocation and copying are inefficient and can fragment memory.","pos":[7,297],"nodes":[{"content":"Before using an array, use <bpt id=\"p1\">[</bpt>SetSize<ept id=\"p1\">](#carray__setsize)</ept> to establish its size and allocate memory for it.","pos":[1,105],"source":" Before using an array, use [SetSize](#carray__setsize) to establish its size and allocate memory for it."},{"content":"If you do not use <ph id=\"ph1\">`SetSize`</ph>, adding elements to your array causes it to be frequently reallocated and copied.","pos":[106,215],"source":" If you do not use `SetSize`, adding elements to your array causes it to be frequently reallocated and copied."},{"content":"Frequent reallocation and copying are inefficient and can fragment memory.","pos":[216,290]}]}]},{"pos":[4631,4796],"content":"If you need a dump of individual elements in an array, you must set the depth of the <bpt id=\"p1\">[</bpt>CDumpContext<ept id=\"p1\">](../../mfc/reference/cdumpcontext-class.md)</ept> object to 1 or larger.","source":"If you need a dump of individual elements in an array, you must set the depth of the [CDumpContext](../../mfc/reference/cdumpcontext-class.md) object to 1 or larger."},{"content":"Certain member functions of this class call global helper functions that must be customized for most uses of the <ph id=\"ph1\">`CArray`</ph> class.","pos":[4803,4931],"source":"Certain member functions of this class call global helper functions that must be customized for most uses of the `CArray` class."},{"content":"See the topic <bpt id=\"p1\">[</bpt>Collection Class Helpers<ept id=\"p1\">](../../mfc/reference/collection-class-helpers.md)</ept> in the MFC Macros and Globals section.","pos":[4932,5060],"source":" See the topic [Collection Class Helpers](../../mfc/reference/collection-class-helpers.md) in the MFC Macros and Globals section."},{"content":"Array class derivation is like list derivation.","pos":[5067,5114]},{"pos":[5121,5225],"content":"For more information about how to use <ph id=\"ph1\">`CArray`</ph>, see the article <bpt id=\"p1\">[</bpt>Collections<ept id=\"p1\">](../../mfc/collections.md)</ept>.","source":"For more information about how to use `CArray`, see the article [Collections](../../mfc/collections.md)."},{"content":"Inheritance Hierarchy","pos":[5234,5255]},{"content":"CObject","pos":[5260,5267]},{"content":"Requirements","pos":[5330,5342]},{"pos":[5356,5366],"content":"afxtempl.h"},{"pos":[5404,5415],"content":"CArray::Add"},{"content":"Adds a new element to the end of an array, growing the array by 1.","pos":[5419,5485]},{"content":"Parameters","pos":[5544,5554]},{"content":"Template parameter specifying the type of arguments referencing elements in this array.","pos":[5572,5659]},{"content":"The element to be added to this array.","pos":[5682,5720]},{"content":"Return Value","pos":[5730,5742]},{"content":"The index of the added element.","pos":[5746,5777]},{"content":"Remarks","pos":[5787,5794]},{"content":"If <bpt id=\"p1\">[</bpt>SetSize<ept id=\"p1\">](#carray__setsize)</ept> has been used with an <ph id=\"ph1\">`nGrowBy`</ph> value greater than 1, then extra memory may be allocated.","pos":[5798,5918],"source":"If [SetSize](#carray__setsize) has been used with an `nGrowBy` value greater than 1, then extra memory may be allocated."},{"content":"However, the upper bound will increase by only 1.","pos":[5919,5968]},{"content":"Example","pos":[5978,5985]},{"pos":[6000,6021],"content":"NVC_MFCCollections#22"},{"pos":[6110,6124],"content":"CArray::Append"},{"content":"Call this member function to add the contents of one array to the end of another.","pos":[6128,6209]},{"content":"Parameters","pos":[6269,6279]},{"content":"src","pos":[6284,6287]},{"content":"Source of the elements to be appended to an array.","pos":[6292,6342]},{"content":"Return Value","pos":[6352,6364]},{"content":"The index of the first appended element.","pos":[6368,6408]},{"content":"Remarks","pos":[6418,6425]},{"content":"The arrays must be of the same type.","pos":[6429,6465]},{"pos":[6472,6573],"content":"If necessary, <bpt id=\"p1\">**</bpt>Append<ept id=\"p1\">**</ept> may allocate extra memory to accommodate the elements appended to the array.","source":"If necessary, **Append** may allocate extra memory to accommodate the elements appended to the array."},{"content":"Example","pos":[6583,6590]},{"pos":[6605,6626],"content":"NVC_MFCCollections#23"},{"pos":[6715,6729],"content":"CArray::CArray"},{"content":"Constructs an empty array.","pos":[6733,6759]},{"content":"Remarks","pos":[6794,6801]},{"content":"The array grows one element at a time.","pos":[6805,6843]},{"content":"Example","pos":[6853,6860]},{"pos":[6875,6896],"content":"NVC_MFCCollections#24"},{"pos":[6983,6995],"content":"CArray::Copy"},{"content":"Use this member function to copy the elements of one array to another.","pos":[6999,7069]},{"content":"Parameters","pos":[7124,7134]},{"content":"src","pos":[7139,7142]},{"content":"Source of the elements to be copied to an array.","pos":[7147,7195]},{"content":"Remarks","pos":[7205,7212]},{"content":"Call this member function to overwrite the elements of one array with the elements of another array.","pos":[7216,7316]},{"pos":[7323,7460],"content":"<bpt id=\"p1\">**</bpt>Copy<ept id=\"p1\">**</ept> does not free memory; however, if necessary, <bpt id=\"p2\">**</bpt>Copy<ept id=\"p2\">**</ept> may allocate extra memory to accommodate the elements copied to the array.","source":"**Copy** does not free memory; however, if necessary, **Copy** may allocate extra memory to accommodate the elements copied to the array."},{"content":"Example","pos":[7470,7477]},{"pos":[7492,7513],"content":"NVC_MFCCollections#25"},{"pos":[7605,7622],"content":"CArray::ElementAt"},{"content":"Returns a temporary reference to the specified element within the array.","pos":[7626,7698]},{"content":"Parameters","pos":[7807,7817]},{"content":"An integer index that is greater than or equal to 0 and less than or equal to the value returned by <bpt id=\"p1\">[</bpt>GetUpperBound<ept id=\"p1\">](#carray__getupperbound)</ept>.","pos":[7833,7973],"source":" An integer index that is greater than or equal to 0 and less than or equal to the value returned by [GetUpperBound](#carray__getupperbound)."},{"content":"Return Value","pos":[7983,7995]},{"content":"A reference to an array element.","pos":[7999,8031]},{"content":"Remarks","pos":[8041,8048]},{"content":"It is used to implement the left-side assignment operator for arrays.","pos":[8052,8121]},{"content":"Example","pos":[8131,8138]},{"pos":[8143,8191],"content":"See the example for <bpt id=\"p1\">[</bpt>GetSize<ept id=\"p1\">](#carray__getsize)</ept>.","source":"See the example for [GetSize](#carray__getsize)."},{"pos":[8235,8252],"content":"CArray::FreeExtra"},{"content":"Frees any extra memory that was allocated while the array was grown.","pos":[8256,8324]},{"content":"Remarks","pos":[8367,8374]},{"content":"This function has no effect on the size or upper bound of the array.","pos":[8378,8446]},{"content":"Example","pos":[8456,8463]},{"pos":[8468,8516],"content":"See the example for <bpt id=\"p1\">[</bpt>GetData<ept id=\"p1\">](#carray__getdata)</ept>.","source":"See the example for [GetData](#carray__getdata)."},{"pos":[8556,8569],"content":"CArray::GetAt"},{"content":"Returns the array element at the specified index.","pos":[8573,8622]},{"content":"Parameters","pos":[8723,8733]},{"content":"TYPE","pos":[8738,8742]},{"content":"Template parameter specifying the type of the array elements.","pos":[8747,8808]},{"content":"An integer index that is greater than or equal to 0 and less than or equal to the value returned by <bpt id=\"p1\">[</bpt>GetUpperBound<ept id=\"p1\">](#carray__getupperbound)</ept>.","pos":[8827,8967],"source":" An integer index that is greater than or equal to 0 and less than or equal to the value returned by [GetUpperBound](#carray__getupperbound)."},{"content":"Return Value","pos":[8977,8989]},{"content":"The array element currently at this index.","pos":[8993,9035]},{"content":"Remarks","pos":[9045,9052]},{"pos":[9056,9177],"content":"Passing a negative value or a value greater than the value returned by <ph id=\"ph1\">`GetUpperBound`</ph> will result in a failed assertion.","source":"Passing a negative value or a value greater than the value returned by `GetUpperBound` will result in a failed assertion."},{"content":"Example","pos":[9187,9194]},{"pos":[9209,9230],"content":"NVC_MFCCollections#26"},{"pos":[9321,9337],"content":"CArray::GetCount"},{"content":"Returns the number of array elements.","pos":[9341,9378]},{"content":"Return Value","pos":[9432,9444]},{"content":"The number of items in the array.","pos":[9448,9481]},{"content":"Remarks","pos":[9491,9498]},{"content":"Call this method to retrieve the number of elements in the array.","pos":[9502,9567]},{"content":"Because indexes are zero-based, the size is 1 greater than the largest index.","pos":[9568,9645]},{"content":"Calling this method will generate the same result as the <bpt id=\"p1\">[</bpt>CArray::GetSize<ept id=\"p1\">](#carray__getsize)</ept> method.","pos":[9646,9746],"source":" Calling this method will generate the same result as the [CArray::GetSize](#carray__getsize) method."},{"content":"Example","pos":[9756,9763]},{"pos":[9778,9799],"content":"NVC_MFCCollections#27"},{"pos":[9889,9904],"content":"CArray::GetData"},{"content":"Use this member function to gain direct access to the elements in an array.","pos":[9908,9983]},{"content":"Parameters","pos":[10059,10069]},{"content":"TYPE","pos":[10074,10078]},{"content":"Template parameter specifying the type of the array elements.","pos":[10083,10144]},{"content":"Return Value","pos":[10154,10166]},{"content":"A pointer to an array element.","pos":[10170,10200]},{"content":"Remarks","pos":[10210,10217]},{"pos":[10221,10282],"content":"If no elements are available, <ph id=\"ph1\">`GetData`</ph> returns a null value.","source":"If no elements are available, `GetData` returns a null value."},{"pos":[10289,10468],"content":"While direct access to the elements of an array can help you work more quickly, use caution when calling <ph id=\"ph1\">`GetData`</ph>; any errors you make directly affect the elements of your array.","source":"While direct access to the elements of an array can help you work more quickly, use caution when calling `GetData`; any errors you make directly affect the elements of your array."},{"content":"Example","pos":[10478,10485]},{"pos":[10500,10521],"content":"NVC_MFCCollections#28"},{"pos":[10611,10626],"content":"CArray::GetSize"},{"content":"Returns the size of the array.","pos":[10630,10660]},{"content":"Remarks","pos":[10713,10720]},{"content":"Because indexes are zero-based, the size is 1 greater than the largest index.","pos":[10724,10801]},{"content":"Calling this method will generate the same result as the <bpt id=\"p1\">[</bpt>CArray::GetCount<ept id=\"p1\">](#carray__getcount)</ept> method.","pos":[10802,10904],"source":" Calling this method will generate the same result as the [CArray::GetCount](#carray__getcount) method."},{"content":"Example","pos":[10914,10921]},{"pos":[10936,10957],"content":"NVC_MFCCollections#29"},{"pos":[11053,11074],"content":"CArray::GetUpperBound"},{"content":"Returns the current upper bound of this array.","pos":[11078,11124]},{"content":"Remarks","pos":[11183,11190]},{"pos":[11194,11284],"content":"Because array indexes are zero-based, this function returns a value 1 less than <ph id=\"ph1\">`GetSize`</ph>.","source":"Because array indexes are zero-based, this function returns a value 1 less than `GetSize`."},{"pos":[11291,11377],"content":"The condition <bpt id=\"p1\">**</bpt>GetUpperBound( )<ept id=\"p1\">**</ept> = –1 indicates that the array contains no elements.","source":"The condition **GetUpperBound( )** = –1 indicates that the array contains no elements."},{"content":"Example","pos":[11387,11394]},{"pos":[11399,11451],"content":"See the example for <bpt id=\"p1\">[</bpt>CArray::GetAt<ept id=\"p1\">](#carray__getat)</ept>.","source":"See the example for [CArray::GetAt](#carray__getat)."},{"pos":[11494,11510],"content":"CArray::InsertAt"},{"pos":[11514,11634],"content":"The first version of <ph id=\"ph1\">`InsertAt`</ph> inserts one element (or multiple copies of an element) at a specified index in an array.","source":"The first version of `InsertAt` inserts one element (or multiple copies of an element) at a specified index in an array."},{"content":"Parameters","pos":[11815,11825]},{"content":"An integer index that may be greater than the value returned by <ph id=\"ph1\">`GetUpperBound`</ph>.","pos":[11841,11921],"source":" An integer index that may be greater than the value returned by `GetUpperBound`."},{"content":"Template parameter specifying the type of elements in this array.","pos":[11942,12007]},{"content":"The element to be placed in this array.","pos":[12030,12069]},{"content":"The number of times this element should be inserted (defaults to 1).","pos":[12088,12156]},{"content":"An integer index that may be greater than the value returned by <bpt id=\"p1\">[</bpt>GetUpperBound<ept id=\"p1\">](#carray__getupperbound)</ept>.","pos":[12180,12284],"source":" An integer index that may be greater than the value returned by [GetUpperBound](#carray__getupperbound)."},{"content":"Another array that contains elements to be added to this array.","pos":[12306,12369]},{"content":"Remarks","pos":[12379,12386]},{"content":"In the process, it shifts up (by incrementing the index) the existing element at this index, and it shifts up all the elements above it.","pos":[12390,12526]},{"pos":[12533,12650],"content":"The second version inserts all the elements from another <ph id=\"ph1\">`CArray`</ph> collection, starting at the <ph id=\"ph2\">`nStartIndex`</ph> position.","source":"The second version inserts all the elements from another `CArray` collection, starting at the `nStartIndex` position."},{"pos":[12657,12761],"content":"The <ph id=\"ph1\">`SetAt`</ph> function, in contrast, replaces one specified array element and does not shift any elements.","source":"The `SetAt` function, in contrast, replaces one specified array element and does not shift any elements."},{"content":"Example","pos":[12771,12778]},{"pos":[12793,12814],"content":"NVC_MFCCollections#30"},{"pos":[12904,12919],"content":"CArray::IsEmpty"},{"content":"Determines whether the array is empty.","pos":[12923,12961]},{"content":"Return Value","pos":[13011,13023]},{"content":"Nonzero if the array contains no elements; otherwise 0.","pos":[13027,13082]},{"pos":[13128,13144],"content":"CArray::operator"},{"pos":[13153,13277],"content":"These subscript operators are a convenient substitute for the <bpt id=\"p1\">[</bpt>SetAt<ept id=\"p1\">](#carray__setat)</ept> and <bpt id=\"p2\">[</bpt>GetAt<ept id=\"p2\">](#carray__getat)</ept> functions.","source":"These subscript operators are a convenient substitute for the [SetAt](#carray__setat) and [GetAt](#carray__getat) functions."},{"content":"Parameters","pos":[13388,13398]},{"content":"TYPE","pos":[13403,13407]},{"content":"Template parameter specifying the type of elements in this array.","pos":[13412,13477]},{"content":"Index of the element to be accessed.","pos":[13496,13532]},{"content":"Remarks","pos":[13542,13549]},{"content":"The first operator, called for arrays that are not <bpt id=\"p1\">**</bpt>const<ept id=\"p1\">**</ept>, may be used on either the right (r-value) or the left (l-value) of an assignment statement.","pos":[13553,13706],"source":"The first operator, called for arrays that are not **const**, may be used on either the right (r-value) or the left (l-value) of an assignment statement."},{"content":"The second, called for <bpt id=\"p1\">**</bpt>const<ept id=\"p1\">**</ept> arrays, may be used only on the right.","pos":[13707,13778],"source":" The second, called for **const** arrays, may be used only on the right."},{"content":"The Debug version of the library asserts if the subscript (either on the left or right side of an assignment statement) is out of bounds.","pos":[13785,13922]},{"content":"Example","pos":[13932,13939]},{"pos":[13954,13975],"content":"NVC_MFCCollections#34"},{"pos":[14075,14099],"content":"CArray::RelocateElements"},{"content":"Relocates data to a new buffer when the array should grow or shrink.","pos":[14103,14171]},{"content":"Parameters","pos":[14361,14371]},{"content":"A new buffer for the array of elements.","pos":[14389,14428]},{"content":"The old array of elements.","pos":[14446,14472]},{"content":"Number of elements in the old array.","pos":[14491,14527]},{"content":"Remarks","pos":[14537,14544]},{"pos":[14559,14615],"content":"is always large enough to hold all the <ph id=\"ph1\">`pData`</ph> elements.","source":" is always large enough to hold all the `pData` elements."},{"content":"The <bpt id=\"p1\">[</bpt>CArray<ept id=\"p1\">](../../mfc/reference/carray-class.md)</ept> implementation uses this method to copy the old data to a new buffer when the array should grow or shrink (when <bpt id=\"p2\">[</bpt>SetSize<ept id=\"p2\">](#carray__setsize)</ept> or <bpt id=\"p3\">[</bpt>FreeExtra<ept id=\"p3\">](#carray__freeextra)</ept> are called).","pos":[14622,14859],"source":"The [CArray](../../mfc/reference/carray-class.md) implementation uses this method to copy the old data to a new buffer when the array should grow or shrink (when [SetSize](#carray__setsize) or [FreeExtra](#carray__freeextra) are called)."},{"content":"The default implementation just copies the data.","pos":[14860,14908]},{"content":"For arrays in which an element contains a pointer to one of its own members, or another structure contains a pointer to one of the array elements, the pointers are not updated in plain copy.","pos":[14915,15105]},{"content":"In this case, you can correct pointers by implementing a specialization of <ph id=\"ph1\">`RelocateElements`</ph> with the relevant types.","pos":[15106,15224],"source":" In this case, you can correct pointers by implementing a specialization of `RelocateElements` with the relevant types."},{"content":"You are also responsible for data copying.","pos":[15225,15267]},{"pos":[15311,15328],"content":"CArray::RemoveAll"},{"content":"Removes all the elements from this array.","pos":[15332,15373]},{"content":"Remarks","pos":[15416,15423]},{"content":"If the array is already empty, the function still works.","pos":[15427,15483]},{"content":"Example","pos":[15493,15500]},{"pos":[15515,15536],"content":"NVC_MFCCollections#31"},{"pos":[15628,15644],"content":"CArray::RemoveAt"},{"content":"Removes one or more elements starting at a specified index in an array.","pos":[15648,15719]},{"content":"Parameters","pos":[15806,15816]},{"content":"An integer index that is greater than or equal to 0 and less than or equal to the value returned by <bpt id=\"p1\">[</bpt>GetUpperBound<ept id=\"p1\">](#carray__getupperbound)</ept>.","pos":[15832,15972],"source":" An integer index that is greater than or equal to 0 and less than or equal to the value returned by [GetUpperBound](#carray__getupperbound)."},{"content":"The number of elements to remove.","pos":[15991,16024]},{"content":"Remarks","pos":[16034,16041]},{"content":"In the process, it shifts down all the elements above the removed element(s).","pos":[16045,16122]},{"content":"It decrements the upper bound of the array but does not free memory.","pos":[16123,16191]},{"content":"If you try to remove more elements than are contained in the array above the removal point, then the Debug version of the library asserts.","pos":[16198,16336]},{"content":"Example","pos":[16346,16353]},{"pos":[16368,16389],"content":"NVC_MFCCollections#32"},{"pos":[16478,16491],"content":"CArray::SetAt"},{"content":"Sets the array element at the specified index.","pos":[16495,16541]},{"content":"Parameters","pos":[16620,16630]},{"content":"An integer index that is greater than or equal to 0 and less than or equal to the value returned by <bpt id=\"p1\">[</bpt>GetUpperBound<ept id=\"p1\">](#carray__getupperbound)</ept>.","pos":[16646,16786],"source":" An integer index that is greater than or equal to 0 and less than or equal to the value returned by [GetUpperBound](#carray__getupperbound)."},{"content":"Template parameter specifying the type of arguments used for referencing array elements.","pos":[16807,16895]},{"content":"The new element value to be stored at the specified position.","pos":[16918,16979]},{"content":"Remarks","pos":[16989,16996]},{"content":"will not cause the array to grow.","pos":[17008,17041]},{"content":"Use <bpt id=\"p1\">[</bpt>SetAtGrow<ept id=\"p1\">](#carray__setatgrow)</ept> if you want the array to grow automatically.","pos":[17042,17122],"source":" Use [SetAtGrow](#carray__setatgrow) if you want the array to grow automatically."},{"content":"You must ensure that your index value represents a valid position in the array.","pos":[17129,17208]},{"content":"If it is out of bounds, then the Debug version of the library asserts.","pos":[17209,17279]},{"content":"Example","pos":[17289,17296]},{"pos":[17301,17345],"content":"See the example for <bpt id=\"p1\">[</bpt>GetAt<ept id=\"p1\">](#carray__getat)</ept>.","source":"See the example for [GetAt](#carray__getat)."},{"pos":[17389,17406],"content":"CArray::SetAtGrow"},{"content":"Sets the array element at the specified index.","pos":[17410,17456]},{"content":"Parameters","pos":[17539,17549]},{"content":"An integer index that is greater than or equal to 0.","pos":[17565,17617]},{"content":"Template parameter specifying the type of elements in the array.","pos":[17638,17702]},{"content":"The element to be added to this array.","pos":[17725,17763]},{"content":"A <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> value is allowed.","pos":[17764,17792],"source":" A **NULL** value is allowed."},{"content":"Remarks","pos":[17802,17809]},{"content":"The array grows automatically if necessary (that is, the upper bound is adjusted to accommodate the new element).","pos":[17813,17926]},{"content":"Example","pos":[17936,17943]},{"pos":[17958,17979],"content":"NVC_MFCCollections#33"},{"pos":[18070,18085],"content":"CArray::SetSize"},{"content":"Establishes the size of an empty or existing array; allocates memory if necessary.","pos":[18089,18171]},{"content":"Parameters","pos":[18261,18271]},{"content":"The new array size (number of elements).","pos":[18289,18329]},{"content":"Must be greater than or equal to 0.","pos":[18330,18365]},{"content":"The minimum number of element slots to allocate if a size increase is necessary.","pos":[18385,18465]},{"content":"Remarks","pos":[18475,18482]},{"content":"If the new size is smaller than the old size, then the array is truncated and all unused memory is released.","pos":[18486,18594]},{"content":"Use this function to set the size of your array before you begin using the array.","pos":[18601,18682]},{"content":"If you do not use <ph id=\"ph1\">`SetSize`</ph>, adding elements to your array causes it to be frequently reallocated and copied.","pos":[18683,18792],"source":" If you do not use `SetSize`, adding elements to your array causes it to be frequently reallocated and copied."},{"content":"Frequent reallocation and copying are inefficient and can fragment memory.","pos":[18793,18867]},{"content":"The <ph id=\"ph1\">`nGrowBy`</ph> parameter affects internal memory allocation while the array is growing.","pos":[18874,18960],"source":"The `nGrowBy` parameter affects internal memory allocation while the array is growing."},{"content":"Its use never affects the array size as reported by <bpt id=\"p1\">[</bpt>GetSize<ept id=\"p1\">](#carray__getsize)</ept> and <bpt id=\"p2\">[</bpt>GetUpperBound<ept id=\"p2\">](#carray__getupperbound)</ept>.","pos":[18961,19085],"source":" Its use never affects the array size as reported by [GetSize](#carray__getsize) and [GetUpperBound](#carray__getupperbound)."},{"content":"If the default value is used, MFC allocates memory in a way calculated to avoid memory fragmentation and optimize efficiency for most cases.","pos":[19086,19226]},{"content":"Example","pos":[19236,19243]},{"pos":[19248,19296],"content":"See the example for <bpt id=\"p1\">[</bpt>GetData<ept id=\"p1\">](#carray__getdata)</ept>.","source":"See the example for [GetData](#carray__getdata)."},{"content":"See Also","pos":[19305,19313]},{"content":"MFC Sample COLLECT","pos":[19318,19336]},{"content":"CObject Class","pos":[19372,19385]},{"content":"Hierarchy Chart","pos":[19430,19445]},{"content":"CObArray Class","pos":[19482,19496]},{"content":"Collection Class Helpers","pos":[19542,19566]}],"content":"---\ntitle: \"CArray Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CArray\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CArray class\"\n  - \"arrays [C++], classes\"\n  - \"templates, collection classes\"\n  - \"collection classes, template-based\"\nms.assetid: fead8b00-4cfd-4625-ad0e-251df62ba92f\ncaps.latest.revision: 33\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CArray Class\nSupports arrays that are like C arrays, but can dynamically reduce and grow as necessary.  \n  \n## Syntax  \n  \n```  \ntemplate <class TYPE, class ARG_TYPE = const TYPE&>  \nclass CArray :  \n    public CObject  \n```  \n  \n#### Parameters  \n `TYPE`  \n Template parameter that specifies the type of objects stored in the array. `TYPE` is a parameter that is returned by `CArray`.  \n  \n `ARG` *_* `TYPE`  \n Template parameter that specifies the argument type that is used to access objects stored in the array. Often a reference to `TYPE`. `ARG_TYPE` is a parameter that is passed to `CArray`.  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CArray::CArray](#carray__carray)|Constructs an empty array.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CArray::Add](#carray__add)|Adds an element to the end of the array; grows the array if necessary.|  \n|[CArray::Append](#carray__append)|Appends another array to the array; grows the array if necessary|  \n|[CArray::Copy](#carray__copy)|Copies another array to the array; grows the array if necessary.|  \n|[CArray::ElementAt](#carray__elementat)|Returns a temporary reference to the element pointer within the array.|  \n|[CArray::FreeExtra](#carray__freeextra)|Frees all unused memory above the current upper bound.|  \n|[CArray::GetAt](#carray__getat)|Returns the value at a given index.|  \n|[CArray::GetCount](#carray__getcount)|Gets the number of elements in this array.|  \n|[CArray::GetData](#carray__getdata)|Allows access to elements in the array. Can be **NULL**.|  \n|[CArray::GetSize](#carray__getsize)|Gets the number of elements in this array.|  \n|[CArray::GetUpperBound](#carray__getupperbound)|Returns the largest valid index.|  \n|[CArray::InsertAt](#carray__insertat)|Inserts an element (or all the elements in another array) at a specified index.|  \n|[CArray::IsEmpty](#carray__isempty)|Determines whether the array is empty.|  \n|[CArray::RemoveAll](#carray__removeall)|Removes all the elements from this array.|  \n|[CArray::RemoveAt](#carray__removeat)|Removes an element at a specific index.|  \n|[CArray::SetAt](#carray__setat)|Sets the value for a given index; array not allowed to grow.|  \n|[CArray::SetAtGrow](#carray__setatgrow)|Sets the value for a given index; grows the array if necessary.|  \n|[CArray::SetSize](#carray__setsize)|Sets the number of elements to be contained in this array.|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[operator&#91;&#93;](#carray__operator_at)|Sets or gets the element at the specified index.|  \n  \n## Remarks  \n Array indexes always start at position 0. You can decide whether to fix the upper bound or enable the array to expand when you add elements past the current bound. Memory is allocated contiguously to the upper bound, even if some elements are null.  \n  \n> [!NOTE]\n>  Most methods that resize a `CArray` object or add elements to it use [memcpy_s](../../c-runtime-library/reference/memcpy-s-wmemcpy-s.md) to move elements. This is a problem because `memcpy_s` is not compatible with any objects that require the constructor to be called. If the items in the `CArray` are not compatible with `memcpy_s`, you must create a new `CArray` of the appropriate size. You must then use [CArray::Copy](#carray__copy) and [CArray::SetAt](#carray__setat) to populate the new array because those methods use an assignment operator instead of `memcpy_s`.  \n  \n As with a C array, the access time for a `CArray` indexed element is constant and is independent of the array size.  \n  \n> [!TIP]\n>  Before using an array, use [SetSize](#carray__setsize) to establish its size and allocate memory for it. If you do not use `SetSize`, adding elements to your array causes it to be frequently reallocated and copied. Frequent reallocation and copying are inefficient and can fragment memory.  \n  \n If you need a dump of individual elements in an array, you must set the depth of the [CDumpContext](../../mfc/reference/cdumpcontext-class.md) object to 1 or larger.  \n  \n Certain member functions of this class call global helper functions that must be customized for most uses of the `CArray` class. See the topic [Collection Class Helpers](../../mfc/reference/collection-class-helpers.md) in the MFC Macros and Globals section.  \n  \n Array class derivation is like list derivation.  \n  \n For more information about how to use `CArray`, see the article [Collections](../../mfc/collections.md).  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n `CArray`  \n  \n## Requirements  \n `Header:` afxtempl.h  \n  \n##  <a name=\"carray__add\"></a>  CArray::Add  \n Adds a new element to the end of an array, growing the array by 1.  \n  \n```  \nINT_PTR Add(ARG_TYPE newElement);\n```  \n  \n### Parameters  \n `ARG_TYPE`  \n Template parameter specifying the type of arguments referencing elements in this array.  \n  \n `newElement`  \n The element to be added to this array.  \n  \n### Return Value  \n The index of the added element.  \n  \n### Remarks  \n If [SetSize](#carray__setsize) has been used with an `nGrowBy` value greater than 1, then extra memory may be allocated. However, the upper bound will increase by only 1.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#22](../../mfc/codesnippet/cpp/carray-class_1.cpp)]  \n  \n##  <a name=\"carray__append\"></a>  CArray::Append  \n Call this member function to add the contents of one array to the end of another.  \n  \n```  \nINT_PTR Append(const CArray& src);\n```  \n  \n### Parameters  \n *src*  \n Source of the elements to be appended to an array.  \n  \n### Return Value  \n The index of the first appended element.  \n  \n### Remarks  \n The arrays must be of the same type.  \n  \n If necessary, **Append** may allocate extra memory to accommodate the elements appended to the array.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#23](../../mfc/codesnippet/cpp/carray-class_2.cpp)]  \n  \n##  <a name=\"carray__carray\"></a>  CArray::CArray  \n Constructs an empty array.  \n  \n```  \nCArray();\n```  \n  \n### Remarks  \n The array grows one element at a time.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#24](../../mfc/codesnippet/cpp/carray-class_3.cpp)]  \n  \n##  <a name=\"carray__copy\"></a>  CArray::Copy  \n Use this member function to copy the elements of one array to another.  \n  \n```  \nvoid Copy(const CArray& src);\n```  \n  \n### Parameters  \n *src*  \n Source of the elements to be copied to an array.  \n  \n### Remarks  \n Call this member function to overwrite the elements of one array with the elements of another array.  \n  \n **Copy** does not free memory; however, if necessary, **Copy** may allocate extra memory to accommodate the elements copied to the array.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#25](../../mfc/codesnippet/cpp/carray-class_4.cpp)]  \n  \n##  <a name=\"carray__elementat\"></a>  CArray::ElementAt  \n Returns a temporary reference to the specified element within the array.  \n  \n```  \nTYPE& ElementAt(INT_PTR nIndex);\n\n \nconst TYPE& ElementAt(INT_PTR nIndex) const;\n\n \n```  \n  \n### Parameters  \n `nIndex`  \n An integer index that is greater than or equal to 0 and less than or equal to the value returned by [GetUpperBound](#carray__getupperbound).  \n  \n### Return Value  \n A reference to an array element.  \n  \n### Remarks  \n It is used to implement the left-side assignment operator for arrays.  \n  \n### Example  \n  See the example for [GetSize](#carray__getsize).  \n  \n##  <a name=\"carray__freeextra\"></a>  CArray::FreeExtra  \n Frees any extra memory that was allocated while the array was grown.  \n  \n```  \nvoid FreeExtra();\n```  \n  \n### Remarks  \n This function has no effect on the size or upper bound of the array.  \n  \n### Example  \n  See the example for [GetData](#carray__getdata).  \n  \n##  <a name=\"carray__getat\"></a>  CArray::GetAt  \n Returns the array element at the specified index.  \n  \n```  \nTYPE& GetAt(INT_PTR nIndex);\n\n \nconst TYPE& GetAt(INT_PTR nIndex) const;\n\n \n```  \n  \n### Parameters  \n *TYPE*  \n Template parameter specifying the type of the array elements.  \n  \n `nIndex`  \n An integer index that is greater than or equal to 0 and less than or equal to the value returned by [GetUpperBound](#carray__getupperbound).  \n  \n### Return Value  \n The array element currently at this index.  \n  \n### Remarks  \n Passing a negative value or a value greater than the value returned by `GetUpperBound` will result in a failed assertion.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#26](../../mfc/codesnippet/cpp/carray-class_5.cpp)]  \n  \n##  <a name=\"carray__getcount\"></a>  CArray::GetCount  \n Returns the number of array elements.  \n  \n```  \nINT_PTR GetCount() const;\n\n \n```  \n  \n### Return Value  \n The number of items in the array.  \n  \n### Remarks  \n Call this method to retrieve the number of elements in the array. Because indexes are zero-based, the size is 1 greater than the largest index. Calling this method will generate the same result as the [CArray::GetSize](#carray__getsize) method.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#27](../../mfc/codesnippet/cpp/carray-class_6.cpp)]  \n  \n##  <a name=\"carray__getdata\"></a>  CArray::GetData  \n Use this member function to gain direct access to the elements in an array.  \n  \n```  \nconst TYPE* GetData() const;\n\n \n \nTYPE* GetData();\n```  \n  \n### Parameters  \n *TYPE*  \n Template parameter specifying the type of the array elements.  \n  \n### Return Value  \n A pointer to an array element.  \n  \n### Remarks  \n If no elements are available, `GetData` returns a null value.  \n  \n While direct access to the elements of an array can help you work more quickly, use caution when calling `GetData`; any errors you make directly affect the elements of your array.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#28](../../mfc/codesnippet/cpp/carray-class_7.cpp)]  \n  \n##  <a name=\"carray__getsize\"></a>  CArray::GetSize  \n Returns the size of the array.  \n  \n```  \nINT_PTR GetSize() const;\n\n \n```  \n  \n### Remarks  \n Because indexes are zero-based, the size is 1 greater than the largest index. Calling this method will generate the same result as the [CArray::GetCount](#carray__getcount) method.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#29](../../mfc/codesnippet/cpp/carray-class_8.cpp)]  \n  \n##  <a name=\"carray__getupperbound\"></a>  CArray::GetUpperBound  \n Returns the current upper bound of this array.  \n  \n```  \nINT_PTR GetUpperBound() const;\n\n \n```  \n  \n### Remarks  \n Because array indexes are zero-based, this function returns a value 1 less than `GetSize`.  \n  \n The condition **GetUpperBound( )** = –1 indicates that the array contains no elements.  \n  \n### Example  \n  See the example for [CArray::GetAt](#carray__getat).  \n  \n##  <a name=\"carray__insertat\"></a>  CArray::InsertAt  \n The first version of `InsertAt` inserts one element (or multiple copies of an element) at a specified index in an array.  \n  \n```  \nvoid InsertAt(\n    INT_PTR nIndex,\n    ARG_TYPE newElement,  \n    INT_PTR nCount = 1);\n\n \nvoid InsertAt(\n    INT_PTR nStartIndex,  \n    CArray* pNewArray);\n```  \n  \n### Parameters  \n `nIndex`  \n An integer index that may be greater than the value returned by `GetUpperBound`.  \n  \n `ARG_TYPE`  \n Template parameter specifying the type of elements in this array.  \n  \n `newElement`  \n The element to be placed in this array.  \n  \n `nCount`  \n The number of times this element should be inserted (defaults to 1).  \n  \n `nStartIndex`  \n An integer index that may be greater than the value returned by [GetUpperBound](#carray__getupperbound).  \n  \n `pNewArray`  \n Another array that contains elements to be added to this array.  \n  \n### Remarks  \n In the process, it shifts up (by incrementing the index) the existing element at this index, and it shifts up all the elements above it.  \n  \n The second version inserts all the elements from another `CArray` collection, starting at the `nStartIndex` position.  \n  \n The `SetAt` function, in contrast, replaces one specified array element and does not shift any elements.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#30](../../mfc/codesnippet/cpp/carray-class_9.cpp)]  \n  \n##  <a name=\"carray__isempty\"></a>  CArray::IsEmpty  \n Determines whether the array is empty.  \n  \n```  \nBOOL IsEmpty() const;\n\n \n```  \n  \n### Return Value  \n Nonzero if the array contains no elements; otherwise 0.  \n  \n##  <a name=\"carray__operator_at\"></a>  CArray::operator \\[\\]  \n These subscript operators are a convenient substitute for the [SetAt](#carray__setat) and [GetAt](#carray__getat) functions.  \n  \n```  \nTYPE& operator[](int_ptr nindex);\n\n \nconst TYPE& operator[](int_ptr nindex) const;\n\n \n```  \n  \n### Parameters  \n *TYPE*  \n Template parameter specifying the type of elements in this array.  \n  \n `nIndex`  \n Index of the element to be accessed.  \n  \n### Remarks  \n The first operator, called for arrays that are not **const**, may be used on either the right (r-value) or the left (l-value) of an assignment statement. The second, called for **const** arrays, may be used only on the right.  \n  \n The Debug version of the library asserts if the subscript (either on the left or right side of an assignment statement) is out of bounds.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#34](../../mfc/codesnippet/cpp/carray-class_10.cpp)]  \n  \n##  <a name=\"carray__relocateelements\"></a>  CArray::RelocateElements  \n Relocates data to a new buffer when the array should grow or shrink.  \n  \n```  \ntemplate<class TYPE, class ARG_TYPE>  \nAFX_INLINE void CArray<TYPE, ARG_TYPE>::RelocateElements(\n    TYPE* pNewData,  \n    const TYPE* pData,  \n    INT_PTR nCount);\n```  \n  \n### Parameters  \n `pNewData`  \n A new buffer for the array of elements.  \n  \n `pData`  \n The old array of elements.  \n  \n `nCount`  \n Number of elements in the old array.  \n  \n### Remarks  \n `pNewData` is always large enough to hold all the `pData` elements.  \n  \n The [CArray](../../mfc/reference/carray-class.md) implementation uses this method to copy the old data to a new buffer when the array should grow or shrink (when [SetSize](#carray__setsize) or [FreeExtra](#carray__freeextra) are called). The default implementation just copies the data.  \n  \n For arrays in which an element contains a pointer to one of its own members, or another structure contains a pointer to one of the array elements, the pointers are not updated in plain copy. In this case, you can correct pointers by implementing a specialization of `RelocateElements` with the relevant types. You are also responsible for data copying.  \n  \n##  <a name=\"carray__removeall\"></a>  CArray::RemoveAll  \n Removes all the elements from this array.  \n  \n```  \nvoid RemoveAll();\n```  \n  \n### Remarks  \n If the array is already empty, the function still works.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#31](../../mfc/codesnippet/cpp/carray-class_11.cpp)]  \n  \n##  <a name=\"carray__removeat\"></a>  CArray::RemoveAt  \n Removes one or more elements starting at a specified index in an array.  \n  \n```  \nvoid RemoveAt(\n    INT_PTR nIndex,  \n    INT_PTR nCount = 1);\n```  \n  \n### Parameters  \n `nIndex`  \n An integer index that is greater than or equal to 0 and less than or equal to the value returned by [GetUpperBound](#carray__getupperbound).  \n  \n `nCount`  \n The number of elements to remove.  \n  \n### Remarks  \n In the process, it shifts down all the elements above the removed element(s). It decrements the upper bound of the array but does not free memory.  \n  \n If you try to remove more elements than are contained in the array above the removal point, then the Debug version of the library asserts.  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#32](../../mfc/codesnippet/cpp/carray-class_12.cpp)]  \n  \n##  <a name=\"carray__setat\"></a>  CArray::SetAt  \n Sets the array element at the specified index.  \n  \n```  \nvoid SetAt(\n    INT_PTR nIndex, ARG_TYPE newElement);\n```  \n  \n### Parameters  \n `nIndex`  \n An integer index that is greater than or equal to 0 and less than or equal to the value returned by [GetUpperBound](#carray__getupperbound).  \n  \n `ARG_TYPE`  \n Template parameter specifying the type of arguments used for referencing array elements.  \n  \n `newElement`  \n The new element value to be stored at the specified position.  \n  \n### Remarks  \n `SetAt` will not cause the array to grow. Use [SetAtGrow](#carray__setatgrow) if you want the array to grow automatically.  \n  \n You must ensure that your index value represents a valid position in the array. If it is out of bounds, then the Debug version of the library asserts.  \n  \n### Example  \n  See the example for [GetAt](#carray__getat).  \n  \n##  <a name=\"carray__setatgrow\"></a>  CArray::SetAtGrow  \n Sets the array element at the specified index.  \n  \n```  \nvoid SetAtGrow(\n    INT_PTR nIndex, ARG_TYPE newElement);\n```  \n  \n### Parameters  \n `nIndex`  \n An integer index that is greater than or equal to 0.  \n  \n `ARG_TYPE`  \n Template parameter specifying the type of elements in the array.  \n  \n `newElement`  \n The element to be added to this array. A **NULL** value is allowed.  \n  \n### Remarks  \n The array grows automatically if necessary (that is, the upper bound is adjusted to accommodate the new element).  \n  \n### Example  \n [!code-cpp[NVC_MFCCollections#33](../../mfc/codesnippet/cpp/carray-class_13.cpp)]  \n  \n##  <a name=\"carray__setsize\"></a>  CArray::SetSize  \n Establishes the size of an empty or existing array; allocates memory if necessary.  \n  \n```  \nvoid SetSize(\n    INT_PTR nNewSize,  \n    INT_PTR nGrowBy = -1);\n```  \n  \n### Parameters  \n `nNewSize`  \n The new array size (number of elements). Must be greater than or equal to 0.  \n  \n `nGrowBy`  \n The minimum number of element slots to allocate if a size increase is necessary.  \n  \n### Remarks  \n If the new size is smaller than the old size, then the array is truncated and all unused memory is released.  \n  \n Use this function to set the size of your array before you begin using the array. If you do not use `SetSize`, adding elements to your array causes it to be frequently reallocated and copied. Frequent reallocation and copying are inefficient and can fragment memory.  \n  \n The `nGrowBy` parameter affects internal memory allocation while the array is growing. Its use never affects the array size as reported by [GetSize](#carray__getsize) and [GetUpperBound](#carray__getupperbound). If the default value is used, MFC allocates memory in a way calculated to avoid memory fragmentation and optimize efficiency for most cases.  \n  \n### Example  \n  See the example for [GetData](#carray__getdata).  \n  \n## See Also  \n [MFC Sample COLLECT](../../visual-cpp-samples.md)   \n [CObject Class](../../mfc/reference/cobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CObArray Class](../../mfc/reference/cobarray-class.md)   \n [Collection Class Helpers](../../mfc/reference/collection-class-helpers.md)\n"}