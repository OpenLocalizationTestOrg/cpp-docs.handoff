{"nodes":[{"pos":[12,53],"content":"_com_error::ErrorMessage | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"_com_error::ErrorMessage | Microsoft Docs","pos":[0,41]}]},{"content":"_com_error::ErrorMessage","pos":[686,710]},{"content":"Microsoft Specific","pos":[713,731]},{"pos":[740,817],"content":"Retrieves the string message for <ph id=\"ph1\">`HRESULT`</ph> stored in the <ph id=\"ph2\">`_com_error`</ph> object.","source":"Retrieves the string message for `HRESULT` stored in the `_com_error` object."},{"content":"Syntax","pos":[826,832]},{"content":"Return Value","pos":[910,922]},{"content":"Returns the string message for the <ph id=\"ph1\">`HRESULT`</ph> recorded within the <ph id=\"ph2\">`_com_error`</ph> object.","pos":[926,1011],"source":"Returns the string message for the `HRESULT` recorded within the `_com_error` object."},{"content":"If the <ph id=\"ph1\">`HRESULT`</ph> is a mapped 16-bit <bpt id=\"p1\">[</bpt>wCode<ept id=\"p1\">](../cpp/com-error-wcode.md)</ept>, then a generic message \"<ph id=\"ph2\">`IDispatch error #&lt;wCode&gt;`</ph>\" is returned.","pos":[1012,1148],"source":" If the `HRESULT` is a mapped 16-bit [wCode](../cpp/com-error-wcode.md), then a generic message \"`IDispatch error #<wCode>`\" is returned."},{"content":"If no message is found, then a generic message \"<ph id=\"ph1\">`Unknown error #&lt;hresult&gt;`</ph>\" is returned.","pos":[1149,1237],"source":" If no message is found, then a generic message \"`Unknown error #<hresult>`\" is returned."},{"content":"The returned string is either a Unicode or multibyte string, depending on the state of the <bpt id=\"p1\">**</bpt>_UNICODE<ept id=\"p1\">**</ept> macro.","pos":[1238,1348],"source":" The returned string is either a Unicode or multibyte string, depending on the state of the **_UNICODE** macro."},{"content":"Remarks","pos":[1357,1364]},{"content":"Retrieves the appropriate system message text for <ph id=\"ph1\">`HRESULT`</ph> recorded within the <ph id=\"ph2\">`_com_error`</ph> object.","pos":[1368,1468],"source":"Retrieves the appropriate system message text for `HRESULT` recorded within the `_com_error` object."},{"content":"The system message text is obtained by calling the Win32 <bpt id=\"p1\">[</bpt>FormatMessage<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679351)</ept> function.","pos":[1469,1611],"source":" The system message text is obtained by calling the Win32 [FormatMessage](http://msdn.microsoft.com/library/windows/desktop/ms679351) function."},{"content":"The string returned is allocated by the <ph id=\"ph1\">`FormatMessage`</ph> API, and it is released when the <ph id=\"ph2\">`_com_error`</ph> object is destroyed.","pos":[1612,1734],"source":" The string returned is allocated by the `FormatMessage` API, and it is released when the `_com_error` object is destroyed."},{"content":"END Microsoft Specific","pos":[1743,1765]},{"content":"See Also","pos":[1776,1784]},{"content":"_com_error Class","pos":[1789,1805]}],"content":"---\ntitle: \"_com_error::ErrorMessage | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\nf1_keywords: \n  - \"_com_error::ErrorMessage\"\n  - \"_com_error.ErrorMessage\"\n  - \"ErrorMessage\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ErrorMessage method\"\nms.assetid: e47335b6-01af-4975-a841-121597479eb7\ncaps.latest.revision: 6\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# _com_error::ErrorMessage\n**Microsoft Specific**  \n  \n Retrieves the string message for `HRESULT` stored in the `_com_error` object.  \n  \n## Syntax  \n  \n```  \n  \nconst TCHAR * ErrorMessage( ) const throw( );  \n  \n```  \n  \n## Return Value  \n Returns the string message for the `HRESULT` recorded within the `_com_error` object. If the `HRESULT` is a mapped 16-bit [wCode](../cpp/com-error-wcode.md), then a generic message \"`IDispatch error #<wCode>`\" is returned. If no message is found, then a generic message \"`Unknown error #<hresult>`\" is returned. The returned string is either a Unicode or multibyte string, depending on the state of the **_UNICODE** macro.  \n  \n## Remarks  \n Retrieves the appropriate system message text for `HRESULT` recorded within the `_com_error` object. The system message text is obtained by calling the Win32 [FormatMessage](http://msdn.microsoft.com/library/windows/desktop/ms679351) function. The string returned is allocated by the `FormatMessage` API, and it is released when the `_com_error` object is destroyed.  \n  \n **END Microsoft Specific**  \n  \n## See Also  \n [_com_error Class](../cpp/com-error-class.md)"}