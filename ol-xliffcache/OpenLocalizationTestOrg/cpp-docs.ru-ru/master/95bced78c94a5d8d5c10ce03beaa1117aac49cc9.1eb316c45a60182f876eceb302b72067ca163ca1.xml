{"nodes":[{"pos":[12,48],"content":"ConvertStringToBSTR | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ConvertStringToBSTR | Microsoft Docs","pos":[0,36]}]},{"content":"ConvertStringToBSTR","pos":[637,656]},{"content":"Microsoft Specific","pos":[659,677]},{"pos":[686,727],"content":"Converts a <bpt id=\"p1\">**</bpt>char <ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept> value to a <ph id=\"ph2\">`BSTR`</ph>.","source":"Converts a **char \\*** value to a `BSTR`."},{"content":"Syntax","pos":[736,742]},{"content":"Parameters","pos":[841,851]},{"content":"A <bpt id=\"p1\">**</bpt>char <ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept> variable.","pos":[865,888],"source":" A **char \\*** variable."},{"content":"Example","pos":[897,904]},{"content":"END Microsoft Specific","pos":[1384,1406]},{"content":"Requirements","pos":[1415,1427]},{"pos":[1431,1452],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> comutil.h","source":"**Header:** comutil.h"},{"pos":[1459,1620],"content":"<bpt id=\"p1\">**</bpt>Lib:<ept id=\"p1\">**</ept> comsuppw.lib or comsuppwd.lib (see <bpt id=\"p2\">[</bpt>/Zc:wchar_t (wchar_t Is Native Type)<ept id=\"p2\">](../build/reference/zc-wchar-t-wchar-t-is-native-type.md)</ept> for more information)","source":"**Lib:** comsuppw.lib or comsuppwd.lib (see [/Zc:wchar_t (wchar_t Is Native Type)](../build/reference/zc-wchar-t-wchar-t-is-native-type.md) for more information)"},{"content":"See Also","pos":[1629,1637]},{"content":"Compiler COM Global Functions","pos":[1642,1671]}],"content":"---\ntitle: \"ConvertStringToBSTR | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\nf1_keywords: \n  - \"ConvertStringToBSTR\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ConvertStringToBSTR function\"\nms.assetid: 071f9b3b-9643-4e06-a1e5-de96ed15bab2\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# ConvertStringToBSTR\n**Microsoft Specific**  \n  \n Converts a **char \\*** value to a `BSTR`.  \n  \n## Syntax  \n  \n```  \n  \n      BSTR __stdcall ConvertStringToBSTR(  \n   const char* pSrc  \n)  \n```  \n  \n#### Parameters  \n `pSrc`  \n A **char \\*** variable.  \n  \n## Example  \n  \n```  \n// ConvertStringToBSTR.cpp  \n#include <comutil.h>  \n#include <stdio.h>  \n  \n#pragma comment(lib, \"comsuppw.lib\")  \n#pragma comment(lib, \"kernel32.lib\")  \n  \nint main() {  \n   char* lpszText = \"Test\";  \n   printf_s(\"char * text: %s\\n\", lpszText);  \n  \n   BSTR bstrText = _com_util::ConvertStringToBSTR(lpszText);  \n   wprintf_s(L\"BSTR text: %s\\n\", bstrText);  \n  \n   SysFreeString(bstrText);  \n}  \n```  \n  \n```Output  \nchar * text: Test  \nBSTR text: Test  \n```  \n  \n## END Microsoft Specific  \n  \n## Requirements  \n **Header:** comutil.h  \n  \n **Lib:** comsuppw.lib or comsuppwd.lib (see [/Zc:wchar_t (wchar_t Is Native Type)](../build/reference/zc-wchar-t-wchar-t-is-native-type.md) for more information)  \n  \n## See Also  \n [Compiler COM Global Functions](../cpp/compiler-com-global-functions.md)"}