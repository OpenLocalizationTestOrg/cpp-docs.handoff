{"nodes":[{"pos":[12,53],"content":"COleDispatchDriver Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"COleDispatchDriver Class | Microsoft Docs","pos":[0,41]}]},{"pos":[707,731],"content":"COleDispatchDriver Class","linkify":"COleDispatchDriver Class","nodes":[{"content":"COleDispatchDriver Class","pos":[0,24]}]},{"content":"Implements the client side of OLE automation.","pos":[732,777]},{"pos":[786,792],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[843,850],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[860,879],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[886,890]},{"content":"Description","pos":[891,902]},{"pos":[940,1021],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::COleDispatchDriver<ept id=\"p1\">](#coledispatchdriver__coledispatchdriver)</ept>","source":"[COleDispatchDriver::COleDispatchDriver](#coledispatchdriver__coledispatchdriver)"},{"pos":[1022,1063],"content":"Constructs a <ph id=\"ph1\">`COleDispatchDriver`</ph> object.","source":"Constructs a `COleDispatchDriver` object."},{"pos":[1074,1088],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1095,1099]},{"content":"Description","pos":[1100,1111]},{"pos":[1149,1222],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::AttachDispatch<ept id=\"p1\">](#coledispatchdriver__attachdispatch)</ept>","source":"[COleDispatchDriver::AttachDispatch](#coledispatchdriver__attachdispatch)"},{"pos":[1223,1293],"content":"Attaches an <ph id=\"ph1\">`IDispatch`</ph> connection to the <ph id=\"ph2\">`COleDispatchDriver`</ph> object.","source":"Attaches an `IDispatch` connection to the `COleDispatchDriver` object."},{"pos":[1298,1371],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::CreateDispatch<ept id=\"p1\">](#coledispatchdriver__createdispatch)</ept>","source":"[COleDispatchDriver::CreateDispatch](#coledispatchdriver__createdispatch)"},{"pos":[1372,1457],"content":"Creates an <ph id=\"ph1\">`IDispatch`</ph> connection and attaches it to the <ph id=\"ph2\">`COleDispatchDriver`</ph> object.","source":"Creates an `IDispatch` connection and attaches it to the `COleDispatchDriver` object."},{"pos":[1462,1535],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::DetachDispatch<ept id=\"p1\">](#coledispatchdriver__detachdispatch)</ept>","source":"[COleDispatchDriver::DetachDispatch](#coledispatchdriver__detachdispatch)"},{"pos":[1536,1593],"content":"Detaches an <ph id=\"ph1\">`IDispatch`</ph> connection, without releasing it.","source":"Detaches an `IDispatch` connection, without releasing it."},{"pos":[1598,1665],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::GetProperty<ept id=\"p1\">](#coledispatchdriver__getproperty)</ept>","source":"[COleDispatchDriver::GetProperty](#coledispatchdriver__getproperty)"},{"content":"Gets an automation property.","pos":[1666,1694]},{"pos":[1699,1768],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::InvokeHelper<ept id=\"p1\">](#coledispatchdriver__invokehelper)</ept>","source":"[COleDispatchDriver::InvokeHelper](#coledispatchdriver__invokehelper)"},{"content":"Helper for calling automation methods.","pos":[1769,1807]},{"pos":[1812,1887],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::ReleaseDispatch<ept id=\"p1\">](#coledispatchdriver__releasedispatch)</ept>","source":"[COleDispatchDriver::ReleaseDispatch](#coledispatchdriver__releasedispatch)"},{"pos":[1888,1923],"content":"Releases an <ph id=\"ph1\">`IDispatch`</ph> connection.","source":"Releases an `IDispatch` connection."},{"pos":[1928,1995],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::SetProperty<ept id=\"p1\">](#coledispatchdriver__setproperty)</ept>","source":"[COleDispatchDriver::SetProperty](#coledispatchdriver__setproperty)"},{"content":"Sets an automation property.","pos":[1996,2024]},{"pos":[2035,2051],"content":"Public Operators","linkify":"Public Operators","nodes":[{"content":"Public Operators","pos":[0,16]}]},{"content":"Name","pos":[2058,2062]},{"content":"Description","pos":[2063,2074]},{"pos":[2112,2179],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::operator =<ept id=\"p1\">](#coledispatchdriver__operator__eq)</ept>","source":"[COleDispatchDriver::operator =](#coledispatchdriver__operator__eq)"},{"pos":[2180,2241],"content":"Copies the source value into the <ph id=\"ph1\">`COleDispatchDriver`</ph> object.","source":"Copies the source value into the `COleDispatchDriver` object."},{"pos":[2246,2329],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::operator LPDISPATCH<ept id=\"p1\">](#coledispatchdriver__operator_lpdispatch)</ept>","source":"[COleDispatchDriver::operator LPDISPATCH](#coledispatchdriver__operator_lpdispatch)"},{"pos":[2330,2374],"content":"Accesses the underlying <ph id=\"ph1\">`IDispatch`</ph> pointer.","source":"Accesses the underlying `IDispatch` pointer."},{"pos":[2385,2404],"content":"Public Data Members","linkify":"Public Data Members","nodes":[{"content":"Public Data Members","pos":[0,19]}]},{"content":"Name","pos":[2411,2415]},{"content":"Description","pos":[2416,2427]},{"pos":[2465,2538],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::m_bAutoRelease<ept id=\"p1\">](#coledispatchdriver__m_bautorelease)</ept>","source":"[COleDispatchDriver::m_bAutoRelease](#coledispatchdriver__m_bautorelease)"},{"pos":[2539,2631],"content":"Specifies whether to release the <ph id=\"ph1\">`IDispatch`</ph> during <ph id=\"ph2\">`ReleaseDispatch`</ph> or object destruction.","source":"Specifies whether to release the `IDispatch` during `ReleaseDispatch` or object destruction."},{"pos":[2636,2705],"content":"<bpt id=\"p1\">[</bpt>COleDispatchDriver::m_lpDispatch<ept id=\"p1\">](#coledispatchdriver__m_lpdispatch)</ept>","source":"[COleDispatchDriver::m_lpDispatch](#coledispatchdriver__m_lpdispatch)"},{"pos":[2706,2795],"content":"Indicates the pointer to the <ph id=\"ph1\">`IDispatch`</ph> interface attached to this <ph id=\"ph2\">`COleDispatchDriver`</ph>.","source":"Indicates the pointer to the `IDispatch` interface attached to this `COleDispatchDriver`."},{"pos":[2805,2812],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2816,2864],"content":"<ph id=\"ph1\">`COleDispatchDriver`</ph> does not have a base class.","source":"`COleDispatchDriver` does not have a base class."},{"content":"OLE dispatch interfaces provide access to an object's methods and properties.","pos":[2871,2948]},{"content":"Member functions of <ph id=\"ph1\">`COleDispatchDriver`</ph> attach, detach, create, and release a dispatch connection of type <ph id=\"ph2\">`IDispatch`</ph>.","pos":[2949,3068],"source":" Member functions of `COleDispatchDriver` attach, detach, create, and release a dispatch connection of type `IDispatch`."},{"content":"Other member functions use variable argument lists to simplify calling <bpt id=\"p1\">**</bpt>IDispatch::Invoke<ept id=\"p1\">**</ept>.","pos":[3069,3162],"source":" Other member functions use variable argument lists to simplify calling **IDispatch::Invoke**."},{"content":"This class can be used directly, but it is generally used only by classes created by the Add Class wizard.","pos":[3169,3275]},{"content":"When you create new C++ classes by importing a type library, the new classes are derived from <ph id=\"ph1\">`COleDispatchDriver`</ph>.","pos":[3276,3391],"source":" When you create new C++ classes by importing a type library, the new classes are derived from `COleDispatchDriver`."},{"pos":[3398,3477],"content":"For more information on using <ph id=\"ph1\">`COleDispatchDriver`</ph>, see the following articles:","source":"For more information on using `COleDispatchDriver`, see the following articles:"},{"pos":[3485,3538],"content":"<bpt id=\"p1\">[</bpt>Automation Clients<ept id=\"p1\">](../../mfc/automation-clients.md)</ept>","source":"[Automation Clients](../../mfc/automation-clients.md)"},{"pos":[3546,3599],"content":"<bpt id=\"p1\">[</bpt>Automation Servers<ept id=\"p1\">](../../mfc/automation-servers.md)</ept>","source":"[Automation Servers](../../mfc/automation-servers.md)"},{"pos":[3608,3629],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[3662,3674],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[3678,3699],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxdisp.h","source":"**Header:** afxdisp.h"},{"pos":[3709,3794],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__attachdispatch\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::AttachDispatch","linkify":"<a name=\"coledispatchdriver__attachdispatch\"></a>  COleDispatchDriver::AttachDispatch","source":"<a name=\"coledispatchdriver__attachdispatch\"></a>  COleDispatchDriver::AttachDispatch"},{"content":"Call the <ph id=\"ph1\">`AttachDispatch`</ph> member function to attach an <ph id=\"ph2\">`IDispatch`</ph> pointer to the <ph id=\"ph3\">`COleDispatchDriver`</ph> object.","pos":[3798,3908],"source":"Call the `AttachDispatch` member function to attach an `IDispatch` pointer to the `COleDispatchDriver` object."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Implementing the IDispatch Interface<ept id=\"p1\">](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)</ept>.","pos":[3909,4044],"source":" For more information, see [Implementing the IDispatch Interface](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)."},{"pos":[4158,4168],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to an OLE <ph id=\"ph1\">`IDispatch`</ph> object to be attached to the <ph id=\"ph2\">`COleDispatchDriver`</ph> object.","pos":[4188,4275],"source":" Pointer to an OLE `IDispatch` object to be attached to the `COleDispatchDriver` object."},{"content":"Specifies whether the dispatch is to be released when this object goes out of scope.","pos":[4300,4384]},{"pos":[4394,4401],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[4405,4512],"content":"This function releases any <ph id=\"ph1\">`IDispatch`</ph> pointer that is already attached to the <ph id=\"ph2\">`COleDispatchDriver`</ph> object.","source":"This function releases any `IDispatch` pointer that is already attached to the `COleDispatchDriver` object."},{"pos":[4522,4529],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[4533,4625],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCOleContainer#3<ept id=\"p2\">](../../mfc/codesnippet/cpp/coledispatchdriver-class_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCOleContainer#3](../../mfc/codesnippet/cpp/coledispatchdriver-class_1.cpp)]"},{"pos":[4635,4728],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__coledispatchdriver\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::COleDispatchDriver","linkify":"<a name=\"coledispatchdriver__coledispatchdriver\"></a>  COleDispatchDriver::COleDispatchDriver","source":"<a name=\"coledispatchdriver__coledispatchdriver\"></a>  COleDispatchDriver::COleDispatchDriver"},{"pos":[4732,4773],"content":"Constructs a <ph id=\"ph1\">`COleDispatchDriver`</ph> object.","source":"Constructs a `COleDispatchDriver` object."},{"pos":[4954,4964],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Pointer to an OLE <ph id=\"ph1\">`IDispatch`</ph> object to be attached to the <ph id=\"ph2\">`COleDispatchDriver`</ph> object.","pos":[4984,5071],"source":" Pointer to an OLE `IDispatch` object to be attached to the `COleDispatchDriver` object."},{"content":"Specifies whether the dispatch is to be released when this object goes out of scope.","pos":[5096,5180]},{"content":"Reference to an existing <ph id=\"ph1\">`COleDispatchDriver`</ph> object.","pos":[5204,5257],"source":" Reference to an existing `COleDispatchDriver` object."},{"pos":[5267,5274],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[5278,5475],"content":"The form <ph id=\"ph1\">`COleDispatchDriver`</ph>( <ph id=\"ph2\">`LPDISPATCH``lpDispatch`</ph>, <bpt id=\"p1\">**</bpt>BOOL<ept id=\"p1\">**</ept><ph id=\"ph3\">`bAutoRelease`</ph><ph id=\"ph4\"> = </ph><bpt id=\"p2\">**</bpt>TRUE<ept id=\"p2\">**</ept>) connects the <bpt id=\"p3\">[</bpt>IDispatch<ept id=\"p3\">](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)</ept> interface.","source":"The form `COleDispatchDriver`( `LPDISPATCH``lpDispatch`, **BOOL**`bAutoRelease` = **TRUE**) connects the [IDispatch](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945) interface."},{"pos":[5482,5641],"content":"The form <ph id=\"ph1\">`COleDispatchDriver`</ph>( <bpt id=\"p1\">**</bpt>const<ept id=\"p1\">**</ept><ph id=\"ph2\">`COleDispatchDriver`</ph><ph id=\"ph3\">&amp; </ph><ph id=\"ph4\">`dispatchSrc`</ph>) copies an existing <ph id=\"ph5\">`COleDispatchDriver`</ph> object and increments the reference count.","source":"The form `COleDispatchDriver`( **const**`COleDispatchDriver`& `dispatchSrc`) copies an existing `COleDispatchDriver` object and increments the reference count."},{"content":"The form <ph id=\"ph1\">`COleDispatchDriver`</ph>( ) creates a <ph id=\"ph2\">`COleDispatchDriver`</ph> object but does not connect the <ph id=\"ph3\">`IDispatch`</ph> interface.","pos":[5648,5766],"source":"The form `COleDispatchDriver`( ) creates a `COleDispatchDriver` object but does not connect the `IDispatch` interface."},{"content":"Before using <ph id=\"ph1\">`COleDispatchDriver`</ph>( ) without arguments, you should connect an <ph id=\"ph2\">`IDispatch`</ph> to it using either <bpt id=\"p1\">[</bpt>COleDispatchDriver::CreateDispatch<ept id=\"p1\">](#coledispatchdriver__createdispatch)</ept> or <bpt id=\"p2\">[</bpt>COleDispatchDriver::AttachDispatch<ept id=\"p2\">](#coledispatchdriver__attachdispatch)</ept>.","pos":[5767,6027],"source":" Before using `COleDispatchDriver`( ) without arguments, you should connect an `IDispatch` to it using either [COleDispatchDriver::CreateDispatch](#coledispatchdriver__createdispatch) or [COleDispatchDriver::AttachDispatch](#coledispatchdriver__attachdispatch)."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Implementing the IDispatch Interface<ept id=\"p1\">](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)</ept>.","pos":[6028,6163],"source":" For more information, see [Implementing the IDispatch Interface](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)."},{"pos":[6173,6180],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[6185,6279],"content":"See the example for <bpt id=\"p1\">[</bpt>COleDispatchDriver::CreateDispatch<ept id=\"p1\">](#coledispatchdriver__createdispatch)</ept>.","source":"See the example for [COleDispatchDriver::CreateDispatch](#coledispatchdriver__createdispatch)."},{"pos":[6289,6374],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__createdispatch\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::CreateDispatch","linkify":"<a name=\"coledispatchdriver__createdispatch\"></a>  COleDispatchDriver::CreateDispatch","source":"<a name=\"coledispatchdriver__createdispatch\"></a>  COleDispatchDriver::CreateDispatch"},{"pos":[6378,6539],"content":"Creates an <bpt id=\"p1\">[</bpt>IDispatch<ept id=\"p1\">](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)</ept> interface object and attaches it to the <ph id=\"ph1\">`COleDispatchDriver`</ph> object.","source":"Creates an [IDispatch](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945) interface object and attaches it to the `COleDispatchDriver` object."},{"pos":[6737,6747],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Class ID of the <ph id=\"ph1\">`IDispatch`</ph> connection object to be created.","pos":[6762,6822],"source":" Class ID of the `IDispatch` connection object to be created."},{"content":"Pointer to an OLE exception object, which will hold the status code resulting from the creation.","pos":[6841,6937]},{"content":"Pointer to the programmatic identifier, such as \"Excel.Document.5\", of the automation object for which the dispatch object is to be created.","pos":[6960,7100]},{"pos":[7110,7122],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero on success; otherwise 0.","pos":[7126,7158]},{"pos":[7168,7175],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[7179,7271],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCOleContainer#4<ept id=\"p2\">](../../mfc/codesnippet/cpp/coledispatchdriver-class_2.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCOleContainer#4](../../mfc/codesnippet/cpp/coledispatchdriver-class_2.cpp)]"},{"pos":[7281,7366],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__detachdispatch\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::DetachDispatch","linkify":"<a name=\"coledispatchdriver__detachdispatch\"></a>  COleDispatchDriver::DetachDispatch","source":"<a name=\"coledispatchdriver__detachdispatch\"></a>  COleDispatchDriver::DetachDispatch"},{"pos":[7370,7431],"content":"Detaches the current <ph id=\"ph1\">`IDispatch`</ph> connection from this object.","source":"Detaches the current `IDispatch` connection from this object."},{"pos":[7485,7497],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"pos":[7501,7561],"content":"A pointer to the previously attached OLE <ph id=\"ph1\">`IDispatch`</ph> object.","source":"A pointer to the previously attached OLE `IDispatch` object."},{"pos":[7571,7578],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[7582,7614],"content":"The <ph id=\"ph1\">`IDispatch`</ph> is not released.","source":"The `IDispatch` is not released."},{"pos":[7621,7843],"content":"For more information about the <ph id=\"ph1\">`LPDISPATCH`</ph> type, see <bpt id=\"p1\">[</bpt>Implementing the IDispatch Interface<ept id=\"p1\">](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)</ept> in the <ph id=\"ph2\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information about the `LPDISPATCH` type, see [Implementing the IDispatch Interface](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[7853,7860],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[7864,7956],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCOleContainer#5<ept id=\"p2\">](../../mfc/codesnippet/cpp/coledispatchdriver-class_3.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCOleContainer#5](../../mfc/codesnippet/cpp/coledispatchdriver-class_3.cpp)]"},{"pos":[7966,8045],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__getproperty\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::GetProperty","linkify":"<a name=\"coledispatchdriver__getproperty\"></a>  COleDispatchDriver::GetProperty","source":"<a name=\"coledispatchdriver__getproperty\"></a>  COleDispatchDriver::GetProperty"},{"pos":[8049,8098],"content":"Gets the object property specified by <ph id=\"ph1\">`dwDispID`</ph>.","source":"Gets the object property specified by `dwDispID`."},{"pos":[8214,8224],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Identifies the property to be retrieved.","pos":[8242,8282]},{"content":"Specifies the property to be retrieved.","pos":[8301,8340]},{"content":"For possible values, see the Remarks section for <bpt id=\"p1\">[</bpt>COleDispatchDriver::InvokeHelper<ept id=\"p1\">](#coledispatchdriver__invokehelper)</ept>.","pos":[8341,8460],"source":" For possible values, see the Remarks section for [COleDispatchDriver::InvokeHelper](#coledispatchdriver__invokehelper)."},{"content":"Address of the variable that will receive the property value.","pos":[8479,8540]},{"content":"It must match the type specified by <ph id=\"ph1\">`vtProp`</ph>.","pos":[8541,8586],"source":" It must match the type specified by `vtProp`."},{"pos":[8596,8603],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[8607,8699],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCOleContainer#6<ept id=\"p2\">](../../mfc/codesnippet/cpp/coledispatchdriver-class_4.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCOleContainer#6](../../mfc/codesnippet/cpp/coledispatchdriver-class_4.cpp)]"},{"pos":[8709,8790],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__invokehelper\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::InvokeHelper","linkify":"<a name=\"coledispatchdriver__invokehelper\"></a>  COleDispatchDriver::InvokeHelper","source":"<a name=\"coledispatchdriver__invokehelper\"></a>  COleDispatchDriver::InvokeHelper"},{"pos":[8794,8892],"content":"Calls the object method or property specified by <ph id=\"ph1\">`dwDispID`</ph>, in the context specified by <ph id=\"ph2\">`wFlags`</ph>.","source":"Calls the object method or property specified by `dwDispID`, in the context specified by `wFlags`."},{"pos":[9083,9093],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Identifies the method or property to be invoked.","pos":[9111,9159]},{"content":"Flags describing the context of the call to <bpt id=\"p1\">**</bpt>IDispatch::Invoke<ept id=\"p1\">**</ept>.","pos":[9178,9244],"source":" Flags describing the context of the call to **IDispatch::Invoke**."},{"content":".","pos":[9245,9246]},{"content":"For a list of possible values, see the <ph id=\"ph1\">`wFlags`</ph> parameter in <bpt id=\"p1\">[</bpt>IDispatch::Invoke<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms221479\\(v=vs.85\\).aspx)</ept> in the <ph id=\"ph2\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","pos":[9247,9463],"source":" For a list of possible values, see the `wFlags` parameter in [IDispatch::Invoke](http://msdn.microsoft.com/library/windows/desktop/ms221479\\(v=vs.85\\).aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"content":"Specifies the type of the return value.","pos":[9481,9520]},{"content":"For possible values, see the Remarks section.","pos":[9521,9566]},{"content":"Address of the variable that will receive the property value or return value.","pos":[9584,9661]},{"content":"It must match the type specified by <ph id=\"ph1\">`vtRet`</ph>.","pos":[9662,9706],"source":" It must match the type specified by `vtRet`."},{"content":"Pointer to a null-terminated string of bytes specifying the types of the parameters following <ph id=\"ph1\">`pbParamInfo`</ph>.","pos":[9730,9838],"source":" Pointer to a null-terminated string of bytes specifying the types of the parameters following `pbParamInfo`."},{"content":"<bpt id=\"p1\">*</bpt>...<ept id=\"p1\">*</ept>","pos":[9845,9850],"source":"*...*"},{"content":"Variable list of parameters, of types specified in <ph id=\"ph1\">`pbParamInfo`</ph>.","pos":[9854,9919],"source":" Variable list of parameters, of types specified in `pbParamInfo`."},{"pos":[9929,9936],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The <ph id=\"ph1\">`pbParamInfo`</ph> parameter specifies the types of the parameters passed to the method or property.","pos":[9940,10039],"source":"The `pbParamInfo` parameter specifies the types of the parameters passed to the method or property."},{"content":"The variable list of arguments is represented by <bpt id=\"p1\">**</bpt>...<ept id=\"p1\">**</ept> in the syntax declaration.","pos":[10040,10123],"source":" The variable list of arguments is represented by **...** in the syntax declaration."},{"content":"Possible values for the <ph id=\"ph1\">`vtRet`</ph> argument are taken from the <ph id=\"ph2\">`VARENUM`</ph> enumeration.","pos":[10130,10212],"source":"Possible values for the `vtRet` argument are taken from the `VARENUM` enumeration."},{"content":"Possible values are as follows:","pos":[10213,10244]},{"content":"Symbol","pos":[10251,10257]},{"content":"Return Type","pos":[10258,10269]},{"pos":[10339,10348],"content":"<bpt id=\"p1\">**</bpt>short<ept id=\"p1\">**</ept>","source":"**short**"},{"pos":[10361,10369],"content":"<bpt id=\"p1\">**</bpt>long<ept id=\"p1\">**</ept>","source":"**long**"},{"pos":[10382,10391],"content":"<bpt id=\"p1\">**</bpt>float<ept id=\"p1\">**</ept>","source":"**float**"},{"pos":[10404,10414],"content":"<bpt id=\"p1\">**</bpt>double<ept id=\"p1\">**</ept>","source":"**double**"},{"pos":[10427,10433],"content":"<bpt id=\"p1\">**</bpt>CY<ept id=\"p1\">**</ept>","source":"**CY**"},{"pos":[10448,10456],"content":"<bpt id=\"p1\">**</bpt>DATE<ept id=\"p1\">**</ept>","source":"**DATE**"},{"pos":[10482,10497],"content":"<bpt id=\"p1\">**</bpt>VT_DISPATCH<ept id=\"p1\">**</ept>","source":"**VT_DISPATCH**"},{"pos":[10548,10556],"content":"<bpt id=\"p1\">**</bpt>BOOL<ept id=\"p1\">**</ept>","source":"**BOOL**"},{"pos":[10561,10575],"content":"<bpt id=\"p1\">**</bpt>VT_VARIANT<ept id=\"p1\">**</ept>","source":"**VT_VARIANT**"},{"pos":[10576,10587],"content":"<bpt id=\"p1\">**</bpt>VARIANT<ept id=\"p1\">**</ept>","source":"**VARIANT**"},{"pos":[10592,10606],"content":"<bpt id=\"p1\">**</bpt>VT_UNKNOWN<ept id=\"p1\">**</ept>","source":"**VT_UNKNOWN**"},{"content":"The <ph id=\"ph1\">`pbParamInfo`</ph> argument is a space-separated list of <bpt id=\"p1\">**</bpt>VTS_<ept id=\"p1\">**</ept> constants.","pos":[10626,10701],"source":"The `pbParamInfo` argument is a space-separated list of **VTS_** constants."},{"content":"One or more of these values, separated by spaces (not commas), specifies the function's parameter list.","pos":[10702,10805]},{"content":"Possible values are listed with the <bpt id=\"p1\">[</bpt>EVENT_CUSTOM<ept id=\"p1\">](event-maps.md#event_custom)</ept> macro.","pos":[10806,10891],"source":" Possible values are listed with the [EVENT_CUSTOM](event-maps.md#event_custom) macro."},{"content":"This function converts the parameters to <bpt id=\"p1\">**</bpt>VARIANTARG<ept id=\"p1\">**</ept> values, then invokes the <bpt id=\"p2\">[</bpt>IDispatch::Invoke<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms221479\\(v=vs.85\\).aspx)</ept> method.","pos":[10898,11082],"source":"This function converts the parameters to **VARIANTARG** values, then invokes the [IDispatch::Invoke](http://msdn.microsoft.com/library/windows/desktop/ms221479\\(v=vs.85\\).aspx) method."},{"content":"If the call to <ph id=\"ph1\">`Invoke`</ph> fails, this function will throw an exception.","pos":[11083,11152],"source":" If the call to `Invoke` fails, this function will throw an exception."},{"content":"If the <ph id=\"ph1\">`SCODE`</ph> (status code) returned by <bpt id=\"p1\">**</bpt>IDispatch::Invoke<ept id=\"p1\">**</ept> is <ph id=\"ph2\">`DISP_E_EXCEPTION`</ph>, this function throws a <bpt id=\"p2\">[</bpt>COleException<ept id=\"p2\">](../../mfc/reference/coleexception-class.md)</ept> object; otherwise it throws a <bpt id=\"p3\">[</bpt>COleDispatchException<ept id=\"p3\">](../../mfc/reference/coledispatchexception-class.md)</ept>.","pos":[11153,11428],"source":" If the `SCODE` (status code) returned by **IDispatch::Invoke** is `DISP_E_EXCEPTION`, this function throws a [COleException](../../mfc/reference/coleexception-class.md) object; otherwise it throws a [COleDispatchException](../../mfc/reference/coledispatchexception-class.md)."},{"pos":[11435,11912],"content":"For more information, see <bpt id=\"p1\">[</bpt>VARIANTARG<ept id=\"p1\">](http://msdn.microsoft.com/en-us/e305240e-9e11-4006-98cc-26f4932d2118)</ept>, <bpt id=\"p2\">[</bpt>Implementing the IDispatch Interface<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms221037\\(v=vs.85\\).aspx)</ept>, <bpt id=\"p3\">[</bpt>IDispatch::Invoke<ept id=\"p3\">](http://msdn.microsoft.com/library/windows/desktop/ms221479\\(v=vs.85\\).aspx)</ept>, and <bpt id=\"p4\">[</bpt>Structure of COM Error Codes<ept id=\"p4\">](http://msdn.microsoft.com/library/windows/desktop/ms690088)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [VARIANTARG](http://msdn.microsoft.com/en-us/e305240e-9e11-4006-98cc-26f4932d2118), [Implementing the IDispatch Interface](http://msdn.microsoft.com/library/windows/desktop/ms221037\\(v=vs.85\\).aspx), [IDispatch::Invoke](http://msdn.microsoft.com/library/windows/desktop/ms221479\\(v=vs.85\\).aspx), and [Structure of COM Error Codes](http://msdn.microsoft.com/library/windows/desktop/ms690088) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[11922,11929],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[11934,12028],"content":"See the example for <bpt id=\"p1\">[</bpt>COleDispatchDriver::CreateDispatch<ept id=\"p1\">](#coledispatchdriver__createdispatch)</ept>.","source":"See the example for [COleDispatchDriver::CreateDispatch](#coledispatchdriver__createdispatch)."},{"pos":[12038,12123],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__m_bautorelease\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::m_bAutoRelease","linkify":"<a name=\"coledispatchdriver__m_bautorelease\"></a>  COleDispatchDriver::m_bAutoRelease","source":"<a name=\"coledispatchdriver__m_bautorelease\"></a>  COleDispatchDriver::m_bAutoRelease"},{"pos":[12127,12373],"content":"If <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the COM object accessed by <bpt id=\"p2\">[</bpt>m_lpDispatch<ept id=\"p2\">](#coledispatchdriver__m_lpdispatch)</ept> will be automatically released when <bpt id=\"p3\">[</bpt>ReleaseDispatch<ept id=\"p3\">](#coledispatchdriver__releasedispatch)</ept> is called or when this <ph id=\"ph1\">`COleDispatchDriver`</ph> object is destroyed.","source":"If **TRUE**, the COM object accessed by [m_lpDispatch](#coledispatchdriver__m_lpdispatch) will be automatically released when [ReleaseDispatch](#coledispatchdriver__releasedispatch) is called or when this `COleDispatchDriver` object is destroyed."},{"pos":[12421,12428],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[12432,12499],"content":"By default, <ph id=\"ph1\">`m_bAutoRelease`</ph> is set to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> in the constructor.","source":"By default, `m_bAutoRelease` is set to **TRUE** in the constructor."},{"pos":[12506,12794],"content":"For more information on releasing COM objects, see <bpt id=\"p1\">[</bpt>Implementing Reference Counting<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms693431)</ept> and <bpt id=\"p2\">[</bpt>IUnknown::Release<ept id=\"p2\">](http://msdn.microsoft.com/library/windows/desktop/ms682317)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information on releasing COM objects, see [Implementing Reference Counting](http://msdn.microsoft.com/library/windows/desktop/ms693431) and [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[12804,12811],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[12815,12907],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCOleContainer#9<ept id=\"p2\">](../../mfc/codesnippet/cpp/coledispatchdriver-class_5.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCOleContainer#9](../../mfc/codesnippet/cpp/coledispatchdriver-class_5.cpp)]"},{"pos":[12917,12998],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__m_lpdispatch\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::m_lpDispatch","linkify":"<a name=\"coledispatchdriver__m_lpdispatch\"></a>  COleDispatchDriver::m_lpDispatch","source":"<a name=\"coledispatchdriver__m_lpdispatch\"></a>  COleDispatchDriver::m_lpDispatch"},{"pos":[13002,13081],"content":"The pointer to the <ph id=\"ph1\">`IDispatch`</ph> interface attached to this <ph id=\"ph2\">`COleDispatchDriver`</ph>.","source":"The pointer to the `IDispatch` interface attached to this `COleDispatchDriver`."},{"pos":[13133,13140],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[13144,13217],"content":"The <ph id=\"ph1\">`m_lpDispatch`</ph> data member is a public variable of type <ph id=\"ph2\">`LPDISPATCH`</ph>.","source":"The `m_lpDispatch` data member is a public variable of type `LPDISPATCH`."},{"pos":[13224,13391],"content":"For more information, see <bpt id=\"p1\">[</bpt>IDispatch<ept id=\"p1\">](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"For more information, see [IDispatch](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[13401,13408],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[13413,13507],"content":"See the example for <bpt id=\"p1\">[</bpt>COleDispatchDriver::AttachDispatch<ept id=\"p1\">](#coledispatchdriver__attachdispatch)</ept>.","source":"See the example for [COleDispatchDriver::AttachDispatch](#coledispatchdriver__attachdispatch)."},{"pos":[13517,13596],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__operator__eq\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::operator =","linkify":"<a name=\"coledispatchdriver__operator__eq\"></a>  COleDispatchDriver::operator =","source":"<a name=\"coledispatchdriver__operator__eq\"></a>  COleDispatchDriver::operator ="},{"pos":[13600,13661],"content":"Copies the source value into the <ph id=\"ph1\">`COleDispatchDriver`</ph> object.","source":"Copies the source value into the `COleDispatchDriver` object."},{"pos":[13762,13772],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to an existing <ph id=\"ph1\">`COleDispatchDriver`</ph> object.","pos":[13793,13846],"source":" A pointer to an existing `COleDispatchDriver` object."},{"pos":[13856,13951],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__operator_lpdispatch\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::operator LPDISPATCH","linkify":"<a name=\"coledispatchdriver__operator_lpdispatch\"></a>  COleDispatchDriver::operator LPDISPATCH","source":"<a name=\"coledispatchdriver__operator_lpdispatch\"></a>  COleDispatchDriver::operator LPDISPATCH"},{"pos":[13955,14034],"content":"Accesses the underlying <ph id=\"ph1\">`IDispatch`</ph> pointer of the <ph id=\"ph2\">`COleDispatchDriver`</ph> object.","source":"Accesses the underlying `IDispatch` pointer of the `COleDispatchDriver` object."},{"pos":[14083,14090],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[14094,14186],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCOleContainer#8<ept id=\"p2\">](../../mfc/codesnippet/cpp/coledispatchdriver-class_6.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCOleContainer#8](../../mfc/codesnippet/cpp/coledispatchdriver-class_6.cpp)]"},{"pos":[14196,14283],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__releasedispatch\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::ReleaseDispatch","linkify":"<a name=\"coledispatchdriver__releasedispatch\"></a>  COleDispatchDriver::ReleaseDispatch","source":"<a name=\"coledispatchdriver__releasedispatch\"></a>  COleDispatchDriver::ReleaseDispatch"},{"content":"Releases the <ph id=\"ph1\">`IDispatch`</ph> connection.","pos":[14287,14323],"source":"Releases the `IDispatch` connection."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Implementing the IDispatch Interface<ept id=\"p1\">](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)</ept>","pos":[14324,14458],"source":" For more information, see [Implementing the IDispatch Interface](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)"},{"pos":[14507,14514],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[14518,14642],"content":"If auto release has been set for this connection, this function calls <bpt id=\"p1\">**</bpt>IDispatch::Release<ept id=\"p1\">**</ept> before releasing the interface.","source":"If auto release has been set for this connection, this function calls **IDispatch::Release** before releasing the interface."},{"pos":[14652,14659],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[14664,14758],"content":"See the example for <bpt id=\"p1\">[</bpt>COleDispatchDriver::AttachDispatch<ept id=\"p1\">](#coledispatchdriver__attachdispatch)</ept>.","source":"See the example for [COleDispatchDriver::AttachDispatch](#coledispatchdriver__attachdispatch)."},{"pos":[14768,14847],"content":"<bpt id=\"p1\">&lt;a name=\"coledispatchdriver__setproperty\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  COleDispatchDriver::SetProperty","linkify":"<a name=\"coledispatchdriver__setproperty\"></a>  COleDispatchDriver::SetProperty","source":"<a name=\"coledispatchdriver__setproperty\"></a>  COleDispatchDriver::SetProperty"},{"pos":[14851,14904],"content":"Sets the OLE object property specified by <ph id=\"ph1\">`dwDispID`</ph>.","source":"Sets the OLE object property specified by `dwDispID`."},{"pos":[15006,15016],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Identifies the property to be set.","pos":[15034,15068]},{"content":"Specifies the type of the property to be set.","pos":[15087,15132]},{"content":"For possible values, see the Remarks section for <bpt id=\"p1\">[</bpt>COleDispatchDriver::InvokeHelper<ept id=\"p1\">](#coledispatchdriver__invokehelper)</ept>.","pos":[15133,15252],"source":" For possible values, see the Remarks section for [COleDispatchDriver::InvokeHelper](#coledispatchdriver__invokehelper)."},{"content":"<bpt id=\"p1\">*</bpt>...<ept id=\"p1\">*</ept>","pos":[15259,15264],"source":"*...*"},{"content":"A single parameter of the type specified by <ph id=\"ph1\">`vtProp`</ph>.","pos":[15268,15321],"source":" A single parameter of the type specified by `vtProp`."},{"pos":[15331,15338],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[15342,15434],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCOleContainer#7<ept id=\"p2\">](../../mfc/codesnippet/cpp/coledispatchdriver-class_7.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCOleContainer#7](../../mfc/codesnippet/cpp/coledispatchdriver-class_7.cpp)]"},{"pos":[15443,15451],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>MFC Sample CALCDRIV<ept id=\"p1\">](../../visual-cpp-samples.md)</ept><ph id=\"ph1\"> </ph>","pos":[15455,15506],"source":"[MFC Sample CALCDRIV](../../visual-cpp-samples.md) "},{"content":"<bpt id=\"p1\"> [</bpt>MFC Sample ACDUAL<ept id=\"p1\">](../../visual-cpp-samples.md)</ept><ph id=\"ph1\"> </ph>","pos":[15509,15559],"source":" [MFC Sample ACDUAL](../../visual-cpp-samples.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[15562,15611],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CCmdTarget Class<ept id=\"p1\">](../../mfc/reference/ccmdtarget-class.md)</ept>","pos":[15614,15674],"source":" [CCmdTarget Class](../../mfc/reference/ccmdtarget-class.md)"}],"content":"---\ntitle: \"COleDispatchDriver Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"COleDispatchDriver\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"COleDispatchDriver class\"\n  - \"Automation clients, implementing Automation\"\n  - \"OLE dispatch interface\"\nms.assetid: 3ed98daf-cdc7-4374-8a0c-cf695a8d3657\ncaps.latest.revision: 21\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# COleDispatchDriver Class\nImplements the client side of OLE automation.  \n  \n## Syntax  \n  \n```  \nclass COleDispatchDriver  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDispatchDriver::COleDispatchDriver](#coledispatchdriver__coledispatchdriver)|Constructs a `COleDispatchDriver` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDispatchDriver::AttachDispatch](#coledispatchdriver__attachdispatch)|Attaches an `IDispatch` connection to the `COleDispatchDriver` object.|  \n|[COleDispatchDriver::CreateDispatch](#coledispatchdriver__createdispatch)|Creates an `IDispatch` connection and attaches it to the `COleDispatchDriver` object.|  \n|[COleDispatchDriver::DetachDispatch](#coledispatchdriver__detachdispatch)|Detaches an `IDispatch` connection, without releasing it.|  \n|[COleDispatchDriver::GetProperty](#coledispatchdriver__getproperty)|Gets an automation property.|  \n|[COleDispatchDriver::InvokeHelper](#coledispatchdriver__invokehelper)|Helper for calling automation methods.|  \n|[COleDispatchDriver::ReleaseDispatch](#coledispatchdriver__releasedispatch)|Releases an `IDispatch` connection.|  \n|[COleDispatchDriver::SetProperty](#coledispatchdriver__setproperty)|Sets an automation property.|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDispatchDriver::operator =](#coledispatchdriver__operator__eq)|Copies the source value into the `COleDispatchDriver` object.|  \n|[COleDispatchDriver::operator LPDISPATCH](#coledispatchdriver__operator_lpdispatch)|Accesses the underlying `IDispatch` pointer.|  \n  \n### Public Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[COleDispatchDriver::m_bAutoRelease](#coledispatchdriver__m_bautorelease)|Specifies whether to release the `IDispatch` during `ReleaseDispatch` or object destruction.|  \n|[COleDispatchDriver::m_lpDispatch](#coledispatchdriver__m_lpdispatch)|Indicates the pointer to the `IDispatch` interface attached to this `COleDispatchDriver`.|  \n  \n## Remarks  \n `COleDispatchDriver` does not have a base class.  \n  \n OLE dispatch interfaces provide access to an object's methods and properties. Member functions of `COleDispatchDriver` attach, detach, create, and release a dispatch connection of type `IDispatch`. Other member functions use variable argument lists to simplify calling **IDispatch::Invoke**.  \n  \n This class can be used directly, but it is generally used only by classes created by the Add Class wizard. When you create new C++ classes by importing a type library, the new classes are derived from `COleDispatchDriver`.  \n  \n For more information on using `COleDispatchDriver`, see the following articles:  \n  \n- [Automation Clients](../../mfc/automation-clients.md)  \n  \n- [Automation Servers](../../mfc/automation-servers.md)  \n  \n## Inheritance Hierarchy  \n `COleDispatchDriver`  \n  \n## Requirements  \n **Header:** afxdisp.h  \n  \n##  <a name=\"coledispatchdriver__attachdispatch\"></a>  COleDispatchDriver::AttachDispatch  \n Call the `AttachDispatch` member function to attach an `IDispatch` pointer to the `COleDispatchDriver` object. For more information, see [Implementing the IDispatch Interface](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945).  \n  \n```  \nvoid AttachDispatch(\n        LPDISPATCH lpDispatch,  \n        BOOL bAutoRelease = TRUE);\n```  \n  \n### Parameters  \n `lpDispatch`  \n Pointer to an OLE `IDispatch` object to be attached to the `COleDispatchDriver` object.  \n  \n `bAutoRelease`  \n Specifies whether the dispatch is to be released when this object goes out of scope.  \n  \n### Remarks  \n This function releases any `IDispatch` pointer that is already attached to the `COleDispatchDriver` object.  \n  \n### Example  \n [!code-cpp[NVC_MFCOleContainer#3](../../mfc/codesnippet/cpp/coledispatchdriver-class_1.cpp)]  \n  \n##  <a name=\"coledispatchdriver__coledispatchdriver\"></a>  COleDispatchDriver::COleDispatchDriver  \n Constructs a `COleDispatchDriver` object.  \n  \n```  \nCOleDispatchDriver();\n\n \nCOleDispatchDriver(LPDISPATCH lpDispatch, BOOL bAutoRelease = TRUE);\n\n \nCOleDispatchDriver(const COleDispatchDriver& dispatchSrc);\n```  \n  \n### Parameters  \n `lpDispatch`  \n Pointer to an OLE `IDispatch` object to be attached to the `COleDispatchDriver` object.  \n  \n `bAutoRelease`  \n Specifies whether the dispatch is to be released when this object goes out of scope.  \n  \n `dispatchSrc`  \n Reference to an existing `COleDispatchDriver` object.  \n  \n### Remarks  \n The form `COleDispatchDriver`( `LPDISPATCH``lpDispatch`, **BOOL**`bAutoRelease` = **TRUE**) connects the [IDispatch](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945) interface.  \n  \n The form `COleDispatchDriver`( **const**`COleDispatchDriver`& `dispatchSrc`) copies an existing `COleDispatchDriver` object and increments the reference count.  \n  \n The form `COleDispatchDriver`( ) creates a `COleDispatchDriver` object but does not connect the `IDispatch` interface. Before using `COleDispatchDriver`( ) without arguments, you should connect an `IDispatch` to it using either [COleDispatchDriver::CreateDispatch](#coledispatchdriver__createdispatch) or [COleDispatchDriver::AttachDispatch](#coledispatchdriver__attachdispatch). For more information, see [Implementing the IDispatch Interface](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945).  \n  \n### Example  \n  See the example for [COleDispatchDriver::CreateDispatch](#coledispatchdriver__createdispatch).  \n  \n##  <a name=\"coledispatchdriver__createdispatch\"></a>  COleDispatchDriver::CreateDispatch  \n Creates an [IDispatch](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945) interface object and attaches it to the `COleDispatchDriver` object.  \n  \n```  \n \nBOOL CreateDispatch(\n        REFCLSID clsid,  \n        COleException* pError = NULL);\n\n \nBOOL CreateDispatch(\n    LPCTSTR lpszProgID,  \n    COleException* pError = NULL);\n```  \n  \n### Parameters  \n `clsid`  \n Class ID of the `IDispatch` connection object to be created.  \n  \n `pError`  \n Pointer to an OLE exception object, which will hold the status code resulting from the creation.  \n  \n `lpszProgID`  \n Pointer to the programmatic identifier, such as \"Excel.Document.5\", of the automation object for which the dispatch object is to be created.  \n  \n### Return Value  \n Nonzero on success; otherwise 0.  \n  \n### Example  \n [!code-cpp[NVC_MFCOleContainer#4](../../mfc/codesnippet/cpp/coledispatchdriver-class_2.cpp)]  \n  \n##  <a name=\"coledispatchdriver__detachdispatch\"></a>  COleDispatchDriver::DetachDispatch  \n Detaches the current `IDispatch` connection from this object.  \n  \n```  \nLPDISPATCH DetachDispatch();\n```  \n  \n### Return Value  \n A pointer to the previously attached OLE `IDispatch` object.  \n  \n### Remarks  \n The `IDispatch` is not released.  \n  \n For more information about the `LPDISPATCH` type, see [Implementing the IDispatch Interface](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n [!code-cpp[NVC_MFCOleContainer#5](../../mfc/codesnippet/cpp/coledispatchdriver-class_3.cpp)]  \n  \n##  <a name=\"coledispatchdriver__getproperty\"></a>  COleDispatchDriver::GetProperty  \n Gets the object property specified by `dwDispID`.  \n  \n```  \nvoid GetProperty(\n    DISPID dwDispID,  \n    VARTYPE vtProp,  \n    void* pvProp) const;\n\n \n```  \n  \n### Parameters  \n `dwDispID`  \n Identifies the property to be retrieved.  \n  \n `vtProp`  \n Specifies the property to be retrieved. For possible values, see the Remarks section for [COleDispatchDriver::InvokeHelper](#coledispatchdriver__invokehelper).  \n  \n `pvProp`  \n Address of the variable that will receive the property value. It must match the type specified by `vtProp`.  \n  \n### Example  \n [!code-cpp[NVC_MFCOleContainer#6](../../mfc/codesnippet/cpp/coledispatchdriver-class_4.cpp)]  \n  \n##  <a name=\"coledispatchdriver__invokehelper\"></a>  COleDispatchDriver::InvokeHelper  \n Calls the object method or property specified by `dwDispID`, in the context specified by `wFlags`.  \n  \n```  \nvoid AFX_CDECL InvokeHelper(\n        DISPID dwDispID,  \n        WORD wFlags,  \n        VARTYPE vtRet,  \n        void* pvRet,  \n        const BYTE* pbParamInfo, ...);\n```  \n  \n### Parameters  \n `dwDispID`  \n Identifies the method or property to be invoked.  \n  \n `wFlags`  \n Flags describing the context of the call to **IDispatch::Invoke**. . For a list of possible values, see the `wFlags` parameter in [IDispatch::Invoke](http://msdn.microsoft.com/library/windows/desktop/ms221479\\(v=vs.85\\).aspx) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n `vtRet`  \n Specifies the type of the return value. For possible values, see the Remarks section.  \n  \n `pvRet`  \n Address of the variable that will receive the property value or return value. It must match the type specified by `vtRet`.  \n  \n `pbParamInfo`  \n Pointer to a null-terminated string of bytes specifying the types of the parameters following `pbParamInfo`.  \n  \n *...*  \n Variable list of parameters, of types specified in `pbParamInfo`.  \n  \n### Remarks  \n The `pbParamInfo` parameter specifies the types of the parameters passed to the method or property. The variable list of arguments is represented by **...** in the syntax declaration.  \n  \n Possible values for the `vtRet` argument are taken from the `VARENUM` enumeration. Possible values are as follows:  \n  \n|Symbol|Return Type|  \n|------------|-----------------|  \n|`VT_EMPTY`|`void`|  \n|`VT_I2`|**short**|  \n|`VT_I4`|**long**|  \n|`VT_R4`|**float**|  \n|`VT_R8`|**double**|  \n|`VT_CY`|**CY**|  \n|`VT_DATE`|**DATE**|  \n|`VT_BSTR`|`BSTR`|  \n|**VT_DISPATCH**|`LPDISPATCH`|  \n|`VT_ERROR`|`SCODE`|  \n|`VT_BOOL`|**BOOL**|  \n|**VT_VARIANT**|**VARIANT**|  \n|**VT_UNKNOWN**|`LPUNKNOWN`|  \n  \n The `pbParamInfo` argument is a space-separated list of **VTS_** constants. One or more of these values, separated by spaces (not commas), specifies the function's parameter list. Possible values are listed with the [EVENT_CUSTOM](event-maps.md#event_custom) macro.  \n  \n This function converts the parameters to **VARIANTARG** values, then invokes the [IDispatch::Invoke](http://msdn.microsoft.com/library/windows/desktop/ms221479\\(v=vs.85\\).aspx) method. If the call to `Invoke` fails, this function will throw an exception. If the `SCODE` (status code) returned by **IDispatch::Invoke** is `DISP_E_EXCEPTION`, this function throws a [COleException](../../mfc/reference/coleexception-class.md) object; otherwise it throws a [COleDispatchException](../../mfc/reference/coledispatchexception-class.md).  \n  \n For more information, see [VARIANTARG](http://msdn.microsoft.com/en-us/e305240e-9e11-4006-98cc-26f4932d2118), [Implementing the IDispatch Interface](http://msdn.microsoft.com/library/windows/desktop/ms221037\\(v=vs.85\\).aspx), [IDispatch::Invoke](http://msdn.microsoft.com/library/windows/desktop/ms221479\\(v=vs.85\\).aspx), and [Structure of COM Error Codes](http://msdn.microsoft.com/library/windows/desktop/ms690088) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n  See the example for [COleDispatchDriver::CreateDispatch](#coledispatchdriver__createdispatch).  \n  \n##  <a name=\"coledispatchdriver__m_bautorelease\"></a>  COleDispatchDriver::m_bAutoRelease  \n If **TRUE**, the COM object accessed by [m_lpDispatch](#coledispatchdriver__m_lpdispatch) will be automatically released when [ReleaseDispatch](#coledispatchdriver__releasedispatch) is called or when this `COleDispatchDriver` object is destroyed.  \n  \n```  \nBOOL m_bAutoRelease;  \n```  \n  \n### Remarks  \n By default, `m_bAutoRelease` is set to **TRUE** in the constructor.  \n  \n For more information on releasing COM objects, see [Implementing Reference Counting](http://msdn.microsoft.com/library/windows/desktop/ms693431) and [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n [!code-cpp[NVC_MFCOleContainer#9](../../mfc/codesnippet/cpp/coledispatchdriver-class_5.cpp)]  \n  \n##  <a name=\"coledispatchdriver__m_lpdispatch\"></a>  COleDispatchDriver::m_lpDispatch  \n The pointer to the `IDispatch` interface attached to this `COleDispatchDriver`.  \n  \n```  \nLPDISPATCH m_lpDispatch;  \n```  \n  \n### Remarks  \n The `m_lpDispatch` data member is a public variable of type `LPDISPATCH`.  \n  \n For more information, see [IDispatch](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n### Example  \n  See the example for [COleDispatchDriver::AttachDispatch](#coledispatchdriver__attachdispatch).  \n  \n##  <a name=\"coledispatchdriver__operator__eq\"></a>  COleDispatchDriver::operator =  \n Copies the source value into the `COleDispatchDriver` object.  \n  \n```  \nconst COleDispatchDriver& operator=(const COleDispatchDriver& dispatchSrc);\n```  \n  \n### Parameters  \n `dispatchSrc`  \n A pointer to an existing `COleDispatchDriver` object.  \n  \n##  <a name=\"coledispatchdriver__operator_lpdispatch\"></a>  COleDispatchDriver::operator LPDISPATCH  \n Accesses the underlying `IDispatch` pointer of the `COleDispatchDriver` object.  \n  \n```  \noperator LPDISPATCH();\n```   \n  \n### Example  \n [!code-cpp[NVC_MFCOleContainer#8](../../mfc/codesnippet/cpp/coledispatchdriver-class_6.cpp)]  \n  \n##  <a name=\"coledispatchdriver__releasedispatch\"></a>  COleDispatchDriver::ReleaseDispatch  \n Releases the `IDispatch` connection. For more information, see [Implementing the IDispatch Interface](http://msdn.microsoft.com/en-us/0e171f7f-0022-4e9b-ac8e-98192828e945)  \n  \n```  \nvoid ReleaseDispatch();\n```  \n  \n### Remarks  \n If auto release has been set for this connection, this function calls **IDispatch::Release** before releasing the interface.  \n  \n### Example  \n  See the example for [COleDispatchDriver::AttachDispatch](#coledispatchdriver__attachdispatch).  \n  \n##  <a name=\"coledispatchdriver__setproperty\"></a>  COleDispatchDriver::SetProperty  \n Sets the OLE object property specified by `dwDispID`.  \n  \n```  \nvoid AFX_CDECL SetProperty(\n    DISPID dwDispID,  \n    VARTYPE vtProp, ...);\n```  \n  \n### Parameters  \n `dwDispID`  \n Identifies the property to be set.  \n  \n `vtProp`  \n Specifies the type of the property to be set. For possible values, see the Remarks section for [COleDispatchDriver::InvokeHelper](#coledispatchdriver__invokehelper).  \n  \n *...*  \n A single parameter of the type specified by `vtProp`.  \n  \n### Example  \n [!code-cpp[NVC_MFCOleContainer#7](../../mfc/codesnippet/cpp/coledispatchdriver-class_7.cpp)]  \n  \n## See Also  \n [MFC Sample CALCDRIV](../../visual-cpp-samples.md)   \n [MFC Sample ACDUAL](../../visual-cpp-samples.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CCmdTarget Class](../../mfc/reference/ccmdtarget-class.md)\n"}