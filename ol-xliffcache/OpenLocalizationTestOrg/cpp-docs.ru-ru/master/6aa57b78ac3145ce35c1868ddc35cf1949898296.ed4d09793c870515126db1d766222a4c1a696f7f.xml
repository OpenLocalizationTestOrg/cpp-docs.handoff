{"nodes":[{"pos":[12,70],"content":"SimpleClassFactory::CreateInstance Method | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"SimpleClassFactory::CreateInstance Method | Microsoft Docs","pos":[0,58]}]},{"content":"SimpleClassFactory::CreateInstance Method","pos":[706,747]},{"content":"Creates an instance of the specified interface.","pos":[748,795]},{"content":"Syntax","pos":[804,810]},{"content":"Parameters","pos":[971,981]},{"content":"Must be <ph id=\"ph1\">`nullptr`</ph>; otherwise, the return value is CLASS_E_NOAGGREGATION.","pos":[1000,1072],"source":" Must be `nullptr`; otherwise, the return value is CLASS_E_NOAGGREGATION."},{"content":"SimpleClassFactory doesn't support aggregation.","pos":[1079,1126]},{"content":"If aggregation were supported and the object being created was part of an aggregate, <ph id=\"ph1\">`pUnkOuter`</ph> would be a pointer to the controlling IUnknown interface of the aggregate.","pos":[1127,1298],"source":" If aggregation were supported and the object being created was part of an aggregate, `pUnkOuter` would be a pointer to the controlling IUnknown interface of the aggregate."},{"content":"Interface ID of the object to create.","pos":[1315,1352]},{"content":"When this operation completes, pointer to an instance of the object specified by the <ph id=\"ph1\">`riid`</ph> parameter.","pos":[1374,1476],"source":" When this operation completes, pointer to an instance of the object specified by the `riid` parameter."},{"content":"Return Value","pos":[1485,1497]},{"content":"S_OK if successful; otherwise, an HRESULT that indicates the error.","pos":[1501,1568]},{"content":"Remarks","pos":[1577,1584]},{"pos":[1588,1919],"content":"If __WRL_STRICT<ph id=\"ph1\">\\_\\_</ph> is defined, an assert error is emitted if the base class specified in the class template parameter isn't derived from <bpt id=\"p1\">[</bpt>RuntimeClass<ept id=\"p1\">](../windows/runtimeclass-class.md)</ept>, or isn't configured with the ClassicCom or WinRtClassicComMix <bpt id=\"p2\">[</bpt>RuntimeClassType<ept id=\"p2\">](../windows/runtimeclasstype-enumeration.md)</ept> enumeration value.","source":"If __WRL_STRICT\\_\\_ is defined, an assert error is emitted if the base class specified in the class template parameter isn't derived from [RuntimeClass](../windows/runtimeclass-class.md), or isn't configured with the ClassicCom or WinRtClassicComMix [RuntimeClassType](../windows/runtimeclasstype-enumeration.md) enumeration value."},{"content":"Requirements","pos":[1928,1940]},{"pos":[1944,1964],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> module.h","source":"**Header:** module.h"},{"pos":[1971,2000],"content":"<bpt id=\"p1\">**</bpt>Namespace:<ept id=\"p1\">**</ept> Microsoft::WRL","source":"**Namespace:** Microsoft::WRL"},{"content":"See Also","pos":[2009,2017]},{"content":"SimpleClassFactory Class","pos":[2022,2046]}],"content":"---\ntitle: \"SimpleClassFactory::CreateInstance Method | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"module/Microsoft::WRL::SimpleClassFactory::CreateInstance\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CreateInstance method\"\nms.assetid: 17b7947a-2608-49d9-b730-fef76501c9bc\ncaps.latest.revision: 3\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# SimpleClassFactory::CreateInstance Method\nCreates an instance of the specified interface.  \n  \n## Syntax  \n  \n```  \n  \nSTDMETHOD(  \n   CreateInstance  \n)  \n   (_Inout_opt_ IUnknown* pUnkOuter,   \n   REFIID riid,   \n   _Deref_out_ void** ppvObject);  \n```  \n  \n#### Parameters  \n `pUnkOuter`  \n Must be `nullptr`; otherwise, the return value is CLASS_E_NOAGGREGATION.  \n  \n SimpleClassFactory doesn't support aggregation. If aggregation were supported and the object being created was part of an aggregate, `pUnkOuter` would be a pointer to the controlling IUnknown interface of the aggregate.  \n  \n `riid`  \n Interface ID of the object to create.  \n  \n `ppvObject`  \n When this operation completes, pointer to an instance of the object specified by the `riid` parameter.  \n  \n## Return Value  \n S_OK if successful; otherwise, an HRESULT that indicates the error.  \n  \n## Remarks  \n If __WRL_STRICT\\_\\_ is defined, an assert error is emitted if the base class specified in the class template parameter isn't derived from [RuntimeClass](../windows/runtimeclass-class.md), or isn't configured with the ClassicCom or WinRtClassicComMix [RuntimeClassType](../windows/runtimeclasstype-enumeration.md) enumeration value.  \n  \n## Requirements  \n **Header:** module.h  \n  \n **Namespace:** Microsoft::WRL  \n  \n## See Also  \n [SimpleClassFactory Class](../windows/simpleclassfactory-class.md)"}