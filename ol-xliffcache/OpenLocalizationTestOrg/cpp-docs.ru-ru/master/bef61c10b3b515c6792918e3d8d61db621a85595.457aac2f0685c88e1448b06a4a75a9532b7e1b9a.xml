{"nodes":[{"pos":[12,55],"content":"Creating a Simple Consumer | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Creating a Simple Consumer | Microsoft Docs","pos":[0,43]}]},{"content":"Creating a Simple Consumer","pos":[590,616]},{"content":"Use the ATL Project Wizard and ATL OLE DB Consumer Wizard to generate an OLE DB Templates consumer.","pos":[617,716]},{"content":"To create a console application for an OLE DB consumer","pos":[727,781]},{"pos":[791,855],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"On the **File** menu, click **New**, and then click **Project**."},{"pos":[866,905],"content":"The <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box appears.","source":"The **New Project** dialog box appears."},{"content":"In the Project Types pane, click the <bpt id=\"p1\">**</bpt>Visual C++ Projects<ept id=\"p1\">**</ept> folder, and then click the <bpt id=\"p2\">**</bpt>Win32 Project<ept id=\"p2\">**</ept> icon in the Templates pane.","pos":[915,1048],"source":"In the Project Types pane, click the **Visual C++ Projects** folder, and then click the **Win32 Project** icon in the Templates pane."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, enter the name of your project, for example, <bpt id=\"p2\">**</bpt>MyCons<ept id=\"p2\">**</ept>.","pos":[1049,1126],"source":" In the **Name** box, enter the name of your project, for example, **MyCons**."},{"pos":[1136,1149],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"The Win32 Project Wizard appears.","pos":[1160,1193]},{"pos":[1203,1313],"content":"On the <bpt id=\"p1\">**</bpt>Application Settings<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Console application<ept id=\"p2\">**</ept>, and then select <bpt id=\"p3\">**</bpt>Add support for ATL<ept id=\"p3\">**</ept>.","source":"On the **Application Settings** page, select **Console application**, and then select **Add support for ATL**."},{"pos":[1323,1385],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to close the wizard and generate the project.","source":"Click **Finish** to close the wizard and generate the project."},{"content":"Next, use the ATL OLE DB Consumer Wizard to add an OLE DB consumer object.","pos":[1392,1466]},{"content":"To create a consumer with the ATL OLE DB Consumer Wizard","pos":[1477,1533]},{"pos":[1543,1591],"content":"In Class View, right-click the <ph id=\"ph1\">`MyCons`</ph> project.","source":"In Class View, right-click the `MyCons` project."},{"pos":[1601,1667],"content":"On the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Add Class<ept id=\"p2\">**</ept>.","source":"On the shortcut menu, click **Add**, and then click **Add Class**."},{"pos":[1678,1715],"content":"The <bpt id=\"p1\">**</bpt>Add Class<ept id=\"p1\">**</ept> dialog box appears.","source":"The **Add Class** dialog box appears."},{"pos":[1725,1857],"content":"In the Categories pane, click <bpt id=\"p1\">**</bpt>Visual C++<ept id=\"p1\">**</ept>, click the <bpt id=\"p2\">**</bpt>ATL OLE DB Consumer<ept id=\"p2\">**</ept> icon in the Templates pane, and then click <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept>.","source":"In the Categories pane, click **Visual C++**, click the **ATL OLE DB Consumer** icon in the Templates pane, and then click **Open**."},{"content":"The ATL OLE DB Consumer Wizard appears.","pos":[1868,1907]},{"pos":[1917,1950],"content":"Click the <bpt id=\"p1\">**</bpt>Data Source<ept id=\"p1\">**</ept> button.","source":"Click the **Data Source** button."},{"pos":[1961,2009],"content":"The <bpt id=\"p1\">**</bpt>Data Link Properties<ept id=\"p1\">**</ept> dialog box appears.","source":"The **Data Link Properties** dialog box appears."},{"pos":[2019,2080],"content":"In the <bpt id=\"p1\">**</bpt>Data Link Properties<ept id=\"p1\">**</ept> dialog box, do the following:","source":"In the **Data Link Properties** dialog box, do the following:"},{"pos":[2094,2146],"content":"On the <bpt id=\"p1\">**</bpt>Provider<ept id=\"p1\">**</ept> tab, specify an OLE DB provider.","source":"On the **Provider** tab, specify an OLE DB provider."},{"pos":[2160,2283],"content":"On the <bpt id=\"p1\">**</bpt>Connection<ept id=\"p1\">**</ept> tab, specify the server name, logon ID, and password for your data source and database on the server.","source":"On the **Connection** tab, specify the server name, logon ID, and password for your data source and database on the server."},{"pos":[2295,2590],"content":"[!NOTE]\n There is a security issue with the **Allow saving of password** feature of the **Data Link Properties** dialog box. In **Enter information to log on to the server**, there are two radio buttons: **Use Windows NT integrated security** and **Use a specific user name and password**.","leadings":["","    > "],"nodes":[{"content":" There is a security issue with the **Allow saving of password** feature of the **Data Link Properties** dialog box. In **Enter information to log on to the server**, there are two radio buttons: **Use Windows NT integrated security** and **Use a specific user name and password**.","pos":[8,289],"nodes":[{"content":"There is a security issue with the <bpt id=\"p1\">**</bpt>Allow saving of password<ept id=\"p1\">**</ept> feature of the <bpt id=\"p2\">**</bpt>Data Link Properties<ept id=\"p2\">**</ept> dialog box.","pos":[1,116],"source":" There is a security issue with the **Allow saving of password** feature of the **Data Link Properties** dialog box."},{"content":"In <bpt id=\"p1\">**</bpt>Enter information to log on to the server<ept id=\"p1\">**</ept>, there are two radio buttons: <bpt id=\"p2\">**</bpt>Use Windows NT integrated security<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Use a specific user name and password<ept id=\"p3\">**</ept>.","pos":[117,281],"source":" In **Enter information to log on to the server**, there are two radio buttons: **Use Windows NT integrated security** and **Use a specific user name and password**."}]}]},{"pos":[2602,2928],"content":"[!NOTE]\n If you select **Use a specific user name and password**, you have the option of saving the password (using the **Allow saving password** check box); however, this option is not secure. It is recommended that you select **Use Windows NT integrated security**; this option uses Windows NT to verify your identity.","leadings":["","    > "],"nodes":[{"content":" If you select **Use a specific user name and password**, you have the option of saving the password (using the **Allow saving password** check box); however, this option is not secure. It is recommended that you select **Use Windows NT integrated security**; this option uses Windows NT to verify your identity.","pos":[8,320],"nodes":[{"content":"If you select <bpt id=\"p1\">**</bpt>Use a specific user name and password<ept id=\"p1\">**</ept>, you have the option of saving the password (using the <bpt id=\"p2\">**</bpt>Allow saving password<ept id=\"p2\">**</ept> check box); however, this option is not secure.","pos":[1,185],"source":" If you select **Use a specific user name and password**, you have the option of saving the password (using the **Allow saving password** check box); however, this option is not secure."},{"content":"It is recommended that you select <bpt id=\"p1\">**</bpt>Use Windows NT integrated security<ept id=\"p1\">**</ept>; this option uses Windows NT to verify your identity.","pos":[186,312],"source":" It is recommended that you select **Use Windows NT integrated security**; this option uses Windows NT to verify your identity."}]}]},{"pos":[2940,3193],"content":"[!NOTE]\n If you cannot use Windows NT integrated security, you should use a middle-tier application to prompt the user for the password or to store the password in a location with security mechanisms to help protect it (instead of in source code).","leadings":["","    > "],"nodes":[{"content":"If you cannot use Windows NT integrated security, you should use a middle-tier application to prompt the user for the password or to store the password in a location with security mechanisms to help protect it (instead of in source code).","pos":[9,247]}]},{"content":"After selecting your provider and other settings, click <bpt id=\"p1\">**</bpt>Test Connection<ept id=\"p1\">**</ept> to verify the selections made on the previous dialog box pages.","pos":[3204,3343],"source":"After selecting your provider and other settings, click **Test Connection** to verify the selections made on the previous dialog box pages."},{"content":"If the <bpt id=\"p1\">**</bpt>Results<ept id=\"p1\">**</ept> box reports <ph id=\"ph1\">`Test connection succeeded`</ph>, click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept> to create the data link.","pos":[3344,3441],"source":" If the **Results** box reports `Test connection succeeded`, click **OK** to create the data link."},{"pos":[3452,3502],"content":"The <bpt id=\"p1\">**</bpt>Select Database Object<ept id=\"p1\">**</ept> dialog box appears.","source":"The **Select Database Object** dialog box appears."},{"content":"Use the tree control to select a table, view, or stored procedure.","pos":[3512,3578]},{"content":"For the purpose of this procedure, select the Products table from the Northwind database.","pos":[3579,3668]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[3678,3691],"source":"Click **OK**."},{"content":"This returns you to the ATL OLE DB Consumer Wizard.","pos":[3692,3743]},{"content":"The wizard completes the names for <ph id=\"ph1\">`Class`</ph> and <bpt id=\"p1\">**</bpt>.h file<ept id=\"p1\">**</ept> based on the name of the table, view, or stored procedure that you selected.","pos":[3753,3888],"source":"The wizard completes the names for `Class` and **.h file** based on the name of the table, view, or stored procedure that you selected."},{"content":"You can edit these names if you want.","pos":[3889,3926]},{"pos":[3935,4201],"content":"Clear the <bpt id=\"p1\">**</bpt>Attributed<ept id=\"p1\">**</ept> check box so that the wizard creates the consumer code using <bpt id=\"p2\">[</bpt>OLE DB Template classes<ept id=\"p2\">](../../data/oledb/ole-db-consumer-templates-reference.md)</ept> instead of the default <bpt id=\"p3\">[</bpt>OLE DB consumer attributes<ept id=\"p3\">](../../windows/ole-db-consumer-attributes.md)</ept>.","source":"Clear the **Attributed** check box so that the wizard creates the consumer code using [OLE DB Template classes](../../data/oledb/ole-db-consumer-templates-reference.md) instead of the default [OLE DB consumer attributes](../../windows/ole-db-consumer-attributes.md)."},{"pos":[4211,4246],"content":"Under <bpt id=\"p1\">**</bpt>Type<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Command<ept id=\"p2\">**</ept>.","source":"Under **Type**, select **Command**."},{"content":"The wizard creates a <bpt id=\"p1\">[</bpt>CCommand<ept id=\"p1\">](../../data/oledb/ccommand-class.md)</ept>-based consumer if you select <bpt id=\"p2\">**</bpt>Command<ept id=\"p2\">**</ept> or a <bpt id=\"p3\">[</bpt>CTable<ept id=\"p3\">](../../data/oledb/ctable-class.md)</ept>-based consumer if you select <bpt id=\"p4\">**</bpt>Table<ept id=\"p4\">**</ept>.","pos":[4257,4453],"source":"The wizard creates a [CCommand](../../data/oledb/ccommand-class.md)-based consumer if you select **Command** or a [CTable](../../data/oledb/ctable-class.md)-based consumer if you select **Table**."},{"content":"The table or command class is named after the selected object, but you can edit the name.","pos":[4454,4543]},{"pos":[4553,4635],"content":"Under <bpt id=\"p1\">**</bpt>Support<ept id=\"p1\">**</ept>, leave the <bpt id=\"p2\">**</bpt>Change<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Insert<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>Delete<ept id=\"p4\">**</ept> boxes cleared.","source":"Under **Support**, leave the **Change**, **Insert**, and **Delete** boxes cleared."},{"content":"Select the <bpt id=\"p1\">**</bpt>Change<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Insert<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Delete<ept id=\"p3\">**</ept> check boxes to support the changing, inserting, and deleting of records in the rowset, if required.","pos":[4646,4795],"source":"Select the **Change**, **Insert**, and **Delete** check boxes to support the changing, inserting, and deleting of records in the rowset, if required."},{"content":"For more information about writing data to the data store, see <bpt id=\"p1\">[</bpt>Updating Rowsets<ept id=\"p1\">](../../data/oledb/updating-rowsets.md)</ept>.","pos":[4796,4916],"source":" For more information about writing data to the data store, see [Updating Rowsets](../../data/oledb/updating-rowsets.md)."},{"pos":[4926,4966],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to create the consumer.","source":"Click **Finish** to create the consumer."},{"content":"The wizard generates a command class and a user record class, as shown in <bpt id=\"p1\">[</bpt>Consumer Wizard-Generated Classes<ept id=\"p1\">](../../data/oledb/consumer-wizard-generated-classes.md)</ept>.","pos":[4973,5138],"source":"The wizard generates a command class and a user record class, as shown in [Consumer Wizard-Generated Classes](../../data/oledb/consumer-wizard-generated-classes.md)."},{"content":"The command class will have the name that you entered in the <ph id=\"ph1\">`Class`</ph> box in the wizard (in this case, <ph id=\"ph2\">`CProducts`</ph>), and the user record class will have a name of the form \"<bpt id=\"p1\">*</bpt>ClassName<ept id=\"p1\">*</ept>Accessor\" (in this case, <ph id=\"ph3\">`CProductsAccessor`</ph>).","pos":[5139,5368],"source":" The command class will have the name that you entered in the `Class` box in the wizard (in this case, `CProducts`), and the user record class will have a name of the form \"*ClassName*Accessor\" (in this case, `CProductsAccessor`)."},{"pos":[5376,5438],"content":"[!NOTE]\n The wizard puts the following line into Products.h:","leadings":["","> "],"nodes":[{"content":"The wizard puts the following line into Products.h:","pos":[9,60]}]},{"pos":[5531,5747],"content":"[!NOTE]\n This line prevents the consumer application from compiling and reminds you to check your connection string for hard-coded passwords. After checking your connection string, you can remove this line of code.","leadings":["","> "],"nodes":[{"content":" This line prevents the consumer application from compiling and reminds you to check your connection string for hard-coded passwords. After checking your connection string, you can remove this line of code.","pos":[8,214],"nodes":[{"content":"This line prevents the consumer application from compiling and reminds you to check your connection string for hard-coded passwords.","pos":[1,133]},{"content":"After checking your connection string, you can remove this line of code.","pos":[134,206]}]}]},{"content":"See Also","pos":[5756,5764]},{"content":"Creating an OLE DB Consumer Using a Wizard","pos":[5769,5811]}],"content":"---\ntitle: \"Creating a Simple Consumer | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"OLE DB consumers, creating\"\nms.assetid: ae32d657-72ea-4db8-9839-75cb5cff68ae\ncaps.latest.revision: 7\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Creating a Simple Consumer\nUse the ATL Project Wizard and ATL OLE DB Consumer Wizard to generate an OLE DB Templates consumer.  \n  \n#### To create a console application for an OLE DB consumer  \n  \n1.  On the **File** menu, click **New**, and then click **Project**.  \n  \n     The **New Project** dialog box appears.  \n  \n2.  In the Project Types pane, click the **Visual C++ Projects** folder, and then click the **Win32 Project** icon in the Templates pane. In the **Name** box, enter the name of your project, for example, **MyCons**.  \n  \n3.  Click **OK**.  \n  \n     The Win32 Project Wizard appears.  \n  \n4.  On the **Application Settings** page, select **Console application**, and then select **Add support for ATL**.  \n  \n5.  Click **Finish** to close the wizard and generate the project.  \n  \n Next, use the ATL OLE DB Consumer Wizard to add an OLE DB consumer object.  \n  \n#### To create a consumer with the ATL OLE DB Consumer Wizard  \n  \n1.  In Class View, right-click the `MyCons` project.  \n  \n2.  On the shortcut menu, click **Add**, and then click **Add Class**.  \n  \n     The **Add Class** dialog box appears.  \n  \n3.  In the Categories pane, click **Visual C++**, click the **ATL OLE DB Consumer** icon in the Templates pane, and then click **Open**.  \n  \n     The ATL OLE DB Consumer Wizard appears.  \n  \n4.  Click the **Data Source** button.  \n  \n     The **Data Link Properties** dialog box appears.  \n  \n5.  In the **Data Link Properties** dialog box, do the following:  \n  \n    -   On the **Provider** tab, specify an OLE DB provider.  \n  \n    -   On the **Connection** tab, specify the server name, logon ID, and password for your data source and database on the server.  \n  \n    > [!NOTE]\n    >  There is a security issue with the **Allow saving of password** feature of the **Data Link Properties** dialog box. In **Enter information to log on to the server**, there are two radio buttons: **Use Windows NT integrated security** and **Use a specific user name and password**.  \n  \n    > [!NOTE]\n    >  If you select **Use a specific user name and password**, you have the option of saving the password (using the **Allow saving password** check box); however, this option is not secure. It is recommended that you select **Use Windows NT integrated security**; this option uses Windows NT to verify your identity.  \n  \n    > [!NOTE]\n    >  If you cannot use Windows NT integrated security, you should use a middle-tier application to prompt the user for the password or to store the password in a location with security mechanisms to help protect it (instead of in source code).  \n  \n     After selecting your provider and other settings, click **Test Connection** to verify the selections made on the previous dialog box pages. If the **Results** box reports `Test connection succeeded`, click **OK** to create the data link.  \n  \n     The **Select Database Object** dialog box appears.  \n  \n6.  Use the tree control to select a table, view, or stored procedure. For the purpose of this procedure, select the Products table from the Northwind database.  \n  \n7.  Click **OK**. This returns you to the ATL OLE DB Consumer Wizard.  \n  \n8.  The wizard completes the names for `Class` and **.h file** based on the name of the table, view, or stored procedure that you selected. You can edit these names if you want.  \n  \n9. Clear the **Attributed** check box so that the wizard creates the consumer code using [OLE DB Template classes](../../data/oledb/ole-db-consumer-templates-reference.md) instead of the default [OLE DB consumer attributes](../../windows/ole-db-consumer-attributes.md).  \n  \n10. Under **Type**, select **Command**.  \n  \n     The wizard creates a [CCommand](../../data/oledb/ccommand-class.md)-based consumer if you select **Command** or a [CTable](../../data/oledb/ctable-class.md)-based consumer if you select **Table**. The table or command class is named after the selected object, but you can edit the name.  \n  \n11. Under **Support**, leave the **Change**, **Insert**, and **Delete** boxes cleared.  \n  \n     Select the **Change**, **Insert**, and **Delete** check boxes to support the changing, inserting, and deleting of records in the rowset, if required. For more information about writing data to the data store, see [Updating Rowsets](../../data/oledb/updating-rowsets.md).  \n  \n12. Click **Finish** to create the consumer.  \n  \n The wizard generates a command class and a user record class, as shown in [Consumer Wizard-Generated Classes](../../data/oledb/consumer-wizard-generated-classes.md). The command class will have the name that you entered in the `Class` box in the wizard (in this case, `CProducts`), and the user record class will have a name of the form \"*ClassName*Accessor\" (in this case, `CProductsAccessor`).  \n  \n> [!NOTE]\n>  The wizard puts the following line into Products.h:  \n  \n```  \n#error Security Issue: The connection string may contain a password  \n```  \n  \n> [!NOTE]\n>  This line prevents the consumer application from compiling and reminds you to check your connection string for hard-coded passwords. After checking your connection string, you can remove this line of code.  \n  \n## See Also  \n [Creating an OLE DB Consumer Using a Wizard](../../data/oledb/creating-an-ole-db-consumer-using-a-wizard.md)"}