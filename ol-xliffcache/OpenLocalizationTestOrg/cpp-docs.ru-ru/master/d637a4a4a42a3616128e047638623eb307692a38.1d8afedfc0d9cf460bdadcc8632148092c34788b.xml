{"nodes":[{"pos":[12,69],"content":"Recordset: Requerying a Recordset (ODBC) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Recordset: Requerying a Recordset (ODBC) | Microsoft Docs","pos":[0,57]}]},{"content":"Recordset: Requerying a Recordset (ODBC)","pos":[711,751]},{"content":"This topic applies to the MFC ODBC classes.","pos":[752,795]},{"pos":[802,1043],"content":"This topic explains how you can use a recordset object to requery (that is, refresh) itself from the database and when you might want to do that with the <bpt id=\"p1\">[</bpt>Requery<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__requery)</ept> member function.","source":"This topic explains how you can use a recordset object to requery (that is, refresh) itself from the database and when you might want to do that with the [Requery](../../mfc/reference/crecordset-class.md#crecordset__requery) member function."},{"content":"The principal reasons for requerying a recordset are to:","pos":[1050,1106]},{"content":"Bring the recordset up to date with respect to records added by you or by other users and records deleted by other users (those you delete are already reflected in the recordset).","pos":[1116,1295]},{"content":"Refresh the recordset based on changing parameter values.","pos":[1305,1362]},{"pos":[1427,1460],"content":"Bringing the Recordset Up to Date"},{"content":"Frequently, you will want to requery your recordset object to bring it up to date.","pos":[1464,1546]},{"content":"In a multiuser database environment, other users can make changes to the data during the life of your recordset.","pos":[1547,1659]},{"content":"For more information about when your recordset reflects changes made by other users and when other users' recordsets reflect your changes, see <bpt id=\"p1\">[</bpt>Recordset: How Recordsets Update Records (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)</ept> and <bpt id=\"p2\">[</bpt>Dynaset<ept id=\"p2\">](../../data/odbc/dynaset.md)</ept>.","pos":[1660,1960],"source":" For more information about when your recordset reflects changes made by other users and when other users' recordsets reflect your changes, see [Recordset: How Recordsets Update Records (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md) and [Dynaset](../../data/odbc/dynaset.md)."},{"pos":[2026,2060],"content":"Requerying Based on New Parameters"},{"pos":[2064,2254],"content":"Another frequent — and equally important — use of <bpt id=\"p1\">[</bpt>Requery<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__requery)</ept> is to select a new set of records based on changing parameter values.","source":"Another frequent — and equally important — use of [Requery](../../mfc/reference/crecordset-class.md#crecordset__requery) is to select a new set of records based on changing parameter values."},{"pos":[2262,2404],"content":"[!TIP]\n Query speed is probably significantly faster if you call **Requery** with changing parameter values than if you call **Open** again.","leadings":["","> "],"nodes":[{"content":"Query speed is probably significantly faster if you call <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> with changing parameter values than if you call <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> again.","pos":[8,140],"source":" Query speed is probably significantly faster if you call **Requery** with changing parameter values than if you call **Open** again."}]},{"pos":[2470,2503],"content":"Requerying Dynasets vs. Snapshots"},{"content":"Because dynasets are meant to present a set of records with dynamic up-to-date data, you want to requery dynasets often if you want to reflect other users' additions.","pos":[2507,2673]},{"content":"Snapshots, on the other hand, are useful because you can safely rely on their static contents while you prepare reports, calculate totals, and so on.","pos":[2674,2823]},{"content":"Still, you might sometimes want to requery a snapshot as well.","pos":[2824,2886]},{"content":"In a multiuser environment, snapshot data might lose synchronization with the data source as other users change the database.","pos":[2887,3012]},{"content":"To requery a recordset object","pos":[3023,3052]},{"pos":[3062,3172],"content":"Call the <bpt id=\"p1\">[</bpt>Requery<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__requery)</ept> member function of the object.","source":"Call the [Requery](../../mfc/reference/crecordset-class.md#crecordset__requery) member function of the object."},{"content":"Alternatively, you can close and reopen the original recordset.","pos":[3179,3242]},{"content":"In either case, the new recordset represents the current state of the data source.","pos":[3243,3325]},{"pos":[3332,3485],"content":"For an example, see <bpt id=\"p1\">[</bpt>Record Views: Filling a List Box from a Second Recordset<ept id=\"p1\">](../../data/filling-a-list-box-from-a-second-recordset-mfc-data-access.md)</ept>.","source":"For an example, see [Record Views: Filling a List Box from a Second Recordset](../../data/filling-a-list-box-from-a-second-recordset-mfc-data-access.md)."},{"pos":[3493,3754],"content":"[!TIP]\n To optimize **Requery** performance, avoid changing the recordset's [filter](../../data/odbc/recordset-filtering-records-odbc.md) or [sort](../../data/odbc/recordset-sorting-records-odbc.md). Change only the parameter value before calling **Requery**.","leadings":["","> "],"nodes":[{"content":" To optimize **Requery** performance, avoid changing the recordset's [filter](../../data/odbc/recordset-filtering-records-odbc.md) or [sort](../../data/odbc/recordset-sorting-records-odbc.md). Change only the parameter value before calling **Requery**.","pos":[7,259],"nodes":[{"content":"To optimize <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> performance, avoid changing the recordset's <bpt id=\"p2\">[</bpt>filter<ept id=\"p2\">](../../data/odbc/recordset-filtering-records-odbc.md)</ept> or <bpt id=\"p3\">[</bpt>sort<ept id=\"p3\">](../../data/odbc/recordset-sorting-records-odbc.md)</ept>.","pos":[1,192],"source":" To optimize **Requery** performance, avoid changing the recordset's [filter](../../data/odbc/recordset-filtering-records-odbc.md) or [sort](../../data/odbc/recordset-sorting-records-odbc.md)."},{"content":"Change only the parameter value before calling <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept>.","pos":[193,252],"source":" Change only the parameter value before calling **Requery**."}]}]},{"content":"If the <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> call fails, you can retry the call; otherwise, your application should terminate gracefully.","pos":[3761,3872],"source":"If the **Requery** call fails, you can retry the call; otherwise, your application should terminate gracefully."},{"content":"A call to <bpt id=\"p1\">**</bpt>Requery<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> might fail for any of a number of reasons.","pos":[3873,3949],"source":" A call to **Requery** or **Open** might fail for any of a number of reasons."},{"content":"Perhaps a network error occurs; or, during the call, after the existing data is released but before the new data is obtained, another user might get exclusive access; or the table on which your recordset depends could be deleted.","pos":[3950,4179]},{"content":"See Also","pos":[4188,4196]},{"content":"Recordset (ODBC)","pos":[4201,4217]},{"content":"Recordset: Dynamically Binding Data Columns (ODBC)","pos":[4259,4309]},{"content":"Recordset: Creating and Closing Recordsets (ODBC)","pos":[4384,4433]}],"content":"---\ntitle: \"Recordset: Requerying a Recordset (ODBC) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"recordsets, requerying\"\n  - \"requerying recordsets\"\n  - \"Requery method\"\n  - \"ODBC recordsets, requerying\"\n  - \"refreshing recordsets\"\nms.assetid: 4ebc3b5b-5b91-4f51-a967-245223c6b8e1\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Recordset: Requerying a Recordset (ODBC)\nThis topic applies to the MFC ODBC classes.  \n  \n This topic explains how you can use a recordset object to requery (that is, refresh) itself from the database and when you might want to do that with the [Requery](../../mfc/reference/crecordset-class.md#crecordset__requery) member function.  \n  \n The principal reasons for requerying a recordset are to:  \n  \n-   Bring the recordset up to date with respect to records added by you or by other users and records deleted by other users (those you delete are already reflected in the recordset).  \n  \n-   Refresh the recordset based on changing parameter values.  \n  \n##  <a name=\"_core_bringing_the_recordset_up_to_date\"></a> Bringing the Recordset Up to Date  \n Frequently, you will want to requery your recordset object to bring it up to date. In a multiuser database environment, other users can make changes to the data during the life of your recordset. For more information about when your recordset reflects changes made by other users and when other users' recordsets reflect your changes, see [Recordset: How Recordsets Update Records (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md) and [Dynaset](../../data/odbc/dynaset.md).  \n  \n##  <a name=\"_core_requerying_based_on_new_parameters\"></a> Requerying Based on New Parameters  \n Another frequent — and equally important — use of [Requery](../../mfc/reference/crecordset-class.md#crecordset__requery) is to select a new set of records based on changing parameter values.  \n  \n> [!TIP]\n>  Query speed is probably significantly faster if you call **Requery** with changing parameter values than if you call **Open** again.  \n  \n##  <a name=\"_core_requerying_dynasets_vs.._snapshots\"></a> Requerying Dynasets vs. Snapshots  \n Because dynasets are meant to present a set of records with dynamic up-to-date data, you want to requery dynasets often if you want to reflect other users' additions. Snapshots, on the other hand, are useful because you can safely rely on their static contents while you prepare reports, calculate totals, and so on. Still, you might sometimes want to requery a snapshot as well. In a multiuser environment, snapshot data might lose synchronization with the data source as other users change the database.  \n  \n#### To requery a recordset object  \n  \n1.  Call the [Requery](../../mfc/reference/crecordset-class.md#crecordset__requery) member function of the object.  \n  \n Alternatively, you can close and reopen the original recordset. In either case, the new recordset represents the current state of the data source.  \n  \n For an example, see [Record Views: Filling a List Box from a Second Recordset](../../data/filling-a-list-box-from-a-second-recordset-mfc-data-access.md).  \n  \n> [!TIP]\n>  To optimize **Requery** performance, avoid changing the recordset's [filter](../../data/odbc/recordset-filtering-records-odbc.md) or [sort](../../data/odbc/recordset-sorting-records-odbc.md). Change only the parameter value before calling **Requery**.  \n  \n If the **Requery** call fails, you can retry the call; otherwise, your application should terminate gracefully. A call to **Requery** or **Open** might fail for any of a number of reasons. Perhaps a network error occurs; or, during the call, after the existing data is released but before the new data is obtained, another user might get exclusive access; or the table on which your recordset depends could be deleted.  \n  \n## See Also  \n [Recordset (ODBC)](../../data/odbc/recordset-odbc.md)   \n [Recordset: Dynamically Binding Data Columns (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)   \n [Recordset: Creating and Closing Recordsets (ODBC)](../../data/odbc/recordset-creating-and-closing-recordsets-odbc.md)"}