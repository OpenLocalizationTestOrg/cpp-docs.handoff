{"nodes":[{"pos":[12,73],"content":"Attribute Targets (C++ Component Extensions) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Attribute Targets (C++ Component Extensions) | Microsoft Docs","pos":[0,61]}]},{"content":"Attribute Targets (C++ Component Extensions)","pos":[619,663]},{"content":"Attribute usage specifiers let you specify attribute targets.","pos":[664,725]},{"content":"Each attribute is defined to apply to certain language elements.","pos":[727,791]},{"content":"For example, an attribute might be defined to apply only to classes and structs.","pos":[792,872]},{"content":"The following list shows the possible syntactic elements on which a custom attribute can be used.","pos":[874,971]},{"content":"Combinations of these values (using logical or) may be used.","pos":[972,1032]},{"content":"To specify attribute target, to pass one or more &lt;xref:System.AttributeTargets&gt; enumerators to &lt;xref:System.AttributeUsageAttribute&gt; when defining the attribute.","pos":[1039,1200],"source":"To specify attribute target, to pass one or more <xref:System.AttributeTargets> enumerators to <xref:System.AttributeUsageAttribute> when defining the attribute."},{"content":"The following is a list of the valid attribute targets:","pos":[1207,1262]},{"pos":[1278,1305],"content":"(applies to all constructs)"},{"pos":[1501,1536],"content":"(applies to an assembly as a whole)"},{"pos":[1735,1767],"content":"(applies to a module as a whole)"},{"content":"Typically, an attribute directly precedes the language element to which it applies.","pos":[5185,5268]},{"content":"In some cases, however, the position of an attribute is not sufficient to determine the attribute's intended target.","pos":[5269,5385]},{"content":"Consider this example:","pos":[5386,5408]},{"content":"Syntactically, there is no way to tell if the attribute is intended to apply to the method or to the method's return value (in this case, it defaults to the method).","pos":[5461,5626]},{"content":"In such cases, an attribute usage specifier may be used.","pos":[5627,5683]},{"content":"For example, to make the attribute apply to the return value, use the <ph id=\"ph1\">`returnvalue`</ph> specifier, as follows:","pos":[5684,5790],"source":" For example, to make the attribute apply to the return value, use the `returnvalue` specifier, as follows:"},{"content":"Attribute usage specifiers are required in the following situations:","pos":[5882,5950]},{"content":"To specify an assembly- or module-level attribute.","pos":[5960,6010]},{"content":"To specify that an attribute applies to a method's return value, not the method:","pos":[6020,6100]},{"content":"To specify that an attribute applies to a property's accessor, not the property:","pos":[6348,6428]},{"content":"To specify that an attribute applies to an event's accessor, not the event:","pos":[6635,6710]},{"content":"An attribute usage specifier applies only to the attribute that immediately follows it; that is,","pos":[6985,7081]},{"content":"is different from","pos":[7132,7149]},{"content":"Example","pos":[7214,7221]},{"content":"Description","pos":[7231,7242]},{"content":"This sample shows how to specify multiple targets.","pos":[7246,7296]},{"content":"Code","pos":[7306,7310]},{"content":"See Also","pos":[7626,7634]},{"content":"User-Defined Attributes","pos":[7639,7662]}],"content":"---\ntitle: \"Attribute Targets (C++ Component Extensions) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"language-reference\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"custom attributes, targets\"\nms.assetid: b4e6e224-da77-4520-b6e6-b96846e0ebc1\ncaps.latest.revision: 6\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Attribute Targets (C++ Component Extensions)\nAttribute usage specifiers let you specify attribute targets.  Each attribute is defined to apply to certain language elements. For example, an attribute might be defined to apply only to classes and structs.  The following list shows the possible syntactic elements on which a custom attribute can be used. Combinations of these values (using logical or) may be used.  \n  \n To specify attribute target, to pass one or more <xref:System.AttributeTargets> enumerators to <xref:System.AttributeUsageAttribute> when defining the attribute.  \n  \n The following is a list of the valid attribute targets:  \n  \n-   `All` (applies to all constructs)  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::All)]  \n    ref class Attr : public Attribute {};  \n  \n    [assembly:Attr];  \n  \n    ```  \n  \n-   `Assembly` (applies to an assembly as a whole)  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Assembly)]  \n    ref class Attr : public Attribute {};  \n  \n    [assembly:Attr];  \n  \n    ```  \n  \n-   `Module` (applies to a module as a whole)  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Module)]  \n    ref class Attr : public Attribute {};  \n  \n    [module:Attr];  \n  \n    ```  \n  \n-   `Class`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Class)]  \n    ref class Attr : public System::Attribute {};  \n  \n    [Attr]   // same as [class:Attr]  \n    ref class MyClass {};  \n  \n    ```  \n  \n-   `Struct`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Struct)]  \n    ref class Attr : public Attribute {};  \n  \n    [Attr]   // same as [struct:Attr]  \n    value struct MyStruct{};  \n  \n    ```  \n  \n-   `enum`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Enum)]  \n    ref class Attr : public Attribute {};  \n  \n    [Attr]   // same as [enum:Attr]  \n    enum struct MyEnum{e, d};  \n  \n    ```  \n  \n-   `Constructor`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Constructor)]  \n    ref class Attr : public Attribute {};  \n  \n    ref struct MyStruct{  \n    [Attr] MyStruct(){}   // same as [constructor:Attr]  \n    };  \n  \n    ```  \n  \n-   `Method`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Method)]  \n    ref class Attr : public Attribute {};  \n  \n    ref struct MyStruct{  \n    [Attr] void Test(){}   // same as [method:Attr]  \n    };  \n  \n    ```  \n  \n-   `Property`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Property)]  \n    ref class Attr : public Attribute {};  \n  \n    ref struct MyStruct{  \n    [Attr] property int Test;   // same as [property:Attr]  \n    };  \n  \n    ```  \n  \n-   `Field`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Field)]  \n    ref class Attr : public Attribute {};  \n  \n    ref struct MyStruct{  \n    [Attr] int Test;   // same as [field:Attr]  \n    };  \n  \n    ```  \n  \n-   `Event`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Event)]  \n    ref class Attr : public Attribute {};  \n  \n    delegate void ClickEventHandler(int, double);  \n  \n    ref struct MyStruct{  \n    [Attr] event ClickEventHandler^ OnClick;   // same as [event:Attr]  \n    };  \n  \n    ```  \n  \n-   `Interface`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Interface)]  \n    ref class Attr : public Attribute {};  \n  \n    [Attr]   // same as [event:Attr]  \n    interface struct MyStruct{};  \n  \n    ```  \n  \n-   `Parameter`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Parameter)]  \n    ref class Attr : public Attribute {};  \n  \n    ref struct MyStruct{  \n    void Test([Attr] int i);  \n    void Test2([parameter:Attr] int i);  \n    };  \n  \n    ```  \n  \n-   `Delegate`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::Delegate)]  \n    ref class Attr : public Attribute {};  \n  \n    [Attr] delegate void Test();  \n    [delegate:Attr] delegate void Test2();  \n  \n    ```  \n  \n-   `ReturnValue`  \n  \n    ```  \n  \n    using namespace System;  \n    [AttributeUsage(AttributeTargets::ReturnValue)]  \n    ref class Attr : public Attribute {};  \n  \n    ref struct MyStruct {  \n    // Note required specifier  \n    [returnvalue:Attr] int Test() { return 0; }  \n    };  \n  \n    ```  \n  \n Typically, an attribute directly precedes the language element to which it applies. In some cases, however, the position of an attribute is not sufficient to determine the attribute's intended target. Consider this example:  \n  \n```  \n[Attr] int MyFn(double x)...  \n```  \n  \n Syntactically, there is no way to tell if the attribute is intended to apply to the method or to the method's return value (in this case, it defaults to the method). In such cases, an attribute usage specifier may be used. For example, to make the attribute apply to the return value, use the `returnvalue` specifier, as follows:  \n  \n```  \n[returnvalue:Attr] int MyFn(double x)... // applies to return value  \n```  \n  \n Attribute usage specifiers are required in the following situations:  \n  \n-   To specify an assembly- or module-level attribute.  \n  \n-   To specify that an attribute applies to a method's return value, not the method:  \n  \n    ```  \n    [method:Attr] int MyFn(double x)...     // Attr applies to method  \n    [returnvalue:Attr] int MyFn(double x)...// Attr applies to return value  \n    [Attr] int MyFn(double x)...            // default: method  \n    ```  \n  \n-   To specify that an attribute applies to a property's accessor, not the property:  \n  \n    ```  \n    [method:MyAttr(123)] property int Property()    \n    [property:MyAttr(123)] property int Property()  \n    [MyAttr(123)] property int get_MyPropy() // default: property  \n    ```  \n  \n-   To specify that an attribute applies to an event's accessor, not the event:  \n  \n    ```  \n    delegate void MyDel();  \n    ref struct X {  \n       [field:MyAttr(123)] event MyDel* MyEvent;   //field  \n       [event:MyAttr(123)] event MyDel* MyEvent;   //event  \n       [MyAttr(123)] event MyDel* MyEvent;   // default: event  \n    }  \n    ```  \n  \n An attribute usage specifier applies only to the attribute that immediately follows it; that is,  \n  \n```  \n[returnvalue:Attr1, Attr2]  \n```  \n  \n is different from  \n  \n```  \n[returnvalue:Attr1, returnvalue:Attr2]  \n```  \n  \n## Example  \n  \n### Description  \n This sample shows how to specify multiple targets.  \n  \n### Code  \n  \n```  \n  \nusing namespace System;  \n[AttributeUsage(AttributeTargets::Class | AttributeTargets::Struct, AllowMultiple = true )]  \nref struct Attr : public Attribute {  \n   Attr(bool i){}  \n   Attr(){}  \n};  \n  \n[Attr]  \nref class MyClass {};  \n  \n[Attr]  \n[Attr(true)]  \nvalue struct MyStruct {};  \n```  \n  \n## See Also  \n [User-Defined Attributes](../windows/user-defined-attributes-cpp-component-extensions.md)"}