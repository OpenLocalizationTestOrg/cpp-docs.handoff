{"nodes":[{"pos":[12,51],"content":"CInternetSession Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CInternetSession Class | Microsoft Docs","pos":[0,39]}]},{"pos":[646,668],"content":"CInternetSession Class","linkify":"CInternetSession Class","nodes":[{"content":"CInternetSession Class","pos":[0,22]}]},{"content":"Creates and initializes a single or several simultaneous Internet sessions and, if necessary, describes your connection to a proxy server.","pos":[669,807]},{"pos":[816,822],"content":"Syntax","linkify":"Syntax","nodes":[{"content":"Syntax","pos":[0,6]}]},{"pos":[888,895],"content":"Members","linkify":"Members","nodes":[{"content":"Members","pos":[0,7]}]},{"pos":[905,924],"content":"Public Constructors","linkify":"Public Constructors","nodes":[{"content":"Public Constructors","pos":[0,19]}]},{"content":"Name","pos":[931,935]},{"content":"Description","pos":[936,947]},{"pos":[985,1058],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::CInternetSession<ept id=\"p1\">](#cinternetsession__cinternetsession)</ept>","source":"[CInternetSession::CInternetSession](#cinternetsession__cinternetsession)"},{"pos":[1059,1098],"content":"Constructs a <ph id=\"ph1\">`CInternetSession`</ph> object.","source":"Constructs a `CInternetSession` object."},{"pos":[1109,1123],"content":"Public Methods","linkify":"Public Methods","nodes":[{"content":"Public Methods","pos":[0,14]}]},{"content":"Name","pos":[1130,1134]},{"content":"Description","pos":[1135,1146]},{"pos":[1184,1235],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::Close<ept id=\"p1\">](#cinternetsession__close)</ept>","source":"[CInternetSession::Close](#cinternetsession__close)"},{"content":"Closes the Internet connection when the Internet session is terminated.","pos":[1236,1307]},{"pos":[1312,1393],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::EnableStatusCallback<ept id=\"p1\">](#cinternetsession__enablestatuscallback)</ept>","source":"[CInternetSession::EnableStatusCallback](#cinternetsession__enablestatuscallback)"},{"content":"Establishes a status callback routine.","pos":[1394,1432]},{"pos":[1437,1498],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::GetContext<ept id=\"p1\">](#cinternetsession__getcontext)</ept>","source":"[CInternetSession::GetContext](#cinternetsession__getcontext)"},{"content":"Closes the Internet connection when the Internet session is terminated.","pos":[1499,1570]},{"pos":[1575,1634],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::GetCookie<ept id=\"p1\">](#cinternetsession__getcookie)</ept>","source":"[CInternetSession::GetCookie](#cinternetsession__getcookie)"},{"content":"Returns cookies for the specified URL and all its parent URLs.","pos":[1635,1697]},{"pos":[1702,1773],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::GetCookieLength<ept id=\"p1\">](#cinternetsession__getcookielength)</ept>","source":"[CInternetSession::GetCookieLength](#cinternetsession__getcookielength)"},{"content":"Retrieves the variable specifying the length of the cookie stored in the buffer.","pos":[1774,1854]},{"pos":[1859,1932],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::GetFtpConnection<ept id=\"p1\">](#cinternetsession__getftpconnection)</ept>","source":"[CInternetSession::GetFtpConnection](#cinternetsession__getftpconnection)"},{"content":"Opens an FTP session with a server.","pos":[1933,1968]},{"content":"Logs on the user.","pos":[1969,1986]},{"pos":[1991,2070],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::GetGopherConnection<ept id=\"p1\">](#cinternetsession__getgopherconnection)</ept>","source":"[CInternetSession::GetGopherConnection](#cinternetsession__getgopherconnection)"},{"content":"Opens a gopher server for an application that is trying to open a connection.","pos":[2071,2148]},{"pos":[2153,2228],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::GetHttpConnection<ept id=\"p1\">](#cinternetsession__gethttpconnection)</ept>","source":"[CInternetSession::GetHttpConnection](#cinternetsession__gethttpconnection)"},{"content":"Opens an HTTP server for an application that is trying to open a connection.","pos":[2229,2305]},{"pos":[2310,2383],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](#cinternetsession__onstatuscallback)</ept>","source":"[CInternetSession::OnStatusCallback](#cinternetsession__onstatuscallback)"},{"content":"Updates the status of an operation when status callback is enabled.","pos":[2384,2451]},{"pos":[2456,2511],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::OpenURL<ept id=\"p1\">](#cinternetsession__openurl)</ept>","source":"[CInternetSession::OpenURL](#cinternetsession__openurl)"},{"content":"Parses and opens a URL.","pos":[2512,2535]},{"pos":[2540,2599],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::SetCookie<ept id=\"p1\">](#cinternetsession__setcookie)</ept>","source":"[CInternetSession::SetCookie](#cinternetsession__setcookie)"},{"content":"Sets a cookie for the specified URL.","pos":[2600,2636]},{"pos":[2641,2700],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::SetOption<ept id=\"p1\">](#cinternetsession__setoption)</ept>","source":"[CInternetSession::SetOption](#cinternetsession__setoption)"},{"content":"Sets options for the Internet session.","pos":[2701,2739]},{"pos":[2750,2766],"content":"Public Operators","linkify":"Public Operators","nodes":[{"content":"Public Operators","pos":[0,16]}]},{"content":"Name","pos":[2773,2777]},{"content":"Description","pos":[2778,2789]},{"pos":[2827,2904],"content":"<bpt id=\"p1\">[</bpt>CInternetSession::operator HINTERNET<ept id=\"p1\">](#cinternetsession__operator_hinternet)</ept>","source":"[CInternetSession::operator HINTERNET](#cinternetsession__operator_hinternet)"},{"content":"A handle to the current Internet session.","pos":[2905,2946]},{"pos":[2956,2963],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[2967,3154],"content":"If your Internet connection must be maintained for the duration of an application, you can create a <ph id=\"ph1\">`CInternetSession`</ph> member of the class <bpt id=\"p1\">[</bpt>CWinApp<ept id=\"p1\">](../../mfc/reference/cwinapp-class.md)</ept>.","source":"If your Internet connection must be maintained for the duration of an application, you can create a `CInternetSession` member of the class [CWinApp](../../mfc/reference/cwinapp-class.md)."},{"content":"Once you have established an Internet session, you can call <bpt id=\"p1\">[</bpt>OpenURL<ept id=\"p1\">](#cinternetsession__openurl)</ept>.","pos":[3161,3259],"source":"Once you have established an Internet session, you can call [OpenURL](#cinternetsession__openurl)."},{"content":"<ph id=\"ph1\">`CInternetSession`</ph> then parses the URL for you by calling the global function <bpt id=\"p1\">[</bpt>AfxParseURL<ept id=\"p1\">](http://msdn.microsoft.com/library/505c717e-aa52-4106-8522-eedff3d9bbae)</ept>.","pos":[3260,3424],"source":"`CInternetSession` then parses the URL for you by calling the global function [AfxParseURL](http://msdn.microsoft.com/library/505c717e-aa52-4106-8522-eedff3d9bbae)."},{"content":"Regardless of its protocol type, <ph id=\"ph1\">`CInternetSession`</ph> interprets the URL and manages it for you.","pos":[3425,3519],"source":" Regardless of its protocol type, `CInternetSession` interprets the URL and manages it for you."},{"content":"It can handle requests for local files identified with the URL resource \"file://\".","pos":[3520,3602]},{"content":"<ph id=\"ph1\">`OpenURL`</ph> will return a pointer to a <bpt id=\"p1\">[</bpt>CStdioFile<ept id=\"p1\">](../../mfc/reference/cstdiofile-class.md)</ept> object if the name you pass it is a local file.","pos":[3603,3741],"source":"`OpenURL` will return a pointer to a [CStdioFile](../../mfc/reference/cstdiofile-class.md) object if the name you pass it is a local file."},{"content":"If you open a URL on an Internet server using <ph id=\"ph1\">`OpenURL`</ph>, you can read information from the site.","pos":[3748,3844],"source":"If you open a URL on an Internet server using `OpenURL`, you can read information from the site."},{"content":"If you want to perform service-specific (for example, HTTP, FTP, or gopher) actions on files located on a server, you must establish the appropriate connection with that server.","pos":[3845,4022]},{"content":"To open a particular kind of connection directly to a particular service, use one of the following member functions:","pos":[4023,4139]},{"pos":[4147,4250],"content":"<bpt id=\"p1\">[</bpt>GetGopherConnection<ept id=\"p1\">](#cinternetsession__getgopherconnection)</ept> to open a connection to a gopher service.","source":"[GetGopherConnection](#cinternetsession__getgopherconnection) to open a connection to a gopher service."},{"pos":[4258,4356],"content":"<bpt id=\"p1\">[</bpt>GetHttpConnection<ept id=\"p1\">](#cinternetsession__gethttpconnection)</ept> to open a connection to an HTTP service.","source":"[GetHttpConnection](#cinternetsession__gethttpconnection) to open a connection to an HTTP service."},{"pos":[4364,4459],"content":"<bpt id=\"p1\">[</bpt>GetFtpConnection<ept id=\"p1\">](#cinternetsession__getftpconnection)</ept> to open a connection to an FTP service.","source":"[GetFtpConnection](#cinternetsession__getftpconnection) to open a connection to an FTP service."},{"pos":[4466,4615],"content":"<bpt id=\"p1\">[</bpt>SetOption<ept id=\"p1\">](#cinternetsession__setoption)</ept> allows you to set the query options of your session, such as time-out values, number of retries, and so on.","source":"[SetOption](#cinternetsession__setoption) allows you to set the query options of your session, such as time-out values, number of retries, and so on."},{"pos":[4622,4945],"content":"<ph id=\"ph1\">`CInternetSession`</ph> member functions <bpt id=\"p1\">[</bpt>SetCookie<ept id=\"p1\">](#cinternetsession__setcookie)</ept>, <bpt id=\"p2\">[</bpt>GetCookie<ept id=\"p2\">](#cinternetsession__getcookie)</ept>, and <bpt id=\"p3\">[</bpt>GetCookieLength<ept id=\"p3\">](#cinternetsession__getcookielength)</ept> provide the means to manage a Win32 cookie database, through which servers and scripts maintain state information about the client workstation.","source":"`CInternetSession` member functions [SetCookie](#cinternetsession__setcookie), [GetCookie](#cinternetsession__getcookie), and [GetCookieLength](#cinternetsession__getcookielength) provide the means to manage a Win32 cookie database, through which servers and scripts maintain state information about the client workstation."},{"content":"For more information about basic Internet programming tasks, see the article <bpt id=\"p1\">[</bpt>Internet First Steps: WinInet<ept id=\"p1\">](../../mfc/wininet-basics.md)</ept>.","pos":[4952,5090],"source":"For more information about basic Internet programming tasks, see the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md)."},{"content":"For general information about using the MFC WinInet classes, see the article <bpt id=\"p1\">[</bpt>Internet Programming with WinInet<ept id=\"p1\">](../../mfc/win32-internet-extensions-wininet.md)</ept>.","pos":[5091,5252],"source":" For general information about using the MFC WinInet classes, see the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md)."},{"pos":[5260,5507],"content":"[!NOTE]\n`CInternetSession` will throw an [AfxThrowNotSupportedException](exception-processing.md#afxthrownotsupportedexception) for unsupported service types. Only the following service types are currently supported: FTP, HTTP, gopher, and file.","leadings":["","> "],"nodes":[{"content":"`CInternetSession` will throw an [AfxThrowNotSupportedException](exception-processing.md#afxthrownotsupportedexception) for unsupported service types. Only the following service types are currently supported: FTP, HTTP, gopher, and file.","pos":[8,245],"nodes":[{"content":"<ph id=\"ph1\">`CInternetSession`</ph> will throw an <bpt id=\"p1\">[</bpt>AfxThrowNotSupportedException<ept id=\"p1\">](exception-processing.md#afxthrownotsupportedexception)</ept> for unsupported service types.","pos":[0,150],"source":"`CInternetSession` will throw an [AfxThrowNotSupportedException](exception-processing.md#afxthrownotsupportedexception) for unsupported service types."},{"content":"Only the following service types are currently supported: FTP, HTTP, gopher, and file.","pos":[151,237]}]}]},{"pos":[5516,5537],"content":"Inheritance Hierarchy","linkify":"Inheritance Hierarchy","nodes":[{"content":"Inheritance Hierarchy","pos":[0,21]}]},{"pos":[5541,5588],"content":"<bpt id=\"p1\">[</bpt>CObject<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept>","source":"[CObject](../../mfc/reference/cobject-class.md)"},{"pos":[5622,5634],"content":"Requirements","linkify":"Requirements","nodes":[{"content":"Requirements","pos":[0,12]}]},{"pos":[5638,5659],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxinet.h","source":"**Header:** afxinet.h"},{"pos":[5669,5754],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__cinternetsession\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::CInternetSession","linkify":"<a name=\"cinternetsession__cinternetsession\"></a>  CInternetSession::CInternetSession","source":"<a name=\"cinternetsession__cinternetsession\"></a>  CInternetSession::CInternetSession"},{"pos":[5758,5833],"content":"This member function is called when a <ph id=\"ph1\">`CInternetSession`</ph> object is created.","source":"This member function is called when a `CInternetSession` object is created."},{"pos":[6092,6102],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a string that identifies the name of the application or entity calling the Internet functions (for example, \"Microsoft Internet Browser\").","pos":[6121,6272]},{"content":"If <ph id=\"ph1\">`pstrAgent`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> (the default), the framework calls the global function <bpt id=\"p2\">[</bpt>AfxGetAppName<ept id=\"p2\">](application-information-and-management.md#afxgetappname)</ept>, which returns a null-terminated string containing an application's name.","pos":[6273,6501],"source":" If `pstrAgent` is **NULL** (the default), the framework calls the global function [AfxGetAppName](application-information-and-management.md#afxgetappname), which returns a null-terminated string containing an application's name."},{"content":"Some protocols use this string to identify your application to the server.","pos":[6502,6576]},{"content":"The context identifier for the operation.","pos":[6598,6639]},{"content":"<ph id=\"ph1\">`dwContext`</ph> identifies the operation's status information returned by <bpt id=\"p1\">[</bpt>CInternetSession::OnStatusCallback<ept id=\"p1\">](#cinternetsession__onstatuscallback)</ept>.","pos":[6640,6784],"source":"`dwContext` identifies the operation's status information returned by [CInternetSession::OnStatusCallback](#cinternetsession__onstatuscallback)."},{"content":"The default is set to 1; however, you can explicitly assign a specific context ID for the operation.","pos":[6785,6885]},{"content":"The object and any work it does will be associated with that context ID.","pos":[6886,6958]},{"content":"The type of access required.","pos":[6983,7011]},{"content":"The following are valid values, exactly one of which may be supplied:","pos":[7012,7081]},{"content":"<bpt id=\"p1\">**</bpt>INTERNET_OPEN_TYPE_PRECONFIG<ept id=\"p1\">**</ept> Connect using preconfigured settings in the registry.","pos":[7089,7175],"source":"**INTERNET_OPEN_TYPE_PRECONFIG** Connect using preconfigured settings in the registry."},{"content":"This access type is set as the default.","pos":[7176,7215]},{"content":"To connect through a TIS proxy, set <ph id=\"ph1\">`dwAccessType`</ph> to this value; you then set the registry appropriately.","pos":[7216,7322],"source":" To connect through a TIS proxy, set `dwAccessType` to this value; you then set the registry appropriately."},{"pos":[7330,7387],"content":"<ph id=\"ph1\">`INTERNET_OPEN_TYPE_DIRECT`</ph> Connect directly to Internet.","source":"`INTERNET_OPEN_TYPE_DIRECT` Connect directly to Internet."},{"pos":[7395,7451],"content":"<ph id=\"ph1\">`INTERNET_OPEN_TYPE_PROXY`</ph> Connect through a CERN proxy.","source":"`INTERNET_OPEN_TYPE_PROXY` Connect through a CERN proxy."},{"pos":[7458,7625],"content":"For information on connecting with different types of proxies, see <bpt id=\"p1\">[</bpt>Steps in a Typical FTP Client Application<ept id=\"p1\">](../../mfc/steps-in-a-typical-ftp-client-application.md)</ept>.","source":"For information on connecting with different types of proxies, see [Steps in a Typical FTP Client Application](../../mfc/steps-in-a-typical-ftp-client-application.md)."},{"pos":[7632,7768],"content":"*pstrProxyName*  \nThe name of the preferred CERN proxy if `dwAccessType` is set as `INTERNET_OPEN_TYPE_PROXY`. The default is **NULL**.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>pstrProxyName<ept id=\"p1\">*</ept>","pos":[0,15],"source":"*pstrProxyName*"},{"content":"The name of the preferred CERN proxy if `dwAccessType` is set as `INTERNET_OPEN_TYPE_PROXY`. The default is **NULL**.","pos":[18,135],"nodes":[{"content":"The name of the preferred CERN proxy if <ph id=\"ph1\">`dwAccessType`</ph> is set as <ph id=\"ph2\">`INTERNET_OPEN_TYPE_PROXY`</ph>.","pos":[0,92],"source":"The name of the preferred CERN proxy if `dwAccessType` is set as `INTERNET_OPEN_TYPE_PROXY`."},{"content":"The default is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[93,117],"source":" The default is **NULL**."}]}]},{"pos":[7775,8094],"content":"*pstrProxyBypass*  \nA pointer to a string containing an optional list of server addresses. These addresses may be bypassed when using proxy access. If a **NULL** value is supplied, the bypass list will be read from the registry. This parameter is meaningful only if `dwAccessType` is set to `INTERNET_OPEN_TYPE_PROXY`.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>pstrProxyBypass<ept id=\"p1\">*</ept>","pos":[0,17],"source":"*pstrProxyBypass*"},{"content":"A pointer to a string containing an optional list of server addresses. These addresses may be bypassed when using proxy access. If a **NULL** value is supplied, the bypass list will be read from the registry. This parameter is meaningful only if `dwAccessType` is set to `INTERNET_OPEN_TYPE_PROXY`.","pos":[20,318],"nodes":[{"content":"A pointer to a string containing an optional list of server addresses.","pos":[0,70]},{"content":"These addresses may be bypassed when using proxy access.","pos":[71,127]},{"content":"If a <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> value is supplied, the bypass list will be read from the registry.","pos":[128,208],"source":" If a **NULL** value is supplied, the bypass list will be read from the registry."},{"content":"This parameter is meaningful only if <ph id=\"ph1\">`dwAccessType`</ph> is set to <ph id=\"ph2\">`INTERNET_OPEN_TYPE_PROXY`</ph>.","pos":[209,298],"source":" This parameter is meaningful only if `dwAccessType` is set to `INTERNET_OPEN_TYPE_PROXY`."}]}]},{"pos":[8101,8202],"content":"`dwFlags`  \nIndicates various caching options. The default is set to 0. The possible values include:","leadings":[""," "],"nodes":[{"content":"Indicates various caching options. The default is set to 0. The possible values include:","pos":[12,100],"nodes":[{"content":"Indicates various caching options.","pos":[0,34]},{"content":"The default is set to 0.","pos":[35,59]},{"content":"The possible values include:","pos":[60,88]}]}]},{"pos":[8210,8301],"content":"<ph id=\"ph1\">`INTERNET_FLAG_DONT_CACHE`</ph> Do not cache the data, either locally or in any gateway servers.","source":"`INTERNET_FLAG_DONT_CACHE` Do not cache the data, either locally or in any gateway servers."},{"content":"<ph id=\"ph1\">`INTERNET_FLAG_OFFLINE`</ph> Download operations are satisfied through the persistent cache only.","pos":[8309,8401],"source":"`INTERNET_FLAG_OFFLINE` Download operations are satisfied through the persistent cache only."},{"content":"If the item does not exist in the cache, an appropriate error code is returned.","pos":[8402,8481]},{"content":"This flag may be combined with the bitwise <ph id=\"ph1\">`OR`</ph> ( <bpt id=\"p1\">**</bpt>&amp;#124;<ept id=\"p1\">**</ept>) operator.","pos":[8482,8553],"source":" This flag may be combined with the bitwise `OR` ( **&#124;**) operator."},{"pos":[8563,8570],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<bpt id=\"p1\">**</bpt>CInternetSession<ept id=\"p1\">**</ept> is the first Internet function called by an application.","pos":[8574,8651],"source":"**CInternetSession** is the first Internet function called by an application."},{"content":"It initializes internal data structures and prepares for future calls from the application.","pos":[8652,8743]},{"pos":[8750,8920],"content":"If no Internet connection can be opened, <ph id=\"ph1\">`CInternetSession`</ph> throws an <bpt id=\"p1\">[</bpt>AfxThrowInternetException<ept id=\"p1\">](http://msdn.microsoft.com/library/c9645b10-9541-48b2-8b0c-94ca33fed3cb)</ept>.","source":"If no Internet connection can be opened, `CInternetSession` throws an [AfxThrowInternetException](http://msdn.microsoft.com/library/c9645b10-9541-48b2-8b0c-94ca33fed3cb)."},{"pos":[8930,8937],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[8942,9020],"content":"See the example for <bpt id=\"p1\">[</bpt>CFtpFileFind<ept id=\"p1\">](../../mfc/reference/cftpfilefind-class.md)</ept>.","source":"See the example for [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md)."},{"pos":[9030,9093],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__close\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::Close","linkify":"<a name=\"cinternetsession__close\"></a>  CInternetSession::Close","source":"<a name=\"cinternetsession__close\"></a>  CInternetSession::Close"},{"pos":[9097,9194],"content":"Call this member function when your application has finished using the <ph id=\"ph1\">`CInternetSession`</ph> object.","source":"Call this member function when your application has finished using the `CInternetSession` object."},{"pos":[9241,9248],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[9253,9331],"content":"See the example for <bpt id=\"p1\">[</bpt>CFtpFileFind<ept id=\"p1\">](../../mfc/reference/cftpfilefind-class.md)</ept>.","source":"See the example for [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md)."},{"pos":[9341,9434],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__enablestatuscallback\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::EnableStatusCallback","linkify":"<a name=\"cinternetsession__enablestatuscallback\"></a>  CInternetSession::EnableStatusCallback","source":"<a name=\"cinternetsession__enablestatuscallback\"></a>  CInternetSession::EnableStatusCallback"},{"content":"Call this member function to enable status callback.","pos":[9438,9490]},{"pos":[9563,9573],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"Specifies whether callback is enabled or disabled.","pos":[9590,9640]},{"content":"The default is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>.","pos":[9641,9665],"source":" The default is **TRUE**."},{"pos":[9675,9687],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Nonzero if successful; otherwise 0.","pos":[9691,9726]},{"content":"If the call fails, determine the cause of the failure by examining the thrown <bpt id=\"p1\">[</bpt>CInternetException<ept id=\"p1\">](../../mfc/reference/cinternetexception-class.md)</ept> object.","pos":[9727,9882],"source":" If the call fails, determine the cause of the failure by examining the thrown [CInternetException](../../mfc/reference/cinternetexception-class.md) object."},{"pos":[9892,9899],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"When handling status callback, you can provide status about the progress of the operation (such as resolving name, connecting to server, and so on) in the status bar of the application.","pos":[9903,10088]},{"content":"Displaying operation status is especially desirable during a long-term operation.","pos":[10089,10170]},{"content":"Because callbacks occur during the request's processing, the application should spend as little time as possible in the callback to prevent degradation of data throughput to the network.","pos":[10177,10363]},{"content":"For example, putting up a dialog box in a callback may be such a lengthy operation that the server terminates the request.","pos":[10364,10486]},{"content":"The status callback cannot be removed as long as any callbacks are pending.","pos":[10493,10568]},{"content":"To handle any operations asynchronously, you must either create your own thread or use the WinInet functions without MFC.","pos":[10575,10696]},{"pos":[10706,10779],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__getcontext\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::GetContext","linkify":"<a name=\"cinternetsession__getcontext\"></a>  CInternetSession::GetContext","source":"<a name=\"cinternetsession__getcontext\"></a>  CInternetSession::GetContext"},{"content":"Call this member function to get the context value for a particular application session.","pos":[10783,10871]},{"pos":[10929,10941],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"The application-defined context Identifier.","pos":[10945,10988]},{"pos":[10998,11005],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<bpt id=\"p1\">[</bpt>OnStatusCallback<ept id=\"p1\">](#cinternetsession__onstatuscallback)</ept> uses the context ID returned by <bpt id=\"p2\">**</bpt>GetContext<ept id=\"p2\">**</ept> to report the status of a particular application.","pos":[11009,11161],"source":"[OnStatusCallback](#cinternetsession__onstatuscallback) uses the context ID returned by **GetContext** to report the status of a particular application."},{"content":"For example, when a user activates an Internet request that involves returning status information, the status callback uses the context ID to report status on that particular request.","pos":[11162,11345]},{"content":"If the user activates two separate Internet requests that both involve returning status information, <ph id=\"ph1\">`OnStatusCallback`</ph> uses the context identifiers to return status about their corresponding requests.","pos":[11346,11547],"source":" If the user activates two separate Internet requests that both involve returning status information, `OnStatusCallback` uses the context identifiers to return status about their corresponding requests."},{"content":"Consequently, the context identifier is used for all status callback operations, and it is associated with the session until the session is ended.","pos":[11548,11694]},{"pos":[11701,11830],"content":"For more information about asynchronous operations, see the article <bpt id=\"p1\">[</bpt>Internet First Steps: WinInet<ept id=\"p1\">](../../mfc/wininet-basics.md)</ept>.","source":"For more information about asynchronous operations, see the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md)."},{"pos":[11840,11911],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__getcookie\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::GetCookie","linkify":"<a name=\"cinternetsession__getcookie\"></a>  CInternetSession::GetCookie","source":"<a name=\"cinternetsession__getcookie\"></a>  CInternetSession::GetCookie"},{"pos":[11915,12135],"content":"This member function implements the behavior of the Win32 function <bpt id=\"p1\">[</bpt>InternetGetCookie<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa384710)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This member function implements the behavior of the Win32 function [InternetGetCookie](http://msdn.microsoft.com/library/windows/desktop/aa384710), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[12394,12404],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a string containing the URL.","pos":[12421,12462]},{"content":"A pointer to a string containing the name of the cookie to get for the specified URL.","pos":[12489,12574]},{"content":"In the first overload, a pointer to a string containing the address of the buffer that receives the cookie data.","pos":[12601,12713]},{"content":"This value can be <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[12714,12741],"source":" This value can be **NULL**."},{"content":"In the second overload, a reference to a <bpt id=\"p1\">[</bpt>CString<ept id=\"p1\">](../../atl-mfc-shared/reference/cstringt-class.md)</ept> object to receive the cookie data.","pos":[12742,12877],"source":" In the second overload, a reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object to receive the cookie data."},{"content":"The variable specifying the size of the <ph id=\"ph1\">`pstrCookieData`</ph> buffer.","pos":[12898,12962],"source":" The variable specifying the size of the `pstrCookieData` buffer."},{"content":"If the function succeeds, the buffer receives the amount of data copied to the <ph id=\"ph1\">`pstrCookieData`</ph> buffer.","pos":[12963,13066],"source":" If the function succeeds, the buffer receives the amount of data copied to the `pstrCookieData` buffer."},{"content":"If <ph id=\"ph1\">`pstrCookieData`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, this parameter receives a value that specifies the size of the buffer necessary to copy all the cookie data.","pos":[13067,13208],"source":" If `pstrCookieData` is **NULL**, this parameter receives a value that specifies the size of the buffer necessary to copy all the cookie data."},{"pos":[13218,13230],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if successful, or <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> otherwise.","pos":[13234,13289],"source":"Returns **TRUE** if successful, or **FALSE** otherwise."},{"content":"If the call fails, call the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> to determine the cause of the error.","pos":[13290,13444],"source":" If the call fails, call the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) to determine the cause of the error."},{"content":"The following error values apply:","pos":[13445,13478]},{"pos":[13486,13571],"content":"<bpt id=\"p1\">**</bpt>ERROR_NO_MORE_ITEMS<ept id=\"p1\">**</ept> There is no cookie for the specified URL and all its parents.","source":"**ERROR_NO_MORE_ITEMS** There is no cookie for the specified URL and all its parents."},{"content":"<bpt id=\"p1\">**</bpt>ERROR_INSUFFICIENT_BUFFER<ept id=\"p1\">**</ept> The value passed in <ph id=\"ph1\">`dwBufLen`</ph> is insufficient to copy all the cookie data.","pos":[13579,13684],"source":"**ERROR_INSUFFICIENT_BUFFER** The value passed in `dwBufLen` is insufficient to copy all the cookie data."},{"content":"The value returned in <ph id=\"ph1\">`dwBufLen`</ph> is the size of the buffer necessary to get all the data.","pos":[13685,13774],"source":" The value returned in `dwBufLen` is the size of the buffer necessary to get all the data."},{"pos":[13784,13791],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[13795,13884],"content":"In the second overload, MFC retrieves the cookie data into the supplied <ph id=\"ph1\">`CString`</ph> object.","source":"In the second overload, MFC retrieves the cookie data into the supplied `CString` object."},{"pos":[13894,13977],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__getcookielength\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::GetCookieLength","linkify":"<a name=\"cinternetsession__getcookielength\"></a>  CInternetSession::GetCookieLength","source":"<a name=\"cinternetsession__getcookielength\"></a>  CInternetSession::GetCookieLength"},{"content":"Call this member function to get the length of the cookie stored in the buffer.","pos":[13981,14060]},{"pos":[14167,14177],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a string containing the URL","pos":[14194,14234]},{"content":"A pointer to a string containing the name of the cookie.","pos":[14261,14317]},{"pos":[14327,14339],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A <ph id=\"ph1\">`DWORD`</ph> value indicating the length of the cookie, stored in the buffer.","pos":[14343,14417],"source":"A `DWORD` value indicating the length of the cookie, stored in the buffer."},{"content":"Zero if no cookie with the name indicated by <ph id=\"ph1\">`pstrCookieName`</ph> exists.","pos":[14418,14487],"source":" Zero if no cookie with the name indicated by `pstrCookieName` exists."},{"pos":[14497,14504],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[14508,14572],"content":"This value is used by <bpt id=\"p1\">[</bpt>GetCookie<ept id=\"p1\">](#cinternetsession__getcookie)</ept>.","source":"This value is used by [GetCookie](#cinternetsession__getcookie)."},{"pos":[14582,14667],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__getftpconnection\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::GetFtpConnection","linkify":"<a name=\"cinternetsession__getftpconnection\"></a>  CInternetSession::GetFtpConnection","source":"<a name=\"cinternetsession__getftpconnection\"></a>  CInternetSession::GetFtpConnection"},{"pos":[14671,14775],"content":"Call this member function to establish an FTP connection and get a pointer to a <ph id=\"ph1\">`CFtpConnection`</ph> object.","source":"Call this member function to establish an FTP connection and get a pointer to a `CFtpConnection` object."},{"pos":[15016,15026],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a string containing the FTP server name.","pos":[15046,15099]},{"content":"Pointer to a null-terminated string that specifies the name of the user to log in.","pos":[15124,15206]},{"content":"If <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default is anonymous.","pos":[15207,15245],"source":" If **NULL**, the default is anonymous."},{"content":"A pointer to a null-terminated string that specifies the password to use to log in.","pos":[15270,15353]},{"content":"If both <ph id=\"ph1\">`pstrPassword`</ph> and <ph id=\"ph2\">`pstrUserName`</ph> are <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, the default anonymous password is the user's email name.","pos":[15354,15466],"source":" If both `pstrPassword` and `pstrUserName` are **NULL**, the default anonymous password is the user's email name."},{"content":"If <ph id=\"ph1\">`pstrPassword`</ph> is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> (or an empty string) but <ph id=\"ph2\">`pstrUserName`</ph> is not <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept>, a blank password is used.","pos":[15467,15579],"source":" If `pstrPassword` is **NULL** (or an empty string) but `pstrUserName` is not **NULL**, a blank password is used."},{"content":"The following table describes the behavior for the four possible settings of <ph id=\"ph1\">`pstrUserName`</ph> and <ph id=\"ph2\">`pstrPassword`</ph>:","pos":[15580,15691],"source":" The following table describes the behavior for the four possible settings of `pstrUserName` and `pstrPassword`:"},{"content":"Username sent to FTP server","pos":[15728,15755]},{"content":"Password sent to FTP server","pos":[15756,15783]},{"pos":[15902,15917],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or \" \"","source":"**NULL** or \" \""},{"pos":[15918,15933],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or \" \"","source":"**NULL** or \" \""},{"content":"\"anonymous\"","pos":[15934,15945]},{"content":"User's email name","pos":[15946,15963]},{"pos":[15968,15988],"content":"Non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> String","source":"Non- **NULL** String"},{"pos":[15989,16004],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> or \" \"","source":"**NULL** or \" \""},{"content":"\" \"","pos":[16020,16023]},{"pos":[16028,16057],"content":"<bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> Non- <bpt id=\"p2\">**</bpt>NULL<ept id=\"p2\">**</ept> String","source":"**NULL** Non- **NULL** String"},{"pos":[16058,16067],"content":"<bpt id=\"p1\">**</bpt>ERROR<ept id=\"p1\">**</ept>","source":"**ERROR**"},{"pos":[16068,16077],"content":"<bpt id=\"p1\">**</bpt>ERROR<ept id=\"p1\">**</ept>","source":"**ERROR**"},{"pos":[16083,16103],"content":"Non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> String","source":"Non- **NULL** String"},{"pos":[16104,16124],"content":"Non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> String","source":"Non- **NULL** String"},{"content":"A number that identifies the TCP/IP port to use on the server.","pos":[16173,16235]},{"content":"Specifies passive or active mode for this FTP session.","pos":[16256,16310]},{"content":"If set to <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, it sets the Win32 API <ph id=\"ph1\">`dwFlag`</ph> to <bpt id=\"p2\">**</bpt>INTERNET_FLAG_PASSIVE<ept id=\"p2\">**</ept>.","pos":[16311,16391],"source":" If set to **TRUE**, it sets the Win32 API `dwFlag` to **INTERNET_FLAG_PASSIVE**."},{"pos":[16401,16413],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CFtpConnection<ept id=\"p1\">](../../mfc/reference/cftpconnection-class.md)</ept> object.","pos":[16417,16501],"source":"A pointer to a [CFtpConnection](../../mfc/reference/cftpconnection-class.md) object."},{"content":"If the call fails, determine the cause of the failure by examining the thrown <bpt id=\"p1\">[</bpt>CInternetException<ept id=\"p1\">](../../mfc/reference/cinternetexception-class.md)</ept> object.","pos":[16502,16657],"source":" If the call fails, determine the cause of the failure by examining the thrown [CInternetException](../../mfc/reference/cinternetexception-class.md) object."},{"pos":[16667,16674],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`GetFtpConnection`</ph> connects to an FTP server, and creates and returns a pointer to a <bpt id=\"p1\">**</bpt>CFTPConnection<ept id=\"p1\">**</ept> object.","pos":[16678,16789],"source":"`GetFtpConnection` connects to an FTP server, and creates and returns a pointer to a **CFTPConnection** object."},{"content":"It does not perform any specific operation on the server.","pos":[16790,16847]},{"content":"If you intend to read or write to files, for example, you must perform those operations as separate steps.","pos":[16848,16954]},{"content":"See the classes <bpt id=\"p1\">[</bpt>CFtpConnection<ept id=\"p1\">](../../mfc/reference/cftpconnection-class.md)</ept> and <bpt id=\"p2\">[</bpt>CFtpFileFind<ept id=\"p2\">](../../mfc/reference/cftpfilefind-class.md)</ept> for information about searching for files, opening files, and reading or writing to files.","pos":[16955,17185],"source":" See the classes [CFtpConnection](../../mfc/reference/cftpconnection-class.md) and [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md) for information about searching for files, opening files, and reading or writing to files."},{"content":"See the article <bpt id=\"p1\">[</bpt>Internet Programming with WinInet<ept id=\"p1\">](../../mfc/win32-internet-extensions-wininet.md)</ept> for steps in performing common FTP connection tasks.","pos":[17186,17338],"source":" See the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md) for steps in performing common FTP connection tasks."},{"pos":[17348,17355],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[17360,17438],"content":"See the example for <bpt id=\"p1\">[</bpt>CFtpFileFind<ept id=\"p1\">](../../mfc/reference/cftpfilefind-class.md)</ept>.","source":"See the example for [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md)."},{"pos":[17448,17539],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__getgopherconnection\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::GetGopherConnection","linkify":"<a name=\"cinternetsession__getgopherconnection\"></a>  CInternetSession::GetGopherConnection","source":"<a name=\"cinternetsession__getgopherconnection\"></a>  CInternetSession::GetGopherConnection"},{"pos":[17543,17656],"content":"Call this member function to establish a new gopher connection and get a pointer to a <ph id=\"ph1\">`CGopherConnection`</ph> object.","source":"Call this member function to establish a new gopher connection and get a pointer to a `CGopherConnection` object."},{"pos":[17874,17884],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a string containing the gopher server name.","pos":[17904,17960]},{"content":"A pointer to a string containing the user name.","pos":[17985,18032]},{"content":"A pointer to a string containing the access password.","pos":[18057,18110]},{"content":"A number that identifies the TCP/IP port to use on the server.","pos":[18128,18190]},{"pos":[18200,18212],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CGopherConnection<ept id=\"p1\">](../../mfc/reference/cgopherconnection-class.md)</ept> object.","pos":[18216,18306],"source":"A pointer to a [CGopherConnection](../../mfc/reference/cgopherconnection-class.md) object."},{"content":"If the call fails, determine the cause of the failure by examining the thrown <bpt id=\"p1\">[</bpt>CInternetException<ept id=\"p1\">](../../mfc/reference/cinternetexception-class.md)</ept> object.","pos":[18307,18462],"source":" If the call fails, determine the cause of the failure by examining the thrown [CInternetException](../../mfc/reference/cinternetexception-class.md) object."},{"pos":[18472,18479],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`GetGopherConnection`</ph> connects to a gopher server, and creates and returns a pointer to a <ph id=\"ph2\">`CGopherConnection`</ph> object.","pos":[18483,18600],"source":"`GetGopherConnection` connects to a gopher server, and creates and returns a pointer to a `CGopherConnection` object."},{"content":"It does not perform any specific operation on the server.","pos":[18601,18658]},{"content":"If you intend to read or write data, for example, you must perform those operations as separate steps.","pos":[18659,18761]},{"content":"See the classes <bpt id=\"p1\">[</bpt>CGopherConnection<ept id=\"p1\">](../../mfc/reference/cgopherconnection-class.md)</ept>, <bpt id=\"p2\">[</bpt>CGopherFile<ept id=\"p2\">](../../mfc/reference/cgopherfile-class.md)</ept>, and <bpt id=\"p3\">[</bpt>CGopherFileFind<ept id=\"p3\">](../../mfc/reference/cgopherfilefind-class.md)</ept> for information about searching for files, opening files, and reading or writing to files.","pos":[18762,19062],"source":" See the classes [CGopherConnection](../../mfc/reference/cgopherconnection-class.md), [CGopherFile](../../mfc/reference/cgopherfile-class.md), and [CGopherFileFind](../../mfc/reference/cgopherfilefind-class.md) for information about searching for files, opening files, and reading or writing to files."},{"content":"For information about browsing an FTP site, see the member function <bpt id=\"p1\">[</bpt>OpenURL<ept id=\"p1\">](#cinternetsession__openurl)</ept>.","pos":[19063,19169],"source":" For information about browsing an FTP site, see the member function [OpenURL](#cinternetsession__openurl)."},{"content":"See the article <bpt id=\"p1\">[</bpt>Internet Programming with WinInet<ept id=\"p1\">](../../mfc/win32-internet-extensions-wininet.md)</ept> for steps in performing common gopher connection tasks.","pos":[19170,19325],"source":" See the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md) for steps in performing common gopher connection tasks."},{"pos":[19335,19422],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__gethttpconnection\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::GetHttpConnection","linkify":"<a name=\"cinternetsession__gethttpconnection\"></a>  CInternetSession::GetHttpConnection","source":"<a name=\"cinternetsession__gethttpconnection\"></a>  CInternetSession::GetHttpConnection"},{"pos":[19426,19532],"content":"Call this member function to establish an HTTP connection and get a pointer to a <ph id=\"ph1\">`CHttpConnection`</ph> object.","source":"Call this member function to establish an HTTP connection and get a pointer to a `CHttpConnection` object."},{"pos":[19959,19969],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a string containing the HTTP server name.","pos":[19989,20043]},{"content":"A number that identifies the TCP/IP port to use on the server.","pos":[20061,20123]},{"content":"A pointer to a string containing the user name.","pos":[20148,20195]},{"content":"A pointer to a string containing the access password.","pos":[20220,20273]},{"content":"<bpt id=\"p1\">*</bpt>dwflags<ept id=\"p1\">*</ept>","pos":[20280,20289],"source":"*dwflags*"},{"content":"Any combination of the <bpt id=\"p1\">**</bpt>INTERNET_ FLAG_<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept> flags.","pos":[20293,20344],"source":" Any combination of the **INTERNET_ FLAG_\\*** flags."},{"content":"See the table in the <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> section of <bpt id=\"p2\">[</bpt>CHttpConnection::OpenRequest<ept id=\"p2\">](../../mfc/reference/chttpconnection-class.md#chttpconnection__openrequest)</ept> for a description of <ph id=\"ph1\">`dwFlags`</ph> values.","pos":[20345,20533],"source":" See the table in the **Remarks** section of [CHttpConnection::OpenRequest](../../mfc/reference/chttpconnection-class.md#chttpconnection__openrequest) for a description of `dwFlags` values."},{"pos":[20543,20555],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"A pointer to a <bpt id=\"p1\">[</bpt>CHttpConnection<ept id=\"p1\">](../../mfc/reference/chttpconnection-class.md)</ept> object.","pos":[20559,20645],"source":"A pointer to a [CHttpConnection](../../mfc/reference/chttpconnection-class.md) object."},{"content":"If the call fails, determine the cause of the failure by examining the thrown <bpt id=\"p1\">[</bpt>CInternetException<ept id=\"p1\">](../../mfc/reference/cinternetexception-class.md)</ept> object.","pos":[20646,20801],"source":" If the call fails, determine the cause of the failure by examining the thrown [CInternetException](../../mfc/reference/cinternetexception-class.md) object."},{"pos":[20811,20818],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"<ph id=\"ph1\">`GetHttpConnection`</ph> connects to an HTTP server, and creates and returns a pointer to a <ph id=\"ph2\">`CHttpConnection`</ph> object.","pos":[20822,20934],"source":"`GetHttpConnection` connects to an HTTP server, and creates and returns a pointer to a `CHttpConnection` object."},{"content":"It does not perform any specific operation on the server.","pos":[20935,20992]},{"content":"If you intend to query an HTTP header, for example, you must perform this operation as a separate step.","pos":[20993,21096]},{"content":"See the classes <bpt id=\"p1\">[</bpt>CHttpConnection<ept id=\"p1\">](../../mfc/reference/chttpconnection-class.md)</ept> and <bpt id=\"p2\">[</bpt>CHttpFile<ept id=\"p2\">](../../mfc/reference/chttpfile-class.md)</ept> for information about operations you can perform by using a connection to an HTTP server.","pos":[21097,21322],"source":" See the classes [CHttpConnection](../../mfc/reference/chttpconnection-class.md) and [CHttpFile](../../mfc/reference/chttpfile-class.md) for information about operations you can perform by using a connection to an HTTP server."},{"content":"For information about browsing an HTTP site, see the member function <bpt id=\"p1\">[</bpt>OpenURL<ept id=\"p1\">](#cinternetsession__openurl)</ept>.","pos":[21323,21430],"source":" For information about browsing an HTTP site, see the member function [OpenURL](#cinternetsession__openurl)."},{"content":"See the article <bpt id=\"p1\">[</bpt>Internet Programming with WinInet<ept id=\"p1\">](../../mfc/win32-internet-extensions-wininet.md)</ept> for steps in performing common HTTP connection tasks.","pos":[21431,21584],"source":" See the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md) for steps in performing common HTTP connection tasks."},{"pos":[21594,21679],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__onstatuscallback\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::OnStatusCallback","linkify":"<a name=\"cinternetsession__onstatuscallback\"></a>  CInternetSession::OnStatusCallback","source":"<a name=\"cinternetsession__onstatuscallback\"></a>  CInternetSession::OnStatusCallback"},{"content":"This member function is called by the framework to update the status when status callback is enabled and an operation is pending.","pos":[21683,21812]},{"pos":[21998,22008],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The context value supplied by the application.","pos":[22027,22073]},{"content":"A status code which indicates why the callback is being made.","pos":[22102,22163]},{"content":"See <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> for a table of possible values.","pos":[22164,22211],"source":" See **Remarks** for a table of possible values."},{"content":"A pointer to a buffer containing information pertinent to this callback.","pos":[22244,22316]},{"content":"The size of <ph id=\"ph1\">`lpvStatusInformation`</ph>.","pos":[22354,22389],"source":" The size of `lpvStatusInformation`."},{"pos":[22399,22406],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[22410,22531],"content":"You must first call <bpt id=\"p1\">[</bpt>EnableStatusCallback<ept id=\"p1\">](#cinternetsession__enablestatuscallback)</ept> to take advantage of status callback.","source":"You must first call [EnableStatusCallback](#cinternetsession__enablestatuscallback) to take advantage of status callback."},{"content":"The <ph id=\"ph1\">`dwInternetStatus`</ph> parameter indicates the operation being performed and determines what the contents of <ph id=\"ph2\">`lpvStatusInformation`</ph> will be.","pos":[22538,22678],"source":"The `dwInternetStatus` parameter indicates the operation being performed and determines what the contents of `lpvStatusInformation` will be."},{"content":"<ph id=\"ph1\">`dwStatusInformationLength`</ph> indicates the length of the data included in <ph id=\"ph2\">`lpvStatusInformation`</ph>.","pos":[22679,22775],"source":"`dwStatusInformationLength` indicates the length of the data included in `lpvStatusInformation`."},{"content":"The following status values for <ph id=\"ph1\">`dwInternetStatus`</ph> are defined as follows:","pos":[22776,22850],"source":" The following status values for `dwInternetStatus` are defined as follows:"},{"content":"Value","pos":[22857,22862]},{"content":"Meaning","pos":[22863,22870]},{"pos":[22938,23012],"content":"Looking up the IP address of the name contained in <ph id=\"ph1\">`lpvStatusInformation`</ph>.","source":"Looking up the IP address of the name contained in `lpvStatusInformation`."},{"pos":[23049,23131],"content":"Successfully found the IP address of the name contained in <ph id=\"ph1\">`lpvStatusInformation`</ph>.","source":"Successfully found the IP address of the name contained in `lpvStatusInformation`."},{"pos":[23175,23302],"content":"Connecting to the socket address ( <bpt id=\"p1\">[</bpt>SOCKADDR<ept id=\"p1\">](../../mfc/reference/sockaddr-structure.md)</ept>) pointed to by <ph id=\"ph1\">`lpvStatusInformation`</ph>.","source":"Connecting to the socket address ( [SOCKADDR](../../mfc/reference/sockaddr-structure.md)) pointed to by `lpvStatusInformation`."},{"pos":[23345,23441],"content":"Successfully connected to the socket address ( <ph id=\"ph1\">`SOCKADDR`</ph>) pointed to by <ph id=\"ph2\">`lpvStatusInformation`</ph>.","source":"Successfully connected to the socket address ( `SOCKADDR`) pointed to by `lpvStatusInformation`."},{"content":"Sending the information request to the server.","pos":[23480,23526]},{"content":"The <ph id=\"ph1\">`lpvStatusInformation`</ph> parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[23527,23576],"source":" The `lpvStatusInformation` parameter is **NULL**."},{"pos":[23581,23614],"content":"<bpt id=\"p1\">**</bpt>INTERNET_STATUS_ REQUEST_SENT<ept id=\"p1\">**</ept>","source":"**INTERNET_STATUS_ REQUEST_SENT**"},{"content":"Successfully sent the information request to the server.","pos":[23615,23671]},{"content":"The <ph id=\"ph1\">`lpvStatusInformation`</ph> parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[23672,23721],"source":" The `lpvStatusInformation` parameter is **NULL**."},{"content":"Waiting for the server to respond to a request.","pos":[23763,23810]},{"content":"The <ph id=\"ph1\">`lpvStatusInformation`</ph> parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[23811,23860],"source":" The `lpvStatusInformation` parameter is **NULL**."},{"content":"Successfully received a response from the server.","pos":[23901,23950]},{"content":"The <ph id=\"ph1\">`lpvStatusInformation`</ph> parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[23951,24000],"source":" The `lpvStatusInformation` parameter is **NULL**."},{"content":"Closing the connection to the server.","pos":[24042,24079]},{"content":"The <ph id=\"ph1\">`lpvStatusInformation`</ph> parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[24080,24129],"source":" The `lpvStatusInformation` parameter is **NULL**."},{"content":"Successfully closed the connection to the server.","pos":[24170,24219]},{"content":"The <ph id=\"ph1\">`lpvStatusInformation`</ph> parameter is <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[24220,24269],"source":" The `lpvStatusInformation` parameter is **NULL**."},{"content":"Used by the Win32 API function <bpt id=\"p1\">[</bpt>InternetConnect<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa384363)</ept> to indicate that it has created the new handle.","pos":[24307,24463],"source":"Used by the Win32 API function [InternetConnect](http://msdn.microsoft.com/library/windows/desktop/aa384363) to indicate that it has created the new handle."},{"content":"This lets the application call the Win32 function <bpt id=\"p1\">[</bpt>InternetCloseHandle<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa384350)</ept> from another thread if the connect is taking too long.","pos":[24464,24650],"source":" This lets the application call the Win32 function [InternetCloseHandle](http://msdn.microsoft.com/library/windows/desktop/aa384350) from another thread if the connect is taking too long."},{"content":"See the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>for more information about these functions.","pos":[24651,24753],"source":" See the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]for more information about these functions."},{"content":"Successfully terminated this handle value.","pos":[24791,24833]},{"content":"Override this member function to require some action before a status callback routine is performed.","pos":[24841,24940]},{"pos":[24948,25105],"content":"[!NOTE]\n Status callbacks need thread-state protection. If you are using MFC in a shared library, add the following line to the beginning of your override:","leadings":["","> "],"nodes":[{"content":" Status callbacks need thread-state protection. If you are using MFC in a shared library, add the following line to the beginning of your override:","pos":[8,155],"nodes":[{"content":"Status callbacks need thread-state protection.","pos":[1,47]},{"content":"If you are using MFC in a shared library, add the following line to the beginning of your override:","pos":[48,147]}]}]},{"pos":[25112,25208],"content":"<bpt id=\"p1\">[!code-cpp</bpt><bpt id=\"p2\">[</bpt>NVC_MFCHtmlHttp#8<ept id=\"p2\">](../../mfc/reference/codesnippet/cpp/cinternetsession-class_1.cpp)</ept><ept id=\"p1\">]</ept>","source":"[!code-cpp[NVC_MFCHtmlHttp#8](../../mfc/reference/codesnippet/cpp/cinternetsession-class_1.cpp)]"},{"pos":[25215,25344],"content":"For more information about asynchronous operations, see the article <bpt id=\"p1\">[</bpt>Internet First Steps: WinInet<ept id=\"p1\">](../../mfc/wininet-basics.md)</ept>.","source":"For more information about asynchronous operations, see the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md)."},{"pos":[25354,25421],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__openurl\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::OpenURL","linkify":"<a name=\"cinternetsession__openurl\"></a>  CInternetSession::OpenURL","source":"<a name=\"cinternetsession__openurl\"></a>  CInternetSession::OpenURL"},{"content":"Call this member function to send the specified request to the HTTP server and allow the client to specify additional RFC822, MIME, or HTTP headers to send along with the request.","pos":[25425,25604]},{"pos":[25822,25832],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"<bpt id=\"p1\">*</bpt>pstrURL<ept id=\"p1\">*</ept>","pos":[25836,25845],"source":"*pstrURL*"},{"content":"A pointer to the name of the URL to begin reading.","pos":[25849,25899]},{"content":"Only URLs beginning with file:, ftp:, gopher:, or http: are supported.","pos":[25900,25970]},{"content":"<bpt id=\"p1\">**</bpt>ASSERTS<ept id=\"p1\">**</ept> if <bpt id=\"p2\">*</bpt>pszURL<ept id=\"p2\">*</ept> is <bpt id=\"p3\">**</bpt>NULL<ept id=\"p3\">**</ept>.","pos":[25971,26007],"source":"**ASSERTS** if *pszURL* is **NULL**."},{"content":"An application-defined value passed with the returned handle in callback.","pos":[26029,26102]},{"content":"The flags describing how to handle this connection.","pos":[26122,26173]},{"content":"See <bpt id=\"p1\">**</bpt>Remarks<ept id=\"p1\">**</ept> for more information about the valid flags.","pos":[26174,26233],"source":" See **Remarks** for more information about the valid flags."},{"content":"The valid flags are:","pos":[26234,26254]},{"content":"<bpt id=\"p1\">**</bpt>INTERNET_FLAG_TRANSFER_ASCII<ept id=\"p1\">**</ept> The default.","pos":[26262,26307],"source":"**INTERNET_FLAG_TRANSFER_ASCII** The default."},{"content":"Transfer the file as ASCII text.","pos":[26308,26340]},{"pos":[26348,26417],"content":"<bpt id=\"p1\">**</bpt>INTERNET_FLAG_TRANSFER_BINARY<ept id=\"p1\">**</ept> Transfer the file as a binary file.","source":"**INTERNET_FLAG_TRANSFER_BINARY** Transfer the file as a binary file."},{"pos":[26425,26504],"content":"<ph id=\"ph1\">`INTERNET_FLAG_RELOAD`</ph> Get the data from the wire even if it is locally cached.","source":"`INTERNET_FLAG_RELOAD` Get the data from the wire even if it is locally cached."},{"pos":[26512,26596],"content":"<ph id=\"ph1\">`INTERNET_FLAG_DONT_CACHE`</ph> Do not cache the data, either locally or in any gateways.","source":"`INTERNET_FLAG_DONT_CACHE` Do not cache the data, either locally or in any gateways."},{"content":"<ph id=\"ph1\">`INTERNET_FLAG_SECURE`</ph> This flag is applicable to HTTP requests only.","pos":[26604,26673],"source":"`INTERNET_FLAG_SECURE` This flag is applicable to HTTP requests only."},{"content":"It requests secure transactions on the wire with Secure Sockets Layer or PCT.","pos":[26674,26751]},{"pos":[26759,26965],"content":"<bpt id=\"p1\">**</bpt>INTERNET_OPEN_FLAG_USE_EXISTING_CONNECT<ept id=\"p1\">**</ept> If possible, reuse the existing connections to the server for new requests generated by <bpt id=\"p2\">**</bpt>OpenUrl<ept id=\"p2\">**</ept> instead of creating a new session for each connection request.","source":"**INTERNET_OPEN_FLAG_USE_EXISTING_CONNECT** If possible, reuse the existing connections to the server for new requests generated by **OpenUrl** instead of creating a new session for each connection request."},{"content":"<bpt id=\"p1\">**</bpt>INTERNET_FLAG_PASSIVE<ept id=\"p1\">**</ept> Used for an FTP site.","pos":[26973,27020],"source":"**INTERNET_FLAG_PASSIVE** Used for an FTP site."},{"content":"Uses passive FTP semantics.","pos":[27021,27048]},{"content":"Used with <bpt id=\"p1\">[</bpt>CInternetConnection<ept id=\"p1\">](../../mfc/reference/cinternetconnection-class.md)</ept> of <ph id=\"ph1\">`OpenURL`</ph>.","pos":[27049,27144],"source":" Used with [CInternetConnection](../../mfc/reference/cinternetconnection-class.md) of `OpenURL`."},{"pos":[27151,27243],"content":"`pstrHeaders`  \nA pointer to a string containing the headers to be sent to the HTTP server.","leadings":[""," "],"nodes":[{"content":"A pointer to a string containing the headers to be sent to the HTTP server.","pos":[16,91]}]},{"pos":[27250,27457],"content":"*dwHeadersLength*  \nThe length, in characters, of the additional headers. If this is -1L and `pstrHeaders` is non- **NULL**, then `pstrHeaders` is assumed to be zero terminated and the length is calculated.","leadings":[""," "],"nodes":[{"content":"<bpt id=\"p1\">*</bpt>dwHeadersLength<ept id=\"p1\">*</ept>","pos":[0,17],"source":"*dwHeadersLength*"},{"content":"The length, in characters, of the additional headers. If this is -1L and `pstrHeaders` is non- **NULL**, then `pstrHeaders` is assumed to be zero terminated and the length is calculated.","pos":[20,206],"nodes":[{"content":"The length, in characters, of the additional headers.","pos":[0,53]},{"content":"If this is -1L and <ph id=\"ph1\">`pstrHeaders`</ph> is non- <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>, then <ph id=\"ph2\">`pstrHeaders`</ph> is assumed to be zero terminated and the length is calculated.","pos":[54,186],"source":" If this is -1L and `pstrHeaders` is non- **NULL**, then `pstrHeaders` is assumed to be zero terminated and the length is calculated."}]}]},{"pos":[27467,27479],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns a file handle for FTP, GOPHER, HTTP, and FILE-type Internet services only.","pos":[27483,27565]},{"content":"Returns <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> if parsing was unsuccessful.","pos":[27566,27611],"source":" Returns **NULL** if parsing was unsuccessful."},{"content":"The pointer that <ph id=\"ph1\">`OpenURL`</ph> returns depends on <bpt id=\"p1\">*</bpt>pszURL<ept id=\"p1\">*</ept>'s type of service.","pos":[27618,27691],"source":"The pointer that `OpenURL` returns depends on *pszURL*'s type of service."},{"content":"The table below illustrates the possible pointers <ph id=\"ph1\">`OpenURL`</ph> can return.","pos":[27692,27763],"source":" The table below illustrates the possible pointers `OpenURL` can return."},{"content":"URL type","pos":[27770,27778]},{"content":"Returns","pos":[27779,27786]},{"content":"file://","pos":[27824,27831]},{"pos":[27832,27848],"content":"<bpt id=\"p1\">**</bpt>CStdioFile<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**CStdioFile\\***"},{"content":"http://","pos":[27853,27860]},{"pos":[27861,27876],"content":"<bpt id=\"p1\">**</bpt>CHttpFile<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**CHttpFile\\***"},{"content":"gopher://","pos":[27881,27890]},{"pos":[27891,27908],"content":"<bpt id=\"p1\">**</bpt>CGopherFile<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**CGopherFile\\***"},{"content":"ftp://","pos":[27913,27919]},{"pos":[27920,27939],"content":"<bpt id=\"p1\">**</bpt>CInternetFile<ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept>","source":"**CInternetFile\\***"},{"pos":[27950,27957],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"content":"The parameter <ph id=\"ph1\">`dwFlags`</ph> must include either <bpt id=\"p1\">**</bpt>INTERNET_FLAG_TRANSFER_ASCII<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>INTERNET_FLAG_TRANSFER_BINARY<ept id=\"p2\">**</ept>, but not both.","pos":[27961,28089],"source":"The parameter `dwFlags` must include either **INTERNET_FLAG_TRANSFER_ASCII** or **INTERNET_FLAG_TRANSFER_BINARY**, but not both."},{"content":"The remaining flags can be combined with the bitwise <ph id=\"ph1\">`OR`</ph> operator ( <bpt id=\"p1\">**</bpt>&amp;#124;<ept id=\"p1\">**</ept>).","pos":[28090,28171],"source":" The remaining flags can be combined with the bitwise `OR` operator ( **&#124;**)."},{"content":"<ph id=\"ph1\">`OpenURL`</ph>, which wraps the Win32 function <bpt id=\"p1\">**</bpt>InternetOpenURL<ept id=\"p1\">**</ept>, allows only downloading, retrieving, and reading the data from an Internet server.","pos":[28178,28323],"source":"`OpenURL`, which wraps the Win32 function **InternetOpenURL**, allows only downloading, retrieving, and reading the data from an Internet server."},{"content":"<ph id=\"ph1\">`OpenURL`</ph> allows no file manipulation on a remote location, so it requires no <bpt id=\"p1\">[</bpt>CInternetConnection<ept id=\"p1\">](../../mfc/reference/cinternetconnection-class.md)</ept> object.","pos":[28324,28481],"source":"`OpenURL` allows no file manipulation on a remote location, so it requires no [CInternetConnection](../../mfc/reference/cinternetconnection-class.md) object."},{"content":"To use connection-specific (that is, protocol-specific) functions, such as writing to a file, you must open a session, then open a particular kind of connection, then use that connection to open a file in the desired mode.","pos":[28488,28710]},{"content":"See <ph id=\"ph1\">`CInternetConnection`</ph> for more information about connection-specific functions.","pos":[28711,28794],"source":" See `CInternetConnection` for more information about connection-specific functions."},{"pos":[28804,28893],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__operator_hinternet\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::operator HINTERNET","linkify":"<a name=\"cinternetsession__operator_hinternet\"></a>  CInternetSession::operator HINTERNET","source":"<a name=\"cinternetsession__operator_hinternet\"></a>  CInternetSession::operator HINTERNET"},{"content":"Use this operator to get the Windows handle for the current Internet session.","pos":[28897,28974]},{"pos":[29030,29101],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__setcookie\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::SetCookie","linkify":"<a name=\"cinternetsession__setcookie\"></a>  CInternetSession::SetCookie","source":"<a name=\"cinternetsession__setcookie\"></a>  CInternetSession::SetCookie"},{"content":"Sets a cookie for the specified URL.","pos":[29105,29141]},{"pos":[29271,29281],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"A pointer to a null-terminated string that specifies the URL for which the cookie should be set.","pos":[29298,29394]},{"content":"A pointer to a string containing the name of the cookie.","pos":[29421,29477]},{"content":"A pointer to a string containing the actual string data to associate with the URL.","pos":[29504,29586]},{"pos":[29596,29608],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"Returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if successful, or <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> otherwise.","pos":[29612,29667],"source":"Returns **TRUE** if successful, or **FALSE** otherwise."},{"content":"To get the specific error code, call <bpt id=\"p1\">**</bpt>GetLastError.<ept id=\"p1\">**</ept>","pos":[29668,29722],"source":" To get the specific error code, call **GetLastError.**"},{"pos":[29732,29739],"content":"Remarks","linkify":"Remarks","nodes":[{"content":"Remarks","pos":[0,7]}]},{"pos":[29743,29962],"content":"This member function implements the behavior of the Win32 message <bpt id=\"p1\">[</bpt>InternetSetCookie<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa385107)</ept>, as described in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>.","source":"This member function implements the behavior of the Win32 message [InternetSetCookie](http://msdn.microsoft.com/library/windows/desktop/aa385107), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]."},{"pos":[29972,30043],"content":"<bpt id=\"p1\">&lt;a name=\"cinternetsession__setoption\"&gt;</bpt><ept id=\"p1\">&lt;/a&gt;</ept>  CInternetSession::SetOption","linkify":"<a name=\"cinternetsession__setoption\"></a>  CInternetSession::SetOption","source":"<a name=\"cinternetsession__setoption\"></a>  CInternetSession::SetOption"},{"content":"Call this member function to set options for the Internet session.","pos":[30047,30113]},{"pos":[30337,30347],"content":"Parameters","linkify":"Parameters","nodes":[{"content":"Parameters","pos":[0,10]}]},{"content":"The Internet option to set.","pos":[30365,30392]},{"content":"See <bpt id=\"p1\">[</bpt>Option Flags<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/aa385328)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph>for a list of the possible options.","pos":[30393,30565],"source":" See [Option Flags](http://msdn.microsoft.com/library/windows/desktop/aa385328) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]for a list of the possible options."},{"content":"A buffer that contains the option setting.","pos":[30586,30628]},{"content":"<bpt id=\"p1\">*</bpt>dwBufferLength<ept id=\"p1\">*</ept>","pos":[30635,30651],"source":"*dwBufferLength*"},{"content":"The length of <ph id=\"ph1\">`lpBuffer`</ph> or the size of <ph id=\"ph2\">`dwValue`</ph>.","pos":[30655,30705],"source":" The length of `lpBuffer` or the size of `dwValue`."},{"content":"A <ph id=\"ph1\">`DWORD`</ph> that contains the option setting.","pos":[30725,30768],"source":" A `DWORD` that contains the option setting."},{"content":"Indicates various caching options.","pos":[30788,30822]},{"content":"The default is set to 0.","pos":[30823,30847]},{"content":"The possible values include:","pos":[30848,30876]},{"pos":[30884,30975],"content":"<ph id=\"ph1\">`INTERNET_FLAG_DONT_CACHE`</ph> Do not cache the data, either locally or in any gateway servers.","source":"`INTERNET_FLAG_DONT_CACHE` Do not cache the data, either locally or in any gateway servers."},{"content":"<ph id=\"ph1\">`INTERNET_FLAG_OFFLINE`</ph> Download operations are satisfied through the persistent cache only.","pos":[30983,31075],"source":"`INTERNET_FLAG_OFFLINE` Download operations are satisfied through the persistent cache only."},{"content":"If the item does not exist in the cache, an appropriate error code is returned.","pos":[31076,31155]},{"content":"This flag may be combined with the bitwise <ph id=\"ph1\">`OR`</ph> ( <bpt id=\"p1\">**</bpt>&amp;#124;<ept id=\"p1\">**</ept>) operator.","pos":[31156,31227],"source":" This flag may be combined with the bitwise `OR` ( **&#124;**) operator."},{"pos":[31237,31249],"content":"Return Value","linkify":"Return Value","nodes":[{"content":"Return Value","pos":[0,12]}]},{"content":"If the operation was successful, a value of <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> is returned.","pos":[31253,31318],"source":"If the operation was successful, a value of **TRUE** is returned."},{"content":"If an error occurred, a value of <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept> is returned.","pos":[31319,31374],"source":" If an error occurred, a value of **FALSE** is returned."},{"content":"If the call fails, the Win32 function <bpt id=\"p1\">[</bpt>GetLastError<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms679360)</ept> may be called to determine the cause of the error.","pos":[31375,31538],"source":" If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error."},{"pos":[31547,31555],"content":"See Also","linkify":"See Also","nodes":[{"content":"See Also","pos":[0,8]}]},{"content":"<bpt id=\"p1\">[</bpt>CObject Class<ept id=\"p1\">](../../mfc/reference/cobject-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[31559,31613],"source":"[CObject Class](../../mfc/reference/cobject-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>Hierarchy Chart<ept id=\"p1\">](../../mfc/hierarchy-chart.md)</ept><ph id=\"ph1\"> </ph>","pos":[31616,31665],"source":" [Hierarchy Chart](../../mfc/hierarchy-chart.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CInternetConnection Class<ept id=\"p1\">](../../mfc/reference/cinternetconnection-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[31668,31747],"source":" [CInternetConnection Class](../../mfc/reference/cinternetconnection-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CHttpConnection Class<ept id=\"p1\">](../../mfc/reference/chttpconnection-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[31750,31821],"source":" [CHttpConnection Class](../../mfc/reference/chttpconnection-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CFtpConnection Class<ept id=\"p1\">](../../mfc/reference/cftpconnection-class.md)</ept><ph id=\"ph1\"> </ph>","pos":[31824,31893],"source":" [CFtpConnection Class](../../mfc/reference/cftpconnection-class.md) "},{"content":"<bpt id=\"p1\"> [</bpt>CGopherConnection Class<ept id=\"p1\">](../../mfc/reference/cgopherconnection-class.md)</ept>","pos":[31896,31970],"source":" [CGopherConnection Class](../../mfc/reference/cgopherconnection-class.md)"}],"content":"---\ntitle: \"CInternetSession Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CInternetSession\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CInternetSession class\"\n  - \"Internet sessions\"\nms.assetid: ef54feb4-9d0f-4e65-a45d-7a4cf6c40e51\ncaps.latest.revision: 25\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CInternetSession Class\nCreates and initializes a single or several simultaneous Internet sessions and, if necessary, describes your connection to a proxy server.  \n  \n## Syntax  \n  \n```  \nclass CInternetSession : public CObject  \n```  \n  \n## Members  \n  \n### Public Constructors  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CInternetSession::CInternetSession](#cinternetsession__cinternetsession)|Constructs a `CInternetSession` object.|  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CInternetSession::Close](#cinternetsession__close)|Closes the Internet connection when the Internet session is terminated.|  \n|[CInternetSession::EnableStatusCallback](#cinternetsession__enablestatuscallback)|Establishes a status callback routine.|  \n|[CInternetSession::GetContext](#cinternetsession__getcontext)|Closes the Internet connection when the Internet session is terminated.|  \n|[CInternetSession::GetCookie](#cinternetsession__getcookie)|Returns cookies for the specified URL and all its parent URLs.|  \n|[CInternetSession::GetCookieLength](#cinternetsession__getcookielength)|Retrieves the variable specifying the length of the cookie stored in the buffer.|  \n|[CInternetSession::GetFtpConnection](#cinternetsession__getftpconnection)|Opens an FTP session with a server. Logs on the user.|  \n|[CInternetSession::GetGopherConnection](#cinternetsession__getgopherconnection)|Opens a gopher server for an application that is trying to open a connection.|  \n|[CInternetSession::GetHttpConnection](#cinternetsession__gethttpconnection)|Opens an HTTP server for an application that is trying to open a connection.|  \n|[CInternetSession::OnStatusCallback](#cinternetsession__onstatuscallback)|Updates the status of an operation when status callback is enabled.|  \n|[CInternetSession::OpenURL](#cinternetsession__openurl)|Parses and opens a URL.|  \n|[CInternetSession::SetCookie](#cinternetsession__setcookie)|Sets a cookie for the specified URL.|  \n|[CInternetSession::SetOption](#cinternetsession__setoption)|Sets options for the Internet session.|  \n  \n### Public Operators  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CInternetSession::operator HINTERNET](#cinternetsession__operator_hinternet)|A handle to the current Internet session.|  \n  \n## Remarks  \n If your Internet connection must be maintained for the duration of an application, you can create a `CInternetSession` member of the class [CWinApp](../../mfc/reference/cwinapp-class.md).  \n  \n Once you have established an Internet session, you can call [OpenURL](#cinternetsession__openurl). `CInternetSession` then parses the URL for you by calling the global function [AfxParseURL](http://msdn.microsoft.com/library/505c717e-aa52-4106-8522-eedff3d9bbae). Regardless of its protocol type, `CInternetSession` interprets the URL and manages it for you. It can handle requests for local files identified with the URL resource \"file://\". `OpenURL` will return a pointer to a [CStdioFile](../../mfc/reference/cstdiofile-class.md) object if the name you pass it is a local file.  \n  \n If you open a URL on an Internet server using `OpenURL`, you can read information from the site. If you want to perform service-specific (for example, HTTP, FTP, or gopher) actions on files located on a server, you must establish the appropriate connection with that server. To open a particular kind of connection directly to a particular service, use one of the following member functions:  \n  \n- [GetGopherConnection](#cinternetsession__getgopherconnection) to open a connection to a gopher service.  \n  \n- [GetHttpConnection](#cinternetsession__gethttpconnection) to open a connection to an HTTP service.  \n  \n- [GetFtpConnection](#cinternetsession__getftpconnection) to open a connection to an FTP service.  \n  \n [SetOption](#cinternetsession__setoption) allows you to set the query options of your session, such as time-out values, number of retries, and so on.  \n  \n `CInternetSession` member functions [SetCookie](#cinternetsession__setcookie), [GetCookie](#cinternetsession__getcookie), and [GetCookieLength](#cinternetsession__getcookielength) provide the means to manage a Win32 cookie database, through which servers and scripts maintain state information about the client workstation.  \n  \n For more information about basic Internet programming tasks, see the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md). For general information about using the MFC WinInet classes, see the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md).  \n  \n> [!NOTE]\n> `CInternetSession` will throw an [AfxThrowNotSupportedException](exception-processing.md#afxthrownotsupportedexception) for unsupported service types. Only the following service types are currently supported: FTP, HTTP, gopher, and file.  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n `CInternetSession`  \n  \n## Requirements  \n **Header:** afxinet.h  \n  \n##  <a name=\"cinternetsession__cinternetsession\"></a>  CInternetSession::CInternetSession  \n This member function is called when a `CInternetSession` object is created.  \n  \n```  \nCInternetSession(\n    LPCTSTR pstrAgent = NULL,  \n    DWORD_PTR dwContext = 1,  \n    DWORD dwAccessType = PRE_CONFIG_INTERNET_ACCESS,  \n    LPCTSTR pstrProxyName = NULL,  \n    LPCTSTR pstrProxyBypass = NULL,  \n    DWORD dwFlags = 0);\n```  \n  \n### Parameters  \n `pstrAgent`  \n A pointer to a string that identifies the name of the application or entity calling the Internet functions (for example, \"Microsoft Internet Browser\"). If `pstrAgent` is **NULL** (the default), the framework calls the global function [AfxGetAppName](application-information-and-management.md#afxgetappname), which returns a null-terminated string containing an application's name. Some protocols use this string to identify your application to the server.  \n  \n `dwContext`  \n The context identifier for the operation. `dwContext` identifies the operation's status information returned by [CInternetSession::OnStatusCallback](#cinternetsession__onstatuscallback). The default is set to 1; however, you can explicitly assign a specific context ID for the operation. The object and any work it does will be associated with that context ID.  \n  \n `dwAccessType`  \n The type of access required. The following are valid values, exactly one of which may be supplied:  \n  \n- **INTERNET_OPEN_TYPE_PRECONFIG** Connect using preconfigured settings in the registry. This access type is set as the default. To connect through a TIS proxy, set `dwAccessType` to this value; you then set the registry appropriately.  \n  \n- `INTERNET_OPEN_TYPE_DIRECT` Connect directly to Internet.  \n  \n- `INTERNET_OPEN_TYPE_PROXY` Connect through a CERN proxy.  \n  \n For information on connecting with different types of proxies, see [Steps in a Typical FTP Client Application](../../mfc/steps-in-a-typical-ftp-client-application.md).  \n  \n *pstrProxyName*  \n The name of the preferred CERN proxy if `dwAccessType` is set as `INTERNET_OPEN_TYPE_PROXY`. The default is **NULL**.  \n  \n *pstrProxyBypass*  \n A pointer to a string containing an optional list of server addresses. These addresses may be bypassed when using proxy access. If a **NULL** value is supplied, the bypass list will be read from the registry. This parameter is meaningful only if `dwAccessType` is set to `INTERNET_OPEN_TYPE_PROXY`.  \n  \n `dwFlags`  \n Indicates various caching options. The default is set to 0. The possible values include:  \n  \n- `INTERNET_FLAG_DONT_CACHE` Do not cache the data, either locally or in any gateway servers.  \n  \n- `INTERNET_FLAG_OFFLINE` Download operations are satisfied through the persistent cache only. If the item does not exist in the cache, an appropriate error code is returned. This flag may be combined with the bitwise `OR` ( **&#124;**) operator.  \n  \n### Remarks  \n **CInternetSession** is the first Internet function called by an application. It initializes internal data structures and prepares for future calls from the application.  \n  \n If no Internet connection can be opened, `CInternetSession` throws an [AfxThrowInternetException](http://msdn.microsoft.com/library/c9645b10-9541-48b2-8b0c-94ca33fed3cb).  \n  \n### Example  \n  See the example for [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md).  \n  \n##  <a name=\"cinternetsession__close\"></a>  CInternetSession::Close  \n Call this member function when your application has finished using the `CInternetSession` object.  \n  \n```  \nvirtual void Close();\n```  \n  \n### Example  \n  See the example for [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md).  \n  \n##  <a name=\"cinternetsession__enablestatuscallback\"></a>  CInternetSession::EnableStatusCallback  \n Call this member function to enable status callback.  \n  \n```  \nBOOL EnableStatusCallback(BOOL bEnable = TRUE);\n```  \n  \n### Parameters  \n `bEnable`  \n Specifies whether callback is enabled or disabled. The default is **TRUE**.  \n  \n### Return Value  \n Nonzero if successful; otherwise 0. If the call fails, determine the cause of the failure by examining the thrown [CInternetException](../../mfc/reference/cinternetexception-class.md) object.  \n  \n### Remarks  \n When handling status callback, you can provide status about the progress of the operation (such as resolving name, connecting to server, and so on) in the status bar of the application. Displaying operation status is especially desirable during a long-term operation.  \n  \n Because callbacks occur during the request's processing, the application should spend as little time as possible in the callback to prevent degradation of data throughput to the network. For example, putting up a dialog box in a callback may be such a lengthy operation that the server terminates the request.  \n  \n The status callback cannot be removed as long as any callbacks are pending.  \n  \n To handle any operations asynchronously, you must either create your own thread or use the WinInet functions without MFC.  \n  \n##  <a name=\"cinternetsession__getcontext\"></a>  CInternetSession::GetContext  \n Call this member function to get the context value for a particular application session.  \n  \n```  \nDWORD_PTR GetContext() const;\n\n \n```  \n  \n### Return Value  \n The application-defined context Identifier.  \n  \n### Remarks  \n [OnStatusCallback](#cinternetsession__onstatuscallback) uses the context ID returned by **GetContext** to report the status of a particular application. For example, when a user activates an Internet request that involves returning status information, the status callback uses the context ID to report status on that particular request. If the user activates two separate Internet requests that both involve returning status information, `OnStatusCallback` uses the context identifiers to return status about their corresponding requests. Consequently, the context identifier is used for all status callback operations, and it is associated with the session until the session is ended.  \n  \n For more information about asynchronous operations, see the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md).  \n  \n##  <a name=\"cinternetsession__getcookie\"></a>  CInternetSession::GetCookie  \n This member function implements the behavior of the Win32 function [InternetGetCookie](http://msdn.microsoft.com/library/windows/desktop/aa384710), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n```  \nstatic BOOL GetCookie(\n    LPCTSTR pstrUrl,  \n    LPCTSTR pstrCookieName,  \n    LPTSTR pstrCookieData,  \n    DWORD dwBufLen);\n\n \nstatic BOOL GetCookie(\n    LPCTSTR pstrUrl,  \n    LPCTSTR pstrCookieName,  \n    CString& strCookieData);\n```  \n  \n### Parameters  \n `pstrUrl`  \n A pointer to a string containing the URL.  \n  \n `pstrCookieName`  \n A pointer to a string containing the name of the cookie to get for the specified URL.  \n  \n `pstrCookieData`  \n In the first overload, a pointer to a string containing the address of the buffer that receives the cookie data. This value can be **NULL**. In the second overload, a reference to a [CString](../../atl-mfc-shared/reference/cstringt-class.md) object to receive the cookie data.  \n  \n `dwBufLen`  \n The variable specifying the size of the `pstrCookieData` buffer. If the function succeeds, the buffer receives the amount of data copied to the `pstrCookieData` buffer. If `pstrCookieData` is **NULL**, this parameter receives a value that specifies the size of the buffer necessary to copy all the cookie data.  \n  \n### Return Value  \n Returns **TRUE** if successful, or **FALSE** otherwise. If the call fails, call the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) to determine the cause of the error. The following error values apply:  \n  \n- **ERROR_NO_MORE_ITEMS** There is no cookie for the specified URL and all its parents.  \n  \n- **ERROR_INSUFFICIENT_BUFFER** The value passed in `dwBufLen` is insufficient to copy all the cookie data. The value returned in `dwBufLen` is the size of the buffer necessary to get all the data.  \n  \n### Remarks  \n In the second overload, MFC retrieves the cookie data into the supplied `CString` object.  \n  \n##  <a name=\"cinternetsession__getcookielength\"></a>  CInternetSession::GetCookieLength  \n Call this member function to get the length of the cookie stored in the buffer.  \n  \n```  \nstatic DWORD GetCookieLength(\n    LPCTSTR pstrUrl,  \n    LPCTSTR pstrCookieName);\n```  \n  \n### Parameters  \n `pstrUrl`  \n A pointer to a string containing the URL  \n  \n `pstrCookieName`  \n A pointer to a string containing the name of the cookie.  \n  \n### Return Value  \n A `DWORD` value indicating the length of the cookie, stored in the buffer. Zero if no cookie with the name indicated by `pstrCookieName` exists.  \n  \n### Remarks  \n This value is used by [GetCookie](#cinternetsession__getcookie).  \n  \n##  <a name=\"cinternetsession__getftpconnection\"></a>  CInternetSession::GetFtpConnection  \n Call this member function to establish an FTP connection and get a pointer to a `CFtpConnection` object.  \n  \n```  \nCFtpConnection* GetFtpConnection(\n    LPCTSTR pstrServer,  \n    LPCTSTR pstrUserName = NULL,  \n    LPCTSTR pstrPassword = NULL,  \n    INTERNET_PORT nPort = INTERNET_INVALID_PORT_NUMBER,  \n    BOOL bPassive = FALSE);\n```  \n  \n### Parameters  \n `pstrServer`  \n A pointer to a string containing the FTP server name.  \n  \n `pstrUserName`  \n Pointer to a null-terminated string that specifies the name of the user to log in. If **NULL**, the default is anonymous.  \n  \n `pstrPassword`  \n A pointer to a null-terminated string that specifies the password to use to log in. If both `pstrPassword` and `pstrUserName` are **NULL**, the default anonymous password is the user's email name. If `pstrPassword` is **NULL** (or an empty string) but `pstrUserName` is not **NULL**, a blank password is used. The following table describes the behavior for the four possible settings of `pstrUserName` and `pstrPassword`:  \n  \n|`pstrUserName`|`pstrPassword`|Username sent to FTP server|Password sent to FTP server|  \n|--------------------|--------------------|---------------------------------|---------------------------------|  \n|**NULL** or \" \"|**NULL** or \" \"|\"anonymous\"|User's email name|  \n|Non- **NULL** String|**NULL** or \" \"|`pstrUserName`|\" \"|  \n|**NULL** Non- **NULL** String|**ERROR**|**ERROR**||  \n|Non- **NULL** String|Non- **NULL** String|`pstrUserName`|`pstrPassword`|  \n  \n `nPort`  \n A number that identifies the TCP/IP port to use on the server.  \n  \n `bPassive`  \n Specifies passive or active mode for this FTP session. If set to **TRUE**, it sets the Win32 API `dwFlag` to **INTERNET_FLAG_PASSIVE**.  \n  \n### Return Value  \n A pointer to a [CFtpConnection](../../mfc/reference/cftpconnection-class.md) object. If the call fails, determine the cause of the failure by examining the thrown [CInternetException](../../mfc/reference/cinternetexception-class.md) object.  \n  \n### Remarks  \n `GetFtpConnection` connects to an FTP server, and creates and returns a pointer to a **CFTPConnection** object. It does not perform any specific operation on the server. If you intend to read or write to files, for example, you must perform those operations as separate steps. See the classes [CFtpConnection](../../mfc/reference/cftpconnection-class.md) and [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md) for information about searching for files, opening files, and reading or writing to files. See the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md) for steps in performing common FTP connection tasks.  \n  \n### Example  \n  See the example for [CFtpFileFind](../../mfc/reference/cftpfilefind-class.md).  \n  \n##  <a name=\"cinternetsession__getgopherconnection\"></a>  CInternetSession::GetGopherConnection  \n Call this member function to establish a new gopher connection and get a pointer to a `CGopherConnection` object.  \n  \n```  \nCGopherConnection* GetGopherConnection(\n    LPCTSTR pstrServer,  \n    LPCTSTR pstrUserName = NULL,  \n    LPCTSTR pstrPassword = NULL,  \n    INTERNET_PORT nPort = INTERNET_INVALID_PORT_NUMBER);\n```  \n  \n### Parameters  \n `pstrServer`  \n A pointer to a string containing the gopher server name.  \n  \n `pstrUserName`  \n A pointer to a string containing the user name.  \n  \n `pstrPassword`  \n A pointer to a string containing the access password.  \n  \n `nPort`  \n A number that identifies the TCP/IP port to use on the server.  \n  \n### Return Value  \n A pointer to a [CGopherConnection](../../mfc/reference/cgopherconnection-class.md) object. If the call fails, determine the cause of the failure by examining the thrown [CInternetException](../../mfc/reference/cinternetexception-class.md) object.  \n  \n### Remarks  \n `GetGopherConnection` connects to a gopher server, and creates and returns a pointer to a `CGopherConnection` object. It does not perform any specific operation on the server. If you intend to read or write data, for example, you must perform those operations as separate steps. See the classes [CGopherConnection](../../mfc/reference/cgopherconnection-class.md), [CGopherFile](../../mfc/reference/cgopherfile-class.md), and [CGopherFileFind](../../mfc/reference/cgopherfilefind-class.md) for information about searching for files, opening files, and reading or writing to files. For information about browsing an FTP site, see the member function [OpenURL](#cinternetsession__openurl). See the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md) for steps in performing common gopher connection tasks.  \n  \n##  <a name=\"cinternetsession__gethttpconnection\"></a>  CInternetSession::GetHttpConnection  \n Call this member function to establish an HTTP connection and get a pointer to a `CHttpConnection` object.  \n  \n```  \nCHttpConnection* GetHttpConnection(\n    LPCTSTR pstrServer,  \n    INTERNET_PORT nPort = INTERNET_INVALID_PORT_NUMBER,  \n    LPCTSTR pstrUserName = NULL,  \n    LPCTSTR pstrPassword = NULL);\n\n \nCHttpConnection* GetHttpConnection(\n    LPCTSTR pstrServer,  \n    DWORD dwFlags,  \n    INTERNET_PORT nPort = INTERNET_INVALID_PORT_NUMBER,  \n    LPCTSTR pstrUserName = NULL,  \n    LPCTSTR pstrPassword = NULL);\n```  \n  \n### Parameters  \n `pstrServer`  \n A pointer to a string containing the HTTP server name.  \n  \n `nPort`  \n A number that identifies the TCP/IP port to use on the server.  \n  \n `pstrUserName`  \n A pointer to a string containing the user name.  \n  \n `pstrPassword`  \n A pointer to a string containing the access password.  \n  \n *dwflags*  \n Any combination of the **INTERNET_ FLAG_\\*** flags. See the table in the **Remarks** section of [CHttpConnection::OpenRequest](../../mfc/reference/chttpconnection-class.md#chttpconnection__openrequest) for a description of `dwFlags` values.  \n  \n### Return Value  \n A pointer to a [CHttpConnection](../../mfc/reference/chttpconnection-class.md) object. If the call fails, determine the cause of the failure by examining the thrown [CInternetException](../../mfc/reference/cinternetexception-class.md) object.  \n  \n### Remarks  \n `GetHttpConnection` connects to an HTTP server, and creates and returns a pointer to a `CHttpConnection` object. It does not perform any specific operation on the server. If you intend to query an HTTP header, for example, you must perform this operation as a separate step. See the classes [CHttpConnection](../../mfc/reference/chttpconnection-class.md) and [CHttpFile](../../mfc/reference/chttpfile-class.md) for information about operations you can perform by using a connection to an HTTP server. For information about browsing an HTTP site, see the member function [OpenURL](#cinternetsession__openurl). See the article [Internet Programming with WinInet](../../mfc/win32-internet-extensions-wininet.md) for steps in performing common HTTP connection tasks.  \n  \n##  <a name=\"cinternetsession__onstatuscallback\"></a>  CInternetSession::OnStatusCallback  \n This member function is called by the framework to update the status when status callback is enabled and an operation is pending.  \n  \n```  \nvirtual void OnStatusCallback(\n    DWORD_PTR dwContext,  \n    DWORD dwInternetStatus,  \n    LPVOID lpvStatusInformation,  \n    DWORD dwStatusInformationLength);\n```  \n  \n### Parameters  \n `dwContext`  \n The context value supplied by the application.  \n  \n `dwInternetStatus`  \n A status code which indicates why the callback is being made. See **Remarks** for a table of possible values.  \n  \n `lpvStatusInformation`  \n A pointer to a buffer containing information pertinent to this callback.  \n  \n `dwStatusInformationLength`  \n The size of `lpvStatusInformation`.  \n  \n### Remarks  \n You must first call [EnableStatusCallback](#cinternetsession__enablestatuscallback) to take advantage of status callback.  \n  \n The `dwInternetStatus` parameter indicates the operation being performed and determines what the contents of `lpvStatusInformation` will be. `dwStatusInformationLength` indicates the length of the data included in `lpvStatusInformation`. The following status values for `dwInternetStatus` are defined as follows:  \n  \n|Value|Meaning|  \n|-----------|-------------|  \n|`INTERNET_STATUS_RESOLVING_NAME`|Looking up the IP address of the name contained in `lpvStatusInformation`.|  \n|`INTERNET_STATUS_NAME_RESOLVED`|Successfully found the IP address of the name contained in `lpvStatusInformation`.|  \n|`INTERNET_STATUS_CONNECTING_TO_SERVER`|Connecting to the socket address ( [SOCKADDR](../../mfc/reference/sockaddr-structure.md)) pointed to by `lpvStatusInformation`.|  \n|`INTERNET_STATUS_CONNECTED_TO_SERVER`|Successfully connected to the socket address ( `SOCKADDR`) pointed to by `lpvStatusInformation`.|  \n|`INTERNET_STATUS_SENDING_REQUEST`|Sending the information request to the server. The `lpvStatusInformation` parameter is **NULL**.|  \n|**INTERNET_STATUS_ REQUEST_SENT**|Successfully sent the information request to the server. The `lpvStatusInformation` parameter is **NULL**.|  \n|`INTERNET_STATUS_RECEIVING_RESPONSE`|Waiting for the server to respond to a request. The `lpvStatusInformation` parameter is **NULL**.|  \n|`INTERNET_STATUS_RESPONSE_RECEIVED`|Successfully received a response from the server. The `lpvStatusInformation` parameter is **NULL**.|  \n|`INTERNET_STATUS_CLOSING_CONNECTION`|Closing the connection to the server. The `lpvStatusInformation` parameter is **NULL**.|  \n|`INTERNET_STATUS_CONNECTION_CLOSED`|Successfully closed the connection to the server. The `lpvStatusInformation` parameter is **NULL**.|  \n|`INTERNET_STATUS_HANDLE_CREATED`|Used by the Win32 API function [InternetConnect](http://msdn.microsoft.com/library/windows/desktop/aa384363) to indicate that it has created the new handle. This lets the application call the Win32 function [InternetCloseHandle](http://msdn.microsoft.com/library/windows/desktop/aa384350) from another thread if the connect is taking too long. See the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]for more information about these functions.|  \n|`INTERNET_STATUS_HANDLE_CLOSING`|Successfully terminated this handle value.|  \n  \n Override this member function to require some action before a status callback routine is performed.  \n  \n> [!NOTE]\n>  Status callbacks need thread-state protection. If you are using MFC in a shared library, add the following line to the beginning of your override:  \n  \n [!code-cpp[NVC_MFCHtmlHttp#8](../../mfc/reference/codesnippet/cpp/cinternetsession-class_1.cpp)]  \n  \n For more information about asynchronous operations, see the article [Internet First Steps: WinInet](../../mfc/wininet-basics.md).  \n  \n##  <a name=\"cinternetsession__openurl\"></a>  CInternetSession::OpenURL  \n Call this member function to send the specified request to the HTTP server and allow the client to specify additional RFC822, MIME, or HTTP headers to send along with the request.  \n  \n```  \nCStdioFile* OpenURL(\n    LPCTSTR pstrURL,  \n    DWORD_PTR dwContext = 1,  \n    DWORD dwFlags = INTERNET_FLAG_TRANSFER_ASCII,  \n    LPCTSTR pstrHeaders = NULL,  \n    DWORD dwHeadersLength = 0);\n```  \n  \n### Parameters  \n *pstrURL*  \n A pointer to the name of the URL to begin reading. Only URLs beginning with file:, ftp:, gopher:, or http: are supported. **ASSERTS** if *pszURL* is **NULL**.  \n  \n `dwContext`  \n An application-defined value passed with the returned handle in callback.  \n  \n `dwFlags`  \n The flags describing how to handle this connection. See **Remarks** for more information about the valid flags. The valid flags are:  \n  \n- **INTERNET_FLAG_TRANSFER_ASCII** The default. Transfer the file as ASCII text.  \n  \n- **INTERNET_FLAG_TRANSFER_BINARY** Transfer the file as a binary file.  \n  \n- `INTERNET_FLAG_RELOAD` Get the data from the wire even if it is locally cached.  \n  \n- `INTERNET_FLAG_DONT_CACHE` Do not cache the data, either locally or in any gateways.  \n  \n- `INTERNET_FLAG_SECURE` This flag is applicable to HTTP requests only. It requests secure transactions on the wire with Secure Sockets Layer or PCT.  \n  \n- **INTERNET_OPEN_FLAG_USE_EXISTING_CONNECT** If possible, reuse the existing connections to the server for new requests generated by **OpenUrl** instead of creating a new session for each connection request.  \n  \n- **INTERNET_FLAG_PASSIVE** Used for an FTP site. Uses passive FTP semantics. Used with [CInternetConnection](../../mfc/reference/cinternetconnection-class.md) of `OpenURL`.  \n  \n `pstrHeaders`  \n A pointer to a string containing the headers to be sent to the HTTP server.  \n  \n *dwHeadersLength*  \n The length, in characters, of the additional headers. If this is -1L and `pstrHeaders` is non- **NULL**, then `pstrHeaders` is assumed to be zero terminated and the length is calculated.  \n  \n### Return Value  \n Returns a file handle for FTP, GOPHER, HTTP, and FILE-type Internet services only. Returns **NULL** if parsing was unsuccessful.  \n  \n The pointer that `OpenURL` returns depends on *pszURL*'s type of service. The table below illustrates the possible pointers `OpenURL` can return.  \n  \n|URL type|Returns|  \n|--------------|-------------|  \n|file://|**CStdioFile\\***|  \n|http://|**CHttpFile\\***|  \n|gopher://|**CGopherFile\\***|  \n|ftp://|**CInternetFile\\***|  \n  \n### Remarks  \n The parameter `dwFlags` must include either **INTERNET_FLAG_TRANSFER_ASCII** or **INTERNET_FLAG_TRANSFER_BINARY**, but not both. The remaining flags can be combined with the bitwise `OR` operator ( **&#124;**).  \n  \n `OpenURL`, which wraps the Win32 function **InternetOpenURL**, allows only downloading, retrieving, and reading the data from an Internet server. `OpenURL` allows no file manipulation on a remote location, so it requires no [CInternetConnection](../../mfc/reference/cinternetconnection-class.md) object.  \n  \n To use connection-specific (that is, protocol-specific) functions, such as writing to a file, you must open a session, then open a particular kind of connection, then use that connection to open a file in the desired mode. See `CInternetConnection` for more information about connection-specific functions.  \n  \n##  <a name=\"cinternetsession__operator_hinternet\"></a>  CInternetSession::operator HINTERNET  \n Use this operator to get the Windows handle for the current Internet session.  \n  \n```  \noperator HINTERNET() const;\n\n \n```  \n  \n##  <a name=\"cinternetsession__setcookie\"></a>  CInternetSession::SetCookie  \n Sets a cookie for the specified URL.  \n  \n```  \nstatic BOOL SetCookie(\n    LPCTSTR pstrUrl,  \n    LPCTSTR pstrCookieName,  \n    LPCTSTR pstrCookieData);\n```  \n  \n### Parameters  \n `pstrUrl`  \n A pointer to a null-terminated string that specifies the URL for which the cookie should be set.  \n  \n `pstrCookieName`  \n A pointer to a string containing the name of the cookie.  \n  \n `pstrCookieData`  \n A pointer to a string containing the actual string data to associate with the URL.  \n  \n### Return Value  \n Returns **TRUE** if successful, or **FALSE** otherwise. To get the specific error code, call **GetLastError.**  \n  \n### Remarks  \n This member function implements the behavior of the Win32 message [InternetSetCookie](http://msdn.microsoft.com/library/windows/desktop/aa385107), as described in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  \n  \n##  <a name=\"cinternetsession__setoption\"></a>  CInternetSession::SetOption  \n Call this member function to set options for the Internet session.  \n  \n```  \nBOOL SetOption(\n    DWORD dwOption,  \n    LPVOID lpBuffer,  \n    DWORD dwBufferLength,  \n    DWORD dwFlags = 0);\n\n \nBOOL SetOption(\n    DWORD dwOption,  \n    DWORD dwValue,  \n    DWORD dwFlags = 0);\n```  \n  \n### Parameters  \n `dwOption`  \n The Internet option to set. See [Option Flags](http://msdn.microsoft.com/library/windows/desktop/aa385328) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]for a list of the possible options.  \n  \n `lpBuffer`  \n A buffer that contains the option setting.  \n  \n *dwBufferLength*  \n The length of `lpBuffer` or the size of `dwValue`.  \n  \n `dwValue`  \n A `DWORD` that contains the option setting.  \n  \n `dwFlags`  \n Indicates various caching options. The default is set to 0. The possible values include:  \n  \n- `INTERNET_FLAG_DONT_CACHE` Do not cache the data, either locally or in any gateway servers.  \n  \n- `INTERNET_FLAG_OFFLINE` Download operations are satisfied through the persistent cache only. If the item does not exist in the cache, an appropriate error code is returned. This flag may be combined with the bitwise `OR` ( **&#124;**) operator.  \n  \n### Return Value  \n If the operation was successful, a value of **TRUE** is returned. If an error occurred, a value of **FALSE** is returned. If the call fails, the Win32 function [GetLastError](http://msdn.microsoft.com/library/windows/desktop/ms679360) may be called to determine the cause of the error.  \n  \n## See Also  \n [CObject Class](../../mfc/reference/cobject-class.md)   \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [CInternetConnection Class](../../mfc/reference/cinternetconnection-class.md)   \n [CHttpConnection Class](../../mfc/reference/chttpconnection-class.md)   \n [CFtpConnection Class](../../mfc/reference/cftpconnection-class.md)   \n [CGopherConnection Class](../../mfc/reference/cgopherconnection-class.md)\n"}