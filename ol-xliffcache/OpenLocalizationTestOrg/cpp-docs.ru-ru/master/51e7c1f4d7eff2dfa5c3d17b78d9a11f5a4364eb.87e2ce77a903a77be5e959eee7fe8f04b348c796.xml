{"nodes":[{"pos":[12,48],"content":"MAPI Support in MFC | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MAPI Support in MFC | Microsoft Docs","pos":[0,36]}]},{"content":"MAPI Support in MFC","pos":[711,730]},{"content":"MFC supplies support for a subset of the Microsoft Messaging Application Program Interface (MAPI) in class <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept>.","pos":[731,852],"source":"MFC supplies support for a subset of the Microsoft Messaging Application Program Interface (MAPI) in class **CDocument**."},{"content":"Specifically, <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> has member functions that determine whether mail support is present on the end-user's machine and, if so, enable a Send Mail command whose standard command ID is <bpt id=\"p2\">**</bpt>ID_FILE_SEND_MAIL<ept id=\"p2\">**</ept>.","pos":[853,1065],"source":" Specifically, **CDocument** has member functions that determine whether mail support is present on the end-user's machine and, if so, enable a Send Mail command whose standard command ID is **ID_FILE_SEND_MAIL**."},{"content":"The MFC handler function for this command allows the user to send a document through electronic mail.","pos":[1066,1167]},{"pos":[1175,1361],"content":"[!TIP]\n Although MFC does not encapsulate the entire MAPI function set, you can still call MAPI functions directly, just as you can call Win32 API functions directly from MFC programs.","leadings":["","> "],"nodes":[{"content":"Although MFC does not encapsulate the entire MAPI function set, you can still call MAPI functions directly, just as you can call Win32 API functions directly from MFC programs.","pos":[8,184]}]},{"content":"Providing the Send Mail command in your application is very easy.","pos":[1368,1433]},{"content":"MFC provides the implementation to package a document (that is, a <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept>-derived object) as an attachment and send it as mail.","pos":[1434,1567],"source":" MFC provides the implementation to package a document (that is, a **CDocument**-derived object) as an attachment and send it as mail."},{"content":"This attachment is equivalent to a File Save command that saves (serializes) the document's contents to the mail message.","pos":[1568,1689]},{"content":"This implementation calls upon the mail client on the user's machine to give the user the opportunity to address the mail and to add subject and message text to the mail message.","pos":[1690,1868]},{"content":"Users see their familiar mail application's user interface.","pos":[1869,1928]},{"content":"This functionality is supplied by two <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> member functions: <ph id=\"ph1\">`OnFileSendMail`</ph> and <ph id=\"ph2\">`OnUpdateFileSendMail`</ph>.","pos":[1929,2043],"source":" This functionality is supplied by two **CDocument** member functions: `OnFileSendMail` and `OnUpdateFileSendMail`."},{"content":"MAPI needs to read the file to send the attachment.","pos":[2050,2101]},{"content":"If the application keeps its data file open during an <ph id=\"ph1\">`OnFileSendMail`</ph> function call, the file needs to be opened with a share mode that allows multiple processes to access the file.","pos":[2102,2284],"source":" If the application keeps its data file open during an `OnFileSendMail` function call, the file needs to be opened with a share mode that allows multiple processes to access the file."},{"pos":[2292,2407],"content":"[!NOTE]\n An overriding version of `OnFileSendMail` for class `COleDocument` correctly handles compound documents.","leadings":["","> "],"nodes":[{"content":"An overriding version of <ph id=\"ph1\">`OnFileSendMail`</ph> for class <ph id=\"ph2\">`COleDocument`</ph> correctly handles compound documents.","pos":[9,113],"source":" An overriding version of `OnFileSendMail` for class `COleDocument` correctly handles compound documents."}]},{"content":"To implement a Send Mail command with MFC","pos":[2418,2459]},{"pos":[2469,2561],"content":"Use the Visual C++ menu editor to add a menu item whose command ID is <bpt id=\"p1\">**</bpt>ID_FILE_SEND_MAIL<ept id=\"p1\">**</ept>.","source":"Use the Visual C++ menu editor to add a menu item whose command ID is **ID_FILE_SEND_MAIL**."},{"content":"This command ID is provided by the framework in AFXRES.H.","pos":[2572,2629]},{"content":"The command can be added to any menu, but it is usually added to the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu.","pos":[2630,2713],"source":" The command can be added to any menu, but it is usually added to the **File** menu."},{"content":"Manually add the following to your document's message map:","pos":[2723,2781]},{"pos":[2803,2819],"content":"NVC_MFCDocView#9"},{"pos":[2883,3105],"content":"[!NOTE]\n This message map works for a document derived from either **CDocument** or **COleDocument** — it picks up the correct base class in either case, even though the message map is in your derived document class.","leadings":["","    > "],"nodes":[{"content":"This message map works for a document derived from either <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>COleDocument<ept id=\"p2\">**</ept> — it picks up the correct base class in either case, even though the message map is in your derived document class.","pos":[9,216],"source":" This message map works for a document derived from either **CDocument** or **COleDocument** — it picks up the correct base class in either case, even though the message map is in your derived document class."}]},{"content":"Build your application.","pos":[3115,3138]},{"content":"If mail support is available, MFC enables your menu item with <ph id=\"ph1\">`OnUpdateFileSendMail`</ph> and subsequently processes the command with <ph id=\"ph2\">`OnFileSendMail`</ph>.","pos":[3145,3291],"source":"If mail support is available, MFC enables your menu item with `OnUpdateFileSendMail` and subsequently processes the command with `OnFileSendMail`."},{"content":"If mail support is not available, MFC automatically removes your menu item so the user will not see it.","pos":[3292,3395]},{"pos":[3403,3665],"content":"[!TIP]\n Rather than manually adding message map entries as previously described, you can use the class Properties window to map messages to functions. For more information, see [Mapping Messages to Functions](../mfc/reference/mapping-messages-to-functions.md).","leadings":["","> "],"nodes":[{"content":" Rather than manually adding message map entries as previously described, you can use the class Properties window to map messages to functions. For more information, see [Mapping Messages to Functions](../mfc/reference/mapping-messages-to-functions.md).","pos":[7,260],"nodes":[{"content":"Rather than manually adding message map entries as previously described, you can use the class Properties window to map messages to functions.","pos":[1,143]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Mapping Messages to Functions<ept id=\"p1\">](../mfc/reference/mapping-messages-to-functions.md)</ept>.","pos":[144,253],"source":" For more information, see [Mapping Messages to Functions](../mfc/reference/mapping-messages-to-functions.md)."}]}]},{"pos":[3672,3737],"content":"For related information, see the <bpt id=\"p1\">[</bpt>MAPI<ept id=\"p1\">](../mfc/mapi.md)</ept> overview.","source":"For related information, see the [MAPI](../mfc/mapi.md) overview."},{"pos":[3744,3828],"content":"For more information about the <bpt id=\"p1\">**</bpt>CDocument<ept id=\"p1\">**</ept> member functions that enable MAPI, see:","source":"For more information about the **CDocument** member functions that enable MAPI, see:"},{"content":"CDocument::OnFileSendMail","pos":[3839,3864]},{"content":"CDocument::OnUpdateFileSendMail","pos":[3939,3970]},{"content":"COleDocument::OnFileSendMail","pos":[4051,4079]},{"content":"See Also","pos":[4158,4166]},{"content":"MAPI","pos":[4171,4175]}],"content":"---\ntitle: \"MAPI Support in MFC | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC, MAPI support\"\n  - \"MAPI support in MFC\"\n  - \"CDocument class, and MAPI\"\n  - \"OnUpdateFileSendMail method\"\n  - \"MAPI, MFC\"\n  - \"OnFileSendMail method\"\nms.assetid: cafbecb1-0427-4077-b4b8-159bae5b49b8\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MAPI Support in MFC\nMFC supplies support for a subset of the Microsoft Messaging Application Program Interface (MAPI) in class **CDocument**. Specifically, **CDocument** has member functions that determine whether mail support is present on the end-user's machine and, if so, enable a Send Mail command whose standard command ID is **ID_FILE_SEND_MAIL**. The MFC handler function for this command allows the user to send a document through electronic mail.  \n  \n> [!TIP]\n>  Although MFC does not encapsulate the entire MAPI function set, you can still call MAPI functions directly, just as you can call Win32 API functions directly from MFC programs.  \n  \n Providing the Send Mail command in your application is very easy. MFC provides the implementation to package a document (that is, a **CDocument**-derived object) as an attachment and send it as mail. This attachment is equivalent to a File Save command that saves (serializes) the document's contents to the mail message. This implementation calls upon the mail client on the user's machine to give the user the opportunity to address the mail and to add subject and message text to the mail message. Users see their familiar mail application's user interface. This functionality is supplied by two **CDocument** member functions: `OnFileSendMail` and `OnUpdateFileSendMail`.  \n  \n MAPI needs to read the file to send the attachment. If the application keeps its data file open during an `OnFileSendMail` function call, the file needs to be opened with a share mode that allows multiple processes to access the file.  \n  \n> [!NOTE]\n>  An overriding version of `OnFileSendMail` for class `COleDocument` correctly handles compound documents.  \n  \n#### To implement a Send Mail command with MFC  \n  \n1.  Use the Visual C++ menu editor to add a menu item whose command ID is **ID_FILE_SEND_MAIL**.  \n  \n     This command ID is provided by the framework in AFXRES.H. The command can be added to any menu, but it is usually added to the **File** menu.  \n  \n2.  Manually add the following to your document's message map:  \n  \n     [!code-cpp[NVC_MFCDocView#9](../mfc/codesnippet/cpp/mapi-support-in-mfc_1.cpp)]  \n  \n    > [!NOTE]\n    >  This message map works for a document derived from either **CDocument** or **COleDocument** — it picks up the correct base class in either case, even though the message map is in your derived document class.  \n  \n3.  Build your application.  \n  \n If mail support is available, MFC enables your menu item with `OnUpdateFileSendMail` and subsequently processes the command with `OnFileSendMail`. If mail support is not available, MFC automatically removes your menu item so the user will not see it.  \n  \n> [!TIP]\n>  Rather than manually adding message map entries as previously described, you can use the class Properties window to map messages to functions. For more information, see [Mapping Messages to Functions](../mfc/reference/mapping-messages-to-functions.md).  \n  \n For related information, see the [MAPI](../mfc/mapi.md) overview.  \n  \n For more information about the **CDocument** member functions that enable MAPI, see:  \n  \n-   [CDocument::OnFileSendMail](../mfc/reference/cdocument-class.md#cdocument__onfilesendmail)  \n  \n-   [CDocument::OnUpdateFileSendMail](../mfc/reference/cdocument-class.md#cdocument__onupdatefilesendmail)  \n  \n-   [COleDocument::OnFileSendMail](../mfc/reference/coledocument-class.md#coledocument__onfilesendmail)  \n  \n## See Also  \n [MAPI](../mfc/mapi.md)\n\n"}