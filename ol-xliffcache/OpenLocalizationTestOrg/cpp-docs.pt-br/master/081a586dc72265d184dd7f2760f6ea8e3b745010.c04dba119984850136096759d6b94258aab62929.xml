{"nodes":[{"pos":[12,55],"content":"Drag and Drop: Customizing | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Drag and Drop: Customizing | Microsoft Docs","pos":[0,43]}]},{"content":"Drag and Drop: Customizing","pos":[786,812]},{"content":"The default implementation of the drag-and-drop feature is sufficient for most applications.","pos":[813,905]},{"content":"However, some applications may require that this standard behavior be changed.","pos":[906,984]},{"content":"This article explains the steps necessary to change these defaults.","pos":[985,1052]},{"content":"In addition, you can use this technique to establish applications that do not support compound documents as drop sources.","pos":[1053,1174]},{"content":"If you are customizing standard OLE drag-and-drop behavior, or you have a non-OLE application, you must create a <ph id=\"ph1\">`COleDataSource`</ph> object to contain the data.","pos":[1181,1338],"source":"If you are customizing standard OLE drag-and-drop behavior, or you have a non-OLE application, you must create a `COleDataSource` object to contain the data."},{"content":"When the user starts a drag-and-drop operation, your code should call the <ph id=\"ph1\">`DoDragDrop`</ph> function from this object instead of from other classes that support drag-and-drop operations.","pos":[1339,1520],"source":" When the user starts a drag-and-drop operation, your code should call the `DoDragDrop` function from this object instead of from other classes that support drag-and-drop operations."},{"content":"Optionally, you can create a <ph id=\"ph1\">`COleDropSource`</ph> object to control the drop and override some of its functions depending on the type of behavior you want to change.","pos":[1527,1688],"source":"Optionally, you can create a `COleDropSource` object to control the drop and override some of its functions depending on the type of behavior you want to change."},{"content":"This drop-source object is then passed to <ph id=\"ph1\">`COleDataSource::DoDragDrop`</ph> to change the default behavior of these functions.","pos":[1689,1810],"source":" This drop-source object is then passed to `COleDataSource::DoDragDrop` to change the default behavior of these functions."},{"content":"These different options allow a great deal of flexibility in how you support drag-and-drop operations in your application.","pos":[1811,1933]},{"content":"For more information about data sources, see the article <bpt id=\"p1\">[</bpt>Data Objects and Data Sources (OLE)<ept id=\"p1\">](../mfc/data-objects-and-data-sources-ole.md)</ept>.","pos":[1934,2074],"source":" For more information about data sources, see the article [Data Objects and Data Sources (OLE)](../mfc/data-objects-and-data-sources-ole.md)."},{"content":"You can override the following functions to customize drag-and-drop operations:","pos":[2081,2160]},{"content":"Override","pos":[2167,2175]},{"content":"To customize","pos":[2176,2188]},{"pos":[2245,2299],"content":"How dragging is initiated after you call <ph id=\"ph1\">`DoDragDrop`</ph>.","source":"How dragging is initiated after you call `DoDragDrop`."},{"content":"Visual feedback, such as cursor appearance, for different drop results.","pos":[2319,2390]},{"content":"The termination of a drag-and-drop operation.","pos":[2415,2460]},{"content":"This function enables you to check modifier key states during the drag operation.","pos":[2461,2542]},{"content":"See Also","pos":[2552,2560]},{"content":"Drag and Drop (OLE)","pos":[2565,2584]},{"content":"COleDropSource Class","pos":[2620,2640]},{"content":"COleDataSource Class","pos":[2689,2709]}],"content":"---\ntitle: \"Drag and Drop: Customizing | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"drag and drop, implementing in non-OLE applications\"\n  - \"drag and drop, customizing behavior\"\n  - \"drag and drop, COleDataSource object\"\n  - \"drag and drop, calling DoDragDrop\"\n  - \"OLE drag and drop, customizing behavior\"\nms.assetid: 03369d3e-46bf-4140-b58c-d0c9657cf38a\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Drag and Drop: Customizing\nThe default implementation of the drag-and-drop feature is sufficient for most applications. However, some applications may require that this standard behavior be changed. This article explains the steps necessary to change these defaults. In addition, you can use this technique to establish applications that do not support compound documents as drop sources.  \n  \n If you are customizing standard OLE drag-and-drop behavior, or you have a non-OLE application, you must create a `COleDataSource` object to contain the data. When the user starts a drag-and-drop operation, your code should call the `DoDragDrop` function from this object instead of from other classes that support drag-and-drop operations.  \n  \n Optionally, you can create a `COleDropSource` object to control the drop and override some of its functions depending on the type of behavior you want to change. This drop-source object is then passed to `COleDataSource::DoDragDrop` to change the default behavior of these functions. These different options allow a great deal of flexibility in how you support drag-and-drop operations in your application. For more information about data sources, see the article [Data Objects and Data Sources (OLE)](../mfc/data-objects-and-data-sources-ole.md).  \n  \n You can override the following functions to customize drag-and-drop operations:  \n  \n|Override|To customize|  \n|--------------|------------------|  \n|`OnBeginDrag`|How dragging is initiated after you call `DoDragDrop`.|  \n|`GiveFeedback`|Visual feedback, such as cursor appearance, for different drop results.|  \n|`QueryContinueDrag`|The termination of a drag-and-drop operation. This function enables you to check modifier key states during the drag operation.|  \n  \n## See Also  \n [Drag and Drop (OLE)](../mfc/drag-and-drop-ole.md)   \n [COleDropSource Class](../mfc/reference/coledropsource-class.md)   \n [COleDataSource Class](../mfc/reference/coledatasource-class.md)\n"}