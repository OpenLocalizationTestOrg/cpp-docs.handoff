{"nodes":[{"pos":[12,85],"content":"How to: Create the User Control and Host in a Dialog Box | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Create the User Control and Host in a Dialog Box | Microsoft Docs","pos":[0,73]}]},{"content":"How to: Create the User Control and Host in a Dialog Box","pos":[688,744]},{"pos":[745,999],"content":"The steps in this article assume that you are creating a dialog-based (<bpt id=\"p1\">[</bpt>CDialog Class<ept id=\"p1\">](../mfc/reference/cdialog-class.md)</ept>) Microsoft Foundation Classes (MFC) project, but you can also add support for a Windows Forms control to an existing MFC dialog box.","source":"The steps in this article assume that you are creating a dialog-based ([CDialog Class](../mfc/reference/cdialog-class.md)) Microsoft Foundation Classes (MFC) project, but you can also add support for a Windows Forms control to an existing MFC dialog box."},{"content":"To create the .NET user control","pos":[1009,1040]},{"pos":[1050,1143],"content":"Create a Visual C# Windows Forms Control Library project named <ph id=\"ph1\">`WindowsFormsControlLibrary1`</ph>.","source":"Create a Visual C# Windows Forms Control Library project named `WindowsFormsControlLibrary1`."},{"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","pos":[1154,1217],"source":"On the **File** menu, click **New** and then click **Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>Visual C#<ept id=\"p1\">**</ept> folder, select <bpt id=\"p2\">**</bpt>Windows Forms Control Library<ept id=\"p2\">**</ept>.","pos":[1218,1288],"source":" In the **Visual C#** folder, select **Windows Forms Control Library**."},{"pos":[1299,1372],"content":"Accept the <ph id=\"ph1\">`WindowsFormsControlLibrary1`</ph> project name by clicking <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Accept the `WindowsFormsControlLibrary1` project name by clicking **OK**."},{"pos":[1383,1447],"content":"By default, the name of the .NET control will be <ph id=\"ph1\">`UserControl1`</ph>.","source":"By default, the name of the .NET control will be `UserControl1`."},{"pos":[1457,1494],"content":"Add child controls to <ph id=\"ph1\">`UserControl1`</ph>.","source":"Add child controls to `UserControl1`."},{"content":"In the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, open the <bpt id=\"p2\">**</bpt>All Windows Forms<ept id=\"p2\">**</ept> list.","pos":[1505,1561],"source":"In the **Toolbox**, open the **All Windows Forms** list."},{"content":"Drag a <bpt id=\"p1\">**</bpt>Button<ept id=\"p1\">**</ept> control to the <ph id=\"ph1\">`UserControl1`</ph> design surface.","pos":[1562,1625],"source":" Drag a **Button** control to the `UserControl1` design surface."},{"pos":[1636,1667],"content":"Also add a <bpt id=\"p1\">**</bpt>TextBox<ept id=\"p1\">**</ept> control.","source":"Also add a **TextBox** control."},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>UserControl1.Designer.cs<ept id=\"p2\">**</ept> to open it for editing.","pos":[1677,1768],"source":"In **Solution Explorer**, double-click **UserControl1.Designer.cs** to open it for editing."},{"content":"Change the declarations of the TextBox and the Button from <ph id=\"ph1\">`private`</ph> to <ph id=\"ph2\">`public`</ph>.","pos":[1769,1850],"source":" Change the declarations of the TextBox and the Button from `private` to `public`."},{"content":"Build the project.","pos":[1860,1878]},{"pos":[1889,1937],"content":"On the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept>.","source":"On the **Build** menu, click **Build Solution**."},{"content":"To create the MFC host application","pos":[1947,1981]},{"content":"Create an MFC Application project.","pos":[1991,2025]},{"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","pos":[2036,2099],"source":"On the **File** menu, click **New** and then click **Project**."},{"content":"In the <bpt id=\"p1\">**</bpt>Visual C++<ept id=\"p1\">**</ept> folder, select <bpt id=\"p2\">**</bpt>MFC Application<ept id=\"p2\">**</ept>.","pos":[2100,2157],"source":" In the **Visual C++** folder, select **MFC Application**."},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <ph id=\"ph1\">`MFC01`</ph>.","pos":[2168,2202],"source":"In the **Name** box, type `MFC01`."},{"content":"Change the Solution setting to <bpt id=\"p1\">**</bpt>Add to Solution<ept id=\"p1\">**</ept>.","pos":[2203,2254],"source":" Change the Solution setting to **Add to Solution**."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[2255,2268],"source":" Click **OK**."},{"content":"In the <bpt id=\"p1\">**</bpt>MFC Application Wizard<ept id=\"p1\">**</ept>, for Application Type, select <bpt id=\"p2\">**</bpt>Dialog based<ept id=\"p2\">**</ept>.","pos":[2279,2360],"source":"In the **MFC Application Wizard**, for Application Type, select **Dialog based**."},{"content":"Accept the remaining default settings and click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","pos":[2361,2420],"source":" Accept the remaining default settings and click **Finish**."},{"content":"This creates an MFC application that has an MFC dialog box.","pos":[2421,2480]},{"content":"Add a placeholder control to the MFC dialog box.","pos":[2490,2538]},{"content":"On the <bpt id=\"p1\">**</bpt>View<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Resource View<ept id=\"p2\">**</ept>.","pos":[2549,2595],"source":"On the **View** menu, click **Resource View**."},{"content":"In <bpt id=\"p1\">**</bpt>Resource View<ept id=\"p1\">**</ept>, expand the <bpt id=\"p2\">**</bpt>Dialog<ept id=\"p2\">**</ept> folder and double-click <ph id=\"ph1\">`IDD_MFC01_DIALOG`</ph>.","pos":[2596,2683],"source":" In **Resource View**, expand the **Dialog** folder and double-click `IDD_MFC01_DIALOG`."},{"content":"The dialog resource appears in <bpt id=\"p1\">**</bpt>Resource Editor<ept id=\"p1\">**</ept>.","pos":[2684,2735],"source":" The dialog resource appears in **Resource Editor**."},{"content":"In the <bpt id=\"p1\">**</bpt>Toolbox<ept id=\"p1\">**</ept>, open the <bpt id=\"p2\">**</bpt>Dialog Editor<ept id=\"p2\">**</ept> list.","pos":[2746,2798],"source":"In the **Toolbox**, open the **Dialog Editor** list."},{"content":"Drag a <bpt id=\"p1\">**</bpt>Static Text<ept id=\"p1\">**</ept> control to the dialog resource.","pos":[2799,2853],"source":" Drag a **Static Text** control to the dialog resource."},{"content":"The <bpt id=\"p1\">**</bpt>Static Text<ept id=\"p1\">**</ept> control will serve as a placeholder for the .NET Windows Forms control.","pos":[2854,2945],"source":" The **Static Text** control will serve as a placeholder for the .NET Windows Forms control."},{"content":"Resize it to approximately the size of the Windows Forms control.","pos":[2946,3011]},{"pos":[3022,3164],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, change the <bpt id=\"p2\">**</bpt>ID<ept id=\"p2\">**</ept> of the <bpt id=\"p3\">**</bpt>Static Text<ept id=\"p3\">**</ept> control to <ph id=\"ph1\">`IDC_CTRL1`</ph> and change the <bpt id=\"p4\">**</bpt>TabStop<ept id=\"p4\">**</ept> property to <bpt id=\"p5\">**</bpt>True<ept id=\"p5\">**</ept>.","source":"In the **Properties** window, change the **ID** of the **Static Text** control to `IDC_CTRL1` and change the **TabStop** property to **True**."},{"content":"Configure the project for Common Language Runtime (CLR) support.","pos":[3174,3238]},{"pos":[3249,3341],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the MFC01 project node, and then click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","source":"In **Solution Explorer**, right-click the MFC01 project node, and then click **Properties**."},{"content":"In the <bpt id=\"p1\">**</bpt>Property Pages<ept id=\"p1\">**</ept> dialog box, under <bpt id=\"p2\">**</bpt>Configuration Properties<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>General<ept id=\"p3\">**</ept>.","pos":[3352,3445],"source":"In the **Property Pages** dialog box, under **Configuration Properties**, select **General**."},{"content":"In the <bpt id=\"p1\">**</bpt>Project Defaults<ept id=\"p1\">**</ept> section, set <bpt id=\"p2\">**</bpt>Common Language Runtime support<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>Common Language Runtime Support (/clr)<ept id=\"p3\">**</ept>.","pos":[3446,3569],"source":" In the **Project Defaults** section, set **Common Language Runtime support** to **Common Language Runtime Support (/clr)**."},{"content":"Under <bpt id=\"p1\">**</bpt>Configuration Properties<ept id=\"p1\">**</ept>, expand <bpt id=\"p2\">**</bpt>C/C++<ept id=\"p2\">**</ept> and select the <bpt id=\"p3\">**</bpt>General<ept id=\"p3\">**</ept> node.","pos":[3580,3665],"source":"Under **Configuration Properties**, expand **C/C++** and select the **General** node."},{"content":"Set <bpt id=\"p1\">**</bpt>Debug Information Format<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Program Database (/Zi)<ept id=\"p2\">**</ept>.","pos":[3666,3729],"source":" Set **Debug Information Format** to **Program Database (/Zi)**."},{"content":"Select the <bpt id=\"p1\">**</bpt>Code Generation<ept id=\"p1\">**</ept> node.","pos":[3740,3776],"source":"Select the **Code Generation** node."},{"content":"Set <bpt id=\"p1\">**</bpt>Enable Minimal Rebuild<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>No (/Gm-)<ept id=\"p2\">**</ept>.","pos":[3777,3825],"source":" Set **Enable Minimal Rebuild** to **No (/Gm-)**."},{"content":"Also set <bpt id=\"p1\">**</bpt>Basic Runtime Checks<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Default<ept id=\"p2\">**</ept>.","pos":[3826,3875],"source":" Also set **Basic Runtime Checks** to **Default**."},{"pos":[3886,3920],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to apply the changes.","source":"Click **OK** to apply the changes."},{"content":"Add a reference to the .NET control.","pos":[3930,3966]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click the MFC01 project node and then click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>References<ept id=\"p3\">**</ept>.","pos":[3977,4077],"source":"In **Solution Explorer**, right-click the MFC01 project node and then click **Add**, **References**."},{"content":"On the <bpt id=\"p1\">**</bpt>Property Page<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Add New Reference<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>WindowsFormsControlLibrary1<ept id=\"p3\">**</ept> (under the <bpt id=\"p4\">**</bpt>Projects<ept id=\"p4\">**</ept> tab), and click <bpt id=\"p5\">**</bpt>OK<ept id=\"p5\">**</ept>.","pos":[4078,4219],"source":" On the **Property Page**, click **Add New Reference**, select **WindowsFormsControlLibrary1** (under the **Projects** tab), and click **OK**."},{"content":"This adds a reference in the form of a <bpt id=\"p1\">[</bpt>/FU<ept id=\"p1\">](../build/reference/fu-name-forced-hash-using-file.md)</ept> compiler option so that the program will compile.","pos":[4220,4368],"source":" This adds a reference in the form of a [/FU](../build/reference/fu-name-forced-hash-using-file.md) compiler option so that the program will compile."},{"content":"It also puts a copy of WindowsFormsControlLibrary1.dll in the \\MFC01\\ project folder so that the program will run.","pos":[4369,4483]},{"content":"In Stdafx.h, find this line:","pos":[4493,4521]},{"content":"Above it, add these lines:","pos":[4595,4621]},{"content":"Add code to create the managed control.","pos":[4716,4755]},{"content":"First, declare the managed control.","pos":[4766,4801]},{"content":"In MFC01Dlg.h, go to the declaration of the dialog class, and add a data member for the user control in Protected scope, as follows.","pos":[4802,4934]},{"content":"Next, provide an implementation for the managed control.","pos":[5160,5216]},{"content":"In MFC01Dlg.cpp, in the dialog override of <ph id=\"ph1\">`CMFC01Dlg::DoDataExchange`</ph> that was generated by the MFC Application wizard (not <ph id=\"ph2\">`CAboutDlg::DoDataExchange`</ph>, which is in the same file), add the following code to create the managed control and associate it with the static place holder IDC_CTRL1.","pos":[5217,5508],"source":" In MFC01Dlg.cpp, in the dialog override of `CMFC01Dlg::DoDataExchange` that was generated by the MFC Application wizard (not `CAboutDlg::DoDataExchange`, which is in the same file), add the following code to create the managed control and associate it with the static place holder IDC_CTRL1."},{"content":"Build and run the project.","pos":[5707,5733]},{"pos":[5744,5834],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>MFC01<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Set as StartUp Project<ept id=\"p3\">**</ept>.","source":"In **Solution Explorer**, right-click **MFC01** and then click **Set as StartUp Project**."},{"pos":[5845,5893],"content":"On the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept>.","source":"On the **Build** menu, click **Build Solution**."},{"content":"On the <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Start without debugging<ept id=\"p2\">**</ept>.","pos":[5904,5961],"source":"On the **Debug** menu, click **Start without debugging**."},{"content":"The MFC dialog box should display the Windows Forms control.","pos":[5962,6022]},{"content":"See Also","pos":[6031,6039]},{"content":"Hosting a Windows Form User Control in an MFC Dialog Box","pos":[6044,6100]}],"content":"---\ntitle: \"How to: Create the User Control and Host in a Dialog Box | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC [C++], hosting a Windows Forms Control\"\n  - \"Windows Forms [C++], MFC support\"\nms.assetid: 03a53032-2f03-4fa2-b567-031615a26011\ncaps.latest.revision: 29\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Create the User Control and Host in a Dialog Box\nThe steps in this article assume that you are creating a dialog-based ([CDialog Class](../mfc/reference/cdialog-class.md)) Microsoft Foundation Classes (MFC) project, but you can also add support for a Windows Forms control to an existing MFC dialog box.  \n  \n### To create the .NET user control  \n  \n1.  Create a Visual C# Windows Forms Control Library project named `WindowsFormsControlLibrary1`.  \n  \n     On the **File** menu, click **New** and then click **Project**. In the **Visual C#** folder, select **Windows Forms Control Library**.  \n  \n     Accept the `WindowsFormsControlLibrary1` project name by clicking **OK**.  \n  \n     By default, the name of the .NET control will be `UserControl1`.  \n  \n2.  Add child controls to `UserControl1`.  \n  \n     In the **Toolbox**, open the **All Windows Forms** list. Drag a **Button** control to the `UserControl1` design surface.  \n  \n     Also add a **TextBox** control.  \n  \n3.  In **Solution Explorer**, double-click **UserControl1.Designer.cs** to open it for editing. Change the declarations of the TextBox and the Button from `private` to `public`.  \n  \n4.  Build the project.  \n  \n     On the **Build** menu, click **Build Solution**.  \n  \n### To create the MFC host application  \n  \n1.  Create an MFC Application project.  \n  \n     On the **File** menu, click **New** and then click **Project**. In the **Visual C++** folder, select **MFC Application**.  \n  \n     In the **Name** box, type `MFC01`. Change the Solution setting to **Add to Solution**. Click **OK**.  \n  \n     In the **MFC Application Wizard**, for Application Type, select **Dialog based**. Accept the remaining default settings and click **Finish**. This creates an MFC application that has an MFC dialog box.  \n  \n2.  Add a placeholder control to the MFC dialog box.  \n  \n     On the **View** menu, click **Resource View**. In **Resource View**, expand the **Dialog** folder and double-click `IDD_MFC01_DIALOG`. The dialog resource appears in **Resource Editor**.  \n  \n     In the **Toolbox**, open the **Dialog Editor** list. Drag a **Static Text** control to the dialog resource. The **Static Text** control will serve as a placeholder for the .NET Windows Forms control. Resize it to approximately the size of the Windows Forms control.  \n  \n     In the **Properties** window, change the **ID** of the **Static Text** control to `IDC_CTRL1` and change the **TabStop** property to **True**.  \n  \n3.  Configure the project for Common Language Runtime (CLR) support.  \n  \n     In **Solution Explorer**, right-click the MFC01 project node, and then click **Properties**.  \n  \n     In the **Property Pages** dialog box, under **Configuration Properties**, select **General**. In the **Project Defaults** section, set **Common Language Runtime support** to **Common Language Runtime Support (/clr)**.  \n  \n     Under **Configuration Properties**, expand **C/C++** and select the **General** node. Set **Debug Information Format** to **Program Database (/Zi)**.  \n  \n     Select the **Code Generation** node. Set **Enable Minimal Rebuild** to **No (/Gm-)**. Also set **Basic Runtime Checks** to **Default**.  \n  \n     Click **OK** to apply the changes.  \n  \n4.  Add a reference to the .NET control.  \n  \n     In **Solution Explorer**, right-click the MFC01 project node and then click **Add**, **References**. On the **Property Page**, click **Add New Reference**, select **WindowsFormsControlLibrary1** (under the **Projects** tab), and click **OK**. This adds a reference in the form of a [/FU](../build/reference/fu-name-forced-hash-using-file.md) compiler option so that the program will compile. It also puts a copy of WindowsFormsControlLibrary1.dll in the \\MFC01\\ project folder so that the program will run.  \n  \n5.  In Stdafx.h, find this line:  \n  \n    ```  \n    #endif // _AFX_NO_AFXCMN_SUPPORT   \n    ```  \n  \n     Above it, add these lines:  \n  \n    ```  \n    #include <afxwinforms.h>   // MFC Windows Forms support  \n    ```  \n  \n6.  Add code to create the managed control.  \n  \n     First, declare the managed control. In MFC01Dlg.h, go to the declaration of the dialog class, and add a data member for the user control in Protected scope, as follows.  \n  \n    ```  \n    class CMFC01Dlg : public CDialog  \n    {  \n       // ...  \n       // Data member for the .NET User Control:  \n       CWinFormsControl<WindowsFormsControlLibrary1::UserControl1> m_ctrl1;  \n    ```  \n  \n     Next, provide an implementation for the managed control. In MFC01Dlg.cpp, in the dialog override of `CMFC01Dlg::DoDataExchange` that was generated by the MFC Application wizard (not `CAboutDlg::DoDataExchange`, which is in the same file), add the following code to create the managed control and associate it with the static place holder IDC_CTRL1.  \n  \n    ```  \n    void CMFC01Dlg::DoDataExchange(CDataExchange* pDX)  \n    {  \n       CDialog::DoDataExchange(pDX);  \n       DDX_ManagedControl(pDX, IDC_CTRL1, m_ctrl1);  \n    }  \n    ```  \n  \n7.  Build and run the project.  \n  \n     In **Solution Explorer**, right-click **MFC01** and then click **Set as StartUp Project**.  \n  \n     On the **Build** menu, click **Build Solution**.  \n  \n     On the **Debug** menu, click **Start without debugging**. The MFC dialog box should display the Windows Forms control.  \n  \n## See Also  \n [Hosting a Windows Form User Control in an MFC Dialog Box](../dotnet/hosting-a-windows-form-user-control-in-an-mfc-dialog-box.md)"}