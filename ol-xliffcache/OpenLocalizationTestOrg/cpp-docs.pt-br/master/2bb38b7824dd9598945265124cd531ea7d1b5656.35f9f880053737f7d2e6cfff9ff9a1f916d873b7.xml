{"nodes":[{"pos":[12,56],"content":"Recordset: Scrolling (ODBC) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Recordset: Scrolling (ODBC) | Microsoft Docs","pos":[0,44]}]},{"content":"Recordset: Scrolling (ODBC)","pos":[836,863]},{"content":"This topic applies to the MFC ODBC classes.","pos":[864,907]},{"content":"After you open a recordset, you need to access the records to display values, do calculations, generate reports, and so on.","pos":[914,1037]},{"content":"Scrolling lets you move from record to record within your recordset.","pos":[1038,1106]},{"content":"This topic explains:","pos":[1113,1133]},{"pos":[1143,1246],"content":"<bpt id=\"p1\">[</bpt>How to scroll from one record to another in a recordset<ept id=\"p1\">](#_core_scrolling_from_one_record_to_another)</ept>.","source":"[How to scroll from one record to another in a recordset](#_core_scrolling_from_one_record_to_another)."},{"pos":[1256,1353],"content":"<bpt id=\"p1\">[</bpt>Under what circumstances scrolling is and is not supported<ept id=\"p1\">](#_core_when_scrolling_is_supported)</ept>.","source":"[Under what circumstances scrolling is and is not supported](#_core_when_scrolling_is_supported)."},{"pos":[1421,1457],"content":"Scrolling from One Record to Another"},{"content":"Class <ph id=\"ph1\">`CRecordset`</ph> provides the <bpt id=\"p1\">**</bpt>Move<ept id=\"p1\">**</ept> member functions for scrolling within a recordset.","pos":[1461,1552],"source":"Class `CRecordset` provides the **Move** member functions for scrolling within a recordset."},{"content":"These functions move the current record by rowsets.","pos":[1553,1604]},{"content":"If you have implemented bulk row fetching, a <bpt id=\"p1\">**</bpt>Move<ept id=\"p1\">**</ept> operation repositions the recordset by the size of the rowset.","pos":[1605,1721],"source":" If you have implemented bulk row fetching, a **Move** operation repositions the recordset by the size of the rowset."},{"content":"If you have not implemented bulk row fetching, a call to a <bpt id=\"p1\">**</bpt>Move<ept id=\"p1\">**</ept> function repositions the recordset by one record each time.","pos":[1722,1849],"source":" If you have not implemented bulk row fetching, a call to a **Move** function repositions the recordset by one record each time."},{"content":"For more information about bulk row fetching, see <bpt id=\"p1\">[</bpt>Recordset: Fetching Records in Bulk (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)</ept>.","pos":[1850,2005],"source":" For more information about bulk row fetching, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md)."},{"pos":[2013,2216],"content":"[!NOTE]\n When moving through a recordset, deleted records might not be skipped. For more information, see the [IsDeleted](../../mfc/reference/crecordset-class.md#crecordset__isdeleted) member function.","leadings":["","> "],"nodes":[{"content":" When moving through a recordset, deleted records might not be skipped. For more information, see the [IsDeleted](../../mfc/reference/crecordset-class.md#crecordset__isdeleted) member function.","pos":[8,201],"nodes":[{"content":"When moving through a recordset, deleted records might not be skipped.","pos":[1,71]},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>IsDeleted<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__isdeleted)</ept> member function.","pos":[72,193],"source":" For more information, see the [IsDeleted](../../mfc/reference/crecordset-class.md#crecordset__isdeleted) member function."}]}]},{"pos":[2223,2397],"content":"In addition to the <bpt id=\"p1\">**</bpt>Move<ept id=\"p1\">**</ept> functions, <ph id=\"ph1\">`CRecordset`</ph> provides member functions for checking whether you have scrolled past the end or ahead of the beginning of your recordset.","source":"In addition to the **Move** functions, `CRecordset` provides member functions for checking whether you have scrolled past the end or ahead of the beginning of your recordset."},{"pos":[2404,2503],"content":"To determine whether scrolling is possible in your recordset, call the <ph id=\"ph1\">`CanScroll`</ph> member function.","source":"To determine whether scrolling is possible in your recordset, call the `CanScroll` member function."},{"content":"To scroll","pos":[2514,2523]},{"pos":[2533,2665],"content":"Forward one record or one rowset: call the <bpt id=\"p1\">[</bpt>MoveNext<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__movenext)</ept> member function.","source":"Forward one record or one rowset: call the [MoveNext](../../mfc/reference/crecordset-class.md#crecordset__movenext) member function."},{"pos":[2675,2808],"content":"Backward one record or one rowset: call the <bpt id=\"p1\">[</bpt>MovePrev<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__moveprev)</ept> member function.","source":"Backward one record or one rowset: call the [MovePrev](../../mfc/reference/crecordset-class.md#crecordset__moveprev) member function."},{"pos":[2818,2956],"content":"To the first record in the recordset: call the <bpt id=\"p1\">[</bpt>MoveFirst<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__movefirst)</ept> member function.","source":"To the first record in the recordset: call the [MoveFirst](../../mfc/reference/crecordset-class.md#crecordset__movefirst) member function."},{"pos":[2966,3123],"content":"To the last record in the recordset or to the last rowset: call the <bpt id=\"p1\">[</bpt>MoveLast<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__movelast)</ept> member function.","source":"To the last record in the recordset or to the last rowset: call the [MoveLast](../../mfc/reference/crecordset-class.md#crecordset__movelast) member function."},{"pos":[3133,3269],"content":"<bpt id=\"p1\">*</bpt>N<ept id=\"p1\">*</ept> records relative to the current position: call the <bpt id=\"p2\">[</bpt>Move<ept id=\"p2\">](../../mfc/reference/crecordset-class.md#crecordset__move)</ept> member function.","source":"*N* records relative to the current position: call the [Move](../../mfc/reference/crecordset-class.md#crecordset__move) member function."},{"content":"To test for the end or the beginning of the recordset","pos":[3280,3333]},{"content":"Have you scrolled past the last record?","pos":[3343,3382]},{"content":"Call the <bpt id=\"p1\">[</bpt>IsEOF<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__iseof)</ept> member function.","pos":[3383,3475],"source":" Call the [IsEOF](../../mfc/reference/crecordset-class.md#crecordset__iseof) member function."},{"content":"Have you scrolled ahead of the first record (moving backward)?","pos":[3485,3547]},{"content":"Call the <bpt id=\"p1\">[</bpt>IsBOF<ept id=\"p1\">](../../mfc/reference/crecordset-class.md#crecordset__isbof)</ept> member function.","pos":[3548,3640],"source":" Call the [IsBOF](../../mfc/reference/crecordset-class.md#crecordset__isbof) member function."},{"pos":[3647,3770],"content":"The following code example uses <ph id=\"ph1\">`IsBOF`</ph> and <ph id=\"ph2\">`IsEOF`</ph> to detect the limits of a recordset when scrolling in either direction.","source":"The following code example uses `IsBOF` and `IsEOF` to detect the limits of a recordset when scrolling in either direction."},{"content":"returns a nonzero value if the recordset is positioned past the last record.","pos":[4411,4487]},{"content":"returns a nonzero value if the recordset is positioned ahead of the first record (before all records).","pos":[4496,4598]},{"content":"In either case, there is no current record to operate on.","pos":[4599,4656]},{"content":"If you call <ph id=\"ph1\">`MovePrev`</ph> when <ph id=\"ph2\">`IsBOF`</ph> is already <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> or call <ph id=\"ph3\">`MoveNext`</ph> when <ph id=\"ph4\">`IsEOF`</ph> is already <bpt id=\"p2\">**</bpt>TRUE<ept id=\"p2\">**</ept>, the framework throws a <ph id=\"ph5\">`CDBException`</ph>.","pos":[4657,4804],"source":" If you call `MovePrev` when `IsBOF` is already **TRUE** or call `MoveNext` when `IsEOF` is already **TRUE**, the framework throws a `CDBException`."},{"content":"You can also use <ph id=\"ph1\">`IsBOF`</ph> and <ph id=\"ph2\">`IsEOF`</ph> to check for an empty recordset.","pos":[4805,4874],"source":" You can also use `IsBOF` and `IsEOF` to check for an empty recordset."},{"pos":[4881,5055],"content":"For more information about recordset navigation, see <bpt id=\"p1\">[</bpt>Recordset: Bookmarks and Absolute Positions (ODBC)<ept id=\"p1\">](../../data/odbc/recordset-bookmarks-and-absolute-positions-odbc.md)</ept>.","source":"For more information about recordset navigation, see [Recordset: Bookmarks and Absolute Positions (ODBC)](../../data/odbc/recordset-bookmarks-and-absolute-positions-odbc.md)."},{"pos":[5114,5141],"content":"When Scrolling Is Supported"},{"content":"As originally designed, SQL provided only forward scrolling, but ODBC extends scrolling capabilities.","pos":[5145,5246]},{"content":"The available level of support for scrolling depends on the ODBC drivers your application works with, your driver's ODBC API conformance level, and whether the ODBC Cursor Library is loaded into memory.","pos":[5247,5449]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>ODBC<ept id=\"p1\">](../../data/odbc/odbc-basics.md)</ept> and <bpt id=\"p2\">[</bpt>ODBC: The ODBC Cursor Library<ept id=\"p2\">](../../data/odbc/odbc-the-odbc-cursor-library.md)</ept>.","pos":[5450,5600],"source":" For more information, see [ODBC](../../data/odbc/odbc-basics.md) and [ODBC: The ODBC Cursor Library](../../data/odbc/odbc-the-odbc-cursor-library.md)."},{"pos":[5608,5798],"content":"[!TIP]\n You can control whether the cursor library is used. See the `bUseCursorLib` and `dwOptions` parameters to [CDatabase::Open](../../mfc/reference/cdatabase-class.md#cdatabase__open).","leadings":["","> "],"nodes":[{"content":" You can control whether the cursor library is used. See the `bUseCursorLib` and `dwOptions` parameters to [CDatabase::Open](../../mfc/reference/cdatabase-class.md#cdatabase__open).","pos":[7,188],"nodes":[{"content":"You can control whether the cursor library is used.","pos":[1,52]},{"content":"See the <ph id=\"ph1\">`bUseCursorLib`</ph> and <ph id=\"ph2\">`dwOptions`</ph> parameters to <bpt id=\"p1\">[</bpt>CDatabase::Open<ept id=\"p1\">](../../mfc/reference/cdatabase-class.md#cdatabase__open)</ept>.","pos":[53,181],"source":" See the `bUseCursorLib` and `dwOptions` parameters to [CDatabase::Open](../../mfc/reference/cdatabase-class.md#cdatabase__open)."}]}]},{"pos":[5806,5982],"content":"[!NOTE]\n Unlike the MFC DAO classes, the MFC ODBC classes do not provide a set of **Find** functions for locating the next (or previous) record that meets specified criteria.","leadings":["","> "],"nodes":[{"content":"Unlike the MFC DAO classes, the MFC ODBC classes do not provide a set of <bpt id=\"p1\">**</bpt>Find<ept id=\"p1\">**</ept> functions for locating the next (or previous) record that meets specified criteria.","pos":[9,174],"source":" Unlike the MFC DAO classes, the MFC ODBC classes do not provide a set of **Find** functions for locating the next (or previous) record that meets specified criteria."}]},{"content":"See Also","pos":[5991,5999]},{"content":"Recordset (ODBC)","pos":[6004,6020]},{"content":"CRecordset::CanScroll","pos":[6062,6083]},{"content":"CRecordset::CheckRowsetError","pos":[6153,6181]},{"content":"Recordset: Filtering Records (ODBC)","pos":[6258,6293]}],"content":"---\ntitle: \"Recordset: Scrolling (ODBC) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"recordsets [C++], end of\"\n  - \"recordsets [C++], beginning of\"\n  - \"navigation [C++], recordsets\"\n  - \"recordsets [C++], moving to records\"\n  - \"ODBC recordsets, scrolling\"\n  - \"recordsets [C++], navigating\"\n  - \"scrolling [C++], recordsets\"\n  - \"Move method (recordsets)\"\nms.assetid: f38d2dcb-1e88-4e41-af25-98b00c276be4\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Recordset: Scrolling (ODBC)\nThis topic applies to the MFC ODBC classes.  \n  \n After you open a recordset, you need to access the records to display values, do calculations, generate reports, and so on. Scrolling lets you move from record to record within your recordset.  \n  \n This topic explains:  \n  \n-   [How to scroll from one record to another in a recordset](#_core_scrolling_from_one_record_to_another).  \n  \n-   [Under what circumstances scrolling is and is not supported](#_core_when_scrolling_is_supported).  \n  \n##  <a name=\"_core_scrolling_from_one_record_to_another\"></a> Scrolling from One Record to Another  \n Class `CRecordset` provides the **Move** member functions for scrolling within a recordset. These functions move the current record by rowsets. If you have implemented bulk row fetching, a **Move** operation repositions the recordset by the size of the rowset. If you have not implemented bulk row fetching, a call to a **Move** function repositions the recordset by one record each time. For more information about bulk row fetching, see [Recordset: Fetching Records in Bulk (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).  \n  \n> [!NOTE]\n>  When moving through a recordset, deleted records might not be skipped. For more information, see the [IsDeleted](../../mfc/reference/crecordset-class.md#crecordset__isdeleted) member function.  \n  \n In addition to the **Move** functions, `CRecordset` provides member functions for checking whether you have scrolled past the end or ahead of the beginning of your recordset.  \n  \n To determine whether scrolling is possible in your recordset, call the `CanScroll` member function.  \n  \n#### To scroll  \n  \n1.  Forward one record or one rowset: call the [MoveNext](../../mfc/reference/crecordset-class.md#crecordset__movenext) member function.  \n  \n2.  Backward one record or one rowset: call the [MovePrev](../../mfc/reference/crecordset-class.md#crecordset__moveprev) member function.  \n  \n3.  To the first record in the recordset: call the [MoveFirst](../../mfc/reference/crecordset-class.md#crecordset__movefirst) member function.  \n  \n4.  To the last record in the recordset or to the last rowset: call the [MoveLast](../../mfc/reference/crecordset-class.md#crecordset__movelast) member function.  \n  \n5.  *N* records relative to the current position: call the [Move](../../mfc/reference/crecordset-class.md#crecordset__move) member function.  \n  \n#### To test for the end or the beginning of the recordset  \n  \n1.  Have you scrolled past the last record? Call the [IsEOF](../../mfc/reference/crecordset-class.md#crecordset__iseof) member function.  \n  \n2.  Have you scrolled ahead of the first record (moving backward)? Call the [IsBOF](../../mfc/reference/crecordset-class.md#crecordset__isbof) member function.  \n  \n The following code example uses `IsBOF` and `IsEOF` to detect the limits of a recordset when scrolling in either direction.  \n  \n```  \n// Open a recordset; first record is current  \nCCustSet rsCustSet( NULL );  \nrsCustSet.Open( );  \n  \nif( rsCustSet.IsBOF( ) )  \n    return;  \n    // The recordset is empty  \n  \n// Scroll to the end of the recordset, past  \n// the last record, so no record is current  \nwhile ( !rsCustSet.IsEOF( ) )  \n    rsCustSet.MoveNext( );  \n  \n// Move to the last record  \nrsCustSet.MoveLast( );  \n  \n// Scroll to beginning of the recordset, before  \n// the first record, so no record is current  \nwhile( !rsCustSet.IsBOF( ) )  \n    rsCustSet.MovePrev( );  \n  \n// First record is current again  \nrsCustSet.MoveFirst( );  \n```  \n  \n `IsEOF` returns a nonzero value if the recordset is positioned past the last record. `IsBOF` returns a nonzero value if the recordset is positioned ahead of the first record (before all records). In either case, there is no current record to operate on. If you call `MovePrev` when `IsBOF` is already **TRUE** or call `MoveNext` when `IsEOF` is already **TRUE**, the framework throws a `CDBException`. You can also use `IsBOF` and `IsEOF` to check for an empty recordset.  \n  \n For more information about recordset navigation, see [Recordset: Bookmarks and Absolute Positions (ODBC)](../../data/odbc/recordset-bookmarks-and-absolute-positions-odbc.md).  \n  \n##  <a name=\"_core_when_scrolling_is_supported\"></a> When Scrolling Is Supported  \n As originally designed, SQL provided only forward scrolling, but ODBC extends scrolling capabilities. The available level of support for scrolling depends on the ODBC drivers your application works with, your driver's ODBC API conformance level, and whether the ODBC Cursor Library is loaded into memory. For more information, see [ODBC](../../data/odbc/odbc-basics.md) and [ODBC: The ODBC Cursor Library](../../data/odbc/odbc-the-odbc-cursor-library.md).  \n  \n> [!TIP]\n>  You can control whether the cursor library is used. See the `bUseCursorLib` and `dwOptions` parameters to [CDatabase::Open](../../mfc/reference/cdatabase-class.md#cdatabase__open).  \n  \n> [!NOTE]\n>  Unlike the MFC DAO classes, the MFC ODBC classes do not provide a set of **Find** functions for locating the next (or previous) record that meets specified criteria.  \n  \n## See Also  \n [Recordset (ODBC)](../../data/odbc/recordset-odbc.md)   \n [CRecordset::CanScroll](../../mfc/reference/crecordset-class.md#crecordset__canscroll)   \n [CRecordset::CheckRowsetError](../../mfc/reference/crecordset-class.md#crecordset__checkrowseterror)   \n [Recordset: Filtering Records (ODBC)](../../data/odbc/recordset-filtering-records-odbc.md)"}