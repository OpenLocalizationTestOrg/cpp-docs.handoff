{"nodes":[{"pos":[12,70],"content":"Implementing the Event Handling Interface | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Implementing the Event Handling Interface | Microsoft Docs","pos":[0,58]}]},{"content":"Implementing the Event Handling Interface","pos":[664,705]},{"content":"ATL helps you with all three elements required for handling events: implementing the event interface, advising the event source, and unadvising the event source.","pos":[706,867]},{"content":"The precise steps you'll need to take depend on the type of the event interface and the performance requirements of your application.","pos":[868,1001]},{"content":"The most common ways of implementing an interface using ATL are:","pos":[1008,1072]},{"content":"Deriving from a custom interface directly.","pos":[1082,1124]},{"pos":[1134,1253],"content":"Deriving from <bpt id=\"p1\">[</bpt>IDispatchImpl<ept id=\"p1\">](../atl/reference/idispatchimpl-class.md)</ept> for dual interfaces described in a type library.","source":"Deriving from [IDispatchImpl](../atl/reference/idispatchimpl-class.md) for dual interfaces described in a type library."},{"pos":[1263,1383],"content":"Deriving from <bpt id=\"p1\">[</bpt>IDispEventImpl<ept id=\"p1\">](../atl/reference/idispeventimpl-class.md)</ept> for dispinterfaces described in a type library.","source":"Deriving from [IDispEventImpl](../atl/reference/idispeventimpl-class.md) for dispinterfaces described in a type library."},{"pos":[1393,1616],"content":"Deriving from <bpt id=\"p1\">[</bpt>IDispEventSimpleImpl<ept id=\"p1\">](../atl/reference/idispeventsimpleimpl-class.md)</ept> for dispinterfaces not described in a type library or when you want to improve efficiency by not loading the type information at run time.","source":"Deriving from [IDispEventSimpleImpl](../atl/reference/idispeventsimpleimpl-class.md) for dispinterfaces not described in a type library or when you want to improve efficiency by not loading the type information at run time."},{"content":"If you are implementing a custom or dual interface, you should advise the event source by calling <bpt id=\"p1\">[</bpt>AtlAdvise<ept id=\"p1\">](http://msdn.microsoft.com/Library/625a2f03-6b7f-4761-be5d-d2871d1d3254)</ept> or <bpt id=\"p2\">[</bpt>CComPtrBase::Advise<ept id=\"p2\">](../atl/reference/ccomptrbase-class.md#ccomptrbase__advise)</ept>.","pos":[1624,1890],"source":"If you are implementing a custom or dual interface, you should advise the event source by calling [AtlAdvise](http://msdn.microsoft.com/Library/625a2f03-6b7f-4761-be5d-d2871d1d3254) or [CComPtrBase::Advise](../atl/reference/ccomptrbase-class.md#ccomptrbase__advise)."},{"content":"You will need to keep track of the cookie returned by the call yourself.","pos":[1891,1963]},{"content":"Call <bpt id=\"p1\">[</bpt>AtlUnadvise<ept id=\"p1\">](http://msdn.microsoft.com/Library/939d2e50-e2df-4e8f-a16a-e9650b8f0340)</ept> to break the connection.","pos":[1964,2079],"source":" Call [AtlUnadvise](http://msdn.microsoft.com/Library/939d2e50-e2df-4e8f-a16a-e9650b8f0340) to break the connection."},{"content":"If you are implementing a dispinterface using <ph id=\"ph1\">`IDispEventImpl`</ph> or <ph id=\"ph2\">`IDispEventSimpleImpl`</ph>, you should advise the event source by calling <bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::DispEventAdvise<ept id=\"p1\">](../atl/reference/idispeventsimpleimpl-class.md#idispeventsimpleimpl__dispeventadvise)</ept>.","pos":[2087,2349],"source":"If you are implementing a dispinterface using `IDispEventImpl` or `IDispEventSimpleImpl`, you should advise the event source by calling [IDispEventSimpleImpl::DispEventAdvise](../atl/reference/idispeventsimpleimpl-class.md#idispeventsimpleimpl__dispeventadvise)."},{"content":"Call <bpt id=\"p1\">[</bpt>IDispEventSimpleImpl::DispEventUnadvise<ept id=\"p1\">](../atl/reference/idispeventsimpleimpl-class.md#idispeventsimpleimpl__dispeventunadvise)</ept> to break the connection.","pos":[2350,2509],"source":" Call [IDispEventSimpleImpl::DispEventUnadvise](../atl/reference/idispeventsimpleimpl-class.md#idispeventsimpleimpl__dispeventunadvise) to break the connection."},{"pos":[2516,2803],"content":"If you are using <ph id=\"ph1\">`IDispEventImpl`</ph> as a base class of a composite control, the event sources listed in the sink map will be advised and unadvised automatically using <bpt id=\"p1\">[</bpt>CComCompositeControl::AdviseSinkMap<ept id=\"p1\">](../atl/reference/ccomcompositecontrol-class.md#ccomcompositecontrol__advisesinkmap)</ept>.","source":"If you are using `IDispEventImpl` as a base class of a composite control, the event sources listed in the sink map will be advised and unadvised automatically using [CComCompositeControl::AdviseSinkMap](../atl/reference/ccomcompositecontrol-class.md#ccomcompositecontrol__advisesinkmap)."},{"pos":[2810,2892],"content":"The <ph id=\"ph1\">`IDispEventImpl`</ph> and <ph id=\"ph2\">`IDispEventSimpleImpl`</ph> classes manage the cookie for you.","source":"The `IDispEventImpl` and `IDispEventSimpleImpl` classes manage the cookie for you."},{"content":"See Also","pos":[2901,2909]},{"content":"Event Handling","pos":[2914,2928]}],"content":"---\ntitle: \"Implementing the Event Handling Interface | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ATL, event handling\"\n  - \"event handling, ATL\"\n  - \"interfaces, event and event sink\"\nms.assetid: eb2a5b33-88dc-4ce3-bee0-c5c38ea050d7\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Implementing the Event Handling Interface\nATL helps you with all three elements required for handling events: implementing the event interface, advising the event source, and unadvising the event source. The precise steps you'll need to take depend on the type of the event interface and the performance requirements of your application.  \n  \n The most common ways of implementing an interface using ATL are:  \n  \n-   Deriving from a custom interface directly.  \n  \n-   Deriving from [IDispatchImpl](../atl/reference/idispatchimpl-class.md) for dual interfaces described in a type library.  \n  \n-   Deriving from [IDispEventImpl](../atl/reference/idispeventimpl-class.md) for dispinterfaces described in a type library.  \n  \n-   Deriving from [IDispEventSimpleImpl](../atl/reference/idispeventsimpleimpl-class.md) for dispinterfaces not described in a type library or when you want to improve efficiency by not loading the type information at run time.  \n  \n\n If you are implementing a custom or dual interface, you should advise the event source by calling [AtlAdvise](http://msdn.microsoft.com/Library/625a2f03-6b7f-4761-be5d-d2871d1d3254) or [CComPtrBase::Advise](../atl/reference/ccomptrbase-class.md#ccomptrbase__advise). You will need to keep track of the cookie returned by the call yourself. Call [AtlUnadvise](http://msdn.microsoft.com/Library/939d2e50-e2df-4e8f-a16a-e9650b8f0340) to break the connection.  \n\n  \n If you are implementing a dispinterface using `IDispEventImpl` or `IDispEventSimpleImpl`, you should advise the event source by calling [IDispEventSimpleImpl::DispEventAdvise](../atl/reference/idispeventsimpleimpl-class.md#idispeventsimpleimpl__dispeventadvise). Call [IDispEventSimpleImpl::DispEventUnadvise](../atl/reference/idispeventsimpleimpl-class.md#idispeventsimpleimpl__dispeventunadvise) to break the connection.  \n  \n If you are using `IDispEventImpl` as a base class of a composite control, the event sources listed in the sink map will be advised and unadvised automatically using [CComCompositeControl::AdviseSinkMap](../atl/reference/ccomcompositecontrol-class.md#ccomcompositecontrol__advisesinkmap).  \n  \n The `IDispEventImpl` and `IDispEventSimpleImpl` classes manage the cookie for you.  \n  \n## See Also  \n [Event Handling](../atl/event-handling-and-atl.md)\n\n"}