{"nodes":[{"pos":[12,83],"content":"Walkthrough: Creating and Using a Static Library (C++) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Walkthrough: Creating and Using a Static Library (C++) | Microsoft Docs","pos":[0,71]}]},{"content":"Walkthrough: Creating and Using a Static Library (C++)","pos":[683,737]},{"content":"This step-by-step walkthrough shows how to create a static library (.lib file) for use with C++ apps.","pos":[738,839]},{"content":"Using a static library is a great way to reuse code.","pos":[840,892]},{"content":"Rather than re-implementing the same routines in every app that requires the functionality, you write them one time in a static library and then reference it from the apps.","pos":[893,1065]},{"content":"Code linked from a static library becomes part of your app—you don’t have to install another file to use the code.","pos":[1066,1180]},{"content":"This walkthrough covers these tasks:","pos":[1187,1223]},{"content":"Creating a static library project","pos":[1234,1267]},{"content":"Adding a class to the static library","pos":[1303,1339]},{"content":"Creating a C++ console app that references the static library","pos":[1372,1433]},{"content":"Using the functionality from the static library in the app","pos":[1473,1531]},{"content":"Running the app","pos":[1562,1577]},{"content":"Prerequisites","pos":[1601,1614]},{"content":"An understanding of the fundamentals of the C++ language.","pos":[1618,1675]},{"pos":[1722,1755],"content":"Creating a static library project"},{"content":"To create a static library project","pos":[1766,1800]},{"pos":[1810,1865],"content":"On the menu bar, choose <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"On the menu bar, choose **File**, **New**, **Project**."},{"pos":[1875,2006],"content":"In the left pane of the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box, expand <bpt id=\"p2\">**</bpt>Installed<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Templates<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Visual C++<ept id=\"p4\">**</ept>, and then select <bpt id=\"p5\">**</bpt>Win32<ept id=\"p5\">**</ept>.","source":"In the left pane of the **New Project** dialog box, expand **Installed**, **Templates**, **Visual C++**, and then select **Win32**."},{"pos":[2016,2073],"content":"In the center pane, select <bpt id=\"p1\">**</bpt>Win32 Console Application<ept id=\"p1\">**</ept>.","source":"In the center pane, select **Win32 Console Application**."},{"content":"Specify a name for the project—for example, <bpt id=\"p1\">**</bpt>MathFuncsLib<ept id=\"p1\">**</ept>—in the <bpt id=\"p2\">**</bpt>Name<ept id=\"p2\">**</ept> box.","pos":[2083,2164],"source":"Specify a name for the project—for example, **MathFuncsLib**—in the **Name** box."},{"content":"Specify a name for the solution—for example, <bpt id=\"p1\">**</bpt>StaticLibrary<ept id=\"p1\">**</ept>—in the <bpt id=\"p2\">**</bpt>Solution Name<ept id=\"p2\">**</ept> box.","pos":[2165,2257],"source":" Specify a name for the solution—for example, **StaticLibrary**—in the **Solution Name** box."},{"content":"Choose the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button.","pos":[2258,2283],"source":" Choose the **OK** button."},{"pos":[2293,2393],"content":"On the <bpt id=\"p1\">**</bpt>Overview<ept id=\"p1\">**</ept> page of the <bpt id=\"p2\">**</bpt>Win32 Application Wizard<ept id=\"p2\">**</ept> dialog box, choose the <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept> button.","source":"On the **Overview** page of the **Win32 Application Wizard** dialog box, choose the **Next** button."},{"pos":[2403,2495],"content":"On the <bpt id=\"p1\">**</bpt>Application Settings<ept id=\"p1\">**</ept> page, under <bpt id=\"p2\">**</bpt>Application type<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>Static library.<ept id=\"p3\">**</ept>","source":"On the **Application Settings** page, under **Application type**, select **Static library.**"},{"pos":[2505,2616],"content":"On the <bpt id=\"p1\">**</bpt>Application Settings<ept id=\"p1\">**</ept> page, under <bpt id=\"p2\">**</bpt>Additional options<ept id=\"p2\">**</ept>, clear the <bpt id=\"p3\">**</bpt>Precompiled header<ept id=\"p3\">**</ept> check box.","source":"On the **Application Settings** page, under **Additional options**, clear the **Precompiled header** check box."},{"pos":[2626,2677],"content":"Choose the <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> button to create the project.","source":"Choose the **Finish** button to create the project."},{"pos":[2721,2757],"content":"Adding a class to the static library"},{"content":"To add a class to the static library","pos":[2768,2804]},{"content":"To create a header file for a new class, open the shortcut menu for the <bpt id=\"p1\">**</bpt>MathFuncsLib<ept id=\"p1\">**</ept> project in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept>, and then choose <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>New Item<ept id=\"p4\">**</ept>.","pos":[2814,2975],"source":"To create a header file for a new class, open the shortcut menu for the **MathFuncsLib** project in **Solution Explorer**, and then choose **Add**, **New Item**."},{"content":"In the <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box, in the left pane, under <bpt id=\"p2\">**</bpt>Visual C++<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>Code<ept id=\"p3\">**</ept>.","pos":[2976,3068],"source":" In the **Add New Item** dialog box, in the left pane, under **Visual C++**, select **Code**."},{"content":"In the center pane, select <bpt id=\"p1\">**</bpt>Header File (.h)<ept id=\"p1\">**</ept>.","pos":[3069,3117],"source":" In the center pane, select **Header File (.h)**."},{"content":"Specify a name for the header file—for example, <bpt id=\"p1\">**</bpt>MathFuncsLib.h<ept id=\"p1\">**</ept>—and then choose the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> button.","pos":[3118,3220],"source":" Specify a name for the header file—for example, **MathFuncsLib.h**—and then choose the **Add** button."},{"content":"A blank header file is displayed.","pos":[3221,3254]},{"content":"Add a class named <bpt id=\"p1\">**</bpt>MyMathFuncs<ept id=\"p1\">**</ept> to do common mathematical operations such as addition, subtraction, multiplication, and division.","pos":[3264,3395],"source":"Add a class named **MyMathFuncs** to do common mathematical operations such as addition, subtraction, multiplication, and division."},{"content":"The code should resemble this:","pos":[3396,3426]},{"pos":[3448,3485],"content":"NVC_Walkthrough_Create_Static_Lib#100"},{"content":"To create a source file for the new class, open the shortcut menu for the <bpt id=\"p1\">**</bpt>MathFuncsLib<ept id=\"p1\">**</ept> project in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept>, and then choose <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>New Item<ept id=\"p4\">**</ept>.","pos":[3581,3744],"source":"To create a source file for the new class, open the shortcut menu for the **MathFuncsLib** project in **Solution Explorer**, and then choose **Add**, **New Item**."},{"content":"In the <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box, in the left pane, under <bpt id=\"p2\">**</bpt>Visual C++<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>Code<ept id=\"p3\">**</ept>.","pos":[3745,3837],"source":" In the **Add New Item** dialog box, in the left pane, under **Visual C++**, select **Code**."},{"content":"In the center pane, select <bpt id=\"p1\">**</bpt>C++ File (.cpp)<ept id=\"p1\">**</ept>.","pos":[3838,3885],"source":" In the center pane, select **C++ File (.cpp)**."},{"content":"Specify a name for the source file—for example, <bpt id=\"p1\">**</bpt>MathFuncsLib.cpp<ept id=\"p1\">**</ept>—and then choose the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> button.","pos":[3886,3990],"source":" Specify a name for the source file—for example, **MathFuncsLib.cpp**—and then choose the **Add** button."},{"content":"A blank source file is displayed.","pos":[3991,4024]},{"content":"Use this source file to implement the functionality for <bpt id=\"p1\">**</bpt>MyMathFuncs<ept id=\"p1\">**</ept>.","pos":[4034,4106],"source":"Use this source file to implement the functionality for **MyMathFuncs**."},{"content":"The code should resemble this:","pos":[4107,4137]},{"pos":[4159,4196],"content":"NVC_Walkthrough_Create_Static_Lib#110"},{"content":"Compile the static library by selecting <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept> on the menu bar.","pos":[4294,4380],"source":"Compile the static library by selecting **Build**, **Build Solution** on the menu bar."},{"content":"This creates a static library that can be used by other programs.","pos":[4381,4446]},{"pos":[4458,5149],"content":"[!NOTE]\n When you build on the Visual Studio command line, you must build the program in two steps. First, run **cl /c /EHsc MathFuncsLib.cpp** to compile the code and create an object file that's named **MathFuncsLib.obj**. (The **cl** command invokes the compiler, Cl.exe, and the **/c** option specifies compile without linking. For more information, see [/c (Compile Without Linking)](../build/reference/c-compile-without-linking.md).) Second, run **lib MathFuncsLib.obj** to link the code and create the static library **MathFuncsLib.lib**. (The **lib** command invokes the Library Manager, Lib.exe. For more information, see [LIB Reference](../build/reference/lib-reference.md).)","leadings":["","    > "],"nodes":[{"content":" When you build on the Visual Studio command line, you must build the program in two steps. First, run **cl /c /EHsc MathFuncsLib.cpp** to compile the code and create an object file that's named **MathFuncsLib.obj**. (The **cl** command invokes the compiler, Cl.exe, and the **/c** option specifies compile without linking. For more information, see [/c (Compile Without Linking)](../build/reference/c-compile-without-linking.md).) Second, run **lib MathFuncsLib.obj** to link the code and create the static library **MathFuncsLib.lib**. (The **lib** command invokes the Library Manager, Lib.exe. For more information, see [LIB Reference](../build/reference/lib-reference.md).)","pos":[8,685],"nodes":[{"content":"When you build on the Visual Studio command line, you must build the program in two steps.","pos":[1,91]},{"content":"First, run <bpt id=\"p1\">**</bpt>cl /c /EHsc MathFuncsLib.cpp<ept id=\"p1\">**</ept> to compile the code and create an object file that's named <bpt id=\"p2\">**</bpt>MathFuncsLib.obj<ept id=\"p2\">**</ept>.","pos":[92,216],"source":" First, run **cl /c /EHsc MathFuncsLib.cpp** to compile the code and create an object file that's named **MathFuncsLib.obj**."},{"content":"(The <bpt id=\"p1\">**</bpt>cl<ept id=\"p1\">**</ept> command invokes the compiler, Cl.exe, and the <bpt id=\"p2\">**</bpt>/c<ept id=\"p2\">**</ept> option specifies compile without linking.","pos":[217,323],"source":" (The **cl** command invokes the compiler, Cl.exe, and the **/c** option specifies compile without linking."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>/c (Compile Without Linking)<ept id=\"p1\">](../build/reference/c-compile-without-linking.md)</ept>.) Second, run <bpt id=\"p2\">**</bpt>lib MathFuncsLib.obj<ept id=\"p2\">**</ept> to link the code and create the static library <bpt id=\"p3\">**</bpt>MathFuncsLib.lib<ept id=\"p3\">**</ept>.","pos":[324,537],"source":" For more information, see [/c (Compile Without Linking)](../build/reference/c-compile-without-linking.md).) Second, run **lib MathFuncsLib.obj** to link the code and create the static library **MathFuncsLib.lib**."},{"content":"(The <bpt id=\"p1\">**</bpt>lib<ept id=\"p1\">**</ept> command invokes the Library Manager, Lib.exe.","pos":[538,596],"source":" (The **lib** command invokes the Library Manager, Lib.exe."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>LIB Reference<ept id=\"p1\">](../build/reference/lib-reference.md)</ept>.)","pos":[597,677],"source":" For more information, see [LIB Reference](../build/reference/lib-reference.md).)"}]}]},{"pos":[5200,5261],"content":"Creating a C++ console app that references the static library"},{"content":"To create a C++ console app that references the static library","pos":[5272,5334]},{"pos":[5344,5399],"content":"On the menu bar, choose <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"On the menu bar, choose **File**, **New**, **Project**."},{"pos":[5409,5466],"content":"In the left pane, under <bpt id=\"p1\">**</bpt>Visual C++<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Win32<ept id=\"p2\">**</ept>.","source":"In the left pane, under **Visual C++**, select **Win32**."},{"pos":[5476,5533],"content":"In the center pane, select <bpt id=\"p1\">**</bpt>Win32 Console Application<ept id=\"p1\">**</ept>.","source":"In the center pane, select **Win32 Console Application**."},{"content":"Specify a name for the project—for example, <bpt id=\"p1\">**</bpt>MyExecRefsLib<ept id=\"p1\">**</ept>—in the <bpt id=\"p2\">**</bpt>Name<ept id=\"p2\">**</ept> box.","pos":[5543,5625],"source":"Specify a name for the project—for example, **MyExecRefsLib**—in the **Name** box."},{"content":"In the drop-down list next to <bpt id=\"p1\">**</bpt>Solution<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Add to Solution<ept id=\"p2\">**</ept>.","pos":[5626,5697],"source":" In the drop-down list next to **Solution**, select **Add to Solution**."},{"content":"This adds the new project to the solution that contains the static library.","pos":[5698,5773]},{"content":"Choose the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button.","pos":[5774,5799],"source":" Choose the **OK** button."},{"pos":[5809,5909],"content":"On the <bpt id=\"p1\">**</bpt>Overview<ept id=\"p1\">**</ept> page of the <bpt id=\"p2\">**</bpt>Win32 Application Wizard<ept id=\"p2\">**</ept> dialog box, choose the <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept> button.","source":"On the **Overview** page of the **Win32 Application Wizard** dialog box, choose the **Next** button."},{"pos":[5919,6016],"content":"On the <bpt id=\"p1\">**</bpt>Application Settings<ept id=\"p1\">**</ept> page, under <bpt id=\"p2\">**</bpt>Application type<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>Console application<ept id=\"p3\">**</ept>.","source":"On the **Application Settings** page, under **Application type**, select **Console application**."},{"pos":[6026,6137],"content":"On the <bpt id=\"p1\">**</bpt>Application Settings<ept id=\"p1\">**</ept> page, under <bpt id=\"p2\">**</bpt>Additional options<ept id=\"p2\">**</ept>, clear the <bpt id=\"p3\">**</bpt>Precompiled header<ept id=\"p3\">**</ept> check box.","source":"On the **Application Settings** page, under **Additional options**, clear the **Precompiled header** check box."},{"pos":[6147,6198],"content":"Choose the <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> button to create the project.","source":"Choose the **Finish** button to create the project."},{"pos":[6240,6298],"content":"Using the functionality from the static library in the app"},{"content":"To use the functionality from the static library in the app","pos":[6309,6368]},{"content":"After you create a console app, an empty program is created for you.","pos":[6378,6446]},{"content":"The name for the source file is the same as the name that you chose earlier.","pos":[6447,6523]},{"content":"In this example, it's named <bpt id=\"p1\">**</bpt>MyExecRefsLib.cpp<ept id=\"p1\">**</ept>.","pos":[6524,6574],"source":" In this example, it's named **MyExecRefsLib.cpp**."},{"content":"Before you can use the math routines in the static library, you must reference it.","pos":[6584,6666]},{"content":"To do this, open the shortcut menu for the <bpt id=\"p1\">**</bpt>MyExecRefsLib<ept id=\"p1\">**</ept> project in <bpt id=\"p2\">**</bpt>Solution Explorer<ept id=\"p2\">**</ept>, and then choose <bpt id=\"p3\">**</bpt>References<ept id=\"p3\">**</ept>.","pos":[6667,6793],"source":" To do this, open the shortcut menu for the **MyExecRefsLib** project in **Solution Explorer**, and then choose **References**."},{"content":"In the <bpt id=\"p1\">**</bpt>MyExecRefsLibProperty Pages<ept id=\"p1\">**</ept> dialog box, expand the <bpt id=\"p2\">**</bpt>Common Properties<ept id=\"p2\">**</ept> node, select <bpt id=\"p3\">**</bpt>Framework and References<ept id=\"p3\">**</ept>, and then choose the <bpt id=\"p4\">**</bpt>Add New Reference<ept id=\"p4\">**</ept> button.","pos":[6794,6970],"source":" In the **MyExecRefsLibProperty Pages** dialog box, expand the **Common Properties** node, select **Framework and References**, and then choose the **Add New Reference** button."},{"content":"For more information about the <bpt id=\"p1\">**</bpt>References<ept id=\"p1\">**</ept> dialog box, see <bpt id=\"p2\">[</bpt>Adding references<ept id=\"p2\">](../ide/adding-references-in-visual-cpp-projects.md)</ept>.","pos":[6971,7105],"source":" For more information about the **References** dialog box, see [Adding references](../ide/adding-references-in-visual-cpp-projects.md)."},{"content":"The <bpt id=\"p1\">**</bpt>Add Reference<ept id=\"p1\">**</ept> dialog box lists the libraries that you can reference.","pos":[7115,7191],"source":"The **Add Reference** dialog box lists the libraries that you can reference."},{"content":"The <bpt id=\"p1\">**</bpt>Projects<ept id=\"p1\">**</ept> tab lists the projects in the current solution and any libraries that they contain.","pos":[7192,7292],"source":" The **Projects** tab lists the projects in the current solution and any libraries that they contain."},{"content":"On the <bpt id=\"p1\">**</bpt>Projects<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>MathFuncsLib<ept id=\"p2\">**</ept> check box, and then choose the <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept> button.","pos":[7293,7391],"source":" On the **Projects** tab, select the **MathFuncsLib** check box, and then choose the **OK** button."},{"content":"To reference the <bpt id=\"p1\">**</bpt>MathFuncsLib.h<ept id=\"p1\">**</ept> header file, you must modify the included directories path.","pos":[7401,7496],"source":"To reference the **MathFuncsLib.h** header file, you must modify the included directories path."},{"content":"In the <bpt id=\"p1\">**</bpt>Property Pages<ept id=\"p1\">**</ept> dialog box for <bpt id=\"p2\">**</bpt>MyExecRefsLib<ept id=\"p2\">**</ept>, expand the <bpt id=\"p3\">**</bpt>Configuration Properties<ept id=\"p3\">**</ept> node, expand the <bpt id=\"p4\">**</bpt>C/C++<ept id=\"p4\">**</ept> node, and then select <bpt id=\"p5\">**</bpt>General<ept id=\"p5\">**</ept>.","pos":[7497,7658],"source":" In the **Property Pages** dialog box for **MyExecRefsLib**, expand the **Configuration Properties** node, expand the **C/C++** node, and then select **General**."},{"content":"Next to <bpt id=\"p1\">**</bpt>Additional Include Directories<ept id=\"p1\">**</ept>, specify the path of the <bpt id=\"p2\">**</bpt>MathFuncsLib<ept id=\"p2\">**</ept> directory or browse for it.","pos":[7659,7771],"source":" Next to **Additional Include Directories**, specify the path of the **MathFuncsLib** directory or browse for it."},{"content":"To browse for the directory path, open the property value drop-down list, and then choose <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept>.","pos":[7782,7881],"source":"To browse for the directory path, open the property value drop-down list, and then choose **Edit**."},{"content":"In the <bpt id=\"p1\">**</bpt>Additional Include Directories<ept id=\"p1\">**</ept> dialog box, in the text box, select a blank line and then choose the ellipsis button (<bpt id=\"p2\">**</bpt>…<ept id=\"p2\">**</ept>) at the end of the line.","pos":[7882,8040],"source":" In the **Additional Include Directories** dialog box, in the text box, select a blank line and then choose the ellipsis button (**…**) at the end of the line."},{"content":"In the <bpt id=\"p1\">**</bpt>Select Directory<ept id=\"p1\">**</ept> dialog box, select the <bpt id=\"p2\">**</bpt>MathFuncsLib<ept id=\"p2\">**</ept> directory and then choose <bpt id=\"p3\">**</bpt>Select Folder<ept id=\"p3\">**</ept> button to save your selection and close the dialog box.","pos":[8041,8208],"source":" In the **Select Directory** dialog box, select the **MathFuncsLib** directory and then choose **Select Folder** button to save your selection and close the dialog box."},{"content":"In the <bpt id=\"p1\">**</bpt>Additional Include Directories<ept id=\"p1\">**</ept> dialog box, choose the <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept> button, and then in the <bpt id=\"p3\">**</bpt>Property Pages<ept id=\"p3\">**</ept> dialog box, choose the <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept> button to save your changes to the project.","pos":[8209,8397],"source":" In the **Additional Include Directories** dialog box, choose the **OK** button, and then in the **Property Pages** dialog box, choose the **OK** button to save your changes to the project."},{"content":"You can now use the <bpt id=\"p1\">**</bpt>MyMathFuncs<ept id=\"p1\">**</ept> class in this app.","pos":[8407,8461],"source":"You can now use the **MyMathFuncs** class in this app."},{"content":"To do this, replace the contents of <bpt id=\"p1\">**</bpt>MyExecRefsLib.cpp<ept id=\"p1\">**</ept> with this code:","pos":[8462,8535],"source":" To do this, replace the contents of **MyExecRefsLib.cpp** with this code:"},{"pos":[8557,8594],"content":"NVC_Walkthrough_Create_Static_Lib#120"},{"pos":[8692,8771],"content":"Build the executable by choosing <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept> on the menu bar.","source":"Build the executable by choosing **Build**, **Build Solution** on the menu bar."},{"pos":[8808,8823],"content":"Running the app"},{"content":"To run the app","pos":[8834,8848]},{"pos":[8858,9048],"content":"Make sure that <bpt id=\"p1\">**</bpt>MyExecRefsLib<ept id=\"p1\">**</ept> is selected as the default project by opening the shortcut menu for <bpt id=\"p2\">**</bpt>MyExecRefsLib<ept id=\"p2\">**</ept> in <bpt id=\"p3\">**</bpt>Solution Explorer<ept id=\"p3\">**</ept>, and then choosing <bpt id=\"p4\">**</bpt>Set as StartUp Project<ept id=\"p4\">**</ept>.","source":"Make sure that **MyExecRefsLib** is selected as the default project by opening the shortcut menu for **MyExecRefsLib** in **Solution Explorer**, and then choosing **Set as StartUp Project**."},{"content":"To run the project, on the menu bar, choose <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Start Without Debugging<ept id=\"p2\">**</ept>.","pos":[9058,9141],"source":"To run the project, on the menu bar, choose **Debug**, **Start Without Debugging**."},{"content":"The output should resemble this:","pos":[9142,9174]},{"content":"See Also","pos":[9296,9304]},{"content":"Visual C++ Guided Tour","pos":[9309,9331]},{"content":"Walkthrough: Creating and Using a Dynamic Link Library (C++)","pos":[9408,9468]},{"content":"Desktop Applications (Visual C++)","pos":[9546,9579]}],"content":"---\ntitle: \"Walkthrough: Creating and Using a Static Library (C++) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"get-started-article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"libraries [C++], static\"\n  - \"static libraries [C++]\"\nms.assetid: 3cc36411-7d66-4240-851e-dacb9a8fd6ac\ncaps.latest.revision: 38\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# Walkthrough: Creating and Using a Static Library (C++)\nThis step-by-step walkthrough shows how to create a static library (.lib file) for use with C++ apps. Using a static library is a great way to reuse code. Rather than re-implementing the same routines in every app that requires the functionality, you write them one time in a static library and then reference it from the apps. Code linked from a static library becomes part of your app—you don’t have to install another file to use the code.  \n  \n This walkthrough covers these tasks:  \n  \n-   [Creating a static library project](#BKMK_CreateLibProject)  \n  \n-   [Adding a class to the static library](#BKMK_AddClassToLib)  \n  \n-   [Creating a C++ console app that references the static library](#BKMK_CreateAppToRefTheLib)  \n  \n-   [Using the functionality from the static library in the app](#BKMK_UseLibInApp)  \n  \n-   [Running the app](#BKMK_RunApp)  \n  \n## Prerequisites  \n An understanding of the fundamentals of the C++ language.  \n  \n##  <a name=\"BKMK_CreateLibProject\"></a> Creating a static library project  \n  \n#### To create a static library project  \n  \n1.  On the menu bar, choose **File**, **New**, **Project**.  \n  \n2.  In the left pane of the **New Project** dialog box, expand **Installed**, **Templates**, **Visual C++**, and then select **Win32**.  \n  \n3.  In the center pane, select **Win32 Console Application**.  \n  \n4.  Specify a name for the project—for example, **MathFuncsLib**—in the **Name** box. Specify a name for the solution—for example, **StaticLibrary**—in the **Solution Name** box. Choose the **OK** button.  \n  \n5.  On the **Overview** page of the **Win32 Application Wizard** dialog box, choose the **Next** button.  \n  \n6.  On the **Application Settings** page, under **Application type**, select **Static library.**  \n  \n7.  On the **Application Settings** page, under **Additional options**, clear the **Precompiled header** check box.  \n  \n8.  Choose the **Finish** button to create the project.  \n  \n##  <a name=\"BKMK_AddClassToLib\"></a> Adding a class to the static library  \n  \n#### To add a class to the static library  \n  \n1.  To create a header file for a new class, open the shortcut menu for the **MathFuncsLib** project in **Solution Explorer**, and then choose **Add**, **New Item**. In the **Add New Item** dialog box, in the left pane, under **Visual C++**, select **Code**. In the center pane, select **Header File (.h)**. Specify a name for the header file—for example, **MathFuncsLib.h**—and then choose the **Add** button. A blank header file is displayed.  \n  \n2.  Add a class named **MyMathFuncs** to do common mathematical operations such as addition, subtraction, multiplication, and division. The code should resemble this:  \n  \n     [!code-cpp[NVC_Walkthrough_Create_Static_Lib#100](../windows/codesnippet/CPP/walkthrough-creating-and-using-a-static-library-cpp_1.h)]  \n  \n3.  To create a source file for the new class, open the shortcut menu for the **MathFuncsLib** project in **Solution Explorer**, and then choose **Add**, **New Item**. In the **Add New Item** dialog box, in the left pane, under **Visual C++**, select **Code**. In the center pane, select **C++ File (.cpp)**. Specify a name for the source file—for example, **MathFuncsLib.cpp**—and then choose the **Add** button. A blank source file is displayed.  \n  \n4.  Use this source file to implement the functionality for **MyMathFuncs**. The code should resemble this:  \n  \n     [!code-cpp[NVC_Walkthrough_Create_Static_Lib#110](../windows/codesnippet/CPP/walkthrough-creating-and-using-a-static-library-cpp_2.cpp)]  \n  \n5.  Compile the static library by selecting **Build**, **Build Solution** on the menu bar. This creates a static library that can be used by other programs.  \n  \n    > [!NOTE]\n    >  When you build on the Visual Studio command line, you must build the program in two steps. First, run **cl /c /EHsc MathFuncsLib.cpp** to compile the code and create an object file that's named **MathFuncsLib.obj**. (The **cl** command invokes the compiler, Cl.exe, and the **/c** option specifies compile without linking. For more information, see [/c (Compile Without Linking)](../build/reference/c-compile-without-linking.md).) Second, run **lib MathFuncsLib.obj** to link the code and create the static library **MathFuncsLib.lib**. (The **lib** command invokes the Library Manager, Lib.exe. For more information, see [LIB Reference](../build/reference/lib-reference.md).)  \n  \n##  <a name=\"BKMK_CreateAppToRefTheLib\"></a> Creating a C++ console app that references the static library  \n  \n#### To create a C++ console app that references the static library  \n  \n1.  On the menu bar, choose **File**, **New**, **Project**.  \n  \n2.  In the left pane, under **Visual C++**, select **Win32**.  \n  \n3.  In the center pane, select **Win32 Console Application**.  \n  \n4.  Specify a name for the project—for example, **MyExecRefsLib**—in the **Name** box. In the drop-down list next to **Solution**, select **Add to Solution**. This adds the new project to the solution that contains the static library. Choose the **OK** button.  \n  \n5.  On the **Overview** page of the **Win32 Application Wizard** dialog box, choose the **Next** button.  \n  \n6.  On the **Application Settings** page, under **Application type**, select **Console application**.  \n  \n7.  On the **Application Settings** page, under **Additional options**, clear the **Precompiled header** check box.  \n  \n8.  Choose the **Finish** button to create the project.  \n  \n##  <a name=\"BKMK_UseLibInApp\"></a> Using the functionality from the static library in the app  \n  \n#### To use the functionality from the static library in the app  \n  \n1.  After you create a console app, an empty program is created for you. The name for the source file is the same as the name that you chose earlier. In this example, it's named **MyExecRefsLib.cpp**.  \n  \n2.  Before you can use the math routines in the static library, you must reference it. To do this, open the shortcut menu for the **MyExecRefsLib** project in **Solution Explorer**, and then choose **References**. In the **MyExecRefsLibProperty Pages** dialog box, expand the **Common Properties** node, select **Framework and References**, and then choose the **Add New Reference** button. For more information about the **References** dialog box, see [Adding references](../ide/adding-references-in-visual-cpp-projects.md).  \n  \n3.  The **Add Reference** dialog box lists the libraries that you can reference. The **Projects** tab lists the projects in the current solution and any libraries that they contain. On the **Projects** tab, select the **MathFuncsLib** check box, and then choose the **OK** button.  \n  \n4.  To reference the **MathFuncsLib.h** header file, you must modify the included directories path. In the **Property Pages** dialog box for **MyExecRefsLib**, expand the **Configuration Properties** node, expand the **C/C++** node, and then select **General**. Next to **Additional Include Directories**, specify the path of the **MathFuncsLib** directory or browse for it.  \n  \n     To browse for the directory path, open the property value drop-down list, and then choose **Edit**. In the **Additional Include Directories** dialog box, in the text box, select a blank line and then choose the ellipsis button (**…**) at the end of the line. In the **Select Directory** dialog box, select the **MathFuncsLib** directory and then choose **Select Folder** button to save your selection and close the dialog box. In the **Additional Include Directories** dialog box, choose the **OK** button, and then in the **Property Pages** dialog box, choose the **OK** button to save your changes to the project.  \n  \n5.  You can now use the **MyMathFuncs** class in this app. To do this, replace the contents of **MyExecRefsLib.cpp** with this code:  \n  \n     [!code-cpp[NVC_Walkthrough_Create_Static_Lib#120](../windows/codesnippet/CPP/walkthrough-creating-and-using-a-static-library-cpp_3.cpp)]  \n  \n6.  Build the executable by choosing **Build**, **Build Solution** on the menu bar.  \n  \n##  <a name=\"BKMK_RunApp\"></a> Running the app  \n  \n#### To run the app  \n  \n1.  Make sure that **MyExecRefsLib** is selected as the default project by opening the shortcut menu for **MyExecRefsLib** in **Solution Explorer**, and then choosing **Set as StartUp Project**.  \n  \n2.  To run the project, on the menu bar, choose **Debug**, **Start Without Debugging**. The output should resemble this:  \n  \n    ```Output  \n    a + b = 106.4  \n    a - b = -91.6  \n    a * b = 732.6  \n    a / b = 0.0747475  \n    ```  \n  \n## See Also  \n [Visual C++ Guided Tour](http://msdn.microsoft.com/en-us/499cb66f-7df1-45d6-8b6b-33d94fd1f17c)   \n [Walkthrough: Creating and Using a Dynamic Link Library (C++)](../build/walkthrough-creating-and-using-a-dynamic-link-library-cpp.md)   \n [Desktop Applications (Visual C++)](../windows/desktop-applications-visual-cpp.md)"}