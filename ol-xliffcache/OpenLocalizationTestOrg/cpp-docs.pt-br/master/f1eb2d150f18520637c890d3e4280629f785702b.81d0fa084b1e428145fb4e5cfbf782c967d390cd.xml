{"nodes":[{"pos":[12,75],"content":"-CLRTHREADATTRIBUTE (Set CLR Thread Attribute) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"-CLRTHREADATTRIBUTE (Set CLR Thread Attribute) | Microsoft Docs","pos":[0,63]}]},{"content":"/CLRTHREADATTRIBUTE (Set CLR Thread Attribute)","pos":[721,767]},{"content":"Explicitly specify the threading attribute for the entry point of your CLR program.","pos":[768,851]},{"content":"Syntax","pos":[860,866]},{"content":"Parameters","pos":[929,939]},{"content":"MTA","pos":[943,946]},{"content":"Applies the MTAThreadAttribute attribute to the entry point of your program.","pos":[950,1026]},{"content":"NONE","pos":[1033,1037]},{"content":"Same as not specifying /CLRTHREADATTRIBUTE.","pos":[1041,1084]},{"content":"Lets the Common Language Runtime (CLR) set the default threading attribute.","pos":[1086,1161]},{"content":"STA","pos":[1168,1171]},{"content":"Applies the STAThreadAttribute attribute to the entry point of your program.","pos":[1175,1251]},{"content":"Remarks","pos":[1260,1267]},{"content":"Setting the thread attribute is only valid when building an .exe, as it affects the entry point of the main thread.","pos":[1271,1386]},{"content":"If you use the default entry point (main or wmain, for example) specify the threading model either by using /CLRTHREADATTRIBUTE or by placing the threading attribute (STAThreadAttribute or MTAThreadAttribute) on the default entry function.","pos":[1393,1632]},{"pos":[1639,1924],"content":"If you use a non-default entry point, specify the threading model either by using /CLRTHREADATTRIBUTE or by placing the threading attribute on the non-default entry function, and then specify the non-default entry point with <bpt id=\"p1\">[</bpt>/ENTRY<ept id=\"p1\">](../../build/reference/entry-entry-point-symbol.md)</ept>.","source":"If you use a non-default entry point, specify the threading model either by using /CLRTHREADATTRIBUTE or by placing the threading attribute on the non-default entry function, and then specify the non-default entry point with [/ENTRY](../../build/reference/entry-entry-point-symbol.md)."},{"content":"If the threading model specified in source code does not agree with the threading model specified with /CLRTHREADATTRIBUTE, the linker will ignore /CLRTHREADATTRIBUTE and apply the threading model specified in source code.","pos":[1931,2153]},{"content":"It will be necessary for you to use single-threading, for example, if your CLR program hosts a COM object that uses single-threading.","pos":[2160,2293]},{"content":"If your CLR program uses multi-threading, it cannot host a COM object that uses single-threading.","pos":[2295,2392]},{"content":"To set this linker option in the Visual Studio development environment","pos":[2402,2472]},{"content":"Open the project's <bpt id=\"p1\">**</bpt>Property Pages<ept id=\"p1\">**</ept> dialog box.","pos":[2482,2531],"source":"Open the project's **Property Pages** dialog box."},{"content":"For details, see <bpt id=\"p1\">[</bpt>Working with Project Properties<ept id=\"p1\">](../../ide/working-with-project-properties.md)</ept>.","pos":[2532,2629],"source":" For details, see [Working with Project Properties](../../ide/working-with-project-properties.md)."},{"pos":[2639,2684],"content":"Expand the <bpt id=\"p1\">**</bpt>Configuration Properties<ept id=\"p1\">**</ept> node.","source":"Expand the **Configuration Properties** node."},{"pos":[2694,2721],"content":"Expand the <bpt id=\"p1\">**</bpt>Linker<ept id=\"p1\">**</ept> node.","source":"Expand the **Linker** node."},{"pos":[2731,2769],"content":"Select the <bpt id=\"p1\">**</bpt>Advanced<ept id=\"p1\">**</ept> property page.","source":"Select the **Advanced** property page."},{"pos":[2779,2824],"content":"Modify the <bpt id=\"p1\">**</bpt>CLR Thread Attribute<ept id=\"p1\">**</ept> property.","source":"Modify the **CLR Thread Attribute** property."},{"content":"To set this linker option programmatically","pos":[2834,2876]},{"content":"See &lt;xref:Microsoft.VisualStudio.VCProjectEngine.VCLinkerTool.CLRThreadAttribute%2A&gt;.","pos":[2886,2971],"source":"See <xref:Microsoft.VisualStudio.VCProjectEngine.VCLinkerTool.CLRThreadAttribute%2A>."},{"content":"See Also","pos":[2980,2988]},{"content":"Setting Linker Options","pos":[2993,3015]},{"content":"Linker Options","pos":[3071,3085]}],"content":"---\ntitle: \"-CLRTHREADATTRIBUTE (Set CLR Thread Attribute) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"VC.Project.VCLinkerTool.CLRThreadAttribute\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"/CLRTHREADATTRIBUTE linker option\"\n  - \"-CLRTHREADATTRIBUTE linker option\"\nms.assetid: 4907e9ef-5031-446c-aecf-0a0b32fae1e8\ncaps.latest.revision: 14\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# /CLRTHREADATTRIBUTE (Set CLR Thread Attribute)\nExplicitly specify the threading attribute for the entry point of your CLR program.  \n  \n## Syntax  \n  \n```  \n/CLRTHREADATTRIBUTE:{STA|MTA|NONE}  \n```  \n  \n#### Parameters  \n MTA  \n Applies the MTAThreadAttribute attribute to the entry point of your program.  \n  \n NONE  \n Same as not specifying /CLRTHREADATTRIBUTE.  Lets the Common Language Runtime (CLR) set the default threading attribute.  \n  \n STA  \n Applies the STAThreadAttribute attribute to the entry point of your program.  \n  \n## Remarks  \n Setting the thread attribute is only valid when building an .exe, as it affects the entry point of the main thread.  \n  \n If you use the default entry point (main or wmain, for example) specify the threading model either by using /CLRTHREADATTRIBUTE or by placing the threading attribute (STAThreadAttribute or MTAThreadAttribute) on the default entry function.  \n  \n If you use a non-default entry point, specify the threading model either by using /CLRTHREADATTRIBUTE or by placing the threading attribute on the non-default entry function, and then specify the non-default entry point with [/ENTRY](../../build/reference/entry-entry-point-symbol.md).  \n  \n If the threading model specified in source code does not agree with the threading model specified with /CLRTHREADATTRIBUTE, the linker will ignore /CLRTHREADATTRIBUTE and apply the threading model specified in source code.  \n  \n It will be necessary for you to use single-threading, for example, if your CLR program hosts a COM object that uses single-threading.  If your CLR program uses multi-threading, it cannot host a COM object that uses single-threading.  \n  \n### To set this linker option in the Visual Studio development environment  \n  \n1.  Open the project's **Property Pages** dialog box. For details, see [Working with Project Properties](../../ide/working-with-project-properties.md).  \n  \n2.  Expand the **Configuration Properties** node.  \n  \n3.  Expand the **Linker** node.  \n  \n4.  Select the **Advanced** property page.  \n  \n5.  Modify the **CLR Thread Attribute** property.  \n  \n### To set this linker option programmatically  \n  \n1.  See <xref:Microsoft.VisualStudio.VCProjectEngine.VCLinkerTool.CLRThreadAttribute%2A>.  \n  \n## See Also  \n [Setting Linker Options](../../build/reference/setting-linker-options.md)   \n [Linker Options](../../build/reference/linker-options.md)"}