{"nodes":[{"pos":[12,49],"content":"CMFCCaptionBar Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CMFCCaptionBar Class | Microsoft Docs","pos":[0,37]}]},{"content":"CMFCCaptionBar Class","pos":[642,662]},{"content":"A <ph id=\"ph1\">`CMFCCaptionBar`</ph> object is a control bar that can display three elements: a button, a text label, and a bitmap.","pos":[663,776],"source":"A `CMFCCaptionBar` object is a control bar that can display three elements: a button, a text label, and a bitmap."},{"content":"It can only display one element of each type at a time.","pos":[777,832]},{"content":"You can align each element to the left or right edges of the control or to the center.","pos":[833,919]},{"content":"You can also apply a flat or 3D style to the top and bottom borders of the caption bar.","pos":[920,1007]},{"content":"Syntax","pos":[1016,1022]},{"content":"Members","pos":[1084,1091]},{"content":"Public Methods","pos":[1101,1115]},{"content":"Name","pos":[1122,1126]},{"content":"Description","pos":[1127,1138]},{"content":"CMFCCaptionBar::Create","pos":[1177,1199]},{"pos":[1226,1305],"content":"Creates the caption bar control and attaches it to the <ph id=\"ph1\">`CMFCCaptionBar`</ph> object.","source":"Creates the caption bar control and attaches it to the `CMFCCaptionBar` object."},{"content":"CMFCCaptionBar::DoesAllowDynInsertBefore","pos":[1311,1351]},{"content":"Indicates whether another pane can be dynamically inserted between the caption bar and its parent frame.","pos":[1396,1500]},{"content":"(Overrides <bpt id=\"p1\">[</bpt>CBasePane::DoesAllowDynInsertBefore<ept id=\"p1\">](../../mfc/reference/cbasepane-class.md#cbasepane__doesallowdyninsertbefore)</ept>.)","pos":[1501,1627],"source":" (Overrides [CBasePane::DoesAllowDynInsertBefore](../../mfc/reference/cbasepane-class.md#cbasepane__doesallowdyninsertbefore).)"},{"content":"CMFCCaptionBar::EnableButton","pos":[1633,1661]},{"content":"Enables or disables the button on the caption bar.","pos":[1694,1744]},{"content":"CMFCCaptionBar::GetAlignment","pos":[1750,1778]},{"content":"Returns the alignment of the specified element.","pos":[1811,1858]},{"content":"CMFCCaptionBar::GetBorderSize","pos":[1864,1893]},{"content":"Returns the border size of the caption bar.","pos":[1927,1970]},{"content":"CMFCCaptionBar::GetButtonRect","pos":[1976,2005]},{"content":"Retrieves the bounding rectangle of the button on the caption bar.","pos":[2039,2105]},{"content":"CMFCCaptionBar::GetMargin","pos":[2111,2136]},{"content":"Returns the distance between the edge of the caption bar elements and the edge of the caption bar control.","pos":[2166,2272]},{"content":"CMFCCaptionBar::IsMessageBarMode","pos":[2278,2310]},{"content":"Specifies whether the caption bar is in the message bar mode.","pos":[2347,2408]},{"content":"CMFCCaptionBar::RemoveBitmap","pos":[2414,2442]},{"content":"Removes the bitmap image from the caption bar.","pos":[2475,2521]},{"content":"CMFCCaptionBar::RemoveButton","pos":[2527,2555]},{"content":"Removes the button from the caption bar.","pos":[2588,2628]},{"content":"CMFCCaptionBar::RemoveIcon","pos":[2634,2660]},{"content":"Removes the icon from the caption bar.","pos":[2691,2729]},{"content":"CMFCCaptionBar::RemoveText","pos":[2735,2761]},{"content":"Removes the text label from the caption bar.","pos":[2792,2836]},{"content":"CMFCCaptionBar::SetBitmap","pos":[2842,2867]},{"content":"Sets the bitmap image for the caption bar.","pos":[2897,2939]},{"content":"CMFCCaptionBar::SetBorderSize","pos":[2945,2974]},{"content":"Sets the border size of the caption bar.","pos":[3008,3048]},{"content":"CMFCCaptionBar::SetButton","pos":[3054,3079]},{"content":"Sets the button for the caption bar.","pos":[3109,3145]},{"content":"CMFCCaptionBar::SetButtonPressed","pos":[3151,3183]},{"content":"Specifies whether the button stays pressed.","pos":[3220,3263]},{"content":"CMFCCaptionBar::SetButtonToolTip","pos":[3269,3301]},{"content":"Sets the tooltip for the button.","pos":[3338,3370]},{"content":"CMFCCaptionBar::SetFlatBorder","pos":[3376,3405]},{"content":"Sets the border style of the caption bar.","pos":[3439,3480]},{"content":"CMFCCaptionBar::SetIcon","pos":[3486,3509]},{"content":"Sets the icon for a caption bar.","pos":[3537,3569]},{"content":"CMFCCaptionBar::SetImageToolTip","pos":[3575,3606]},{"content":"Sets the tooltip for the image for the caption bar.","pos":[3642,3693]},{"content":"CMFCCaptionBar::SetMargin","pos":[3699,3724]},{"content":"Sets the distance between the edge of the caption bar element and the edge of the caption bar control.","pos":[3754,3856]},{"content":"CMFCCaptionBar::SetText","pos":[3862,3885]},{"content":"Sets the text label for the caption bar.","pos":[3913,3953]},{"content":"Protected Methods","pos":[3964,3981]},{"content":"Name","pos":[3988,3992]},{"content":"Description","pos":[3993,4004]},{"content":"CMFCCaptionBar::OnDrawBackground","pos":[4043,4075]},{"content":"Called by the framework to fill the background of the caption bar.","pos":[4112,4178]},{"content":"CMFCCaptionBar::OnDrawBorder","pos":[4184,4212]},{"content":"Called by the framework to draw the border of the caption bar.","pos":[4245,4307]},{"content":"CMFCCaptionBar::OnDrawButton","pos":[4313,4341]},{"content":"Called by the framework to draw the caption bar button.","pos":[4374,4429]},{"content":"CMFCCaptionBar::OnDrawImage","pos":[4435,4462]},{"content":"Called by the framework to draw the caption bar image.","pos":[4494,4548]},{"content":"CMFCCaptionBar::OnDrawText","pos":[4554,4580]},{"content":"Called by the framework to draw the caption bar text.","pos":[4611,4664]},{"content":"Data Members","pos":[4675,4687]},{"content":"Name","pos":[4694,4698]},{"content":"Description","pos":[4699,4710]},{"content":"CMFCCaptionBar::m_clrBarBackground","pos":[4749,4783]},{"content":"The background color of the caption bar.","pos":[4822,4862]},{"content":"CMFCCaptionBar::m_clrBarBorder","pos":[4868,4898]},{"content":"The color of the border of the caption bar.","pos":[4933,4976]},{"content":"CMFCCaptionBar::m_clrBarText","pos":[4982,5010]},{"content":"The color of the caption bar text.","pos":[5043,5077]},{"content":"Remarks","pos":[5087,5094]},{"content":"To create a caption bar, follow these steps:","pos":[5098,5142]},{"content":"Construct the <ph id=\"ph1\">`CMFCCaptionBar`</ph> object.","pos":[5152,5190],"source":"Construct the `CMFCCaptionBar` object."},{"content":"Typically, you would add the caption bar to a frame window class.","pos":[5191,5256]},{"pos":[5266,5411],"content":"Call the <bpt id=\"p1\">[</bpt>CMFCCaptionBar::Create<ept id=\"p1\">](#cmfccaptionbar__create)</ept> method to create the caption bar control and attach it to the <ph id=\"ph1\">`CMFCCaptionBar`</ph> object.","source":"Call the [CMFCCaptionBar::Create](#cmfccaptionbar__create) method to create the caption bar control and attach it to the `CMFCCaptionBar` object."},{"pos":[5421,5681],"content":"Call <bpt id=\"p1\">[</bpt>CMFCCaptionBar::SetButton<ept id=\"p1\">](#cmfccaptionbar__setbutton)</ept>, <bpt id=\"p2\">[</bpt>CMFCCaptionBar::SetText<ept id=\"p2\">](#cmfccaptionbar__settext)</ept>, <bpt id=\"p3\">[</bpt>CMFCCaptionBar::SetIcon<ept id=\"p3\">](#cmfccaptionbar__seticon)</ept>, and <bpt id=\"p4\">[</bpt>CMFCCaptionBar::SetBitmap<ept id=\"p4\">](#cmfccaptionbar__setbitmap)</ept> to set the caption bar elements.","source":"Call [CMFCCaptionBar::SetButton](#cmfccaptionbar__setbutton), [CMFCCaptionBar::SetText](#cmfccaptionbar__settext), [CMFCCaptionBar::SetIcon](#cmfccaptionbar__seticon), and [CMFCCaptionBar::SetBitmap](#cmfccaptionbar__setbitmap) to set the caption bar elements."},{"content":"When you set the button element, you must assign a command ID to the button.","pos":[5688,5764]},{"content":"When the user clicks the button, the caption bar routes the <ph id=\"ph1\">`WM_COMMAND`</ph> messages that have this ID to the parent frame window.","pos":[5765,5892],"source":" When the user clicks the button, the caption bar routes the `WM_COMMAND` messages that have this ID to the parent frame window."},{"content":"The caption bar can also work in message bar mode, which emulates the message bar that appears in Microsoft Office 2007 applications.","pos":[5899,6032]},{"content":"In message bar mode, the caption bar displays a bitmap, a message, and a button (which typically opens a dialog box.) You can assign a tooltip to the bitmap.","pos":[6033,6190]},{"pos":[6197,6339],"content":"To enable message bar mode, call <bpt id=\"p1\">[</bpt>CMFCCaptionBar::Create<ept id=\"p1\">](#cmfccaptionbar__create)</ept> and set the fourth parameter (bIsMessageBarMode) to <ph id=\"ph1\">`TRUE`</ph>.","source":"To enable message bar mode, call [CMFCCaptionBar::Create](#cmfccaptionbar__create) and set the fourth parameter (bIsMessageBarMode) to `TRUE`."},{"content":"Example","pos":[6348,6355]},{"content":"The following example demonstrates how to use various methods in the <ph id=\"ph1\">`CMFCCaptionBar`</ph> class.","pos":[6359,6451],"source":"The following example demonstrates how to use various methods in the `CMFCCaptionBar` class."},{"content":"The example shows how to create the caption bar control, set a 3D border of the caption bar, set the distance, in pixels, between the edge of the caption bar elements and the edge of the caption bar control, set the button for the caption bar, set the tooltip for the button, set the text label for the caption bar, set the bitmap image for the caption bar, and set the tooltip for the image in the caption bar.","pos":[6452,6863]},{"content":"This code snippet is part of the <bpt id=\"p1\">[</bpt>MS Office 2007 Demo sample<ept id=\"p1\">](../../visual-cpp-samples.md)</ept>.","pos":[6864,6955],"source":" This code snippet is part of the [MS Office 2007 Demo sample](../../visual-cpp-samples.md)."},{"content":"NVC_MFC_MSOffice2007Demo#1","pos":[6973,6999]},{"content":"NVC_MFC_MSOffice2007Demo#2","pos":[7077,7103]},{"content":"Inheritance Hierarchy","pos":[7178,7199]},{"content":"CObject","pos":[7204,7211]},{"content":"CCmdTarget","pos":[7258,7268]},{"content":"CWnd","pos":[7318,7322]},{"content":"CBasePane","pos":[7366,7375]},{"content":"CPane","pos":[7424,7429]},{"content":"CMFCCaptionBar","pos":[7474,7488]},{"content":"Requirements","pos":[7543,7555]},{"pos":[7559,7586],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> afxcaptionbar.h","source":"**Header:** afxcaptionbar.h"},{"pos":[7635,7657],"content":"CMFCCaptionBar::Create"},{"pos":[7661,7740],"content":"Creates the caption bar control and attaches it to the <ph id=\"ph1\">`CMFCCaptionBar`</ph> object.","source":"Creates the caption bar control and attaches it to the `CMFCCaptionBar` object."},{"content":"Parameters","pos":[7896,7906]},{"content":"The logical OR combination of the caption bar styles.","pos":[7923,7976]},{"content":"The parent window of the caption bar control.","pos":[7999,8044]},{"content":"The ID of caption bar control.","pos":[8060,8090]},{"content":"The height, in pixels, of the caption bar control.","pos":[8110,8160]},{"content":"If it is -1, the height is calculated according to the height of the icon, the text and the button that the caption bar control displays.","pos":[8161,8298]},{"content":"if the caption bar is in the message bar mode; <ph id=\"ph1\">`FALSE`</ph> otherwise.","pos":[8335,8400],"source":" if the caption bar is in the message bar mode; `FALSE` otherwise."},{"content":"Return Value","pos":[8410,8422]},{"pos":[8433,8503],"content":"if the caption bar control is created successfully; <ph id=\"ph1\">`FALSE`</ph> otherwise.","source":" if the caption bar control is created successfully; `FALSE` otherwise."},{"content":"Remarks","pos":[8513,8520]},{"content":"You construct a <ph id=\"ph1\">`CMFCCaptionBar`</ph> object in two steps.","pos":[8524,8577],"source":"You construct a `CMFCCaptionBar` object in two steps."},{"content":"First you call the constructor, and then you call the <ph id=\"ph1\">`Create`</ph> method, which creates the Windows control and attaches it to the <ph id=\"ph2\">`CMFCCaptionBar`</ph> object.","pos":[8578,8730],"source":" First you call the constructor, and then you call the `Create` method, which creates the Windows control and attaches it to the `CMFCCaptionBar` object."},{"pos":[8797,8837],"content":"CMFCCaptionBar::DoesAllowDynInsertBefore"},{"content":"Indicates whether another pane can be dynamically inserted between the caption bar and its parent frame.","pos":[8841,8945]},{"content":"Return Value","pos":[9020,9032]},{"pos":[9036,9070],"content":"Returns <ph id=\"ph1\">`FALSE`</ph> unless overridden.","source":"Returns `FALSE` unless overridden."},{"content":"Remarks","pos":[9080,9087]},{"pos":[9142,9170],"content":"CMFCCaptionBar::EnableButton"},{"content":"Enables or disables the button on the caption bar.","pos":[9174,9224]},{"content":"Parameters","pos":[9287,9297]},{"content":"[in]","pos":[9301,9305]},{"content":"to enable the button, <ph id=\"ph1\">`FALSE`</ph> to disable the button.","pos":[9326,9378],"source":" to enable the button, `FALSE` to disable the button."},{"pos":[9433,9461],"content":"CMFCCaptionBar::GetAlignment"},{"content":"Returns the alignment of the specified element.","pos":[9465,9512]},{"content":"Parameters","pos":[9588,9598]},{"content":"[in]","pos":[9602,9606]},{"content":"A caption bar element for which to retrieve alignment.","pos":[9617,9671]},{"content":"Return Value","pos":[9681,9693]},{"content":"The alignment of an element, such as a button, a bitmap, text, or an icon.","pos":[9697,9771]},{"content":"Remarks","pos":[9781,9788]},{"content":"The alignment of the element can be one of the following values:","pos":[9792,9856]},{"content":"ALIGN_INVALID","pos":[9866,9879]},{"content":"ALIGN_LEFT","pos":[9889,9899]},{"content":"ALIGN_RIGHT","pos":[9909,9920]},{"content":"ALIGN_CENTER","pos":[9930,9942]},{"pos":[9998,10027],"content":"CMFCCaptionBar::GetBorderSize"},{"content":"Returns the border size of the caption bar.","pos":[10031,10074]},{"content":"Return Value","pos":[10129,10141]},{"content":"The size, in pixels, of the border.","pos":[10145,10180]},{"pos":[10236,10265],"content":"CMFCCaptionBar::GetButtonRect"},{"content":"Retrieves the bounding rectangle of the button on the caption bar.","pos":[10269,10335]},{"content":"Return Value","pos":[10392,10404]},{"pos":[10408,10514],"content":"A <ph id=\"ph1\">`CRect`</ph> object that contains the coordinates of the bounding rectangle of the button on the caption bar.","source":"A `CRect` object that contains the coordinates of the bounding rectangle of the button on the caption bar."},{"pos":[10566,10591],"content":"CMFCCaptionBar::GetMargin"},{"content":"Returns the distance between the edge of the caption bar elements and the edge of the caption bar control.","pos":[10595,10701]},{"content":"Return Value","pos":[10752,10764]},{"content":"The distance, in pixels, between the edge of the caption bar elements and the edge of the caption bar control.","pos":[10768,10878]},{"pos":[10937,10969],"content":"CMFCCaptionBar::IsMessageBarMode"},{"content":"Specifies whether the caption bar is in the message bar mode.","pos":[10973,11034]},{"content":"Return Value","pos":[11093,11105]},{"pos":[11116,11181],"content":"if the caption bar is in the message bar mode; <ph id=\"ph1\">`FALSE`</ph> otherwise.","source":" if the caption bar is in the message bar mode; `FALSE` otherwise."},{"content":"Remarks","pos":[11191,11198]},{"content":"In the message bar mode, the caption bar displays an image with a tooltip, a message text, and a button.","pos":[11202,11306]},{"pos":[11367,11401],"content":"CMFCCaptionBar::m_clrBarBackground"},{"content":"The background color of the caption bar.","pos":[11405,11445]},{"pos":[11547,11577],"content":"CMFCCaptionBar::m_clrBarBorder"},{"content":"The color of the border of the caption bar.","pos":[11581,11624]},{"pos":[11720,11748],"content":"CMFCCaptionBar::m_clrBarText"},{"content":"The color of the caption bar text.","pos":[11752,11786]},{"pos":[11884,11916],"content":"CMFCCaptionBar::OnDrawBackground"},{"content":"Called by the framework to fill the background of the caption bar.","pos":[11920,11986]},{"content":"Parameters","pos":[12075,12085]},{"content":"[in]","pos":[12089,12093]},{"content":"A pointer to the device context of the caption bar.","pos":[12103,12154]},{"content":"[in]","pos":[12161,12165]},{"content":"The bounding rectangle to fill.","pos":[12176,12207]},{"content":"Remarks","pos":[12217,12224]},{"content":"The <ph id=\"ph1\">`OnDrawBackground`</ph> method is called when the background of the caption bar is about to be filled.","pos":[12228,12329],"source":"The `OnDrawBackground` method is called when the background of the caption bar is about to be filled."},{"content":"The default implementation fills the background by using the <bpt id=\"p1\">[</bpt>CMFCCaptionBar::m_clrBarBackground<ept id=\"p1\">](#cmfccaptionbar__m_clrbarbackground)</ept> color.","pos":[12330,12471],"source":" The default implementation fills the background by using the [CMFCCaptionBar::m_clrBarBackground](#cmfccaptionbar__m_clrbarbackground) color."},{"pos":[12478,12582],"content":"Override this method in a <ph id=\"ph1\">`CMFCCaptionBar`</ph> derived class to customize the appearance of the caption bar.","source":"Override this method in a `CMFCCaptionBar` derived class to customize the appearance of the caption bar."},{"pos":[12637,12665],"content":"CMFCCaptionBar::OnDrawBorder"},{"content":"Called by the framework to draw the border of the caption bar.","pos":[12669,12731]},{"content":"Parameters","pos":[12816,12826]},{"content":"[in]","pos":[12830,12834]},{"content":"A device context that is used to display the borders.","pos":[12844,12897]},{"content":"[in]","pos":[12904,12908]},{"content":"The bounding rectangle.","pos":[12919,12942]},{"content":"Remarks","pos":[12952,12959]},{"content":"By default, the borders have the flat style.","pos":[12963,13007]},{"pos":[13014,13128],"content":"Override this method in a <ph id=\"ph1\">`CMFCCaptionBar`</ph> derived class to customize the appearance of the caption bar's borders.","source":"Override this method in a `CMFCCaptionBar` derived class to customize the appearance of the caption bar's borders."},{"pos":[13183,13211],"content":"CMFCCaptionBar::OnDrawButton"},{"content":"Called by the framework to draw the caption bar button.","pos":[13215,13270]},{"content":"Parameters","pos":[13408,13418]},{"content":"[in]","pos":[13422,13426]},{"content":"A pointer to a device context that is used to display the button.","pos":[13436,13501]},{"content":"[in]","pos":[13508,13512]},{"content":"The bounding rectangle of the button.","pos":[13523,13560]},{"content":"[in]","pos":[13567,13571]},{"content":"The button's text label.","pos":[13587,13611]},{"content":"[in]","pos":[13618,13622]},{"content":"if the button is enabled; <ph id=\"ph1\">`FALSE`</ph> otherwise.","pos":[13644,13688],"source":" if the button is enabled; `FALSE` otherwise."},{"content":"Remarks","pos":[13698,13705]},{"pos":[13709,13822],"content":"Override this method in a <ph id=\"ph1\">`CMFCCaptionBar`</ph> derived class to customize the appearance of the caption bar's button.","source":"Override this method in a `CMFCCaptionBar` derived class to customize the appearance of the caption bar's button."},{"pos":[13876,13903],"content":"CMFCCaptionBar::OnDrawImage"},{"content":"Called by the framework to draw the caption bar image.","pos":[13907,13961]},{"content":"Parameters","pos":[14045,14055]},{"content":"[in]","pos":[14059,14063]},{"content":"A pointer to a device context that is used to display the image.","pos":[14073,14137]},{"content":"[in]","pos":[14144,14148]},{"content":"Specifies the bounding rectangle of the image.","pos":[14159,14205]},{"content":"Remarks","pos":[14215,14222]},{"pos":[14226,14317],"content":"Override this method in a <ph id=\"ph1\">`CMFCCaptionBar`</ph> derived class to customize the image appearance.","source":"Override this method in a `CMFCCaptionBar` derived class to customize the image appearance."},{"pos":[14370,14396],"content":"CMFCCaptionBar::OnDrawText"},{"content":"Called by the framework to draw the caption bar text.","pos":[14400,14453]},{"content":"Parameters","pos":[14566,14576]},{"content":"[in]","pos":[14580,14584]},{"content":"A pointer to a device context that is used to display the button.","pos":[14594,14659]},{"content":"[in]","pos":[14666,14670]},{"content":"The bounding rectangle of the text.","pos":[14681,14716]},{"content":"[in]","pos":[14723,14727]},{"content":"The text string to display.","pos":[14741,14768]},{"content":"Remarks","pos":[14778,14785]},{"pos":[14789,14931],"content":"The default implementation displays the text by using <ph id=\"ph1\">`CDC::DrawText`</ph> and <bpt id=\"p1\">[</bpt>CMFCCaptionBar::m_clrBarText<ept id=\"p1\">](#cmfccaptionbar__m_clrbartext)</ept> color.","source":"The default implementation displays the text by using `CDC::DrawText` and [CMFCCaptionBar::m_clrBarText](#cmfccaptionbar__m_clrbartext) color."},{"pos":[14938,15049],"content":"Override this method in a <ph id=\"ph1\">`CMFCCaptionBar`</ph> derived class to customize the appearance of the caption bar's text.","source":"Override this method in a `CMFCCaptionBar` derived class to customize the appearance of the caption bar's text."},{"pos":[15104,15132],"content":"CMFCCaptionBar::RemoveBitmap"},{"content":"Removes the bitmap image from the caption bar.","pos":[15136,15182]},{"pos":[15273,15301],"content":"CMFCCaptionBar::RemoveButton"},{"content":"Removes the button from the caption bar.","pos":[15305,15345]},{"content":"Remarks","pos":[15391,15398]},{"content":"The layout of caption bar elements are adjusted automatically.","pos":[15402,15464]},{"pos":[15517,15543],"content":"CMFCCaptionBar::RemoveIcon"},{"content":"Removes the icon from the caption bar.","pos":[15547,15585]},{"pos":[15672,15698],"content":"CMFCCaptionBar::RemoveText"},{"content":"Removes the text label from the caption bar.","pos":[15702,15746]},{"pos":[15832,15857],"content":"CMFCCaptionBar::SetBitmap"},{"content":"Sets the bitmap image for the caption bar.","pos":[15861,15903]},{"content":"Parameters","pos":[16227,16237]},{"content":"[in]","pos":[16241,16245]},{"content":"The handle to the bitmap to set.","pos":[16259,16291]},{"content":"[in]","pos":[16298,16302]},{"content":"An RGB value that specifies the transparent color of the bitmap.","pos":[16323,16387]},{"content":"[in]","pos":[16394,16398]},{"content":"If <ph id=\"ph1\">`TRUE`</ph>, the bitmap is stretched if it does not fit to the image bounding rectangle.","pos":[16413,16499],"source":" If `TRUE`, the bitmap is stretched if it does not fit to the image bounding rectangle."},{"content":"Otherwise the bitmap is not stretched.","pos":[16500,16538]},{"content":"[in]","pos":[16545,16549]},{"content":"The alignment of the bitmap.","pos":[16568,16596]},{"content":"Remarks","pos":[16606,16613]},{"content":"Use this method to set a bitmap on a caption bar.","pos":[16617,16666]},{"content":"The previous bitmap is destroyed automatically.","pos":[16673,16720]},{"content":"If the caption bar displays an icon because you called the <bpt id=\"p1\">[</bpt>CMFCCaptionBar::SetIcon<ept id=\"p1\">](#cmfccaptionbar__seticon)</ept> method, the bitmap will not be displayed unless you remove the icon by calling <bpt id=\"p2\">[</bpt>CMFCCaptionBar::RemoveIcon<ept id=\"p2\">](#cmfccaptionbar__removeicon)</ept>.","pos":[16721,16969],"source":" If the caption bar displays an icon because you called the [CMFCCaptionBar::SetIcon](#cmfccaptionbar__seticon) method, the bitmap will not be displayed unless you remove the icon by calling [CMFCCaptionBar::RemoveIcon](#cmfccaptionbar__removeicon)."},{"content":"The bitmap is aligned as specified by the <ph id=\"ph1\">`bmpAlignment`</ph> parameter.","pos":[16976,17043],"source":"The bitmap is aligned as specified by the `bmpAlignment` parameter."},{"content":"This parameter can be one of the following <ph id=\"ph1\">`BarElementAlignment`</ph> values:","pos":[17045,17117],"source":"  This parameter can be one of the following `BarElementAlignment` values:"},{"content":"ALIGN_INVALID","pos":[17127,17140]},{"content":"ALIGN_LEFT","pos":[17150,17160]},{"content":"ALIGN_RIGHT","pos":[17170,17181]},{"content":"ALIGN_CENTER","pos":[17191,17203]},{"pos":[17259,17288],"content":"CMFCCaptionBar::SetBorderSize"},{"content":"Sets the border size of the caption bar.","pos":[17292,17332]},{"content":"Parameters","pos":[17388,17398]},{"content":"[in]","pos":[17402,17406]},{"content":"The new size, in pixels, of the caption bar border.","pos":[17418,17469]},{"pos":[17521,17546],"content":"CMFCCaptionBar::SetButton"},{"content":"Sets the button for the caption bar.","pos":[17550,17586]},{"content":"Parameters","pos":[17757,17767]},{"content":"The button's command label.","pos":[17786,17813]},{"content":"The button's command ID.","pos":[17833,17857]},{"content":"The button's alignment.","pos":[17882,17905]},{"content":"if the button displays a drop down arrow, <ph id=\"ph1\">`FALSE`</ph> otherwise.","pos":[17942,18002],"source":" if the button displays a drop down arrow, `FALSE` otherwise."},{"pos":[18061,18093],"content":"CMFCCaptionBar::SetButtonPressed"},{"content":"Specifies whether the button stays pressed.","pos":[18097,18140]},{"content":"Parameters","pos":[18207,18217]},{"content":"if the button keeps its pressed state, <ph id=\"ph1\">`FALSE`</ph> otherwise.","pos":[18241,18298],"source":" if the button keeps its pressed state, `FALSE` otherwise."},{"pos":[18357,18389],"content":"CMFCCaptionBar::SetButtonToolTip"},{"content":"Sets the tooltip for the button.","pos":[18393,18425]},{"content":"Parameters","pos":[18535,18545]},{"content":"[in]","pos":[18549,18553]},{"content":"The tooltip caption.","pos":[18571,18591]},{"content":"[in]","pos":[18598,18602]},{"content":"The tooltip description.","pos":[18624,18648]},{"pos":[18704,18733],"content":"CMFCCaptionBar::SetFlatBorder"},{"content":"Sets the border style of the caption bar.","pos":[18737,18778]},{"content":"Parameters","pos":[18840,18850]},{"content":"[in]","pos":[18854,18858]},{"content":"if the border of a caption bar is flat.","pos":[18877,18916]},{"content":"if the border is 3D.","pos":[18925,18945]},{"pos":[18995,19018],"content":"CMFCCaptionBar::SetIcon"},{"content":"Sets the icon for a caption bar.","pos":[19022,19054]},{"content":"Parameters","pos":[19164,19174]},{"content":"[in]","pos":[19178,19182]},{"content":"The handle to the icon to set.","pos":[19194,19224]},{"content":"[in]","pos":[19231,19235]},{"content":"The alignment of the icon.","pos":[19255,19281]},{"content":"Remarks","pos":[19291,19298]},{"content":"Caption bars can display either icons or bitmaps.","pos":[19302,19351]},{"content":"See <bpt id=\"p1\">[</bpt>CMFCCaptionBar::SetBitmap<ept id=\"p1\">](#cmfccaptionbar__setbitmap)</ept> to find out how to display a bitmap.","pos":[19352,19448],"source":" See [CMFCCaptionBar::SetBitmap](#cmfccaptionbar__setbitmap) to find out how to display a bitmap."},{"content":"If you set both an icon and a bitmap, the icon is always displayed.","pos":[19449,19516]},{"content":"Call <bpt id=\"p1\">[</bpt>CMFCCaptionBar::RemoveIcon<ept id=\"p1\">](#cmfccaptionbar__removeicon)</ept> to remove an icon from the caption bar.","pos":[19517,19619],"source":" Call [CMFCCaptionBar::RemoveIcon](#cmfccaptionbar__removeicon) to remove an icon from the caption bar."},{"content":"The icon is aligned according to the <ph id=\"ph1\">`iconAlignment`</ph> parameter.","pos":[19626,19689],"source":"The icon is aligned according to the `iconAlignment` parameter."},{"content":"It can be one of the following <ph id=\"ph1\">`BarElementAlignment`</ph> values:","pos":[19690,19750],"source":" It can be one of the following `BarElementAlignment` values:"},{"content":"ALIGN_INVALID","pos":[19760,19773]},{"content":"ALIGN_LEFT","pos":[19783,19793]},{"content":"ALIGN_RIGHT","pos":[19803,19814]},{"content":"ALIGN_CENTER","pos":[19824,19836]},{"pos":[19894,19925],"content":"CMFCCaptionBar::SetImageToolTip"},{"content":"Sets the tooltip for the image in the caption bar.","pos":[19929,19979]},{"content":"Parameters","pos":[20088,20098]},{"content":"[in]","pos":[20102,20106]},{"content":"The text of the tooltip.","pos":[20124,20148]},{"content":"[in]","pos":[20155,20159]},{"content":"The tooltip description.","pos":[20181,20205]},{"pos":[20257,20282],"content":"CMFCCaptionBar::SetMargin"},{"content":"Sets the distance between the edge of the caption bar element and the edge of the caption bar control.","pos":[20286,20388]},{"content":"Parameters","pos":[20442,20452]},{"content":"[in]","pos":[20456,20460]},{"content":"The distance, in pixels, between the edge of the caption bar elements and the edge of the caption bar control.","pos":[20474,20584]},{"pos":[20634,20657],"content":"CMFCCaptionBar::SetText"},{"content":"Sets the text label for the caption bar.","pos":[20661,20701]},{"content":"Parameters","pos":[20822,20832]},{"content":"[in]","pos":[20836,20840]},{"content":"The text string to set.","pos":[20854,20877]},{"content":"[in]","pos":[20884,20888]},{"content":"The text alignment.","pos":[20908,20927]},{"content":"Remarks","pos":[20937,20944]},{"content":"The text label is aligned as specified by the <ph id=\"ph1\">`textAlignment`</ph> parameter.","pos":[20948,21020],"source":"The text label is aligned as specified by the `textAlignment` parameter."},{"content":"It can be one of the following <ph id=\"ph1\">`BarElementAlignment`</ph> values:","pos":[21021,21081],"source":" It can be one of the following `BarElementAlignment` values:"},{"content":"ALIGN_INVALID","pos":[21091,21104]},{"content":"ALIGN_LEFT","pos":[21114,21124]},{"content":"ALIGN_RIGHT","pos":[21134,21145]},{"content":"ALIGN_CENTER","pos":[21155,21167]},{"content":"See Also","pos":[21176,21184]},{"content":"Hierarchy Chart","pos":[21189,21204]},{"content":"Classes","pos":[21241,21248]}],"content":"---\ntitle: \"CMFCCaptionBar Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CMFCCaptionBar\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CMFCCaptionBar class\"\nms.assetid: acb54d5f-14ff-4c96-aeb3-7717cf566d9a\ncaps.latest.revision: 28\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# CMFCCaptionBar Class\nA `CMFCCaptionBar` object is a control bar that can display three elements: a button, a text label, and a bitmap. It can only display one element of each type at a time. You can align each element to the left or right edges of the control or to the center. You can also apply a flat or 3D style to the top and bottom borders of the caption bar.  \n  \n## Syntax  \n  \n```  \nclass CMFCCaptionBar : public CPane  \n```  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCCaptionBar::Create](#cmfccaptionbar__create)|Creates the caption bar control and attaches it to the `CMFCCaptionBar` object.|  \n|[CMFCCaptionBar::DoesAllowDynInsertBefore](#cmfccaptionbar__doesallowdyninsertbefore)|Indicates whether another pane can be dynamically inserted between the caption bar and its parent frame. (Overrides [CBasePane::DoesAllowDynInsertBefore](../../mfc/reference/cbasepane-class.md#cbasepane__doesallowdyninsertbefore).)|  \n|[CMFCCaptionBar::EnableButton](#cmfccaptionbar__enablebutton)|Enables or disables the button on the caption bar.|  \n|[CMFCCaptionBar::GetAlignment](#cmfccaptionbar__getalignment)|Returns the alignment of the specified element.|  \n|[CMFCCaptionBar::GetBorderSize](#cmfccaptionbar__getbordersize)|Returns the border size of the caption bar.|  \n|[CMFCCaptionBar::GetButtonRect](#cmfccaptionbar__getbuttonrect)|Retrieves the bounding rectangle of the button on the caption bar.|  \n|[CMFCCaptionBar::GetMargin](#cmfccaptionbar__getmargin)|Returns the distance between the edge of the caption bar elements and the edge of the caption bar control.|  \n|[CMFCCaptionBar::IsMessageBarMode](#cmfccaptionbar__ismessagebarmode)|Specifies whether the caption bar is in the message bar mode.|  \n|[CMFCCaptionBar::RemoveBitmap](#cmfccaptionbar__removebitmap)|Removes the bitmap image from the caption bar.|  \n|[CMFCCaptionBar::RemoveButton](#cmfccaptionbar__removebutton)|Removes the button from the caption bar.|  \n|[CMFCCaptionBar::RemoveIcon](#cmfccaptionbar__removeicon)|Removes the icon from the caption bar.|  \n|[CMFCCaptionBar::RemoveText](#cmfccaptionbar__removetext)|Removes the text label from the caption bar.|  \n|[CMFCCaptionBar::SetBitmap](#cmfccaptionbar__setbitmap)|Sets the bitmap image for the caption bar.|  \n|[CMFCCaptionBar::SetBorderSize](#cmfccaptionbar__setbordersize)|Sets the border size of the caption bar.|  \n|[CMFCCaptionBar::SetButton](#cmfccaptionbar__setbutton)|Sets the button for the caption bar.|  \n|[CMFCCaptionBar::SetButtonPressed](#cmfccaptionbar__setbuttonpressed)|Specifies whether the button stays pressed.|  \n|[CMFCCaptionBar::SetButtonToolTip](#cmfccaptionbar__setbuttontooltip)|Sets the tooltip for the button.|  \n|[CMFCCaptionBar::SetFlatBorder](#cmfccaptionbar__setflatborder)|Sets the border style of the caption bar.|  \n|[CMFCCaptionBar::SetIcon](#cmfccaptionbar__seticon)|Sets the icon for a caption bar.|  \n|[CMFCCaptionBar::SetImageToolTip](#cmfccaptionbar__setimagetooltip)|Sets the tooltip for the image for the caption bar.|  \n|[CMFCCaptionBar::SetMargin](#cmfccaptionbar__setmargin)|Sets the distance between the edge of the caption bar element and the edge of the caption bar control.|  \n|[CMFCCaptionBar::SetText](#cmfccaptionbar__settext)|Sets the text label for the caption bar.|  \n  \n### Protected Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCCaptionBar::OnDrawBackground](#cmfccaptionbar__ondrawbackground)|Called by the framework to fill the background of the caption bar.|  \n|[CMFCCaptionBar::OnDrawBorder](#cmfccaptionbar__ondrawborder)|Called by the framework to draw the border of the caption bar.|  \n|[CMFCCaptionBar::OnDrawButton](#cmfccaptionbar__ondrawbutton)|Called by the framework to draw the caption bar button.|  \n|[CMFCCaptionBar::OnDrawImage](#cmfccaptionbar__ondrawimage)|Called by the framework to draw the caption bar image.|  \n|[CMFCCaptionBar::OnDrawText](#cmfccaptionbar__ondrawtext)|Called by the framework to draw the caption bar text.|  \n  \n### Data Members  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CMFCCaptionBar::m_clrBarBackground](#cmfccaptionbar__m_clrbarbackground)|The background color of the caption bar.|  \n|[CMFCCaptionBar::m_clrBarBorder](#cmfccaptionbar__m_clrbarborder)|The color of the border of the caption bar.|  \n|[CMFCCaptionBar::m_clrBarText](#cmfccaptionbar__m_clrbartext)|The color of the caption bar text.|  \n  \n## Remarks  \n To create a caption bar, follow these steps:  \n  \n1.  Construct the `CMFCCaptionBar` object. Typically, you would add the caption bar to a frame window class.  \n  \n2.  Call the [CMFCCaptionBar::Create](#cmfccaptionbar__create) method to create the caption bar control and attach it to the `CMFCCaptionBar` object.  \n  \n3.  Call [CMFCCaptionBar::SetButton](#cmfccaptionbar__setbutton), [CMFCCaptionBar::SetText](#cmfccaptionbar__settext), [CMFCCaptionBar::SetIcon](#cmfccaptionbar__seticon), and [CMFCCaptionBar::SetBitmap](#cmfccaptionbar__setbitmap) to set the caption bar elements.  \n  \n When you set the button element, you must assign a command ID to the button. When the user clicks the button, the caption bar routes the `WM_COMMAND` messages that have this ID to the parent frame window.  \n  \n The caption bar can also work in message bar mode, which emulates the message bar that appears in Microsoft Office 2007 applications. In message bar mode, the caption bar displays a bitmap, a message, and a button (which typically opens a dialog box.) You can assign a tooltip to the bitmap.  \n  \n To enable message bar mode, call [CMFCCaptionBar::Create](#cmfccaptionbar__create) and set the fourth parameter (bIsMessageBarMode) to `TRUE`.  \n  \n## Example  \n The following example demonstrates how to use various methods in the `CMFCCaptionBar` class. The example shows how to create the caption bar control, set a 3D border of the caption bar, set the distance, in pixels, between the edge of the caption bar elements and the edge of the caption bar control, set the button for the caption bar, set the tooltip for the button, set the text label for the caption bar, set the bitmap image for the caption bar, and set the tooltip for the image in the caption bar. This code snippet is part of the [MS Office 2007 Demo sample](../../visual-cpp-samples.md).  \n  \n [!code-cpp[NVC_MFC_MSOffice2007Demo#1](../../mfc/reference/codesnippet/cpp/cmfccaptionbar-class_1.h)]  \n[!code-cpp[NVC_MFC_MSOffice2007Demo#2](../../mfc/reference/codesnippet/cpp/cmfccaptionbar-class_2.cpp)]  \n  \n## Inheritance Hierarchy  \n [CObject](../../mfc/reference/cobject-class.md)  \n  \n [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  \n  \n [CWnd](../../mfc/reference/cwnd-class.md)  \n  \n [CBasePane](../../mfc/reference/cbasepane-class.md)  \n  \n [CPane](../../mfc/reference/cpane-class.md)  \n  \n [CMFCCaptionBar](../../mfc/reference/cmfccaptionbar-class.md)  \n  \n## Requirements  \n **Header:** afxcaptionbar.h  \n  \n##  <a name=\"cmfccaptionbar__create\"></a>  CMFCCaptionBar::Create  \n Creates the caption bar control and attaches it to the `CMFCCaptionBar` object.  \n  \n```  \nBOOL Create(\n    DWORD dwStyle,  \n    CWnd* pParentWnd,  \n    UINT uID,  \n    int nHeight=-1,  \n    BOOL bIsMessageBarMode=FALSE);\n```  \n  \n### Parameters  \n `dwStyle`  \n The logical OR combination of the caption bar styles.  \n  \n `pParentWnd`  \n The parent window of the caption bar control.  \n  \n `uID`  \n The ID of caption bar control.  \n  \n `nHeight`  \n The height, in pixels, of the caption bar control. If it is -1, the height is calculated according to the height of the icon, the text and the button that the caption bar control displays.  \n  \n `bIsMessageBarMode`  \n `TRUE` if the caption bar is in the message bar mode; `FALSE` otherwise.  \n  \n### Return Value  \n `TRUE` if the caption bar control is created successfully; `FALSE` otherwise.  \n  \n### Remarks  \n You construct a `CMFCCaptionBar` object in two steps. First you call the constructor, and then you call the `Create` method, which creates the Windows control and attaches it to the `CMFCCaptionBar` object.  \n  \n##  <a name=\"cmfccaptionbar__doesallowdyninsertbefore\"></a>  CMFCCaptionBar::DoesAllowDynInsertBefore  \n Indicates whether another pane can be dynamically inserted between the caption bar and its parent frame.  \n  \n```  \nvirtual BOOL DoesAllowDynInsertBefore() const;\n\n \n```  \n  \n### Return Value  \n Returns `FALSE` unless overridden.  \n  \n### Remarks  \n  \n##  <a name=\"cmfccaptionbar__enablebutton\"></a>  CMFCCaptionBar::EnableButton  \n Enables or disables the button on the caption bar.  \n  \n```  \nvoid EnableButton(BOOL bEnable=TRUE);\n```  \n  \n### Parameters  \n [in] `bEnable`  \n `TRUE` to enable the button, `FALSE` to disable the button.  \n  \n##  <a name=\"cmfccaptionbar__getalignment\"></a>  CMFCCaptionBar::GetAlignment  \n Returns the alignment of the specified element.  \n  \n```  \nBarElementAlignment GetAlignment(BarElement elem);\n```  \n  \n### Parameters  \n [in] `elem`  \n A caption bar element for which to retrieve alignment.  \n  \n### Return Value  \n The alignment of an element, such as a button, a bitmap, text, or an icon.  \n  \n### Remarks  \n The alignment of the element can be one of the following values:  \n  \n-   ALIGN_INVALID  \n  \n-   ALIGN_LEFT  \n  \n-   ALIGN_RIGHT  \n  \n-   ALIGN_CENTER  \n  \n##  <a name=\"cmfccaptionbar__getbordersize\"></a>  CMFCCaptionBar::GetBorderSize  \n Returns the border size of the caption bar.  \n  \n```  \nint GetBorderSize() const;\n\n \n```  \n  \n### Return Value  \n The size, in pixels, of the border.  \n  \n##  <a name=\"cmfccaptionbar__getbuttonrect\"></a>  CMFCCaptionBar::GetButtonRect  \n Retrieves the bounding rectangle of the button on the caption bar.  \n  \n```  \nCRect GetButtonRect() const;\n\n \n```  \n  \n### Return Value  \n A `CRect` object that contains the coordinates of the bounding rectangle of the button on the caption bar.  \n  \n##  <a name=\"cmfccaptionbar__getmargin\"></a>  CMFCCaptionBar::GetMargin  \n Returns the distance between the edge of the caption bar elements and the edge of the caption bar control.  \n  \n```  \nint GetMargin() const;\n\n \n```  \n  \n### Return Value  \n The distance, in pixels, between the edge of the caption bar elements and the edge of the caption bar control.  \n  \n##  <a name=\"cmfccaptionbar__ismessagebarmode\"></a>  CMFCCaptionBar::IsMessageBarMode  \n Specifies whether the caption bar is in the message bar mode.  \n  \n```  \nBOOL IsMessageBarMode() const;\n\n \n```  \n  \n### Return Value  \n `TRUE` if the caption bar is in the message bar mode; `FALSE` otherwise.  \n  \n### Remarks  \n In the message bar mode, the caption bar displays an image with a tooltip, a message text, and a button.  \n  \n##  <a name=\"cmfccaptionbar__m_clrbarbackground\"></a>  CMFCCaptionBar::m_clrBarBackground  \n The background color of the caption bar.  \n  \n```  \nCOLORREF m_clrBarBackground  \n```  \n  \n##  <a name=\"cmfccaptionbar__m_clrbarborder\"></a>  CMFCCaptionBar::m_clrBarBorder  \n The color of the border of the caption bar.  \n  \n```  \nCOLORREF m_clrBarBorder  \n```  \n  \n##  <a name=\"cmfccaptionbar__m_clrbartext\"></a>  CMFCCaptionBar::m_clrBarText  \n The color of the caption bar text.  \n  \n```  \nCOLORREF m_clrBarText  \n```  \n  \n##  <a name=\"cmfccaptionbar__ondrawbackground\"></a>  CMFCCaptionBar::OnDrawBackground  \n Called by the framework to fill the background of the caption bar.  \n  \n```  \nvirtual void OnDrawBackground(\n    CDC* pDC,  \n    CRect rect);\n```  \n  \n### Parameters  \n [in] `pDC`  \n A pointer to the device context of the caption bar.  \n  \n [in] `rect`  \n The bounding rectangle to fill.  \n  \n### Remarks  \n The `OnDrawBackground` method is called when the background of the caption bar is about to be filled. The default implementation fills the background by using the [CMFCCaptionBar::m_clrBarBackground](#cmfccaptionbar__m_clrbarbackground) color.  \n  \n Override this method in a `CMFCCaptionBar` derived class to customize the appearance of the caption bar.  \n  \n##  <a name=\"cmfccaptionbar__ondrawborder\"></a>  CMFCCaptionBar::OnDrawBorder  \n Called by the framework to draw the border of the caption bar.  \n  \n```  \nvirtual void OnDrawBorder(\n    CDC* pDC,  \n    CRect rect);\n```  \n  \n### Parameters  \n [in] `pDC`  \n A device context that is used to display the borders.  \n  \n [in] `rect`  \n The bounding rectangle.  \n  \n### Remarks  \n By default, the borders have the flat style.  \n  \n Override this method in a `CMFCCaptionBar` derived class to customize the appearance of the caption bar's borders.  \n  \n##  <a name=\"cmfccaptionbar__ondrawbutton\"></a>  CMFCCaptionBar::OnDrawButton  \n Called by the framework to draw the caption bar button.  \n  \n```  \nvirtual void OnDrawButton(\n    CDC* pDC,  \n    CRect rect,  \n    const CString& strButton,  \n    BOOL bEnabled);\n```  \n  \n### Parameters  \n [in] `pDC`  \n A pointer to a device context that is used to display the button.  \n  \n [in] `rect`  \n The bounding rectangle of the button.  \n  \n [in] `strButton`  \n The button's text label.  \n  \n [in] `bEnabled`  \n `TRUE` if the button is enabled; `FALSE` otherwise.  \n  \n### Remarks  \n Override this method in a `CMFCCaptionBar` derived class to customize the appearance of the caption bar's button.  \n  \n##  <a name=\"cmfccaptionbar__ondrawimage\"></a>  CMFCCaptionBar::OnDrawImage  \n Called by the framework to draw the caption bar image.  \n  \n```  \nvirtual void OnDrawImage(\n    CDC* pDC,  \n    CRect rect);\n```  \n  \n### Parameters  \n [in] `pDC`  \n A pointer to a device context that is used to display the image.  \n  \n [in] `rect`  \n Specifies the bounding rectangle of the image.  \n  \n### Remarks  \n Override this method in a `CMFCCaptionBar` derived class to customize the image appearance.  \n  \n##  <a name=\"cmfccaptionbar__ondrawtext\"></a>  CMFCCaptionBar::OnDrawText  \n Called by the framework to draw the caption bar text.  \n  \n```  \nvirtual void OnDrawText(\n    CDC* pDC,  \n    CRect rect,  \n    const CString& strText);\n```  \n  \n### Parameters  \n [in] `pDC`  \n A pointer to a device context that is used to display the button.  \n  \n [in] `rect`  \n The bounding rectangle of the text.  \n  \n [in] `strText`  \n The text string to display.  \n  \n### Remarks  \n The default implementation displays the text by using `CDC::DrawText` and [CMFCCaptionBar::m_clrBarText](#cmfccaptionbar__m_clrbartext) color.  \n  \n Override this method in a `CMFCCaptionBar` derived class to customize the appearance of the caption bar's text.  \n  \n##  <a name=\"cmfccaptionbar__removebitmap\"></a>  CMFCCaptionBar::RemoveBitmap  \n Removes the bitmap image from the caption bar.  \n  \n```  \nvoid RemoveBitmap();\n```  \n  \n##  <a name=\"cmfccaptionbar__removebutton\"></a>  CMFCCaptionBar::RemoveButton  \n Removes the button from the caption bar.  \n  \n```  \nvoid RemoveButton();\n```  \n  \n### Remarks  \n The layout of caption bar elements are adjusted automatically.  \n  \n##  <a name=\"cmfccaptionbar__removeicon\"></a>  CMFCCaptionBar::RemoveIcon  \n Removes the icon from the caption bar.  \n  \n```  \nvoid RemoveIcon();\n```  \n  \n##  <a name=\"cmfccaptionbar__removetext\"></a>  CMFCCaptionBar::RemoveText  \n Removes the text label from the caption bar.  \n  \n```  \nvoid RemoveText();\n```  \n  \n##  <a name=\"cmfccaptionbar__setbitmap\"></a>  CMFCCaptionBar::SetBitmap  \n Sets the bitmap image for the caption bar.  \n  \n```  \nvoid SetBitmap(\n    HBITMAP hBitmap,  \n    COLORREF clrTransparent,  \n    BOOL bStretch=FALSE,  \n    BarElementAlignment bmpAlignment=ALIGN_RIGHT);\n\n \nvoid SetBitmap(\n    UINT uiBmpResID,  \n    COLORREF clrTransparent,  \n    BOOL bStretch=FALSE,  \n    BarElementAlignment bmpAlignment=ALIGN_RIGHT);\n```  \n  \n### Parameters  \n [in] `hBitmap`  \n The handle to the bitmap to set.  \n  \n [in] `clrTransparent`  \n An RGB value that specifies the transparent color of the bitmap.  \n  \n [in] `bStretch`  \n If `TRUE`, the bitmap is stretched if it does not fit to the image bounding rectangle. Otherwise the bitmap is not stretched.  \n  \n [in] `bmpAlignment`  \n The alignment of the bitmap.  \n  \n### Remarks  \n Use this method to set a bitmap on a caption bar.  \n  \n The previous bitmap is destroyed automatically. If the caption bar displays an icon because you called the [CMFCCaptionBar::SetIcon](#cmfccaptionbar__seticon) method, the bitmap will not be displayed unless you remove the icon by calling [CMFCCaptionBar::RemoveIcon](#cmfccaptionbar__removeicon).  \n  \n The bitmap is aligned as specified by the `bmpAlignment` parameter.  This parameter can be one of the following `BarElementAlignment` values:  \n  \n-   ALIGN_INVALID  \n  \n-   ALIGN_LEFT  \n  \n-   ALIGN_RIGHT  \n  \n-   ALIGN_CENTER  \n  \n##  <a name=\"cmfccaptionbar__setbordersize\"></a>  CMFCCaptionBar::SetBorderSize  \n Sets the border size of the caption bar.  \n  \n```  \nvoid SetBorderSize(int nSize);\n```  \n  \n### Parameters  \n [in] `nSize`  \n The new size, in pixels, of the caption bar border.  \n  \n##  <a name=\"cmfccaptionbar__setbutton\"></a>  CMFCCaptionBar::SetButton  \n Sets the button for the caption bar.  \n  \n```  \nvoid SetButton(\n    LPCTSTR lpszLabel,  \n    UINT uiCmdUI,  \n    BarElementAlignment btnAlignmnet=ALIGN_LEFT,  \n    BOOL bHasDropDownArrow=TRUE);\n```  \n  \n### Parameters  \n `lpszLabel`  \n The button's command label.  \n  \n `uiCmdUI`  \n The button's command ID.  \n  \n `btnAlignmnet`  \n The button's alignment.  \n  \n `bHasDropDownArrow`  \n `TRUE` if the button displays a drop down arrow, `FALSE` otherwise.  \n  \n##  <a name=\"cmfccaptionbar__setbuttonpressed\"></a>  CMFCCaptionBar::SetButtonPressed  \n Specifies whether the button stays pressed.  \n  \n```  \nvoid SetButtonPressed(BOOL bPresed=TRUE);\n```  \n  \n### Parameters  \n `bPresed`  \n `TRUE` if the button keeps its pressed state, `FALSE` otherwise.  \n  \n##  <a name=\"cmfccaptionbar__setbuttontooltip\"></a>  CMFCCaptionBar::SetButtonToolTip  \n Sets the tooltip for the button.  \n  \n```  \nvoid SetButtonToolTip(\n    LPCTSTR lpszToolTip,  \n    LPCTSTR lpszDescription=NULL);\n```  \n  \n### Parameters  \n [in] `lpszToolTip`  \n The tooltip caption.  \n  \n [in] `lpszDescription`  \n The tooltip description.  \n  \n##  <a name=\"cmfccaptionbar__setflatborder\"></a>  CMFCCaptionBar::SetFlatBorder  \n Sets the border style of the caption bar.  \n  \n```  \nvoid SetFlatBorder(BOOL bFlat=TRUE);\n```  \n  \n### Parameters  \n [in] `bFlat`  \n `TRUE` if the border of a caption bar is flat. `FALSE` if the border is 3D.  \n  \n##  <a name=\"cmfccaptionbar__seticon\"></a>  CMFCCaptionBar::SetIcon  \n Sets the icon for a caption bar.  \n  \n```  \nvoid SetIcon(\n    HICON hIcon,  \n    BarElementAlignment iconAlignment=ALIGN_RIGHT);\n```  \n  \n### Parameters  \n [in] `hIcon`  \n The handle to the icon to set.  \n  \n [in] `iconAlignment`  \n The alignment of the icon.  \n  \n### Remarks  \n Caption bars can display either icons or bitmaps. See [CMFCCaptionBar::SetBitmap](#cmfccaptionbar__setbitmap) to find out how to display a bitmap. If you set both an icon and a bitmap, the icon is always displayed. Call [CMFCCaptionBar::RemoveIcon](#cmfccaptionbar__removeicon) to remove an icon from the caption bar.  \n  \n The icon is aligned according to the `iconAlignment` parameter. It can be one of the following `BarElementAlignment` values:  \n  \n-   ALIGN_INVALID  \n  \n-   ALIGN_LEFT  \n  \n-   ALIGN_RIGHT  \n  \n-   ALIGN_CENTER  \n  \n##  <a name=\"cmfccaptionbar__setimagetooltip\"></a>  CMFCCaptionBar::SetImageToolTip  \n Sets the tooltip for the image in the caption bar.  \n  \n```  \nvoid SetImageToolTip(\n    LPCTSTR lpszToolTip,  \n    LPCTSTR lpszDescription=NULL);\n```  \n  \n### Parameters  \n [in] `lpszToolTip`  \n The text of the tooltip.  \n  \n [in] `lpszDescription`  \n The tooltip description.  \n  \n##  <a name=\"cmfccaptionbar__setmargin\"></a>  CMFCCaptionBar::SetMargin  \n Sets the distance between the edge of the caption bar element and the edge of the caption bar control.  \n  \n```  \nvoid SetMargin(int nMargin);\n```  \n  \n### Parameters  \n [in] `nMargin`  \n The distance, in pixels, between the edge of the caption bar elements and the edge of the caption bar control.  \n  \n##  <a name=\"cmfccaptionbar__settext\"></a>  CMFCCaptionBar::SetText  \n Sets the text label for the caption bar.  \n  \n```  \nvoid SetText(\n    const CString& strText,  \n    BarElementAlignment textAlignment=ALIGN_RIGHT);\n```  \n  \n### Parameters  \n [in] `strText`  \n The text string to set.  \n  \n [in] `textAlignment`  \n The text alignment.  \n  \n### Remarks  \n The text label is aligned as specified by the `textAlignment` parameter. It can be one of the following `BarElementAlignment` values:  \n  \n-   ALIGN_INVALID  \n  \n-   ALIGN_LEFT  \n  \n-   ALIGN_RIGHT  \n  \n-   ALIGN_CENTER  \n  \n## See Also  \n [Hierarchy Chart](../../mfc/hierarchy-chart.md)   \n [Classes](../../mfc/reference/mfc-classes.md)\n"}