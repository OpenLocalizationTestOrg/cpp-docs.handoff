{"nodes":[{"pos":[12,47],"content":"fclose, _fcloseall | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"fclose, _fcloseall | Microsoft Docs","pos":[0,35]}]},{"content":"fclose, _fcloseall","pos":[1022,1040]},{"pos":[1041,1110],"content":"Closes a stream (<ph id=\"ph1\">`fclose`</ph>) or closes all open streams (<ph id=\"ph2\">`_fcloseall`</ph>).","source":"Closes a stream (`fclose`) or closes all open streams (`_fcloseall`)."},{"content":"Syntax","pos":[1119,1125]},{"content":"Parameters","pos":[1216,1226]},{"content":"Pointer to <ph id=\"ph1\">`FILE`</ph> structure.","pos":[1242,1270],"source":" Pointer to `FILE` structure."},{"content":"Return Value","pos":[1279,1291]},{"content":"returns 0 if the stream is successfully closed.","pos":[1304,1351]},{"content":"returns the total number of streams closed.","pos":[1365,1408]},{"content":"Both functions return <ph id=\"ph1\">`EOF`</ph> to indicate an error.","pos":[1409,1458],"source":" Both functions return `EOF` to indicate an error."},{"content":"Remarks","pos":[1467,1474]},{"content":"The <ph id=\"ph1\">`fclose`</ph> function closes <ph id=\"ph2\">`stream`</ph>.","pos":[1478,1516],"source":"The `fclose` function closes `stream`."},{"content":"If <ph id=\"ph1\">`stream`</ph> is <ph id=\"ph2\">`NULL`</ph>, the invalid parameter handler is invoked, as described in <bpt id=\"p1\">[</bpt>Parameter Validation<ept id=\"p1\">](../../c-runtime-library/parameter-validation.md)</ept>.","pos":[1517,1670],"source":" If `stream` is `NULL`, the invalid parameter handler is invoked, as described in [Parameter Validation](../../c-runtime-library/parameter-validation.md)."},{"content":"If execution is allowed to continue, <ph id=\"ph1\">`fclose`</ph> sets <ph id=\"ph2\">`errno`</ph> to <ph id=\"ph3\">`EINVAL`</ph> and returns <ph id=\"ph4\">`EOF`</ph>.","pos":[1671,1760],"source":" If execution is allowed to continue, `fclose` sets `errno` to `EINVAL` and returns `EOF`."},{"content":"It is recommended that the <ph id=\"ph1\">`stream`</ph> pointer always be checked prior to calling this function.","pos":[1761,1854],"source":" It is recommended that the `stream` pointer always be checked prior to calling this function."},{"pos":[1861,2035],"content":"See <bpt id=\"p1\">[</bpt>_doserrno, errno, _sys_errlist, and _sys_nerr<ept id=\"p1\">](../../c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr.md)</ept> for more information on these, and other, error codes.","source":"See [_doserrno, errno, _sys_errlist, and _sys_nerr](../../c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr.md) for more information on these, and other, error codes."},{"content":"The <ph id=\"ph1\">`_fcloseall`</ph> function closes all open streams except <ph id=\"ph2\">`stdin`</ph>, <ph id=\"ph3\">`stdout`</ph>, <ph id=\"ph4\">`stderr`</ph> (and, in MS-DOS, <ph id=\"ph5\">`_stdaux`</ph> and <ph id=\"ph6\">`_stdprn`</ph>).","pos":[2042,2169],"source":"The `_fcloseall` function closes all open streams except `stdin`, `stdout`, `stderr` (and, in MS-DOS, `_stdaux` and `_stdprn`)."},{"content":"It also closes and deletes any temporary files created by <ph id=\"ph1\">`tmpfile`</ph>.","pos":[2170,2238],"source":" It also closes and deletes any temporary files created by `tmpfile`."},{"content":"In both functions, all buffers associated with the stream are flushed prior to closing.","pos":[2239,2326]},{"content":"System-allocated buffers are released when the stream is closed.","pos":[2327,2391]},{"content":"Buffers assigned by the user with <ph id=\"ph1\">`setbuf`</ph> and <ph id=\"ph2\">`setvbuf`</ph> are not automatically released.","pos":[2392,2480],"source":" Buffers assigned by the user with `setbuf` and `setvbuf` are not automatically released."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> When these functions are used to close a stream, the underlying file descriptor and OS file handle (or socket) are closed, as well as the stream.","pos":[2487,2642],"source":"**Note:** When these functions are used to close a stream, the underlying file descriptor and OS file handle (or socket) are closed, as well as the stream."},{"content":"Thus, if the file was originally opened as a file handle or file descriptor and is closed with <ph id=\"ph1\">`fclose`</ph>, do not also call <ph id=\"ph2\">`_close`</ph> to close the file descriptor; do not call the Win32 function <ph id=\"ph3\">`CloseHandle`</ph> to close the file handle.","pos":[2643,2874],"source":" Thus, if the file was originally opened as a file handle or file descriptor and is closed with `fclose`, do not also call `_close` to close the file descriptor; do not call the Win32 function `CloseHandle` to close the file handle."},{"content":"and <ph id=\"ph1\">`_fcloseall`</ph> include code to protect against interference from other threads.","pos":[2890,2971],"source":" and `_fcloseall` include code to protect against interference from other threads."},{"content":"For non-locking version of a <ph id=\"ph1\">`fclose`</ph>, see <ph id=\"ph2\">`_fclose_nolock`</ph>.","pos":[2972,3032],"source":" For non-locking version of a `fclose`, see `_fclose_nolock`."},{"content":"Requirements","pos":[3041,3053]},{"content":"Function","pos":[3060,3068]},{"content":"Required header","pos":[3069,3084]},{"content":"stdio.h&gt;","pos":[3141,3149],"source":"stdio.h>"},{"content":"stdio.h&gt;","pos":[3169,3177],"source":"stdio.h>"},{"pos":[3185,3309],"content":"For additional compatibility information, see <bpt id=\"p1\">[</bpt>Compatibility<ept id=\"p1\">](../../c-runtime-library/compatibility.md)</ept> in the Introduction.","source":"For additional compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md) in the Introduction."},{"content":"Example","pos":[3318,3325]},{"pos":[3329,3408],"content":"See the example for <bpt id=\"p1\">[</bpt>fopen<ept id=\"p1\">](../../c-runtime-library/reference/fopen-wfopen.md)</ept>.","source":"See the example for [fopen](../../c-runtime-library/reference/fopen-wfopen.md)."},{"content":".NET Framework Equivalent","pos":[3417,3442]},{"content":"System::IO::BinaryReader::Close","pos":[3453,3484]},{"content":"System::IO::BinaryWriter::Close","pos":[3572,3603]},{"content":"System::IO::StringReader::Close","pos":[3691,3722]},{"content":"System::IO::StringWriter::Close","pos":[3810,3841]},{"content":"System::IO::Stream::Close","pos":[3929,3954]},{"content":"System::IO::StreamReader::Close","pos":[4036,4067]},{"content":"System::IO::StreamWriter::Close","pos":[4155,4186]},{"content":"System::IO::TextReader::Close","pos":[4274,4303]},{"content":"System::IO::TextWriter::Close","pos":[4389,4418]},{"content":"See Also","pos":[4502,4510]},{"content":"Stream I/O","pos":[4515,4525]},{"content":"_close","pos":[4571,4577]},{"content":"_fdopen, _wfdopen","pos":[4628,4645]},{"content":"fflush","pos":[4705,4711]},{"content":"fopen, _wfopen","pos":[4763,4777]},{"content":"freopen, _wfreopen","pos":[4835,4853]}],"content":"---\ntitle: \"fclose, _fcloseall | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\napiname: \n  - \"fclose\"\n  - \"_fcloseall\"\napilocation: \n  - \"msvcrt.dll\"\n  - \"msvcr80.dll\"\n  - \"msvcr90.dll\"\n  - \"msvcr100.dll\"\n  - \"msvcr100_clr0400.dll\"\n  - \"msvcr110.dll\"\n  - \"msvcr110_clr0400.dll\"\n  - \"msvcr120.dll\"\n  - \"msvcr120_clr0400.dll\"\n  - \"ucrtbase.dll\"\n  - \"api-ms-win-crt-stdio-l1-1-0.dll\"\napitype: \"DLLExport\"\nf1_keywords: \n  - \"fclose\"\n  - \"_fcloseall\"\ndev_langs: \n  - \"C++\"\n  - \"C\"\nhelpviewer_keywords: \n  - \"fclose function\"\n  - \"streams, closing\"\n  - \"_fcloseall function\"\nms.assetid: c3c6ea72-92c6-450a-a33e-3e568d2784a4\ncaps.latest.revision: 17\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# fclose, _fcloseall\nCloses a stream (`fclose`) or closes all open streams (`_fcloseall`).  \n  \n## Syntax  \n  \n```  \nint fclose(   \n   FILE *stream   \n);  \nint _fcloseall( void );  \n```  \n  \n#### Parameters  \n `stream`  \n Pointer to `FILE` structure.  \n  \n## Return Value  \n `fclose` returns 0 if the stream is successfully closed. `_fcloseall` returns the total number of streams closed. Both functions return `EOF` to indicate an error.  \n  \n## Remarks  \n The `fclose` function closes `stream`. If `stream` is `NULL`, the invalid parameter handler is invoked, as described in [Parameter Validation](../../c-runtime-library/parameter-validation.md). If execution is allowed to continue, `fclose` sets `errno` to `EINVAL` and returns `EOF`. It is recommended that the `stream` pointer always be checked prior to calling this function.  \n  \n See [_doserrno, errno, _sys_errlist, and _sys_nerr](../../c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr.md) for more information on these, and other, error codes.  \n  \n The `_fcloseall` function closes all open streams except `stdin`, `stdout`, `stderr` (and, in MS-DOS, `_stdaux` and `_stdprn`). It also closes and deletes any temporary files created by `tmpfile`. In both functions, all buffers associated with the stream are flushed prior to closing. System-allocated buffers are released when the stream is closed. Buffers assigned by the user with `setbuf` and `setvbuf` are not automatically released.  \n  \n **Note:** When these functions are used to close a stream, the underlying file descriptor and OS file handle (or socket) are closed, as well as the stream. Thus, if the file was originally opened as a file handle or file descriptor and is closed with `fclose`, do not also call `_close` to close the file descriptor; do not call the Win32 function `CloseHandle` to close the file handle.  \n  \n `fclose` and `_fcloseall` include code to protect against interference from other threads. For non-locking version of a `fclose`, see `_fclose_nolock`.  \n  \n## Requirements  \n  \n|Function|Required header|  \n|--------------|---------------------|  \n|`fclose`|\\<stdio.h>|  \n|`_fcloseall`|\\<stdio.h>|  \n  \n For additional compatibility information, see [Compatibility](../../c-runtime-library/compatibility.md) in the Introduction.  \n  \n## Example  \n See the example for [fopen](../../c-runtime-library/reference/fopen-wfopen.md).  \n  \n## .NET Framework Equivalent  \n  \n-   [System::IO::BinaryReader::Close](https://msdn.microsoft.com/en-us/library/system.io.binaryreader.close.aspx)  \n  \n-   [System::IO::BinaryWriter::Close](https://msdn.microsoft.com/en-us/library/system.io.binarywriter.close.aspx)  \n  \n-   [System::IO::StringReader::Close](https://msdn.microsoft.com/en-us/library/system.io.stringreader.close.aspx)  \n  \n-   [System::IO::StringWriter::Close](https://msdn.microsoft.com/en-us/library/system.io.stringwriter.close.aspx)  \n  \n-   [System::IO::Stream::Close](https://msdn.microsoft.com/en-us/library/system.io.stream.close.aspx)  \n  \n-   [System::IO::StreamReader::Close](https://msdn.microsoft.com/en-us/library/system.io.streamreader.close.aspx)  \n  \n-   [System::IO::StreamWriter::Close](https://msdn.microsoft.com/en-us/library/system.io.streamwriter.close.aspx)  \n  \n-   [System::IO::TextReader::Close](https://msdn.microsoft.com/en-us/library/system.io.textreader.close.aspx)  \n  \n-   [System::IO::TextWriter::Close](https://msdn.microsoft.com/en-us/library/system.io.textwriter.close.aspx)  \n  \n## See Also  \n [Stream I/O](../../c-runtime-library/stream-i-o.md)   \n [_close](../../c-runtime-library/reference/close.md)   \n [_fdopen, _wfdopen](../../c-runtime-library/reference/fdopen-wfdopen.md)   \n [fflush](../../c-runtime-library/reference/fflush.md)   \n [fopen, _wfopen](../../c-runtime-library/reference/fopen-wfopen.md)   \n [freopen, _wfreopen](../../c-runtime-library/reference/freopen-wfreopen.md)"}