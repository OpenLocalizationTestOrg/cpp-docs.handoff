{"nodes":[{"pos":[12,84],"content":"MFC: Using Database Classes Without Documents and Views | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC: Using Database Classes Without Documents and Views | Microsoft Docs","pos":[0,72]}]},{"content":"MFC: Using Database Classes Without Documents and Views","pos":[1431,1486]},{"content":"Sometimes you might not want to use the framework's document/view architecture in your database applications.","pos":[1487,1596]},{"content":"This topic explains:","pos":[1597,1617]},{"pos":[1627,1739],"content":"<bpt id=\"p1\">[</bpt>When you do not need to use documents<ept id=\"p1\">](#_core_when_you_don.92.t_need_documents)</ept> such as document serialization.","source":"[When you do not need to use documents](#_core_when_you_don.92.t_need_documents) such as document serialization."},{"pos":[1749,1979],"content":"<bpt id=\"p1\">[</bpt>Application wizard options<ept id=\"p1\">](#_core_appwizard_options_for_documents_and_views)</ept> to support applications without serialization and without document-related <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu commands such as <bpt id=\"p3\">**</bpt>New<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Open<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Save<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>Save As<ept id=\"p6\">**</ept>.","source":"[Application wizard options](#_core_appwizard_options_for_documents_and_views) to support applications without serialization and without document-related **File** menu commands such as **New**, **Open**, **Save**, and **Save As**."},{"pos":[1989,2096],"content":"<bpt id=\"p1\">[</bpt>How to work with an application that uses a minimal document<ept id=\"p1\">](#_core_applications_with_minimal_documents)</ept>.","source":"[How to work with an application that uses a minimal document](#_core_applications_with_minimal_documents)."},{"pos":[2106,2203],"content":"<bpt id=\"p1\">[</bpt>How to structure an application with no document or view<ept id=\"p1\">](#_core_applications_with_no_document)</ept>.","source":"[How to structure an application with no document or view](#_core_applications_with_no_document)."},{"pos":[2267,2297],"content":"When You Do Not Need Documents"},{"content":"Some applications have a distinct concept of a document.","pos":[2301,2357]},{"content":"These applications typically load all or most of a file from storage into memory with a <bpt id=\"p1\">**</bpt>File Open<ept id=\"p1\">**</ept> command.","pos":[2358,2468],"source":" These applications typically load all or most of a file from storage into memory with a **File Open** command."},{"content":"They write the updated file back to storage all at once with a <bpt id=\"p1\">**</bpt>File Save<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Save As<ept id=\"p2\">**</ept> command.","pos":[2469,2569],"source":" They write the updated file back to storage all at once with a **File Save** or **Save As** command."},{"content":"What the user sees is a data file.","pos":[2570,2604]},{"content":"Some categories of applications, however, do not require a document.","pos":[2611,2679]},{"content":"Database applications operate in terms of transactions.","pos":[2680,2735]},{"content":"The application selects records from a database and presents them to the user, often one at a time.","pos":[2736,2835]},{"content":"What the user sees is usually a single current record, which might be the only one in memory.","pos":[2836,2929]},{"content":"If your application does not require a document for storing data, you can dispense with some or all of the framework's document/view architecture.","pos":[2936,3082]},{"content":"How much you dispense with depends on the approach you prefer.","pos":[3083,3145]},{"content":"You might:","pos":[3146,3156]},{"content":"Use a minimal document as a place to store a connection to your data source but dispense with normal document features such as serialization.","pos":[3166,3307]},{"content":"This is useful when you want several views of the data and want to synchronize all the views, updating them all at once and so on.","pos":[3308,3438]},{"content":"Use a frame window, into which you draw directly, rather than using a view.","pos":[3448,3523]},{"content":"In this case, you omit the document and store any data or data connections in the frame-window object.","pos":[3524,3626]},{"pos":[3699,3749],"content":"Application Wizard Options for Documents and Views"},{"content":"The MFC Application Wizard has several options in <bpt id=\"p1\">**</bpt>Select database support<ept id=\"p1\">**</ept>, which are listed in the following table.","pos":[3753,3872],"source":"The MFC Application Wizard has several options in **Select database support**, which are listed in the following table."},{"content":"If you use the MFC Application Wizard to create an application, all these options produce applications with documents and views.","pos":[3873,4001]},{"content":"Some options provide documents and views that omit unneeded document functionality.","pos":[4002,4085]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Database Support, MFC Application Wizard<ept id=\"p1\">](../mfc/reference/database-support-mfc-application-wizard.md)</ept>.","pos":[4086,4216],"source":" For more information, see [Database Support, MFC Application Wizard](../mfc/reference/database-support-mfc-application-wizard.md)."},{"content":"Option","pos":[4223,4229]},{"content":"View","pos":[4230,4234]},{"content":"Document","pos":[4235,4243]},{"content":"None","pos":[4293,4297]},{"pos":[4300,4321],"content":"Derived from <ph id=\"ph1\">`CView`</ph>.","source":"Derived from `CView`."},{"content":"Provides no database support.","pos":[4322,4351]},{"content":"This is the default option.","pos":[4352,4379]},{"content":"If you select the <bpt id=\"p1\">**</bpt>Document/view architecture support<ept id=\"p1\">**</ept> option on the <bpt id=\"p2\">[</bpt>Application Type, MFC Application Wizard<ept id=\"p2\">](../mfc/reference/application-type-mfc-application-wizard.md)</ept> page, you get full document support including serialization and <ph id=\"ph1\">`New`</ph>, <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Save<ept id=\"p4\">**</ept>, and <bpt id=\"p5\">**</bpt>Save As<ept id=\"p5\">**</ept> commands on the <bpt id=\"p6\">**</bpt>File<ept id=\"p6\">**</ept> menu.","pos":[4392,4704],"source":" If you select the **Document/view architecture support** option on the [Application Type, MFC Application Wizard](../mfc/reference/application-type-mfc-application-wizard.md) page, you get full document support including serialization and `New`, **Open**, **Save**, and **Save As** commands on the **File** menu."},{"content":"See <bpt id=\"p1\">[</bpt>Applications with No Document<ept id=\"p1\">](#_core_applications_with_no_document)</ept>.","pos":[4705,4779],"source":" See [Applications with No Document](#_core_applications_with_no_document)."},{"content":"Header files only","pos":[4786,4803]},{"pos":[4806,4827],"content":"Derived from <ph id=\"ph1\">`CView`</ph>.","source":"Derived from `CView`."},{"content":"Provides the basic level of database support for your application.","pos":[4828,4894]},{"content":"Includes Afxdb.h.","pos":[4907,4924]},{"content":"Adds link libraries, but does not create any database-specific classes.","pos":[4925,4996]},{"content":"You can create recordsets later and use them to examine and update records.","pos":[4997,5072]},{"content":"Database view without file support","pos":[5079,5113]},{"pos":[5116,5128],"content":"Derived from"},{"content":"Provides document support but no serialization support.","pos":[5143,5198]},{"content":"Document can store recordset and coordinate multiple views; does not support serialization or the <ph id=\"ph1\">`New`</ph>, <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Save As<ept id=\"p3\">**</ept> commands.","pos":[5199,5349],"source":" Document can store recordset and coordinate multiple views; does not support serialization or the `New`, **Open**, **Save**, and **Save As** commands."},{"content":"See <bpt id=\"p1\">[</bpt>Applications with Minimal Documents<ept id=\"p1\">](#_core_applications_with_minimal_documents)</ept>.","pos":[5350,5436],"source":" See [Applications with Minimal Documents](#_core_applications_with_minimal_documents)."},{"content":"If you include a database view, you must specify the source of the data.","pos":[5437,5509]},{"content":"Includes database header files, link libraries, a record view, and a recordset.","pos":[5522,5601]},{"content":"(Available only for applications with the <bpt id=\"p1\">**</bpt>Document/view architecture support<ept id=\"p1\">**</ept> option selected on the <bpt id=\"p2\">[</bpt>Application Type, MFC Application Wizard<ept id=\"p2\">](../mfc/reference/application-type-mfc-application-wizard.md)</ept> page.)","pos":[5602,5816],"source":" (Available only for applications with the **Document/view architecture support** option selected on the [Application Type, MFC Application Wizard](../mfc/reference/application-type-mfc-application-wizard.md) page.)"},{"content":"Database view with file support","pos":[5823,5854]},{"pos":[5857,5869],"content":"Derived from"},{"content":"Provides full document support, including serialization and document-related <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu commands.","pos":[5884,5984],"source":"Provides full document support, including serialization and document-related **File** menu commands."},{"content":"Database applications typically operate on a per-record basis rather than on a per-file basis and so do not need serialization.","pos":[5985,6112]},{"content":"However, you might have a special use for serialization.","pos":[6113,6169]},{"content":"See <bpt id=\"p1\">[</bpt>Applications with Minimal Documents<ept id=\"p1\">](#_core_applications_with_minimal_documents)</ept>.","pos":[6170,6256],"source":" See [Applications with Minimal Documents](#_core_applications_with_minimal_documents)."},{"content":"If you include a database view, you must specify the source of the data.","pos":[6257,6329]},{"content":"Includes database header files, link libraries, a record view, and a recordset.","pos":[6342,6421]},{"content":"(Available only for applications with the <bpt id=\"p1\">**</bpt>Document/view architecture support<ept id=\"p1\">**</ept> option selected on the <bpt id=\"p2\">[</bpt>Application Type, MFC Application Wizard<ept id=\"p2\">](../mfc/reference/application-type-mfc-application-wizard.md)</ept> page.)","pos":[6422,6636],"source":" (Available only for applications with the **Document/view architecture support** option selected on the [Application Type, MFC Application Wizard](../mfc/reference/application-type-mfc-application-wizard.md) page.)"},{"pos":[6644,6859],"content":"For a discussion of alternatives to serialization and alternative uses for serialization, see <bpt id=\"p1\">[</bpt>Serialization: Serialization vs. Database Input/Output<ept id=\"p1\">](../mfc/serialization-serialization-vs-database-input-output.md)</ept>.","source":"For a discussion of alternatives to serialization and alternative uses for serialization, see [Serialization: Serialization vs. Database Input/Output](../mfc/serialization-serialization-vs-database-input-output.md)."},{"pos":[6926,6961],"content":"Applications with Minimal Documents"},{"content":"The MFC Application Wizard has two options that support form-based data access applications.","pos":[6965,7057]},{"content":"Each option creates a <ph id=\"ph1\">`CRecordView`</ph>-derived view class and a document.","pos":[7058,7128],"source":" Each option creates a `CRecordView`-derived view class and a document."},{"content":"They differ in what they leave out of the document.","pos":[7129,7180]},{"pos":[7244,7273],"content":"Document Without File Support"},{"content":"Select the application wizard database option <bpt id=\"p1\">**</bpt>Database view without file support<ept id=\"p1\">**</ept> if you do not need document serialization.","pos":[7277,7404],"source":"Select the application wizard database option **Database view without file support** if you do not need document serialization."},{"content":"The document serves the following useful purposes:","pos":[7405,7455]},{"pos":[7465,7521],"content":"It is a convenient place to store a <ph id=\"ph1\">`CRecordset`</ph> object.","source":"It is a convenient place to store a `CRecordset` object."},{"content":"This usage parallels ordinary document concepts: the document stores the data  (or, in this case, a set of records) and the view is a view of the document.","pos":[7532,7687]},{"content":"If your application presents multiple views (such as multiple record views), a document supports coordinating the views.","pos":[7697,7817]},{"pos":[7828,7992],"content":"If multiple views show the same data, you can use the <ph id=\"ph1\">`CDocument::UpdateAllViews`</ph> member function to coordinate updates to all views when any view changes the data.","source":"If multiple views show the same data, you can use the `CDocument::UpdateAllViews` member function to coordinate updates to all views when any view changes the data."},{"content":"You usually use this option for simple form-based applications.","pos":[7999,8062]},{"content":"The application wizard supports a convenient structure for such applications automatically.","pos":[8063,8154]},{"pos":[8215,8241],"content":"Document with File Support"},{"content":"Select the application wizard database option <bpt id=\"p1\">**</bpt>Database view with file support<ept id=\"p1\">**</ept> when you have an alternative use for the document-related <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu commands and document serialization.","pos":[8245,8435],"source":"Select the application wizard database option **Database view with file support** when you have an alternative use for the document-related **File** menu commands and document serialization."},{"content":"For the data-access portion of your program, you can use the document in the same way as described in <bpt id=\"p1\">[</bpt>Document Without File Support<ept id=\"p1\">](#_core_a_document_without_file_support)</ept>.","pos":[8436,8610],"source":" For the data-access portion of your program, you can use the document in the same way as described in [Document Without File Support](#_core_a_document_without_file_support)."},{"content":"You can use the document's serialization capability, for example, to read and write a serialized user profile document that stores the user's preferences or other useful information.","pos":[8611,8793]},{"content":"For more ideas, see <bpt id=\"p1\">[</bpt>Serialization: Serialization vs. Database Input/Output<ept id=\"p1\">](../mfc/serialization-serialization-vs-database-input-output.md)</ept>.","pos":[8794,8935],"source":" For more ideas, see [Serialization: Serialization vs. Database Input/Output](../mfc/serialization-serialization-vs-database-input-output.md)."},{"content":"The application wizard supports this option, but you must write the code that serializes the document.","pos":[8942,9044]},{"content":"Store the serialized information in document data members.","pos":[9045,9103]},{"pos":[9164,9193],"content":"Applications with No Document"},{"content":"You might sometimes want to write an application that does not use documents or views.","pos":[9197,9283]},{"content":"Without documents, you store your data (such as a <ph id=\"ph1\">`CRecordset`</ph> object) in your frame-window class or your application class.","pos":[9284,9408],"source":" Without documents, you store your data (such as a `CRecordset` object) in your frame-window class or your application class."},{"content":"Any additional requirements depend on whether the application presents a user interface.","pos":[9409,9497]},{"pos":[9568,9606],"content":"Database Support with a User Interface"},{"content":"If you have a user interface (other than, for example, a console command-line interface), your application draws directly into the frame window's client area rather than into a view.","pos":[9610,9792]},{"content":"Such an application does not use <ph id=\"ph1\">`CRecordView`</ph>, <ph id=\"ph2\">`CFormView`</ph>, or <ph id=\"ph3\">`CDialog`</ph> for its main user interface, but it normally use <ph id=\"ph4\">`CDialog`</ph> for ordinary dialogs.","pos":[9793,9947],"source":" Such an application does not use `CRecordView`, `CFormView`, or `CDialog` for its main user interface, but it normally use `CDialog` for ordinary dialogs."},{"pos":[10018,10056],"content":"Writing Applications Without Documents"},{"content":"Because the application wizard does not support creating applications without documents, you must write your own <ph id=\"ph1\">`CWinApp`</ph>-derived class and, if needed, also create a <ph id=\"ph2\">`CFrameWnd`</ph> or <ph id=\"ph3\">`CMDIFrameWnd`</ph> class.","pos":[10060,10263],"source":"Because the application wizard does not support creating applications without documents, you must write your own `CWinApp`-derived class and, if needed, also create a `CFrameWnd` or `CMDIFrameWnd` class."},{"content":"Override <ph id=\"ph1\">`CWinApp::InitInstance`</ph> and declare an application object as:","pos":[10264,10334],"source":" Override `CWinApp::InitInstance` and declare an application object as:"},{"content":"The framework still supplies the message-map mechanism and many other features.","pos":[10379,10458]},{"pos":[10540,10589],"content":"Database Support Separate from the User Interface"},{"content":"Some applications need no user interface or only a minimal one.","pos":[10593,10656]},{"content":"For example, suppose you are writing:","pos":[10657,10694]},{"content":"An intermediate data-access object that other applications (clients) call for special processing of data between the application and the data source.","pos":[10704,10853]},{"content":"An application that processes data without user intervention, such as an application that moves data from one database format to another or one that does calculations and performs batch updates.","pos":[10863,11057]},{"content":"Because no document owns the <ph id=\"ph1\">`CRecordset`</ph> or <ph id=\"ph2\">`CDaoRecordset`</ph> object, you probably want to store it as an embedded data member in your <ph id=\"ph3\">`CWinApp`</ph>-derived application class.","pos":[11064,11234],"source":"Because no document owns the `CRecordset` or `CDaoRecordset` object, you probably want to store it as an embedded data member in your `CWinApp`-derived application class."},{"content":"Alternatives include:","pos":[11235,11256]},{"content":"Not keeping a permanent <ph id=\"ph1\">`CRecordset`</ph> or <ph id=\"ph2\">`CDaoRecordset`</ph> object at all.","pos":[11266,11336],"source":"Not keeping a permanent `CRecordset` or `CDaoRecordset` object at all."},{"content":"You can pass <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept> to your recordset class constructors.","pos":[11337,11396],"source":" You can pass **NULL** to your recordset class constructors."},{"content":"In that case, the framework creates a temporary <ph id=\"ph1\">`CDatabase`</ph> or <ph id=\"ph2\">`CDaoDatabase`</ph> object using the information in the recordset's <ph id=\"ph3\">`GetDefaultConnect`</ph> member function.","pos":[11397,11559],"source":" In that case, the framework creates a temporary `CDatabase` or `CDaoDatabase` object using the information in the recordset's `GetDefaultConnect` member function."},{"content":"This is the most likely alternative approach.","pos":[11560,11605]},{"content":"Making the <ph id=\"ph1\">`CRecordset`</ph> or <ph id=\"ph2\">`CDaoRecordset`</ph> object a global variable.","pos":[11615,11683],"source":"Making the `CRecordset` or `CDaoRecordset` object a global variable."},{"content":"This variable should be a pointer to a recordset object that you create dynamically in your <ph id=\"ph1\">`CWinApp::InitInstance`</ph> override.","pos":[11684,11809],"source":" This variable should be a pointer to a recordset object that you create dynamically in your `CWinApp::InitInstance` override."},{"content":"This avoids attempting to construct the object before the framework is initialized.","pos":[11810,11893]},{"content":"Using recordset objects as you would within the context of a document or a view.","pos":[11903,11983]},{"content":"Create recordsets in the member functions of your application or frame-window objects.","pos":[11984,12070]},{"content":"See Also","pos":[12079,12087]},{"content":"MFC Database Classes (ODBC and DAO)","pos":[12092,12127]}],"content":"---\ntitle: \"MFC: Using Database Classes Without Documents and Views | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"ODBC applications [C++], without views\"\n  - \"documents [C++], applications without\"\n  - \"ODBC applications [C++]\"\n  - \"DAO [C++], writing applications\"\n  - \"document/view architecture [C++], in databases\"\n  - \"files [C++], MFC\"\n  - \"DAO [C++], file support in database applications\"\n  - \"database classes [C++], MFC\"\n  - \"CRecordView class, using in database applications\"\n  - \"database applications [C++], without views\"\n  - \"CDaoRecordView class, using in database applications\"\n  - \"database applications [C++], application wizard options\"\n  - \"application wizards [C++], creating database applications\"\n  - \"ODBC [C++], file support in database applications\"\n  - \"ODBC applications [C++], without documents\"\n  - \"database applications [C++], without documents\"\n  - \"user interface [C++], drawing information\"\nms.assetid: 15bf52d4-91cf-4b1d-8b37-87c3ae70123a\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# MFC: Using Database Classes Without Documents and Views\nSometimes you might not want to use the framework's document/view architecture in your database applications. This topic explains:  \n  \n-   [When you do not need to use documents](#_core_when_you_don.92.t_need_documents) such as document serialization.  \n  \n-   [Application wizard options](#_core_appwizard_options_for_documents_and_views) to support applications without serialization and without document-related **File** menu commands such as **New**, **Open**, **Save**, and **Save As**.  \n  \n-   [How to work with an application that uses a minimal document](#_core_applications_with_minimal_documents).  \n  \n-   [How to structure an application with no document or view](#_core_applications_with_no_document).  \n  \n##  <a name=\"_core_when_you_don.92.t_need_documents\"></a> When You Do Not Need Documents  \n Some applications have a distinct concept of a document. These applications typically load all or most of a file from storage into memory with a **File Open** command. They write the updated file back to storage all at once with a **File Save** or **Save As** command. What the user sees is a data file.  \n  \n Some categories of applications, however, do not require a document. Database applications operate in terms of transactions. The application selects records from a database and presents them to the user, often one at a time. What the user sees is usually a single current record, which might be the only one in memory.  \n  \n If your application does not require a document for storing data, you can dispense with some or all of the framework's document/view architecture. How much you dispense with depends on the approach you prefer. You might:  \n  \n-   Use a minimal document as a place to store a connection to your data source but dispense with normal document features such as serialization. This is useful when you want several views of the data and want to synchronize all the views, updating them all at once and so on.  \n  \n-   Use a frame window, into which you draw directly, rather than using a view. In this case, you omit the document and store any data or data connections in the frame-window object.  \n  \n##  <a name=\"_core_appwizard_options_for_documents_and_views\"></a> Application Wizard Options for Documents and Views  \n The MFC Application Wizard has several options in **Select database support**, which are listed in the following table. If you use the MFC Application Wizard to create an application, all these options produce applications with documents and views. Some options provide documents and views that omit unneeded document functionality. For more information, see [Database Support, MFC Application Wizard](../mfc/reference/database-support-mfc-application-wizard.md).  \n  \n|Option|View|Document|  \n|------------|----------|--------------|  \n|**None**|Derived from `CView`.|Provides no database support. This is the default option.<br /><br /> If you select the **Document/view architecture support** option on the [Application Type, MFC Application Wizard](../mfc/reference/application-type-mfc-application-wizard.md) page, you get full document support including serialization and `New`, **Open**, **Save**, and **Save As** commands on the **File** menu. See [Applications with No Document](#_core_applications_with_no_document).|  \n|**Header files only**|Derived from `CView`.|Provides the basic level of database support for your application.<br /><br /> Includes Afxdb.h. Adds link libraries, but does not create any database-specific classes. You can create recordsets later and use them to examine and update records.|  \n|**Database view without file support**|Derived from `CRecordView`|Provides document support but no serialization support. Document can store recordset and coordinate multiple views; does not support serialization or the `New`, **Open**, **Save**, and **Save As** commands. See [Applications with Minimal Documents](#_core_applications_with_minimal_documents). If you include a database view, you must specify the source of the data.<br /><br /> Includes database header files, link libraries, a record view, and a recordset. (Available only for applications with the **Document/view architecture support** option selected on the [Application Type, MFC Application Wizard](../mfc/reference/application-type-mfc-application-wizard.md) page.)|  \n|**Database view with file support**|Derived from `CRecordView`|Provides full document support, including serialization and document-related **File** menu commands. Database applications typically operate on a per-record basis rather than on a per-file basis and so do not need serialization. However, you might have a special use for serialization. See [Applications with Minimal Documents](#_core_applications_with_minimal_documents). If you include a database view, you must specify the source of the data.<br /><br /> Includes database header files, link libraries, a record view, and a recordset. (Available only for applications with the **Document/view architecture support** option selected on the [Application Type, MFC Application Wizard](../mfc/reference/application-type-mfc-application-wizard.md) page.)|  \n  \n For a discussion of alternatives to serialization and alternative uses for serialization, see [Serialization: Serialization vs. Database Input/Output](../mfc/serialization-serialization-vs-database-input-output.md).  \n  \n##  <a name=\"_core_applications_with_minimal_documents\"></a> Applications with Minimal Documents  \n The MFC Application Wizard has two options that support form-based data access applications. Each option creates a `CRecordView`-derived view class and a document. They differ in what they leave out of the document.  \n  \n###  <a name=\"_core_a_document_without_file_support\"></a> Document Without File Support  \n Select the application wizard database option **Database view without file support** if you do not need document serialization. The document serves the following useful purposes:  \n  \n-   It is a convenient place to store a `CRecordset` object.  \n  \n     This usage parallels ordinary document concepts: the document stores the data  (or, in this case, a set of records) and the view is a view of the document.  \n  \n-   If your application presents multiple views (such as multiple record views), a document supports coordinating the views.  \n  \n     If multiple views show the same data, you can use the `CDocument::UpdateAllViews` member function to coordinate updates to all views when any view changes the data.  \n  \n You usually use this option for simple form-based applications. The application wizard supports a convenient structure for such applications automatically.  \n  \n###  <a name=\"_core_a_document_with_file_support\"></a> Document with File Support  \n Select the application wizard database option **Database view with file support** when you have an alternative use for the document-related **File** menu commands and document serialization. For the data-access portion of your program, you can use the document in the same way as described in [Document Without File Support](#_core_a_document_without_file_support). You can use the document's serialization capability, for example, to read and write a serialized user profile document that stores the user's preferences or other useful information. For more ideas, see [Serialization: Serialization vs. Database Input/Output](../mfc/serialization-serialization-vs-database-input-output.md).  \n  \n The application wizard supports this option, but you must write the code that serializes the document. Store the serialized information in document data members.  \n  \n##  <a name=\"_core_applications_with_no_document\"></a> Applications with No Document  \n You might sometimes want to write an application that does not use documents or views. Without documents, you store your data (such as a `CRecordset` object) in your frame-window class or your application class. Any additional requirements depend on whether the application presents a user interface.  \n  \n###  <a name=\"_core_database_support_with_a_user_interface\"></a> Database Support with a User Interface  \n If you have a user interface (other than, for example, a console command-line interface), your application draws directly into the frame window's client area rather than into a view. Such an application does not use `CRecordView`, `CFormView`, or `CDialog` for its main user interface, but it normally use `CDialog` for ordinary dialogs.  \n  \n###  <a name=\"_core_writing_applications_without_documents\"></a> Writing Applications Without Documents  \n Because the application wizard does not support creating applications without documents, you must write your own `CWinApp`-derived class and, if needed, also create a `CFrameWnd` or `CMDIFrameWnd` class. Override `CWinApp::InitInstance` and declare an application object as:  \n  \n```  \nCYourNameApp theApp;  \n```  \n  \n The framework still supplies the message-map mechanism and many other features.  \n  \n###  <a name=\"_core_database_support_separate_from_the_user_interface\"></a> Database Support Separate from the User Interface  \n Some applications need no user interface or only a minimal one. For example, suppose you are writing:  \n  \n-   An intermediate data-access object that other applications (clients) call for special processing of data between the application and the data source.  \n  \n-   An application that processes data without user intervention, such as an application that moves data from one database format to another or one that does calculations and performs batch updates.  \n  \n Because no document owns the `CRecordset` or `CDaoRecordset` object, you probably want to store it as an embedded data member in your `CWinApp`-derived application class. Alternatives include:  \n  \n-   Not keeping a permanent `CRecordset` or `CDaoRecordset` object at all. You can pass **NULL** to your recordset class constructors. In that case, the framework creates a temporary `CDatabase` or `CDaoDatabase` object using the information in the recordset's `GetDefaultConnect` member function. This is the most likely alternative approach.  \n  \n-   Making the `CRecordset` or `CDaoRecordset` object a global variable. This variable should be a pointer to a recordset object that you create dynamically in your `CWinApp::InitInstance` override. This avoids attempting to construct the object before the framework is initialized.  \n  \n-   Using recordset objects as you would within the context of a document or a view. Create recordsets in the member functions of your application or frame-window objects.  \n  \n## See Also  \n [MFC Database Classes (ODBC and DAO)](../data/mfc-database-classes-odbc-and-dao.md)"}