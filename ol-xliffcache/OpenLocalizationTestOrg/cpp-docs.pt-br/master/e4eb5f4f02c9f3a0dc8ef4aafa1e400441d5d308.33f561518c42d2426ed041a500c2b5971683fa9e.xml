{"nodes":[{"pos":[12,64],"content":"How to: Manage a Scheduler Instance | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Manage a Scheduler Instance | Microsoft Docs","pos":[0,52]}]},{"content":"How to: Manage a Scheduler Instance","pos":[709,744]},{"content":"Scheduler instances let you associate specific scheduling policies with various kinds of workloads.","pos":[745,844]},{"content":"This topic contains two basic examples that show how to create and manage a scheduler instance.","pos":[845,940]},{"content":"The examples create schedulers that use the default scheduler policies.","pos":[947,1018]},{"content":"For an example that creates a scheduler that uses a custom policy, see <bpt id=\"p1\">[</bpt>How to: Specify Specific Scheduler Policies<ept id=\"p1\">](../../parallel/concrt/how-to-specify-specific-scheduler-policies.md)</ept>.","pos":[1019,1205],"source":" For an example that creates a scheduler that uses a custom policy, see [How to: Specify Specific Scheduler Policies](../../parallel/concrt/how-to-specify-specific-scheduler-policies.md)."},{"content":"To manage a scheduler instance in your application","pos":[1215,1265]},{"pos":[1275,1437],"content":"Create a <bpt id=\"p1\">[</bpt>concurrency::SchedulerPolicy<ept id=\"p1\">](../../parallel/concrt/reference/schedulerpolicy-class.md)</ept> object that contains the policy values for the scheduler to use.","source":"Create a [concurrency::SchedulerPolicy](../../parallel/concrt/reference/schedulerpolicy-class.md) object that contains the policy values for the scheduler to use."},{"pos":[1448,1663],"content":"Call the <bpt id=\"p1\">[</bpt>concurrency::CurrentScheduler::Create<ept id=\"p1\">](reference/currentscheduler-class.md#create)</ept> method or the <bpt id=\"p2\">[</bpt>concurrency::Scheduler::Create<ept id=\"p2\">](reference/scheduler-class.md#create)</ept> method to create a scheduler instance.","source":"Call the [concurrency::CurrentScheduler::Create](reference/currentscheduler-class.md#create) method or the [concurrency::Scheduler::Create](reference/scheduler-class.md#create) method to create a scheduler instance."},{"pos":[1674,1869],"content":"If you use the <ph id=\"ph1\">`Scheduler::Create`</ph> method, call the <bpt id=\"p1\">[</bpt>concurrency::Scheduler::Attach<ept id=\"p1\">](reference/scheduler-class.md#attach)</ept> method when you need to associate the scheduler with the current context.","source":"If you use the `Scheduler::Create` method, call the [concurrency::Scheduler::Attach](reference/scheduler-class.md#attach) method when you need to associate the scheduler with the current context."},{"pos":[1879,2033],"content":"Call the <bpt id=\"p1\">[</bpt>CreateEvent<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms682396)</ept> function to create a handle to a non-signaled, auto-reset event object.","source":"Call the [CreateEvent](http://msdn.microsoft.com/library/windows/desktop/ms682396) function to create a handle to a non-signaled, auto-reset event object."},{"content":"Pass the handle to the event object that you just created to the <bpt id=\"p1\">[</bpt>concurrency::CurrentScheduler::RegisterShutdownEvent<ept id=\"p1\">](reference/currentscheduler-class.md#registershutdownevent)</ept> method or the <bpt id=\"p2\">[</bpt>concurrency::Scheduler::RegisterShutdownEvent<ept id=\"p2\">](reference/scheduler-class.md#registershutdownevent)</ept> method.","pos":[2043,2343],"source":"Pass the handle to the event object that you just created to the [concurrency::CurrentScheduler::RegisterShutdownEvent](reference/currentscheduler-class.md#registershutdownevent) method or the [concurrency::Scheduler::RegisterShutdownEvent](reference/scheduler-class.md#registershutdownevent) method."},{"content":"This registers the event to be set when the scheduler is destroyed.","pos":[2344,2411]},{"content":"Perform the tasks that you want the current scheduler to schedule.","pos":[2421,2487]},{"pos":[2497,2683],"content":"Call the <bpt id=\"p1\">[</bpt>concurrency::CurrentScheduler::Detach<ept id=\"p1\">](reference/currentscheduler-class.md#detach)</ept> method to detach the current scheduler and restore the previous scheduler as the current one.","source":"Call the [concurrency::CurrentScheduler::Detach](reference/currentscheduler-class.md#detach) method to detach the current scheduler and restore the previous scheduler as the current one."},{"pos":[2694,2884],"content":"If you use the <ph id=\"ph1\">`Scheduler::Create`</ph> method, call the <bpt id=\"p1\">[</bpt>concurrency::Scheduler::Release<ept id=\"p1\">](reference/scheduler-class.md#release)</ept> method to decrement the reference count of the <ph id=\"ph2\">`Scheduler`</ph> object.","source":"If you use the `Scheduler::Create` method, call the [concurrency::Scheduler::Release](reference/scheduler-class.md#release) method to decrement the reference count of the `Scheduler` object."},{"pos":[2894,3060],"content":"Pass the handle to the event to the <bpt id=\"p1\">[</bpt>WaitForSingleObject<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms687032)</ept> function to wait for the scheduler to shut down.","source":"Pass the handle to the event to the [WaitForSingleObject](http://msdn.microsoft.com/library/windows/desktop/ms687032) function to wait for the scheduler to shut down."},{"pos":[3070,3202],"content":"Call the <bpt id=\"p1\">[</bpt>CloseHandle<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms724211)</ept> function to close the handle to the event object.","source":"Call the [CloseHandle](http://msdn.microsoft.com/library/windows/desktop/ms724211) function to close the handle to the event object."},{"content":"Example","pos":[3211,3218]},{"content":"The following code shows two ways to manage a scheduler instance.","pos":[3222,3287]},{"content":"Each example first uses the default scheduler to perform a task that prints out the unique identifier of the current scheduler.","pos":[3288,3415]},{"content":"Each example then uses a scheduler instance to perform the same task again.","pos":[3416,3491]},{"content":"Finally, each example restores the default scheduler as the current one and performs the task one more time.","pos":[3492,3600]},{"content":"The first example uses the <bpt id=\"p1\">[</bpt>concurrency::CurrentScheduler<ept id=\"p1\">](../../parallel/concrt/reference/currentscheduler-class.md)</ept> class to create a scheduler instance and associate it with the current context.","pos":[3607,3804],"source":"The first example uses the [concurrency::CurrentScheduler](../../parallel/concrt/reference/currentscheduler-class.md) class to create a scheduler instance and associate it with the current context."},{"content":"The second example uses the <bpt id=\"p1\">[</bpt>concurrency::Scheduler<ept id=\"p1\">](../../parallel/concrt/reference/scheduler-class.md)</ept> class to perform the same task.","pos":[3805,3941],"source":" The second example uses the [concurrency::Scheduler](../../parallel/concrt/reference/scheduler-class.md) class to perform the same task."},{"content":"Typically, the <ph id=\"ph1\">`CurrentScheduler`</ph> class is used to work with the current scheduler.","pos":[3942,4025],"source":" Typically, the `CurrentScheduler` class is used to work with the current scheduler."},{"content":"The second example, which uses the <ph id=\"ph1\">`Scheduler`</ph> class, is useful when you want to control when the scheduler is associated with the current context or when you want to associate specific schedulers with specific tasks.","pos":[4026,4243],"source":" The second example, which uses the `Scheduler` class, is useful when you want to control when the scheduler is associated with the current context or when you want to associate specific schedulers with specific tasks."},{"pos":[4261,4288],"content":"concrt-scheduler-instance#1"},{"content":"This example produces the following output.","pos":[4377,4420]},{"content":"Compiling the Code","pos":[4810,4828]},{"pos":[4832,5032],"content":"Copy the example code and paste it in a Visual Studio project, or paste it in a file that is named <ph id=\"ph1\">`scheduler-instance.cpp`</ph> and then run the following command in a Visual Studio Command Prompt window.","source":"Copy the example code and paste it in a Visual Studio project, or paste it in a file that is named `scheduler-instance.cpp` and then run the following command in a Visual Studio Command Prompt window."},{"content":"cl.exe /EHsc scheduler-instance.cpp","pos":[5041,5076]},{"content":"See Also","pos":[5087,5095]},{"content":"Scheduler Instances","pos":[5100,5119]},{"content":"How to: Specify Specific Scheduler Policies","pos":[5172,5215]}],"content":"---\ntitle: \"How to: Manage a Scheduler Instance | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"managing a scheduler instance [Concurrency Runtime]\"\n  - \"scheduler instances, managing [Concurrency Runtime]\"\nms.assetid: 2cc804f0-5ff3-498b-97f1-a9f67a005448\ncaps.latest.revision: 15\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"ru-ru\"\n  - \"zh-cn\"\n  - \"zh-tw\"\ntranslation.priority.mt: \n  - \"cs-cz\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"tr-tr\"\n---\n# How to: Manage a Scheduler Instance\nScheduler instances let you associate specific scheduling policies with various kinds of workloads. This topic contains two basic examples that show how to create and manage a scheduler instance.  \n  \n The examples create schedulers that use the default scheduler policies. For an example that creates a scheduler that uses a custom policy, see [How to: Specify Specific Scheduler Policies](../../parallel/concrt/how-to-specify-specific-scheduler-policies.md).  \n  \n### To manage a scheduler instance in your application  \n  \n1.  Create a [concurrency::SchedulerPolicy](../../parallel/concrt/reference/schedulerpolicy-class.md) object that contains the policy values for the scheduler to use.  \n  \n\n2.  Call the [concurrency::CurrentScheduler::Create](reference/currentscheduler-class.md#create) method or the [concurrency::Scheduler::Create](reference/scheduler-class.md#create) method to create a scheduler instance.  \n  \n     If you use the `Scheduler::Create` method, call the [concurrency::Scheduler::Attach](reference/scheduler-class.md#attach) method when you need to associate the scheduler with the current context.  \n  \n3.  Call the [CreateEvent](http://msdn.microsoft.com/library/windows/desktop/ms682396) function to create a handle to a non-signaled, auto-reset event object.  \n  \n4.  Pass the handle to the event object that you just created to the [concurrency::CurrentScheduler::RegisterShutdownEvent](reference/currentscheduler-class.md#registershutdownevent) method or the [concurrency::Scheduler::RegisterShutdownEvent](reference/scheduler-class.md#registershutdownevent) method. This registers the event to be set when the scheduler is destroyed.  \n  \n5.  Perform the tasks that you want the current scheduler to schedule.  \n  \n6.  Call the [concurrency::CurrentScheduler::Detach](reference/currentscheduler-class.md#detach) method to detach the current scheduler and restore the previous scheduler as the current one.  \n  \n     If you use the `Scheduler::Create` method, call the [concurrency::Scheduler::Release](reference/scheduler-class.md#release) method to decrement the reference count of the `Scheduler` object.  \n  \n7.  Pass the handle to the event to the [WaitForSingleObject](http://msdn.microsoft.com/library/windows/desktop/ms687032) function to wait for the scheduler to shut down.  \n  \n8.  Call the [CloseHandle](http://msdn.microsoft.com/library/windows/desktop/ms724211) function to close the handle to the event object.  \n  \n## Example  \n The following code shows two ways to manage a scheduler instance. Each example first uses the default scheduler to perform a task that prints out the unique identifier of the current scheduler. Each example then uses a scheduler instance to perform the same task again. Finally, each example restores the default scheduler as the current one and performs the task one more time.  \n  \n The first example uses the [concurrency::CurrentScheduler](../../parallel/concrt/reference/currentscheduler-class.md) class to create a scheduler instance and associate it with the current context. The second example uses the [concurrency::Scheduler](../../parallel/concrt/reference/scheduler-class.md) class to perform the same task. Typically, the `CurrentScheduler` class is used to work with the current scheduler. The second example, which uses the `Scheduler` class, is useful when you want to control when the scheduler is associated with the current context or when you want to associate specific schedulers with specific tasks.  \n  \n [!code-cpp[concrt-scheduler-instance#1](../../parallel/concrt/codesnippet/cpp/how-to-manage-a-scheduler-instance_1.cpp)]  \n  \n This example produces the following output.  \n  \n```Output  \nUsing CurrentScheduler class...  \n \nCurrent scheduler id: 0  \nCreating and attaching scheduler...  \nCurrent scheduler id: 1  \nDetaching scheduler...  \nCurrent scheduler id: 0  \n \nUsing Scheduler class...  \n \nCurrent scheduler id: 0  \nCreating scheduler...  \nAttaching scheduler...  \nCurrent scheduler id: 2  \nDetaching scheduler...  \nCurrent scheduler id: 0  \n```  \n  \n## Compiling the Code  \n Copy the example code and paste it in a Visual Studio project, or paste it in a file that is named `scheduler-instance.cpp` and then run the following command in a Visual Studio Command Prompt window.  \n  \n **cl.exe /EHsc scheduler-instance.cpp**  \n  \n## See Also  \n [Scheduler Instances](../../parallel/concrt/scheduler-instances.md)   \n [How to: Specify Specific Scheduler Policies](../../parallel/concrt/how-to-specify-specific-scheduler-policies.md)\n\n"}