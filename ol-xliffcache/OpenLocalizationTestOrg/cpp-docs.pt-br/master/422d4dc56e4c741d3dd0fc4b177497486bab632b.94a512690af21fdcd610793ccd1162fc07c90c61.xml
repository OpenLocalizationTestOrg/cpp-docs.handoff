{"nodes":[{"pos":[12,124],"content":"Walkthrough: Deploying a Visual C++ Application By Using the Visual C++ Redistributable Package | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Walkthrough: Deploying a Visual C++ Application By Using the Visual C++ Redistributable Package | Microsoft Docs","pos":[0,112]}]},{"content":"Walkthrough: Deploying a Visual C++ Application By Using the Visual C++ Redistributable Package","pos":[717,812]},{"content":"This step-by-step article describes how to use the Visual C++ Redistributable Package to deploy a Visual C++ application.","pos":[813,934]},{"content":"Prerequisites","pos":[943,956]},{"content":"You must have these components to complete this walkthrough:","pos":[960,1020]},{"content":"A computer that has Visual Studio installed.","pos":[1030,1074]},{"content":"An additional computer that does not have the Visual C++ libraries.","pos":[1084,1151]},{"content":"To use the Visual C++ Redistributable Package to deploy an application","pos":[1161,1231]},{"pos":[1241,1476],"content":"Create and build an MFC application by following the first three steps in <bpt id=\"p1\">[</bpt>Walkthrough: Deploying a Visual C++ Application By Using a Setup Project<ept id=\"p1\">](../ide/deploying-visual-cpp-application-by-using-the-vcpp-redistributable-package.md)</ept>.","source":"Create and build an MFC application by following the first three steps in [Walkthrough: Deploying a Visual C++ Application By Using a Setup Project](../ide/deploying-visual-cpp-application-by-using-the-vcpp-redistributable-package.md)."},{"content":"Create a file, name it setup.bat, and add the following commands to it.","pos":[1486,1557]},{"content":"Change <ph id=\"ph1\">`MyMFCApplication`</ph> to the name of your project.","pos":[1558,1612],"source":" Change `MyMFCApplication` to the name of your project."},{"content":"Create a self-extracting setup file:","pos":[1813,1849]},{"pos":[1863,1926],"content":"At a command prompt or in the <bpt id=\"p1\">**</bpt>Run<ept id=\"p1\">**</ept> window, run iexpress.exe.","source":"At a command prompt or in the **Run** window, run iexpress.exe."},{"pos":[1940,2029],"content":"Select <bpt id=\"p1\">**</bpt>Create new Self Extraction Directive file<ept id=\"p1\">**</ept> and then choose the <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> button.","source":"Select **Create new Self Extraction Directive file** and then choose the **Next** button."},{"pos":[2043,2125],"content":"Select <bpt id=\"p1\">**</bpt>Extract files and run an installation command<ept id=\"p1\">**</ept> and then choose <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"Select **Extract files and run an installation command** and then choose **Next**."},{"pos":[2139,2220],"content":"In the text box, enter the name of your MFC application and then choose <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","source":"In the text box, enter the name of your MFC application and then choose **Next**."},{"pos":[2234,2317],"content":"On the <bpt id=\"p1\">**</bpt>Confirmation prompt<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>No Prompt<ept id=\"p2\">**</ept> and then choose <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"On the **Confirmation prompt** page, select **No Prompt** and then choose **Next**."},{"pos":[2331,2427],"content":"On the <bpt id=\"p1\">**</bpt>License agreement<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Do not display a license<ept id=\"p2\">**</ept> and then choose <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"On the **License agreement** page, select **Do not display a license** and then choose **Next**."},{"pos":[2441,2522],"content":"On the <bpt id=\"p1\">**</bpt>Packaged files<ept id=\"p1\">**</ept> page, add the following files and then choose <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"On the **Packaged files** page, add the following files and then choose **Next**."},{"content":"Your MFC application (.exe file).","pos":[2540,2573]},{"content":"vcredist_x86.exe.","pos":[2591,2608]},{"content":"This file is located in \\Program Files\\Microsoft SDKs\\Windows\\v7.0A\\Bootstrapper\\Packages\\vcredist_x86<ph id=\"ph1\">\\\\</ph>.","pos":[2609,2714],"source":" This file is located in \\Program Files\\Microsoft SDKs\\Windows\\v7.0A\\Bootstrapper\\Packages\\vcredist_x86\\\\."},{"content":"The setup.bat file that you created in the earlier step.","pos":[2732,2788]},{"pos":[2802,2940],"content":"On the <bpt id=\"p1\">**</bpt>Install Program to Launch<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Install Program<ept id=\"p2\">**</ept> text box, enter the following command line and then choose <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"On the **Install Program to Launch** page, in the **Install Program** text box, enter the following command line and then choose **Next**."},{"content":"cmd.exe /c \"setup.bat\"","pos":[2957,2979]},{"pos":[2994,3067],"content":"On the <bpt id=\"p1\">**</bpt>Show window<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Default<ept id=\"p2\">**</ept> and then choose <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"On the **Show window** page, select **Default** and then choose **Next**."},{"pos":[3081,3162],"content":"On the <bpt id=\"p1\">**</bpt>Finished message<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>No message<ept id=\"p2\">**</ept> and then choose <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"On the **Finished message** page, select **No message** and then choose **Next**."},{"content":"On the <bpt id=\"p1\">**</bpt>Package Name and Options<ept id=\"p1\">**</ept> page, enter a name for your self-extracting setup file, select the <bpt id=\"p2\">**</bpt>Store files using Long File Name inside Package<ept id=\"p2\">**</ept> option, and then choose <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","pos":[3176,3364],"source":"On the **Package Name and Options** page, enter a name for your self-extracting setup file, select the **Store files using Long File Name inside Package** option, and then choose **Next**."},{"content":"The end of the file name must be Setup.exeâ€”for example, MyMFCApplicationSetup.exe.","pos":[3365,3447]},{"pos":[3461,3543],"content":"On the <bpt id=\"p1\">**</bpt>Configure restart<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>No restart<ept id=\"p2\">**</ept> and then choose <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"On the **Configure restart** page, select **No restart** and then choose **Next**."},{"pos":[3557,3683],"content":"On the <bpt id=\"p1\">**</bpt>Save Self Extraction Directive<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Save Self Extraction Directive (SED) file<ept id=\"p2\">**</ept> and then choose <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"On the **Save Self Extraction Directive** page, select **Save Self Extraction Directive (SED) file** and then choose **Next**."},{"pos":[3697,3745],"content":"On the <bpt id=\"p1\">**</bpt>Create package<ept id=\"p1\">**</ept> page, choose <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"On the **Create package** page, choose **Next**."},{"content":"Test the self-extracting setup file on the other computer, which does not have the Visual C++ libraries:","pos":[3755,3859]},{"content":"On the other computer, download a copy of the setup file, and then install it by running it and following the steps that it provides.","pos":[3873,4006]},{"content":"Run the MFC application.","pos":[4020,4044]},{"content":"The self-extracting setup file installs the MFC application that is in the folder that you specified in step 2.","pos":[4059,4170]},{"content":"The application runs successfully because the Visual C++ Redistributable Package installer is included in the self-extracting setup file.","pos":[4171,4308]},{"pos":[4324,4766],"content":"[!IMPORTANT]\n To determine which version of the runtime is installed, the installer checks the registry key \\HKLM\\SOFTWARE\\Microsoft\\VisualStudio\\11.0\\VC\\Runtimes\\\\[platform]. If the currently installed version is newer than the version that the installer is attempting to install, the installer returns success without installing the older version and leaves an additional entry on the installed programs page in the Control Panel.","leadings":["","        > "],"nodes":[{"content":" To determine which version of the runtime is installed, the installer checks the registry key \\HKLM\\SOFTWARE\\Microsoft\\VisualStudio\\11.0\\VC\\Runtimes\\\\[platform]. If the currently installed version is newer than the version that the installer is attempting to install, the installer returns success without installing the older version and leaves an additional entry on the installed programs page in the Control Panel.","pos":[13,432],"nodes":[{"content":"To determine which version of the runtime is installed, the installer checks the registry key \\HKLM\\SOFTWARE\\Microsoft\\VisualStudio\\11.0\\VC\\Runtimes<ph id=\"ph1\">\\\\</ph>[platform].","pos":[1,162],"source":" To determine which version of the runtime is installed, the installer checks the registry key \\HKLM\\SOFTWARE\\Microsoft\\VisualStudio\\11.0\\VC\\Runtimes\\\\[platform]."},{"content":"If the currently installed version is newer than the version that the installer is attempting to install, the installer returns success without installing the older version and leaves an additional entry on the installed programs page in the Control Panel.","pos":[163,419]}]}]},{"content":"See Also","pos":[4775,4783]},{"content":"Deployment Examples","pos":[4788,4807]}],"content":"---\ntitle: \"Walkthrough: Deploying a Visual C++ Application By Using the Visual C++ Redistributable Package | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"walkthrough, deploying a Visual C++ application by using the redistributable package\"\nms.assetid: e59becbf-b8c6-4c8e-bab3-b69cc1ed3e5e\ncaps.latest.revision: 9\nauthor: \"corob-msft\"\nms.author: \"corob\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Walkthrough: Deploying a Visual C++ Application By Using the Visual C++ Redistributable Package\nThis step-by-step article describes how to use the Visual C++ Redistributable Package to deploy a Visual C++ application.  \n  \n## Prerequisites  \n You must have these components to complete this walkthrough:  \n  \n-   A computer that has Visual Studio installed.  \n  \n-   An additional computer that does not have the Visual C++ libraries.  \n  \n### To use the Visual C++ Redistributable Package to deploy an application  \n  \n1.  Create and build an MFC application by following the first three steps in [Walkthrough: Deploying a Visual C++ Application By Using a Setup Project](../ide/deploying-visual-cpp-application-by-using-the-vcpp-redistributable-package.md).  \n  \n2.  Create a file, name it setup.bat, and add the following commands to it. Change `MyMFCApplication` to the name of your project.  \n  \n    ```  \n  \n              @echo off  \n    vcredist_x86.exe  \n    mkdir \"C:\\Program Files\\MyMFCApplication\"  \n    copy MyMFCApplication.exe \"C:\\Program Files\\MyMFCApplication\"  \n    ```  \n  \n3.  Create a self-extracting setup file:  \n  \n    1.  At a command prompt or in the **Run** window, run iexpress.exe.  \n  \n    2.  Select **Create new Self Extraction Directive file** and then choose the **Next** button.  \n  \n    3.  Select **Extract files and run an installation command** and then choose **Next**.  \n  \n    4.  In the text box, enter the name of your MFC application and then choose **Next**.  \n  \n    5.  On the **Confirmation prompt** page, select **No Prompt** and then choose **Next**.  \n  \n    6.  On the **License agreement** page, select **Do not display a license** and then choose **Next**.  \n  \n    7.  On the **Packaged files** page, add the following files and then choose **Next**.  \n  \n        -   Your MFC application (.exe file).  \n  \n        -   vcredist_x86.exe. This file is located in \\Program Files\\Microsoft SDKs\\Windows\\v7.0A\\Bootstrapper\\Packages\\vcredist_x86\\\\.  \n  \n        -   The setup.bat file that you created in the earlier step.  \n  \n    8.  On the **Install Program to Launch** page, in the **Install Program** text box, enter the following command line and then choose **Next**.  \n  \n         **cmd.exe /c \"setup.bat\"**  \n  \n    9. On the **Show window** page, select **Default** and then choose **Next**.  \n  \n    10. On the **Finished message** page, select **No message** and then choose **Next**.  \n  \n    11. On the **Package Name and Options** page, enter a name for your self-extracting setup file, select the **Store files using Long File Name inside Package** option, and then choose **Next**. The end of the file name must be Setup.exeâ€”for example, MyMFCApplicationSetup.exe.  \n  \n    12. On the **Configure restart** page, select **No restart** and then choose **Next**.  \n  \n    13. On the **Save Self Extraction Directive** page, select **Save Self Extraction Directive (SED) file** and then choose **Next**.  \n  \n    14. On the **Create package** page, choose **Next**.  \n  \n4.  Test the self-extracting setup file on the other computer, which does not have the Visual C++ libraries:  \n  \n    1.  On the other computer, download a copy of the setup file, and then install it by running it and following the steps that it provides.  \n  \n    2.  Run the MFC application.  \n  \n         The self-extracting setup file installs the MFC application that is in the folder that you specified in step 2. The application runs successfully because the Visual C++ Redistributable Package installer is included in the self-extracting setup file.  \n  \n        > [!IMPORTANT]\n        >  To determine which version of the runtime is installed, the installer checks the registry key \\HKLM\\SOFTWARE\\Microsoft\\VisualStudio\\11.0\\VC\\Runtimes\\\\[platform]. If the currently installed version is newer than the version that the installer is attempting to install, the installer returns success without installing the older version and leaves an additional entry on the installed programs page in the Control Panel.  \n  \n## See Also  \n [Deployment Examples](../ide/deployment-examples.md)"}