{"nodes":[{"pos":[12,54],"content":"Attribute Programming FAQ | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Attribute Programming FAQ | Microsoft Docs","pos":[0,42]}]},{"content":"Attribute Programming FAQ","pos":[706,731]},{"content":"This topic answers the following frequently asked questions:","pos":[732,792]},{"content":"What is an HRESULT?","pos":[803,822]},{"content":"When do I have to specify the parameter name for an attribute?","pos":[873,935]},{"content":"Can I use comments in an attribute block?","pos":[986,1027]},{"content":"How do attributes interact with inheritance?","pos":[1078,1122]},{"content":"How can I use attributes in a nonattributed ATL project?","pos":[1173,1229]},{"content":"How can I use an .idl file in an attributed project?","pos":[1280,1332]},{"content":"Can I modify code that is injected by an attribute?","pos":[1383,1434]},{"content":"How can I forward declare an attributed interface?","pos":[1485,1535]},{"content":"Can I use attributes on a class derived from a class that also uses attributes?","pos":[1621,1700]},{"pos":[1839,1858],"content":"What is an HRESULT?"},{"content":"An <ph id=\"ph1\">`HRESULT`</ph> is a simple data type that is often used as a return value by attributes and ATL in general.","pos":[1862,1967],"source":"An `HRESULT` is a simple data type that is often used as a return value by attributes and ATL in general."},{"content":"The following table describes the various values.","pos":[1968,2017]},{"content":"More values are contained in the header file winerror.h.","pos":[2018,2074]},{"content":"Name","pos":[2081,2085]},{"content":"Description","pos":[2086,2097]},{"content":"Value","pos":[2098,2103]},{"content":"S_OK","pos":[2153,2157]},{"content":"Operation successful","pos":[2158,2178]},{"content":"0x00000000","pos":[2179,2189]},{"content":"E_UNEXPECTED","pos":[2194,2206]},{"content":"Unexpected failure","pos":[2207,2225]},{"content":"0x8000FFFF","pos":[2226,2236]},{"content":"E_NOTIMPL","pos":[2241,2250]},{"content":"Not implemented","pos":[2251,2266]},{"content":"0x80004001","pos":[2267,2277]},{"content":"E_OUTOFMEMORY","pos":[2282,2295]},{"content":"Failed to allocate necessary memory","pos":[2296,2331]},{"content":"0x8007000E","pos":[2332,2342]},{"content":"E_INVALIDARG","pos":[2347,2359]},{"content":"One or more arguments are invalid","pos":[2360,2393]},{"content":"0x80070057","pos":[2394,2404]},{"content":"E_NOINTERFACE","pos":[2409,2422]},{"content":"No such interface supported","pos":[2423,2450]},{"content":"0x80004002","pos":[2451,2461]},{"content":"E_POINTER","pos":[2466,2475]},{"content":"Invalid pointer","pos":[2476,2491]},{"content":"0x80004003","pos":[2492,2502]},{"content":"E_HANDLE","pos":[2507,2515]},{"content":"Invalid handle","pos":[2516,2530]},{"content":"0x80070006","pos":[2531,2541]},{"content":"E_ABORT","pos":[2546,2553]},{"content":"Operation aborted","pos":[2554,2571]},{"content":"0x80004004","pos":[2572,2582]},{"content":"E_FAIL","pos":[2587,2593]},{"content":"Unspecified failure","pos":[2594,2613]},{"content":"0x80004005","pos":[2614,2624]},{"content":"E_ACCESSDENIED","pos":[2629,2643]},{"content":"General access denied error","pos":[2644,2671]},{"content":"0x80070005","pos":[2672,2682]},{"pos":[2745,2807],"content":"When do I have to specify the parameter name for an attribute?"},{"content":"In most cases, if the attribute has a single parameter, that parameter is named.","pos":[2811,2891]},{"content":"This name is not required when inserting the attribute in your code.","pos":[2892,2960]},{"content":"For example, the following usage of the <bpt id=\"p1\">[</bpt>aggregatable<ept id=\"p1\">](../windows/aggregatable.md)</ept> attribute:","pos":[2961,3054],"source":" For example, the following usage of the [aggregatable](../windows/aggregatable.md) attribute:"},{"content":"is exactly the same as:","pos":[3170,3193]},{"content":"However, the following attributes have single, unnamed parameters:","pos":[3303,3369]},{"content":"call_as","pos":[3394,3401]},{"content":"case","pos":[3427,3431]},{"content":"cpp_quote","pos":[3458,3467]},{"content":"default","pos":[3499,3506]},{"content":"defaultvalue","pos":[3536,3548]},{"content":"defaultvtable","pos":[3579,3592]},{"content":"emitidl","pos":[3628,3635]},{"content":"entry","pos":[3661,3666]},{"content":"first_is","pos":[3690,3698]},{"content":"helpcontext","pos":[3729,3740]},{"content":"helpfile","pos":[3770,3778]},{"content":"helpstring","pos":[3805,3815]},{"content":"helpstringcontext","pos":[3848,3865]},{"content":"helpstringdll","pos":[3901,3914]},{"content":"id","pos":[3946,3948]},{"content":"iid_is","pos":[3973,3979]},{"content":"import","pos":[4004,4010]},{"content":"importlib","pos":[4035,4044]},{"content":"include","pos":[4076,4083]},{"content":"includelib","pos":[4113,4123]},{"content":"last_is","pos":[4156,4163]},{"content":"length_is","pos":[4193,4202]},{"content":"max_is","pos":[4230,4236]},{"content":"no_injected_text","pos":[4261,4277]},{"content":"pointer_default","pos":[4316,4331]},{"content":"pragma","pos":[4365,4371]},{"content":"restricted","pos":[4396,4406]},{"content":"size_is","pos":[4439,4446]},{"content":"source","pos":[4472,4478]},{"content":"switch_is","pos":[4507,4516]},{"content":"switch_type","pos":[4548,4559]},{"content":"transmit_as","pos":[4589,4600]},{"content":"wire_marshal","pos":[4630,4642]},{"pos":[4734,4775],"content":"Can I use comments in an attribute block?"},{"content":"You can use both single-line and multiple-line comments within an attribute block.","pos":[4779,4861]},{"content":"However, you cannot use either style of comment within the parentheses holding the parameters to an attribute.","pos":[4862,4972]},{"content":"The following is allowed:","pos":[4979,5004]},{"content":"The following is disallowed:","pos":[5193,5221]},{"pos":[5425,5469],"content":"How do attributes interact with inheritance?"},{"content":"You can inherit both attributed and unattributed classes from other classes, which may themselves be attributed or not.","pos":[5473,5592]},{"content":"The result of deriving from an attributed class is the same as deriving from that class after the attribute provider has transformed its code.","pos":[5593,5735]},{"content":"Attributes are not transmitted to derived classes through C++ inheritance.","pos":[5736,5810]},{"content":"An attribute provider only transforms code in the vicinity of its attributes.","pos":[5811,5888]},{"pos":[5950,6006],"content":"How can I use attributes in a nonattributed ATL project?"},{"content":"You may have a nonattributed ATL project, which has an .idl file, and you may want to start adding attributed objects.","pos":[6010,6128]},{"content":"In this case, use the Add Class Wizard to provide the code.","pos":[6129,6188]},{"pos":[6250,6302],"content":"How can I use an .idl file in an attributed project?"},{"content":"You may have a .idl file that you want to use in your ATL attributed project.","pos":[6306,6383]},{"content":"In this case, you would use the <bpt id=\"p1\">[</bpt>importidl<ept id=\"p1\">](../windows/importidl.md)</ept> attribute, compile the .idl file to a .h file (see the <bpt id=\"p2\">[</bpt>MIDL Property Pages<ept id=\"p2\">](../ide/midl-property-pages.md)</ept> in the project's Property Pages dialog box), and then include the .h file in your project.","pos":[6384,6651],"source":" In this case, you would use the [importidl](../windows/importidl.md) attribute, compile the .idl file to a .h file (see the [MIDL Property Pages](../ide/midl-property-pages.md) in the project's Property Pages dialog box), and then include the .h file in your project."},{"pos":[6713,6764],"content":"Can I modify code that is injected by an attribute?"},{"content":"Some attributes inject code into your project.","pos":[6768,6814]},{"content":"You can see the injected code by using the <bpt id=\"p1\">[</bpt>/Fx<ept id=\"p1\">](../build/reference/fx-merge-injected-code.md)</ept> compiler option.","pos":[6815,6926],"source":" You can see the injected code by using the [/Fx](../build/reference/fx-merge-injected-code.md) compiler option."},{"content":"It is also possible to copy code from the injected file and paste it into your source code.","pos":[6927,7018]},{"content":"This allows you to modify the behavior of the attribute.","pos":[7019,7075]},{"content":"However, you may have to modify other parts of your code as well.","pos":[7076,7141]},{"content":"The following sample is the result of copying injected code into a source code file:","pos":[7148,7232]},{"pos":[10544,10594],"content":"How can I forward declare an attributed interface?"},{"content":"If you are going to make a forward declaration of an attributed interface, you must apply the same attributes to the forward declaration that you apply to the actual interface declaration.","pos":[10598,10786]},{"content":"You must also apply the <bpt id=\"p1\">[</bpt>export<ept id=\"p1\">](../windows/export.md)</ept> attribute to your forward declaration.","pos":[10787,10880],"source":" You must also apply the [export](../windows/export.md) attribute to your forward declaration."},{"pos":[10979,11058],"content":"Can I use attributes on a class derived from a class that also uses attributes?"},{"content":"No, using attributes on a class derived from a class that also uses attributes is not supported.","pos":[11062,11158]},{"content":"See Also","pos":[11167,11175]},{"content":"Concepts","pos":[11180,11188]}],"content":"---\ntitle: \"Attribute Programming FAQ | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"attributed programming\"\n  - \"attributes [C++], frequently asked questions\"\n  - \"FAQs (frequently asked questions), attributed programming [C++]\"\nms.assetid: a1b8349f-7f51-43c4-95ea-4edb6e5f243f\ncaps.latest.revision: 8\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Attribute Programming FAQ\nThis topic answers the following frequently asked questions:  \n  \n-   [What is an HRESULT?](#vcconattributeprogrammmingfaqanchor1)  \n  \n-   [When do I have to specify the parameter name for an attribute?](#vcconattributeprogrammmingfaqanchor2)  \n  \n-   [Can I use comments in an attribute block?](#vcconattributeprogrammmingfaqanchor3)  \n  \n-   [How do attributes interact with inheritance?](#vcconattributeprogrammmingfaqanchor4)  \n  \n-   [How can I use attributes in a nonattributed ATL project?](#vcconattributeprogrammmingfaqanchor5)  \n  \n-   [How can I use an .idl file in an attributed project?](#vcconattributeprogrammmingfaqanchor6)  \n  \n-   [Can I modify code that is injected by an attribute?](#vcconattributeprogrammmingfaqanchor7)  \n  \n-   [How can I forward declare an attributed interface?](#vcconattributeprogrammmingfaqhowcaniforwarddeclareanattributedinterface)  \n  \n-   [Can I use attributes on a class derived from a class that also uses attributes?](#vcconcaniuseattributesonclassderivedfromclassthatalsousesattributesanchor)  \n  \n##  <a name=\"vcconattributeprogrammmingfaqanchor1\"></a> What is an HRESULT?  \n An `HRESULT` is a simple data type that is often used as a return value by attributes and ATL in general. The following table describes the various values. More values are contained in the header file winerror.h.  \n  \n|Name|Description|Value|  \n|----------|-----------------|-----------|  \n|S_OK|Operation successful|0x00000000|  \n|E_UNEXPECTED|Unexpected failure|0x8000FFFF|  \n|E_NOTIMPL|Not implemented|0x80004001|  \n|E_OUTOFMEMORY|Failed to allocate necessary memory|0x8007000E|  \n|E_INVALIDARG|One or more arguments are invalid|0x80070057|  \n|E_NOINTERFACE|No such interface supported|0x80004002|  \n|E_POINTER|Invalid pointer|0x80004003|  \n|E_HANDLE|Invalid handle|0x80070006|  \n|E_ABORT|Operation aborted|0x80004004|  \n|E_FAIL|Unspecified failure|0x80004005|  \n|E_ACCESSDENIED|General access denied error|0x80070005|  \n  \n##  <a name=\"vcconattributeprogrammmingfaqanchor2\"></a> When do I have to specify the parameter name for an attribute?  \n In most cases, if the attribute has a single parameter, that parameter is named. This name is not required when inserting the attribute in your code. For example, the following usage of the [aggregatable](../windows/aggregatable.md) attribute:  \n  \n```  \n[coclass, aggregatable(value=allowed)]  \nclass CMyClass  \n{  \n// The class declaration  \n};  \n```  \n  \n is exactly the same as:  \n  \n```  \n[coclass, aggregatable(allowed)]  \nclass CMyClass  \n{  \n// The class declaration  \n};  \n```  \n  \n However, the following attributes have single, unnamed parameters:  \n  \n||||  \n|-|-|-|  \n|[call_as](../windows/call-as.md)|[case](../windows/case-cpp.md)|[cpp_quote](../windows/cpp-quote.md)|  \n|[default](../windows/default-cpp.md)|[defaultvalue](../windows/defaultvalue.md)|[defaultvtable](../windows/defaultvtable.md)|  \n|[emitidl](../windows/emitidl.md)|[entry](../windows/entry.md)|[first_is](../windows/first-is.md)|  \n|[helpcontext](../windows/helpcontext.md)|[helpfile](../windows/helpfile.md)|[helpstring](../windows/helpstring.md)|  \n|[helpstringcontext](../windows/helpstringcontext.md)|[helpstringdll](../windows/helpstringdll.md)|[id](../windows/id.md)|  \n|[iid_is](../windows/iid-is.md)|[import](../windows/import.md)|[importlib](../windows/importlib.md)|  \n|[include](../windows/include-cpp.md)|[includelib](../windows/includelib-cpp.md)|[last_is](../windows/last-is.md)|  \n|[length_is](../windows/length-is.md)|[max_is](../windows/max-is.md)|[no_injected_text](../windows/no-injected-text.md)|  \n|[pointer_default](../windows/pointer-default.md)|[pragma](../windows/pragma.md)|[restricted](../windows/restricted.md)|  \n|[size_is](../windows/size-is.md)|[source](../windows/source-cpp.md)|[switch_is](../windows/switch-is.md)|  \n|[switch_type](../windows/switch-type.md)|[transmit_as](../windows/transmit-as.md)|[wire_marshal](../windows/wire-marshal.md)|  \n  \n##  <a name=\"vcconattributeprogrammmingfaqanchor3\"></a> Can I use comments in an attribute block?  \n You can use both single-line and multiple-line comments within an attribute block. However, you cannot use either style of comment within the parentheses holding the parameters to an attribute.  \n  \n The following is allowed:  \n  \n```  \n[ coclass,  \n   progid(\"MyClass.CMyClass.1\"), /* Multiple-line  \n                                       comment */  \n   threading(\"both\") // Single-line comment  \n]  \n```  \n  \n The following is disallowed:  \n  \n```  \n[ coclass,  \n   progid(\"MyClass.CMyClass.1\" /* Multiple-line comment */ ),  \n   threading(\"both\" // Single-line comment)  \n]  \n```  \n  \n##  <a name=\"vcconattributeprogrammmingfaqanchor4\"></a> How do attributes interact with inheritance?  \n You can inherit both attributed and unattributed classes from other classes, which may themselves be attributed or not. The result of deriving from an attributed class is the same as deriving from that class after the attribute provider has transformed its code. Attributes are not transmitted to derived classes through C++ inheritance. An attribute provider only transforms code in the vicinity of its attributes.  \n  \n##  <a name=\"vcconattributeprogrammmingfaqanchor5\"></a> How can I use attributes in a nonattributed ATL project?  \n You may have a nonattributed ATL project, which has an .idl file, and you may want to start adding attributed objects. In this case, use the Add Class Wizard to provide the code.  \n  \n##  <a name=\"vcconattributeprogrammmingfaqanchor6\"></a> How can I use an .idl file in an attributed project?  \n You may have a .idl file that you want to use in your ATL attributed project. In this case, you would use the [importidl](../windows/importidl.md) attribute, compile the .idl file to a .h file (see the [MIDL Property Pages](../ide/midl-property-pages.md) in the project's Property Pages dialog box), and then include the .h file in your project.  \n  \n##  <a name=\"vcconattributeprogrammmingfaqanchor7\"></a> Can I modify code that is injected by an attribute?  \n Some attributes inject code into your project. You can see the injected code by using the [/Fx](../build/reference/fx-merge-injected-code.md) compiler option. It is also possible to copy code from the injected file and paste it into your source code. This allows you to modify the behavior of the attribute. However, you may have to modify other parts of your code as well.  \n  \n The following sample is the result of copying injected code into a source code file:  \n  \n```  \n// attr_injected.cpp  \n// compile with: comsupp.lib  \n#define _ATL_ATTRIBUTES 1  \n#include <atlbase.h>  \n#include <atlcom.h>  \n  \n[ module(name=\"MyLibrary\") ];  \n  \n// ITestTest  \n[   \n   object,  \n   uuid(\"DADECE00-0FD2-46F1-BFD3-6A0579CA1BC4\"),  \n   dual,  \n   helpstring(\"ITestTest Interface\"),  \n   pointer_default(unique)  \n]  \n  \n__interface ITestTest : IDispatch {  \n   [id(1), helpstring(\"method DoTest\")]   \n   HRESULT DoTest([in] BSTR str);  \n};  \n  \n// _ITestTestEvents  \n[  \n   uuid(\"12753B9F-DEF4-49b0-9D52-A79C371F2909\"),  \n   dispinterface,  \n   helpstring(\"_ITestTestEvents Interface\")  \n]  \n  \n__interface _ITestTestEvents {  \n   [id(1), helpstring(\"method BeforeChange\")] HRESULT BeforeChange([in] BSTR str, [in,out] VARIANT_BOOL* bCancel);  \n};  \n  \n// CTestTest  \n[  \n   coclass,  \n   threading(apartment),  \n   vi_progid(\"TestATL1.TestTest\"),  \n   progid(\"TestATL1.TestTest.1\"),  \n   version(1.0),  \n   uuid(\"D9632007-14FA-4679-9E1C-28C9A949E784\"),  \n   // this line would be commented out from original file  \n   // event_source(\"com\"),  \n   // this line would be added to support injected code  \n   source(_ITestTestEvents),  \n   helpstring(\"TestTest Class\")  \n]  \n  \nclass ATL_NO_VTABLE CTestTest : public ITestTest,  \n// the following base classes support added injected code  \npublic IConnectionPointContainerImpl<CTestTest>,  \npublic IConnectionPointImpl<CTestTest, &__uuidof(::_ITestTestEvents), CComDynamicUnkArray>  \n{  \npublic:  \n   CTestTest() {  \n   }  \n   // this line would be commented out from original file  \n   // __event __interface _ITestTestEvents;  \n   DECLARE_PROTECT_FINAL_CONSTRUCT()  \n   HRESULT FinalConstruct() {  \n      return S_OK;  \n   }  \n  \nvoid FinalRelease() {}  \n  \npublic:  \n   CComBSTR m_value;  \n   STDMETHOD(DoTest)(BSTR str) {  \n      VARIANT_BOOL bCancel = FALSE;  \n      BeforeChange(str,&bCancel);  \n      if (bCancel) {  \n          return Error(\"Error : Someone don't want us to change the value\");  \n      }  \n  \n     m_value =str;  \n     return S_OK;  \n    }  \n// the following was copied in from the injected code.  \nHRESULT BeforeChange(::BSTR i1,::VARIANT_BOOL* i2) {  \n   HRESULT hr = S_OK;  \n   IConnectionPointImpl<CTestTest, &__uuidof(_ITestTestEvents), CComDynamicUnkArray>* p = this;  \n   VARIANT rgvars[2];  \n   Lock();  \n   IUnknown** pp = p->m_vec.begin();  \n   Unlock();  \n   while (pp < p->m_vec.end()) {  \n      if (*pp != NULL) {  \n         IDispatch* pDispatch = (IDispatch*) *pp;  \n         ::VariantInit(&rgvars[1]);  \n         rgvars[1].vt = VT_BSTR;  \n         V_BSTR(&rgvars[1])= (BSTR) i1;  \n         ::VariantInit(&rgvars[0]);  \n         rgvars[0].vt = (VT_BOOL | VT_BYREF);  \n         V_BOOLREF(&rgvars[0])= (VARIANT_BOOL*) i2;  \n         DISPPARAMS disp = { rgvars, NULL, 2, 0 };  \n         VARIANT ret_val;  \n         hr = __ComInvokeEventHandler(pDispatch, 1, 1, &disp, &ret_val);  \n         if (FAILED(hr))  \n            break;  \n      }  \n      pp++;  \n   }  \n   return hr;  \n}  \n  \nBEGIN_CONNECTION_POINT_MAP(CTestTest)  \nCONNECTION_POINT_ENTRY(__uuidof(::_ITestTestEvents))  \nEND_CONNECTION_POINT_MAP()  \n// end added code section  \n  \n// _ITestCtrlEvents Methods  \npublic:  \n};  \n  \nint main() {}  \n```  \n  \n##  <a name=\"vcconattributeprogrammmingfaqhowcaniforwarddeclareanattributedinterface\"></a> How can I forward declare an attributed interface?  \n If you are going to make a forward declaration of an attributed interface, you must apply the same attributes to the forward declaration that you apply to the actual interface declaration. You must also apply the [export](../windows/export.md) attribute to your forward declaration.  \n  \n##  <a name=\"vcconcaniuseattributesonclassderivedfromclassthatalsousesattributesanchor\"></a> Can I use attributes on a class derived from a class that also uses attributes?  \n No, using attributes on a class derived from a class that also uses attributes is not supported.  \n  \n## See Also  \n [Concepts](../windows/attributed-programming-concepts.md)"}