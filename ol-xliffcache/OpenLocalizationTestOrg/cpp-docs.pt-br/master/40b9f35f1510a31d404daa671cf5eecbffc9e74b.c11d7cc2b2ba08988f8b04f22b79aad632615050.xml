{"nodes":[{"pos":[12,53],"content":"Multiple Dual Interfaces | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Multiple Dual Interfaces | Microsoft Docs","pos":[0,41]}]},{"content":"Multiple Dual Interfaces","pos":[799,823]},{"content":"You may want to combine the advantages of a dual interface (that is, the flexibility of both vtable and late binding, thus making the class available to scripting languages as well as C++) with the techniques of multiple inheritance.","pos":[824,1057]},{"content":"Although it is possible to expose multiple dual interfaces on a single COM object, it is not recommended.","pos":[1064,1169]},{"content":"If there are multiple dual interfaces, there must be only one <ph id=\"ph1\">`IDispatch`</ph> interface exposed.","pos":[1170,1262],"source":" If there are multiple dual interfaces, there must be only one `IDispatch` interface exposed."},{"content":"The techniques available to ensure that this is the case carry penalties such as loss of function or increased code complexity.","pos":[1263,1390]},{"content":"The developer considering this approach should carefully weigh the advantages and disadvantages.","pos":[1391,1487]},{"content":"Exposing a Single IDispatch Interface","pos":[1496,1533]},{"content":"It is possible to expose multiple dual interfaces on a single object by deriving from two or more specializations of <ph id=\"ph1\">`IDispatchImpl`</ph>.","pos":[1537,1670],"source":"It is possible to expose multiple dual interfaces on a single object by deriving from two or more specializations of `IDispatchImpl`."},{"content":"However, if you allow clients to query for the <ph id=\"ph1\">`IDispatch`</ph> interface, you will need to use the <bpt id=\"p1\">[</bpt>COM_INTERFACE_ENTRY2<ept id=\"p1\">](http://msdn.microsoft.com/library/3d48c53b-827b-42cc-9e22-594f7ea2bf0b)</ept> macro (or <bpt id=\"p2\">[</bpt>COM_INTERFACE_ENTRY_IID<ept id=\"p2\">](http://msdn.microsoft.com/library/1bb69549-2099-4e20-ad5e-4c5a32f44e4b)</ept>) to specify which base class to use for the implementation of <ph id=\"ph2\">`IDispatch`</ph>.","pos":[1671,2043],"source":" However, if you allow clients to query for the `IDispatch` interface, you will need to use the [COM_INTERFACE_ENTRY2](http://msdn.microsoft.com/library/3d48c53b-827b-42cc-9e22-594f7ea2bf0b) macro (or [COM_INTERFACE_ENTRY_IID](http://msdn.microsoft.com/library/1bb69549-2099-4e20-ad5e-4c5a32f44e4b)) to specify which base class to use for the implementation of `IDispatch`."},{"pos":[2061,2075],"content":"NVC_ATL_COM#23"},{"pos":[2137,2340],"content":"Because only one <ph id=\"ph1\">`IDispatch`</ph> interface is exposed, clients that can only access your objects through the <ph id=\"ph2\">`IDispatch`</ph> interface will not be able to access the methods or properties in any other interface.","source":"Because only one `IDispatch` interface is exposed, clients that can only access your objects through the `IDispatch` interface will not be able to access the methods or properties in any other interface."},{"content":"Combining Multiple Dual Interfaces into a Single Implementation of IDispatch","pos":[2349,2425]},{"content":"ATL does not provide any support for combining multiple dual interfaces into a single implementation of <ph id=\"ph1\">`IDispatch`</ph>.","pos":[2429,2545],"source":"ATL does not provide any support for combining multiple dual interfaces into a single implementation of `IDispatch`."},{"content":"However, there are several known approaches to manually combining the interfaces, such as creating a templated class that contains a union of the separate <ph id=\"ph1\">`IDispatch`</ph> interfaces, creating a new object to perform the <ph id=\"ph2\">`QueryInterface`</ph> function, or using a typeinfo-based implementation of nested objects to create the <ph id=\"ph3\">`IDispatch`</ph> interface.","pos":[2546,2884],"source":" However, there are several known approaches to manually combining the interfaces, such as creating a templated class that contains a union of the separate `IDispatch` interfaces, creating a new object to perform the `QueryInterface` function, or using a typeinfo-based implementation of nested objects to create the `IDispatch` interface."},{"content":"These approaches have problems with potential namespace collisions, as well as code complexity and maintainability.","pos":[2891,3006]},{"content":"It is not recommended that you create multiple dual interfaces.","pos":[3007,3070]},{"content":"See Also","pos":[3079,3087]},{"content":"Dual Interfaces and ATL","pos":[3092,3115]}],"content":"---\ntitle: \"Multiple Dual Interfaces | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"multiple dual interfaces\"\n  - \"COM_INTERFACE_ENTRY2 macro\"\n  - \"dual interfaces, exposing multiple\"\n  - \"multiple dual interfaces, exposing with ATL\"\n  - \"IDispatchImpl class, multiple dual interfaces\"\n  - \"COM_INTERFACE_ENTRY_IID macro\"\nms.assetid: 7fea86e6-247f-4063-be6e-85588a9e3719\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Multiple Dual Interfaces\nYou may want to combine the advantages of a dual interface (that is, the flexibility of both vtable and late binding, thus making the class available to scripting languages as well as C++) with the techniques of multiple inheritance.  \n  \n Although it is possible to expose multiple dual interfaces on a single COM object, it is not recommended. If there are multiple dual interfaces, there must be only one `IDispatch` interface exposed. The techniques available to ensure that this is the case carry penalties such as loss of function or increased code complexity. The developer considering this approach should carefully weigh the advantages and disadvantages.  \n  \n## Exposing a Single IDispatch Interface  \n It is possible to expose multiple dual interfaces on a single object by deriving from two or more specializations of `IDispatchImpl`. However, if you allow clients to query for the `IDispatch` interface, you will need to use the [COM_INTERFACE_ENTRY2](http://msdn.microsoft.com/library/3d48c53b-827b-42cc-9e22-594f7ea2bf0b) macro (or [COM_INTERFACE_ENTRY_IID](http://msdn.microsoft.com/library/1bb69549-2099-4e20-ad5e-4c5a32f44e4b)) to specify which base class to use for the implementation of `IDispatch`.  \n  \n [!code-cpp[NVC_ATL_COM#23](../atl/codesnippet/cpp/multiple-dual-interfaces_1.h)]  \n  \n Because only one `IDispatch` interface is exposed, clients that can only access your objects through the `IDispatch` interface will not be able to access the methods or properties in any other interface.  \n  \n## Combining Multiple Dual Interfaces into a Single Implementation of IDispatch  \n ATL does not provide any support for combining multiple dual interfaces into a single implementation of `IDispatch`. However, there are several known approaches to manually combining the interfaces, such as creating a templated class that contains a union of the separate `IDispatch` interfaces, creating a new object to perform the `QueryInterface` function, or using a typeinfo-based implementation of nested objects to create the `IDispatch` interface.  \n  \n These approaches have problems with potential namespace collisions, as well as code complexity and maintainability. It is not recommended that you create multiple dual interfaces.  \n  \n## See Also  \n [Dual Interfaces and ATL](../atl/dual-interfaces-and-atl.md)\n\n"}