{"nodes":[{"pos":[12,83],"content":"MFC ActiveX Controls: Advanced Property Implementation | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"MFC ActiveX Controls: Advanced Property Implementation | Microsoft Docs","pos":[0,71]}]},{"content":"MFC ActiveX Controls: Advanced Property Implementation","pos":[706,760]},{"content":"This article describes topics related to implementing advanced properties in an ActiveX control:","pos":[761,857]},{"content":"Read-only and write-only properties","pos":[868,903]},{"content":"Returning error codes from a property","pos":[961,998]},{"pos":[1114,1149],"content":"Read-Only and Write-Only Properties"},{"content":"The Add Property Wizard provides a quick and easy method to implement read-only or write-only properties for the control.","pos":[1153,1274]},{"content":"To implement a read-only or write-only property","pos":[1285,1332]},{"content":"Load your control's project.","pos":[1342,1370]},{"content":"In Class View, expand the library node of your control.","pos":[1380,1435]},{"content":"Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.","pos":[1445,1557]},{"pos":[1567,1637],"content":"From the shortcut menu, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Add Property<ept id=\"p2\">**</ept>.","source":"From the shortcut menu, click **Add** and then click **Add Property**."},{"pos":[1648,1722],"content":"This opens the <bpt id=\"p1\">[</bpt>Add Property Wizard<ept id=\"p1\">](../ide/names-add-property-wizard.md)</ept>.","source":"This opens the [Add Property Wizard](../ide/names-add-property-wizard.md)."},{"pos":[1732,1793],"content":"In the <bpt id=\"p1\">**</bpt>Property Name<ept id=\"p1\">**</ept> box, type the name of your property.","source":"In the **Property Name** box, type the name of your property."},{"pos":[1803,1858],"content":"For <bpt id=\"p1\">**</bpt>Implementation Type<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Get/Set Methods<ept id=\"p2\">**</ept>.","source":"For **Implementation Type**, click **Get/Set Methods**."},{"pos":[1868,1938],"content":"In the <bpt id=\"p1\">**</bpt>Property Type<ept id=\"p1\">**</ept> box, select the proper type for the property.","source":"In the **Property Type** box, select the proper type for the property."},{"content":"If you want a read-only property, clear the Set function name.","pos":[1948,2010]},{"content":"If you want a write-only property, clear the Get function name.","pos":[2011,2074]},{"pos":[2083,2100],"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","source":"Click **Finish**."},{"pos":[2107,2276],"content":"When you do this, the Add Property Wizard inserts the function <ph id=\"ph1\">`SetNotSupported`</ph> or <ph id=\"ph2\">`GetNotSupported`</ph> in the dispatch map entry in place of a normal Set or Get function.","source":"When you do this, the Add Property Wizard inserts the function `SetNotSupported` or `GetNotSupported` in the dispatch map entry in place of a normal Set or Get function."},{"content":"If you want to change an existing property to be read-only or write-only, you can edit the dispatch map manually and remove the unnecessary Set or Get function from the control class.","pos":[2283,2466]},{"content":"If you want a property to be conditionally read-only or write-only (for example, only when your control is operating in a particular mode), you can provide the Set or Get function, as normal, and call the <ph id=\"ph1\">`SetNotSupported`</ph> or <ph id=\"ph2\">`GetNotSupported`</ph> function where appropriate.","pos":[2473,2744],"source":"If you want a property to be conditionally read-only or write-only (for example, only when your control is operating in a particular mode), you can provide the Set or Get function, as normal, and call the `SetNotSupported` or `GetNotSupported` function where appropriate."},{"content":"For example:","pos":[2745,2757]},{"pos":[2775,2790],"content":"NVC_MFC_AxUI#29"},{"content":"This code sample calls <ph id=\"ph1\">`SetNotSupported`</ph> if the <ph id=\"ph2\">`m_bReadOnlyMode`</ph> data member is <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>.","pos":[2883,2973],"source":"This code sample calls `SetNotSupported` if the `m_bReadOnlyMode` data member is **TRUE**."},{"content":"If <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>, then the property is set to the new value.","pos":[2974,3030],"source":" If **FALSE**, then the property is set to the new value."},{"pos":[3099,3136],"content":"Returning Error Codes From a Property"},{"content":"To indicate that an error has occurred while attempting to get or set a property, use the <ph id=\"ph1\">`COleControl::ThrowError`</ph> function, which takes an <ph id=\"ph2\">`SCODE`</ph> (status code) as a parameter.","pos":[3140,3318],"source":"To indicate that an error has occurred while attempting to get or set a property, use the `COleControl::ThrowError` function, which takes an `SCODE` (status code) as a parameter."},{"content":"You can use a predefined <ph id=\"ph1\">`SCODE`</ph> or define one of your own.","pos":[3319,3378],"source":" You can use a predefined `SCODE` or define one of your own."},{"content":"For a list of predefined <ph id=\"ph1\">`SCODE`</ph>s and instructions for defining custom <ph id=\"ph2\">`SCODE`</ph>s, see <bpt id=\"p1\">[</bpt>Handling Errors in Your ActiveX Control<ept id=\"p1\">](../mfc/mfc-activex-controls-advanced-topics.md)</ept> in the article ActiveX controls: Advanced Topics.","pos":[3379,3603],"source":" For a list of predefined `SCODE`s and instructions for defining custom `SCODE`s, see [Handling Errors in Your ActiveX Control](../mfc/mfc-activex-controls-advanced-topics.md) in the article ActiveX controls: Advanced Topics."},{"pos":[3610,3985],"content":"Helper functions exist for the most common predefined <ph id=\"ph1\">`SCODE`</ph>s, such as <bpt id=\"p1\">[</bpt>COleControl::SetNotSupported<ept id=\"p1\">](../mfc/reference/colecontrol-class.md#colecontrol__setnotsupported)</ept>, <bpt id=\"p2\">[</bpt>COleControl::GetNotSupported<ept id=\"p2\">](../mfc/reference/colecontrol-class.md#colecontrol__getnotsupported)</ept>, and <bpt id=\"p3\">[</bpt>COleControl::SetNotPermitted<ept id=\"p3\">](../mfc/reference/colecontrol-class.md#colecontrol__setnotpermitted)</ept>.","source":"Helper functions exist for the most common predefined `SCODE`s, such as [COleControl::SetNotSupported](../mfc/reference/colecontrol-class.md#colecontrol__setnotsupported), [COleControl::GetNotSupported](../mfc/reference/colecontrol-class.md#colecontrol__getnotsupported), and [COleControl::SetNotPermitted](../mfc/reference/colecontrol-class.md#colecontrol__setnotpermitted)."},{"pos":[3993,4238],"content":"[!NOTE]\n `ThrowError` is meant to be used only as a means of returning an error from within a property's Get or Set function or an automation method. These are the only times that the appropriate exception handler will be present on the stack.","leadings":["","> "],"nodes":[{"content":" is meant to be used only as a means of returning an error from within a property's Get or Set function or an automation method. These are the only times that the appropriate exception handler will be present on the stack.","pos":[21,243],"nodes":[{"content":"is meant to be used only as a means of returning an error from within a property's Get or Set function or an automation method.","pos":[1,128]},{"content":"These are the only times that the appropriate exception handler will be present on the stack.","pos":[129,222]}]}]},{"pos":[4245,4564],"content":"For more information on reporting exceptions in other areas of the code, see <bpt id=\"p1\">[</bpt>COleControl::FireError<ept id=\"p1\">](../mfc/reference/colecontrol-class.md#colecontrol__fireerror)</ept> and the section <bpt id=\"p2\">[</bpt>Handling Errors in Your ActiveX Control<ept id=\"p2\">](../mfc/mfc-activex-controls-advanced-topics.md)</ept> in the article ActiveX Controls: Advanced Topics.","source":"For more information on reporting exceptions in other areas of the code, see [COleControl::FireError](../mfc/reference/colecontrol-class.md#colecontrol__fireerror) and the section [Handling Errors in Your ActiveX Control](../mfc/mfc-activex-controls-advanced-topics.md) in the article ActiveX Controls: Advanced Topics."},{"content":"See Also","pos":[4573,4581]},{"content":"MFC ActiveX Controls","pos":[4586,4606]},{"content":"MFC ActiveX Controls: Properties","pos":[4645,4677]},{"content":"MFC ActiveX Controls: Methods","pos":[4727,4756]},{"content":"COleControl Class","pos":[4803,4820]}],"content":"---\ntitle: \"MFC ActiveX Controls: Advanced Property Implementation | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"MFC ActiveX controls, error codes\"\n  - \"properties [MFC], ActiveX controls\"\n  - \"MFC ActiveX controls, properties\"\nms.assetid: ec2e6759-5a8e-41d8-a275-99af8ff6f32e\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# MFC ActiveX Controls: Advanced Property Implementation\nThis article describes topics related to implementing advanced properties in an ActiveX control:  \n  \n-   [Read-only and write-only properties](#_core_read2donly_and_write2donly_properties)  \n  \n-   [Returning error codes from a property](#_core_returning_error_codes_from_a_property)  \n  \n##  <a name=\"_core_read2donly_and_write2donly_properties\"></a> Read-Only and Write-Only Properties  \n The Add Property Wizard provides a quick and easy method to implement read-only or write-only properties for the control.  \n  \n#### To implement a read-only or write-only property  \n  \n1.  Load your control's project.  \n  \n2.  In Class View, expand the library node of your control.  \n  \n3.  Right-click the interface node for your control (the second node of the library node) to open the shortcut menu.  \n  \n4.  From the shortcut menu, click **Add** and then click **Add Property**.  \n  \n     This opens the [Add Property Wizard](../ide/names-add-property-wizard.md).  \n  \n5.  In the **Property Name** box, type the name of your property.  \n  \n6.  For **Implementation Type**, click **Get/Set Methods**.  \n  \n7.  In the **Property Type** box, select the proper type for the property.  \n  \n8.  If you want a read-only property, clear the Set function name. If you want a write-only property, clear the Get function name.  \n  \n9. Click **Finish**.  \n  \n When you do this, the Add Property Wizard inserts the function `SetNotSupported` or `GetNotSupported` in the dispatch map entry in place of a normal Set or Get function.  \n  \n If you want to change an existing property to be read-only or write-only, you can edit the dispatch map manually and remove the unnecessary Set or Get function from the control class.  \n  \n If you want a property to be conditionally read-only or write-only (for example, only when your control is operating in a particular mode), you can provide the Set or Get function, as normal, and call the `SetNotSupported` or `GetNotSupported` function where appropriate. For example:  \n  \n [!code-cpp[NVC_MFC_AxUI#29](../mfc/codesnippet/cpp/mfc-activex-controls-advanced-property-implementation_1.cpp)]  \n  \n This code sample calls `SetNotSupported` if the `m_bReadOnlyMode` data member is **TRUE**. If **FALSE**, then the property is set to the new value.  \n  \n##  <a name=\"_core_returning_error_codes_from_a_property\"></a> Returning Error Codes From a Property  \n To indicate that an error has occurred while attempting to get or set a property, use the `COleControl::ThrowError` function, which takes an `SCODE` (status code) as a parameter. You can use a predefined `SCODE` or define one of your own. For a list of predefined `SCODE`s and instructions for defining custom `SCODE`s, see [Handling Errors in Your ActiveX Control](../mfc/mfc-activex-controls-advanced-topics.md) in the article ActiveX controls: Advanced Topics.  \n  \n Helper functions exist for the most common predefined `SCODE`s, such as [COleControl::SetNotSupported](../mfc/reference/colecontrol-class.md#colecontrol__setnotsupported), [COleControl::GetNotSupported](../mfc/reference/colecontrol-class.md#colecontrol__getnotsupported), and [COleControl::SetNotPermitted](../mfc/reference/colecontrol-class.md#colecontrol__setnotpermitted).  \n  \n> [!NOTE]\n>  `ThrowError` is meant to be used only as a means of returning an error from within a property's Get or Set function or an automation method. These are the only times that the appropriate exception handler will be present on the stack.  \n  \n For more information on reporting exceptions in other areas of the code, see [COleControl::FireError](../mfc/reference/colecontrol-class.md#colecontrol__fireerror) and the section [Handling Errors in Your ActiveX Control](../mfc/mfc-activex-controls-advanced-topics.md) in the article ActiveX Controls: Advanced Topics.  \n  \n## See Also  \n [MFC ActiveX Controls](../mfc/mfc-activex-controls.md)   \n [MFC ActiveX Controls: Properties](../mfc/mfc-activex-controls-properties.md)   \n [MFC ActiveX Controls: Methods](../mfc/mfc-activex-controls-methods.md)   \n [COleControl Class](../mfc/reference/colecontrol-class.md)\n"}