{"nodes":[{"pos":[12,46],"content":"CComCoClass Class | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"CComCoClass Class | Microsoft Docs","pos":[0,34]}]},{"content":"CComCoClass Class","pos":[696,713]},{"content":"This class provides methods for creating instances of a class, and obtaining its properties.","pos":[714,806]},{"content":"Syntax","pos":[815,821]},{"content":"Parameters","pos":[927,937]},{"content":"Your class, derived from <ph id=\"ph1\">`CComCoClass`</ph>.","pos":[948,987],"source":" Your class, derived from `CComCoClass`."},{"content":"pclsid","pos":[995,1001]},{"content":"A pointer to the CLSID of the object.","pos":[1006,1043]},{"content":"Members","pos":[1052,1059]},{"content":"Public Methods","pos":[1069,1083]},{"content":"Name","pos":[1090,1094]},{"content":"Description","pos":[1095,1106]},{"content":"CComCoClass::CreateInstance","pos":[1145,1172]},{"content":"(Static) Creates an instance of the class and queries for an interface.","pos":[1204,1275]},{"content":"CComCoClass::Error","pos":[1281,1299]},{"content":"(Static) Returns rich error information to the client.","pos":[1322,1376]},{"content":"CComCoClass::GetObjectCLSID","pos":[1382,1409]},{"content":"(Static) Returns the object's class identifier.","pos":[1441,1488]},{"content":"CComCoClass::GetObjectDescription","pos":[1494,1527]},{"content":"(Static) Override to return the object's description.","pos":[1565,1618]},{"content":"Remarks","pos":[1628,1635]},{"content":"provides methods for retrieving an object's CLSID, setting error information, and creating instances of the class.","pos":[1653,1767]},{"content":"Any class registered in the <bpt id=\"p1\">[</bpt>object map<ept id=\"p1\">](http://msdn.microsoft.com/en-us/b57619cc-534f-4b8f-bfd4-0c12f937202f)</ept> should be derived from <ph id=\"ph1\">`CComCoClass`</ph>.","pos":[1768,1916],"source":" Any class registered in the [object map](http://msdn.microsoft.com/en-us/b57619cc-534f-4b8f-bfd4-0c12f937202f) should be derived from `CComCoClass`."},{"content":"also defines the default class factory and aggregation model for your object.","pos":[1937,2014]},{"content":"uses the following two macros:","pos":[2029,2059]},{"pos":[2067,2261],"content":"<bpt id=\"p1\">[</bpt>DECLARE_CLASSFACTORY<ept id=\"p1\">](http://msdn.microsoft.com/library/51a6b925-07c0-4d3a-9174-0b8c808975e4)</ept> Declares the class factory to be <bpt id=\"p2\">[</bpt>CComClassFactory<ept id=\"p2\">](../../atl/reference/ccomclassfactory-class.md)</ept>.","source":"[DECLARE_CLASSFACTORY](http://msdn.microsoft.com/library/51a6b925-07c0-4d3a-9174-0b8c808975e4) Declares the class factory to be [CComClassFactory](../../atl/reference/ccomclassfactory-class.md)."},{"pos":[2269,2408],"content":"<bpt id=\"p1\">[</bpt>DECLARE_AGGREGATABLE<ept id=\"p1\">](http://msdn.microsoft.com/library/e7e568d7-04e0-4226-b5dc-224deed229ab)</ept> Declares that your object can be aggregated.","source":"[DECLARE_AGGREGATABLE](http://msdn.microsoft.com/library/e7e568d7-04e0-4226-b5dc-224deed229ab) Declares that your object can be aggregated."},{"content":"You can override either of these defaults by specifying another macro in your class definition.","pos":[2415,2510]},{"content":"For example, to use <bpt id=\"p1\">[</bpt>CComClassFactory2<ept id=\"p1\">](../../atl/reference/ccomclassfactory2-class.md)</ept> instead of <ph id=\"ph1\">`CComClassFactory`</ph>, specify the <bpt id=\"p2\">[</bpt>DECLARE_CLASSFACTORY2<ept id=\"p2\">](http://msdn.microsoft.com/library/38a6c969-7297-4bb1-9ba6-1fe2d355b285)</ept> macro:","pos":[2511,2744],"source":" For example, to use [CComClassFactory2](../../atl/reference/ccomclassfactory2-class.md) instead of `CComClassFactory`, specify the [DECLARE_CLASSFACTORY2](http://msdn.microsoft.com/library/38a6c969-7297-4bb1-9ba6-1fe2d355b285) macro:"},{"pos":[2762,2775],"content":"NVC_ATL_COM#2"},{"content":"Requirements","pos":[2835,2847]},{"pos":[2851,2871],"content":"<bpt id=\"p1\">**</bpt>Header:<ept id=\"p1\">**</ept> atlcom.h","source":"**Header:** atlcom.h"},{"pos":[2925,2952],"content":"CComCoClass::CreateInstance"},{"pos":[2956,3091],"content":"Use these <ph id=\"ph1\">`CreateInstance`</ph> functions to create an instance of a COM object and retrieve an interface pointer without using the COM API.","source":"Use these `CreateInstance` functions to create an instance of a COM object and retrieve an interface pointer without using the COM API."},{"content":"Parameters","pos":[3280,3290]},{"content":"The COM interface that should be returned via <ph id=\"ph1\">`pp`</ph>.","pos":[3301,3352],"source":" The COM interface that should be returned via `pp`."},{"content":"punkOuter","pos":[3360,3369]},{"content":"[in] The outer unknown or controlling unknown of the aggregate.","pos":[3374,3437]},{"content":"[out] The address of a pointer variable that receives the requested interface pointer if creation succeeds.","pos":[3452,3559]},{"content":"Return Value","pos":[3569,3581]},{"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","pos":[3585,3612],"source":"A standard `HRESULT` value."},{"content":"See <bpt id=\"p1\">[</bpt>CoCreateInstance<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms686615)</ept> in the <ph id=\"ph1\">[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]</ph> for a description of possible return values.","pos":[3613,3799],"source":" See [CoCreateInstance](http://msdn.microsoft.com/library/windows/desktop/ms686615) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a description of possible return values."},{"content":"Remarks","pos":[3809,3816]},{"content":"Use the first overload of this function for typical object creation; use the second overload when you need to aggregate the object being created.","pos":[3820,3965]},{"content":"The ATL class implementing the required COM object (that is, the class used as the first template parameter to <bpt id=\"p1\">[</bpt>CComCoClass<ept id=\"p1\">](../../atl/reference/ccomcoclass-class.md)</ept>) must be in the same project as the calling code.","pos":[3972,4188],"source":"The ATL class implementing the required COM object (that is, the class used as the first template parameter to [CComCoClass](../../atl/reference/ccomcoclass-class.md)) must be in the same project as the calling code."},{"content":"The creation of the COM object is carried out by the class factory registered for this ATL class.","pos":[4189,4286]},{"content":"These functions are useful for creating objects that you have prevented from being externally creatable by using the <bpt id=\"p1\">[</bpt>OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO<ept id=\"p1\">](http://msdn.microsoft.com/library/abdc093c-6502-42de-8419-b7ebf45299d1)</ept> macro.","pos":[4293,4526],"source":"These functions are useful for creating objects that you have prevented from being externally creatable by using the [OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO](http://msdn.microsoft.com/library/abdc093c-6502-42de-8419-b7ebf45299d1) macro."},{"content":"They are also useful in situations where you want to avoid the COM API for reasons of efficiency.","pos":[4527,4624]},{"pos":[4631,4777],"content":"Note that the interface <ph id=\"ph1\">`Q`</ph> must have an IID associated with it that can be retrieved using the <bpt id=\"p1\">[</bpt>__uuidof<ept id=\"p1\">](../../cpp/uuidof-operator.md)</ept> operator.","source":"Note that the interface `Q` must have an IID associated with it that can be retrieved using the [__uuidof](../../cpp/uuidof-operator.md) operator."},{"content":"Example","pos":[4787,4794]},{"content":"In the following example, <ph id=\"ph1\">`CDocument`</ph> is a wizard-generated ATL class derived from <ph id=\"ph2\">`CComCoClass`</ph> that implements the <bpt id=\"p1\">**</bpt>IDocument<ept id=\"p1\">**</ept> interface.","pos":[4798,4939],"source":"In the following example, `CDocument` is a wizard-generated ATL class derived from `CComCoClass` that implements the **IDocument** interface."},{"content":"The class is registered in the object map with the <ph id=\"ph1\">`OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO`</ph> macro so clients can't create instances of the document using <bpt id=\"p1\">[</bpt>CoCreateInstance<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms686615)</ept>.","pos":[4940,5170],"source":" The class is registered in the object map with the `OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO` macro so clients can't create instances of the document using [CoCreateInstance](http://msdn.microsoft.com/library/windows/desktop/ms686615)."},{"content":"is a CoClass that provides a method on one of its own COM interfaces to create instances of the document class.","pos":[5186,5297]},{"content":"The code below shows how easy it to create instances of the document class using the <ph id=\"ph1\">`CreateInstance`</ph> member inherited from the <ph id=\"ph2\">`CComCoClass`</ph> base class.","pos":[5298,5451],"source":" The code below shows how easy it to create instances of the document class using the `CreateInstance` member inherited from the `CComCoClass` base class."},{"pos":[5469,5483],"content":"NVC_ATL_COM#11"},{"pos":[5581,5599],"content":"CComCoClass::Error"},{"pos":[5603,5702],"content":"This static function sets up the <ph id=\"ph1\">`IErrorInfo`</ph> interface to provide error information to the client.","source":"This static function sets up the `IErrorInfo` interface to provide error information to the client."},{"content":"Parameters","pos":[6627,6637]},{"content":"[in] The string describing the error.","pos":[6655,6692]},{"content":"The Unicode version of <ph id=\"ph1\">`Error`</ph> specifies that <ph id=\"ph2\">`lpszDesc`</ph> is of type <bpt id=\"p1\">**</bpt>LPCOLESTR<ept id=\"p1\">**</ept>; the ANSI version specifies a type of <ph id=\"ph3\">`LPCSTR`</ph>.","pos":[6693,6822],"source":" The Unicode version of `Error` specifies that `lpszDesc` is of type **LPCOLESTR**; the ANSI version specifies a type of `LPCSTR`."},{"content":"[in] The IID of the interface defining the error or <ph id=\"ph1\">`GUID_NULL`</ph> (the default value) if the error is defined by the operating system.","pos":[6838,6970],"source":" [in] The IID of the interface defining the error or `GUID_NULL` (the default value) if the error is defined by the operating system."},{"content":"[in] The <ph id=\"ph1\">`HRESULT`</ph> you want returned to the caller.","pos":[6987,7038],"source":" [in] The `HRESULT` you want returned to the caller."},{"content":"The default value is 0.","pos":[7039,7062]},{"content":"For more details about <ph id=\"ph1\">`hRes`</ph>, see Remarks.","pos":[7063,7106],"source":" For more details about `hRes`, see Remarks."},{"content":"[in] The resource identifier where the error description string is stored.","pos":[7122,7196]},{"content":"This value should lie between 0x0200 and 0xFFFF, inclusively.","pos":[7197,7258]},{"content":"In debug builds, an <bpt id=\"p1\">**</bpt>ASSERT<ept id=\"p1\">**</ept> will result if <ph id=\"ph1\">`nID`</ph> does not index a valid string.","pos":[7259,7341],"source":" In debug builds, an **ASSERT** will result if `nID` does not index a valid string."},{"content":"In release builds, the error description string will be set to \"Unknown Error.\"","pos":[7342,7421]},{"content":"[in] The help context identifier for the error.","pos":[7442,7489]},{"content":"[in] The path and name of the help file describing the error.","pos":[7514,7575]},{"content":"[in] The handle to the resource.","pos":[7593,7625]},{"content":"By default, this parameter is <bpt id=\"p1\">**</bpt>_AtlModule::GetResourceInstance<ept id=\"p1\">**</ept>, where <bpt id=\"p2\">**</bpt>_AtlModule<ept id=\"p2\">**</ept> is the global instance of <bpt id=\"p3\">[</bpt>CAtlModule<ept id=\"p3\">](../../atl/reference/catlmodule-class.md)</ept>.","pos":[7626,7794],"source":" By default, this parameter is **_AtlModule::GetResourceInstance**, where **_AtlModule** is the global instance of [CAtlModule](../../atl/reference/catlmodule-class.md)."},{"content":"Return Value","pos":[7804,7816]},{"content":"A standard <ph id=\"ph1\">`HRESULT`</ph> value.","pos":[7820,7847],"source":"A standard `HRESULT` value."},{"content":"For details, see Remarks.","pos":[7848,7873]},{"content":"Remarks","pos":[7883,7890]},{"pos":[7894,7982],"content":"To call <ph id=\"ph1\">`Error`</ph>, your object must implement the <ph id=\"ph2\">`ISupportErrorInfo Interface`</ph> interface.","source":"To call `Error`, your object must implement the `ISupportErrorInfo Interface` interface."},{"content":"If the <ph id=\"ph1\">`hRes`</ph> parameter is nonzero, then <ph id=\"ph2\">`Error`</ph> returns the value of <ph id=\"ph3\">`hRes`</ph>.","pos":[7989,8066],"source":"If the `hRes` parameter is nonzero, then `Error` returns the value of `hRes`."},{"content":"If <ph id=\"ph1\">`hRes`</ph> is zero, then the first four versions of <ph id=\"ph2\">`Error`</ph> return <ph id=\"ph3\">`DISP_E_EXCEPTION`</ph>.","pos":[8067,8152],"source":" If `hRes` is zero, then the first four versions of `Error` return `DISP_E_EXCEPTION`."},{"content":"The last two versions return the result of the macro <bpt id=\"p1\">**</bpt>MAKE_HRESULT( 1, FACILITY_ITF,<ept id=\"p1\">**</ept> <ph id=\"ph1\">`nID`</ph> <bpt id=\"p2\">**</bpt>)<ept id=\"p2\">**</ept>.","pos":[8153,8253],"source":" The last two versions return the result of the macro **MAKE_HRESULT( 1, FACILITY_ITF,** `nID` **)**."},{"pos":[8307,8334],"content":"CComCoClass::GetObjectCLSID"},{"content":"Provides a consistent way of retrieving the object's CLSID.","pos":[8338,8397]},{"content":"Return Value","pos":[8465,8477]},{"content":"The object's class identifier.","pos":[8481,8511]},{"pos":[8571,8604],"content":"CComCoClass::GetObjectDescription"},{"content":"This static function retrieves the text description for your class object.","pos":[8608,8682]},{"content":"Return Value","pos":[8751,8763]},{"content":"The class object's description.","pos":[8767,8798]},{"content":"Remarks","pos":[8808,8815]},{"content":"The default implementation returns <bpt id=\"p1\">**</bpt>NULL<ept id=\"p1\">**</ept>.","pos":[8819,8863],"source":"The default implementation returns **NULL**."},{"content":"You can override this method with the <bpt id=\"p1\">[</bpt>DECLARE_OBJECT_DESCRIPTION<ept id=\"p1\">](http://msdn.microsoft.com/library/32ac881c-97b1-44e2-a017-0e23eb99ac93)</ept> macro.","pos":[8864,9009],"source":" You can override this method with the [DECLARE_OBJECT_DESCRIPTION](http://msdn.microsoft.com/library/32ac881c-97b1-44e2-a017-0e23eb99ac93) macro."},{"content":"For example:","pos":[9010,9022]},{"pos":[9040,9054],"content":"NVC_ATL_COM#12"},{"content":"is called by <bpt id=\"p1\">**</bpt>IComponentRegistrar::GetComponents<ept id=\"p1\">**</ept>.","pos":[9135,9187],"source":" is called by **IComponentRegistrar::GetComponents**."},{"content":"<bpt id=\"p1\">**</bpt>IComponentRegistrar<ept id=\"p1\">**</ept> is an Automation interface that allows you to register and unregister individual components in a DLL.","pos":[9188,9313],"source":"**IComponentRegistrar** is an Automation interface that allows you to register and unregister individual components in a DLL."},{"content":"When you create a Component Registrar object with the ATL Project Wizard, the wizard will automatically implement the <bpt id=\"p1\">**</bpt>IComponentRegistrar<ept id=\"p1\">**</ept> interface.","pos":[9314,9466],"source":" When you create a Component Registrar object with the ATL Project Wizard, the wizard will automatically implement the **IComponentRegistrar** interface."},{"content":"<bpt id=\"p1\">**</bpt>IComponentRegistrar<ept id=\"p1\">**</ept> is typically used by Microsoft Transaction Server.","pos":[9467,9541],"source":"**IComponentRegistrar** is typically used by Microsoft Transaction Server."},{"pos":[9548,9689],"content":"For more information about the ATL Project Wizard, see the article <bpt id=\"p1\">[</bpt>Creating an ATL Project<ept id=\"p1\">](../../atl/reference/creating-an-atl-project.md)</ept>.","source":"For more information about the ATL Project Wizard, see the article [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md)."},{"content":"See Also","pos":[9698,9706]},{"content":"Class Overview","pos":[9711,9725]}],"content":"---\ntitle: \"CComCoClass Class | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"reference\"\nf1_keywords: \n  - \"CComCoClass\"\n  - \"ATL.CComCoClass\"\n  - \"ATL::CComCoClass\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CComCoClass class\"\n  - \"aggregation [C++], aggregation models\"\nms.assetid: 67cfefa4-8df9-47fa-ad58-2d1a1ae25762\ncaps.latest.revision: 19\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# CComCoClass Class\nThis class provides methods for creating instances of a class, and obtaining its properties.  \n  \n## Syntax  \n  \n```\ntemplate <class   T,\n    const CLSID* pclsid = &CLSID_NULL>\n    class CComCoClass\n```  \n  \n#### Parameters  \n `T`  \n Your class, derived from `CComCoClass`.  \n  \n *pclsid*  \n A pointer to the CLSID of the object.  \n  \n## Members  \n  \n### Public Methods  \n  \n|Name|Description|  \n|----------|-----------------|  \n|[CComCoClass::CreateInstance](#ccomcoclass__createinstance)|(Static) Creates an instance of the class and queries for an interface.|  \n|[CComCoClass::Error](#ccomcoclass__error)|(Static) Returns rich error information to the client.|  \n|[CComCoClass::GetObjectCLSID](#ccomcoclass__getobjectclsid)|(Static) Returns the object's class identifier.|  \n|[CComCoClass::GetObjectDescription](#ccomcoclass__getobjectdescription)|(Static) Override to return the object's description.|  \n  \n## Remarks  \n `CComCoClass` provides methods for retrieving an object's CLSID, setting error information, and creating instances of the class. Any class registered in the [object map](http://msdn.microsoft.com/en-us/b57619cc-534f-4b8f-bfd4-0c12f937202f) should be derived from `CComCoClass`.  \n  \n `CComCoClass` also defines the default class factory and aggregation model for your object. `CComCoClass` uses the following two macros:  \n  \n- [DECLARE_CLASSFACTORY](http://msdn.microsoft.com/library/51a6b925-07c0-4d3a-9174-0b8c808975e4) Declares the class factory to be [CComClassFactory](../../atl/reference/ccomclassfactory-class.md).  \n  \n- [DECLARE_AGGREGATABLE](http://msdn.microsoft.com/library/e7e568d7-04e0-4226-b5dc-224deed229ab) Declares that your object can be aggregated.  \n  \n You can override either of these defaults by specifying another macro in your class definition. For example, to use [CComClassFactory2](../../atl/reference/ccomclassfactory2-class.md) instead of `CComClassFactory`, specify the [DECLARE_CLASSFACTORY2](http://msdn.microsoft.com/library/38a6c969-7297-4bb1-9ba6-1fe2d355b285) macro:  \n  \n [!code-cpp[NVC_ATL_COM#2](../../atl/codesnippet/cpp/ccomcoclass-class_1.h)]  \n  \n## Requirements  \n **Header:** atlcom.h  \n  \n##  <a name=\"ccomcoclass__createinstance\"></a>  CComCoClass::CreateInstance  \n Use these `CreateInstance` functions to create an instance of a COM object and retrieve an interface pointer without using the COM API.  \n  \n```\ntemplate <class  Q>\n    static HRESULT CreateInstance(\n    Q** pp);\n\n    template <class  Q>\n    static HRESULT CreateInstance(\n    IUnknown* punkOuter,\n    Q** pp);\n```  \n  \n### Parameters  \n `Q`  \n The COM interface that should be returned via `pp`.  \n  \n *punkOuter*  \n [in] The outer unknown or controlling unknown of the aggregate.  \n  \n `pp`  \n [out] The address of a pointer variable that receives the requested interface pointer if creation succeeds.  \n  \n### Return Value  \n A standard `HRESULT` value. See [CoCreateInstance](http://msdn.microsoft.com/library/windows/desktop/ms686615) in the [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)] for a description of possible return values.  \n  \n### Remarks  \n Use the first overload of this function for typical object creation; use the second overload when you need to aggregate the object being created.  \n  \n The ATL class implementing the required COM object (that is, the class used as the first template parameter to [CComCoClass](../../atl/reference/ccomcoclass-class.md)) must be in the same project as the calling code. The creation of the COM object is carried out by the class factory registered for this ATL class.  \n  \n These functions are useful for creating objects that you have prevented from being externally creatable by using the [OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO](http://msdn.microsoft.com/library/abdc093c-6502-42de-8419-b7ebf45299d1) macro. They are also useful in situations where you want to avoid the COM API for reasons of efficiency.  \n  \n Note that the interface `Q` must have an IID associated with it that can be retrieved using the [__uuidof](../../cpp/uuidof-operator.md) operator.  \n  \n### Example  \n In the following example, `CDocument` is a wizard-generated ATL class derived from `CComCoClass` that implements the **IDocument** interface. The class is registered in the object map with the `OBJECT_ENTRY_NON_CREATEABLE_EX_AUTO` macro so clients can't create instances of the document using [CoCreateInstance](http://msdn.microsoft.com/library/windows/desktop/ms686615). `CApplication` is a CoClass that provides a method on one of its own COM interfaces to create instances of the document class. The code below shows how easy it to create instances of the document class using the `CreateInstance` member inherited from the `CComCoClass` base class.  \n  \n [!code-cpp[NVC_ATL_COM#11](../../atl/codesnippet/cpp/ccomcoclass-class_2.cpp)]  \n  \n##  <a name=\"ccomcoclass__error\"></a>  CComCoClass::Error  \n This static function sets up the `IErrorInfo` interface to provide error information to the client.  \n  \n```\nstatic HRESULT WINAPI Error(\n    LPCOLESTR lpszDesc,\n    const IID& iid = GUID_NULL,\n    HRESULT hRes = 0);\n\n    static HRESULT WINAPI Error(\n    LPCOLESTR lpszDesc,\n    DWORD dwHelpID,\n    LPCOLESTR lpszHelpFile,\n    const IID& iid = GUID_NULL,\n    HRESULT hRes = 0);\n\n    static HRESULT WINAPI Error(\n    LPCSTR lpszDesc,\n    const IID& iid = GUID_NULL,\n    HRESULT hRes = 0);\n\n    static HRESULT WINAPI Error(\n    LPCSTR lpszDesc,\n    DWORD dwHelpID,\n    LPCSTR lpszHelpFile,\n    const IID& iid = GUID_NULL,\n    HRESULT hRes = 0);\n\n    static HRESULT WINAPI Error(\n    UINT nID,\n    const IID& iid = GUID_NULL,\n    HRESULT hRes = 0,\n    HINSTANCE hInst = _AtlBaseModule.GetResourceInstance ());\n\n    static HRESULT Error(\n    UINT nID,\n    DWORD dwHelpID,\n    LPCOLESTR lpszHelpFile,\n    const IID& iid = GUID_NULL,\n    HRESULT hRes = 0,\n    HINSTANCE hInst = _AtlBaseModule.GetResourceInstance());\n```  \n  \n### Parameters  \n `lpszDesc`  \n [in] The string describing the error. The Unicode version of `Error` specifies that `lpszDesc` is of type **LPCOLESTR**; the ANSI version specifies a type of `LPCSTR`.  \n  \n `iid`  \n [in] The IID of the interface defining the error or `GUID_NULL` (the default value) if the error is defined by the operating system.  \n  \n `hRes`  \n [in] The `HRESULT` you want returned to the caller. The default value is 0. For more details about `hRes`, see Remarks.  \n  \n `nID`  \n [in] The resource identifier where the error description string is stored. This value should lie between 0x0200 and 0xFFFF, inclusively. In debug builds, an **ASSERT** will result if `nID` does not index a valid string. In release builds, the error description string will be set to \"Unknown Error.\"  \n  \n `dwHelpID`  \n [in] The help context identifier for the error.  \n  \n `lpszHelpFile`  \n [in] The path and name of the help file describing the error.  \n  \n `hInst`  \n [in] The handle to the resource. By default, this parameter is **_AtlModule::GetResourceInstance**, where **_AtlModule** is the global instance of [CAtlModule](../../atl/reference/catlmodule-class.md).  \n  \n### Return Value  \n A standard `HRESULT` value. For details, see Remarks.  \n  \n### Remarks  \n To call `Error`, your object must implement the `ISupportErrorInfo Interface` interface.  \n  \n If the `hRes` parameter is nonzero, then `Error` returns the value of `hRes`. If `hRes` is zero, then the first four versions of `Error` return `DISP_E_EXCEPTION`. The last two versions return the result of the macro **MAKE_HRESULT( 1, FACILITY_ITF,** `nID` **)**.  \n  \n##  <a name=\"ccomcoclass__getobjectclsid\"></a>  CComCoClass::GetObjectCLSID  \n Provides a consistent way of retrieving the object's CLSID.  \n  \n```\nstatic const CLSID& WINAPI GetObjectCLSID();\n```  \n  \n### Return Value  \n The object's class identifier.  \n  \n##  <a name=\"ccomcoclass__getobjectdescription\"></a>  CComCoClass::GetObjectDescription  \n This static function retrieves the text description for your class object.  \n  \n```\nstatic LPCTSTR WINAPI GetObjectDescription();\n```  \n  \n### Return Value  \n The class object's description.  \n  \n### Remarks  \n The default implementation returns **NULL**. You can override this method with the [DECLARE_OBJECT_DESCRIPTION](http://msdn.microsoft.com/library/32ac881c-97b1-44e2-a017-0e23eb99ac93) macro. For example:  \n  \n [!code-cpp[NVC_ATL_COM#12](../../atl/codesnippet/cpp/ccomcoclass-class_3.h)]  \n  \n `GetObjectDescription` is called by **IComponentRegistrar::GetComponents**. **IComponentRegistrar** is an Automation interface that allows you to register and unregister individual components in a DLL. When you create a Component Registrar object with the ATL Project Wizard, the wizard will automatically implement the **IComponentRegistrar** interface. **IComponentRegistrar** is typically used by Microsoft Transaction Server.  \n  \n For more information about the ATL Project Wizard, see the article [Creating an ATL Project](../../atl/reference/creating-an-atl-project.md).  \n  \n## See Also  \n [Class Overview](../../atl/atl-class-overview.md)\n"}