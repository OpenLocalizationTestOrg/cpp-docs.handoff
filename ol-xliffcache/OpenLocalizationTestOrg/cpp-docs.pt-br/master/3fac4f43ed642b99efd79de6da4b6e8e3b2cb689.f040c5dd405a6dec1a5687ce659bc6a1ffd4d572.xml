{"nodes":[{"pos":[12,96],"content":"ActiveX Control Containers: Handling Events from an ActiveX Control | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"ActiveX Control Containers: Handling Events from an ActiveX Control | Microsoft Docs","pos":[0,84]}]},{"content":"ActiveX Control Containers: Handling Events from an ActiveX Control","pos":[904,971]},{"content":"This article discusses using the Properties window to install event handlers for ActiveX controls in an ActiveX control container.","pos":[972,1102]},{"content":"The event handlers are used to receive notifications (from the control) of certain events and perform some action in response.","pos":[1103,1229]},{"content":"This notification is called \"firing\" the event.","pos":[1230,1277]},{"pos":[1285,1453],"content":"[!NOTE]\n This article uses a dialog-based ActiveX control container project named Container and an embedded control named Circ as examples in the procedures and code.","leadings":["","> "],"nodes":[{"content":"This article uses a dialog-based ActiveX control container project named Container and an embedded control named Circ as examples in the procedures and code.","pos":[9,166]}]},{"content":"Using the Events button in the Properties window, you can create a map of events that can occur in your ActiveX control container application.","pos":[1460,1602]},{"content":"This map, called an \"event sink map,'' is created and maintained by Visual C++ when you add event handlers to the control container class.","pos":[1603,1741]},{"content":"Each event handler, implemented with an event map entry, maps a specific event to a container event handler member function.","pos":[1742,1866]},{"content":"This event handler function is called when the specified event is fired by the ActiveX control object.","pos":[1867,1969]},{"pos":[1976,2109],"content":"For more information on event sink maps, see <bpt id=\"p1\">[</bpt>Event Sink Maps<ept id=\"p1\">](../mfc/reference/event-sink-maps.md)</ept> in the <bpt id=\"p2\">*</bpt>Class Library Reference<ept id=\"p2\">*</ept>.","source":"For more information on event sink maps, see [Event Sink Maps](../mfc/reference/event-sink-maps.md) in the *Class Library Reference*."},{"pos":[2183,2225],"content":"Event Handler Modifications to the Project"},{"content":"When you use the Properties window to add event handlers, an event sink map is declared and defined in your project.","pos":[2229,2345]},{"content":"The following statements are added to the control .CPP file the first time an event handler is added.","pos":[2346,2447]},{"content":"This code declares an event sink map for the dialog box class (in this case, <ph id=\"ph1\">`CContainerDlg`</ph>):","pos":[2448,2542],"source":" This code declares an event sink map for the dialog box class (in this case, `CContainerDlg`):"},{"content":"NVC_MFC_AxCont#8","pos":[2560,2576]},{"content":"NVC_MFC_AxCont#9","pos":[2689,2705]},{"pos":[2811,3007],"content":"As you use the Properties window to add events, an event map entry (<ph id=\"ph1\">`ON_EVENT`</ph>) is added to the event sink map and an event handler function is added to the container's implementation (.CPP) file.","source":"As you use the Properties window to add events, an event map entry (`ON_EVENT`) is added to the event sink map and an event handler function is added to the container's implementation (.CPP) file."},{"pos":[3014,3132],"content":"The following example declares an event handler, called <ph id=\"ph1\">`OnClickInCircCtrl`</ph>, for the Circ control's <bpt id=\"p1\">**</bpt>ClickIn<ept id=\"p1\">**</ept> event:","source":"The following example declares an event handler, called `OnClickInCircCtrl`, for the Circ control's **ClickIn** event:"},{"pos":[3150,3167],"content":"NVC_MFC_AxCont#10"},{"pos":[3273,3412],"content":"In addition, the following template is added to the <ph id=\"ph1\">`CContainerDlg`</ph> class implementation (.CPP) file for the event handler member function:","source":"In addition, the following template is added to the `CContainerDlg` class implementation (.CPP) file for the event handler member function:"},{"pos":[3430,3447],"content":"NVC_MFC_AxCont#11"},{"pos":[3553,3688],"content":"For more information on event sink macros, see <bpt id=\"p1\">[</bpt>Event Sink Maps<ept id=\"p1\">](../mfc/reference/event-sink-maps.md)</ept> in the <bpt id=\"p2\">*</bpt>Class Library Reference<ept id=\"p2\">*</ept>.","source":"For more information on event sink macros, see [Event Sink Maps](../mfc/reference/event-sink-maps.md) in the *Class Library Reference*."},{"content":"To create an event handler function","pos":[3699,3734]},{"content":"From Class View, select the dialog class that contains the ActiveX control.","pos":[3744,3819]},{"content":"For this example, use <ph id=\"ph1\">`CContainerDlg`</ph>.","pos":[3820,3858],"source":" For this example, use `CContainerDlg`."},{"pos":[3868,3922],"content":"In the Properties window, click the <bpt id=\"p1\">**</bpt>Events<ept id=\"p1\">**</ept> button.","source":"In the Properties window, click the **Events** button."},{"content":"In the Properties window, select the control ID of the embedded ActiveX control.","pos":[3932,4012]},{"content":"For this example, use <ph id=\"ph1\">`IDC_CIRCCTRL1`</ph>.","pos":[4013,4051],"source":" For this example, use `IDC_CIRCCTRL1`."},{"content":"The Properties window displays a list of events that can be fired by the embedded ActiveX control.","pos":[4062,4160]},{"content":"Any member function shown in bold already has handler functions assigned to it.","pos":[4161,4240]},{"content":"Select the event you want the dialog class to handle.","pos":[4250,4303]},{"content":"For this example, select <bpt id=\"p1\">**</bpt>Click<ept id=\"p1\">**</ept>.","pos":[4304,4339],"source":" For this example, select **Click**."},{"pos":[4349,4424],"content":"From the drop-down list box on the right, select <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\&lt;</ph>Add&gt; ClickCircctrl1<ept id=\"p1\">**</ept>.","source":"From the drop-down list box on the right, select **\\<Add> ClickCircctrl1**."},{"pos":[4434,4575],"content":"Double-click the new handler function from Class View to jump to the event handler code in the implementation (.CPP) file of <ph id=\"ph1\">`CContainerDlg`</ph>.","source":"Double-click the new handler function from Class View to jump to the event handler code in the implementation (.CPP) file of `CContainerDlg`."},{"content":"See Also","pos":[4584,4592]},{"content":"ActiveX Control Containers","pos":[4597,4623]}],"content":"---\ntitle: \"ActiveX Control Containers: Handling Events from an ActiveX Control | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"event handlers [C++], ActiveX controls\"\n  - \"ActiveX control containers [C++], event sinks\"\n  - \"event handling [C++], ActiveX controls\"\n  - \"ON_EVENT macro\"\n  - \"ActiveX controls [C++], events\"\n  - \"END_EVENTSINK_MAP macro, using\"\n  - \"events [C++], ActiveX controls\"\n  - \"BEGIN_EVENTSINK_MAP macro\"\nms.assetid: f9c106db-052f-4e32-82ad-750646aa760b\ncaps.latest.revision: 9\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# ActiveX Control Containers: Handling Events from an ActiveX Control\nThis article discusses using the Properties window to install event handlers for ActiveX controls in an ActiveX control container. The event handlers are used to receive notifications (from the control) of certain events and perform some action in response. This notification is called \"firing\" the event.  \n  \n> [!NOTE]\n>  This article uses a dialog-based ActiveX control container project named Container and an embedded control named Circ as examples in the procedures and code.  \n  \n Using the Events button in the Properties window, you can create a map of events that can occur in your ActiveX control container application. This map, called an \"event sink map,'' is created and maintained by Visual C++ when you add event handlers to the control container class. Each event handler, implemented with an event map entry, maps a specific event to a container event handler member function. This event handler function is called when the specified event is fired by the ActiveX control object.  \n  \n For more information on event sink maps, see [Event Sink Maps](../mfc/reference/event-sink-maps.md) in the *Class Library Reference*.  \n  \n##  <a name=\"_core_event_handler_modifications_to_the_project\"></a> Event Handler Modifications to the Project  \n When you use the Properties window to add event handlers, an event sink map is declared and defined in your project. The following statements are added to the control .CPP file the first time an event handler is added. This code declares an event sink map for the dialog box class (in this case, `CContainerDlg`):  \n  \n [!code-cpp[NVC_MFC_AxCont#8](../mfc/codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_1.cpp)]  \n[!code-cpp[NVC_MFC_AxCont#9](../mfc/codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_2.cpp)]  \n  \n As you use the Properties window to add events, an event map entry (`ON_EVENT`) is added to the event sink map and an event handler function is added to the container's implementation (.CPP) file.  \n  \n The following example declares an event handler, called `OnClickInCircCtrl`, for the Circ control's **ClickIn** event:  \n  \n [!code-cpp[NVC_MFC_AxCont#10](../mfc/codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_3.cpp)]  \n  \n In addition, the following template is added to the `CContainerDlg` class implementation (.CPP) file for the event handler member function:  \n  \n [!code-cpp[NVC_MFC_AxCont#11](../mfc/codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_4.cpp)]  \n  \n For more information on event sink macros, see [Event Sink Maps](../mfc/reference/event-sink-maps.md) in the *Class Library Reference*.  \n  \n#### To create an event handler function  \n  \n1.  From Class View, select the dialog class that contains the ActiveX control. For this example, use `CContainerDlg`.  \n  \n2.  In the Properties window, click the **Events** button.  \n  \n3.  In the Properties window, select the control ID of the embedded ActiveX control. For this example, use `IDC_CIRCCTRL1`.  \n  \n     The Properties window displays a list of events that can be fired by the embedded ActiveX control. Any member function shown in bold already has handler functions assigned to it.  \n  \n4.  Select the event you want the dialog class to handle. For this example, select **Click**.  \n  \n5.  From the drop-down list box on the right, select **\\<Add> ClickCircctrl1**.  \n  \n6.  Double-click the new handler function from Class View to jump to the event handler code in the implementation (.CPP) file of `CContainerDlg`.  \n  \n## See Also  \n [ActiveX Control Containers](../mfc/activex-control-containers.md)\n\n"}