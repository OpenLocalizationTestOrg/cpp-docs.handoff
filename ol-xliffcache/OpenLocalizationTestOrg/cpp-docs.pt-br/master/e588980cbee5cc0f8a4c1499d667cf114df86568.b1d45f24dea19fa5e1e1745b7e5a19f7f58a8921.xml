{"nodes":[{"pos":[12,60],"content":"Security Best Practices for C++ | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Security Best Practices for C++ | Microsoft Docs","pos":[0,48]}]},{"content":"Security Best Practices for C++","pos":[689,720]},{"content":"This article contains information about security tools and practices.","pos":[721,790]},{"content":"Using them does not make applications immune from attack, but it makes successful attacks less likely.","pos":[791,893]},{"content":"Visual C++ Security Features","pos":[902,930]},{"content":"These security features are built into the Visual C++ compiler and linker:","pos":[934,1008]},{"content":"/guard (Enable Control Flow Guard)","pos":[1016,1050]},{"content":"Causes the compiler to to analyze control flow for indirect call targets at compile time, and then to insert code to verify the targets at runtime.","pos":[1110,1257]},{"content":"/GS (Buffer Security Check)","pos":[1265,1292]},{"content":"Instructs the compiler to insert overrun detection code into functions that are at risk of being exploited.","pos":[1345,1452]},{"content":"When an overrun is detected, execution is stopped.","pos":[1453,1503]},{"content":"By default, this option is on.","pos":[1504,1534]},{"content":"/SAFESEH (Image has Safe Exception Handlers)","pos":[1542,1586]},{"content":"Instructs the linker to include in the output image a table that contains the address of each exception handler.","pos":[1656,1768]},{"content":"At run time, the operating system uses this table to make sure that only legitimate exception handlers are executed.","pos":[1769,1885]},{"content":"This helps prevent the execution of exception handlers that are introduced by a malicious attack at run time.","pos":[1886,1995]},{"content":"By default, this option is off.","pos":[1996,2027]},{"content":"<bpt id=\"p1\">[</bpt>/NXCOMPAT<ept id=\"p1\">](../build/reference/nxcompat.md)</ept>, <bpt id=\"p2\">[</bpt>/NXCOMPAT (Compatible with Data Execution Prevention)<ept id=\"p2\">](../build/reference/nxcompat-compatible-with-data-execution-prevention.md)</ept>","pos":[2034,2208],"source":"[/NXCOMPAT](../build/reference/nxcompat.md), [/NXCOMPAT (Compatible with Data Execution Prevention)](../build/reference/nxcompat-compatible-with-data-execution-prevention.md)"},{"content":"These compiler and linker options enable Data Execution Prevention (DEP) compatibility.","pos":[2212,2299]},{"content":"DEP guards the CPU against the execution of non-code pages.","pos":[2300,2359]},{"content":"/analyze (Code Analysis)","pos":[2367,2391]},{"content":"This compiler option activates code analysis that reports potential security issues such as buffer overrun, un-initialized memory, null pointer dereferencing, and memory leaks.","pos":[2441,2617]},{"content":"By default, this option is off.","pos":[2618,2649]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Code Analysis for C/C++ Overview<ept id=\"p1\">](/visualstudio/code-quality/code-analysis-for-c-cpp-overview)</ept>.","pos":[2650,2772],"source":" For more information, see [Code Analysis for C/C++ Overview](/visualstudio/code-quality/code-analysis-for-c-cpp-overview)."},{"content":"/DYNAMICBASE (Use address space layout randomization)","pos":[2780,2833]},{"content":"This linker option enables the building of an executable image that can be loaded at different locations in memory at the beginning of execution.","pos":[2912,3057]},{"content":"This option also makes the stack location in memory much less predictable.","pos":[3058,3132]},{"content":"Security-Enhanced CRT","pos":[3141,3162]},{"content":"The C Runtime Library (CRT) has been augmented to include secure versions of functions that pose security risks—for example, the unchecked <ph id=\"ph1\">`strcpy`</ph> string copy function.","pos":[3166,3335],"source":"The C Runtime Library (CRT) has been augmented to include secure versions of functions that pose security risks—for example, the unchecked `strcpy` string copy function."},{"content":"Because the older, nonsecure versions of these functions are deprecated, they cause compile-time warnings.","pos":[3336,3442]},{"content":"We encourage you to use the secure versions of these CRT functions instead of suppressing the compilation warnings.","pos":[3443,3558]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Security Features in the CRT<ept id=\"p1\">](../c-runtime-library/security-features-in-the-crt.md)</ept>.","pos":[3559,3670],"source":" For more information, see [Security Features in the CRT](../c-runtime-library/security-features-in-the-crt.md)."},{"content":"SafeInt Library","pos":[3679,3694]},{"content":"<bpt id=\"p1\">[</bpt>SafeInt Library<ept id=\"p1\">](../windows/safeint-library.md)</ept> helps prevent integer overflows and other exploitable errors that might occur when the application performs mathematical operations.","pos":[3698,3879],"source":"[SafeInt Library](../windows/safeint-library.md) helps prevent integer overflows and other exploitable errors that might occur when the application performs mathematical operations."},{"content":"The <ph id=\"ph1\">`SafeInt`</ph> library includes the <bpt id=\"p1\">[</bpt>SafeInt Class<ept id=\"p1\">](../windows/safeint-class.md)</ept>, the <bpt id=\"p2\">[</bpt>SafeIntException Class<ept id=\"p2\">](../windows/safeintexception-class.md)</ept>, and several <bpt id=\"p3\">[</bpt>SafeInt Functions<ept id=\"p3\">](../windows/safeint-functions.md)</ept>.","pos":[3880,4094],"source":" The `SafeInt` library includes the [SafeInt Class](../windows/safeint-class.md), the [SafeIntException Class](../windows/safeintexception-class.md), and several [SafeInt Functions](../windows/safeint-functions.md)."},{"content":"The <ph id=\"ph1\">`SafeInt`</ph> class protects against integer overflow and divide-by-zero exploits.","pos":[4101,4183],"source":"The `SafeInt` class protects against integer overflow and divide-by-zero exploits."},{"content":"You can use it to handle comparisons between values of different types.","pos":[4184,4255]},{"content":"I provides two error handling policies.","pos":[4256,4295]},{"content":"The default policy is for the <ph id=\"ph1\">`SafeInt`</ph> class to throw a <ph id=\"ph2\">`SafeIntException`</ph> class exception to report why a mathematical operation cannot be completed.","pos":[4296,4447],"source":" The default policy is for the `SafeInt` class to throw a `SafeIntException` class exception to report why a mathematical operation cannot be completed."},{"content":"The second policy is for the <ph id=\"ph1\">`SafeInt`</ph> class to stop program execution.","pos":[4448,4519],"source":" The second policy is for the `SafeInt` class to stop program execution."},{"content":"You can also define a custom policy.","pos":[4520,4556]},{"content":"Each <ph id=\"ph1\">`SafeInt`</ph> function protects one mathematical operation from an exploitable error.","pos":[4563,4649],"source":"Each `SafeInt` function protects one mathematical operation from an exploitable error."},{"content":"You can use two different kinds of parameters without converting them to the same type.","pos":[4650,4737]},{"content":"To protect multiple mathematical operations, use the <ph id=\"ph1\">`SafeInt`</ph> class.","pos":[4738,4807],"source":" To protect multiple mathematical operations, use the `SafeInt` class."},{"content":"Checked Iterators","pos":[4816,4833]},{"content":"A checked iterator enforces container boundaries.","pos":[4837,4886]},{"content":"By default, when a checked iterator is out of bounds, it generates an exception and ends program execution.","pos":[4887,4994]},{"content":"A checked iterator provides other levels of response that depend on values that are assigned to preprocessor defines such as <bpt id=\"p1\">**</bpt>_SECURE_SCL_THROWS<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>_ITERATOR_DEBUG_LEVEL<ept id=\"p2\">**</ept>.","pos":[4995,5173],"source":" A checked iterator provides other levels of response that depend on values that are assigned to preprocessor defines such as **_SECURE_SCL_THROWS** and **_ITERATOR_DEBUG_LEVEL**."},{"content":"For example, at <bpt id=\"p1\">**</bpt>_ITERATOR_DEBUG_LEVEL=2<ept id=\"p1\">**</ept>, a checked iterator provides comprehensive correctness checks in debug mode, which are made available by using asserts.","pos":[5174,5337],"source":" For example, at **_ITERATOR_DEBUG_LEVEL=2**, a checked iterator provides comprehensive correctness checks in debug mode, which are made available by using asserts."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Checked Iterators<ept id=\"p1\">](../standard-library/checked-iterators.md)</ept>.","pos":[5338,5426],"source":" For more information, see [Checked Iterators](../standard-library/checked-iterators.md)."},{"content":"Code Analysis for Managed Code","pos":[5435,5465]},{"content":"Code Analysis for Managed Code, also known as FxCop, checks assemblies for conformance to the.NET Framework design guidelines.","pos":[5469,5595]},{"content":"FxCop analyzes the code and metadata in each assembly to check for defects in the following areas:","pos":[5596,5694]},{"content":"Library design","pos":[5704,5718]},{"content":"Localization","pos":[5728,5740]},{"content":"Naming conventions","pos":[5750,5768]},{"content":"Performance","pos":[5778,5789]},{"content":"Security","pos":[5799,5807]},{"content":"Windows Application Verifier","pos":[5816,5844]},{"content":"The Application Verifier (AppVerifier) can help you identify potential application compatibility, stability, and security issues.","pos":[5848,5977]},{"content":"The AppVerifier monitors how an application uses the operating system.","pos":[5984,6054]},{"content":"It watches the file system, registry, memory, and APIs while the application is running, and recommends source-code fixes for issues that it uncovers.","pos":[6055,6205]},{"content":"You can use the AppVerifier to:","pos":[6212,6243]},{"content":"Test for potential application compatibility errors that are caused by common programming mistakes.","pos":[6253,6352]},{"pos":[6362,6417],"content":"Examine an application for memory-related issues.  \ns","leadings":["","  "],"nodes":[{"content":"Examine an application for memory-related issues.","pos":[0,49]},{"content":"s","pos":[52,53]}]},{"content":"Identify potential security issues in an application.","pos":[6422,6475]},{"pos":[6482,6674],"content":"The AppVerifier is part of the Application Compatibility Toolkit, which is available from the <bpt id=\"p1\">[</bpt>Application Compatibility<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=91277)</ept> on the TechNet web site.","source":"The AppVerifier is part of the Application Compatibility Toolkit, which is available from the [Application Compatibility](http://go.microsoft.com/fwlink/?LinkId=91277) on the TechNet web site."},{"content":".NET Framework Security Features","pos":[6683,6715]},{"pos":[6719,6906],"content":"<bpt id=\"p1\">[</bpt>NIB: Configuring Security Policy<ept id=\"p1\">](http://msdn.microsoft.com/en-us/0f130bcd-1bba-4346-b231-0bcca7dab1a4)</ept> describes guidelines and tools for adjusting the .NET Framework security policies.","source":"[NIB: Configuring Security Policy](http://msdn.microsoft.com/en-us/0f130bcd-1bba-4346-b231-0bcca7dab1a4) describes guidelines and tools for adjusting the .NET Framework security policies."},{"content":"Windows User Accounts","pos":[6915,6936]},{"content":"Using Windows user accounts that belong to the Administrators group exposes developers and--by extension--customers to security risks.","pos":[6940,7074]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Running as a Member of the Users Group<ept id=\"p1\">](running-as-a-member-of-the-users-group.md)</ept> and <bpt id=\"p2\">[</bpt>How User Account Control (UAC) Affects Your Application<ept id=\"p2\">](how-user-account-control-uac-affects-your-application.md)</ept>.","pos":[7075,7305],"source":" For more information, see [Running as a Member of the Users Group](running-as-a-member-of-the-users-group.md) and [How User Account Control (UAC) Affects Your Application](how-user-account-control-uac-affects-your-application.md)."},{"content":"See Also","pos":[7314,7322]},{"content":"&lt;xref:System.Security&gt;","pos":[7326,7348],"source":"<xref:System.Security> "},{"content":"Security","pos":[7354,7362]},{"content":"How User Account Control (UAC) Affects Your Application","pos":[7441,7496]}],"content":"---\ntitle: \"Security Best Practices for C++ | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"securitybestpracticesVC\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"Visual C++, security\"\n  - \"security [C++]\"\n  - \"security [C++], best practices\"\nms.assetid: 86acaccf-cdb4-4517-bd58-553618e3ec42\ncaps.latest.revision: 45\nauthor: \"ghogen\"\nms.author: \"ghogen\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Security Best Practices for C++\nThis article contains information about security tools and practices. Using them does not make applications immune from attack, but it makes successful attacks less likely.  \n  \n## Visual C++ Security Features  \n These security features are built into the Visual C++ compiler and linker:  \n  \n [/guard (Enable Control Flow Guard)](../build/reference/guard-enable-control-flow-guard.md)  \n Causes the compiler to to analyze control flow for indirect call targets at compile time, and then to insert code to verify the targets at runtime.  \n  \n [/GS (Buffer Security Check)](../build/reference/gs-buffer-security-check.md)  \n Instructs the compiler to insert overrun detection code into functions that are at risk of being exploited. When an overrun is detected, execution is stopped. By default, this option is on.  \n  \n [/SAFESEH (Image has Safe Exception Handlers)](../build/reference/safeseh-image-has-safe-exception-handlers.md)  \n Instructs the linker to include in the output image a table that contains the address of each exception handler. At run time, the operating system uses this table to make sure that only legitimate exception handlers are executed. This helps prevent the execution of exception handlers that are introduced by a malicious attack at run time. By default, this option is off.  \n  \n [/NXCOMPAT](../build/reference/nxcompat.md), [/NXCOMPAT (Compatible with Data Execution Prevention)](../build/reference/nxcompat-compatible-with-data-execution-prevention.md)  \n These compiler and linker options enable Data Execution Prevention (DEP) compatibility. DEP guards the CPU against the execution of non-code pages.  \n  \n [/analyze (Code Analysis)](../build/reference/analyze-code-analysis.md)  \n This compiler option activates code analysis that reports potential security issues such as buffer overrun, un-initialized memory, null pointer dereferencing, and memory leaks. By default, this option is off. For more information, see [Code Analysis for C/C++ Overview](/visualstudio/code-quality/code-analysis-for-c-cpp-overview).  \n  \n [/DYNAMICBASE (Use address space layout randomization)](../build/reference/dynamicbase-use-address-space-layout-randomization.md)  \n This linker option enables the building of an executable image that can be loaded at different locations in memory at the beginning of execution. This option also makes the stack location in memory much less predictable.  \n  \n## Security-Enhanced CRT  \n The C Runtime Library (CRT) has been augmented to include secure versions of functions that pose security risks—for example, the unchecked `strcpy` string copy function. Because the older, nonsecure versions of these functions are deprecated, they cause compile-time warnings. We encourage you to use the secure versions of these CRT functions instead of suppressing the compilation warnings. For more information, see [Security Features in the CRT](../c-runtime-library/security-features-in-the-crt.md).  \n  \n## SafeInt Library  \n [SafeInt Library](../windows/safeint-library.md) helps prevent integer overflows and other exploitable errors that might occur when the application performs mathematical operations. The `SafeInt` library includes the [SafeInt Class](../windows/safeint-class.md), the [SafeIntException Class](../windows/safeintexception-class.md), and several [SafeInt Functions](../windows/safeint-functions.md).  \n  \n The `SafeInt` class protects against integer overflow and divide-by-zero exploits. You can use it to handle comparisons between values of different types. I provides two error handling policies. The default policy is for the `SafeInt` class to throw a `SafeIntException` class exception to report why a mathematical operation cannot be completed. The second policy is for the `SafeInt` class to stop program execution. You can also define a custom policy.  \n  \n Each `SafeInt` function protects one mathematical operation from an exploitable error. You can use two different kinds of parameters without converting them to the same type. To protect multiple mathematical operations, use the `SafeInt` class.  \n  \n## Checked Iterators  \n A checked iterator enforces container boundaries. By default, when a checked iterator is out of bounds, it generates an exception and ends program execution. A checked iterator provides other levels of response that depend on values that are assigned to preprocessor defines such as **_SECURE_SCL_THROWS** and **_ITERATOR_DEBUG_LEVEL**. For example, at **_ITERATOR_DEBUG_LEVEL=2**, a checked iterator provides comprehensive correctness checks in debug mode, which are made available by using asserts. For more information, see [Checked Iterators](../standard-library/checked-iterators.md).  \n  \n## Code Analysis for Managed Code  \n Code Analysis for Managed Code, also known as FxCop, checks assemblies for conformance to the.NET Framework design guidelines. FxCop analyzes the code and metadata in each assembly to check for defects in the following areas:  \n  \n-   Library design  \n  \n-   Localization  \n  \n-   Naming conventions  \n  \n-   Performance  \n  \n-   Security  \n  \n## Windows Application Verifier  \n The Application Verifier (AppVerifier) can help you identify potential application compatibility, stability, and security issues.  \n  \n The AppVerifier monitors how an application uses the operating system. It watches the file system, registry, memory, and APIs while the application is running, and recommends source-code fixes for issues that it uncovers.  \n  \n You can use the AppVerifier to:  \n  \n-   Test for potential application compatibility errors that are caused by common programming mistakes.  \n  \n-   Examine an application for memory-related issues.  \n  s\n-   Identify potential security issues in an application.  \n  \n The AppVerifier is part of the Application Compatibility Toolkit, which is available from the [Application Compatibility](http://go.microsoft.com/fwlink/?LinkId=91277) on the TechNet web site.  \n  \n## .NET Framework Security Features  \n [NIB: Configuring Security Policy](http://msdn.microsoft.com/en-us/0f130bcd-1bba-4346-b231-0bcca7dab1a4) describes guidelines and tools for adjusting the .NET Framework security policies.  \n  \n## Windows User Accounts  \n Using Windows user accounts that belong to the Administrators group exposes developers and--by extension--customers to security risks. For more information, see [Running as a Member of the Users Group](running-as-a-member-of-the-users-group.md) and [How User Account Control (UAC) Affects Your Application](how-user-account-control-uac-affects-your-application.md).  \n  \n## See Also  \n <xref:System.Security>   \n [Security](http://msdn.microsoft.com/Library/9a9621d7-8883-4a4f-a874-65e8e09e20a6)   \n [How User Account Control (UAC) Affects Your Application](how-user-account-control-uac-affects-your-application.md)"}