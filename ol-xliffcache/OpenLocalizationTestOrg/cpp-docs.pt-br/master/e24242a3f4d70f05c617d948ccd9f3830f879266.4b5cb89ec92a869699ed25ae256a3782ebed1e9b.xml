{"nodes":[{"pos":[12,53],"content":"Allocating GDI Resources | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Allocating GDI Resources | Microsoft Docs","pos":[0,41]}]},{"content":"Allocating GDI Resources","pos":[681,705]},{"content":"This article explains how to allocate and deallocate the Windows graphics device interface (GDI) objects needed for printing.","pos":[706,831]},{"pos":[839,1418],"content":"[!NOTE]\n GDI+ is included with Windows XP and is available as a redistributable for Windows NT 4.0  SP6, Windows 2000, Windows 98, and Windows Me. To download the latest redistributable, see  [http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm](http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm). For more information, see the GDI+ SDK documentation in MSDN: [http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/GDIPlus/GDIPlus.asp](http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/gdiplus/gdiplus.asp).","leadings":["","> "],"nodes":[{"content":" GDI+ is included with Windows XP and is available as a redistributable for Windows NT 4.0  SP6, Windows 2000, Windows 98, and Windows Me. To download the latest redistributable, see  [http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm](http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm). For more information, see the GDI+ SDK documentation in MSDN: [http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/GDIPlus/GDIPlus.asp](http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/gdiplus/gdiplus.asp).","pos":[8,577],"nodes":[{"content":"GDI+ is included with Windows XP and is available as a redistributable for Windows NT 4.0  SP6, Windows 2000, Windows 98, and Windows Me.","pos":[1,138]},{"content":"To download the latest redistributable, see  <bpt id=\"p1\">[</bpt>http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm<ept id=\"p1\">](http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm)</ept>.","pos":[139,333],"source":" To download the latest redistributable, see  [http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm](http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm)."},{"content":"For more information, see the GDI+ SDK documentation in MSDN: <bpt id=\"p1\">[</bpt>http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/GDIPlus/GDIPlus.asp<ept id=\"p1\">](http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/gdiplus/gdiplus.asp)</ept>.","pos":[334,569],"source":" For more information, see the GDI+ SDK documentation in MSDN: [http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/GDIPlus/GDIPlus.asp](http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/gdiplus/gdiplus.asp)."}]}]},{"content":"Suppose you need to use certain fonts, pens, or other GDI objects for printing, but not for screen display.","pos":[1425,1532]},{"content":"Because of the memory they require, it's inefficient to allocate these objects when the application starts up.","pos":[1533,1643]},{"content":"When the application isn't printing a document, that memory might be needed for other purposes.","pos":[1644,1739]},{"content":"It's better to allocate them when printing begins, and then delete them when printing ends.","pos":[1740,1831]},{"content":"To allocate these GDI objects, override the <bpt id=\"p1\">[</bpt>OnBeginPrinting<ept id=\"p1\">](../mfc/reference/cview-class.md#cview__onbeginprinting)</ept> member function.","pos":[1838,1972],"source":"To allocate these GDI objects, override the [OnBeginPrinting](../mfc/reference/cview-class.md#cview__onbeginprinting) member function."},{"content":"This function is well suited to this purpose for two reasons: the framework calls this function once at the beginning of each print job and, unlike <bpt id=\"p1\">[</bpt>OnPreparePrinting<ept id=\"p1\">](../mfc/reference/cview-class.md#cview__onprepareprinting)</ept>, this function has access to the <bpt id=\"p2\">[</bpt>CDC<ept id=\"p2\">](../mfc/reference/cdc-class.md)</ept> object representing the printer device driver.","pos":[1973,2315],"source":" This function is well suited to this purpose for two reasons: the framework calls this function once at the beginning of each print job and, unlike [OnPreparePrinting](../mfc/reference/cview-class.md#cview__onprepareprinting), this function has access to the [CDC](../mfc/reference/cdc-class.md) object representing the printer device driver."},{"content":"You can store these objects for use during the print job by defining member variables in your view class that point to GDI objects (for example, <bpt id=\"p1\">**</bpt>CFont <ph id=\"ph1\">\\*</ph><ept id=\"p1\">**</ept> members, and so on).","pos":[2316,2494],"source":" You can store these objects for use during the print job by defining member variables in your view class that point to GDI objects (for example, **CFont \\*** members, and so on)."},{"content":"To use the GDI objects you've created, select them into the printer device context in the <bpt id=\"p1\">[</bpt>OnPrint<ept id=\"p1\">](../mfc/reference/cview-class.md#cview__onprint)</ept> member function.","pos":[2501,2665],"source":"To use the GDI objects you've created, select them into the printer device context in the [OnPrint](../mfc/reference/cview-class.md#cview__onprint) member function."},{"content":"If you need different GDI objects for different pages of the document, you can examine the <ph id=\"ph1\">`m_nCurPage`</ph> member of the <bpt id=\"p1\">[</bpt>CPrintInfo<ept id=\"p1\">](../mfc/reference/cprintinfo-structure.md)</ept> structure and select the GDI object accordingly.","pos":[2666,2887],"source":" If you need different GDI objects for different pages of the document, you can examine the `m_nCurPage` member of the [CPrintInfo](../mfc/reference/cprintinfo-structure.md) structure and select the GDI object accordingly."},{"content":"If you need a GDI object for several consecutive pages, Windows requires that you select it into the device context each time <ph id=\"ph1\">`OnPrint`</ph> is called.","pos":[2888,3034],"source":" If you need a GDI object for several consecutive pages, Windows requires that you select it into the device context each time `OnPrint` is called."},{"content":"To deallocate these GDI objects, override the <bpt id=\"p1\">[</bpt>OnEndPrinting<ept id=\"p1\">](../mfc/reference/cview-class.md#cview__onendprinting)</ept> member function.","pos":[3041,3173],"source":"To deallocate these GDI objects, override the [OnEndPrinting](../mfc/reference/cview-class.md#cview__onendprinting) member function."},{"content":"The framework calls this function at the end of each print job, giving you the opportunity to deallocate printing-specific GDI objects before the application returns to other tasks.","pos":[3174,3355]},{"content":"See Also","pos":[3364,3372]},{"content":"Printing","pos":[3377,3385]},{"content":"How Default Printing Is Done","pos":[3412,3440]}],"content":"---\ntitle: \"Allocating GDI Resources | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"resources [MFC], printing\"\n  - \"GDI objects, allocating during printing\"\n  - \"printing [MFC], allocating GDI resources\"\nms.assetid: cef7e94d-5a27-4aea-a9ee-8369fc895d3a\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Allocating GDI Resources\nThis article explains how to allocate and deallocate the Windows graphics device interface (GDI) objects needed for printing.  \n  \n> [!NOTE]\n>  GDI+ is included with Windows XP and is available as a redistributable for Windows NT 4.0  SP6, Windows 2000, Windows 98, and Windows Me. To download the latest redistributable, see  [http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm](http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdkredist.htm). For more information, see the GDI+ SDK documentation in MSDN: [http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/GDIPlus/GDIPlus.asp](http://msdn.microsoft.com/library/default.aspurl=/library/gdicpp/gdiplus/gdiplus.asp).  \n  \n Suppose you need to use certain fonts, pens, or other GDI objects for printing, but not for screen display. Because of the memory they require, it's inefficient to allocate these objects when the application starts up. When the application isn't printing a document, that memory might be needed for other purposes. It's better to allocate them when printing begins, and then delete them when printing ends.  \n  \n To allocate these GDI objects, override the [OnBeginPrinting](../mfc/reference/cview-class.md#cview__onbeginprinting) member function. This function is well suited to this purpose for two reasons: the framework calls this function once at the beginning of each print job and, unlike [OnPreparePrinting](../mfc/reference/cview-class.md#cview__onprepareprinting), this function has access to the [CDC](../mfc/reference/cdc-class.md) object representing the printer device driver. You can store these objects for use during the print job by defining member variables in your view class that point to GDI objects (for example, **CFont \\*** members, and so on).  \n  \n To use the GDI objects you've created, select them into the printer device context in the [OnPrint](../mfc/reference/cview-class.md#cview__onprint) member function. If you need different GDI objects for different pages of the document, you can examine the `m_nCurPage` member of the [CPrintInfo](../mfc/reference/cprintinfo-structure.md) structure and select the GDI object accordingly. If you need a GDI object for several consecutive pages, Windows requires that you select it into the device context each time `OnPrint` is called.  \n  \n To deallocate these GDI objects, override the [OnEndPrinting](../mfc/reference/cview-class.md#cview__onendprinting) member function. The framework calls this function at the end of each print job, giving you the opportunity to deallocate printing-specific GDI objects before the application returns to other tasks.  \n  \n## See Also  \n [Printing](../mfc/printing.md)   \n [How Default Printing Is Done](../mfc/how-default-printing-is-done.md)\n\n"}