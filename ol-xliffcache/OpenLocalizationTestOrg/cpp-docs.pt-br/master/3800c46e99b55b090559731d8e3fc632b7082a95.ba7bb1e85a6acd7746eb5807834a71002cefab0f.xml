{"nodes":[{"pos":[12,65],"content":"Handling Customization Notifications | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"Handling Customization Notifications | Microsoft Docs","pos":[0,53]}]},{"content":"Handling Customization Notifications","pos":[1722,1758]},{"content":"A Windows toolbar common control has built-in customization features, including a system-defined customization dialog box, which allow the user to insert, delete, or rearrange toolbar buttons.","pos":[1759,1951]},{"content":"The application determines whether the customization features are available and controls the extent to which the user can customize the toolbar.","pos":[1952,2096]},{"content":"You can make these customization features available to the user by giving the toolbar the <ph id=\"ph1\">`CCS_ADJUSTABLE`</ph> style.","pos":[2103,2216],"source":"You can make these customization features available to the user by giving the toolbar the `CCS_ADJUSTABLE` style."},{"content":"The customization features allow the user to drag a button to a new position or to remove a button by dragging it off the toolbar.","pos":[2217,2347]},{"content":"In addition, the user can double-click the toolbar to display the <bpt id=\"p1\">**</bpt>Customize Toolbar<ept id=\"p1\">**</ept> dialog box, which allows the user to add, delete, and rearrange toolbar buttons.","pos":[2348,2516],"source":" In addition, the user can double-click the toolbar to display the **Customize Toolbar** dialog box, which allows the user to add, delete, and rearrange toolbar buttons."},{"content":"The application can display the dialog box by using the <bpt id=\"p1\">[</bpt>Customize<ept id=\"p1\">](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__customize)</ept> member function.","pos":[2517,2665],"source":" The application can display the dialog box by using the [Customize](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__customize) member function."},{"content":"The toolbar control sends notification messages to the parent window at each step in the customization process.","pos":[2672,2783]},{"content":"If the user holds the SHIFT key down and begins dragging a button, the toolbar automatically handles the drag operation.","pos":[2784,2904]},{"content":"The toolbar sends the <bpt id=\"p1\">**</bpt>TBN_QUERYDELETE<ept id=\"p1\">**</ept> notification message to the parent window to determine whether the button may be deleted.","pos":[2905,3036],"source":" The toolbar sends the **TBN_QUERYDELETE** notification message to the parent window to determine whether the button may be deleted."},{"content":"The drag operation ends if the parent window returns <bpt id=\"p1\">**</bpt>FALSE<ept id=\"p1\">**</ept>.","pos":[3037,3100],"source":" The drag operation ends if the parent window returns **FALSE**."},{"content":"Otherwise, the toolbar captures mouse input and waits for the user to release the mouse button.","pos":[3101,3196]},{"content":"When the user releases the mouse button, the toolbar control determines the location of the mouse cursor.","pos":[3203,3308]},{"content":"If the cursor is outside the toolbar, the button is deleted.","pos":[3309,3369]},{"content":"If the cursor is on another toolbar button, the toolbar sends the <bpt id=\"p1\">**</bpt>TBN_QUERYINSERT<ept id=\"p1\">**</ept> notification message to the parent window to determine if a button may be inserted to the left of the given button.","pos":[3370,3571],"source":" If the cursor is on another toolbar button, the toolbar sends the **TBN_QUERYINSERT** notification message to the parent window to determine if a button may be inserted to the left of the given button."},{"content":"The button is inserted if the parent window returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>; otherwise, it is not.","pos":[3572,3655],"source":" The button is inserted if the parent window returns **TRUE**; otherwise, it is not."},{"content":"The toolbar sends the <bpt id=\"p1\">**</bpt>TBN_TOOLBARCHANGE<ept id=\"p1\">**</ept> notification message to signal the end of the drag operation.","pos":[3656,3761],"source":" The toolbar sends the **TBN_TOOLBARCHANGE** notification message to signal the end of the drag operation."},{"content":"If the user begins a drag operation without holding down the SHIFT key, the toolbar control sends the <bpt id=\"p1\">**</bpt>TBN_BEGINDRAG<ept id=\"p1\">**</ept> notification message to the owner window.","pos":[3768,3929],"source":"If the user begins a drag operation without holding down the SHIFT key, the toolbar control sends the **TBN_BEGINDRAG** notification message to the owner window."},{"content":"An application that implements its own button-dragging code can use this message as a signal to begin a drag operation.","pos":[3930,4049]},{"content":"The toolbar sends the <bpt id=\"p1\">**</bpt>TBN_ENDDRAG<ept id=\"p1\">**</ept> notification message to signal the end of the drag operation.","pos":[4050,4149],"source":" The toolbar sends the **TBN_ENDDRAG** notification message to signal the end of the drag operation."},{"content":"A toolbar control sends notification messages when the user customizes a toolbar by using the <bpt id=\"p1\">**</bpt>Customize Toolbar<ept id=\"p1\">**</ept> dialog box.","pos":[4156,4283],"source":"A toolbar control sends notification messages when the user customizes a toolbar by using the **Customize Toolbar** dialog box."},{"content":"The toolbar sends the <bpt id=\"p1\">**</bpt>TBN_BEGINADJUST<ept id=\"p1\">**</ept> notification message after the user double-clicks the toolbar, but before the dialog box is created.","pos":[4284,4426],"source":" The toolbar sends the **TBN_BEGINADJUST** notification message after the user double-clicks the toolbar, but before the dialog box is created."},{"content":"Next, the toolbar begins sending a series of <bpt id=\"p1\">**</bpt>TBN_QUERYINSERT<ept id=\"p1\">**</ept> notification messages to determine whether the toolbar allows buttons to be inserted.","pos":[4427,4577],"source":" Next, the toolbar begins sending a series of **TBN_QUERYINSERT** notification messages to determine whether the toolbar allows buttons to be inserted."},{"content":"When the parent window returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept>, the toolbar stops sending <bpt id=\"p2\">**</bpt>TBN_QUERYINSERT<ept id=\"p2\">**</ept> notification messages.","pos":[4578,4687],"source":" When the parent window returns **TRUE**, the toolbar stops sending **TBN_QUERYINSERT** notification messages."},{"content":"If the parent window does not return <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> for any button, the toolbar destroys the dialog box.","pos":[4688,4786],"source":" If the parent window does not return **TRUE** for any button, the toolbar destroys the dialog box."},{"content":"Next, the toolbar control determines if any buttons may be deleted from the toolbar by sending one <bpt id=\"p1\">**</bpt>TBN_QUERYDELETE<ept id=\"p1\">**</ept> notification message for each button in the toolbar.","pos":[4793,4964],"source":"Next, the toolbar control determines if any buttons may be deleted from the toolbar by sending one **TBN_QUERYDELETE** notification message for each button in the toolbar."},{"content":"The parent window returns <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> to indicate that a button may be deleted; otherwise, it returns <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept>.","pos":[4965,5074],"source":" The parent window returns **TRUE** to indicate that a button may be deleted; otherwise, it returns **FALSE**."},{"content":"The toolbar adds all toolbar buttons to the dialog box, but grays those that may not be deleted.","pos":[5075,5171]},{"content":"Whenever the toolbar control needs information about a button in the Customize Toolbar dialog box, it sends the <bpt id=\"p1\">**</bpt>TBN_GETBUTTONINFO<ept id=\"p1\">**</ept> notification message, specifying the index of the button for which it needs information and the address of a <bpt id=\"p2\">**</bpt>TBNOTIFY<ept id=\"p2\">**</ept> structure.","pos":[5178,5444],"source":"Whenever the toolbar control needs information about a button in the Customize Toolbar dialog box, it sends the **TBN_GETBUTTONINFO** notification message, specifying the index of the button for which it needs information and the address of a **TBNOTIFY** structure."},{"content":"The parent window must fill the structure with the relevant information.","pos":[5445,5517]},{"content":"The <bpt id=\"p1\">**</bpt>Customize Toolbar<ept id=\"p1\">**</ept> dialog box includes a Help button and a Reset button.","pos":[5524,5603],"source":"The **Customize Toolbar** dialog box includes a Help button and a Reset button."},{"content":"When the user chooses the Help button, the toolbar control sends the <bpt id=\"p1\">**</bpt>TBN_CUSTHELP<ept id=\"p1\">**</ept> notification message.","pos":[5604,5711],"source":" When the user chooses the Help button, the toolbar control sends the **TBN_CUSTHELP** notification message."},{"content":"The parent window should respond by displaying help information.","pos":[5712,5776]},{"content":"The dialog box sends the <bpt id=\"p1\">**</bpt>TBN_RESET<ept id=\"p1\">**</ept> notification message when the user selects the Reset button.","pos":[5777,5876],"source":" The dialog box sends the **TBN_RESET** notification message when the user selects the Reset button."},{"content":"This message signals that the toolbar is about to reinitialize the dialog box.","pos":[5877,5955]},{"pos":[5962,6141],"content":"These messages are all <bpt id=\"p1\">**</bpt>WM_NOTIFY<ept id=\"p1\">**</ept> messages, and they can be handled in your owner window by adding message-map entries of the following form to your owner window's message map:","source":"These messages are all **WM_NOTIFY** messages, and they can be handled in your owner window by adding message-map entries of the following form to your owner window's message map:"},{"content":"Notification message identifier code, such as <bpt id=\"p1\">**</bpt>TBN_BEGINADJUST<ept id=\"p1\">**</ept>.","pos":[6220,6286],"source":" Notification message identifier code, such as **TBN_BEGINADJUST**."},{"content":"The identifier of the control sending the notification.","pos":[6308,6363]},{"content":"The member function to be called when this notification is received.","pos":[6385,6453]},{"content":"Your member function would be declared with the following prototype:","pos":[6460,6528]},{"pos":[6610,6722],"content":"If the notification message handler returns a value, it should put it in the <bpt id=\"p1\">**</bpt>LRESULT<ept id=\"p1\">**</ept> pointed to by <bpt id=\"p2\">*</bpt>result<ept id=\"p2\">*</ept>.","source":"If the notification message handler returns a value, it should put it in the **LRESULT** pointed to by *result*."},{"content":"For each message, <ph id=\"ph1\">`pNotifyStruct`</ph> points to either an <bpt id=\"p1\">**</bpt>NMHDR<ept id=\"p1\">**</ept> structure or a <bpt id=\"p2\">**</bpt>TBNOTIFY<ept id=\"p2\">**</ept> structure.","pos":[6729,6831],"source":"For each message, `pNotifyStruct` points to either an **NMHDR** structure or a **TBNOTIFY** structure."},{"content":"These structures are described below:","pos":[6832,6869]},{"pos":[6876,6931],"content":"The <bpt id=\"p1\">**</bpt>NMHDR<ept id=\"p1\">**</ept> structure contains the following members:","source":"The **NMHDR** structure contains the following members:"},{"content":"hwndFrom","pos":[7165,7173]},{"content":"Window handle of the control that is sending the notification.","pos":[7179,7241]},{"content":"To convert this handle to a <ph id=\"ph1\">`CWnd`</ph> pointer, use <bpt id=\"p1\">[</bpt>CWnd::FromHandle<ept id=\"p1\">](../mfc/reference/cwnd-class.md#cwnd__fromhandle)</ept>.","pos":[7242,7358],"source":" To convert this handle to a `CWnd` pointer, use [CWnd::FromHandle](../mfc/reference/cwnd-class.md#cwnd__fromhandle)."},{"content":"idFrom","pos":[7367,7373]},{"content":"Identifier of the control sending the notification.","pos":[7379,7430]},{"content":"code","pos":[7439,7443]},{"content":"Notification code.","pos":[7449,7467]},{"content":"This member can be a value specific to a control type, such as <bpt id=\"p1\">**</bpt>TBN_BEGINADJUST<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>TTN_NEEDTEXT<ept id=\"p2\">**</ept>, or it can be one of the common notification values listed below:","pos":[7468,7636],"source":" This member can be a value specific to a control type, such as **TBN_BEGINADJUST** or **TTN_NEEDTEXT**, or it can be one of the common notification values listed below:"},{"pos":[7646,7721],"content":"<bpt id=\"p1\">**</bpt>NM_CLICK<ept id=\"p1\">**</ept> The user has clicked the left mouse button within the control.","source":"**NM_CLICK** The user has clicked the left mouse button within the control."},{"pos":[7731,7814],"content":"<bpt id=\"p1\">**</bpt>NM_DBLCLK<ept id=\"p1\">**</ept> The user has double-clicked the left mouse button within the control.","source":"**NM_DBLCLK** The user has double-clicked the left mouse button within the control."},{"pos":[7824,7878],"content":"<bpt id=\"p1\">**</bpt>NM_KILLFOCUS<ept id=\"p1\">**</ept> The control has lost the input focus.","source":"**NM_KILLFOCUS** The control has lost the input focus."},{"pos":[7888,7996],"content":"<bpt id=\"p1\">**</bpt>NM_OUTOFMEMORY<ept id=\"p1\">**</ept> The control could not complete an operation because there is not enough memory available.","source":"**NM_OUTOFMEMORY** The control could not complete an operation because there is not enough memory available."},{"pos":[8006,8083],"content":"<bpt id=\"p1\">**</bpt>NM_RCLICK<ept id=\"p1\">**</ept> The user has clicked the right mouse button within the control.","source":"**NM_RCLICK** The user has clicked the right mouse button within the control."},{"pos":[8093,8178],"content":"<bpt id=\"p1\">**</bpt>NM_RDBLCLK<ept id=\"p1\">**</ept> The user has double-clicked the right mouse button within the control.","source":"**NM_RDBLCLK** The user has double-clicked the right mouse button within the control."},{"pos":[8188,8274],"content":"<bpt id=\"p1\">**</bpt>NM_RETURN<ept id=\"p1\">**</ept> The control has the input focus, and the user has pressed the ENTER key.","source":"**NM_RETURN** The control has the input focus, and the user has pressed the ENTER key."},{"pos":[8284,8341],"content":"<bpt id=\"p1\">**</bpt>NM_SETFOCUS<ept id=\"p1\">**</ept> The control has received the input focus.","source":"**NM_SETFOCUS** The control has received the input focus."},{"pos":[8348,8406],"content":"The <bpt id=\"p1\">**</bpt>TBNOTIFY<ept id=\"p1\">**</ept> structure contains the following members:","source":"The **TBNOTIFY** structure contains the following members:"},{"content":"Remarks","pos":[8797,8804]},{"content":"hdr","pos":[8810,8813]},{"content":"Information common to all <bpt id=\"p1\">**</bpt>WM_NOTIFY<ept id=\"p1\">**</ept> messages.","pos":[8819,8868],"source":" Information common to all **WM_NOTIFY** messages."},{"content":"iItem","pos":[8877,8882]},{"content":"Index of button associated with notification.","pos":[8888,8933]},{"content":"tbButton","pos":[8942,8950]},{"content":"structure that contains information about the toolbar button associated with the notification.","pos":[8967,9061]},{"content":"cchText","pos":[9070,9077]},{"content":"Count of characters in button text.","pos":[9083,9118]},{"content":"lpszText","pos":[9127,9135]},{"content":"Pointer to button text.","pos":[9141,9164]},{"content":"The notifications the toolbar sends are as follows:","pos":[9171,9222]},{"content":"<bpt id=\"p1\">**</bpt>TBN_BEGINADJUST<ept id=\"p1\">**</ept> Sent when the user begins customizing a toolbar control.","pos":[9232,9308],"source":"**TBN_BEGINADJUST** Sent when the user begins customizing a toolbar control."},{"content":"The pointer points to an <bpt id=\"p1\">**</bpt>NMHDR<ept id=\"p1\">**</ept> structure that contains information about the notification.","pos":[9309,9403],"source":" The pointer points to an **NMHDR** structure that contains information about the notification."},{"content":"The handler doesn't need to return any specific value.","pos":[9404,9458]},{"content":"<bpt id=\"p1\">**</bpt>TBN_BEGINDRAG<ept id=\"p1\">**</ept> Sent when the user begins dragging a button in a toolbar control.","pos":[9468,9551],"source":"**TBN_BEGINDRAG** Sent when the user begins dragging a button in a toolbar control."},{"content":"The pointer points to a <bpt id=\"p1\">**</bpt>TBNOTIFY<ept id=\"p1\">**</ept> structure.","pos":[9552,9599],"source":" The pointer points to a **TBNOTIFY** structure."},{"content":"The <bpt id=\"p1\">**</bpt>iItem<ept id=\"p1\">**</ept> member contains the zero-based index of the button being dragged.","pos":[9600,9679],"source":" The **iItem** member contains the zero-based index of the button being dragged."},{"content":"The handler doesn't need to return any specific value.","pos":[9680,9734]},{"content":"<bpt id=\"p1\">**</bpt>TBN_CUSTHELP<ept id=\"p1\">**</ept> Sent when the user chooses the Help button in the Customize Toolbar dialog box.","pos":[9744,9840],"source":"**TBN_CUSTHELP** Sent when the user chooses the Help button in the Customize Toolbar dialog box."},{"content":"No return value.","pos":[9841,9857]},{"content":"The pointer points to an <bpt id=\"p1\">**</bpt>NMHDR<ept id=\"p1\">**</ept> structure that contains information about the notification message.","pos":[9858,9960],"source":" The pointer points to an **NMHDR** structure that contains information about the notification message."},{"content":"The handler doesn't need to return any specific value.","pos":[9961,10015]},{"content":"<bpt id=\"p1\">**</bpt>TBN_ENDADJUST<ept id=\"p1\">**</ept> Sent when the user stops customizing a toolbar control.","pos":[10025,10098],"source":"**TBN_ENDADJUST** Sent when the user stops customizing a toolbar control."},{"content":"The pointer points to an <bpt id=\"p1\">**</bpt>NMHDR<ept id=\"p1\">**</ept> structure that contains information about the notification message.","pos":[10099,10201],"source":" The pointer points to an **NMHDR** structure that contains information about the notification message."},{"content":"The handler doesn't need to return any specific value.","pos":[10202,10256]},{"content":"<bpt id=\"p1\">**</bpt>TBN_ENDDRAG<ept id=\"p1\">**</ept> Sent when the user stops dragging a button in a toolbar control.","pos":[10266,10346],"source":"**TBN_ENDDRAG** Sent when the user stops dragging a button in a toolbar control."},{"content":"The pointer points to a <bpt id=\"p1\">**</bpt>TBNOTIFY<ept id=\"p1\">**</ept> structure.","pos":[10347,10394],"source":" The pointer points to a **TBNOTIFY** structure."},{"content":"The <bpt id=\"p1\">**</bpt>iItem<ept id=\"p1\">**</ept> member contains the zero-based index of the button being dragged.","pos":[10395,10474],"source":" The **iItem** member contains the zero-based index of the button being dragged."},{"content":"The handler doesn't need to return any specific value.","pos":[10475,10529]},{"content":"<bpt id=\"p1\">**</bpt>TBN_GETBUTTONINFO<ept id=\"p1\">**</ept> Sent when the user is customizing a toolbar control.","pos":[10539,10613],"source":"**TBN_GETBUTTONINFO** Sent when the user is customizing a toolbar control."},{"content":"The toolbar uses this notification message to retrieve information needed by the Customize Toolbar dialog box.","pos":[10614,10724]},{"content":"The pointer points to a <bpt id=\"p1\">**</bpt>TBNOTIFY<ept id=\"p1\">**</ept> structure.","pos":[10725,10772],"source":" The pointer points to a **TBNOTIFY** structure."},{"content":"The <bpt id=\"p1\">**</bpt>iItem<ept id=\"p1\">**</ept> member specifies the zero-based index of a button.","pos":[10773,10837],"source":" The **iItem** member specifies the zero-based index of a button."},{"content":"The <bpt id=\"p1\">**</bpt>pszText<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>cchText<ept id=\"p2\">**</ept> members specify the address and length, in characters, of the current button text.","pos":[10838,10952],"source":" The **pszText** and **cchText** members specify the address and length, in characters, of the current button text."},{"content":"An application should fill the structure with information about the button.","pos":[10953,11028]},{"content":"Return <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> if button information was copied to the structure, or <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> otherwise.","pos":[11029,11119],"source":" Return **TRUE** if button information was copied to the structure, or **FALSE** otherwise."},{"content":"<bpt id=\"p1\">**</bpt>TBN_QUERYDELETE<ept id=\"p1\">**</ept> Sent while the user is customizing a toolbar to determine whether a button may be deleted from a toolbar control.","pos":[11129,11262],"source":"**TBN_QUERYDELETE** Sent while the user is customizing a toolbar to determine whether a button may be deleted from a toolbar control."},{"content":"The pointer points to a <bpt id=\"p1\">**</bpt>TBNOTIFY<ept id=\"p1\">**</ept> structure.","pos":[11263,11310],"source":" The pointer points to a **TBNOTIFY** structure."},{"content":"The <bpt id=\"p1\">**</bpt>iItem<ept id=\"p1\">**</ept> member contains the zero-based index of the button to be deleted.","pos":[11311,11390],"source":" The **iItem** member contains the zero-based index of the button to be deleted."},{"content":"Return <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> to allow the button to be deleted or <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> to prevent the button from being deleted.","pos":[11391,11495],"source":" Return **TRUE** to allow the button to be deleted or **FALSE** to prevent the button from being deleted."},{"content":"<bpt id=\"p1\">**</bpt>TBN_QUERYINSERT<ept id=\"p1\">**</ept> Sent while the user is customizing a toolbar control to determine whether a button may be inserted to the left of the given button.","pos":[11505,11656],"source":"**TBN_QUERYINSERT** Sent while the user is customizing a toolbar control to determine whether a button may be inserted to the left of the given button."},{"content":"The pointer points to a <bpt id=\"p1\">**</bpt>TBNOTIFY<ept id=\"p1\">**</ept> structure.","pos":[11657,11704],"source":" The pointer points to a **TBNOTIFY** structure."},{"content":"The <bpt id=\"p1\">**</bpt>iItem<ept id=\"p1\">**</ept> member contains the zero-based index of the button to be inserted.","pos":[11705,11785],"source":" The **iItem** member contains the zero-based index of the button to be inserted."},{"content":"Return <bpt id=\"p1\">**</bpt>TRUE<ept id=\"p1\">**</ept> to allow a button to be inserted in front of the given button or <bpt id=\"p2\">**</bpt>FALSE<ept id=\"p2\">**</ept> to prevent the button from being inserted.","pos":[11786,11919],"source":" Return **TRUE** to allow a button to be inserted in front of the given button or **FALSE** to prevent the button from being inserted."},{"content":"<bpt id=\"p1\">**</bpt>TBN_RESET<ept id=\"p1\">**</ept> Sent when the user resets the content of the Customize Toolbar dialog box.","pos":[11929,12017],"source":"**TBN_RESET** Sent when the user resets the content of the Customize Toolbar dialog box."},{"content":"The pointer points to an <bpt id=\"p1\">**</bpt>NMHDR<ept id=\"p1\">**</ept> structure that contains information about the notification message.","pos":[12018,12120],"source":" The pointer points to an **NMHDR** structure that contains information about the notification message."},{"content":"The handler doesn't need to return any specific value.","pos":[12121,12175]},{"content":"<bpt id=\"p1\">**</bpt>TBN_TOOLBARCHANGE<ept id=\"p1\">**</ept> Sent after the user has customized a toolbar control.","pos":[12185,12260],"source":"**TBN_TOOLBARCHANGE** Sent after the user has customized a toolbar control."},{"content":"The pointer points to an <bpt id=\"p1\">**</bpt>NMHDR<ept id=\"p1\">**</ept> structure that contains information about the notification message.","pos":[12261,12363],"source":" The pointer points to an **NMHDR** structure that contains information about the notification message."},{"content":"The handler doesn't need to return any specific value.","pos":[12364,12418]},{"content":"See Also","pos":[12427,12435]},{"content":"Using CToolBarCtrl","pos":[12440,12458]},{"content":"Controls","pos":[12495,12503]}],"content":"---\ntitle: \"Handling Customization Notifications | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"TBN_CUSTHELP\"\n  - \"TBN_QUERYINSERT\"\n  - \"TBNOTIFY\"\n  - \"NMHDR\"\n  - \"TBN_TOOLBARCHANGE\"\n  - \"TBN_ENDDRAG\"\n  - \"NM_SETFOCUS\"\n  - \"TBN_RESET\"\n  - \"NM_RETURN\"\n  - \"NM_ENDWAIT\"\n  - \"NM_STARTWAIT\"\n  - \"TBN_BEGINDRAG\"\n  - \"NM_OUTOFMEMORY\"\n  - \"TBN_QUERYDELETE\"\n  - \"NM_DBLCLK\"\n  - \"TBN_ENDADJUST\"\n  - \"NM_KILLFOCUS\"\n  - \"NM_RCLICK\"\n  - \"TBN_BEGINADJUST\"\n  - \"NM_CLICK\"\n  - \"NM_RDBLCLK::\"\n  - \"TBN_GETBUTTONINFO\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"TBN_ENDADJUST notification\"\n  - \"TBNOTIFY notification\"\n  - \"TBN_BEGINDRAG notification\"\n  - \"TBN_TOOLBARCHANGE notification\"\n  - \"NM_CLICK notification\"\n  - \"NM_RETURN notification\"\n  - \"NM_RCLICK notification\"\n  - \"TBN_ENDDRAG notification\"\n  - \"TBN_BEGINADJUST notification\"\n  - \"NM_ENDWAIT notification\"\n  - \"NM_KILLFOCUS notification\"\n  - \"NM_SETFOCUS notification\"\n  - \"NM_OUTOFMEMORY notification\"\n  - \"TBN_QUERYINSERT notification\"\n  - \"NMHDR\"\n  - \"NM_STARTWAIT notification\"\n  - \"CToolBarCtrl class, handling notifications\"\n  - \"TBN_CUSTHELP notification\"\n  - \"TBN_RESET notification\"\n  - \"NM_DBLCLK notification\"\n  - \"TBN_QUERYDELETE notification\"\n  - \"NM_RDBLCLK notification\"\n  - \"TBN_GETBUTTONINFO notification\"\nms.assetid: 219ea08e-7515-4b98-85cb-47120f08c0a2\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# Handling Customization Notifications\nA Windows toolbar common control has built-in customization features, including a system-defined customization dialog box, which allow the user to insert, delete, or rearrange toolbar buttons. The application determines whether the customization features are available and controls the extent to which the user can customize the toolbar.  \n  \n You can make these customization features available to the user by giving the toolbar the `CCS_ADJUSTABLE` style. The customization features allow the user to drag a button to a new position or to remove a button by dragging it off the toolbar. In addition, the user can double-click the toolbar to display the **Customize Toolbar** dialog box, which allows the user to add, delete, and rearrange toolbar buttons. The application can display the dialog box by using the [Customize](../mfc/reference/ctoolbarctrl-class.md#ctoolbarctrl__customize) member function.  \n  \n The toolbar control sends notification messages to the parent window at each step in the customization process. If the user holds the SHIFT key down and begins dragging a button, the toolbar automatically handles the drag operation. The toolbar sends the **TBN_QUERYDELETE** notification message to the parent window to determine whether the button may be deleted. The drag operation ends if the parent window returns **FALSE**. Otherwise, the toolbar captures mouse input and waits for the user to release the mouse button.  \n  \n When the user releases the mouse button, the toolbar control determines the location of the mouse cursor. If the cursor is outside the toolbar, the button is deleted. If the cursor is on another toolbar button, the toolbar sends the **TBN_QUERYINSERT** notification message to the parent window to determine if a button may be inserted to the left of the given button. The button is inserted if the parent window returns **TRUE**; otherwise, it is not. The toolbar sends the **TBN_TOOLBARCHANGE** notification message to signal the end of the drag operation.  \n  \n If the user begins a drag operation without holding down the SHIFT key, the toolbar control sends the **TBN_BEGINDRAG** notification message to the owner window. An application that implements its own button-dragging code can use this message as a signal to begin a drag operation. The toolbar sends the **TBN_ENDDRAG** notification message to signal the end of the drag operation.  \n  \n A toolbar control sends notification messages when the user customizes a toolbar by using the **Customize Toolbar** dialog box. The toolbar sends the **TBN_BEGINADJUST** notification message after the user double-clicks the toolbar, but before the dialog box is created. Next, the toolbar begins sending a series of **TBN_QUERYINSERT** notification messages to determine whether the toolbar allows buttons to be inserted. When the parent window returns **TRUE**, the toolbar stops sending **TBN_QUERYINSERT** notification messages. If the parent window does not return **TRUE** for any button, the toolbar destroys the dialog box.  \n  \n Next, the toolbar control determines if any buttons may be deleted from the toolbar by sending one **TBN_QUERYDELETE** notification message for each button in the toolbar. The parent window returns **TRUE** to indicate that a button may be deleted; otherwise, it returns **FALSE**. The toolbar adds all toolbar buttons to the dialog box, but grays those that may not be deleted.  \n  \n Whenever the toolbar control needs information about a button in the Customize Toolbar dialog box, it sends the **TBN_GETBUTTONINFO** notification message, specifying the index of the button for which it needs information and the address of a **TBNOTIFY** structure. The parent window must fill the structure with the relevant information.  \n  \n The **Customize Toolbar** dialog box includes a Help button and a Reset button. When the user chooses the Help button, the toolbar control sends the **TBN_CUSTHELP** notification message. The parent window should respond by displaying help information. The dialog box sends the **TBN_RESET** notification message when the user selects the Reset button. This message signals that the toolbar is about to reinitialize the dialog box.  \n  \n These messages are all **WM_NOTIFY** messages, and they can be handled in your owner window by adding message-map entries of the following form to your owner window's message map:  \n  \n `ON_NOTIFY( wNotifyCode, idControl, memberFxn )`  \n  \n `wNotifyCode`  \n Notification message identifier code, such as **TBN_BEGINADJUST**.  \n  \n `idControl`  \n The identifier of the control sending the notification.  \n  \n `memberFxn`  \n The member function to be called when this notification is received.  \n  \n Your member function would be declared with the following prototype:  \n  \n `afx_msg void memberFxn( NMHDR * pNotifyStruct, LRESULT * result );`  \n  \n If the notification message handler returns a value, it should put it in the **LRESULT** pointed to by *result*.  \n  \n For each message, `pNotifyStruct` points to either an **NMHDR** structure or a **TBNOTIFY** structure. These structures are described below:  \n  \n The **NMHDR** structure contains the following members:  \n  \n `typedef struct tagNMHDR {`  \n  \n `HWND hwndFrom;  // handle of control sending message`  \n  \n `UINT idFrom;// identifier of control sending message`  \n  \n `UINT code;  // notification code; see below`  \n  \n `} NMHDR;`  \n  \n **hwndFrom**  \n Window handle of the control that is sending the notification. To convert this handle to a `CWnd` pointer, use [CWnd::FromHandle](../mfc/reference/cwnd-class.md#cwnd__fromhandle).  \n  \n **idFrom**  \n Identifier of the control sending the notification.  \n  \n **code**  \n Notification code. This member can be a value specific to a control type, such as **TBN_BEGINADJUST** or **TTN_NEEDTEXT**, or it can be one of the common notification values listed below:  \n  \n-   **NM_CLICK** The user has clicked the left mouse button within the control.  \n  \n-   **NM_DBLCLK** The user has double-clicked the left mouse button within the control.  \n  \n-   **NM_KILLFOCUS** The control has lost the input focus.  \n  \n-   **NM_OUTOFMEMORY** The control could not complete an operation because there is not enough memory available.  \n  \n-   **NM_RCLICK** The user has clicked the right mouse button within the control.  \n  \n-   **NM_RDBLCLK** The user has double-clicked the right mouse button within the control.  \n  \n-   **NM_RETURN** The control has the input focus, and the user has pressed the ENTER key.  \n  \n-   **NM_SETFOCUS** The control has received the input focus.  \n  \n The **TBNOTIFY** structure contains the following members:  \n  \n `typedef struct {`  \n  \n `NMHDR hdr; // information common to all WM_NOTIFY messages`  \n  \n `int iItem; // index of button associated with notification`  \n  \n `TBBUTTON tbButton; // info about button associated withnotification`  \n  \n `int cchText;   // count of characters in button text`  \n  \n `LPSTR lpszText;// address of button text`  \n  \n `} TBNOTIFY, FAR* LPTBNOTIFY;`  \n  \n## Remarks  \n **hdr**  \n Information common to all **WM_NOTIFY** messages.  \n  \n **iItem**  \n Index of button associated with notification.  \n  \n **tbButton**  \n `TBBUTTON` structure that contains information about the toolbar button associated with the notification.  \n  \n **cchText**  \n Count of characters in button text.  \n  \n **lpszText**  \n Pointer to button text.  \n  \n The notifications the toolbar sends are as follows:  \n  \n-   **TBN_BEGINADJUST** Sent when the user begins customizing a toolbar control. The pointer points to an **NMHDR** structure that contains information about the notification. The handler doesn't need to return any specific value.  \n  \n-   **TBN_BEGINDRAG** Sent when the user begins dragging a button in a toolbar control. The pointer points to a **TBNOTIFY** structure. The **iItem** member contains the zero-based index of the button being dragged. The handler doesn't need to return any specific value.  \n  \n-   **TBN_CUSTHELP** Sent when the user chooses the Help button in the Customize Toolbar dialog box. No return value. The pointer points to an **NMHDR** structure that contains information about the notification message. The handler doesn't need to return any specific value.  \n  \n-   **TBN_ENDADJUST** Sent when the user stops customizing a toolbar control. The pointer points to an **NMHDR** structure that contains information about the notification message. The handler doesn't need to return any specific value.  \n  \n-   **TBN_ENDDRAG** Sent when the user stops dragging a button in a toolbar control. The pointer points to a **TBNOTIFY** structure. The **iItem** member contains the zero-based index of the button being dragged. The handler doesn't need to return any specific value.  \n  \n-   **TBN_GETBUTTONINFO** Sent when the user is customizing a toolbar control. The toolbar uses this notification message to retrieve information needed by the Customize Toolbar dialog box. The pointer points to a **TBNOTIFY** structure. The **iItem** member specifies the zero-based index of a button. The **pszText** and **cchText** members specify the address and length, in characters, of the current button text. An application should fill the structure with information about the button. Return **TRUE** if button information was copied to the structure, or **FALSE** otherwise.  \n  \n-   **TBN_QUERYDELETE** Sent while the user is customizing a toolbar to determine whether a button may be deleted from a toolbar control. The pointer points to a **TBNOTIFY** structure. The **iItem** member contains the zero-based index of the button to be deleted. Return **TRUE** to allow the button to be deleted or **FALSE** to prevent the button from being deleted.  \n  \n-   **TBN_QUERYINSERT** Sent while the user is customizing a toolbar control to determine whether a button may be inserted to the left of the given button. The pointer points to a **TBNOTIFY** structure. The **iItem** member contains the zero-based index of the button to be inserted. Return **TRUE** to allow a button to be inserted in front of the given button or **FALSE** to prevent the button from being inserted.  \n  \n-   **TBN_RESET** Sent when the user resets the content of the Customize Toolbar dialog box. The pointer points to an **NMHDR** structure that contains information about the notification message. The handler doesn't need to return any specific value.  \n  \n-   **TBN_TOOLBARCHANGE** Sent after the user has customized a toolbar control. The pointer points to an **NMHDR** structure that contains information about the notification message. The handler doesn't need to return any specific value.  \n  \n## See Also  \n [Using CToolBarCtrl](../mfc/using-ctoolbarctrl.md)   \n [Controls](../mfc/controls-mfc.md)\n\n"}