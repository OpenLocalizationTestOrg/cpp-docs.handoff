{"nodes":[{"pos":[12,68],"content":"How to: Implement Tracking in Your Code | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"How to: Implement Tracking in Your Code | Microsoft Docs","pos":[0,56]}]},{"content":"How to: Implement Tracking in Your Code","pos":[619,658]},{"content":"To track an OLE item, you must handle certain events related to the item, such as clicking the item or updating the view of the document.","pos":[659,796]},{"content":"In all cases, it is sufficient to declare a temporary <bpt id=\"p1\">[</bpt>CRectTracker<ept id=\"p1\">](../mfc/reference/crecttracker-class.md)</ept> object and manipulate the item by means of this object.","pos":[797,961],"source":" In all cases, it is sufficient to declare a temporary [CRectTracker](../mfc/reference/crecttracker-class.md) object and manipulate the item by means of this object."},{"content":"When a user selects an item or inserts an object with a menu command, you must initialize the tracker with the proper styles to represent the state of the OLE item.","pos":[968,1132]},{"content":"The following table outlines the conventions used by the OCLIENT sample.","pos":[1133,1205]},{"content":"For more information on these styles, see <ph id=\"ph1\">`CRectTracker`</ph>.","pos":[1206,1263],"source":" For more information on these styles, see `CRectTracker`."},{"content":"Container Styles and States of the OLE Item","pos":[1273,1316]},{"content":"Style displayed","pos":[1323,1338]},{"content":"State of OLE item","pos":[1339,1356]},{"content":"Dotted border","pos":[1411,1424]},{"content":"Item is linked","pos":[1425,1439]},{"content":"Solid border","pos":[1444,1456]},{"content":"Item is embedded in your document","pos":[1457,1490]},{"content":"Resize handles","pos":[1495,1509]},{"content":"Item is currently selected","pos":[1510,1536]},{"content":"Hatched border","pos":[1541,1555]},{"content":"Item is currently in-place active","pos":[1556,1589]},{"content":"Hatching pattern overlays item","pos":[1594,1624]},{"content":"Item's server is open","pos":[1625,1646]},{"content":"You can handle this initialization easily using a procedure that checks the state of the OLE item and sets the appropriate styles.","pos":[1654,1784]},{"content":"The <bpt id=\"p1\">**</bpt>SetupTracker<ept id=\"p1\">**</ept> function found in the OCLIENT sample demonstrates tracker initialization.","pos":[1785,1879],"source":" The **SetupTracker** function found in the OCLIENT sample demonstrates tracker initialization."},{"content":"The parameters for this function are the address of the tracker, <bpt id=\"p1\">*</bpt>pTracker<ept id=\"p1\">*</ept>; a pointer to the client item that is related to the tracker, <ph id=\"ph1\">`pItem`</ph>; and a pointer to a rectangle, <bpt id=\"p2\">*</bpt>pTrueRect<ept id=\"p2\">*</ept>.","pos":[1880,2069],"source":" The parameters for this function are the address of the tracker, *pTracker*; a pointer to the client item that is related to the tracker, `pItem`; and a pointer to a rectangle, *pTrueRect*."},{"content":"For a more complete example of this function, see the MFC OLE sample <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../visual-cpp-samples.md)</ept>.","pos":[2070,2175],"source":" For a more complete example of this function, see the MFC OLE sample [OCLIENT](../visual-cpp-samples.md)."},{"pos":[2182,2326],"content":"The <bpt id=\"p1\">**</bpt>SetupTracker<ept id=\"p1\">**</ept> code example presents a single function; lines of the function are interspersed with discussion of the function's features:","source":"The **SetupTracker** code example presents a single function; lines of the function are interspersed with discussion of the function's features:"},{"pos":[2344,2360],"content":"NVC_MFCOClient#1"},{"content":"The tracker is initialized by setting the minimum size and clearing the style of the tracker.","pos":[2438,2531]},{"pos":[2549,2565],"content":"NVC_MFCOClient#2"},{"content":"The following lines check to see whether the item is currently selected and whether the item is linked to the document or embedded in it.","pos":[2643,2780]},{"content":"Resize handles located on the inside of the border are added to the style, indicating that the item is currently selected.","pos":[2781,2903]},{"content":"If the item is linked to your document, the dotted border style is used.","pos":[2904,2976]},{"content":"A solid border is used if the item is embedded.","pos":[2977,3024]},{"pos":[3042,3058],"content":"NVC_MFCOClient#3"},{"content":"The following code overlays the item with a hatched pattern if the item is currently open.","pos":[3136,3226]},{"pos":[3244,3260],"content":"NVC_MFCOClient#4"},{"content":"You can then call this function whenever the tracker has to be displayed.","pos":[3338,3411]},{"content":"For example, call this function from the <ph id=\"ph1\">`OnDraw`</ph> function of your view class.","pos":[3412,3490],"source":" For example, call this function from the `OnDraw` function of your view class."},{"content":"This updates the tracker's appearance whenever the view is repainted.","pos":[3491,3560]},{"content":"For a complete example, see the <bpt id=\"p1\">**</bpt>CMainView::OnDraw<ept id=\"p1\">**</ept> function of the MFC OLE sample <bpt id=\"p2\">[</bpt>OCLIENT<ept id=\"p2\">](../visual-cpp-samples.md)</ept>.","pos":[3561,3682],"source":" For a complete example, see the **CMainView::OnDraw** function of the MFC OLE sample [OCLIENT](../visual-cpp-samples.md)."},{"content":"In your application, events that require tracker code, such as resizing, moving, or hit detecting, will occur.","pos":[3689,3799]},{"content":"These actions usually indicate that an attempt is being made to grab or move the item.","pos":[3800,3886]},{"content":"In these cases, you will need to decide what was grabbed: a resize handle or a portion of the border between resize handles.","pos":[3887,4011]},{"content":"The <ph id=\"ph1\">`OnLButtonDown`</ph> message handler is a good place to test the position of the mouse in relation to the item.","pos":[4012,4122],"source":" The `OnLButtonDown` message handler is a good place to test the position of the mouse in relation to the item."},{"content":"Make a call to <ph id=\"ph1\">`CRectTracker::HitTest`</ph>.","pos":[4123,4162],"source":" Make a call to `CRectTracker::HitTest`."},{"content":"If the test returns something besides <bpt id=\"p1\">**</bpt>CRectTracker::hitOutside<ept id=\"p1\">**</ept>, the item is being resized or moved.","pos":[4163,4266],"source":" If the test returns something besides **CRectTracker::hitOutside**, the item is being resized or moved."},{"content":"Therefore, you should make a call to the <ph id=\"ph1\">`Track`</ph> member function.","pos":[4267,4332],"source":" Therefore, you should make a call to the `Track` member function."},{"content":"See the <bpt id=\"p1\">**</bpt>CMainView::OnLButtonDown<ept id=\"p1\">**</ept> function located in the MFC OLE sample <bpt id=\"p2\">[</bpt>OCLIENT<ept id=\"p2\">](../visual-cpp-samples.md)</ept> for a complete example.","pos":[4333,4468],"source":" See the **CMainView::OnLButtonDown** function located in the MFC OLE sample [OCLIENT](../visual-cpp-samples.md) for a complete example."},{"content":"The <ph id=\"ph1\">`CRectTracker`</ph> class provides several different cursor shapes used to indicate whether a move, resize, or drag operation is taking place.","pos":[4475,4616],"source":"The `CRectTracker` class provides several different cursor shapes used to indicate whether a move, resize, or drag operation is taking place."},{"content":"To handle this event, check to see whether the item currently under the mouse is selected.","pos":[4617,4707]},{"content":"If it is, make a call to <ph id=\"ph1\">`CRectTracker::SetCursor`</ph>, or call the default handler.","pos":[4708,4788],"source":" If it is, make a call to `CRectTracker::SetCursor`, or call the default handler."},{"content":"The following example is from the MFC OLE sample <bpt id=\"p1\">[</bpt>OCLIENT<ept id=\"p1\">](../visual-cpp-samples.md)</ept>:","pos":[4789,4874],"source":" The following example is from the MFC OLE sample [OCLIENT](../visual-cpp-samples.md):"},{"pos":[4892,4908],"content":"NVC_MFCOClient#5"},{"content":"See Also","pos":[4988,4996]},{"content":"Trackers: Implementing Trackers in Your OLE Application","pos":[5001,5056]}],"content":"---\ntitle: \"How to: Implement Tracking in Your Code | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"CRectTracker class, implementing trackers\"\nms.assetid: baaeca2c-5114-485f-bf58-8807db1bc973\ncaps.latest.revision: 11\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# How to: Implement Tracking in Your Code\nTo track an OLE item, you must handle certain events related to the item, such as clicking the item or updating the view of the document. In all cases, it is sufficient to declare a temporary [CRectTracker](../mfc/reference/crecttracker-class.md) object and manipulate the item by means of this object.  \n  \n When a user selects an item or inserts an object with a menu command, you must initialize the tracker with the proper styles to represent the state of the OLE item. The following table outlines the conventions used by the OCLIENT sample. For more information on these styles, see `CRectTracker`.  \n  \n### Container Styles and States of the OLE Item  \n  \n|Style displayed|State of OLE item|  \n|---------------------|-----------------------|  \n|Dotted border|Item is linked|  \n|Solid border|Item is embedded in your document|  \n|Resize handles|Item is currently selected|  \n|Hatched border|Item is currently in-place active|  \n|Hatching pattern overlays item|Item's server is open|  \n  \n You can handle this initialization easily using a procedure that checks the state of the OLE item and sets the appropriate styles. The **SetupTracker** function found in the OCLIENT sample demonstrates tracker initialization. The parameters for this function are the address of the tracker, *pTracker*; a pointer to the client item that is related to the tracker, `pItem`; and a pointer to a rectangle, *pTrueRect*. For a more complete example of this function, see the MFC OLE sample [OCLIENT](../visual-cpp-samples.md).  \n  \n The **SetupTracker** code example presents a single function; lines of the function are interspersed with discussion of the function's features:  \n  \n [!code-cpp[NVC_MFCOClient#1](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_1.cpp)]  \n  \n The tracker is initialized by setting the minimum size and clearing the style of the tracker.  \n  \n [!code-cpp[NVC_MFCOClient#2](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_2.cpp)]  \n  \n The following lines check to see whether the item is currently selected and whether the item is linked to the document or embedded in it. Resize handles located on the inside of the border are added to the style, indicating that the item is currently selected. If the item is linked to your document, the dotted border style is used. A solid border is used if the item is embedded.  \n  \n [!code-cpp[NVC_MFCOClient#3](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_3.cpp)]  \n  \n The following code overlays the item with a hatched pattern if the item is currently open.  \n  \n [!code-cpp[NVC_MFCOClient#4](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_4.cpp)]  \n  \n You can then call this function whenever the tracker has to be displayed. For example, call this function from the `OnDraw` function of your view class. This updates the tracker's appearance whenever the view is repainted. For a complete example, see the **CMainView::OnDraw** function of the MFC OLE sample [OCLIENT](../visual-cpp-samples.md).  \n  \n In your application, events that require tracker code, such as resizing, moving, or hit detecting, will occur. These actions usually indicate that an attempt is being made to grab or move the item. In these cases, you will need to decide what was grabbed: a resize handle or a portion of the border between resize handles. The `OnLButtonDown` message handler is a good place to test the position of the mouse in relation to the item. Make a call to `CRectTracker::HitTest`. If the test returns something besides **CRectTracker::hitOutside**, the item is being resized or moved. Therefore, you should make a call to the `Track` member function. See the **CMainView::OnLButtonDown** function located in the MFC OLE sample [OCLIENT](../visual-cpp-samples.md) for a complete example.  \n  \n The `CRectTracker` class provides several different cursor shapes used to indicate whether a move, resize, or drag operation is taking place. To handle this event, check to see whether the item currently under the mouse is selected. If it is, make a call to `CRectTracker::SetCursor`, or call the default handler. The following example is from the MFC OLE sample [OCLIENT](../visual-cpp-samples.md):  \n  \n [!code-cpp[NVC_MFCOClient#5](../mfc/codesnippet/cpp/how-to-implement-tracking-in-your-code_5.cpp)]  \n  \n## See Also  \n [Trackers: Implementing Trackers in Your OLE Application](../mfc/trackers-implementing-trackers-in-your-ole-application.md)\n\n"}