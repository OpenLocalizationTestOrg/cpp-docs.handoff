{"nodes":[{"pos":[12,57],"content":"InitInstance Member Function | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":"InitInstance Member Function | Microsoft Docs","pos":[0,45]}]},{"content":"InitInstance Member Function","pos":[724,752]},{"content":"The Windows operating system allows you to run more than one copy, or \"instance,\" of the same application.","pos":[753,859]},{"content":"calls <bpt id=\"p1\">[</bpt>InitInstance<ept id=\"p1\">](../mfc/reference/cwinapp-class.md#cwinapp__initinstance)</ept> every time a new instance of the application starts.","pos":[870,1000],"source":" calls [InitInstance](../mfc/reference/cwinapp-class.md#cwinapp__initinstance) every time a new instance of the application starts."},{"pos":[1007,1117],"content":"The standard <ph id=\"ph1\">`InitInstance`</ph> implementation created by the MFC Application Wizard performs the following tasks:","source":"The standard `InitInstance` implementation created by the MFC Application Wizard performs the following tasks:"},{"content":"As its central action, creates the document templates that in turn create documents, views, and frame windows.","pos":[1127,1237]},{"content":"For a description of this process, see <bpt id=\"p1\">[</bpt>Document Template Creation<ept id=\"p1\">](../mfc/document-template-creation.md)</ept>.","pos":[1238,1344],"source":" For a description of this process, see [Document Template Creation](../mfc/document-template-creation.md)."},{"content":"Loads standard file options from an .ini file or the Windows registry, including the names of the most recently used files.","pos":[1354,1477]},{"content":"Registers one or more document templates.","pos":[1487,1528]},{"content":"For an MDI application, creates a main frame window.","pos":[1538,1590]},{"content":"Processes the command line to open a document specified on the command line or to open a new, empty document.","pos":[1600,1709]},{"content":"You can add your own initialization code or modify the code written by the wizard.","pos":[1716,1798]},{"pos":[1806,2353],"content":"[!NOTE]\n MFC applications must be initialized as single threaded apartment (STA). If you call [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) in your `InitInstance` override, specify `COINIT_APARTMENTTHREADED` (rather than `COINIT_MULTITHREADED`). For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at [http://support.microsoft.com/default.aspxscid=kb;en-us;828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643).","leadings":["","> "],"nodes":[{"content":" MFC applications must be initialized as single threaded apartment (STA). If you call [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) in your `InitInstance` override, specify `COINIT_APARTMENTTHREADED` (rather than `COINIT_MULTITHREADED`). For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at [http://support.microsoft.com/default.aspxscid=kb;en-us;828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643).","pos":[8,545],"nodes":[{"content":"MFC applications must be initialized as single threaded apartment (STA).","pos":[1,73]},{"content":"If you call <bpt id=\"p1\">[</bpt>CoInitializeEx<ept id=\"p1\">](http://msdn.microsoft.com/library/windows/desktop/ms695279)</ept> in your <ph id=\"ph1\">`InitInstance`</ph> override, specify <ph id=\"ph2\">`COINIT_APARTMENTTHREADED`</ph> (rather than <ph id=\"ph3\">`COINIT_MULTITHREADED`</ph>).","pos":[74,268],"source":" If you call [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) in your `InitInstance` override, specify `COINIT_APARTMENTTHREADED` (rather than `COINIT_MULTITHREADED`)."},{"content":"For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at <bpt id=\"p1\">[</bpt>http://support.microsoft.com/default.aspxscid=kb;en-us;828643<ept id=\"p1\">](http://support.microsoft.com/default.aspxscid=kb;en-us;828643)</ept>.","pos":[269,537],"source":" For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at [http://support.microsoft.com/default.aspxscid=kb;en-us;828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643)."}]}]},{"content":"See Also","pos":[2362,2370]},{"content":"CWinApp: The Application Class","pos":[2375,2405]}],"content":"---\ntitle: \"InitInstance Member Function | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\nf1_keywords: \n  - \"InitInstance\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"InitInstance method\"\n  - \"applications [MFC], initializing\"\n  - \"MFC [C++], initializing\"\n  - \"initializing MFC applications\"\nms.assetid: 4ef09267-ff7f-4c39-91a0-57454a264f83\ncaps.latest.revision: 10\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# InitInstance Member Function\nThe Windows operating system allows you to run more than one copy, or \"instance,\" of the same application. `WinMain` calls [InitInstance](../mfc/reference/cwinapp-class.md#cwinapp__initinstance) every time a new instance of the application starts.  \n  \n The standard `InitInstance` implementation created by the MFC Application Wizard performs the following tasks:  \n  \n-   As its central action, creates the document templates that in turn create documents, views, and frame windows. For a description of this process, see [Document Template Creation](../mfc/document-template-creation.md).  \n  \n-   Loads standard file options from an .ini file or the Windows registry, including the names of the most recently used files.  \n  \n-   Registers one or more document templates.  \n  \n-   For an MDI application, creates a main frame window.  \n  \n-   Processes the command line to open a document specified on the command line or to open a new, empty document.  \n  \n You can add your own initialization code or modify the code written by the wizard.  \n  \n> [!NOTE]\n>  MFC applications must be initialized as single threaded apartment (STA). If you call [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) in your `InitInstance` override, specify `COINIT_APARTMENTTHREADED` (rather than `COINIT_MULTITHREADED`). For more information, see PRB: MFC Application Stops Responding When You Initialize the Application as a Multithreaded Apartment (828643) at [http://support.microsoft.com/default.aspxscid=kb;en-us;828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643).  \n  \n## See Also  \n [CWinApp: The Application Class](../mfc/cwinapp-the-application-class.md)\n"}