{"nodes":[{"pos":[12,56],"content":".Vsz File (Project Control) | Microsoft Docs","needQuote":false,"needEscape":true,"nodes":[{"content":".Vsz File (Project Control) | Microsoft Docs","pos":[0,44]}]},{"content":".Vsz File (Project Control)","pos":[712,739]},{"content":"The starting point of each wizard is the .vsz file.","pos":[740,791]},{"content":"The .vsz file is a text file that determines the wizard to be called and the information to pass to the wizard.","pos":[792,903]},{"content":"The file contains a two-line header, followed by various optional parameters to be passed to the wizard.","pos":[904,1008]},{"content":"For a list of optional parameters, see <bpt id=\"p1\">[</bpt>Predefined Custom Wizard Symbols<ept id=\"p1\">](../ide/custom-parameters-in-the-wizard-dot-vsz-file.md)</ept>.","pos":[1009,1139],"source":" For a list of optional parameters, see [Predefined Custom Wizard Symbols](../ide/custom-parameters-in-the-wizard-dot-vsz-file.md)."},{"content":"The following sample shows the header in a .vsz file:","pos":[1146,1199]},{"content":"The first line of the header specifies the version number of the template file format.","pos":[1314,1400]},{"content":"You may specify this number as <ph id=\"ph1\">`6.0`</ph>, <ph id=\"ph2\">`7.0`</ph>, or <ph id=\"ph3\">`7.1`</ph>.","pos":[1401,1455],"source":" You may specify this number as `6.0`, `7.0`, or `7.1`."},{"content":"No other numbers are valid, and using other numbers results in an \"Invalid Format\" error.","pos":[1456,1545]},{"content":"The second line sets the <bpt id=\"p1\">**</bpt>Wizard<ept id=\"p1\">**</ept> variable to the ProgID of the wizard that is cocreated by Visual Studio.","pos":[1555,1663],"source":"The second line sets the **Wizard** variable to the ProgID of the wizard that is cocreated by Visual Studio."},{"content":"A ProgID is a string representation of a CLSID, such as <ph id=\"ph1\">`VsWizard.VsWizardEngine.10.0`</ph>.","pos":[1664,1751],"source":" A ProgID is a string representation of a CLSID, such as `VsWizard.VsWizardEngine.10.0`."},{"content":"If your wizard has a user interface, the ProgID automatically specifies your wizard to implement &lt;xref:Microsoft.VisualStudio.VsWizard.IVCWizCtlUI&gt;.","pos":[1762,1910],"source":"If your wizard has a user interface, the ProgID automatically specifies your wizard to implement <xref:Microsoft.VisualStudio.VsWizard.IVCWizCtlUI>."},{"content":"By default, the methods of this interface are used in the <bpt id=\"p1\">[</bpt>.htm files<ept id=\"p1\">](../ide/html-files.md)</ept> of your project.","pos":[1911,2020],"source":" By default, the methods of this interface are used in the [.htm files](../ide/html-files.md) of your project."},{"content":"You can change the behavior of your wizard by using the methods for this interface in the .htm files.","pos":[2021,2122]},{"content":"See &lt;xref:Microsoft.VisualStudio.VsWizard.VCWizCtl&gt; for more information, which is the coclass for &lt;xref:Microsoft.VisualStudio.VsWizard.IVCWizCtlUI&gt;.","pos":[2123,2273],"source":" See <xref:Microsoft.VisualStudio.VsWizard.VCWizCtl> for more information, which is the coclass for <xref:Microsoft.VisualStudio.VsWizard.IVCWizCtlUI>."},{"content":"Following these two lines is an optional list of parameters that allow the .vsz file to pass additional custom parameters to the wizard.","pos":[2283,2419]},{"content":"Each value is passed as a string element in an array of variants in the wizard control's &lt;xref:Microsoft.VisualStudio.VsWizard.VsWizardClass.Execute%2A&gt; method.","pos":[2420,2580],"source":" Each value is passed as a string element in an array of variants in the wizard control's <xref:Microsoft.VisualStudio.VsWizard.VsWizardClass.Execute%2A> method."},{"content":"By default, a wizard with a user interface produces the following default parameters:","pos":[2581,2666]},{"pos":[2997,3134],"content":"If your wizard does not have a user interface, it does not have an <ph id=\"ph1\">`IMAGES_PATH`</ph> parameter and instead contains the following parameters:","source":"If your wizard does not have a user interface, it does not have an `IMAGES_PATH` parameter and instead contains the following parameters:"},{"pos":[3233,3404],"content":"The .vsz file can contain the following parameters, which specify functions found in the <bpt id=\"p1\">[</bpt>Common.js<ept id=\"p1\">](../ide/customizing-cpp-wizards-with-common-jscript-functions.md)</ept> file:","source":"The .vsz file can contain the following parameters, which specify functions found in the [Common.js](../ide/customizing-cpp-wizards-with-common-jscript-functions.md) file:"},{"content":"The functions <bpt id=\"p1\">[</bpt>CanAddATLClass<ept id=\"p1\">](../ide/canaddatlclass.md)</ept>, <bpt id=\"p2\">[</bpt>CanAddMFCClass<ept id=\"p2\">](../ide/canaddmfcclass.md)</ept>, and <bpt id=\"p3\">[</bpt>CanAddClass<ept id=\"p3\">](../ide/canaddclass.md)</ept> are called by the wizard to confirm that the <bpt id=\"p4\">[</bpt>Visual C++ Code Model<ept id=\"p4\">](http://msdn.microsoft.com/en-us/dd6452c2-1054-44a1-b0eb-639a94a1216b)</ept> is available.","pos":[3584,3879],"source":"The functions [CanAddATLClass](../ide/canaddatlclass.md), [CanAddMFCClass](../ide/canaddmfcclass.md), and [CanAddClass](../ide/canaddclass.md) are called by the wizard to confirm that the [Visual C++ Code Model](http://msdn.microsoft.com/en-us/dd6452c2-1054-44a1-b0eb-639a94a1216b) is available."},{"content":"If one function returns <bpt id=\"p1\">**</bpt>false<ept id=\"p1\">**</ept>, the wizard is not launched.","pos":[3880,3942],"source":" If one function returns **false**, the wizard is not launched."},{"content":"You can add your wizard to the Templates pane in the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box in Visual Studio by placing the .vsz file in the vcprojects directory.","pos":[3949,4099],"source":"You can add your wizard to the Templates pane in the **New Project** dialog box in Visual Studio by placing the .vsz file in the vcprojects directory."},{"content":"By default, the Custom Wizard writes the .vsz file to this directory.","pos":[4100,4169]},{"pos":[4177,4340],"content":"[!NOTE]\n If you delete your wizard files and directories, you must also delete the project's .vsz file, .vsdir file, and .ico file from the vcprojects directory.","leadings":["","> "],"nodes":[{"content":"If you delete your wizard files and directories, you must also delete the project's .vsz file, .vsdir file, and .ico file from the vcprojects directory.","pos":[9,161]}]},{"content":"See Also","pos":[4349,4357]},{"content":"Files Created for Your Wizard","pos":[4362,4391]},{"content":"Custom Wizard","pos":[4439,4452]},{"content":"Creating a Custom Wizard","pos":[4484,4508]},{"content":"Visual C++ Wizard Model","pos":[4551,4574]},{"content":"Adding Wizards to the Add Item and New Project Dialog Boxes by Using .Vsdir Files","pos":[4651,4732]},{"content":"Designing a Wizard","pos":[4811,4829]}],"content":"---\ntitle: \".Vsz File (Project Control) | Microsoft Docs\"\nms.custom: \"\"\nms.date: \"11/04/2016\"\nms.reviewer: \"\"\nms.suite: \"\"\nms.technology: \n  - \"devlang-cpp\"\nms.tgt_pltfrm: \"\"\nms.topic: \"article\"\ndev_langs: \n  - \"C++\"\nhelpviewer_keywords: \n  - \"custom wizards, project control files\"\n  - \".vsz files\"\n  - \"vsz files\"\n  - \"custom wizards, .vsz file\"\n  - \"files [C++], created by Custom Wizard\"\nms.assetid: b8678fee-6795-46d1-9338-48b22d5e9207\ncaps.latest.revision: 12\nauthor: \"mikeblome\"\nms.author: \"mblome\"\nmanager: \"ghogen\"\ntranslation.priority.ht: \n  - \"cs-cz\"\n  - \"de-de\"\n  - \"es-es\"\n  - \"fr-fr\"\n  - \"it-it\"\n  - \"ja-jp\"\n  - \"ko-kr\"\n  - \"pl-pl\"\n  - \"pt-br\"\n  - \"ru-ru\"\n  - \"tr-tr\"\n  - \"zh-cn\"\n  - \"zh-tw\"\n---\n# .Vsz File (Project Control)\nThe starting point of each wizard is the .vsz file. The .vsz file is a text file that determines the wizard to be called and the information to pass to the wizard. The file contains a two-line header, followed by various optional parameters to be passed to the wizard. For a list of optional parameters, see [Predefined Custom Wizard Symbols](../ide/custom-parameters-in-the-wizard-dot-vsz-file.md).  \n  \n The following sample shows the header in a .vsz file:  \n  \n```  \nVSWIZARD 7.0  \nWizard=VsWizard.VsWizardEngine.10.0  \nParam=\"WIZARD_NAME = My AppWizard\"  \n```  \n  \n-   The first line of the header specifies the version number of the template file format. You may specify this number as `6.0`, `7.0`, or `7.1`. No other numbers are valid, and using other numbers results in an \"Invalid Format\" error.  \n  \n-   The second line sets the **Wizard** variable to the ProgID of the wizard that is cocreated by Visual Studio. A ProgID is a string representation of a CLSID, such as `VsWizard.VsWizardEngine.10.0`.  \n  \n     If your wizard has a user interface, the ProgID automatically specifies your wizard to implement <xref:Microsoft.VisualStudio.VsWizard.IVCWizCtlUI>. By default, the methods of this interface are used in the [.htm files](../ide/html-files.md) of your project. You can change the behavior of your wizard by using the methods for this interface in the .htm files. See <xref:Microsoft.VisualStudio.VsWizard.VCWizCtl> for more information, which is the coclass for <xref:Microsoft.VisualStudio.VsWizard.IVCWizCtlUI>.  \n  \n-   Following these two lines is an optional list of parameters that allow the .vsz file to pass additional custom parameters to the wizard. Each value is passed as a string element in an array of variants in the wizard control's <xref:Microsoft.VisualStudio.VsWizard.VsWizardClass.Execute%2A> method. By default, a wizard with a user interface produces the following default parameters:  \n  \n    ```  \n    Param=\"START_PATH = <path to the wizard>\"  \n    Param=\"HTML_PATH = <path to the wizard's HTML file>\"  \n    Param=\"TEMPLATES_PATH = <path to the wizard's template file>\"  \n    Param=\"SCRIPT_PATH = <path to the wizard's script files>\"  \n    Param=\"IMAGES_PATH = <path to the wizard's images>\"  \n    ```  \n  \n     If your wizard does not have a user interface, it does not have an `IMAGES_PATH` parameter and instead contains the following parameters:  \n  \n    ```  \n    Param=\"WIZARD_UI = FALSE\"  \n    Param=\"SOURCE_FILTER = txt\"  \n    ```  \n  \n-   The .vsz file can contain the following parameters, which specify functions found in the [Common.js](../ide/customizing-cpp-wizards-with-common-jscript-functions.md) file:  \n  \n    ```  \n    Param=\"PREPROCESS_FUNCTION = CanAddATLClass\"  \n    Param=\"PREPROCESS_FUNCTION = CanAddMFCClass\"  \n    Param=\"PREPROCESS_FUNCTION = CanAddClass\"  \n    ```  \n  \n The functions [CanAddATLClass](../ide/canaddatlclass.md), [CanAddMFCClass](../ide/canaddmfcclass.md), and [CanAddClass](../ide/canaddclass.md) are called by the wizard to confirm that the [Visual C++ Code Model](http://msdn.microsoft.com/en-us/dd6452c2-1054-44a1-b0eb-639a94a1216b) is available. If one function returns **false**, the wizard is not launched.  \n  \n You can add your wizard to the Templates pane in the **New Project** dialog box in Visual Studio by placing the .vsz file in the vcprojects directory. By default, the Custom Wizard writes the .vsz file to this directory.  \n  \n> [!NOTE]\n>  If you delete your wizard files and directories, you must also delete the project's .vsz file, .vsdir file, and .ico file from the vcprojects directory.  \n  \n## See Also  \n [Files Created for Your Wizard](../ide/files-created-for-your-wizard.md)   \n [Custom Wizard](../ide/custom-wizard.md)   \n [Creating a Custom Wizard](../ide/creating-a-custom-wizard.md)   \n [Visual C++ Wizard Model](http://msdn.microsoft.com/en-us/159395ac-33c7-47bf-ad42-4e1435ddc758)   \n [Adding Wizards to the Add Item and New Project Dialog Boxes by Using .Vsdir Files](http://msdn.microsoft.com/Library/e0a20da0-3680-4084-997e-dbe02db51da9)   \n [Designing a Wizard](../ide/designing-a-wizard.md)"}